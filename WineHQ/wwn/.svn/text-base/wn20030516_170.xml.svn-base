<?xml version="1.0" ?>
<kc>

<title>Wine Traffic</title>

<author contact="http://www.theshell.com/~vinn">Brian Vincent</author>

<issue num="170" date="05/16/2003" />

<intro>
<p>This is the 170th release of the Wine's kernel cousin publication. 
  Its main goal is to inform you of what's going on around Wine (the Un*x 
  Windows emulator).</p>
</intro>





<stats posts="182" size="611" contrib="56" multiples="31" lastweek="30">

<person posts="19" size="56" who="Dimitrie O. Paun" />
<person posts="17" size="40" who="Lionel Ulmer" />
<person posts="16" size="55" who="Raphael Junqueira" />
<person posts="15" size="33" who="Alexandre Julliard" />
<person posts="10" size="26" who="Mike Hearn" />
<person posts="8" size="21" who="Vincent Beron" />
<person posts="7" size="24" who="Uwe Bonnes" />
<person posts="7" size="14" who="Eric Pouech" />
<person posts="6" size="16" who="Andreas Mohr" />
<person posts="5" size="9" who="erwin wolff" />
<person posts="4" size="19" who="Gregory M. Turner" />
<person posts="4" size="9" who="Sylvain Petreolle" />
<person posts="4" size="9" who="(fenix)" />
<person posts="3" size="8" who="Adam Gundy" />
<person posts="3" size="8" who="Stefan Leichter" />
<person posts="3" size="8" who="Raphael Junqueira" />
<person posts="3" size="6" who="Ferenc Wagner" />
<person posts="2" size="95" who="Steven Edwards" />
<person posts="2" size="7" who="Gerald Pfeifer" />
<person posts="2" size="7" who="Rok Mandeljc" />
<person posts="2" size="6" who="Duane Clark" />
<person posts="2" size="6" who="Michael Stefaniuc" />
<person posts="2" size="5" who="Jukka Heinonen" />
<person posts="2" size="5" who="Joerg Mayer" />
<person posts="2" size="5" who="Dmitry Timoshkov" />
<person posts="2" size="5" who="Jason Edmeades" />
<person posts="2" size="4" who="Gyorgy Jeney" />
<person posts="2" size="4" who="Gerhard W. Gruber" />
<person posts="2" size="4" who="Mike McCormack" />
<person posts="1" size="15" who="Luis Marques" />
<person posts="1" size="7" who="Knut J Bjuland" />
<person posts="1" size="4" who="Rein Klazes" />
<person posts="1" size="4" who="Steven Edwards" />
<person posts="1" size="3" who="Zsolt Rizsanyi" />
<person posts="1" size="3" who="Joe Squire" />
<person posts="1" size="3" who="Ulrich Weigand" />
<person posts="1" size="3" who="Ulrich Czekalla" />
<person posts="1" size="2" who="Vitaliy Margolen" />
<person posts="1" size="2" who="Ove Kaaven" />
<person posts="1" size="2" who="BiGgUn" />
<person posts="1" size="2" who="Rizsanyi Zsolt" />
<person posts="1" size="2" who="Patrick Griffin" />
<person posts="1" size="2" who="(wine)" />
<person posts="1" size="2" who="Mark Westcott" />
<person posts="1" size="2" who="Kevin DeKorte" />
<person posts="1" size="2" who="Aric Stewart" />
<person posts="1" size="2" who="Shachar Shemesh" />
<person posts="1" size="1" who="Marcus Meissner" />
<person posts="1" size="1" who="Nick Capik" />
<person posts="1" size="1" who="Jeremy Newman" />
<person posts="1" size="1" who="Thorsten Kolb" />
<person posts="1" size="1" who="Philipp Wollermann" />

</stats>




<section 
	title="News: TransGaming Poll Update, SpyHunter Port, More on FoxPro" 
	subject="News"
	archive="http://www.transgaming.com/pollslist.php" 
	posts="3"
	startdate="05/10/2003"
	enddate="05/16/2003"
>
<topic>News</topic>
<p>TransGaming updated their polls and opened voting for
May.  What's significant is the removal of some topics:</p>
 <quote who="TransGaming"><p>
 April's polling section has now been closed and the new votes for 
 May are up. Check out the topics at in our 
 <a href="http://www.transgaming.com/pollslist.php">voting section</a>. 
</p><p>
We have made sufficient progress with WineX 3.0 and Point2Play that 
the following poll topics have been removed: 
<ul>
<li>Better support for InstallShield </li>
<li>Separate installation sites for each game (this is a primary 
    feature of Point2Play) </li>
<li>Improved support for copy protected games </li>
</ul>
</p></quote>

<p>TransGaming issued a press release announcing a 
<a href="http://www.transgaming.com/news.php?newsid=71">port 
of SpyHunter</a>.   What's not clear is if Wine had anything to
do with it.  Aspyr's web site 
<a href="http://www.aspyr.com/products.php?p_product_id=1">describes
the game</a> as being offered only for Windows 2000/XP or Mac OS X.</p>

<p>Linux Journal published 
<a href="http://www.linuxjournal.com/article.php?sid=6869">an addendum</a>
to an earlier story about a Visual FoxPro developer who was prevented
from giving a demo to a user group.  Microsoft responded with vague wording
suggesting end users look elsewhere concerning the legality of running
Visual FoxPro with Wine, 
<quote who="Microsoft">you should seek your own legal counsel's advice 
 when interpreting your rights and obligations under the Visual FoxPro 
 End User License Agreement</quote>.  One lawyer did just that and posted
his  <a href="http://leafe.com/archives/showMsg/139126">interpretation</a>.
Microsoft's position is ambiguous at best, but with army of lawyers it
doesn't need to be any clearer.</p>

<p>More intriguing is Linux Journal's assertion that Microsoft wants to
get rid of Visual FoxPro because it's so cheap to develop for.  SQL
Server is a cash cow comparatively speaking and presumably would want to
throw their weight behind development environments that use it.  This
has led developers to look towards Visual FoxPro for cost savings.</p>

<p>At some point I mentioned there would be an interview every week
on WineHQ.  So far I've managed to miss deadline for the past month.
I'm still shooting for Tuesday releases, now it's going to be every
two weeks though.</p>

</section><section 
	title="Direct3D Status" 
	subject="[dx8-21] Viewport fix"
	archive="http://www.winehq.org/hypermail/wine-devel/2003/05/0353.html" 
	posts="5"
	startdate="05/13/2003"
	enddate="05/15/2003"
>
<topic>Fixes</topic>
<p>There's been a ton of Direct3D work over 
the past week, in part to a public transportation
<a href="http://famulus.msnbc.com/FamulusIntl/reuters05-14-221212.asp?reg=EUROPE">strike</a>.  
Most of it has already been committed to CVS too. Jason Edmeades 
wrote in to let everyone know Warcraft3 is working with regular old Wine:</p>
<quote who="Jason Edmeades"><p>
 FYI With the 
 <a href="http://www.winehq.org/hypermail/wine-patches/2003/05/att-0171/01-dx22.viewport.patch20030315">attached
 patch</a> on top of the wine cvs tree, a no-cd install
 (requires native msvcrt until I fix the 'thiscall' issue) and running 'wine
 war3' warcraft 3 now appears to be pretty much right!!! (No more screen
 distortion / misplaced faces etc).
</p><p>
 Thanks to everyone who has helped get this far, especially Raphael and
 Lucho.
</p></quote>

<p>
<a href="http://www.blizzard.com">Warcraft 3</a> 
came out last year and has been one of the top selling
video games since then.</p>

<p>Erwin Wolff wrote to report Grand Theft Auto 3 is partially working with
the latest updates:</p>
<quote who="Erwin Wolff"><p>
I tested GTA3 again, but this time with the latest cvs. GTA3 runs much
faster now and produces only one error:
<ul><code>
fixme:d3d:IDirect3DDevice8Impl_SetCurrentTexturePalette (0x402fc60) :
stub</code></ul></p><p>
 Again, no in-game textures are being shown, only polygons and colors.
 The only texture that is being shown is the title of the game in the
 game menu.
</p></quote>

<p>Raphael Junqueira, one of the D3D 8 authors, replied that he might
be able to get some texture support working for it.  Lionel Ulmer
gave him a pointer to some D3D 7 GL code that could be adapted.</p>

<p>Jason wrote in with another update later in the week, this time
concerning Max Payne, 
 <quote who="Jason Edmeades"> 
 With this fix MayPayne is starting to be playable. Looks fine as
 long as you don't change weapon (Fancy doing it all with the pistol?).
 You have to wait with a black screen during some of the movie sections
 though.  </quote>  A few hours later he had more problems fixed,
 including being able to change weapons, and announced,
 <quote who="Jason Edmeades"> 
 Aside from no movies and no sound May Payne looks quite good. I also
 checked my changes didn't break warcraft3 either, so we now at least have
 2 games which are playable.
 PS: Don't expect much more from me for a while now - Busy playing games...
 </quote>
</p>

<p>Late in the week Mike McCormack submitted a patch to delay loading
of OpenGL till runtime, noting,
<quote who="Mike McCormack">
 This patch binds opengl at runtime, so we can build binaries with OpenGL 
 enabled and still use some parts of ddraw on systems without OpenGL.
</quote>
  Lionel Ulmer requested that Alexandre not
 apply the large patch.  The eventual goal will be to write a common
 D3D core that will provide a similar functionality,
 <quote who="Lionel Ulmer">
 Basically, we will have a d3dcore
 library linked to OpenGL and if DDraw fails to load it (for example if GL is
 not present on the system), DDraw will not support D3D.
 </quote></p>

</section><section 
	title="Lotus Notes Breakage" 
	subject="Lotus Notes and wine and RedHat 9"
	archive="http://www.winehq.org/hypermail/wine-devel/2003/05/0290.html" 
	posts="6"
	startdate="05/10/2003"
	enddate="05/12/2003"
>
<topic>Fixes</topic>
<p>Joe Squire reported a problem running Lotus Notes and asked for help:</p>
<quote who="Joe Squire"><p>
 I had been running wine on 7.2 with Lotus Notes 5.0.11 successfully. I made 
 the unfortunate discovery about RH9 and threads and wine a little too late 
 after upgrading to RH9. I will be more careful next time...
</p><p>
Anyways, I downloaded the source (2003-05-08), and managed to configure with 
<tt>--with-nptl</tt></p>
<p>
But I ran into a problem that has already been reported at (thank you 
google)
<ul><a href="http://www.winehq.org/hypermail/wine-devel/2003/05/0141.html">
 http://www.winehq.org/hypermail/wine-devel/2003/05/0141.html</a></ul></p><p>
 (the issue was unresolved. Kevin rolled back to a previous wine source from 
 5/1/2003).
 As with that post, there had been no changes to the install in the wine 
 directory. The Lotus Notes splash screen comes up. The background for Notes 
 itself comes up. The password box appears, and the error happens when I 
 punch in the password and hit OK.</p></quote>

<p>Uwe Bonnes recognized the problem and described it,
<quote who="Uwe Bonnes">
 it boiled down that Andi added a lot of functions in the user32 spec file,
 with no implementation provided. These functions are mostly only implemented
 in recent windows version, and Notes has to cope with these functions not
 available. But as we added them in the spec file, this request will be
 granted, but later fails when this function should be executed.
</quote></p>

<p>Mike Hearn wondered if maybe the functions should be commented out
in the spec file until they're implemented.  Michael Stefaniuc pointed
out that Alexandre had very recently
<a href="http://www.winehq.org/hypermail/wine-cvs/2003/05/0131.html">supplied</a>
that exact fix.</p>

<p>So, if you're using Lotus Notes and you ran into some problems recently
give the latest CVS a try.  
<a href="http://www.winehq.org/?page=cvs">Instructions </a> for getting 
Wine from CVS can be found at WineHQ.</p>

</section><section 
	title="NPTL Auto Detection &amp; RH9 Packages" 
	subject="NPTL auto detection"
	archive="http://www.winehq.org/hypermail/wine-devel/2003/05/0244.html" 
	posts="15"
	startdate="05/09/2003"
	enddate="05/10/2003"
>
<topic>Integration</topic>
<p>More discussion of the recent threading changes appeared
on wine-devel this week.  Alexandre once mentioned that he'd
like to make the use of NPTL-style threads detectable at
runtime.  Currently you have to do it when you compile by
supplying configure with the "<tt>--with-nptl</tt>" option.
When it came up again this week Alexandre mentioned that
CrossOver Office 2.0 used a really ugly hack that wouldn't
be included in the LGPL'ed Wine tree,
<quote who="Alexandre Julliard">
 it's two sets of libraries and a script that tweaks LD_LIBRARY_PATH 
 etc.</quote></p>

<p>Mike Hearn wanted to know if it would be ok to submit a
temporary fix that makes configure detect which threading library 
is in use.  Alexandre pointed out a problem with that though,
<quote who="Alexandre Julliard">
 Well, you can detect the lib in use at compile time but that isn't
 necessarily what will be used at run time, things like changing the
 kernel or even simply setting LD_ASSUME_KERNEL differently will break
 it. So I'm not convinced it's really more reliable. The real problem
 IMO is that we don't have NPTL rpm packages.</quote></p>

<p>Mike pointed out that RPM's do exist,
<quote who="Mike Hearn">
 We do, over at 
 <a href="http://newrpms.sunsite.dk">newrpms.sunsite.dk</a>
 iirc, the biggest problems being that I
 think they depend on ALSA (not sure why) and that nobody knows about them
 unless they visit IRC. Plus they are for RedHat only (but really it's
 mostly RedHat users with the problems).</quote></p>

<p>Dimi Paun wanted to add them to the 
<a href="http://sourceforge.net/projects/wine/">SourceForge repository</a>,
but wasn't sure how well the RPM's were packaged.  Vincent Beron,
the RedHat RPM packager, thought they were ok since they were derived
from his RH8 packages.  Because of hardware problems it would be a
while before he could create the RH 9 ones himself.
</p>






</section><section 
	title="RPC Documentation Update" 
	subject="DCE RPC documentation fund is collecting dust..."
	archive="http://www.winehq.org/hypermail/wine-devel/2003/05/0249.html" 
	posts="4"
	startdate="05/09/2003"
	enddate="05/10/2003"
>
<topic></topic>
<p>A few months ago Jeremy White put together a PayPal fund to purchase
some RPC docs.  We covered this back in 
<a href="http://www.winehq.org/index.php?issue=156#RPC%20Data%20Marshalling%20(cont'd)">issue
#156</a>. Greg Turner wrote the list about the status of getting
that documentation:</p>

<quote who="Greg Turner"><p>
My apologies for not announcing this sooner, but it seems that the DCE RPC 
documentation package, which many of you kindly donated funds for, is a 
no-go.  I've spent some time researching what, if anything, we need from 
OpenGroup, and unfortunately, I've never been able to get a coherent answer, 
even from OpenGroup's sales people.  
</p><p>
Part of the problem seems to be that the DCE standard is "discontinued" by 
OpenGroup as a project.  We wouldn't care if we knew what documents had 
relevance to wine.  But it turns out that DCE covers a lot more than just 
RPC, most of which is not of interest to wine's RPC implementation.  The RPC 
part of the standard, as far as I can tell, is freely available for download, 
including the fascinating "DCOM/ActiveX" standard (which refers to a separate 
ORPC standards document I have been unable to find, I'm afraid, to document 
the ORPC wire protocol :(; btw, I think Microsoft let their similar document 
fall of the 'net as well, you'll see links to it in various places... but I 
digress....)
</p><p>
So, insofar as I have questions about whether or not there's anything useful 
in there, OpenGroup's sales lady is unable to help -- she don't even seem 
able to give me the information that's available on the website, much less 
elaborate on it.  That leaves me with no choice but to guess what is useful 
based on the information available to me: which seems to indicate that we 
don't need anything we can't get for free from OpenGroup.
</p><p>
So, the obvious question is, where does everyone's hard-earned money go?  I've 
confirmed with Jeremy that refunds are an option; if you want your money 
back, let Jeremy know, and presumably he will make arrangements with you in 
private to get your money returned.
</p><p>
For those of you who would rather have your donations go to some other 
wine-releated cause, the matter is open for discussion.  One idea which has 
been tossed around in private discussions between myself, Jeremy and Dimi is 
to rededictae these funds to the Wine Party Fund or some other wine 
conference fund.  Another would be to find some other documentation we need 
to buy and use it for that.  But, it's your money, and since every 
contributor essentially has veto power over their own portion of the funds, 
we obviously want to build some kind of consensus.
</p><p>
Sorry it took me so long to break this news, I spend a fair amount of time 
trying to salvage the original plan to buy the DCE doc's but it just didn't 
seem right to spend it on something which potentially has no value to wine... 
and then the guilt and procrastination set in... ;)  Thanks for your patience 
on this matter.
</p></quote>

<p>Everyone who responded seemed fine with letting the donations be used for
another purpose in the future.</p>

</section><section 
	title="Valgrinding Wine" 
	subject="Valgrind for WINE tarball now available"
	archive="http://www.winehq.org/hypermail/wine-devel/2003/05/0317.html" 
	posts="1"
	startdate="05/12/2003"
>
<topic>Debugging</topic>
<p>Adam Gundy wrote in with another announcement for running Wine
with Valgrind:</p>
<quote who="Adam Gundy"><p>
For all you developers out there who haven't tried valgrinding WINE yet
(it's fun - honest!) there is now a pre-patched tarball of the latest
valgrind 1.9.6 for WINE available from the valgrind website:
<ul><a href="http://developer.kde.org/~sewardj/">http://developer.kde.org/~sewardj/</a>
</ul></p><p>

no patching needed to WINE or valgrind. Just get the latest snapshot of WINE
(or a CVS checkout), build for debugging, get the pre-patched valgrind and use it!
</p><p>
there are still plenty of bugs in WINE which need fixing - most are simple 1 line edits..
</p></quote>

</section><section 
	title="Separating 16/32 Bit OLE Functions" 
	subject="PATCH - Start separating 16/32 in Ole and ole32 memlockbytes"
	archive="http://www.winehq.org/hypermail/wine-devel/2003/05/0404.html" 
	posts="2"
	startdate="05/15/2003"
>
<topic>Architecture</topic>
<p>Steven Edwards started splitting out some functions in OLE and
OLE32.  He gave an update of what he's trying to do and some of
the issues involved:</p>
<quote who="Steven Edwards"><p>
 I am doing some work trying to separate Ole* and Ole32 for use in 
 ReactOS. Before we can make use of most of the WINE code all of the 
 Non-Win32api imported functions are going to need to be compiled out or 
 rewitten. I don't need someone to do this for me but I am going to need a 
 little hand-holding as I don't want to waste my or anyone else's time.
</p><p>
Currentlly Ole32 Imports these non-Win32api functions:
<ul>
 <li> From GDI32.dll
	<ul><li>CloseMetaFile16</li></ul></li>
 <li> From Kernel32.dll 
	<ul><li>FreeLibrary16</li>
	<li>GetCurrentTask</li>
	<li>GetModuleHandle16</li>
 	<li>GetProcAddress16</li>
	<li>GlobalAlloc16</li>
	<li>GlobalFree16</li>
	<li>GlobalLock16</li>
	<li>GlobalReAlloc16</li>
	<li>GlobalSize16</li>
	<li>GlobalUnlock16</li>
	<li>K32WOWCallback16Ex</li>
	<li>K32WOWGlobalAllocLock16</li>
	<li>K32WOWGlobalUnlockFree16</li>
	<li>LoadLibrary16</li>
	<li>LockResource16</li>
	<li>MapLS</li>
	<li>UnMapLS</li>
 </ul></li></ul>

</p><p>
Anywhere here is the first patch that removes a few of these imports if 
<tt>--disable-win16</tt> is passed to configure. I still have a lot to go and 
this may need some cleanup/review from a OLE guru on Linux but it builds 
for me without warnings or errors under Mingw.
</p><p>
Changelog: Separate Win16 and Win32 Ole support in memlockbytes.
</p></quote>

</section><section 
	title="Improving Exception Handling" 
	subject="-fexceptions? -fasync-unwind-tables?"
	archive="http://www.winehq.org/hypermail/wine-devel/2003/05/0394.html" 
	posts="6"
	startdate="05/12/2003"
	enddate="05/14/2003"
>
<topic>Fixes</topic>
<p>For several weeks Greg Turner has been struggling with getting
some exception handling to work.  Ulrich Weigand asked Greg for 
a description of exactly what he was trying to accomplish.  Greg
described the problem:</p>
<quote who="Greg Turner"><p>

Well, you are probably going to laugh, but now that we are using some 
MIDL-generated code, I'm racking my brains on how to improve the exception 
handling macro's built into wine.  The MIDL-generated code utilizes the 
typical Microsoftian (Borlandian?) try { } except(bool expr) { } / 
try { } finally { } construct.
</p><p>
Possible goals are:
<ul>
  <li>achieve real "SEH"-style syntax, that is, no bloody __ENDTRY macro.</li>
  
  <li>fix "break"</li>

  <li>fix "return" from try/finally blocks.</li>

</ul></p><p>
Now here comes the part that will make you laugh: I'm supposed to do all this 
without patching gcc, using c++, or doing anything nonportable.  In reality, 
an x86-specific solution that really worked would probably cut the mustard, 
IMO, at least as a starting point for cross-platform support.
</p><p>
I made some proof-of-concept patches which use the existing wine macros and 
various gcc-ism's to achieve some of these goals (they are not "right", of 
course).  I had given up on it, or at least put it on the back burner, but 
Ove's recent DCOM patches inspired me to continue bashing my head against the 
wall...
</p><p>
Anyhow, I'll take a look at the dwarf2 goodies, maybe I'll decide that it's 
do-able, but more trouble than its worth... either way, I intend to make some 
kind of patch out of this whole investigation, as I am pretty darn sure I can 
at least fix one of the forementioned deficiencies, maybe even two, without 
making any major sacrifices.
</p><p>
If I'm lucky, I will stumble upon a solution to all three, but I'm kind of 
learning some of this (OK, all of it ;) ) as I go, and somewhat skeptical of 
my chances...
</p><p>
Knowing you, Dr. Weigand, you probably instantly know how to achieve this, so 
don't worry about spoiling the fun, you can go ahead and tell us ;)
</p></quote>

<p>After more head bashing, Greg came up with something and requested
some comments on it:</p>

<quote who="Greg Turner"><p>
  Implement gcc-specific "__TYPED_TRY" macro supposedly capable of
  intercepting return and running the finally clause.  If it compiles,
  it should work on x86... If it fails to compile, it needs you to specify
  the return type as in 
  <ul><code>
     __TYPED_TRY(float) { <br />
     } __FINALLY(func) { <br />
     } __ENDTRY</code></ul></p><p>

  Other arches may have much less success ;) of course, almost any problem
  of this kind should be fixed by turning __TRY into the appropriate
  __TYPED_TRY.  __TRY generates warnings, some may be fixable.
  </p></quote>

<p>For more details, look at the
<a href="http://www.winehq.org/hypermail/wine-devel/2003/05/0394.html">actual patch</a>.</p>
<p>Alexandre thought the problem required approaching it from a different
angle:</p>
<quote who="Alexandre Julliard"><p>
Cool! now you can start considering how to support <tt>continue</tt>, <tt>break</tt>,
and <tt>goto</tt> ;-)
</p><p>
(I don't want to discourage you, but I think you will eventually come
to realize that the only way to make this work right is to do it in
the compiler)</p></quote>




</section><section 
	title="SourceForge Download Stats" 
	subject="[FYI] SourceForge stats"
	archive="http://www.winehq.org/hypermail/wine-devel/2003/05/0.html" 
	posts="2"
	startdate="05/15/2003"
	enddate="05/15/2003"
>
<topic>Project Management</topic>
<p>Wow.  A lot of you use Wine.  Then again, you're reading this
so you better have some sort of interest.  Dimi wrote in with some
stats concerning downloads:</p>
<quote who="Dimitrie Paun">
<p>
 For the first time we are in the first 30 downloads (position 29 :)) on
 SourceForge:
 <ul>
 <a href="http://sourceforge.net/top/toplist.php?type=downloads_week">
 http://sourceforge.net/top/toplist.php?type=downloads_week</a></ul>
</p><p>
We need to make it to the fist 10, so we are always featured on the
front page :) But we need to more than quadruple our downloads to
achieve that. Alexandre, I think you need to release more often ;)
</p></quote>

<p>Tracking such stats is a good reason to use SourceForge for 
downloads.  In no way should those numbers be representative of
the number of how much Wine is used (and the same goes for every
other project on SourceForge).  Lots of people use Wine directly
out of CVS, others stick with an older release because it works,
and many download from other locations.  It is good to see such
a high ranking considering how relatively recent it's been that
SourceForge hosts Wine downloads.  </p>

</section></kc>
