<?xml version="1.0" ?>
<kc>

<title>Kernel Cousin Wine</title>

<author email="vinn@theshell.com">Brian Vincent</author>

<issue num="139" date="10/11/2002" />

<intro>

<p>This is the 139th release of the Wine's kernel cousin publication. Its
main goal is to distribute widely what's going on around Wine (the Un*x 
Windows emulator).</p>
</intro>


<stats posts="137" size="556" contrib="44" multiples="23" lastweek="22">

<person posts="16" size="43" who="Alexandre Julliard &lt;julliard@winehq.org&gt;" />
<person posts="12" size="38" who="Dimitrie O. Paun &lt;dpaun@rogers.com&gt;" />
<person posts="12" size="24" who="Sylvain Petreolle &lt;spetreolle@yahoo.fr&gt;" />
<person posts="9" size="27" who="Greg Turner &lt;gmturner007@ameritech.net&gt;" />
<person posts="7" size="37" who="steve.lustbader@philips.com" />
<person posts="7" size="20" who="Fabian Cenedese &lt;Cenedese@indel.ch&gt;" />
<person posts="7" size="16" who="Eric Pouech &lt;eric.pouech@wanadoo.fr&gt;" />
<person posts="5" size="16" who="Uwe Bonnes &lt;bon@elektron.ikp.physik.tu-darmstadt.de&gt;" />
<person posts="4" size="12" who="Paul Rupe &lt;prupe@myrealbox.com&gt;" />
<person posts="4" size="11" who="Rein Klazes &lt;rklazes@xs4all.nl&gt;" />
<person posts="4" size="9" who="Andreas Mohr &lt;andi@rhlx01.fht-esslingen.de&gt;" />
<person posts="4" size="9" who="Gyorgy Jeney &lt;nog@sdf.lonestar.org&gt;" />
<person posts="4" size="17" who="Chris Morgan &lt;chrismorgan@rcn.com&gt;" />
<person posts="3" size="9" who="Andrew M. Johnston &lt;johnstonam@logica.com&gt;" />
<person posts="3" size="8" who="Armish &lt;acemimsi@yahoo.com&gt;" />
<person posts="3" size="6" who="Steven Edwards &lt;Steven_Ed4153@yahoo.com&gt;" />
<person posts="2" size="18" who="Sean Millichamp &lt;sean@compu-aid.net&gt;" />
<person posts="2" size="5" who="Joerg Mayer &lt;jmayer@loplof.de&gt;" />
<person posts="2" size="5" who="Rizsanyi Zsolt &lt;rizsanyi@myrealbox.com&gt;" />
<person posts="2" size="5" who="twickline2@triad.rr.com" />
<person posts="2" size="5" who="Martin Wilck &lt;Martin.Wilck@Fujitsu-Siemens.com&gt;" />
<person posts="2" size="4" who="Roger Eisenecher &lt;roger.eisenecher@icer.ch&gt;" />
<person posts="2" size="3" who="Matthew Davison &lt;m.davison@virgin.net&gt;" />
<person posts="1" size="149" who="Juergen Schmied &lt;juergen.schmied@debitel.net&gt;" />
<person posts="1" size="4" who="Ove Kaaven &lt;ovek@arcticnet.no&gt;" />
<person posts="1" size="4" who="Shachar Shemesh &lt;wine-devel@sun.consumer.org.il&gt;" />
<person posts="1" size="3" who="Geoff Thorpe &lt;geoff@geoffthorpe.net&gt;" />
<person posts="1" size="3" who="Nerijus Baliunas &lt;nerijus@users.sourceforge.net&gt;" />
<person posts="1" size="3" who="David Fraser &lt;davidf@sjsoft.com&gt;" />
<person posts="1" size="3" who="Juraj Hercek &lt;juraj@syncad.com&gt;" />
<person posts="1" size="3" who="Thorsten Kranzkowski &lt;tki@cce.de&gt;" />
<person posts="1" size="2" who="Ender &lt;winedev@admdev.com&gt;" />
<person posts="1" size="2" who="Christian Costa &lt;titan.costa@wanadoo.fr&gt;" />
<person posts="1" size="2" who="Dmitry Timoshkov &lt;dmitry@baikal.ru&gt;" />
<person posts="1" size="2" who="Jukka Heinonen &lt;jhei@iki.fi&gt;" />
<person posts="1" size="2" who="Z_God &lt;zeldario@wanadoo.nl&gt;" />
<person posts="1" size="2" who="Stefan Leichter &lt;Stefan.Leichter@camLine.com&gt;" />
<person posts="1" size="2" who="David D. Hagood &lt;wowbagger@sktc.net&gt;" />
<person posts="1" size="1" who="Bill Medland &lt;billmedland@look.ca&gt;" />
<person posts="1" size="1" who="Medland, Bill &lt;Bill.Medland@accpac.com&gt;" />
<person posts="1" size="1" who="Descalzi Carlos &lt;cdescalzi@nec.com.ar&gt;" />

</stats>

<section 
	title="News: Wine-20021007, TransGaming Update, Frank's Corner" 
	subject="News"
	archive="" 
	posts="" 
	startdate="10/05/2002"
	enddate="10/11/2002"
>
<topic>News</topic>
<p>Alexandre 
 <a href="http://cvs.winehq.org/cvsweb/wine/ANNOUNCE?rev=1.67&amp;content-type=text/x-cvsweb-markup">announced</a> 
 Wine-20021007 on Monday:</p>
<quote who="Alexandre Julliard"><p>
WHAT'S NEW with Wine-20021007: (see 
<a href="http://cvs.winehq.org/cvsweb/wine/ChangeLog?rev=1.63&amp;content-type=text/x-cvsweb-markup">ChangeLog</a> 
 for details)
<ul>
	<li> Massive listview 
	<a href="http://www.winehq.org/news/?view=138#Listview%20Changes">rewrite</a>.</li>
	<li> New MS RLE codec.</li>
	<li> winemaker should be working again.</li>
	<li> Beginnings of 
	<a href="http://www.winehq.org/news/?view=135#Direct3D%208%20Support">Direct3D 8</a> support.</li>
	<li> Lots of bug fixes.</li>
</ul></p></quote>

<p>The listview rewrite is ongoing, fifteen more have been committed since
Wine-20021007 was tagged.  Dimi Paun has sent a flurry
of patches over the past few weeks.  The fact that he organized 
them in a logical manner and separated out the changes no doubt
helped get them committed.  The winemaker work by Francois Gouget and
Martin Wilck was aimed at restoring functionality broken by new
naming conventions and other changes.  The RLE video codec was a last minute
addition - the patch appeared Monday courtesy of Michael G&#252;nnewig.</p>

<p>The <a href="http://www.winehq.org/about/index.php?status">status</a> page
on WineHQ had more work done.  I took some time and referenced WWN coverage
for each of the items.  Digging through 130+ issues took some time, so the
list is by no means complete, but for most things it should be a good 
primer.  Thomas Wickline updated the "To Do" part of the page.  The list
is not necessarily 1.0 specific.</p> 

<p>TransGaming released 
<a href="http://www.transgaming.com/showthread.php?news=49">WineX 2.2</a> 
on Tuesday.  This was based off the same codebase as 2.1.  Changes include:
</p>
<quote who="TransGaming"><p>
<ul><li>
 Many improvements have been made to the sound system in WineX. 
 Several new combinations of hardware and device drivers should 
 now work better than previously. </li>
<li>
 Hardware sound buffering is supported when explicitly activated. 
 It can be configured in the ~/.transgaming/config file, along 
 with support for Full Duplex mode. See the WineX Beginners Guide
 v. 2.2 for more information. </li>
<li>DirectShow support has been significantly improved, 
 both in performance, as well as with support for additional 
 media types. DirectShow performance is best when hardware 
 sound buffering is enabled. </li>
<li>Several improvements have been made to DirectInput, 
 including support for Unicode APIs and multi-button mice. </li>
<li>A number of fixes have been made to Direct3D 8, including 
 support switching rendering between threads, as well as various 
 Transformation and Lighting fixes. </li>
<li>Preliminary support for EverQuest. The Game is now fully 
 playable using the default 'new' EverQuest user interface mode, 
 however the auto-updater may not always work properly. The 
 standard UI mode is not fully functional, and performance 
 improvements will be made in future releases. For more information, 
 see the WineX 2.2 Release Notes. </li>
<li>Fixes for Mandrake 9.0 and RedHat 8.0 CD device auto-detection. 
 Note that Mandrake 9.0 appears to have a bug with SuperMount which 
 can cause problems reading files from a CD-ROM in some circumstances. 
 To work around the problem, disable the SuperMount feature in the OS. 
</li></ul></p></quote>

<p>TransGaming also posted a 
<a href="http://www.transgaming.com/showthread.php?news=48">development
status</a> outlining progress they've made and their future plans.
TransGaming's development is partly driven by subscribers who vote
each for the work they'd like to see done.  The EverQuest work
is an example.  The top ranked poll items from September requested
improvements on Direct3D, sound support, and InstallShield support.
</p>

<p>It looks like Frank's World has now moved to 
<a href="http://www.frankscorner.org/wine/">Frank's Corner</a>.  
Along with it there's all kinds of new stuff.  Check out:
<ul><li><a href="http://www.frankscorner.org/wineforum/">Wine/WineX forum</a></li>
<li>application/game specific installation instructions</li>
<li>Wine howto's</li>
</ul></p>
 


</section>





<section 
	title="Jack Audio Driver" 
	subject="Re: jack audio driver"
	archive="http://www.winehq.org/hypermail/wine-devel/2002/10/0137.html" 
	posts="1" 
	startdate="10/08/2002"
>
<topic>Multimedia</topic>
<p>Chris Morgan asked Eric Pouech about a new audio driver:</p>
<quote who="Chris Morgan"><p>
 I have an audio driver for the jack audio server,
 <a href="http://jackit.sourceforge.net">http://jackit.sourceforge.net</a>.  
 This is a callback based server, so each time
 the server needs audio data it executes a client callback function.  I was
 wondering if there was any interest in having this driver as part of mainline
 wine code as an example of how to write a wine audio driver for a callback
 based architecture.</p></quote>

<p>Eric replied:</p>
<quote who="Eric Pouech"><p>
well, it depends what you look at
jack way well be the standardized API for audio application
interoperability on Linux
but, some folks may argue that arts may well become the same
as of today, I don't like the number of sound drivers that we already
have (OSS, alsa, arts, nas) just for linux
it, of course, reflects the mess in low level audio interface in linux
what I really fear is the real maintenance of those drivers
as of today, OSS is maintained, I cannot really tell the same for the
others
it's never a bad idea to share code, but I fear we're not going to be
able to maintain all the drivers (but we don't maintain them all today
anyway)
so go for it
(sorry for thinking while writing ;-)
</p></quote>

<p>No code appeared on wine-patches nor did Alexandre commit
it directly.</p>

</section>









<section 
	title="Creating Test Framework for New DLL" 
	subject="How to add a new test dir?"
	archive="http://www.winehq.org/hypermail/wine-devel/2002/10/0099.html" 
	posts="3" 
	startdate="10/06/2002"
	enddate="10/07/2002"
>
<topic>Testing</topic>
<p>
 Greg Turner has been busy porting and fixing up
 Ove K&aring;ven's RPC code.  After submitting a
 few patches Greg decided to tackle creating some
 tests.  He detailed what he did to get the framework
 in place for the new rpcrt4 DLL and it's probably
 a good intro for another new DLL:</p>
<quote who="Greg Turner"><p>
 I'm trying to create a tests directory for rpcrt4.  So far I've
 done the following:
 <ul>
  <li> Create a <code>dlls/rpcrt4/tests</code> directory</li>
  <li> Change <code>dlls/rpcrt4/Makefile.in</code>:
	<ul><code>
	--- Makefile.in.A_PL2   2002-10-04 09:26:11.000000000 -0500<br />
	+++ Makefile.in 2002-10-06 17:59:31.000000000 -0500<br />
	@@ -13,6 +13,8 @@
        <ul> 	rpc_binding.c \<br />
        	rpcrt4_main.c</ul>

	+SUBDIRS = tests<br />
	+<br />
	 @MAKE_DLL_RULES@<br /><br />
 	### Dependencies:<br /></code></ul></li>

  <li> add <code>dlls/rpcrt4/tests/Makefile.in</code>:
	<ul><code>
	TOPSRCDIR = @top_srcdir@<br />
	TOPOBJDIR = ../../..<br />
	SRCDIR    = @srcdir@<br />
	VPATH  	  = @srcdir@<br />
	TESTDLL   = rpcrt4.dll<br />
	IMPORTS   = rpcrt4<br /><br />

	CTESTS = \
        	<ul>rpc.c</ul>

	@MAKE_TEST_RULES@<br /><br />

	### Dependencies:<br /></code></ul></li>

  <li> add <code>dlls/rpcrt4/tests/rpc.c</code>:
	<ul><code>
	#include "wine/test.h"<br />
	#include &lt;winbase.h&gt;<br />
	#include &lt;winnt.h&gt;<br />
	#include &lt;winerror.h&gt;<br /><br />

	START_TEST( rpc )<br />
	{<br /><ul>
    		trace ( " **** STARTING TEST %d **** \n", 0 );<br />
		ok (1);</ul>

    	Exit();<br />
	}</code></ul></li></ul>
</p></quote>

<p>But that wasn't enough and Greg couldn't figure out
what he was missing.  However, since it was the weekend
the list traffic was pretty slow and no one responded.
Greg kept at it and discovered the problem a few hours later -
a line needed in configure.ac for autoconf:</p>
<quote who="Greg Turner">
<p><ul><code>
diff -u -r1.81 configure.ac<br />
--- configure.ac        2 Oct 2002 19:58:27 -0000       1.81<br />
+++ configure.ac        7 Oct 2002 03:09:02 -0000<br />
@@ -1435,6 +1435,7 @@<br />
 dlls/rasapi32/Makefile<br />
 dlls/richedit/Makefile<br />
 dlls/rpcrt4/Makefile<br />
+dlls/rpcrt4/tests/Makefile<br />
 dlls/serialui/Makefile</code></ul></p></quote>

<p>He then submitted 
<a href="http://www.winehq.org/hypermail/wine-patches/2002/10/att-0062/01-rpc_A_PL4.diff">a patch</a> 
for the new framework with some actual tests.</p>


</section>









<section 
	title="Languages &amp; Locales" 
	subject="Languages/Locales"
	archive="http://www.winehq.org/hypermail/wine-devel/2002/10/0107.html" 
	posts="6" 
	startdate="10/07/2002"
	enddate="10/08/2002"
>
<topic>Internationalization</topic>
<p>Steve Lustbader posted a patch to implement 
<code>GetUserDefaultUILanguage</code> and 
<code>GetSystemDefaultUILanguage</code> but wasn't
sure of the details of using them:</p>
<quote who="Steve Lustbader"><p>
 I implemented these functions in codepage.c since similar functions
 (GetDefaultLangID and GetDefaultLCID) were already there.  Why are
 these functions in this file, instead of in dlls/kernel/locale.c?
</p><p>
 It seems locales and languages aren't really implemented yet
 (just hardcoded to English) - is this going in for 1.0 or is it not planned
 for the immediate future?
</p></quote>

<p>As to the first question, Alexandre said the functions were needed
 by ntdll, so for now they live in codepage.c.  Eventually that will
 be changed.  As for the implementation, Alexandre pointed out a lot
 of it has been done and lives in <quote who="Alexandre Julliard">
 <code>dlls/kernel/locale.c</code> and <code>ole/ole2nls.c</code>.
</quote></p>

<p>Someone else wondered about how locales work,
<quote who="Unknown">I often see Dutch stuff while using Wine 
 (other than Dutch programs of course), so I don't think everything is 
 hardcoded to english.</quote>  Shachar Shemesh explained:</p>
<quote who="Shachar Shemesh"><p>
You see dutch because the english locales in many of our apps are marked 
as sublanguage "NEUTRAL" instead of "DEFAULT".
</p><p>
This causes a problem when your locale is not matched by any of the 
resources. Usually, English is picked as a fallback, but since the 
english resource is incorrectly defined, English is not matched either. 
As a second fallback, the first resource language is picked, which 
happens to be Dutch.
</p><p>
I fixed the problem for Notepad a while back 
(<a href="http://www.winehq.org/hypermail/wine-patches/2002/08/0078.html">
http://www.winehq.org/hypermail/wine-patches/2002/08/0078.html</a>). 
I fixed it only for the English locale there (the rest are not that 
important to my specific problem), but as far as I understand the 
matter, "DEFAULT" should be used for all lanugagues unless the sublang 
is important. If I understand correctly, sublang NEUTRAL should only be 
used when asking to perform a match, never when defining resources.
</p><p>
As an interesting anacdote, when loading resources with LANG_HEBREW, 
Visual Studio works great. It won't let you define such resources from 
the GUI, however. I always thought this was because they didn't want to 
support that language for some strange reason, until I tried loading 
resources from WINE that had languages only defined in WINE. Visual 
Studio kept complaining and wouldn't load the resources, despite the 
fact that the languages were defined as numbers and no symbols were missing.
</p><p>
Now I am confused regarding the reason that Visual Studio won't let me 
define Hebrew resources. It appears that it is aware of the language, 
but will not give it a GUI. A deliberate action? Just one more to life's 
little misteries.</p></quote>

</section>





<section 
	title="User Level Security in Apps" 
	subject="Re : wine/programs/wcmd wcmdmain.c"
	archive="http://www.winehq.org/hypermail/wine-devel/2002/10/0182.html" 
	posts="7" 
	startdate="10/10/2002"
>
<topic>Integration</topic>
<topic>Filesystems</topic>
<p>Alexandre committed a patch that allowed CreateProcess to attempt
to run a program even if SHGetFileInfo failed.  The theory being it
would still allow Unix binaries to run if the executable was able to
be found.  Sylvain Peteolle wondered if that was really a good idea
though and though some programs might maliciously gain access to 
something that couldn't normally be launched.  Specifically, Sylvain
wondered what would happen if a program had access to ping.  Alexandre 
didn't think it was a big deal though:</p>
<quote who="Alexandre Julliard"><p>
 There is no way to prevent a Windows application running under Wine
 from doing everything a Unix application could do. Even if you don't
 let CreateProcess launch Unix programs the Windows app can always do a
 straight system call. If you want to avoid inadvertently running
 /bin/ping you can make sure /bin is not accessible from a DOS
 drive. But you can't prevent a malicious app from doing it.</p></quote>

<p>Joerg Mayer summarized that as, <quote who="Joerg Mayer">
 This leaves just two options for the paranoid: Don't run untrusted
 applications - yeah I know that comes as a surprise :-) or run Wine
 inside UserModeLinux.</quote></p>

<p>Geoff Thorpe thought this was worth having in Wine and suggested
another option,
<quote who="Geoff Thorpe">
 Or run it as a different user? Wine doesn't run a virtual machine, so 
 you can't prevent running code (ie. whether it was loaded by wine or 
 not) from doing anything that the user it's running as could do.  
 Therefore, logically, the only rules that wine-loaded win32 code can't 
 break are the same rules that no other program running as the same user 
 can't break. So the way I see it there's no logical argument for 
 putting restrictive rules into WINE that only make something 
 *potentially* useful more difficult (and a lot less elegant) to do. In 
 fact it could be very useful, especially for people wanting to mix 
 "shell"-like tools which are in some cases native to win32 (eg. 
 "cl.exe" or "somewebserver.exe") or native to unix (eg. "gmake" and 
 "/etc/init.d/w32server", respectively).</quote></p>

</section>
</kc>

