From m.b.lankhorst at gmail.com  Sat Mar  1 02:55:39 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sat, 1 Mar 2008 00:55:39 -0800
Subject: iPod synced with iTunes v7.6!
Message-ID: <b130c85e0803010055g19782baam34bc7e1301c884ed@mail.gmail.com>

Hi all,

I got an ipod I borrowed to sync: http://www.astro.rug.nl/~lankhorst/ipod.png

There are, however, 3 separate issues to work out for this to work
with an unpatched version of wine, minus the patches I sent to
wine-patches, and one I still need to confirm with rob.

1. I need to add detection in explorer (through hal detection) so that
ipods are automatically mounted and appropiate registry keys are
created (not that much work).
2. The ioctl's from dlls/ntdll/cdrom.c should really be moved to
dlls/mountmgr.sys, so that IOCTL_STORAGE_GET_DEVICE_NUMBER will always
be called with a proper implementation.
3. I need to add raw device access (access to /dev/sdb, if the ipod is
mounted on /dev/sdb2), through CreateFile(\\USBSTOR#..........)

1&3 won't be too hard to solve within a few days, but I'm not 100%
sure how to do 2.

Cheers,
Maarten.


From ono at java.pl  Sat Mar  1 09:10:24 2008
From: ono at java.pl (Adam Strzelecki)
Date: Sat, 1 Mar 2008 16:10:24 +0100
Subject: kernel32 & winex11: WaitForMultipleObjectsEx should ignore NULL
	handles
In-Reply-To: <47C839A8.10101@codeweavers.com>
References: <B5DA0EA3-A343-4A4C-99EA-581A2F230874@java.pl>
	<47C839A8.10101@codeweavers.com>
Message-ID: <76BAF0EE-5450-482A-B1F3-D5B57DB89156@java.pl>

> In this case, MSI should not be calling MsgWaitForMultipleObjects  
> with an invalid handle and in fact that barring memory corruption,  
> this can't happen:
You're right, my patch was incorrect, I made bad assumption.

I'm still not sure why this X11DRV_MsgWaitForMultipleObjectsEx is  
testing for "(count || timeout)", rather than "(count && timeout)" or  
just "count" at:

>      if (process_events( data->display, mask )) ret = count - 1;
>      else if (count || timeout)
>      {
>          ret = WaitForMultipleObjectsEx( count, handles, flags &  
> MWMO_WAITALL,
>                                          timeout, flags &  
> MWMO_ALERTABLE );
>>

I can see that msi_dialog_run_message_loop calls  
"MsgWaitForMultipleObjects( 0, NULL, 0, INFINITE, QS_ALLINPUT );"  
which implies that
"WaitForMultipleObjects( 0, NULL, 0, INFINITE, MWMO_ALERTABLE );" can  
be called if precess_events returns FALSE.

I'm pretty sure I saw in gdb some calls with NULL handles to  
WaitForMultipleObjects related to MSI.

Regards,
-- 
Adam Strzelecki |: nanoant.com :|



From ono at java.pl  Sat Mar  1 09:35:16 2008
From: ono at java.pl (Adam Strzelecki)
Date: Sat, 1 Mar 2008 16:35:16 +0100
Subject: kernel32 & winelib: Don't test string size in CompareStringW for
	null	terminated strings
In-Reply-To: <47C83B7A.7080208@codeweavers.com>
References: <8027AB2D-A230-47B0-A07F-76B998446AE6@java.pl>
	<47C83B7A.7080208@codeweavers.com>
Message-ID: <11CF4451-91C9-40AF-BF7E-C2610CEF0A4C@java.pl>

Hello,

> You introduce a lot of complexity into the low-level helper  
> routines. We don't want to put Win32 quirks, like -1 meaning "until  
> the null terminator" being put into the low-level functions unless  
> we have to. In this case, if this is the sole cause of the slowdown  
> then you would be better off caching the length at the MSI level  
> since the strings are bound to be accessed more than once.

My intention was to fix performance of lstrcmpW, or CompareStringW  
with null-terminated strings.
Currently if we try to compare "1st very long string of blah blah blah  
blah blah" with "2nd very long string of blah blah blah blah blah", we  
call non-optimized strlenW (that is simple inline loop with null  
checking) for both of them, which both do all together around 100  
iterations.
While 1 comparison (iteration) is enough to tell the result should be  
-1.
So counting length for both string in CompareStringW just because low- 
lever wine_compare_string expects strings to have always specified  
length is IMHO CPU hog, that makes impact on WINE MSI performance, on  
other components using a lot of string comparing.

> How do you know that the compiler isn't generating the same assembly  
> for the functions as that used by msvcrt / glibc? Theories like  
> these need numbers to back them up.

I know that because those msvcrt or glibc routines are written  
directly in assembler not C and optimized for the 32-bit (or 64-bit)  
data aligning etc, and DWORD fetching. Visual Studio is shipping with  
complete sources of C CRT so you may have a look.

> ;***
> ;strlen.asm - contains strlen() routine
> ;
> ;       Copyright (c) Microsoft Corporation. All rights reserved.
> ;
> ;Purpose:
> ;       strlen returns the length of a null-terminated string,
> ;       not including the null byte itself.
> ;
> ;*******************************************************************************


Probably same thing happens with CompareStringW and lstrlenW of  
kernel, but this time I can't be sure because I don't have the ASM  
sources.

So it has nothing to do with compiler, but care about performance of  
some often used functions and programming habit to reuse existing far  
better optimized low level code than cooking generic one believing  
that GCC will do make it best.

Cheers,
-- 
Adam Strzelecki |: nanoant.com :|



From dank at kegel.com  Sat Mar  1 09:38:36 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 1 Mar 2008 07:38:36 -0800
Subject: kernel32 & winelib: Don't test string size in CompareStringW for
	null terminated strings
Message-ID: <a71bd89a0803010738y65b9e90cve6e222d69adafe37@mail.gmail.com>

Adam Strzelecki wrote:
> Visual Studio is shipping with complete sources of C CRT so you may have a look.
> ;***
> ;strlen.asm - contains strlen() routine
> ;
> ;       Copyright (c) Microsoft Corporation. All rights reserved.

No, we may not have a look!  And we sure as hell can't
post copyrighted Microsoft source code on this mailing list!
- Dan


From ono at java.pl  Sat Mar  1 09:55:12 2008
From: ono at java.pl (Adam Strzelecki)
Date: Sat, 1 Mar 2008 16:55:12 +0100
Subject: kernel32 & winelib: Don't test string size in CompareStringW for
	null terminated strings
In-Reply-To: <a71bd89a0803010738y65b9e90cve6e222d69adafe37@mail.gmail.com>
References: <a71bd89a0803010738y65b9e90cve6e222d69adafe37@mail.gmail.com>
Message-ID: <5FFEB4AF-441F-47FA-87F4-7CE319CAC1D7@java.pl>

> No, we may not have a look!  And we sure as hell can't
> post copyrighted Microsoft source code on this mailing list!
Argh... I meant you may have a look if you have Visual Studio  
installed, I don't intend to post any copyrighted code there, but I  
just post header copyright information from this file to prove that it  
does exist:)
However you can find with Google + "strlen.asm - contains strlen()  
routine" on M$ forums some ppl that wisely did post full source ;P

Regards,
-- 
Adam Strzelecki |: nanoant.com :|



From winehacker at gmail.com  Sat Mar  1 10:12:02 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sat, 1 Mar 2008 11:12:02 -0500
Subject: kernel32 & winelib: Don't test string size in CompareStringW for
	null terminated strings
In-Reply-To: <5FFEB4AF-441F-47FA-87F4-7CE319CAC1D7@java.pl>
References: <a71bd89a0803010738y65b9e90cve6e222d69adafe37@mail.gmail.com>
	<5FFEB4AF-441F-47FA-87F4-7CE319CAC1D7@java.pl>
Message-ID: <19e31a080803010812q2a2e2748ma3dea3412e5dcfe4@mail.gmail.com>

On Sat, Mar 1, 2008 at 10:55 AM, Adam Strzelecki <ono at java.pl> wrote:
> > No, we may not have a look!  And we sure as hell can't
>  > post copyrighted Microsoft source code on this mailing list!
>  Argh... I meant you may have a look if you have Visual Studio
>  installed, I don't intend to post any copyrighted code there, but I
>  just post header copyright information from this file to prove that it
>  does exist:)
>  However you can find with Google + "strlen.asm - contains strlen()
>  routine" on M$ forums some ppl that wisely did post full source ;P

Wine kind of work on the honor system here. If you've looked at the
CRT sources even though they come with the PSDK and MSVC please don't
start implementing those functions. Ditto for ATL. MSVC ships with the
source code for it also but the developers that work on the ATL don't
go digging in to those sources.

Thanks
-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From ono at java.pl  Sat Mar  1 16:02:10 2008
From: ono at java.pl (Adam Strzelecki)
Date: Sat, 1 Mar 2008 23:02:10 +0100
Subject: msi: ACTION_RegisterProduct store all InstallProperties
In-Reply-To: <22821af30803011158g219b93bbq4b660d43d96ffdae@mail.gmail.com>
References: <2D73E93F-4E00-4493-8416-3238546EA3B9@java.pl>
	<22821af30802290939q489b73d9n3c9c106604a49e8c@mail.gmail.com>
	<C467D1FF-9F98-4A2F-869B-E51C31E17A71@java.pl>
	<22821af30803011158g219b93bbq4b660d43d96ffdae@mail.gmail.com>
Message-ID: <1D8C710E-D65D-4E87-865C-9BA7F8747B1F@java.pl>

Hello,

> I think you need to read through the implementation of
> MSI_GetProductInfo more closely and also read the MsiGetProductInfo
> tests in tests/msi.c and the test_publish:RegisterProduct tests in
> tests/install.c.

I think I did, and looking at the tests I see they are testing  
properties only at Uninstall key, and I think this is wrong, or at  
least incomplete, as quoted below:

>     res = RegOpenKeyA(uninstall, prodcode, &prodkey);
>     ok(res == ERROR_SUCCESS, "Expected ERROR_SUCCESS, got %d\n", res);
>
>     CHECK_REG_DWORD(prodkey, "Version", 0x1010001);
>     CHECK_REG_DWORD(prodkey, "VersionMajor", 1);
>     CHECK_REG_DWORD(prodkey, "VersionMinor", 1);
>     CHECK_REG_DWORD(prodkey, "WindowsInstaller", 1);


While MSI_GetProductInfo is reading VersionMajor, VersionMinor, ...  
etc from InstallProperties key (from szInstallProperties_fmt or  
szInstaller_LocalSystemProductCodes_fmt), but NOT from Uninstall key  
as quotes below:

>     if (classes)
>         MSIREG_OpenLocalSystemProductKey(szProduct, &userdata, FALSE);
>     else
>         MSIREG_OpenInstallPropertiesKey(szProduct, &userdata, FALSE);
>
>     if (!lstrcmpW(szAttribute, INSTALLPROPERTY_HELPLINKW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_HELPTELEPHONEW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_INSTALLDATEW) ||
>         !lstrcmpW(szAttribute,  
> INSTALLPROPERTY_INSTALLEDPRODUCTNAMEW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_INSTALLLOCATIONW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_INSTALLSOURCEW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_LOCALPACKAGEW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_PUBLISHERW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_URLINFOABOUTW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_URLUPDATEINFOW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_VERSIONMINORW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_VERSIONMAJORW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_VERSIONSTRINGW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_PRODUCTIDW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_REGCOMPANYW) ||
>         !lstrcmpW(szAttribute, INSTALLPROPERTY_REGOWNERW))
>     {
>         if (!prodkey)
>         {
>             r = ERROR_UNKNOWN_PRODUCT;
>             goto done;
>         }
>
>         if (!userdata)
>             return ERROR_UNKNOWN_PROPERTY;
>
>         if (!lstrcmpW(szAttribute,  
> INSTALLPROPERTY_INSTALLEDPRODUCTNAMEW))
>             szAttribute = display_name;
>         else if (!lstrcmpW(szAttribute,  
> INSTALLPROPERTY_VERSIONSTRINGW))
>             szAttribute = display_version;
>
>         val = msi_reg_get_value(userdata, szAttribute, &type);
>         if (!val)
>             val = empty;
>     }


So it does not find any of those properties in the registry, because  
they're not written there by ACTION_RegisterProduct.
And fixing this is the intention of my patch.

Regards,
-- 
Adam Strzelecki |: nanoant.com :|



From truiken at gmail.com  Sat Mar  1 16:08:57 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 1 Mar 2008 16:08:57 -0600
Subject: msi: ACTION_RegisterProduct store all InstallProperties
In-Reply-To: <1D8C710E-D65D-4E87-865C-9BA7F8747B1F@java.pl>
References: <2D73E93F-4E00-4493-8416-3238546EA3B9@java.pl>
	<22821af30802290939q489b73d9n3c9c106604a49e8c@mail.gmail.com>
	<C467D1FF-9F98-4A2F-869B-E51C31E17A71@java.pl>
	<22821af30803011158g219b93bbq4b660d43d96ffdae@mail.gmail.com>
	<1D8C710E-D65D-4E87-865C-9BA7F8747B1F@java.pl>
Message-ID: <22821af30803011408pee462d1gcfc98723ca7c68ca@mail.gmail.com>

On Sat, Mar 1, 2008 at 4:02 PM, Adam Strzelecki <ono at java.pl> wrote:
> Hello,
>
>
>  > I think you need to read through the implementation of
>  > MSI_GetProductInfo more closely and also read the MsiGetProductInfo
>  > tests in tests/msi.c and the test_publish:RegisterProduct tests in
>  > tests/install.c.
>
>  I think I did, and looking at the tests I see they are testing
>  properties only at Uninstall key, and I think this is wrong, or at
>  least incomplete, as quoted below:
>
>  >     res = RegOpenKeyA(uninstall, prodcode, &prodkey);
>  >     ok(res == ERROR_SUCCESS, "Expected ERROR_SUCCESS, got %d\n", res);
>  >
>  >     CHECK_REG_DWORD(prodkey, "Version", 0x1010001);
>  >     CHECK_REG_DWORD(prodkey, "VersionMajor", 1);
>  >     CHECK_REG_DWORD(prodkey, "VersionMinor", 1);
>  >     CHECK_REG_DWORD(prodkey, "WindowsInstaller", 1);
>
>
>  While MSI_GetProductInfo is reading VersionMajor, VersionMinor, ...
>  etc from InstallProperties key (from szInstallProperties_fmt or
>  szInstaller_LocalSystemProductCodes_fmt), but NOT from Uninstall key
>  as quotes below:
>
>  >     if (classes)
>  >         MSIREG_OpenLocalSystemProductKey(szProduct, &userdata, FALSE);
>  >     else
>  >         MSIREG_OpenInstallPropertiesKey(szProduct, &userdata, FALSE);
>  >
>  >     if (!lstrcmpW(szAttribute, INSTALLPROPERTY_HELPLINKW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_HELPTELEPHONEW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_INSTALLDATEW) ||
>  >         !lstrcmpW(szAttribute,
>  > INSTALLPROPERTY_INSTALLEDPRODUCTNAMEW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_INSTALLLOCATIONW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_INSTALLSOURCEW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_LOCALPACKAGEW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_PUBLISHERW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_URLINFOABOUTW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_URLUPDATEINFOW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_VERSIONMINORW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_VERSIONMAJORW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_VERSIONSTRINGW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_PRODUCTIDW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_REGCOMPANYW) ||
>  >         !lstrcmpW(szAttribute, INSTALLPROPERTY_REGOWNERW))
>  >     {
>  >         if (!prodkey)
>  >         {
>  >             r = ERROR_UNKNOWN_PRODUCT;
>  >             goto done;
>  >         }
>  >
>  >         if (!userdata)
>  >             return ERROR_UNKNOWN_PROPERTY;
>  >
>  >         if (!lstrcmpW(szAttribute,
>  > INSTALLPROPERTY_INSTALLEDPRODUCTNAMEW))
>  >             szAttribute = display_name;
>  >         else if (!lstrcmpW(szAttribute,
>  > INSTALLPROPERTY_VERSIONSTRINGW))
>  >             szAttribute = display_version;
>  >
>  >         val = msi_reg_get_value(userdata, szAttribute, &type);
>  >         if (!val)
>  >             val = empty;
>  >     }
>
>
>  So it does not find any of those properties in the registry, because
>  they're not written there by ACTION_RegisterProduct.
>  And fixing this is the intention of my patch.
>

Which is wrong, which you'll see when I submit my next patch which
tests your theory.

-- 
James Hawkins


From ono at java.pl  Sat Mar  1 16:33:16 2008
From: ono at java.pl (Adam Strzelecki)
Date: Sat, 1 Mar 2008 23:33:16 +0100
Subject: msi: ACTION_RegisterProduct store all InstallProperties
In-Reply-To: <22821af30803011408pee462d1gcfc98723ca7c68ca@mail.gmail.com>
References: <2D73E93F-4E00-4493-8416-3238546EA3B9@java.pl>
	<22821af30802290939q489b73d9n3c9c106604a49e8c@mail.gmail.com>
	<C467D1FF-9F98-4A2F-869B-E51C31E17A71@java.pl>
	<22821af30803011158g219b93bbq4b660d43d96ffdae@mail.gmail.com>
	<1D8C710E-D65D-4E87-865C-9BA7F8747B1F@java.pl>
	<22821af30803011408pee462d1gcfc98723ca7c68ca@mail.gmail.com>
Message-ID: <A00C3432-7B22-4B69-81A5-AB643A2396AE@java.pl>

> Which is wrong, which you'll see when I submit my next patch which
> tests your theory.

I don't mind you pointing me out my mistakes. So I kindly waiting for  
your patch. However right now I presented my arguments quoting Wine  
sources, but you just respond that I'm wrong without presenting yours.

All I can say, I was testing this is MSXML 6.0 + Visual Studio 2005  
installer, and current Wine trunk causes VS2005 installer think that  
MSXML 6.0 is regardless of anything, just because VerionMajor &  
VersionMinor fails on MsiGetProductInfo.
-- 
Adam Strzelecki |: nanoant.com :|



From truiken at gmail.com  Sat Mar  1 16:38:38 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 1 Mar 2008 16:38:38 -0600
Subject: msi: ACTION_RegisterProduct store all InstallProperties
In-Reply-To: <A00C3432-7B22-4B69-81A5-AB643A2396AE@java.pl>
References: <2D73E93F-4E00-4493-8416-3238546EA3B9@java.pl>
	<22821af30802290939q489b73d9n3c9c106604a49e8c@mail.gmail.com>
	<C467D1FF-9F98-4A2F-869B-E51C31E17A71@java.pl>
	<22821af30803011158g219b93bbq4b660d43d96ffdae@mail.gmail.com>
	<1D8C710E-D65D-4E87-865C-9BA7F8747B1F@java.pl>
	<22821af30803011408pee462d1gcfc98723ca7c68ca@mail.gmail.com>
	<A00C3432-7B22-4B69-81A5-AB643A2396AE@java.pl>
Message-ID: <22821af30803011438v2633aa35s2459553825fb375d@mail.gmail.com>

On Sat, Mar 1, 2008 at 4:33 PM, Adam Strzelecki <ono at java.pl> wrote:
> > Which is wrong, which you'll see when I submit my next patch which
>  > tests your theory.
>
>  I don't mind you pointing me out my mistakes. So I kindly waiting for
>  your patch. However right now I presented my arguments quoting Wine
>  sources, but you just respond that I'm wrong without presenting yours.
>
>  All I can say, I was testing this is MSXML 6.0 + Visual Studio 2005
>  installer, and current Wine trunk causes VS2005 installer think that
>  MSXML 6.0 is regardless of anything, just because VerionMajor &
>  VersionMinor fails on MsiGetProductInfo.
>

Have some patience...I *just* wrote the tests, and I'm doing this on a
Saturday.  You'll see them soon enough.

-- 
James Hawkins


From juan.lang at gmail.com  Sat Mar  1 19:07:58 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Sat, 1 Mar 2008 17:07:58 -0800
Subject: iPod synced with iTunes v7.6!
In-Reply-To: <b130c85e0803010055g19782baam34bc7e1301c884ed@mail.gmail.com>
References: <b130c85e0803010055g19782baam34bc7e1301c884ed@mail.gmail.com>
Message-ID: <3a768c550803011707q5dbb1b92m57d76c8d425a511d@mail.gmail.com>

>  I got an ipod I borrowed to sync: http://www.astro.rug.nl/~lankhorst/ipod.png

W00t!  Well done, Maarten!
--Juan


From austinenglish at gmail.com  Sat Mar  1 19:23:04 2008
From: austinenglish at gmail.com (Austin English)
Date: Sat, 1 Mar 2008 19:23:04 -0600
Subject: Any graphics card y'all like to see tests run on?
In-Reply-To: <47C62C2A.4010203@sprintpcs.com>
References: <b6bb06270802261940q5120855al1822b2f4651e8019@mail.gmail.com>
	<558b2f5c0802261955l72dfe40aj616b46b8a79a52f2@mail.gmail.com>
	<b6bb06270802262049j6ae51a21v385707ea0bfc090b@mail.gmail.com>
	<200802270857.56215.stefan@codeweavers.com>
	<47C62C2A.4010203@sprintpcs.com>
Message-ID: <b6bb06270803011723s3677cd1fp136333b447f30ff7@mail.gmail.com>

On Wed, Feb 27, 2008 at 9:36 PM, James McKenzie
<jjmckenzie51 at sprintpcs.com> wrote:
>
> Stefan D?singer wrote:
>  > Am Mittwoch, 27. Februar 2008 05:49:57 schrieb Austin English:
>  >
>  >> Thanks Carl, and to the rest of the list, sorry for the noise/false
>  >> hope to d3d/ddraw guys.
>  >>
>  > Just to answer your previous questions if someone else wonders the same: Some
>  > ATI card would be useful. I have an X1600 and a radeon mobility 9000 myself,
>  > but other cards would be good to test as well. In the codeweavers office we
>  > have a few other cards too(older radeons and a bunch of macs)
>  >
>  >
>  Testing on Macs, especially the newer laptops would be nice :)
>
>  I have a MacBookPro and a MacBook here (the latter is the other person
>  who lives here's.)
>
>  James
>
>
>
>

My roommate has a MacBook pro, so if testing anything specific is
needed, drop me a line.

-Austin

From dmitry at codeweavers.com  Sat Mar  1 22:09:30 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 2 Mar 2008 12:09:30 +0800
Subject: winmm/tests: Don't use 0x55 to avoid any confusion when running
	with+heap.
References: <alpine.DEB.1.00.0803012110480.16709@amboise.dolphin>
Message-ID: <007001c87c1b$3bf91540$a600fea9@DMITRY>

"Francois Gouget" <fgouget at free.fr> wrote:

>     mmioSeek(hmmio, 0, SEEK_SET);
> -    memset(&ck, 0x55, sizeof(ck));
> +    memset(&ck, 0x66, sizeof(ck));
>     ret = mmioDescend(hmmio, &ck, NULL, MMIO_FINDCHUNK);
>     ok(ret == MMIOERR_CHUNKNOTFOUND ||
>        ret == MMIOERR_INVALIDFILE, "mmioDescend returned %u\n", ret);
> @@ -162,7 +162,7 @@ static void test_mmioDescend(void)
>     ok(ck.dwDataOffset != 0x55555555, "wrong dwDataOffset: %04x\n", ck.dwDataOffset);

The 'ok' above (and 2 tests before it) will fail with your changes.

-- 
Dmitry.


From m.b.lankhorst at gmail.com  Sun Mar  2 01:56:48 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sat, 1 Mar 2008 23:56:48 -0800
Subject: mountmgr.sys and ioctl's
Message-ID: <b130c85e0803012356v2887045amb76936b576f0e5a2@mail.gmail.com>

Hi Alexandre,

In irc we discussed ioctl's with devices, and how ioctl's go to
ntdll/cdrom.c if the drive is fd backed, and to mountmgr.sys if it
isn't. For itunes it needs raw disk access, but also an ioctl from
mountmgr.

What if we always map access to \\.\X: is always mapped to mountmgr,
and let mountmanager open \\.\X:: that would be mapped to
/dosdevices/x::, any ioctl, and read/write stuff that mountmgr can't
handle can then be forwarded to the raw device, if available.

Do you think that would be an appropiate solution?

Cheers,
Maarten.


From ono at java.pl  Sun Mar  2 08:10:24 2008
From: ono at java.pl (Adam Strzelecki)
Date: Sun, 2 Mar 2008 15:10:24 +0100
Subject: kernel32 & winelib: Don't test string size in CompareStringW for
	null terminated strings
In-Reply-To: <19e31a080803010812q2a2e2748ma3dea3412e5dcfe4@mail.gmail.com>
References: <a71bd89a0803010738y65b9e90cve6e222d69adafe37@mail.gmail.com>
	<5FFEB4AF-441F-47FA-87F4-7CE319CAC1D7@java.pl>
	<19e31a080803010812q2a2e2748ma3dea3412e5dcfe4@mail.gmail.com>
Message-ID: <1E8FD512-6B85-4093-A474-FF91FB48010E@java.pl>

I believe the further discussion is pointless. If you ever dared to  
look how MSVCRT or GLIBC strlen function is implemented you would know  
that it is exactly same algorithm (that just differs in the  
implementation) using 4 byte fetching with magic bits matching, also  
described in few books and articles, let me name one: "Write Great  
Code, Volume 2: Thinking Low-Level, Writing High-Level" ISBN  
1593270658, section 10.1.1.1 about using string manipulation routines,  
so there's nothing about Microsoft's or anybody's else secret invention.

However instead of decent discussion I was pushed aside and then  
taught here not to copy copyrighted materials, so something that I'm  
already very aware and careful about. IMHO this overwhelming paranoia  
of being scared of Microsoft is against sober thinking, and this for  
sure glads greediness of this company. My mistake was I just mentioned  
MSVCRT, that raised your disquiet, while I could point you to GLIBC or  
Linux kernel sources as well, or the book above. Too bad.

To be clear, my only intention was to point you that Wine's  
CompareStringW can be better. IMHO it is very respectable to not only  
write code that is well organized and bug-free that Wine is in my  
opinion, but also to write performance aware code, which IMHO Wine is  
NOT.

Finally I just want to point you there:
http://www.ussg.iu.edu/hypermail/linux/kernel/9907.3/0434.html

Note there that Linux kernel mailing list is bit less paranoiac :P

Cheers,
-- 
Adam Strzelecki |: nanoant.com :|



From dmitry at codeweavers.com  Sun Mar  2 09:26:02 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 2 Mar 2008 23:26:02 +0800
Subject: kernel32 & winelib: Don't test string size in CompareStringW
	fornull terminated strings
References: <a71bd89a0803010738y65b9e90cve6e222d69adafe37@mail.gmail.com><5FFEB4AF-441F-47FA-87F4-7CE319CAC1D7@java.pl><19e31a080803010812q2a2e2748ma3dea3412e5dcfe4@mail.gmail.com>
	<1E8FD512-6B85-4093-A474-FF91FB48010E@java.pl>
Message-ID: <009a01c87c79$bb3d4160$a600fea9@DMITRY>

"Adam Strzelecki" <ono at java.pl> wrote:

> I believe the further discussion is pointless. If you ever dared to  
> look how MSVCRT or GLIBC strlen function is implemented you would know  
> that it is exactly same algorithm (that just differs in the  
> implementation) using 4 byte fetching with magic bits matching, also  
> described in few books and articles, let me name one: "Write Great  
> Code, Volume 2: Thinking Low-Level, Writing High-Level" ISBN  
> 1593270658, section 10.1.1.1 about using string manipulation routines,  
> so there's nothing about Microsoft's or anybody's else secret invention.

Wine already had at some point strlen along with some other string functions
implemented in asm, however they have been removed after it was proved that
gcc optimized C code outperforms it.

> To be clear, my only intention was to point you that Wine's  
> CompareStringW can be better. IMHO it is very respectable to not only  
> write code that is well organized and bug-free that Wine is in my  
> opinion, but also to write performance aware code, which IMHO Wine is  
> NOT.

You are welcome to show the results of the benchmark which show how much
your patch improves performance.

-- 
Dmitry.


From dank at kegel.com  Sun Mar  2 10:44:43 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 2 Mar 2008 08:44:43 -0800
Subject: winmm/tests: Don't use 0x55 to avoid any confusion when running
	with +heap.
Message-ID: <a71bd89a0803020844u74ba2303mf7854d5f8bb14b0b@mail.gmail.com>

Hey, on that topic, there are also a bunch of other possible suspects:

./dlls/ntdll/tests/atom.c:    memset(abi->Name, 0x55, 255 * sizeof(WCHAR));
./dlls/ntdll/tests/atom.c:    memset(abi->Name, 0x55,
lstrlenW(testAtom1) * sizeof(WCHAR));
./dlls/user32/tests/menu.c:    memset( bmfill, 0x55, sizeof( bmfill));
./dlls/ntoskrnl.exe/ntoskrnl.c:    memset( &irp, 0x55, sizeof(irp) );
./tools/wrc/utils.c:    memset(res, 0x55, size);
./tools/widl/utils.c:    memset(res, 0x55, size);
./tools/wmc/utils.c:    memset(res, 0x55, size);
./server/object.c:    if (ptr) memset( ptr, 0x55, size );
./server/window.c:    memset( win, 0x55, sizeof(*win) +
win->nb_extra_bytes - 1 );

And 0xaa can also interfere:

./dlls/kernel32/tests/process.c:    memset(&info, 0xaa, sizeof(info));
./dlls/ddraw/tests/d3d.c:    memset(outH, 0xaa, sizeof(outH));
./dlls/comctl32/tests/listview.c:    memset(&column, 0xaa, sizeof(column));
./dlls/comctl32/tests/listview.c:    memset(&item, 0xaa, sizeof (item));
./dlls/comctl32/tests/listview.c:    memset (&item, 0xaa, sizeof (item));
./dlls/comctl32/tests/listview.c:    memset (&item, 0xaa, sizeof (item));
./dlls/comctl32/tests/listview.c:    memset (&item, 0xaa, sizeof (item));
./dlls/comctl32/tests/listview.c:    memset (&item, 0xaa, sizeof (item));
./dlls/comctl32/tests/listview.c:    memset (&item, 0xaa, sizeof (item));
./dlls/comctl32/tests/listview.c:    memset (&item, 0xaa, sizeof (item));
./dlls/comctl32/tests/listview.c:    memset (&item, 0xaa, sizeof (item));
./dlls/comctl32/tests/listview.c:    memset (&item, 0xaa, sizeof (item));
./dlls/comctl32/tests/listview.c:    memset(&column, 0xaa, sizeof(column));
./server/object.c:        memset( obj, 0xaa, obj->ops->size );


From dmitry at codeweavers.com  Sun Mar  2 10:55:19 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 3 Mar 2008 00:55:19 +0800
Subject: winmm/tests: Don't use 0x55 to avoid any confusion when
	runningwith +heap.
References: <a71bd89a0803020844u74ba2303mf7854d5f8bb14b0b@mail.gmail.com>
Message-ID: <001c01c87c86$34154450$a600fea9@DMITRY>

"Dan Kegel" <dank at kegel.com> wrote:

> Hey, on that topic, there are also a bunch of other possible suspects:
> 
> ./dlls/ntdll/tests/atom.c:    memset(abi->Name, 0x55, 255 * sizeof(WCHAR));
> ./dlls/ntdll/tests/atom.c:    memset(abi->Name, 0x55,
> lstrlenW(testAtom1) * sizeof(WCHAR));
> ./dlls/user32/tests/menu.c:    memset( bmfill, 0x55, sizeof( bmfill));
> ./dlls/ntoskrnl.exe/ntoskrnl.c:    memset( &irp, 0x55, sizeof(irp) );
> ./tools/wrc/utils.c:    memset(res, 0x55, size);
> ./tools/widl/utils.c:    memset(res, 0x55, size);
> ./tools/wmc/utils.c:    memset(res, 0x55, size);
> ./server/object.c:    if (ptr) memset( ptr, 0x55, size );
> ./server/window.c:    memset( win, 0x55, sizeof(*win) +
> win->nb_extra_bytes - 1 );
> 
> And 0xaa can also interfere:

Perhaps we could agree on a common constant to mark not initialized data in
tests? I'd suggest to use 0xCC (standard debugging trick) for that purpose.

-- 
Dmitry.


From ono at java.pl  Sun Mar  2 10:59:21 2008
From: ono at java.pl (Adam Strzelecki)
Date: Sun, 2 Mar 2008 17:59:21 +0100
Subject: kernel32 & winelib: Don't test string size in CompareStringW
	fornull terminated strings
In-Reply-To: <009a01c87c79$bb3d4160$a600fea9@DMITRY>
References: <a71bd89a0803010738y65b9e90cve6e222d69adafe37@mail.gmail.com><5FFEB4AF-441F-47FA-87F4-7CE319CAC1D7@java.pl><19e31a080803010812q2a2e2748ma3dea3412e5dcfe4@mail.gmail.com>
	<1E8FD512-6B85-4093-A474-FF91FB48010E@java.pl>
	<009a01c87c79$bb3d4160$a600fea9@DMITRY>
Message-ID: <533A2C2F-F929-4E69-B543-F168CE902BD8@java.pl>

> Wine already had at some point strlen along with some other string  
> functions
> implemented in asm, however they have been removed after it was  
> proved that
> gcc optimized C code outperforms it.

Let me ask this way, why Wine don't use standard C library functions  
for lstringsomething kernel32 implementation? Current GLIBC, OSX LIBC  
are Unicode libraries since quite long time. Is Wine supposed to work  
on platforms where wchar_t is unimplemented or differs from unsigned  
short? Anyway AFAIK Wine is only Intel (LittleEndian) 32-bit.
So why Wine does re-implement all the string manipulation functions  
that are already present in C runtimes (heavily optimized for GCC and  
OS).
I know that some of Windows functions differ, but Wine may keep just  
the implementation of those that differ? What do you think?

> You are welcome to show the results of the benchmark which show how  
> much
> your patch improves performance.

Please have a look at my patch, is just an easiest try to remove IMHO  
unnecessary requirement to count null-terminated string lengths before  
comparison, as most of comparisons are made with null-terminated  
strings (-1 length).

I don't want anyone to accept my patch straight-ahead, but just to  
review this string manipulation matter in Wine.
Probably the best way it would be to have CompareStringW having to  
versions (function branches), one for 2 null-terminated params (most  
of cases), 2nd for one, or two strings with named length.

Regards,
-- 
Adam Strzelecki |: nanoant.com :|



From ono at java.pl  Sun Mar  2 11:14:45 2008
From: ono at java.pl (Adam Strzelecki)
Date: Sun, 2 Mar 2008 18:14:45 +0100
Subject: winequartz.drv Mac OS X UI discontinued?
Message-ID: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>

Hi,

I know that CodeWeavers supports quite nicely Mac builds of Wine, and  
CrossOver for Mac, yet all of them are X11.
There was also once Darwine - an effort to provide Carbon Wine UI  
driver and Mac optimizations & L&F.
Pretty many of those were merged back to Wine, but not winequartz.drv.

Do you guys think about reviving winequartz.drv?

This would greatly improve Wine on Mac as we could have native Mac  
fonts handling that's faster than FreeType, Dock icons for Wine  
applications, and few others.
There's still old copy of the it hanging around, but it is abandoned,  
and no longer compiles with Wine.

Or I think it would be cool to write new winecocoa.drv or sthing like  
that, as Apple officially states that Carbon is deprecated.

While it is not well documented, it is pretty easy with Cocoa to make  
console non-bundled process to be UI foreground process and handle  
events and Dock:
(This code is copyrighted by myself ;P)

> int main(int argc, const char * argv[]) {
>         ProcessSerialNumber psn = {0, kCurrentProcess};
>         OSStatus returnCode = TransformProcessType(&psn,  
> kProcessTransformToForegroundApplication);
>         SetFrontProcess(&psn);
>
>         NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
>         [NSApplication sharedApplication];
>
>         NSImage *icon = [NSImage imageNamed:@"NSApplicationIcon"];
>         [NSApp setApplicationIconImage:icon];
>
>         [NSApp finishLaunching];
>
>         NSWindow *window = [[NSWindow alloc]  
> initWithContentRect:NSMakeRect(0, 0, 100, 100)
>                         styleMask:NSTitledWindowMask| 
> NSClosableWindowMask|NSMiniaturizableWindowMask|NSResizableWindowMask
>                         backing:NSBackingStoreBuffered defer:NO];
>         [window center];
>         [window setTitle:@"Test"];
>
>         NSButton *button = [[NSButton alloc]  
> initWithFrame:NSMakeRect(10, 10, 80, 80)];
>         [button setTitle:@"What?"];
>         [button setBezelStyle:1];
>         [[window contentView] addSubview:button];
>         [button release];
>
>         [window makeKeyAndOrderFront:NSApp];
>
>         while(1) {
>                 NSEvent *event = [NSApp  
> nextEventMatchingMask:NSAnyEventMask
>                                                                                         untilDate 
> :[NSDate distantFuture]
>                                                                                         inMode:NSDefaultRunLoopMode
>                                                                                         dequeue:YES 
> ];
>                 if(event) [NSApp sendEvent:event];
>         }
>         [pool release];
>         return 0;
> }

BTW. I heard that someone previously working for Wine project is now  
in Apple, it is true?

Regards,
-- 
Adam Strzelecki |: nanoant.com :|



From stefan at codeweavers.com  Sun Mar  2 11:50:02 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 2 Mar 2008 18:50:02 +0100
Subject: winequartz.drv Mac OS X UI discontinued?
In-Reply-To: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>
Message-ID: <200803021850.04583.stefan@codeweavers.com>

Am Sonntag, 2. M?rz 2008 18:14:45 schrieb Adam Strzelecki:
> I know that CodeWeavers supports quite nicely Mac builds of Wine, and
> CrossOver for Mac, yet all of them are X11.
> There was also once Darwine - an effort to provide Carbon Wine UI
> driver and Mac optimizations & L&F.
> Pretty many of those were merged back to Wine, but not winequartz.drv.
>
> Do you guys think about reviving winequartz.drv?
I think everyone would greatly welcome efforts to continue it, and in fact 
Steven Edwards is currently trying to bring the old driver up to date.

So the short answer: We accept (well written) patches!

The long answer: This isn't an easy undertaking. For one part, Wine's display 
driver model(how gdi32, user32, opengl32 and d3d talk to winex11.drv) still 
needs a bit of cleanup, currently some abstraction layers are at the wrong 
place. The other issue is that *a lot* of implicit knowledge is encoded in 
winex11.drv. To add to this, the gain of a native quartz/cocoa/whatever 
driver is rather limited:

* Faster font handling: Maybe, although I personally never had an app that had 
font performance problems. My view is rather limited though
* Dock integration: Crossover has that, despite using winex11.drv. This is an 
entirely different story and comes down to the different ideas what 
an "Application" is at user interface level.

What we would gain:
* No mess with X11 servers. Apple's X11 is rather broken. No Expos? 
headbanging with quartz_wm. No messing with Apple X11's opengl
* No need for a DIB engine on MacOS. MacOS can give us everything we need.
* No troubles with relative mouse movements, like we have them on X11 even on 
Linux
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080302/83dc4391/attachment.pgp 

From wine-devel at kievinfo.com  Sun Mar  2 12:10:52 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 02 Mar 2008 11:10:52 -0700
Subject: kernel32 & winelib: Don't test string size in
	CompareStringWfornull terminated strings
In-Reply-To: <533A2C2F-F929-4E69-B543-F168CE902BD8@java.pl>
References: <a71bd89a0803010738y65b9e90cve6e222d69adafe37@mail.gmail.com><5FFEB4AF-441F-47FA-87F4-7CE319CAC1D7@java.pl><19e31a080803010812q2a2e2748ma3dea3412e5dcfe4@mail.gmail.com>	<1E8FD512-6B85-4093-A474-FF91FB48010E@java.pl>	<009a01c87c79$bb3d4160$a600fea9@DMITRY>
	<533A2C2F-F929-4E69-B543-F168CE902BD8@java.pl>
Message-ID: <47CAEDAC.5030307@kievinfo.com>

Adam Strzelecki wrote:
> Let me ask this way, why Wine don't use standard C library functions  
> for lstringsomething kernel32 implementation? Current GLIBC, OSX LIBC  
> are Unicode libraries since quite long time. Is Wine supposed to work  
> on platforms where wchar_t is unimplemented or differs from unsigned  
WCHAR is not the same as wchar_t.

> short? Anyway AFAIK Wine is only Intel (LittleEndian) 32-bit.
Wrong, it compiles and works (for winelib) on SUN.

Vitaliy


From winehacker at gmail.com  Sun Mar  2 12:53:31 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 2 Mar 2008 13:53:31 -0500
Subject: winequartz.drv Mac OS X UI discontinued?
In-Reply-To: <200803021850.04583.stefan@codeweavers.com>
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>
	<200803021850.04583.stefan@codeweavers.com>
Message-ID: <19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>

Hi,

On Sun, Mar 2, 2008 at 12:50 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Sonntag, 2. M?rz 2008 18:14:45 schrieb Adam Strzelecki:
>  > Do you guys think about reviving winequartz.drv?
>  I think everyone would greatly welcome efforts to continue it, and in fact
>  Steven Edwards is currently trying to bring the old driver up to date.

There is a public branch where the Wine quartzdrv will go even if its
not accepted in to Winehq. I have been from time to time bringing in
infrastructure changes from the old winequartzdrv however the current
tree is empty as the developer of the prior editions, Emmanuel
Maillard,  is in the process of overhauling it from recent changes to
the Wine driver model.

Keep an eye on

http://wiki.winehq.org/MacOSX/QuartzDriver

And hopefully in the next few weeks we will have a newer patch in the
winequartzdrv tree for a more recent version of Wine. I am not sure
what design changes Emmanuel is wanting to make but hopefully they
will be more to Alexandre's liking and can eventually go in to normal
winehq. If you want to work on quartzdrv with Emmanuel, send him an
email to get an idea of what he needs and what the design will be,
then apply for write access to http://repo.or.cz and I will add you to
the winequartzdrv branch.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From stefan at codeweavers.com  Sun Mar  2 13:52:34 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Sun, 2 Mar 2008 20:52:34 +0100
Subject: Heading towards a fixed function pipeline replacement
Message-ID: <200803022052.40028.stefan@codeweavers.com>

Hi,

Due to the bad weather I had some spare hacking time this weekend, and I've 
done some work and investigation on a fixed function pipeline replacement. 
The product of that is a hacky fixed function pipeline replacement via 
GL_ATI_fragment_shader(*).

Functionality wise the code is doing pretty good, it should support everything 
the current GL_ARB_texture_env_combine supports on ATI cards, although I 
didn't test it much yet and it is most likely buggy. However, 
integration-wise it is a disaster at this point, as I've focused on the GL 
functionality for now.

However, I have some roadmap for integrating this in Wine now. Essentially I'm 
going to modify the state table and shader backends a bit:

-> Make the state table a property of the shader model: Each pipeline 
implementation has its own state dependencies and ways to load states, so it 
is pointless to use one static table. The table will remain static, but there 
will be multiple tables, selected at device creation time

-> As a consequence, make the current "none" shader backend a backend for the 
current fixed function state table

-> Different state implementations will be able to borrow code from each 
other. E.g, the ATI_fragment_shader backend can borrow vertex processing from 
the fixed function implementation or GL_ARB_*_program

-> The current "fixed function" state table will still be able to handle d3d 
shaders of all kinds, at least for now. Somewhen later we might want to split 
fixed function and shaders up, so that whenever we have shaders we use them 
for fixed function processing too. But for now we still have the problem that 
e.g. GLSL has horribly slow shader compilation performance.

On top of this work the mentioned SoC project to write a vertex shader 
replacement pipeline might be doable because the general infrastructure is 
there, and only the shader generator is needed.

Feel free to comment,
Stefan

(*) Why this odd extension and not GLSL? We'll want it at some point anyway 
for better support of r200 cards(radeon 8500-9250), and as a counterpart to 
the GL_NV_register_combiner code on nvidia cards. GLSL has a few other tricky 
aspects, like per shader uniforms, so this extension is easier for the start.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0032-WineD3D-Add-GL_ATI_fragment_shader.patch
Type: text/x-diff
Size: 9680 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080302/75b36fa5/attachment-0001.patch 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0033-WineD3D-Fixed-function-fragment-processing-with-GL_.patch.bz2
Type: application/x-bzip2
Size: 7600 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080302/75b36fa5/attachment-0001.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080302/75b36fa5/attachment-0001.pgp 

From ono at java.pl  Sun Mar  2 14:53:09 2008
From: ono at java.pl (Adam Strzelecki)
Date: Sun, 2 Mar 2008 21:53:09 +0100
Subject: kernel32 & winelib: Don't test string size in
	CompareStringWfornull terminated strings
In-Reply-To: <47CAEDAC.5030307@kievinfo.com>
References: <a71bd89a0803010738y65b9e90cve6e222d69adafe37@mail.gmail.com><5FFEB4AF-441F-47FA-87F4-7CE319CAC1D7@java.pl><19e31a080803010812q2a2e2748ma3dea3412e5dcfe4@mail.gmail.com>	<1E8FD512-6B85-4093-A474-FF91FB48010E@java.pl>	<009a01c87c79$bb3d4160$a600fea9@DMITRY>
	<533A2C2F-F929-4E69-B543-F168CE902BD8@java.pl>
	<47CAEDAC.5030307@kievinfo.com>
Message-ID: <95229BD5-0E7D-484E-A15F-DCD74D538B11@java.pl>

>> Let me ask this way, why Wine don't use standard C library functions
>> for lstringsomething kernel32 implementation? Current GLIBC, OSX LIBC
>> are Unicode libraries since quite long time. Is Wine supposed to work
>> on platforms where wchar_t is unimplemented or differs from unsigned
> WCHAR is not the same as wchar_t.
You're right, it is means the same only in Windows.
I just checked several discussions already done on this subject, now I  
know that Windows 16-bit UNICODE isn't compatible with UNIX 32-bit one.
Someone have mentioned in old Wine dev list archives also -fshort- 
wchar GCC flag solution, but it seems this makes C library's UNICODE  
function not work at all as expected. Nice to learn something new.

> Wrong, it compiles and works (for winelib) on SUN.
Good to know.

Cheers,
-- 
Adam Strzelecki |: nanoant.com :|



From ono at java.pl  Sun Mar  2 15:00:31 2008
From: ono at java.pl (Adam Strzelecki)
Date: Sun, 2 Mar 2008 22:00:31 +0100
Subject: winequartz.drv Mac OS X UI discontinued?
In-Reply-To: <19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>
	<200803021850.04583.stefan@codeweavers.com>
	<19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>
Message-ID: <C6F397EE-31F0-43F8-837A-712D5ED29DBE@java.pl>

> Keep an eye on
> http://wiki.winehq.org/MacOSX/QuartzDriver

Oh, that's awesome! How did I missed this.

> And hopefully in the next few weeks we will have a newer patch in the
> winequartzdrv tree for a more recent version of Wine. I am not sure
> what design changes Emmanuel is wanting to make but hopefully they
> will be more to Alexandre's liking and can eventually go in to normal
> winehq. If you want to work on quartzdrv with Emmanuel, send him an
> email to get an idea of what he needs and what the design will be,
> then apply for write access to http://repo.or.cz and I will add you to
> the winequartzdrv branch.

There're very neat Wine Mac builds made on http://www.kronenberg.org/darwine/
Do you have contact with the maintainer? I believe you can work out  
great Mac distro together especially once quartz is ready.

Cheers,
-- 
Adam Strzelecki |: nanoant.com :|



From ono at java.pl  Sun Mar  2 15:13:55 2008
From: ono at java.pl (Adam Strzelecki)
Date: Sun, 2 Mar 2008 22:13:55 +0100
Subject: winequartz.drv Mac OS X UI discontinued?
In-Reply-To: <C6F397EE-31F0-43F8-837A-712D5ED29DBE@java.pl>
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>
	<200803021850.04583.stefan@codeweavers.com>
	<19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>
	<C6F397EE-31F0-43F8-837A-712D5ED29DBE@java.pl>
Message-ID: <E8677747-DE7A-4E00-99AD-50815A863529@java.pl>

>> Keep an eye on
>> http://wiki.winehq.org/MacOSX/QuartzDriver
>
> Oh, that's awesome! How did I missed this.
I know, I didn't looked there for over month, and it was recently  
updated.
I keep my fingers crossed for QuartzDriver!

Good night,
-- 
Adam Strzelecki |: nanoant.com :|



From fgouget at free.fr  Sun Mar  2 17:28:59 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 3 Mar 2008 00:28:59 +0100 (CET)
Subject: winmm/tests: Don't use 0x55 to avoid any confusion when running
	with +heap.
In-Reply-To: <a71bd89a0803020844u74ba2303mf7854d5f8bb14b0b@mail.gmail.com>
References: <a71bd89a0803020844u74ba2303mf7854d5f8bb14b0b@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0803030027080.8380@amboise.dolphin>

On Sun, 2 Mar 2008, Dan Kegel wrote:

> Hey, on that topic, there are also a bunch of other possible suspects:
> 
> ./dlls/ntdll/tests/atom.c:    memset(abi->Name, 0x55, 255 * sizeof(WCHAR));
> ./dlls/ntdll/tests/atom.c:    memset(abi->Name, 0x55,
[...]
> And 0xaa can also interfere:
> 
> ./dlls/kernel32/tests/process.c:    memset(&info, 0xaa, sizeof(info));
[...]

Yes. I have a few other patches (though not for all of them) but I was 
waiting to see if this one would go through before flooding 
wine-patches.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                     Avoid the Gates of Hell - use Linux.


From fgouget at free.fr  Sun Mar  2 17:32:49 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 3 Mar 2008 00:32:49 +0100 (CET)
Subject: winmm/tests: Don't use 0x55 to avoid any confusion when
	runningwith +heap.
In-Reply-To: <001c01c87c86$34154450$a600fea9@DMITRY>
References: <a71bd89a0803020844u74ba2303mf7854d5f8bb14b0b@mail.gmail.com>
	<001c01c87c86$34154450$a600fea9@DMITRY>
Message-ID: <alpine.DEB.1.00.0803030029060.8380@amboise.dolphin>

On Mon, 3 Mar 2008, Dmitry Timoshkov wrote:
[...]
> Perhaps we could agree on a common constant to mark not initialized data in
> tests? I'd suggest to use 0xCC (standard debugging trick) for that purpose.

I'm open to suggestions. So 0xcc is commonly used for this purpose? 
If it's used by debuggers wouldn't this be a reason to avoid it?

If I remember correctly a couple of tests need two values and use both 
0x55 and 0xaa. Do you have another constant to suggest for this case?

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
The nice thing about meditation is that it makes doing nothing quite respectable
                                  -- Paul Dean


From dank at kegel.com  Sun Mar  2 20:32:55 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 2 Mar 2008 18:32:55 -0800
Subject: Free apps bundled with msvcp71?
Message-ID: <a71bd89a0803021832m1a3ffda2m5402cf57f2264572@mail.gmail.com>

Adobe Contribute 4, released in Nov 2006 or so, had a nice online trial at
http://trials.adobe.com/Applications/Contribute/Adobe_Contribute_4_Win/Adobe_Contribute_4_Win.exe
and still online, I think, at
http://www.soft32.com/download/63-129953-1/Adobe_Contribute_4_Win.exe

Starting it fails with

err:module:import_dll Library MSVCP71.dll (which is needed by
L"C:\\Program Files\\Adobe\\Contribute 4\\CoreTypes.dll") not found

Wine has a nice implementation of msvcr71.dll, but not
the C++-oriented msvcp71.dll, nor is it likely to get one soon.

This brings back the question: what's a good place to
legally and freely download an application bundled with a full set
of msvcp71.dll et al?  Ideally something at Microsoft.com
and/or something small and suitable for use in winetricks.
Any ideas?
- Dan


From dmitry at codeweavers.com  Sun Mar  2 21:00:48 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 3 Mar 2008 11:00:48 +0800
Subject: winequartz.drv Mac OS X UI discontinued?
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl><200803021850.04583.stefan@codeweavers.com><19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>
	<C6F397EE-31F0-43F8-837A-712D5ED29DBE@java.pl>
Message-ID: <003101c87cda$c9ceb0e0$a600fea9@DMITRY>

"Adam Strzelecki" <ono at java.pl> wrote:

> There're very neat Wine Mac builds made on http://www.kronenberg.org/darwine/
> Do you have contact with the maintainer? I believe you can work out  
> great Mac distro together especially once quartz is ready.

"Neat" is what sense? It's not clear what additional functionality they provide,
what's the status of quartz.drv in their sources, and why they don't send patches
to WineHQ. Besides that sites claims that "Darwine and wine are released under
the gpl", that's plain wrong.

Could you please remove the "Reply-To:" header when posting to Wine lists?

-- 
Dmitry.


From dmitry at codeweavers.com  Sun Mar  2 21:24:04 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 3 Mar 2008 11:24:04 +0800
Subject: winequartz.drv Mac OS X UI discontinued?
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl><200803021850.04583.stefan@codeweavers.com><19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com><C6F397EE-31F0-43F8-837A-712D5ED29DBE@java.pl>
	<003101c87cda$c9ceb0e0$a600fea9@DMITRY>
Message-ID: <00d101c87cde$0b00b9c0$a600fea9@DMITRY>

"Dmitry Timoshkov" dmitry at codeweavers.com wrote:

>> There're very neat Wine Mac builds made on http://www.kronenberg.org/darwine/
>> Do you have contact with the maintainer? I believe you can work out  
>> great Mac distro together especially once quartz is ready.
> 
> "Neat" is what sense? It's not clear what additional functionality they provide,
> what's the status of quartz.drv in their sources, and why they don't send patches
> to WineHQ.

The following notice in the upper right corner on that site makes it clear why :-)

"Bevore You install, please make sure:
Tiger users: install X11 from your Tiger Installation DVD"

-- 
Dmitry.


From winehacker at gmail.com  Sun Mar  2 21:26:19 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 2 Mar 2008 22:26:19 -0500
Subject: winequartz.drv Mac OS X UI discontinued?
In-Reply-To: <003101c87cda$c9ceb0e0$a600fea9@DMITRY>
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>
	<200803021850.04583.stefan@codeweavers.com>
	<19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>
	<C6F397EE-31F0-43F8-837A-712D5ED29DBE@java.pl>
	<003101c87cda$c9ceb0e0$a600fea9@DMITRY>
Message-ID: <19e31a080803021926q75b327d9n9e628cce63d3b3a3@mail.gmail.com>

On Sun, Mar 2, 2008 at 10:00 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
>  "Neat" is what sense? It's not clear what additional functionality they provide,
>  what's the status of quartz.drv in their sources, and why they don't send patches
>  to WineHQ. Besides that sites claims that "Darwine and wine are released under
>  the gpl", that's plain wrong.
>
>  Could you please remove the "Reply-To:" header when posting to Wine lists?

Dude chill with the hostility. Winehq currently provides no
functionality for Mac users...see here

http://www.winehq.org/site/download

No one is currently offering officially blessed Winehq builds whenever
Alexandre tags a release. There is no need in anyone to send patches
to Winehq for code that we know Julliard is going to reject. He stated
it to us during the Mac discussion at Wineconf in Redding that he
viewed Darwine as a separate project and should do its only bundling.
Basically anything done in Objective C he does not want in the tree
which includes half of the current winequartzdrv, the Darwine launcher
and Doc code and just about everything else.

If you want to review a patch, look at the patch for 0.9.48

http://sourceforge.net/tracker/?group_id=69890&atid=526089

And help further abstract user32/x11drv like has been done for Window
creation and Window positioning.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sun Mar  2 21:45:48 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 3 Mar 2008 11:45:48 +0800
Subject: winequartz.drv Mac OS X UI discontinued?
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl><200803021850.04583.stefan@codeweavers.com><19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com><C6F397EE-31F0-43F8-837A-712D5ED29DBE@java.pl><003101c87cda$c9ceb0e0$a600fea9@DMITRY>
	<19e31a080803021926q75b327d9n9e628cce63d3b3a3@mail.gmail.com>
Message-ID: <014b01c87ce1$13395770$a600fea9@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> On Sun, Mar 2, 2008 at 10:00 PM, Dmitry Timoshkov
> <dmitry at codeweavers.com> wrote:
>>  "Neat" is what sense? It's not clear what additional functionality they provide,
>>  what's the status of quartz.drv in their sources, and why they don't send patches
>>  to WineHQ. Besides that sites claims that "Darwine and wine are released under
>>  the gpl", that's plain wrong.
>>
>>  Could you please remove the "Reply-To:" header when posting to Wine lists?
> 
> Dude chill with the hostility.

I have no idea why you're treating asking the questions as a "hostility".
This is the developers list, not the list for user complaints. Sending
the patches is a usual activity here, not vague reasoning.

> Winehq currently provides no
> functionality for Mac users...see here
> 
> http://www.winehq.org/site/download
> 
> No one is currently offering officially blessed Winehq builds whenever
> Alexandre tags a release.

Feel free to provide/suggest one.

> There is no need in anyone to send patches
> to Winehq for code that we know Julliard is going to reject. He stated
> it to us during the Mac discussion at Wineconf in Redding that he
> viewed Darwine as a separate project and should do its only bundling.
> Basically anything done in Objective C he does not want in the tree
> which includes half of the current winequartzdrv, the Darwine launcher
> and Doc code and just about everything else.
> 
> If you want to review a patch, look at the patch for 0.9.48
> 
> http://sourceforge.net/tracker/?group_id=69890&atid=526089
> 
> And help further abstract user32/x11drv like has been done for Window
> creation and Window positioning.

Aren't you supposed to work on that according to http://wiki.winehq.org/MacOSX/QuartzDriver?

Looks like you overreacted, http://www.kronenberg.org/darwine/ has nothing
to do with darwine except using its name.

-- 
Dmitry.


From jjmckenzie51 at sprintpcs.com  Sun Mar  2 22:13:42 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sun, 02 Mar 2008 21:13:42 -0700
Subject: winequartz.drv Mac OS X UI discontinued?
In-Reply-To: <014b01c87ce1$13395770$a600fea9@DMITRY>
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>
	<200803021850.04583.stefan@codeweavers.com>
	<19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>
	<C6F397EE-31F0-43F8-837A-712D5ED29DBE@java.pl>
	<003101c87cda$c9ceb0e0$a600fea9@DMITRY>
	<19e31a080803021926q75b327d9n9e628cce63d3b3a3@mail.gmail.com>
	<014b01c87ce1$13395770$a600fea9@DMITRY>
Message-ID: <47CB7AF6.6070703@sprintpcs.com>

Dmitry Timoshkov wrote:
> Looks like you overreacted, http://www.kronenberg.org/darwine/ has nothing
> to do with darwine except using its name.
>
>   
Actually, I have Mike's code and it uses the Darwine build system and 
applies two patches to it.  One brings in FontForge so that Apple Native 
fonts will work in Wine, and this is discussed on the Building Wine for 
MacOSX web page.  The other fixes a known problem for Leopard's handling 
of screen location (it does not always use :0.0 for security 
reasons).    I will suggest that he bring back into the Darwine project 
his fixes.   I think he already has tried but received no response from 
the Project.

As to the rest, AJ has stated, repeatedly, that he wants no Obj-C in the 
Wine tree.  This prevents bringing in some Mac specific code, and 
completely eliminates the winequartz.drv project.  I'm not going to 
argue with his reasoning, but this forces a Native version of Wine to be 
a continuous fork with fixes in Wine requiring fixes (if winex11.drv is 
changed) in the code.

As to support for the Mac, I have been doing what some Mac users are 
doing now:  Building my own.  Unfortunately, I do not have a place to 
put my builds where the public can download them.  Also, they contain 
code that has not been approved for the main Wine build and may contain 
'dangerous' code.  I'm willing to risk my system's stability to test, 
but not others.

James McKenzie



From winehacker at gmail.com  Sun Mar  2 22:47:53 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 2 Mar 2008 23:47:53 -0500
Subject: winequartz.drv Mac OS X UI discontinued?
In-Reply-To: <014b01c87ce1$13395770$a600fea9@DMITRY>
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>
	<200803021850.04583.stefan@codeweavers.com>
	<19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>
	<C6F397EE-31F0-43F8-837A-712D5ED29DBE@java.pl>
	<003101c87cda$c9ceb0e0$a600fea9@DMITRY>
	<19e31a080803021926q75b327d9n9e628cce63d3b3a3@mail.gmail.com>
	<014b01c87ce1$13395770$a600fea9@DMITRY>
Message-ID: <19e31a080803022047p4aab2e8eg3b2e9c292b7ac3a6@mail.gmail.com>

On Sun, Mar 2, 2008 at 10:45 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
>  I have no idea why you're treating asking the questions as a "hostility".
>  This is the developers list, not the list for user complaints. Sending
>  the patches is a usual activity here, not vague reasoning.

Sorry I misread one of your statements. There is no point in sending
the patches when we already know they are going to be rejected.

>  Feel free to provide/suggest one.

There is a script posted here to make it less of a hassle to build a
stock Winehq release on OS X.

http://www.wine-forum.org/showthread.php?t=16

I'm happy to start making builds of Winehq snapshots for OS X. I just
don't see the point when the Darwine packages are better for the end
user experience. With Winehelper you get Doc integration and a partial
menu system. The stock X.org on OS X is broken and has inherit
overhead that will always be present, being able to write directly to
the native Windowing system seems like a much more logical long term
solution rather than trying to keep Xorg from breaking and or
developing hacks to work around X and its tricky interaction with
Quartz.

>  Aren't you supposed to work on that according to http://wiki.winehq.org/MacOSX/QuartzDriver?

I have been but I've put my work on it on hold pending a new round of
patches from Emmanuel. My point was that you asked for patches, there
is one for your pleasure. I welcome your thoughts and I am sure
Emmanuel does as well. I know Pierre seemed to get disappointed when
he wanted to develop quartzdrv in winehq but could not get a clear
idea of what Julliard really wanted. What do you want/think quartzdrv
in winehq should look like? How should it be implemented? What
infrastructure changes should be made?

>  Looks like you overreacted, http://www.kronenberg.org/darwine/ has nothing
>  to do with darwine except using its name.

Sorry like I said I mis-read the other email. My point was that it
does not seem that anyone wants to provide real solutions. I don't
think Emmanuel or Pierre really knew what Julliard wants in Quartzdrv.
I don't know know what you want in it. I know there is a certain level
of abstraction that needs to be done in user32 and I was glad to see
Julliard started working on it, thats what made me interested in
bringing some life back in to quartzdrv. It would be nice if those
people that are the experts on the Wine driver model would speak up
and say would needs to be done before we can have this driver.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From jim at pagesmiths.com  Sun Mar  2 23:00:18 2008
From: jim at pagesmiths.com (Jim White)
Date: Sun, 02 Mar 2008 22:00:18 -0700
Subject: winequartz.drv Mac OS X UI discontinued?
In-Reply-To: <47CB7AF6.6070703@sprintpcs.com>
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>	<200803021850.04583.stefan@codeweavers.com>	<19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>	<C6F397EE-31F0-43F8-837A-712D5ED29DBE@java.pl>	<003101c87cda$c9ceb0e0$a600fea9@DMITRY>	<19e31a080803021926q75b327d9n9e628cce63d3b3a3@mail.gmail.com>	<014b01c87ce1$13395770$a600fea9@DMITRY>
	<47CB7AF6.6070703@sprintpcs.com>
Message-ID: <47CB85E2.9050600@pagesmiths.com>

Any developer that wants to maintain source and/or binaries on the 
Darwine project at SF.net is welcome to do so.

I have responded to every such request that I have seen, which isn't to 
say of course that someone hasn't sent such a message that I haven't 
seen.  Folks should be aware that you must subscribe to the list to post 
(although I do manually review posts from non-subscribers and try to put 
through any that are actually about Darwine and not male enhancement or 
get rich quick...).  It is true that questions from users trying to run 
application X may not get much help other than being told Darwine isn't 
ready for end users.

Of course folks are also welcome to host their own builds, and I'd be 
happy if someone came along and just fixed the web site (which suffered 
greatly in the move back to SF.net from opendarwin.org - I didn't want 
to leave SF.net in the first place...), so we could point other folks to 
those builds.

It was never my intention that Darwine be a fork of Wine, but rather a 
friendly haven for Mac developers working on Wine.  If that means doing 
more for users such as hosting binaries, then I'm fine with that too.

Geeze.  I just looked at the download stats and folks are pulling almost 
300 copies a day (nearly 7GB).  It would be nice if they were using that 
bandwidth to get something useful...

Jim White
http://darwine.sf.net/

James McKenzie wrote:

> Dmitry Timoshkov wrote:
> 
>>Looks like you overreacted, http://www.kronenberg.org/darwine/ has nothing
>>to do with darwine except using its name.
>>  
> 
> Actually, I have Mike's code and it uses the Darwine build system and 
> applies two patches to it.  One brings in FontForge so that Apple Native 
> fonts will work in Wine, and this is discussed on the Building Wine for 
> MacOSX web page.  The other fixes a known problem for Leopard's handling 
> of screen location (it does not always use :0.0 for security 
> reasons).    I will suggest that he bring back into the Darwine project 
> his fixes.   I think he already has tried but received no response from 
> the Project.
> 
> As to the rest, AJ has stated, repeatedly, that he wants no Obj-C in the 
> Wine tree.  This prevents bringing in some Mac specific code, and 
> completely eliminates the winequartz.drv project.  I'm not going to 
> argue with his reasoning, but this forces a Native version of Wine to be 
> a continuous fork with fixes in Wine requiring fixes (if winex11.drv is 
> changed) in the code.
> 
> As to support for the Mac, I have been doing what some Mac users are 
> doing now:  Building my own.  Unfortunately, I do not have a place to 
> put my builds where the public can download them.  Also, they contain 
> code that has not been approved for the main Wine build and may contain 
> 'dangerous' code.  I'm willing to risk my system's stability to test, 
> but not others.
> 
> James McKenzie



From dmitry at codeweavers.com  Sun Mar  2 23:04:17 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 3 Mar 2008 13:04:17 +0800
Subject: winequartz.drv Mac OS X UI discontinued?
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl><200803021850.04583.stefan@codeweavers.com><19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com><C6F397EE-31F0-43F8-837A-712D5ED29DBE@java.pl><003101c87cda$c9ceb0e0$a600fea9@DMITRY><19e31a080803021926q75b327d9n9e628cce63d3b3a3@mail.gmail.com><014b01c87ce1$13395770$a600fea9@DMITRY>
	<19e31a080803022047p4aab2e8eg3b2e9c292b7ac3a6@mail.gmail.com>
Message-ID: <01cc01c87cec$0a948210$a600fea9@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> I have been but I've put my work on it on hold pending a new round of
> patches from Emmanuel. My point was that you asked for patches, there
> is one for your pleasure. I welcome your thoughts and I am sure
> Emmanuel does as well. I know Pierre seemed to get disappointed when
> he wanted to develop quartzdrv in winehq but could not get a clear
> idea of what Julliard really wanted. What do you want/think quartzdrv
> in winehq should look like? How should it be implemented? What
> infrastructure changes should be made?

Alexandre has moved a lot of things to user32 that previously were needed
to be implemented on the driver side (SetWindowPos, ShowWindow, DCE) which
should greatly simplify the quartzdrv efforts.

-- 
Dmitry.


From ono at java.pl  Mon Mar  3 03:39:06 2008
From: ono at java.pl (Adam Strzelecki)
Date: Mon, 3 Mar 2008 10:39:06 +0100
Subject: winequartz.drv Mac OS X UI discontinued?
In-Reply-To: <47CB7AF6.6070703@sprintpcs.com>
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>
	<200803021850.04583.stefan@codeweavers.com>
	<19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>
	<C6F397EE-31F0-43F8-837A-712D5ED29DBE@java.pl>
	<003101c87cda$c9ceb0e0$a600fea9@DMITRY>
	<19e31a080803021926q75b327d9n9e628cce63d3b3a3@mail.gmail.com>
	<014b01c87ce1$13395770$a600fea9@DMITRY>
	<47CB7AF6.6070703@sprintpcs.com>
Message-ID: <1B8D4E96-4E8C-4117-82EE-768C69AF8E38@java.pl>

James McKenzie wrote:
> As to the rest, AJ has stated, repeatedly, that he wants no Obj-C in  
> the
> Wine tree.  This prevents bringing in some Mac specific code, and
> completely eliminates the winequartz.drv project.  I'm not going to
> argue with his reasoning, but this forces a Native version of Wine  
> to be
> a continuous fork with fixes in Wine requiring fixes (if winex11.drv  
> is
> changed) in the code.

That means no good for Mac users. With Leopard release Carbon (pure C)  
is more-less deprecated API, Apple pushes all new functionality only  
to Obj-C Cocoa, also there's is no 64-bit Carbon at all.
I don't want to argue what's wrong with Obj-C that it cannot go into  
Wine code-base, but staying out of it won't ever bring full Wine  
support for Mac users.

Dmitry Timoshkov wrote:
> This is the developers list, not the list for user complaints. Sending
> the patches is a usual activity here, not vague reasoning.

That's bizarre, but OK, every society has its own rules. I raised here  
subject about implementation (or call it development) of some Wine  
module (winequartz.drv), so I thought it is more adequate to post it  
here, but if you call it user complaint alright, this list is "sending  
patches" (even I thought wine-patches is the one) I cut this chit-chat.

-- 
Adam Strzelecki |: nanoant.com :|

P.S. What was wrong with "Reply-To" header? I call it normal habit at  
other lists.



From rob at codeweavers.com  Mon Mar  3 04:07:19 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 03 Mar 2008 10:07:19 +0000
Subject: msi: Fix cast-qual warnings
In-Reply-To: <22821af30803010009i56387b95j313566481ccce86e@mail.gmail.com>
References: <22821af30803010009i56387b95j313566481ccce86e@mail.gmail.com>
Message-ID: <47CBCDD7.6000404@codeweavers.com>

James Hawkins wrote:
>      module = LoadLibraryExW( file->TargetPath, NULL, LOAD_LIBRARY_AS_DATAFILE );
>      if (module)
>      {
> -        LPCWSTR guid;
> -        guid = MSI_RecordGetString(row,1);
> -        CLSIDFromString((LPWSTR)guid, &tl_struct.clsid);
> +        LPWSTR guid;
> +        guid = strdupW(MSI_RecordGetString(row, 1));
> +        CLSIDFromString(guid, &tl_struct.clsid);
> +        msi_free(guid);
>          tl_struct.source = strdupW( file->TargetPath );
>          tl_struct.path = NULL;
I can guarantee you that CLSIDFromString does not change the input string. We should not be adding extra performance costs in the form of extra memory allocations for the sake of getting rid of a fairly harmless warning. We should fix the ones that don't require an extra allocations or other performance penalty and leave the warning off.


-- 
Rob Shearman



From rob at codeweavers.com  Mon Mar  3 04:10:11 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 03 Mar 2008 10:10:11 +0000
Subject: ntdll: Added support for Windows 2008
In-Reply-To: <fqe2q8$c3m$1@ger.gmane.org>
References: <fqe2q8$c3m$1@ger.gmane.org>
Message-ID: <47CBCE83.8010103@codeweavers.com>

Alistair Leslie-Hughes wrote:
>          sizeof(RTL_OSVERSIONINFOEXW), 6, 0, 0x1770, VER_PLATFORM_WIN32_NT,
>          {' ',0},
>          0, 0, VER_SUITE_SINGLEUSERTS, VER_NT_WORKSTATION, 0
> +    },
> +    /* WIN2K8 */
> +    {
> +        sizeof(RTL_OSVERSIONINFOEXW), 6, 0, 0x1771, VER_PLATFORM_WIN32_NT,
> +        {'S','e','r','v','i','c','e',' ','P','a','c','k',' ','1',0},
> +        0, 0, VER_SUITE_SINGLEUSERTS, VER_NT_SERVER, 0
>      }
>  };
>   

I see Microsoft are using even more sneaky tactics these days to 
increase sales. They are releasing new versions of Windows with the 
first service pack already applied to satisfy the customers who always 
wait for the first service pack of a version of Windows to come out 
before upgrading to it.

Or could this just be a copy and paste mistake?

-- 
Rob Shearman



From leslie_alistair at hotmail.com  Mon Mar  3 04:23:47 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Mon, 3 Mar 2008 21:23:47 +1100
Subject: ntdll: Added support for Windows 2008
References: <fqe2q8$c3m$1@ger.gmane.org> <47CBCE83.8010103@codeweavers.com>
Message-ID: <fqgjj8$gl5$1@ger.gmane.org>

"Robert Shearman" <rob at codeweavers.com> wrote in message 
news:47CBCE83.8010103 at codeweavers.com...
> Alistair Leslie-Hughes wrote:
>>          sizeof(RTL_OSVERSIONINFOEXW), 6, 0, 0x1770, 
>> VER_PLATFORM_WIN32_NT,
>>          {' ',0},
>>          0, 0, VER_SUITE_SINGLEUSERTS, VER_NT_WORKSTATION, 0
>> +    },
>> +    /* WIN2K8 */
>> +    {
>> +        sizeof(RTL_OSVERSIONINFOEXW), 6, 0, 0x1771, 
>> VER_PLATFORM_WIN32_NT,
>> +        {'S','e','r','v','i','c','e',' ','P','a','c','k',' ','1',0},
>> +        0, 0, VER_SUITE_SINGLEUSERTS, VER_NT_SERVER, 0
>>      }
>>  };
>>
>
> I see Microsoft are using even more sneaky tactics these days to
> increase sales. They are releasing new versions of Windows with the
> first service pack already applied to satisfy the customers who always
> wait for the first service pack of a version of Windows to come out
> before upgrading to it.
>
> Or could this just be a copy and paste mistake?
No, its no mistake.
osvi.szCSDVersion returns "Service Pack 1".

I thought it was a mistake as well, when i first saw it, but I ran cpuz on 
the server, and it

is reported as "Windows Vista Service Pack 1" (It appears the cpuz doesnt 
understand the

its a server yet).



Best Regards

 Alistair Leslie-Hughes




From leslie_alistair at hotmail.com  Mon Mar  3 04:55:50 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Mon, 3 Mar 2008 21:55:50 +1100
Subject: Regession tests
References: <fq392s$69o$1@ger.gmane.org> <47C531C9.9050600@gmail.com>
Message-ID: <fqglgm$n3u$1@ger.gmane.org>

"Paul Vriens" <paul.vriens.wine at gmail.com> wrote in message 
news:47C531C9.9050600 at gmail.com...
> Alistair Leslie-Hughes wrote:
>> Hi,
>>
>> Some of the regessions test are failing with errors in output file like
>> msxml3:domdoc start dlls/msxml3/tests/domdoc.c 1.80
>> msxml3:domdoc done (-1073741819)
>>
>> Is this due to a Seg Fault?
>>
>>
> Yes, this usually is an indication that the test crashed. (You would see a
> 'Failed' on test.winehq.org).
>
> -- 
What is the best way to narrow down what is causing the crash?

Best Regards
 Alistair Leslie-Hughes 




From dmitry at codeweavers.com  Mon Mar  3 05:03:28 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 3 Mar 2008 19:03:28 +0800
Subject: winex11.drv: Add DefaultRefreshRates option to specify refresh
	ratewhen application does not
References: <47CB80F1.90300@ossguy.com>
Message-ID: <028701c87d1e$37f6ef40$a600fea9@DMITRY>

"Denver Gingerich" <denver at ossguy.com> wrote:

> This patch allows the user to specify a list of default refresh
> rates to use at particular resolutions to override the default
> behavior that chooses the refresh rate based on whichever mode
> is first in the list for a given resolution.  The list is specified
> by populating the X11 Driver/DefaultRefreshRates registry key with
> a semicolon-delimited list of resolution, refresh rate pairs.

What's really needs to be done is writing the tests to investigate
what Windows does in that case, and make the tests pass in Wine.

-- 
Dmitry.


From julliard at winehq.org  Mon Mar  3 05:06:48 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 03 Mar 2008 12:06:48 +0100
Subject: [1/3] shlwapi/tests: Move the function pointers to the string
	test functions where they are initialized and used.
In-Reply-To: <alpine.DEB.1.00.0803012113580.16709@amboise.dolphin> (Francois
	Gouget's message of "Sat, 1 Mar 2008 21:16:09 +0100 (CET)")
References: <alpine.DEB.1.00.0803012113580.16709@amboise.dolphin>
Message-ID: <87prucnk1j.fsf@wine.dyndns.org>

Francois Gouget <fgouget at free.fr> writes:

> It makes no sense to declare the function pointers globally, but then 
> only initialiaze them in one function or another. This is a recipe for 
> adding code that calls the function pointer elsewhere... and before it 
> has been initialized of course.

Actually the reason for declaring them globally is that 2.x gcc versions
sometimes crash on local WINAPI function pointers.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Mon Mar  3 05:18:09 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 03 Mar 2008 12:18:09 +0100
Subject: mountmgr.sys and ioctl's
In-Reply-To: <b130c85e0803012356v2887045amb76936b576f0e5a2@mail.gmail.com>
	(Maarten Lankhorst's message of "Sat, 1 Mar 2008 23:56:48 -0800")
References: <b130c85e0803012356v2887045amb76936b576f0e5a2@mail.gmail.com>
Message-ID: <87ir04njim.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> What if we always map access to \\.\X: is always mapped to mountmgr,
> and let mountmanager open \\.\X:: that would be mapped to
> /dosdevices/x::, any ioctl, and read/write stuff that mountmgr can't
> handle can then be forwarded to the raw device, if available.
>
> Do you think that would be an appropiate solution?

No, things that can be done locally through the fd shouldn't have to go
through mountmgr, especially not read/writes.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Mon Mar  3 05:26:13 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 03 Mar 2008 12:26:13 +0100
Subject: [PATCH 1/1] GDI+: Implement GdipGetImageEncoders.
In-Reply-To: <1203868184-16476-1-git-send-email-nathan.beckmann@gmail.com>
	(Nathan Beckmann's message of "Sun, 24 Feb 2008 07:49:44 -0800")
References: <1203868184-16476-1-git-send-email-nathan.beckmann@gmail.com>
Message-ID: <87ejasnj56.fsf@wine.dyndns.org>

Nathan Beckmann <nathan.beckmann at gmail.com> writes:

> +
> +/*************************************************************************
> + * Encoders -
> + *   Implemented as dummy objects that let the user know which files are
> + *   supported. Actual encoding is done by OLE.
> + *
> + *   This code is based heavily on libgdiplus (Mono):
> + *
> [...]

What's the point of including such a large copyright notice if you are
not actually copying any code?  You are just defining a couple of
constants, you don't need to copy that from Mono.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Mon Mar  3 05:27:18 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 03 Mar 2008 12:27:18 +0100
Subject: [PATCH 1/6] OLE: Remove tabs from olepicture.c test file.
In-Reply-To: <1203868639-16623-1-git-send-email-nathan.beckmann@gmail.com>
	(Nathan Beckmann's message of "Sun, 24 Feb 2008 07:57:14 -0800")
References: <1203868639-16623-1-git-send-email-nathan.beckmann@gmail.com>
Message-ID: <87ablgnj3d.fsf@wine.dyndns.org>

Please don't do that.

-- 
Alexandre Julliard
julliard at winehq.org


From msclrhd at googlemail.com  Mon Mar  3 04:49:13 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Mon, 3 Mar 2008 10:49:13 +0000
Subject: ntdll: Added support for Windows 2008
In-Reply-To: <47CBCE83.8010103@codeweavers.com>
References: <fqe2q8$c3m$1@ger.gmane.org> <47CBCE83.8010103@codeweavers.com>
Message-ID: <3f4fd2640803030249t49062983ybda517dcafb11ef@mail.gmail.com>

On 03/03/2008, Robert Shearman <rob at codeweavers.com> wrote:
>
>  I see Microsoft are using even more sneaky tactics these days to
>  increase sales. They are releasing new versions of Windows with the
>  first service pack already applied to satisfy the customers who always
>  wait for the first service pack of a version of Windows to come out
>  before upgrading to it.
>
>  Or could this just be a copy and paste mistake?

Windows 2008 is built on the Vista codebase, and is aligned with Vista
SP1. When Vista SP2 ships, it will be Windows 2008 SP1. (Source: Paul
Thurott's podcast on www.twit.tv).

- Reece


From martin at hinner.info  Mon Mar  3 06:16:46 2008
From: martin at hinner.info (Martin Hinner)
Date: Mon, 3 Mar 2008 13:16:46 +0100
Subject: Getting apps running under Wine
Message-ID: <24d1a1690803030416u128ff6a7i59ad69eeeb06f976@mail.gmail.com>

Hello,

   I would like to run some of our (win32-based) applications under
Linux using Wine. At this time it is only for my personal use, but
maybe someday some of our users will like to have it on Linux like me.

   I have managed to get all of them running, showing at least first
dialog/window. But there are some problems:

1) User interface stuff. We are using dialogs (MFC CDialog) that have
non-default font size (i.e.  Times New Roman, 12 ). The font is
displayed correctly under Wine, but dialog window has wrong size (it's
smaller and some parts of dialog, mainly buttons at bottom, are not
visible). I can send more info on this. How to solve this problem
(other way than detecting Wine and resizing window manually) ?

2) Windows drivers. We use DLL that depends on some Win32 drivers.
Linux driver is available with similar API, so it's not a big problem
to change our application to use Linux library. I understand that
clearest way how to solve this problem is to make .dll.so file, but
it's quite complicated for this particular application and I would
prefer much more to add few if conditions to our Windows code that
would recognize Wine under Linux and load native .so file (not
.dll.so!). Is this possible? How to deal with different calling
conventions between gcc and Visual C++ 2003 ?

3) Windows service. We use a windows NT service (which can easily be
ported to Linux,btw), an application communicates with the service
using named pipe. Is it possible to communicate from "wined"
application with some Linux program using technique other than TCP or
Unix socket ? If no - is it possible to open Unix socket from our win
app ?

-- 
Martin Hinner

http://martin.hinner.info
http://www.auto-diagnostics.info


From fgouget at free.fr  Mon Mar  3 07:27:07 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 3 Mar 2008 14:27:07 +0100 (CET)
Subject: [1/3] shlwapi/tests: Move the function pointers to the string
	test functions where they are initialized and used.
In-Reply-To: <87prucnk1j.fsf@wine.dyndns.org>
References: <alpine.DEB.1.00.0803012113580.16709@amboise.dolphin>
	<87prucnk1j.fsf@wine.dyndns.org>
Message-ID: <alpine.DEB.1.00.0803031426190.2379@amboise.dolphin>

On Mon, 3 Mar 2008, Alexandre Julliard wrote:

> Francois Gouget <fgouget at free.fr> writes:
> 
> > It makes no sense to declare the function pointers globally, but then 
> > only initialiaze them in one function or another. This is a recipe for 
> > adding code that calls the function pointer elsewhere... and before it 
> > has been initialized of course.
> 
> Actually the reason for declaring them globally is that 2.x gcc versions
> sometimes crash on local WINAPI function pointers.

Then I think it's better to initialize them all in the test's 'main' 
function. I'll submit a patch for that.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                  A black hole is just God dividing by zero.


From julliard at winehq.org  Mon Mar  3 08:38:22 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 03 Mar 2008 15:38:22 +0100
Subject: [PATCH 1/4] rpcss: Implement endpoint-mapper server using DCE/RPC.
In-Reply-To: <47CBEB37.5040401@codeweavers.com> (Robert Shearman's message of
	"Mon, 03 Mar 2008 12:12:39 +0000")
References: <47CBEB37.5040401@codeweavers.com>
Message-ID: <87skz7na8x.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> ---
>   include/Makefile.in            |    2 +
>   include/sharedidl/dcetypes.idl |   88 ++++++++++++
>   include/sharedidl/epm.idl      |  113 ++++++++++++++++
>   programs/rpcss/Makefile.in     |    3 +
>   programs/rpcss/epm.idl         |   19 +++
>   programs/rpcss/epmp.c          |  291
> ++++++++++++++++++++++++++++++++++++++++
>   programs/rpcss/rpcss_main.c    |   54 +++++---
>   7 files changed, 550 insertions(+), 20 deletions(-)
>   create mode 100644 include/sharedidl/dcetypes.idl
>   create mode 100644 include/sharedidl/epm.idl
>   create mode 100644 programs/rpcss/epm.idl
>   create mode 100644 programs/rpcss/epmp.c

That sharedidl stuff is ugly, we really have to find a way to make this
work with the idl files in include/wine.

-- 
Alexandre Julliard
julliard at winehq.org


From denver at ossguy.com  Mon Mar  3 09:04:53 2008
From: denver at ossguy.com (Denver Gingerich)
Date: Mon, 3 Mar 2008 10:04:53 -0500
Subject: winex11.drv: Add DefaultRefreshRates option to specify refresh
	ratewhen application does not
In-Reply-To: <028701c87d1e$37f6ef40$a600fea9@DMITRY>
References: <47CB80F1.90300@ossguy.com> <028701c87d1e$37f6ef40$a600fea9@DMITRY>
Message-ID: <6defe8840803030704x1424f0ddu89c104565f40a516@mail.gmail.com>

On Mon, Mar 3, 2008 at 6:03 AM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> "Denver Gingerich" <denver at ossguy.com> wrote:
>
>  > This patch allows the user to specify a list of default refresh
>  > rates to use at particular resolutions to override the default
>  > behavior that chooses the refresh rate based on whichever mode
>  > is first in the list for a given resolution.  The list is specified
>  > by populating the X11 Driver/DefaultRefreshRates registry key with
>  > a semicolon-delimited list of resolution, refresh rate pairs.
>
>  What's really needs to be done is writing the tests to investigate
>  what Windows does in that case, and make the tests pass in Wine.

The only way I could see of modifying the default refresh rate under
Windows is to change it through Display Settings.  Unfortunately, not
all Wine platforms have this option.  On my system, where the Nvidia
binary driver automatically constructs a list of modes (there are no
ModeLine entries in xorg.conf), there does not appear to be a
mechanism for modifying the mode list.

I suppose the proper solution would be to modify the Nvidia binary
driver to allow for modification of the mode list (and modify any
other drivers that don't provide that mechanism).  While I generally
like proper solutions, I don't think that is a practical option
because we don't have access to the Nvidia binary driver source code
yet those with Nvidia cards have to use it for
DirectDrawRenderer=opengl and RenderTargetLockMode=readtex.

If I find the time, I will try to construct a test case in the next
few days and run it on Windows and Wine to see what happens.  If
someone on the list is interested, though, I would appreciate if they
did it instead.  I don't have a development environment setup on
Windows at this point.

Regardless of the outcome of the test cases, I would still like to see
DefaultRefreshRates implemented in Wine for the reasons above.  Unless
someone can tell me how to change the mode ordering in the OS with the
Nvidia driver, I can't see any way to choose different default refresh
rates for the various resolutions.  I would appreciate if others could
comment on whether their video card driver allows the mode ordering to
be changed.

Denver


From dmitry at codeweavers.com  Mon Mar  3 09:25:18 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 3 Mar 2008 23:25:18 +0800
Subject: winex11.drv: Add DefaultRefreshRates option to specify
	refreshratewhen application does not
References: <47CB80F1.90300@ossguy.com> <028701c87d1e$37f6ef40$a600fea9@DMITRY>
	<6defe8840803030704x1424f0ddu89c104565f40a516@mail.gmail.com>
Message-ID: <03e401c87d42$cb7a69d0$a600fea9@DMITRY>

"Denver Gingerich" <denver at ossguy.com> wrote:

> The only way I could see of modifying the default refresh rate under
> Windows is to change it through Display Settings.  Unfortunately, not
> all Wine platforms have this option.  On my system, where the Nvidia
> binary driver automatically constructs a list of modes (there are no
> ModeLine entries in xorg.conf), there does not appear to be a
> mechanism for modifying the mode list.

Why do you need to modify the modes list? You need to figure out how
Windows chooses from the list of available modes when refresh rate is
not specified. Does it select first/best/any from the list?

-- 
Dmitry.


From dank at kegel.com  Mon Mar  3 10:09:44 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 3 Mar 2008 08:09:44 -0800
Subject: Building dlls/oleaut32/tests/olepicture.c under Cygwin?
Message-ID: <a71bd89a0803030809w2095b3f8s57b5029a2d21c7c7@mail.gmail.com>

I tried building dlls/oleaut32/tests/olepicture.c
on Windows using cygwin, but ran into a couple small problems.
The main problem is:

/cygdrive/c/DOCUME~1/Liz/LOCALS~1/Temp/ccXL7SF3.o:olepicture.c:(.text+0x18e5):
undefined reference to `_IPictureDisp_Invoke'

That sounds fishy - is that test using a wine-specific shortcut?
If so, what's the kosher windows way to do what it's doing?

Here's the procedure I followed:

1. Download and run the installer from http://cygwin.com
Use it to install gcc and git
2. Open a cygwin window
3. Grab a copy of the Wine sources using git as normal
4. cd wine/dlls/oleaut32/tests
5. to avoid conflicts between the win32 headers from wine and from cygwin,
just use the cygwin ones.  But we do have to copy one header from wine:
 mkdir -p include/wine
 cp ../../../include/wine/test.h include/wine
6. Try compiling and linking with
$ gcc -DSTANDALONE -Iinclude olepicture.c -mwindows -loleaut32 -lole32 -luuid
This fails with all sorts of errors about LOGFONTA.
That's because the include lines in olepicture.c are in the wrong order!
Edit olepicture.c and change the lines

#include <winuser.h>
#include <wingdi.h>

to read

#include <wingdi.h>
#include <winuser.h>

7. Try compiling again.  Now you fail with a handful of errors like
/cygdrive/c/DOCUME~1/Liz/LOCALS~1/Temp/ccXL7SF3.o:olepicture.c:(.text+0x18e5): u
ndefined reference to `_IPictureDisp_Invoke'

Seems like a portability problem in tests/olepicture.c.


From denver at ossguy.com  Mon Mar  3 10:10:50 2008
From: denver at ossguy.com (Denver Gingerich)
Date: Mon, 3 Mar 2008 11:10:50 -0500
Subject: winex11.drv: Add DefaultRefreshRates option to specify
	refreshratewhen application does not
In-Reply-To: <03e401c87d42$cb7a69d0$a600fea9@DMITRY>
References: <47CB80F1.90300@ossguy.com> <028701c87d1e$37f6ef40$a600fea9@DMITRY>
	<6defe8840803030704x1424f0ddu89c104565f40a516@mail.gmail.com>
	<03e401c87d42$cb7a69d0$a600fea9@DMITRY>
Message-ID: <6defe8840803030810h3cea606ema4afa265dec35de@mail.gmail.com>

On Mon, Mar 3, 2008 at 10:25 AM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> "Denver Gingerich" <denver at ossguy.com> wrote:
>
>
> > The only way I could see of modifying the default refresh rate under
>  > Windows is to change it through Display Settings.  Unfortunately, not
>  > all Wine platforms have this option.  On my system, where the Nvidia
>  > binary driver automatically constructs a list of modes (there are no
>  > ModeLine entries in xorg.conf), there does not appear to be a
>  > mechanism for modifying the mode list.
>
>  Why do you need to modify the modes list?

Using the current Wine code (without this patch), modifying the modes
list so that a particular refresh rate appears first in the list is
the only way that I can see to specify a default refresh rate for a
given resolution.  This is because the current Wine code chooses the
first mode that matches the resolution if no refresh rate is specified
even if there are other modes with the same resolution but different
refresh rates.

I think what you're saying is that Wine's current behavior (pick the
first mode with matching resolution) does not necessarily reflect
Windows' behavior so testing needs to be done to see what algorithm
Windows uses to determine the refresh rate when it isn't specified.
Correct me if I'm wrong.

> You need to figure out how
>  Windows chooses from the list of available modes when refresh rate is
>  not specified. Does it select first/best/any from the list?

This test definitely needs to be done.  I will hopefully have time in
the next few days but if someone else beats me to it, I won't
complain.

Denver


From rob at codeweavers.com  Mon Mar  3 10:19:30 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 03 Mar 2008 16:19:30 +0000
Subject: Building dlls/oleaut32/tests/olepicture.c under Cygwin?
In-Reply-To: <a71bd89a0803030809w2095b3f8s57b5029a2d21c7c7@mail.gmail.com>
References: <a71bd89a0803030809w2095b3f8s57b5029a2d21c7c7@mail.gmail.com>
Message-ID: <47CC2512.3040608@codeweavers.com>

Dan Kegel wrote:
> 7. Try compiling again.  Now you fail with a handful of errors like
> /cygdrive/c/DOCUME~1/Liz/LOCALS~1/Temp/ccXL7SF3.o:olepicture.c:(.text+0x18e5): u
> ndefined reference to `_IPictureDisp_Invoke'
>
> Seems like a portability problem in tests/olepicture.c.

 From ocidl.h:
#define 
IPictureDisp_Invoke(This,dispIdMember,riid,lcid,wFlags,pDispParams,pVarResult,pExcepInfo,puArgErr) 
(This)->lpVtbl->Invoke(This,dispIdMember,riid,lcid,wFlags,pDispParams,pVarResult,pExcepInfo,puArgErr)

Which headers are you using?

-- 
Rob Shearman



From dank at kegel.com  Mon Mar  3 10:24:07 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 3 Mar 2008 08:24:07 -0800
Subject: Building dlls/oleaut32/tests/olepicture.c under Cygwin?
In-Reply-To: <47CC2512.3040608@codeweavers.com>
References: <a71bd89a0803030809w2095b3f8s57b5029a2d21c7c7@mail.gmail.com>
	<47CC2512.3040608@codeweavers.com>
Message-ID: <a71bd89a0803030824q4af31a81hf613e7d79e25a5b4@mail.gmail.com>

On Mon, Mar 3, 2008 at 8:19 AM, Robert Shearman <rob at codeweavers.com> wrote:
>   From ocidl.h:
>  #define  IPictureDisp_Invoke ...
>
>  Which headers are you using?

The cygwin ones.  Think I can just add that one define to them?


From dank at kegel.com  Mon Mar  3 10:29:44 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 3 Mar 2008 08:29:44 -0800
Subject: Building dlls/oleaut32/tests/olepicture.c under Cygwin?
In-Reply-To: <a71bd89a0803030824q4af31a81hf613e7d79e25a5b4@mail.gmail.com>
References: <a71bd89a0803030809w2095b3f8s57b5029a2d21c7c7@mail.gmail.com>
	<47CC2512.3040608@codeweavers.com>
	<a71bd89a0803030824q4af31a81hf613e7d79e25a5b4@mail.gmail.com>
Message-ID: <a71bd89a0803030829j30f6209cjb150b83ab0327121@mail.gmail.com>

On Mon, Mar 3, 2008 at 8:24 AM, Dan Kegel <dank at kegel.com> wrote:
> On Mon, Mar 3, 2008 at 8:19 AM, Robert Shearman <rob at codeweavers.com> wrote:
>  >   From ocidl.h:
>  >  #define  IPictureDisp_Invoke ...
> >
>  >  Which headers are you using?
>
>  The cygwin ones.  Think I can just add that one define to them?

I bet not.  I guess I'll try the microsoft headers next.


From winehacker at gmail.com  Mon Mar  3 10:51:26 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 3 Mar 2008 11:51:26 -0500
Subject: Building dlls/oleaut32/tests/olepicture.c under Cygwin?
In-Reply-To: <a71bd89a0803030829j30f6209cjb150b83ab0327121@mail.gmail.com>
References: <a71bd89a0803030809w2095b3f8s57b5029a2d21c7c7@mail.gmail.com>
	<47CC2512.3040608@codeweavers.com>
	<a71bd89a0803030824q4af31a81hf613e7d79e25a5b4@mail.gmail.com>
	<a71bd89a0803030829j30f6209cjb150b83ab0327121@mail.gmail.com>
Message-ID: <19e31a080803030851r9bb7f5fy41cf5b4ee345d250@mail.gmail.com>

On Mon, Mar 3, 2008 at 11:29 AM, Dan Kegel <dank at kegel.com> wrote:
>  >  The cygwin ones.  Think I can just add that one define to them?
>
>  I bet not.  I guess I'll try the microsoft headers next.

The default search order for the headers on cygwin/mingw is host then
Wine so if you just remove or rename the w32api headers you will end
up including the Wine headers which may fix the problem.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From juan.lang at gmail.com  Mon Mar  3 11:09:08 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Mon, 3 Mar 2008 09:09:08 -0800
Subject: Getting apps running under Wine
In-Reply-To: <24d1a1690803030416u128ff6a7i59ad69eeeb06f976@mail.gmail.com>
References: <24d1a1690803030416u128ff6a7i59ad69eeeb06f976@mail.gmail.com>
Message-ID: <3a768c550803030909q29647b57i704040f69b7dac72@mail.gmail.com>

Hi Martin,

>  1) User interface stuff. We are using dialogs (MFC CDialog) that have
>  non-default font size (i.e.  Times New Roman, 12 ). The font is
>  displayed correctly under Wine, but dialog window has wrong size (it's
>  smaller and some parts of dialog, mainly buttons at bottom, are not
>  visible). I can send more info on this. How to solve this problem
>  (other way than detecting Wine and resizing window manually) ?

Please open a bug at our bugzilla (bugs.winehq.org).  Attaching
screenshots of the problem would help.  We discourage you from working
around Wine bugs, because if we fix the bug, we'll break your app in
the process.  Better to fix Wine.

>  2) Windows drivers. We use DLL that depends on some Win32 drivers.
>  Linux driver is available with similar API, so it's not a big problem
>  to change our application to use Linux library. I understand that
>  clearest way how to solve this problem is to make .dll.so file, but
>  it's quite complicated for this particular application and I would
>  prefer much more to add few if conditions to our Windows code that
>  would recognize Wine under Linux and load native .so file (not
>  .dll.so!). Is this possible? How to deal with different calling
>  conventions between gcc and Visual C++ 2003 ?

I'm not sure what you mean by different calling conventions; gcc
supports the __stdcall convention, at least, and VC++ supports
__cdecl.  If you're using __fastcall you'll need to change it to one
of the others, I think.

As far as detecting Wine, again we prefer you don't.  Would it be any
great problem to ship a Linux version that called the Linux drivers,
and a Windows version that called the Windows drivers?

>  3) Windows service. We use a windows NT service (which can easily be
>  ported to Linux,btw), an application communicates with the service
>  using named pipe. Is it possible to communicate from "wined"
>  application with some Linux program using technique other than TCP or
>  Unix socket ? If no - is it possible to open Unix socket from our win
>  app ?

It's certainly possible to open a Unix socket from a winelib app.
(Wine itself does so.)  Using a named pipe from a regular (not
winelib) Linux app won't work.

Hope that helps,
--Juan


From austinenglish at gmail.com  Mon Mar  3 12:59:03 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 3 Mar 2008 12:59:03 -0600
Subject: Bugzilla's down again
Message-ID: <b6bb06270803031059re473f98q55c916a64cb4b522@mail.gmail.com>

Someone with access care to reset mysql?

-Austin


From kuba at mareimbrium.org  Mon Mar  3 13:47:09 2008
From: kuba at mareimbrium.org (Kuba Ober)
Date: Mon, 3 Mar 2008 14:47:09 -0500
Subject: Next big app(s) to try?
In-Reply-To: <47B8AFE0.6060509@diderot.org>
References: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>
	<47B87933.5090208@gmail.com> <47B8AFE0.6060509@diderot.org>
Message-ID: <200803031447.09373.kuba@mareimbrium.org>

On Sunday 17 February 2008, denis bonnenfant wrote:
> Another major application that may be interesting to support is SolidWorks.
> http://appdb.winehq.org/objectManager.php?sClass=version&iId=8983
>
> Why ?
>
> - It's one of the most popular CAD application for mechanical design and
> engineering, and surely the most used for educationnal purposes. Although
> the industrial version is quite expensive, thousands of $ or ?, it is
> availiable for free for students in europe, and currently, it is the only
> app that may prevent them from switching from Windows to Linux.

In similar vein I'd add Alibre Design, which provides almost the same 
functionality for 5-10x less money.

Cheers, Kuba


From dank at kegel.com  Mon Mar  3 13:52:48 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 3 Mar 2008 11:52:48 -0800
Subject: Building dlls/oleaut32/tests/olepicture.c under Cygwin?
In-Reply-To: <19e31a080803030851r9bb7f5fy41cf5b4ee345d250@mail.gmail.com>
References: <a71bd89a0803030809w2095b3f8s57b5029a2d21c7c7@mail.gmail.com>
	<47CC2512.3040608@codeweavers.com>
	<a71bd89a0803030824q4af31a81hf613e7d79e25a5b4@mail.gmail.com>
	<a71bd89a0803030829j30f6209cjb150b83ab0327121@mail.gmail.com>
	<19e31a080803030851r9bb7f5fy41cf5b4ee345d250@mail.gmail.com>
Message-ID: <a71bd89a0803031152j789a6be9u606ba4a94aa7436@mail.gmail.com>

On Mon, Mar 3, 2008 at 8:51 AM, Steven Edwards <winehacker at gmail.com> wrote:
>  The default search order for the headers on cygwin/mingw is host then
>  Wine so if you just remove or rename the w32api headers you will end
>  up including the Wine headers which may fix the problem.

That did it.  So the full procedure, for the record, is:

1. Download and run the installer from http://cygwin.com
Use it to install gcc, git, make, flex, and bison.

2. Open a cygwin window

3. Grab a copy of the Wine sources using git as normal

4. Configure wine, build widl, and use it to expand .idl files to .h files.
$ cd wine
$ ./configure
$ cd libs/port; make; cd -
$ cd libs/wpp; make; cd -
$ cd tools/widl; make; cd -
$ cd include; make; cd -

5. cd wine/dlls/oleaut32/tests

5. to avoid conflicts between the win32 headers from wine and from cygwin,
just use the wine ones.  The easiest way to nuke the cygwin ones
is to do
$ mv /usr/include/w32api /usr/include/w32api.x

6. Try compiling and linking your test.  e.g.
$ cd wine/dlls/oleaut32/tests
$ gcc -DSTANDALONE -I../../../include olepicture.c -mno-cygwin
-loleaut32 -lole32 -luuid
This fails with all sorts of errors about LOGFONTA.
That's because the include lines in olepicture.c are in the wrong order!
Edit olepicture.c and change the lines

#include <winuser.h>
#include <wingdi.h>

to read

#include <wingdi.h>
#include <winuser.h>

7. Try compiling again.  It should work now.  To run your standalone test, do
$ ./a.exe
If you need more verbose output, do
$ WINETEST_DEBUG=1 ./a.out
That will enable trace() statements.


From jnewman at codeweavers.com  Mon Mar  3 14:23:08 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Mon, 03 Mar 2008 14:23:08 -0600
Subject: Bugzilla's down again
In-Reply-To: <b6bb06270803031059re473f98q55c916a64cb4b522@mail.gmail.com>
References: <b6bb06270803031059re473f98q55c916a64cb4b522@mail.gmail.com>
Message-ID: <47CC5E2C.6060002@codeweavers.com>

It didn't go down that I'm aware of. At least not in the same way it had 
been crashing before.

Austin English wrote:
> Someone with access care to reset mysql?
> 
> -Austin
> 
> 


From ben at atomnet.co.uk  Mon Mar  3 14:26:42 2008
From: ben at atomnet.co.uk (Ben Hodgetts)
Date: Mon, 03 Mar 2008 20:26:42 +0000
Subject: Bugzilla's down again
In-Reply-To: <47CC5E2C.6060002@codeweavers.com>
References: <b6bb06270803031059re473f98q55c916a64cb4b522@mail.gmail.com>
	<47CC5E2C.6060002@codeweavers.com>
Message-ID: <47CC5F02.4070701@atomnet.co.uk>

Seems to work for me although initially loading it took a little longer 
than it normally does.

Ben H.

Jeremy Newman wrote:
> It didn't go down that I'm aware of. At least not in the same way it had 
> been crashing before.
>
> Austin English wrote:
>   
>> Someone with access care to reset mysql?
>>
>> -Austin
>>
>>
>>     
>
>
>   


From austinenglish at gmail.com  Mon Mar  3 15:07:31 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 3 Mar 2008 15:07:31 -0600
Subject: Bugzilla's down again
In-Reply-To: <47CC5F02.4070701@atomnet.co.uk>
References: <b6bb06270803031059re473f98q55c916a64cb4b522@mail.gmail.com>
	<47CC5E2C.6060002@codeweavers.com> <47CC5F02.4070701@atomnet.co.uk>
Message-ID: <b6bb06270803031307x4e6a6b1fpe33212b77150e05e@mail.gmail.com>

On Mon, Mar 3, 2008 at 2:26 PM, Ben Hodgetts <ben at atomnet.co.uk> wrote:
> Seems to work for me although initially loading it took a little longer
>  than it normally does.
>
>  Ben H.
>
>
>
>  Jeremy Newman wrote:
>  > It didn't go down that I'm aware of. At least not in the same way it had
>  > been crashing before.
>  >
>  > Austin English wrote:
>  >
>  >> Someone with access care to reset mysql?
>  >>
>  >> -Austin
>  >>
>  >>
>  >>
>  >
>  >
>  >
>
>
>

Yeah, seems to be back up now, had been down for few minutes, but not
as long as usual...

-Austin


From m.b.lankhorst at gmail.com  Mon Mar  3 15:22:30 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 3 Mar 2008 13:22:30 -0800
Subject: Summer of code 2008, looking for volunteers
Message-ID: <b130c85e0803031322h253a5155m8f87d10140d39a66@mail.gmail.com>

Hi all,

I'm planning on being administrator for wine project with the summer
of code 2008.

I'm looking for mentor volunteers. If you don't know what that is read
take some time to read through
http://code.google.com/soc/2008/faqs.html
If anyone is interested, please contact me privately.

I'm also looking for project ideas, if anyone has an idea for a
project for the summer of code, please update
http://wiki.winehq.org/SummerOfCode . I would prefer projects that can
be done by small changes at a time, like implementing changes to get
an application to work, instead of something dractic like a dib
engine. It should preferably be doable in 2 to 3 months by someone who
doesn't have a lot of wine experience yet.

I'm also looking for people who want to help out in other ways, like
updating the wiki page and creating some additional information that
would be useful to students.

Cheers,
Maarten.


From us at edmeades.me.uk  Mon Mar  3 17:38:57 2008
From: us at edmeades.me.uk (Ann & Jason Edmeades)
Date: Mon, 3 Mar 2008 23:38:57 -0000
Subject: Summer of code 2008 - cmd.exe compatibility?
Message-ID: <000001c87d87$c445e0f0$1001a8c0@JasonsPC>

Hiya, 

Out of interest, what is meant by improving cmd.exe compatibility?

Jason




From thestig at google.com  Mon Mar  3 17:52:21 2008
From: thestig at google.com (Lei Zhang)
Date: Mon, 3 Mar 2008 15:52:21 -0800
Subject: Summer of code 2008 - cmd.exe compatibility?
In-Reply-To: <000001c87d87$c445e0f0$1001a8c0@JasonsPC>
References: <000001c87d87$c445e0f0$1001a8c0@JasonsPC>
Message-ID: <558b2f5c0803031552l6694951s1b90bbb4c0a75132@mail.gmail.com>

On Mon, Mar 3, 2008 at 3:38 PM, Ann & Jason Edmeades <us at edmeades.me.uk> wrote:
> Hiya,
>
>  Out of interest, what is meant by improving cmd.exe compatibility?

Add support for all the cmd.exe switches and all the dos batch
programming constructs?


From donpedro at tdcadsl.dk  Mon Mar  3 18:40:41 2008
From: donpedro at tdcadsl.dk (Peter Dons Tychsen)
Date: Tue, 04 Mar 2008 01:40:41 +0100
Subject: Request for comments on listview patch which was rejected.
Message-ID: <1204591241.3700.4.camel@dhcppc1>

Hello Devs.

I sent in this listview patch some while ago,
but it was silently rejected (like most of my patches :-)).

Before i re-send it, could someone take a peak at it and tell me what is
wrong?

It looks quite sober to me...

/p
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0002-Fixed-listview-bug-when-client-sends-bogus-SETITEMS.patch
Type: text/x-patch
Size: 3664 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080304/2f4249e9/attachment.bin 

From dimi at lattica.com  Mon Mar  3 18:45:09 2008
From: dimi at lattica.com (Dimi Paun)
Date: Mon, 03 Mar 2008 19:45:09 -0500
Subject: Request for comments on listview patch which was rejected.
In-Reply-To: <1204591241.3700.4.camel@dhcppc1>
References: <1204591241.3700.4.camel@dhcppc1>
Message-ID: <1204591509.5026.127.camel@dimi.lattica.com>


On Tue, 2008-03-04 at 01:40 +0100, Peter Dons Tychsen wrote:
> It looks quite sober to me...

Looks good to me too...

-- 
Dimi Paun <dimi at lattica.com>
Lattica, Inc.



From stefan at codeweavers.com  Mon Mar  3 19:28:41 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 4 Mar 2008 02:28:41 +0100
Subject: Summer of code 2008, looking for volunteers
In-Reply-To: <b130c85e0803031322h253a5155m8f87d10140d39a66@mail.gmail.com>
References: <b130c85e0803031322h253a5155m8f87d10140d39a66@mail.gmail.com>
Message-ID: <200803040228.46184.stefan@codeweavers.com>

Am Montag, 3. M?rz 2008 22:22:30 schrieb Maarten Lankhorst:
> I'm also looking for project ideas, if anyone has an idea for a
> project for the summer of code, please update
> http://wiki.winehq.org/SummerOfCode . I would prefer projects that can
> be done by small changes at a time, like implementing changes to get
> an application to work, instead of something dractic like a dib
> engine. It should preferably be doable in 2 to 3 months by someone who
> doesn't have a lot of wine experience yet.
I think writing a (partial?) D3D pipeline replacement shader in either GLSL or 
ARB is an idea. With the current state of the code this is rather hard, but I 
am working on some general infrastructure to make this easier. Depending on 
how far my work gets this could in the end be mainly a matter of translating 
the D3D settings into a shader, without worrying too much how the shader is 
then integrated into the rest of the pipeline.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080304/b1d75ca6/attachment-0001.pgp 

From epssyis at gmail.com  Mon Mar  3 19:53:13 2008
From: epssyis at gmail.com (Edward Savage)
Date: Tue, 4 Mar 2008 11:53:13 +1000
Subject: Summer of code 2008 - cmd.exe compatibility?
In-Reply-To: <558b2f5c0803031552l6694951s1b90bbb4c0a75132@mail.gmail.com>
References: <000001c87d87$c445e0f0$1001a8c0@JasonsPC>
	<558b2f5c0803031552l6694951s1b90bbb4c0a75132@mail.gmail.com>
Message-ID: <d6c5d7290803031753k414d9b5l2c3cbb8e4f0f4a5e@mail.gmail.com>

Does this also include applications that dump data to cmd.exe will
have it show now instead of not as is current?

(Ie Eve Online starts with a console, under windows it will list a
bunch of starting information for the game in cmd, under wine the box
remains empty unless their is a memory error.  The same is the case
for several server applications.)

On Tue, Mar 4, 2008 at 9:52 AM, Lei Zhang <thestig at google.com> wrote:
> On Mon, Mar 3, 2008 at 3:38 PM, Ann & Jason Edmeades <us at edmeades.me.uk> wrote:
>  > Hiya,
>  >
>  >  Out of interest, what is meant by improving cmd.exe compatibility?
>
>  Add support for all the cmd.exe switches and all the dos batch
>  programming constructs?
>
>
>


From dank at kegel.com  Mon Mar  3 20:27:51 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 3 Mar 2008 18:27:51 -0800
Subject: Wine preloader redux
Message-ID: <a71bd89a0803031827x780cb57dv21f5426587af3eee@mail.gmail.com>

Say, it looks like at some point in the past, an alternate
approach was looked at for reserving special addresses:
http://bugzilla.kernel.org/show_bug.cgi?id=2255
If that kernel issue were resolved, would that let us get
rid of the preloader?


From julliard at winehq.org  Tue Mar  4 03:24:25 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 04 Mar 2008 10:24:25 +0100
Subject: Wine preloader redux
In-Reply-To: <a71bd89a0803031827x780cb57dv21f5426587af3eee@mail.gmail.com>
	(Dan Kegel's message of "Mon, 3 Mar 2008 18:27:51 -0800")
References: <a71bd89a0803031827x780cb57dv21f5426587af3eee@mail.gmail.com>
Message-ID: <878x0yn8om.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> Say, it looks like at some point in the past, an alternate
> approach was looked at for reserving special addresses:
> http://bugzilla.kernel.org/show_bug.cgi?id=2255
> If that kernel issue were resolved, would that let us get
> rid of the preloader?

Not really, we'd still need to support older kernels, and the preloader
is more flexible anyway. Why would you want to get rid of it?  We
haven't had any trouble with it for a long time.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Tue Mar  4 04:58:55 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 4 Mar 2008 11:58:55 +0100
Subject: Wine preloader redux
In-Reply-To: <878x0yn8om.fsf@wine.dyndns.org>
References: <a71bd89a0803031827x780cb57dv21f5426587af3eee@mail.gmail.com>
	<878x0yn8om.fsf@wine.dyndns.org>
Message-ID: <200803041158.57792.stefan@codeweavers.com>

Am Dienstag, 4. M?rz 2008 10:24:25 schrieb Alexandre Julliard:
> "Dan Kegel" <dank at kegel.com> writes:
> > Say, it looks like at some point in the past, an alternate
> > approach was looked at for reserving special addresses:
> > http://bugzilla.kernel.org/show_bug.cgi?id=2255
> > If that kernel issue were resolved, would that let us get
> > rid of the preloader?
>
> Not really, we'd still need to support older kernels, and the preloader
> is more flexible anyway. Why would you want to get rid of it?  We
> haven't had any trouble with it for a long time.
Might that fix our problem with the VM limitation for video drivers?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080304/81811506/attachment.pgp 

From julliard at winehq.org  Tue Mar  4 05:04:26 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 04 Mar 2008 12:04:26 +0100
Subject: Wine preloader redux
In-Reply-To: <200803041158.57792.stefan@codeweavers.com> ("Stefan
	=?utf-8?Q?D=C3=B6singer=22's?=
	message of "Tue, 4 Mar 2008 11:58:55 +0100")
References: <a71bd89a0803031827x780cb57dv21f5426587af3eee@mail.gmail.com>
	<878x0yn8om.fsf@wine.dyndns.org>
	<200803041158.57792.stefan@codeweavers.com>
Message-ID: <87ve42lphh.fsf@wine.dyndns.org>

Stefan D?singer <stefan at codeweavers.com> writes:

> Am Dienstag, 4. M?rz 2008 10:24:25 schrieb Alexandre Julliard:
>> "Dan Kegel" <dank at kegel.com> writes:
>> > Say, it looks like at some point in the past, an alternate
>> > approach was looked at for reserving special addresses:
>> > http://bugzilla.kernel.org/show_bug.cgi?id=2255
>> > If that kernel issue were resolved, would that let us get
>> > rid of the preloader?
>>
>> Not really, we'd still need to support older kernels, and the preloader
>> is more flexible anyway. Why would you want to get rid of it?  We
>> haven't had any trouble with it for a long time.
> Might that fix our problem with the VM limitation for video drivers?

No, the memory needs to be reserved one way or another.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Tue Mar  4 06:15:10 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 04:15:10 -0800
Subject: WineHQ should discourage the use of cracks
Message-ID: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>

I've been fighting against the notion that the
wine project encourages cracks for some time now.
Cracked versions of apps are bad because they are
a) illegal (at least in the US),
b) disrespectful of the author of the app, and
c) much more likely to be infected with malware.

One place we still do it is in our appdb ratings definitions;
http://appdb.winehq.org//help/?sTopic=maintainer_ratings
which say
"Gold: Application works flawlessly with some DLL overrides or other
settings, crack etc. "

I propose that we change the appdb ratings definitions
so that an app that only works with a crack gets no higher
than bronze.

Any objections?
- Dan


From dank at kegel.com  Tue Mar  4 06:17:43 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 04:17:43 -0800
Subject: Wine preloader redux
In-Reply-To: <878x0yn8om.fsf@wine.dyndns.org>
References: <a71bd89a0803031827x780cb57dv21f5426587af3eee@mail.gmail.com>
	<878x0yn8om.fsf@wine.dyndns.org>
Message-ID: <a71bd89a0803040417h4a2df8a9n9757e6e95e72c003@mail.gmail.com>

On Tue, Mar 4, 2008 at 1:24 AM, Alexandre Julliard <julliard at winehq.org> wrote:
>  > http://bugzilla.kernel.org/show_bug.cgi?id=2255
>  > If that kernel issue were resolved, would that let us get
>  > rid of the preloader?
>
> Why would you want to get rid of it?  We haven't had any trouble with it for a long time.

Because getting rid of it might make it much easier
to turn winelib into a normal library, thus enabling
plain old linux apps to at least statically link it in
and thereby become able to use windows dlls
without having to use the preloader.


From thunderbird2k at gmx.net  Tue Mar  4 06:40:05 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 04 Mar 2008 13:40:05 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
Message-ID: <20080304124005.51800@gmx.net>

> I've been fighting against the notion that the
> wine project encourages cracks for some time now.
> Cracked versions of apps are bad because they are
> a) illegal (at least in the US),
> b) disrespectful of the author of the app, and
> c) much more likely to be infected with malware.
> 
> One place we still do it is in our appdb ratings definitions;
> http://appdb.winehq.org//help/?sTopic=maintainer_ratings
> which say
> "Gold: Application works flawlessly with some DLL overrides or other
> settings, crack etc. "
> 
> I propose that we change the appdb ratings definitions
> so that an app that only works with a crack gets no higher
> than bronze.
> 
> Any objections?
> - Dan
> 

I believe that here in Europe a crack doesn't have to be illegal. We should fix copy protection support but it is not trivial at all and various games use different protection schemes. Most games really don't work without a crack. Further there are protections like StarForce which we will never be able to support. Limiting apps with cracks to bronze is a bit hard in my opinion.

Roderick
-- 
GMX startet ShortView.de. Hier findest Du Leute mit Deinen Interessen!
Jetzt dabei sein: http://www.shortview.de/?mc=sv_ext_mf at gmx


From dank at kegel.com  Tue Mar  4 07:01:17 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 05:01:17 -0800
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <20080304124005.51800@gmx.net>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<20080304124005.51800@gmx.net>
Message-ID: <a71bd89a0803040501v3a9e4df2n6934c1bc3bf6aef7@mail.gmail.com>

Roderick Colenbrander <thunderbird2k at gmx.net> wrote:
>  I believe that here in Europe a crack doesn't have
> to be illegal. We should fix copy protection support
> but it is not trivial at all... Most games really don't work without a crack. ...
> Limiting apps with cracks to bronze is a bit hard in my opinion.

Hard it may be, but  WineHQ cannot be in a position of encouraging
unlawful behavior in the lawsuit-happy and copyright-holder-friendly
country in which a large number of its developers live and work.

Can we at least agree that needing a crack disqualifies
the app from gold status?


From julliard at winehq.org  Tue Mar  4 07:04:09 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 04 Mar 2008 14:04:09 +0100
Subject: Wine preloader redux
In-Reply-To: <a71bd89a0803040417h4a2df8a9n9757e6e95e72c003@mail.gmail.com>
	(Dan Kegel's message of "Tue, 4 Mar 2008 04:17:43 -0800")
References: <a71bd89a0803031827x780cb57dv21f5426587af3eee@mail.gmail.com>
	<878x0yn8om.fsf@wine.dyndns.org>
	<a71bd89a0803040417h4a2df8a9n9757e6e95e72c003@mail.gmail.com>
Message-ID: <87lk4yljxy.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> Because getting rid of it might make it much easier
> to turn winelib into a normal library, thus enabling
> plain old linux apps to at least statically link it in
> and thereby become able to use windows dlls
> without having to use the preloader.

We could have that as an option for Winelib apps, though I don't think
it would make things really easier, just differently complicated.

-- 
Alexandre Julliard
julliard at winehq.org


From madewokherd+d41d at gmail.com  Tue Mar  4 07:06:28 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Tue, 4 Mar 2008 08:06:28 -0500
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
Message-ID: <ced95fe0803040506n612aad7bpe1dc03c86d9b6de6@mail.gmail.com>

But the wine project DOES encourage the use of cracks. It allows some
applications with unsupported copy-protection to run on Linux, but
only if a crack is used, creating an incentive for some people to use
cracks. QED.

The way to stop doing that would be to support copy protections and
make cracks useless, except for people who would need them anyway.
(This is not easy, I know.)

It's not clear to me what you want to accomplish by changing the
ratings. If games that only work with a crack become bronze instead of
gold, will fewer people really use cracks? Will they decide, from just
looking at the rating, that they don't want to use wine for their app?
Is that really a good thing if it happens?

I don't think this would change the incentives, and thus how much wine
encourages cracks, at all.

So would you be doing this just to make someone I don't know about happy?

That said, I don't really see the fact that it's likely to have no
real effect as a reason not to change the ratings. It just makes doing
it a bit silly.

On Tue, Mar 4, 2008 at 7:15 AM, Dan Kegel <dank at kegel.com> wrote:
> I've been fighting against the notion that the
>  wine project encourages cracks for some time now.
>  Cracked versions of apps are bad because they are
>  a) illegal (at least in the US),
>  b) disrespectful of the author of the app, and
>  c) much more likely to be infected with malware.
>
>  One place we still do it is in our appdb ratings definitions;
>  http://appdb.winehq.org//help/?sTopic=maintainer_ratings
>  which say
>  "Gold: Application works flawlessly with some DLL overrides or other
>  settings, crack etc. "
>
>  I propose that we change the appdb ratings definitions
>  so that an app that only works with a crack gets no higher
>  than bronze.
>
>  Any objections?
>  - Dan
>
>
>



-- 
Vincent Povirk


From dank at kegel.com  Tue Mar  4 07:13:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 05:13:30 -0800
Subject: Wine preloader redux
In-Reply-To: <87lk4yljxy.fsf@wine.dyndns.org>
References: <a71bd89a0803031827x780cb57dv21f5426587af3eee@mail.gmail.com>
	<878x0yn8om.fsf@wine.dyndns.org>
	<a71bd89a0803040417h4a2df8a9n9757e6e95e72c003@mail.gmail.com>
	<87lk4yljxy.fsf@wine.dyndns.org>
Message-ID: <a71bd89a0803040513r4b17fefct432586f3d0b7c1dc@mail.gmail.com>

Alexandre Julliard <julliard at winehq.org> wrote:
> > Because getting rid of it might make it much easier
>  > to turn winelib into a normal library, thus enabling
>  > plain old linux apps to at least statically link it in
>  > and thereby become able to use windows dlls
>  > without having to use the preloader.
>
>  We could have that as an option for Winelib apps, though I don't think
>  it would make things really easier, just differently complicated.

The scenario I'm imagining is:
 Lots of people want to use a particular windows dll in their Linux apps.
 Joe Developer writes a nice wrapper library using winelib to hide
 the fact that win32 is involved at all.
 Fred Developer uses Joe's library in his app.
 Currently, Fred has to switch his app around to be run via the wine preloader.
 With the scheme Mike was thinking of in
 http://bugzilla.kernel.org/show_bug.cgi?id=2255
 Fred wouldn't have to do that; he'd only have to link in a static
 library (named, say, wine-reserve-win32-vma.a), and then
 link in Joe's library any old way.
That sounds a lot easier to me.  Did I miss something?


From julliard at winehq.org  Tue Mar  4 07:20:49 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 04 Mar 2008 14:20:49 +0100
Subject: Wine preloader redux
In-Reply-To: <a71bd89a0803040513r4b17fefct432586f3d0b7c1dc@mail.gmail.com>
	(Dan Kegel's message of "Tue, 4 Mar 2008 05:13:30 -0800")
References: <a71bd89a0803031827x780cb57dv21f5426587af3eee@mail.gmail.com>
	<878x0yn8om.fsf@wine.dyndns.org>
	<a71bd89a0803040417h4a2df8a9n9757e6e95e72c003@mail.gmail.com>
	<87lk4yljxy.fsf@wine.dyndns.org>
	<a71bd89a0803040513r4b17fefct432586f3d0b7c1dc@mail.gmail.com>
Message-ID: <87hcfmlj66.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> The scenario I'm imagining is:
>  Lots of people want to use a particular windows dll in their Linux apps.
>  Joe Developer writes a nice wrapper library using winelib to hide
>  the fact that win32 is involved at all.
>  Fred Developer uses Joe's library in his app.
>  Currently, Fred has to switch his app around to be run via the wine preloader.
>  With the scheme Mike was thinking of in
>  http://bugzilla.kernel.org/show_bug.cgi?id=2255
>  Fred wouldn't have to do that; he'd only have to link in a static
>  library (named, say, wine-reserve-win32-vma.a), and then
>  link in Joe's library any old way.
> That sounds a lot easier to me.  Did I miss something?

I'm not sure you can do the ELF magic with a static library, but even if
you could there's a lot more to the initial setup than the preloader;
that's why winelib apps are shared libraries, so that we can do all the
work that needs to be done before they get loaded.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Tue Mar  4 07:21:15 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 05:21:15 -0800
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <ced95fe0803040506n612aad7bpe1dc03c86d9b6de6@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040506n612aad7bpe1dc03c86d9b6de6@mail.gmail.com>
Message-ID: <a71bd89a0803040521x48b00e80sbfdd266169558e4a@mail.gmail.com>

Vincent Povirk <madewokherd+d41d at gmail.com> wrote:
>  It's not clear to me what you want to accomplish by changing the
>  ratings. If games that only work with a crack become bronze instead of
>  gold, will fewer people really use cracks? Will they decide, from just
>  looking at the rating, that they don't want to use wine for their app?
>  Is that really a good thing if it happens?
>
>  I don't think this would change the incentives, and thus how much wine
>  encourages cracks, at all.

Does Microsoft encourage people to use cracks?  No.
Wine shouldn't either.

The fact is, by telling people about cracks, and by
giving high ratings to apps that only work with cracks, WineHQ
encourages the use of cracks.

The use of cracks is really independent of wine and/or windows,
and it's bad for the Wine project if people start associating
Wine with breaking the law, disrespecting copyright, and encouraging
people to seek out software from seedy, malware-ridden warez sites.
- Dan


From dank at kegel.com  Tue Mar  4 07:23:42 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 05:23:42 -0800
Subject: Wine preloader redux
In-Reply-To: <87hcfmlj66.fsf@wine.dyndns.org>
References: <a71bd89a0803031827x780cb57dv21f5426587af3eee@mail.gmail.com>
	<878x0yn8om.fsf@wine.dyndns.org>
	<a71bd89a0803040417h4a2df8a9n9757e6e95e72c003@mail.gmail.com>
	<87lk4yljxy.fsf@wine.dyndns.org>
	<a71bd89a0803040513r4b17fefct432586f3d0b7c1dc@mail.gmail.com>
	<87hcfmlj66.fsf@wine.dyndns.org>
Message-ID: <a71bd89a0803040523s10fc0f3w4836f9ba39df498c@mail.gmail.com>

Alexandre Julliard <julliard at winehq.org> wrote:
>  I'm not sure you can do the ELF magic with a static library, but even if
>  you could there's a lot more to the initial setup than the preloader;
>  that's why winelib apps are shared libraries, so that we can do all the
>  work that needs to be done before they get loaded.

What's one other thing that couldn't reasonably happen
at global constructor time (i.e., just before main())?


From julliard at winehq.org  Tue Mar  4 07:30:48 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 04 Mar 2008 14:30:48 +0100
Subject: Wine preloader redux
In-Reply-To: <a71bd89a0803040523s10fc0f3w4836f9ba39df498c@mail.gmail.com> (Dan
	Kegel's message of "Tue, 4 Mar 2008 05:23:42 -0800")
References: <a71bd89a0803031827x780cb57dv21f5426587af3eee@mail.gmail.com>
	<878x0yn8om.fsf@wine.dyndns.org>
	<a71bd89a0803040417h4a2df8a9n9757e6e95e72c003@mail.gmail.com>
	<87lk4yljxy.fsf@wine.dyndns.org>
	<a71bd89a0803040513r4b17fefct432586f3d0b7c1dc@mail.gmail.com>
	<87hcfmlj66.fsf@wine.dyndns.org>
	<a71bd89a0803040523s10fc0f3w4836f9ba39df498c@mail.gmail.com>
Message-ID: <87d4qalipj.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> Alexandre Julliard <julliard at winehq.org> wrote:
>>  I'm not sure you can do the ELF magic with a static library, but even if
>>  you could there's a lot more to the initial setup than the preloader;
>>  that's why winelib apps are shared libraries, so that we can do all the
>>  work that needs to be done before they get loaded.
>
> What's one other thing that couldn't reasonably happen
> at global constructor time (i.e., just before main())?

Global constructor time is too late, by this time dependent libraries
will have been loaded and initialized, which will crash and burn if some
of them are Windows dlls. Also you need the environment and command line
setup before the global constructors are run. You also need to setup the
process stack, which you can't do inside a constructor that you have to
return from.

-- 
Alexandre Julliard
julliard at winehq.org


From frick at sc-networks.de  Tue Mar  4 07:34:17 2008
From: frick at sc-networks.de (Christoph Frick)
Date: Tue, 4 Mar 2008 14:34:17 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
Message-ID: <20080304133414.GZ353@byleth.sc-networks.de>

On Tue, Mar 04, 2008 at 04:15:10AM -0800, Dan Kegel wrote:

> I propose that we change the appdb ratings definitions so that an app
> that only works with a crack gets no higher than bronze.

how about:

give it the next state to gold and add a appdb flag, that states "may
only work if some <put in legaly correct term for a crack here>" flag to
the app and then provide the maintainers with a proper explanation of
the flag in the UI. if the flag is set, then do not allow the highest
state - even if is rated gold. then take of some weeks and weed through
the appdb and fix all occurences of the word crack.

-- 
cu
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 163 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080304/619c04e0/attachment.pgp 

From madewokherd+d41d at gmail.com  Tue Mar  4 07:43:16 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Tue, 4 Mar 2008 08:43:16 -0500
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040521x48b00e80sbfdd266169558e4a@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040506n612aad7bpe1dc03c86d9b6de6@mail.gmail.com>
	<a71bd89a0803040521x48b00e80sbfdd266169558e4a@mail.gmail.com>
Message-ID: <ced95fe0803040543v147bc064pe9aaa9ab584e185c@mail.gmail.com>

On Tue, Mar 4, 2008 at 8:21 AM, Dan Kegel <dank at kegel.com> wrote:
>  Does Microsoft encourage people to use cracks?  No.
>  Wine shouldn't either.
>
Microsoft doesn't need to. Software developers have good reasons make
sure their copy protections will work on Windows (for most people
anyway).

>  The fact is, by telling people about cracks, and by
>  giving high ratings to apps that only work with cracks, WineHQ
>  encourages the use of cracks.
>
I would object to removing information about cracks (unless, perhaps,
the cracks aren't needed and would lead users to do tweaking that is
unnecessary and therefore risky and bad) from the appdb. The appdb is
always competing with other sources of app support. When it stops
providing the information that people want, and that information is
available elsewhere, people will go elsewhere. Do I have to explain
why that is bad for users and for the wine project?

>  The use of cracks is really independent of wine and/or windows,
>  and it's bad for the Wine project if people start associating
>  Wine with breaking the law, disrespecting copyright, and encouraging
>  people to seek out software from seedy, malware-ridden warez sites.
>  - Dan
>
I thought that was bad for copyright law and DRM (since the goal here
is not to use software without paying for it but just to run it on a
different platform, but that goal can't be met without breaking the
law and the DRM), but maybe I don't think about this the way most
people do?

-- 
Vincent Povirk


From vit.hrachovy at sandbox.cz  Tue Mar  4 07:49:39 2008
From: vit.hrachovy at sandbox.cz (Vit Hrachovy)
Date: Tue, 04 Mar 2008 14:49:39 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
Message-ID: <47CD5373.8070804@sandbox.cz>

Dan Kegel wrote:
> I've been fighting against the notion that the
> wine project encourages cracks for some time now.
> Cracked versions of apps are bad because they are
> a) illegal (at least in the US),
> b) disrespectful of the author of the app, and
> c) much more likely to be infected with malware.
> 
> One place we still do it is in our appdb ratings definitions;
> http://appdb.winehq.org//help/?sTopic=maintainer_ratings
> which say
> "Gold: Application works flawlessly with some DLL overrides or other
> settings, crack etc. "
> 
> I propose that we change the appdb ratings definitions
> so that an app that only works with a crack gets no higher
> than bronze.
> 
> Any objections?
> - Dan

Hi Dan,

in fact a DLL override may be another form of 'crack' - given the 
situation I'm not owner of a Windows copy and need to override MS DLL 
which is not free to use without Windows license.

I think we should not mix up the functionality ratings with legality 
ratings. I consider this a politicspeak, not techspeak.

Given the problem above - we can solve it by rewording in a similar 
spirit but leaving the bad word out:

"Gold: Application works flawlessly with some DLL overrides or other
settings, etc. Copy protection issues are not considered as issues here."

Regards
Vit


From dank at kegel.com  Tue Mar  4 07:47:49 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 05:47:49 -0800
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <ced95fe0803040543v147bc064pe9aaa9ab584e185c@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040506n612aad7bpe1dc03c86d9b6de6@mail.gmail.com>
	<a71bd89a0803040521x48b00e80sbfdd266169558e4a@mail.gmail.com>
	<ced95fe0803040543v147bc064pe9aaa9ab584e185c@mail.gmail.com>
Message-ID: <a71bd89a0803040547t67009b78hd127b7052315f7a8@mail.gmail.com>

Vincent Povirk <madewokherd+d41d at gmail.com> wrote:
>  >  The fact is, by telling people about cracks, and by
>  >  giving high ratings to apps that only work with cracks, WineHQ
>  >  encourages the use of cracks.
>  >
>  I would object to removing information about cracks

Would you also object to removing high ratings from
apps that need cracks?    IMHO "Gold" ought not to
imply that one has to seek out a crack (and thereby
potentially infect your machine with malware).


From dank at kegel.com  Tue Mar  4 07:51:51 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 05:51:51 -0800
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <47CD5373.8070804@sandbox.cz>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<47CD5373.8070804@sandbox.cz>
Message-ID: <a71bd89a0803040551g40e788b8n325d3581b9f7a318@mail.gmail.com>

Vit Hrachovy <vit.hrachovy at sandbox.cz> wrote:
>  in fact a DLL override may be another form of 'crack' - given the
>  situation I'm not owner of a Windows copy and need to override MS DLL
>  which is not free to use without Windows license.

That's much less risky.   First off, most
Wine users currently happen to have a Windows license,
due to the Microsoft tax.  Second, most of the MS DLLs
people need to grab can be downloaded directly from
Microsoft, thus avoiding malware exposure.

>  Given the problem above - we can solve it by rewording in a similar
>  spirit but leaving the bad word out:
>
>  "Gold: Application works flawlessly with some DLL overrides or other
>  settings, etc. Copy protection issues are not considered as issues here."

Sorry, that doesn't do it for me.  Apps that need cracks are simply
not convenient or safe enough to merit a gold rating, IMHO.
- Dan


From vit.hrachovy at sandbox.cz  Tue Mar  4 08:02:39 2008
From: vit.hrachovy at sandbox.cz (Vit Hrachovy)
Date: Tue, 04 Mar 2008 15:02:39 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040551g40e788b8n325d3581b9f7a318@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>	
	<47CD5373.8070804@sandbox.cz>
	<a71bd89a0803040551g40e788b8n325d3581b9f7a318@mail.gmail.com>
Message-ID: <47CD567F.3020507@sandbox.cz>

Dan Kegel wrote:
>>  "Gold: Application works flawlessly with some DLL overrides or other
>>  settings, etc. Copy protection issues are not considered as issues here."
> 
> Sorry, that doesn't do it for me.  Apps that need cracks are simply
> not convenient or safe enough to merit a gold rating, IMHO.
> - Dan

O.K. So I don't agree with Your opinion.

Gold means for me the application works for me as I expect it to work.

Copy protection is for me just an obstacle to skip through - I crack all 
the legal SW I've bought, because I need comfort using the application, 
not being whipped up by stupid DRM.

My priority is SW FUNCTIONALITY.

For copy protection functionalities we shall then have separate entries 
in AppDB - as I'm interested in my app functionality, not its DRM.

I'm happy with the current AppDB state - AppDB is for users, not for 
patent holders.

Regards
Vit


From dank at kegel.com  Tue Mar  4 08:03:34 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 06:03:34 -0800
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <47CD567F.3020507@sandbox.cz>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<47CD5373.8070804@sandbox.cz>
	<a71bd89a0803040551g40e788b8n325d3581b9f7a318@mail.gmail.com>
	<47CD567F.3020507@sandbox.cz>
Message-ID: <a71bd89a0803040603k628deda9g33837e549f89cfed@mail.gmail.com>

Vit Hrachovy <vit.hrachovy at sandbox.cz> wrote:
>  > Apps that need cracks are simply
>  > not convenient or safe enough to merit a gold rating, IMHO.
>
>  Copy protection is for me just an obstacle to skip through...

I think you're setting the bar too low on usability.
Software should not require jumping over obstacles of any sort to reach gold.

Platinum should be obstacle-free and also visually nearly perfect.
- Dan


From dank at kegel.com  Tue Mar  4 07:56:51 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 05:56:51 -0800
Subject: Only three DLLs still failing tests!
Message-ID: <a71bd89a0803040556k3a533de6yebfdb81bb0a7a98d@mail.gmail.com>

For me, only user32, gdi32, and urlmon are failing tests on linux these days.
And there's only one failure in urlmon: stream.c.

Jacek, can you have a look at that urlmon failure?
It'd be cool to be down to just two dlls with test failures!
- Dan


From mrmessiah at gmail.com  Tue Mar  4 08:27:11 2008
From: mrmessiah at gmail.com (Chris Howe)
Date: Tue, 4 Mar 2008 14:27:11 +0000
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040603k628deda9g33837e549f89cfed@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<47CD5373.8070804@sandbox.cz>
	<a71bd89a0803040551g40e788b8n325d3581b9f7a318@mail.gmail.com>
	<47CD567F.3020507@sandbox.cz>
	<a71bd89a0803040603k628deda9g33837e549f89cfed@mail.gmail.com>
Message-ID: <39c14e440803040627w8311136j39d4f3edbd23337a@mail.gmail.com>

I totally get why you want to make it look like Wine isn't encouraging
cracks, but if that's all that's keeping an app from plat status, one
notch should be enough. How about

Gold: Application works flawlessly with some DLL overrides or other
settings etc. Application may not work correctly due to unsupported
copy protection.

It sounds a bit less like Wine directly saying "works if you crack it".

The thing is, if you bust an app down to bronze that works fine except
for a copy protection issue, all that's going to happen is people are
going to post "wtf? It works fine with a crack" anyway. Especially when
cracking an app you have a right to use isn't illegal in a lot of
juristictions.

--
Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080304/c740bba7/attachment.htm 

From kai.blin at gmail.com  Tue Mar  4 08:35:11 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Tue, 4 Mar 2008 15:35:11 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
Message-ID: <200803041535.18561.kai.blin@gmail.com>

On Tuesday 04 March 2008 13:15:10 Dan Kegel wrote:
> I've been fighting against the notion that the
> wine project encourages cracks for some time now.
> Cracked versions of apps are bad because they are
> a) illegal (at least in the US),

No argument on the US part. I'm still convinced that by EU laws, you're 
allowed to crack an app you bought in order to make it run on your software. 
As this hasn't been tested in court yet, though, I'll concede.

> b) disrespectful of the author of the app, and

Sometimes I wonder if a "look, we found a legal use for a crack" wouldn't be 
something that could move a publisher to help make his stuff work. Of course 
most publishers probably wouldn't agree to my reasoning in a), making b) a 
moot point.

> c) much more likely to be infected with malware.

No arguments here.

> One place we still do it is in our appdb ratings definitions;
> http://appdb.winehq.org//help/?sTopic=maintainer_ratings
> which say
> "Gold: Application works flawlessly with some DLL overrides or other
> settings, crack etc. "
>
> I propose that we change the appdb ratings definitions
> so that an app that only works with a crack gets no higher
> than bronze.

Fine with me. I agree with your reasoning of having to avoid being associated 
with malware and illegal activities. I think a better solution even for my 
point b) is to publicly support publishers who play nice. Did I mention I 
really like the fact that Blizzard finally decided to not force me to search 
for my star craft cd anymore? :)

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080304/33bcd007/attachment.pgp 

From winehacker at gmail.com  Tue Mar  4 08:46:03 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 4 Mar 2008 09:46:03 -0500
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040547t67009b78hd127b7052315f7a8@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040506n612aad7bpe1dc03c86d9b6de6@mail.gmail.com>
	<a71bd89a0803040521x48b00e80sbfdd266169558e4a@mail.gmail.com>
	<ced95fe0803040543v147bc064pe9aaa9ab584e185c@mail.gmail.com>
	<a71bd89a0803040547t67009b78hd127b7052315f7a8@mail.gmail.com>
Message-ID: <19e31a080803040646g6672b6ecp2b8c306fec3adca0@mail.gmail.com>

On Tue, Mar 4, 2008 at 8:47 AM, Dan Kegel <dank at kegel.com> wrote:
>  Would you also object to removing high ratings from
>  apps that need cracks?    IMHO "Gold" ought not to
>  imply that one has to seek out a crack (and thereby
>  potentially infect your machine with malware).

To me the whole concept of Gold meaning anything that works our of the
box with no dlloverride changes, is broken. I am willing to concede
Bronze for cracks if Silver means dlloverrides depending on MSFT
runtimes. I have ethical reasons for this that transcend copyright.
Wine dcom development stagnated for too long because we were able to
get by with dcom9x and the thought of certifying an application as
Gold with Microsoft dlls hurts the project long term more than it
helps.


-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From zgold550 at gmail.com  Tue Mar  4 08:48:50 2008
From: zgold550 at gmail.com (Zachary Goldberg)
Date: Tue, 4 Mar 2008 09:48:50 -0500
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <47CD567F.3020507@sandbox.cz>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<47CD5373.8070804@sandbox.cz>
	<a71bd89a0803040551g40e788b8n325d3581b9f7a318@mail.gmail.com>
	<47CD567F.3020507@sandbox.cz>
Message-ID: <b050a5e70803040648g3906d8ebo9b6bd6e96218ca8e@mail.gmail.com>

On Tue, Mar 4, 2008 at 9:02 AM, Vit Hrachovy <vit.hrachovy at sandbox.cz> wrote:
> Dan Kegel wrote:
>  >>  "Gold: Application works flawlessly with some DLL overrides or other
>  >>  settings, etc. Copy protection issues are not considered as issues here."
>  >
>  > Sorry, that doesn't do it for me.  Apps that need cracks are simply
>  > not convenient or safe enough to merit a gold rating, IMHO.
>  > - Dan
>
>  O.K. So I don't agree with Your opinion.
>
>  Gold means for me the application works for me as I expect it to work.

>
>  Copy protection is for me just an obstacle to skip through - I crack all
>  the legal SW I've bought, because I need comfort using the application,
>  not being whipped up by stupid DRM.
>

That opinion unfortunatly is not one a community which may be in the
legal line of site can take.  Dan mentioned before that a large number
of Wine's devs are in the US and in the US using such tactics are
illegal.  The Wine community should respect that, even if it may mean
hindering some usability in the short term.

In an ideal world I agree with you, I am also of the opinion that 'I
bought the software, let me use it on any OS i please'.  However, if
something like copy protection prevents such a thing and the only way
around it use to use a technique deemed illegal by our government we
have no choice but to comply as a community or face really a rather
expensive legal battle.  That doesn't mean we can't make a fuss about
it; attempt to change such a law civilly but in the short term, life's
tough.

>  My priority is SW FUNCTIONALITY.
>
>  For copy protection functionalities we shall then have separate entries
>  in AppDB - as I'm interested in my app functionality, not its DRM.
>
>  I'm happy with the current AppDB state - AppDB is for users, not for
>  patent holders.
>

Sadly in this world we have to always be conscious of both.

>  Regards
>  Vit
>
>
>

Also, +1 to dan's arguement about modifying the definitions of
Gold/Platinum.  Gold should really imply works out of the box with
minor gaps in functionality or crashes, NOT works with overrides +
cracks.  Platinum should imply works out of the box no excuses 100%
working.

I'm also intruiged by the idea of specially flagging apps that work
but need overrides / cracks; if properly thought out that might be a
reasonable solution as well.


-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From jacek at codeweavers.com  Tue Mar  4 09:19:08 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Tue, 04 Mar 2008 16:19:08 +0100
Subject: Only three DLLs still failing tests!
In-Reply-To: <a71bd89a0803040556k3a533de6yebfdb81bb0a7a98d@mail.gmail.com>
References: <a71bd89a0803040556k3a533de6yebfdb81bb0a7a98d@mail.gmail.com>
Message-ID: <47CD686C.1080005@codeweavers.com>

Hi Dan,

Dan Kegel wrote:
> Jacek, can you have a look at that urlmon failure?
> It'd be cool to be down to just two dlls with test failures!
>   

Can you send me urlmon logs? It doesn't fail for me and I can't see 
failures reports on test.winehq.org.


Thanks,
    Jacek


From frick at sc-networks.de  Tue Mar  4 09:23:46 2008
From: frick at sc-networks.de (Christoph Frick)
Date: Tue, 4 Mar 2008 16:23:46 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <200803041535.18561.kai.blin@gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<200803041535.18561.kai.blin@gmail.com>
Message-ID: <20080304152346.GF353@byleth.sc-networks.de>

On Tue, Mar 04, 2008 at 03:35:11PM +0100, Kai Blin wrote:

> No argument on the US part. I'm still convinced that by EU laws,
> you're allowed to crack an app you bought in order to make it run on
> your software.  As this hasn't been tested in court yet, though, I'll
> concede.

IANAL, but since 2008 germany adopted a law from a EU proposal (maybe
other countries added it before), that disallows circumventing copy
protections at all. so in theory your statement is not true any longer
for the EU.

-- 
cu
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 163 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080304/70982cfd/attachment.pgp 

From madewokherd+d41d at gmail.com  Tue Mar  4 09:31:40 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Tue, 4 Mar 2008 10:31:40 -0500
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040547t67009b78hd127b7052315f7a8@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040506n612aad7bpe1dc03c86d9b6de6@mail.gmail.com>
	<a71bd89a0803040521x48b00e80sbfdd266169558e4a@mail.gmail.com>
	<ced95fe0803040543v147bc064pe9aaa9ab584e185c@mail.gmail.com>
	<a71bd89a0803040547t67009b78hd127b7052315f7a8@mail.gmail.com>
Message-ID: <ced95fe0803040731i14c0b137ifb0f2e58f490a866@mail.gmail.com>

On Tue, Mar 4, 2008 at 8:47 AM, Dan Kegel <dank at kegel.com> wrote:
>  Would you also object to removing high ratings from
>  apps that need cracks?    IMHO "Gold" ought not to
>  imply that one has to seek out a crack (and thereby
>  potentially infect your machine with malware).
>
Not in principle. The rating system doesn't really change the
information available on the site. For anything that's not Garbage or
Platinum, it's important anyway to look at the entry for more details.

I do agree that treating cracks differently from patches or overrides
would be inconsistent, as those are just as difficult to set up.

As others have pointed out, ratings actually express two different
things: the maximum possible functionality of an app and the
difficulty involved in getting that functionality. Right now, the only
rating that addresses difficulty is Platinum (an app that requires an
override or hack can be anywhere from Bronze to Gold). The ratings
currently look like this:

Garbage: No functionality, impossible to set up
Bronze: Somewhat functional, may require hacks
Silver: Mostly functional, may require hacks
Gold: Fully functional, requires hacks
Platinum: Fully functional, does not require hacks

Something like this might actually make more sense:

Garbage: No functionality, impossible to set up
Bronze: Somewhat functional, may require hacks
Silver: Mostly functional, requires hacks
Gold: Mostly functional, does not require hacks
Platinum: Fully functional, does not require hacks

This would give a fair amount of information about both the level of
functionality and the difficulty, and it would mean anything that
requires hacks cannot be rated Gold. It would also mean a program that
works only with a crack can be rated Silver, but I can't come up with
anything consistent that would force them to be rated Bronze.

-- 
Vincent Povirk


From ben at atomnet.co.uk  Tue Mar  4 09:38:20 2008
From: ben at atomnet.co.uk (Ben Hodgetts)
Date: Tue, 04 Mar 2008 15:38:20 +0000
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <20080304133414.GZ353@byleth.sc-networks.de>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<20080304133414.GZ353@byleth.sc-networks.de>
Message-ID: <47CD6CEC.1070800@atomnet.co.uk>

I'm against lowering the rating for an app that requires a "No CD Patch" 
to run simply because they aren't hard to find or install (normally 
anyway) and when used restores full functionality to the game. Much like 
having to use a native DLL. Lower ratings should be reserved for games 
that have problems which are considerably harder to get working or have 
unresolvable issues (of varying degrees). I have little respect for 
copy-protection schemes due to either a) underhanded methods of 
operation or b) the mess they can create. Normally the only thing they 
end up doing is stopping people that legally own the games from actually 
using them (and this is a good example of that). If people really want 
to pirate games then they wouldn't have much of an issue spending 2 
minutes longer looking for something.

Just my (slightly irritated) 2 pence.

Ben H.


From sbrown7 at umbc.edu  Tue Mar  4 10:02:08 2008
From: sbrown7 at umbc.edu (Steve Brown)
Date: Tue, 4 Mar 2008 11:02:08 -0500 (EST)
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0803041047110.5508@cadence2.gl.umbc.edu>

On Tue, 4 Mar 2008, Dan Kegel wrote:

> "Gold: Application works flawlessly with some DLL overrides or other
> settings, crack etc. "
>
> I propose that we change the appdb ratings definitions
> so that an app that only works with a crack gets no higher
> than bronze.

I have mixed emotions on this -- I can understand the reluctance of folks, 
that are only running an app for the purpose of testing, to shelling out 
several kilobucks for a license... but I also am morally opposed to piracy 
(it's why I got into the Linux realm in the first place).  That said, 
there are a couple proprietary programs that the users I support use that 
have such poor support from the vendor that the users go ahead and buy the 
licenses, but install a crack code -- just because it's easier than 
dealing with the vendors... sigh.

I would vote for trying to find out what the cracks mentioned in the 
database are _really_ about.  Are they to allow offline playing of a game 
that constantly "calls home," license fee avoidance, running on a non-supported
platform, other stuff?  I wouldn't want a tester to "have" to lie about 
whether or not they were running a fully licensed version just to let us 
know about real issues.

Steve Brown
sbrown7 at umbc.edu


From kai.blin at gmail.com  Tue Mar  4 10:08:19 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Tue, 4 Mar 2008 17:08:19 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <20080304152346.GF353@byleth.sc-networks.de>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<200803041535.18561.kai.blin@gmail.com>
	<20080304152346.GF353@byleth.sc-networks.de>
Message-ID: <200803041708.19713.kai.blin@gmail.com>

On Tuesday 04 March 2008 16:23:46 Christoph Frick wrote:
> On Tue, Mar 04, 2008 at 03:35:11PM +0100, Kai Blin wrote:
> > No argument on the US part. I'm still convinced that by EU laws,
> > you're allowed to crack an app you bought in order to make it run on
> > your software.  As this hasn't been tested in court yet, though, I'll
> > concede.
>
> IANAL, but since 2008 germany adopted a law from a EU proposal (maybe
> other countries added it before), that disallows circumventing copy
> protections at all. so in theory your statement is not true any longer
> for the EU.

Und soweit ich wei? l?uft da gerade eine Verfassungsklage dagegen. Aber 
stimmt, das hatte ich vergessen. :)

Gru?,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080304/13e234ba/attachment.pgp 

From kai.blin at gmail.com  Tue Mar  4 10:14:55 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Tue, 4 Mar 2008 17:14:55 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <Pine.LNX.4.64.0803041047110.5508@cadence2.gl.umbc.edu>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<Pine.LNX.4.64.0803041047110.5508@cadence2.gl.umbc.edu>
Message-ID: <200803041714.55996.kai.blin@gmail.com>

On Tuesday 04 March 2008 17:02:08 Steve Brown wrote:

> I have mixed emotions on this -- I can understand the reluctance of folks,
> that are only running an app for the purpose of testing, to shelling out
> several kilobucks for a license... but I also am morally opposed to piracy
> (it's why I got into the Linux realm in the first place).  That said,
> there are a couple proprietary programs that the users I support use that
> have such poor support from the vendor that the users go ahead and buy the
> licenses, but install a crack code -- just because it's easier than
> dealing with the vendors... sigh.

Whoa there. That's not what we're talking about. We were never talking about 
piracy or anything like that. It seems like in lots of countries even 
cracking a program you do have a license for is illegal, and that's the only 
use of cracks that Wine ever was talking about.

I agree with Dan that an app where I might have to violate a law to be able to 
run it (even if I rightfully own a license and the system requirements 
said "Win98 or better" and I installed Linux) should not be Gold-rated. Steve 
Edwards also has a point with the psychological effect that might have on 
development.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080304/1db72ba0/attachment.pgp 

From sbrown7 at umbc.edu  Tue Mar  4 10:22:26 2008
From: sbrown7 at umbc.edu (Steve Brown)
Date: Tue, 4 Mar 2008 11:22:26 -0500 (EST)
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040603k628deda9g33837e549f89cfed@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<47CD5373.8070804@sandbox.cz>
	<a71bd89a0803040551g40e788b8n325d3581b9f7a318@mail.gmail.com>
	<47CD567F.3020507@sandbox.cz>
	<a71bd89a0803040603k628deda9g33837e549f89cfed@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0803041119540.5508@cadence2.gl.umbc.edu>

On Tue, 4 Mar 2008, Dan Kegel wrote:

> Vit Hrachovy <vit.hrachovy at sandbox.cz> wrote:
>> > Apps that need cracks are simply
>> > not convenient or safe enough to merit a gold rating, IMHO.
>>
>>  Copy protection is for me just an obstacle to skip through...
>
> I think you're setting the bar too low on usability.
> Software should not require jumping over obstacles of any sort to reach gold.

Many folks feel that they have to jump over the same bars on Windows -- 
Vit included, it seems.  Much of the commercial software I have to support 
is barely usable on its intended platform (wouldn't even get close to 
silver without "cracks").

Steve Brown
sbrown7 at umbc.edu


From kai.blin at gmail.com  Tue Mar  4 10:18:28 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Tue, 4 Mar 2008 17:18:28 +0100
Subject: Reply-to munging.... (Was: Re: WineHQ should discourage the use of
	cracks)
In-Reply-To: <200803041708.19713.kai.blin@gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<20080304152346.GF353@byleth.sc-networks.de>
	<200803041708.19713.kai.blin@gmail.com>
Message-ID: <200803041718.28812.kai.blin@gmail.com>

On Tuesday 04 March 2008 17:08:19 Kai Blin wrote:

> Und soweit ich wei? l?uft da gerade eine Verfassungsklage dagegen. Aber
> stimmt, das hatte ich vergessen. :)

It's time for another "reply-to munging considered harmful" post, I guess. I 
actually wanted to send this to Christoph. If anyone cares, it says
"IIRC there's someone suing against that new law already. But you're right, I 
forgot about that one."

Sorry about that, I'm kind of used to pressing 'l' if I want to reply to the 
list and 'r' if I want to reply to the author. For wine-devel, I need to 
remember to press 'A' to send to the author.

Cheers,
Kai
-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080304/6697cb2a/attachment.pgp 

From me at gn0me.org  Tue Mar  4 10:34:20 2008
From: me at gn0me.org (Guillaume VanderEst)
Date: Tue, 4 Mar 2008 08:34:20 -0800
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040547t67009b78hd127b7052315f7a8@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040506n612aad7bpe1dc03c86d9b6de6@mail.gmail.com>
	<a71bd89a0803040521x48b00e80sbfdd266169558e4a@mail.gmail.com>
	<ced95fe0803040543v147bc064pe9aaa9ab584e185c@mail.gmail.com>
	<a71bd89a0803040547t67009b78hd127b7052315f7a8@mail.gmail.com>
Message-ID: <2e3390300803040834r4f38224t528d682ec896d24@mail.gmail.com>

On Tue, Mar 4, 2008 at 5:47 AM, Dan Kegel <dank at kegel.com> wrote:

>
> Would you also object to removing high ratings from
> apps that need cracks?    IMHO "Gold" ought not to
> imply that one has to seek out a crack (and thereby
> potentially infect your machine with malware).


If you think about it, we could technically add cracks to the AppDB and
give them platinum rating if they're doing what they're supposed to be
doing. ;-)

But in semi-seriousness, I agree completely.  Legalities of cracking aside,
we're trying to judge if the application works perfectly.  Wording regarding
cracking should probably be removed from the site as it sets a weird tone,
but the RATING of a program should be completely dependent on its working
state out of the box.

If a DLL isn't supported, or something isn't yet programmed, then that is
the
curse of working on a project that isn't 1.0 yet. :-)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080304/5cc3332f/attachment.htm 

From madewokherd+d41d at gmail.com  Tue Mar  4 10:47:57 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Tue, 4 Mar 2008 11:47:57 -0500
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <2e3390300803040834r4f38224t528d682ec896d24@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040506n612aad7bpe1dc03c86d9b6de6@mail.gmail.com>
	<a71bd89a0803040521x48b00e80sbfdd266169558e4a@mail.gmail.com>
	<ced95fe0803040543v147bc064pe9aaa9ab584e185c@mail.gmail.com>
	<a71bd89a0803040547t67009b78hd127b7052315f7a8@mail.gmail.com>
	<2e3390300803040834r4f38224t528d682ec896d24@mail.gmail.com>
Message-ID: <ced95fe0803040847x174f522et59b53362f024b41b@mail.gmail.com>

On Tue, Mar 4, 2008 at 11:34 AM, Guillaume VanderEst <me at gn0me.org> wrote:
> But in semi-seriousness, I agree completely.  Legalities of cracking aside,
> we're trying to judge if the application works perfectly.  Wording regarding
> cracking should probably be removed from the site as it sets a weird tone,
>  but the RATING of a program should be completely dependent on its working
> state out of the box.

I have to disagree here. The appdb is where people go to find out
about application compatibility, providing some information related to
the question "Will I be able to run this app in Wine, and if so how?".
If we only based ratings on how well applications work out of the box,
a Garbage rating would apply to any app that requires some extra step
to run, even if the extra step is grabbing MFC42.dll and putting it in
system32, as well as any app that no one has been able to run yet.
That's not very useful.

> If a DLL isn't supported, or something isn't yet programmed, then that is the
> curse of working on a project that isn't 1.0 yet. :-)

Not at all. We can expect to see such things happen long after 1.0 is released.

-- 
Vincent Povirk


From dank at kegel.com  Tue Mar  4 10:53:22 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 08:53:22 -0800
Subject: Only three DLLs still failing tests!
In-Reply-To: <47CD686C.1080005@codeweavers.com>
References: <a71bd89a0803040556k3a533de6yebfdb81bb0a7a98d@mail.gmail.com>
	<47CD686C.1080005@codeweavers.com>
Message-ID: <a71bd89a0803040853u9e890a0v6765f8afa5b523b@mail.gmail.com>

On Tue, Mar 4, 2008 at 7:19 AM, Jacek Caban <jacek at codeweavers.com> wrote:
>  Can you send me urlmon logs? It doesn't fail for me and I can't see
>  failures reports on test.winehq.org.

False alarm!  I had some crud in my tree.
So we *are* down to just two DLLs with failing tests!
- Dan


From dank at kegel.com  Tue Mar  4 10:58:56 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 08:58:56 -0800
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <ced95fe0803040731i14c0b137ifb0f2e58f490a866@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040506n612aad7bpe1dc03c86d9b6de6@mail.gmail.com>
	<a71bd89a0803040521x48b00e80sbfdd266169558e4a@mail.gmail.com>
	<ced95fe0803040543v147bc064pe9aaa9ab584e185c@mail.gmail.com>
	<a71bd89a0803040547t67009b78hd127b7052315f7a8@mail.gmail.com>
	<ced95fe0803040731i14c0b137ifb0f2e58f490a866@mail.gmail.com>
Message-ID: <a71bd89a0803040858g7e568f0clb225d72190b99e31@mail.gmail.com>

On Tue, Mar 4, 2008 at 7:31 AM, Vincent Povirk
<madewokherd+d41d at gmail.com> wrote:
>  Something like this might actually make more sense:
>
>  Garbage: No functionality, impossible to set up
>  Bronze: Somewhat functional, may require hacks
>  Silver: Mostly functional, requires hacks
>  Gold: Mostly functional, does not require hacks
>  Platinum: Fully functional, does not require hacks
>
>  This would give a fair amount of information about both the level of
>  functionality and the difficulty, and it would mean anything that
>  requires hacks cannot be rated Gold.

That's a step in the right direction.  As long as we don't explicitly
mention cracks, I'm ok with that.
- Dan


From tzi063 at student.uib.no  Tue Mar  4 09:23:16 2008
From: tzi063 at student.uib.no (Tomas Zijdemans)
Date: Tue, 04 Mar 2008 16:23:16 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <200803041535.18561.kai.blin@gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<200803041535.18561.kai.blin@gmail.com>
Message-ID: <fqjpf1$gc6$1@ger.gmane.org>

> No argument on the US part. I'm still convinced that by EU laws, you're 
> allowed to crack an app you bought in order to make it run on your software. 
> As this hasn't been tested in court yet, though, I'll concede.

This has been tested in the Norwegian court (the famous DVD-Jon case). 
It was ruled that developing, distributing and applying software to make 
software work on your OS is perfectly legal. But then again we don't 
have a horde of those nasty lobbyists over here.

Cheers,

Tomas



From msclrhd at googlemail.com  Tue Mar  4 09:25:56 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 4 Mar 2008 15:25:56 +0000
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <b050a5e70803040648g3906d8ebo9b6bd6e96218ca8e@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<47CD5373.8070804@sandbox.cz>
	<a71bd89a0803040551g40e788b8n325d3581b9f7a318@mail.gmail.com>
	<47CD567F.3020507@sandbox.cz>
	<b050a5e70803040648g3906d8ebo9b6bd6e96218ca8e@mail.gmail.com>
Message-ID: <3f4fd2640803040725m5293d1b8r2d1f9df4c19e7d07@mail.gmail.com>

On 04/03/2008, Zachary Goldberg <zgold550 at gmail.com> wrote:
> On Tue, Mar 4, 2008 at 9:02 AM, Vit Hrachovy <vit.hrachovy at sandbox.cz> wrote:
>  >  My priority is SW FUNCTIONALITY.
>  >
>  >  For copy protection functionalities we shall then have separate entries
>  >  in AppDB - as I'm interested in my app functionality, not its DRM.
>  >
>  >  I'm happy with the current AppDB state - AppDB is for users, not for
>  >  patent holders.
>
> Sadly in this world we have to always be conscious of both.

I agree. Applications should just work on Wine. If they don't (through
copy protection or missing functionality), it is misleading to
advertise an application as being Gold or Platinum.

>  Also, +1 to dan's arguement about modifying the definitions of
>  Gold/Platinum.  Gold should really imply works out of the box with
>  minor gaps in functionality or crashes, NOT works with overrides +
>  cracks.  Platinum should imply works out of the box no excuses 100%
>  working.

+1

>  I'm also intruiged by the idea of specially flagging apps that work
>  but need overrides / cracks; if properly thought out that might be a
>  reasonable solution as well.

+1

How about if there are two statuses? The first is with no
overrides/cracks/etc., while the second is with documented ways to get
the application working. If the application requires a crack to get
around copy protection, this should be preceeded with a disclaimer
saying that this is not supported by WineHQ, is illegal in some
countries and is likely to contain malware.

For applications like StarCraft, where a patch is available by the
company that removes the copy protection legally, this should be
documented in AppDB and the rating should use the patch by default.

- Reece


From alex at thehandofagony.com  Tue Mar  4 11:53:47 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Tue, 4 Mar 2008 18:53:47 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040858g7e568f0clb225d72190b99e31@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040731i14c0b137ifb0f2e58f490a866@mail.gmail.com>
	<a71bd89a0803040858g7e568f0clb225d72190b99e31@mail.gmail.com>
Message-ID: <200803041853.48238.alex@thehandofagony.com>

> On Tue, Mar 4, 2008 at 7:31 AM, Vincent Povirk
>
> <madewokherd+d41d at gmail.com> wrote:
> >  Something like this might actually make more sense:
> >
> >  Garbage: No functionality, impossible to set up
> >  Bronze: Somewhat functional, may require hacks
> >  Silver: Mostly functional, requires hacks
> >  Gold: Mostly functional, does not require hacks
> >  Platinum: Fully functional, does not require hacks
> >
> >  This would give a fair amount of information about both the level of
> >  functionality and the difficulty, and it would mean anything that
> >  requires hacks cannot be rated Gold.
>
> That's a step in the right direction.  As long as we don't explicitly
> mention cracks, I'm ok with that.
> - Dan


I'm not sure if we should remove the option for 'fully functional, requires 
hacks'.  A lot of people come to the AppDB to find out how they can make 
their apps work, and are more interested in the end result as opposed to how 
to get there.  

It might not be a good idea, but we could always introduce a new rating so 
that we have

> >  Garbage: No functionality, impossible to set up
> >  Bronze: Somewhat functional, may require hacks
> >  Silver: Mostly functional, requires hacks
> >  Gold: Mostly functional, does not require hacks
>>   Ivory: Fully functional, requires hacks
> >  Platinum: Fully functional, does not require hacks


Not saying it's a good idea.

Otherwise, adding a 'difficulty' field sounds interesting.  This would allow 
users to easily avoid apps that require a really complicated work-around, 
such as patching and compiling Wine.  Then we could also add an option to 
turn on warnings if an app requires a crack, or we could censor it 
automatically based on GeoIP data.


Regards,

Alexander N. S?rnes



From dank at kegel.com  Tue Mar  4 12:04:47 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 10:04:47 -0800
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <200803041853.48238.alex@thehandofagony.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040731i14c0b137ifb0f2e58f490a866@mail.gmail.com>
	<a71bd89a0803040858g7e568f0clb225d72190b99e31@mail.gmail.com>
	<200803041853.48238.alex@thehandofagony.com>
Message-ID: <a71bd89a0803041004s600ab521vc20b2f529d78bae8@mail.gmail.com>

On Tue, Mar 4, 2008 at 9:53 AM, Alexander Nicolaysen S?rnes
<alex at thehandofagony.com> wrote:
>  It might not be a good idea, but we could always introduce a new rating so
>  that we have
>
>
>  > >  Garbage: No functionality, impossible to set up
>  > >  Bronze: Somewhat functional, may require hacks
>  > >  Silver: Mostly functional, requires hacks
>  > >  Gold: Mostly functional, does not require hacks
>  > >   Ivory: Fully functional, requires hacks
>  > >  Platinum: Fully functional, does not require hacks
>
>  Not saying it's a good idea.

Too complicated.  Reminds me of the us government's terror threat
level index :-)

>  Otherwise, adding a 'difficulty' field sounds interesting.  This would allow
>  users to easily avoid apps that require a really complicated work-around,
>  such as patching and compiling Wine.  Then we could also add an option to
>  turn on warnings if an app requires a crack, or we could censor it
>  automatically based on GeoIP data.

Tempting but I think ultimately too complicated.   I think we should
stick with a single rating scheme that requires 'no fiddling' for gold
or platinum.


From madewokherd+d41d at gmail.com  Tue Mar  4 12:58:12 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Tue, 4 Mar 2008 13:58:12 -0500
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <200803041853.48238.alex@thehandofagony.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040731i14c0b137ifb0f2e58f490a866@mail.gmail.com>
	<a71bd89a0803040858g7e568f0clb225d72190b99e31@mail.gmail.com>
	<200803041853.48238.alex@thehandofagony.com>
Message-ID: <ced95fe0803041058q325a7b24u52299f3c652cf445@mail.gmail.com>

On Tue, Mar 4, 2008 at 12:53 PM, Alexander Nicolaysen S?rnes
<alex at thehandofagony.com> wrote:
>  I'm not sure if we should remove the option for 'fully functional, requires
>  hacks'.  A lot of people come to the AppDB to find out how they can make
>  their apps work, and are more interested in the end result as opposed to how
>  to get there.

In practice, is there really enough difference between "fully
functional" and "mostly functional" that we need another rating?
People who only care about the end result would know that anything
Silver or above will just about work.

I've seen Gold applied to software that is really "mostly functional,
requires hacks", i.e. there are some other minor problems that can't
be worked around (and Platinum for software with minor problems as
well).


Then again, if we add a few more variables, we can express the ratings
with radar charts. ;)

http://img231.imageshack.us/img231/9466/screenshot5ec1.png

-- 
Vincent Povirk


From research at science.su  Tue Mar  4 13:52:13 2008
From: research at science.su (L. Rahyen)
Date: Tue, 4 Mar 2008 19:52:13 +0000
Subject: Winecfg: Raise max screen resolution to 160 DPI
In-Reply-To: <b6bb06270803032029q6fd721b6ue4287d0c75a1ae22@mail.gmail.com>
References: <b6bb06270803032029q6fd721b6ue4287d0c75a1ae22@mail.gmail.com>
Message-ID: <200803041952.13428.research@science.su>

	Your patch isn't correct. Just try this:

rm -rf ~/.wine
wineprefixcreate
winecfg

	Go to Graphics tab and set any resolution more than 127 DPI (for example, 
150). Close winecfg. Run it again. Now you have 63 DPI (instead of 150; in 
fact anything bigger than 127 DPI will not be displayed correctly in winecfg).

	This problem was already solved in this patch [1] by Nigel Liang. 
Unfortunately, it wasn't accepted and Nigel didn't tried to ask why it was 
rejected or to resend it.
	I think I will go ahead and resend his patch.

[1] http://www.winehq.org/pipermail/wine-patches/2007-October/044977.html


From truiken at gmail.com  Tue Mar  4 14:03:09 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 4 Mar 2008 14:03:09 -0600
Subject: (resend) msi: Fix bug in handling of multivolume CAB files.
In-Reply-To: <47CD8C1A.3060607@transgaming.com>
References: <47CD8C1A.3060607@transgaming.com>
Message-ID: <22821af30803041203s1fdd170bn1f8f8fdb85c5f798@mail.gmail.com>

On Tue, Mar 4, 2008 at 11:51 AM, Ove Kaaven <ovek at transgaming.com> wrote:
> The email address in the patch was wrong, sending it again.
>
>
> >From b88a43dbc2234c8b35ee4fa7bb4f275475b8d821 Mon Sep 17 00:00:00 2001
>  From: Ove Kaaven <ovek at transgaming.com>
>  Date: Tue, 4 Mar 2008 18:16:27 +0100
>  Subject: [PATCH] Fix bug in handling of multivolume CAB files.
>   After extracting a single file from a multivolume CAB file, sometimes
>   information about the next CAB file to extract from would not be loaded,
>   because the is_continuous state was previously only properly reset if a
>   file happened to be partially extracted from the last volume of a
>   multivolume series.
>

A lot of time has been spent fixing cab/media related bugs in
installers, as the behavior is very fickle (and easily breakable), so
can you please add a test case first?  See the multicab tests that are
already in install.c.  They will fail in wine because our cabinet.dll
cannot create compressed cabinets, but assuming you test in Windows or
use native cabinet.dll, it'll still verify that the patch is correct.

-- 
James Hawkins


From dank at kegel.com  Tue Mar  4 14:07:20 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 12:07:20 -0800
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <ced95fe0803041058q325a7b24u52299f3c652cf445@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040731i14c0b137ifb0f2e58f490a866@mail.gmail.com>
	<a71bd89a0803040858g7e568f0clb225d72190b99e31@mail.gmail.com>
	<200803041853.48238.alex@thehandofagony.com>
	<ced95fe0803041058q325a7b24u52299f3c652cf445@mail.gmail.com>
Message-ID: <a71bd89a0803041207q7ea05735g99ec196564df19a4@mail.gmail.com>

Vincent Povirk <madewokherd+d41d at gmail.com> wrote:
>If we only based ratings on how well applications work out of the box,
>a Garbage rating would apply to any app that requires some extra step
>to run, even if the extra step is grabbing MFC42.dll and putting it in
>system32

This is a valid concern.  I think we may end up having to
deal with this by providing an easy, standard way to
install the most commonly needed, legally redistributable
dependencies.   For instance, we might bundle a couple
of key demo apps with Wine; if we choose carefully,
we can probably find a set of apps that will just happen to
install all the commonly needed redistributables.
- Dan


From winehacker at gmail.com  Tue Mar  4 14:16:35 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 4 Mar 2008 15:16:35 -0500
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803041207q7ea05735g99ec196564df19a4@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040731i14c0b137ifb0f2e58f490a866@mail.gmail.com>
	<a71bd89a0803040858g7e568f0clb225d72190b99e31@mail.gmail.com>
	<200803041853.48238.alex@thehandofagony.com>
	<ced95fe0803041058q325a7b24u52299f3c652cf445@mail.gmail.com>
	<a71bd89a0803041207q7ea05735g99ec196564df19a4@mail.gmail.com>
Message-ID: <19e31a080803041216u3523e4adw36f39fdec152346@mail.gmail.com>

On Tue, Mar 4, 2008 at 3:07 PM, Dan Kegel <dank at kegel.com> wrote:
>  This is a valid concern.  I think we may end up having to
>  deal with this by providing an easy, standard way to
>  install the most commonly needed, legally redistributable
>  dependencies.   For instance, we might bundle a couple
>  of key demo apps with Wine; if we choose carefully,
>  we can probably find a set of apps that will just happen to
>  install all the commonly needed redistributables.

This really sounds like an issue for distribution maintainers, OEMs,
Vars and Wine companies like CodeWeavers. I really don't think Winehq
should ever get in to a position of shipping third party runtimes via
back door demos. If you want to do it in Winetricks or if the Bordeaux
and PlayOnLinux guys want to do it, more power to you. Nothing stops
you from making your own Wine package and distributing it however you
like with whatever third party runtimes and demos that you like.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From denver at ossguy.com  Tue Mar  4 16:09:10 2008
From: denver at ossguy.com (Denver Gingerich)
Date: Tue, 4 Mar 2008 17:09:10 -0500
Subject: Screen mode retrieval/trace tool for Windows
Message-ID: <6defe8840803041409i6167ee19wf1003817672c02fe@mail.gmail.com>

I am trying to trace the sequence of screen mode
(resolution/bpp/refresh rate) changes that occur when StarCraft is run
in Windows so that I can make Wine emulate Windows' behavior.  Right
now I'm trying to see exactly what resolution, bits per pixel, and
refresh rate StarCraft is using.  Unfortunately, I can't just go into
Display Properties while StarCraft is running because it switches the
resolution back when you Alt-Tab out of the game.

My current plan is to install an SSH or telnet server on the Windows
machine and run a command line tool to check the current screen mode
while StarCraft is running.   I have used a couple of command-line
tools for changing the screen mode [1] [2], but neither of them have
an option to list the current mode.  Does anyone know of a tool or can
anyone quickly create a tool that will list the resolution currently
in use from the command line?

I have tried using StraceNT [3] to see the parameters passed to
ChangeDisplaySettingsEx (which is the function StarCraft uses to
change the resolution), but it does not let me look at the DEVMODE
structure that is passed in.  Does anyone know of a trace tool that
would let me do that?

Based on my testing so far, there appears to be a discrepancy in how
Windows and Wine set the refresh rate if none is specified on a
resolution change.  Wine always picks the first mode with a matching
resolution, while Windows does not.  My tests in Windows have shown
that even though StarCraft asks for 640x480 and the first mode with
that resolution has a 60 Hz refresh rate, Windows chooses a higher
refresh rate.  Unfortunately, I don't know exactly which refresh rate,
but I can verify by sight that 60 Hz is not being used (the screen
doesn't flicker as it would at 60 Hz).  This discrepancy is why I wish
to run further tests and acquire more precise information about the
refresh rate being used.

I am performing this testing according to a request in a previous
thread [4].  If you have any questions about my testing, please let me
know.

Denver


1. http://www.vrdevelopers.de/content/view/15/44/
2. http://www.nirsoft.net/utils/nircmd.html
3. http://www.intellectualheaven.com/default.asp?BH=projects&H=strace.htm
4. http://www.winehq.org/pipermail/wine-devel/2008-March/063150.html


From us at edmeades.me.uk  Tue Mar  4 16:28:19 2008
From: us at edmeades.me.uk (Ann & Jason Edmeades)
Date: Tue, 4 Mar 2008 22:28:19 -0000
Subject: Summer of code 2008 - cmd.exe compatibility?
In-Reply-To: <558b2f5c0803031552l6694951s1b90bbb4c0a75132@mail.gmail.com>
Message-ID: <002601c87e47$1523baa0$1001a8c0@JasonsPC>

>>  Out of interest, what is meant by improving cmd.exe compatibility?

>Add support for all the cmd.exe switches and all the dos batch
>programming constructs?

I do track bugzilla for any cmd.exe issues regularly and aside from one
which I started work on, I don't know of any other batch issues. I spent
quite a bit of time working on cmd.exe compatibility, including adding the
newer 'odd' syntax (e.g. %~$PATH:i) and getting it as close to native as
possible. Additionally, the 'missing' commands are almost all external
applications, not inbuilt to the command shell.

I do know of some differences, but few apps require complex batch. You can
download some complex batch which require specific text to come out from
specific commands, but if no real app needs them, its not worth persuing
yet.

Jason




From vit.hrachovy at sandbox.cz  Tue Mar  4 16:37:37 2008
From: vit.hrachovy at sandbox.cz (=?ISO-8859-2?Q?V=EDt_Hrachov=FD?=)
Date: Tue, 04 Mar 2008 23:37:37 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <a71bd89a0803040858g7e568f0clb225d72190b99e31@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>	<ced95fe0803040506n612aad7bpe1dc03c86d9b6de6@mail.gmail.com>	<a71bd89a0803040521x48b00e80sbfdd266169558e4a@mail.gmail.com>	<ced95fe0803040543v147bc064pe9aaa9ab584e185c@mail.gmail.com>	<a71bd89a0803040547t67009b78hd127b7052315f7a8@mail.gmail.com>	<ced95fe0803040731i14c0b137ifb0f2e58f490a866@mail.gmail.com>
	<a71bd89a0803040858g7e568f0clb225d72190b99e31@mail.gmail.com>
Message-ID: <47CDCF31.4080702@sandbox.cz>

Dan Kegel wrote:
> On Tue, Mar 4, 2008 at 7:31 AM, Vincent Povirk
> <madewokherd+d41d at gmail.com> wrote:
>>  Something like this might actually make more sense:
>>
>>  Garbage: No functionality, impossible to set up
>>  Bronze: Somewhat functional, may require hacks
>>  Silver: Mostly functional, requires hacks
>>  Gold: Mostly functional, does not require hacks
>>  Platinum: Fully functional, does not require hacks
>>
>>  This would give a fair amount of information about both the level of
>>  functionality and the difficulty, and it would mean anything that
>>  requires hacks cannot be rated Gold.
> 
> That's a step in the right direction.  As long as we don't explicitly
> mention cracks, I'm ok with that.
> - Dan

+1

Vit


From willz06jw at gmail.com  Tue Mar  4 18:05:30 2008
From: willz06jw at gmail.com (Will Howard)
Date: Tue, 4 Mar 2008 18:05:30 -0600
Subject: Don't know if this is the right place to ask this but...
Message-ID: <47cde3e1.37e9220a.7c3b.1246@mx.google.com>

Howdy,

 

I'm trying to help find memory leaks for wine
http://wiki.winehq.org/MemoryLeaks and I'm having some issues figuring out
Valgrind.  

 

#1 How do you know if Valgrind is working properly (AKA everything is
patched and working).  

#2 How do you decifer the output to start looking for bugs.

 

Thanks for the help,

Will

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080304/3141bb62/attachment-0001.htm 

From melbournemark+wine-devel at gmail.com  Tue Mar  4 18:38:59 2008
From: melbournemark+wine-devel at gmail.com (mark cox)
Date: Wed, 5 Mar 2008 11:38:59 +1100
Subject: Screen mode retrieval/trace tool for Windows
In-Reply-To: <6defe8840803041409i6167ee19wf1003817672c02fe@mail.gmail.com>
References: <6defe8840803041409i6167ee19wf1003817672c02fe@mail.gmail.com>
Message-ID: <e2c9b5730803041638v53bf109eg17e8dd651742f629@mail.gmail.com>

Perhaps use detours to hook the ChangeDisplaySettingsEx function and dump
the devmode structure to a file?
Regards,
mark


On Wed, Mar 5, 2008 at 9:09 AM, Denver Gingerich <denver at ossguy.com> wrote:

> I am trying to trace the sequence of screen mode
> (resolution/bpp/refresh rate) changes that occur when StarCraft is run
> in Windows so that I can make Wine emulate Windows' behavior.  Right
> now I'm trying to see exactly what resolution, bits per pixel, and
> refresh rate StarCraft is using.  Unfortunately, I can't just go into
> Display Properties while StarCraft is running because it switches the
> resolution back when you Alt-Tab out of the game.
>
> My current plan is to install an SSH or telnet server on the Windows
> machine and run a command line tool to check the current screen mode
> while StarCraft is running.   I have used a couple of command-line
> tools for changing the screen mode [1] [2], but neither of them have
> an option to list the current mode.  Does anyone know of a tool or can
> anyone quickly create a tool that will list the resolution currently
> in use from the command line?
>
> I have tried using StraceNT [3] to see the parameters passed to
> ChangeDisplaySettingsEx (which is the function StarCraft uses to
> change the resolution), but it does not let me look at the DEVMODE
> structure that is passed in.  Does anyone know of a trace tool that
> would let me do that?
>
> Based on my testing so far, there appears to be a discrepancy in how
> Windows and Wine set the refresh rate if none is specified on a
> resolution change.  Wine always picks the first mode with a matching
> resolution, while Windows does not.  My tests in Windows have shown
> that even though StarCraft asks for 640x480 and the first mode with
> that resolution has a 60 Hz refresh rate, Windows chooses a higher
> refresh rate.  Unfortunately, I don't know exactly which refresh rate,
> but I can verify by sight that 60 Hz is not being used (the screen
> doesn't flicker as it would at 60 Hz).  This discrepancy is why I wish
> to run further tests and acquire more precise information about the
> refresh rate being used.
>
> I am performing this testing according to a request in a previous
> thread [4].  If you have any questions about my testing, please let me
> know.
>
> Denver
>
>
> 1. http://www.vrdevelopers.de/content/view/15/44/
> 2. http://www.nirsoft.net/utils/nircmd.html
> 3. http://www.intellectualheaven.com/default.asp?BH=projects&H=strace.htm
> 4. http://www.winehq.org/pipermail/wine-devel/2008-March/063150.html
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080305/772b38ea/attachment.htm 

From ovek at transgaming.com  Tue Mar  4 19:01:33 2008
From: ovek at transgaming.com (Ove Kaaven)
Date: Wed, 05 Mar 2008 02:01:33 +0100
Subject: (resend) msi: Fix bug in handling of multivolume CAB files.
In-Reply-To: <22821af30803041203s1fdd170bn1f8f8fdb85c5f798@mail.gmail.com>
References: <47CD8C1A.3060607@transgaming.com>
	<22821af30803041203s1fdd170bn1f8f8fdb85c5f798@mail.gmail.com>
Message-ID: <47CDF0ED.1060203@transgaming.com>

James Hawkins skrev:
> A lot of time has been spent fixing cab/media related bugs in
> installers, as the behavior is very fickle (and easily breakable), so
> can you please add a test case first?  See the multicab tests that are
> already in install.c.  They will fail in wine because our cabinet.dll
> cannot create compressed cabinets, but assuming you test in Windows or
> use native cabinet.dll, it'll still verify that the patch is correct.

Using native cabinet.dll from XP causes numerous failures in those tests 
(notably in caborder, if I remember right). I probably won't really have 
time to track that down right now.

But it seems that I am able to use builtin cabinet if I change 
create_cc_test_files to use a maxsize of 40000 or whatever instead of 
200, so that it creates 2 cabfiles instead of 615. (That routine creates 
something close to the situation I originally described, too.) And if I 
try it that way, my patch seems to fix the todo tests at lines 1733 and 
1734 (in test_uiLevelFlags), for some reason. Is that good enough?


From mike at fireburn.co.uk  Tue Mar  4 19:12:02 2008
From: mike at fireburn.co.uk (Mike Lothian)
Date: Wed, 5 Mar 2008 01:12:02 +0000
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <200803041853.48238.alex@thehandofagony.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<ced95fe0803040731i14c0b137ifb0f2e58f490a866@mail.gmail.com>
	<a71bd89a0803040858g7e568f0clb225d72190b99e31@mail.gmail.com>
	<200803041853.48238.alex@thehandofagony.com>
Message-ID: <f3f71ab90803041712q245df82bi4687ec2a3601d73@mail.gmail.com>

What About:

 <madewokherd+d41d at gmail.com> wrote:
>  Something like this might actually make more sense:
>
>  Garbage: No functionality, impossible to set up
>  Bronze: Somewhat functional, may require hacks
>  Silver: Mostly functional, requires hacks
Fools Gold: Fully functional, requires hacks
>  Gold: Mostly functional, does not require hacks
>  Platinum: Fully functional, does not require hacks


Since only a fool would use a crack that's possibly Malware, or use a
piece of code that's from Microsoft


From truiken at gmail.com  Tue Mar  4 19:20:56 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 4 Mar 2008 19:20:56 -0600
Subject: (resend) msi: Fix bug in handling of multivolume CAB files.
In-Reply-To: <47CDF0ED.1060203@transgaming.com>
References: <47CD8C1A.3060607@transgaming.com>
	<22821af30803041203s1fdd170bn1f8f8fdb85c5f798@mail.gmail.com>
	<47CDF0ED.1060203@transgaming.com>
Message-ID: <22821af30803041720j2a791f09yc1fae29311dd7b6c@mail.gmail.com>

On Tue, Mar 4, 2008 at 7:01 PM, Ove Kaaven <ovek at transgaming.com> wrote:
> James Hawkins skrev:
>
> > A lot of time has been spent fixing cab/media related bugs in
>  > installers, as the behavior is very fickle (and easily breakable), so
>  > can you please add a test case first?  See the multicab tests that are
>  > already in install.c.  They will fail in wine because our cabinet.dll
>  > cannot create compressed cabinets, but assuming you test in Windows or
>  > use native cabinet.dll, it'll still verify that the patch is correct.
>
>  Using native cabinet.dll from XP causes numerous failures in those tests
>  (notably in caborder, if I remember right). I probably won't really have
>  time to track that down right now.
>
>  But it seems that I am able to use builtin cabinet if I change
>  create_cc_test_files to use a maxsize of 40000 or whatever instead of
>  200, so that it creates 2 cabfiles instead of 615. (That routine creates
>  something close to the situation I originally described, too.) And if I
>  try it that way, my patch seems to fix the todo tests at lines 1733 and
>  1734 (in test_uiLevelFlags), for some reason. Is that good enough?
>

The tests that now pass with native cabinet dll are test_continuouscab
(which is similar to what you're trying to test).  The point of
maxsize is so that it creates continuous cabs...there's no other way
to do it, and builtin doesn't create continuous cabs at all.  The
answer to your question is no, because there is no test currently that
runs down the code path you are fixing.

-- 
James Hawkins


From stefan at codeweavers.com  Tue Mar  4 19:33:37 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 5 Mar 2008 02:33:37 +0100
Subject: Screen mode retrieval/trace tool for Windows
In-Reply-To: <e2c9b5730803041638v53bf109eg17e8dd651742f629@mail.gmail.com>
References: <6defe8840803041409i6167ee19wf1003817672c02fe@mail.gmail.com>
	<e2c9b5730803041638v53bf109eg17e8dd651742f629@mail.gmail.com>
Message-ID: <200803050233.39875.stefan@codeweavers.com>

Am Mittwoch, 5. M?rz 2008 01:38:59 schrieb mark cox:
> Perhaps use detours to hook the ChangeDisplaySettingsEx function and dump
> the devmode structure to a file?
That's rather complex, a simple C app calling 
EnumDisplaySettingsEx(ENUM_CURRENT_MODE) called from command line should do 
that as well, and it is much easier to write


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080305/b616c141/attachment.pgp 

From austinenglish at gmail.com  Tue Mar  4 20:08:09 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 4 Mar 2008 20:08:09 -0600
Subject: Winecfg: Raise max screen resolution to 160 DPI
In-Reply-To: <200803041952.13428.research@science.su>
References: <b6bb06270803032029q6fd721b6ue4287d0c75a1ae22@mail.gmail.com>
	<200803041952.13428.research@science.su>
Message-ID: <b6bb06270803041808wc72deb8h1a7086f3c62f0470@mail.gmail.com>

On Tue, Mar 4, 2008 at 1:52 PM, L. Rahyen <research at science.su> wrote:
>         Your patch isn't correct. Just try this:
>
>  rm -rf ~/.wine
>  wineprefixcreate
>  winecfg
>
>         Go to Graphics tab and set any resolution more than 127 DPI (for example,
>  150). Close winecfg. Run it again. Now you have 63 DPI (instead of 150; in
>  fact anything bigger than 127 DPI will not be displayed correctly in winecfg).
>
>         This problem was already solved in this patch [1] by Nigel Liang.
>  Unfortunately, it wasn't accepted and Nigel didn't tried to ask why it was
>  rejected or to resend it.
>         I think I will go ahead and resend his patch.
>
>  [1] http://www.winehq.org/pipermail/wine-patches/2007-October/044977.html
>
>
>

Please apply Nigel's patch, thus reverting my own. I tested on my
machine, but didn't catch this problem.

Thanks Rahyen for catching this, and sorry for the mistake.

-Austin


From dank at kegel.com  Tue Mar  4 20:11:57 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 Mar 2008 18:11:57 -0800
Subject: Don't know if this is the right place to ask this but...
Message-ID: <a71bd89a0803041811t62c5bd8avf48e72adfb33dc17@mail.gmail.com>

Will Howard willz06jw at gmail.com wrote:
>#1 How do you know if Valgrind is working properly (AKA everything is
>patched and working).
>
>#2 How do you decifer the output to start looking for bugs.

Here's some example output (cleaned up a bit by
my perl script, http://kegel.com/wine/valgrind/valgrind-split-pl.txt) is at:
http://kegel.com/wine/valgrind/logs-2008-03-03/vg-ws2_32_sock.txt

That particular output file says

 Syscall param socketcall.sendmsg(msg.msg_iov[i]) points to
uninitialised byte(s)
    at  (within /lib/ld-2.6.1.so)
    by  WSASendTo (socket.c:2674)
    by  WS_sendto (socket.c:2827)
    by  test_UDP (sock.c:1055)
    by  func_sock (sock.c:1985)
    by  run_test (test.h:406)
    by  main (test.h:455)

This means there may be a bug somewhere near some of the lines mentioned.
Sadly, only filename are given, not directories, so you kind of have
to guess whether the files in question are in the directory ws2_32 or
ws2_32/tests (or somewhere else).

The thing to do is to read and understand the test with the issue.

The course of action will then be obvious :-)

Did I mention you have to really understand the test?
- Dan


From remco47 at yahoo.com  Tue Mar  4 20:39:01 2008
From: remco47 at yahoo.com (Remco)
Date: Tue, 4 Mar 2008 18:39:01 -0800 (PST)
Subject: WineHQ should discourage the use of cracks
Message-ID: <142906.45998.qm@web50103.mail.re2.yahoo.com>

Or how about this:

::Wine Compatibility::
( ) Doesn't work at all [Garbage]
( ) Starts, but not very usable [Bronze]
( ) Basically works, a few bugs [Silver]
(*) Works flawlessly [Gold]

::Extra Info::
[x] Needs Wine configuration (Windows version, sound options, regedit entries, etc.)
[x] Needs a Windows DLL (has legal issues)
[x] Needs a third party hack (has legal issues)

If Gold and no tick boxes are selected: Works out of the box! [Platinum]

The Extra Info tick boxes could be represented as icons accompanying the color-based Status wherever it goes. The icons should probably give a negative impression. A red color for example, although that might not get across very well, considering the color palette of WineHQ... ;)

The "has legal issues" should link to a Wine Wiki page which explains exactly what those issues are and that specific discussion on how to get those things working is not allowed at winehq.org, the mailing lists, the newsgroup or the IRC channel.

Remco



      ____________________________________________________________________________________
Never miss a thing.  Make Yahoo your home page. 
http://www.yahoo.com/r/hs


From dmitry at codeweavers.com  Tue Mar  4 20:55:34 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 5 Mar 2008 10:55:34 +0800
Subject: Winecfg: Raise max screen resolution to 160 DPI
References: <b6bb06270803032029q6fd721b6ue4287d0c75a1ae22@mail.gmail.com>
	<200803041952.13428.research@science.su>
Message-ID: <00d501c87e6c$651c2450$a600fea9@DMITRY>

"L. Rahyen" <research at science.su> wrote:

> This problem was already solved in this patch [1] by Nigel Liang. 
> Unfortunately, it wasn't accepted and Nigel didn't tried to ask why it was 
> rejected or to resend it.
> I think I will go ahead and resend his patch.
> 
> [1] http://www.winehq.org/pipermail/wine-patches/2007-October/044977.html

MultiByteToWideChar is that patch passes negative length for the destination
buffer which is incorrect.

-- 
Dmitry.


From denver at ossguy.com  Tue Mar  4 20:56:26 2008
From: denver at ossguy.com (Denver Gingerich)
Date: Tue, 4 Mar 2008 18:56:26 -0800
Subject: Screen mode retrieval/trace tool for Windows
In-Reply-To: <200803050233.39875.stefan@codeweavers.com>
References: <6defe8840803041409i6167ee19wf1003817672c02fe@mail.gmail.com>
	<e2c9b5730803041638v53bf109eg17e8dd651742f629@mail.gmail.com>
	<200803050233.39875.stefan@codeweavers.com>
Message-ID: <6defe8840803041856t79bfd059n27ff248b2ce5083a@mail.gmail.com>

On Tue, Mar 4, 2008 at 5:33 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Mittwoch, 5. M?rz 2008 01:38:59 schrieb mark cox:
>
> > Perhaps use detours to hook the ChangeDisplaySettingsEx function and dump
>  > the devmode structure to a file?
>  That's rather complex, a simple C app calling
>  EnumDisplaySettingsEx(ENUM_CURRENT_MODE) called from command line should do
>  that as well, and it is much easier to write

I'm having some trouble getting such an app compiled.  I'm using MinGW
5.1.3 on Windows XP.  Here's what's happening:

>type x.c
#include <windows.h>

int main()
{
        DEVMODE dm;
        dm.dmSize = sizeof(dm);
        EnumDisplaySettingsEx(NULL, ENUM_CURRENT_SETTINGS, &dm, 0);
        return 0;
}

>gcc -c x.c

>gcc -lgdi32 -luser32 -o x x.o -mwindows
x.o:x.c:(.text+0x5e): undefined reference to `EnumDisplaySettingsExA'
collect2: ld returned 1 exit status


I'm not very familiar with building applications that use the Windows
API with MinGW so it's very likely that I made a silly mistake.
Suggestions on how to fix this would be appreciated.

Denver


From dmitry at codeweavers.com  Tue Mar  4 21:07:56 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 5 Mar 2008 11:07:56 +0800
Subject: Screen mode retrieval/trace tool for Windows
References: <6defe8840803041409i6167ee19wf1003817672c02fe@mail.gmail.com><e2c9b5730803041638v53bf109eg17e8dd651742f629@mail.gmail.com><200803050233.39875.stefan@codeweavers.com>
	<6defe8840803041856t79bfd059n27ff248b2ce5083a@mail.gmail.com>
Message-ID: <011301c87e6e$1f690de0$a600fea9@DMITRY>

"Denver Gingerich" <denver at ossguy.com> wrote:

> >gcc -lgdi32 -luser32 -o x x.o -mwindows
> x.o:x.c:(.text+0x5e): undefined reference to `EnumDisplaySettingsExA'
> collect2: ld returned 1 exit status
> 
> 
> I'm not very familiar with building applications that use the Windows
> API with MinGW so it's very likely that I made a silly mistake.
> Suggestions on how to fix this would be appreciated.

You could try EnumDisplaySettings instead.

-- 
Dmitry.



From denver at ossguy.com  Tue Mar  4 21:19:11 2008
From: denver at ossguy.com (Denver Gingerich)
Date: Tue, 4 Mar 2008 19:19:11 -0800
Subject: Screen mode retrieval/trace tool for Windows
In-Reply-To: <011301c87e6e$1f690de0$a600fea9@DMITRY>
References: <6defe8840803041409i6167ee19wf1003817672c02fe@mail.gmail.com>
	<e2c9b5730803041638v53bf109eg17e8dd651742f629@mail.gmail.com>
	<200803050233.39875.stefan@codeweavers.com>
	<6defe8840803041856t79bfd059n27ff248b2ce5083a@mail.gmail.com>
	<011301c87e6e$1f690de0$a600fea9@DMITRY>
Message-ID: <6defe8840803041919p9f7eed7ueec4bfdaeb87f3ad@mail.gmail.com>

On Tue, Mar 4, 2008 at 7:07 PM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> "Denver Gingerich" <denver at ossguy.com> wrote:
>
>
> > >gcc -lgdi32 -luser32 -o x x.o -mwindows
>  > x.o:x.c:(.text+0x5e): undefined reference to `EnumDisplaySettingsExA'
>  > collect2: ld returned 1 exit status
>  >
>  >
>  > I'm not very familiar with building applications that use the Windows
>  > API with MinGW so it's very likely that I made a silly mistake.
>  > Suggestions on how to fix this would be appreciated.
>
>  You could try EnumDisplaySettings instead.

Surprisingly (to me), that worked.  Thanks for the tip.  I'll report
back after I've run the tests.

Denver


From leslie_alistair at hotmail.com  Tue Mar  4 21:51:55 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Wed, 5 Mar 2008 14:51:55 +1100
Subject: Regession tests
References: <fq392s$69o$1@ger.gmane.org> <47C531C9.9050600@gmail.com>
	<fqglgm$n3u$1@ger.gmane.org>
Message-ID: <fql5d0$ghk$1@ger.gmane.org>

> What is the best way to narrow down what is causing the crash?
> 
Will answer my own quetsion.

Install mingw

1. Run "make crosstest" in the releavent directory
2. Copy to exe to Windows and run
3. Modify test(s) to correct issue(s)
4. Rinse and Repeat.

Best Regards
 Alistair Leslie-Hughes



From patrol at sinus.cz  Wed Mar  5 00:02:37 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Wed, 5 Mar 2008 07:02:37 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <20080304152346.GF353@byleth.sc-networks.de>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<200803041535.18561.kai.blin@gmail.com>
	<20080304152346.GF353@byleth.sc-networks.de>
Message-ID: <20080305060237.GA1583@tangens.sinus.cz>

> On Tue, Mar 04, 2008 at 03:35:11PM +0100, Kai Blin wrote:
> 
> > No argument on the US part. I'm still convinced that by EU laws,
> > you're allowed to crack an app you bought in order to make it run on
> > your software.  As this hasn't been tested in court yet, though, I'll
> > concede.
> 
> IANAL, but since 2008 germany adopted a law from a EU proposal (maybe
> other countries added it before), that disallows circumventing copy
> protections at all. so in theory your statement is not true any longer
> for the EU.
> 
Hi!
  Here, in Czech Republic, there is also a new law forbidding to circumvent
the copy protection, it probably comes from the same european source as the
German one.
  However, using cracks to make the app running on wine can't be primarily
classified as "circumventing copy protection", but as "modifying an app to
run on other OS", which is, I hope, still legal. I think that if I own a legal
copy of an application, didn't make any illegal copies of it, and just
modified it to run in wine, any court on the world should decide, that my
intention was not to circumvent the copy protection (because it is not of
any importance to me, I already legally have it), but to make it working
(yes, I've spent my money to use the app and I had to modify it to be able to
use it). Our courts have to evidence my invention to make a punishable act
(like to circumvent the copy protection to either get a pirated copy or to
sell my pirated copies to anybody else), but if I did something similar, but
for evidently another purpose (to run the legally owned app), I think that
it's not a punishable act. Something similar happened recently - a court
set free an old woman which was growing marihuana strictly for medical purpose,
even if there is a law strictly prohibiting to grow marihuana at all. Of course
IANAL, but my kids are running cracked games on wine, however we HAVE all the
CDs including bills from the shop for everybody, who would like to accuse us of
using illegal software.

  With regards, Pavel Troller


From matteo at mitalia.net  Tue Mar  4 16:57:02 2008
From: matteo at mitalia.net (Matteo Italia)
Date: Tue, 4 Mar 2008 23:57:02 +0100
Subject: Screen mode retrieval/trace tool for Windows
In-Reply-To: <6defe8840803041409i6167ee19wf1003817672c02fe@mail.gmail.com>
References: <6defe8840803041409i6167ee19wf1003817672c02fe@mail.gmail.com>
Message-ID: <000a01c87e4b$0ff599a0$f8b19b05@teoxp>

I think that you could just write a Windows application that listens for
WM_DISPLAYCHANGE messages (that are generated when the
ChangeDisplaySettingsEx succeeds) and logs the parameters recieved somewhere
(keep in mind that wParam = new BPP; LOWORD(lParam) = new horizontal
resolution; HIWORD(lParam) = new vertical resolution). If you need other
infos about the screen settings just use the GetDeviceCaps API with the
handle returned by GetDC(NULL) (see the MSDN for info about these APIs).
If you need any help, I'm here. :-)

Bye

Matteo

-----Original Message-----
From: wine-devel-bounces at winehq.org [mailto:wine-devel-bounces at winehq.org]
On Behalf Of Denver Gingerich
Sent: Tuesday, March 04, 2008 11:09 PM
To: wine-devel at winehq.org
Subject: Screen mode retrieval/trace tool for Windows

I am trying to trace the sequence of screen mode (resolution/bpp/refresh
rate) changes that occur when StarCraft is run in Windows so that I can make
Wine emulate Windows' behavior.  Right now I'm trying to see exactly what
resolution, bits per pixel, and refresh rate StarCraft is using.
Unfortunately, I can't just go into Display Properties while StarCraft is
running because it switches the resolution back when you Alt-Tab out of the
game.

My current plan is to install an SSH or telnet server on the Windows machine
and run a command line tool to check the current screen mode
while StarCraft is running.   I have used a couple of command-line
tools for changing the screen mode [1] [2], but neither of them have an
option to list the current mode.  Does anyone know of a tool or can anyone
quickly create a tool that will list the resolution currently in use from
the command line?

I have tried using StraceNT [3] to see the parameters passed to
ChangeDisplaySettingsEx (which is the function StarCraft uses to change the
resolution), but it does not let me look at the DEVMODE structure that is
passed in.  Does anyone know of a trace tool that would let me do that?

Based on my testing so far, there appears to be a discrepancy in how Windows
and Wine set the refresh rate if none is specified on a resolution change.
Wine always picks the first mode with a matching resolution, while Windows
does not.  My tests in Windows have shown that even though StarCraft asks
for 640x480 and the first mode with that resolution has a 60 Hz refresh
rate, Windows chooses a higher refresh rate.  Unfortunately, I don't know
exactly which refresh rate, but I can verify by sight that 60 Hz is not
being used (the screen doesn't flicker as it would at 60 Hz).  This
discrepancy is why I wish to run further tests and acquire more precise
information about the refresh rate being used.

I am performing this testing according to a request in a previous thread
[4].  If you have any questions about my testing, please let me know.

Denver


1. http://www.vrdevelopers.de/content/view/15/44/
2. http://www.nirsoft.net/utils/nircmd.html
3. http://www.intellectualheaven.com/default.asp?BH=projects&H=strace.htm
4. http://www.winehq.org/pipermail/wine-devel/2008-March/063150.html

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 5113 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080304/7f5c43c5/attachment.bin 

From cbill.lam at gmail.com  Wed Mar  5 02:41:27 2008
From: cbill.lam at gmail.com (bill lam)
Date: Wed, 05 Mar 2008 16:41:27 +0800
Subject: X Error of failed request
Message-ID: <47CE5CB7.8020102@gmail.com>

Sometimes (about 3 or 4 times in one day) that it just crashed with this message,

X Error of failed request:  BadWindow (invalid Window parameter)
   Major opcode of failed request:  18 (X_ChangeProperty)
   Resource id in failed request:  0x4400003
   Serial number of failed request:  1113
   Current serial number in output stream:  1117

no stack trace was available. Is this a known issue and how to
get more information that may help debugging.

I use nvidia card on ubuntu 7.10 amd64.

regards,


From dmitry at codeweavers.com  Wed Mar  5 02:51:14 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 5 Mar 2008 16:51:14 +0800
Subject: X Error of failed request
References: <47CE5CB7.8020102@gmail.com>
Message-ID: <005a01c87e9e$131bca20$a600fea9@DMITRY>

"bill lam" <cbill.lam at gmail.com> wrote:

> Sometimes (about 3 or 4 times in one day) that it just crashed with this message,
> 
> X Error of failed request:  BadWindow (invalid Window parameter)
>   Major opcode of failed request:  18 (X_ChangeProperty)
>   Resource id in failed request:  0x4400003
>   Serial number of failed request:  1113
>   Current serial number in output stream:  1117
> 
> no stack trace was available. Is this a known issue and how to
> get more information that may help debugging.
> 
> I use nvidia card on ubuntu 7.10 amd64.

Please open a bug report for this problem instead of posting it here.

-- 
Dmitry.


From ben at atomnet.co.uk  Wed Mar  5 04:26:48 2008
From: ben at atomnet.co.uk (Ben Hodgetts)
Date: Wed, 05 Mar 2008 10:26:48 +0000
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <142906.45998.qm@web50103.mail.re2.yahoo.com>
References: <142906.45998.qm@web50103.mail.re2.yahoo.com>
Message-ID: <47CE7568.7070202@atomnet.co.uk>

I like this... considering how... "unskilled" many people that fill in 
test reports are on the AppDB, this would help make it a little more 
foolproof (although the "Has legal issues" bits seem rather unnecessary 
at the end).

Ben H.

Remco wrote:
> Or how about this:
>
> ::Wine Compatibility::
> ( ) Doesn't work at all [Garbage]
> ( ) Starts, but not very usable [Bronze]
> ( ) Basically works, a few bugs [Silver]
> (*) Works flawlessly [Gold]
>
> ::Extra Info::
> [x] Needs Wine configuration (Windows version, sound options, regedit entries, etc.)
> [x] Needs a Windows DLL (has legal issues)
> [x] Needs a third party hack (has legal issues)
>
> If Gold and no tick boxes are selected: Works out of the box! [Platinum]
>
> The Extra Info tick boxes could be represented as icons accompanying the color-based Status wherever it goes. The icons should probably give a negative impression. A red color for example, although that might not get across very well, considering the color palette of WineHQ... ;)
>
> The "has legal issues" should link to a Wine Wiki page which explains exactly what those issues are and that specific discussion on how to get those things working is not allowed at winehq.org, the mailing lists, the newsgroup or the IRC channel.
>
> Remco
>
>
>
>       ____________________________________________________________________________________
> Never miss a thing.  Make Yahoo your home page. 
> http://www.yahoo.com/r/hs
>
>
>   


From julliard at winehq.org  Wed Mar  5 04:50:36 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 05 Mar 2008 11:50:36 +0100
Subject: [PATCH 1/3] shell32: add xdg-user-dirs lookup code
In-Reply-To: <558b2f5c0803041625k13370c35l5e04eb6be5504961@mail.gmail.com>
	(Lei Zhang's message of "Tue, 4 Mar 2008 16:25:20 -0800")
References: <558b2f5c0803041625k13370c35l5e04eb6be5504961@mail.gmail.com>
Message-ID: <874pblla0z.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> +    /* Convert $HOME to wide chars */
> +    len = MultiByteToWideChar(CP_ACP, 0, home_dir, -1, NULL, 0);
> +    home_dirW = HeapAlloc(GetProcessHeap(), 0, len * sizeof(WCHAR));
> +    if (!home_dirW)
> +    {
> +        hr = E_OUTOFMEMORY;
> +        goto xdg_user_dir_lookup_error;
> +    }
> +    MultiByteToWideChar(CP_ACP, 0, home_dir, -1, home_dirW, len);
> +    hr = get_xdg_config_file(home_dir, &config_file);
> +    if (FAILED(hr))
> +        goto xdg_user_dir_lookup_error;
> +
> +    file = fopen(config_file, "r");
> +    HeapFree(GetProcessHeap(), 0, config_file);
> +    if (!file)
> +    {
> +        hr = E_HANDLE;
> +        goto xdg_user_dir_lookup_error;
> +    }
> +
> +    while (fgets(buffer, sizeof(buffer), file))
> +    {
> +        int idx;
> +        WCHAR *p, bufferW[512];
> +
> +        /* Convert buffer to wide chars */
> +        len = MultiByteToWideChar(CP_UTF8, 0, buffer, -1, NULL, 0);
> +        MultiByteToWideChar(CP_UTF8, 0, buffer, -1, bufferW, len);

It doesn't make sense to convert $HOME or config strings to Unicode,
these are Unix paths, they should be kept as such until you call
symlink() or whatever on them.

-- 
Alexandre Julliard
julliard at winehq.org


From paul.vriens.wine at gmail.com  Wed Mar  5 05:13:49 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 05 Mar 2008 12:13:49 +0100
Subject: ntdll/tests: Don't use 0x55/0xaa to avoid any confusion when
	running	with +heap.
In-Reply-To: <alpine.DEB.1.00.0803051204170.5451@amboise.dolphin>
References: <alpine.DEB.1.00.0803051204170.5451@amboise.dolphin>
Message-ID: <47CE806D.4070708@gmail.com>

Francois Gouget wrote:
> ---
>  dlls/ntdll/tests/atom.c |   12 ++++++------
>  1 files changed, 6 insertions(+), 6 deletions(-)
> 
> diff --git a/dlls/ntdll/tests/atom.c b/dlls/ntdll/tests/atom.c
> index 2de94a0..68f5aba 100644
> --- a/dlls/ntdll/tests/atom.c
> +++ b/dlls/ntdll/tests/atom.c
> @@ -198,13 +198,13 @@ static void test_NtAtom(void)
>          ok((lstrlenW(testAtom2) * sizeof(WCHAR)) == Len, "Returned wrong length %d\n", Len);
>  
>          Len = 8;
> c-        Name[0] = Name[1] = Name[2] = Name[3] = Name[4] = 0x55AA;
> +        Name[0] = Name[1] = Name[2] = Name[3] = Name[4] = 0x1337;

What happened there?

-- 
Cheers,

Paul.


From meissner at suse.de  Wed Mar  5 06:40:09 2008
From: meissner at suse.de (Marcus Meissner)
Date: Wed, 5 Mar 2008 13:40:09 +0100
Subject: Maarten Lankhorst : oleaut32: Handle TKIND_ALIAS properly when
	passed as pointer.
In-Reply-To: <E1JWsfO-0007hK-Qn@wine.codeweavers.com>
References: <E1JWsfO-0007hK-Qn@wine.codeweavers.com>
Message-ID: <20080305124008.GA20226@suse.de>

On Wed, Mar 05, 2008 at 06:24:14AM -0600, Alexandre Julliard wrote:
> Module: wine
> Branch: master
> Commit: c978bbee87dd6e09e4ad836df5ad7d63506face2
> URL:    http://source.winehq.org/git/wine.git/?a=commit;h=c978bbee87dd6e09e4ad836df5ad7d63506face2
> 
> Author: Maarten Lankhorst <m.b.lankhorst at gmail.com>
> Date:   Mon Mar  3 14:27:03 2008 -0800
> 
> oleaut32: Handle TKIND_ALIAS properly when passed as pointer.
> 
> ---
> 
> +                break;
>  	    case TKIND_ENUM:	/* confirmed */
>  	    case TKIND_RECORD:	/* FIXME: mostly untested */
> -		derefhere=TRUE;
>  		break;
...

Why the removal of this line? Any indication that it helps?

Ciao, Marcus


From julliard at winehq.org  Wed Mar  5 07:03:45 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 05 Mar 2008 14:03:45 +0100
Subject: #1 gdi32: Move GetICMProfile to the driver.
In-Reply-To: <200803051202.16784.hans@it.vu.nl> (Hans Leidekker's message of
	"Wed, 5 Mar 2008 12:02:16 +0100")
References: <200803051202.16784.hans@it.vu.nl>
Message-ID: <87zltdjpam.fsf@wine.dyndns.org>

Hans Leidekker <hans at it.vu.nl> writes:

> Changelog
>  Move GetICMProfile to the driver.

Looks good, but the code doesn't belong in x11drv_main.c. Something like
graphics.c would be more appropriate.

-- 
Alexandre Julliard
julliard at winehq.org


From darkwalker_ at yahoo.com  Wed Mar  5 07:20:43 2008
From: darkwalker_ at yahoo.com (F Capela)
Date: Wed, 5 Mar 2008 05:20:43 -0800 (PST)
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <47CE7568.7070202@atomnet.co.uk>
Message-ID: <320185.79293.qm@web38002.mail.mud.yahoo.com>

Remco wrote:
> Or how about this:
>
> ::Wine Compatibility::
> ( ) Doesn't work at all [Garbage]
> ( ) Starts, but not very usable [Bronze]
> ( ) Basically works, a few bugs [Silver]
> (*) Works flawlessly [Gold]
>
> ::Extra Info::
> [x] Needs Wine configuration (Windows version,
> sound options, regedit entries, etc.)
> [x] Needs a Windows DLL (has legal issues)
> [x] Needs a third party hack (has legal issues)
>
> If Gold and no tick boxes are selected: Works out
> of the box! [Platinum]
>
> The Extra Info tick boxes could be represented as
> icons accompanying the color-based Status wherever
> it goes. The icons should probably give a negative
> impression. A red color for example, although that
> might not get across very well, considering the
> color palette of WineHQ... ;)
>
> The "has legal issues" should link to a Wine Wiki
> page which explains exactly what those issues are
> and that specific discussion on how to get those
> things working is not allowed at winehq.org, the
> mailing lists, the newsgroup or the IRC channel.
>
> Remco

I like this idea, although I'd change "has legal
issues" to "may have legal issues". Most of those DLL
overrides can be obtained legally (and even if there
is an EULA stating that they can only be used in
Windows, in some places such clause is illegal), and
there are places where circumventing copy protection
schemes in order to have better usability is legal.

BTW, where I live (Brazil) it's only illegal to
circumvent copy protection measures if it's done to
distribute illegal copies; doing it to have better
usability is perfectly legal here. And something
interesting, there's a note jointly published last
year by 4 brazilian ministers declaring, among other
things, that DRM technologies may be against both the
federal constitution and copyright law.


F?bio Oliveira Schmidt Capela
darkwalker_ at yahoo.com


      ____________________________________________________________________________________
Looking for last minute shopping deals?  
Find them fast with Yahoo! Search.  http://tools.search.yahoo.com/newsearch/category.php?category=shopping


From fgouget at free.fr  Wed Mar  5 11:25:16 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 5 Mar 2008 18:25:16 +0100 (CET)
Subject: ntdll/tests: Don't use 0x55/0xaa to avoid any confusion when
	running with +heap.
In-Reply-To: <47CE806D.4070708@gmail.com>
References: <alpine.DEB.1.00.0803051204170.5451@amboise.dolphin>
	<47CE806D.4070708@gmail.com>
Message-ID: <alpine.DEB.1.00.0803051824230.22992@amboise.dolphin>

On Wed, 5 Mar 2008, Paul Vriens wrote:
[...]
> > @@ -198,13 +198,13 @@ static void test_NtAtom(void)
> >          ok((lstrlenW(testAtom2) * sizeof(WCHAR)) == Len, "Returned wrong length %d\n", Len);
> >  
> >          Len = 8;
> > c-        Name[0] = Name[1] = Name[2] = Name[3] = Name[4] = 0x55AA;
> > +        Name[0] = Name[1] = Name[2] = Name[3] = Name[4] = 0x1337;
> 
> What happened there?

I must have hit 'c' while reviewing the patch instead of 'Ctrl+X' to 
send. Apparently Alexandre fixed the patch.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                            1 + e ^ ( i * pi ) = 0


From julliard at winehq.org  Wed Mar  5 12:07:16 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 05 Mar 2008 19:07:16 +0100
Subject: hal: Add a stub for HalGetBusData() to make 3DMark2001SE happy in
	WinNT mode.
In-Reply-To: <alpine.DEB.1.00.0803051207100.5451@amboise.dolphin> (Francois
	Gouget's message of "Wed, 5 Mar 2008 12:07:15 +0100 (CET)")
References: <alpine.DEB.1.00.0803051207100.5451@amboise.dolphin>
Message-ID: <87pru9jb8r.fsf@wine.dyndns.org>

Francois Gouget <fgouget at codeweavers.com> writes:

> +typedef enum _BUS_DATA_TYPE
> +{
> +    ConfigurationSpaceUndefined = -1,
> +    Cmos,
> +    EisaConfiguration,
> +    Pos,
> +    CbusConfiguration,
> +    PCIConfiguration,
> +    VMEConfiguration,
> +    NuBusConfiguration,
> +    PCMCIAConfiguration,
> +    MPIConfiguration,
> +    MPSAConfiguration,
> +    PNPISAConfiguration,
> +    MaximumBusDataType
> +} BUS_DATA_TYPE, *PBUS_DATA_TYPE;

Shouldn't that stuff go into a public header?

-- 
Alexandre Julliard
julliard at winehq.org


From truiken at gmail.com  Wed Mar  5 12:05:03 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 5 Mar 2008 12:05:03 -0600
Subject: make LoadStringW pass tests (fixed merge conflict)
In-Reply-To: <47CEDF48.8090705@procyongames.com>
References: <47CEDF48.8090705@procyongames.com>
Message-ID: <22821af30803051005r2ab23be0p501aeb71841cc562@mail.gmail.com>

On Wed, Mar 5, 2008 at 11:58 AM, Christopher
<raccoonone at procyongames.com> wrote:
> resubmitting my patch to resolve a merge conflict with the latest GIT
>
>  Christopher Berner
>
> From 47a770102acf010834899489416e92fd4f79ffd1 Mon Sep 17 00:00:00 2001
>  From: Christopher Berner <raccoonone at procyongames.com>
>  Date: Wed, 5 Mar 2008 09:28:26 -0800
>  Subject: [PATCH] make LoadStringW pass conformance tests
>
>  ---
>   dlls/crypt32/oid.c           |    3 ++-
>   dlls/hhctrl.ocx/help.c       |    4 ++--
>   dlls/mpr/wnet.c              |    3 ++-
>   dlls/user32/resource.c       |   14 +++++++++++++-
>   dlls/user32/tests/resource.c |   29 +++++++++++------------------
>   5 files changed, 30 insertions(+), 23 deletions(-)
>
>  diff --git a/dlls/crypt32/oid.c b/dlls/crypt32/oid.c
>  index 5d17997..edd9732 100644
>  --- a/dlls/crypt32/oid.c
>  +++ b/dlls/crypt32/oid.c
>  @@ -1402,8 +1402,9 @@ static void init_oid_info(HINSTANCE hinst)
>          }
>          else
>          {
>  +            LPWSTR junkpointer; /* third argument cannot be NULL, to receive length of resource from LoadStringW */
>              int len = LoadStringW(hinst, (UINT_PTR)oidInfoConstructors[i].pwszName,
>  -             NULL, 0);
>  +             (LPWSTR)&junkpointer, 0);
>

Why don't you just name the new parameter the same name as the
function parameter ('buffer' or some variation)?  junkpointer is a
terrible variable name.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Wed Mar  5 12:18:57 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 5 Mar 2008 10:18:57 -0800
Subject: Maarten Lankhorst : oleaut32: Handle TKIND_ALIAS properly when
	passed as pointer.
In-Reply-To: <20080305124008.GA20226@suse.de>
References: <E1JWsfO-0007hK-Qn@wine.codeweavers.com>
	<20080305124008.GA20226@suse.de>
Message-ID: <b130c85e0803051018k1dc78411u6ff8c96a3e7d3bc3@mail.gmail.com>

Hi Marcus,

2008/3/5, Marcus Meissner <meissner at suse.de>:
> On Wed, Mar 05, 2008 at 06:24:14AM -0600, Alexandre Julliard wrote:
>  > Module: wine
>  > Branch: master
>  > Commit: c978bbee87dd6e09e4ad836df5ad7d63506face2

>  > +                break;
>  >           case TKIND_ENUM:    /* confirmed */
>  >           case TKIND_RECORD:  /* FIXME: mostly untested */
>  > -             derefhere=TRUE;
>  >               break;
>  ...
>
>  Why the removal of this line? Any indication that it helps?
It was redundant because default is already set to true.

Cheers,
Maarten.


From raccoonone at procyongames.com  Wed Mar  5 13:06:32 2008
From: raccoonone at procyongames.com (Christopher)
Date: Wed, 05 Mar 2008 11:06:32 -0800
Subject: make LoadStringW pass tests (fixed merge conflict)
In-Reply-To: <22821af30803051005r2ab23be0p501aeb71841cc562@mail.gmail.com>
References: <47CEDF48.8090705@procyongames.com>
	<22821af30803051005r2ab23be0p501aeb71841cc562@mail.gmail.com>
Message-ID: <47CEEF38.1040808@procyongames.com>

James Hawkins wrote:
> On Wed, Mar 5, 2008 at 11:58 AM, Christopher
> <raccoonone at procyongames.com> wrote:
>   
>> resubmitting my patch to resolve a merge conflict with the latest GIT
>>
>>  Christopher Berner
>>
>> From 47a770102acf010834899489416e92fd4f79ffd1 Mon Sep 17 00:00:00 2001
>>  From: Christopher Berner <raccoonone at procyongames.com>
>>  Date: Wed, 5 Mar 2008 09:28:26 -0800
>>  Subject: [PATCH] make LoadStringW pass conformance tests
>>
>>  ---
>>   dlls/crypt32/oid.c           |    3 ++-
>>   dlls/hhctrl.ocx/help.c       |    4 ++--
>>   dlls/mpr/wnet.c              |    3 ++-
>>   dlls/user32/resource.c       |   14 +++++++++++++-
>>   dlls/user32/tests/resource.c |   29 +++++++++++------------------
>>   5 files changed, 30 insertions(+), 23 deletions(-)
>>
>>  diff --git a/dlls/crypt32/oid.c b/dlls/crypt32/oid.c
>>  index 5d17997..edd9732 100644
>>  --- a/dlls/crypt32/oid.c
>>  +++ b/dlls/crypt32/oid.c
>>  @@ -1402,8 +1402,9 @@ static void init_oid_info(HINSTANCE hinst)
>>          }
>>          else
>>          {
>>  +            LPWSTR junkpointer; /* third argument cannot be NULL, to receive length of resource from LoadStringW */
>>              int len = LoadStringW(hinst, (UINT_PTR)oidInfoConstructors[i].pwszName,
>>  -             NULL, 0);
>>  +             (LPWSTR)&junkpointer, 0);
>>
>>     
>
> Why don't you just name the new parameter the same name as the
> function parameter ('buffer' or some variation)?  junkpointer is a
> terrible variable name.
>
>   
sure, I will change it.


From julliard at winehq.org  Wed Mar  5 13:15:46 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 05 Mar 2008 20:15:46 +0100
Subject: make LoadStringW pass tests (fixed merge conflict)
In-Reply-To: <47CEEF38.1040808@procyongames.com> (Christopher's message of
	"Wed, 05 Mar 2008 11:06:32 -0800")
References: <47CEDF48.8090705@procyongames.com>
	<22821af30803051005r2ab23be0p501aeb71841cc562@mail.gmail.com>
	<47CEEF38.1040808@procyongames.com>
Message-ID: <87fxv5j82l.fsf@wine.dyndns.org>

Christopher <raccoonone at procyongames.com> writes:

> James Hawkins wrote:
>> Why don't you just name the new parameter the same name as the
>> function parameter ('buffer' or some variation)?  junkpointer is a
>> terrible variable name.
>>
>>   
> sure, I will change it.

Actually what you should do is take advantage of the fact that the
pointer is returned to simplify the code and avoid a second LoadStringW
call.

-- 
Alexandre Julliard
julliard at winehq.org


From titan.costa at wanadoo.fr  Wed Mar  5 14:20:35 2008
From: titan.costa at wanadoo.fr (Christian Costa)
Date: Wed, 05 Mar 2008 21:20:35 +0100
Subject: [feature requist] Glide API support
In-Reply-To: <20080218204213.15010@gmx.net>
References: <ee59d8c70802181225l1b871193md11e7dff3579103c@mail.gmail.com>
	<20080218204213.15010@gmx.net>
Message-ID: <47CF0093.6070305@wanadoo.fr>

Roderick Colenbrander a ?crit :
>> Dear Wine devs,
>>
>> There are some games out there that were built with the Glide API. The
>> Glide
>> API is the graphics API of the 3dfx Voodoo cards and is basically a
>> stripped
>> down version of OpenGL. Could please consider adding support for the Glide
>> API because I, and other have games that requires this API to be able to
>> run
>> under Wine. Now I know that there are Glide wrappers but they don't seem
>> to
>> work for a lot of people, including me, and Glide has been a very popular
>> game API in the mid- to late 90's.
>>
>> Thanks in advance,
>>
>> Vincent Weber,
>> weber dot vincent at gmail dot com
>>     
>
> The policy is roughly to ship dlls that are a core part of Windows. Yes there are glide wrappers and quite a bunch of those succesfuly work on Wine. Personally I don't know actual names but a lot of users have used Glide->OpenGL and even Glide->Direct3D wrappers without issues.
>
> Roderick
>   
Hi,

Glide is very similar to ASIO.
They are :
- very popular (I would say was for glide)
- tied to a driver
- not shipped with application (as for Quicktime for instance)

ASIO cannot be integrated in Wine only due to legal issue but if it's 
not the case for glide (is there legal issue at all ?) I don't see any 
reason to not have it.

Personnaly, I've never found a glide wrapper that satisfied me but I've 
not tested all the existing ones. I also not sure source are available 
for all of them.
I also think that would be good to have glide support in Wine so users 
can use it seamlessly without having to browse the web to find the good one.

I began implementing glide some years ago but I didn't get to far and 
it's barely more than a stub dll.
It may still lies somewhere in my hard drive. It was on my to do list to 
improve it. :-)

Bye
Christian




From research at science.su  Wed Mar  5 17:11:47 2008
From: research at science.su (L. Rahyen)
Date: Wed, 5 Mar 2008 23:11:47 +0000
Subject: Winecfg: Raise max screen resolution to 160 DPI
In-Reply-To: <00d501c87e6c$651c2450$a600fea9@DMITRY>
References: <b6bb06270803032029q6fd721b6ue4287d0c75a1ae22@mail.gmail.com>
	<200803041952.13428.research@science.su>
	<00d501c87e6c$651c2450$a600fea9@DMITRY>
Message-ID: <200803052311.48169.research@science.su>

On Wednesday March 5 2008 02:55:34 Dmitry Timoshkov wrote:
> "L. Rahyen" <research at science.su> wrote:
> > This problem was already solved in this patch [1] by Nigel Liang.
> > Unfortunately, it wasn't accepted and Nigel didn't tried to ask why it
> > was rejected or to resend it.
> > I think I will go ahead and resend his patch.
> >
> > [1] http://www.winehq.org/pipermail/wine-patches/2007-October/044977.html
>
> MultiByteToWideChar is that patch passes negative length for the
> destination buffer which is incorrect.

	That means patch "winecfg: Fix overflow in the DPI field at the 
Graphics tab for DPI value bigger than 127" is incorrect too.
	I think I will write today better patch myself from scratch for this bug 
(after reading some docs about MultiByteToWideChar).
	After Austin's patch "Revert: winecfg raise max screen resolution to 160 DPI" 
will be accepted I will send better fix for this bug (9715).


From truiken at gmail.com  Wed Mar  5 18:37:11 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 5 Mar 2008 18:37:11 -0600
Subject: slight winsock design change proposal
In-Reply-To: <47CF3AC7.9010603@gmail.com>
References: <47CF3AC7.9010603@gmail.com>
Message-ID: <22821af30803051637s6237aa1el9f153278e8441e53@mail.gmail.com>

On Wed, Mar 5, 2008 at 6:28 PM, Christopher Harvey
<arbuckle911 at gmail.com> wrote:
> I'm giving the mswsock.c file some development time. I need to know if
>  the winsock API has been inited. This has already been implemented, but
>  I need to get access to the num_startup variable from the mswsock.c
>  file. I hacked a bit and got it, but hesitate to continue because I
>  don't know if I changed it in the proper way to get access. If this
>  change is fine please accept it. if not please advise on the proper way
>  to see if winsock has been inited or not, from the  mswsock.c file.
>
>  Thanks.
>
> diff --git a/dlls/mswsock/mswsock.c b/dlls/mswsock/mswsock.c
>  index d283405..7f339c0 100644
>  --- a/dlls/mswsock/mswsock.c
>  +++ b/dlls/mswsock/mswsock.c
>  @@ -62,9 +62,10 @@ BOOL WINAPI AcceptEx(
>                                        operation */
>   {
>      FIXME("(listen=%ld, accept=%ld, %p, %d, %d, %d, %p, %p), not implemented\n",
>  -       sListenSocket,sAcceptSocket,lpOutputBuffer,dwReceiveDataLength,
>  -       dwLocalAddressLength,dwRemoteAddressLength,lpdwBytesReceived,lpOverlapped
>  -    );
>  +         sListenSocket,sAcceptSocket,lpOutputBuffer,dwReceiveDataLength,
>  +         dwLocalAddressLength,dwRemoteAddressLength,lpdwBytesReceived,lpOverlapped
>  +         );
>  +    //get_num_startup();  Use this to see if Winsock has been inited yet or not
>      return FALSE;
>   }
>
>  diff --git a/dlls/ws2_32/socket.c b/dlls/ws2_32/socket.c
>  index 502f309..03030a2 100644
>  --- a/dlls/ws2_32/socket.c
>  +++ b/dlls/ws2_32/socket.c
>  @@ -5021,3 +5021,8 @@ INT WINAPI WSCWriteProviderOrder( LPDWORD entry, DWORD number )
>      FIXME("(%p 0x%08x) Stub!\n", entry, number);
>      return 0;
>   }
>  +
>  +INT get_num_startup()
>  +{
>  +    return num_startup;
>  +}
>  diff --git a/include/winsock2.h b/include/winsock2.h
>  index a302331..dcca0e7 100644
>  --- a/include/winsock2.h
>  +++ b/include/winsock2.h
>  @@ -728,6 +728,7 @@ typedef INT (WINAPI *LPFN_WSASTRINGTOADDRESSW)(LPSTR,INT,LPWSAPROTOCOL_INFOA,LPS
>   typedef DWORD (WINAPI *LPFN_WSAWAITFORMULTIPLEEVENTS)(DWORD,const WSAEVENT*,BOOL,DWORD,BOOL);
>   #endif /* WS_API_TYPEDEFS */
>
>  +typedef INT get_num_startup();
>
>   /* Condition function return values */
>   #define CF_ACCEPT       0x0000
>

Are you seriously asking if adding a hack to a public header in order
to read a global variable from another dll is acceptable?  That pretty
much sums up the answer.

-- 
James Hawkins


From dmitry at codeweavers.com  Wed Mar  5 21:04:25 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 6 Mar 2008 11:04:25 +0800
Subject: user32: Fix enumeration for EnumWindowStations and EnumDesktops,
	try2
References: <b130c85e0803051502r521d9c45m6781436764375cfd@mail.gmail.com>
Message-ID: <00c701c87f36$ca9ff020$a600fea9@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

> Oops, the other call has to be null terminated as well.

Do you have test cases for those changes? They look like
a noop to me.

-- 
Dmitry.


From m.b.lankhorst at gmail.com  Wed Mar  5 21:08:19 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 5 Mar 2008 19:08:19 -0800
Subject: user32: Fix enumeration for EnumWindowStations and EnumDesktops,
	try2
In-Reply-To: <00c701c87f36$ca9ff020$a600fea9@DMITRY>
References: <b130c85e0803051502r521d9c45m6781436764375cfd@mail.gmail.com>
	<00c701c87f36$ca9ff020$a600fea9@DMITRY>
Message-ID: <b130c85e0803051908w6a84e879j5f41db0f9a2f5b3f@mail.gmail.com>

Hi Dmitry,

2008/3/5, Dmitry Timoshkov <dmitry at codeweavers.com>:
> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:
>
>  > Oops, the other call has to be null terminated as well.
>
>
> Do you have test cases for those changes? They look like
>  a noop to me.
I ran into this bug when I used those functions. I would get
Default@#$*@#% or Winsta0#$@*#$@ from my ickle enumeration function...
Of course I can't open those.

Cheers,
Maarten.


From ovek at transgaming.com  Wed Mar  5 21:15:55 2008
From: ovek at transgaming.com (Ove Kaaven)
Date: Thu, 06 Mar 2008 04:15:55 +0100
Subject: (resend) msi: Fix bug in handling of multivolume CAB files.
In-Reply-To: <22821af30803041720j2a791f09yc1fae29311dd7b6c@mail.gmail.com>
References: <47CD8C1A.3060607@transgaming.com>	
	<22821af30803041203s1fdd170bn1f8f8fdb85c5f798@mail.gmail.com>	
	<47CDF0ED.1060203@transgaming.com>
	<22821af30803041720j2a791f09yc1fae29311dd7b6c@mail.gmail.com>
Message-ID: <47CF61EB.8090504@transgaming.com>

James Hawkins skrev:
> The tests that now pass with native cabinet dll are test_continuouscab
> (which is similar to what you're trying to test).  The point of
> maxsize is so that it creates continuous cabs...there's no other way
> to do it, and builtin doesn't create continuous cabs at all.

No? Then I really wonder what those hundreds of .cab files it creates 
from that 50k testfile is, if not continuous cabs. What else are they?

> The
> answer to your question is no, because there is no test currently that
> runs down the code path you are fixing.

Looks like it takes an order of magnitude more time writing test cases 
for this stuff than actually fixing that darn bug (fixing the bug took 2 
hours, figuring out how to put a working test case together (trying to 
take differences between native and builtin cabinet into account) has 
taken me all day, probably longer).

Here's what I managed to put together that seems to trigger the problem 
condition... the cab extraction sequence was somehow different in my 
real-world case, so I had to fudge this testcase a little by packing a 
third file into the continuous cab. So what do you think about this 
test, then?
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: msi-test.patch
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080306/6c4ef7c2/attachment-0001.txt 

From truiken at gmail.com  Wed Mar  5 21:25:31 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 5 Mar 2008 21:25:31 -0600
Subject: (resend) msi: Fix bug in handling of multivolume CAB files.
In-Reply-To: <47CF61EB.8090504@transgaming.com>
References: <47CD8C1A.3060607@transgaming.com>
	<22821af30803041203s1fdd170bn1f8f8fdb85c5f798@mail.gmail.com>
	<47CDF0ED.1060203@transgaming.com>
	<22821af30803041720j2a791f09yc1fae29311dd7b6c@mail.gmail.com>
	<47CF61EB.8090504@transgaming.com>
Message-ID: <22821af30803051925u6d405215i245d96a360a9b768@mail.gmail.com>

On Wed, Mar 5, 2008 at 9:15 PM, Ove Kaaven <ovek at transgaming.com> wrote:
> James Hawkins skrev:
>
> > The tests that now pass with native cabinet dll are test_continuouscab
>  > (which is similar to what you're trying to test).  The point of
>  > maxsize is so that it creates continuous cabs...there's no other way
>  > to do it, and builtin doesn't create continuous cabs at all.
>
>  No? Then I really wonder what those hundreds of .cab files it creates
>  from that 50k testfile is, if not continuous cabs. What else are they?
>

Sorry, I meant that it doesn't create the compressed continuous cabs
that the tests expect.

>  > The
>  > answer to your question is no, because there is no test currently that
>  > runs down the code path you are fixing.
>
>  Looks like it takes an order of magnitude more time writing test cases
>  for this stuff than actually fixing that darn bug (fixing the bug took 2
>  hours, figuring out how to put a working test case together (trying to
>  take differences between native and builtin cabinet into account) has
>  taken me all day, probably longer).
>

You have to keep in consideration all the time that has been saved
fixing bugs later down the road because the test cases have kept
regressions to a minimum (and just flat out wrong code being added).

>  Here's what I managed to put together that seems to trigger the problem
>  condition... the cab extraction sequence was somehow different in my
>  real-world case, so I had to fudge this testcase a little by packing a
>  third file into the continuous cab. So what do you think about this
>  test, then?
>

Looks good to me, as long as the test fails without your fix and
succeeds with your fix (with the cabinet override of course).  When
submitting the tests to wine-patches, make sure you add todo_wine to
the failing tests (because of cabinet).

-- 
James Hawkins


From austinenglish at gmail.com  Wed Mar  5 22:08:56 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 5 Mar 2008 22:08:56 -0600
Subject: Regression tests - recent regressions
Message-ID: <b6bb06270803052008y3cb8e571ya85518ee01e35723@mail.gmail.com>

In today's git, I've had a few regressions in make -k test:

austin at zelda:~/wine-git$ grep -i 'Test failed' wine-0.9.56-420-g22f146f.txt
visual.c:1741: Test failed: double texbem failed: Got color
0x00ff00ff, expected 0x00ffff00.
systray.c:89: Test failed: ret 0x1 which is not a window
systray.c:90: Test failed: hWnd overwritten
msg.c:9415: Test failed: 30: ShowWindow(SW_RESTORE): in msg 0x0047
expecting wParam 0x8160 got 0x8162
msg.c:9415: Test failed: 50: ShowWindow(SW_SHOWNORMAL): the msg 0x0047
was expected, but got msg 0x0005 instead
msg.c:9415: Test failed: 50: ShowWindow(SW_SHOWNORMAL): the msg 0x0003
was expected, but got msg 0x0009 instead
msg.c:9415: Test failed: 50: ShowWindow(SW_SHOWNORMAL): the msg 0x0005
was expected, but got msg 0x0047 instead
msg.c:9415: Test failed: 50: ShowWindow(SW_SHOWNORMAL): the msg
sequence is not complete: expected 0000 - actual 0003
msg.c:9415: Test failed: 56: ShowWindow(SW_SHOWNOACTIVATE): in msg
0x0047 expecting wParam 0x8170 got 0x8172
win.c:3271: Test failed: pixel should be black, color is 00205860
win.c:3275: Test failed: pixel should be black, color is 00205860
win.c:3302: Test failed: pixel should be black, color is 00205860

+heap adds:
job.c:250: Test failed: GetState failed: 0x80004001
job.c:266: Test failed: Resume failed to return BG_E_EMPTY error: 0x80004001
input.c:470: Test failed: 01: 12 from 81 -> 01 unexpected
input.c:470: Test failed: 01: a4 from 81 -> 01 unexpected
input.c:461: Test failed: 03: 12 from 00 -> 00 instead of 80 -> 00
input.c:461: Test failed: 03: a4 from 00 -> 00 instead of 80 -> 00
input.c:538: Test failed: not enough messages found; looking for 0

I don't have time to pin these down any further, as I've got a midterm
tomorrow then spring break after that. But thought those of you who
made recent commits in this area should take a look. If you need a
specific test run or log, then please e-mail me.

-Austin


From ovek at transgaming.com  Wed Mar  5 22:26:27 2008
From: ovek at transgaming.com (Ove Kaaven)
Date: Thu, 06 Mar 2008 05:26:27 +0100
Subject: (resend) msi: Fix bug in handling of multivolume CAB files.
In-Reply-To: <22821af30803051925u6d405215i245d96a360a9b768@mail.gmail.com>
References: <47CD8C1A.3060607@transgaming.com>	
	<22821af30803041203s1fdd170bn1f8f8fdb85c5f798@mail.gmail.com>	
	<47CDF0ED.1060203@transgaming.com>	
	<22821af30803041720j2a791f09yc1fae29311dd7b6c@mail.gmail.com>	
	<47CF61EB.8090504@transgaming.com>
	<22821af30803051925u6d405215i245d96a360a9b768@mail.gmail.com>
Message-ID: <47CF7273.7070801@transgaming.com>

James Hawkins skrev:
> On Wed, Mar 5, 2008 at 9:15 PM, Ove Kaaven <ovek at transgaming.com> wrote:
>> James Hawkins skrev:
>>
>>> The tests that now pass with native cabinet dll are test_continuouscab
>>  > (which is similar to what you're trying to test).  The point of
>>  > maxsize is so that it creates continuous cabs...there's no other way
>>  > to do it, and builtin doesn't create continuous cabs at all.
>>
>>  No? Then I really wonder what those hundreds of .cab files it creates
>>  from that 50k testfile is, if not continuous cabs. What else are they?
>>
> 
> Sorry, I meant that it doesn't create the compressed continuous cabs
> that the tests expect.

Well, that's because create_cc_test_files expect to get 2 cab files, not 
600, and so the "caesar" part proceeds to overwrite the 3rd in the 
series, rendering the whole series unreadable. By adjusting the max size 
so that only 2 (uncompressed) cab files are created, most of the todo 
tests appear to run fine. Just changing the file name might also work. 
(Actually I don't see any reason your tests would really need to depend 
on compression anyway, it's supposed to be a test of MSI, not cabinet.)

>>  Here's what I managed to put together that seems to trigger the problem
>>  condition... the cab extraction sequence was somehow different in my
>>  real-world case, so I had to fudge this testcase a little by packing a
>>  third file into the continuous cab. So what do you think about this
>>  test, then?
>>
> 
> Looks good to me, as long as the test fails without your fix and
> succeeds with your fix (with the cabinet override of course).

Actually, I think it works with both builtin and native cabinet, because 
my create_cc2_test_files creates uncompressed continuous cabinets, which 
both builtin and native seem to handle. (I was almost forced to use 
uncompressed anyway, because create_file creates sparse files, which 
compresses into almost nothing, which made it difficult to predict 
whether the contents would be distributed the way I needed...)


From dmitry at codeweavers.com  Thu Mar  6 01:57:32 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 6 Mar 2008 15:57:32 +0800
Subject: [PATCH] gdiplus: Fix errors in image dimensions.
References: <1204789580-3462-1-git-send-email-nathan.beckmann@gmail.com>
Message-ID: <036501c87f5f$bccf9300$a600fea9@DMITRY>

"Nathan Beckmann" <nathan.beckmann at gmail.com> wrote:

> -    y = (UINT)(((REAL)y) * ((REAL)GetDeviceCaps(hdcref, LOGPIXELSY)) /
> -              ((REAL)INCH_HIMETRIC));
> +    /* this calculation can lead to truncation error */
> +    y = (UINT)((((REAL)y) * ((REAL)GetDeviceCaps(hdcref, LOGPIXELSY)) /
> +              ((REAL)INCH_HIMETRIC)) + 0.5);

Using MulDiv instead should be a more appropriate fix here.

-- 
Dmitry.


From hverbeet at gmail.com  Thu Mar  6 02:23:14 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Thu, 6 Mar 2008 09:23:14 +0100
Subject: WineD3D: Implement depth copy from onscreen to offscreen surface
	when depth fixup is used
In-Reply-To: <47CF2E6B.2040105@gmail.com>
References: <47CF2E6B.2040105@gmail.com>
Message-ID: <d658b69e0803060023m53766e0fj39ea3893635afc86@mail.gmail.com>

On 06/03/2008, Frank Richter <frank.richter at gmail.com> wrote:
>
This doesn't work.
The problem with doing depth copy with fixed up depth stencil is that
the size of the render buffer is different from the depth stencil
size. Basically what needs to happen is that the render buffer
contents need to be blitted to the depth stencil before copying the
depth stencil from offscreen to onscreen.

Aside from that, depth stencil copying is broken (in that it doesn't
always copy when it should, and sometimes copies when it shouldn't).
I've got a patch that fixes this, but it causes regressions. Changing
anything in the depth copying code would cause some nasty conflicts in
my patch. Of course if you're interested in tracking down regressions
I'd be happy to send you the patch.


From nathan.beckmann at gmail.com  Thu Mar  6 03:27:33 2008
From: nathan.beckmann at gmail.com (Nathan Beckmann)
Date: Thu, 6 Mar 2008 01:27:33 -0800
Subject: [PATCH] GDI+: Implement GdipGetImageEncoders.
In-Reply-To: <3a22664a0803060038j43e96407x3049049fc4c4a1d3@mail.gmail.com>
References: <1204744897-28734-1-git-send-email-nathan.beckmann@gmail.com>
	<3a22664a0803060038j43e96407x3049049fc4c4a1d3@mail.gmail.com>
Message-ID: <3a22664a0803060127j42f56f7p59190b7033e0c4a@mail.gmail.com>

Don't apply this patch.

The test cases crash on Windows.

I was using winetricks to test and accidentally did not test under Windows.

A "try 2" patch has been sent that fixes these issues.

Sorry.

- Nathan


From stefan at codeweavers.com  Thu Mar  6 03:36:33 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 6 Mar 2008 10:36:33 +0100
Subject: Regression tests - recent regressions
In-Reply-To: <b6bb06270803052008y3cb8e571ya85518ee01e35723@mail.gmail.com>
References: <b6bb06270803052008y3cb8e571ya85518ee01e35723@mail.gmail.com>
Message-ID: <200803061036.33157.stefan@codeweavers.com>

Am Donnerstag, 6. M?rz 2008 05:08:56 schrieb Austin English:
> visual.c:1741: Test failed: double texbem failed: Got color
> 0x00ff00ff, expected 0x00ffff00.
Which GPU do you have?


From austinenglish at gmail.com  Thu Mar  6 03:47:26 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 6 Mar 2008 03:47:26 -0600
Subject: Regression tests - recent regressions
In-Reply-To: <200803061036.33157.stefan@codeweavers.com>
References: <b6bb06270803052008y3cb8e571ya85518ee01e35723@mail.gmail.com>
	<200803061036.33157.stefan@codeweavers.com>
Message-ID: <b6bb06270803060147l3fe921dbxf5be6e78f850e3ca@mail.gmail.com>

On Thu, Mar 6, 2008 at 3:36 AM, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Donnerstag, 6. M?rz 2008 05:08:56 schrieb Austin English:
>
> > visual.c:1741: Test failed: double texbem failed: Got color
>  > 0x00ff00ff, expected 0x00ffff00.
>  Which GPU do you have?
>

01:00.0 VGA compatible controller: nVidia Corporation NV34 [GeForce FX
5200] (rev a1) (prog-if 00 [VGA])
       Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop-
ParErr- Stepping- SERR- FastB2B-
       Status: Cap+ 66MHz+ UDF- FastB2B+ ParErr- DEVSEL=medium
>TAbort- <TAbort- <MAbort- >SERR- <PERR-
       Latency: 248 (1250ns min, 250ns max)
       Interrupt: pin A routed to IRQ 16
       Region 0: Memory at fb000000 (32-bit, non-prefetchable) [size=16M]
       Region 1: Memory at e0000000 (32-bit, prefetchable) [size=256M]
       [virtual] Expansion ROM at faf00000 [disabled] [size=128K]
       Capabilities: [60] Power Management version 2
               Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA
PME(D0-,D1-,D2-,D3hot-,D3cold-)
               Status: D0 PME-Enable- DSel=0 DScale=0 PME-
       Capabilities: [44] AGP version 3.0
               Status: RQ=32 Iso- ArqSz=0 Cal=3 SBA+ ITACoh- GART64-
HTrans- 64bit- FW+ AGP3+ Rate=x4,x8
               Command: RQ=32 ArqSz=0 Cal=0 SBA+ AGP+ GART64- 64bit-
FW- Rate=x8

Driver: nvidia-glx 1:1.0.9639+2.6.22.4-14.10

From julliard at winehq.org  Thu Mar  6 04:49:39 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 06 Mar 2008 11:49:39 +0100
Subject: Regression tests - recent regressions
In-Reply-To: <b6bb06270803052008y3cb8e571ya85518ee01e35723@mail.gmail.com>
	(Austin English's message of "Wed, 5 Mar 2008 22:08:56 -0600")
References: <b6bb06270803052008y3cb8e571ya85518ee01e35723@mail.gmail.com>
Message-ID: <87bq5sjfek.fsf@wine.dyndns.org>

"Austin English" <austinenglish at gmail.com> writes:

> In today's git, I've had a few regressions in make -k test:
>
> austin at zelda:~/wine-git$ grep -i 'Test failed' wine-0.9.56-420-g22f146f.txt
> visual.c:1741: Test failed: double texbem failed: Got color
> 0x00ff00ff, expected 0x00ffff00.
> systray.c:89: Test failed: ret 0x1 which is not a window
> systray.c:90: Test failed: hWnd overwritten
> msg.c:9415: Test failed: 30: ShowWindow(SW_RESTORE): in msg 0x0047
> expecting wParam 0x8160 got 0x8162
> msg.c:9415: Test failed: 50: ShowWindow(SW_SHOWNORMAL): the msg 0x0047
> was expected, but got msg 0x0005 instead
> msg.c:9415: Test failed: 50: ShowWindow(SW_SHOWNORMAL): the msg 0x0003
> was expected, but got msg 0x0009 instead
> msg.c:9415: Test failed: 50: ShowWindow(SW_SHOWNORMAL): the msg 0x0005
> was expected, but got msg 0x0047 instead
> msg.c:9415: Test failed: 50: ShowWindow(SW_SHOWNORMAL): the msg
> sequence is not complete: expected 0000 - actual 0003
> msg.c:9415: Test failed: 56: ShowWindow(SW_SHOWNOACTIVATE): in msg
> 0x0047 expecting wParam 0x8170 got 0x8172
> win.c:3271: Test failed: pixel should be black, color is 00205860
> win.c:3275: Test failed: pixel should be black, color is 00205860
> win.c:3302: Test failed: pixel should be black, color is 00205860
>
> +heap adds:
> job.c:250: Test failed: GetState failed: 0x80004001
> job.c:266: Test failed: Resume failed to return BG_E_EMPTY error: 0x80004001
> input.c:470: Test failed: 01: 12 from 81 -> 01 unexpected
> input.c:470: Test failed: 01: a4 from 81 -> 01 unexpected
> input.c:461: Test failed: 03: 12 from 00 -> 00 instead of 80 -> 00
> input.c:461: Test failed: 03: a4 from 00 -> 00 instead of 80 -> 00
> input.c:538: Test failed: not enough messages found; looking for 0

Most of these are not real regressions. There are a number of race
conditions in the tests that will cause these things to fail
sometimes. You have to run make test several times in a row to make sure
they are real failures.

-- 
Alexandre Julliard
julliard at winehq.org


From nathan.beckmann at gmail.com  Thu Mar  6 02:38:30 2008
From: nathan.beckmann at gmail.com (Nathan Beckmann)
Date: Thu, 6 Mar 2008 00:38:30 -0800
Subject: [PATCH] GDI+: Implement GdipGetImageEncoders.
In-Reply-To: <1204744897-28734-1-git-send-email-nathan.beckmann@gmail.com>
References: <1204744897-28734-1-git-send-email-nathan.beckmann@gmail.com>
Message-ID: <3a22664a0803060038j43e96407x3049049fc4c4a1d3@mail.gmail.com>

Don't apply this patch.

The test cases crash on Windows.

I was using winetricks to test and accidentally did not test under Windows.

- Nathan

On Wed, Mar 5, 2008 at 11:21 AM, Nathan Beckmann
<nathan.beckmann at gmail.com> wrote:
> Implement helper GdipGetImageEncodersSize.
>
>  Also included tests.
>  ---
>   dlls/gdiplus/gdiplus.spec  |    4 +-
>   dlls/gdiplus/image.c       |   87 ++++++++++++++++++++++++++++++++++++++++++++
>   dlls/gdiplus/tests/image.c |   53 +++++++++++++++++++++++++++
>   include/gdiplusenums.h     |   13 +++++++
>   include/gdiplusflat.h      |    2 +
>   include/gdiplusimaging.h   |   35 ++++++++++++++++++
>   6 files changed, 192 insertions(+), 2 deletions(-)
>
>  diff --git a/dlls/gdiplus/gdiplus.spec b/dlls/gdiplus/gdiplus.spec
>  index b4f314a..a477086 100644
>  --- a/dlls/gdiplus/gdiplus.spec
>  +++ b/dlls/gdiplus/gdiplus.spec
>  @@ -284,8 +284,8 @@
>   @ stub GdipGetImageDecoders
>   @ stub GdipGetImageDecodersSize
>   @ stdcall GdipGetImageDimension(ptr ptr ptr)
>  -@ stub GdipGetImageEncoders
>  -@ stub GdipGetImageEncodersSize
>  +@ stdcall GdipGetImageEncoders(long long ptr)
>  +@ stdcall GdipGetImageEncodersSize(ptr ptr)
>   @ stub GdipGetImageFlags
>   @ stdcall GdipGetImageGraphicsContext(ptr ptr)
>   @ stdcall GdipGetImageHeight(ptr ptr)
>  diff --git a/dlls/gdiplus/image.c b/dlls/gdiplus/image.c
>  index 5871209..330d90f 100644
>  --- a/dlls/gdiplus/image.c
>  +++ b/dlls/gdiplus/image.c
>  @@ -831,3 +831,90 @@ GpStatus WINGDIPAPI GdipSetImagePalette(GpImage *image,
>
>      return NotImplemented;
>   }
>  +
>  +/*************************************************************************
>  + * Encoders -
>  + *   Implemented as dummy objects that let the user know which files are
>  + *   supported. Actual encoding is done by OLE.
>  + *
>  + *   This code is based heavily on libgdiplus (Mono):
>  + */
>  +
>  +typedef enum {
>  +    BMP,
>  +    ICO,
>  +} ImageFormat;
>  +
>  +#define NUM_ENCODERS_SUPPORTED 2
>  +
>  +/* ImageCodecInfo creation routines taken from libgdiplus */
>  +static const WCHAR bmp_codecname[] = {'B', 'u', 'i','l', 't', '-','i', 'n', ' ', 'B', 'M', 'P', 0}; /* Built-in BMP */
>  +static const WCHAR bmp_extension[] = {'*','.','B', 'M', 'P',';', '*','.', 'D','I', 'B',';', '*','.', 'R', 'L', 'E',0}; /* *.BMP;*.DIB;*.RLE */
>  +static const WCHAR bmp_mimetype[] = {'i', 'm', 'a','g', 'e', '/', 'b', 'm', 'p', 0}; /* image/bmp */
>  +static const WCHAR bmp_format[] = {'B', 'M', 'P', 0}; /* BMP */
>  +static const BYTE bmp_sig_pattern[] = { 0x42, 0x4D };
>  +static const BYTE bmp_sig_mask[] = { 0xFF, 0xFF };
>  +
>  +static const WCHAR ico_codecname[] = {'B', 'u', 'i','l', 't', '-','i', 'n', ' ', 'I', 'C', 'O', 0}; /* Built-in ICO */
>  +static const WCHAR ico_extension[] = {'*','.','I', 'C', 'O', 0}; /* *.ICO */
>  +static const WCHAR ico_mimetype[] = {'i', 'm', 'a','g', 'e', '/', 'x', '-', 'i', 'c', 'o', 'n', 0}; /* image/x-icon */
>  +static const WCHAR ico_format[] = {'I', 'C', 'O', 0}; /* ICO */
>  +static const BYTE ico_sig_pattern[] = { 0x00, 0x00, 0x01, 0x00 };
>  +static const BYTE ico_sig_mask[] = { 0xFF, 0xFF, 0xFF, 0xFF };
>  +
>  +static const ImageCodecInfo codecs[NUM_ENCODERS_SUPPORTED] =
>  +    {
>  +        { /* BMP */
>  +            /* Clsid */              { 0x557cf400, 0x1a04, 0x11d3, { 0x9a, 0x73, 0x0, 0x0, 0xf8, 0x1e, 0xf3, 0x2e } },
>  +            /* FormatID */           { 0xb96b3cabU, 0x0728U, 0x11d3U, {0x9d, 0x7b, 0x00, 0x00, 0xf8, 0x1e, 0xf3, 0x2e} },
>  +            /* CodecName */          (const WCHAR*) bmp_codecname,
>  +            /* DllName */            NULL,
>  +            /* FormatDescription */  (const WCHAR*) bmp_format,
>  +            /* FilenameExtension */  (const WCHAR*) bmp_extension,
>  +            /* MimeType */           (const WCHAR*) bmp_mimetype,
>  +            /* Flags */              ImageCodecFlagsEncoder | ImageCodecFlagsDecoder | ImageCodecFlagsSupportBitmap | ImageCodecFlagsBuiltin,
>  +            /* Version */            1,
>  +            /* SigCount */           1,
>  +            /* SigSize */            2,
>  +            /* SigPattern */         (const BYTE*) bmp_sig_pattern,
>  +            /* SigMask */            (const BYTE*) bmp_sig_mask,
>  +        },
>  +        { /* ICO */
>  +            /* Clsid */              { 0x557cf407, 0x1a04, 0x11d3, { 0x9a, 0x73, 0x0, 0x0, 0xf8, 0x1e, 0xf3, 0x2e } },
>  +            /* FormatID */           { 0xb96b3cb5U, 0x0728U, 0x11d3U, {0x9d, 0x7b, 0x00, 0x00, 0xf8, 0x1e, 0xf3, 0x2e} },
>  +            /* CodecName */          (const WCHAR*) ico_codecname,
>  +            /* DllName */            NULL,
>  +            /* FormatDescription */  (const WCHAR*) ico_format,
>  +            /* FilenameExtension */  (const WCHAR*) ico_extension,
>  +            /* MimeType */           (const WCHAR*) ico_mimetype,
>  +            /* Flags */              ImageCodecFlagsDecoder | ImageCodecFlagsSupportBitmap | ImageCodecFlagsBuiltin,
>  +            /* Version */            1,
>  +            /* SigCount */           1,
>  +            /* SigSize */            4,
>  +            /* SigPattern */         (const BYTE*) ico_sig_pattern,
>  +            /* SigMask */            (const BYTE*) ico_sig_mask,
>  +        },
>  +    };
>  +
>  +GpStatus WINGDIPAPI GdipGetImageEncodersSize(UINT *numEncoders, UINT *size)
>  +{
>  +    if (!numEncoders || !size)
>  +        return InvalidParameter;
>  +
>  +    *numEncoders = NUM_ENCODERS_SUPPORTED;
>  +    *size = sizeof (codecs);
>  +
>  +    return Ok;
>  +}
>  +
>  +GpStatus WINGDIPAPI GdipGetImageEncoders(UINT numEncoders, UINT size, ImageCodecInfo *encoders)
>  +{
>  +    if (!encoders ||
>  +        (numEncoders != NUM_ENCODERS_SUPPORTED) ||
>  +        (size != sizeof (codecs)))
>  +        return InvalidParameter;
>  +
>  +    memcpy(encoders, codecs, sizeof (codecs));
>  +
>  +    return Ok;
>  +}
>  diff --git a/dlls/gdiplus/tests/image.c b/dlls/gdiplus/tests/image.c
>  index 5ff164d..5f75c15 100644
>  --- a/dlls/gdiplus/tests/image.c
>  +++ b/dlls/gdiplus/tests/image.c
>  @@ -122,6 +122,58 @@ static void test_LoadingImages(void)
>      expect(InvalidParameter, stat);
>   }
>
>  +static void test_encoders(void)
>  +{
>  +    GpStatus stat;
>  +    UINT n;
>  +    UINT s;
>  +    ImageCodecInfo *codecs;
>  +    int i;
>  +    int bmp_found;
>  +
>  +    static const WCHAR bmp_format[] = {'B', 'M', 'P', 0};
>  +
>  +    stat = GdipGetImageEncodersSize(NULL, NULL);
>  +    expect(stat, InvalidParameter);
>  +
>  +    stat = GdipGetImageEncodersSize(&n, &s);
>  +    expect(stat, Ok);
>  +
>  +    codecs = GdipAlloc(sizeof(ImageCodecInfo) * n);
>  +    if (!codecs)
>  +        return;
>  +
>  +    stat = GdipGetImageEncoders(n, s, NULL);
>  +    expect(stat, InvalidParameter);
>  +
>  +    stat = GdipGetImageEncoders(0, s, codecs);
>  +    expect(stat, InvalidParameter);
>  +
>  +    stat = GdipGetImageEncoders(n, s-1, codecs);
>  +    expect(stat, InvalidParameter);
>  +
>  +    stat = GdipGetImageEncoders(n, s+1, codecs);
>  +    expect(stat, InvalidParameter);
>  +
>  +    stat = GdipGetImageEncoders(n, s, codecs);
>  +    expect(stat, Ok);
>  +
>  +    bmp_found = FALSE;
>  +    for (i = 0; i < n; i++)
>  +        {
>  +            if (CompareStringW(LOCALE_SYSTEM_DEFAULT, 0,
>  +                               codecs[i].FormatDescription, -1,
>  +                               bmp_format, -1) == CSTR_EQUAL) {
>  +                bmp_found = TRUE;
>  +                break;
>  +            }
>  +        }
>  +    if (!bmp_found)
>  +        ok(FALSE, "No BMP codec found.\n");
>  +
>  +    GdipFree(codecs);
>  +}
>  +
>   START_TEST(image)
>   {
>      struct GdiplusStartupInput gdiplusStartupInput;
>  @@ -137,6 +189,7 @@ START_TEST(image)
>      test_Scan0();
>      test_GetImageDimension();
>      test_LoadingImages();
>  +    test_encoders();
>
>      GdiplusShutdown(gdiplusToken);
>   }
>  diff --git a/include/gdiplusenums.h b/include/gdiplusenums.h
>  index 7c97005..c579ebe 100644
>  --- a/include/gdiplusenums.h
>  +++ b/include/gdiplusenums.h
>  @@ -257,6 +257,18 @@ enum HotkeyPrefix
>      HotkeyPrefixHide   = 2
>   };
>
>  +enum ImageCodecFlags
>  +{
>  +    ImageCodecFlagsEncoder             = 1,
>  +    ImageCodecFlagsDecoder             = 2,
>  +    ImageCodecFlagsSupportBitmap       = 4,
>  +    ImageCodecFlagsSupportVector       = 8,
>  +    ImageCodecFlagsSeekableEncode      = 16,
>  +    ImageCodecFlagsBlockingDecode      = 32,
>  +    ImageCodecFlagsBuiltin             = 65536,
>  +    ImageCodecFlagsSystem              = 131072,
>  +    ImageCodecFlagsUser                        = 262144
>  +};
>
>   #ifndef __cplusplus
>
>  @@ -286,6 +298,7 @@ typedef enum StringTrimming StringTrimming;
>   typedef enum StringFormatFlags StringFormatFlags;
>   typedef enum HotkeyPrefix HotkeyPrefix;
>   typedef enum PenAlignment GpPenAlignment;
>  +typedef enum ImageCodecFlags ImageCodecFlags;
>
>   #endif /* end of c typedefs */
>
>  diff --git a/include/gdiplusflat.h b/include/gdiplusflat.h
>  index 1f635ba..b15a4ea 100644
>  --- a/include/gdiplusflat.h
>  +++ b/include/gdiplusflat.h
>  @@ -257,6 +257,8 @@ GpStatus WINGDIPAPI GdipCreateBitmapFromStreamICM(IStream*,GpBitmap**);
>   GpStatus WINGDIPAPI GdipDisposeImage(GpImage*);
>   GpStatus WINGDIPAPI GdipFindFirstImageItem(GpImage*,ImageItemData*);
>   GpStatus WINGDIPAPI GdipFindNextImageItem(GpImage*,ImageItemData*);
>  +GpStatus WINGDIPAPI GdipGetImageEncodersSize(UINT *numEncoders, UINT *size);
>  +GpStatus WINGDIPAPI GdipGetImageEncoders(UINT numEncoders, UINT size, ImageCodecInfo *encoders);
>   GpStatus WINGDIPAPI GdipGetImageItemData(GpImage*,ImageItemData*);
>   GpStatus WINGDIPAPI GdipGetImageBounds(GpImage*,GpRectF*,GpUnit*);
>   GpStatus WINGDIPAPI GdipGetImageGraphicsContext(GpImage*,GpGraphics**);
>  diff --git a/include/gdiplusimaging.h b/include/gdiplusimaging.h
>  index c78e1b1..a843da1 100644
>  --- a/include/gdiplusimaging.h
>  +++ b/include/gdiplusimaging.h
>  @@ -43,6 +43,24 @@ public:
>      EncoderParameter Parameter[1];
>   };
>
>  +class ImageCodecInfo
>  +{
>  +public:
>  +    CLSID Clsid;
>  +    GUID  FormatID;
>  +    const WCHAR* CodecName;
>  +    const WCHAR* DllName;
>  +    const WCHAR* FormatDescription;
>  +    const WCHAR* FilenameExtension;
>  +    const WCHAR* MimeType;
>  +    DWORD Flags;
>  +    DWORD Version;
>  +    DWORD SigCount;
>  +    DWORD SigSize;
>  +    const BYTE* SigPattern;
>  +    const BYTE* SigMask;
>  +};
>  +
>   class BitmapData
>   {
>   public:
>  @@ -84,6 +102,23 @@ typedef struct EncoderParameters
>      EncoderParameter Parameter[1];
>   } EncoderParameters;
>
>  +typedef struct ImageCodecInfo
>  +{
>  +    CLSID Clsid;
>  +    GUID  FormatID;
>  +    const WCHAR* CodecName;
>  +    const WCHAR* DllName;
>  +    const WCHAR* FormatDescription;
>  +    const WCHAR* FilenameExtension;
>  +    const WCHAR* MimeType;
>  +    DWORD Flags;
>  +    DWORD Version;
>  +    DWORD SigCount;
>  +    DWORD SigSize;
>  +    const BYTE* SigPattern;
>  +    const BYTE* SigMask;
>  +} ImageCodecInfo;
>  +
>   typedef struct BitmapData
>   {
>      UINT Width;
>  --
>  1.5.4.2
>
>


From mahanuu at free.fr  Thu Mar  6 08:08:23 2008
From: mahanuu at free.fr (Emmanuel Maillard)
Date: Thu, 6 Mar 2008 15:08:23 +0100
Subject: winequartz.drv Mac OS X UI discontinued?
In-Reply-To: <19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>
	<200803021850.04583.stefan@codeweavers.com>
	<19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>
Message-ID: <EEDB1C7D-011E-431A-97FA-9C0E24015C82@free.fr>

Hi,

I post a new quartzdrv patch for wine-0.9.56 on Darwine SF patches  
page :
http://sourceforge.net/tracker/index.php?func=detail&aid=1908759&group_id=69890&atid=526089

It's not fully update to wine changes (SysCommandSizeMove didn't be  
reviewed)
and don't contain all changes I initially planned but will be next time.

Cheers

Emmanuel


Le 2 mars 08 ? 19:53, Steven Edwards a ?crit :

> Hi,
>
> On Sun, Mar 2, 2008 at 12:50 PM, Stefan D?singer <stefan at codeweavers.com 
> > wrote:
>> Am Sonntag, 2. M?rz 2008 18:14:45 schrieb Adam Strzelecki:
>>> Do you guys think about reviving winequartz.drv?
>> I think everyone would greatly welcome efforts to continue it, and  
>> in fact
>> Steven Edwards is currently trying to bring the old driver up to  
>> date.
>
> There is a public branch where the Wine quartzdrv will go even if its
> not accepted in to Winehq. I have been from time to time bringing in
> infrastructure changes from the old winequartzdrv however the current
> tree is empty as the developer of the prior editions, Emmanuel
> Maillard,  is in the process of overhauling it from recent changes to
> the Wine driver model.
>
> Keep an eye on
>
> http://wiki.winehq.org/MacOSX/QuartzDriver
>
> And hopefully in the next few weeks we will have a newer patch in the
> winequartzdrv tree for a more recent version of Wine. I am not sure
> what design changes Emmanuel is wanting to make but hopefully they
> will be more to Alexandre's liking and can eventually go in to normal
> winehq. If you want to work on quartzdrv with Emmanuel, send him an
> email to get an idea of what he needs and what the design will be,
> then apply for write access to http://repo.or.cz and I will add you to
> the winequartzdrv branch.
>
> -- 
> Steven Edwards
>
> "There is one thing stronger than all the armies in the world, and
> that is an idea whose time has come." - Victor Hugo
>
>



From julliard at winehq.org  Thu Mar  6 09:32:25 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 06 Mar 2008 16:32:25 +0100
Subject: msi [2/3]: Fix handling of published installer properties
In-Reply-To: <22821af30803052111n38300ae8lf3c5cc66fc49ce6@mail.gmail.com>
	(James Hawkins's message of "Wed, 5 Mar 2008 23:11:43 -0600")
References: <22821af30803052111n38300ae8lf3c5cc66fc49ce6@mail.gmail.com>
Message-ID: <8763vzkgvq.fsf@wine.dyndns.org>

"James Hawkins" <jhawkins at codeweavers.com> writes:

> The tests are in the next patch.  Fixes bug 7189.
> http://bugs.winehq.org/show_bug.cgi?id=7189

You need to fix the todo_wine tests in the same patch, I can't apply a
patch that causes failures:

../../../tools/runtest -q -P wine -M msi.dll -T ../../.. -p msi_test.exe.so install.c && touch install.ok
install.c:2233: Test succeeded inside todo block: Expected ERROR_FILE_NOT_FOUND, got 2
install.c:2259: Test succeeded inside todo block: Expected ERROR_FILE_NOT_FOUND, got 2
install.c:2341: Test succeeded inside todo block: Expected ERROR_FILE_NOT_FOUND, got 2
install.c:2469: Test succeeded inside todo block: Expected ERROR_FILE_NOT_FOUND, got 2
install.c:2495: Test succeeded inside todo block: Expected ERROR_FILE_NOT_FOUND, got 2
install.c:2610: Test succeeded inside todo block: Expected ERROR_FILE_NOT_FOUND, got 2
install.c:2633: Test succeeded inside todo block: Expected ERROR_FILE_NOT_FOUND, got 2
install.c:2797: Test succeeded inside todo block: Expected ERROR_FILE_NOT_FOUND, got 2
install.c:2823: Test succeeded inside todo block: Expected ERROR_FILE_NOT_FOUND, got 2
install.c:2900: Test succeeded inside todo block: Expected ERROR_FILE_NOT_FOUND, got 2
install.c:3241: Test succeeded inside todo block: Expected ERROR_FILE_NOT_FOUND, got 2
make: *** [install.ok] Error 11

And if I apply your 3/3 patch I now get:

../../../tools/runtest -q -P wine -M msi.dll -T ../../.. -p msi_test.exe.so install.c && touch install.ok
install.c:4398: Test failed: Expected ERROR_UNKNOWN_PRODUCT, got 0
make: *** [install.ok] Error 1

-- 
Alexandre Julliard
julliard at winehq.org


From martin at hinner.info  Thu Mar  6 09:56:42 2008
From: martin at hinner.info (Martin Hinner)
Date: Thu, 6 Mar 2008 16:56:42 +0100
Subject: Getting apps running under Wine
In-Reply-To: <3a768c550803030909q29647b57i704040f69b7dac72@mail.gmail.com>
References: <24d1a1690803030416u128ff6a7i59ad69eeeb06f976@mail.gmail.com>
	<3a768c550803030909q29647b57i704040f69b7dac72@mail.gmail.com>
Message-ID: <24d1a1690803060756u65cc9de6vb066e242699aa031@mail.gmail.com>

Hi,

> Please open a bug at our bugzilla (bugs.winehq.org).  Attaching
>  screenshots of the problem would help.  We discourage you from working
>  around Wine bugs, because if we fix the bug, we'll break your app in
>  the process.  Better to fix Wine.

I 100% agree, but I wasn't sure if wine team is willing/able to help
with this. Will do.

>  >  2) Windows drivers. We use DLL that depends on some Win32 drivers.
>  >  Linux driver is available with similar API, so it's not a big problem
>  >  to change our application to use Linux library. I understand that
>  >  clearest way how to solve this problem is to make .dll.so file, but
>  >  it's quite complicated for this particular application and I would
>  >  prefer much more to add few if conditions to our Windows code that
>  >  would recognize Wine under Linux and load native .so file (not
>  >  .dll.so!). Is this possible? How to deal with different calling
>  >  conventions between gcc and Visual C++ 2003 ?
> I'm not sure what you mean by different calling conventions; gcc
>  supports the __stdcall convention, at least, and VC++ supports
>  __cdecl.  If you're using __fastcall you'll need to change it to one
>  of the others, I think.

Unfortunately I cannot change calling convention for one of DLLs as
it's closed-source 3rd party file.

>  As far as detecting Wine, again we prefer you don't.  Would it be any
>  great problem to ship a Linux version that called the Linux drivers,
>  and a Windows version that called the Windows drivers?

Having two versions of Win32 executable is IMHO not very practical, as
99% of the code would be same for both applications.

The original question was about loading Linux .so files directly from
.exe. How do we load (dlopen, dlsym) a .so library from .exe running
under Wine ? This would solve our problem.

Martin


From juan.lang at gmail.com  Thu Mar  6 10:03:25 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 6 Mar 2008 08:03:25 -0800
Subject: Getting apps running under Wine
In-Reply-To: <24d1a1690803060756u65cc9de6vb066e242699aa031@mail.gmail.com>
References: <24d1a1690803030416u128ff6a7i59ad69eeeb06f976@mail.gmail.com>
	<3a768c550803030909q29647b57i704040f69b7dac72@mail.gmail.com>
	<24d1a1690803060756u65cc9de6vb066e242699aa031@mail.gmail.com>
Message-ID: <3a768c550803060803k697cc0d7i46c058923f75425a@mail.gmail.com>

>  Having two versions of Win32 executable is IMHO not very practical, as
>  99% of the code would be same for both applications.

That wasn't exactly what I intended.  You said in your original email,

> We use DLL that depends on some Win32 drivers.

My question is, could you ship a Linux version of this DLL (.so) that
calls the Linux drivers instead?

>  The original question was about loading Linux .so files directly from
>  .exe. How do we load (dlopen, dlsym) a .so library from .exe running
>  under Wine ? This would solve our problem.

You can't exactly.  If you make your app a winelib app, then you can,
but you won't be able to link such a beast for Windows, that is, as a
.exe rather than a .exe.so.

Again, my suggestion is to have a Windows version of the DLL that
calls the Windows drivers, and a Linux version of the same .dll that
is a winelib dll (.dll.so) that calls the Linux drivers.  The rest of
the code would remain the same, but you could either install the
appropriate version depending on whether you're running in Linux, or
use some DLL override magic to specify which to use in Wine.

Hope that helps,
--Juan


From dank at kegel.com  Thu Mar  6 10:07:06 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 6 Mar 2008 08:07:06 -0800
Subject: Recent valgrind regressions in msxml3
Message-ID: <a71bd89a0803060807h361fcbe0gfc36c3ef4da326ad@mail.gmail.com>

Hi Alistair,
I'm seeing some regressions in msxml3 in yesterday's git; see
http://kegel.com/wine/valgrind/logs-2008-03-05/vg-msxml3_domdoc-diff.txt
e.g.
+ Invalid read of size 4
+    at  HEAP_ValidateInUseArena (heap.c:925)
+    by  RtlFreeHeap (heap.c:1288)
+    by  SysFreeString (oleaut.c:196)
+    by  test_domdoc (domdoc.c:658)
+    by  func_domdoc (domdoc.c:2875)
+    by  run_test (test.h:406)
+    by  main (test.h:455)
etc.
Could you have a look?  Also, have you tried running
Valgrind yourself?  It's not hard at all these days.
- Dan


From arbuckle911 at gmail.com  Thu Mar  6 10:08:11 2008
From: arbuckle911 at gmail.com (Christopher Harvey)
Date: Thu, 06 Mar 2008 11:08:11 -0500
Subject: slight winsock design change proposal
In-Reply-To: <22821af30803051637s6237aa1el9f153278e8441e53@mail.gmail.com>
References: <47CF3AC7.9010603@gmail.com>
	<22821af30803051637s6237aa1el9f153278e8441e53@mail.gmail.com>
Message-ID: <47D016EB.9030602@gmail.com>

James Hawkins wrote:
> On Wed, Mar 5, 2008 at 6:28 PM, Christopher Harvey
> <arbuckle911 at gmail.com> wrote:
>   
>> I'm giving the mswsock.c file some development time. I need to know if
>>  the winsock API has been inited. This has already been implemented, but
>>  I need to get access to the num_startup variable from the mswsock.c
>>  file. I hacked a bit and got it, but hesitate to continue because I
>>  don't know if I changed it in the proper way to get access. If this
>>  change is fine please accept it. if not please advise on the proper way
>>  to see if winsock has been inited or not, from the  mswsock.c file.
>>
>>  Thanks.
>>
>> diff --git a/dlls/mswsock/mswsock.c b/dlls/mswsock/mswsock.c
>>  index d283405..7f339c0 100644
>>  --- a/dlls/mswsock/mswsock.c
>>  +++ b/dlls/mswsock/mswsock.c
>>  @@ -62,9 +62,10 @@ BOOL WINAPI AcceptEx(
>>                                        operation */
>>   {
>>      FIXME("(listen=%ld, accept=%ld, %p, %d, %d, %d, %p, %p), not implemented\n",
>>  -       sListenSocket,sAcceptSocket,lpOutputBuffer,dwReceiveDataLength,
>>  -       dwLocalAddressLength,dwRemoteAddressLength,lpdwBytesReceived,lpOverlapped
>>  -    );
>>  +         sListenSocket,sAcceptSocket,lpOutputBuffer,dwReceiveDataLength,
>>  +         dwLocalAddressLength,dwRemoteAddressLength,lpdwBytesReceived,lpOverlapped
>>  +         );
>>  +    //get_num_startup();  Use this to see if Winsock has been inited yet or not
>>      return FALSE;
>>   }
>>
>>  diff --git a/dlls/ws2_32/socket.c b/dlls/ws2_32/socket.c
>>  index 502f309..03030a2 100644
>>  --- a/dlls/ws2_32/socket.c
>>  +++ b/dlls/ws2_32/socket.c
>>  @@ -5021,3 +5021,8 @@ INT WINAPI WSCWriteProviderOrder( LPDWORD entry, DWORD number )
>>      FIXME("(%p 0x%08x) Stub!\n", entry, number);
>>      return 0;
>>   }
>>  +
>>  +INT get_num_startup()
>>  +{
>>  +    return num_startup;
>>  +}
>>  diff --git a/include/winsock2.h b/include/winsock2.h
>>  index a302331..dcca0e7 100644
>>  --- a/include/winsock2.h
>>  +++ b/include/winsock2.h
>>  @@ -728,6 +728,7 @@ typedef INT (WINAPI *LPFN_WSASTRINGTOADDRESSW)(LPSTR,INT,LPWSAPROTOCOL_INFOA,LPS
>>   typedef DWORD (WINAPI *LPFN_WSAWAITFORMULTIPLEEVENTS)(DWORD,const WSAEVENT*,BOOL,DWORD,BOOL);
>>   #endif /* WS_API_TYPEDEFS */
>>
>>  +typedef INT get_num_startup();
>>
>>   /* Condition function return values */
>>   #define CF_ACCEPT       0x0000
>>
>>     
>
> Are you seriously asking if adding a hack to a public header in order
> to read a global variable from another dll is acceptable?  That pretty
> much sums up the answer.
>
>   
I can't think of any other way. I'm asking for help.


From juan.lang at gmail.com  Thu Mar  6 10:12:03 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 6 Mar 2008 08:12:03 -0800
Subject: slight winsock design change proposal
In-Reply-To: <47D016EB.9030602@gmail.com>
References: <47CF3AC7.9010603@gmail.com>
	<22821af30803051637s6237aa1el9f153278e8441e53@mail.gmail.com>
	<47D016EB.9030602@gmail.com>
Message-ID: <3a768c550803060812w5a165k2c4a93ede859fe71@mail.gmail.com>

>  I'm giving the mswsock.c file some development time. I need to know if
>  the winsock API has been inited.

The question is, why do you need to know that?  Can't you just
initialize it yourself?  Then you'll know it has been.
--Juan


From winehacker at gmail.com  Thu Mar  6 10:12:22 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 6 Mar 2008 11:12:22 -0500
Subject: winequartz.drv Mac OS X UI discontinued?
In-Reply-To: <EEDB1C7D-011E-431A-97FA-9C0E24015C82@free.fr>
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>
	<200803021850.04583.stefan@codeweavers.com>
	<19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>
	<EEDB1C7D-011E-431A-97FA-9C0E24015C82@free.fr>
Message-ID: <19e31a080803060812w296fef4w7c46660fd1f52f55@mail.gmail.com>

Hi,

On Thu, Mar 6, 2008 at 9:08 AM, Emmanuel Maillard <mahanuu at free.fr> wrote:
>  I post a new quartzdrv patch for wine-0.9.56 on Darwine SF patches
>  page :
>  http://sourceforge.net/tracker/index.php?func=detail&aid=1908759&group_id=69890&atid=526089
>
>  It's not fully update to wine changes (SysCommandSizeMove didn't be
>  reviewed)
>  and don't contain all changes I initially planned but will be next time.

It looks really good. With the most recent changes I can start Office
2003 applications such as Excel and Winword

http://steven-edwards.kicks-ass.org/~sedwards/quartzdrv/excel2.png
http://steven-edwards.kicks-ass.org/~sedwards/quartzdrv/excel3.png
http://steven-edwards.kicks-ass.org/~sedwards/quartzdrv/excel4.png
http://steven-edwards.kicks-ass.org/~sedwards/quartzdrv/excel5.png
http://steven-edwards.kicks-ass.org/~sedwards/quartzdrv/winword.png

The only problem I have is that the windows are not being managed. It
looks like MainMenu.nib is not being created properly by the
patch/script. Is this a known issue or is that SysCommandSizeMove
problem?

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From arbuckle911 at gmail.com  Thu Mar  6 10:18:27 2008
From: arbuckle911 at gmail.com (Christopher Harvey)
Date: Thu, 06 Mar 2008 11:18:27 -0500
Subject: slight winsock design change proposal
In-Reply-To: <3a768c550803060812w5a165k2c4a93ede859fe71@mail.gmail.com>
References: <47CF3AC7.9010603@gmail.com>	
	<22821af30803051637s6237aa1el9f153278e8441e53@mail.gmail.com>	
	<47D016EB.9030602@gmail.com>
	<3a768c550803060812w5a165k2c4a93ede859fe71@mail.gmail.com>
Message-ID: <47D01953.8040501@gmail.com>

Juan Lang wrote:
>>  I'm giving the mswsock.c file some development time. I need to know if
>>  the winsock API has been inited.
>>     
>
> The question is, why do you need to know that?  Can't you just
> initialize it yourself?  Then you'll know it has been.
> --Juan
>
>   
There are some functions that return errors if WSAStartup hasn't been 
called. I think wine should do that too, rather than call it for the 
application.


From juan.lang at gmail.com  Thu Mar  6 10:21:18 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 6 Mar 2008 08:21:18 -0800
Subject: slight winsock design change proposal
In-Reply-To: <47D01953.8040501@gmail.com>
References: <47CF3AC7.9010603@gmail.com>
	<22821af30803051637s6237aa1el9f153278e8441e53@mail.gmail.com>
	<47D016EB.9030602@gmail.com>
	<3a768c550803060812w5a165k2c4a93ede859fe71@mail.gmail.com>
	<47D01953.8040501@gmail.com>
Message-ID: <3a768c550803060821w522496ecwa7768578641bfd6@mail.gmail.com>

>  There are some functions that return errors if WSAStartup hasn't been
>  called. I think wine should do that too, rather than call it for the
>  application.

Perhaps it should, but that should be fixed in ws2_32, not in mswsock.
--Juan


From dmitry at codeweavers.com  Thu Mar  6 10:24:55 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 7 Mar 2008 00:24:55 +0800
Subject: slight winsock design change proposal
References: <47CF3AC7.9010603@gmail.com>	<22821af30803051637s6237aa1el9f153278e8441e53@mail.gmail.com>	<47D016EB.9030602@gmail.com><3a768c550803060812w5a165k2c4a93ede859fe71@mail.gmail.com>
	<47D01953.8040501@gmail.com>
Message-ID: <012001c87fa6$9ed8dbd0$a600fea9@DMITRY>

"Christopher Harvey" <arbuckle911 at gmail.com> wrote:

> Juan Lang wrote:
>>>  I'm giving the mswsock.c file some development time. I need to know if
>>>  the winsock API has been inited.
>>>     
>>
>> The question is, why do you need to know that?  Can't you just
>> initialize it yourself?  Then you'll know it has been.
>> --Juan
>>
>>   
> There are some functions that return errors if WSAStartup hasn't been 
> called. I think wine should do that too, rather than call it for the 
> application.

It would really help to at least name those "some functions", or even
better to provide a test case.

-- 
Dmitry.


From arbuckle911 at gmail.com  Thu Mar  6 10:54:00 2008
From: arbuckle911 at gmail.com (Christopher Harvey)
Date: Thu, 06 Mar 2008 11:54:00 -0500
Subject: slight winsock design change proposal
In-Reply-To: <012001c87fa6$9ed8dbd0$a600fea9@DMITRY>
References: <47CF3AC7.9010603@gmail.com>	<22821af30803051637s6237aa1el9f153278e8441e53@mail.gmail.com>	<47D016EB.9030602@gmail.com><3a768c550803060812w5a165k2c4a93ede859fe71@mail.gmail.com>
	<47D01953.8040501@gmail.com>
	<012001c87fa6$9ed8dbd0$a600fea9@DMITRY>
Message-ID: <47D021A8.8020400@gmail.com>

Dmitry Timoshkov wrote:
> "Christopher Harvey" <arbuckle911 at gmail.com> wrote:
>
>> Juan Lang wrote:
>>>>  I'm giving the mswsock.c file some development time. I need to 
>>>> know if
>>>>  the winsock API has been inited.
>>>>     
>>>
>>> The question is, why do you need to know that?  Can't you just
>>> initialize it yourself?  Then you'll know it has been.
>>> --Juan
>>>
>>>   
>> There are some functions that return errors if WSAStartup hasn't been 
>> called. I think wine should do that too, rather than call it for the 
>> application.
>
> It would really help to at least name those "some functions", or even
> better to provide a test case.
>
Alright, I see where I'm going wrong. I was reading the WSAAccept 
function when I thought I was reading the AcceptEx page in MSDN.

Sorry.


From cesar at ecuarock.net  Thu Mar  6 11:06:12 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Thu, 6 Mar 2008 12:06:12 -0500
Subject: Google Summer of Code - Case Insensitive Filenames
Message-ID: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>

Hello everyone,

I would like to participate in this year's google summer of code doing
some work on case insensitive filenames (
http://wiki.winehq.org/CaseInsensitiveFilenames )

I have some experience working with FUSE ( see
http://code.google.com/p/dejumble/ ).

Is there any formal process I must go through to enter google summer
of code for wine?

Thanks.

Cesar Izurieta


From andrey.turkin at gmail.com  Thu Mar  6 11:06:36 2008
From: andrey.turkin at gmail.com (Andrey Turkin)
Date: Thu, 06 Mar 2008 20:06:36 +0300
Subject: slight winsock design change proposal
In-Reply-To: <47D021A8.8020400@gmail.com>
References: <47CF3AC7.9010603@gmail.com>	<22821af30803051637s6237aa1el9f153278e8441e53@mail.gmail.com>	<47D016EB.9030602@gmail.com><3a768c550803060812w5a165k2c4a93ede859fe71@mail.gmail.com>	<47D01953.8040501@gmail.com>	<012001c87fa6$9ed8dbd0$a600fea9@DMITRY>
	<47D021A8.8020400@gmail.com>
Message-ID: <47D0249C.6080305@gmail.com>

Actually the correct way IMHO is to implement 
AcceptEx/GetAcceptExSockaddrs/TransmitFile in ws2_32.dll, and use 
WSAIoctl(SIO_GET_EXTENSION_FUNCTION_POINTER) to get function addresses 
in mswsock.dll. I believe this is that Windows' mswsock.dll do.

Christopher Harvey wrote:
> Dmitry Timoshkov wrote:
>   
>> "Christopher Harvey" <arbuckle911 at gmail.com> wrote:
>>
>>     
>>> Juan Lang wrote:
>>>       
>>>>>  I'm giving the mswsock.c file some development time. I need to 
>>>>> know if
>>>>>  the winsock API has been inited.
>>>>>     
>>>>>           
>>>> The question is, why do you need to know that?  Can't you just
>>>> initialize it yourself?  Then you'll know it has been.
>>>> --Juan
>>>>
>>>>   
>>>>         
>>> There are some functions that return errors if WSAStartup hasn't been 
>>> called. I think wine should do that too, rather than call it for the 
>>> application.
>>>       
>> It would really help to at least name those "some functions", or even
>> better to provide a test case.
>>
>>     
> Alright, I see where I'm going wrong. I was reading the WSAAccept 
> function when I thought I was reading the AcceptEx page in MSDN.
>
> Sorry.
>
>
>
>   

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080306/377a1017/attachment.htm 

From mpartap at gmx.net  Thu Mar  6 11:27:11 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Thu, 06 Mar 2008 18:27:11 +0100
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
Message-ID: <47D0296F.9020404@gmx.net>

> Is there any formal process I must go through to enter google summer
> of code for wine?
Just filing Google's application will do, although you may want to crash in #winehackers ..
What you should do IN TIME is to get intimate with the toolchain! That was the hardest part for me - 
getting started on WINE - but if you already have programming experience I doubt that is a problem.
However, from personal experience of last years SoC, communicate your implementation ideas as early 
as possible and don't be afraid to ask for help here on the list would probably be the two most 
important things...
And another lesson learned: it takes a lot of polish for your patches to be approved and committed 
by officer Julliard, be prepared to reiterate over your submitted code several times :D
Else - go for it, task sounds reasonable achievable. And the t-shirt is really worth the effort :)
regards

-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>


From jan.wine at zerebecki.de  Thu Mar  6 12:52:24 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Thu, 6 Mar 2008 19:52:24 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <20080304152346.GF353@byleth.sc-networks.de>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>
	<200803041535.18561.kai.blin@gmail.com>
	<20080304152346.GF353@byleth.sc-networks.de>
Message-ID: <20080306185224.GA26705@crissy.swd.zerebecki.de>

On Tue, Mar 04, 2008 at 04:23:46PM +0100, Christoph Frick wrote:
> On Tue, Mar 04, 2008 at 03:35:11PM +0100, Kai Blin wrote:
> 
> > No argument on the US part. I'm still convinced that by EU laws,
> > you're allowed to crack an app you bought in order to make it run on
> > your software.  As this hasn't been tested in court yet, though, I'll
> > concede.
> 
> IANAL, but since 2008 germany adopted a law from a EU proposal (maybe
> other countries added it before), that disallows circumventing copy
> protections at all. so in theory your statement is not true any longer
> for the EU.

Last time I read that part of the german law my understanding was that
the part about copy prevention doesn't apply to software.


Jan



From leslie_alistair at hotmail.com  Thu Mar  6 15:14:56 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Fri, 7 Mar 2008 08:14:56 +1100
Subject: Recent valgrind regressions in msxml3
References: <a71bd89a0803060807h361fcbe0gfc36c3ef4da326ad@mail.gmail.com>
Message-ID: <fqpmls$ndb$1@ger.gmane.org>


"Dan Kegel" <dank at kegel.com> wrote in message 
news:a71bd89a0803060807h361fcbe0gfc36c3ef4da326ad at mail.gmail.com...
> Hi Alistair,
> I'm seeing some regressions in msxml3 in yesterday's git; see
> http://kegel.com/wine/valgrind/logs-2008-03-05/vg-msxml3_domdoc-diff.txt
> e.g.
> + Invalid read of size 4
> +    at  HEAP_ValidateInUseArena (heap.c:925)
> +    by  RtlFreeHeap (heap.c:1288)
> +    by  SysFreeString (oleaut.c:196)
> +    by  test_domdoc (domdoc.c:658)
> +    by  func_domdoc (domdoc.c:2875)
> +    by  run_test (test.h:406)
> +    by  main (test.h:455)
> etc.
> Could you have a look?  Also, have you tried running
> Valgrind yourself?  It's not hard at all these days.
Hi Dan,
  Thanks for the heads up. I'll have a look tonight.

Best Regards
 Alistair Leslie-Hughes 




From m.b.lankhorst at gmail.com  Thu Mar  6 16:48:21 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 6 Mar 2008 14:48:21 -0800
Subject: Forgot a release_obj in my broadcastsystemmessage patch.
Message-ID: <b130c85e0803061448j6375659axd41428ba92cc0e32@mail.gmail.com>

Hi,

Please don't apply the broadcastsystemmessage patch, there is a bug in
enum_top_windows that I accidentally copied from enum_desktop. I'll
send a fix for the enum_desktop call and a fixed version of the patch.

Cheers,
Maarten.


From cesar at ecuarock.net  Thu Mar  6 17:47:35 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Thu, 6 Mar 2008 18:47:35 -0500
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <47D0296F.9020404@gmx.net>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<47D0296F.9020404@gmx.net>
Message-ID: <e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>

Thanks for your help. I'll prepare something and post it here for
suggestions soon.

On Thu, Mar 6, 2008 at 12:27 PM, Marcel Partap <mpartap at gmx.net> wrote:

> > Is there any formal process I must go through to enter google summer
> > of code for wine?
> Just filing Google's application will do, although you may want to crash
> in #winehackers ..
> What you should do IN TIME is to get intimate with the toolchain! That was
> the hardest part for me -
> getting started on WINE - but if you already have programming experience I
> doubt that is a problem.
> However, from personal experience of last years SoC, communicate your
> implementation ideas as early
> as possible and don't be afraid to ask for help here on the list would
> probably be the two most
> important things...
> And another lesson learned: it takes a lot of polish for your patches to
> be approved and committed
> by officer Julliard, be prepared to reiterate over your submitted code
> several times :D
> Else - go for it, task sounds reasonable achievable. And the t-shirt is
> really worth the effort :)
> regards
>
> --
> <div id="signature">
>   "Obstacles are those frightful things you see when you take your eyes
> off your goal."
>                                                               -- Henry
> Ford (1863-1947)
>   Change the world! Vote revolution: http://hfopi.org/vote-future
> </div>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080306/3e0bd27d/attachment.htm 

From chris.kcat at gmail.com  Thu Mar  6 18:15:20 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Thu, 6 Mar 2008 16:15:20 -0800
Subject: WGL/WINED3D: add WGL_WINE_pixel_format_passthrough
In-Reply-To: <20080306223641.309510@gmx.net>
References: <20080306223641.309510@gmx.net>
Message-ID: <200803061615.20481.chris.kcat@gmail.com>

On Thursday 06 March 2008 02:36:41 pm Roderick Colenbrander wrote:
> WGL only allows you to set the pixel format once for a HDC. This requires a
> WINE-specific WGL extension which allows us to set the pixel format again.
> The patch does this and it works correctly in DirectX8/9 SDK samples.

I'm pretty sure this can cause a resource leak if it's done on a D3D child 
window (the existing offscreen surfaces won't be destroyed). Though I can't 
say I like the idea of the patch since it does nothing for non-Wine, or even 
non-winex11.drv Wine, to fix the issue.


From winehacker at gmail.com  Thu Mar  6 19:44:32 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 6 Mar 2008 20:44:32 -0500
Subject: user32: Add a better stub for broadcastsystemmessage, try 2
In-Reply-To: <b130c85e0803061547l3eb9403g246b890fcf7d2d2c@mail.gmail.com>
References: <b130c85e0803061547l3eb9403g246b890fcf7d2d2c@mail.gmail.com>
Message-ID: <19e31a080803061744h3f8d832eh6d0b2f50e27a001c@mail.gmail.com>

On Thu, Mar 6, 2008 at 6:47 PM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Fixes: BroadcastSystemMessage to not hang other processes any more.

+static BOOL CALLBACK broadcastsystemmessagetopwindowcallback(HWND
top_window, LPARAM lp)
+static BOOL CALLBACK broadcastsystemmessagewindowstationcallback(
LPWSTR winsta, LPARAM lp )

Just a matter of style...if ever there was a case for abbrevation this is it.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Thu Mar  6 20:18:17 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 7 Mar 2008 10:18:17 +0800
Subject: user32: Fix enumeration and add tests for EnumWindowStations
	andEnumDesktops, try X
References: <b130c85e0803061116k1699ad8fr1aa47d549852db98@mail.gmail.com>
Message-ID: <00c901c87ff9$83781b50$a600fea9@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

> Fixed, and with tests!

Why not use A versions of APIs to simplify the tests?

Also, though that's a matter of taste, ok(hdesk != 0) is more
readable IMO than ok(!!hdesk).

-- 
Dmitry.


From thunderbird2k at gmx.net  Fri Mar  7 02:55:27 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Fri, 07 Mar 2008 09:55:27 +0100
Subject: WGL/WINED3D: add WGL_WINE_pixel_format_passthrough
In-Reply-To: <200803061615.20481.chris.kcat@gmail.com>
References: <20080306223641.309510@gmx.net>
	<200803061615.20481.chris.kcat@gmail.com>
Message-ID: <20080307085527.190280@gmx.net>

> On Thursday 06 March 2008 02:36:41 pm Roderick Colenbrander wrote:
> > WGL only allows you to set the pixel format once for a HDC. This
> requires a
> > WINE-specific WGL extension which allows us to set the pixel format
> again.
> > The patch does this and it works correctly in DirectX8/9 SDK samples.
> 
> I'm pretty sure this can cause a resource leak if it's done on a D3D child
> window (the existing offscreen surfaces won't be destroyed). Though I
> can't 
> say I like the idea of the patch since it does nothing for non-Wine, or
> even 
> non-winex11.drv Wine, to fix the issue.

In the non-Wine case you would need WineD3D child windows. I don't like that and it would be a performance hit. Right now we don't have a functioning quartz driver. When it comes around the function should be ported over.

Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.web.de/de/entertainment/games/free


From rob at codeweavers.com  Fri Mar  7 02:57:10 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 07 Mar 2008 08:57:10 +0000
Subject: Make winecfg DPI interval to be the same as in Windows
In-Reply-To: <200803062057.44835.research@science.su>
References: <200803062057.44835.research@science.su>
Message-ID: <47D10366.8050907@codeweavers.com>

L. Rahyen wrote:
> @@ -37,7 +37,7 @@ WINE_DEFAULT_DEBUG_CHANNEL(winecfg);
>  
>  #define RES_MAXLEN 5 /* the maximum number of characters in a screen dimension. 5 digits should be plenty, what kind of crazy person runs their screen >10,000 pixels across? */
>  #define MINDPI 96
> -#define MAXDPI 160
> +#define MAXDPI 480
>  #define DEFDPI 96
>  
>  static const char logpixels_reg[] = "System\\CurrentControlSet\\Hardware Profiles\\Current\\Software\\Fonts";
> @@ -243,9 +243,12 @@ static void on_d3d_pshader_mode_clicked(HWND dialog) {
>  }
>  static INT read_logpixels_reg(void)
>  {
> +    static const WCHAR szLogPixels[] = {'L', 'o', 'g', 'P', 'i', 'x', 'e', 'l', 's', 0};
>      DWORD dwLogPixels;
> -    char *buf  = get_reg_key(HKEY_LOCAL_MACHINE, logpixels_reg,
> -                             "LogPixels", NULL);
> +    WCHAR *buf;
> +    WCHAR szLogPixelsReg[MAXBUFLEN];
> +    MultiByteToWideChar(GetACP(), 0, logpixels_reg, -1, szLogPixelsReg, sizeof(szLogPixelsReg)/sizeof(szLogPixelsReg[0]) );
> +    buf = get_reg_keyW(HKEY_LOCAL_MACHINE, szLogPixelsReg, szLogPixels, NULL);
>      dwLogPixels = buf ? *buf : DEFDPI;
>      HeapFree(GetProcessHeap(), 0, buf);
>      return dwLogPixels;
>   

Don't convert a constant string using MultiByteToWideChar.

-- 
Rob Shearman



From rob at codeweavers.com  Fri Mar  7 03:02:19 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 07 Mar 2008 09:02:19 +0000
Subject: [3/6] qmgr: Add a mutex to BackgroundCopyJob.
In-Reply-To: <20080307030552.GL31625@linux.ucla.edu>
References: <20080307030552.GL31625@linux.ucla.edu>
Message-ID: <47D1049B.4020208@codeweavers.com>

Dan Hipschman wrote:
> Pretty much the same as yesterday but I changed to using mutexes instead
> of critical sections since I need to wait on two at once (one for the
> job and the other for the file when updating progress).
>   

I'm not sure this is a correct reason for mutexes instead of critical 
sections. Either way, you need to have a strict ordering so that you 
don't deadlock and critical sections use mutexes underneath. Unless 
you're going to be using a named mutex to synchronise across processes 
or you're going to have threads quit whilst holding the mutex, then the 
only difference will be that the code is slower when using mutexes 
because of the necessary server call, which more often than not can be 
avoided with critical sections.

-- 
Rob Shearman



From jacek at codeweavers.com  Fri Mar  7 05:55:14 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Fri, 07 Mar 2008 12:55:14 +0100
Subject: add realization of HTMLDocument_write,HTMLDocument_open
In-Reply-To: <200803071148.27757.ivan@etersoft.ru>
References: <200803071148.27757.ivan@etersoft.ru>
Message-ID: <47D12D22.9060204@codeweavers.com>

Hi Ivan,

Ivan Sinitsin wrote:
> This patch adds realization of function HTMLDocument_write, and 
> HTMLDocument_open (it needed for method HTMLDocument_write).
>
> Changelog:
> This patch adds realization of function HTMLDocument_write, and 
> HTMLDocument_open.
>   

First of all, these should be two separated patches.

> static HRESULT WINAPI HTMLDocument_write(IHTMLDocument2 *iface, SAFEARRAY *psarray)
>  {
> -    FIXME("(%p)->(%p)\n", iface, psarray);
> -    return E_NOTIMPL;
> +    HRESULT hres;
> +    VARIANT *pvar;
> +    IHTMLElement *pbody;
> +    BSTR vtext;
> +    int i;
> +
> +    vtext = SysAllocString(L"");
> +
> +    HTMLDocument_get_body(iface,&pbody);

You can't assume that write will be called inside body element.

> +
> +    hres = IHTMLElement_get_innerHTML(pbody, &vtext);

You leak vtext memory here. Also you shouldn't use get_innerHTML at all.

> +    if (FAILED(hres)) {
> +        vtext = SysAllocString(L"");
> +    }
> +
> +    hres=SafeArrayAccessData(psarray, (void **)&pvar);
> +    if (FAILED(hres)) return hres;
> +    for (i=0; i < psarray->rgsabound[0].cElements; i++) {
> +        hres = VarBstrCat(vtext, V_BSTR(&(pvar[i])), &vtext);

You should check if pvar[i] is VT_BSTR before using it.

> +        if (FAILED(hres)) {
> +            break;
> +        }
> +    }
> +
> +    IHTMLElement_put_innerHTML(pbody,vtext);

You can't use put_innerHTML here. It will cause recreating of whole body element content. What you probably want is nsIHTMLDocument::Write. I will send the right write implementation.

> +    SysFreeString(vtext);
> +    hres = SafeArrayUnaccessData(psarray);
> +
> +    return S_OK;
>  }
 
>  static HRESULT WINAPI HTMLDocument_writeln(IHTMLDocument2 *iface, SAFEARRAY *psarray)
> @@ -688,8 +715,8 @@ static HRESULT WINAPI HTMLDocument_write
>  static HRESULT WINAPI HTMLDocument_open(IHTMLDocument2 *iface, BSTR url, VARIANT name,
>                          VARIANT features, VARIANT replace, IDispatch **pomWindowResult)
>  {
> -    FIXME("(%p)->(%s %p)\n", iface, debugstr_w(url), pomWindowResult);
> -    return E_NOTIMPL;
> +    TRACE("(%p)->(%s %p)\n", iface, debugstr_w(url), pomWindowResult);
> +    return IHTMLDocument2_QueryInterface(iface, &IID_IDispatch, (void**)pomWindowResult);
>  }


This is obviously not IHTMLDocument2::open implementation.


Jacek


From ono at java.pl  Fri Mar  7 07:10:37 2008
From: ono at java.pl (Adam Strzelecki)
Date: Fri, 7 Mar 2008 14:10:37 +0100
Subject: msi: ACTION_RegisterProduct store all InstallProperties
In-Reply-To: <22821af30803011438v2633aa35s2459553825fb375d@mail.gmail.com>
References: <2D73E93F-4E00-4493-8416-3238546EA3B9@java.pl>
	<22821af30802290939q489b73d9n3c9c106604a49e8c@mail.gmail.com>
	<C467D1FF-9F98-4A2F-869B-E51C31E17A71@java.pl>
	<22821af30803011158g219b93bbq4b660d43d96ffdae@mail.gmail.com>
	<1D8C710E-D65D-4E87-865C-9BA7F8747B1F@java.pl>
	<22821af30803011408pee462d1gcfc98723ca7c68ca@mail.gmail.com>
	<A00C3432-7B22-4B69-81A5-AB643A2396AE@java.pl>
	<22821af30803011438v2633aa35s2459553825fb375d@mail.gmail.com>
Message-ID: <7D3A0B5D-132F-4837-9BDE-53EBD5FD37DE@java.pl>

Thanks for your latest MSI patches fixing the issue.

Please mark my patch obsolete.

Regards,
-- 
Adam Strzelecki |: nanoant.com :|



From wine.dev at web.de  Fri Mar  7 08:25:58 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Fri, 07 Mar 2008 15:25:58 +0100
Subject: [2/2]try3.add new dll. wbemprox.dll
In-Reply-To: <200803071319.35887.ivan@etersoft.ru>
References: <200803071319.35887.ivan@etersoft.ru>
Message-ID: <1204899958.6786.36.camel@p4>

On Fr, 2008-03-07 at 13:19 +0300, Ivan Sinitsin wrote:

> This patch add new library to the project wine. Name of the library 
> is - "wbemprox.dll".

Since you read the Developer-Hints, you are now aware, that
"Makefile.in" is wrong here.

I have no Idea about COM, but you should studdy commits for new dlls,
when COM functionality was added (Patch-Size, Complexity).

Since you used some code from Roy as template, i suggest to study 
the commits for his recent Patches. 
As Examples:
http://source.winehq.org/git/wine.git/?a=history;f=dlls/qmgrprxy or
http://source.winehq.org/git/wine.git/?a=history;f=dlls/qmgr



A "\n" at the start of a TRACE is wrong.
A "\t" in a TRACE is not needed.

A FIXME for an unimplemented function is a good idea, but a simple
FIXME("\n");
is not informative.

Thanks for helping Wine


-- 
 
By by ... Detlef




From dreamulelowid at gmail.com  Fri Mar  7 08:53:36 2008
From: dreamulelowid at gmail.com (Bruno Cabral)
Date: Fri, 7 Mar 2008 11:53:36 -0300
Subject: Problem open files/folders with ShellExecute.
Message-ID: <cf12d1750803070653j616428f2vd7b7404f73ad962@mail.gmail.com>

Hi guys i trying make my windows software "wine compatible" .
It use ShellExecute(..) , how could i use that to open a folder in Kde or
Gnome ? The best that i got is to open the wineefile with this:

ShellExecute(handle, "open", "explorer", "path_to_folder", NULL,
SW_SHOWNORMAL);

And i try to open a file too(for example a mp3), but it do nothing too.

ShellExecute(NULL, NULL, "path_to_mp3", NULL, NULL, SW_SHOW);

Both examples work fine with all version of windows.


So, how can execute a file , and howi could open a folder with kde/gnome ?

Thanks !
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080307/c51c36af/attachment.htm 

From wine.dev at web.de  Fri Mar  7 08:56:56 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Fri, 07 Mar 2008 15:56:56 +0100
Subject: [1/2]try3. Add new dll. Wbemprox.dll
In-Reply-To: <200803071319.29621.ivan@etersoft.ru>
References: <200803071319.29621.ivan@etersoft.ru>
Message-ID: <1204901816.6786.40.camel@p4>

On Fr, 2008-03-07 at 13:19 +0300, Ivan Sinitsin wrote:

> +++ configure.ac        21 Feb 2008 13:19:10 -0000
> +++ Makefile.in 21 Feb 2008 13:21:30 -0000
> +++ dlls/Makefile.in    21 Feb 2008 15:04:36 -0000

This does not work.
Please follow our guidelines about "Implementing a new DLL":
http://wiki.winehq.org/Developers-Hints

You can also learn from the commit-messages,
especially from the commits, when a new dll was added.

> +++ tools/wine.inf      22 Feb 2008 07:10:09 -0000

We create only a fake dll, when and application requires
the dll to be present and fail without the fake dll.

Thanks for helping wine.


-- 
 
By by ... Detlef




From tom at dbservice.com  Fri Mar  7 09:39:55 2008
From: tom at dbservice.com (Tomas Carnecky)
Date: Fri, 07 Mar 2008 16:39:55 +0100
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <ced95fe0803041058q325a7b24u52299f3c652cf445@mail.gmail.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>	<ced95fe0803040731i14c0b137ifb0f2e58f490a866@mail.gmail.com>	<a71bd89a0803040858g7e568f0clb225d72190b99e31@mail.gmail.com>	<200803041853.48238.alex@thehandofagony.com>
	<ced95fe0803041058q325a7b24u52299f3c652cf445@mail.gmail.com>
Message-ID: <47D161CB.2050103@dbservice.com>

Vincent Povirk wrote:
> On Tue, Mar 4, 2008 at 12:53 PM, Alexander Nicolaysen S?rnes
> <alex at thehandofagony.com> wrote:
>>  I'm not sure if we should remove the option for 'fully functional, requires
>>  hacks'.  A lot of people come to the AppDB to find out how they can make
>>  their apps work, and are more interested in the end result as opposed to how
>>  to get there.
> 
> In practice, is there really enough difference between "fully
> functional" and "mostly functional" that we need another rating?
> People who only care about the end result would know that anything
> Silver or above will just about work.
> 
> I've seen Gold applied to software that is really "mostly functional,
> requires hacks", i.e. there are some other minor problems that can't
> be worked around (and Platinum for software with minor problems as
> well).
> 
> 
> Then again, if we add a few more variables, we can express the ratings
> with radar charts. ;)
> 
> http://img231.imageshack.us/img231/9466/screenshot5ec1.png

Yeah, use a multi-dimensional rating system. Have different criteria and 
not just one. Rate each with zero to four stars. The overall rating 
(platinum, gold, garbage) is then a function of all the criteria ratings.

Rating:
  - 0: Does not work
  - 1: Works but ...
  - 2: Works but requires dlls (download from internet)
  - 3: Works but requires local changes in winecfg (sound settings etc)
  - 4: Works with vanilla wine

Criteria:
  - Installation
  - Functionality
  - Usability
  - ???


The radar chart is not a bad idea. smartvote.ch, a site that helps you 
find out who to vote for (in switzerland), creates nice charts:

http://dbservice.com/ftpdir/tom/smartspider.png

tom


From luis.busquets at ilidium.com  Fri Mar  7 11:01:15 2008
From: luis.busquets at ilidium.com (=?ISO-8859-1?Q?=22Luis_C=2E_Busquets_P=E9rez=22?=)
Date: Fri, 07 Mar 2008 18:01:15 +0100
Subject: Google Summer of Code
Message-ID: <47D174DB.7000706@ilidium.com>

Please find attached some projects that could be in this Summer of Code:
1. Finishing the implementation of d3dx9_36. Since we have already the 
forwarding d3dx9_xx there is just need for the this dll to be in our 
system. With this fully dll implemented tehre would be no need.

2. msxml.dll, msxml2.dll, msxml2a.dll, msxml2r.dll, msxml3.dll, 
msxml3r.dll, msxml4.dll, msxml4a.dll, msxml4r.dll, msxml5.dll, 
msxml5r.dll, msxml6.dll msxml6r.dll and WinHTTP5.dll are all versions 
referring to the same API together with resoruces. Since wine is already 
implementing msxml3.dll I see that a good thing would be to link the 
rest of the files and implement them all? together. I assume that the 
biggest part of the work will be repeated.

3. The same that applies to point 2 applise to all files msvcrxx.dll 
(msvcr80.dll, msvcr70.dll,

4, As in point 3, implementing msvcpxx.dll could also be a job


From infyquest at gmail.com  Fri Mar  7 11:06:07 2008
From: infyquest at gmail.com (Vijay Kiran Kamuju)
Date: Fri, 7 Mar 2008 12:06:07 -0500
Subject: [rsaenh] Fix AES Provider Handling for Windows XP (resend)
Message-ID: <36bf289b0803070906u57027eanaa96f520b2a172fd@mail.gmail.com>

Hi,


 Please let me know why this patch has been rejected.
http://www.winehq.org/pipermail/wine-patches/2008-February/049817.html
 It seems this patch has gone completely unnoticed.
 Please Comment.
Somehow, my patches are not getting commited/reviewed.
Did I do anything wrong, please do tell me.

Thanks,
Vijay

>  2008/2/8 Vijay Kiran Kamuju <infyquest at gmail.com>:
>
>
> > ChangeLog
>  >  ----------------
>  >  Fix the AES Provider Handling for Windows XP by adding AES Provider
>  >  string for XP in wine registry
>  >
>  >  Bug#11509
>  >
>


From tehblunderbuss at gmail.com  Fri Mar  7 11:19:06 2008
From: tehblunderbuss at gmail.com (TheBlunderbuss)
Date: Fri, 07 Mar 2008 11:19:06 -0600
Subject: WineHQ should discourage the use of cracks
In-Reply-To: <47D161CB.2050103@dbservice.com>
References: <a71bd89a0803040415w6593b990u961b9c62ac58b23a@mail.gmail.com>	<ced95fe0803040731i14c0b137ifb0f2e58f490a866@mail.gmail.com>	<a71bd89a0803040858g7e568f0clb225d72190b99e31@mail.gmail.com>	<200803041853.48238.alex@thehandofagony.com>	<ced95fe0803041058q325a7b24u52299f3c652cf445@mail.gmail.com>
	<47D161CB.2050103@dbservice.com>
Message-ID: <47D1790A.7010201@gmail.com>

Tomas Carnecky wrote:
> Vincent Povirk wrote:
>   
>> On Tue, Mar 4, 2008 at 12:53 PM, Alexander Nicolaysen S?rnes
>> <alex at thehandofagony.com> wrote:
>>     
>>>  I'm not sure if we should remove the option for 'fully functional, requires
>>>  hacks'.  A lot of people come to the AppDB to find out how they can make
>>>  their apps work, and are more interested in the end result as opposed to how
>>>  to get there.
>>>       
>> In practice, is there really enough difference between "fully
>> functional" and "mostly functional" that we need another rating?
>> People who only care about the end result would know that anything
>> Silver or above will just about work.
>>
>> I've seen Gold applied to software that is really "mostly functional,
>> requires hacks", i.e. there are some other minor problems that can't
>> be worked around (and Platinum for software with minor problems as
>> well).
>>
>>
>> Then again, if we add a few more variables, we can express the ratings
>> with radar charts. ;)
>>
>> http://img231.imageshack.us/img231/9466/screenshot5ec1.png
>>     
>
> Yeah, use a multi-dimensional rating system. Have different criteria and 
> not just one. Rate each with zero to four stars. The overall rating 
> (platinum, gold, garbage) is then a function of all the criteria ratings.
>
> Rating:
>   - 0: Does not work
>   - 1: Works but ...
>   - 2: Works but requires dlls (download from internet)
>   - 3: Works but requires local changes in winecfg (sound settings etc)
>   - 4: Works with vanilla wine
>
> Criteria:
>   - Installation
>   - Functionality
>   - Usability
>   - ???
>
>
> The radar chart is not a bad idea. smartvote.ch, a site that helps you 
> find out who to vote for (in switzerland), creates nice charts:
>
> http://dbservice.com/ftpdir/tom/smartspider.png
>
> tom
Yay nested quotes.

I think adding this kind of rating is exactly what the Appdb needs. It 
has enough flexibility and simplicity to concisely inform what's needed 
to run the program.


From dank at kegel.com  Fri Mar  7 12:20:04 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 7 Mar 2008 10:20:04 -0800
Subject: Problem open files/folders with ShellExecute
Message-ID: <a71bd89a0803071020q362549dg9f774690a729ccd0@mail.gmail.com>

Bruno Cabral wrote:
>how could i use ShellExecute() to open a folder in Kde or
>Gnome ? The best that i got is to open the wineefile with this:
>ShellExecute(handle, "open", "explorer", "path_to_folder", NULL,SW_SHOWNORMAL);
>And i try to open a file too(for example a mp3), but it do nothing too.
>ShellExecute(NULL, NULL, "path_to_mp3", NULL, NULL, SW_SHOW);
>Both examples work fine with all version of windows.

Wine really should make ShellExecute work just as you expect,
but I don't know how long it'll be until we get around to it.

For now, you can detect that you're running on Wine
(e.g. if getenv("LOGNAME") is not NULL),
and then use the command xdg-open to open the directory or .mp3 file.
To prove to yourself this works, try
  wine cmd /c z:\\usr\\bin\\xdg-open foo.mp3
or
  wine cmd /c z:\\usr\\bin\\xdg-open /usr

That will open the file or directory in the appropriate native app.
The only catch is that the path passed to xdg-open has
to be a Unix path.  You can use the executable winepath
to convert Windows paths to Unix paths.  To prove to yourself
this works, try this:

 wine cmd /c winepath c:\
This will output the Unix path,
/home/dkegel/.wine/dosdevices/c:/

And then you have to be careful about paths with spaces in them, etc.
It's a bit of a pain at the moment.

If you go down this route, put it in a helper function so you
can rip it out easily later.  (And so you can share the
helper function with others.)
- Dan

p.s. Related bug:
http://bugs.winehq.org/show_bug.cgi?id=3332


From xerox_xerox2000 at yahoo.co.uk  Fri Mar  7 12:35:19 2008
From: xerox_xerox2000 at yahoo.co.uk (Louis Lenders)
Date: Fri, 7 Mar 2008 18:35:19 +0000 (UTC)
Subject: Google Summer of Code
References: <47D174DB.7000706@ilidium.com>
Message-ID: <loom.20080307T182715-417@post.gmane.org>

Luis C. Busquets P?rez <luis.busquets <at> ilidium.com> writes:

> 
> Please find attached some projects that could be in this Summer of Code:
> 1. Finishing the implementation of d3dx9_36. Since we have already the 
> forwarding d3dx9_xx there is just need for the this dll to be in our 
> system. With this fully dll implemented tehre would be no need.
>

"Finishing the implementation of d3dx9_36" would be a bit too much i guess, 
for doing that in 2/3 months. I like the idea though, better "do some work" on
d3dx9_36

Further i would find it nice if a project proposal would be something like
"write a dxdiag.exe". Something like a fancy spinning cube with wine-logo, and
frame-rate  counter or something the like. This would allow users to quickly
test if they have set up their opengl/directX stuff correctly, and if they 
have hardware acceleration enabled. This would be something that could be 
easily done in 2/3 months






From stefan at codeweavers.com  Fri Mar  7 12:53:20 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Fri, 7 Mar 2008 19:53:20 +0100
Subject: Google Summer of Code
In-Reply-To: <loom.20080307T182715-417@post.gmane.org>
References: <47D174DB.7000706@ilidium.com>
	<loom.20080307T182715-417@post.gmane.org>
Message-ID: <200803071953.23612.stefan@codeweavers.com>

Am Freitag, 7. M?rz 2008 19:35:19 schrieb Louis Lenders:
> Further i would find it nice if a project proposal would be something like
> "write a dxdiag.exe". Something like a fancy spinning cube with wine-logo,
> and frame-rate  counter or something the like. This would allow users to
> quickly test if they have set up their opengl/directX stuff correctly, and
> if they have hardware acceleration enabled. This would be something that
> could be easily done in 2/3 months
I have a bunch of driver bug tests, I could share them to anyone who is 
interested in putting them into a test application like this.

I have a few more directx-related project suggestions:

*) Write a fixed function pipelien replacement shaders in ARB_*_program 
assembly or GLSL. That could be made two projects maybe. I am currently doing 
some infrastructure work for this, if such a project is viable depends on 
where this infrastructure gets.

*) Implement pixel shaders using GL_ATI_fragment_shaders and/or 
GL_NV_register_combiners+GL_NV_texture_shader. This would bring Radeon 
8500-9200 and Geforce 4 cards up to the feature level they have in Windows. 
This also depends on the infrastructure work mentioned above.

*) Of course if anyone has own suggestions we're open to them as well. Please 
discuss them on wine-devel before applying to soc though.

My experience from last year is that GSOC projects focused on preparing 
infrastructure do not get too far, since they're boring and more work than 
estimated. Thus I've done the infrastructure work on the current proposals 
myself this time. This has the advantage that the student can focus on 
implementing code for the problem, but has the disadvantage that he has to 
get used to existing code.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080307/69d9108c/attachment.pgp 

From artur.szymiec at gmail.com  Fri Mar  7 14:06:01 2008
From: artur.szymiec at gmail.com (Artur Szymiec)
Date: Fri, 07 Mar 2008 21:06:01 +0100
Subject: Tons of shader recompilation in TRLegend and screen set issues
Message-ID: <47D1A029.1010601@gmail.com>

Greetings,

I would like to point out 3 issues with TR Legend game:
1) wine is outputing a ton of messages like:
    fixme:d3d_shader:IWineD3DVertexShaderImpl_CompileShader Vertexshader
0x13fb3028 recompiled more than 50 times
fixme:d3d_shader:IWineD3DVertexShaderImpl_CompileShader Vertexshader
0x13fb3028 recompiled more than 50 times
fixme:d3d_shader:IWineD3DVertexShaderImpl_CompileShader Vertexshader
0x13fb3028 recompiled more than 50 times
fixme:d3d_shader:IWineD3DVertexShaderImpl_CompileShader Vertexshader
0x13fb3028 recompiled more than 50 times
fixme:d3d_shader:IWineD3DVertexShaderImpl_CompileShader Vertexshader
0x13fb3028 recompiled more than 50 times
fixme:d3d_shader:IWineD3DVertexShaderImpl_CompileShader Vertexshader
0x13fb3028 recompiled more than 50 times

2) the game itself contain a gfx config dialog. Then at next startup it
should use this settings
    saved somewhere (I guess registry) but instead it dosen't - always
running the game will bring
    the config in the first place. Why is that ?

3) Still something is wrong with the  vertex shaders  and buffers - see
this screenshoot:
    http://img171.imageshack.us/my.php?image=screen3ub0.jpg

And the tons of shader compilation warnings happens in every water scene
like in the screenshoot.

Best regards
Artur

-- 
--------------------------------------------------------------------------
Registered User No 397465
Linux Debian 2.6.24.2 AMD Athlon(tm) 64 X2 Dual Core 5000+
Conquer your Desktop! http://www.kde.org/trykde/
Reclaim Your Inbox!   http://www.mozilla.org/products/thunderbird/
--------------------------------------------------------------------------



From stefan at codeweavers.com  Fri Mar  7 15:55:01 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 7 Mar 2008 22:55:01 +0100
Subject: Tons of shader recompilation in TRLegend and screen set issues
In-Reply-To: <47D1A029.1010601@gmail.com>
References: <47D1A029.1010601@gmail.com>
Message-ID: <200803072255.03332.stefan@codeweavers.com>

Am Freitag, 7. M?rz 2008 21:06:01 schrieb Artur Szymiec:
> Greetings,
>
> I would like to point out 3 issues with TR Legend game:
Please file bugs at bugs.winehq.org instead of posting it to the mailing list
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080307/877aa6f1/attachment.pgp 

From pawel.rozanski at gmail.com  Fri Mar  7 16:34:43 2008
From: pawel.rozanski at gmail.com (=?ISO-8859-2?Q?Pawe=B3_R=F3=BFa=F1ski?=)
Date: Fri, 7 Mar 2008 23:34:43 +0100
Subject: Tons of shader recompilation in TRLegend and screen set issues
In-Reply-To: <200803072255.03332.stefan@codeweavers.com>
References: <47D1A029.1010601@gmail.com>
	<200803072255.03332.stefan@codeweavers.com>
Message-ID: <cd91cef90803071434s2a5610f3n8668e6bab30ca8ef@mail.gmail.com>

Hi

Artur: or you could find that at least one of these bugs is already filled
 http://bugs.winehq.org/show_bug.cgi?id=11357

But I have question which is more general (not only for Stefan D?singer):

I tend to check if something changed in game/program that I'm
currently monitoring. Are new comments for bug like "it still not
woking at wine-....." need ?

Because i can add them :) every weekend or so. I really appreciate
developers time which was invested in wine. I just want to ask what is
more desired:

- report often that something doesn't work (to keep information current)
- leave it until dev response that this particular problem is solved
(but something can slip out)

Again - I don't want to look like impatient one (like i said - I
really appreciate what I have) I just want to know what will do better
job.


Keep care, your project keeps me thinking that everything is possible :)
-- 
Pawe? R??a?ski

From stefan at codeweavers.com  Fri Mar  7 17:14:28 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 8 Mar 2008 00:14:28 +0100
Subject: ddraw: Implement ForceRefreshRate registry entry for overriding
	DirectX refresh rate
In-Reply-To: <47D1B39D.2000708@ossguy.com>
References: <47D1B39D.2000708@ossguy.com>
Message-ID: <200803080014.33567.stefan@codeweavers.com>

Am Freitag, 7. M?rz 2008 22:29:01 schrieb Denver Gingerich:
> The DirectX refresh rate override feature that this patch implements is
> described in main.c below.
>
> In order for the override to take effect only on SetDisplayMode and not on
> RestoreDisplayMode it was necessary to move the functionality of
> SetDisplayMode into a helper function (DDRAW_SetDisplayMode) and let
> IDirectDrawImpl_SetDisplayMode and IDirectDrawImpl_RestoreDisplayMode call
> the helper function.
I have two concerns:

First, do you have an application that needs this, or is this just for making 
this aspect of ddraw compatible with Windows? There's nothing wrong with that 
in principle, but I am curious

I do not really like the name DDRAW_SetDisplayMode. It somewhat goes away from 
the convention by starting with DDRAW, but yet it does not tell more about 
what the function does.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080308/e9a73eb1/attachment.pgp 

From denver at ossguy.com  Fri Mar  7 17:52:23 2008
From: denver at ossguy.com (Denver Gingerich)
Date: Fri, 7 Mar 2008 18:52:23 -0500
Subject: ddraw: Implement ForceRefreshRate registry entry for overriding
	DirectX refresh rate
In-Reply-To: <200803080014.33567.stefan@codeweavers.com>
References: <47D1B39D.2000708@ossguy.com>
	<200803080014.33567.stefan@codeweavers.com>
Message-ID: <6defe8840803071552s2448398fh1d18843b72495fca@mail.gmail.com>

On Fri, Mar 7, 2008 at 6:14 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Freitag, 7. M?rz 2008 22:29:01 schrieb Denver Gingerich:
>
> > The DirectX refresh rate override feature that this patch implements is
>  > described in main.c below.
>  >
>  > In order for the override to take effect only on SetDisplayMode and not on
>  > RestoreDisplayMode it was necessary to move the functionality of
>  > SetDisplayMode into a helper function (DDRAW_SetDisplayMode) and let
>  > IDirectDrawImpl_SetDisplayMode and IDirectDrawImpl_RestoreDisplayMode call
>  > the helper function.
>  I have two concerns:
>
>  First, do you have an application that needs this, or is this just for making
>  this aspect of ddraw compatible with Windows? There's nothing wrong with that
>  in principle, but I am curious

I described my reasoning to some extent in the following message/threads:
http://www.winehq.org/pipermail/wine-patches/2008-March/050965.html
http://www.winehq.org/pipermail/wine-devel/2008-March/063147.html

Basically, I am running an application that calls SetDisplayMode and
doesn't specify a refresh rate.  ChangeDisplaySettingsEx picks the
first mode that matches the bpp, and resolution, and that mode just so
happens to have a bad refresh rate for me.  So I want a way to
override it.

>  I do not really like the name DDRAW_SetDisplayMode. It somewhat goes away from
>  the convention by starting with DDRAW, but yet it does not tell more about
>  what the function does.

I modeled this after DDRAW_Create in dlls/ddraw/main.c.  It seemed
like using a DDRAW_ prefix might specify a helper function so I went
with it.  But I will admit it didn't seem that standard.

I couldn't really think of anything better than SetDisplayMode for a
suffix.  Setting the display mode is what it does, after all.  I could
rename it to something like SetDisplayModeHelper.  Does that seem
reasonable?  Are there other suggestions?

Denver


From nathan.beckmann at gmail.com  Fri Mar  7 23:26:58 2008
From: nathan.beckmann at gmail.com (Nathan Beckmann)
Date: Fri, 7 Mar 2008 21:26:58 -0800
Subject: [PATCH] gdiplus: Fix memory leak in GdipLockBitmapBits.
In-Reply-To: <1204873684-30630-1-git-send-email-nathan.beckmann@gmail.com>
References: <1204873684-30630-1-git-send-email-nathan.beckmann@gmail.com>
Message-ID: <3a22664a0803072126g277290adk31a079e54f2e2bc6@mail.gmail.com>

Further testing indicates that a lot more needs to change than what's
in this patch.

It might be best to hold off on it until I know everything that needs
to be done.

- Nathan


From epssyis at gmail.com  Fri Mar  7 23:53:53 2008
From: epssyis at gmail.com (Edward Savage)
Date: Sat, 8 Mar 2008 15:53:53 +1000
Subject: Tons of shader recompilation in TRLegend and screen set issues
In-Reply-To: <cd91cef90803071434s2a5610f3n8668e6bab30ca8ef@mail.gmail.com>
References: <47D1A029.1010601@gmail.com>
	<200803072255.03332.stefan@codeweavers.com>
	<cd91cef90803071434s2a5610f3n8668e6bab30ca8ef@mail.gmail.com>
Message-ID: <d6c5d7290803072153g10c3771cw34bde9029ff251a2@mail.gmail.com>

I wouldn't mind knowing this as well.  For example there is a bug in
the rendering of the planet in the eve loading screen (this affects
all in game planets too) and has been a bug for a year or more now.
I've been trying to work out if it is worth poking the bug report on
it or just leaving it till some one has time to go back over older
bugs.

2008/3/8 Pawe? R??a?ski <pawel.rozanski at gmail.com>:
> Hi
>
>  Artur: or you could find that at least one of these bugs is already filled
>   http://bugs.winehq.org/show_bug.cgi?id=11357
>
>  But I have question which is more general (not only for Stefan D?singer):
>
>  I tend to check if something changed in game/program that I'm
>  currently monitoring. Are new comments for bug like "it still not
>  woking at wine-....." need ?
>
>  Because i can add them :) every weekend or so. I really appreciate
>  developers time which was invested in wine. I just want to ask what is
>  more desired:
>
>  - report often that something doesn't work (to keep information current)
>  - leave it until dev response that this particular problem is solved
>  (but something can slip out)
>
>  Again - I don't want to look like impatient one (like i said - I
>  really appreciate what I have) I just want to know what will do better
>  job.
>
>
>  Keep care, your project keeps me thinking that everything is possible :)
>  --
>  Pawe? R??a?ski
>
>

From arbuckle911 at gmail.com  Sat Mar  8 00:03:48 2008
From: arbuckle911 at gmail.com (Christopher Harvey)
Date: Sat, 08 Mar 2008 01:03:48 -0500
Subject: AcceptEx implemetation
Message-ID: <47D22C44.6080600@gmail.com>

Hi,
I'm going to try to implement AcceptEx this weekend. Just wanted to ask 
if I should write it using unix sockets, or using the existing ws2_32 
implementation.

Thanks.


From eric.pouech at orange.fr  Sat Mar  8 03:08:44 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Sat, 08 Mar 2008 10:08:44 +0100
Subject: AcceptEx implemetation
In-Reply-To: <47D22C44.6080600@gmail.com>
References: <47D22C44.6080600@gmail.com>
Message-ID: <47D2579C.6070709@orange.fr>

Christopher Harvey a ?crit :
> Hi,
> I'm going to try to implement AcceptEx this weekend. Just wanted to ask 
> if I should write it using unix sockets, or using the existing ws2_32 
> implementation.
>
> Thanks.
>
>
>
>
>   
ws2_32 when possible
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From stefan at codeweavers.com  Sat Mar  8 04:30:15 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 8 Mar 2008 11:30:15 +0100
Subject: AcceptEx implemetation
In-Reply-To: <47D2579C.6070709@orange.fr>
References: <47D22C44.6080600@gmail.com> <47D2579C.6070709@orange.fr>
Message-ID: <200803081130.18639.stefan@codeweavers.com>

Am Samstag, 8. M?rz 2008 10:08:44 schrieb Eric Pouech:
> Christopher Harvey a ?crit :
> > Hi,
> > I'm going to try to implement AcceptEx this weekend. Just wanted to ask
> > if I should write it using unix sockets, or using the existing ws2_32
> > implementation.
> >
> > Thanks.
>
> ws2_32 when possible
> A+
There's a beginning of such an implementation by Andrey Turkin attached to a 
bug in bugzilla: http://bugs.winehq.org/show_bug.cgi?id=9787
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080308/d58326f6/attachment.pgp 

From stefan at codeweavers.com  Sat Mar  8 04:33:38 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 8 Mar 2008 11:33:38 +0100
Subject: ddraw: Implement ForceRefreshRate registry entry for overriding
	DirectX refresh rate
In-Reply-To: <6defe8840803071552s2448398fh1d18843b72495fca@mail.gmail.com>
References: <47D1B39D.2000708@ossguy.com>
	<200803080014.33567.stefan@codeweavers.com>
	<6defe8840803071552s2448398fh1d18843b72495fca@mail.gmail.com>
Message-ID: <200803081133.42654.stefan@codeweavers.com>

Am Samstag, 8. M?rz 2008 00:52:23 schrieb Denver Gingerich:
> Basically, I am running an application that calls SetDisplayMode and
> doesn't specify a refresh rate.  ChangeDisplaySettingsEx picks the
> first mode that matches the bpp, and resolution, and that mode just so
> happens to have a bad refresh rate for me.  So I want a way to
> override it.
Fair enough. I can't argue that using this key for that is wrong, since it 
exists as-is on Windows, but it doesn't really attack the root of the 
problem. You'll run into the same issue again with d3d8/9 apps or apps that 
use ChangeDisplaySettingsEx directly with a refresh rate of 0
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080308/a05e40a2/attachment.pgp 

From stefan at codeweavers.com  Sat Mar  8 06:34:18 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-2?q?D=F6singer?=)
Date: Sat, 8 Mar 2008 13:34:18 +0100
Subject: Tons of shader recompilation in TRLegend and screen set issues
In-Reply-To: <d6c5d7290803072153g10c3771cw34bde9029ff251a2@mail.gmail.com>
References: <47D1A029.1010601@gmail.com>
	<cd91cef90803071434s2a5610f3n8668e6bab30ca8ef@mail.gmail.com>
	<d6c5d7290803072153g10c3771cw34bde9029ff251a2@mail.gmail.com>
Message-ID: <200803081334.24760.stefan@codeweavers.com>


Am Samstag, 8. M?rz 2008 06:53:53 schrieb Edward Savage:
> I wouldn't mind knowing this as well.  For example there is a bug in
> the rendering of the planet in the eve loading screen (this affects
> all in game planets too) and has been a bug for a year or more now.
> I've been trying to work out if it is worth poking the bug report on
> it or just leaving it till some one has time to go back over older
> bugs.
Retesting with every wine release is welcome, with some message 
like "Confirming bug in wine x.y.z" or similar. That way anyone who is 
interested in fixing the bug doesn't have to ask for a retest and wait for a 
reply when he wants to attack the bug.

@ The eve online problem: I've had a look at that, and Eve uses fixed function 
processing with somewhat insane transformation matrices, some fields are 10^6 
or even bigger.  Doing something like that is asking for precision problems, 
I am not sure if we can fix that

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080308/df9982b0/attachment.pgp 

From denver at ossguy.com  Sat Mar  8 08:32:40 2008
From: denver at ossguy.com (Denver Gingerich)
Date: Sat, 8 Mar 2008 09:32:40 -0500
Subject: ddraw: Implement ForceRefreshRate registry entry for overriding
	DirectX refresh rate
In-Reply-To: <200803081133.42654.stefan@codeweavers.com>
References: <47D1B39D.2000708@ossguy.com>
	<200803080014.33567.stefan@codeweavers.com>
	<6defe8840803071552s2448398fh1d18843b72495fca@mail.gmail.com>
	<200803081133.42654.stefan@codeweavers.com>
Message-ID: <6defe8840803080632i384ed938t2b466ed905d58084@mail.gmail.com>

On Sat, Mar 8, 2008 at 5:33 AM, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Samstag, 8. M?rz 2008 00:52:23 schrieb Denver Gingerich:
>
> > Basically, I am running an application that calls SetDisplayMode and
>  > doesn't specify a refresh rate.  ChangeDisplaySettingsEx picks the
>  > first mode that matches the bpp, and resolution, and that mode just so
>  > happens to have a bad refresh rate for me.  So I want a way to
>  > override it.
>  Fair enough. I can't argue that using this key for that is wrong, since it
>  exists as-is on Windows, but it doesn't really attack the root of the
>  problem. You'll run into the same issue again with d3d8/9 apps or apps that
>  use ChangeDisplaySettingsEx directly with a refresh rate of 0

The problem is that Windows doesn't attack the root of the problem so
Wine can't either.  The previous patch I sent [1] changed the behavior
of ChangeDisplaySettingsEx and even allowed you to customize the
refresh rate at different resolutions, which I felt was attacking the
root of the problem.  But since Windows doesn't do it that way, the
patch was rejected.

Some limited testing has revealed that Windows usually picks the first
mode that matches the bpp and resolution when no refresh rate is given
to ChangeDisplaySettingsEx.  I will post the complete results of my
tests when I get around to it.

The only way I've found to force a refresh rate for a program that
uses ChangeDisplaySettingsEx is to change the available refresh rates
of the monitor, which is essentially changing the list of modes
available.  Changing the list of modes is not something Wine handles.
Rather, it's up to the libraries it uses (like Xrandr) to modify the
mode list.

So I think we're stuck with leaving ChangeDisplaySettingsEx as it is
and implementing what hacks Windows has for DirectX applications so
that we can at least get a partial fix.

Denver


1. http://www.winehq.org/pipermail/wine-patches/2008-March/050965.html


From dank at kegel.com  Sat Mar  8 09:22:09 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 8 Mar 2008 07:22:09 -0800
Subject: Article about running Adobe AIR 1.0 on wine
Message-ID: <a71bd89a0803080722s68c783d3h1777cef966a4ae0e@mail.gmail.com>

http://www.downloadsquad.com/2008/03/08/using-wine-to-install-adobe-air-on-linux/

Has a list of apps known not to work.  Might be worth following up.


From bernhard.posselt at gmx.at  Sat Mar  8 14:59:46 2008
From: bernhard.posselt at gmx.at (Bernhard Posselt)
Date: Sat, 08 Mar 2008 21:59:46 +0100
Subject: Baldurs Gate 2 script
Message-ID: <1205009986.19646.2.camel@localhost>

My username: idefy at web.de
Including the skript itself
-------------- next part --------------
A non-text attachment was scrubbed...
Name: bg
Type: application/x-shellscript
Size: 2007 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080308/1aafd034/attachment.bin 

From jgardou at yahoo.fr  Sun Mar  9 05:48:08 2008
From: jgardou at yahoo.fr (=?iso-8859-1?q?J=E9r=F4me_Gardou?=)
Date: Sun, 9 Mar 2008 11:48:08 +0100
Subject: Implementing a new Direct3D function
Message-ID: <200803091148.08522.jgardou@yahoo.fr>

I'm trying to implement some direct3d functions, more precisely the 
GetImageInfoFromFile* ones.

These are present in directX 8 and in d3dx9_xx.dll

I wondered what is the best way to do this :
1)Implementing it in d3dx8.dll and forward everything to this one.
2) Make some useful functions in wined3d and then use them from d3dx8.
3) Implement them directly in wined3d, forwarding everything to it.
4) An other way ?

Cheers.
J?r?me

	

	
		
___________________________________________________________________________ 
Yahoo! Mail r?invente le mail ! D?couvrez le nouveau Yahoo! Mail et son interface r?volutionnaire.
http://fr.mail.yahoo.com



From thunderbird2k at gmx.net  Sun Mar  9 11:09:35 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 09 Mar 2008 17:09:35 +0100
Subject: [PATCH 4/6] wined3d: Make code safe if there are no device
	palettes.
In-Reply-To: <47D3EFD1.9020502@inbox.lv>
References: <47D3EFD1.9020502@inbox.lv>
Message-ID: <20080309160935.288340@gmx.net>

> There are two types of palettes in wined3d: directx <= 7 style palettes as
> separate interface and d3d >= 8 style device palettes. Some code was
> defaulting 
> to device palettes in several places if there's no "old" style palette and
> using 
> device palettes to store ddraw primary surface's palette. This patch
> avoids use 
> of device palettes for anything else than their direct purpose. It is a 
> necessary preparation for making device palettes dynamically allocated as
> needed 
> (next patch), that prevents ddraw apps from crashing with the latter.
> ---
>   dlls/wined3d/palette.c      |   11 ----
>   dlls/wined3d/surface.c      |  109
> ++++++++++++++++++++++--------------------
>   dlls/wined3d/surface_base.c |   20 ++------
>   dlls/wined3d/surface_gdi.c  |   51 ++++++++------------
>   4 files changed, 82 insertions(+), 109 deletions(-)

First of all it appears that this patch contains multiple patches (e.g. the direct3d9 getdc p8 check is one). I'll mention some others below. The p8 code is very sensitive to bugs and those are most of the time very hard to fix, so I'm quite strict. Various things need to be tested using testcases before this patch (cut in pieces) can make it in.

In case of read_from_framebuffer when there is no palette set, just return directly instead of adding an if(pal) check. The function won't do anything useful without a palette. Further read_from_framebuffer shouldn't get called from d3d8/9 games anyway as there aren't p8 render targets.

I wonder if we need SetDibColorTable at all in case of GetDC as the data the app will receive in the hdc is 8bit. It wants to draw in it by hand, so I would say that the palette won't matter. It might require a testcase.

The removal of the device palette code from RealizePalette can be done in a separate patch.

I'm not sure if change in SetColorKey is correct in the case a surface doesn't have a palette and uses the primary surface its palette. It doesn't feel right. I think it should fail but this requires a testcase.

Second even if the call to SetDibColorTable is needed I wonder what should happen on surfaces which don't have a palette set. It might be correct to use the palette of the primary surface but it might also just be an illegal situation.

Roderick
-- 
Ist Ihr Browser Vista-kompatibel? Jetzt die neuesten 
Browser-Versionen downloaden: http://www.gmx.net/de/go/browser


From mikolaj at zalewski.pl  Sun Mar  9 11:45:34 2008
From: mikolaj at zalewski.pl (=?ISO-8859-2?Q?Miko=B3aj_Zalewski?=)
Date: Sun, 09 Mar 2008 17:45:34 +0100
Subject: [comctl32/tests #3] Use GetModuleHandleA instead of LoadLibraryA
Message-ID: <47D4142E.4050206@zalewski.pl>

  I've changed GetModuleHandle to LoadLibrary because when I compiled 
only tests/rebar.c as standalone, the comctl32 wasn't loaded and 
GetModuleHandle returned NULL. Are there advantages from using 
GetModuleHandle?

Miko?aj Zalewski


From paul.vriens.wine at gmail.com  Sun Mar  9 12:12:46 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Sun, 09 Mar 2008 18:12:46 +0100
Subject: [comctl32/tests #3] Use GetModuleHandleA instead of LoadLibraryA
In-Reply-To: <47D4142E.4050206@zalewski.pl>
References: <47D4142E.4050206@zalewski.pl>
Message-ID: <47D41A8E.4070600@gmail.com>

Miko?aj Zalewski wrote:
>  I've changed GetModuleHandle to LoadLibrary because when I compiled 
> only tests/rebar.c as standalone, the comctl32 wasn't loaded and 
> GetModuleHandle returned NULL. Are there advantages from using 
> GetModuleHandle?
> 
> Miko?aj Zalewski
> 
Well, I was checking whether LoadLibrary was accompanied by a FreeLibrary. In 
this case it wasn't and I thought GetModuleHandle does the trick as well. It did 
for the other stuff in the comctl32 tests.

I'm not in favor of LoadLibrary or GetModuleHandle. I think the general rule 
could be:

If dll is already imported use GetModuleHandle unless compilation excludes the 
dll because there are no reference to the dll.

Does that look a bit sane?

The question that remains is should the full <dll>-tests be able to be compiled 
and run or should we have this to be correct for every single test? I mean that 
are no issues if you compile the whole comctl32 "testsuite".

If LoadLibrary is indeed needed it should be accompanied with a FreeLibrary and 
we probably need a comment for the why as well.

-- 
Cheers,

Paul.


From alexd4 at inbox.lv  Sun Mar  9 12:18:29 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Sun, 09 Mar 2008 19:18:29 +0200
Subject: [PATCH 4/6] wined3d: Make code safe if there are no device
	palettes.
In-Reply-To: <20080309160935.288340@gmx.net>
References: <47D3EFD1.9020502@inbox.lv> <20080309160935.288340@gmx.net>
Message-ID: <47D41BE5.3020008@inbox.lv>

Roderick Colenbrander wrote:
> First of all it appears that this patch contains multiple patches (e.g. the direct3d9 getdc p8 check is one). I'll mention some others below. The p8 code is very sensitive to bugs and those are most of the time very hard to fix, so I'm quite strict. Various things need to be tested using testcases before this patch (cut in pieces) can make it in.

All changes are functionally related (direct3d9 format check ensures any 
palette-related code below it will be ddraw/d3d <= 7 only), but ok, I guess it's 
possible to cut it into several pieces.

> In case of read_from_framebuffer when there is no palette set, just return directly instead of adding an if(pal) check. The function won't do anything useful without a palette. Further read_from_framebuffer shouldn't get called from d3d8/9 games anyway as there aren't p8 render targets.

Agree about this.

> I wonder if we need SetDibColorTable at all in case of GetDC as the data the app will receive in the hdc is 8bit. It wants to draw in it by hand, so I would say that the palette won't matter. It might require a testcase.

I have no idea if any app actually uses it, but, hypothetically, it can call 
GetDIBColorTable, which seems to return meaningful results on native.

> The removal of the device palette code from RealizePalette can be done in a separate patch.
> 
> I'm not sure if change in SetColorKey is correct in the case a surface doesn't have a palette and uses the primary surface its palette. It doesn't feel right. I think it should fail but this requires a testcase.
> 
> Second even if the call to SetDibColorTable is needed I wonder what should happen on surfaces which don't have a palette set. It might be correct to use the palette of the primary surface but it might also just be an illegal situation.
I assume you mean GetDC because I didn't change SetColorKey. I did some tests in 
windows XP, if you obtain a dc from offscreen surface without a palette, then 
call GetDIBColorTable on this dc, you get a color table that matches palette of 
primary surface. I just replicated the existing functionality in Wine which was 
doing the same only using device palette as intermediary storage of primary 
palette: when setting palette to primary surface, entries were copied to current 
device palette, but when palette is missing in GetDC it was using current device 
palette that's the same as primary surface palette. I guess it's most likely 
obscure and unused functionality, but who knows if there's something that may 
rely on it.

I can integrate a test for this scenario (GetDC/GetDIBColorTable with offscreen 
surface that has not palette and compare it to primary surface palette) into 
ddraw testcases, if needed. Do you have ideas what else can be tested?


From stefan at codeweavers.com  Sun Mar  9 12:42:55 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 9 Mar 2008 18:42:55 +0100
Subject: [PATCH 6/6] wined3d: Dirtify p8 textures when device palettes
	change.
In-Reply-To: <47D3EFEE.7030606@inbox.lv>
References: <47D3EFEE.7030606@inbox.lv>
Message-ID: <200803091842.58861.stefan@codeweavers.com>

Am Sonntag, 9. M?rz 2008 15:10:54 schrieb Alexander Dorofeyev:
> Fixes problems with properly updating wine's P8 textures, when it is
> required because of device palette change.
Instead of iterating over all resources and finding P8 textures I think it 
would be nicer to store the palette the texture/surface was loaded with in 
each P8 / A8P8 surface and compare this stored palette to the current device 
palette in IWineD3DSurface::PreLoad(non-texture path) and 
IWineD3D*Texture::PreLoad.

With this, patch 4 could maybe be made nicer as well. If we have to verify the 
palettes anyway, we can remove the DDraw-Style IWineD3DPalette interface from 
WineD3D altogether, and just give each ddraw palette in ddraw.dll a WineD3D 
palette number and use the d3d8/9 palette management exclusively in WineD3D 
and avoid the confusion of having two palette interfaces.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080309/1f2bee4c/attachment.pgp 

From stefan at codeweavers.com  Sun Mar  9 12:44:18 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 9 Mar 2008 18:44:18 +0100
Subject: Implementing a new Direct3D function
In-Reply-To: <200803091148.08522.jgardou@yahoo.fr>
References: <200803091148.08522.jgardou@yahoo.fr>
Message-ID: <200803091844.24578.stefan@codeweavers.com>

Am Sonntag, 9. M?rz 2008 11:48:08 schrieb J?r?me Gardou:
> I'm trying to implement some direct3d functions, more precisely the
> GetImageInfoFromFile* ones.
>
> These are present in directX 8 and in d3dx9_xx.dll
>
> I wondered what is the best way to do this :
> 1)Implementing it in d3dx8.dll and forward everything to this one.
This is the way that was chosen for the other functions, so I think it is the 
way to go in this case as well
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080309/83e6af8d/attachment.pgp 

From jgardou at yahoo.fr  Sun Mar  9 13:52:12 2008
From: jgardou at yahoo.fr (=?iso-8859-1?q?J=E9r=F4me_Gardou?=)
Date: Sun, 9 Mar 2008 19:52:12 +0100
Subject: Implementing a new Direct3D function
In-Reply-To: <E1JYPQa-0000lW-41@www10.emo.freenet-rz.de>
References: <E1JYPQa-0000lW-41@www10.emo.freenet-rz.de>
Message-ID: <200803091952.12638.jgardou@yahoo.fr>

Le Sunday 09 March 2008 18:35:16 tony.wasserka at freenet.de, vous avez ?crit?:
> D3DXGetImageInfoFromFile takes the D3DXIMAGE_INFO structure as parameter,
> which has changed between d3dx8 an dd3dx9_36 though.
> This means you can't forward the D3DXGetImageInfoFromFile calls from d3dx9
> to d3dx8, (even if it is done like that atm, you should fix that an you
> patch) so you'll have to write two versions of each.
> Our plan for implementing d3dx was to keep any d3dx code away from wined3d,
> so you don't have to change anything about that.
> So basically all you have to do is
> (1) implement the d3dx8 version of each function
> (2) add them to the d3dx8 specfile
> (3) implement the d3dx9_36 version of each function
> (3) correct the d3dx9_36 specfile (i.e. remove the forwarding to d3dx8)
>
> The d3dx9_24 to 35 dlls forward their calls to d3dx9_36, so they are okay,
> too.
>
>
>     Tony
>
>
>
>
> Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain
> inkl.
> http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/i
>ndex.html

OK, then I'll do this that way. 
Also, d3dx9 provides support for multiple file format (PNG, TGA, BMP...). I 
assume I'll have to add those dependencies in the build process.

	

	
		
___________________________________________________________________________ 
Yahoo! Mail r?invente le mail ! D?couvrez le nouveau Yahoo! Mail et son interface r?volutionnaire.
http://fr.mail.yahoo.com



From alexd4 at inbox.lv  Sun Mar  9 13:56:40 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Sun, 09 Mar 2008 20:56:40 +0200
Subject: [PATCH 6/6] wined3d: Dirtify p8 textures when device palettes
	change.
In-Reply-To: <200803091842.58861.stefan@codeweavers.com>
References: <47D3EFEE.7030606@inbox.lv>
	<200803091842.58861.stefan@codeweavers.com>
Message-ID: <47D432E8.1030205@inbox.lv>

Hi Stefan,

About implementing ddraw-style palette on top of device palettes - I think this 
way we would create more issues than we solve by it. As far as I'm concerned, I 
don't feel like there's a lot of confusion coming from the fact there are two 
palette interfaces, although there is some confusion primarily because device 
palettes are used for ddraw purposes, mainly storing p8 primary surface's 
palette.  That isn't a big trouble to avoid, as same can be done by accessing 
dds_primary, I believe.

If ddraw palettes are mapped onto d3d8 style ones, then we need a mechanism of 
allocating palette numbers and freeing them as needed. For example, AVP1 does 
palette creation/destruction a LOT (every frame or every few frames), so it's 
not an unrealistic possibility to run out of palettes, if 65536 limit is kept 
and something is done wrong.

You may be right about checking palette in IWineD3D*Texture::PreLoad. I guess 
the palette9_changed call could simply be moved to PreLoad and it would 
accomplish something like that.

Stefan D?singer wrote:
> Am Sonntag, 9. M?rz 2008 15:10:54 schrieb Alexander Dorofeyev:
>> Fixes problems with properly updating wine's P8 textures, when it is
>> required because of device palette change.
> Instead of iterating over all resources and finding P8 textures I think it 
> would be nicer to store the palette the texture/surface was loaded with in 
> each P8 / A8P8 surface and compare this stored palette to the current device 
> palette in IWineD3DSurface::PreLoad(non-texture path) and 
> IWineD3D*Texture::PreLoad.
> 
> With this, patch 4 could maybe be made nicer as well. If we have to verify the 
> palettes anyway, we can remove the DDraw-Style IWineD3DPalette interface from 
> WineD3D altogether, and just give each ddraw palette in ddraw.dll a WineD3D 
> palette number and use the d3d8/9 palette management exclusively in WineD3D 
> and avoid the confusion of having two palette interfaces.



From stefan at codeweavers.com  Sun Mar  9 14:15:19 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Sun, 9 Mar 2008 20:15:19 +0100
Subject: Fixed function pipeline replacement infrastructure follow up
Message-ID: <200803092015.27839.stefan@codeweavers.com>

Hi,

As a follow up to the mail from last Sunday I now have a concrete 
implementation suggestion for an infrastructure for a fixed function pipeline 
replacement:

What it mainly does is that it makes the state table a property of the shader 
backend, as well as the shader caps to keep GetDeviceCaps simpler. It also 
adds rudimentary functions for comparing the fixed function fragment 
processing settings. As an example implementation, the patchset is 
constructed around a fragment pipeline implementation using 
GL_ATI_fragment_shader.

What is missing is dealing with vertex states, Henri has some code for that 
already. The data structure and comparison of pipeline states needs 
optimization. The already existing pipeline replacement using 
GL_NV_register_combiners and GL_NV_texture_shader should be moved into a 
separate shader backend. And obviously an implementation of vertex and 
fragment pipeline using ARB shaders and GLSL(that could be done as a gsoc 
project maybe)

The GL_ATI_fragment_shader code is constructed bottom-up, so if the patches 
are applied as-is, it will lead to a temporary regression on ATI cards. 
Inverting this would be a major pain, so when sending it in I'll keep the 
extension disabled in patch 1, and enable it in a final last patch.

The GL_NV_* stuff will work a bit different than atifs, arb and glsl, since we 
can configure all texture stages individually, so a stored program and state 
comparison is not needed. Instead we can keep the set_tex_op as it is, but 
the if(GL_SUPPORTED(...)) checks and related nastiness can be factored out. 
Maybe we can also get rid of setting up the texunit map every draw in some 
cases.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ffp.tar.bz2
Type: application/x-tbz
Size: 43514 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080309/d629b6f6/attachment-0001.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080309/d629b6f6/attachment-0001.pgp 

From msclrhd at googlemail.com  Sun Mar  9 15:36:37 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 9 Mar 2008 20:36:37 +0000
Subject: oleacc: add GetOleaccVersionInfo
In-Reply-To: <252714.38266.qm@web23203.mail.ird.yahoo.com>
References: <252714.38266.qm@web23203.mail.ird.yahoo.com>
Message-ID: <3f4fd2640803091336j74cacebdkfe264cefe96fb00e@mail.gmail.com>

On 09/03/2008, Louis. Lenders <xerox_xerox2000 at yahoo.co.uk> wrote:
>
> Hi, this fixes crash in DietPower:
> http://bugs.winehq.org/show_bug.cgi?id=10102

> +@ stdcall GetOleaccVersionInfo(long long)

Since both these arguments are DWORD*, they need to be ptr, not long.

- Reece


From msclrhd at googlemail.com  Sun Mar  9 15:37:47 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 9 Mar 2008 20:37:47 +0000
Subject: oleacc: add GetOleaccVersionInfo
In-Reply-To: <3f4fd2640803091336j74cacebdkfe264cefe96fb00e@mail.gmail.com>
References: <252714.38266.qm@web23203.mail.ird.yahoo.com>
	<3f4fd2640803091336j74cacebdkfe264cefe96fb00e@mail.gmail.com>
Message-ID: <3f4fd2640803091337y4b765509x1de4f4a905bdf144@mail.gmail.com>

On 09/03/2008, Reece Dunn <msclrhd at googlemail.com> wrote:
> On 09/03/2008, Louis. Lenders <xerox_xerox2000 at yahoo.co.uk> wrote:
>  >
>  > Hi, this fixes crash in DietPower:
>  > http://bugs.winehq.org/show_bug.cgi?id=10102
>
>
> > +@ stdcall GetOleaccVersionInfo(long long)
>
>  Since both these arguments are DWORD*, they need to be ptr, not long.

Sorry for spamming wine-patches. I hit Reply to all without checking
the CC list.

- Reece


From thunderbird2k at gmx.net  Sun Mar  9 17:44:43 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 09 Mar 2008 23:44:43 +0100
Subject: [PATCH 6/6] wined3d: Dirtify p8 textures when device palettes
	change.
In-Reply-To: <47D432E8.1030205@inbox.lv>
References: <47D3EFEE.7030606@inbox.lv>
	<200803091842.58861.stefan@codeweavers.com> <47D432E8.1030205@inbox.lv>
Message-ID: <20080309224443.80270@gmx.net>

> Hi Stefan,
> 
> About implementing ddraw-style palette on top of device palettes - I think
> this 
> way we would create more issues than we solve by it. As far as I'm
> concerned, I 
> don't feel like there's a lot of confusion coming from the fact there are
> two 
> palette interfaces, although there is some confusion primarily because
> device 
> palettes are used for ddraw purposes, mainly storing p8 primary surface's 
> palette.  That isn't a big trouble to avoid, as same can be done by
> accessing 
> dds_primary, I believe.
> 
> If ddraw palettes are mapped onto d3d8 style ones, then we need a
> mechanism of 
> allocating palette numbers and freeing them as needed. For example, AVP1
> does 
> palette creation/destruction a LOT (every frame or every few frames), so
> it's 
> not an unrealistic possibility to run out of palettes, if 65536 limit is
> kept 
> and something is done wrong.
> 
> You may be right about checking palette in IWineD3D*Texture::PreLoad. I
> guess 
> the palette9_changed call could simply be moved to PreLoad and it would 
> accomplish something like that.
> 
> Stefan D?singer wrote:
> > Am Sonntag, 9. M?rz 2008 15:10:54 schrieb Alexander Dorofeyev:
> >> Fixes problems with properly updating wine's P8 textures, when it is
> >> required because of device palette change.
> > Instead of iterating over all resources and finding P8 textures I think
> it 
> > would be nicer to store the palette the texture/surface was loaded with
> in 
> > each P8 / A8P8 surface and compare this stored palette to the current
> device 
> > palette in IWineD3DSurface::PreLoad(non-texture path) and 
> > IWineD3D*Texture::PreLoad.
> > 
> > With this, patch 4 could maybe be made nicer as well. If we have to
> verify the 
> > palettes anyway, we can remove the DDraw-Style IWineD3DPalette interface
> from 
> > WineD3D altogether, and just give each ddraw palette in ddraw.dll a
> WineD3D 
> > palette number and use the d3d8/9 palette management exclusively in
> WineD3D 
> > and avoid the confusion of having two palette interfaces.
> 
> 

I think we should continue splitting the ddraw and d3d8/9 palette interfaces. It took me a long time to get the ddraw in a reasonable shape (there are a few small issues left). There are differences and I think we get issues down the road if we don't explicitly split it like it is now. (at least you would get a lot of dxversion checks).

It is just that right now a few places which don't need the device palette code have it in (I mean there are places left which use the device palette when there is none set e.g. read_from_framebuffer, RealizePalette and others).

Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.gmx.net/de/entertainment/games/free


From nessi at nessi-online.de  Sun Mar  9 18:33:23 2008
From: nessi at nessi-online.de (Jens Nestler)
Date: Mon, 10 Mar 2008 00:33:23 +0100
Subject: Fwd: Re: RegOverridePredefKey stub - Take 2
Message-ID: <200803100033.23681.nessi@nessi-online.de>

Hello,
six weeks ago I've sent this patch for a basic implementation of the  
RegOverridePredefKey function.
Unfortunately the patch was not considered till now.
Can everybody help me ?

Jens
-------------- next part --------------
An embedded message was scrubbed...
From: Jens Nestler <nessi at nessi-online.de>
Subject: Re: RegOverridePredefKey stub - Take 2
Date: Wed, 6 Feb 2008 08:00:05 +0100
Size: 5806
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080310/031480b3/attachment.eml 

From wine-devel at kievinfo.com  Sun Mar  9 20:19:02 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 09 Mar 2008 19:19:02 -0600
Subject: Fwd: Re: RegOverridePredefKey stub - Take 2
In-Reply-To: <200803100033.23681.nessi@nessi-online.de>
References: <200803100033.23681.nessi@nessi-online.de>
Message-ID: <47D48C86.5040403@kievinfo.com>


Jens Nestler wrote:
> Hello,
> six weeks ago I've sent this patch for a basic implementation of the  
> RegOverridePredefKey function.
> Unfortunately the patch was not considered till now.
> Can everybody help me ?
> 
You have some extra pieces in this patch. When you are submitting patch - 
make sure only one thing is being changed. Here you have some irrelevant 
changes in your patch.

Vitaliy.


From thestig at google.com  Sun Mar  9 22:18:51 2008
From: thestig at google.com (Lei Zhang)
Date: Sun, 9 Mar 2008 20:18:51 -0700
Subject: [PATCH 3/3] shell32: use well known directories from
	xdg-user-dirs (try 2)
In-Reply-To: <558b2f5c0803051941g32980e2p51c33adf3842e509@mail.gmail.com>
References: <558b2f5c0803051941g32980e2p51c33adf3842e509@mail.gmail.com>
Message-ID: <558b2f5c0803092018n1bb888a4i6222fa2ed59b770d@mail.gmail.com>

On Wed, Mar 5, 2008 at 8:41 PM, Lei Zhang <thestig at google.com> wrote:
> Hi,
>
>  This sets the shell folders using values from xdg-user-dirs. The
>  existing shell folder code checks the shell folder registry keys, and
>  will not overwrite the values we set here.
>
>  This version converts the Unix paths to Unicode when needed.
>

It just occurred to me that I need to convert the Unix path to a dos path.

Should I just send the updated version of this patch, or resend the
first two patches in the series as well?


From thestig at google.com  Sun Mar  9 22:19:12 2008
From: thestig at google.com (Lei Zhang)
Date: Sun, 9 Mar 2008 20:19:12 -0700
Subject: [PATCH] qedit: use skip in MediaDet test
In-Reply-To: <558b2f5c0802211615l4cdec6a6q1c2559d2ad9e2415@mail.gmail.com>
References: <558b2f5c0802211615l4cdec6a6q1c2559d2ad9e2415@mail.gmail.com>
Message-ID: <558b2f5c0803092019w20181225keb618b31061626f6@mail.gmail.com>

On Thu, Feb 21, 2008 at 5:15 PM, Lei Zhang <thestig at google.com> wrote:
> Hi,
>
>  Dank pointed out the qedit test crashes with an old .wine directory.
>  Adding a skip().
>

Any reason why this wasn't committed?


From m.b.lankhorst at gmail.com  Sun Mar  9 23:05:04 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 9 Mar 2008 21:05:04 -0700
Subject: Processes and ioctl's
Message-ID: <b130c85e0803092105q622740acj3e47004f5f2f4227@mail.gmail.com>

Hi all,

I am hitting a snag with moving ioctl handling into mount manager. I
got the ioctl's working and itunes fairly satisfied, but now I'm
hitting another problem: The mount manager is not in the same process
any more as the application. This is an issue because one of the
ioctl's is passing a pointer in the struct itself, which gives a messy
situation if it doesn't run in the current application any more.

A workaround would be to use ReadProcessMemory and WriteProcessMemory,
then fudge the wineserver ioctl request to somehow pass a handle of
the calling process around so I can use that. This looks like it is
not a clean solution. Does anyone know how to do it cleanly?

Cheers,
Maarten.


From wine-devel at kievinfo.com  Mon Mar 10 00:24:38 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 09 Mar 2008 23:24:38 -0600
Subject: Please remove/block DARKGuy user from the forum and user mailing list!
Message-ID: <47D4C616.70603@kievinfo.com>

What the subject say.


From dank at kegel.com  Mon Mar 10 01:14:19 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 9 Mar 2008 23:14:19 -0700
Subject: New winetricks 20080309: new verb 'icodecs'
Message-ID: <a71bd89a0803092314y2d317568g28ebb999e371c106@mail.gmail.com>

Intel codecs are needed to run Tonka Search & Rescue 2
(which my son likes), so I added them to winetricks as 'icodecs'.

I also renamed allvcodecs to be allcodecs (since it's hard
to separate audio from video codecs sometimes)
and removed a spurious warning from wsh56.

As always, winetricks is at
  http://kegel.com/wine/winetricks
and
  http://winezeug.googlecode.com


From julliard at winehq.org  Mon Mar 10 03:37:27 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 10 Mar 2008 09:37:27 +0100
Subject: [PATCH 3/3] shell32: use well known directories from
	xdg-user-dirs (try 2)
In-Reply-To: <558b2f5c0803092018n1bb888a4i6222fa2ed59b770d@mail.gmail.com>
	(Lei Zhang's message of "Sun, 9 Mar 2008 20:18:51 -0700")
References: <558b2f5c0803051941g32980e2p51c33adf3842e509@mail.gmail.com>
	<558b2f5c0803092018n1bb888a4i6222fa2ed59b770d@mail.gmail.com>
Message-ID: <87myp7dlfc.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> It just occurred to me that I need to convert the Unix path to a dos path.

No, there's no guarantee that the xdg dirs are reachable from a DOS
drive. You should be modifying the symlinks instead.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Mon Mar 10 03:36:38 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 10 Mar 2008 09:36:38 +0100
Subject: [PATCH] qedit: use skip in MediaDet test
In-Reply-To: <558b2f5c0803092019w20181225keb618b31061626f6@mail.gmail.com>
	(Lei Zhang's message of "Sun, 9 Mar 2008 20:19:12 -0700")
References: <558b2f5c0802211615l4cdec6a6q1c2559d2ad9e2415@mail.gmail.com>
	<558b2f5c0803092019w20181225keb618b31061626f6@mail.gmail.com>
Message-ID: <87r6ejdlgp.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> On Thu, Feb 21, 2008 at 5:15 PM, Lei Zhang <thestig at google.com> wrote:
>> Hi,
>>
>>  Dank pointed out the qedit test crashes with an old .wine directory.
>>  Adding a skip().
>>
>
> Any reason why this wasn't committed?

A skip() is for things that cannot be tested because some feature can
legitimately be missing on Windows. Having a not up-to-date Wine
registry is not a legitimate setup, there's no reason for the test to
try to cope with that.

-- 
Alexandre Julliard
julliard at winehq.org


From mikolaj at zalewski.pl  Mon Mar 10 04:31:12 2008
From: mikolaj at zalewski.pl (=?ISO-8859-2?Q?Miko=B3aj_Zalewski?=)
Date: Mon, 10 Mar 2008 10:31:12 +0100
Subject: [comctl32/tests #3] Use GetModuleHandleA instead of LoadLibraryA
In-Reply-To: <47D41A8E.4070600@gmail.com>
References: <47D4142E.4050206@zalewski.pl> <47D41A8E.4070600@gmail.com>
Message-ID: <47D4FFE0.1080504@zalewski.pl>


> If LoadLibrary is indeed needed it should be accompanied with a 
> FreeLibrary and we probably need a comment for the why as well.

  Does it matter if we call FreeLibrary on the library we are testing? I 
don't think we will be able to free it before the end of the tests when 
anyhow it will be unloaded by the process shutdown. But maybe I should 
care more about elegant code?

Mikolaj Zalewski


From paul.vriens.wine at gmail.com  Mon Mar 10 04:41:24 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 10 Mar 2008 10:41:24 +0100
Subject: [comctl32/tests #3] Use GetModuleHandleA instead of LoadLibraryA
In-Reply-To: <47D4FFE0.1080504@zalewski.pl>
References: <47D4142E.4050206@zalewski.pl> <47D41A8E.4070600@gmail.com>
	<47D4FFE0.1080504@zalewski.pl>
Message-ID: <47D50244.1070302@gmail.com>

Miko?aj Zalewski wrote:
> 
>> If LoadLibrary is indeed needed it should be accompanied with a 
>> FreeLibrary and we probably need a comment for the why as well.
> 
>  Does it matter if we call FreeLibrary on the library we are testing? I 
> don't think we will be able to free it before the end of the tests when 
> anyhow it will be unloaded by the process shutdown. But maybe I should 
> care more about elegant code?
> 
> Mikolaj Zalewski
> 
Yeah, I wrote 'should' but it has more to do with style I guess. The same is 
true for HeapFree of course but I do think we should make the code as 
good/correct as possible.

-- 
Cheers,

Paul.


From julliard at winehq.org  Mon Mar 10 05:34:19 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 10 Mar 2008 11:34:19 +0100
Subject: [comctl32/tests #3] Use GetModuleHandleA instead of LoadLibraryA
In-Reply-To: <47D41A8E.4070600@gmail.com> (Paul Vriens's message of "Sun, 09
	Mar 2008 18:12:46 +0100")
References: <47D4142E.4050206@zalewski.pl> <47D41A8E.4070600@gmail.com>
Message-ID: <87iqzueul0.fsf@wine.dyndns.org>

Paul Vriens <paul.vriens.wine at gmail.com> writes:

> The question that remains is should the full <dll>-tests be able to be compiled 
> and run or should we have this to be correct for every single test? I mean that 
> are no issues if you compile the whole comctl32 "testsuite".

It's a good idea to keep each C file as stand-alone as possible, so that
it's possible to copy it over to Windows and quickly build a test exe
without needing extra infrastructure.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Mon Mar 10 05:41:08 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 10 Mar 2008 10:41:08 +0000
Subject: a patch to fix the font in bottons and so on.
In-Reply-To: <120d62710803091906w5bbbdebds71047663b19b73b5@mail.gmail.com>
References: <120d62710803091906w5bbbdebds71047663b19b73b5@mail.gmail.com>
Message-ID: <47D51044.5020901@codeweavers.com>

?? wrote:
> Hi everyone,
> I have a patch in ubuntu China forum, which fix the font in bottons 
> and so on to display correctly using the right font. This patch 
> changes only one source file: dlls/gdi32/freetype.c. The main function 
> is: Default and ansi charset is translated to 
> getenv("WINE_DEFAULT_CODEPAGE"). This patch was written by *windowssux 
> <javascript:pn('windowssux');> in ubunt china forum: 
> http://forum.ubuntu.org.cn/*
>
>
> The patched freetype.c is attached. It's the first time for me to send 
> you guys a patch to wine. Please let know if something is wrong. Thanks.

You need to send the patch, not the whole file. It's nearly impossible 
to review the changes if you add an attachment with several thousand 
lines of code.

-- 
Rob Shearman



From julliard at winehq.org  Mon Mar 10 06:05:29 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 10 Mar 2008 12:05:29 +0100
Subject: wininet: Make the reference count of WININETHANDLEHEADER
	thread-safe by using InterlockedIncrement/InterlockedDecrement.
In-Reply-To: <47D27219.8030202@codeweavers.com> (Robert Shearman's message of
	"Sat, 08 Mar 2008 11:01:45 +0000")
References: <47D27219.8030202@codeweavers.com>
Message-ID: <87ejaiet52.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> @@ -1296,7 +1296,7 @@ HINTERNET FTP_FtpOpenFileW(LPWININETFTPSESSIONW lpwfs,
>          lpwh->hdr.vtbl = &FTPFILEVtbl;
>          lpwh->hdr.dwFlags = dwFlags;
>          lpwh->hdr.dwContext = dwContext;
> -        lpwh->hdr.dwRefCount = 1;
> +        lpwh->hdr.lRefCount = 1;

If you are going to rename the variable then please take the opportunity
to get rid of the silly Hungarian prefix, so that we don't need to
rename it again next time.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Mon Mar 10 06:14:50 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 10 Mar 2008 12:14:50 +0100
Subject: shell32: Support getting the shell folder path for users other
	than the current user and the default user (take 3)
In-Reply-To: <200803092125.m29LP1YO005984@mailhost.geldorp.nl> (Ge van
	Geldorp's message of "Sun, 9 Mar 2008 22:25:06 +0100")
References: <200803092125.m29LP1YO005984@mailhost.geldorp.nl>
Message-ID: <87abl6esph.fsf@wine.dyndns.org>

"Ge van Geldorp" <ge at thinstall.com> writes:

> Changelog:
>   Juan Lang <juan.lang at gmail.com>
>   Ge van Geldorp <ge at thinstall.com>
>   Support getting the shell folder path for users other than the current
> user and the default user
>   Fixes bug 10905

You are leaking memory now.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Mon Mar 10 08:38:24 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 10 Mar 2008 14:38:24 +0100
Subject: Implementing a new Direct3D function
In-Reply-To: <200803091952.12638.jgardou@yahoo.fr>
References: <E1JYPQa-0000lW-41@www10.emo.freenet-rz.de>
	<200803091952.12638.jgardou@yahoo.fr>
Message-ID: <200803101438.30661.stefan@codeweavers.com>

Am Sonntag, 9. M?rz 2008 19:52:12 schrieb J?r?me Gardou:
> Also, d3dx9 provides support for multiple file format (PNG, TGA, BMP...). I
> assume I'll have to add those dependencies in the build process.
As far as I know GDI handles them, so you can use GDI functions here, and GDI 
in turn alredy has the dependency on the external libraries
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080310/37f28483/attachment.pgp 

From stefan at codeweavers.com  Mon Mar 10 08:47:13 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 10 Mar 2008 14:47:13 +0100
Subject: Fixed function pipeline replacement infrastructure follow up
In-Reply-To: <200803092015.27839.stefan@codeweavers.com>
References: <200803092015.27839.stefan@codeweavers.com>
Message-ID: <200803101447.17268.stefan@codeweavers.com>

Am Sonntag, 9. M?rz 2008 20:15:19 schrieb Stefan D?singer:
> What is missing is dealing with vertex states, Henri has some code for that
> already. The data structure and comparison of pipeline states needs
> optimization. The already existing pipeline replacement using
> GL_NV_register_combiners and GL_NV_texture_shader should be moved into a
> separate shader backend.
An update on this, I think moving the 
GL_NV_texture_shader+GL_NV_register_combiners code into a separate shader 
model is pointless. I had a deeper look at the code again, and I think that 
the NVTS handling is well abstracted using set_tex_op vs set_tex_op_nvrc. 
GL_NV_texture_shader in turn is handled mostly in the activate_dimensions() 
function in state.c.

The situation isn't 100Q% desireable, but to get major improvements we'd need 
an nvts+nvrc exclusive backend, and keep both extensions out of the base one. 
This would mean a functional regression for cards that have nvrc but not 
nvts(Geforce 2 and earlier). Trying to keep nvrc functionality without nvts 
and still separating the code would mean massive code duplication with the 
gain of removing 4 or 5 if conditions. (Or alternatively adding a few more 
shader callbacks, one for each replaced if())

Once we implement real pixel shaders using those extensions we need a separate 
shader backend, but for the ffp part it will only hook the state_alphaop(), 
state_colorop() and sampler() functions to prevent the originals from killing 
the shader, but not modifying their functionality.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080310/71dd143f/attachment.pgp 

From jgardou at yahoo.fr  Mon Mar 10 11:35:35 2008
From: jgardou at yahoo.fr (=?iso-8859-1?q?Gardou=20J=E9r=F4me?=)
Date: Mon, 10 Mar 2008 17:35:35 +0100 (CET)
Subject: Implementing a new Direct3D function
In-Reply-To: <200803101438.30661.stefan@codeweavers.com>
Message-ID: <541659.19987.qm@web25014.mail.ukl.yahoo.com>



Stefan D?singer <stefan at codeweavers.com> a ?crit : Am Sonntag, 9. M?rz 2008 19:52:12 schrieb J?r?me Gardou:
> Also, d3dx9 provides support for multiple file format (PNG, TGA, BMP...). I
> assume I'll have to add those dependencies in the build process.
As far as I know GDI handles them, so you can use GDI functions here, and GDI 
in turn alredy has the dependency on the external libraries
Yes, but that would be very incomplete. GDI has only limited support for PNG and JPG files, and doesn't handle TGA at all.

Though this will be useful for DIBs, DDS and BMPs.

       
---------------------------------
 Envoy? avec Yahoo! Mail.
Une boite mail plus intelligente. 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080310/18ffa194/attachment.htm 

From denver at ossguy.com  Mon Mar 10 11:50:24 2008
From: denver at ossguy.com (Denver Gingerich)
Date: Mon, 10 Mar 2008 12:50:24 -0400
Subject: ddraw: Implement ForceRefreshRate registry entry for overriding
	DirectX refresh rate
In-Reply-To: <47D56576.2060908@ossguy.com>
References: <47D56576.2060908@ossguy.com>
Message-ID: <6defe8840803100950u5289f119j96c99dcaa7ff93da@mail.gmail.com>

On Mon, Mar 10, 2008 at 12:44 PM, Denver Gingerich <denver at ossguy.com> wrote:
> The DirectX refresh rate override feature that this patch implements is described in main.c below.
>
>  In order for the override to take effect only on SetDisplayMode and not on RestoreDisplayMode it was necessary to move the functionality of SetDisplayMode into a helper function (IDirectDrawImpl_SetDisplayModeNoOverride) and let IDirectDrawImpl_SetDisplayMode and IDirectDrawImpl_RestoreDisplayMode call the helper function.
>
>  Denver Gingerich
>
>
>  diff --git a/dlls/ddraw/ddraw.c b/dlls/ddraw/ddraw.c
>  index 4cac55d..0f7eeaf 100644
>  --- a/dlls/ddraw/ddraw.c
>  +++ b/dlls/ddraw/ddraw.c
>  @@ -3,6 +3,7 @@
>   * Copyright 1998-2000 Lionel Ulmer
>   * Copyright 2000-2001 TransGaming Technologies Inc.
>   * Copyright 2006 Stefan D?singer
>  + * Copyright 2008 Denver Gingerich
>   *
>   * This library is free software; you can redistribute it and/or
>   * modify it under the terms of the GNU Lesser General Public
>  @@ -60,6 +61,9 @@ static const DDDEVICEIDENTIFIER2 deviceidentifier =
>      0
>   };
>
>  +/* in main.c; stores value of ForceRefreshRate */
>  +extern DWORD force_refresh_rate;
>  +
>   /*****************************************************************************
>   * IUnknown Methods
>   *****************************************************************************/
>  @@ -534,34 +538,24 @@ IDirectDrawImpl_SetCooperativeLevel(IDirectDraw7 *iface,
>   }
>
>   /*****************************************************************************
>  - * IDirectDraw7::SetDisplayMode
>   *
>  - * Sets the display screen resolution, color depth and refresh frequency
>  - * when in fullscreen mode (in theory).
>  - * Possible return values listed in the SDK suggest that this method fails
>  - * when not in fullscreen mode, but this is wrong. Windows 2000 happily sets
>  - * the display mode in DDSCL_NORMAL mode without an hwnd specified.
>  - * It seems to be valid to pass 0 for With and Height, this has to be tested
>  - * It could mean that the current video mode should be left as-is. (But why
>  - * call it then?)
>  + * Helper function for SetDisplayMode and RestoreDisplayMode
>   *
>  - * Params:
>  - *  Height, Width: Screen dimension
>  - *  BPP: Color depth in Bits per pixel
>  - *  Refreshrate: Screen refresh rate
>  - *  Flags: Other stuff
>  - *
>  - * Returns
>  - *  DD_OK on success
>  + * Implements DirectDraw's SetDisplayMode, but ignores the value of
>  + * ForceRefreshRate, since it is already handled by
>  + * IDirectDrawImpl_SetDisplayMode.  RestoreDisplayMode can use this function
>  + * without worrying that ForceRefreshRate will override the refresh rate.  For
>  + * argument and return value documentation, see
>  + * IDirectDrawImpl_SetDisplayMode.
>   *
>   *****************************************************************************/
>  -static HRESULT WINAPI
>  -IDirectDrawImpl_SetDisplayMode(IDirectDraw7 *iface,
>  -                               DWORD Width,
>  -                               DWORD Height,
>  -                               DWORD BPP,
>  -                               DWORD RefreshRate,
>  -                               DWORD Flags)
>  +static HRESULT
>  +IDirectDrawImpl_SetDisplayModeNoOverride(IDirectDraw7 *iface,
>  +                                         DWORD Width,
>  +                                         DWORD Height,
>  +                                         DWORD BPP,
>  +                                         DWORD RefreshRate,
>  +                                         DWORD Flags)
>   {
>      ICOM_THIS_FROM(IDirectDrawImpl, IDirectDraw7, iface);
>      WINED3DDISPLAYMODE Mode;
>  @@ -616,6 +610,46 @@ IDirectDrawImpl_SetDisplayMode(IDirectDraw7 *iface,
>   }
>
>   /*****************************************************************************
>  + * IDirectDraw7::SetDisplayMode
>  + *
>  + * Sets the display screen resolution, color depth and refresh frequency
>  + * when in fullscreen mode (in theory).
>  + * Possible return values listed in the SDK suggest that this method fails
>  + * when not in fullscreen mode, but this is wrong. Windows 2000 happily sets
>  + * the display mode in DDSCL_NORMAL mode without an hwnd specified.
>  + * It seems to be valid to pass 0 for With and Height, this has to be tested
>  + * It could mean that the current video mode should be left as-is. (But why
>  + * call it then?)
>  + *
>  + * Params:
>  + *  Height, Width: Screen dimension
>  + *  BPP: Color depth in Bits per pixel
>  + *  Refreshrate: Screen refresh rate
>  + *  Flags: Other stuff
>  + *
>  + * Returns
>  + *  DD_OK on success
>  + *
>  + *****************************************************************************/
>  +static HRESULT WINAPI
>  +IDirectDrawImpl_SetDisplayMode(IDirectDraw7 *iface,
>  +                               DWORD Width,
>  +                               DWORD Height,
>  +                               DWORD BPP,
>  +                               DWORD RefreshRate,
>  +                               DWORD Flags)
>  +{
>  +    if (force_refresh_rate != 0)
>  +    {
>  +        TRACE("ForceRefreshRate overriding passed-in refresh rate (%d Hz) to %d Hz\n", RefreshRate, force_refresh_rate);
>  +        RefreshRate = force_refresh_rate;
>  +    }
>  +
>  +    return IDirectDrawImpl_SetDisplayModeNoOverride(iface, Width, Height, BPP,
>  +                                                    RefreshRate, Flags);
>  +}
>  +
>  +/*****************************************************************************
>   * IDirectDraw7::RestoreDisplayMode
>   *
>   * Restores the display mode to what it was at creation time. Basically.
>  @@ -642,12 +676,12 @@ IDirectDrawImpl_RestoreDisplayMode(IDirectDraw7 *iface)
>      ICOM_THIS_FROM(IDirectDrawImpl, IDirectDraw7, iface);
>      TRACE("(%p)\n", This);
>
>  -    return IDirectDraw7_SetDisplayMode(ICOM_INTERFACE(This, IDirectDraw7),
>  -                                       This->orig_width,
>  -                                       This->orig_height,
>  -                                       This->orig_bpp,
>  -                                       0,
>  -                                       0);
>  +    return IDirectDrawImpl_SetDisplayModeNoOverride(ICOM_INTERFACE(This, IDirectDraw7),
>  +                                                    This->orig_width,
>  +                                                    This->orig_height,
>  +                                                    This->orig_bpp,
>  +                                                    0,
>  +                                                    0);
>   }
>
>   /*****************************************************************************
>  diff --git a/dlls/ddraw/main.c b/dlls/ddraw/main.c
>  index 4e77d4f..a33cb34 100644
>  --- a/dlls/ddraw/main.c
>  +++ b/dlls/ddraw/main.c
>  @@ -4,6 +4,7 @@
>   * Copyright 1998 Lionel Ulmer
>   * Copyright 2000-2001 TransGaming Technologies Inc.
>   * Copyright 2006 Stefan D?singer
>  + * Copyright 2008 Denver Gingerich
>   *
>   * This file contains the (internal) driver registration functions,
>   * driver enumeration APIs and DirectDraw creation functions.
>  @@ -68,6 +69,9 @@ static CRITICAL_SECTION_DEBUG ddraw_cs_debug =
>   };
>   CRITICAL_SECTION ddraw_cs = { &ddraw_cs_debug, -1, 0, 0, 0, 0 };
>
>  +/* value of ForceRefreshRate */
>  +DWORD force_refresh_rate = 0;
>  +
>   /***********************************************************************
>   *
>   * Helper function for DirectDrawCreate and friends
>  @@ -886,6 +890,38 @@ DllMain(HINSTANCE hInstDLL,
>              }
>          }
>
>  +        /* On Windows one can force the refresh rate that DirectDraw uses by
>  +         * setting an override value in dxdiag.  This is documented in KB315614
>  +         * (main article), KB230002, and KB217348.  By comparing registry dumps
>  +         * before and after setting the override, we see that the override value
>  +         * is stored in HKLM\Software\Microsoft\DirectDraw\ForceRefreshRate as a
>  +         * DWORD that represents the refresh rate to force.  We use this
>  +         * registry entry to modify the behavior of SetDisplayMode so that Wine
>  +         * users can override the refresh rate in a Windows-compatible way.
>  +         *
>  +         * dxdiag will not accept a refresh rate lower than 40 or higher than
>  +         * 120 so this value should be within that range.  It is, of course,
>  +         * possible for a user to set the registry entry value directly so that
>  +         * assumption might not hold.
>  +         *
>  +         * There is no current mechanism for setting this value through the Wine
>  +         * GUI.  It would be most appropriate to set this value through a dxdiag
>  +         * clone, but it may be sufficient to use winecfg.
>  +         *
>  +         * TODO: Create a mechanism for setting this value through the Wine GUI.
>  +         */
>  +        if ( !RegOpenKeyA( HKEY_LOCAL_MACHINE, "Software\\Microsoft\\DirectDraw", &hkey ) )
>  +        {
>  +            DWORD type, data;
>  +            size = sizeof(data);
>  +            if (!RegQueryValueExA( hkey, "ForceRefreshRate", NULL, &type, (LPBYTE)&data, &size ) && type == REG_DWORD)
>  +            {
>  +                TRACE("ForceRefreshRate set; overriding refresh rate to %d Hz\n", data);
>  +                force_refresh_rate = data;
>  +            }
>  +            RegCloseKey( hkey );
>  +        }
>  +
>          DisableThreadLibraryCalls(hInstDLL);
>      }
>      else if (Reason == DLL_PROCESS_DETACH)

This patch differs from my previous patch [1] in the following ways:
a) DDRAW_SetDisplayMode renamed to IDirectDrawImpl_SetDisplayModeNoOverride
b) sentence in main.c description changed from

"To ensure compatibility with Windows, we use this registry entry to
modify the behavior of SetDisplayMode."

to

"We use this registry entry to modify the behavior of SetDisplayMode
so that Wine users can override the refresh rate in a
Windows-compatible way."


Hopefully these changes are sufficient for the patch to be accepted.
Please let me know if there are further concerns with it.  Thanks.

Denver


1. http://www.winehq.org/pipermail/wine-patches/2008-March/051213.html


From dank at kegel.com  Mon Mar 10 12:31:24 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 10 Mar 2008 10:31:24 -0700
Subject: Processes and ioctl's
Message-ID: <a71bd89a0803101031n13f7dde7s88f5b41e6c4d882@mail.gmail.com>

Maarten wrote:
> I am hitting a snag with moving ioctl handling into mount manager.

It might be good to review for the group why you're moving ioctl
handling.  Context is always helpful.


From nessi at nessi-online.de  Mon Mar 10 13:40:46 2008
From: nessi at nessi-online.de (Jens Nestler)
Date: Mon, 10 Mar 2008 19:40:46 +0100
Subject: Fwd: Re: RegOverridePredefKey stub -  new
In-Reply-To: <47D48C86.5040403@kievinfo.com>
References: <200803100033.23681.nessi@nessi-online.de>
	<47D48C86.5040403@kievinfo.com>
Message-ID: <200803101940.46947.nessi@nessi-online.de>

Am Montag, 10. M?rz 2008 02:19:02 schrieb Vitaliy Margolen:
> Jens Nestler wrote:
> > Hello,
> > six weeks ago I've sent this patch for a basic implementation of the
> > RegOverridePredefKey function.
> > Unfortunately the patch was not considered till now.
> > Can everybody help me ?
>
> You have some extra pieces in this patch. When you are submitting patch -
> make sure only one thing is being changed. Here you have some irrelevant
> changes in your patch.
>
> Vitaliy.

Sorry, 
unfortunately there was a second patch included (which was already applied). 
Please find the revised patch attached.
Jens
-------------- next part --------------
A non-text attachment was scrubbed...
Name: patch_RegOverridePredefKey.diff
Type: text/x-diff
Size: 2869 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080310/70201203/attachment.diff 

From jchevrier at nexicom.net  Mon Mar 10 14:06:49 2008
From: jchevrier at nexicom.net (Justin Chevrier)
Date: Mon, 10 Mar 2008 15:06:49 -0400
Subject: DestroyWindow behavior differences between Win9x and Win2k/xp
Message-ID: <47D586C9.7010905@nexicom.net>

Hey guys,

I'm looking into a crash of Master Of Orion II on exit (both in Wine and 
Windows XP). The problem appears to be that the program is attempting to 
do a DestroyWindow on a different thread. This is not allowed by our 
code and that behavior is backed up by MSDN documentation. This behavior 
was allowed on Windows 9x however. I have confirmed that removing the 
thread check allows the app to exit cleanly, but of course that is not 
an acceptable fix. As this is a full screen app the game's window stays 
on top in a partially drawn state and exiting requires doing an alt-tab 
to the console. Opinions on the correct course of action to resolve this?

Thanks

Justin Chevrier


From juan.lang at gmail.com  Mon Mar 10 14:11:09 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Mon, 10 Mar 2008 12:11:09 -0700
Subject: DestroyWindow behavior differences between Win9x and Win2k/xp
In-Reply-To: <47D586C9.7010905@nexicom.net>
References: <47D586C9.7010905@nexicom.net>
Message-ID: <3a768c550803101211x6a8b69afgb9c95dcc9e7edf39@mail.gmail.com>

>  I'm looking into a crash of Master Of Orion II on exit (both in Wine and
>  Windows XP). The problem appears to be that the program is attempting to
>  do a DestroyWindow on a different thread. This is not allowed by our
>  code and that behavior is backed up by MSDN documentation. This behavior
>  was allowed on Windows 9x however. I have confirmed that removing the
>  thread check allows the app to exit cleanly, but of course that is not
>  an acceptable fix.

On the contrary, if Windows (in any version) allows it, and an app
depends on it, then we have to emulate it.  A test case that passes on
Win9x that demonstrates the problem is probably sufficient to show
that the check should be removed.

--Juan


From dank at kegel.com  Mon Mar 10 14:13:29 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 10 Mar 2008 12:13:29 -0700
Subject: DestroyWindow behavior differences between Win9x and Win2k/xp
Message-ID: <a71bd89a0803101213p3fc0e81do69dd503fbe9fec@mail.gmail.com>

Maybe writing a test showing that the cross-thread
behavior is required on win9x would be a good next step?


From jchevrier at nexicom.net  Mon Mar 10 14:17:40 2008
From: jchevrier at nexicom.net (Justin Chevrier)
Date: Mon, 10 Mar 2008 15:17:40 -0400
Subject: DestroyWindow behavior differences between Win9x and Win2k/xp
In-Reply-To: <3a768c550803101211x6a8b69afgb9c95dcc9e7edf39@mail.gmail.com>
References: <47D586C9.7010905@nexicom.net>
	<3a768c550803101211x6a8b69afgb9c95dcc9e7edf39@mail.gmail.com>
Message-ID: <47D58954.2030608@nexicom.net>

Juan Lang wrote:
>>  I'm looking into a crash of Master Of Orion II on exit (both in Wine and
>>  Windows XP). The problem appears to be that the program is attempting to
>>  do a DestroyWindow on a different thread. This is not allowed by our
>>  code and that behavior is backed up by MSDN documentation. This behavior
>>  was allowed on Windows 9x however. I have confirmed that removing the
>>  thread check allows the app to exit cleanly, but of course that is not
>>  an acceptable fix.
>>     
>
> On the contrary, if Windows (in any version) allows it, and an app
> depends on it, then we have to emulate it.  A test case that passes on
> Win9x that demonstrates the problem is probably sufficient to show
> that the check should be removed.
>
> --Juan
>
>
>
>   
Okay, that will be my next stop.

Thanks Juan and Dan.

Justin


From julliard at winehq.org  Mon Mar 10 14:18:38 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 10 Mar 2008 20:18:38 +0100
Subject: DestroyWindow behavior differences between Win9x and Win2k/xp
In-Reply-To: <3a768c550803101211x6a8b69afgb9c95dcc9e7edf39@mail.gmail.com>
	(Juan Lang's message of "Mon, 10 Mar 2008 12:11:09 -0700")
References: <47D586C9.7010905@nexicom.net>
	<3a768c550803101211x6a8b69afgb9c95dcc9e7edf39@mail.gmail.com>
Message-ID: <874pbee6b5.fsf@wine.dyndns.org>

"Juan Lang" <juan.lang at gmail.com> writes:

>>  I'm looking into a crash of Master Of Orion II on exit (both in Wine and
>>  Windows XP). The problem appears to be that the program is attempting to
>>  do a DestroyWindow on a different thread. This is not allowed by our
>>  code and that behavior is backed up by MSDN documentation. This behavior
>>  was allowed on Windows 9x however. I have confirmed that removing the
>>  thread check allows the app to exit cleanly, but of course that is not
>>  an acceptable fix.
>
> On the contrary, if Windows (in any version) allows it, and an app
> depends on it, then we have to emulate it.  A test case that passes on
> Win9x that demonstrates the problem is probably sufficient to show
> that the check should be removed.

If the app crashes on XP then it's fairly reasonable for it to crash on
Wine too. The Win9x design (or lack thereof) is not something we want to
support in general.

-- 
Alexandre Julliard
julliard at winehq.org


From jacek at codeweavers.com  Mon Mar 10 14:52:34 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Mon, 10 Mar 2008 20:52:34 +0100
Subject: Revert "mshtml: Use QueryService to get IHttpNegotiate
	in	get_post_data_stream."
In-Reply-To: <47D212DE.5080508@kievinfo.com>
References: <47D212DE.5080508@kievinfo.com>
Message-ID: <47D59182.3070002@codeweavers.com>

Hi Vitaliy,

Vitaliy Margolen wrote:
> This reverts commit c32cca8066807d09e3b953aee9242eba8cfa8cdb.
>
> This patch is obviously wrong since it broke Steam Community page.
>
This patch is obviously good and fixed a real problem, so the problem 
must be somewhere else. I would try to fix it, but Community tab works 
fine for me so I can't test it.


Jacek


From raccoonone at procyongames.com  Mon Mar 10 15:32:43 2008
From: raccoonone at procyongames.com (Christopher)
Date: Mon, 10 Mar 2008 13:32:43 -0700
Subject: make LoadStringW pass tests (fixed merge conflict)
In-Reply-To: <87fxv5j82l.fsf@wine.dyndns.org>
References: <47CEDF48.8090705@procyongames.com>	<22821af30803051005r2ab23be0p501aeb71841cc562@mail.gmail.com>	<47CEEF38.1040808@procyongames.com>
	<87fxv5j82l.fsf@wine.dyndns.org>
Message-ID: <47D59AEB.3050401@procyongames.com>

Alexandre Julliard wrote:
> Christopher <raccoonone at procyongames.com> writes:
>
>   
>> James Hawkins wrote:
>>     
>>> Why don't you just name the new parameter the same name as the
>>> function parameter ('buffer' or some variation)?  junkpointer is a
>>> terrible variable name.
>>>
>>>   
>>>       
>> sure, I will change it.
>>     
>
> Actually what you should do is take advantage of the fact that the
> pointer is returned to simplify the code and avoid a second LoadStringW
> call.
>
>   
Is there more work I need to do on this patch? I noticed that the new 
copy that I sent in, with the corrections that everyone suggested, still 
hasn't been accepted.

Christopher Berner


From zgs at seas.upenn.edu  Mon Mar 10 18:04:49 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Mon, 10 Mar 2008 23:04:49 +0000
Subject: Future Wine Weekly Newsletters
Message-ID: <b050a5e70803101604l40b45999xd4b2059d54a6414a@mail.gmail.com>

Wine,

I normally would like to have WWNs ready by Sunday night to be posted
on Monday but as you can tell i'm going to slip by a day or two again
this week.

A proposal was mentioned to me to make WWNs perhaps bi-weekly, either
coordinating with the week of releases or the off week.  This would
have a couple immediate pros and cons that I can see:

pros
*More articles and posts for me to sift through, pick out the more
important and relevent articles.  Slightly higher overall W(B)WN
quality.
*It'd be much easier for me to be on time with them.

cons
*Fewer wwns
*Perhaps slightly bigger wwns, i don't know what general consensus is
on preffered newsletter length


Thoughts?  Either way i'de like to have 343 ready and submitted
sometime tomorrow evening.

--Zach


From wine-devel at kievinfo.com  Mon Mar 10 20:31:48 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Mon, 10 Mar 2008 19:31:48 -0600
Subject: Revert "mshtml: Use QueryService to get IHttpNegotiate in
	get_post_data_stream."
In-Reply-To: <47D59182.3070002@codeweavers.com>
References: <47D212DE.5080508@kievinfo.com> <47D59182.3070002@codeweavers.com>
Message-ID: <47D5E104.9070000@kievinfo.com>

Jacek Caban wrote:
> Hi Vitaliy,
> 
> Vitaliy Margolen wrote:
>> This reverts commit c32cca8066807d09e3b953aee9242eba8cfa8cdb.
>>
>> This patch is obviously wrong since it broke Steam Community page.
>>
> This patch is obviously good and fixed a real problem, so the problem 
> must be somewhere else. I would try to fix it, but Community tab works 
> fine for me so I can't test it.
> 
It would be nice if you would have said something in the bug report.

It seems the problem caused by an empty content-length for the POST request. 
That might work for you because you are not behind the proxy. Proxies do not 
like that and return error. The question is then why does it work without 
your patch?

Vitaliy.


From wine-devel at kievinfo.com  Mon Mar 10 20:34:37 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Mon, 10 Mar 2008 19:34:37 -0600
Subject: DestroyWindow behavior differences between Win9x and Win2k/xp
In-Reply-To: <874pbee6b5.fsf@wine.dyndns.org>
References: <47D586C9.7010905@nexicom.net>	<3a768c550803101211x6a8b69afgb9c95dcc9e7edf39@mail.gmail.com>
	<874pbee6b5.fsf@wine.dyndns.org>
Message-ID: <47D5E1AD.5090809@kievinfo.com>

Alexandre Julliard wrote:
> "Juan Lang" <juan.lang at gmail.com> writes:
> 
>>>  I'm looking into a crash of Master Of Orion II on exit (both in Wine and
>>>  Windows XP). The problem appears to be that the program is attempting to
>>>  do a DestroyWindow on a different thread. This is not allowed by our
>>>  code and that behavior is backed up by MSDN documentation. This behavior
>>>  was allowed on Windows 9x however. I have confirmed that removing the
>>>  thread check allows the app to exit cleanly, but of course that is not
>>>  an acceptable fix.
>> On the contrary, if Windows (in any version) allows it, and an app
>> depends on it, then we have to emulate it.  A test case that passes on
>> Win9x that demonstrates the problem is probably sufficient to show
>> that the check should be removed.
> 
> If the app crashes on XP then it's fairly reasonable for it to crash on
> Wine too. The Win9x design (or lack thereof) is not something we want to
> support in general.
> 
Then we might as well remove "emulation" of all win versions and keep it at 
win2k. That's the whole point - if we have such a switch, we have to keep 
Wine compatible to that win version. If we can't, then we shouldn't even try 
to pretend. I'm not suggesting doing this for everything, but things like 
this do matter.

Vitaliy


From jjmckenzie51 at sprintpcs.com  Mon Mar 10 20:59:23 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Mon, 10 Mar 2008 18:59:23 -0700
Subject: Future Wine Weekly Newsletters
In-Reply-To: <b050a5e70803101604l40b45999xd4b2059d54a6414a@mail.gmail.com>
References: <b050a5e70803101604l40b45999xd4b2059d54a6414a@mail.gmail.com>
Message-ID: <47D5E77B.1010109@sprintpcs.com>

Zachary Goldberg wrote:
> Wine,
>
> I normally would like to have WWNs ready by Sunday night to be posted
> on Monday but as you can tell i'm going to slip by a day or two again
> this week.
>
> A proposal was mentioned to me to make WWNs perhaps bi-weekly, either
> coordinating with the week of releases or the off week.  This would
> have a couple immediate pros and cons that I can see:
>
> pros
> *More articles and posts for me to sift through, pick out the more
> important and relevent articles.  Slightly higher overall W(B)WN
> quality.
> *It'd be much easier for me to be on time with them.
>
> cons
> *Fewer wwns
> *Perhaps slightly bigger wwns, i don't know what general consensus is
> on preffered newsletter length
>
>
> Thoughts?  Either way i'de like to have 343 ready and submitted
> sometime tomorrow evening.
>
> --Zach
>
>
>   
Zach:

Bi-weekly is fine by me.  Would go with the release schedule.

James



From dank at kegel.com  Mon Mar 10 21:14:13 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 10 Mar 2008 19:14:13 -0700
Subject: Wine booth/BOF and Linuxworld San Francisco, Aug 2008?
Message-ID: <a71bd89a0803101914v628d0bc9l65880a6458b97633@mail.gmail.com>

Wine has come a long way, and will have just had its 1.0
release (knock on wood).  So perhaps this is a good year
to have a .org booth.  What do folks think?


From epssyis at gmail.com  Mon Mar 10 22:40:41 2008
From: epssyis at gmail.com (Edward Savage)
Date: Tue, 11 Mar 2008 13:40:41 +1000
Subject: Future Wine Weekly Newsletters
In-Reply-To: <47D5E77B.1010109@sprintpcs.com>
References: <b050a5e70803101604l40b45999xd4b2059d54a6414a@mail.gmail.com>
	<47D5E77B.1010109@sprintpcs.com>
Message-ID: <d6c5d7290803102040y4eb9d9b1mc979b2f6645f3555@mail.gmail.com>

I would like to see it kept at weekly.  To that end I'm happy to offer
my services as a co-editor.

Has any further thought happened over my suggestion of wikifying WWN
submissions so that the community can also submit storys on their
current projects.  If so I'm also happy to setup a list of clear rules
for it and the structure of the wiki page.

As always you can contact me any time via eps in the winehackers channel.

On Tue, Mar 11, 2008 at 11:59 AM, James McKenzie
<jjmckenzie51 at sprintpcs.com> wrote:
>
> Zachary Goldberg wrote:
>  > Wine,
>  >
>  > I normally would like to have WWNs ready by Sunday night to be posted
>  > on Monday but as you can tell i'm going to slip by a day or two again
>  > this week.
>  >
>  > A proposal was mentioned to me to make WWNs perhaps bi-weekly, either
>  > coordinating with the week of releases or the off week.  This would
>  > have a couple immediate pros and cons that I can see:
>  >
>  > pros
>  > *More articles and posts for me to sift through, pick out the more
>  > important and relevent articles.  Slightly higher overall W(B)WN
>  > quality.
>  > *It'd be much easier for me to be on time with them.
>  >
>  > cons
>  > *Fewer wwns
>  > *Perhaps slightly bigger wwns, i don't know what general consensus is
>  > on preffered newsletter length
>  >
>  >
>  > Thoughts?  Either way i'de like to have 343 ready and submitted
>  > sometime tomorrow evening.
>  >
>  > --Zach
>  >
>  >
>  >
>  Zach:
>
>  Bi-weekly is fine by me.  Would go with the release schedule.
>
>  James
>
>
>
>


From kai.blin at gmail.com  Tue Mar 11 02:37:48 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Tue, 11 Mar 2008 08:37:48 +0100
Subject: Wine booth/BOF and Linuxworld San Francisco, Aug 2008?
In-Reply-To: <a71bd89a0803101914v628d0bc9l65880a6458b97633@mail.gmail.com>
References: <a71bd89a0803101914v628d0bc9l65880a6458b97633@mail.gmail.com>
Message-ID: <200803110838.07439.kai.blin@gmail.com>

On Tuesday 11 March 2008 03:14:13 Dan Kegel wrote:
> Wine has come a long way, and will have just had its 1.0
> release (knock on wood).  So perhaps this is a good year
> to have a .org booth.  What do folks think?

We used to have a Wine booth at LinuxTag in Germany for many years. I know 
2007 didn't work out because neither Uwe Bonnes nor the itomic folks could 
make it. Still, those folks might be able to say something about how busy the 
Wine booth usually was.

Also, in my experience you need at least three people to man an expo booth.

I think a booth at Linuxworld would be nice publicity for Wine 1.0, but only 
if we can get our act together and have a sufficient number of people around 
to demo apps and answer questions.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080311/5c62a02b/attachment.pgp 

From julliard at winehq.org  Tue Mar 11 03:59:02 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 11 Mar 2008 09:59:02 +0100
Subject: DestroyWindow behavior differences between Win9x and Win2k/xp
In-Reply-To: <47D5E1AD.5090809@kievinfo.com> (Vitaliy Margolen's message of
	"Mon, 10 Mar 2008 19:34:37 -0600")
References: <47D586C9.7010905@nexicom.net>
	<3a768c550803101211x6a8b69afgb9c95dcc9e7edf39@mail.gmail.com>
	<874pbee6b5.fsf@wine.dyndns.org> <47D5E1AD.5090809@kievinfo.com>
Message-ID: <87y78pd4bt.fsf@wine.dyndns.org>

Vitaliy Margolen <wine-devel at kievinfo.com> writes:

> Alexandre Julliard wrote:
>> If the app crashes on XP then it's fairly reasonable for it to crash on
>> Wine too. The Win9x design (or lack thereof) is not something we want to
>> support in general.
>> 
> Then we might as well remove "emulation" of all win versions and keep it at 
> win2k. That's the whole point - if we have such a switch, we have to keep 
> Wine compatible to that win version. If we can't, then we shouldn't even try 
> to pretend. I'm not suggesting doing this for everything, but things like 
> this do matter.

We can be compatible up to a certain point, but there are some behaviors
of Win9x that we cannot possibly ever support. Memory management is one
example. That doesn't mean we should get rid of the version switch,
there are a ton of apps that are quite happy with our level of
compatibility.

-- 
Alexandre Julliard
julliard at winehq.org


From scott at open-vote.org  Tue Mar 11 04:00:28 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Tue, 11 Mar 2008 02:00:28 -0700
Subject: Wine booth/BOF and Linuxworld San Francisco, Aug 2008?
In-Reply-To: <200803110838.07439.kai.blin@gmail.com>
References: <a71bd89a0803101914v628d0bc9l65880a6458b97633@mail.gmail.com>
	<200803110838.07439.kai.blin@gmail.com>
Message-ID: <47D64A2C.7070807@open-vote.org>

Kai Blin wrote:
> On Tuesday 11 March 2008 03:14:13 Dan Kegel wrote:
>> Wine has come a long way, and will have just had its 1.0
>> release (knock on wood).  So perhaps this is a good year
>> to have a .org booth.  What do folks think?
> 
> We used to have a Wine booth at LinuxTag in Germany for many years. I know 
> 2007 didn't work out because neither Uwe Bonnes nor the itomic folks could 
> make it. Still, those folks might be able to say something about how busy the 
> Wine booth usually was.
> 
> Also, in my experience you need at least three people to man an expo booth.
> 
> I think a booth at Linuxworld would be nice publicity for Wine 1.0, but only 
> if we can get our act together and have a sufficient number of people around 
> to demo apps and answer questions.
> 

Living in the bay area, I volunteer myself to go.

Thanks,
Scott Ritchie


From julliard at winehq.org  Tue Mar 11 05:39:19 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 11 Mar 2008 11:39:19 +0100
Subject: [PATCH 3/5] shell32: use xdg well known directories for shell
	redirection (try 4)
In-Reply-To: <558b2f5c0803101959mb14b674r14d39f83c429a132@mail.gmail.com> (Lei
	Zhang's message of "Mon, 10 Mar 2008 19:59:14 -0700")
References: <558b2f5c0803101959mb14b674r14d39f83c429a132@mail.gmail.com>
Message-ID: <87pru1czoo.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> This patch attempts to set the shell folders using xdg well known
> directories via shell redirection. If any part of this fails, the rest
> of SHELL_RegisterShellFolders() should fill in the gaps.

This will still break if the user changes the drives config. I don't
understand why you don't want to simply use the symlinks; why should the
dirs be handled differently when they are obtained from the xdg config
instead of from the current hard-coded values?

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Tue Mar 11 06:10:29 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 11 Mar 2008 12:10:29 +0100
Subject: msi: Test the published installer properties
In-Reply-To: <22821af30803102100l13285e7au7de9c2872a4c8c@mail.gmail.com>
	(James Hawkins's message of "Mon, 10 Mar 2008 23:00:08 -0500")
References: <22821af30803102100l13285e7au7de9c2872a4c8c@mail.gmail.com>
Message-ID: <87lk4pcy8q.fsf@wine.dyndns.org>

"James Hawkins" <jhawkins at codeweavers.com> writes:

> rediffed with git.
>
> Changelog:
> * Test the published installer properties.

This is still failing for me:

../../../tools/runtest -q -P wine -M msi.dll -T ../../.. -p msi_test.exe.so install.c && touch install.ok
install.c:4484: Test failed: Expected ERROR_UNKNOWN_PRODUCT, got 0
make[2]: *** [install.ok] Error 1

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Tue Mar 11 06:34:00 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 11 Mar 2008 12:34:00 +0100
Subject: user32: Fix enumeration and add tests for EnumWindowStations and
	EnumDesktops, try X
In-Reply-To: <b130c85e0803101324y20b5c91bv45d156dd286d11af@mail.gmail.com>
	(Maarten Lankhorst's message of "Mon, 10 Mar 2008 13:24:27 -0700")
References: <b130c85e0803101324y20b5c91bv45d156dd286d11af@mail.gmail.com>
Message-ID: <87abl5cx5j.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> +static BOOL CALLBACK windowstationcallbackA(LPSTR winsta, LPARAM lp)
> +{
> +    trace("windowstationcallbackA called with argument %s\n", winsta);
> +    return lp;
> +}
> +
> +static BOOL CALLBACK openwindowstationcallbackA(LPSTR winsta, LPARAM lp)
> +{

Please use underscores to separate words in function names,
theselongstringswithoutspacesarepainfultoread.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Tue Mar 11 06:35:32 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 11 Mar 2008 12:35:32 +0100
Subject: [1/5] qmgr: Add infrastructure for background file transferring.
	[take 2]
In-Reply-To: <20080310233123.GA10236@linux.ucla.edu> (Dan Hipschman's message
	of "Mon, 10 Mar 2008 16:31:23 -0700")
References: <20080310233123.GA10236@linux.ucla.edu>
Message-ID: <8763vtcx2z.fsf@wine.dyndns.org>

Dan Hipschman <dsh at linux.ucla.edu> writes:

> +DWORD WINAPI fileTransfer(void *param)
> +{
> +    BackgroundCopyManagerImpl *qmgr = &globalMgr;
> +    BackgroundCopyJobImpl *job = NULL;
> +
> +    for (;;)
> +    {
> +        /* Note that other threads may add files to the job list, but only
> +           this thread ever deletes them so we don't need to worry about jobs
> +           magically disappearing from the list.  */
> +        EnterCriticalSection(&qmgr->cs);
> +        {
> +            struct list *next = (job
> +                                 ? list_next(&qmgr->jobs, &job->entryFromQmgr)
> +                                 : list_head(&qmgr->jobs));
> +            job = (next
> +                   ? LIST_ENTRY(next, BackgroundCopyJobImpl, entryFromQmgr)
> +                   : NULL);
> +        }
> +        LeaveCriticalSection(&qmgr->cs);
> +
> +        if (job)
> +        {
> +            /* It's fine to access the job state outside of the job's critical
> +               section in these cases because this thread is the only one that
> +               can change the state once it gets in one of these.  */
> +            if (job->state == BG_JOB_STATE_ACKNOWLEDGED || job->state == BG_JOB_STATE_CANCELLED)
> +            {
> +                EnterCriticalSection(&qmgr->cs);
> +                list_remove(&job->entryFromQmgr);
> +                job->lpVtbl->Release((IBackgroundCopyJob *) job);
> +                LeaveCriticalSection(&qmgr->cs);
> +                job = NULL;
> +            }
> +            else
> +            {
> +                /* Process job */
> +            }
> +        }
> +        else
> +            Sleep(1000);

You should use some sort of synchronization mechanism, not just poll the
list every second.

-- 
Alexandre Julliard
julliard at winehq.org


From jacek at codeweavers.com  Tue Mar 11 06:49:24 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Tue, 11 Mar 2008 12:49:24 +0100
Subject: Revert "mshtml: Use QueryService to get IHttpNegotiate in
	get_post_data_stream."
In-Reply-To: <47D5E104.9070000@kievinfo.com>
References: <47D212DE.5080508@kievinfo.com> <47D59182.3070002@codeweavers.com>
	<47D5E104.9070000@kievinfo.com>
Message-ID: <47D671C4.7010006@codeweavers.com>

Vitaliy Margolen wrote:
>
> It seems the problem caused by an empty content-length for the POST 
> request. That might work for you because you are not behind the proxy. 
> Proxies do not like that and return error.

Does attached hack help?

> The question is then why does it work without your patch?

My patch fixed regression due to changes in urlmon that caused post data 
to be never sent.


Jacek

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: fix_header.diff
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080311/4529909a/attachment-0001.txt 

From julliard at winehq.org  Tue Mar 11 06:28:01 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 11 Mar 2008 12:28:01 +0100
Subject: patch to fix bug 8246
In-Reply-To: <329440.1539.qm@web23102.mail.ird.yahoo.com> (Hin-Tak Leung's
	message of "Mon, 10 Mar 2008 22:58:02 +0000 (GMT)")
References: <329440.1539.qm@web23102.mail.ird.yahoo.com>
Message-ID: <87ejahcxfi.fsf@wine.dyndns.org>

Hin-Tak Leung <htl10 at users.sourceforge.net> writes:

> This is the fix to bug 8246 to get HtmlHelpW to work correctly. 
> It was first worked on by Andrey Turkin and updated later by me.  

Please add a proper log entry describing the change.

> -static inline LPWSTR strdupAtoW(LPCSTR str)
> +static inline LPWSTR strdupnAtoW(LPCSTR str, LONG l)
>  {
>      LPWSTR ret;
>      DWORD len;
> +    BOOL   zero_pad;
>  
>      if(!str)
>          return NULL;
>  
> -    len = MultiByteToWideChar(CP_ACP, 0, str, -1, NULL, 0);
> +    if (l>0)
> +    {
> +        LONG i;
> +        zero_pad = TRUE;
> +        for (i=0;i<l;i++)
> +        {
> +            if (!str[i])
> +            {
> +                zero_pad = FALSE;
> +                l = i+1;
> +                break;
> +            }
> +        }
> +    } else {
> +        zero_pad = FALSE;
> +    }
> +
> +    len = MultiByteToWideChar(CP_ACP, 0, str, l, NULL, 0);
> +    if (zero_pad)
> +        len++;

This is ugly and unnecessary, MultiByteToWideChar handles embedded nulls
just fine.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Tue Mar 11 07:00:33 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 11 Mar 2008 13:00:33 +0100
Subject: [PATCH 1/4] avifil32: Fix copy/paste error.
In-Reply-To: <47D61FA1.20805@codeweavers.com>
References: <47D61FA1.20805@codeweavers.com>
Message-ID: <200803111300.36909.stefan@codeweavers.com>

I think the patches suffer from mail client line wrapping, I cannot apply 
them:

patch -p1 < /dev/shm/kenpatch/\[PATCH\ 1_4\]\ avifil32\:\ Fix\ copy_paste\ 
error.
patching file dlls/avifil32/acmstream.c
patch: **** malformed patch at line 67: LONG start,

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080311/ba7c44a9/attachment.pgp 

From chad.harris2003 at gmail.com  Tue Mar 11 00:35:35 2008
From: chad.harris2003 at gmail.com (Chad Harris)
Date: Mon, 10 Mar 2008 22:35:35 -0700
Subject: compile fail on Linux Mint
Message-ID: <741a36fb0803102235t1da657acn9c3e3eceb56000a0@mail.gmail.com>

Hi guys.


Just tried to compile wine.. ( Yes, I know theres a package )  but sometimes
I'm sadistic enough to want to compile somethin.. and it just keeps
failing..  perhaps you can shed some light on what's goin' wrong?

Thanks

Chad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080310/8245e719/attachment.htm 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: config.log
Type: text/x-log
Size: 6745 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080310/8245e719/attachment.bin 

From andrey.turkin at gmail.com  Tue Mar 11 07:32:01 2008
From: andrey.turkin at gmail.com (Andrey Turkin)
Date: Tue, 11 Mar 2008 15:32:01 +0300
Subject: patch to fix bug 8246
In-Reply-To: <87ejahcxfi.fsf@wine.dyndns.org>
References: <329440.1539.qm@web23102.mail.ird.yahoo.com>
	<87ejahcxfi.fsf@wine.dyndns.org>
Message-ID: <f004deef0803110532s4de89b8bn3bea53b253a22d22@mail.gmail.com>

This is not about embedded nulls, this is about possibly not null terminated
strings. If there is zero somewhere in the buffer then we should only
convert string up to that zero; if there isn't any nulls, then we have to
convert full string and null-terminate string. This can be coded prettier,
though:

if (l>0)
{
     void *eos = memchr(str, 0, l);
     if (eos)
         l = (LONG)(eos-str);
}

and always zero-pad afterwards

2008/3/11, Alexandre Julliard <julliard at winehq.org>:
>
> Hin-Tak Leung <htl10 at users.sourceforge.net> writes:
>
> > This is the fix to bug 8246 to get HtmlHelpW to work correctly.
> > It was first worked on by Andrey Turkin and updated later by me.
>
>
> Please add a proper log entry describing the change.
>
> > -static inline LPWSTR strdupAtoW(LPCSTR str)
> > +static inline LPWSTR strdupnAtoW(LPCSTR str, LONG l)
> >  {
> >      LPWSTR ret;
> >      DWORD len;
> > +    BOOL   zero_pad;
> >
> >      if(!str)
> >          return NULL;
> >
> > -    len = MultiByteToWideChar(CP_ACP, 0, str, -1, NULL, 0);
> > +    if (l>0)
> > +    {
> > +        LONG i;
> > +        zero_pad = TRUE;
> > +        for (i=0;i<l;i++)
> > +        {
> > +            if (!str[i])
> > +            {
> > +                zero_pad = FALSE;
> > +                l = i+1;
> > +                break;
> > +            }
> > +        }
> > +    } else {
> > +        zero_pad = FALSE;
> > +    }
> > +
> > +    len = MultiByteToWideChar(CP_ACP, 0, str, l, NULL, 0);
> > +    if (zero_pad)
> > +        len++;
>
> This is ugly and unnecessary, MultiByteToWideChar handles embedded nulls
> just fine.
>
>
> --
> Alexandre Julliard
> julliard at winehq.org
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080311/ffa4a331/attachment.htm 

From rob at codeweavers.com  Tue Mar 11 07:36:33 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Tue, 11 Mar 2008 12:36:33 +0000
Subject: compile fail on Linux Mint
In-Reply-To: <741a36fb0803102235t1da657acn9c3e3eceb56000a0@mail.gmail.com>
References: <741a36fb0803102235t1da657acn9c3e3eceb56000a0@mail.gmail.com>
Message-ID: <47D67CD1.5050201@codeweavers.com>

Chad Harris wrote:
> Just tried to compile wine.. ( Yes, I know theres a package )  but 
> sometimes I'm sadistic enough to want to compile somethin.. and it 
> just keeps failing..  perhaps you can shed some light on what's goin' 
> wrong?

You need to install glibc and associated development libraries.

-- 
Rob Shearman



From meissner at suse.de  Tue Mar 11 08:43:36 2008
From: meissner at suse.de (Marcus Meissner)
Date: Tue, 11 Mar 2008 14:43:36 +0100
Subject: compile fail on Linux Mint
In-Reply-To: <741a36fb0803102235t1da657acn9c3e3eceb56000a0@mail.gmail.com>
References: <741a36fb0803102235t1da657acn9c3e3eceb56000a0@mail.gmail.com>
Message-ID: <20080311134335.GA1493@suse.de>

On Mon, Mar 10, 2008 at 10:35:35PM -0700, Chad Harris wrote:
> Hi guys.
> 
> 
> Just tried to compile wine.. ( Yes, I know theres a package )  but sometimes
> I'm sadistic enough to want to compile somethin.. and it just keeps
> failing..  perhaps you can shed some light on what's goin' wrong?
> 
> configure:2595: $? = 1
> configure:2618: checking for C compiler default output file name
> configure:2645: gcc    conftest.c  >&5
> /usr/bin/ld: crt1.o: No such file: No such file or directory
> collect2: ld returned 1 exit status

You are missing basic development libraries (glibc development files and headers).
There are like 20 - 30 more you will need.

I strongly suggest just to use the prepackaged binaries.

Ciao, Marcus


From ivan at etersoft.ru  Tue Mar 11 08:44:37 2008
From: ivan at etersoft.ru (Ivan Sinitsin)
Date: Tue, 11 Mar 2008 16:44:37 +0300
Subject: Question about function "HTMLDocument_write"
Message-ID: <200803111644.39716.ivan@etersoft.ru>

On Monday the patch realizing this function has been accepted. It works 
perfectly, but hyperlinks do not work.
If I makes this function that way:

static HRESULT WINAPI HTMLDocument_write(IHTMLDocument2 *iface, SAFEARRAY 
*psarray)
{
    HRESULT hres;
    VARIANT *pvar;
    IHTMLElement *pbody;
    BSTR vtext;
    int i;

    vtext = SysAllocString(L"");

    HTMLDocument_get_body(iface,&pbody);

    hres = IHTMLElement_get_innerHTML(pbody, &vtext);
    if (FAILED(hres)) {
        vtext = SysAllocString(L"");
    }

    hres=SafeArrayAccessData(psarray, (void **)&pvar);
    if (FAILED(hres)) return hres;
    for (i=0; i < psarray->rgsabound[0].cElements; i++) {
        hres = VarBstrCat(vtext, V_BSTR(&(pvar[i])), &vtext);
        if (FAILED(hres)) {
           break;
        }
    }

    IHTMLElement_put_innerHTML(pbody,vtext);
    SysFreeString(vtext);
    hres = SafeArrayUnaccessData(psarray);

    return S_OK;
}

hyperlinks works good.

Why so occurs?


From wine-devel at kievinfo.com  Tue Mar 11 08:31:03 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 11 Mar 2008 07:31:03 -0600
Subject: Revert "mshtml: Use QueryService to get IHttpNegotiate in
	get_post_data_stream."
In-Reply-To: <47D671C4.7010006@codeweavers.com>
References: <47D212DE.5080508@kievinfo.com> <47D59182.3070002@codeweavers.com>
	<47D5E104.9070000@kievinfo.com> <47D671C4.7010006@codeweavers.com>
Message-ID: <47D68997.3040404@kievinfo.com>

Jacek Caban wrote:
> Vitaliy Margolen wrote:
>>
>> It seems the problem caused by an empty content-length for the POST 
>> request. That might work for you because you are not behind the proxy. 
>> Proxies do not like that and return error.
> 
> Does attached hack help?

Yes it does fix the problem. Thank you. So then something inserts extra 
empty line(s) between header and the body? No wonder proxy doesn't like this 
- it is an equivalent of an empty reply.

Vitaliy.



From ben at atomnet.co.uk  Tue Mar 11 11:07:41 2008
From: ben at atomnet.co.uk (Ben Hodgetts (Enverex))
Date: Tue, 11 Mar 2008 16:07:41 +0000
Subject: compile fail on Linux Mint
In-Reply-To: <741a36fb0803102235t1da657acn9c3e3eceb56000a0@mail.gmail.com>
References: <741a36fb0803102235t1da657acn9c3e3eceb56000a0@mail.gmail.com>
Message-ID: <47D6AE4D.9000205@atomnet.co.uk>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Chad Harris wrote:
> Hi guys.

Please use the user-list in future or use the pre-compiled packages
until you're experienced with compiling programs, this is the Wine
development list.

Ben H.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFH1q5NuqCUopk11kIRAmWKAJ0UdQ1s+BFS4yUlEeMlOK1ZG4XBoQCdF93f
xm50wCaqQs9UoJzrd3vZyr4=
=VhRI
-----END PGP SIGNATURE-----


From truiken at gmail.com  Tue Mar 11 12:59:17 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 11 Mar 2008 12:59:17 -0500
Subject: msi: Test the published installer properties
In-Reply-To: <87lk4pcy8q.fsf@wine.dyndns.org>
References: <22821af30803102100l13285e7au7de9c2872a4c8c@mail.gmail.com>
	<87lk4pcy8q.fsf@wine.dyndns.org>
Message-ID: <22821af30803111059s71207447ja02204f2ba66e47b@mail.gmail.com>

On Tue, Mar 11, 2008 at 6:10 AM, Alexandre Julliard <julliard at winehq.org> wrote:
> "James Hawkins" <jhawkins at codeweavers.com> writes:
>
>  > rediffed with git.
>  >
>  > Changelog:
>  > * Test the published installer properties.
>
>  This is still failing for me:
>
>  ../../../tools/runtest -q -P wine -M msi.dll -T ../../.. -p msi_test.exe.so install.c && touch install.ok
>  install.c:4484: Test failed: Expected ERROR_UNKNOWN_PRODUCT, got 0
>  make[2]: *** [install.ok] Error 1
>

Just to narrow the possibilities, have you cleared your wineprefix
immediately before applying this patch and running the tests?

-- 
James Hawkins


From tehblunderbuss at gmail.com  Tue Mar 11 13:02:05 2008
From: tehblunderbuss at gmail.com (TheBlunderbuss)
Date: Tue, 11 Mar 2008 13:02:05 -0500
Subject: Thunderbird -- Colored Diffs
Message-ID: <47D6C91D.4070804@gmail.com>

This may have been out there for a while, but I'd thought I'd mention it 
anyway.
Colored Diffs is an extension for you Thunderbird users out there that 
makes it easier to read those diffs, even when they're part of the email 
message itself.
I was happily surprised at the functionality :)

https://addons.mozilla.org/en-US/thunderbird/addon/4268


From skorka at gmx.net  Tue Mar 11 13:21:32 2008
From: skorka at gmx.net (Daniel)
Date: Tue, 11 Mar 2008 19:21:32 +0100
Subject: Something that might be useful for the D3D guys
Message-ID: <20080311182132.GA4572@iapetus.hadiko.de>

Hello there,

while stumbling through the net today, I came upon this [1] little tool.
It will, among other things, allow you to run apps that are overly picky
about the level of hardware support your graphic card offers. I found
that some things (like disabling textures, forcing wireframe mode) work
in wine 0.9.56 as well, whereas things like lying about the shaders
seems to fail. Perhaps it can be of some use to those who have to deal
with D3D.

regards,
Daniel


[1] http://www.tommti-systems.com/main-Dateien/files.html (3D-Analyze,
click on the image)
-- 
'God is omnipotent, omniscient, and omnibenevolent [...]
If you have a mind capable of believing all three of these attributes
simultaneously, I have a wonderful bargain for you. No checks, please.
Cash and in small bills.' -- Robert Heinlein, "Notebooks of Lazarus Long"


From xerox_xerox2000 at yahoo.co.uk  Tue Mar 11 13:37:40 2008
From: xerox_xerox2000 at yahoo.co.uk (Louis. Lenders)
Date: Tue, 11 Mar 2008 18:37:40 +0000 (GMT)
Subject: improve winetricks dotnet 1.1
Message-ID: <332226.9387.qm@web23204.mail.ird.yahoo.com>

Hi, i wonder if it would be possible to improve winetricks dotnet 1.1, so that it's actually able to run
.net-1.1 applications. Currently it only installs the framework, but due to bugs the apps don't run. Atm  moment i use pretty worthless script below to get them running, but i'm sure one of the winetricks hackers could turn this into a nice script

Note, the dlls gdiplus and mscoree should be set to native only, not (native, builtin), so override_dll should look tiny bit different then in winetricks.








      __________________________________________________________
Sent from Yahoo! Mail.
The World's Favourite Email http://uk.docs.yahoo.com/nowyoucan.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080311/b3d96c7b/attachment.htm 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: worthless_script.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080311/b3d96c7b/attachment.txt 

From julliard at winehq.org  Tue Mar 11 13:46:11 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 11 Mar 2008 19:46:11 +0100
Subject: [PATCH 3/5] shell32: use xdg well known directories for shell
	redirection (try 4)
In-Reply-To: <558b2f5c0803111138j851c897t75723d09dccccfc0@mail.gmail.com> (Lei
	Zhang's message of "Tue, 11 Mar 2008 11:38:00 -0700")
References: <558b2f5c0803101959mb14b674r14d39f83c429a132@mail.gmail.com>
	<87pru1czoo.fsf@wine.dyndns.org>
	<558b2f5c0803111138j851c897t75723d09dccccfc0@mail.gmail.com>
Message-ID: <87wso9ayks.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> We ran into a problem with Picasa and directory scanning. It looks
> like an issue with FindFirstChange/FindNextChange and overlapping
> directories, so I'm trying to use shell redirection to avoid the
> problem. Perhaps we should fix the problem with
> FindFirstChange/FindNextChange rather than avoid it.

We should at least understand what the problem is. And if it turns out
that we have to use shell redirection, then we want to do that in all
cases, it shouldn't be specific to the xdg case.

> I'll resubmit the patches without the shell redirection code.

Thanks.

-- 
Alexandre Julliard
julliard at winehq.org


From thestig at google.com  Tue Mar 11 13:38:00 2008
From: thestig at google.com (Lei Zhang)
Date: Tue, 11 Mar 2008 11:38:00 -0700
Subject: [PATCH 3/5] shell32: use xdg well known directories for shell
	redirection (try 4)
In-Reply-To: <87pru1czoo.fsf@wine.dyndns.org>
References: <558b2f5c0803101959mb14b674r14d39f83c429a132@mail.gmail.com>
	<87pru1czoo.fsf@wine.dyndns.org>
Message-ID: <558b2f5c0803111138j851c897t75723d09dccccfc0@mail.gmail.com>

On Tue, Mar 11, 2008 at 3:39 AM, Alexandre Julliard <julliard at winehq.org> wrote:
> "Lei Zhang" <thestig at google.com> writes:
>
>  > This patch attempts to set the shell folders using xdg well known
>  > directories via shell redirection. If any part of this fails, the rest
>  > of SHELL_RegisterShellFolders() should fill in the gaps.
>
>  This will still break if the user changes the drives config. I don't
>  understand why you don't want to simply use the symlinks; why should the
>  dirs be handled differently when they are obtained from the xdg config
>  instead of from the current hard-coded values?
>
>  --
>  Alexandre Julliard
>  julliard at winehq.org
>

We ran into a problem with Picasa and directory scanning. It looks
like an issue with FindFirstChange/FindNextChange and overlapping
directories, so I'm trying to use shell redirection to avoid the
problem. Perhaps we should fix the problem with
FindFirstChange/FindNextChange rather than avoid it.

I'll resubmit the patches without the shell redirection code.


From htl10 at users.sourceforge.net  Tue Mar 11 14:10:52 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Tue, 11 Mar 2008 19:10:52 +0000 (GMT)
Subject: patch to fix bug 8246
In-Reply-To: <f004deef0803110532s4de89b8bn3bea53b253a22d22@mail.gmail.com>
Message-ID: <159054.46539.qm@web23112.mail.ird.yahoo.com>

I did wonder what the padding was about (it didn't do any harm...) - 
I'll be happy to rework it to make it acceptable.

--- Andrey Turkin <andrey.turkin at gmail.com> wrote:

> This is not about embedded nulls, this is about possibly not null terminated
> strings. If there is zero somewhere in the buffer then we should only
> convert string up to that zero; if there isn't any nulls, then we have to
> convert full string and null-terminate string. This can be coded prettier,
> though:
> 
> if (l>0)
> {
>      void *eos = memchr(str, 0, l);
>      if (eos)
>          l = (LONG)(eos-str);
> }
> 
> and always zero-pad afterwards
> 
> 2008/3/11, Alexandre Julliard <julliard at winehq.org>:
> >
> > Hin-Tak Leung <htl10 at users.sourceforge.net> writes:
> >
> > > This is the fix to bug 8246 to get HtmlHelpW to work correctly.
> > > It was first worked on by Andrey Turkin and updated later by me.
> >
> >
> > Please add a proper log entry describing the change.
> >
> > > -static inline LPWSTR strdupAtoW(LPCSTR str)
> > > +static inline LPWSTR strdupnAtoW(LPCSTR str, LONG l)
> > >  {
> > >      LPWSTR ret;
> > >      DWORD len;
> > > +    BOOL   zero_pad;
> > >
> > >      if(!str)
> > >          return NULL;
> > >
> > > -    len = MultiByteToWideChar(CP_ACP, 0, str, -1, NULL, 0);
> > > +    if (l>0)
> > > +    {
> > > +        LONG i;
> > > +        zero_pad = TRUE;
> > > +        for (i=0;i<l;i++)
> > > +        {
> > > +            if (!str[i])
> > > +            {
> > > +                zero_pad = FALSE;
> > > +                l = i+1;
> > > +                break;
> > > +            }
> > > +        }
> > > +    } else {
> > > +        zero_pad = FALSE;
> > > +    }
> > > +
> > > +    len = MultiByteToWideChar(CP_ACP, 0, str, l, NULL, 0);
> > > +    if (zero_pad)
> > > +        len++;
> >
> > This is ugly and unnecessary, MultiByteToWideChar handles embedded nulls
> > just fine.
> >
> >
> > --
> > Alexandre Julliard
> > julliard at winehq.org
> >
> >
> >
> 



      ___________________________________________________________ 
Rise to the challenge for Sport Relief with Yahoo! For Good  

http://uk.promotions.yahoo.com/forgood/


From stefan at codeweavers.com  Tue Mar 11 14:32:59 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 11 Mar 2008 20:32:59 +0100
Subject: Something that might be useful for the D3D guys
In-Reply-To: <20080311182132.GA4572@iapetus.hadiko.de>
References: <20080311182132.GA4572@iapetus.hadiko.de>
Message-ID: <200803112033.03817.stefan@codeweavers.com>

Am Dienstag, 11. M?rz 2008 19:21:32 schrieb Daniel:
> Hello there,
>
> while stumbling through the net today, I came upon this [1] little tool.
> It will, among other things, allow you to run apps that are overly picky
> about the level of hardware support your graphic card offers. I found
> that some things (like disabling textures, forcing wireframe mode) work
> in wine 0.9.56 as well, whereas things like lying about the shaders
> seems to fail. Perhaps it can be of some use to those who have to deal
> with D3D.
I've come across that tool before, and it could be useful for verifying some 
capability flag problems on Windows. As far as Wine is concerned, we can 
archive all the tool does by modifying the WineD3D code.

At some point it would be cool to have a D3D9 thunk that thunks to D3D9, to 
have a sort of function hooking DLL, where we can trace all D3D9 calls on 
Windows, and modify their behavior.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080311/658429ed/attachment.pgp 

From dank at kegel.com  Tue Mar 11 15:15:15 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 11 Mar 2008 13:15:15 -0700
Subject: improve winetricks dotnet 1.1
Message-ID: <a71bd89a0803111315m6812e01fqb30a2663b30f05d3@mail.gmail.com>

Louis wrote:
> Hi, i wonder if it would be possible to improve
> winetricks dotnet 1.1, so that it's actually able to run
>.net-1.1 applications. Currently it only installs the framework,
> but due to bugs the apps don't run.   Atm i use pretty worthless
> script below to get them running..

I'm kind of hoping James implements the missing bits in msi
soon.  James, think that will happen soon enough that
there's no need to update winetricks?

> Note, the dlls gdiplus and mscoree should be set to native only, not (native, builtin), so override_dll should look tiny bit different then in winetricks.

Ah, good point.
- Dan


From wine.dev at web.de  Tue Mar 11 16:16:11 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Tue, 11 Mar 2008 22:16:11 +0100
Subject: compile fail on Linux Mint
In-Reply-To: <741a36fb0803102235t1da657acn9c3e3eceb56000a0@mail.gmail.com>
References: <741a36fb0803102235t1da657acn9c3e3eceb56000a0@mail.gmail.com>
Message-ID: <1205270171.7330.8.camel@p4>

On Mo, 2008-03-10 at 22:35 -0700, Chad Harris wrote:
> /usr/bin/ld: crt1.o: No such file: No such file or directory

You are missing the development-packages.

The first is "libc6-dev"

http://wiki.winehq.org/Recommended_Packages


-- 
 
By by ... Detlef




From jacek at codeweavers.com  Tue Mar 11 16:37:11 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Tue, 11 Mar 2008 22:37:11 +0100
Subject: Revert "mshtml: Use QueryService to get IHttpNegotiate
	in	get_post_data_stream."
In-Reply-To: <47D68997.3040404@kievinfo.com>
References: <47D212DE.5080508@kievinfo.com>
	<47D59182.3070002@codeweavers.com>	<47D5E104.9070000@kievinfo.com>
	<47D671C4.7010006@codeweavers.com> <47D68997.3040404@kievinfo.com>
Message-ID: <47D6FB87.8000809@codeweavers.com>

Vitaliy Margolen wrote:
> Yes it does fix the problem. Thank you. So then something inserts extra 
> empty line(s) between header and the body? No wonder proxy doesn't like this 
> - it is an equivalent of an empty reply.
>   
Gecko reported in header content with length 0 (because of this empty 
line) and it caused problem for proxy. I've sent a patch to wine-patches.

Jacek


From leslie_alistair at hotmail.com  Tue Mar 11 18:13:42 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Wed, 12 Mar 2008 10:13:42 +1100
Subject: Bugzilla Privs
Message-ID: <fr73mq$enr$1@ger.gmane.org>

Hi,
  Can I please get Privs on Bugzilla to help with the msxml work I am doing?

Best Regards
 Alistair Leslie-Hughes 




From truiken at gmail.com  Tue Mar 11 18:16:48 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 11 Mar 2008 18:16:48 -0500
Subject: improve winetricks dotnet 1.1
In-Reply-To: <a71bd89a0803111315m6812e01fqb30a2663b30f05d3@mail.gmail.com>
References: <a71bd89a0803111315m6812e01fqb30a2663b30f05d3@mail.gmail.com>
Message-ID: <22821af30803111616s3a37347l1d63ec8b74cb0470@mail.gmail.com>

On Tue, Mar 11, 2008 at 3:15 PM, Dan Kegel <dank at kegel.com> wrote:
> Louis wrote:
>  > Hi, i wonder if it would be possible to improve
>  > winetricks dotnet 1.1, so that it's actually able to run
>  >.net-1.1 applications. Currently it only installs the framework,
>  > but due to bugs the apps don't run.   Atm i use pretty worthless
>  > script below to get them running..
>
>  I'm kind of hoping James implements the missing bits in msi
>  soon.  James, think that will happen soon enough that
>  there's no need to update winetricks?
>

Just sent in the service patch.  If you're referring to anything else,
I'm not sure what it is.  MsiPublishAssemblies won't see the light of
day for a long, long time, because it requires fusion.dll being
implemented.

-- 
James Hawkins


From dank at kegel.com  Tue Mar 11 18:18:06 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 11 Mar 2008 16:18:06 -0700
Subject: improve winetricks dotnet 1.1
In-Reply-To: <22821af30803111616s3a37347l1d63ec8b74cb0470@mail.gmail.com>
References: <a71bd89a0803111315m6812e01fqb30a2663b30f05d3@mail.gmail.com>
	<22821af30803111616s3a37347l1d63ec8b74cb0470@mail.gmail.com>
Message-ID: <a71bd89a0803111618x105a952cv6345582020bf809a@mail.gmail.com>

On Tue, Mar 11, 2008 at 4:16 PM, James Hawkins <truiken at gmail.com> wrote:
>  MsiPublishAssemblies won't see the light of
>  day for a long, long time, because it requires fusion.dll being
>  implemented.

OK, I guess I'll roll the kludge into crosstool.

Thanks,
Dan


From truiken at gmail.com  Tue Mar 11 18:47:50 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 11 Mar 2008 18:47:50 -0500
Subject: improve winetricks dotnet 1.1
In-Reply-To: <22821af30803111616s3a37347l1d63ec8b74cb0470@mail.gmail.com>
References: <a71bd89a0803111315m6812e01fqb30a2663b30f05d3@mail.gmail.com>
	<22821af30803111616s3a37347l1d63ec8b74cb0470@mail.gmail.com>
Message-ID: <22821af30803111647q216e77e5vabbc5f2a301e7bc8@mail.gmail.com>

On Tue, Mar 11, 2008 at 6:16 PM, James Hawkins <truiken at gmail.com> wrote:
> On Tue, Mar 11, 2008 at 3:15 PM, Dan Kegel <dank at kegel.com> wrote:
>  > Louis wrote:
>  >  > Hi, i wonder if it would be possible to improve
>  >  > winetricks dotnet 1.1, so that it's actually able to run
>  >  >.net-1.1 applications. Currently it only installs the framework,
>  >  > but due to bugs the apps don't run.   Atm i use pretty worthless
>  >  > script below to get them running..
>  >
>  >  I'm kind of hoping James implements the missing bits in msi
>  >  soon.  James, think that will happen soon enough that
>  >  there's no need to update winetricks?
>  >
>
>  Just sent in the service patch.  If you're referring to anything else,
>  I'm not sure what it is.  MsiPublishAssemblies won't see the light of
>  day for a long, long time, because it requires fusion.dll being
>  implemented.
>

For the record, if I were a millionaire, this is what I would work on :)

http://msdn2.microsoft.com/en-us/library/ms404523(VS.85).aspx

-- 
James Hawkins


From dank at kegel.com  Tue Mar 11 20:14:26 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 11 Mar 2008 18:14:26 -0700
Subject: Can we have a server component in bugzilla?
Message-ID: <a71bd89a0803111814m6df67951tc42c4afbe2c8d3c@mail.gmail.com>

There have been several server-related bugs
lately, yet we have no server component.
Seems like we need one.


From truiken at gmail.com  Tue Mar 11 21:21:50 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 11 Mar 2008 21:21:50 -0500
Subject: Can we have a server component in bugzilla?
In-Reply-To: <a71bd89a0803111814m6df67951tc42c4afbe2c8d3c@mail.gmail.com>
References: <a71bd89a0803111814m6df67951tc42c4afbe2c8d3c@mail.gmail.com>
Message-ID: <22821af30803111921n4323505an66f300a3822bc3be@mail.gmail.com>

On Tue, Mar 11, 2008 at 8:14 PM, Dan Kegel <dank at kegel.com> wrote:
> There have been several server-related bugs
>  lately, yet we have no server component.
>  Seems like we need one.
>

server as in winehq.org or wineserver?

-- 
James Hawkins


From dank at kegel.com  Tue Mar 11 22:47:53 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 11 Mar 2008 20:47:53 -0700
Subject: Can we have a server component in bugzilla?
In-Reply-To: <22821af30803111921n4323505an66f300a3822bc3be@mail.gmail.com>
References: <a71bd89a0803111814m6df67951tc42c4afbe2c8d3c@mail.gmail.com>
	<22821af30803111921n4323505an66f300a3822bc3be@mail.gmail.com>
Message-ID: <a71bd89a0803112047r1314d72egd7790d6c0c623427@mail.gmail.com>

On Tue, Mar 11, 2008 at 7:21 PM, James Hawkins <truiken at gmail.com> wrote:
>  > There have been several server-related bugs
>  >  lately, yet we have no server component.
>  >  Seems like we need one.
>
>  server as in winehq.org or wineserver?

As in wineserver.  We already have a winehq.org category, kind of.


From ead1234 at hotmail.com  Tue Mar 11 23:40:26 2008
From: ead1234 at hotmail.com (EA Durbin)
Date: Tue, 11 Mar 2008 23:40:26 -0500
Subject: FW: bug 6311 1.0 - wineserver regression
In-Reply-To: <a71bd89a0803111813o560159der72755abf21b75e1e@mail.gmail.com>
References: <BAY128-W155CB32B5D03500E8A9F88AB080@phx.gbl>
	<a71bd89a0803111813o560159der72755abf21b75e1e@mail.gmail.com>
Message-ID: <BAY128-W15FC2BBD80CB3B7A171171AB080@phx.gbl>


Could someone familiar with wineserver take a look at this please?

I've narrowed down the cause of this regression in bugzilla within the commit itself, but I don't know the proper fix.

----------------------------------------
> Date: Tue, 11 Mar 2008 18:13:48 -0700
> From: dank at kegel.com
> To: ead1234 at hotmail.com
> Subject: Re: bug 6311 1.0
> 
> On Tue, Mar 11, 2008 at 6:10 PM, EA Durbin  wrote:
>>  Can we add bug 6311 to the 1.0 bugs?
>> 5948 was on the list but it is closed now.
>>There was a regression recently and it's broken again.
> 
> Make some noise on the list about those bugs.
> 
> Being on the 1.0 list isn't really that helpful.

_________________________________________________________________
Need to know the score, the latest news, or you need your Hotmail?-get your "fix".
http://www.msnmobilefix.com/Default.aspx

From ead1234 at hotmail.com  Wed Mar 12 01:22:54 2008
From: ead1234 at hotmail.com (EA Durbin)
Date: Wed, 12 Mar 2008 01:22:54 -0500
Subject: bug 6311 1.0 - wineserver regression
In-Reply-To: <BAY128-W15FC2BBD80CB3B7A171171AB080@phx.gbl>
References: <BAY128-W155CB32B5D03500E8A9F88AB080@phx.gbl>
	<a71bd89a0803111813o560159der72755abf21b75e1e@mail.gmail.com> 
	<BAY128-W15FC2BBD80CB3B7A171171AB080@phx.gbl>
Message-ID: <BAY128-W4697F208CD044F916A2711AB080@phx.gbl>


Disregard, I think I've found the problem and I'm sending a patch.
----------------------------------------
> From: ead1234 at hotmail.com
> To: wine-devel at winehq.org
> Subject: FW: bug 6311 1.0 - wineserver regression
> Date: Tue, 11 Mar 2008 23:40:26 -0500
> 
> 
> Could someone familiar with wineserver take a look at this please?
> 
> I've narrowed down the cause of this regression in bugzilla within the commit itself, but I don't know the proper fix.
> 
> ----------------------------------------
>> Date: Tue, 11 Mar 2008 18:13:48 -0700
>> From: dank at kegel.com
>> To: ead1234 at hotmail.com
>> Subject: Re: bug 6311 1.0
>> 
>> On Tue, Mar 11, 2008 at 6:10 PM, EA Durbin  wrote:
>>>  Can we add bug 6311 to the 1.0 bugs?
>>> 5948 was on the list but it is closed now.
>>>There was a regression recently and it's broken again.
>> 
>> Make some noise on the list about those bugs.
>> 
>> Being on the 1.0 list isn't really that helpful.
> 
> _________________________________________________________________
> Need to know the score, the latest news, or you need your Hotmail?-get your "fix".
> http://www.msnmobilefix.com/Default.aspx
> 

_________________________________________________________________
Helping your favorite cause is as easy as instant messaging.?You IM, we give.
http://im.live.com/Messenger/IM/Home/?source=text_hotmail_join

From truiken at gmail.com  Wed Mar 12 02:05:06 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 12 Mar 2008 02:05:06 -0500
Subject: Can we have a server component in bugzilla?
In-Reply-To: <a71bd89a0803112047r1314d72egd7790d6c0c623427@mail.gmail.com>
References: <a71bd89a0803111814m6df67951tc42c4afbe2c8d3c@mail.gmail.com>
	<22821af30803111921n4323505an66f300a3822bc3be@mail.gmail.com>
	<a71bd89a0803112047r1314d72egd7790d6c0c623427@mail.gmail.com>
Message-ID: <22821af30803120005u5e13cafic41525a80a8b48c9@mail.gmail.com>

On Tue, Mar 11, 2008 at 10:47 PM, Dan Kegel <dank at kegel.com> wrote:
> On Tue, Mar 11, 2008 at 7:21 PM, James Hawkins <truiken at gmail.com> wrote:
>  >  > There have been several server-related bugs
>  >  >  lately, yet we have no server component.
>  >  >  Seems like we need one.
>  >
>  >  server as in winehq.org or wineserver?
>
>  As in wineserver.  We already have a winehq.org category, kind of.
>

There is a wineserver component.

-- 
James Hawkins


From ken at codeweavers.com  Wed Mar 12 02:08:39 2008
From: ken at codeweavers.com (Ken Thomases)
Date: Wed, 12 Mar 2008 02:08:39 -0500
Subject: [PATCH 1/4] avifil32: Fix copy/paste error.
In-Reply-To: <200803111300.36909.stefan@codeweavers.com>
References: <47D61FA1.20805@codeweavers.com>
	<200803111300.36909.stefan@codeweavers.com>
Message-ID: <ACC020FF-138B-4DCA-B9A8-6291C3B1E34E@codeweavers.com>

On Mar 11, 2008, at 7:00 AM, Stefan D?singer wrote:

> I think the patches suffer from mail client line wrapping

Huh.  I specifically switched to Thunderbird to send them because I  
thought it wouldn't do that.

Anyway, I've resent them using the --attach option for git-format- 
patch.  Thanks for bringing this to my attention.

Cheers,
Ken



From twickline at gmail.com  Wed Mar 12 02:55:21 2008
From: twickline at gmail.com (Tom Wickline)
Date: Wed, 12 Mar 2008 03:55:21 -0400
Subject: Free apps bundled with msvcp71?
In-Reply-To: <a71bd89a0803021832m1a3ffda2m5402cf57f2264572@mail.gmail.com>
References: <a71bd89a0803021832m1a3ffda2m5402cf57f2264572@mail.gmail.com>
Message-ID: <53e3a9930803120055k60847f60u277ea47e84b83ba@mail.gmail.com>

Hello Dan,

MSVCP71.dll is the MS Visual C++ 7.1 Runtime Library (which comes with
.NET 2003).

see: http://msdn2.microsoft.com/en-gb/vbasic/ms789141.aspx  for some info,

The Visual C++ Toolkit 2003 also bundles MSVCP71.dll and MSVCR71.dll
see: http://xona.com/2004/06/29.html

The Toolkit can be downloaded from xona at :
http://xona.com/programs/VCToolkitSetup(v1.01)(2004.07.06).zip (29.9
MB)

I know this isn't a direct MS download but it might help in further
investigation :D

Cheers,

Tom

On Sun, Mar 2, 2008 at 10:32 PM, Dan Kegel <dank at kegel.com> wrote:
> Adobe Contribute 4, released in Nov 2006 or so, had a nice online trial at
>  http://trials.adobe.com/Applications/Contribute/Adobe_Contribute_4_Win/Adobe_Contribute_4_Win.exe
>  and still online, I think, at
>  http://www.soft32.com/download/63-129953-1/Adobe_Contribute_4_Win.exe
>
>  Starting it fails with
>
>  err:module:import_dll Library MSVCP71.dll (which is needed by
>  L"C:\\Program Files\\Adobe\\Contribute 4\\CoreTypes.dll") not found
>
>  Wine has a nice implementation of msvcr71.dll, but not
>  the C++-oriented msvcp71.dll, nor is it likely to get one soon.
>
>  This brings back the question: what's a good place to
>  legally and freely download an application bundled with a full set
>  of msvcp71.dll et al?  Ideally something at Microsoft.com
>  and/or something small and suitable for use in winetricks.
>  Any ideas?
>  - Dan
>
>
>


From mstefani at redhat.com  Wed Mar 12 04:53:30 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 12 Mar 2008 10:53:30 +0100
Subject: improve winetricks dotnet 1.1
In-Reply-To: <22821af30803111616s3a37347l1d63ec8b74cb0470@mail.gmail.com>
References: <a71bd89a0803111315m6812e01fqb30a2663b30f05d3@mail.gmail.com>
	<22821af30803111616s3a37347l1d63ec8b74cb0470@mail.gmail.com>
Message-ID: <47D7A81A.6040002@redhat.com>

James Hawkins wrote:
> On Tue, Mar 11, 2008 at 3:15 PM, Dan Kegel <dank at kegel.com> wrote:
>> Louis wrote:
>>  > Hi, i wonder if it would be possible to improve
>>  > winetricks dotnet 1.1, so that it's actually able to run
>>  >.net-1.1 applications. Currently it only installs the framework,
>>  > but due to bugs the apps don't run.   Atm i use pretty worthless
>>  > script below to get them running..
>>
>>  I'm kind of hoping James implements the missing bits in msi
>>  soon.  James, think that will happen soon enough that
>>  there's no need to update winetricks?
>>
> 
> Just sent in the service patch.  If you're referring to anything else,
> I'm not sure what it is.  MsiPublishAssemblies won't see the light of
> day for a long, long time, because it requires fusion.dll being
> implemented.
Implementing fusion.dll sounds like a GSoC project to me (no clue how
much work that is). At least getting the basic structure in place should
be doable.

bye
	michael
-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Hauptst?tter Strasse 58, 70178 Stuttgart
Handelsregister: Amtsgericht Stuttgart HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                 Werner Knoblich


From rob at codeweavers.com  Wed Mar 12 04:57:36 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 12 Mar 2008 09:57:36 +0000
Subject: Hans Leidekker : wininet:	Make sure not to overwrite any caller
	supplied authorization header.
In-Reply-To: <E1JM2XT-0000cU-JC@wine.codeweavers.com>
References: <E1JM2XT-0000cU-JC@wine.codeweavers.com>
Message-ID: <47D7A910.9020107@codeweavers.com>

Alexandre Julliard wrote:
> Module: wine
> Branch: master
> Commit: b069ef4268e7056856ce6714714d929165f24fc8
> URL:    http://source.winehq.org/git/wine.git/?a=commit;h=b069ef4268e7056856ce6714714d929165f24fc8
>
> Author: Hans Leidekker <hans at it.vu.nl>
> Date:   Fri Feb  1 14:40:15 2008 +0100
>
> wininet: Make sure not to overwrite any caller supplied authorization header.
>
> ---
>
>  dlls/wininet/http.c       |   36 ++++++++++--------------------------
>  dlls/wininet/tests/http.c |    5 ++++-
>  2 files changed, 14 insertions(+), 27 deletions(-)
>
> diff --git a/dlls/wininet/http.c b/dlls/wininet/http.c
> index 65b86fb..a339c86 100644
> --- a/dlls/wininet/http.c
> +++ b/dlls/wininet/http.c
> @@ -1187,9 +1187,11 @@ static UINT HTTP_DecodeBase64( LPCWSTR base64, LPSTR bin )
>   *
>   *   Insert or delete the authorization field in the request header.
>   */
> -static BOOL HTTP_InsertAuthorizationForHeader( LPWININETHTTPREQW lpwhr, struct HttpAuthInfo *pAuthInfo, LPCWSTR header )
> +static BOOL HTTP_InsertAuthorization( LPWININETHTTPREQW lpwhr, LPCWSTR header, BOOL first )
>  {
>      WCHAR *authorization = NULL;
> +    struct HttpAuthInfo *pAuthInfo = lpwhr->pAuthInfo;
> +    DWORD flags;
>  
>      if (pAuthInfo && pAuthInfo->auth_data_len)
>      {
> @@ -1222,35 +1224,17 @@ static BOOL HTTP_InsertAuthorizationForHeader( LPWININETHTTPREQW lpwhr, struct H
>  
>      TRACE("Inserting authorization: %s\n", debugstr_w(authorization));
>  
> -    HTTP_ProcessHeader(lpwhr, header, authorization,
> -                       HTTP_ADDHDR_FLAG_REPLACE | HTTP_ADDHDR_FLAG_REQ);
> +    /* make sure not to overwrite any caller supplied authorization header */
> +    flags = HTTP_ADDHDR_FLAG_REQ;
> +    flags |= first ? HTTP_ADDHDR_FLAG_ADD_IF_NEW : HTTP_ADDHDR_FLAG_REPLACE;
>  
> -    HeapFree(GetProcessHeap(), 0, authorization);
> +    HTTP_ProcessHeader(lpwhr, header, authorization, flags);
>  
> +    HeapFree(GetProcessHeap(), 0, authorization);
>      return TRUE;
>  }
>  
>  /***********************************************************************
> - *  HTTP_InsertAuthorization
> - *
> - *   Insert the authorization field in the request header
> - */
> -static BOOL HTTP_InsertAuthorization( LPWININETHTTPREQW lpwhr )
> -{
> -    return HTTP_InsertAuthorizationForHeader(lpwhr, lpwhr->pAuthInfo, szAuthorization);
> -}
> -
> -/***********************************************************************
> - *  HTTP_InsertProxyAuthorization
> - *
> - *   Insert the proxy authorization field in the request header
> - */
> -static BOOL HTTP_InsertProxyAuthorization( LPWININETHTTPREQW lpwhr )
> -{
> -    return HTTP_InsertAuthorizationForHeader(lpwhr, lpwhr->pProxyAuthInfo, szProxy_Authorization);
> -}
> -
> -/***********************************************************************
>   *           HTTP_DealWithProxy
>   */
>  static BOOL HTTP_DealWithProxy( LPWININETAPPINFOW hIC,
> @@ -2621,8 +2605,8 @@ BOOL WINAPI HTTP_HttpSendRequestW(LPWININETHTTPREQW lpwhr, LPCWSTR lpszHeaders,
>                             lpwhr->hdr.dwFlags & INTERNET_FLAG_KEEP_CONNECTION ? szKeepAlive : szClose,
>                             HTTP_ADDHDR_FLAG_REQ | HTTP_ADDHDR_FLAG_REPLACE);
>  
> -        HTTP_InsertAuthorization(lpwhr);
> -        HTTP_InsertProxyAuthorization(lpwhr);
> +        HTTP_InsertAuthorization(lpwhr, szAuthorization, !loop_next);
> +        HTTP_InsertAuthorization(lpwhr, szProxy_Authorization, !loop_next);
>  
>          /* add the headers the caller supplied */
>          if( lpszHeaders && dwHeaderLength )
> diff --git a/dlls/wininet/tests/http.c b/dlls/wininet/tests/http.c
> index 8bb7cca..88369cf 100644
> --- a/dlls/wininet/tests/http.c
> +++ b/dlls/wininet/tests/http.c
> @@ -1502,7 +1502,10 @@ static void test_header_handling_order(int port)
>      request = HttpOpenRequest(connect, NULL, "/test3", NULL, NULL, types, INTERNET_FLAG_KEEP_CONNECTION, 0);
>      ok(request != NULL, "HttpOpenRequest failed\n");
>  
> -    ret = HttpSendRequest(request, authorization, ~0UL, NULL, 0);
> +    ret = HttpAddRequestHeaders(request, authorization, ~0UL, HTTP_ADDREQ_FLAG_ADD);
> +    ok(ret, "HttpAddRequestHeaders failed\n");
> +
> +    ret = HttpSendRequest(request, NULL, 0, NULL, 0);
>      ok(ret, "HttpSendRequest failed\n");
>  
>      status = 0;
>   

This patch simultaneously breaks proxy authentication and NTLM 
authentication. Proxy authentication is broken because the helper 
function is removed that passes lpwhr->pProxyAuthInfo into 
HTTP_InsertAuthentication. NTLM authentication is broken because first 
is false when we try to send the authenticate message (i.e. the 3rd leg) 
and so the data for the negotiate message (i.e. the first leg) is sent 
instead as the field is not overridden.

Is this trying to fix a real app? If not, why isn't the code that is 
using the behaviour using INTERNET_FLAG_NO_AUTH?

-- 
Rob Shearman



From stefandoesinger at gmx.at  Wed Mar 12 05:46:37 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 12 Mar 2008 11:46:37 +0100
Subject: [2/2] wined3d: Don't translate by a full half pixel
In-Reply-To: <200803120146.25428.chris.kcat@gmail.com>
References: <200803120146.25428.chris.kcat@gmail.com>
Message-ID: <200803121146.40664.stefandoesinger@gmx.at>

Am Mittwoch, 12. M?rz 2008 09:46:25 schrieb Chris Robinson:
I am not yet conviced that those patches are a good idea. Some time ago I 
found that I need the full half pixel to make DCT happy. Furthermore I see 
different behavior among drivers, e.g. my r200 driver doesn't need any 
correction(it rather hurts instead), and the nvidia driver behaves odd on 
very small render targets.

As I said on IRC, I am afraid that we have to do those position fixes per 
driver. In the extension detection we have to draw a few points onto the back 
buffer and read back the results, and then configure the offsets accordingly.

As I keep saying, we need proper tests for that. Your test to test the corner 
points is a good start, but we also have to test offscreen targets of 
different sizes(e.g. 1x1, 4x4, 16x16, ...), and we have to test all 3 
codepaths(rhw, fixed function, shader).
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080312/8b9f5479/attachment.pgp 

From dank at kegel.com  Wed Mar 12 09:03:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 12 Mar 2008 07:03:18 -0700
Subject: Free apps bundled with msvcp71?
In-Reply-To: <53e3a9930803120055k60847f60u277ea47e84b83ba@mail.gmail.com>
References: <a71bd89a0803021832m1a3ffda2m5402cf57f2264572@mail.gmail.com>
	<53e3a9930803120055k60847f60u277ea47e84b83ba@mail.gmail.com>
Message-ID: <a71bd89a0803120703s73a21d65t690bf458f8826a61@mail.gmail.com>

On Wed, Mar 12, 2008 at 12:55 AM, Tom Wickline <twickline at gmail.com> wrote:
>  MSVCP71.dll is the MS Visual C++ 7.1 Runtime Library (which comes with
>  .NET 2003).
>
>  see: http://msdn2.microsoft.com/en-gb/vbasic/ms789141.aspx  for some info,
>
>  The Visual C++ Toolkit 2003 also bundles MSVCP71.dll and MSVCR71.dll
>  see: http://xona.com/2004/06/29.html

Yes indeed.

>  The Toolkit can be downloaded from xona at :
>  http://xona.com/programs/VCToolkitSetup(v1.01)(2004.07.06).zip (29.9
>  MB)

But not legally; I think the EULA for that package forbids redistribution.

>  I know this isn't a direct MS download but it might help in further
>  investigation :D

Fortunately, I already had a copy of the Visual C++ Toolkit 2003.

I'm still looking for a legal download of some app
that just happens to come with msvcp71.dll.
Ideally it'll be some small app with a trivial installer
that can be run noninteractively, suitable for use inside winetricks.
- Dan


From dank at kegel.com  Wed Mar 12 09:22:14 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 12 Mar 2008 07:22:14 -0700
Subject: Can we have a server component in bugzilla?
In-Reply-To: <22821af30803120005u5e13cafic41525a80a8b48c9@mail.gmail.com>
References: <a71bd89a0803111814m6df67951tc42c4afbe2c8d3c@mail.gmail.com>
	<22821af30803111921n4323505an66f300a3822bc3be@mail.gmail.com>
	<a71bd89a0803112047r1314d72egd7790d6c0c623427@mail.gmail.com>
	<22821af30803120005u5e13cafic41525a80a8b48c9@mail.gmail.com>
Message-ID: <a71bd89a0803120722v53d9989cn6f0e1b8cdafd4407@mail.gmail.com>

On Wed, Mar 12, 2008 at 12:05 AM, James Hawkins <truiken at gmail.com> wrote:
>  There is a wineserver component.

D'oh.  Blind.  I guess I was expecting the 'wine' prefix to be removed
as it was for lots of other stuff.


From remco47 at yahoo.com  Wed Mar 12 11:20:29 2008
From: remco47 at yahoo.com (Remco)
Date: Wed, 12 Mar 2008 09:20:29 -0700 (PDT)
Subject: Free apps bundled with msvcp71?
Message-ID: <99443.37356.qm@web50108.mail.re2.yahoo.com>

----- Original Message ----
> From: Dan Kegel <dank at kegel.com>
> Subject: Re: Free apps bundled with msvcp71?
> 
> I'm still looking for a legal download of some app
> that just happens to come with msvcp71.dll.
> Ideally it'll be some small app with a trivial installer
> that can be run noninteractively, suitable for use inside winetricks.


Maybe winetricks could become a w32 application. Make it an applicationthat "installs commonly omitted dlls and frameworks on Windows". That way,you could use some of the dlls directly: those dlls that only allowfree redistribution when bundled with Windows-oriented applications. Nothing in the application, especially the name,should refer to Wine of course; that alone would make it orientedto non-Windows platforms. At least until there is a plausible use for Wine on Windows.

Remco



      __________________________________________________________
Sent from Yahoo! Mail.
The World's Favourite Email http://uk.docs.yahoo.com/nowyoucan.html


From julliard at winehq.org  Wed Mar 12 11:54:49 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 12 Mar 2008 17:54:49 +0100
Subject: [1/4] qmgr: Add critical sections for Jobs and Files.
In-Reply-To: <20080311231236.GA4608@linux.ucla.edu> (Dan Hipschman's message
	of "Tue, 11 Mar 2008 16:12:36 -0700")
References: <20080311231236.GA4608@linux.ucla.edu>
Message-ID: <878x0nc27a.fsf@wine.dyndns.org>

Dan Hipschman <dsh at linux.ucla.edu> writes:

> @@ -25,6 +25,7 @@ WINE_DEFAULT_DEBUG_CHANNEL(qmgr);
>  
>  static void BackgroundCopyFileDestructor(BackgroundCopyFileImpl *This)
>  {
> +    This->owner->lpVtbl->Release((IBackgroundCopyJob *) This->owner);

Please use the appropriate COM macros instead of accessing lpVtbl
directly.

-- 
Alexandre Julliard
julliard at winehq.org


From raccoonone at procyongames.com  Wed Mar 12 13:51:52 2008
From: raccoonone at procyongames.com (Christopher)
Date: Wed, 12 Mar 2008 11:51:52 -0700
Subject: Running services in WINE?
Message-ID: <47D82648.30208@procyongames.com>

I've been trying to get MozyHome working on WINE, and have made a little 
progress. However, it seems that the service which Mozy uses won't 
start. Searching a bit I found a thread from a year ago stating that 
services don't work in WINE, but that it was being worked on. Are 
services implemented in WINE now, or if they're not is someone working 
on it who I could help out?

Christopher Berner


From paul.vriens.wine at gmail.com  Wed Mar 12 13:52:31 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 12 Mar 2008 19:52:31 +0100
Subject: Vista and SHFileOperation tests for shell32
Message-ID: <47D8266F.5050505@gmail.com>

Hi,

I was trying to fix the issues with the user32/listbox tests when I found that 
we have a lot of leftover files from the shell32/shlfileop test.

This happens because I get about a gazillion dialogs asking me what to do during 
the shlfileop tests and I usually tend to click Cancel or Skip.

The first test that fails for me is where we delete the directory before the 
file in that directory. This silently succeeds on everything before Vista but 
fails on Vista and W2K8.

Adding any of the silencing flags doesn't make a difference on Vista but make it 
fail on all the other Windows versions.

What road should I take for this:

a) Add some delete_all_possible_leftover_files_and_directories function at the 
end of shlfileop.c ?
b) Start making a distinction between Vista/W2K8 and pre-Vista ?
c) ????

The first one obviously doesn't fix the test failures.

-- 
Cheers,

Paul.


From dank at kegel.com  Wed Mar 12 15:10:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 12 Mar 2008 12:10:18 -0800
Subject: Running services in WINE?
Message-ID: <a71bd89a0803121310q3b16e881y3b97fcfddd328266@mail.gmail.com>

Yes, services are implemented now.  If you
run into a problem, please file a bug.


From us at edmeades.me.uk  Wed Mar 12 18:10:15 2008
From: us at edmeades.me.uk (Ann & Jason Edmeades)
Date: Wed, 12 Mar 2008 23:10:15 -0000
Subject: Clipping regions on windows and Expose Xevents issue
Message-ID: <000001c88496$3e60ef00$1001a8c0@JasonsPC>

Hello, I've been investigating defect 11562, and would appreciate some
thoughts on how to move forward...

Basically the application creates a new visible window (eg at 0,0 - 200,50)
and then draws in it by:
1. BeginPaint - This sets up the cliprgn to the whole window
2. Works out some sizes...
3. MoveWindow - This moves the window to an appropriate place on the screen
4. FillRect (DrawText, EndPaint) to empty the window... From this call (and
all follow on ones) nothing is written to the window because although the
visible region is correctly calculated, the clip region was not updated by
the MoveWindow call.

This highlights 2 problems..

1. MoveWindow doesn't update the DCEx clip_region region, and hence when the
visible region changes, it is merged with the clip region and since there is
no overlap the visible region is empty so all subsequent processing ends.

Q: Whats the best way to handle that - I was tempted to reset the
clip_region to the visible_region (as MSDN sort of implies - you cant really
query them so tests don't help much here) in a movewindow call

2. I then hacked MoveWindow to do nothing, so I could progress...

What I see then is the popup is drawn, emptied and framed etc, and THEN
overwritten with grey. Debugging this shows the application does not respond
to WM_PAINT calls for the popup window - ie its drawn once and once only.
You can see this on windows if you alt+tab to a covering window, and then
back again. HOWEVER, on windows the popup does display correctly the once

Investigating the cause, all is ok until the 
trace:event:process_events Expose for hwnd/window 0xd50026/220002c
This drives the 
trace:win:RedrawWindow 0xd50026 rect (0,0)-(250,50) flags: RDW_INVALIDATE
RDW_ERASE RDW_ALLCHILDREN
and *bang*, all the drawing which has been done is lost

Q: This is getting way outside my understanding of X events, but shouldn't
the Expose event for the child (popup) window be processed before returning
from CreateWindow with style WS_VISIBLE?

All suggestions welcome - I don't mind writing tests etc but would like to
try to come up with a solution for the problem as well!

Jason




From jacek at codeweavers.com  Wed Mar 12 18:16:22 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Thu, 13 Mar 2008 00:16:22 +0100
Subject: Question about function "HTMLDocument_write"
In-Reply-To: <200803111644.39716.ivan@etersoft.ru>
References: <200803111644.39716.ivan@etersoft.ru>
Message-ID: <47D86446.5000100@codeweavers.com>

Ivan Sinitsin wrote:
> On Monday the patch realizing this function has been accepted. It works 
> perfectly, but hyperlinks do not work.
>   

What do you mean by hyperlinks don't work?

> If I makes this function that way:
>
> [...]
> hyperlinks works good.
>
> Why so occurs?
>   

As I've explained in comment to your patch, this implementation is wrong.


Jacek



From stefan at codeweavers.com  Wed Mar 12 18:43:52 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 13 Mar 2008 00:43:52 +0100
Subject: Prototype patch that solves bug 11897
In-Reply-To: <47D85F5F.4030302@gmail.com>
References: <47D85D93.4090401@gmail.com> <47D85F5F.4030302@gmail.com>
Message-ID: <200803130043.55597.stefan@codeweavers.com>

Hi,
Note that we do not accept workaround patches into Wine, because otherwise the 
whole software would become a huge workaround collection.

A potential proper fix for this is to generate an UUID, store it in a constant 
global variable and memcpy it into the deviceidentifier
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080313/1a57b1ef/attachment.pgp 

From artur.szymiec at gmail.com  Wed Mar 12 19:02:47 2008
From: artur.szymiec at gmail.com (Artur Szymiec)
Date: Thu, 13 Mar 2008 01:02:47 +0100
Subject: Prototype patch that solves bug 11897
In-Reply-To: <200803130043.55597.stefan@codeweavers.com>
References: <47D85D93.4090401@gmail.com> <47D85F5F.4030302@gmail.com>
	<200803130043.55597.stefan@codeweavers.com>
Message-ID: <47D86F27.9040606@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Stefan D?singer pisze:
> Hi,
> Note that we do not accept workaround patches into Wine, because
otherwise the
> whole software would become a huge workaround collection.
>
> A potential proper fix for this is to generate an UUID, store it in a
constant
> global variable and memcpy it into the deviceidentifier
Dear Stefan,

ok  then.
At d3d startup I'll read back UUID from wine registry (or create one
if none) -> copy into globar var
and then memcopy.

Is this schema looks ok for you ?

Best regards
Artur

- --
- --------------------------------------------------------------------------
Registered User No 397465
Linux Debian 2.6.24.2 AMD Athlon(tm) 64 X2 Dual Core 5000+
Conquer your Desktop! http://www.kde.org/trykde/
Reclaim Your Inbox!   http://www.mozilla.org/products/thunderbird/
- --------------------------------------------------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFH2G8nbB2ld6kq2MsRAtNlAKCSdLhr90nzct+gMklYXyTKAHcv4ACgwOxt
v3lQmgjNIM/X75ZMd7icMhc=
=aDz2
-----END PGP SIGNATURE-----



From stefan at codeweavers.com  Wed Mar 12 19:17:11 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-2?q?D=F6singer?=)
Date: Thu, 13 Mar 2008 01:17:11 +0100
Subject: Prototype patch that solves bug 11897
In-Reply-To: <47D86F27.9040606@gmail.com>
References: <47D85D93.4090401@gmail.com>
	<200803130043.55597.stefan@codeweavers.com>
	<47D86F27.9040606@gmail.com>
Message-ID: <200803130117.11323.stefan@codeweavers.com>

Am Donnerstag, 13. M?rz 2008 01:02:47 schrieb Artur Szymiec:
> Stefan D?singer pisze:
> > Hi,
> > Note that we do not accept workaround patches into Wine, because
>
> otherwise the
>
> > whole software would become a huge workaround collection.
> >
> > A potential proper fix for this is to generate an UUID, store it in a
>
> constant
>
> > global variable and memcpy it into the deviceidentifier
>
> Dear Stefan,
>
> ok  then.
> At d3d startup I'll read back UUID from wine registry (or create one
> if none) -> copy into globar var
> and then memcopy.
I don't think you need to store them in the registry. Just hardcode it in the 
code, e.g. like ddraw does it:

const GUID IID_D3DDEVICE_WineD3D = {
  0xaef72d43,
  0xb09a,
  0x4b7b,
  { 0xb7,0x98,0xc6,0x8a,0x77,0x2d,0x72,0x2a }
};

which matches an uuidgen output of
0xaef72d43-0xb09a-0x4b7b-b798-6c8a773d722a
(Don't use this specific UUID for d3d9, generate a new one using uuidgen(part 
of the ext2 filesystem tools)

Chatter has it that on Windows there is some schematic in DirectX GUIDs, 
additionally to the general way UIDs work. But since that's not documented 
anywhere I could find I don't think any game depends on that. In the worst 
case we'll have to adopt the UIDs ATI and Nvidia are using on Windows, if any 
game compares them.




From m.b.lankhorst at gmail.com  Wed Mar 12 21:39:52 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 12 Mar 2008 19:39:52 -0700
Subject: Running services in WINE?
In-Reply-To: <47D82648.30208@procyongames.com>
References: <47D82648.30208@procyongames.com>
Message-ID: <b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>

Hi Christopher,

2008/3/12, Christopher <raccoonone at procyongames.com>:
> I've been trying to get MozyHome working on WINE, and have made a little
>  progress. However, it seems that the service which Mozy uses won't
>  start. Searching a bit I found a thread from a year ago stating that
>  services don't work in WINE, but that it was being worked on. Are
>  services implemented in WINE now, or if they're not is someone working
>  on it who I could help out?
Services most definitely work now. Some of them you can start manually
with "wine net start 'servicename'", however this shouldn't be needed.

Cheers,
Maarten.


From jjmckenzie51 at sprintpcs.com  Wed Mar 12 22:38:15 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Wed, 12 Mar 2008 20:38:15 -0700
Subject: winequartz.drv Mac OS X UI discontinued?
In-Reply-To: <EEDB1C7D-011E-431A-97FA-9C0E24015C82@free.fr>
References: <169F6047-C9D9-4C25-9E39-28AFE06C366D@java.pl>
	<200803021850.04583.stefan@codeweavers.com>
	<19e31a080803021053u74f564fo7b6a9fdd6676a37@mail.gmail.com>
	<EEDB1C7D-011E-431A-97FA-9C0E24015C82@free.fr>
Message-ID: <47D8A1A7.6060005@sprintpcs.com>

Emmanuel Maillard wrote:
> Hi,
>
> I post a new quartzdrv patch for wine-0.9.56 on Darwine SF patches  
> page :
> http://sourceforge.net/tracker/index.php?func=detail&aid=1908759&group_id=69890&atid=526089
>
> It's not fully update to wine changes (SysCommandSizeMove didn't be  
> reviewed)
> and don't contain all changes I initially planned but will be next time.
>
> Cheers
>
> Emmanuel
>   
Thank you.  I also noticed there are new .nib files available.

James McKenzie



From raccoonone at procyongames.com  Thu Mar 13 01:16:25 2008
From: raccoonone at procyongames.com (Christopher)
Date: Wed, 12 Mar 2008 23:16:25 -0700
Subject: Running services in WINE?
In-Reply-To: <b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>
References: <47D82648.30208@procyongames.com>
	<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>
Message-ID: <47D8C6B9.8030607@procyongames.com>

Maarten Lankhorst wrote:
> Hi Christopher,
>
> 2008/3/12, Christopher <raccoonone at procyongames.com>:
>   
>> I've been trying to get MozyHome working on WINE, and have made a little
>>  progress. However, it seems that the service which Mozy uses won't
>>  start. Searching a bit I found a thread from a year ago stating that
>>  services don't work in WINE, but that it was being worked on. Are
>>  services implemented in WINE now, or if they're not is someone working
>>  on it who I could help out?
>>     
> Services most definitely work now. Some of them you can start manually
> with "wine net start 'servicename'", however this shouldn't be needed.
>
> Cheers,
> Maarten.
>
>
>   
Thanks Maarten!
I tried that, but didn't have anymore luck. The service exits almost 
immediately, after giving a few fixme messages. Time to do some 
debugging I guess :)

Christopher


From paul.vriens.wine at gmail.com  Thu Mar 13 02:54:57 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 13 Mar 2008 08:54:57 +0100
Subject: msi: Ignore the custom action type 51 if the source field is empty
In-Reply-To: <22821af30803102230g1c52f0bewb89c8db92f271f10@mail.gmail.com>
References: <22821af30803102230g1c52f0bewb89c8db92f271f10@mail.gmail.com>
Message-ID: <47D8DDD1.5020805@gmail.com>

James Hawkins wrote:
> Hi,
> 
> Fixes bug 11891.  http://bugs.winehq.org/show_bug.cgi?id=11891
> 
> Changelog:
> * Ignore the custom action type 51 if the source field is empty.
> 
>  dlls/msi/custom.c        |    3 ++
>  dlls/msi/tests/install.c |   65 ++++++++++++++++++++++++++++++++++++++++++++++
>  2 files changed, 68 insertions(+), 0 deletions(-)
> 
> 
> 
> ------------------------------------------------------------------------
> 
> 
Hi James,

I was looking at the sudden huge amount of failures for the msi/package tests on 
Windows:

http://test.winehq.org/data/200803121000/

The issue turned out to be with the above patch for the install tests. If I run 
the install tests a 'MSITEST' package will stay around (can been seen in 
'Add/Remove Programs").

If I remove MSITEST the package tests will succeed again.

(Reverting the above patch makes the package tests pass again as well, when run 
after the install tests of course).

The thing that surprises me is that we don't see the same failures when running 
the package tests on Wine? Is this because we have 39 TODO's in there?

-- 
Cheers,

Paul.


From ivan at etersoft.ru  Thu Mar 13 02:59:36 2008
From: ivan at etersoft.ru (Ivan Sinitsin)
Date: Thu, 13 Mar 2008 10:59:36 +0300
Subject: Question about function "HTMLDocument_write"
In-Reply-To: <47D86446.5000100@codeweavers.com>
References: <200803111644.39716.ivan@etersoft.ru>
	<47D86446.5000100@codeweavers.com>
Message-ID: <200803131059.36573.ivan@etersoft.ru>

>
> What do you mean by hyperlinks don't work?
>
I have such code which create html page:

htmlDoc2->lpVtbl->open(htmlDoc2, L"html/txt", vnull, vnull, vnull, &pdisp);
bstr =SysAllocString(L"<html><head></head><body><p>Simple text</p>");
if ((pVar->bstrVal = bstr)) {
     htmlDoc2->lpVtbl->write(htmlDoc2, sfArray);
}
SysFreeString(bstr);
bstr = SysAllocString(L"<br><a href='http://www.yandex.ru'>Link to the 
Yandex");
if ((pVar->bstrVal = bstr)) {
      htmlDoc2->lpVtbl->write(htmlDoc2, sfArray);
}
SysFreeString(bstr);
bstr = SysAllocString(L"</a><br>End of document</body></html>");
if ((pVar->bstrVal = bstr)) {
      htmlDoc2->lpVtbl->write(htmlDoc2, sfArray);
}
SysFreeString(bstr);
htmlDoc2->lpVtbl->close(htmlDoc2);

After creation of page, I try to click on a hyperlink, but nothing occurs.

When I used my patch, hyperlink works good.

>
> As I've explained in comment to your patch, this implementation is wrong.
>
I do not speak, that my patch better than yours or my patch is right. I only 
want  to understand, why so occurs and where to look?

>
> Jacek

-- 
Sinitsin Ivan


From artur.szymiec at gmail.com  Thu Mar 13 04:19:36 2008
From: artur.szymiec at gmail.com (Artur Szymiec)
Date: Thu, 13 Mar 2008 10:19:36 +0100
Subject: RESEND Prototype patch that solves bug 11897
In-Reply-To: <200803130117.11323.stefan@codeweavers.com>
References: <47D85D93.4090401@gmail.com>
	<200803130043.55597.stefan@codeweavers.com>
	<47D86F27.9040606@gmail.com>
	<200803130117.11323.stefan@codeweavers.com>
Message-ID: <47D8F1A8.1060007@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Stefan D?singer pisze:
> Am Donnerstag, 13. M?rz 2008 01:02:47 schrieb Artur Szymiec:
>> Stefan D?singer pisze:
>>> Hi, Note that we do not accept workaround patches into Wine,
>>> because
>> otherwise the
>>
>>> whole software would become a huge workaround collection.
>>>
>>> A potential proper fix for this is to generate an UUID, store
>>> it in a
>> constant
>>
>>> global variable and memcpy it into the deviceidentifier
>> Dear Stefan,
>>
>> ok  then. At d3d startup I'll read back UUID from wine registry
>> (or create one if none) -> copy into globar var and then memcopy.
>>
> I don't think you need to store them in the registry. Just hardcode
> it in the code, e.g. like ddraw does it:
>
> const GUID IID_D3DDEVICE_WineD3D = { 0xaef72d43, 0xb09a, 0x4b7b, {
> 0xb7,0x98,0xc6,0x8a,0x77,0x2d,0x72,0x2a } };
>
> which matches an uuidgen output of
> 0xaef72d43-0xb09a-0x4b7b-b798-6c8a773d722a (Don't use this specific
> UUID for d3d9, generate a new one using uuidgen(part of the ext2
> filesystem tools)
>
> Chatter has it that on Windows there is some schematic in DirectX
> GUIDs, additionally to the general way UIDs work. But since that's
> not documented anywhere I could find I don't think any game depends
> on that. In the worst case we'll have to adopt the UIDs ATI and
> Nvidia are using on Windows, if any game compares them.
This is a corrected patch.
The uuid is common to dx8 and dx9 since the UUID is generated
inside wined3d.

diff --git a/dlls/wined3d/directx.c b/dlls/wined3d/directx.c
index 04af700..809809c 100644
- --- a/dlls/wined3d/directx.c
+++ b/dlls/wined3d/directx.c
@@ -36,6 +36,14 @@
 WINE_DEFAULT_DEBUG_CHANNEL(d3d);
 WINE_DECLARE_DEBUG_CHANNEL(d3d_caps);

+/* The d3d device ID */
+const GUID IID_D3DDEVICE_D3DUID = {
+  0xaeb2cdd4,
+  0x6e41,
+  0x43ea,
+  { 0x94,0x1c,0x83,0x61,0xcc,0x76,0x07,0x81 }
+};
+
 /* Extension detection */
 static const struct {
     const char *extension_string;
@@ -1595,7 +1603,9 @@ static HRESULT WINAPI
IWineD3DImpl_GetAdapterIdentifier(IWineD3D *iface, UINT Ad
     *(pIdentifier->SubSysId) = 0;
     *(pIdentifier->Revision) = 0;

- -    /*FIXME: memcpy(&pIdentifier->DeviceIdentifier, ??,
sizeof(??GUID)); */
+    /* Fixes BUG 11897 */
+
memcpy(pIdentifier->DeviceIdentifier,&IID_D3DDEVICE_D3DUID,sizeof(GUID));
+
     if (Flags & WINED3DENUM_NO_WHQL_LEVEL) {
         *(pIdentifier->WHQLLevel) = 0;
     } else {


- --
- --------------------------------------------------------------------------
Registered User No 397465
Linux Debian 2.6.24.2 AMD Athlon(tm) 64 X2 Dual Core 5000+
Conquer your Desktop! http://www.kde.org/trykde/
Reclaim Your Inbox!   http://www.mozilla.org/products/thunderbird/
- --------------------------------------------------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFH2PGnbB2ld6kq2MsRAp3fAJ0QbkQ7Ifo3ukdiu0l1KD3TAaXX+QCgsFhC
7MoBeeM2XNh7SmgHe5tppBs=
=/t0r
-----END PGP SIGNATURE-----



From stefan at codeweavers.com  Thu Mar 13 05:30:07 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-2?q?D=F6singer?=)
Date: Thu, 13 Mar 2008 11:30:07 +0100
Subject: RESEND Prototype patch that solves bug 11897
In-Reply-To: <47D8F1A8.1060007@gmail.com>
References: <47D85D93.4090401@gmail.com>
	<200803130117.11323.stefan@codeweavers.com>
	<47D8F1A8.1060007@gmail.com>
Message-ID: <200803131130.11126.stefan@codeweavers.com>

Am Donnerstag, 13. M?rz 2008 10:19:36 schrieb Artur Szymiec:
> This is a corrected patch.
> The uuid is common to dx8 and dx9 since the UUID is generated
> inside wined3d.
Yes, that looks reasonable. Only two small issues:

> +/* Fixes BUG 11897 */
That's not really needed, specifying a GUID is correct even if it wouldn't fix 
a bug report.

Also, please attach the patch as an extra file to the mail, if you inline it 
like you did in your last mails it most likely suffers from line wrapping and 
can't be applied
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080313/ae9124d6/attachment.pgp 

From julliard at winehq.org  Thu Mar 13 05:31:21 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 13 Mar 2008 11:31:21 +0100
Subject: [2/4] qmgr: Add infrastructure for background file transferring.
	[take 4]
In-Reply-To: <20080312185645.GF4608@linux.ucla.edu> (Dan Hipschman's message
	of "Wed, 12 Mar 2008 11:56:45 -0700")
References: <20080312185645.GF4608@linux.ucla.edu>
Message-ID: <87myp2zzie.fsf@wine.dyndns.org>

Dan Hipschman <dsh at linux.ucla.edu> writes:

> @@ -129,6 +131,21 @@ ServiceMain(DWORD dwArgc, LPWSTR *lpszArgv)
>          return;
>      }
>  
> +    globalMgr.jobEvent = CreateEventW(NULL, TRUE, FALSE, NULL);
> +    if (!globalMgr.jobEvent) {
> +        ERR("Couldn't create event: error %d\n", GetLastError());
> +        UpdateStatus(SERVICE_STOPPED, NO_ERROR, 0);
> +        return;
> +    }
> +
> +    fileTxThread = CreateThread(NULL, 0, fileTransfer, NULL, 0, &threadId);
> +    if (!fileTxThread)
> +    {
> +        ERR("Failed starting file transfer thread\n");
> +        UpdateStatus(SERVICE_STOPPED, NO_ERROR, 0);
> +        return;
> +    }
> +
>      UpdateStatus(SERVICE_RUNNING, NO_ERROR, 0);

You also need to shutdown the thread properly when the service
terminates.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Mar 13 06:22:00 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 13 Mar 2008 12:22:00 +0100
Subject: Clipping regions on windows and Expose Xevents issue
In-Reply-To: <000001c88496$3e60ef00$1001a8c0@JasonsPC> (Ann & Jason Edmeades's
	message of "Wed, 12 Mar 2008 23:10:15 -0000")
References: <000001c88496$3e60ef00$1001a8c0@JasonsPC>
Message-ID: <87iqzqzx5z.fsf@wine.dyndns.org>

"Ann & Jason Edmeades" <us at edmeades.me.uk> writes:

> 1. MoveWindow doesn't update the DCEx clip_region region, and hence when the
> visible region changes, it is merged with the clip region and since there is
> no overlap the visible region is empty so all subsequent processing ends.
>
> Q: Whats the best way to handle that - I was tempted to reset the
> clip_region to the visible_region (as MSDN sort of implies - you cant really
> query them so tests don't help much here) in a movewindow call

You can query the visible region, so with well-chosen dimensions and
clip region it shouldn't be too hard to write test cases. Make sure you
test both GetDCEx with an explicit clip region and BeginPaint, the
behavior is probably different

> Q: This is getting way outside my understanding of X events, but shouldn't
> the Expose event for the child (popup) window be processed before returning
> from CreateWindow with style WS_VISIBLE?

The way we hack around the asynchronous events is by checking for expose
events in UpdateWindow, but of course if the app doesn't even use that
it won't help. And on a slow connection the expose events will always
arrive too late anyway. We'd need to explicitly wait for the event, but
that would hurt badly on slow connections.

-- 
Alexandre Julliard
julliard at winehq.org


From artur.szymiec at gmail.com  Thu Mar 13 07:04:28 2008
From: artur.szymiec at gmail.com (Artur Szymiec)
Date: Thu, 13 Mar 2008 13:04:28 +0100
Subject: RESEND Prototype patch that solves bug 11897
In-Reply-To: <200803131130.11126.stefan@codeweavers.com>
References: <47D85D93.4090401@gmail.com>
	<200803130117.11323.stefan@codeweavers.com>
	<47D8F1A8.1060007@gmail.com>
	<200803131130.11126.stefan@codeweavers.com>
Message-ID: <47D9184C.8070704@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Stefan D?singer pisze:
> Am Donnerstag, 13. M?rz 2008 10:19:36 schrieb Artur Szymiec:
>> This is a corrected patch. The uuid is common to dx8 and dx9
>> since the UUID is generated inside wined3d.
> Yes, that looks reasonable. Only two small issues:
>
>> +/* Fixes BUG 11897 */
> That's not really needed, specifying a GUID is correct even if it
> wouldn't fix a bug report.
>
> Also, please attach the patch as an extra file to the mail, if you
> inline it like you did in your last mails it most likely suffers
> from line wrapping and can't be applied
Thank you very much for help Stefan !

Best regards
Artur

- --
- --------------------------------------------------------------------------
Registered User No 397465
Linux Debian 2.6.24.2 AMD Athlon(tm) 64 X2 Dual Core 5000+
Conquer your Desktop! http://www.kde.org/trykde/
Reclaim Your Inbox!   http://www.mozilla.org/products/thunderbird/
- --------------------------------------------------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFH2RhMbB2ld6kq2MsRAsltAJ0eZzgQoJlZ1jgPc/8YPHoMJyP1MwCg2c+Z
bDKy0V+CgkyilcTdduIKUbQ=
=TvMs
-----END PGP SIGNATURE-----

-------------- next part --------------
A non-text attachment was scrubbed...
Name: UUID.patch
Type: text/x-diff
Size: 984 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080313/852afa9f/attachment.patch 

From stefan at codeweavers.com  Thu Mar 13 08:27:58 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 13 Mar 2008 14:27:58 +0100
Subject: RESEND Prototype patch that solves bug 11897
In-Reply-To: <47D9184C.8070704@gmail.com>
References: <47D85D93.4090401@gmail.com>
	<200803131130.11126.stefan@codeweavers.com>
	<47D9184C.8070704@gmail.com>
Message-ID: <200803131428.00449.stefan@codeweavers.com>

Am Donnerstag, 13. M?rz 2008 13:04:28 schrieb Artur Szymiec:
> Thank you very much for help Stefan !
You're welcome. Thanks for your help to make Wine better.

Just send the patch to wine-patches, if they're on wine-devel they won't be 
applied. Also I recommend not to sign mails to wine-patches because the 
archives can't handle more than one attachment, and if there's a signature 
the patch isn't accessible from the archives
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080313/bf4f4c41/attachment.pgp 

From stefan at codeweavers.com  Thu Mar 13 09:20:14 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 13 Mar 2008 15:20:14 +0100
Subject: RESEND D3D add device uuid solves bug 11897
In-Reply-To: <47D92EB7.3010709@gmail.com>
References: <47D85D93.4090401@gmail.com>
	<200803131130.11126.stefan@codeweavers.com>
	<47D92EB7.3010709@gmail.com>
Message-ID: <200803131520.17639.stefan@codeweavers.com>

Am Donnerstag, 13. M?rz 2008 14:40:07 schrieb Artur Szymiec:
> Stefan D?singer pisze:
> > Am Donnerstag, 13. M?rz 2008 10:19:36 schrieb Artur Szymiec:
> >> This is a corrected patch.
> >> The uuid is common to dx8 and dx9 since the UUID is generated
> >> inside wined3d.
> >
> > Yes, that looks reasonable. Only two small issues:
> >> +/* Fixes BUG 11897 */
> >
> > That's not really needed, specifying a GUID is correct even if it
> > wouldn't fix a bug report.
> >
> > Also, please attach the patch as an extra file to the mail, if you inline
> > it like you did in your last mails it most likely suffers from line
> > wrapping and can't be applied
>
> That's final version with suggested correction
> by Stefan D?singer
Sorry that I didn't think of that earlier, but do you have to use memcpy? 
Doesn't a simple *pIdentifier->DeviceIdentifier = IID_D3DDEVICE_D3DUID; work 
as well?

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080313/884ae204/attachment.pgp 

From artur.szymiec at gmail.com  Thu Mar 13 09:37:02 2008
From: artur.szymiec at gmail.com (Artur Szymiec)
Date: Thu, 13 Mar 2008 15:37:02 +0100
Subject: RESEND D3D add device uuid solves bug 11897
In-Reply-To: <200803131520.17639.stefan@codeweavers.com>
References: <47D85D93.4090401@gmail.com>
	<200803131130.11126.stefan@codeweavers.com>
	<47D92EB7.3010709@gmail.com>
	<200803131520.17639.stefan@codeweavers.com>
Message-ID: <47D93C0E.7060605@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Stefan D?singer pisze:
> Am Donnerstag, 13. M?rz 2008 14:40:07 schrieb Artur Szymiec:
>> Stefan D?singer pisze:
>>> Am Donnerstag, 13. M?rz 2008 10:19:36 schrieb Artur Szymiec:
>>>> This is a corrected patch.
>>>> The uuid is common to dx8 and dx9 since the UUID is generated
>>>> inside wined3d.
>>> Yes, that looks reasonable. Only two small issues:
>>>> +/* Fixes BUG 11897 */
>>> That's not really needed, specifying a GUID is correct even if it
>>> wouldn't fix a bug report.
>>>
>>> Also, please attach the patch as an extra file to the mail, if you inline
>>> it like you did in your last mails it most likely suffers from line
>>> wrapping and can't be applied
>> That's final version with suggested correction
>> by Stefan D?singer
> Sorry that I didn't think of that earlier, but do you have to use memcpy?
> Doesn't a simple *pIdentifier->DeviceIdentifier = IID_D3DDEVICE_D3DUID;
work
> as well?
>
I've corrected this like Vitaliy suggested and
sent again to wine-patches.

Regards
Artur

- --
- --------------------------------------------------------------------------
Registered User No 397465
Linux Debian 2.6.24.2 AMD Athlon(tm) 64 X2 Dual Core 5000+
Conquer your Desktop! http://www.kde.org/trykde/
Reclaim Your Inbox!   http://www.mozilla.org/products/thunderbird/
- --------------------------------------------------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFH2TwObB2ld6kq2MsRAsprAKCxRDwygn0VZ4ZglvUbHcPEL0EyAQCggwhv
qr236BN0Nv88EkUTooR6z1I=
=FxIQ
-----END PGP SIGNATURE-----



From dank at kegel.com  Thu Mar 13 10:32:23 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 13 Mar 2008 08:32:23 -0700
Subject: wine virus story
Message-ID: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>

http://wearenixed.blogspot.com/2008/03/you-only-know-good-when-youve-seen-bad.html

"I had set her up with a perfect Wine install. She had a bit
of software that needed to run under wine and I had shown her
how to install within that environment. Apparently, I wasn't
specific enough. It never occurred to Paula that the .exe
programs she had used on her XP machine were the vehicles for
many of her present viruses. To her, it was perfectly fine to
use those same .exe's...after all, she was in Linux, right?

I got there within the same hour and checked her
machine. Yep...Windows viruses will reside and create the same
havoc within a Wine environment. Now, I've seen it with my own
eyes. This time I reinstalled for her and made sure I found
all the infected .exe's on the Windows side and deleted them."


From pgquiles at elpauer.org  Thu Mar 13 10:51:17 2008
From: pgquiles at elpauer.org (Pau Garcia i Quiles)
Date: Thu, 13 Mar 2008 16:51:17 +0100
Subject: wine virus story
In-Reply-To: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
Message-ID: <20080313165117.wzyb7otv0ow80cw8@www.elpauer.org>

Quoting Dan Kegel <dank at kegel.com>:

> http://wearenixed.blogspot.com/2008/03/you-only-know-good-when-youve-seen-bad.html
>
> "I had set her up with a perfect Wine install. She had a bit
> of software that needed to run under wine and I had shown her
> how to install within that environment. Apparently, I wasn't
> specific enough. It never occurred to Paula that the .exe
> programs she had used on her XP machine were the vehicles for
> many of her present viruses. To her, it was perfectly fine to
> use those same .exe's...after all, she was in Linux, right?
>
> I got there within the same hour and checked her
> machine. Yep...Windows viruses will reside and create the same
> havoc within a Wine environment. Now, I've seen it with my own
> eyes. This time I reinstalled for her and made sure I found
> all the infected .exe's on the Windows side and deleted them."

Windows virus infecting Linux machines are a huge success for Wine.

Take that one Microsoft! Windows viruses run better on Linux than on  
Windows Vista!

-- 
Pau Garcia i Quiles
http://www.elpauer.org
(Due to my workload, I may need 10 days to answer)



From meissner at suse.de  Thu Mar 13 11:27:38 2008
From: meissner at suse.de (Marcus Meissner)
Date: Thu, 13 Mar 2008 17:27:38 +0100
Subject: wine virus story
In-Reply-To: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
Message-ID: <20080313162737.GA29108@suse.de>

On Thu, Mar 13, 2008 at 08:32:23AM -0700, Dan Kegel wrote:
> http://wearenixed.blogspot.com/2008/03/you-only-know-good-when-youve-seen-bad.html
> 
> "I had set her up with a perfect Wine install. She had a bit
> of software that needed to run under wine and I had shown her
> how to install within that environment. Apparently, I wasn't
> specific enough. It never occurred to Paula that the .exe
> programs she had used on her XP machine were the vehicles for
> many of her present viruses. To her, it was perfectly fine to
> use those same .exe's...after all, she was in Linux, right?
> 
> I got there within the same hour and checked her
> machine. Yep...Windows viruses will reside and create the same
> havoc within a Wine environment. Now, I've seen it with my own
> eyes. This time I reinstalled for her and made sure I found
> all the infected .exe's on the Windows side and deleted them."

Fortunately you can run clamscan -r ~/.wine/ without much
fear for rootkits hiding the virii.

Ciao, Marcus


From wine-patches at kievinfo.com  Thu Mar 13 08:39:28 2008
From: wine-patches at kievinfo.com (Vitaliy Margolen)
Date: Thu, 13 Mar 2008 07:39:28 -0600
Subject: RESEND Prototype patch that solves bug 11897
In-Reply-To: <47D9184C.8070704@gmail.com>
References: <47D85D93.4090401@gmail.com>	<200803130117.11323.stefan@codeweavers.com>	<47D8F1A8.1060007@gmail.com>	<200803131130.11126.stefan@codeweavers.com>
	<47D9184C.8070704@gmail.com>
Message-ID: <47D92E90.9080007@kievinfo.com>

Artur Szymiec wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> Stefan D?singer pisze:
>> Am Donnerstag, 13. M?rz 2008 10:19:36 schrieb Artur Szymiec:
>>> This is a corrected patch. The uuid is common to dx8 and dx9
>>> since the UUID is generated inside wined3d.
>> Yes, that looks reasonable. Only two small issues:
>>
>>> +/* Fixes BUG 11897 */
>> That's not really needed, specifying a GUID is correct even if it
>> wouldn't fix a bug report.
>>
>> Also, please attach the patch as an extra file to the mail, if you
>> inline it like you did in your last mails it most likely suffers
>> from line wrapping and can't be applied
> Thank you very much for help Stefan !
> 
Few more problems with your patch:
> +const GUID IID_D3DDEVICE_D3DUID = {
> +  0xaeb2cdd4,
> +  0x6e41,
1. Use 4 spaces indentation as the rest of the file not 2.

> +    memcpy(pIdentifier->DeviceIdentifier,&IID_D3DDEVICE_D3DUID,sizeof(GUID));
2. Don't use memcpy. They are both structs and you you can assign sctruct to 
struct in c:
     *pIdentifier->DeviceIdentifier = IID_D3DDEVICE_D3DUID;

Vitaliy.


From mammothtruk at gmail.com  Thu Mar 13 09:31:56 2008
From: mammothtruk at gmail.com (MammothTruk)
Date: Thu, 13 Mar 2008 09:31:56 -0500
Subject: GSoC
Message-ID: <1dd4d8b40803130731r6681a702x9112f3abac8b795a@mail.gmail.com>

I read the WineHQ newsletters when they come out to try and keep up on the
goings on of Wine and what will run on it.  I noticed that the
Wsock32.dllwas suggested as a SoC project.  I wanted to point out that
Vista X64 has
issues with this dll and some of the newer programs arent accessing it
right.  This could be a really good project to take on for someone as it
would give people that are having issues with Vista to use Wine.

I also thought that possible control panel rewriting so that it looks better
would be a good project.  Make it more user friendly.  Easier to access.  My
descriptions of what things do on each tab.  Just an overall nice,easy,good
looking control panel would be really helpful to first time users.  the
current winecfg looks like crap and isnt at all user friendly to the first
time user.  I was a first time users a year ago and I still dont understand
half of the control panel.

Wine Plugin project might be really useful too.  It would help companies
that cant afford or wont make direct linux ports to have some kind of
ability to get their porgrams working without official linux support.

The three things listed above all come from me playing NeverWinter Nights
2.  OEI wont make a linux port but have been pretty supportive of Wine in
their forums on bioware.  .NET is also something needed to get the toolset
working, but I thought that was a little big for a 2-3 month project.

Supporter,
Nicholas "MammothTruk" Baldwin

-- 
Lifes to Short.  Stop wasting your time.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080313/89fb70db/attachment.htm 

From arbuckle911 at gmail.com  Thu Mar 13 12:11:48 2008
From: arbuckle911 at gmail.com (Christopher Harvey)
Date: Thu, 13 Mar 2008 13:11:48 -0400
Subject: GSoC
In-Reply-To: <1dd4d8b40803130731r6681a702x9112f3abac8b795a@mail.gmail.com>
References: <1dd4d8b40803130731r6681a702x9112f3abac8b795a@mail.gmail.com>
Message-ID: <47D96054.6050301@gmail.com>

MammothTruk wrote:
> I read the WineHQ newsletters when they come out to try and keep up on 
> the goings on of Wine and what will run on it.  I noticed that the 
> Wsock32.dll was suggested as a SoC project.  I wanted to point out 
> that Vista X64 has issues with this dll and some of the newer programs 
> arent accessing it right.  This could be a really good project to take 
> on for someone as it would give people that are having issues with 
> Vista to use Wine.
>
> I also thought that possible control panel rewriting so that it looks 
> better would be a good project.  Make it more user friendly.  Easier 
> to access.  My descriptions of what things do on each tab.  Just an 
> overall nice,easy,good looking control panel would be really helpful 
> to first time users.  the current winecfg looks like crap and isnt at 
> all user friendly to the first time user.  I was a first time users a 
> year ago and I still dont understand half of the control panel.
>
> Wine Plugin project might be really useful too.  It would help 
> companies that cant afford or wont make direct linux ports to have 
> some kind of ability to get their porgrams working without official 
> linux support.
>
> The three things listed above all come from me playing NeverWinter 
> Nights 2.  OEI wont make a linux port but have been pretty supportive 
> of Wine in their forums on bioware.  .NET is also something needed to 
> get the toolset working, but I thought that was a little big for a 2-3 
> month project.
>
> Supporter,
> Nicholas "MammothTruk" Baldwin
>
> -- 
> Lifes to Short.  Stop wasting your time.
> ------------------------------------------------------------------------
>
>
>   
Hi,
I'm going to be applying for GSoC this year, for the mswsock dll 
mentioned in this e-mail. I've been working on it pretty part time for 
about week, and with wine as a whole for about 1 month,  I think I can 
handle it. I heard it was a good idea to post and let people know if one 
is interested in GSoC, so here is my post.
I've had a few ideas that I thought of on my own, but now I'm starting 
to see they perhaps aren't as useful as the ideas thought of by current 
developers, but I'll float it out there one last time. I thought it 
would be cool to create a wine GUI overlay for games, exactly like 
nvPerfHUD. The thing about doing it in wine that makes it better than 
nvPerHUD is the fact the to use nvPerfHUD the apps have to give 
permission for nvPerHUD to run on them. A wine version would actually be 
able to force every single 3d app, opengl or directX to output nvPerfHUD 
like output. Anyway, just a thought. Would I be able to apply for both 
of these projects and pick one last minute?
Thanks,
Chris.



From luis.busquets at ilidium.com  Thu Mar 13 12:23:06 2008
From: luis.busquets at ilidium.com (=?UTF-8?B?Ikx1aXMgQy4gQnVzcXVldHMgUMOpcmV6Ig==?=)
Date: Thu, 13 Mar 2008 18:23:06 +0100
Subject: d3dx8: Implementation of D3DXGetFVFVertexSize
Message-ID: <47D962FA.9040005@ilidium.com>

Is ther eany problem with this patch?

---
  dlls/d3dx8/d3dx8_main.c |   59 
+++++++++++++++++++++++++++++++++++++++++++++-
  1 files changed, 57 insertions(+), 2 deletions(-)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: eb5a1f3d568271b2fe052ebfd206365aaf4d6929.diff
Type: text/x-patch
Size: 1654 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080313/985ca5d4/attachment.bin 

From luis.busquets at ilidium.com  Thu Mar 13 12:26:17 2008
From: luis.busquets at ilidium.com (=?ISO-8859-1?Q?=22Luis_C=2E_Busquets_P=E9rez=22?=)
Date: Thu, 13 Mar 2008 18:26:17 +0100
Subject: Google Summer of code
Message-ID: <47D963B9.3040205@ilidium.com>

Proposing another thing if implementing d3dx9_36.dll is too much I 
propose to implement:
     1   D3DXAssembleShader
     2   D3DXAssembleShaderFromFileA
     3   D3DXCompileShader
     4   D3DXCompileShaderFromFileA
     5   D3DXCreateCubeTextureFromFileExA
     6   D3DXCreateCubeTextureFromFileInMemory
     7   D3DXCreateEffectCompilerFromFileA
     8   D3DXCreateEffectFromFileA
     9   D3DXCreateTextureFromFileExA
    10   D3DXCreateTextureFromFileInMemory
    11   D3DXCreateVolumeTextureFromFileExA
    12   D3DXCreateVolumeTextureFromFileInMemory
    13   D3DXGetImageInfoFromFileInMemory
    14   D3DXGetPixelShaderProfile
    15   D3DXGetShaderConstantTable
    16   D3DXGetShaderInputSemantics
    17   D3DXGetShaderVersion
    18   D3DXGetVertexShaderProfile
    19   D3DXLoadSurfaceFromSurface
    20   D3DXSaveSurfaceToFileA
    21   D3DXSaveTextureToFileA

Which are the functions that Sid Meier's Civilization 4 calls and are 
not yet implemented from d3dx9_32 (36)



From erappleman at gmail.com  Thu Mar 13 13:04:26 2008
From: erappleman at gmail.com (Eric Appleman)
Date: Thu, 13 Mar 2008 14:04:26 -0400
Subject: 1 program is separating me from complete windows independence. please
	help!
Message-ID: <47D96CAA.1010704@gmail.com>

Can someone please take a look at this bug for me?

http://bugs.winehq.org/show_bug.cgi?id=11953


From epssyis at gmail.com  Thu Mar 13 13:12:00 2008
From: epssyis at gmail.com (Edward Savage)
Date: Fri, 14 Mar 2008 05:12:00 +1100
Subject: wine virus story
In-Reply-To: <20080313162737.GA29108@suse.de>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
	<20080313162737.GA29108@suse.de>
Message-ID: <d6c5d7290803131112o71a0121dhce7a6d6c60277e6@mail.gmail.com>

I remember my last attempt to run a virus under wine caused a total
loss of my .wine structure but didn't manage to cause any damage to my
sandbox (including a juicy fake address list).  I was really let down
as I expected carnage.

Just as a silly outside thought; would it be worth keeping track of
some of the bigger windows virus so we can see how good wine
compatibiliy with all of the nitty gritty bugs of windows really is?
Also this would allow us to identify dangerous areas in wine were the
ability to affect the linux environment cross over.

On Fri, Mar 14, 2008 at 3:27 AM, Marcus Meissner <meissner at suse.de> wrote:
>
> On Thu, Mar 13, 2008 at 08:32:23AM -0700, Dan Kegel wrote:
>  > http://wearenixed.blogspot.com/2008/03/you-only-know-good-when-youve-seen-bad.html
>  >
>  > "I had set her up with a perfect Wine install. She had a bit
>  > of software that needed to run under wine and I had shown her
>  > how to install within that environment. Apparently, I wasn't
>  > specific enough. It never occurred to Paula that the .exe
>  > programs she had used on her XP machine were the vehicles for
>  > many of her present viruses. To her, it was perfectly fine to
>  > use those same .exe's...after all, she was in Linux, right?
>  >
>  > I got there within the same hour and checked her
>  > machine. Yep...Windows viruses will reside and create the same
>  > havoc within a Wine environment. Now, I've seen it with my own
>  > eyes. This time I reinstalled for her and made sure I found
>  > all the infected .exe's on the Windows side and deleted them."
>
>  Fortunately you can run clamscan -r ~/.wine/ without much
>  fear for rootkits hiding the virii.
>
>  Ciao, Marcus
>
>
>


From dank at kegel.com  Thu Mar 13 14:11:14 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 13 Mar 2008 11:11:14 -0800
Subject: wine virus story
In-Reply-To: <d6c5d7290803131112o71a0121dhce7a6d6c60277e6@mail.gmail.com>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
	<20080313162737.GA29108@suse.de>
	<d6c5d7290803131112o71a0121dhce7a6d6c60277e6@mail.gmail.com>
Message-ID: <a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>

On 3/13/08, Edward Savage <epssyis at gmail.com> wrote:
>  Just as a silly outside thought; would it be worth keeping track of
>  some of the bigger windows virus so we can see how good wine
>  compatibiliy with all of the nitty gritty bugs of windows really is?
>  Also this would allow us to identify dangerous areas in wine were the
>  ability to affect the linux environment cross over.

Yes, it would be good to keep an eye on that.

Ideally we'd have an automated script to set up
a petri dish, try out a bunch of known infectious agents,
and see which one of them reproduce.

I haven't done anything like that myself, but I imagine
a good place to start might be to script an instance
of mozilla or ies4linux visiting the top sites listed at
http://www.stopbadware.org/home/topsites
and see if they're able to modify the system at all.
- Dan


From epssyis at gmail.com  Thu Mar 13 14:31:49 2008
From: epssyis at gmail.com (Edward Savage)
Date: Fri, 14 Mar 2008 06:31:49 +1100
Subject: wine virus story
In-Reply-To: <a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
	<20080313162737.GA29108@suse.de>
	<d6c5d7290803131112o71a0121dhce7a6d6c60277e6@mail.gmail.com>
	<a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
Message-ID: <d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com>

This sounds like some thing I'd be able to do though I'm not sure of
the best way to sand box wine away from the system.  What is the best
way to go about this, would simply creating a new user be enough to
protect a system, or does a vm have to be used?

I have a bit of free time tomorrow so I'll make a start and see where I get.

On Fri, Mar 14, 2008 at 6:11 AM, Dan Kegel <dank at kegel.com> wrote:
> On 3/13/08, Edward Savage <epssyis at gmail.com> wrote:
>  >  Just as a silly outside thought; would it be worth keeping track of
>  >  some of the bigger windows virus so we can see how good wine
>  >  compatibiliy with all of the nitty gritty bugs of windows really is?
>  >  Also this would allow us to identify dangerous areas in wine were the
>  >  ability to affect the linux environment cross over.
>
>  Yes, it would be good to keep an eye on that.
>
>  Ideally we'd have an automated script to set up
>  a petri dish, try out a bunch of known infectious agents,
>  and see which one of them reproduce.
>
>  I haven't done anything like that myself, but I imagine
>  a good place to start might be to script an instance
>  of mozilla or ies4linux visiting the top sites listed at
>  http://www.stopbadware.org/home/topsites
>  and see if they're able to modify the system at all.
>  - Dan
>


From dank at kegel.com  Thu Mar 13 14:35:24 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 13 Mar 2008 11:35:24 -0800
Subject: wine virus story
In-Reply-To: <d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
	<20080313162737.GA29108@suse.de>
	<d6c5d7290803131112o71a0121dhce7a6d6c60277e6@mail.gmail.com>
	<a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
	<d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com>
Message-ID: <a71bd89a0803131235s272b9ab8o649d0eacaac82209@mail.gmail.com>

On 3/13/08, Edward Savage <epssyis at gmail.com> wrote:
> This sounds like some thing I'd be able to do though I'm not sure of
>  the best way to sand box wine away from the system.  What is the best
>  way to go about this, would simply creating a new user be enough to
>  protect a system, or does a vm have to be used?

I would totally do it in a virtual machine.


From arbuckle911 at gmail.com  Thu Mar 13 14:36:25 2008
From: arbuckle911 at gmail.com (Christopher Harvey)
Date: Thu, 13 Mar 2008 15:36:25 -0400
Subject: wine virus story
In-Reply-To: <a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>	<20080313162737.GA29108@suse.de>	<d6c5d7290803131112o71a0121dhce7a6d6c60277e6@mail.gmail.com>
	<a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
Message-ID: <47D98239.2020200@gmail.com>

Dan Kegel wrote:
> On 3/13/08, Edward Savage <epssyis at gmail.com> wrote:
>   
>>  Just as a silly outside thought; would it be worth keeping track of
>>  some of the bigger windows virus so we can see how good wine
>>  compatibiliy with all of the nitty gritty bugs of windows really is?
>>  Also this would allow us to identify dangerous areas in wine were the
>>  ability to affect the linux environment cross over.
>>     
>
> Yes, it would be good to keep an eye on that.
>
> Ideally we'd have an automated script to set up
> a petri dish, try out a bunch of known infectious agents,
> and see which one of them reproduce.
>
> I haven't done anything like that myself, but I imagine
> a good place to start might be to script an instance
> of mozilla or ies4linux visiting the top sites listed at
> http://www.stopbadware.org/home/topsites
> and see if they're able to modify the system at all.
> - Dan
>
>
>
>   
I like that idea. are there any linux tools to watch files for changes? 
Or maybe have linux watch the wine processes for their file changing 
activities.


From vit.hrachovy at sandbox.cz  Thu Mar 13 14:46:42 2008
From: vit.hrachovy at sandbox.cz (=?ISO-8859-2?Q?V=EDt_Hrachov=FD?=)
Date: Thu, 13 Mar 2008 20:46:42 +0100
Subject: wine virus story
In-Reply-To: <47D98239.2020200@gmail.com>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>	<20080313162737.GA29108@suse.de>	<d6c5d7290803131112o71a0121dhce7a6d6c60277e6@mail.gmail.com>	<a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
	<47D98239.2020200@gmail.com>
Message-ID: <47D984A2.3070802@sandbox.cz>

> I like that idea. are there any linux tools to watch files for changes? 
> Or maybe have linux watch the wine processes for their file changing 
> activities.

I've used tripwire for a long time.

fschange looks promising, builds upon inotify, but I've never used it yet:

http://stefan.buettcher.org/cs/fschange/index.html

Cheers
Vit


From research at science.su  Thu Mar 13 14:49:11 2008
From: research at science.su (L. Rahyen)
Date: Thu, 13 Mar 2008 19:49:11 +0000
Subject: wine virus story
In-Reply-To: <d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
	<a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
	<d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com>
Message-ID: <200803131949.11704.research@science.su>

On Thursday March 13 2008 19:31:49 Edward Savage wrote:
> This sounds like some thing I'd be able to do though I'm not sure of
> the best way to sand box wine away from the system.  What is the best
> way to go about this, would simply creating a new user be enough to
> protect a system, or does a vm have to be used?

	Separate user is enough if you don't have world writable files in your 
system. And of course user for such purpose shouldn't be in group(s) that 
have write access to your personal or system files.
	If you are unsure use VirtualBox ( http://virtualbox.org/ ) - it's free and 
open-source, or VMWare ( http://vmware.com/ ) - it's not free.
	On Debian (and probably Ubuntu) you can install VirtualBox by running "sudo 
apt-get install virtualbox".
	I do not recommend to use QEmu because it's less user friendly than 
VirtualBox (BTW, VirtualBox is based on QEmu).


From julliard at winehq.org  Thu Mar 13 14:52:11 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 13 Mar 2008 20:52:11 +0100
Subject: mshtml: Return full patch in res protocol's secure URL.
In-Reply-To: <47D91FE7.4030901@codeweavers.com> (Jacek Caban's message of
	"Thu, 13 Mar 2008 13:36:55 +0100")
References: <47D91FE7.4030901@codeweavers.com>
Message-ID: <871w6ez9jo.fsf@wine.dyndns.org>

Jacek Caban <jacek at codeweavers.com> writes:

> ---
>  dlls/mshtml/protocol.c       |   31 +++++++++++++++++++++----------
>  dlls/mshtml/tests/protocol.c |   41
> ++++++++++++++++++++++++++++++++++++++++-
>  2 files changed, 61 insertions(+), 11 deletions(-)

This breaks the tests:

../../../tools/runtest -q -P wine -M urlmon.dll -T ../../.. -p urlmon_test.exe.so misc.c && touch misc.ok
misc.c:775: Test failed: [0] size=39, expected 9
misc.c:777: Test failed: [0] wrong secid
make: *** [misc.ok] Error 2

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Mar 13 14:53:06 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 13 Mar 2008 20:53:06 +0100
Subject: fonts: Start of the Symbol font.
In-Reply-To: <8763vqzdfq.fsf@totally-fudged-out-message-id> (Huw Davies's
	message of "Thu, 13 Mar 2008 17:05:38 +0000")
References: <8763vqzdfq.fsf@totally-fudged-out-message-id>
Message-ID: <87wso6xuxp.fsf@wine.dyndns.org>

Huw Davies <huw at codeweavers.com> writes:

> ---
>  fonts/Makefile.in |    1 +
>  fonts/symbol.sfd  |   83 +++++++++++++++++++++++++++++++++++++++++++++++++++++
>  2 files changed, 84 insertions(+), 0 deletions(-)
>  create mode 100644 fonts/symbol.sfd

It fails make test for me:

../../../tools/runtest -q -P wine -M gdi32.dll -T ../../.. -p gdi32_test.exe.so font.c && touch font.ok
font.c:1357: Test failed: no fonts should be enumerated: Symbol ANSI_CHARSET
font.c:1405: Test failed: SYMBOL_CHARSET should NOT enumerate ANSI_CHARSET for Symbol
font.c:1407: Test failed: SYMBOL_CHARSET should enumerate SYMBOL_CHARSET for Symbol
font.c:1447: Test failed: no fonts enumerated: Symbol SYMBOL_CHARSET
font.c:1458: Test failed: SYMBOL_CHARSET should enumerate SYMBOL_CHARSET for Symbol
font.c:1639: Test failed: A: tmLastChar for Symbol 20 != ff
font.c:1671: Test failed: W: tmFirstChar for Symbol 00 != 30
make: *** [font.ok] Error 7

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Thu Mar 13 14:53:41 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 13 Mar 2008 11:53:41 -0800
Subject: wine virus story
In-Reply-To: <200803131949.11704.research@science.su>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
	<a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
	<d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com>
	<200803131949.11704.research@science.su>
Message-ID: <a71bd89a0803131253y10b5b459n73bdff9ba3be93e@mail.gmail.com>

On 3/13/08, L. Rahyen <research at science.su> wrote:
>         Separate user is enough if you don't have world writable files in your
>  system.

No, because the malware could root your Linux system
using a local priv escalation exploit.  You really want a
totally isolated sandbox.
- Dan


From sgoth at roath.org  Thu Mar 13 13:52:44 2008
From: sgoth at roath.org (Sebastian Goth)
Date: Thu, 13 Mar 2008 19:52:44 +0100
Subject: Configure not throwing error for missing asoundlib.h
Message-ID: <200803131953.05712.sgoth@roath.org>

Hi,
even with "--with-alsa" there is no report on a missing asoundlib.h.
This is a bit inconvenient since other missing libs are reported.

Valid for wine-0.9.57

Sebastian
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080313/454314df/attachment.pgp 

From thestig at google.com  Thu Mar 13 14:58:13 2008
From: thestig at google.com (Lei Zhang)
Date: Thu, 13 Mar 2008 12:58:13 -0700
Subject: wine virus story
In-Reply-To: <200803131949.11704.research@science.su>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
	<a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
	<d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com>
	<200803131949.11704.research@science.su>
Message-ID: <558b2f5c0803131258j3e45b501keadd68cee3e7e565@mail.gmail.com>

On Thu, Mar 13, 2008 at 12:49 PM, L. Rahyen <research at science.su> wrote:
>         Separate user is enough if you don't have world writable files in your
>  system. And of course user for such purpose shouldn't be in group(s) that
>  have write access to your personal or system files.
>         If you are unsure use VirtualBox ( http://virtualbox.org/ ) - it's free and
>  open-source, or VMWare ( http://vmware.com/ ) - it's not free.
>         On Debian (and probably Ubuntu) you can install VirtualBox by running "sudo
>  apt-get install virtualbox".
>         I do not recommend to use QEmu because it's less user friendly than
>  VirtualBox (BTW, VirtualBox is based on QEmu).
>

VMWare workstation is not free, but you can get both VMWare server and
VMWare player at no charge. It's  available from the Canonical
repositories as well:
http://archive.canonical.com/ubuntu/pool/partner/v/vmware-server/


From dank at kegel.com  Thu Mar 13 15:30:40 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 13 Mar 2008 12:30:40 -0800
Subject: Please vote for your favorite Wine-1.0 bugs...
Message-ID: <a71bd89a0803131330j1c55e5c1k97db527ffa509637@mail.gmail.com>

The 1.0 release of Wine is tenatively scheduled for
the 15th anniversary of the project (roughly 1 June 2008,
if you take Dan Dulitz' message as the start of the project,
http://groups.google.com/group/comp.os.linux/msg/7f92abdf494ab8b3 )

Over the last six or so months, the wine developers have
identified 180 or so bugs as possibly being worth fixing
before the 1.0 release.

63 of the Wine 1.0 bugs have already been fixed:
http://bugs.winehq.org/buglist.cgi?target_milestone=1.0.0&resolution=FIXED

101 are left to fix:
http://bugs.winehq.org/buglist.cgi?target_milestone=1.0.0&resolution=---

We can't fix all of these before the 1.0 release; we'll have to
leave some for later.
If you want a say in which of these bugs get fixed sooner,
please vote for your favorite bugs.  To do this,
sign into Bugzilla (you need to register, but that's easy),
pull up your favorite bug from the above list,
and click on the 'Vote for this bug' link on the bug.

We can't promise we'll fix the bugs with the most votes,
but knowing which ones are most popular can't hurt.

Thanks,
Dan


From us at edmeades.me.uk  Thu Mar 13 16:19:17 2008
From: us at edmeades.me.uk (Ann & Jason Edmeades)
Date: Thu, 13 Mar 2008 21:19:17 -0000
Subject: Clipping regions on windows and Expose Xevents issue
In-Reply-To: <87iqzqzx5z.fsf@wine.dyndns.org>
Message-ID: <000201c8854f$e97f3e00$1001a8c0@JasonsPC>

Thanks Alexandre,

(BTW This createwindow / movewindow / draw to window is all occurring in
LBUTTONDOWN processing)

>> 1. MoveWindow doesn't update the DCEx clip_region region, and hence when
the
>> visible region changes, it is merged with the clip region and since there
is
>> no overlap the visible region is empty so all subsequent processing ends.
>>
>> Q: Whats the best way to handle that - I was tempted to reset the
>> clip_region to the visible_region (as MSDN sort of implies - you cant
really
>> query them so tests don't help much here) in a movewindow call

>You can query the visible region, so with well-chosen dimensions and
>clip region it shouldn't be too hard to write test cases. Make sure you
>test both GetDCEx with an explicit clip region and BeginPaint, the
>behavior is probably different

The difficulty here is the inability to directly query the concealed (within
the struct DCE) clip_rgn not the visible region. For example, GetClipRgn
returns dc->hClipRgn, whereas the dce clip_rgn is internal to user32
painting.c. The only call I can see replaces the region with GetDCEx? 

What kind of test did you have in mind - The only idea I had was something
like CreateWindow at 100,100, begin paint, MoveWindow to 50,50, FillRect
into red, endpaint, then read it back to see if it really is read?


>> Q: This is getting way outside my understanding of X events, but
shouldn't
>> the Expose event for the child (popup) window be processed before
returning
>> from CreateWindow with style WS_VISIBLE?

>The way we hack around the asynchronous events is by checking for expose
>events in UpdateWindow, but of course if the app doesn't even use that
>it won't help. And on a slow connection the expose events will always
>arrive too late anyway. We'd need to explicitly wait for the event, but
>that would hurt badly on slow connections.

The app is processing in a WM_LBUTTONDOWN, and just creates a window and
draws to it immediately, and the windows message loop wont redraw it. Is
there any workaround for this or is it going to be an impossibility to get
it working? (I wondered, for example, if we can do anything about ignoring
the first expose if the window was created as visible, or removing the
rdw_erase if the window had explicitly painted itself before the first
event)?

Jason




From scott at open-vote.org  Thu Mar 13 17:54:43 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Thu, 13 Mar 2008 15:54:43 -0700
Subject: GSoC
In-Reply-To: <47D96054.6050301@gmail.com>
References: <1dd4d8b40803130731r6681a702x9112f3abac8b795a@mail.gmail.com>
	<47D96054.6050301@gmail.com>
Message-ID: <47D9B0B3.7050205@open-vote.org>

Christopher Harvey wrote:
> I've had a few ideas that I thought of on my own, but now I'm starting 
> to see they perhaps aren't as useful as the ideas thought of by current 
> developers, but I'll float it out there one last time. I thought it 
> would be cool to create a wine GUI overlay for games, exactly like 
> nvPerfHUD. The thing about doing it in wine that makes it better than 
> nvPerHUD is the fact the to use nvPerfHUD the apps have to give 
> permission for nvPerHUD to run on them. A wine version would actually be 
> able to force every single 3d app, opengl or directX to output nvPerfHUD 
> like output. Anyway, just a thought. Would I be able to apply for both 
> of these projects and pick one last minute?
> Thanks,
> Chris.
> 

After talking about the concept a bit at the Ubuntu Developer Summit, I
really don't like the idea of a "Wine GUI" just for running Wine
applications.  From the user's persepctive, installers for Wine
applications shouldn't be substantially different from any old Linux
installer - they just click on them, it adds something to their
applications menu, and from then on they can run it from there.

Most of the futzing with applications, like messing around with native
dlls in winecfg, shouldn't have to be done at all.  The same goes with
editing the registry.

Configuration we'll never be able to eliminate completely, like
selecting the windows version, should ultimately be done through an
intuitive place and not some central "Wine configuration" program.  For
instance, I should be able to right click a Windows application, select
properties, and then change the Windows version from there.

So, yes, I agree.  Winecfg is ugly and inadequate for the kind of
configuration our users are doing now.  But before we put too much
effort into sprucing up Winecfg, let's instead talk about how feasible
it is to make it unneeded in the first place.


Thanks,
Scott Ritchie


From dsh at linux.ucla.edu  Thu Mar 13 18:04:19 2008
From: dsh at linux.ucla.edu (Dan Hipschman)
Date: Thu, 13 Mar 2008 16:04:19 -0700
Subject: [3/6] kernel32: Add the MOVEFILE_WRITE_THROUGH flag (stub) for
	MoveFileEx.
In-Reply-To: <20080313230032.GO4608@linux.ucla.edu>
References: <20080313230032.GO4608@linux.ucla.edu>
Message-ID: <20080313230419.GP4608@linux.ucla.edu>


Yup, ignore.

On Thu, Mar 13, 2008 at 04:00:32PM -0700, Dan Hipschman wrote:
> 
> NOTE: I thought I sent this with the other five patches, but I don't see
> it.  Sorry if it ends up being a resend.
> 
> This feature of MoveFileEx is technically needed by IBackgroundCopyJob_Complete
> to return the correct status if it has to move temp files across volumes, but
> since it's a very small point, I'm just adding the flag so we can compile with
> it.
> 
> ---
>  dlls/kernel32/path.c |    3 +++
>  include/winbase.h    |    1 +
>  2 files changed, 4 insertions(+), 0 deletions(-)
> 
> diff --git a/dlls/kernel32/path.c b/dlls/kernel32/path.c
> index f0f713f..aad260f 100644
> --- a/dlls/kernel32/path.c
> +++ b/dlls/kernel32/path.c
> @@ -1010,6 +1010,9 @@ BOOL WINAPI MoveFileWithProgressW( LPCWSTR source, LPCWSTR dest,
>      if (!dest)
>          return DeleteFileW( source );
>  
> +    if (flag & MOVEFILE_WRITE_THROUGH)
> +        FIXME("MOVEFILE_WRITE_THROUGH unimplemented\n");
> +
>      /* check if we are allowed to rename the source */
>  
>      if (!RtlDosPathNameToNtPathName_U( source, &nt_name, NULL, NULL ))
> diff --git a/include/winbase.h b/include/winbase.h
> index e2ee515..f3130a0 100644
> --- a/include/winbase.h
> +++ b/include/winbase.h
> @@ -845,6 +845,7 @@ typedef DWORD (CALLBACK *LPPROGRESS_ROUTINE)(LARGE_INTEGER, LARGE_INTEGER, LARGE
>  #define MOVEFILE_REPLACE_EXISTING       0x00000001
>  #define MOVEFILE_COPY_ALLOWED           0x00000002
>  #define MOVEFILE_DELAY_UNTIL_REBOOT     0x00000004
> +#define MOVEFILE_WRITE_THROUGH          0x00000008
>  
>  #define REPLACEFILE_WRITE_THROUGH       0x00000001
>  #define REPLACEFILE_IGNORE_MERGE_ERRORS 0x00000002
> 
> 


From jjmckenzie51 at sprintpcs.com  Thu Mar 13 22:36:04 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Thu, 13 Mar 2008 20:36:04 -0700
Subject: [Wine] How should I educate myself in order to code for WineHQ?
In-Reply-To: <a71bd89a0803121721w3ec8b82agcb84d9bad50cd972@mail.gmail.com>
References: <1205367112.m2f.1159@forum.winehq.org>
	<a71bd89a0803121721w3ec8b82agcb84d9bad50cd972@mail.gmail.com>
Message-ID: <47D9F2A4.2000500@sprintpcs.com>

Dan Kegel wrote:
> On Wed, Mar 12, 2008 at 5:11 PM, jingo811 <wineforum-user at winehq.org> wrote:
>   
>>  So I was wondering can you give me an ordered to-do-list in becoming a Code Monkey for WineHQ?
>>
>>         Like do I have to know both C and C++ to code for Wine.
>>     
>
> Nope, just C.  Go through "The C Programming Language" by
> Kernighan and Ritchie, and do all the exercizes.
>
>   
If you can make it through the book, you are very good and will work 
well for the Wine project.

BTW, anyone want a spare copy of this book?

James




From dmitry at codeweavers.com  Thu Mar 13 23:44:31 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 14 Mar 2008 12:44:31 +0800
Subject: [Wine] How should I educate myself in order to code for WineHQ?
References: <1205367112.m2f.1159@forum.winehq.org><a71bd89a0803121721w3ec8b82agcb84d9bad50cd972@mail.gmail.com>
	<47D9F2A4.2000500@sprintpcs.com>
Message-ID: <00b701c8858e$1999cfe0$a600fea9@DMITRY>

"James McKenzie" <jjmckenzie51 at sprintpcs.com> wrote:

> Dan Kegel wrote:
>> On Wed, Mar 12, 2008 at 5:11 PM, jingo811 <wineforum-user at winehq.org> wrote:
>>   
>>>  So I was wondering can you give me an ordered to-do-list in becoming a Code Monkey for WineHQ?
>>>
>>>         Like do I have to know both C and C++ to code for Wine.
>>>     
>>
>> Nope, just C.  Go through "The C Programming Language" by
>> Kernighan and Ritchie, and do all the exercizes.
>>
>>   
> If you can make it through the book, you are very good and will work 
> well for the Wine project.
> 
> BTW, anyone want a spare copy of this book?

Unfortunately that's not that simple. Wine programming requires Windows
API programming skills as well, one needs an experience of using at least
APIs for the component(s) of Wine he/she is going to write the code for,
and a good knowledge how it's supposed to work/operate internally. One
should be prepared to write lots of tests to investigate/clarify behaviour
described/missing in MSDN.

-- 
Dmitry.


From epssyis at gmail.com  Fri Mar 14 03:22:05 2008
From: epssyis at gmail.com (Edward Savage)
Date: Fri, 14 Mar 2008 19:22:05 +1100
Subject: wine virus story
In-Reply-To: <558b2f5c0803131258j3e45b501keadd68cee3e7e565@mail.gmail.com>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
	<a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
	<d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com>
	<200803131949.11704.research@science.su>
	<558b2f5c0803131258j3e45b501keadd68cee3e7e565@mail.gmail.com>
Message-ID: <d6c5d7290803140122x10d45044q88f1e0c388c3f3d2@mail.gmail.com>

I've made a good start on a script that grabs a list of virus from
around the internet and attempts to run each one and then reports
changes in wine and then resets the wine structure.  I'll be testing
with the above two file change tools to see which one works best (I
was just using a small one from freshmeat) though I'm interested as to
what else I should be looking for in results? At the moment I'm just
reporting crash details and file changes then using human inspection
to see how well it did.

I just thought it might be a good idea to build a mailing list that
goes to the local (vm) system then check if the local systems mail was
spammed and report that.  Looking for more suggestions like this.

Also I'm using qemu running debian at the moment.  Of course the
script wont care which vm you use.  For those thinking that qemu is
painful to use install qemulator and the kqemu kernel package and
you're set.  Though I'm not really sure this is the sort of thing we
want new users to be attempting so easy of use of the vm shouldn't be
important.

For those interested I've tested the top five virus listed on symantec
and none of them have caused any serious issues, all malware I've
tried has failed completely due to the lack of IE.  I'll be setting up
two build environments in the script, one with IE and one with native
wine claiming ie (or not depending on responces).

Finally, where would be the right place to report the results? Appdb
seems like a strange place to be putting results of this nature. :P

Edward

On Fri, Mar 14, 2008 at 6:58 AM, Lei Zhang <thestig at google.com> wrote:
> On Thu, Mar 13, 2008 at 12:49 PM, L. Rahyen <research at science.su> wrote:
>  >         Separate user is enough if you don't have world writable files in your
>  >  system. And of course user for such purpose shouldn't be in group(s) that
>  >  have write access to your personal or system files.
>  >         If you are unsure use VirtualBox ( http://virtualbox.org/ ) - it's free and
>  >  open-source, or VMWare ( http://vmware.com/ ) - it's not free.
>  >         On Debian (and probably Ubuntu) you can install VirtualBox by running "sudo
>  >  apt-get install virtualbox".
>  >         I do not recommend to use QEmu because it's less user friendly than
>  >  VirtualBox (BTW, VirtualBox is based on QEmu).
>  >
>
>  VMWare workstation is not free, but you can get both VMWare server and
>  VMWare player at no charge. It's  available from the Canonical
>  repositories as well:
>  http://archive.canonical.com/ubuntu/pool/partner/v/vmware-server/
>
>
>


From dmitry at codeweavers.com  Fri Mar 14 03:40:23 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 14 Mar 2008 16:40:23 +0800
Subject: wine virus story
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com><a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com><d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com><200803131949.11704.research@science.su><558b2f5c0803131258j3e45b501keadd68cee3e7e565@mail.gmail.com>
	<d6c5d7290803140122x10d45044q88f1e0c388c3f3d2@mail.gmail.com>
Message-ID: <028301c885af$0d59d060$a600fea9@DMITRY>

"Edward Savage" <epssyis at gmail.com> wrote:

> Finally, where would be the right place to report the results? Appdb
> seems like a strange place to be putting results of this nature. :P

Since Windows viruses use Win32 APIs that's not surprising that they
work under Wine. What you are doing doesn't have IMO any practical means,
except probably hurting Wine by creating an image of Wine as a platform
for Windows viruses under Linux (which is not true).

-- 
Dmitry.


From epssyis at gmail.com  Fri Mar 14 03:59:45 2008
From: epssyis at gmail.com (Edward Savage)
Date: Fri, 14 Mar 2008 19:59:45 +1100
Subject: wine virus story
In-Reply-To: <028301c885af$0d59d060$a600fea9@DMITRY>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
	<a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
	<d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com>
	<200803131949.11704.research@science.su>
	<558b2f5c0803131258j3e45b501keadd68cee3e7e565@mail.gmail.com>
	<d6c5d7290803140122x10d45044q88f1e0c388c3f3d2@mail.gmail.com>
	<028301c885af$0d59d060$a600fea9@DMITRY>
Message-ID: <d6c5d7290803140159p71faea93v39f560ae46989391@mail.gmail.com>

The assumption is that since win32 virus are so windows specific and
require so many small windows bugs and tweaks to run that they are a
good test bed to see how good windows compatibility really is.  In
general they are also rather badly written so finding linux-wine
compatibility issues should also be possible as well, we know they run
under windows so if they don't under wine then that is an issue that
should be looked at that could also fix other legit applications.

Besides I hardly think that is part of an image that doesn't already
exist or is even bad for the project.  When I've seen wine in the
media (a good number of times now) the comment has been, paraphrased,
'so good that it can even run some windows virus'.

I would suggest that the real media damage would come from any virus
running that we don't know about and then root kits or wipes some poor
newbies system.  I can see the slashdot headline now, "Users under
threat from unknown virus risks when using Wine".

I'm happy to just do this as a pet project and maybe report findings
for wwn or similar but in general I think it'd be some thing worth at
least keeping track of officially.

On Fri, Mar 14, 2008 at 7:40 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> "Edward Savage" <epssyis at gmail.com> wrote:
>
>
> > Finally, where would be the right place to report the results? Appdb
>  > seems like a strange place to be putting results of this nature. :P
>
>  Since Windows viruses use Win32 APIs that's not surprising that they
>  work under Wine. What you are doing doesn't have IMO any practical means,
>  except probably hurting Wine by creating an image of Wine as a platform
>  for Windows viruses under Linux (which is not true).
>
>  --
>  Dmitry.
>


From dotancohen at gmail.com  Thu Mar 13 15:39:49 2008
From: dotancohen at gmail.com (Dotan Cohen)
Date: Thu, 13 Mar 2008 22:39:49 +0200
Subject: [Wine] Please vote for your favorite Wine-1.0 bugs...
In-Reply-To: <a71bd89a0803131330j1c55e5c1k97db527ffa509637@mail.gmail.com>
References: <a71bd89a0803131330j1c55e5c1k97db527ffa509637@mail.gmail.com>
Message-ID: <880dece00803131339k325797acre109f66af1d7514c@mail.gmail.com>

On 13/03/2008, Dan Kegel <dank at kegel.com> wrote:
> The 1.0 release of Wine is tenatively scheduled for
>  the 15th anniversary of the project (roughly 1 June 2008,
>  if you take Dan Dulitz' message as the start of the project,
>  http://groups.google.com/group/comp.os.linux/msg/7f92abdf494ab8b3 )
>
>  Over the last six or so months, the wine developers have
>  identified 180 or so bugs as possibly being worth fixing
>  before the 1.0 release.
>
>  63 of the Wine 1.0 bugs have already been fixed:
>  http://bugs.winehq.org/buglist.cgi?target_milestone=1.0.0&resolution=FIXED
>
>  101 are left to fix:
>  http://bugs.winehq.org/buglist.cgi?target_milestone=1.0.0&resolution=---
>
>  We can't fix all of these before the 1.0 release; we'll have to
>  leave some for later.
>  If you want a say in which of these bugs get fixed sooner,
>  please vote for your favorite bugs.  To do this,
>  sign into Bugzilla (you need to register, but that's easy),
>  pull up your favorite bug from the above list,
>  and click on the 'Vote for this bug' link on the bug.
>
>  We can't promise we'll fix the bugs with the most votes,
>  but knowing which ones are most popular can't hurt.
>
>  Thanks,
>
> Dan

Thank _you_ Dan. I'm heading over there now.

Dotan Cohen

http://what-is-what.com
http://gibberish.co.il
?-?-?-?-?-?-?-?-?-?-?-?-?-?-?-?-?-?-?-?-?-?-?-?-?-?-?

A: Because it messes up the order in which people normally read text.
Q: Why is top-posting such a bad thing?

From dmitry at codeweavers.com  Fri Mar 14 04:15:13 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 14 Mar 2008 17:15:13 +0800
Subject: wine virus story
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com><a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com><d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com><200803131949.11704.research@science.su><558b2f5c0803131258j3e45b501keadd68cee3e7e565@mail.gmail.com><d6c5d7290803140122x10d45044q88f1e0c388c3f3d2@mail.gmail.com><028301c885af$0d59d060$a600fea9@DMITRY>
	<d6c5d7290803140159p71faea93v39f560ae46989391@mail.gmail.com>
Message-ID: <02a401c885b3$ead113f0$a600fea9@DMITRY>

"Edward Savage" <epssyis at gmail.com> wrote:

> The assumption is that since win32 virus are so windows specific and
> require so many small windows bugs and tweaks to run that they are a
> good test bed to see how good windows compatibility really is.  In
> general they are also rather badly written so finding linux-wine
> compatibility issues should also be possible as well, we know they run
> under windows so if they don't under wine then that is an issue that
> should be looked at that could also fix other legit applications.

If you have plenty of free time in your hands it would be much better
spent with testing real applications, or rather triaging bugs in Wine
bugzilla.

> Besides I hardly think that is part of an image that doesn't already
> exist or is even bad for the project.  When I've seen wine in the
> media (a good number of times now) the comment has been, paraphrased,
> 'so good that it can even run some windows virus'.
> 
> I would suggest that the real media damage would come from any virus
> running that we don't know about and then root kits or wipes some poor
> newbies system.  I can see the slashdot headline now, "Users under
> threat from unknown virus risks when using Wine".
> 
> I'm happy to just do this as a pet project and maybe report findings
> for wwn or similar but in general I think it'd be some thing worth at
> least keeping track of officially.

That's exactly what hurts Wine: a misguided report of a clueless user,
and WWN is not the place for it neither.

-- 
Dmitry.


From epssyis at gmail.com  Fri Mar 14 04:17:10 2008
From: epssyis at gmail.com (Edward Savage)
Date: Fri, 14 Mar 2008 20:17:10 +1100
Subject: wine virus story
In-Reply-To: <02a401c885b3$ead113f0$a600fea9@DMITRY>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
	<a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
	<d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com>
	<200803131949.11704.research@science.su>
	<558b2f5c0803131258j3e45b501keadd68cee3e7e565@mail.gmail.com>
	<d6c5d7290803140122x10d45044q88f1e0c388c3f3d2@mail.gmail.com>
	<028301c885af$0d59d060$a600fea9@DMITRY>
	<d6c5d7290803140159p71faea93v39f560ae46989391@mail.gmail.com>
	<02a401c885b3$ead113f0$a600fea9@DMITRY>
Message-ID: <d6c5d7290803140217i1be87376te9db38081b6ec39d@mail.gmail.com>

>  That's exactly what hurts Wine: a misguided report of a clueless user,
>  and WWN is not the place for it neither.
>

Thanks.


From dmitry at codeweavers.com  Fri Mar 14 06:12:59 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 14 Mar 2008 19:12:59 +0800
Subject: msvcrt: Implement wcscat_s
References: <frdk13$s7e$1@ger.gmane.org>
Message-ID: <034e01c885c4$5e6746d0$a600fea9@DMITRY>

"Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote:

> +@ cdecl wcscat_s(ptr long wstr) MSVCRT_wcscat_s

The first parameter has type wstr. Also, please check actual
buffer contents in the tests not just the return values.

-- 
Dmitry.


From julliard at winehq.org  Fri Mar 14 07:05:45 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 14 Mar 2008 13:05:45 +0100
Subject: regedit: stdin is not seekable so do not try to seek the input
	file if it is not seekable
In-Reply-To: <47DA1F74.302@codeweavers.com> (Aric Stewart's message of "Fri,
	14 Mar 2008 15:47:16 +0900")
References: <47DA1F74.302@codeweavers.com>
Message-ID: <87prtxy0h2.fsf@wine.dyndns.org>

Aric Stewart <aric at codeweavers.com> writes:

> ---
>  programs/regedit/regedit.c |    2 +-
>  programs/regedit/regproc.c |   19 +++++++++++--------
>  programs/regedit/regproc.h |    2 +-
>  3 files changed, 13 insertions(+), 10 deletions(-)

We shouldn't need to seek at all, instead it should be easy to test the
first two bytes of the first line before processing it.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Mar 14 07:25:42 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 14 Mar 2008 13:25:42 +0100
Subject: [PATCH] (RESUBMIT) wininet: restructure for better return checking
In-Reply-To: <87tzjaxonu.fsf@totally-fudged-out-message-id> (Marcus Meissner's
	message of "Thu, 13 Mar 2008 19:23:24 +0100")
References: <87tzjaxonu.fsf@totally-fudged-out-message-id>
Message-ID: <87lk4lxzjt.fsf@wine.dyndns.org>

Marcus Meissner <marcus at jet.franken.de> writes:

> Coverity spotted some potential lpwhh NULL usage
> after NULL checking.
>
> I restructured the code a bit to check lpwhh
> earlier and return at that time. Also removed a
> unnecessary cast.

This doesn't work:

../../../tools/runtest -q -P wine -M wininet.dll -T ../../.. -p wininet_test.exe.so internet.c && touch internet.ok
internet.c:118: Test failed: InternetSetOptionA failed 6, expected ERROR_INTERNET_INVALID_OPTION
make[2]: *** [internet.ok] Error 1

-- 
Alexandre Julliard
julliard at winehq.org


From aric at codeweavers.com  Fri Mar 14 07:49:21 2008
From: aric at codeweavers.com (Aric Stewart)
Date: Fri, 14 Mar 2008 21:49:21 +0900
Subject: regedit: stdin is not seekable so do not try to seek the input
	file if it is not seekable
In-Reply-To: <87prtxy0h2.fsf@wine.dyndns.org>
References: <47DA1F74.302@codeweavers.com> <87prtxy0h2.fsf@wine.dyndns.org>
Message-ID: <47DA7451.7080103@codeweavers.com>

True, through I did not add the code that was doing the seeking so i 
tried to not be too intrusive.

Should I rework the way we do the line processing to be able to do this 
then?

-aric

Alexandre Julliard wrote:
> Aric Stewart <aric at codeweavers.com> writes:
> 
>> ---
>>  programs/regedit/regedit.c |    2 +-
>>  programs/regedit/regproc.c |   19 +++++++++++--------
>>  programs/regedit/regproc.h |    2 +-
>>  3 files changed, 13 insertions(+), 10 deletions(-)
> 
> We shouldn't need to seek at all, instead it should be easy to test the
> first two bytes of the first line before processing it.
> 


From paul.vriens.wine at gmail.com  Fri Mar 14 08:03:31 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 14 Mar 2008 14:03:31 +0100
Subject: Running services in WINE?
In-Reply-To: <47D8C6B9.8030607@procyongames.com>
References: <47D82648.30208@procyongames.com>	<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>
	<47D8C6B9.8030607@procyongames.com>
Message-ID: <47DA77A3.8060206@gmail.com>

Christopher wrote:
> Maarten Lankhorst wrote:
>> Hi Christopher,
>>
>> 2008/3/12, Christopher <raccoonone at procyongames.com>:
>>   
>>> I've been trying to get MozyHome working on WINE, and have made a little
>>>  progress. However, it seems that the service which Mozy uses won't
>>>  start. Searching a bit I found a thread from a year ago stating that
>>>  services don't work in WINE, but that it was being worked on. Are
>>>  services implemented in WINE now, or if they're not is someone working
>>>  on it who I could help out?
>>>     
>> Services most definitely work now. Some of them you can start manually
>> with "wine net start 'servicename'", however this shouldn't be needed.
>>
>> Cheers,
>> Maarten.
>>
>>
>>   
> Thanks Maarten!
> I tried that, but didn't have anymore luck. The service exits almost 
> immediately, after giving a few fixme messages. Time to do some 
> debugging I guess :)
> 
> Christopher
> 
> 
> 
I've been looking into this and found an issue in Wine that I'm not sure who to 
test or solve yet.

MozyHome creates a key in the Services branch:

System\\CurrentControlSet\\Services\\mozybackup

It than adds a 'Description' value to this key.

A bit later it checks for the service by doing an OpenService. This succeeds on 
Wine but shouldn't.

I've created a simple test that creates the key and some value in it. Doing an 
OpenService fails every time on Windows.

I took another approach whereby I created a proper service (CreateService) and 
checked whether I could do an OpenService. This succeeded every time even after 
deleting the whole key.

What it boils down to is that the service control manager keeps track of the 
services. Only proper service calls can influence the service control manager 
(or a reboot).

So as long as we don't implement some service control manager functionality 
(services.exe?) we could have some issues as with MozyHome.

One approach we could take while we don't have the full functionality is to 
check for the minimal required parameters (value) we need for a service. Would 
that be acceptable?

I think Maarten's patch for CreateService was along those same lines 
(http://source.winehq.org/git/wine.git/?a=commit;h=284f86183cce638ff8fce4023cb76273e979aa09). 
We need to find a better way of checking whether a service is truly installed. 
(and not just some registry keys).

-- 
Cheers,

Paul.


From julliard at winehq.org  Fri Mar 14 08:20:38 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 14 Mar 2008 14:20:38 +0100
Subject: regedit: stdin is not seekable so do not try to seek the input
	file if it is not seekable
In-Reply-To: <47DA7451.7080103@codeweavers.com> (Aric Stewart's message of
	"Fri, 14 Mar 2008 21:49:21 +0900")
References: <47DA1F74.302@codeweavers.com> <87prtxy0h2.fsf@wine.dyndns.org>
	<47DA7451.7080103@codeweavers.com>
Message-ID: <87hcf9xx09.fsf@wine.dyndns.org>

Aric Stewart <aric at codeweavers.com> writes:

> True, through I did not add the code that was doing the seeking so i
> tried to not be too intrusive.
>
> Should I rework the way we do the line processing to be able to do
> this then?

Yes please.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Mar 14 08:27:48 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 14 Mar 2008 14:27:48 +0100
Subject: Clipping regions on windows and Expose Xevents issue
In-Reply-To: <000201c8854f$e97f3e00$1001a8c0@JasonsPC> (Ann & Jason Edmeades's
	message of "Thu, 13 Mar 2008 21:19:17 -0000")
References: <000201c8854f$e97f3e00$1001a8c0@JasonsPC>
Message-ID: <87d4pxxwob.fsf@wine.dyndns.org>

"Ann & Jason Edmeades" <us at edmeades.me.uk> writes:

> The difficulty here is the inability to directly query the concealed (within
> the struct DCE) clip_rgn not the visible region. For example, GetClipRgn
> returns dc->hClipRgn, whereas the dce clip_rgn is internal to user32
> painting.c. The only call I can see replaces the region with GetDCEx? 
>
> What kind of test did you have in mind - The only idea I had was something
> like CreateWindow at 100,100, begin paint, MoveWindow to 50,50, FillRect
> into red, endpaint, then read it back to see if it really is read?

No, nothing like that. You could create say a 100x100 window, a 50x50
region, do GetDCEx with that clip region, then move/resize the window
and check how the DC visible region changes. Then the same thing with
InvalidateRgn+BeginPaint instead of GetDCEx.

> The app is processing in a WM_LBUTTONDOWN, and just creates a window and
> draws to it immediately, and the windows message loop wont redraw it. Is
> there any workaround for this or is it going to be an impossibility to get
> it working? (I wondered, for example, if we can do anything about ignoring
> the first expose if the window was created as visible, or removing the
> rdw_erase if the window had explicitly painted itself before the first
> event)?

We can't know if the app has painted itself, it's quite possible that
the window wasn't mapped yet when it painted, since this can be
intercepted by the window manager. We'd have to buffer the output in a
pixmap before the first expose event.

-- 
Alexandre Julliard
julliard at winehq.org


From tehblunderbuss at gmail.com  Fri Mar 14 10:53:58 2008
From: tehblunderbuss at gmail.com (TheBlunderbuss)
Date: Fri, 14 Mar 2008 10:53:58 -0500
Subject: Wine Security Disclosure
Message-ID: <47DA9F96.70601@gmail.com>

An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080314/57537018/attachment.htm 

From chris.kcat at gmail.com  Fri Mar 14 10:58:47 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Fri, 14 Mar 2008 07:58:47 -0800
Subject: quartz: Detect and skip id3v2 header in mpeg splitter
In-Reply-To: <b130c85e0803132101o7100bbe1j38c3002117a78070@mail.gmail.com>
References: <b130c85e0803132101o7100bbe1j38c3002117a78070@mail.gmail.com>
Message-ID: <200803140858.48273.chris.kcat@gmail.com>

On Thursday 13 March 2008 09:01:53 pm Maarten Lankhorst wrote:
> If read from a file source, ID3 v2 tags might be incorrectly parsed by
> the head_check. This patch skips the whole tag altogether.

I'm not sure this is completely correct. The main splitter function detects 
the presense of an MP3 header at the start of a sample it's sending to set 
the sample's sync point attribute. Since the ID3 tag is not a sync point, 
this causes the first sample to not be set as a sync point, and it would be 
unlikely that a following sample would, under normal circumstances, contain 
an MP3 header at the start either. This could cause sensitive codecs to never 
find a sync point.

ACMWrapper wouldn't be affected as it doesn't handle sync points, but other 
native codecs (which do work in Wine) could. Additionally, winemp3.acm may be 
affected by the ID3 tag as it doesn't seem to have code to handle it either.


From zgs at seas.upenn.edu  Fri Mar 14 11:03:04 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Fri, 14 Mar 2008 16:03:04 +0000
Subject: Wine Security Disclosure
In-Reply-To: <47DA9F96.70601@gmail.com>
References: <47DA9F96.70601@gmail.com>
Message-ID: <b050a5e70803140903r2601c8b2s1dd88ddf459f32bd@mail.gmail.com>

On Fri, Mar 14, 2008 at 3:53 PM, TheBlunderbuss
<tehblunderbuss at gmail.com> wrote:
>
>      The recent discussion about Windows viruses working through Wine leads
> me to questions about its security.
>  I've heard that using a separate user is alright, and then it isn't
> alright.

Where did you hear that its not alright?  Running wine as a normal
(non-root privs) user is the recommended way to use wine for most
software that you know is legit.

No matter what if your running a program, be it linux or windows (on
wine) it always has the potential to mess up things that the user
running it has access too.  So if you run it as a normal user the
worst it can do is mess up that users files (unless its really really
sneaky and root exploits, but thats another case).  All of your
important system files are owned by root (or they should be...) so as
long as your not running as root it can't break your actual system.



>  That you shouldn't use sudo to login to such a special wine user.
>  That you really should use a virtual machine for total security.

Sure; if your playing with something you know could be nasty the best
guarantee that it won't affect anything in your environment is a
virtual machine.  But for apps that you know are alright, games etc.
then running as a normal user is perfectly fine.

>
>  What's the consensus here? And shouldn't this info be published somewhere,
> in big bold letters?
>
>
http://wiki.winehq.org/FAQ

Part 2 Section 11


-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From thestig at google.com  Fri Mar 14 11:30:38 2008
From: thestig at google.com (Lei Zhang)
Date: Fri, 14 Mar 2008 09:30:38 -0700
Subject: [PATCH] gdiplus: Fix test crash in GdipSaveImageToStream.
In-Reply-To: <1205299560-7537-1-git-send-email-nathan.beckmann@gmail.com>
References: <1205299560-7537-1-git-send-email-nathan.beckmann@gmail.com>
Message-ID: <558b2f5c0803140930s212f9011g9458090fa1021871@mail.gmail.com>

On Tue, Mar 11, 2008 at 10:26 PM, Nathan Beckmann
<nathan.beckmann at gmail.com> wrote:
> Correctly initialized parameters to GetDIBits. (Based on
>  GdipLockBitmapBits.)
>
>  Testing seems to indicate that the error doesn't occur on Debian, but
>  shows up in Slackware. Valgrind also complains.
>  ---
>   dlls/gdiplus/image.c |   28 ++++++++++++++++++++++------
>   1 files changed, 22 insertions(+), 6 deletions(-)
>
>  diff --git a/dlls/gdiplus/image.c b/dlls/gdiplus/image.c
>  index 8307938..ad15148 100644
>  --- a/dlls/gdiplus/image.c
>  +++ b/dlls/gdiplus/image.c
>  @@ -908,7 +908,9 @@ GpStatus WINGDIPAPI GdipSaveImageToStream(GpImage *image, IStream* stream,
>      HRESULT hr;
>      short type;
>      HBITMAP hbmp;
>  +    HBITMAP old_hbmp;
>      HDC hdc;
>  +    int bm_is_selected;
>      BITMAPINFO bmp_info;
>      LPVOID bmp_bits;
>      encode_image_func* encode_image;
>  @@ -917,6 +919,7 @@ GpStatus WINGDIPAPI GdipSaveImageToStream(GpImage *image, IStream* stream,
>      unsigned int dummy;
>      int i;
>
>  +    old_hbmp = 0;
>      output = NULL;
>      output_size = 0;
>
>  @@ -943,18 +946,32 @@ GpStatus WINGDIPAPI GdipSaveImageToStream(GpImage *image, IStream* stream,
>      hr = IPicture_get_Handle(image->picture, (OLE_HANDLE*)&hbmp);
>      if (FAILED(hr) || !hbmp)
>          return GenericError;
>  +    hr = IPicture_get_CurDC(image->picture, &hdc);
>  +    if (FAILED(hr))
>  +        return GenericError;
>  +    bm_is_selected = (hdc != 0);
>  +    if (!bm_is_selected) {
>  +        hdc = CreateCompatibleDC(0);
>  +        old_hbmp = SelectObject(hdc, hbmp);
>  +    }
>
>      /* get bits from HBITMAP */
>  -    hdc = GetDC(0);
>      bmp_info.bmiHeader.biSize = sizeof(bmp_info.bmiHeader);
>  +    bmp_info.bmiHeader.biBitCount = 0;
>      GetDIBits(hdc, hbmp, 0, 0, NULL, &bmp_info, DIB_RGB_COLORS);
>
>      bmp_bits = GdipAlloc(bmp_info.bmiHeader.biSizeImage);
>  -    if (!bmp_bits) {
>  -        ReleaseDC(0, hdc);
>  -        return OutOfMemory;
>  +
>  +    if (bmp_bits)
>  +        GetDIBits(hdc, hbmp, 0, abs(bmp_info.bmiHeader.biHeight), bmp_bits, &bmp_info, DIB_RGB_COLORS);
>  +
>  +    if (!bm_is_selected) {
>  +        SelectObject(hdc, old_hbmp);
>  +        DeleteDC(hdc);
>      }
>  -    GetDIBits(hdc, hbmp, 0, bmp_info.bmiHeader.biHeight, bmp_bits, &bmp_info, DIB_RGB_COLORS);
>  +
>  +    if (!bmp_bits)
>  +        return OutOfMemory;
>
>      stat = encode_image(bmp_bits, &bmp_info, &output, &output_size);
>      if (stat == Ok)
>  @@ -962,7 +979,6 @@ GpStatus WINGDIPAPI GdipSaveImageToStream(GpImage *image, IStream* stream,
>
>      GdipFree(output);
>      GdipFree(bmp_bits);
>  -    ReleaseDC(0, hdc);
>
>      return stat;
>   }
>  --
>  1.5.4.2
>
>
>
>

FYI, here's the valgrind log:

http://www.kegel.com/wine/valgrind/logs-2008-03-11/vg-gdiplus_image-diff.txt

We're passing an uninitialized bmp_info into GetDIBits(), but somehow
it magically works on Debian.


From truiken at gmail.com  Fri Mar 14 11:39:49 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 14 Mar 2008 11:39:49 -0500
Subject: Running services in WINE?
In-Reply-To: <47DA77A3.8060206@gmail.com>
References: <47D82648.30208@procyongames.com>
	<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>
	<47D8C6B9.8030607@procyongames.com> <47DA77A3.8060206@gmail.com>
Message-ID: <22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>

On Fri, Mar 14, 2008 at 8:03 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>
> Christopher wrote:
>  > Maarten Lankhorst wrote:
>  >> Hi Christopher,
>  >>
>  >> 2008/3/12, Christopher <raccoonone at procyongames.com>:
>  >>
>  >>> I've been trying to get MozyHome working on WINE, and have made a little
>  >>>  progress. However, it seems that the service which Mozy uses won't
>  >>>  start. Searching a bit I found a thread from a year ago stating that
>  >>>  services don't work in WINE, but that it was being worked on. Are
>  >>>  services implemented in WINE now, or if they're not is someone working
>  >>>  on it who I could help out?
>  >>>
>  >> Services most definitely work now. Some of them you can start manually
>  >> with "wine net start 'servicename'", however this shouldn't be needed.
>  >>
>  >> Cheers,
>  >> Maarten.
>  >>
>  >>
>  >>
>  > Thanks Maarten!
>  > I tried that, but didn't have anymore luck. The service exits almost
>  > immediately, after giving a few fixme messages. Time to do some
>  > debugging I guess :)
>  >
>  > Christopher
>  >
>  >
>  >
>  I've been looking into this and found an issue in Wine that I'm not sure who to
>  test or solve yet.
>
>  MozyHome creates a key in the Services branch:
>
>  System\\CurrentControlSet\\Services\\mozybackup
>
>  It than adds a 'Description' value to this key.
>
>  A bit later it checks for the service by doing an OpenService. This succeeds on
>  Wine but shouldn't.
>
>  I've created a simple test that creates the key and some value in it. Doing an
>  OpenService fails every time on Windows.
>
>  I took another approach whereby I created a proper service (CreateService) and
>  checked whether I could do an OpenService. This succeeded every time even after
>  deleting the whole key.
>
>  What it boils down to is that the service control manager keeps track of the
>  services. Only proper service calls can influence the service control manager
>  (or a reboot).
>
>  So as long as we don't implement some service control manager functionality
>  (services.exe?) we could have some issues as with MozyHome.
>
>  One approach we could take while we don't have the full functionality is to
>  check for the minimal required parameters (value) we need for a service. Would
>  that be acceptable?
>
>  I think Maarten's patch for CreateService was along those same lines
>  (http://source.winehq.org/git/wine.git/?a=commit;h=284f86183cce638ff8fce4023cb76273e979aa09).
>  We need to find a better way of checking whether a service is truly installed.
>  (and not just some registry keys).
>

http://bugs.winehq.org/show_bug.cgi?id=11651#c3

but generally comments 2-4.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Fri Mar 14 12:29:34 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 14 Mar 2008 10:29:34 -0700
Subject: quartz: Detect and skip id3v2 header in mpeg splitter
In-Reply-To: <200803140858.48273.chris.kcat@gmail.com>
References: <b130c85e0803132101o7100bbe1j38c3002117a78070@mail.gmail.com>
	<200803140858.48273.chris.kcat@gmail.com>
Message-ID: <b130c85e0803141029h70e47dd4ta2f40e81f4cfab34@mail.gmail.com>

Hi Chris,

2008/3/14, Chris Robinson <chris.kcat at gmail.com>:
> On Thursday 13 March 2008 09:01:53 pm Maarten Lankhorst wrote:
>  > If read from a file source, ID3 v2 tags might be incorrectly parsed by
>  > the head_check. This patch skips the whole tag altogether.
>
>
> I'm not sure this is completely correct. The main splitter function detects
>  the presense of an MP3 header at the start of a sample it's sending to set
>  the sample's sync point attribute. Since the ID3 tag is not a sync point,
>  this causes the first sample to not be set as a sync point, and it would be
>  unlikely that a following sample would, under normal circumstances, contain
>  an MP3 header at the start either. This could cause sensitive codecs to never
>  find a sync point.
In general the tag is not a sync point, but some data behind it
accidentally may be parsed as such. Even if it didn't, the tag is
generally a few 100 (or about 1000 in my case)  bytes in size. Reading
all those bytes individually and moving them all 4 times doesn't seem
really optimal. Skipping the amount of data that is set in the size
buffer causes it to immediately find the first mp3 header.

>  ACMWrapper wouldn't be affected as it doesn't handle sync points, but other
>  native codecs (which do work in Wine) could. Additionally, winemp3.acm may be
>  affected by the ID3 tag as it doesn't seem to have code to handle it either.
It doesn't affect sync points, everything in the id3 tag is garbage
and skipping it is a good thing (TM).

Cheers,
Maarten.


From chris.kcat at gmail.com  Fri Mar 14 12:51:47 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Fri, 14 Mar 2008 09:51:47 -0800
Subject: quartz: Detect and skip id3v2 header in mpeg splitter
In-Reply-To: <b130c85e0803141029h70e47dd4ta2f40e81f4cfab34@mail.gmail.com>
References: <b130c85e0803132101o7100bbe1j38c3002117a78070@mail.gmail.com>
	<200803140858.48273.chris.kcat@gmail.com>
	<b130c85e0803141029h70e47dd4ta2f40e81f4cfab34@mail.gmail.com>
Message-ID: <200803141051.47732.chris.kcat@gmail.com>

On Friday 14 March 2008 10:29:34 am Maarten Lankhorst wrote:
> Hi Chris,
>
> 2008/3/14, Chris Robinson <chris.kcat at gmail.com>:
> > On Thursday 13 March 2008 09:01:53 pm Maarten Lankhorst wrote:
> >  > If read from a file source, ID3 v2 tags might be incorrectly parsed by
> >  > the head_check. This patch skips the whole tag altogether.
> >
> > I'm not sure this is completely correct. The main splitter function
> > detects the presense of an MP3 header at the start of a sample it's
> > sending to set the sample's sync point attribute. Since the ID3 tag is
> > not a sync point, this causes the first sample to not be set as a sync
> > point, and it would be unlikely that a following sample would, under
> > normal circumstances, contain an MP3 header at the start either. This
> > could cause sensitive codecs to never find a sync point.
>
> In general the tag is not a sync point, but some data behind it
> accidentally may be parsed as such. Even if it didn't, the tag is
> generally a few 100 (or about 1000 in my case)  bytes in size. Reading
> all those bytes individually and moving them all 4 times doesn't seem
> really optimal. Skipping the amount of data that is set in the size
> buffer causes it to immediately find the first mp3 header.

Correct, but the patch only handles when the pin connection happens. The main 
splitter function will go through the start of the data again, and find the 
ID3 tag again, where it doesn't find the header to set the sync point (unlike 
the pin-connection, it doesn't continue to search forward and will just send 
it as is without the sync point attribute, though).

The following filter (acmwrapper or a native one) will also get the ID3 tag 
and will have to be able to handle it, otherwise it'll fail just like the 
splitter would.


From meissner at suse.de  Fri Mar 14 13:07:55 2008
From: meissner at suse.de (Marcus Meissner)
Date: Fri, 14 Mar 2008 19:07:55 +0100
Subject: wine virus story
In-Reply-To: <3f4fd2640803141019i5b7faab5m8c025fe85a66de32@mail.gmail.com>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
	<a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
	<d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com>
	<200803131949.11704.research@science.su>
	<a71bd89a0803131253y10b5b459n73bdff9ba3be93e@mail.gmail.com>
	<3f4fd2640803141019i5b7faab5m8c025fe85a66de32@mail.gmail.com>
Message-ID: <20080314180755.GA24248@suse.de>

On Fri, Mar 14, 2008 at 05:19:39PM +0000, Reece Dunn wrote:
> On 13/03/2008, Dan Kegel <dank at kegel.com> wrote:
> > On 3/13/08, L. Rahyen <research at science.su> wrote:
> >  >         Separate user is enough if you don't have world writable files in your
> >  >  system.
> >
> > No, because the malware could root your Linux system
> >  using a local priv escalation exploit.  You really want a
> >  totally isolated sandbox.
> 
> Do you know what the status of the ClamAv support is for malware
> detection through the Windows API?
> 
> Also, should this really map the Windows API to use Linux API for
> malware detection (http://lwn.net/Articles/260918/), or the Mac API,
> or other OS APIs if available? If none is provided, the Windows calls
> could use ClamAv as a fallback if available.
> 
> Also, should an effort be made to get Windows AV products working on
> Wine? This has the problem that they would likely require Windows
> kernel APIs that Wine isn't providing. It would also require testing.
> 
> In addition to AV support, should Wine use the Windows API to use a
> firewall if one is available on the OS that Wine is running?

The Windows firewalls usually plugins in at kernel level.

One of our 2006 Summer of Code students wrote an on-access scanner
for Wine, but it was never integrated.

http://www.christoph-probst.com/soc2006/wine/

Ciao, Marcus


From m.b.lankhorst at gmail.com  Fri Mar 14 13:08:42 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 14 Mar 2008 11:08:42 -0700
Subject: quartz: Detect and skip id3v2 header in mpeg splitter
In-Reply-To: <200803141051.47732.chris.kcat@gmail.com>
References: <b130c85e0803132101o7100bbe1j38c3002117a78070@mail.gmail.com>
	<200803140858.48273.chris.kcat@gmail.com>
	<b130c85e0803141029h70e47dd4ta2f40e81f4cfab34@mail.gmail.com>
	<200803141051.47732.chris.kcat@gmail.com>
Message-ID: <b130c85e0803141108s51b36f91m4ff7f2d964fdfb0c@mail.gmail.com>

Hi Chris,

2008/3/14, Chris Robinson <chris.kcat at gmail.com>:
> On Friday 14 March 2008 10:29:34 am Maarten Lankhorst wrote:
>  > Hi Chris,
>  >
>  > 2008/3/14, Chris Robinson <chris.kcat at gmail.com>:
>  > > On Thursday 13 March 2008 09:01:53 pm Maarten Lankhorst wrote:
>  > >  > If read from a file source, ID3 v2 tags might be incorrectly parsed by
>  > >  > the head_check. This patch skips the whole tag altogether.
>  > >
>  > > I'm not sure this is completely correct. The main splitter function
>  > > detects the presense of an MP3 header at the start of a sample it's
>  > > sending to set the sample's sync point attribute. Since the ID3 tag is
>  > > not a sync point, this causes the first sample to not be set as a sync
>  > > point, and it would be unlikely that a following sample would, under
>  > > normal circumstances, contain an MP3 header at the start either. This
>  > > could cause sensitive codecs to never find a sync point.
>  >
>  > In general the tag is not a sync point, but some data behind it
>  > accidentally may be parsed as such. Even if it didn't, the tag is
>  > generally a few 100 (or about 1000 in my case)  bytes in size. Reading
>  > all those bytes individually and moving them all 4 times doesn't seem
>  > really optimal. Skipping the amount of data that is set in the size
>  > buffer causes it to immediately find the first mp3 header.
> Correct, but the patch only handles when the pin connection happens. The main
>  splitter function will go through the start of the data again, and find the
>  ID3 tag again, where it doesn't find the header to set the sync point (unlike
>  the pin-connection, it doesn't continue to search forward and will just send
>  it as is without the sync point attribute, though).
Considering it's metadata that doesn't have any effect for the next
stages, it shouldn't be sent upstream. It should just be dropped
locally. I missed the main splitter function, I'll fix that one too.

Cheers,
Maarten.


From stefandoesinger at gmx.at  Fri Mar 14 13:34:11 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 14 Mar 2008 19:34:11 +0100
Subject: Google Summer of code
In-Reply-To: <47D963B9.3040205@ilidium.com>
References: <47D963B9.3040205@ilidium.com>
Message-ID: <200803141934.17922.stefandoesinger@gmx.at>

Am Donnerstag, 13. M?rz 2008 18:26:17 schrieb Luis C. Busquets P?rez:
> Proposing another thing if implementing d3dx9_36.dll is too much I
> propose to implement:
>      1   D3DXAssembleShader
>      2   D3DXAssembleShaderFromFileA
>      3   D3DXCompileShader
>      4   D3DXCompileShaderFromFileA
I plan to implement those as a university project now(I already got the 
general approval for it, just need to sort out the details)

>      5   D3DXCreateCubeTextureFromFileExA
>      6   D3DXCreateCubeTextureFromFileInMemory
>      7   D3DXCreateEffectCompilerFromFileA
>      8   D3DXCreateEffectFromFileA
>      9   D3DXCreateTextureFromFileExA
>     10   D3DXCreateTextureFromFileInMemory
>     11   D3DXCreateVolumeTextureFromFileExA
>     12   D3DXCreateVolumeTextureFromFileInMemory
>     13   D3DXGetImageInfoFromFileInMemory
>     14   D3DXGetPixelShaderProfile
>     15   D3DXGetShaderConstantTable
>     16   D3DXGetShaderInputSemantics
>     17   D3DXGetShaderVersion
>     18   D3DXGetVertexShaderProfile
>     19   D3DXLoadSurfaceFromSurface
>     20   D3DXSaveSurfaceToFileA
>     21   D3DXSaveTextureToFileA
That's a long enough list in itself I think. You shouldn't cap it off at 
specifically the functions CIV4 calls, but rather look for blocks of 
functionality.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080314/d8afcc9e/attachment.pgp 

From artur.szymiec at gmail.com  Fri Mar 14 14:04:38 2008
From: artur.szymiec at gmail.com (Artur Szymiec)
Date: Fri, 14 Mar 2008 20:04:38 +0100
Subject: Wine SOC - any d3d related projects
Message-ID: <47DACC46.8060302@gmail.com>

Hi,

are there any d3d related projects for SOC 2008 ?
Who is the Mentor ? How can I join ?

Best regards
Artur

-- 
--------------------------------------------------------------------------
Registered User No 397465
Linux Debian 2.6.24.2 AMD Athlon(tm) 64 X2 Dual Core 5000+
Conquer your Desktop! http://www.kde.org/trykde/
Reclaim Your Inbox!   http://www.mozilla.org/products/thunderbird/
--------------------------------------------------------------------------



From paul.vriens.wine at gmail.com  Fri Mar 14 14:11:44 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 14 Mar 2008 20:11:44 +0100
Subject: Running services in WINE?
In-Reply-To: <22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
References: <47D82648.30208@procyongames.com>	
	<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>	
	<47D8C6B9.8030607@procyongames.com> <47DA77A3.8060206@gmail.com>
	<22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
Message-ID: <47DACDF0.3060503@gmail.com>

James Hawkins wrote:
> On Fri, Mar 14, 2008 at 8:03 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> Christopher wrote:
>>  > Maarten Lankhorst wrote:
>>  >> Hi Christopher,
>>  >>
>>  >> 2008/3/12, Christopher <raccoonone at procyongames.com>:
>>  >>
>>  >>> I've been trying to get MozyHome working on WINE, and have made a little
>>  >>>  progress. However, it seems that the service which Mozy uses won't
>>  >>>  start. Searching a bit I found a thread from a year ago stating that
>>  >>>  services don't work in WINE, but that it was being worked on. Are
>>  >>>  services implemented in WINE now, or if they're not is someone working
>>  >>>  on it who I could help out?
>>  >>>
>>  >> Services most definitely work now. Some of them you can start manually
>>  >> with "wine net start 'servicename'", however this shouldn't be needed.
>>  >>
>>  >> Cheers,
>>  >> Maarten.
>>  >>
>>  >>
>>  >>
>>  > Thanks Maarten!
>>  > I tried that, but didn't have anymore luck. The service exits almost
>>  > immediately, after giving a few fixme messages. Time to do some
>>  > debugging I guess :)
>>  >
>>  > Christopher
>>  >
>>  >
>>  >
>>  I've been looking into this and found an issue in Wine that I'm not sure who to
>>  test or solve yet.
>>
>>  MozyHome creates a key in the Services branch:
>>
>>  System\\CurrentControlSet\\Services\\mozybackup
>>
>>  It than adds a 'Description' value to this key.
>>
>>  A bit later it checks for the service by doing an OpenService. This succeeds on
>>  Wine but shouldn't.
>>
>>  I've created a simple test that creates the key and some value in it. Doing an
>>  OpenService fails every time on Windows.
>>
>>  I took another approach whereby I created a proper service (CreateService) and
>>  checked whether I could do an OpenService. This succeeded every time even after
>>  deleting the whole key.
>>
>>  What it boils down to is that the service control manager keeps track of the
>>  services. Only proper service calls can influence the service control manager
>>  (or a reboot).
>>
>>  So as long as we don't implement some service control manager functionality
>>  (services.exe?) we could have some issues as with MozyHome.
>>
>>  One approach we could take while we don't have the full functionality is to
>>  check for the minimal required parameters (value) we need for a service. Would
>>  that be acceptable?
>>
>>  I think Maarten's patch for CreateService was along those same lines
>>  (http://source.winehq.org/git/wine.git/?a=commit;h=284f86183cce638ff8fce4023cb76273e979aa09).
>>  We need to find a better way of checking whether a service is truly installed.
>>  (and not just some registry keys).
>>
> 
> http://bugs.winehq.org/show_bug.cgi?id=11651#c3
> 
> but generally comments 2-4.
> 
It's good we came to same conclusion.

If we wanted to implemented a SCM where would that reside? wineboot?

Cheers,

Paul.


From raccoonone at procyongames.com  Fri Mar 14 14:14:59 2008
From: raccoonone at procyongames.com (Christopher)
Date: Fri, 14 Mar 2008 12:14:59 -0700
Subject: Running services in WINE?
In-Reply-To: <47DACDF0.3060503@gmail.com>
References: <47D82648.30208@procyongames.com>	
	<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>	
	<47D8C6B9.8030607@procyongames.com> <47DA77A3.8060206@gmail.com>
	<22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
	<47DACDF0.3060503@gmail.com>
Message-ID: <47DACEB3.8030405@procyongames.com>

Paul Vriens wrote:
> James Hawkins wrote:
>> On Fri, Mar 14, 2008 at 8:03 AM, Paul Vriens 
>> <paul.vriens.wine at gmail.com> wrote:
>>> Christopher wrote:
>>>  > Maarten Lankhorst wrote:
>>>  >> Hi Christopher,
>>>  >>
>>>  >> 2008/3/12, Christopher <raccoonone at procyongames.com>:
>>>  >>
>>>  >>> I've been trying to get MozyHome working on WINE, and have made 
>>> a little
>>>  >>>  progress. However, it seems that the service which Mozy uses 
>>> won't
>>>  >>>  start. Searching a bit I found a thread from a year ago 
>>> stating that
>>>  >>>  services don't work in WINE, but that it was being worked on. Are
>>>  >>>  services implemented in WINE now, or if they're not is someone 
>>> working
>>>  >>>  on it who I could help out?
>>>  >>>
>>>  >> Services most definitely work now. Some of them you can start 
>>> manually
>>>  >> with "wine net start 'servicename'", however this shouldn't be 
>>> needed.
>>>  >>
>>>  >> Cheers,
>>>  >> Maarten.
>>>  >>
>>>  >>
>>>  >>
>>>  > Thanks Maarten!
>>>  > I tried that, but didn't have anymore luck. The service exits almost
>>>  > immediately, after giving a few fixme messages. Time to do some
>>>  > debugging I guess :)
>>>  >
>>>  > Christopher
>>>  >
>>>  >
>>>  >
>>>  I've been looking into this and found an issue in Wine that I'm not 
>>> sure who to
>>>  test or solve yet.
>>>
>>>  MozyHome creates a key in the Services branch:
>>>
>>>  System\\CurrentControlSet\\Services\\mozybackup
>>>
>>>  It than adds a 'Description' value to this key.
>>>
>>>  A bit later it checks for the service by doing an OpenService. This 
>>> succeeds on
>>>  Wine but shouldn't.
>>>
>>>  I've created a simple test that creates the key and some value in 
>>> it. Doing an
>>>  OpenService fails every time on Windows.
>>>
>>>  I took another approach whereby I created a proper service 
>>> (CreateService) and
>>>  checked whether I could do an OpenService. This succeeded every 
>>> time even after
>>>  deleting the whole key.
>>>
>>>  What it boils down to is that the service control manager keeps 
>>> track of the
>>>  services. Only proper service calls can influence the service 
>>> control manager
>>>  (or a reboot).
>>>
>>>  So as long as we don't implement some service control manager 
>>> functionality
>>>  (services.exe?) we could have some issues as with MozyHome.
>>>
>>>  One approach we could take while we don't have the full 
>>> functionality is to
>>>  check for the minimal required parameters (value) we need for a 
>>> service. Would
>>>  that be acceptable?
>>>
>>>  I think Maarten's patch for CreateService was along those same lines
>>>  (http://source.winehq.org/git/wine.git/?a=commit;h=284f86183cce638ff8fce4023cb76273e979aa09). 
>>>
>>>  We need to find a better way of checking whether a service is truly 
>>> installed.
>>>  (and not just some registry keys).
>>>
>>
>> http://bugs.winehq.org/show_bug.cgi?id=11651#c3
>>
>> but generally comments 2-4.
>>
> It's good we came to same conclusion.
>
> If we wanted to implemented a SCM where would that reside? wineboot?
>
> Cheers,
>
> Paul.
>
>
If one of you (or anyone else) works on implementing a SCM, I'd love to 
help. I don't think I could do it on my own, but I can certainly lend a 
hand if someone with more experience can tell me what needs to be done.

Christopher


From rob at codeweavers.com  Fri Mar 14 14:25:32 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 14 Mar 2008 19:25:32 +0000
Subject: Running services in WINE?
In-Reply-To: <47DACDF0.3060503@gmail.com>
References: <47D82648.30208@procyongames.com>		<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>		<47D8C6B9.8030607@procyongames.com>
	<47DA77A3.8060206@gmail.com>	<22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
	<47DACDF0.3060503@gmail.com>
Message-ID: <47DAD12C.3030607@codeweavers.com>

Paul Vriens wrote:
> James Hawkins wrote:
>   
>> On Fri, Mar 14, 2008 at 8:03 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>>     
>>> Christopher wrote:
>>>  > Maarten Lankhorst wrote:
>>>  >> Hi Christopher,
>>>  >>
>>>  >> 2008/3/12, Christopher <raccoonone at procyongames.com>:
>>>  >>
>>>  >>> I've been trying to get MozyHome working on WINE, and have made a little
>>>  >>>  progress. However, it seems that the service which Mozy uses won't
>>>  >>>  start. Searching a bit I found a thread from a year ago stating that
>>>  >>>  services don't work in WINE, but that it was being worked on. Are
>>>  >>>  services implemented in WINE now, or if they're not is someone working
>>>  >>>  on it who I could help out?
>>>  >>>
>>>  >> Services most definitely work now. Some of them you can start manually
>>>  >> with "wine net start 'servicename'", however this shouldn't be needed.
>>>  >>
>>>  >> Cheers,
>>>  >> Maarten.
>>>  >>
>>>  >>
>>>  >>
>>>  > Thanks Maarten!
>>>  > I tried that, but didn't have anymore luck. The service exits almost
>>>  > immediately, after giving a few fixme messages. Time to do some
>>>  > debugging I guess :)
>>>  >
>>>  > Christopher
>>>  >
>>>  >
>>>  >
>>>  I've been looking into this and found an issue in Wine that I'm not sure who to
>>>  test or solve yet.
>>>
>>>  MozyHome creates a key in the Services branch:
>>>
>>>  System\\CurrentControlSet\\Services\\mozybackup
>>>
>>>  It than adds a 'Description' value to this key.
>>>
>>>  A bit later it checks for the service by doing an OpenService. This succeeds on
>>>  Wine but shouldn't.
>>>
>>>  I've created a simple test that creates the key and some value in it. Doing an
>>>  OpenService fails every time on Windows.
>>>
>>>  I took another approach whereby I created a proper service (CreateService) and
>>>  checked whether I could do an OpenService. This succeeded every time even after
>>>  deleting the whole key.
>>>
>>>  What it boils down to is that the service control manager keeps track of the
>>>  services. Only proper service calls can influence the service control manager
>>>  (or a reboot).
>>>
>>>  So as long as we don't implement some service control manager functionality
>>>  (services.exe?) we could have some issues as with MozyHome.
>>>
>>>  One approach we could take while we don't have the full functionality is to
>>>  check for the minimal required parameters (value) we need for a service. Would
>>>  that be acceptable?
>>>
>>>  I think Maarten's patch for CreateService was along those same lines
>>>  (http://source.winehq.org/git/wine.git/?a=commit;h=284f86183cce638ff8fce4023cb76273e979aa09).
>>>  We need to find a better way of checking whether a service is truly installed.
>>>  (and not just some registry keys).
>>>
>>>       
>> http://bugs.winehq.org/show_bug.cgi?id=11651#c3
>>
>> but generally comments 2-4.
>>
>>     
> It's good we came to same conclusion.
>
> If we wanted to implemented a SCM where would that reside? wineboot?
>   

programs/services

It could then be started on demand by wineboot and/or the advapi32 
services functions.
I was planning to work on this after my endpoint mapper patches are 
accepted.

-- 
Rob Shearman



From mikolaj at zalewski.pl  Fri Mar 14 14:33:34 2008
From: mikolaj at zalewski.pl (=?UTF-8?B?TWlrb8WCYWogWmFsZXdza2k=?=)
Date: Fri, 14 Mar 2008 20:33:34 +0100
Subject: Running services in WINE?
In-Reply-To: <47DACDF0.3060503@gmail.com>
References: <47D82648.30208@procyongames.com>		<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>		<47D8C6B9.8030607@procyongames.com>
	<47DA77A3.8060206@gmail.com>	<22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
	<47DACDF0.3060503@gmail.com>
Message-ID: <47DAD30E.3060105@zalewski.pl>


> If we wanted to implemented a SCM where would that reside? wineboot?
>   
  The SCM is the servies.exe program. Other programs using advapi32 
communicates with it using RPC. I've started writing it - see 
http://www.winehq.org/pipermail/wine-patches/2007-September/044396.html 
. The problems with widl are fixed so it should be possible to add this 
code to Wine. Probably this code should be updated to current Wine and 
I'm not sure if I moved all the database query function to services.exe 
(it's good to more them all in one go to avoid discrepancies between the 
current advapi implementation that relies on the current state of 
registry keys and services.exe that loads all the keys at start time and 
keeps them in memory).
  I may have some time to work on it and I can help if someone who wants 
to do it (if one wants to have an idea how the SCM works there is a 
chapter about it in "Windows Internals" by M. Russinovich and D. Solomon).

Miko?aj Zalewski


From dank at kegel.com  Fri Mar 14 14:33:50 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 14 Mar 2008 12:33:50 -0700
Subject: Wine Security Disclosure
Message-ID: <a71bd89a0803141233m62e4135bh1998d9057754b958@mail.gmail.com>

<tehblunderbuss at gmail.com> wrote:
>      The recent discussion about Windows viruses working through Wine leads
> me to questions about its security.
>  I've heard that using a separate user is alright, and then it isn't
> alright.

You're probably referring to
http://www.winehq.org/pipermail/wine-devel/2008-March/063452.html

I was talking about how to make sure your machine is
safe when you *on purpose* load malware.

However, it is true that we should tell users that Wine is
able to run many Windows malware, and that they
should be just as careful running Windows software
with Wine as they would running it with Windows.
We should also show how to install the standard
Linux virus checkers.
- Dan


From dank at kegel.com  Fri Mar 14 14:25:51 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 14 Mar 2008 12:25:51 -0700
Subject: new winetricks 20080314: added vcrun2003, improved dotnet,
	fixed gui multiple selections
Message-ID: <a71bd89a0803141225g61682a7aqd7cbfa1854e3e8c1@mail.gmail.com>

Another day, another winetricks :-)

This version finally adds a way to get Visual C++ 2003 runtime
libraries (msvcp71, mfc71).
It also finally adds in all the twisty little workarounds
needed to run trivial .net 1.1 apps.

Also, it looks like enough people are using the gui to send
in bug reports for it, which is great; as a result,
multiple selections should actually work now.

As always, you can grab the latest crosstool from
  http://kegel.com/wine/winetricks
or
  http://winezeug.googlecode.com

Remember, don't use winetricks while operating heavy machinery...
- Dan


From m.b.lankhorst at gmail.com  Fri Mar 14 15:22:13 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 14 Mar 2008 13:22:13 -0700
Subject: improve winetricks dotnet 1.1
In-Reply-To: <47D7A81A.6040002@redhat.com>
References: <a71bd89a0803111315m6812e01fqb30a2663b30f05d3@mail.gmail.com>
	<22821af30803111616s3a37347l1d63ec8b74cb0470@mail.gmail.com>
	<47D7A81A.6040002@redhat.com>
Message-ID: <b130c85e0803141322h401d6e1bv16c1e2f97f7165c7@mail.gmail.com>

Hi,

2008/3/12, Michael Stefaniuc <mstefani at redhat.com>:
> James Hawkins wrote:
>  > On Tue, Mar 11, 2008 at 3:15 PM, Dan Kegel <dank at kegel.com> wrote:
>  >> Louis wrote:
>  >>  > Hi, i wonder if it would be possible to improve
>  >>  > winetricks dotnet 1.1, so that it's actually able to run
>  >>  >.net-1.1 applications. Currently it only installs the framework,
>  >>  > but due to bugs the apps don't run.   Atm i use pretty worthless
>  >>  > script below to get them running..
>  >>
>  >>  I'm kind of hoping James implements the missing bits in msi
>  >>  soon.  James, think that will happen soon enough that
>  >>  there's no need to update winetricks?
>  >>
>  >
>  > Just sent in the service patch.  If you're referring to anything else,
>  > I'm not sure what it is.  MsiPublishAssemblies won't see the light of
>  > day for a long, long time, because it requires fusion.dll being
>  > implemented.
>
> Implementing fusion.dll sounds like a GSoC project to me (no clue how
>  much work that is). At least getting the basic structure in place should
>  be doable.
It doesn't seem that hard to implementi the fusion dll. The hard part
is that you will probably have to dipe really deep into assemblies for
it if you want to implement it properly. I don't know the specific
code paths taken, but msdn seems to have at least some info on it.

I think that the fusion dll is installed when installing the .net
framework because my windows xp install doesn't have it in system32.
It is in C:\windows\microsoft.net\framework\${VERSION}, which means
it's probably installed as part of the .net framework. Calling it from
MSI doesn't seem to be too hard.

Cheers,
Maarten.


From msclrhd at googlemail.com  Fri Mar 14 12:19:39 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Fri, 14 Mar 2008 17:19:39 +0000
Subject: wine virus story
In-Reply-To: <a71bd89a0803131253y10b5b459n73bdff9ba3be93e@mail.gmail.com>
References: <a71bd89a0803130832u84b7773m154a826182bcea43@mail.gmail.com>
	<a71bd89a0803131211l572d1126sdf4c01d8cd282733@mail.gmail.com>
	<d6c5d7290803131231k29761ad7i908fe667faa2f3c4@mail.gmail.com>
	<200803131949.11704.research@science.su>
	<a71bd89a0803131253y10b5b459n73bdff9ba3be93e@mail.gmail.com>
Message-ID: <3f4fd2640803141019i5b7faab5m8c025fe85a66de32@mail.gmail.com>

On 13/03/2008, Dan Kegel <dank at kegel.com> wrote:
> On 3/13/08, L. Rahyen <research at science.su> wrote:
>  >         Separate user is enough if you don't have world writable files in your
>  >  system.
>
> No, because the malware could root your Linux system
>  using a local priv escalation exploit.  You really want a
>  totally isolated sandbox.

Do you know what the status of the ClamAv support is for malware
detection through the Windows API?

Also, should this really map the Windows API to use Linux API for
malware detection (http://lwn.net/Articles/260918/), or the Mac API,
or other OS APIs if available? If none is provided, the Windows calls
could use ClamAv as a fallback if available.

Also, should an effort be made to get Windows AV products working on
Wine? This has the problem that they would likely require Windows
kernel APIs that Wine isn't providing. It would also require testing.

In addition to AV support, should Wine use the Windows API to use a
firewall if one is available on the OS that Wine is running?

- Reece


From leslie_alistair at hotmail.com  Fri Mar 14 14:27:17 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Sat, 15 Mar 2008 06:27:17 +1100
Subject: msvcrt: Implement wcscat_s
References: <frdk13$s7e$1@ger.gmane.org>
	<034e01c885c4$5e6746d0$a600fea9@DMITRY>
Message-ID: <freji9$jhh$1@ger.gmane.org>

"Dmitry Timoshkov" <dmitry at codeweavers.com> wrote in message 
news:034e01c885c4$5e6746d0$a600fea9 at DMITRY...
> "Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote:
>
>> +@ cdecl wcscat_s(ptr long wstr) MSVCRT_wcscat_s
>
> The first parameter has type wstr. Also, please check actual
> buffer contents in the tests not just the return values.
>
Hi Dmitry,
  When I wrote the wcscpy_s you asked to me change the spec file to
from
cdecl wcscpy_s(wstr long wstr) MSVCRT_wcscpy_s
to
cdecl wcscpy_s(ptr long wstr) MSVCRT_wcscpy_s
since wcscat_s has the same arguments I assmed it to be the same.

After this change I assumed the following
ptr = non-const pointer that will be changed
wstr = const pointer of type wchar

Can you clarify what is correct?

Ill correct the tests.

Best Regards
 Alistair Leslie-Hughes




From mstefani at redhat.com  Fri Mar 14 15:57:33 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Fri, 14 Mar 2008 21:57:33 +0100
Subject: improve winetricks dotnet 1.1
In-Reply-To: <b130c85e0803141322h401d6e1bv16c1e2f97f7165c7@mail.gmail.com>
References: <a71bd89a0803111315m6812e01fqb30a2663b30f05d3@mail.gmail.com>	<22821af30803111616s3a37347l1d63ec8b74cb0470@mail.gmail.com>	<47D7A81A.6040002@redhat.com>
	<b130c85e0803141322h401d6e1bv16c1e2f97f7165c7@mail.gmail.com>
Message-ID: <47DAE6BD.3070902@redhat.com>

Maarten Lankhorst wrote:
> Hi,
> 
> 2008/3/12, Michael Stefaniuc <mstefani at redhat.com>:
>> James Hawkins wrote:
>>  > On Tue, Mar 11, 2008 at 3:15 PM, Dan Kegel <dank at kegel.com> wrote:
>>  >>  I'm kind of hoping James implements the missing bits in msi
>>  >>  soon.  James, think that will happen soon enough that
>>  >>  there's no need to update winetricks?
>>  >>
>>  >
>>  > Just sent in the service patch.  If you're referring to anything else,
>>  > I'm not sure what it is.  MsiPublishAssemblies won't see the light of
>>  > day for a long, long time, because it requires fusion.dll being
>>  > implemented.
>>
>> Implementing fusion.dll sounds like a GSoC project to me (no clue how
>>  much work that is). At least getting the basic structure in place should
>>  be doable.
> It doesn't seem that hard to implementi the fusion dll. The hard part
> is that you will probably have to dipe really deep into assemblies for
> it if you want to implement it properly. I don't know the specific
Just to remove any confusion: I'm _not_ planning to participate in the
GSoC. My student time are long gone .... Means implementing fusion.dll
is free for everybody.

> code paths taken, but msdn seems to have at least some info on it.
> 
> I think that the fusion dll is installed when installing the .net
> framework because my windows xp install doesn't have it in system32.
> It is in C:\windows\microsoft.net\framework\${VERSION}, which means
> it's probably installed as part of the .net framework. Calling it from
> MSI doesn't seem to be too hard.

bye
	michael
-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Hauptst?tter Strasse 58, 70178 Stuttgart
Handelsregister: Amtsgericht Stuttgart HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                 Werner Knoblich


From m.b.lankhorst at gmail.com  Fri Mar 14 16:38:57 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 14 Mar 2008 14:38:57 -0700
Subject: Wine SOC - any d3d related projects
In-Reply-To: <47DACC46.8060302@gmail.com>
References: <47DACC46.8060302@gmail.com>
Message-ID: <b130c85e0803141438k57454e89i1a03332109a586b7@mail.gmail.com>

Hi Artur,

2008/3/14, Artur Szymiec <artur.szymiec at gmail.com>:
>  are there any d3d related projects for SOC 2008 ?
>  Who is the Mentor ? How can I join ?
Definitely, look at the idea page to get an ide aof what we think is
good. It's even better if you suggest something YOU want to do here.
It doesn't have to come from the idea page.

Cheers,
Maarten.


From m.b.lankhorst at gmail.com  Fri Mar 14 16:41:39 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 14 Mar 2008 14:41:39 -0700
Subject: Google Summer of code
In-Reply-To: <47D963B9.3040205@ilidium.com>
References: <47D963B9.3040205@ilidium.com>
Message-ID: <b130c85e0803141441r7cb7e07fh49eb7afdf582e25d@mail.gmail.com>

Hi Luis,

2008/3/13, "Luis C. Busquets P?rez" <luis.busquets at ilidium.com>:
> Proposing another thing if implementing d3dx9_36.dll is too much I
>  propose to implement:
>      1   D3DXAssembleShader
>      2   D3DXAssembleShaderFromFileA
>      3   D3DXCompileShader
>      4   D3DXCompileShaderFromFileA
>      5   D3DXCreateCubeTextureFromFileExA
>      6   D3DXCreateCubeTextureFromFileInMemory
>      7   D3DXCreateEffectCompilerFromFileA
>      8   D3DXCreateEffectFromFileA
>      9   D3DXCreateTextureFromFileExA
>     10   D3DXCreateTextureFromFileInMemory
>     11   D3DXCreateVolumeTextureFromFileExA
>     12   D3DXCreateVolumeTextureFromFileInMemory
>     13   D3DXGetImageInfoFromFileInMemory
>     14   D3DXGetPixelShaderProfile
>     15   D3DXGetShaderConstantTable
>     16   D3DXGetShaderInputSemantics
>     17   D3DXGetShaderVersion
>     18   D3DXGetVertexShaderProfile
>     19   D3DXLoadSurfaceFromSurface
>     20   D3DXSaveSurfaceToFileA
>     21   D3DXSaveTextureToFileA
>
>  Which are the functions that Sid Meier's Civilization 4 calls and are
>  not yet implemented from d3dx9_32 (36)
Your best bet for the A function is to forward them to the W versions.
These do basically the same thing. Call the W version from the A
version and convert any wide strings to ansi strings, this is what
happens all throughout wine. Also, do you have any plans for adding
conformance tests so you can compare it with windows behavior?

Cheers,
Maarten.


From m.b.lankhorst at gmail.com  Fri Mar 14 16:45:58 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 14 Mar 2008 14:45:58 -0700
Subject: GSoC
In-Reply-To: <47D9B0B3.7050205@open-vote.org>
References: <1dd4d8b40803130731r6681a702x9112f3abac8b795a@mail.gmail.com>
	<47D96054.6050301@gmail.com> <47D9B0B3.7050205@open-vote.org>
Message-ID: <b130c85e0803141445t2966a728r96f263e1aa7ee2a5@mail.gmail.com>

Hi all,

2008/3/13, Scott Ritchie <scott at open-vote.org>:
> Christopher Harvey wrote:
>  > I've had a few ideas that I thought of on my own, but now I'm starting
>  > to see they perhaps aren't as useful as the ideas thought of by current
>  > developers, but I'll float it out there one last time. I thought it
>  > would be cool to create a wine GUI overlay for games, exactly like
>  > nvPerfHUD. The thing about doing it in wine that makes it better than
>  > nvPerHUD is the fact the to use nvPerfHUD the apps have to give
>  > permission for nvPerHUD to run on them. A wine version would actually be
>  > able to force every single 3d app, opengl or directX to output nvPerfHUD
>  > like output. Anyway, just a thought. Would I be able to apply for both
>  > of these projects and pick one last minute?
>  > Thanks,
>  > Chris.
>  >
>
>
> After talking about the concept a bit at the Ubuntu Developer Summit, I
>  really don't like the idea of a "Wine GUI" just for running Wine
>  applications.  From the user's persepctive, installers for Wine
>  applications shouldn't be substantially different from any old Linux
>  installer - they just click on them, it adds something to their
>  applications menu, and from then on they can run it from there.
>
>  Most of the futzing with applications, like messing around with native
>  dlls in winecfg, shouldn't have to be done at all.  The same goes with
>  editing the registry.
>
>  Configuration we'll never be able to eliminate completely, like
>  selecting the windows version, should ultimately be done through an
>  intuitive place and not some central "Wine configuration" program.  For
>  instance, I should be able to right click a Windows application, select
>  properties, and then change the Windows version from there.
>
>  So, yes, I agree.  Winecfg is ugly and inadequate for the kind of
>  configuration our users are doing now.  But before we put too much
>  effort into sprucing up Winecfg, let's instead talk about how feasible
>  it is to make it unneeded in the first place.

I totally agree that a wine gui is not what we want. ui's are counter
productive.
I also found that I need winecfg less and less, I now run winecfg only
to set the windows version to vista. Maybe we should make this version
the default now? More and more applications don't want to run with
windows version set to 2000, and it should just work.

Cheers,
Maarten.


From austinenglish at gmail.com  Fri Mar 14 17:12:48 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 14 Mar 2008 17:12:48 -0500
Subject: GSoC
In-Reply-To: <b130c85e0803141445t2966a728r96f263e1aa7ee2a5@mail.gmail.com>
References: <1dd4d8b40803130731r6681a702x9112f3abac8b795a@mail.gmail.com>
	<47D96054.6050301@gmail.com> <47D9B0B3.7050205@open-vote.org>
	<b130c85e0803141445t2966a728r96f263e1aa7ee2a5@mail.gmail.com>
Message-ID: <b6bb06270803141512l146e8740q3ed9c6069d01c223@mail.gmail.com>

On Fri, Mar 14, 2008 at 4:45 PM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Hi all,
>
>  2008/3/13, Scott Ritchie <scott at open-vote.org>:
>
>
> > Christopher Harvey wrote:
>  >  > I've had a few ideas that I thought of on my own, but now I'm starting
>  >  > to see they perhaps aren't as useful as the ideas thought of by current
>  >  > developers, but I'll float it out there one last time. I thought it
>  >  > would be cool to create a wine GUI overlay for games, exactly like
>  >  > nvPerfHUD. The thing about doing it in wine that makes it better than
>  >  > nvPerHUD is the fact the to use nvPerfHUD the apps have to give
>  >  > permission for nvPerHUD to run on them. A wine version would actually be
>  >  > able to force every single 3d app, opengl or directX to output nvPerfHUD
>  >  > like output. Anyway, just a thought. Would I be able to apply for both
>  >  > of these projects and pick one last minute?
>  >  > Thanks,
>  >  > Chris.
>  >  >
>  >
>  >
>  > After talking about the concept a bit at the Ubuntu Developer Summit, I
>  >  really don't like the idea of a "Wine GUI" just for running Wine
>  >  applications.  From the user's persepctive, installers for Wine
>  >  applications shouldn't be substantially different from any old Linux
>  >  installer - they just click on them, it adds something to their
>  >  applications menu, and from then on they can run it from there.
>  >
>  >  Most of the futzing with applications, like messing around with native
>  >  dlls in winecfg, shouldn't have to be done at all.  The same goes with
>  >  editing the registry.
>  >
>  >  Configuration we'll never be able to eliminate completely, like
>  >  selecting the windows version, should ultimately be done through an
>  >  intuitive place and not some central "Wine configuration" program.  For
>  >  instance, I should be able to right click a Windows application, select
>  >  properties, and then change the Windows version from there.
>  >
>  >  So, yes, I agree.  Winecfg is ugly and inadequate for the kind of
>  >  configuration our users are doing now.  But before we put too much
>  >  effort into sprucing up Winecfg, let's instead talk about how feasible
>  >  it is to make it unneeded in the first place.
>
>  I totally agree that a wine gui is not what we want. ui's are counter
>  productive.
>  I also found that I need winecfg less and less, I now run winecfg only
>  to set the windows version to vista. Maybe we should make this version
>  the default now? More and more applications don't want to run with
>  windows version set to 2000, and it should just work.
>
>  Cheers,
>  Maarten.
>
>
>

There was a discussion a while back about setting the default version
to XP. Vista may be a bad default, considering how badly it's been
running, I wouldn't be surprised if some apps start including their
own workarounds for Vista.


From m.b.lankhorst at gmail.com  Fri Mar 14 17:48:56 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 14 Mar 2008 15:48:56 -0700
Subject: GSoC
In-Reply-To: <b6bb06270803141512l146e8740q3ed9c6069d01c223@mail.gmail.com>
References: <1dd4d8b40803130731r6681a702x9112f3abac8b795a@mail.gmail.com>
	<47D96054.6050301@gmail.com> <47D9B0B3.7050205@open-vote.org>
	<b130c85e0803141445t2966a728r96f263e1aa7ee2a5@mail.gmail.com>
	<b6bb06270803141512l146e8740q3ed9c6069d01c223@mail.gmail.com>
Message-ID: <b130c85e0803141548r70acad3fnc5a6e530c4e091d7@mail.gmail.com>

Hi Austin,

2008/3/14, Austin English <austinenglish at gmail.com>:
> On Fri, Mar 14, 2008 at 4:45 PM, Maarten Lankhorst
>  <m.b.lankhorst at gmail.com> wrote:
>  > Hi all,
>  >
>  >  2008/3/13, Scott Ritchie <scott at open-vote.org>:
>  >
>  >
>  > > Christopher Harvey wrote:
>  >  >  > I've had a few ideas that I thought of on my own, but now I'm starting
>  >  >  > to see they perhaps aren't as useful as the ideas thought of by current
>  >  >  > developers, but I'll float it out there one last time. I thought it
>  >  >  > would be cool to create a wine GUI overlay for games, exactly like
>  >  >  > nvPerfHUD. The thing about doing it in wine that makes it better than
>  >  >  > nvPerHUD is the fact the to use nvPerfHUD the apps have to give
>  >  >  > permission for nvPerHUD to run on them. A wine version would actually be
>  >  >  > able to force every single 3d app, opengl or directX to output nvPerfHUD
>  >  >  > like output. Anyway, just a thought. Would I be able to apply for both
>  >  >  > of these projects and pick one last minute?
>  >  >  > Thanks,
>  >  >  > Chris.
>  >  >  >
>  >  >
>  >  >
>  >  > After talking about the concept a bit at the Ubuntu Developer Summit, I
>  >  >  really don't like the idea of a "Wine GUI" just for running Wine
>  >  >  applications.  From the user's persepctive, installers for Wine
>  >  >  applications shouldn't be substantially different from any old Linux
>  >  >  installer - they just click on them, it adds something to their
>  >  >  applications menu, and from then on they can run it from there.
>  >  >
>  >  >  Most of the futzing with applications, like messing around with native
>  >  >  dlls in winecfg, shouldn't have to be done at all.  The same goes with
>  >  >  editing the registry.
>  >  >
>  >  >  Configuration we'll never be able to eliminate completely, like
>  >  >  selecting the windows version, should ultimately be done through an
>  >  >  intuitive place and not some central "Wine configuration" program.  For
>  >  >  instance, I should be able to right click a Windows application, select
>  >  >  properties, and then change the Windows version from there.
>  >  >
>  >  >  So, yes, I agree.  Winecfg is ugly and inadequate for the kind of
>  >  >  configuration our users are doing now.  But before we put too much
>  >  >  effort into sprucing up Winecfg, let's instead talk about how feasible
>  >  >  it is to make it unneeded in the first place.
>  >
>  >  I totally agree that a wine gui is not what we want. ui's are counter
>  >  productive.
>  >  I also found that I need winecfg less and less, I now run winecfg only
>  >  to set the windows version to vista. Maybe we should make this version
>  >  the default now? More and more applications don't want to run with
>  >  windows version set to 2000, and it should just work.
>  >
>  >  Cheers,
>  >  Maarten.
>  >
>  >
>  >
>
>
> There was a discussion a while back about setting the default version
>  to XP. Vista may be a bad default, considering how badly it's been
>  running, I wouldn't be surprised if some apps start including their
>  own workarounds for Vista.
It's a good idea to set to vista, I think we'll support it. Some games
for example won't run on xp any more.

I only know apps that will run if windows version is set to vista. I
don't know any that fail if the version is set to that specifically.

Cheers,
Maarten.


From truiken at gmail.com  Fri Mar 14 18:05:20 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 14 Mar 2008 18:05:20 -0500
Subject: GSoC
In-Reply-To: <b130c85e0803141548r70acad3fnc5a6e530c4e091d7@mail.gmail.com>
References: <1dd4d8b40803130731r6681a702x9112f3abac8b795a@mail.gmail.com>
	<47D96054.6050301@gmail.com> <47D9B0B3.7050205@open-vote.org>
	<b130c85e0803141445t2966a728r96f263e1aa7ee2a5@mail.gmail.com>
	<b6bb06270803141512l146e8740q3ed9c6069d01c223@mail.gmail.com>
	<b130c85e0803141548r70acad3fnc5a6e530c4e091d7@mail.gmail.com>
Message-ID: <22821af30803141605q50fb85f4x6eb4c17b9ef9b6a5@mail.gmail.com>

On Fri, Mar 14, 2008 at 5:48 PM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Hi Austin,
>
>  2008/3/14, Austin English <austinenglish at gmail.com>:
>
>
> > On Fri, Mar 14, 2008 at 4:45 PM, Maarten Lankhorst
>  >  <m.b.lankhorst at gmail.com> wrote:
>  >  > Hi all,
>  >  >
>  >  >  2008/3/13, Scott Ritchie <scott at open-vote.org>:
>  >  >
>  >  >
>  >  > > Christopher Harvey wrote:
>  >  >  >  > I've had a few ideas that I thought of on my own, but now I'm starting
>  >  >  >  > to see they perhaps aren't as useful as the ideas thought of by current
>  >  >  >  > developers, but I'll float it out there one last time. I thought it
>  >  >  >  > would be cool to create a wine GUI overlay for games, exactly like
>  >  >  >  > nvPerfHUD. The thing about doing it in wine that makes it better than
>  >  >  >  > nvPerHUD is the fact the to use nvPerfHUD the apps have to give
>  >  >  >  > permission for nvPerHUD to run on them. A wine version would actually be
>  >  >  >  > able to force every single 3d app, opengl or directX to output nvPerfHUD
>  >  >  >  > like output. Anyway, just a thought. Would I be able to apply for both
>  >  >  >  > of these projects and pick one last minute?
>  >  >  >  > Thanks,
>  >  >  >  > Chris.
>  >  >  >  >
>  >  >  >
>  >  >  >
>  >  >  > After talking about the concept a bit at the Ubuntu Developer Summit, I
>  >  >  >  really don't like the idea of a "Wine GUI" just for running Wine
>  >  >  >  applications.  From the user's persepctive, installers for Wine
>  >  >  >  applications shouldn't be substantially different from any old Linux
>  >  >  >  installer - they just click on them, it adds something to their
>  >  >  >  applications menu, and from then on they can run it from there.
>  >  >  >
>  >  >  >  Most of the futzing with applications, like messing around with native
>  >  >  >  dlls in winecfg, shouldn't have to be done at all.  The same goes with
>  >  >  >  editing the registry.
>  >  >  >
>  >  >  >  Configuration we'll never be able to eliminate completely, like
>  >  >  >  selecting the windows version, should ultimately be done through an
>  >  >  >  intuitive place and not some central "Wine configuration" program.  For
>  >  >  >  instance, I should be able to right click a Windows application, select
>  >  >  >  properties, and then change the Windows version from there.
>  >  >  >
>  >  >  >  So, yes, I agree.  Winecfg is ugly and inadequate for the kind of
>  >  >  >  configuration our users are doing now.  But before we put too much
>  >  >  >  effort into sprucing up Winecfg, let's instead talk about how feasible
>  >  >  >  it is to make it unneeded in the first place.
>  >  >
>  >  >  I totally agree that a wine gui is not what we want. ui's are counter
>  >  >  productive.
>  >  >  I also found that I need winecfg less and less, I now run winecfg only
>  >  >  to set the windows version to vista. Maybe we should make this version
>  >  >  the default now? More and more applications don't want to run with
>  >  >  windows version set to 2000, and it should just work.
>  >  >
>  >  >  Cheers,
>  >  >  Maarten.
>  >  >
>  >  >
>  >  >
>  >
>  >
>  > There was a discussion a while back about setting the default version
>  >  to XP. Vista may be a bad default, considering how badly it's been
>  >  running, I wouldn't be surprised if some apps start including their
>  >  own workarounds for Vista.
>  It's a good idea to set to vista, I think we'll support it. Some games
>  for example won't run on xp any more.
>
>  I only know apps that will run if windows version is set to vista. I
>  don't know any that fail if the version is set to that specifically.
>

We should set the default version to the version of Windows that we
emulate the best.  This is determined in part by what version the
tests are written for (and thus the implementation is aligned with).
As can be seen from the test results, the version with the fewest
failures is XP or 2003.  Thus, we should set our default version to
winxp.  Though you say many games don't run on XP anymore, Vista
hasn't been around long enough for us to emulate that version
correctly.  Besides, 'games' is just a subset of the applications
people run in Wine.  Defaulting to Vista is overreaching our bounds
and will lead to many problems.

-- 
James Hawkins


From ivg231 at gmail.com  Fri Mar 14 19:42:27 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Fri, 14 Mar 2008 20:42:27 -0400
Subject: Wine Security Disclosure
In-Reply-To: <b050a5e70803140903r2601c8b2s1dd88ddf459f32bd@mail.gmail.com>
References: <47DA9F96.70601@gmail.com>
	<b050a5e70803140903r2601c8b2s1dd88ddf459f32bd@mail.gmail.com>
Message-ID: <47DB1B73.3070204@gmail.com>

> No matter what if your running a program, be it linux or windows (on
> wine) it always has the potential to mess up things that the user
> running it has access too.

Not true - you should be running in a SELinux sandbox to solve this problem. I'm not sure if the technology is mature enough for this, but it can and will constrain beyond user privs.

> So if you run it as a normal user the worst it can do is mess up that users files
> All of your important system files are owned by root (or they should be...) 

Quite the opposite in fact - anything important's already in the user's files - saved passwords, crypto keys, personal data, financial files. The root stuff is not interesting at all, except as a means to get to the user's files.

- Ivan



From chris.kcat at gmail.com  Fri Mar 14 20:37:49 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Fri, 14 Mar 2008 17:37:49 -0800
Subject: quartz: Set a default sync source on the filtergraph
In-Reply-To: <b130c85e0803141625t72cedd7egb0ed975b36e985c2@mail.gmail.com>
References: <b130c85e0803141625t72cedd7egb0ed975b36e985c2@mail.gmail.com>
Message-ID: <200803141837.50199.chris.kcat@gmail.com>

On Friday 14 March 2008 04:25:02 pm Maarten Lankhorst wrote:
> Use the fallback system IReferenceClock, unless the app comes up with
> its own clock.

This doesn't look right. According to MSDN, the clock used when Run is called 
is chosen by the following algorithm:

1- The app called IMediaFilter::SetSyncSource

2- A live filter source is connected to the graph and supports the 
IReferenceClock interface

3- Any filters support IReferenceClock, starting with renderers and 
going "upstream" (following pin connections to the source), and falling back 
to disconnected filters if still nothing. Normally, an audio renderer would 
be selected here.

4- If still nothing, use the system reference clock.


I don't think SetDefaultSyncSource should should just jump right to the system 
clock. As far as I can tell, you need to hold a reference to a clock, and a 
bool saying if it's custom set (as even NULL can be a valid custom override). 
When Run is called, if no custom override is set, it would release the 
current set clock (if any) and check as steps 2, 3, and 4 describe.

So really what the function needs to do is release the current set reference 
clock (if non-NULL), clear a custom-override flag (while SetSyncSource sets 
the custom-override flag and holds a reference for non-NULL filters), and 
check steps 2, 3, and 4. So something like:

SetSyncSource(clock) {
    if(this->ref_clock)
        this->ref_clock->Release();
    this->ref_clock = clock;
    if(clock)
        clock->AddRef();
    this->custom_clock = TRUE;
}
SetDefaultSyncSource() {
    SetSyncSource(NULL);
    this->custom_clock = FALSE;
    ...do steps 2, 3, and 4...
    this->ref_clock = selected_clock;
}
Run() {
    if(!this->custom_clock)
        SetDefaultSyncSource();
    ...run...
}


From winehacker at gmail.com  Fri Mar 14 20:36:46 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 14 Mar 2008 21:36:46 -0400
Subject: GSoC
In-Reply-To: <b6bb06270803141512l146e8740q3ed9c6069d01c223@mail.gmail.com>
References: <1dd4d8b40803130731r6681a702x9112f3abac8b795a@mail.gmail.com>
	<47D96054.6050301@gmail.com> <47D9B0B3.7050205@open-vote.org>
	<b130c85e0803141445t2966a728r96f263e1aa7ee2a5@mail.gmail.com>
	<b6bb06270803141512l146e8740q3ed9c6069d01c223@mail.gmail.com>
Message-ID: <19e31a080803141836g60fea439ld717cd545d0724e1@mail.gmail.com>

On Fri, Mar 14, 2008 at 6:12 PM, Austin English
> There was a discussion a while back about setting the default version
> to XP. Vista may be a bad default, considering how badly it's been
> running, I wouldn't be surprised if some apps start including their
> own workarounds for Vista.

Given each application tends to have different results depending on
which version of Wine is emulated, the solution to me seems that there
should be a default set like now, such as XP and then the Desktop
Environment should support a right click on the *.EXE where the user
can select

Open With Wine
Open With Wine in Win2000 Mode
Open With Wine in WinXP Mode
etc

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From m.b.lankhorst at gmail.com  Fri Mar 14 21:20:45 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 14 Mar 2008 19:20:45 -0700
Subject: quartz: Set a default sync source on the filtergraph
In-Reply-To: <200803141837.50199.chris.kcat@gmail.com>
References: <b130c85e0803141625t72cedd7egb0ed975b36e985c2@mail.gmail.com>
	<200803141837.50199.chris.kcat@gmail.com>
Message-ID: <b130c85e0803141920g381099f2x1088173eae578842@mail.gmail.com>

Hi Chris,

2008/3/14, Chris Robinson <chris.kcat at gmail.com>:
> On Friday 14 March 2008 04:25:02 pm Maarten Lankhorst wrote:
>  > Use the fallback system IReferenceClock, unless the app comes up with
>  > its own clock.
>
>
> This doesn't look right. According to MSDN, the clock used when Run is called
>  is chosen by the following algorithm:
>
>  1- The app called IMediaFilter::SetSyncSource
>
>  2- A live filter source is connected to the graph and supports the
>  IReferenceClock interface
>
>  3- Any filters support IReferenceClock, starting with renderers and
>  going "upstream" (following pin connections to the source), and falling back
>  to disconnected filters if still nothing. Normally, an audio renderer would
>  be selected here.
>
>  4- If still nothing, use the system reference clock.
Almost right.

You're specifying behavior when doing 'run'.

Quoting msdn on IFilterGraph::SetSyncSource:
"This method instructs the Filter Graph Manager to choose a reference
clock using its default algorithm. For more information about the
algorithm that it uses, see Reference Clocks."

There are also strict criteria for live filter sources (basically
webcams or microphones), and when a ireferenceclock will be used from
audio. It needs to expose some interfaces before it is chosen as
reference clock. This patch sets the reference clock to the system
clock, unless overridden by the application. When SetDefaultSyncSource
is called the clock is reset to the system clock.

This isn't entirely conforming, but it's the best solution at the moment.

Cheers,
Maarten.


From m.b.lankhorst at gmail.com  Fri Mar 14 22:11:13 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 14 Mar 2008 20:11:13 -0700
Subject: GSoC
In-Reply-To: <19e31a080803141836g60fea439ld717cd545d0724e1@mail.gmail.com>
References: <1dd4d8b40803130731r6681a702x9112f3abac8b795a@mail.gmail.com>
	<47D96054.6050301@gmail.com> <47D9B0B3.7050205@open-vote.org>
	<b130c85e0803141445t2966a728r96f263e1aa7ee2a5@mail.gmail.com>
	<b6bb06270803141512l146e8740q3ed9c6069d01c223@mail.gmail.com>
	<19e31a080803141836g60fea439ld717cd545d0724e1@mail.gmail.com>
Message-ID: <b130c85e0803142011r27a31982s6094a2734b4277c4@mail.gmail.com>

Hi Steven,

2008/3/14, Steven Edwards <winehacker at gmail.com>:
> On Fri, Mar 14, 2008 at 6:12 PM, Austin English
>
> > There was a discussion a while back about setting the default version
>  > to XP. Vista may be a bad default, considering how badly it's been
>  > running, I wouldn't be surprised if some apps start including their
>  > own workarounds for Vista.
>
>
> Given each application tends to have different results depending on
>  which version of Wine is emulated, the solution to me seems that there
>  should be a default set like now, such as XP and then the Desktop
>  Environment should support a right click on the *.EXE where the user
>  can select
>
>  Open With Wine
>  Open With Wine in Win2000 Mode
>  Open With Wine in WinXP Mode
>  etc
This isn't about specific applications, but for the default
application wine setting.

Cheers,
Maarten.


From dmitry at codeweavers.com  Fri Mar 14 23:16:20 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 15 Mar 2008 12:16:20 +0800
Subject: msvcrt: Implement wcscat_s
References: <frdk13$s7e$1@ger.gmane.org><034e01c885c4$5e6746d0$a600fea9@DMITRY>
	<freji9$jhh$1@ger.gmane.org>
Message-ID: <007201c88653$54802170$a600fea9@DMITRY>

"Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote:

>>> +@ cdecl wcscat_s(ptr long wstr) MSVCRT_wcscat_s
>>
>> The first parameter has type wstr. Also, please check actual
>> buffer contents in the tests not just the return values.
>>
> Hi Dmitry,
>  When I wrote the wcscpy_s you asked to me change the spec file to
> from
> cdecl wcscpy_s(wstr long wstr) MSVCRT_wcscpy_s
> to
> cdecl wcscpy_s(ptr long wstr) MSVCRT_wcscpy_s
> since wcscat_s has the same arguments I assmed it to be the same.
> 
> After this change I assumed the following
> ptr = non-const pointer that will be changed
> wstr = const pointer of type wchar
> 
> Can you clarify what is correct?

Basically parameters in the .spec files are used as descriptors for
relay debugging, and difference between ptr and wstr is whether the
contents on the buffer or just a pointer should be printed.

First parameter of wcscpy_s is a not initialized buffer, while first
parameter of wcscat_s is an initialized unicode string.

-- 
Dmitry.


From dmitry at codeweavers.com  Sat Mar 15 00:53:04 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 15 Mar 2008 13:53:04 +0800
Subject: user32: test processing of expose events (try 2)
References: <200803142345.02310.cjstimpson@utwire.net>
Message-ID: <01d001c88660$d86020a0$a600fea9@DMITRY>

"Clinton Stimpson" <cjstimpson at utwire.net> wrote:

> Simplified from first try by removing unecessary thread.
> 
> ChangeLog:  
>  user32: test processing of expose events

Is it possible to use 4 space indents as in the rest of file?

-- 
Dmitry.


From xixsimplicityxix at gmail.com  Sat Mar 15 00:56:35 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Sat, 15 Mar 2008 00:56:35 -0500
Subject: user32: Fix enumeration for EnumWindowStations and EnumDesktops,
	try 5
In-Reply-To: <b130c85e0803142215h18c6dbfapbd2dd1b813328383@mail.gmail.com>
References: <b130c85e0803142215h18c6dbfapbd2dd1b813328383@mail.gmail.com>
Message-ID: <78a7dad00803142256h6e1fab50r55ac66e69b1f8010@mail.gmail.com>

On Sat, Mar 15, 2008 at 12:15 AM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Fixed names to have underscores.
>
>
>
>

+static void test_enumstations(void)
+{
+    BOOL ret;
+
+#if 0 /* Crashes instead */
+    SetLastError(0xbabefeed);
+    ret = EnumWindowStationsA(NULL, 0);
+    ok(!ret, "EnumWindowStationsA returned succesfully!\n");
+    ok(GetLastError() == ERROR_INVALID_PARAMETER, "LastError is set
to %08x\n", GetLastError());
+#endif
+


Dead code?


From truiken at gmail.com  Sat Mar 15 01:00:49 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 15 Mar 2008 01:00:49 -0500
Subject: user32: Fix enumeration for EnumWindowStations and EnumDesktops,
	try 5
In-Reply-To: <78a7dad00803142256h6e1fab50r55ac66e69b1f8010@mail.gmail.com>
References: <b130c85e0803142215h18c6dbfapbd2dd1b813328383@mail.gmail.com>
	<78a7dad00803142256h6e1fab50r55ac66e69b1f8010@mail.gmail.com>
Message-ID: <22821af30803142300wf53273dx405ac89c72e3a1fe@mail.gmail.com>

On Sat, Mar 15, 2008 at 12:56 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> On Sat, Mar 15, 2008 at 12:15 AM, Maarten Lankhorst
>  <m.b.lankhorst at gmail.com> wrote:
>  > Fixed names to have underscores.
>  >
>  >
>  >
>  >
>
>  +static void test_enumstations(void)
>  +{
>  +    BOOL ret;
>  +
>  +#if 0 /* Crashes instead */
>  +    SetLastError(0xbabefeed);
>  +    ret = EnumWindowStationsA(NULL, 0);
>  +    ok(!ret, "EnumWindowStationsA returned succesfully!\n");
>  +    ok(GetLastError() == ERROR_INVALID_PARAMETER, "LastError is set
>  to %08x\n", GetLastError());
>  +#endif
>  +
>
>
>  Dead code?
>

No, but he should have used if (0) instead.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Sat Mar 15 01:26:35 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 14 Mar 2008 23:26:35 -0700
Subject: user32: Fix enumeration for EnumWindowStations and EnumDesktops,
	try 5
In-Reply-To: <78a7dad00803142256h6e1fab50r55ac66e69b1f8010@mail.gmail.com>
References: <b130c85e0803142215h18c6dbfapbd2dd1b813328383@mail.gmail.com>
	<78a7dad00803142256h6e1fab50r55ac66e69b1f8010@mail.gmail.com>
Message-ID: <b130c85e0803142326k6cc4d5cbqe65e2fe7e931e0e9@mail.gmail.com>

Hi John,

2008/3/14, John Klehm <xixsimplicityxix at gmail.com>:
> On Sat, Mar 15, 2008 at 12:15 AM, Maarten Lankhorst
>  <m.b.lankhorst at gmail.com> wrote:
>  > Fixed names to have underscores.
>
> +static void test_enumstations(void)
>  +{
>  +    BOOL ret;
>  +
>  +#if 0 /* Crashes instead */
>  +    SetLastError(0xbabefeed);
>  +    ret = EnumWindowStationsA(NULL, 0);
>  +    ok(!ret, "EnumWindowStationsA returned succesfully!\n");
>  +    ok(GetLastError() == ERROR_INVALID_PARAMETER, "LastError is set
>  to %08x\n", GetLastError());
>  +#endif
>  +
>
>  Dead code?
It's just so that I know the behavior is crashing, instead of setting
an error. This means that windows programs won't rely on the behavior,
and that the test is not needed.

Cheers,
Maarten.


From luis.busquets at ilidium.com  Sat Mar 15 01:36:34 2008
From: luis.busquets at ilidium.com (=?ISO-8859-1?Q?=22Luis_C=2E_Busquets_P=E9rez=22?=)
Date: Sat, 15 Mar 2008 07:36:34 +0100
Subject: Google Summer of code
In-Reply-To: <200803141934.17922.stefandoesinger@gmx.at>
References: <47D963B9.3040205@ilidium.com>
	<200803141934.17922.stefandoesinger@gmx.at>
Message-ID: <47DB6E72.8050908@ilidium.com>

Following your comment I understand that you will be implementing the 
hard core of D3DXCompileShaderxx.

Nevertheless, I have already a simplification of the 
D3DXCompileShaderFromFilexx functionsStefan D?singer escribi?. This are 
being work referring to D3DXCompileShaderFromFileExW on the basement, i.e:

D3DXCompileShaderFromFileA --> D3DXCompileShaderFromFileW
D3DXCompileShaderFromFileExA --> D3DXCompileShaderFromFileExW
D3DXCompileShaderFromFileW --> D3DXCompileShaderFromFileExW

Please find the patch attached. I have tested it with Civilizqation4, which as explained calls D3DXCompileShaderFromFileA. To test 3DXCompileShaderFromFileExA I tried a temporary path of 
D3DXCompileShaderFromFileA --> D3DXCompileShaderFromFileExA

All this using the work around of implementing the three calling functions (D3DXCompileShaderFromFileA, D3DXCompileShaderFromFileW, D3DXCompileShaderFromFileExA) in d3dx9_32 for testing and now setting the code on d3dx9_36 obviously. The tests have been ok.

Please let me know your comments and if you think that it can be submitted to wine-patches.




> Am Donnerstag, 13. M?rz 2008 18:26:17 schrieb Luis C. Busquets P?rez:
>   
>> Proposing another thing if implementing d3dx9_36.dll is too much I
>> propose to implement:
>>      1   D3DXAssembleShader
>>      2   D3DXAssembleShaderFromFileA
>>      3   D3DXCompileShader
>>      4   D3DXCompileShaderFromFileA
>>     
> I plan to implement those as a university project now(I already got the 
> general approval for it, just need to sort out the details)
>
>   
>>      5   D3DXCreateCubeTextureFromFileExA
>>      6   D3DXCreateCubeTextureFromFileInMemory
>>      7   D3DXCreateEffectCompilerFromFileA
>>      8   D3DXCreateEffectFromFileA
>>      9   D3DXCreateTextureFromFileExA
>>     10   D3DXCreateTextureFromFileInMemory
>>     11   D3DXCreateVolumeTextureFromFileExA
>>     12   D3DXCreateVolumeTextureFromFileInMemory
>>     13   D3DXGetImageInfoFromFileInMemory
>>     14   D3DXGetPixelShaderProfile
>>     15   D3DXGetShaderConstantTable
>>     16   D3DXGetShaderInputSemantics
>>     17   D3DXGetShaderVersion
>>     18   D3DXGetVertexShaderProfile
>>     19   D3DXLoadSurfaceFromSurface
>>     20   D3DXSaveSurfaceToFileA
>>     21   D3DXSaveTextureToFileA
>>     
> That's a long enough list in itself I think. You shouldn't cap it off at 
> specifically the functions CIV4 calls, but rather look for blocks of 
> functionality.
>   

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080315/ea65e8f4/attachment.htm 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: d342fc5d1d9965313406f1bd3b6bd154f231e8cf.diff
Type: text/x-patch
Size: 5387 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080315/ea65e8f4/attachment.bin 

From julliard at winehq.org  Sat Mar 15 05:03:58 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 15 Mar 2008 11:03:58 +0100
Subject: fonts: Start of the Symbol font.
In-Reply-To: <8763vqzdfq.fsf@totally-fudged-out-message-id> (Huw Davies's
	message of "Thu, 13 Mar 2008 17:05:38 +0000")
References: <8763vqzdfq.fsf@totally-fudged-out-message-id>
Message-ID: <87tzj8wbg1.fsf@wine.dyndns.org>

Huw Davies <huw at codeweavers.com> writes:

>  fonts/Makefile.in |    1 +
>  fonts/symbol.sfd  |   83 +++++++++++++++++++++++++++++++++++++++++++++++++++++

Upgrading fontforge fixed the gdi32 errors, but now I'm getting errors
in usp10:

../../../tools/runtest -q -P wine -M usp10.dll -T ../../.. -p usp10_test.exe.so usp10.c && touch usp10.ok
usp10.c:76: Test failed: ExtTextOutW should return TRUE
usp10.c:500: Test failed: ScriptTextOut should return 0 not (00000001)
usp10.c:510: Test failed: ScriptTextOut should return 0 not (00000001)
usp10.c:775: Test failed: ScriptStringXtoCP should return Ch = 0 not 7 for X = 0
usp10.c:789: Test failed: ScriptStringXtoCP should return Ch = 1 not 7 for X = 0
usp10.c:775: Test failed: ScriptStringXtoCP should return Ch = 1 not 7 for X = 0
usp10.c:789: Test failed: ScriptStringXtoCP should return Ch = 2 not 7 for X = 0
usp10.c:775: Test failed: ScriptStringXtoCP should return Ch = 2 not 7 for X = 0
usp10.c:789: Test failed: ScriptStringXtoCP should return Ch = 3 not 7 for X = 0
usp10.c:775: Test failed: ScriptStringXtoCP should return Ch = 3 not 7 for X = 0
usp10.c:789: Test failed: ScriptStringXtoCP should return Ch = 4 not 7 for X = 0
usp10.c:775: Test failed: ScriptStringXtoCP should return Ch = 4 not 7 for X = 0
usp10.c:789: Test failed: ScriptStringXtoCP should return Ch = 5 not 7 for X = 0
usp10.c:775: Test failed: ScriptStringXtoCP should return Ch = 5 not 7 for X = 0
usp10.c:789: Test failed: ScriptStringXtoCP should return Ch = 6 not 7 for X = 0
usp10.c:775: Test failed: ScriptStringXtoCP should return Ch = 6 not 7 for X = 0
usp10.c:789: Test failed: ScriptStringXtoCP should return Ch = 8 not 9 for X = 7
usp10.c:775: Test failed: ScriptStringXtoCP should return Ch = 8 not 9 for X = 7
usp10.c:804: Test failed: ScriptStringXtoCP should return Ch = 3 not -1 for X = -1
usp10.c:820: Test failed: ScriptStringXtoCP should return Ch = 4 not 7 for X = 1
usp10.c:836: Test failed: ScriptStringXtoCP should return Ch = 2 not -1 for X = -1
make: *** [usp10.ok] Error 21

-- 
Alexandre Julliard
julliard at winehq.org


From roy.evison at ntlworld.com  Sat Mar 15 06:54:23 2008
From: roy.evison at ntlworld.com (roy.evison at ntlworld.com)
Date: Sat, 15 Mar 2008 11:54:23 +0000
Subject: inbox
Message-ID: <20080315115817.IXRT26699.aamtaout03-winn.ispmail.ntl.com@smtp.ntlworld.com>

 Dear Sir/Madam,
                appologies I have lost my password etc but would be greatful if you could see a way to remove me from current thread as my inbox is constantly filling up with stuff, originally about microsoft dll's, that I really do not understand. Many thanks.
  
  Roy.

-----------------------------------------
Email sent from www.virginmedia.com/email
Virus-checked using McAfee(R) Software and scanned for spam



From epssyis at gmail.com  Sat Mar 15 07:18:53 2008
From: epssyis at gmail.com (Edward Savage)
Date: Sat, 15 Mar 2008 23:18:53 +1100
Subject: Wine Security Disclosure
In-Reply-To: <a71bd89a0803141233m62e4135bh1998d9057754b958@mail.gmail.com>
References: <a71bd89a0803141233m62e4135bh1998d9057754b958@mail.gmail.com>
Message-ID: <d6c5d7290803150518t27307drf04ff78bfd45872@mail.gmail.com>

>  However, it is true that we should tell users that Wine is
>  able to run many Windows malware, and that they
>  should be just as careful running Windows software
>  with Wine as they would running it with Windows.
>  We should also show how to install the standard
>  Linux virus checkers.
>  - Dan
>
>
>

That thread got very nasty very quickly starting with dmitry's
comments and getting almost flameful from contributors after that.
Though after continuing testing out malware and known spyware
infecting applications, since I had the environment already setup, my
opinion of this issue has gone from neutral to very strongly in favor
of documenting cases where malware/(and dangerous) spyware cross over.
 A solution I think would be to tag the applications that fall in to
this group with a strong warning in appdb.

A good example I found was the first version of iMesh that included
spyware (released in 02) that runs and almost seamlessly installs and
runs spyware bundled with it.  While not up to date I feel the better
bug for bug support that wine obtains with windows the more smaller
(and in some cases bigger) software solutions it will run, introducing
more bundled vectors - imagine when that purple ape runs under wine!

While I take the comment that it is misguided to catalog issues with
virus that work maybe valid I cannot see how ignoring software
uneducated windows users consider to be legitimate but still contain
spyware/malware can be any less misguided.  People will try and run
these applications and then blame the wine project when they cause
issues with their systems in the same way they do when they load them
under windows.

Since there is no source available the windows environment binaries
(normally) are far more prone to having malicious software included in
legitimate software and there is no escaping that.

Edward


From jan.wine at zerebecki.de  Sat Mar 15 09:50:50 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sat, 15 Mar 2008 15:50:50 +0100
Subject: Bugzilla Privs
In-Reply-To: <fr73mq$enr$1@ger.gmane.org>
References: <fr73mq$enr$1@ger.gmane.org>
Message-ID: <20080315145050.GJ3557@crissy.swd.zerebecki.de>

On Wed, Mar 12, 2008 at 10:13:42AM +1100, Alistair Leslie-Hughes wrote:
>   Can I please get Privs on Bugzilla to help with the msxml work I am doing?

done.


Jan



From dank at kegel.com  Sat Mar 15 10:11:49 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 15 Mar 2008 08:11:49 -0700
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
Message-ID: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>

I've updated http://wiki.winehq.org/WineReleaseCriteria
to be a bit more final.

I've also written a draft release plan; see
http://wiki.winehq.org/WineReleasePlan

Comments?


From winehacker at gmail.com  Sat Mar 15 11:54:53 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sat, 15 Mar 2008 12:54:53 -0400
Subject: GSoC
In-Reply-To: <b130c85e0803142011r27a31982s6094a2734b4277c4@mail.gmail.com>
References: <1dd4d8b40803130731r6681a702x9112f3abac8b795a@mail.gmail.com>
	<47D96054.6050301@gmail.com> <47D9B0B3.7050205@open-vote.org>
	<b130c85e0803141445t2966a728r96f263e1aa7ee2a5@mail.gmail.com>
	<b6bb06270803141512l146e8740q3ed9c6069d01c223@mail.gmail.com>
	<19e31a080803141836g60fea439ld717cd545d0724e1@mail.gmail.com>
	<b130c85e0803142011r27a31982s6094a2734b4277c4@mail.gmail.com>
Message-ID: <19e31a080803150954n57593213je5dcf87c679a354c@mail.gmail.com>

On Fri, Mar 14, 2008 at 11:11 PM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> > Given each application tends to have different results depending on
> >  which version of Wine is emulated, the solution to me seems that there
> >  should be a default set like now, such as XP and then the Desktop
> >  Environment should support a right click on the *.EXE where the user
> >  can select
> >
> >  Open With Wine
> >  Open With Wine in Win2000 Mode
> >  Open With Wine in WinXP Mode
> >  etc
> This isn't about specific applications, but for the default
> application wine setting.

I was replying to Austins comment about applications behaving
differently for vista. They already tend to do this for win2000 verses
windows xp so something should be done to address this for users that
are running these applications. Winecfg or another program does not
feel like the right place to me and Wine needs to tie in better with
GNOME in this regard.

I tend to agree the default global version should be set to XP as
there is a lot of backlash against Vista and XP is going to be with us
for a very very long time once SP3 officially goes gold.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From jgardou at yahoo.fr  Sat Mar 15 12:38:54 2008
From: jgardou at yahoo.fr (=?iso-8859-1?q?J=E9r=F4me_Gardou?=)
Date: Sat, 15 Mar 2008 18:38:54 +0100
Subject: Some questions about texture functions of d3dx8/9
Message-ID: <200803151838.54783.jgardou@yahoo.fr>

I'm trying to implement the D3DXGetImageInfoFrom* functions in d3dx8/9 dlls, 
and I have a few questions.

As there is no related source file from this kind of functions, I created 
texture.c within dlls/d3dx8. I guess this is the way you want it, but I'd 
like to hear it from you. 

Then I need libpng to handle this. I know that gdi32 has some (limited) 
support for this files, but I wasn't able to know how it was included in its 
code. A simple #include <png.h> doesn't work, as I expected. So I would like 
to know how wine build process handle third party libraries.

Then, I'd like to know what you think about the code attached here. Please 
don't forget that this is the very first time I make some code for wine !

Cheers.
J?r?me
-------------- next part --------------
A non-text attachment was scrubbed...
Name: textures.c
Type: text/x-csrc
Size: 5197 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080315/c77dffea/attachment.c 

From jjmckenzie51 at sprintpcs.com  Sat Mar 15 12:50:52 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 15 Mar 2008 10:50:52 -0700
Subject: [Wine] How should I educate myself in order to code for WineHQ?
In-Reply-To: <00b701c8858e$1999cfe0$a600fea9@DMITRY>
References: <1205367112.m2f.1159@forum.winehq.org>
	<a71bd89a0803121721w3ec8b82agcb84d9bad50cd972@mail.gmail.com>
	<47D9F2A4.2000500@sprintpcs.com>
	<00b701c8858e$1999cfe0$a600fea9@DMITRY>
Message-ID: <47DC0C7C.5070702@sprintpcs.com>

Dmitry Timoshkov wrote:
> "James McKenzie" <jjmckenzie51 at sprintpcs.com> wrote:
>
>> Dan Kegel wrote:
>>> On Wed, Mar 12, 2008 at 5:11 PM, jingo811 
>>> <wineforum-user at winehq.org> wrote:
>>>  
>>>>  So I was wondering can you give me an ordered to-do-list in 
>>>> becoming a Code Monkey for WineHQ?
>>>>
>>>>         Like do I have to know both C and C++ to code for Wine.
>>>>     
>>>
>>> Nope, just C.  Go through "The C Programming Language" by
>>> Kernighan and Ritchie, and do all the exercizes.
>>>
>>>   
>> If you can make it through the book, you are very good and will work 
>> well for the Wine project.
>>
>> BTW, anyone want a spare copy of this book?
>
> Unfortunately that's not that simple. Wine programming requires Windows
> API programming skills as well, one needs an experience of using at least
> APIs for the component(s) of Wine he/she is going to write the code for,
> and a good knowledge how it's supposed to work/operate internally. One
> should be prepared to write lots of tests to investigate/clarify 
> behaviour
> described/missing in MSDN.
>
Agreed.  However, for the basics, K&R will do.  They teach how to write 
excellent code rather than passable code.

Also, knowledge on programming best practices is good to have as well.

James



From jjmckenzie51 at sprintpcs.com  Sat Mar 15 12:57:25 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 15 Mar 2008 10:57:25 -0700
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
References: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
Message-ID: <47DC0E05.7050206@sprintpcs.com>

Dan Kegel wrote:
> I've updated http://wiki.winehq.org/WineReleaseCriteria
> to be a bit more final.
>
> I've also written a draft release plan; see
> http://wiki.winehq.org/WineReleasePlan
>
> Comments?
>
>
>   
+1 to the release plan.

James McKenzie



From julliard at winehq.org  Sat Mar 15 13:04:15 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 15 Mar 2008 19:04:15 +0100
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
	(Dan Kegel's message of "Sat, 15 Mar 2008 08:11:49 -0700")
References: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
Message-ID: <87lk4jx3s0.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> I've updated http://wiki.winehq.org/WineReleaseCriteria
> to be a bit more final.
>
> I've also written a draft release plan; see
> http://wiki.winehq.org/WineReleasePlan
>
> Comments?

We need a code freeze and stabilization period before the release. My
thinking is that we should have a 1.0rc1 release, probably sometime in
May, and from that point on only accept small obvious fixes. Then we'd
have rc2, rc3, etc. as needed until the bug list gets small enough. And
by rc1 (or even earlier) any bug that requires more than a small simple
patch would be deferred to 1.1.0.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Sat Mar 15 13:43:32 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 15 Mar 2008 11:43:32 -0700
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <87lk4jx3s0.fsf@wine.dyndns.org>
References: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
	<87lk4jx3s0.fsf@wine.dyndns.org>
Message-ID: <a71bd89a0803151143m1f7fa448uee6e7d1b24d2e9ef@mail.gmail.com>

On Sat, Mar 15, 2008 at 11:04 AM, Alexandre Julliard
<julliard at winehq.org> wrote:
>  > http://wiki.winehq.org/WineReleasePlan
>
>  We need a code freeze and stabilization period before the release. My
>  thinking is that we should have a 1.0rc1 release, probably sometime in
>  May, and from that point on only accept small obvious fixes. Then we'd
>  have rc2, rc3, etc. as needed until the bug list gets small enough. And
>  by rc1 (or even earlier) any bug that requires more than a small simple
>  patch would be deferred to 1.1.0.

How's it look now?
- Dan


From mstefani at redhat.com  Sat Mar 15 15:08:46 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Sat, 15 Mar 2008 21:08:46 +0100
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <87lk4jx3s0.fsf@wine.dyndns.org>
References: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
	<87lk4jx3s0.fsf@wine.dyndns.org>
Message-ID: <47DC2CCE.9010809@redhat.com>

Alexandre Julliard wrote:
> "Dan Kegel" <dank at kegel.com> writes:
> 
>> I've updated http://wiki.winehq.org/WineReleaseCriteria
>> to be a bit more final.
>>
>> I've also written a draft release plan; see
>> http://wiki.winehq.org/WineReleasePlan
>>
>> Comments?
> 
> We need a code freeze and stabilization period before the release. My
> thinking is that we should have a 1.0rc1 release, probably sometime in
> May, and from that point on only accept small obvious fixes. Then we'd
What about small janitorial patches?

> have rc2, rc3, etc. as needed until the bug list gets small enough. And
> by rc1 (or even earlier) any bug that requires more than a small simple
> patch would be deferred to 1.1.0.

bye
	michael


From dank at kegel.com  Sat Mar 15 15:53:37 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 15 Mar 2008 13:53:37 -0700
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <47DC2CCE.9010809@redhat.com>
References: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
	<87lk4jx3s0.fsf@wine.dyndns.org> <47DC2CCE.9010809@redhat.com>
Message-ID: <a71bd89a0803151353y9e79412g8ce85cf0602ef60b@mail.gmail.com>

Michael Stefaniuc <mstefani at redhat.com> wrote:
>  > thinking is that we should have a 1.0rc1 release, probably sometime in
>  > May, and from that point on only accept small obvious fixes. Then we'd
>  What about small janitorial patches?

If they have low risk, and are obvious, they might well go in.


From julliard at winehq.org  Sat Mar 15 16:27:27 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 15 Mar 2008 22:27:27 +0100
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <a71bd89a0803151143m1f7fa448uee6e7d1b24d2e9ef@mail.gmail.com>
	(Dan Kegel's message of "Sat, 15 Mar 2008 11:43:32 -0700")
References: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
	<87lk4jx3s0.fsf@wine.dyndns.org>
	<a71bd89a0803151143m1f7fa448uee6e7d1b24d2e9ef@mail.gmail.com>
Message-ID: <87hcf7wudc.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> On Sat, Mar 15, 2008 at 11:04 AM, Alexandre Julliard
> <julliard at winehq.org> wrote:
>>  > http://wiki.winehq.org/WineReleasePlan
>>
>>  We need a code freeze and stabilization period before the release. My
>>  thinking is that we should have a 1.0rc1 release, probably sometime in
>>  May, and from that point on only accept small obvious fixes. Then we'd
>>  have rc2, rc3, etc. as needed until the bug list gets small enough. And
>>  by rc1 (or even earlier) any bug that requires more than a small simple
>>  patch would be deferred to 1.1.0.
>
> How's it look now?

Looks good, now we need to work on shrinking that bug list...

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Sat Mar 15 16:32:17 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 15 Mar 2008 22:32:17 +0100
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <47DC2CCE.9010809@redhat.com> (Michael Stefaniuc's message of
	"Sat, 15 Mar 2008 21:08:46 +0100")
References: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
	<87lk4jx3s0.fsf@wine.dyndns.org> <47DC2CCE.9010809@redhat.com>
Message-ID: <87abkzwu5a.fsf@wine.dyndns.org>

Michael Stefaniuc <mstefani at redhat.com> writes:

> Alexandre Julliard wrote:
>> We need a code freeze and stabilization period before the release. My
>> thinking is that we should have a 1.0rc1 release, probably sometime in
>> May, and from that point on only accept small obvious fixes. Then we'd
> What about small janitorial patches?

Obvious low risk patches could go in, but I don't see much need to put
in janitorial patches during the rc phase, they can just as well wait
until 1.0 is out.

-- 
Alexandre Julliard
julliard at winehq.org


From remco47 at yahoo.com  Sat Mar 15 17:35:07 2008
From: remco47 at yahoo.com (Remco)
Date: Sat, 15 Mar 2008 15:35:07 -0700 (PDT)
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
Message-ID: <682197.30196.qm@web50108.mail.re2.yahoo.com>

----- Original Message ----
> From: Dan Kegel <dank at kegel.com>
> I've updated http://wiki.winehq.org/WineReleaseCriteria
> to be a bit more final.
> 
> I've also written a draft release plan; see
> http://wiki.winehq.org/WineReleasePlan
> 
> Comments?


Please note that I'm not complaining, but doesn't that list of criteriaseem a little disappointing? I know what Wine is capable of, but you'retelling the world that, after 15 years, Wine 1.0 is guaranteed to runabout 4 applications.

What about growing the list with a few applications that work perfectly at the moment (such as the top 10 platinum rated apps)?

There is of course a slight stability problem (mandatory updates) with the Steam apps in that top 10 list, so those would have to be excluded.

Remco



      ___________________________________________________________ 
Rise to the challenge for Sport Relief with Yahoo! For Good  

http://uk.promotions.yahoo.com/forgood/


From dank at kegel.com  Sat Mar 15 17:52:48 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 15 Mar 2008 15:52:48 -0700
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <682197.30196.qm@web50108.mail.re2.yahoo.com>
References: <682197.30196.qm@web50108.mail.re2.yahoo.com>
Message-ID: <a71bd89a0803151552u6d5b746ax141bfa57063bd882@mail.gmail.com>

On Sat, Mar 15, 2008 at 3:35 PM, Remco <remco47 at yahoo.com> wrote:
>  What about growing the list with a few applications that work perfectly at the moment (such as the top 10 platinum rated apps)?

The problem with expanding the list is that each new app
adds a huge amount of testing to each release.

If you can provide an automated test case for your
favorite platinum app, so that we can just run it without
any manual work, I'll gladly add it to the list.
- Dan

p.s.
http://appdb.winehq.org/browse_by_rating.php lists 1227
(that's over a thousand!) platinum applications.
I'm willing to bet that the real number is a lot lower.


From dank at kegel.com  Sat Mar 15 18:15:06 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 15 Mar 2008 16:15:06 -0700
Subject: Wine code freeze in seven weeks; volunteers needed to fix 1.0 bugs
Message-ID: <a71bd89a0803151615u391878e4ub6bd99385ba372b3@mail.gmail.com>

Per http://wiki.winehq.org/WineReleasePlan,
in early May, Wine's trunk will go into code freeze,
and only small, obvious bugfixes will be accepted.

Now might be a good time to start winding down
development, and switching to cleaning up loose ends.

http://bugs.winehq.org/buglist.cgi?query_format=advanced&product=Wine&target_milestone=1.0.0&bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED
lists 99 bugs targeted for the 1.0.0 release.
When the code freeze starts, we will defer most of the
remaining unfixed 1.0 bugs to the 1.1 release.

A bunch of them have patches or good analysis
attached, and it'd be a shame if those got deferred,
so please have a look at these, and if you have time,
pick an easy one to fix.
- Dan


From dank at kegel.com  Sat Mar 15 18:25:51 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 15 Mar 2008 16:25:51 -0700
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <a71bd89a0803151552u6d5b746ax141bfa57063bd882@mail.gmail.com>
References: <682197.30196.qm@web50108.mail.re2.yahoo.com>
	<a71bd89a0803151552u6d5b746ax141bfa57063bd882@mail.gmail.com>
Message-ID: <a71bd89a0803151625r26b1b2bei97230cf6ad2b8f0a@mail.gmail.com>

On Sat, Mar 15, 2008 at 3:52 PM, Dan Kegel <dank at kegel.com> wrote:
>  If you can provide an automated test case for your
>  favorite platinum app, so that we can just run it without
>  any manual work, I'll gladly add it to the list.

That's not as hard as it sounds.
You might consider adapting existing automated installer
scripts such as the ones at http://wpkg.org/ or
http://unattended.sourceforge.net/

There are surely dozens of apps that are
have freely downloadable versions and
can have automated installs.  All of them
ought to be part of the release criteria;
we're just short on manpower to write those scripts.
- Dan


From jjmckenzie51 at sprintpcs.com  Sat Mar 15 19:13:54 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 15 Mar 2008 17:13:54 -0700
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <a71bd89a0803151143m1f7fa448uee6e7d1b24d2e9ef@mail.gmail.com>
References: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
	<87lk4jx3s0.fsf@wine.dyndns.org>
	<a71bd89a0803151143m1f7fa448uee6e7d1b24d2e9ef@mail.gmail.com>
Message-ID: <47DC6642.5060102@sprintpcs.com>

Dan Kegel wrote:
> On Sat, Mar 15, 2008 at 11:04 AM, Alexandre Julliard
> <julliard at winehq.org> wrote:
>   
>>  > http://wiki.winehq.org/WineReleasePlan
>>
>>  We need a code freeze and stabilization period before the release. My
>>  thinking is that we should have a 1.0rc1 release, probably sometime in
>>  May, and from that point on only accept small obvious fixes. Then we'd
>>  have rc2, rc3, etc. as needed until the bug list gets small enough. And
>>  by rc1 (or even earlier) any bug that requires more than a small simple
>>  patch would be deferred to 1.1.0.
>>     
>
> How's it look now?
> - Dan
>
>
>   
Dan:

How much of a pain would it be to switch to weekly releases during the 
rc period to catch patches and regresssions?

James



From austinenglish at gmail.com  Sat Mar 15 19:16:25 2008
From: austinenglish at gmail.com (Austin English)
Date: Sat, 15 Mar 2008 19:16:25 -0500
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <a71bd89a0803151625r26b1b2bei97230cf6ad2b8f0a@mail.gmail.com>
References: <682197.30196.qm@web50108.mail.re2.yahoo.com>
	<a71bd89a0803151552u6d5b746ax141bfa57063bd882@mail.gmail.com>
	<a71bd89a0803151625r26b1b2bei97230cf6ad2b8f0a@mail.gmail.com>
Message-ID: <b6bb06270803151716j2a43d362if6270f7298f007ab@mail.gmail.com>

On Sat, Mar 15, 2008 at 6:25 PM, Dan Kegel <dank at kegel.com> wrote:
>  That's not as hard as it sounds.
>  You might consider adapting existing automated installer
>  scripts such as the ones at http://wpkg.org/ or
>  http://unattended.sourceforge.net/
>
>  There are surely dozens of apps that are
>  have freely downloadable versions and
>  can have automated installs.  All of them
>  ought to be part of the release criteria;
>  we're just short on manpower to write those scripts.
>  - Dan

We had talked a while back about doing this, but it seems it never
went anywhere. If you'd like Dan, I can probably write a few of
those...Just send me an e-mail with what you want/an example.

-Austin


From jjmckenzie51 at sprintpcs.com  Sat Mar 15 19:58:18 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 15 Mar 2008 17:58:18 -0700
Subject: Wine code freeze in seven weeks; volunteers needed to fix 1.0 bugs
In-Reply-To: <a71bd89a0803151615u391878e4ub6bd99385ba372b3@mail.gmail.com>
References: <a71bd89a0803151615u391878e4ub6bd99385ba372b3@mail.gmail.com>
Message-ID: <47DC70AA.2030305@sprintpcs.com>

Dan Kegel wrote:
> Per http://wiki.winehq.org/WineReleasePlan,
> in early May, Wine's trunk will go into code freeze,
> and only small, obvious bugfixes will be accepted.
>
> Now might be a good time to start winding down
> development, and switching to cleaning up loose ends.
>
> http://bugs.winehq.org/buglist.cgi?query_format=advanced&product=Wine&target_milestone=1.0.0&bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED
> lists 99 bugs targeted for the 1.0.0 release.
> When the code freeze starts, we will defer most of the
> remaining unfixed 1.0 bugs to the 1.1 release.
>
> A bunch of them have patches or good analysis
> attached, and it'd be a shame if those got deferred,
> so please have a look at these, and if you have time,
> pick an easy one to fix.
> - Dan
>
>
>   
Dan:

6254 had a proposed fix from Tony Rollo, and was worked on both Lai 
Zhang and myself.  Can I send the proposed patch to the dev list for 
review?  The patch fixes the problem stated.

James McKenzie



From dank at kegel.com  Sat Mar 15 20:06:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 15 Mar 2008 18:06:18 -0700
Subject: Wine code freeze in seven weeks; volunteers needed to fix 1.0 bugs
In-Reply-To: <47DC70AA.2030305@sprintpcs.com>
References: <a71bd89a0803151615u391878e4ub6bd99385ba372b3@mail.gmail.com>
	<47DC70AA.2030305@sprintpcs.com>
Message-ID: <a71bd89a0803151806v50916e6ctfe836829bd226a1b@mail.gmail.com>

<jjmckenzie51 at sprintpcs.com> wrote:
>  6254 had a proposed fix from Tony Rollo, and was worked on both Lai
>  Zhang and myself.  Can I send the proposed patch to the dev list for
>  review?  The patch fixes the problem stated.

Lei, feel like resubmitting
http://winehq.org/pipermail/wine-patches/2007-June/040182.html ?
- Dan


From thestig at google.com  Sat Mar 15 20:13:59 2008
From: thestig at google.com (Lei Zhang)
Date: Sat, 15 Mar 2008 18:13:59 -0700
Subject: Wine code freeze in seven weeks; volunteers needed to fix 1.0 bugs
In-Reply-To: <a71bd89a0803151806v50916e6ctfe836829bd226a1b@mail.gmail.com>
References: <a71bd89a0803151615u391878e4ub6bd99385ba372b3@mail.gmail.com>
	<47DC70AA.2030305@sprintpcs.com>
	<a71bd89a0803151806v50916e6ctfe836829bd226a1b@mail.gmail.com>
Message-ID: <558b2f5c0803151813s56526128v1358cbeeac53cc33@mail.gmail.com>

On Sat, Mar 15, 2008 at 6:06 PM, Dan Kegel <dank at kegel.com> wrote:
> <jjmckenzie51 at sprintpcs.com> wrote:
>  >  6254 had a proposed fix from Tony Rollo, and was worked on both Lai
>  >  Zhang and myself.  Can I send the proposed patch to the dev list for
>  >  review?  The patch fixes the problem stated.
>
>  Lei, feel like resubmitting
>  http://winehq.org/pipermail/wine-patches/2007-June/040182.html ?
>  - Dan
>
>
>

That patch is old and crusty and doesn't apply anymore. James should
have an updated version.


From m.b.lankhorst at gmail.com  Sat Mar 15 20:44:42 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sat, 15 Mar 2008 18:44:42 -0700
Subject: Is the cxtest.org site down?
Message-ID: <b130c85e0803151844o411b74fbo11e4114ce9de912b@mail.gmail.com>

Hi,

I was trying to look at www.cxtest.org but the site seems not to work.
Can this be fixed?

Cheers,
Maarten.


From tehblunderbuss at gmail.com  Sat Mar 15 23:42:49 2008
From: tehblunderbuss at gmail.com (TheBlunderbuss)
Date: Sat, 15 Mar 2008 23:42:49 -0500
Subject: Wine Security Disclosure
Message-ID: <47DCA549.5010209@gmail.com>

An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080315/7f1341bd/attachment.htm 

From dmitry at codeweavers.com  Sun Mar 16 00:29:20 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 16 Mar 2008 13:29:20 +0800
Subject: Wine Security Disclosure
References: <47DCA549.5010209@gmail.com>
Message-ID: <007501c88726$b1199550$a600fea9@DMITRY>

"TheBlunderbuss" <tehblunderbuss at gmail.com> wrote:

[skipped]

> This level of security info is something everyone should have easy
> access to and know before starting Wine. Of course, wherever I'm not
> accurate, feel free to fill in!

There is nothing special about Wine that doesn't apply to common
unix/linux/windows security practices.

-- 
Dmitry.


From lats at yless4u.com.au  Sun Mar 16 00:46:21 2008
From: lats at yless4u.com.au (Jeff Latimer)
Date: Sun, 16 Mar 2008 16:46:21 +1100
Subject: Wine Security Disclosure
In-Reply-To: <007501c88726$b1199550$a600fea9@DMITRY>
References: <47DCA549.5010209@gmail.com>
	<007501c88726$b1199550$a600fea9@DMITRY>
Message-ID: <47DCB42D.9020709@yless4u.com.au>

Dmitry Timoshkov wrote:
> "TheBlunderbuss" <tehblunderbuss at gmail.com> wrote:
>
> [skipped]
>
>   
>> This level of security info is something everyone should have easy
>> access to and know before starting Wine. Of course, wherever I'm not
>> accurate, feel free to fill in!
>>     
> There is nothing special about Wine that doesn't apply to common
> unix/linux/windows security practices.
here is the myth that Linux/Unix is impervious to viri and for new Linux 
users not to be concerned about the issue.


From winehacker at gmail.com  Sun Mar 16 02:33:19 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 16 Mar 2008 03:33:19 -0400
Subject: Wine Security Disclosure
In-Reply-To: <007501c88726$b1199550$a600fea9@DMITRY>
References: <47DCA549.5010209@gmail.com>
	<007501c88726$b1199550$a600fea9@DMITRY>
Message-ID: <19e31a080803160033t33e2ac67k4aa974f263063de9@mail.gmail.com>

On Sun, Mar 16, 2008 at 1:29 AM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
>  There is nothing special about Wine that doesn't apply to common
>  unix/linux/windows security practices.

No but people come to Linux hearing that its more secure than Windows
for various reasons. While this may or may not be true, if we are so
compatible that we can run virii and spyware, then we need to document
it as TheBlunderbuss said otherwise there will be many people
disappointed by unrealistic expectations.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sun Mar 16 02:52:01 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 16 Mar 2008 15:52:01 +0800
Subject: Wine Security Disclosure
References: <47DCA549.5010209@gmail.com><007501c88726$b1199550$a600fea9@DMITRY>
	<19e31a080803160033t33e2ac67k4aa974f263063de9@mail.gmail.com>
Message-ID: <020801c8873a$9f945310$a600fea9@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

>>  There is nothing special about Wine that doesn't apply to common
>>  unix/linux/windows security practices.
> 
> No but people come to Linux hearing that its more secure than Windows
> for various reasons.

I hardly see that it's a Wine problem.

> While this may or may not be true, if we are so
> compatible that we can run virii and spyware, then we need to document
> it as TheBlunderbuss said otherwise there will be many people
> disappointed by unrealistic expectations.

Again, I don't see how Wine developers could help with that, we are developers,
not a health care department.

-- 
Dmitry.


From winehacker at gmail.com  Sun Mar 16 03:07:42 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 16 Mar 2008 04:07:42 -0400
Subject: Wine Security Disclosure
In-Reply-To: <020801c8873a$9f945310$a600fea9@DMITRY>
References: <47DCA549.5010209@gmail.com>
	<007501c88726$b1199550$a600fea9@DMITRY>
	<19e31a080803160033t33e2ac67k4aa974f263063de9@mail.gmail.com>
	<020801c8873a$9f945310$a600fea9@DMITRY>
Message-ID: <19e31a080803160107g7a68d284k4cf62d5807dbea0f@mail.gmail.com>

On Sun, Mar 16, 2008 at 3:52 AM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
>  Again, I don't see how Wine developers could help with that, we are developers,
>  not a health care department.

And this is why there is a disconnect from developers to users. If you
don't document what are and are not valid assumptions and behaviors,
how the hell do you expect the user to figure it out? One reason there
is not a ton of spyware/virii for Linux and friends is most packages
come in source and binary form  where there is the chance of peer
review (and the fact the market share is so small its not worth
targeting) but users don't know that. They think Wine+Linux will just
magically solve the problem due to the apparent "betterness" of Linux.
If we don't properly address that, then users will be disappointed
because the real value comes from the free as in freedom part of the
software not the assumed enhanced security.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sun Mar 16 03:14:23 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 16 Mar 2008 16:14:23 +0800
Subject: Wine Security Disclosure
References: <47DCA549.5010209@gmail.com>
	<007501c88726$b1199550$a600fea9@DMITRY>
	<19e31a080803160033t33e2ac67k4aa974f263063de9@mail.gmail.com>
	<020801c8873a$9f945310$a600fea9@DMITRY>
	<19e31a080803160107g7a68d284k4cf62d5807dbea0f@mail.gmail.com>
Message-ID: <000d01c8873d$c0351c00$a600fea9@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> On Sun, Mar 16, 2008 at 3:52 AM, Dmitry Timoshkov
> <dmitry at codeweavers.com> wrote:
>>  Again, I don't see how Wine developers could help with that, we are developers,
>>  not a health care department.
> 
> And this is why there is a disconnect from developers to users. If you
> don't document what are and are not valid assumptions and behaviors,
> how the hell do you expect the user to figure it out? One reason there
> is not a ton of spyware/virii for Linux and friends is most packages
> come in source and binary form  where there is the chance of peer
> review (and the fact the market share is so small its not worth
> targeting) but users don't know that. They think Wine+Linux will just
> magically solve the problem due to the apparent "betterness" of Linux.
> If we don't properly address that, then users will be disappointed
> because the real value comes from the free as in freedom part of the
> software not the assumed enhanced security.

That's more like a social/mental/political problem, not something this list
is about. The purpse of Wine is to run the code written for Windows, nothing
more nothing less. Perhaps to clarify the assumptions one should start from
reading README in the Wine source and front page of winehq.org.

-- 
Dmitry.


From r.kalbermatter at hccnet.nl  Sun Mar 16 04:05:41 2008
From: r.kalbermatter at hccnet.nl (Rolf Kalbermatter)
Date: Sun, 16 Mar 2008 10:05:41 +0100
Subject: Wine Security Disclosure
In-Reply-To: <007501c88726$b1199550$a600fea9@DMITRY>
References: <47DCA549.5010209@gmail.com>
	<007501c88726$b1199550$a600fea9@DMITRY>
Message-ID: <006601c88744$e8f49c90$4001a8c0@NATERS>

Dmitry Timoshkov [mailto:dmitry at codeweavers.com] wrote:

> > This level of security info is something everyone should have easy 
> > access to and know before starting Wine. Of course, wherever I'm not 
> > accurate, feel free to fill in!
> 
> There is nothing special about Wine that doesn't apply to 
> common unix/linux/windows security practices.

This is correct but with Wine 1.0 approaching you are now targetting an
audience that knows often nothing about Unix/Linux other than it's
mythological lack of sensitivity to viri. That this lack is more a question
of a lack of a common and standardizid target due to it's lower market
penetration in end user systems and many flavors and user specific setups
is beyond them. Wine now offers almost the same attack target as does
Windows due to its already good and still improving compatibility with it.

So although you obviously don't like it, maybe because you do not want to
shy away new potential users, a warning somewhere with a description is
definitly not the wrong thing to do. But I do feel the original poster
used still a to much unix language for the upcoming average Wine users.

There definitely still exists that picture that Linux is much more secure
no matter how bad you treat it and that is simply not true and an upcoming
user should be educated about that. It should be made clear in my opinion
that Wine is not meant and can't be used to run Windows applications
whithout observing exactly the same care and security as you would need
on Windows.

You won't be able to avoid the bad publicity about people messing up their
system under Wine but at least you can say that this was known and
documented
and Wine isn't a magical bulletproof security solution that allows users
to download every single Warez application that is out there without risking
more or less the same problems as you would get under Windows. And once Wine
has gotten the wide spread use we would all like to see, the next step to
Wine aware viri and such is not that big, believe me.

Rolf Kalbermatter



From paul.vriens.wine at gmail.com  Sun Mar 16 04:29:26 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Sun, 16 Mar 2008 10:29:26 +0100
Subject: [Tools 7/7] winetest: Add some heuristics to detect missing dlls
	in	version 3 reports.
In-Reply-To: <alpine.DEB.1.00.0803142003100.23729@amboise.dolphin>
References: <alpine.DEB.1.00.0803142003100.23729@amboise.dolphin>
Message-ID: <47DCE876.8020507@gmail.com>

Hi,

I saw that 'gather' is not creating the index.html file at test.winehq.org anymore.

I had a quick look at test.winehq.org and something seem to have go wrong with 
the patching of 'gather':

pvriens at wine:/home/winehq/opt/winetest$ perl gather
Use of bare << to mean <<"" is deprecated at gather line 142.
Use of bare << to mean <<"" is deprecated at gather line 171.
Global symbol "$testref" requires explicit package name at gather line 142.
Global symbol "$extrema" requires explicit package name at gather line 142.
Global symbol "$extrema" requires explicit package name at gather line 142.
Global symbol "$extrema" requires explicit package name at gather line 142.
Global symbol "$extrema" requires explicit package name at gather line 142.
Global symbol "$extrema" requires explicit package name at gather line 142.
syntax error at gather line 176, near "HEAD:"
   (Might be a runaway multi-line << string starting on line 171)
Execution of gather aborted due to compilation errors.

-- 
Cheers,

Paul.


From artur.szymiec at gmail.com  Sun Mar 16 04:49:36 2008
From: artur.szymiec at gmail.com (Artur Szymiec)
Date: Sun, 16 Mar 2008 10:49:36 +0100
Subject: DSound Issues
Message-ID: <47DCED30.6030106@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Greeetings,

I would like to trackdown an issue with Direct Sound
on TM United (BUG http://bugs.winehq.org/show_bug.cgi?id=12058).

How can I provide some usefull data for DSound maintainers ?

Best regards
Artur

- --
- --------------------------------------------------------------------------
Registered User No 397465
Linux Debian 2.6.24.2 AMD Athlon(tm) 64 X2 Dual Core 5000+
Conquer your Desktop! http://www.kde.org/trykde/
Reclaim Your Inbox!   http://www.mozilla.org/products/thunderbird/
- --------------------------------------------------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFH3O0vbB2ld6kq2MsRAoiXAJ94yo6Lyhc6pnjPibpDr0s+aJlbTACg1dJd
gCpvefzVOhd0rJBKPOMXLOg=
=QhL+
-----END PGP SIGNATURE-----



From bobbyg at gmx.net  Sun Mar 16 08:44:37 2008
From: bobbyg at gmx.net (bobbyg at gmx.net)
Date: Sun, 16 Mar 2008 14:44:37 +0100
Subject: ddraw: Fix refcounting of palettes
Message-ID: <47DD2445.2060502@gmx.net>

This fixes a crash in a game called "Autobahnverfolgungsjagd Total"
(not in AppDB).

While tracing this bug I noticed that
IWineD3DBaseSurfaceImpl_GetPalette() does not call AddRef when
returning the palette. Is that intentional?

Cheers,
Cihan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-ddraw-Fix-refcounting-of-palettes.patch
Type: text/x-patch
Size: 0 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080316/d45e0a9b/attachment.bin 

From cia at koala  Sun Mar 16 08:25:27 2008
From: cia at koala (Cihan Altinay)
Date: Sun, 16 Mar 2008 14:25:27 +0100
Subject: ddraw: Fix refcounting of palettes
Message-ID: <mailman.166.1205675095.3731.wine-devel@winehq.org>

This patch prevents releasing the same palettes more than once if main
surfaces have a palette while sub-surfaces haven't.

---
 dlls/ddraw/texture.c |   12 ++++++++++--
 1 files changed, 10 insertions(+), 2 deletions(-)

diff --git a/dlls/ddraw/texture.c b/dlls/ddraw/texture.c
index 8835e4e..551e3b2 100644
--- a/dlls/ddraw/texture.c
+++ b/dlls/ddraw/texture.c
@@ -380,8 +380,16 @@ IDirect3DTextureImpl_Load(IDirect3DTexture2 *iface,
             IDirectDrawPalette_SetEntries(pal, 0, 0, 256, palent);
         }
 
-        if (pal) IDirectDrawPalette_Release(pal);
-        if (pal_src) IDirectDrawPalette_Release(pal_src);
+        if (pal)
+        {
+            IDirectDrawPalette_Release(pal);
+            pal = NULL;
+        }
+        if (pal_src)
+        {
+            IDirectDrawPalette_Release(pal_src);
+            pal_src = NULL;
+        }
 
         /* Copy one surface on the other */
         dst_d = (DDSURFACEDESC *)&(This->surface_desc);
-- 
1.5.4.2


--------------070206050602010305060400--


From dank at kegel.com  Sun Mar 16 09:01:03 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 16 Mar 2008 07:01:03 -0700
Subject: Wine Security Disclosure
In-Reply-To: <d6c5d7290803150518t27307drf04ff78bfd45872@mail.gmail.com>
References: <a71bd89a0803141233m62e4135bh1998d9057754b958@mail.gmail.com>
	<d6c5d7290803150518t27307drf04ff78bfd45872@mail.gmail.com>
Message-ID: <a71bd89a0803160701l396265a1xec06ea8345f67f8a@mail.gmail.com>

dmitry wrote:
>> if we are so compatible that we can run virii and spyware,
>> then we need to document it ... otherwise there will be many people
>> disappointed by unrealistic expectations.
>
> Again, I don't see how Wine developers could help with that,
> we are developers, not a health care department.

We can help in several ways:

1) at the top of our documentation, we can say

 "Warning: Wine can run Windows viruses and malware.
  Always practice safe computing -
  never run anything from somebody you don't trust,
  and never run any Windows app you haven't scanned
  for viruses."

2) we can at least document how to use clamav with wine,
  or link to clamav and its doc, e.g.
  http://www.clamav.net/
  https://help.ubuntu.com/community/ClamAV

3) we can warn on startup if we detect that clamav
  is not present.

4) we can try to make it easy to use free virus scanners
  with wine.  Some ideas:
  http://www.burghardt.pl/2007/11/wine-with-on-access-clamav-scanning/
  http://www.christoph-probst.com/soc2006/wine/

It's not enough to provide Wine and throw up our hands
saying "It's up to users to protect their systems"
because our users are at worst quite literally clueless,
and at best too busy to want to bother with virus issues.
If we can guide them or ease their way, we should.
- Dan


From stefan at codeweavers.com  Sun Mar 16 09:11:34 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 16 Mar 2008 15:11:34 +0100
Subject: Wine SOC - any d3d related projects
In-Reply-To: <47DACC46.8060302@gmail.com>
References: <47DACC46.8060302@gmail.com>
Message-ID: <200803161511.34306.stefan@codeweavers.com>

Am Freitag, 14. M?rz 2008 20:04:38 schrieb Artur Szymiec:
> Hi,
>
> are there any d3d related projects for SOC 2008 ?
> Who is the Mentor ? How can I join ?
For any D3D(not d3dx) gsoc project Henri, Roderick or I would be the mentor. 
If you want to do a project this list is a good place to announce your 
interest, later when the student registration is open you can officially 
apply at google's SOC pages.

I have a few rough ideas which I think might work:

*) Fixed function pipeline replacement shader using ARB shaders or GLSL
*) Pixel shader 1.x support using GL_ATI_fragment_shader(for shader support on 
ATI r200,r250 and r280 cards)
*) Pixel shader 1.x support using GL_NV_texture_shader and 
GL_NV_register_combiners(For shader support on Geforce 3 and Geforce 4 cards)
*) Get native d3drm.dll running. That's a good pool for finding ddraw/d3d7 
bugs.

A few othe ideas which might be hard for someone who doesn't know the code 
yet:

*) Prepare WineD3D for OpenGL 3(is that even out yet???) by splitting opengl 
rendering code from general management code. That is done already for 
surfaces, but needs to be done for IWineD3DDevice and buffers

*) Move WineD3D to a d3d10-like architecture: Restructure the textures, 
surfaces, index and vertex buffers around the D3D10/OpenGL resource model. To 
make use of that implement ATIs R2VB(render to vertex buffer) hack in 
d3d9.dll.

Maybe also worth a consideration:
*) Take an advanced game(e.g. Team Fortress 2 in dxlevel 95, Bioshock or 
Crysis) and a graphics driver which doesn't yet work as intended(e.g. fglrx 
or any MacOS driver) and isolate the problems that prevent it from working on 
the chosen driver. Then either find workarounds or report the bug to the 
driver vendor. The problem here is that we cannot find a timeframe for a 
debugging project. It could be done withhin 5 minutes or take years.

*) Similarly, in cooperation with the Xorg guys: Find the bug that causes 
those pesky random memory corruptions when using WineD3D with Mesa/DRI 
drivers.


From jjmckenzie51 at sprintpcs.com  Sun Mar 16 09:13:22 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sun, 16 Mar 2008 07:13:22 -0700
Subject: Wine code freeze in seven weeks; volunteers needed to fix 1.0 bugs
In-Reply-To: <558b2f5c0803151813s56526128v1358cbeeac53cc33@mail.gmail.com>
References: <a71bd89a0803151615u391878e4ub6bd99385ba372b3@mail.gmail.com>
	<47DC70AA.2030305@sprintpcs.com>
	<a71bd89a0803151806v50916e6ctfe836829bd226a1b@mail.gmail.com>
	<558b2f5c0803151813s56526128v1358cbeeac53cc33@mail.gmail.com>
Message-ID: <47DD2B02.3050001@sprintpcs.com>

Lei Zhang wrote:
> On Sat, Mar 15, 2008 at 6:06 PM, Dan Kegel <dank at kegel.com> wrote:
>   
>> <jjmckenzie51 at sprintpcs.com> wrote:
>>  >  6254 had a proposed fix from Tony Rollo, and was worked on both Lai
>>  >  Zhang and myself.  Can I send the proposed patch to the dev list for
>>  >  review?  The patch fixes the problem stated.
>>
>>  Lei, feel like resubmitting
>>  http://winehq.org/pipermail/wine-patches/2007-June/040182.html ?
>>  - Dan
>>
>>
>>
>>     
>
> That patch is old and crusty and doesn't apply anymore. James should
> have an updated version.
>
>
>   
Lei:

I do and I will look at it this afternoon.  It is supposed to be very 
rainy with thunderstorms here in Southern Arizona (we'll take every drop 
of rain we can get, we are in a drought) so I should be able to look at 
it and see if it applies to .57.  If it does, I will send it first to 
this list for comments and then after fixing what I can, to patches for 
integration.

I would like to publically thank Tony Rollo and you for the work you 
did, the both of you did the heavy work, I'm just cleaning it up.

James McKenzie



From dank at kegel.com  Sun Mar 16 09:30:06 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 16 Mar 2008 07:30:06 -0700
Subject: appdb request: "Browse Regressions"
Message-ID: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>

The nice reports in recent wwn's showing changes in
appdb ratings make me want to use the appdb itself
to see which apps have recently fallen in rating.

Following past appdb practice, one would implement
that by adding a new "Browse Regressions" menu
item on the left, below Browse Apps, Browse Newest Apps,
Downloadable Apps, and Browse Apps by Rating.

I expect this will become increasingly useful as
we approach 1.0.  How hard would it be?

(Also, it might be nice to have an "advanced browse"
that let you filter and sort by date, rating, and rating change.
Once that works well, we might not need
all those other specific browse commands...)
- Dan


From phil at newstar.rinet.ru  Sun Mar 16 09:43:12 2008
From: phil at newstar.rinet.ru (Phil Krylov)
Date: Sun, 16 Mar 2008 17:43:12 +0300
Subject: Wine code freeze in seven weeks; volunteers needed to fix 1.0 bugs
In-Reply-To: <47DD2B02.3050001@sprintpcs.com>
References: <a71bd89a0803151615u391878e4ub6bd99385ba372b3@mail.gmail.com>
	<47DC70AA.2030305@sprintpcs.com>
	<a71bd89a0803151806v50916e6ctfe836829bd226a1b@mail.gmail.com>
	<558b2f5c0803151813s56526128v1358cbeeac53cc33@mail.gmail.com>
	<47DD2B02.3050001@sprintpcs.com>
Message-ID: <c10dbf450803160743h203d66e8s8d731d20dd300d63@mail.gmail.com>

Hi,

>  > That patch is old and crusty and doesn't apply anymore. James should
>  > have an updated version.

One thing I can add from looking at that patch is that the comments
about the deficiency of MS richedit tables handling are true only for
versions <=2.0. Later versions, including msftedit, improved tables
handling with each new version.

-- Ph


From truiken at gmail.com  Sun Mar 16 09:30:04 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 16 Mar 2008 07:30:04 -0700
Subject: Wine code freeze in seven weeks; volunteers needed to fix 1.0 bugs
In-Reply-To: <47DD2B02.3050001@sprintpcs.com>
References: <a71bd89a0803151615u391878e4ub6bd99385ba372b3@mail.gmail.com>
	<47DC70AA.2030305@sprintpcs.com>
	<a71bd89a0803151806v50916e6ctfe836829bd226a1b@mail.gmail.com>
	<558b2f5c0803151813s56526128v1358cbeeac53cc33@mail.gmail.com>
	<47DD2B02.3050001@sprintpcs.com>
Message-ID: <251311EF-C57F-4D1A-9A81-A1D971F12D53@gmail.com>



On Mar 16, 2008, at 7:13 AM, James McKenzie  
<jjmckenzie51 at sprintpcs.com> wrote:

> Lei Zhang wrote:
>> On Sat, Mar 15, 2008 at 6:06 PM, Dan Kegel <dank at kegel.com> wrote:
>>
>>> <jjmckenzie51 at sprintpcs.com> wrote:
>>>> 6254 had a proposed fix from Tony Rollo, and was worked on both Lai
>>>> Zhang and myself.  Can I send the proposed patch to the dev list  
>>>> for
>>>> review?  The patch fixes the problem stated.
>>>
>>> Lei, feel like resubmitting
>>> http://winehq.org/pipermail/wine-patches/2007-June/040182.html ?
>>> - Dan
>>>
>>>
>>>
>>>
>>
>> That patch is old and crusty and doesn't apply anymore. James should
>> have an updated version.
>>
>>
>>
> Lei:
>
> I do and I will look at it this afternoon.  It is supposed to be very
> rainy with thunderstorms here in Southern Arizona (we'll take every  
> drop
> of rain we can get, we are in a drought) so I should be able to look  
> at
> it and see if it applies to .57.  If it does, I will send it first to
> this list for comments and then after fixing what I can, to patches  
> for
> integration.
>
> I would like to publically thank Tony Rollo and you for the work you
> did, the both of you did the heavy work, I'm just cleaning it up.
>
> James McKenzie
>
>
>

How crazy!  I'm just now driving through that rain on my way to LA :)

James


From kai.blin at gmail.com  Sun Mar 16 09:48:13 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Sun, 16 Mar 2008 15:48:13 +0100
Subject: Wine code freeze in seven weeks; volunteers needed to fix 1.0 bugs
In-Reply-To: <a71bd89a0803151615u391878e4ub6bd99385ba372b3@mail.gmail.com>
References: <a71bd89a0803151615u391878e4ub6bd99385ba372b3@mail.gmail.com>
Message-ID: <200803161548.20259.kai.blin@gmail.com>

On Sunday 16 March 2008 00:15:06 Dan Kegel wrote:
> Per http://wiki.winehq.org/WineReleasePlan,
> in early May, Wine's trunk will go into code freeze,
> and only small, obvious bugfixes will be accepted.

Could we please come up with a good plan on how to handle Summer of Code 
contributions _before_ we do a code freeze? I remember that the 2005 code 
freeze just when I was starting to get my patches in was immensely 
frustrating. Git will make this easier, but we _need_ to decide how we want 
to handle ongoing contributions. I know the idea of a code freeze is to get 
people working on existing bugs but for the SoC students that's just not an 
option. If we don't integrate the code during SoC, I doubt we're really going 
to use it. I still remember the ClamAV plugin that never made it to the 
master branch.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080316/d0b60988/attachment.pgp 

From stefan at codeweavers.com  Sun Mar 16 10:11:51 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 16 Mar 2008 16:11:51 +0100
Subject: d3dx9_36: Implements D3DXGetShaderVersion
In-Reply-To: <47DB11DD.3000708@ilidium.com>
References: <47DB11DD.3000708@ilidium.com>
Message-ID: <200803161611.51758.stefan@codeweavers.com>

Am Samstag, 15. M?rz 2008 01:01:33 schrieb Luis C. Busquets P?rez:
> To implement a test would be far more complicated as it would mean to
> include a binary shader. Anyway, I have tested the results with Civ4 (by
> making a derivation on d3dx9_32 with this function and using the
> original d3dx9_36.D3DXGetShaderVersion function) and the results where
> the same for all the shaders that where present.
You can grab a few binary shaders from dlls/d3d9/tests/visual.c I guess a few 
DWORDs would be enough. You can use the D3D9 sdk compiler to generate a few 
shaders:

wine vsa.exe shader.txt /Fh shader.h

Then shader.h contains a DWORD[] array with the shader bytecode


From dmitry at codeweavers.com  Sun Mar 16 10:21:42 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 16 Mar 2008 23:21:42 +0800
Subject: Wine Security Disclosure
References: <a71bd89a0803141233m62e4135bh1998d9057754b958@mail.gmail.com><d6c5d7290803150518t27307drf04ff78bfd45872@mail.gmail.com>
	<a71bd89a0803160701l396265a1xec06ea8345f67f8a@mail.gmail.com>
Message-ID: <004c01c88779$72d36bb0$a600fea9@DMITRY>

"Dan Kegel" <dank at kegel.com> wrote:

> It's not enough to provide Wine and throw up our hands
> saying "It's up to users to protect their systems"
> because our users are at worst quite literally clueless,
> and at best too busy to want to bother with virus issues.
> If we can guide them or ease their way, we should.

How other projects that provide cross platform compatibility or even
virtual environments to run executables from DOS/Windows/etc. cope with
that? Do they provide any information of possible security risks, or
they assume that the users of a being run software treat the execution
environment same way as an emulated one, and therefore it's fair to
assume the same level of awareness/responsibility as an emulated one
has? What's so special about Wine that doesn't apply to say VMWare,
Parallels, Win4Lin, DOSBox, and others? Probably yes, we could extend
the FAQ section about security, but that's almost everything we can do.

-- 
Dmitry.


From thestig at google.com  Sun Mar 16 10:22:05 2008
From: thestig at google.com (Lei Zhang)
Date: Sun, 16 Mar 2008 08:22:05 -0700
Subject: DSound Issues
In-Reply-To: <47DCED30.6030106@gmail.com>
References: <47DCED30.6030106@gmail.com>
Message-ID: <558b2f5c0803160822r646158dbr65fd5c5fb73c2221@mail.gmail.com>

On Sun, Mar 16, 2008 at 2:49 AM, Artur Szymiec <artur.szymiec at gmail.com> wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
>  Hash: SHA1
>
>  Greeetings,
>
>  I would like to trackdown an issue with Direct Sound
>  on TM United (BUG http://bugs.winehq.org/show_bug.cgi?id=12058).
>
>  How can I provide some usefull data for DSound maintainers ?

Hi,

We will triage the bug on Bugzilla. No need to email the devel list.

- Lei


From dank at kegel.com  Sun Mar 16 10:33:13 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 16 Mar 2008 08:33:13 -0700
Subject: Wine Security Disclosure
In-Reply-To: <004c01c88779$72d36bb0$a600fea9@DMITRY>
References: <a71bd89a0803141233m62e4135bh1998d9057754b958@mail.gmail.com>
	<d6c5d7290803150518t27307drf04ff78bfd45872@mail.gmail.com>
	<a71bd89a0803160701l396265a1xec06ea8345f67f8a@mail.gmail.com>
	<004c01c88779$72d36bb0$a600fea9@DMITRY>
Message-ID: <a71bd89a0803160833w1cc18c3cw8fb740a3514f0c0c@mail.gmail.com>

dmitry at codeweavers.com wrote:
>  What's so special about Wine that doesn't apply to say VMWare,
>  Parallels, Win4Lin, DOSBox, and others?

With vmware, parallels, and win4lin, you can actually
run commercial virus scanners inside those environments,
and everybody knows that one should do that if one
cares about viruses.

With DOSBox, well, the target market for that tool is so small
compared to Wine it doesn't matter, they're mostly technical users,
and there isn't much ms-dos malware being written these days.

So Wine really is different; you can't run commercial virus
scanners in it, it's for users who aren't technical enough to
be able to find an antivirus solution on their own, and
(worst of all) everybody assumes Linux is impervious to viruses.

> Probably yes, we could extend  the FAQ section about
> security, but that's almost everything we can do.

I pointed out several other things we could do.
Another one is we could make the wine package list clamav
as a dependency.

Denying there's a problem, or that we can do anything about it,
might lead to a large number of unhappy users.
- Dan


From stefan at codeweavers.com  Sun Mar 16 10:36:03 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 16 Mar 2008 16:36:03 +0100
Subject: ddraw: Fix refcounting of palettes
In-Reply-To: <47DD2445.2060502@gmx.net>
References: <47DD2445.2060502@gmx.net>
Message-ID: <200803161636.03424.stefan@codeweavers.com>

Am Sonntag, 16. M?rz 2008 14:44:37 schrieb bobbyg at gmx.net:
> This fixes a crash in a game called "Autobahnverfolgungsjagd Total"
> (not in AppDB).
I think it would be better to set pal = NULL if there is no wined3d palette 
returned a few lines above the place you're changing.

> While tracing this bug I noticed that
> IWineD3DBaseSurfaceImpl_GetPalette() does not call AddRef when
> returning the palette. Is that intentional?
This looks like it needs a fix


From dmitry at codeweavers.com  Sun Mar 16 10:39:57 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 16 Mar 2008 23:39:57 +0800
Subject: New function "SHParseDisplayName"
References: <1205678381.13535.2.camel@localhost>
Message-ID: <00c001c8877b$fef95760$a600fea9@DMITRY>

"Paul" <paulvgenderen at gmail.com> wrote:

> This is my first code contribution to Wine, I have _no_ idea if this
> patch is 100% correct

Then it's always a good idea to write some tests.

> but it /should/ work =)

It can't work since you haven't added an entry to the spec file.

-- 
Dmitry.


From thunderbird2k at gmx.net  Sun Mar 16 10:53:23 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 16 Mar 2008 16:53:23 +0100
Subject: appdb request: "Browse Regressions"
In-Reply-To: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>
References: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>
Message-ID: <20080316155323.139350@gmx.net>

> The nice reports in recent wwn's showing changes in
> appdb ratings make me want to use the appdb itself
> to see which apps have recently fallen in rating.
> 
> Following past appdb practice, one would implement
> that by adding a new "Browse Regressions" menu
> item on the left, below Browse Apps, Browse Newest Apps,
> Downloadable Apps, and Browse Apps by Rating.
> 
> I expect this will become increasingly useful as
> we approach 1.0.  How hard would it be?
> 
> (Also, it might be nice to have an "advanced browse"
> that let you filter and sort by date, rating, and rating change.
> Once that works well, we might not need
> all those other specific browse commands...)
> - Dan
> 

Personally I don't trust appdb regressions much. The main issue I see is that the appdb rating mechanism is not good. A lot of users don't know how to rate apps properly and even rate something as gold when half of its features don't work. They even rate it gold when they have to copy half a windows registry and tons of windows dlls.

This makes appdb lots of users complain that they saw that an app worked but that they can't reproduce it themselves. I have seen this on a lot of forums and on irc. A too low rating would even be better than a too high rating as it would then surprise users that an app worked.

Someone on irc started this page to come to a new rating:
http://wiki.winehq.org/appdbratingpage

I have extended it a bit and I think we should move to such a system in which the user needs to answer a few questions and that based on those answers a rating is selected.

The problem with the current approach is that due to the way different users rank apps, the appdb scores can fluctuate quite a bit.

Roderick
-- 
Ist Ihr Browser Vista-kompatibel? Jetzt die neuesten 
Browser-Versionen downloaden: http://www.gmx.net/de/go/browser


From dmitry at codeweavers.com  Sun Mar 16 10:57:47 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 16 Mar 2008 23:57:47 +0800
Subject: Wine Security Disclosure
References: <a71bd89a0803141233m62e4135bh1998d9057754b958@mail.gmail.com><d6c5d7290803150518t27307drf04ff78bfd45872@mail.gmail.com><a71bd89a0803160701l396265a1xec06ea8345f67f8a@mail.gmail.com><004c01c88779$72d36bb0$a600fea9@DMITRY>
	<a71bd89a0803160833w1cc18c3cw8fb740a3514f0c0c@mail.gmail.com>
Message-ID: <00da01c8877e$7c5651c0$a600fea9@DMITRY>

"Dan Kegel" <dank at kegel.com> wrote:

>>  What's so special about Wine that doesn't apply to say VMWare,
>>  Parallels, Win4Lin, DOSBox, and others?
> 
> With vmware, parallels, and win4lin, you can actually
> run commercial virus scanners inside those environments,

Is it really necessary to require running a virus scanner from
inside of Wine?

> and everybody knows that one should do that if one
> cares about viruses.

Same sentence applies to Wine I'd assume.

> With DOSBox, well, the target market for that tool is so small
> compared to Wine it doesn't matter, they're mostly technical users,
> and there isn't much ms-dos malware being written these days.

There are thousands of existing DOS viruses, it doesn't matter that
nobody writes new ones anymore, there are plenty of them already.

> So Wine really is different; you can't run commercial virus
> scanners in it,

It's still possible to run a native virus scanner outside of Wine.
Wine is just a part of underlying system, not a separate environment.

> it's for users who aren't technical enough to
> be able to find an antivirus solution on their own,

That's not different from other environments providing DOS/Windows
compatibility.

> and
> (worst of all) everybody assumes Linux is impervious to viruses.

I already answered to this one.

>> Probably yes, we could extend  the FAQ section about
>> security, but that's almost everything we can do.
> 
> I pointed out several other things we could do.
> Another one is we could make the wine package list clamav
> as a dependency.
> 
> Denying there's a problem, or that we can do anything about it,
> might lead to a large number of unhappy users.

Nobody denies that there is a problem, the thing is that personally
I don't see why that problem is Wine specific.

-- 
Dmitry.


From dank at kegel.com  Sun Mar 16 11:01:15 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 16 Mar 2008 09:01:15 -0700
Subject: appdb request: "Browse Regressions"
In-Reply-To: <20080316155323.139350@gmx.net>
References: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>
	<20080316155323.139350@gmx.net>
Message-ID: <a71bd89a0803160901w63a925e5t3ae4b99edb9b7b03@mail.gmail.com>

Roderick Colenbrander <thunderbird2k at gmx.net> wrote:
> A lot of users don't know how to rate apps properly and
> even rate something as gold when half of its features
> don't work. They even rate it gold when they have to copy
> half a windows registry and tons of windows dlls.

Agreed.  We need to solve this somehow.

>  Someone on irc started this page to come to a new rating:
>  http://wiki.winehq.org/appdbratingpage

I used to think that asking too many questions
would annoy users, but now I agree that a
wizard approach to computing the rating
might provide more reliable results.
- Dan


From dank at kegel.com  Sun Mar 16 11:04:39 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 16 Mar 2008 09:04:39 -0700
Subject: Wine Security Disclosure
In-Reply-To: <00da01c8877e$7c5651c0$a600fea9@DMITRY>
References: <a71bd89a0803141233m62e4135bh1998d9057754b958@mail.gmail.com>
	<d6c5d7290803150518t27307drf04ff78bfd45872@mail.gmail.com>
	<a71bd89a0803160701l396265a1xec06ea8345f67f8a@mail.gmail.com>
	<004c01c88779$72d36bb0$a600fea9@DMITRY>
	<a71bd89a0803160833w1cc18c3cw8fb740a3514f0c0c@mail.gmail.com>
	<00da01c8877e$7c5651c0$a600fea9@DMITRY>
Message-ID: <a71bd89a0803160904w5e58f2ear23873329a2f68a4e@mail.gmail.com>

dmitry at codeweavers.com wrote:
>  Is it really necessary to require running a virus scanner from
>  inside of Wine?

No.  Hey, cool, we agree on something!

>  > and everybody knows that one should do that if one
>  > cares about viruses.
>
>  Same sentence applies to Wine I'd assume.

No, because everybody assumes Linux is impervious
to viruses.  (You say you dealt with this comment, but
I must have missed it.)

>  > So Wine really is different; you can't run commercial virus
>  > scanners in it,
>
>  It's still possible to run a native virus scanner outside of Wine.

Yes.  And we need to encourage this, and perhaps hook into it.

>  Nobody denies that there is a problem, the thing is that personally
>  I don't see why that problem is Wine specific.

Wine increases Linux's attack surface area hugely
*and* attracts new users to Linux who are used
to computers coming with bundled virus scanners.
- Dan


From bobbyg at gmx.net  Sun Mar 16 11:22:52 2008
From: bobbyg at gmx.net (Cihan Altinay)
Date: Sun, 16 Mar 2008 17:22:52 +0100
Subject: ddraw: Fix refcounting of palettes
In-Reply-To: <200803161636.03424.stefan@codeweavers.com>
References: <47DD2445.2060502@gmx.net>
	<200803161636.03424.stefan@codeweavers.com>
Message-ID: <47DD495C.5020300@gmx.net>

Stefan D?singer wrote:
> Am Sonntag, 16. M?rz 2008 14:44:37 schrieb bobbyg at gmx.net:
> I think it would be better to set pal = NULL if there is no wined3d palette 
> returned a few lines above the place you're changing.

That's fine with me but it would mean setting it to NULL in every
iteration instead of only when necessary.

>> While tracing this bug I noticed that
>> IWineD3DBaseSurfaceImpl_GetPalette() does not call AddRef when
>> returning the palette. Is that intentional?
> This looks like it needs a fix

Ok, I'll add that to the same patch since the problem is related.

Cheers,
Cihan


From stefan at codeweavers.com  Sun Mar 16 11:33:21 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 16 Mar 2008 17:33:21 +0100
Subject: ddraw: Fix refcounting of palettes
In-Reply-To: <47DD495C.5020300@gmx.net>
References: <47DD2445.2060502@gmx.net>
	<200803161636.03424.stefan@codeweavers.com>
	<47DD495C.5020300@gmx.net>
Message-ID: <200803161733.21148.stefan@codeweavers.com>

Am Sonntag, 16. M?rz 2008 17:22:52 schrieb Cihan Altinay:
> Stefan D?singer wrote:
> > Am Sonntag, 16. M?rz 2008 14:44:37 schrieb bobbyg at gmx.net:
> > I think it would be better to set pal = NULL if there is no wined3d
> > palette returned a few lines above the place you're changing.
>
> That's fine with me but it would mean setting it to NULL in every
> iteration instead of only when necessary.
I don't think this code is highly performance critical, as it is usually 
called during loading. If you set it to NULL there you'll always set the 
palette that is used rather than relying that the previous iteration left a 
correct palette(maybe NULL) set.

> >> While tracing this bug I noticed that
> >> IWineD3DBaseSurfaceImpl_GetPalette() does not call AddRef when
> >> returning the palette. Is that intentional?
> >
> > This looks like it needs a fix
>
> Ok, I'll add that to the same patch since the problem is related.
If one patch works without the other please send separate patches.


From pure_evil at mail.bg  Sun Mar 16 11:50:04 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Sun, 16 Mar 2008 18:50:04 +0200
Subject: wine's very own control panel applets?
Message-ID: <200803161850.04879.pure_evil@mail.bg>

Hey folks
I was thinking of writing some substitutes/stubs for the windows .CPL files.

I migrated to using linux as a desktop fairly recently /used it for servers 
for a while, though/. Adapting to the linux equivalents of the programs I 
use, using wine for the rest etc.
Whilst "reinventing" the software base,I  had an annoyingly  familiar *close 
encounter* with a program which /both windows and wine/ gives out a message 
basically saying in short: "For this program to run, the decimal should 
be '.' and the negative sign - '-'." That's cuz the locale /Bulgarian/ uses 
the ',' as the default decimal /both win and wine/.

The solutions, of course, are the 3 obvious ones - copy intl.cpl from a 
working windows, go "regedit" on the subject, open the regs with a text 
editor. Both 3 are not very appealing (notably the first one; the 2nd and 3rd 
are rather annoying /if you haven't tampered with the registry too much/, but 
I consider the first one a real no-go.). So I decided to write something to 
replace the functions of intl.cpl, and called it "winelocalesetup".

However, this got me thinking further - what if that program instead of 
popping up that message, decided to execute,say, "control.exe intl.cpl", to 
save me some of the trouble? And didn't issue any warning, but instead 
crashed in midst of working with it if the decimal wasn't changed (which 
would normally be the case. It's an accounting program, so, the decimal is 
indeed important...) 

Anywho, I was thinking of creating a bunch of CPLs which mimic their windows 
counterparts in their names. However, the applet itself wouldn't do much - it 
would basically contain a somewhat appropriate icon/description, and, when 
started, launch the real executable, wine*something*.exe. 
That "wine*something*.exe" will for now basically show a 
message "Winesomething. Not implemented yet. If you see this message because 
of a running program, it means that the program is trying to...". With time, 
the .exe will be transformed into a useful substitute for the corresponding 
windows function.
For example:
intl.cpl - contains an icon (preferably a picture of the Earth; was thinking 
of going NASA on the subject), a description "Wine Locale Settings", and will 
execute winelocalesetup.exe. Winelocalesetup.exe would show a message: 
"Winelocalesetup. Not implemented yet. If you see this message, it means that 
a program is trying to call INTL.CPL, probably in order for you to modify the 
regional settings." That way, at least, it will be indicated to the user 
what's going on.

The idea for having both the cpls and the exes is, well, the cpls have to be 
called what they're called for compatibility reasons, and, once in place, 
need not be modified; the actual tool is contained within the .exe, which can 
be, well, a lot more flexible to develop than the CPL itself, and, can be 
replaced at any moment. And, well, although compatible with windows, it 
wouldn't be a pure repetition. (and no longer an empty control panel. Yay!)

BTW I have done quite some work on that winelocalesetup.exe, it reads the 
appropriate values from the registry, doesn't resemble the original 
intl.cpl's vision, and, well, is somewhat kinda useful (if only I could 
figure out how to WRITE the damn values, the keys keep turning back to their 
old values... oh well, guess I'll have to RTFM some more.)

So, any suggestions/comments/ideas? 


From bobbyg at gmx.net  Sun Mar 16 11:43:52 2008
From: bobbyg at gmx.net (Cihan Altinay)
Date: Sun, 16 Mar 2008 17:43:52 +0100
Subject: [RESEND] ddraw: Fix refcounting of palettes
Message-ID: <47DD4E48.2090904@gmx.net>

Changed as suggested by Stefan D?singer.

This fixes a crash in a game called "Autobahnverfolgungsjagd Total"
(not in AppDB).

Cheers,
Cihan

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-ddraw-Fix-refcounting-of-palettes-when-loading-text.patch
Type: text/x-patch
Size: 1518 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080316/3d866920/attachment.bin 

From alexd4 at inbox.lv  Sun Mar 16 11:50:41 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Sun, 16 Mar 2008 18:50:41 +0200
Subject: ddraw: Fix refcounting of palettes
In-Reply-To: <200803161636.03424.stefan@codeweavers.com>
References: <47DD2445.2060502@gmx.net>
	<200803161636.03424.stefan@codeweavers.com>
Message-ID: <47DD4FE1.4040704@inbox.lv>

Stefan D?singer wrote:
> Am Sonntag, 16. M?rz 2008 14:44:37 schrieb bobbyg at gmx.net:
>> This fixes a crash in a game called "Autobahnverfolgungsjagd Total"
>> (not in AppDB).
> I think it would be better to set pal = NULL if there is no wined3d palette 
> returned a few lines above the place you're changing.
> 
>> While tracing this bug I noticed that
>> IWineD3DBaseSurfaceImpl_GetPalette() does not call AddRef when
>> returning the palette. Is that intentional?
> This looks like it needs a fix

To my knowledge, the way refcounting for IWineD3DPalette currently works, 
refcount is always kept equal to 1 during its lifetime, IDirectDrawPalette owns 
this reference and releases it when it (ddraw palette) is getting destroyed. So, 
the real refcounting is done for ddraw palette and it is omitted in most places 
for wined3d palette (which simply gets destroyed together with ddraw palette). 
Generally, this seems to work ok. If IWineD3DBaseSurfaceImpl_GetPalette is 
changed to call AddRef, then all other places must be fixed too (SetPalette and 
callers of IWineD3DBaseSurfaceImpl_GetPalette, possibly others too) or things 
may break (leaks etc) and become inconsistent. For example, 
IDirectDrawSurfaceImpl_GetPalette does not call Release on interface it gets 
from IWineD3DSurface_GetPalette.


From stefan at codeweavers.com  Sun Mar 16 12:36:21 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 16 Mar 2008 18:36:21 +0100
Subject: wined3d: Increment reference count before returning palette
In-Reply-To: <47DD4FA2.4030000@gmx.net>
References: <47DD4FA2.4030000@gmx.net>
Message-ID: <200803161836.22043.stefan@codeweavers.com>

Am Sonntag, 16. M?rz 2008 17:49:38 schrieb Cihan Altinay:
> Cheers,
> Cihan
You'll have to check the code that uses this method. As far as I can see 
DDrawSurface::GetPalette doesn't release the palette it got from WineD3D, so 
just changing WineD3D will cause a leak


From stefan at codeweavers.com  Sun Mar 16 12:39:06 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 16 Mar 2008 18:39:06 +0100
Subject: [RESEND] ddraw: Fix refcounting of palettes
In-Reply-To: <47DD4E48.2090904@gmx.net>
References: <47DD4E48.2090904@gmx.net>
Message-ID: <200803161839.06890.stefan@codeweavers.com>

Am Sonntag, 16. M?rz 2008 17:43:52 schrieb Cihan Altinay:
> Changed as suggested by Stefan D?singer.
Looks good to me


From thestig at google.com  Sun Mar 16 12:45:43 2008
From: thestig at google.com (Lei Zhang)
Date: Sun, 16 Mar 2008 10:45:43 -0700
Subject: wine --show-config option?
Message-ID: <558b2f5c0803161045q40af369cod438e93d995adfb0@mail.gmail.com>

Hi,

Would it be helpful for the wine executable to have a --show-config
option? It can show information such as:

* what options are not compiled in
* the version of gcc, fontforge used
* whether gecko is installed
* what dlls are set to native

- Lei


From alex at thehandofagony.com  Sun Mar 16 12:45:55 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Sun, 16 Mar 2008 18:45:55 +0100
Subject: appdb request: "Browse Regressions"
In-Reply-To: <a71bd89a0803160901w63a925e5t3ae4b99edb9b7b03@mail.gmail.com>
References: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>
	<20080316155323.139350@gmx.net>
	<a71bd89a0803160901w63a925e5t3ae4b99edb9b7b03@mail.gmail.com>
Message-ID: <200803161845.56467.alex@thehandofagony.com>

> Roderick Colenbrander <thunderbird2k at gmx.net> wrote:
> > A lot of users don't know how to rate apps properly and
> > even rate something as gold when half of its features
> > don't work. They even rate it gold when they have to copy
> > half a windows registry and tons of windows dlls.
>
> Agreed.  We need to solve this somehow.
>

Certainly, that's my experience, too.

> >  Someone on irc started this page to come to a new rating:
> >  http://wiki.winehq.org/appdbratingpage
>
> I used to think that asking too many questions
> would annoy users, but now I agree that a
> wizard approach to computing the rating
> might provide more reliable results.
> - Dan

We were planning to add a wizard people could use if they were unsure about 
the rating, but yes, it might be a good idea to make it compulsory.


Alexander N. S?rnes


From thestig at google.com  Sun Mar 16 13:03:00 2008
From: thestig at google.com (Lei Zhang)
Date: Sun, 16 Mar 2008 11:03:00 -0700
Subject: Eric Pouech : riched20: Start handling OLE objects inside
	richedit.
In-Reply-To: <000001c88624$28e2dc80$7aa89580$@com>
References: <000001c88624$28e2dc80$7aa89580$@com>
Message-ID: <558b2f5c0803161103p4690356bjb6d6709966a62f1@mail.gmail.com>

On Fri, Mar 14, 2008 at 3:38 PM, EmpKey Administrator <admin at empkey.com> wrote:
>
>
>
>
> Hi,
>
>
>
> I am using CRichEditView class in MFC library to display RTF. The problem is
> that ole objects are not displayed in-line with their surround texts. Could
> you please let me know how to solve the problem?
>
>
>
> Thanks in advances
>
>
>
> emp
>
>
>
>
>

Wine-cvs is the wrong list. Please ask questions on wine-devel. Better
yet, file a bug on the Wine bugzilla:

http://bugs.winehq.org/

- Lei


From thestig at google.com  Sun Mar 16 13:17:38 2008
From: thestig at google.com (Lei Zhang)
Date: Sun, 16 Mar 2008 11:17:38 -0700
Subject: Improving the Wine Users Guide
Message-ID: <558b2f5c0803161117h4b341754nd5261c16a1372c73@mail.gmail.com>

Hi,

For our 1.0 release, we should have a polished users guide to help
people to learn to use Wine properly. I did a quick read of the Wine
Users Guide [1] and here are my comments:

* Near the top - mention virus / security issues, warn against running
Wine as root.
* Remove references to tools/wineinstall - does anyone use this anymore?
* Section 2.3.1 - mention ./configure --verbose
* Section 3.1.2.1 - are there dlls besides kernel32, gdi32, user32,
and ntdll that we should never use the native one? Add warning about
downloading dlls from the web.
* Section 3.1.3 - the default virtual window resolution is 800x600
now. Add documentation for the dpi setting. Remove references to
"desktop double buffering" - option no longer exists.
* Section 3.1.4 - document the advanced options.
* Section 3.1.5 - add a blurb about setting directsound emulation to
none when wine complains about it.
* Section 4.5 - mention the WINEPREFIX environment variable.
* Section 5.2.1 - mention including hardware / drivers info in bug reports

- Lei

[1] http://www.winehq.org/docs/en/wineusr-guide.html


From thestig at google.com  Sun Mar 16 13:29:26 2008
From: thestig at google.com (Lei Zhang)
Date: Sun, 16 Mar 2008 11:29:26 -0700
Subject: Wine Security Disclosure
In-Reply-To: <a71bd89a0803160701l396265a1xec06ea8345f67f8a@mail.gmail.com>
References: <a71bd89a0803141233m62e4135bh1998d9057754b958@mail.gmail.com>
	<d6c5d7290803150518t27307drf04ff78bfd45872@mail.gmail.com>
	<a71bd89a0803160701l396265a1xec06ea8345f67f8a@mail.gmail.com>
Message-ID: <558b2f5c0803161129v3f6ffbc5n29929d15f74f6e16@mail.gmail.com>

On Sun, Mar 16, 2008 at 7:01 AM, Dan Kegel <dank at kegel.com> wrote:
>  2) we can at least document how to use clamav with wine,
>   or link to clamav and its doc, e.g.
>   http://www.clamav.net/
>   https://help.ubuntu.com/community/ClamAV
>
>  3) we can warn on startup if we detect that clamav
>   is not present.
>
>  4) we can try to make it easy to use free virus scanners
>   with wine.  Some ideas:
>   http://www.burghardt.pl/2007/11/wine-with-on-access-clamav-scanning/
>   http://www.christoph-probst.com/soc2006/wine/

What about working with Linux distros to set up proper SELinux /
AppArmor profiles for Wine?


From ivg231 at gmail.com  Sun Mar 16 09:32:51 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Sun, 16 Mar 2008 10:32:51 -0400
Subject: d3dx9_36: Implements D3DXGetShaderVersion
In-Reply-To: <47DB11DD.3000708@ilidium.com>
References: <47DB11DD.3000708@ilidium.com>
Message-ID: <47DD2F93.8060109@gmail.com>

Luis C. Busquets P?rez wrote:
> This functions gets the Version Token of a binary shader. This Token 
> is the first of the binary stream so it is as easy as picling the 
> pointed DWORD. This is all public information available to the public.
What happens when the shader is NULL?
Yours will crash - MSDN says otherwise.

Does this work on Pixel and Vertex shaders ?
Does it always return back the first dword as is - what happens if an 
invalid shader version is passed in.

> To implement a test would be far more complicated as it would mean to 
> include a binary shader. Anyway, I have tested the results with Civ4 
> (by making a derivation on d3dx9_32 with this function and using the 
> original d3dx9_36.D3DXGetShaderVersion function) and the results where 
> the same for all the shaders that where present.
I would suggest an automated test across [ vs: 1.0, 1.1, 2.0, 2.1, 3.0 ] 
, [ ps: 1.0, 1.1, 1.2, 1.3, 1.4,  2.0, 2.1, 3.0 ] , NULL, and an invalid 
token.
You can see some binary shaders in the d3d9 tests.

Ivan






From jan.wine at zerebecki.de  Sun Mar 16 13:38:22 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sun, 16 Mar 2008 19:38:22 +0100
Subject: wine --show-config option?
In-Reply-To: <558b2f5c0803161045q40af369cod438e93d995adfb0@mail.gmail.com>
References: <558b2f5c0803161045q40af369cod438e93d995adfb0@mail.gmail.com>
Message-ID: <20080316183822.GK3557@crissy.swd.zerebecki.de>

On Sun, Mar 16, 2008 at 10:45:43AM -0700, Lei Zhang wrote:
> Would it be helpful for the wine executable to have a --show-config
> option? It can show information such as:
> 
> * what options are not compiled in
> * the version of gcc, fontforge used
> * whether gecko is installed
> * what dlls are set to native

Yes, please :) this would be really helpful . I must not be "wine
--show-config" but we should have the information about how wine
was compiled available in an installed wine and have an easy way
to put together all the important information about an wine
installation and a wine prefix so we can tell a user "Do foo and
give me the resulting file.".

There was already an attempt for some of this, see
http://article.gmane.org/gmane.comp.emulators.wine.patches/45328
.


Jan



From stefan at codeweavers.com  Sun Mar 16 13:40:12 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Sun, 16 Mar 2008 19:40:12 +0100
Subject: d3dx9_36: Implements D3DXGetShaderVersion
In-Reply-To: <47DD2F93.8060109@gmail.com>
References: <47DB11DD.3000708@ilidium.com> <47DD2F93.8060109@gmail.com>
Message-ID: <200803161940.12226.stefan@codeweavers.com>

Am Sonntag, 16. M?rz 2008 15:32:51 schrieb Ivan Gyurdiev:
> I would suggest an automated test across [ vs: 1.0, 1.1, 2.0, 2.1, 3.0 ]
> , [ ps: 1.0, 1.1, 1.2, 1.3, 1.4,  2.0, 2.1, 3.0 ] , NULL, and an invalid
> token.
> You can see some binary shaders in the d3d9 tests.
You can't really iterate over the shader versions as various shader versions 
use different bytecode tokens. Of course you could try to pass an invalid 
shader with a valid version token, but for a basic functionality test it 
should be a valid shader IMHO


From bobbyg at gmx.net  Sun Mar 16 13:57:06 2008
From: bobbyg at gmx.net (Cihan Altinay)
Date: Sun, 16 Mar 2008 19:57:06 +0100
Subject: wined3d: Increment reference count before returning palette
In-Reply-To: <200803161836.22043.stefan@codeweavers.com>
References: <47DD4FA2.4030000@gmx.net>
	<200803161836.22043.stefan@codeweavers.com>
Message-ID: <47DD6D82.9030502@gmx.net>

Stefan D?singer wrote:
> You'll have to check the code that uses this method. As far as I can see 
> DDrawSurface::GetPalette doesn't release the palette it got from WineD3D, so 
> just changing WineD3D will cause a leak

Yes, that's what Alexander Dorofeyev pointed out, too.
So do not apply this patch.


From jgardou at yahoo.fr  Sun Mar 16 14:13:13 2008
From: jgardou at yahoo.fr (=?iso-8859-1?q?J=E9r=F4me_Gardou?=)
Date: Sun, 16 Mar 2008 20:13:13 +0100
Subject: Improving the Wine Users Guide
In-Reply-To: <558b2f5c0803161117h4b341754nd5261c16a1372c73@mail.gmail.com>
References: <558b2f5c0803161117h4b341754nd5261c16a1372c73@mail.gmail.com>
Message-ID: <200803162013.13729.jgardou@yahoo.fr>

Le Sunday 16 March 2008 19:17:38 Lei Zhang, vous avez ?crit?:
> * Section 3.1.2.1 - are there dlls besides kernel32, gdi32, user32,
> and ntdll that we should never use the native one? Add warning about
> downloading dlls from the web.

Isn't ddraw a part of this ones ?

	

	
		
___________________________________________________________________________ 
Yahoo! Mail r?invente le mail ! D?couvrez le nouveau Yahoo! Mail et son interface r?volutionnaire.
http://fr.mail.yahoo.com



From stefan at codeweavers.com  Sun Mar 16 14:55:54 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 16 Mar 2008 20:55:54 +0100
Subject: Improving the Wine Users Guide
In-Reply-To: <200803162013.13729.jgardou@yahoo.fr>
References: <558b2f5c0803161117h4b341754nd5261c16a1372c73@mail.gmail.com>
	<200803162013.13729.jgardou@yahoo.fr>
Message-ID: <200803162055.54607.stefan@codeweavers.com>

Am Sonntag, 16. M?rz 2008 20:13:13 schrieb J?r?me Gardou:
> Le Sunday 16 March 2008 19:17:38 Lei Zhang, vous avez ?crit?:
> > * Section 3.1.2.1 - are there dlls besides kernel32, gdi32, user32,
> > and ntdll that we should never use the native one? Add warning about
> > downloading dlls from the web.
>
> Isn't ddraw a part of this ones ?
ddraw,d3d8,d3d9,d3d10,dsound, also mostly true for dinput


From tehblunderbuss at gmail.com  Sun Mar 16 15:20:29 2008
From: tehblunderbuss at gmail.com (TheBlunderbuss)
Date: Sun, 16 Mar 2008 15:20:29 -0500
Subject: Wine Security Disclosure
In-Reply-To: <004c01c88779$72d36bb0$a600fea9@DMITRY>
References: <a71bd89a0803141233m62e4135bh1998d9057754b958@mail.gmail.com><d6c5d7290803150518t27307drf04ff78bfd45872@mail.gmail.com>	<a71bd89a0803160701l396265a1xec06ea8345f67f8a@mail.gmail.com>
	<004c01c88779$72d36bb0$a600fea9@DMITRY>
Message-ID: <47DD810D.2000504@gmail.com>

An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080316/ad3bc3c2/attachment.htm 

From wine-devel at kievinfo.com  Sun Mar 16 15:26:32 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 16 Mar 2008 14:26:32 -0600
Subject: Improving the Wine Users Guide
In-Reply-To: <200803162055.54607.stefan@codeweavers.com>
References: <558b2f5c0803161117h4b341754nd5261c16a1372c73@mail.gmail.com>	<200803162013.13729.jgardou@yahoo.fr>
	<200803162055.54607.stefan@codeweavers.com>
Message-ID: <47DD8278.8040202@kievinfo.com>

Stefan D?singer wrote:
> Am Sonntag, 16. M?rz 2008 20:13:13 schrieb J?r?me Gardou:
>> Le Sunday 16 March 2008 19:17:38 Lei Zhang, vous avez ?crit :
>>> * Section 3.1.2.1 - are there dlls besides kernel32, gdi32, user32,
>>> and ntdll that we should never use the native one? Add warning about
>>> downloading dlls from the web.
>> Isn't ddraw a part of this ones ?
> ddraw,d3d8,d3d9,d3d10,dsound, also mostly true for dinput
> 
> 

Native dinput works perfectly for keyboard and mouse. Not at all for 
joystick. So I don't see any reason to put it on that list.

Add ntoskrnl.exe, hal.dll.

Vitaliy.


From jeffzaroyko at gmail.com  Sun Mar 16 16:04:35 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Sun, 16 Mar 2008 21:04:35 +0000 (UTC)
Subject: Improving the Wine Users Guide
References: <558b2f5c0803161117h4b341754nd5261c16a1372c73@mail.gmail.com>
Message-ID: <loom.20080316T210244-471@post.gmane.org>

Lei Zhang <thestig <at> google.com> writes:

> 
> Hi,
> 
> For our 1.0 release, we should have a polished users guide to help
> people to learn to use Wine properly. I did a quick read of the Wine
> Users Guide [1] and here are my comments:
> 
> * Remove references to tools/wineinstall - does anyone use this anymore?
> 

Anyone who reads the README distributed with wine might, it's listed under the
quick start section as the recommended way to build and install.



From juan.lang at gmail.com  Sun Mar 16 16:35:39 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Sun, 16 Mar 2008 14:35:39 -0700
Subject: wine's very own control panel applets?
In-Reply-To: <200803161850.04879.pure_evil@mail.bg>
References: <200803161850.04879.pure_evil@mail.bg>
Message-ID: <3a768c550803161435g2c31a271q60339daef3ad4eeb@mail.gmail.com>

Hi,

While I think writing control panel applets for Wine may be a good
idea in general, I wonder whether the specific example you propose--a
locale setting control panel--might be better served by trying to
infer the correct settings from the Linux locale.

--Juan


From ivg231 at gmail.com  Sun Mar 16 09:00:49 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Sun, 16 Mar 2008 10:00:49 -0400
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803162204.44168.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
Message-ID: <47DD2811.3010708@gmail.com>

I don't quite understand why it's necessary to write ARB, GLSL, and NONE 
shader descriptors inside the ati_shader file.
How will this infrastructure scale to a new shader backend added a year 
from now ?

For such a large patchset maybe there should be a high level design 
diagram that explains how it works ?

I very much like that backend-specific functionality ends up in the 
appropriate backend - as per patches 10, 11, and 14.
However, it seems those patches stand on their own, independent of the 
rest of the patchset and this feature.

Ivan









From dank at kegel.com  Sun Mar 16 17:25:04 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 16 Mar 2008 15:25:04 -0700
Subject: Locked topics considered harmful
Message-ID: <a71bd89a0803161525h418c2108p53e18289ad178df5@mail.gmail.com>

wine-users is not a forum, it's a mailing list.
Topics should not be locked except in extreme circumstances;
the bounce messages are annoying, and
it's wrong for the forum to not properly show
what's going on in the mailing list.


From stefan at codeweavers.com  Sun Mar 16 17:25:53 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 16 Mar 2008 23:25:53 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47DD2811.3010708@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<47DD2811.3010708@gmail.com>
Message-ID: <200803162325.53786.stefan@codeweavers.com>

Am Sonntag, 16. M?rz 2008 15:00:49 schrieb Ivan Gyurdiev:
> I don't quite understand why it's necessary to write ARB, GLSL, and NONE
> shader descriptors inside the ati_shader file.
> How will this infrastructure scale to a new shader backend added a year
> from now ?
Currently I am doing that so ATI cards which have ARB_fp or GLSL can use the 
fragment replacement code and d3d pshaders at the same time. As commented in 
the code we can remove all but the ATIfs+ARBvp backend the day we have a ffp 
replacement in ARB or GLSL. Thus there's no need for that to scale, what we 
have here is the worst case.

> I very much like that backend-specific functionality ends up in the
> appropriate backend - as per patches 10, 11, and 14.
> However, it seems those patches stand on their own, independent of the
> rest of the patchset and this feature.
You're right, the shader model changes do not really need the ATIfs code to 
work. However, separating them would be quite a pain, and I do not see any 
gain from that beyong the point where the patches are applied. It won't 
affect regression testing really.

The reason why I wrote it that way was that I needed an implementation of an 
ffp replacement to see where the whole thing goes. I couldn't do that with 
the existing nvts code because nvrc+nvts are quite different from 
arb/glsl/atifs and as described in the other mail putting that code into a 
separate shader backend won't help us much.


From juan.lang at gmail.com  Sun Mar 16 17:32:06 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Sun, 16 Mar 2008 15:32:06 -0700
Subject: Improving the Wine Users Guide
In-Reply-To: <558b2f5c0803161117h4b341754nd5261c16a1372c73@mail.gmail.com>
References: <558b2f5c0803161117h4b341754nd5261c16a1372c73@mail.gmail.com>
Message-ID: <3a768c550803161532h3f64077fk2085a5ef0381ad3f@mail.gmail.com>

>  * Section 3.1.2.1 - are there dlls besides kernel32, gdi32, user32,
>  and ntdll that we should never use the native one? Add warning about
>  downloading dlls from the web.

This list may end up being rather large.  Certainly not iphlpapi.
Right now, not netapi32 or crypt32, either, though whether that will
always be the case I can't say.
--Juan


From andrewriedi at gmail.com  Sun Mar 16 17:53:22 2008
From: andrewriedi at gmail.com (Andrew Riedi)
Date: Sun, 16 Mar 2008 15:53:22 -0700
Subject: Redirect http://forums.winehq.org -> http://forum.winehq.org.
Message-ID: <689de9370803161553v195b60f2h3c714782b63e9b70@mail.gmail.com>

Because many other sites have forums spelled in the plural, such as
http://ubuntuforums.org and http://forums.gentoo.org, many users
simply assume we will too.  I would like to request a redirect from
http://fourms.winehq.org to http://forum.winehq.org.

Note, even one of own developers made this mistake, which I sent in a
fix for at:  http://article.gmane.org/gmane.comp.emulators.wine.patches/48512
.

-- 
Andrew Riedi


From jjmckenzie51 at sprintpcs.com  Sun Mar 16 18:23:49 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sun, 16 Mar 2008 16:23:49 -0700
Subject: Locked topics considered harmful
In-Reply-To: <a71bd89a0803161525h418c2108p53e18289ad178df5@mail.gmail.com>
References: <a71bd89a0803161525h418c2108p53e18289ad178df5@mail.gmail.com>
Message-ID: <47DDAC05.9070402@sprintpcs.com>

Dan Kegel wrote:
> wine-users is not a forum, it's a mailing list.
> Topics should not be locked except in extreme circumstances;
> the bounce messages are annoying, and
> it's wrong for the forum to not properly show
> what's going on in the mailing list.
>
>
>   
+1
If a topic is also posted to the mailing list. 
If this is not possible or practical, put a message in the forum that 
the topic is being locked and why.  This will also reflect into the 
mailing list and make those of us on the list aware that the topic is 
locked.

James McKenzie



From fgouget at free.fr  Sun Mar 16 18:39:43 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 17 Mar 2008 00:39:43 +0100 (CET)
Subject: [Tools 7/7] winetest: Add some heuristics to detect missing dlls
	in version 3 reports.
In-Reply-To: <47DCE876.8020507@gmail.com>
References: <alpine.DEB.1.00.0803142003100.23729@amboise.dolphin>
	<47DCE876.8020507@gmail.com>
Message-ID: <alpine.DEB.1.00.0803170036570.14363@amboise.dolphin>

On Sun, 16 Mar 2008, Paul Vriens wrote:

> Hi,
> 
> I saw that 'gather' is not creating the index.html file at test.winehq.org
> anymore.
> 
> I had a quick look at test.winehq.org and something seem to have go wrong with
> the patching of 'gather':
> 
> pvriens at wine:/home/winehq/opt/winetest$ perl gather
> Use of bare << to mean <<"" is deprecated at gather line 142.
> Use of bare << to mean <<"" is deprecated at gather line 171.
> Global symbol "$testref" requires explicit package name at gather line 142.
> Global symbol "$extrema" requires explicit package name at gather line 142.
> Global symbol "$extrema" requires explicit package name at gather line 142.
> Global symbol "$extrema" requires explicit package name at gather line 142.
> Global symbol "$extrema" requires explicit package name at gather line 142.
> Global symbol "$extrema" requires explicit package name at gather line 142.
> syntax error at gather line 176, near "HEAD:"
>   (Might be a runaway multi-line << string starting on line 171)
> Execution of gather aborted due to compilation errors.

Yes, but I'm surprised because the pristine Git checkout I have here 
does not contain the word 'testref' and lines 142 and 171 don't 
contain '<<'. So it looks like what's being run does not correspond to 
what's in Git.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
           Cahn's Axiom: When all else fails, read the instructions.


From ivg231 at gmail.com  Sun Mar 16 11:35:25 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Sun, 16 Mar 2008 12:35:25 -0400
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803162325.53786.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<47DD2811.3010708@gmail.com>
	<200803162325.53786.stefan@codeweavers.com>
Message-ID: <47DD4C4D.7040605@gmail.com>

Stefan D?singer wrote:
> Am Sonntag, 16. M?rz 2008 15:00:49 schrieb Ivan Gyurdiev:
>   
>> I don't quite understand why it's necessary to write ARB, GLSL, and NONE
>> shader descriptors inside the ati_shader file.
>> How will this infrastructure scale to a new shader backend added a year
>> from now ?
>>     
> Currently I am doing that so ATI cards which have ARB_fp or GLSL can use the 
> fragment replacement code and d3d pshaders at the same time.

To me this suggests that there should be two separate shader backends, 
selected differently for "fixed pipeline replacement" purposes and for 
shaders. I don't like the argument that this is only an intermediate 
step - if no one writes the glsl/arb replacement code, it becomes permanent.

Ivan




From jjmckenzie51 at sprintpcs.com  Sun Mar 16 20:01:58 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sun, 16 Mar 2008 18:01:58 -0700
Subject: Wine Security Disclosure
In-Reply-To: <00da01c8877e$7c5651c0$a600fea9@DMITRY>
References: <a71bd89a0803141233m62e4135bh1998d9057754b958@mail.gmail.com>
	<d6c5d7290803150518t27307drf04ff78bfd45872@mail.gmail.com>
	<a71bd89a0803160701l396265a1xec06ea8345f67f8a@mail.gmail.com>
	<004c01c88779$72d36bb0$a600fea9@DMITRY>
	<a71bd89a0803160833w1cc18c3cw8fb740a3514f0c0c@mail.gmail.com>
	<00da01c8877e$7c5651c0$a600fea9@DMITRY>
Message-ID: <47DDC306.6060109@sprintpcs.com>

Dmitry Timoshkov wrote:
> "Dan Kegel" <dank at kegel.com> wrote:
>
>   
>>>  What's so special about Wine that doesn't apply to say VMWare,
>>>  Parallels, Win4Lin, DOSBox, and others?
>>>       
>> With vmware, parallels, and win4lin, you can actually
>> run commercial virus scanners inside those environments,
>>     
>
> Is it really necessary to require running a virus scanner from
> inside of Wine?
>
>   
No, but files should be scanned on Linux/UNIX/MacOSX using a virus 
scanner like ClamAV.  There even is a front end for the Mac.
>> and everybody knows that one should do that if one
>> cares about viruses.
>>     
>
> Same sentence applies to Wine I'd assume.
>
>   
Viruses depend on the environment.  The more APIs that are built, the 
more likely a virus will be able to run in Wine.
>
> It's still possible to run a native virus scanner outside of Wine.
> Wine is just a part of underlying system, not a separate environment.
>
>   
See my comment above.  Linux users have to become aware that Wine will 
make their systems vulnerable to Windows Viruses as well as running 
Windows Code.
>> and
>> (worst of all) everybody assumes Linux is impervious to viruses.
>>     
>
> I already answered to this one.
>
>   
Macs are not impervious to viruses, it just is not popular enough and 
the 'hoops' you have to go through to run a virus are major.  However, 
adding Wine does make Macs vulnerable to Windows viruses (at least some 
of them). 
>>> Probably yes, we could extend  the FAQ section about
>>> security, but that's almost everything we can do.
>>>       
>> I pointed out several other things we could do.
>> Another one is we could make the wine package list clamav
>> as a dependency.
>>
>> Denying there's a problem, or that we can do anything about it,
>> might lead to a large number of unhappy users.
>>     
>
> Nobody denies that there is a problem, the thing is that personally
> I don't see why that problem is Wine specific.
>
>   

The problem is that adding Wine to Linux/UNIX/MacOSX opens the system to 
Windows vulnerabilities unless they are blocked.  If we attempt to do 
this, the project may suffer.  So the other alternative is to make Wine 
users aware that adding this product to their systems may increase the 
likelyhood they may become infected if they do not practice good 
computer security habits, like using virus scanners to prevent 
introduction of viruses to their systems.  Even I as a Mac user practice 
good computer security, and that is because I got burned with a DOS 
virus on OS/2. 

+1 to adding Virus warnings on the Wine FAQ.

James McKenzie



From jjmckenzie51 at sprintpcs.com  Sun Mar 16 20:04:07 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sun, 16 Mar 2008 18:04:07 -0700
Subject: Wine Security Disclosure
In-Reply-To: <558b2f5c0803161129v3f6ffbc5n29929d15f74f6e16@mail.gmail.com>
References: <a71bd89a0803141233m62e4135bh1998d9057754b958@mail.gmail.com>
	<d6c5d7290803150518t27307drf04ff78bfd45872@mail.gmail.com>
	<a71bd89a0803160701l396265a1xec06ea8345f67f8a@mail.gmail.com>
	<558b2f5c0803161129v3f6ffbc5n29929d15f74f6e16@mail.gmail.com>
Message-ID: <47DDC387.10504@sprintpcs.com>

Lei Zhang wrote:
> On Sun, Mar 16, 2008 at 7:01 AM, Dan Kegel <dank at kegel.com> wrote:
>   
>>  2) we can at least document how to use clamav with wine,
>>   or link to clamav and its doc, e.g.
>>   http://www.clamav.net/
>>   https://help.ubuntu.com/community/ClamAV
>>
>>  3) we can warn on startup if we detect that clamav
>>   is not present.
>>
>>  4) we can try to make it easy to use free virus scanners
>>   with wine.  Some ideas:
>>   http://www.burghardt.pl/2007/11/wine-with-on-access-clamav-scanning/
>>   http://www.christoph-probst.com/soc2006/wine/
>>     
>
> What about working with Linux distros to set up proper SELinux /
> AppArmor profiles for Wine?
>
>
>   
Lei:

That would be fine, but what about the other UNIXes and MacOSX?  I don't 
want to attempt a test to see if a Windows virus will affect my Mac.  
Again, we have to make our user base aware that Windows viruses will run 
under Wine and that the results can be disasterous.  They should 
practice good computer security, to include scanning any and all files 
before using them with Wine.

James McKenzie



From stefan at codeweavers.com  Sun Mar 16 20:18:09 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 02:18:09 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47DD4C4D.7040605@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803162325.53786.stefan@codeweavers.com>
	<47DD4C4D.7040605@gmail.com>
Message-ID: <200803170218.09473.stefan@codeweavers.com>

Am Sonntag, 16. M?rz 2008 17:35:25 schrieb Ivan Gyurdiev:

> To me this suggests that there should be two separate shader backends,
> selected differently for "fixed pipeline replacement" purposes and for
> shaders. I don't like the argument that this is only an intermediate
> step - if no one writes the glsl/arb replacement code, it becomes
> permanent.
How would that work with e.g. GLSL, where vertex and fragment shaders are 
linked? How would you use a D3D vertex shader together with a ffp replacement 
fragment shader?

One of the aims of my patches is providing the infrastructure where summer of 
code applicants could kick in. So I think chances that we get an ARB or GLSL 
replacement soon are pretty good.


From madewokherd+d41d at gmail.com  Sun Mar 16 23:39:01 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Mon, 17 Mar 2008 00:39:01 -0400
Subject: explorer: add /startfile switch for starting files from file managers
Message-ID: <ced95fe0803162139q4a765f4dm1a84cc92a0ebe612@mail.gmail.com>

This patch adds a switch, /startfile, to explorer.exe, used as "wine
explorer /startfile filename". It accepts a windows or unix path. It
attempts to mimic what windows explorer does to start files and
provide some visible (gui) feedback when it doesn't work. The idea is
that wine.desktop can then be modified to use this switch instead of
wine, solving the following problems when starting exe files from file
managers:
* File managers typically do not set the working directory to the
directory that contains an exe when they start it. Setting the working
directory is the default behavior for windows explorer, and many
windows programs rely on it.
* File managers naturally use the unix path to start files, and the
wine binary passes the unix path along to the exe it starts, rather
than translating it to a windows path (this can and probably should
also be fixed somewhere else).
* Windows explorer always starts exe files with quotes around the path
in the command-line, even if the path does not contain spaces. The
wine binary does not (and probably should not) add quotes in this
situation. A few apps rely on the quotes. See
http://bugs.winehq.org/show_bug.cgi?id=5224#c14

My last attempt created a new winelib program; apparently this
functionality fits in explorer.

-- 
Vincent Povirk
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-explorer-add-startfile-switch-for-starting-files-f.patch
Type: text/x-patch
Size: 13559 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080317/a0aac1b6/attachment.bin 

From dmitry at codeweavers.com  Mon Mar 17 00:05:04 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 17 Mar 2008 13:05:04 +0800
Subject: user32: Add test_CreateIconFromResourceEx().
References: <689de9370803161544j310ad57p312e928e460aa3d0@mail.gmail.com>
Message-ID: <01bc01c887ec$78e0f720$a600fea9@DMITRY>

"Andrew Riedi" <andrewriedi at gmail.com> wrote:

> changelog: user32: Add test_CreateIconFromResourceEx().

What this patch is supposed to test? Just that CreateIconFromResourceEx
returns a valid icon handle? What about the resulting icon contents?
What about cases when CreateIconFromResourceEx should fail?

-- 
Dmitry.


From pure_evil at mail.bg  Mon Mar 17 02:05:08 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Mon, 17 Mar 2008 09:05:08 +0200
Subject: wine's very own control panel applets?
In-Reply-To: <3a768c550803161435g2c31a271q60339daef3ad4eeb@mail.gmail.com>
References: <200803161850.04879.pure_evil@mail.bg>
	<3a768c550803161435g2c31a271q60339daef3ad4eeb@mail.gmail.com>
Message-ID: <200803170905.08268.pure_evil@mail.bg>

On Sunday 16 March 2008 11:35:39 pm you wrote:
> Hi,
>
> While I think writing control panel applets for Wine may be a good
> idea in general, I wonder whether the specific example you propose--a
> locale setting control panel--might be better served by trying to
> infer the correct settings from the Linux locale.
>
> --Juan

I'm not sure how changing the decimal (in the example case) on linux would 
affect the linux apps themselves - will I have to switch it back and forth if 
another, linux app demands it to be ',' whilst the windows one wants a dot. 
(sorry if the question is somewhat stupid, still adapting, trying to get the 
windows way of thinking out of me head). 
So, in this particular case I was thinking of having the wine and linux 
locales as two different entities; After all, the win-apps only care about 
what the registry says, so no need to ever touch the global linux settings. 
(besides, the intl.cpl is the easiest and somewhat useful to make a 
substitute for, a nice starting point and a good test for the entire 
idea/toolkit; The truth is, I still haven't got much of a clue how the 
equivalent of appwiz.cpl would actually operate, not to mention (OMG!) 
hdwwiz.cpl).
In a more general sense, I have fresh memories of how frustrating the 
migration to linux can be in terms of the crash course you take once you see 
the desktop. So for a new user, having his favorite apps up and running 
properly under wine by doing something he's used to ->  Control Panel -> 
Regional Settings, rather than including a lesson in linux locale 
modification in the crash course would be nice. He can always take that 
lesson a few days later when he dares to get out of the box of the software 
he's used to ;)
BTW what about the general idea, a CPL (so the name matches) which executes 
a .exe (which does the real job,and is easier to substitute with another .exe 
when/if needed)? And a little hint on the structure... It looks like there 
are twenty-something *usual* applets. That would make 40+ additional files in 
the system32... maybe a c:/windows/winecontrolapplets folder which contains 
the .exes?


From dmitry at codeweavers.com  Mon Mar 17 02:30:33 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 17 Mar 2008 15:30:33 +0800
Subject: wine's very own control panel applets?
References: <200803161850.04879.pure_evil@mail.bg><3a768c550803161435g2c31a271q60339daef3ad4eeb@mail.gmail.com>
	<200803170905.08268.pure_evil@mail.bg>
Message-ID: <02b501c88800$caeee310$a600fea9@DMITRY>

<pure_evil at mail.bg> wrote:

> I'm not sure how changing the decimal (in the example case) on linux would 
> affect the linux apps themselves - will I have to switch it back and forth if 
> another, linux app demands it to be ',' whilst the windows one wants a dot. 
> (sorry if the question is somewhat stupid, still adapting, trying to get the 
> windows way of thinking out of me head). 

How about setting preferred values in ~/.wine/user.reg, under [Control Panel\International]
using your favourite text editor?

-- 
Dmitry.


From pure_evil at mail.bg  Mon Mar 17 02:53:53 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Mon, 17 Mar 2008 09:53:53 +0200
Subject: wine's very own control panel applets?
In-Reply-To: <02b501c88800$caeee310$a600fea9@DMITRY>
References: <200803161850.04879.pure_evil@mail.bg>
	<200803170905.08268.pure_evil@mail.bg>
	<02b501c88800$caeee310$a600fea9@DMITRY>
Message-ID: <200803170953.53247.pure_evil@mail.bg>

On Monday 17 March 2008 09:30:33 am you wrote:
> <pure_evil at mail.bg> wrote:
> > I'm not sure how changing the decimal (in the example case) on linux
> > would affect the linux apps themselves - will I have to switch it back
> > and forth if another, linux app demands it to be ',' whilst the windows
> > one wants a dot. (sorry if the question is somewhat stupid, still
> > adapting, trying to get the windows way of thinking out of me head).
>
> How about setting preferred values in ~/.wine/user.reg, under [Control
> Panel\International] using your favourite text editor?

LoL in my particular case, I did all 3 things on all the 
install/reinstall/uninstall cases I had trying to get that app to work /it 
requires Bulgarian language, it uses MDAC, it has a MSSQL2005 server backend, 
it needs that dot, some part is Tahoma font, others are, well, just about any 
font you can imagine, I know the man who wrote it, his moto is: "allways new 
stuff, always microsoft" /OMG is he really gonna go VISTA in a year or 
two?! /, IT'S THE APP FROM HELL!!!!... And there's no substitute :( /
I copied intl.cpl, went regedit, and, used vi on the reg. All 3 worked, but I 
was thinking in the lines of, will a regular user be happy with any of the 
three options should he encounter such a monstrosity, or, a different 
monstrosity which requires a different cpl.



From m.b.lankhorst at gmail.com  Mon Mar 17 03:33:19 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 17 Mar 2008 01:33:19 -0700
Subject: Improving the Wine Users Guide
In-Reply-To: <3a768c550803161532h3f64077fk2085a5ef0381ad3f@mail.gmail.com>
References: <558b2f5c0803161117h4b341754nd5261c16a1372c73@mail.gmail.com>
	<3a768c550803161532h3f64077fk2085a5ef0381ad3f@mail.gmail.com>
Message-ID: <b130c85e0803170133s33b7193ctc70d4d273bf1f884@mail.gmail.com>

2008/3/16, Juan Lang <juan.lang at gmail.com>:
> >  * Section 3.1.2.1 - are there dlls besides kernel32, gdi32, user32,
>  >  and ntdll that we should never use the native one? Add warning about
>  >  downloading dlls from the web.
>
>
> This list may end up being rather large.  Certainly not iphlpapi.
>  Right now, not netapi32 or crypt32, either, though whether that will
>  always be the case I can't say.
Winecfg already warns for a lot of dlls you shouldn't override.


From paul.vriens.wine at gmail.com  Mon Mar 17 03:50:24 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 09:50:24 +0100
Subject: user32: test processing of expose events (try 3)
In-Reply-To: <200803142359.54348.cjstimpson@utwire.net>
References: <200803142359.54348.cjstimpson@utwire.net>
Message-ID: <47DE30D0.3020802@gmail.com>

Clinton Stimpson wrote:
> Simplified from first try by removing unecessary thread.
> Also fixing style to other code in file (thanks for feedback).
> 
> ChangeLog:  
>   user32: test processing of expose events
> 
> Thanks,
> Clinton Stimpson
> 
> 
> ------------------------------------------------------------------------
> 
> 
The patch has been committed but makes sure that the user32 tests currently 
don't run on win95 anymore.

Can the MsgWaitForMultipleObjectsEx be changed to a MsgWaitForMultipleObjects?

If so, I'll sent in a patch, if not we have to exclude this test for win95 (and 
will also sent a patch).

-- 
Cheers,

Paul.


From hverbeet at gmail.com  Mon Mar 17 04:01:30 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 17 Mar 2008 10:01:30 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803170218.09473.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803162325.53786.stefan@codeweavers.com>
	<47DD4C4D.7040605@gmail.com>
	<200803170218.09473.stefan@codeweavers.com>
Message-ID: <d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>

On 17/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Sonntag, 16. M?rz 2008 17:35:25 schrieb Ivan Gyurdiev:
>
>
>  > To me this suggests that there should be two separate shader backends,
>  > selected differently for "fixed pipeline replacement" purposes and for
>  > shaders. I don't like the argument that this is only an intermediate
>  > step - if no one writes the glsl/arb replacement code, it becomes
>  > permanent.
>
> How would that work with e.g. GLSL, where vertex and fragment shaders are
>  linked? How would you use a D3D vertex shader together with a ffp replacement
>  fragment shader?
>
>  One of the aims of my patches is providing the infrastructure where summer of
>  code applicants could kick in. So I think chances that we get an ARB or GLSL
>  replacement soon are pretty good.
>

Personally, I'm not quite convinced of the need of an ati fragment
shader ffp replacement in the first place. The functionality seems
more of the level of register combiners and texture shaders.

Also, all the cards that are powerful enough to support a shader
implementation of fixed function processing support GLSL vertex and
fragment shaders, so realistically all you really need is a GLSL ffp
replacement.

On the subject of GSoC, I'm somewhat sceptical.


From mokresa at codeweavers.com  Mon Mar 17 04:05:53 2008
From: mokresa at codeweavers.com (Michal Okresa)
Date: Mon, 17 Mar 2008 10:05:53 +0100
Subject: Is the cxtest.org site down?
In-Reply-To: <b130c85e0803151844o411b74fbo11e4114ce9de912b@mail.gmail.com>
References: <b130c85e0803151844o411b74fbo11e4114ce9de912b@mail.gmail.com>
Message-ID: <47DE3471.8070204@codeweavers.com>

It is back again.

Maarten Lankhorst wrote:
> Hi,
> 
> I was trying to look at www.cxtest.org but the site seems not to work.
> Can this be fixed?
> 
> Cheers,
> Maarten.
> 
> 



From julliard at winehq.org  Mon Mar 17 04:15:39 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 17 Mar 2008 10:15:39 +0100
Subject: [Tools 7/7] winetest: Add some heuristics to detect missing dlls
	in version 3 reports.
In-Reply-To: <alpine.DEB.1.00.0803170036570.14363@amboise.dolphin> (Francois
	Gouget's message of "Mon, 17 Mar 2008 00:39:43 +0100 (CET)")
References: <alpine.DEB.1.00.0803142003100.23729@amboise.dolphin>
	<47DCE876.8020507@gmail.com>
	<alpine.DEB.1.00.0803170036570.14363@amboise.dolphin>
Message-ID: <87wso1btj8.fsf@wine.dyndns.org>

Francois Gouget <fgouget at free.fr> writes:

> Yes, but I'm surprised because the pristine Git checkout I have here 
> does not contain the word 'testref' and lines 142 and 171 don't 
> contain '<<'. So it looks like what's being run does not correspond to 
> what's in Git.

The problem is that someone (who shall remain nameless ;) committed
changes directly to the mirror repository, so updating from the main
repos failed. I've fixed it.

-- 
Alexandre Julliard
julliard at winehq.org


From jjmckenzie51 at earthlink.net  Sun Mar 16 21:56:36 2008
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Sun, 16 Mar 2008 19:56:36 -0700
Subject: Proposed EM_Fontrange Patch
Message-ID: <47DDDDE4.6050500@earthlink.net>

All:

I would like to see the problems with EM_Fontrange be fixed.  The 
attached patch is for comment/review and I would like SPECIFIC guidance 
on how to implement this patch as it relates to a Wine 1.0 bug 
(bug/issue 6254) and fixes the problem specified there.  The conformance 
tests are already in tests/editor.c and all they involve is removing 
some todo_wine blocks related to this issue.  The entire patch will do 
this.  Sorry that the patch is in UNIX diff format, I could not get git 
to do what I wanted.  The actual patch will be git format and use the 
daily git.

Also, I would like to extend thanks to Tony Rollo, Lei Zhang and Eric 
Pouech for their guidance and prior fixes.  I would like to thank Erich 
Pouech for moving some of the functionality that the original patch 
introduced into OLE handling.

Please be BRUTAL as I feel we have a limited time period to get this in 
and other related issues that the patch will expose fixed before Wine 1.0.

Thank you.

James McKenzie

-------------- next part --------------
A non-text attachment was scrubbed...
Name: EM_Fontrange.57.diff
Type: text/x-diff
Size: 30321 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080316/253bb96c/attachment-0001.diff 

From fgouget at free.fr  Mon Mar 17 05:26:36 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 17 Mar 2008 11:26:36 +0100 (CET)
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
References: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0803171028540.2931@amboise.dolphin>

On Sat, 15 Mar 2008, Dan Kegel wrote:

> I've updated http://wiki.winehq.org/WineReleaseCriteria
> to be a bit more final.
> 
> I've also written a draft release plan; see
> http://wiki.winehq.org/WineReleasePlan
> 
> Comments?

My understanding is that Wine 1.0's goal has never been to run 
everything under the sun but more to put a stake in the ground saying 
'now all the infrastructure is in place' and a change of gears to care 
more about not introducing regressions.

So I'd say that among the most important things to do for 1.0 is to:
 * make sure the conformance tests are correct. Currently a large 
fraction of them still fails on various Windows platforms which proves 
that they are far from correct (despite Paul Vriens' great work). As a 
start we could shoot for less than 10% failure on XP, 2003 and Vista for 
instance. Right now we stand at about 37%.

 * make sure the conformance tests work in Wine. This is actually on the 
1.0 bug list (bugs 7915 and 9916) but lost in the middle of the 99 bugs 
there's no chance they will be looked at very much.

 * I'd also consider '421 - Implement a DIB engine (framework)' as 
belonging to that list as it's clearly part of the infrastructure and 
has been needed for a long time (and the infrastructure part is within 
reach).


Also while I agree about having a small set of 'must run' applications, 
I think that most of the other application-specific issues can be moved 
to 1.1 (or future) right away:

5807 - Mercora IMRadio crashes while attempting to run
6048 - wine crashes while starting Strokes russian language course
2547 - word perfect 12 trial fails to install
6095 - MOTD in counter-strike 1.6 and counter-strike source does not render
5535 - Planescape:Torment doesn't work
1114 - Winrar2.90/3.00: Comboex doesn't trigger a event when you mouse-click in some value of it
3023 - Orcad - "Place Part" never tries to put down a part
3711 - Musicmatch fails to install (missing registry key, HTTP_HttpOpenRequest() problem)
4770 - BlackBerry Device Manager fails to install under wine
4971 - Corel Draw 12 demo install fails
5024 - Thief: Deadly Shadows crashes:page fault on read access to 0x0000040c
5163 - Office XP 2002 crashes on installation
5402 - Trying to run PhotoStitch 3.1
5828 - Command and Conquer Generals (Zero Hour) doesn't change the mouse cursor from the default X mouse
6126 - SoulSeek crashes
6526 - Typing Instructor for Kids 2 fails to install
6795 - Skype 3.0.0.137 Beta dies trying to login in win98, winme mode
7877 - Weatherbug install stops because of missing ie6
8095 - PQ Teaching toy crashes
8125 - Marratech 6.1 crashes on start
8898 - Run Time Error "445": Object doesn't support this action in Europa Knowledgebase
9030 - army men hangs on black screen
9039 - GS-Auftrag Professional SQL aborts on startup
9104 - Pdf-xchange viewer crashes
9304 - Temple of Elemental Evil demo doesn't start - gui irresponsive
9459 - FIFA 2007 crashes with the recent versions
9637 - Switchball only shows a blank screen
9809 - Autodesk Revit Architecture 2008 install fails
9895 - Alzip crashes: Invalid float operation
9942 - Powerpoint Viewer 2007 crashes opening .pptx files
10147 - Word Viewer 2003 - Tab behavior differs from Windows
10815 - Cannot drag images into Adobe Photoshop 7 from the web / desktop
10905 - thinstall firefox demo requires native msvcrt
10984 - sun jre 5 update 10 installer hangs in 0.9.52
11431 - Adobe Photoshop CS2: z-overlay of image containers
9469 - Adobe Photoshop Elements 1 welcome dialog options don't work
5948 - Star Trek: Armada does not install
7098 - RufzXP crashes on startup, needs mscoree.dll.CorBindToRuntimeEx


There, add a mere two bugs and remove 38. Isn't that a sweet deal?

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                     Avoid the Gates of Hell - use Linux.


From mstefani at redhat.com  Mon Mar 17 05:58:11 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Mon, 17 Mar 2008 11:58:11 +0100
Subject: gdi: Add a stub for GdipCreateFontFamilyFromName
In-Reply-To: <1205713085.6940.5.camel@mighmos>
References: <1205713085.6940.5.camel@mighmos>
Message-ID: <47DE4EC3.4000803@redhat.com>

Adam Petaccia wrote:
> This patch is needed for me to run Tabula Rasa.
> 
> This is my first patch, so please tell if I've broken conventions.
Please add the correct declarations for "struct GpFontCollection" and
"struct GpFontFamily". If you cannot find those on MSDN then check Mono;
that one seems to have them too. But please do not cut'n'paste.

bye
	michael

> ------------------------------------------------------------------------
> 
> diff --git a/dlls/gdiplus/font.c b/dlls/gdiplus/font.c
> index be60843..e0a781c 100644
> --- a/dlls/gdiplus/font.c
> +++ b/dlls/gdiplus/font.c
> @@ -27,6 +27,9 @@
>  
>  #include "gdiplus.h"
>  #include "gdiplus_private.h"
> +#include "wine/debug.h"
> +
> +WINE_DEFAULT_DEBUG_CHANNEL(gdiplus);
>  
>  GpStatus WINGDIPAPI GdipCreateFontFromLogfontW(HDC hdc,
>      GDIPCONST LOGFONTW *logfont, GpFont **font)
> @@ -99,3 +102,10 @@ GpStatus WINGDIPAPI GdipGetLogFontW(GpFont *font, GpGraphics *graphics,
>  
>      return Ok;
>  }
> +
> +GpStatus WINGDIPAPI GdipCreateFontFamilyFromName(GDIPCONST WCHAR *name, struct GpFontCollection *fontCollection, struct GpFontFamily **FontFamily)
> +{
> +	FIXME("GdipCreateFontFamilyFromName: stub!\n");
> +
> +	return Ok;
> +}
> diff --git a/dlls/gdiplus/gdiplus.spec b/dlls/gdiplus/gdiplus.spec
> index 4aac0df..1fbc57a 100644
> --- a/dlls/gdiplus/gdiplus.spec
> +++ b/dlls/gdiplus/gdiplus.spec
> @@ -85,7 +85,7 @@
>  @ stdcall GdipCreateCustomLineCap(ptr ptr long long ptr)
>  @ stub GdipCreateEffect
>  @ stub GdipCreateFont
> -@ stub GdipCreateFontFamilyFromName
> +@ stdcall GdipCreateFontFamilyFromName(ptr ptr ptr)
>  @ stub GdipCreateFontFromDC
>  @ stdcall GdipCreateFontFromLogfontA(ptr ptr ptr)
>  @ stdcall GdipCreateFontFromLogfontW(ptr ptr ptr)
> diff --git a/dlls/gdiplus/gdiplus_private.h b/dlls/gdiplus/gdiplus_private.h
> index 09ef83f..cd6a7d5 100644
> --- a/dlls/gdiplus/gdiplus_private.h
> +++ b/dlls/gdiplus/gdiplus_private.h
> @@ -184,4 +184,9 @@ struct GpStringFormat{
>      StringAlignment vertalign;
>  };
>  
> +struct GpFontCollection{
> +};
> +
> +struct GpFontFamily{
> +};
>  #endif
> 
> 
> ------------------------------------------------------------------------
> 
> 


-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Hauptst?tter Strasse 58, 70178 Stuttgart
Handelsregister: Amtsgericht Stuttgart HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                 Werner Knoblich


From stefan at codeweavers.com  Mon Mar 17 06:07:26 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 12:07:26 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803170218.09473.stefan@codeweavers.com>
	<d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>
Message-ID: <200803171207.27200.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 10:01:30 schrieb H. Verbeet:
> Personally, I'm not quite convinced of the need of an ati fragment
> shader ffp replacement in the first place. The functionality seems
> more of the level of register combiners and texture shaders.
Using that argument we could remove the nvrc/nvts code as well. Obviously this 
doesn't get us more functionality, but it brings ATI cards, most importantly 
the r200 cards to the same level as Nvidia cards.


From hverbeet at gmail.com  Mon Mar 17 06:18:11 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 17 Mar 2008 12:18:11 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803171207.27200.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803170218.09473.stefan@codeweavers.com>
	<d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>
	<200803171207.27200.stefan@codeweavers.com>
Message-ID: <d658b69e0803170418h69b9eee0od6d9805f186a7d13@mail.gmail.com>

On 17/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Montag, 17. M?rz 2008 10:01:30 schrieb H. Verbeet:
>
> > Personally, I'm not quite convinced of the need of an ati fragment
>  > shader ffp replacement in the first place. The functionality seems
>  > more of the level of register combiners and texture shaders.
>
> Using that argument we could remove the nvrc/nvts code as well. Obviously this
>  doesn't get us more functionality, but it brings ATI cards, most importantly
>  the r200 cards to the same level as Nvidia cards.
>
Supporting ATI fragment shader is useful, obviously. What I'm not so
sure about is positioning it as an ffp replacement.


From paul.vriens.wine at gmail.com  Mon Mar 17 07:21:36 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 13:21:36 +0100
Subject: wined3d: Check with "&& FALSE"
Message-ID: <47DE6250.6000506@gmail.com>

Hi,

In the past we had some occurrences of comparisons with NULL flags. I had this 
check run again today and it came back with:

./dlls/wined3d/arb_program_shader.c:316:         if(max_constantsF + 
extra_constants_needed + 1 < GL_LIMITS(pshader_constantsF) && FALSE) {

Is this line correct? Doesn't this alway return FALSE?

-- 
Cheers,

Paul.


From hverbeet at gmail.com  Mon Mar 17 07:39:35 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 17 Mar 2008 13:39:35 +0100
Subject: wined3d: Check with "&& FALSE"
In-Reply-To: <47DE6250.6000506@gmail.com>
References: <47DE6250.6000506@gmail.com>
Message-ID: <d658b69e0803170539h2a386946k35b1d82c9437a7f5@mail.gmail.com>

On 17/03/2008, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi,
>
>  In the past we had some occurrences of comparisons with NULL flags. I had this
>  check run again today and it came back with:
>
>  ./dlls/wined3d/arb_program_shader.c:316:         if(max_constantsF +
>  extra_constants_needed + 1 < GL_LIMITS(pshader_constantsF) && FALSE) {
>
>  Is this line correct? Doesn't this alway return FALSE?
>
Looks like leftover debug code to me.


From paul.vriens.wine at gmail.com  Mon Mar 17 07:48:30 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 13:48:30 +0100
Subject: wined3d: Check with "&& FALSE"
In-Reply-To: <d658b69e0803170539h2a386946k35b1d82c9437a7f5@mail.gmail.com>
References: <47DE6250.6000506@gmail.com>
	<d658b69e0803170539h2a386946k35b1d82c9437a7f5@mail.gmail.com>
Message-ID: <47DE689E.4030606@gmail.com>

H. Verbeet wrote:
> On 17/03/2008, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> Hi,
>>
>>  In the past we had some occurrences of comparisons with NULL flags. I had this
>>  check run again today and it came back with:
>>
>>  ./dlls/wined3d/arb_program_shader.c:316:         if(max_constantsF +
>>  extra_constants_needed + 1 < GL_LIMITS(pshader_constantsF) && FALSE) {
>>
>>  Is this line correct? Doesn't this alway return FALSE?
>>
> Looks like leftover debug code to me.
> 
Hi,

This is the commit responsible for this change:

commit 6313e0ffff5f57e437937e17fa482694d17d9664
Author: Stefan D?singer <stefan at codeweavers.com>
Date:   Fri Sep 14 13:02:59 2007 +0200

     wined3d: SRGB write correction emulation.

-- 
Cheers,

Paul.


From dank at kegel.com  Mon Mar 17 09:05:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 07:05:18 -0700
Subject: [Wine] Re: How to know which env vars a software wants
In-Reply-To: <1205761554.m2f.1445@forum.winehq.org>
References: <1205512949.m2f.1259@forum.winehq.org>
	<1205761554.m2f.1445@forum.winehq.org>
Message-ID: <a71bd89a0803170705u1757cee1m895f12c95de16dd1@mail.gmail.com>

vitamin <wineforum-user at winehq.org> wrote:
>  > > A simple touch ~/c:/windows/system32/drivers/etc/{services,host}
>  > So perhaps this will help other Informix-based apps?
>
>  Should probably add these files to Wine tree. "hosts" shouldn't need
> anything more then standard 127.0.0.1 localhost
>  And services should be empty.

Yep.  Filed as
http://bugs.winehq.org/show_bug.cgi?id=12076


From dank at kegel.com  Mon Mar 17 09:11:24 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 07:11:24 -0700
Subject: Make XP emulation the default?
Message-ID: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>

What would break if we made XP the default windows version in Wine?

I've run into several apps that fail to install unless I change that
setting lately...


From stefan at codeweavers.com  Mon Mar 17 09:14:21 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 15:14:21 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803170418h69b9eee0od6d9805f186a7d13@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171207.27200.stefan@codeweavers.com>
	<d658b69e0803170418h69b9eee0od6d9805f186a7d13@mail.gmail.com>
Message-ID: <200803171514.21417.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 12:18:11 schrieb H. Verbeet:
> Supporting ATI fragment shader is useful, obviously. What I'm not so
> sure about is positioning it as an ffp replacement.
Do you mean the term "ffp replacement", or what the code is doing? I for one 
call our nvrc code an ffp replacement as well, however, there's no sharp 
border between programmable and fixed function functionality. I've seen 
articles which called GL_ARB_texture_env_combine "programmable" as well.

I don't know if we can support 1.x pixel shaders properly using atifs because 
texkill and texdepth are missing. However, the visual test shows that the 
texdepth test is completely broken on my r200 card on Windows, and texkill 
basically works, but doesn't conform to the refrast and behavior of newer 
cards, so games should not really use those instructions.


From stefan at codeweavers.com  Mon Mar 17 09:06:46 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 15:06:46 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803170218.09473.stefan@codeweavers.com>
	<d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>
Message-ID: <200803171506.47002.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 10:01:30 schrieb H. Verbeet:
> Also, all the cards that are powerful enough to support a shader
> implementation of fixed function processing support GLSL vertex and
> fragment shaders, so realistically all you really need is a GLSL ffp
> replacement.
That's not quite true, my atifs replacement supports everything on the 
fragment side, and that card doesn't support GLSL(not even ARBfp). Also on 
the vertex side there are cards that have ARB only and not GLSL. I don't yet 
know if we can replace the fixed function vertex pipeline on r200 cards, as 
the 128 shader constants seem rather limiting, especially when it comes to 
indexed vertex blending. However, it should be able to do non-indexed vertex 
blending just fine, and we can get rid of the color conversion.


From julliard at winehq.org  Mon Mar 17 09:07:54 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 17 Mar 2008 15:07:54 +0100
Subject: msvcrt: Implement wcscat_s (try 4)
In-Reply-To: <frh8dd$kpq$1@ger.gmane.org> (Alistair Leslie-Hughes's message of
	"Sun, 16 Mar 2008 06:34:57 +1100")
References: <frh8dd$kpq$1@ger.gmane.org>
Message-ID: <87od9dbg05.fsf@wine.dyndns.org>

Alistair Leslie-Hughes <leslie_alistair at hotmail.com> writes:

> Hi,
> 	Added missing test

You should also test that you aren't overflowing the buffer. This should
help you find a bug in your implementation.

-- 
Alexandre Julliard
julliard at winehq.org


From hverbeet at gmail.com  Mon Mar 17 09:41:07 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 17 Mar 2008 15:41:07 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803171506.47002.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803170218.09473.stefan@codeweavers.com>
	<d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>
	<200803171506.47002.stefan@codeweavers.com>
Message-ID: <d658b69e0803170741i24251696gaae8e5ab6aa80f48@mail.gmail.com>

On 17/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Montag, 17. M?rz 2008 10:01:30 schrieb H. Verbeet:
>
> > Also, all the cards that are powerful enough to support a shader
>  > implementation of fixed function processing support GLSL vertex and
>  > fragment shaders, so realistically all you really need is a GLSL ffp
>  > replacement.
>
> That's not quite true, my atifs replacement supports everything on the
>  fragment side, and that card doesn't support GLSL(not even ARBfp).
Sure, but in that aspect it isn't really different from register combiners.

>  Also on
>  the vertex side there are cards that have ARB only and not GLSL. I don't yet
>  know if we can replace the fixed function vertex pipeline on r200 cards, as
>  the 128 shader constants seem rather limiting, especially when it comes to
>  indexed vertex blending. However, it should be able to do non-indexed vertex
>  blending just fine, and we can get rid of the color conversion.
>
I think a useful ffp replacement should at least replace the vertex
processing part. Extension s like ATI_fragment_shader and
NV_register_combiners, etc. can already support pretty much all of
fixed function fragment processing without having to integrate it in
the shader backends.

In terms of replacing vertex processing, anything that still has
dedicated hardware for fixed function processing isn't really powerful
enough to run such an ffp replacement, either because of instruction
count / number of constant limitations or simply execution speed. For
nvidia hardware that basically means you'll need at least something
like a GF5 or GF6.


From cjstimpson at utwire.net  Mon Mar 17 09:43:15 2008
From: cjstimpson at utwire.net (Clinton Stimpson)
Date: Mon, 17 Mar 2008 08:43:15 -0600
Subject: user32: test processing of expose events (try 3)
In-Reply-To: <47DE30D0.3020802@gmail.com>
References: <200803142359.54348.cjstimpson@utwire.net>
	<47DE30D0.3020802@gmail.com>
Message-ID: <47DE8383.5070205@utwire.net>

Paul Vriens wrote:
> Clinton Stimpson wrote:
>> Simplified from first try by removing unecessary thread.
>> Also fixing style to other code in file (thanks for feedback).
>>
>> ChangeLog:    user32: test processing of expose events
>>
>> Thanks,
>> Clinton Stimpson
>>
>>
>> ------------------------------------------------------------------------
>>
>>
> The patch has been committed but makes sure that the user32 tests 
> currently don't run on win95 anymore.
>
> Can the MsgWaitForMultipleObjectsEx be changed to a 
> MsgWaitForMultipleObjects?
Yes, it can be changed.  But its not clear to me why that fixes it.

Clint
>
> If so, I'll sent in a patch, if not we have to exclude this test for 
> win95 (and will also sent a patch).
>



From paul.vriens.wine at gmail.com  Mon Mar 17 09:46:43 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 15:46:43 +0100
Subject: user32: test processing of expose events (try 3)
In-Reply-To: <47DE8383.5070205@utwire.net>
References: <200803142359.54348.cjstimpson@utwire.net>
	<47DE30D0.3020802@gmail.com> <47DE8383.5070205@utwire.net>
Message-ID: <47DE8453.7060005@gmail.com>

Clinton Stimpson wrote:
> Paul Vriens wrote:
>> Clinton Stimpson wrote:
>>> Simplified from first try by removing unecessary thread.
>>> Also fixing style to other code in file (thanks for feedback).
>>>
>>> ChangeLog:    user32: test processing of expose events
>>>
>>> Thanks,
>>> Clinton Stimpson
>>>
>>>
>>> ------------------------------------------------------------------------
>>>
>>>
>> The patch has been committed but makes sure that the user32 tests 
>> currently don't run on win95 anymore.
>>
>> Can the MsgWaitForMultipleObjectsEx be changed to a 
>> MsgWaitForMultipleObjects?
> Yes, it can be changed.  But its not clear to me why that fixes it.
> 
> Clint

MsgWaitForMultipleObjectsEx is not available on win95. So we have to either load 
it via GetProcAddress and check for it's existence or just change to 
MsgWaitForMultipleObjects.

-- 
Cheers,

Paul.


From hverbeet at gmail.com  Mon Mar 17 09:53:04 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 17 Mar 2008 15:53:04 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803171514.21417.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171207.27200.stefan@codeweavers.com>
	<d658b69e0803170418h69b9eee0od6d9805f186a7d13@mail.gmail.com>
	<200803171514.21417.stefan@codeweavers.com>
Message-ID: <d658b69e0803170753y7b1046ffl35a3e372f80827bb@mail.gmail.com>

On 17/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Do you mean the term "ffp replacement", or what the code is doing? I for one
>  call our nvrc code an ffp replacement as well, however, there's no sharp
>  border between programmable and fixed function functionality. I've seen
>  articles which called GL_ARB_texture_env_combine "programmable" as well.
>
It's mostly a matter of where you integrate it into the code. At this
point I don't really see the advantage of making it a different shader
backend compared to integrating it into the existing fixed function
code.


From dank at kegel.com  Mon Mar 17 09:53:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 07:53:30 -0700
Subject: cabinet.dll -> FDICopy: Test added
Message-ID: <a71bd89a0803170753nc6caff2r4ce5766f262733e4@mail.gmail.com>

Did you forget the patch?


From stefan at codeweavers.com  Mon Mar 17 09:59:36 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 15:59:36 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803170741i24251696gaae8e5ab6aa80f48@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171506.47002.stefan@codeweavers.com>
	<d658b69e0803170741i24251696gaae8e5ab6aa80f48@mail.gmail.com>
Message-ID: <200803171559.36756.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 15:41:07 schrieb H. Verbeet:
> I think a useful ffp replacement should at least replace the vertex
> processing part. Extension s like ATI_fragment_shader and
> NV_register_combiners, etc. can already support pretty much all of
> fixed function fragment processing without having to integrate it in
> the shader backends.
From the atifs API putting the code into its own shader backend really helps 
abstraction and efficiency in wined3d(e.g. different state linking). nvrc has 
a vastly different API(individual stages instead of one "atomic" program that 
can't be split up).

If we ever implement pixel shaders using nvrc+nvts we'll have to move the code 
into a separate backend as well.

> In terms of replacing vertex processing, anything that still has
> dedicated hardware for fixed function processing isn't really powerful
> enough to run such an ffp replacement, either because of instruction
> count / number of constant limitations or simply execution speed. For
> nvidia hardware that basically means you'll need at least something
> like a GF5 or GF6.
I don't know how the r200 card works internally, but it might have dedicated 
ffp vertex hardware as well. At least from the development history of the 
r200 driver it seems like that, because the card didn't have ARBvp until the 
reverse engineered r300 code was backported.

Anyway, I do not intend to break the ability to use opengl fixed function + 
d3d shaders like we do now. Its just a matter of the shader backend 
configuring their state tables accordingly. Essentially glsl shader backend + 
its own state handlers = replacement pipeline, glsl shader backend + 
unmodified state table = opengl fixed function pipeline.

For the start I think we should prefer our current fixed function code with 
nvrc/ati by default and make a glsl or arb replacement opt-in for now. 
Especially glsl with its long shader linking time.


From thestig at google.com  Mon Mar 17 10:05:42 2008
From: thestig at google.com (Lei Zhang)
Date: Mon, 17 Mar 2008 08:05:42 -0700
Subject: explorer: add /startfile switch for starting files from file
	managers
In-Reply-To: <ced95fe0803162139q4a765f4dm1a84cc92a0ebe612@mail.gmail.com>
References: <ced95fe0803162139q4a765f4dm1a84cc92a0ebe612@mail.gmail.com>
Message-ID: <558b2f5c0803170805n1ec3f47kef243ac2f8732d4b@mail.gmail.com>

On Sun, Mar 16, 2008 at 9:39 PM, Vincent Povirk
<madewokherd+d41d at gmail.com> wrote:
> This patch adds a switch, /startfile, to explorer.exe, used as "wine
>  explorer /startfile filename". It accepts a windows or unix path. It
>  attempts to mimic what windows explorer does to start files and
>  provide some visible (gui) feedback when it doesn't work. The idea is
>  that wine.desktop can then be modified to use this switch instead of
>  wine, solving the following problems when starting exe files from file
>  managers:
>  * File managers typically do not set the working directory to the
>  directory that contains an exe when they start it. Setting the working
>  directory is the default behavior for windows explorer, and many
>  windows programs rely on it.
>  * File managers naturally use the unix path to start files, and the
>  wine binary passes the unix path along to the exe it starts, rather
>  than translating it to a windows path (this can and probably should
>  also be fixed somewhere else).
>  * Windows explorer always starts exe files with quotes around the path
>  in the command-line, even if the path does not contain spaces. The
>  wine binary does not (and probably should not) add quotes in this
>  situation. A few apps rely on the quotes. See
>  http://bugs.winehq.org/show_bug.cgi?id=5224#c14
>
>  My last attempt created a new winelib program; apparently this
>  functionality fits in explorer.
>
>  --
>  Vincent Povirk
>
>
>
>

Patches should go to wine-patches, not wine-devel.


From stefan at codeweavers.com  Mon Mar 17 10:15:21 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 16:15:21 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803170753y7b1046ffl35a3e372f80827bb@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171514.21417.stefan@codeweavers.com>
	<d658b69e0803170753y7b1046ffl35a3e372f80827bb@mail.gmail.com>
Message-ID: <200803171615.22030.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 15:53:04 schrieb H. Verbeet:
> It's mostly a matter of where you integrate it into the code. At this
> point I don't really see the advantage of making it a different shader
> backend compared to integrating it into the existing fixed function
> code.
As I explained in the other mail, atifs uses a complete fragment shader 
object, as opposed to nvrc/nvts and arb combiners, which configure single 
stages. This requires different state linking. So to implement that 
efficiently I need at least a different state table which links all fixed 
function states together, instead of one that links colorop settings and 
alphaop settings per stage.

Also if we ever implement pixel shaders using atifs we'll need a shader 
backend for it.


From hverbeet at gmail.com  Mon Mar 17 10:22:30 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 17 Mar 2008 16:22:30 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803171559.36756.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171506.47002.stefan@codeweavers.com>
	<d658b69e0803170741i24251696gaae8e5ab6aa80f48@mail.gmail.com>
	<200803171559.36756.stefan@codeweavers.com>
Message-ID: <d658b69e0803170822k1bba0bd8ve521f3dadb950456@mail.gmail.com>

On 17/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> From the atifs API putting the code into its own shader backend really helps
>  abstraction and efficiency in wined3d(e.g. different state linking). nvrc has
>  a vastly different API(individual stages instead of one "atomic" program that
>  can't be split up).
>
That's more an issue with the state table design than a reason to
create a new shader backend. A more hierarchical state table would
probably have helped there, but the general issue you're trying to
solve is that you want the state table to change depending on the
available extensions and wined3d configuration. I don't think that's
limited to shaders or fragment processing. If a GL3 spec ever actually
gets released, and actual drivers start implementing it, we'll run
into it there as well.


From dmitry at codeweavers.com  Mon Mar 17 10:36:42 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 17 Mar 2008 23:36:42 +0800
Subject: cabinet.dll -> FDICopy: Test added
References: <200803171816.51565.vitperov@etersoft.ru>
Message-ID: <05bf01c88844$b53f3030$a600fea9@DMITRY>

"Vitaly Perov" <vitperov at etersoft.ru> wrote:

> +void CreateEmptyCab(void)
> +{
> +    static char file_array [] = {77, 83, 67, 70, 0, 0, 0, 0, 36, 0, 0, 0, 0, 0, 0, 0, 36, 0, 0, 0, 0, 0, 0, 0, 3, 1, 
> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

It should be 'static const char' ?

> +    FILE* fp;
> +    int i;
> +
> +    fp = fopen("test1.cab", "wb" );
> +   if (!fp) trace("Can't create file test1.cab\n");

That should be an assert.

> +    for (i = 0; i < sizeof(file_array); i++)
> +        fputc(file_array[i], fp);

What about fwrite?

> +    fclose(fp);
> +}

Functions you add should be static. Use Win32 APIs to create a temporary
file. Set tab size to 8, and avoid using tabs to indent code at all. Avoid
trailing spaces.


-- 
Dmitry. 



From paul.vriens.wine at gmail.com  Mon Mar 17 10:41:13 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 16:41:13 +0100
Subject: advapi32 security tests and Vista (PROCESS_ALL_ACCESS)
Message-ID: <47DE9119.4040202@gmail.com>

Hi,

I'm now looking at some of the failures for the security tests on Vista. 
Apparently PROCESS_ALL_ACCESS which is defined as:

#define PROCESS_ALL_ACCESS         (STANDARD_RIGHTS_REQUIRED|SYNCHRONIZE|0xfff)

is changed on Vista:

#define PROCESS_ALL_ACCESS         (STANDARD_RIGHTS_REQUIRED|SYNCHRONIZE|0xffff)

Should I change the tests (CreateProcess) to check for both possibilities or 
should our PROCESS_ALL_ACCESS be changed?

I'm not sure what implications the latter one has yet. Only that using that mask 
on other windows versions will/could fail.

-- 
Cheers,

Paul.


From julliard at winehq.org  Mon Mar 17 10:43:05 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 17 Mar 2008 16:43:05 +0100
Subject: shell32: Support getting the shell folder path for users other
	than the current user and the default user (take 4)
In-Reply-To: <200803141125.m2EBPPPP010439@mailhost.geldorp.nl> (Ge van
	Geldorp's message of "Fri, 14 Mar 2008 12:25:27 +0100")
References: <200803141125.m2EBPPPP010439@mailhost.geldorp.nl>
Message-ID: <87abkxbbli.fsf@wine.dyndns.org>

"Ge van Geldorp" <ge at thinstall.com> writes:

> This is getting embarassing :). Fix memory leak.

Now it fails make test:

../../../tools/runtest -q -P wine -M shell32.dll -T ../../.. -p shell32_test.exe.so shellpath.c && touch shellpath.ok
shellpath.c:305: Test failed: SHGetFolderLocation(NULL, CSIDL_FAVORITES, 2, 0, &pidl) returned 0x80070006, expected E_FAIL
make[2]: *** [shellpath.ok] Error 1

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Mon Mar 17 10:47:39 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 16:47:39 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803170822k1bba0bd8ve521f3dadb950456@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171559.36756.stefan@codeweavers.com>
	<d658b69e0803170822k1bba0bd8ve521f3dadb950456@mail.gmail.com>
Message-ID: <200803171647.39614.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 16:22:30 schrieb H. Verbeet:
> That's more an issue with the state table design than a reason to
> create a new shader backend. A more hierarchical state table would
> probably have helped there, but the general issue you're trying to
> solve is that you want the state table to change depending on the
> available extensions and wined3d configuration. I don't think that's
> limited to shaders or fragment processing. If a GL3 spec ever actually
> gets released, and actual drivers start implementing it, we'll run
> into it there as well.

Couldn't we have discussed that one week ago when I sent the patches to 
wine-devel? ;-)

I think putting the state table into a shader backend is quite reasonable 
considering the existing opengl spec and extension, even if we do not call 
atifs/nvrc "shaders". With my patches we set the shader backend using complex 
conditions based on available extensions. If we keep the state table separate 
we'd set both that way, and probably need shader specific decisions in either 
the state handlers, or state table specific considerations in the shaders. I 
do not see what we would gain by not putting the atifs code into a shader 
backend, other than moving the temporary uglyness of the 3 backends to a 
permanent state table selection uglyness.

As far as opengl 3 is concerned, I think they wanted to get rid of the fixed 
function pipeline, in that case we'd be best of with the shader backend 
anyway. However, I think trying to find an architecture that deals with 
future interfaces is a bit of lottery anyway. We don't know what Direct3D 11 
will bring either.


From paul.vriens.wine at gmail.com  Mon Mar 17 11:21:51 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 17:21:51 +0100
Subject: [Tools 6/6] winetest: Issue a better description than '.' for
	the	special failure modes. Write them as a note so they stand out
	better.
In-Reply-To: <alpine.DEB.1.00.0803171232160.2931@amboise.dolphin>
References: <alpine.DEB.1.00.0803171232160.2931@amboise.dolphin>
Message-ID: <47DE9A9F.8000809@gmail.com>

Francois Gouget wrote:
> ---
>  winetest/gather |   12 ++++++------
>  1 files changed, 6 insertions(+), 6 deletions(-)
> 
> diff --git a/winetest/gather b/winetest/gather
> index b502345..ee49f4a 100755
> --- a/winetest/gather
> +++ b/winetest/gather
> @@ -329,21 +329,21 @@ sub singletest($$$) {
>  EOF
>      } elsif ($count eq "winetest crash") {
>          print OUT <<"EOF";
> -      <td class="result fail also-skip"><a
> +      <td class="note"><a
>          title="Test did not run as winetest crashed"
> -        >.</a></td>
> +        >winetest</a></td>
>  EOF
>      } elsif ($count eq "file limit") {
>          print OUT <<"EOF";
> -      <td class="result fail also-skip"><a
> +      <td class="note"><a
>          title="Test is missing because of a partial report file"
> -        >.</a></td>
> +        >truncated</a></td>
>  EOF
>      } elsif ($count eq "test missing") {
>          print OUT <<"EOF";
> -      <td class="result fail also-skip"><a
> +      <td class="note"><a
>          title="Test did not run for an unknown reason"
> -        >.</a></td>
> +        >not run</a></td>
>  EOF
>      } else {
>          my $class = $error?"fail":$todo?"todo":"pass";
Hi Francois,

We currently have these single '.' also when there are multiple failures for an 
OS that are actually the same failures.

For example the missing dll's. There are several dll's missing on win95 and 
win98 so it would be nice to have this reflected in the group piece of the page. 
I think green with a blue border looks much nicer than the single '.' we are 
currently having. Other thoughts?

The new page layout is now present and I must say it looks better although Wine 
looks a bit worse now because all the green is gone :-).

-- 
Cheers,

Paul.


From raccoonone at procyongames.com  Mon Mar 17 11:21:47 2008
From: raccoonone at procyongames.com (Christopher)
Date: Mon, 17 Mar 2008 09:21:47 -0700
Subject: Running services in WINE?
In-Reply-To: <47DAD30E.3060105@zalewski.pl>
References: <47D82648.30208@procyongames.com>		<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>		<47D8C6B9.8030607@procyongames.com>
	<47DA77A3.8060206@gmail.com>	<22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
	<47DACDF0.3060503@gmail.com> <47DAD30E.3060105@zalewski.pl>
Message-ID: <47DE9A9B.5060401@procyongames.com>

Miko?aj Zalewski wrote:
>
>> If we wanted to implemented a SCM where would that reside? wineboot?
>>   
>  The SCM is the servies.exe program. Other programs using advapi32 
> communicates with it using RPC. I've started writing it - see 
> http://www.winehq.org/pipermail/wine-patches/2007-September/044396.html 
> . The problems with widl are fixed so it should be possible to add 
> this code to Wine. Probably this code should be updated to current 
> Wine and I'm not sure if I moved all the database query function to 
> services.exe (it's good to more them all in one go to avoid 
> discrepancies between the current advapi implementation that relies on 
> the current state of registry keys and services.exe that loads all the 
> keys at start time and keeps them in memory).
>  I may have some time to work on it and I can help if someone who 
> wants to do it (if one wants to have an idea how the SCM works there 
> is a chapter about it in "Windows Internals" by M. Russinovich and D. 
> Solomon).
>
> Miko?aj Zalewski
>
>
Thanks for sending in your patch Miko?aj, I tested MozyHome with it, but 
it didn't help anything, the service still wouldn't start. I don't have 
the experience to work on that patch by myself, but if someone else 
starts on it and would like assistance making tests or something I'm 
happy to try.

Christopher Berner


From carlfongheiser at gmail.com  Mon Mar 17 11:23:47 2008
From: carlfongheiser at gmail.com (Carl Fongheiser)
Date: Mon, 17 Mar 2008 11:23:47 -0500
Subject: advapi32 security tests and Vista (PROCESS_ALL_ACCESS)
In-Reply-To: <47DE9119.4040202@gmail.com>
References: <47DE9119.4040202@gmail.com>
Message-ID: <1ba87a1f0803170923r7fbff0der7f2cc0a034da38e2@mail.gmail.com>

On Mon, Mar 17, 2008 at 10:41 AM, Paul Vriens <paul.vriens.wine at gmail.com>
wrote:

> Hi,
>
> I'm now looking at some of the failures for the security tests on Vista.
> Apparently PROCESS_ALL_ACCESS which is defined as:
>
> #define PROCESS_ALL_ACCESS
> (STANDARD_RIGHTS_REQUIRED|SYNCHRONIZE|0xfff)
>
> is changed on Vista:
>
> #define PROCESS_ALL_ACCESS
> (STANDARD_RIGHTS_REQUIRED|SYNCHRONIZE|0xffff)
>
> Should I change the tests (CreateProcess) to check for both possibilities
> or
> should our PROCESS_ALL_ACCESS be changed?
>
> I'm not sure what implications the latter one has yet. Only that using
> that mask
> on other windows versions will/could fail.
>

Windows Vista/Windows Server 2008 have a new permission flag,
PROCESS_QUERY_LIMITED_INFORMATION, with a value of 0x1000.  That's why they
added the extra nibble.   The permission check code isn't supposed to check
bits it doesn't know about, so it should be harmless to enable the extra
nibble even on older versions.

Carl Fongheiser
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080317/845f6ba8/attachment.htm 

From adam at tpetaccia.com  Mon Mar 17 11:35:37 2008
From: adam at tpetaccia.com (Adam Petaccia)
Date: Mon, 17 Mar 2008 12:35:37 -0400
Subject: gdi: Add a stub for GdipCreateFontFamilyFromName
In-Reply-To: <47DE4EC3.4000803@redhat.com>
References: <1205713085.6940.5.camel@mighmos>  <47DE4EC3.4000803@redhat.com>
Message-ID: <1205771738.6751.2.camel@mighmos>

On Mon, 2008-03-17 at 11:58 +0100, Michael Stefaniuc wrote:
> Adam Petaccia wrote:
> > This patch is needed for me to run Tabula Rasa.
> > 
> > This is my first patch, so please tell if I've broken conventions.
> Please add the correct declarations for "struct GpFontCollection" and
> "struct GpFontFamily". If you cannot find those on MSDN then check Mono;
> that one seems to have them too. But please do not cut'n'paste.
I believe they are abstract classes with no members of their own, but
I'm not sure how to write that in C. I'll take a look at similar wine
code in a bit, but does anyone have any pointers on where I should
start?

> 
> bye
> 	michael
> 
> > ------------------------------------------------------------------------
> > 
> > diff --git a/dlls/gdiplus/font.c b/dlls/gdiplus/font.c
> > index be60843..e0a781c 100644
> > --- a/dlls/gdiplus/font.c
> > +++ b/dlls/gdiplus/font.c
> > @@ -27,6 +27,9 @@
> >  
> >  #include "gdiplus.h"
> >  #include "gdiplus_private.h"
> > +#include "wine/debug.h"
> > +
> > +WINE_DEFAULT_DEBUG_CHANNEL(gdiplus);
> >  
> >  GpStatus WINGDIPAPI GdipCreateFontFromLogfontW(HDC hdc,
> >      GDIPCONST LOGFONTW *logfont, GpFont **font)
> > @@ -99,3 +102,10 @@ GpStatus WINGDIPAPI GdipGetLogFontW(GpFont *font, GpGraphics *graphics,
> >  
> >      return Ok;
> >  }
> > +
> > +GpStatus WINGDIPAPI GdipCreateFontFamilyFromName(GDIPCONST WCHAR *name, struct GpFontCollection *fontCollection, struct GpFontFamily **FontFamily)
> > +{
> > +	FIXME("GdipCreateFontFamilyFromName: stub!\n");
> > +
> > +	return Ok;
> > +}
> > diff --git a/dlls/gdiplus/gdiplus.spec b/dlls/gdiplus/gdiplus.spec
> > index 4aac0df..1fbc57a 100644
> > --- a/dlls/gdiplus/gdiplus.spec
> > +++ b/dlls/gdiplus/gdiplus.spec
> > @@ -85,7 +85,7 @@
> >  @ stdcall GdipCreateCustomLineCap(ptr ptr long long ptr)
> >  @ stub GdipCreateEffect
> >  @ stub GdipCreateFont
> > -@ stub GdipCreateFontFamilyFromName
> > +@ stdcall GdipCreateFontFamilyFromName(ptr ptr ptr)
> >  @ stub GdipCreateFontFromDC
> >  @ stdcall GdipCreateFontFromLogfontA(ptr ptr ptr)
> >  @ stdcall GdipCreateFontFromLogfontW(ptr ptr ptr)
> > diff --git a/dlls/gdiplus/gdiplus_private.h b/dlls/gdiplus/gdiplus_private.h
> > index 09ef83f..cd6a7d5 100644
> > --- a/dlls/gdiplus/gdiplus_private.h
> > +++ b/dlls/gdiplus/gdiplus_private.h
> > @@ -184,4 +184,9 @@ struct GpStringFormat{
> >      StringAlignment vertalign;
> >  };
> >  
> > +struct GpFontCollection{
> > +};
> > +
> > +struct GpFontFamily{
> > +};
> >  #endif
> > 
> > 
> > ------------------------------------------------------------------------
> > 
> > 
> 
> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080317/e1ec07b8/attachment.pgp 

From pure_evil at mail.bg  Mon Mar 17 12:04:44 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Mon, 17 Mar 2008 19:04:44 +0200
Subject: First wine cpl available to test - the regional settings
Message-ID: <200803171904.44476.pure_evil@mail.bg>

I made the first cpl (intl.cpl), and, the actual executable that goes with it.
http://www.keepandshare.com/doc/view.php?id=460541&da=y
that should link to a file called intl_wine.zip.
It contains 2 things: intl.cpl which goes into c:\windows\system32
and a folder - winecontrolapplets containing the executable 
winelocalesetup.exe. The folder goes into c:\windows. 
when using "wine control", that should've added a "Locale settings" icon in 
the control panel, and launching it should execute the winelocalesetup.exe.
For some reason, though, it only reads the reg values, when trying to 
write 'em, they revert.
(haven't tested it on a winbox yet though; if writing sticks there, a possible 
bug? Using wine 0.9.57. Tested it on two openSuSe 10.3 boxes though.)

Give the concept a test drive, see if the duality matching cpl/real executable 
is feasable etc, drop me a line on cpls in general - which ones should be 
emulated etc.

If you're more interested in only the regional settings themselves, test 'em 
out on a few locales; I've already done the US one, also 
"LANG=bg_BG wine control" and "LANG=ru_RU wine control" appear to show logical 
stuff, but I have no way of knowing whether the other locales look good.

Cheers,
Stefanov


From lich at math.spbu.ru  Mon Mar 17 12:22:33 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Mon, 17 Mar 2008 17:22:33 +0000
Subject: services.exe: series of patches - empty attachments.
Message-ID: <200803172022.34310.lich@math.spbu.ru>

Hi,

Empty patches are attached to every e-mail in this series.
Size: 0 bytes
http://www.winehq.org/pipermail/wine-patches/2008-March/051638.html
http://www.winehq.org/pipermail/wine-patches/2008-March/051651.html
http://www.winehq.org/pipermail/wine-patches/2008-March/051641.html
...
--
Kirill


From fgouget at free.fr  Mon Mar 17 12:18:08 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 17 Mar 2008 18:18:08 +0100 (CET)
Subject: [Tools 6/6] winetest: Issue a better description than '.' for
	the special failure modes. Write them as a note so they stand out
	better.
In-Reply-To: <47DE9A9F.8000809@gmail.com>
References: <alpine.DEB.1.00.0803171232160.2931@amboise.dolphin>
	<47DE9A9F.8000809@gmail.com>
Message-ID: <alpine.DEB.1.00.0803171756180.22074@amboise.dolphin>

On Mon, 17 Mar 2008, Paul Vriens wrote:
[...]
> We currently have these single '.' also when there are multiple failures for
> an OS that are actually the same failures.

Yes, I've noticed that. Essentially we lose information when merging bug 
reports. Fix That's next on my todo list. Here's my (optimistic) todo 
list:

 * Fix merging report data so the group-level information is more 
accurate.
 * Collect statistics about the number of unit tests that failed and 
their percentage, both for individual reports and for groups.
 * For each build, collect global statistics about the group-level 
results, how many reports of each type are present, etc. Store that 
in a new machine readable file (a bit like the individual report's 
summary.txt files).
 * Add a new script that takes these build-level summaries and generates 
a proper top-level index file showing the percentage of failed unit 
tests and the count of reports for each group.

That last bit would make progress more visible, and would make it easier 
to find a build which has been tested on a given platform.


> For example the missing dll's. There are several dll's missing on win95 and
> win98 so it would be nice to have this reflected in the group piece of the
> page. I think green with a blue border looks much nicer than the single '.' we
> are currently having. Other thoughts?

Well, if, for a given test, all the reports in the group have the 
same state ('crashed', 'timed out', 'errors', etc.), then the group's 
cell should look exactly like each of the corresponding report cells. So 
in the missing Win95 dlls, this would indeed be a 'pass also-skip' cell. 
But if they all crashed, then it should be a white cell with 
the 'crashed' message.

If the cells have different states, for instance one says 'crashed' and 
the other 'timed out', or one says 'not run' and the other says errors 
occurred, then I think the group cell should say something like 'mixed' 
and be on a white background.

Maybe the 'filelimit' and 'truncated' cells should be ignored when 
merging, though we should really not have any of these either.



> The new page layout is now present and I must say it looks better although
> Wine looks a bit worse now because all the green is gone :-).

Yeah :-/ But I think it more accurately reflects the state of Wine. 
Hopefully it's also more motivating for the people fixing Wine to 
eliminate todos.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                           La terre est une b


From mikolaj at zalewski.pl  Mon Mar 17 12:21:10 2008
From: mikolaj at zalewski.pl (=?UTF-8?B?TWlrb8WCYWogWmFsZXdza2k=?=)
Date: Mon, 17 Mar 2008 18:21:10 +0100
Subject: services.exe: series of patches - empty attachments.
In-Reply-To: <200803172022.34310.lich@math.spbu.ru>
References: <200803172022.34310.lich@math.spbu.ru>
Message-ID: <47DEA886.7040808@zalewski.pl>


>Hi,
>
>Empty patches are attached to every e-mail in this series.
>Size: 0 bytes
>http://www.winehq.org/pipermail/wine-patches/2008-March/051638.html
>http://www.winehq.org/pipermail/wine-patches/2008-March/051651.html
>http://www.winehq.org/pipermail/wine-patches/2008-March/051641.html
>...
>  
>
  For some reason the attachements are shown by the mail archive as 
separate [PATCH] entries, like: 
http://www.winehq.org/pipermail/wine-patches/2008-March/051639.html .

Miko?aj Zalewski


From mikolaj at zalewski.pl  Mon Mar 17 12:27:30 2008
From: mikolaj at zalewski.pl (=?UTF-8?B?TWlrb8WCYWogWmFsZXdza2k=?=)
Date: Mon, 17 Mar 2008 18:27:30 +0100
Subject: Running services in WINE?
In-Reply-To: <47DE9A9B.5060401@procyongames.com>
References: <47D82648.30208@procyongames.com>		<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>		<47D8C6B9.8030607@procyongames.com>
	<47DA77A3.8060206@gmail.com>	<22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
	<47DACDF0.3060503@gmail.com> <47DAD30E.3060105@zalewski.pl>
	<47DE9A9B.5060401@procyongames.com>
Message-ID: <47DEAA02.40101@zalewski.pl>


> Thanks for sending in your patch Miko?aj, I tested MozyHome with it, 
> but it didn't help anything, the service still wouldn't start. I don't 
> have the experience to work on that patch by myself, but if someone 
> else starts on it and would like assistance making tests or something 
> I'm happy to try.

  I can look into that (I see it's bug #12030) however it looks like 
it's not a problem with starting the service but may be a problem with 
the service itself. Have you tried to run this service with e.g. notepad 
running in the background - the services are marked as system processes 
and if there is no non-system process left, all the system processes 
will terminate themselves.

Miko?aj Zalewski


From paul.vriens.wine at gmail.com  Mon Mar 17 13:00:03 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 19:00:03 +0100
Subject: msi: Skip the endlines test if the table fails on import
In-Reply-To: <22821af30803171016i3ed4ffb6hdbfdaad76035057b@mail.gmail.com>
References: <22821af30803171016i3ed4ffb6hdbfdaad76035057b@mail.gmail.com>
Message-ID: <47DEB1A3.3090406@gmail.com>

James Hawkins wrote:
> Hi,
> 
> Fixes 33 test failures on win9x.
> 
> Changelog:
> * Skip the endlines test if the table fails on import.
> 
>  dlls/msi/tests/db.c |    7 ++++++-
>  1 files changed, 6 insertions(+), 1 deletions(-)
> 
> 
> 
> ------------------------------------------------------------------------
> 
> 
But shouldn't the ok-call stay and be moved after the if? Or is there not much 
extra information when add_table_to_db fails?

-- 
Cheers,

Paul.


From stefan at codeweavers.com  Mon Mar 17 13:08:28 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 19:08:28 +0100
Subject: wined3d: Check with "&& FALSE"
In-Reply-To: <47DE689E.4030606@gmail.com>
References: <47DE6250.6000506@gmail.com>
	<d658b69e0803170539h2a386946k35b1d82c9437a7f5@mail.gmail.com>
	<47DE689E.4030606@gmail.com>
Message-ID: <200803171908.28947.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 13:48:30 schrieb Paul Vriens:
> H. Verbeet wrote:
> > On 17/03/2008, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> >>  Is this line correct? Doesn't this alway return FALSE?
> >
> > Looks like leftover debug code to me.
Yes, this is leftover debugging code. Feel free to send a patch to remove it



From paul.vriens.wine at gmail.com  Mon Mar 17 13:19:15 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 19:19:15 +0100
Subject: wined3d: Check with "&& FALSE"
In-Reply-To: <200803171908.28947.stefan@codeweavers.com>
References: <47DE6250.6000506@gmail.com>
	<d658b69e0803170539h2a386946k35b1d82c9437a7f5@mail.gmail.com>
	<47DE689E.4030606@gmail.com>
	<200803171908.28947.stefan@codeweavers.com>
Message-ID: <47DEB623.8020301@gmail.com>

Stefan D?singer wrote:
> Am Montag, 17. M?rz 2008 13:48:30 schrieb Paul Vriens:
>> H. Verbeet wrote:
>>> On 17/03/2008, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>>>>  Is this line correct? Doesn't this alway return FALSE?
>>> Looks like leftover debug code to me.
> Yes, this is leftover debugging code. Feel free to send a patch to remove it
> 
OK, I'll sent a patch for that.

What's "strange" though is that Coverity didn't pick this up as DEADCODE.

Cheers,

Paul.


From paul.vriens.wine at gmail.com  Mon Mar 17 13:22:27 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 19:22:27 +0100
Subject: Running services in WINE?
In-Reply-To: <47DEAA02.40101@zalewski.pl>
References: <47D82648.30208@procyongames.com>		<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>		<47D8C6B9.8030607@procyongames.com>
	<47DA77A3.8060206@gmail.com>	<22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
	<47DACDF0.3060503@gmail.com> <47DAD30E.3060105@zalewski.pl>
	<47DE9A9B.5060401@procyongames.com> <47DEAA02.40101@zalewski.pl>
Message-ID: <47DEB6E3.8060207@gmail.com>

Miko?aj Zalewski wrote:
> 
>> Thanks for sending in your patch Miko?aj, I tested MozyHome with it, 
>> but it didn't help anything, the service still wouldn't start. I don't 
>> have the experience to work on that patch by myself, but if someone 
>> else starts on it and would like assistance making tests or something 
>> I'm happy to try.
> 
>  I can look into that (I see it's bug #12030) however it looks like it's 
> not a problem with starting the service but may be a problem with the 
> service itself. Have you tried to run this service with e.g. notepad 
> running in the background - the services are marked as system processes 
> and if there is no non-system process left, all the system processes 
> will terminate themselves.
> 
> Miko?aj Zalewski

I already had a quick look and it looks like it fails while it tries to 
talk to mozyfilter. This is a system driver that's not (properly?) 
installed during installation for an yet unknown reason. Or is just that 
system drivers like this are not supported (yet)?

Cheers,

Paul.


From raccoonone at procyongames.com  Mon Mar 17 13:26:10 2008
From: raccoonone at procyongames.com (Christopher)
Date: Mon, 17 Mar 2008 11:26:10 -0700
Subject: Running services in WINE?
In-Reply-To: <47DEAA02.40101@zalewski.pl>
References: <47D82648.30208@procyongames.com>		<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>		<47D8C6B9.8030607@procyongames.com>
	<47DA77A3.8060206@gmail.com>	<22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
	<47DACDF0.3060503@gmail.com> <47DAD30E.3060105@zalewski.pl>
	<47DE9A9B.5060401@procyongames.com> <47DEAA02.40101@zalewski.pl>
Message-ID: <47DEB7C2.1050805@procyongames.com>

Miko?aj Zalewski wrote:
>
>> Thanks for sending in your patch Miko?aj, I tested MozyHome with it, 
>> but it didn't help anything, the service still wouldn't start. I 
>> don't have the experience to work on that patch by myself, but if 
>> someone else starts on it and would like assistance making tests or 
>> something I'm happy to try.
>
>  I can look into that (I see it's bug #12030) however it looks like 
> it's not a problem with starting the service but may be a problem with 
> the service itself. Have you tried to run this service with e.g. 
> notepad running in the background - the services are marked as system 
> processes and if there is no non-system process left, all the system 
> processes will terminate themselves.
>
> Miko?aj Zalewski
>
>
I tried it with notepad running in the background, and the same thing 
happens: mozybackup.exe shows up in the process list for ~3seconds then 
disappears and the console displays the fixme's that I posted in bug #12030.

If you have time to look into it that would be great! My knowledge of 
how services work is limited at best (still an undergrad, and I haven't 
taken an OS class yet).
Christopher


From truiken at gmail.com  Mon Mar 17 15:08:58 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 17 Mar 2008 15:08:58 -0500
Subject: msi: Skip the endlines test if the table fails on import
In-Reply-To: <47DEB1A3.3090406@gmail.com>
References: <22821af30803171016i3ed4ffb6hdbfdaad76035057b@mail.gmail.com>
	<47DEB1A3.3090406@gmail.com>
Message-ID: <22821af30803171308l4f2e95at77ccc9fb842dc7e3@mail.gmail.com>

On Mon, Mar 17, 2008 at 1:00 PM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>
> James Hawkins wrote:
>  > Hi,
>  >
>  > Fixes 33 test failures on win9x.
>  >
>  > Changelog:
>  > * Skip the endlines test if the table fails on import.
>  >
>  >  dlls/msi/tests/db.c |    7 ++++++-
>  >  1 files changed, 6 insertions(+), 1 deletions(-)
>  >
>  >
>  >
>  > ------------------------------------------------------------------------
>  >
>  >
>  But shouldn't the ok-call stay and be moved after the if? Or is there not much
>  extra information when add_table_to_db fails?
>

The ok is kinda pointless after the if statement.  The real tests are
the rest of the oks.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Mon Mar 17 15:45:29 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 17 Mar 2008 13:45:29 -0700
Subject: Google Summer of Code 2008 is on!
Message-ID: <b130c85e0803171345g2d50b559g6697b1a4cf7ea5b8@mail.gmail.com>

Hi all,

Wine has been officially accepted as mentoring organisation for
2008!!!!!!!! Just thought I'd share.

I hope this will be the best summer of code for wine yet!

Cheers,
Maarten.


From stefan at codeweavers.com  Mon Mar 17 16:29:30 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 22:29:30 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803171647.39614.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<d658b69e0803170822k1bba0bd8ve521f3dadb950456@mail.gmail.com>
	<200803171647.39614.stefan@codeweavers.com>
Message-ID: <200803172229.30779.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 16:47:39 schrieb Stefan D?singer:
> Am Montag, 17. M?rz 2008 16:22:30 schrieb H. Verbeet:
> > That's more an issue with the state table design than a reason to
> > create a new shader backend. A more hierarchical state table would
> > probably have helped there, but the general issue you're trying to
> > solve is that you want the state table to change depending on the
> > available extensions and wined3d configuration. I don't think that's
> > limited to shaders or fragment processing. If a GL3 spec ever actually
> > gets released, and actual drivers start implementing it, we'll run
> > into it there as well.
> I think putting the state table into a shader backend is quite reasonable
> considering the existing opengl spec and extension, even if we do not call
> atifs/nvrc "shaders". With my patches we set the shader backend using
> complex conditions based on available extensions.
> ...
Thinking about a bit more I think I have a better phrasing of this: The API of 
GL_ATI_fragment_shader is very close to the shader API of 
GL_ARB_fragment_program / GLSL, and as far as the global WineD3D design is 
concerend it is equal to the ARBfp one. Contrary to that, the nvrc API is 
comparable to the ARB_texture_env_combine API. We do not care how it works in 
the driver or the hardware, that's all abstracted away from us. API-wise it 
is a shader API, I think that is reason enough to give the atifs code its own 
shader backend.


From mailjohnmorris at gmail.com  Mon Mar 17 16:41:39 2008
From: mailjohnmorris at gmail.com (John Morris)
Date: Mon, 17 Mar 2008 16:41:39 -0500
Subject: UrlCanonicalize patch I submitted
Message-ID: <1125723f0803171441i585ba334u61ef5145ad8f9d75@mail.gmail.com>

Hi,

Last week I submitted a patch to correct the behavior of the
UrlCanonicalize{W,A} functions.
I found that "Stylus Studio 2007" had problems opening files that had
a space in the path name.

Tracing through the code, I found that the UrlCanonicalizeW function
was not removing the "%20" escaped space when the URL_UNESCAPE bit was
set in the flags parameter.  I wrote a small program that set the
flags like stylus studio was doing and ran it on both wine and
windows, and found that wine definitely didn't handle it the same as
windows.

I made a small change to dlls/shlwapi/url.c, as well as added a test
case to dlls/shlwapi/tests/url.c. With that change I got the same
result with my program on both windows and wine.

This is only my second patch to wine, so please feel free to give me
any feedback, and let me know if there is anything that would be
deemed incorrect about the way I did this.

Many Thanks,

John Morris


From dank at kegel.com  Mon Mar 17 18:03:39 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 16:03:39 -0700
Subject: improve winetricks dotnet 1.1
In-Reply-To: <a71bd89a0803111315m6812e01fqb30a2663b30f05d3@mail.gmail.com>
References: <a71bd89a0803111315m6812e01fqb30a2663b30f05d3@mail.gmail.com>
Message-ID: <a71bd89a0803171603s61c89741q2b5a98d8b0e9b4c0@mail.gmail.com>

On Tue, Mar 11, 2008 at 1:15 PM, Dan Kegel <dank at kegel.com> wrote:
> Louis wrote:
>  > Hi, i wonder if it would be possible to improve
>  > winetricks dotnet 1.1, so that it's actually able to run
>  >.net-1.1 applications. Currently it only installs the framework,
>  > but due to bugs the apps don't run.   Atm i use pretty worthless
>  > script below to get them running..

Louis, your script did

winetricks allfonts
wineprefixcreate  #to register the fonts

which I didn't quite understand.  Why do fonts installed by
perfectly valid corefonts installers from Microsoft need
to be registered?  Do we have a bug somewhere?

I ask because http://winehq.org/pipermail/wine-users/2008-March/030284.html
mentions that it helped him.  I'm still not quite convinced,
hoping you can enlighten me.
- Dan


From dank at kegel.com  Mon Mar 17 18:15:52 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 16:15:52 -0700
Subject: Please create 1.2.0 milestone in Bugzilla
Message-ID: <a71bd89a0803171615u6de6d3a6oca591b54a611bb21@mail.gmail.com>

The 1.1.x releases will be development releases,
so a 1.1.0 milestone doesn't make much sense.
Please create a 1.2.0 milestone in Bugzilla.
Thanks!
- Dan


From rob at codeweavers.com  Mon Mar 17 18:32:42 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 17 Mar 2008 23:32:42 +0000
Subject: services.exe/advapi32[3/7]: start a local RPC server
In-Reply-To: <47DD9147.9000802@zalewski.pl>
References: <47DD9147.9000802@zalewski.pl>
Message-ID: <47DEFF9A.4040800@codeweavers.com>

Miko?aj Zalewski wrote:
> @@ -231,6 +247,101 @@ static inline LPWSTR SERV_dupmulti(LPCSTR str)
>  }
>  
>  /******************************************************************************
> + * RPC connection with servies.exe
> + */
> +
> +static BOOL check_services_exe()
> +{
>   

Put "void" in the brackets here and in many other places.

> +static SvcCtlRpcHandle connect_to_server(LPCWSTR server)
> +{
> +    WCHAR transport[] = SVCCTL_TRANSPORT;
> +    WCHAR endpoint[] = SVCCTL_ENDPOINT;
> +    LPWSTR server_copy = NULL;
> +    RPC_WSTR binding_str;
> +    RPC_STATUS status;
> +    SvcCtlRpcHandle rpc_handle;
> +    
> +    /* unlike Windows we start services.exe on demand. We start it always as
> +     * checking if this is our address can be tricky */
> +    if (!check_services_exe())
> +        return NULL;
> +
> +    if (server) /* parameters of RpcStringBindingComposeW are not const */
> +    {
> +        server_copy = HeapAlloc(GetProcessHeap(), 0, sizeof(WCHAR)*(strlenW(server) + 1));
> +        strcpyW(server_copy, server);
> +    }
>   

RpcStringBindingComposeW doesn't change server if you pass it in, so 
there is no need to make a copy.

> +    status = RpcStringBindingComposeW(NULL, transport, server_copy, endpoint, NULL, &binding_str);
> +    HeapFree(GetProcessHeap(), 0, server_copy);
> +    if (status != RPC_S_OK)
> +    {
> +        ERR("RpcStringBindingComposeW failed (%d)\n", (DWORD)status);
> +        return NULL;
> +    }
>   

> diff --git a/include/wine/svcctl.idl b/include/wine/svcctl.idl
> new file mode 100644
> index 0000000..fefd12f
> --- /dev/null
> +++ b/include/wine/svcctl.idl
> @@ -0,0 +1,68 @@
> +/*
> + * svcctl interface definitions - exported by services.exe to access the
> + * services database
> + *
> + * Copyright 2007 Google (Mikolaj Zalewski)
> + *
> + * This library is free software; you can redistribute it and/or
> + * modify it under the terms of the GNU Lesser General Public
> + * License as published by the Free Software Foundation; either
> + * version 2.1 of the License, or (at your option) any later version.
> + *
> + * This library is distributed in the hope that it will be useful,
> + * but WITHOUT ANY WARRANTY; without even the implied warranty of
> + * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
> + * Lesser General Public License for more details.
> + *
> + * You should have received a copy of the GNU Lesser General Public
> + * License along with this library; if not, write to the Free Software
> + * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
> + */
> +
> +import "wtypes.idl";
> +
> +/* 
> + * some defined for the C code
> + */
> +cpp_quote("#define SVCCTL_TRANSPORT {'n','c','a','c','n','_','n','p',0}");
> +cpp_quote("#define SVCCTL_ENDPOINT {'\\\\','p','i','p','e','\\\\','s','v','c','c','t','l',0}");
> +
> +/* Not the Windows event name - if needed the true one can be found in Inside Windows */
> +cpp_quote("#define SVCCTL_STARTED_EVENT (const WCHAR[]){'_','_','w','i','n','e','_','S','v','c','c','t','l','S','t','a','r','t','e','d',0}");
> +
> +
> +/* Based on the Samba IDL. Some functions are compatible with Windows but some
> + * aren't and many are missing (thus function numbers are different) so we
> + * don't use the Windows uuid which is 367abb81-9844-35f1-ad32-98f038001003 .
> + */
> +[ uuid(78e2d9e8-d2a8-40d8-9bbe-7328cc5a9c32),
> +  version(2.0),
> +  pointer_default(unique),
> +  endpoint("ncacn_np:[\\pipe\\svcctl]"),
> +  helpstring("Service Control")
> +] interface svcctl
> +{
> +    typedef handle_t SvcCtlRpcHandle;
> +
> +    typedef struct _POLICY_HANDLE
> +    {
> +        DWORD dwHandleType;
> +	GUID uuid;
> +    } POLICY_HANDLE;
>   

There's no need to use Samba's concept of "POLICY_HANDLE". We fully 
support the DCE/RPC context_handle type which is what this actually is.

You can find out more about how to use context handles here:
http://msdn2.microsoft.com/en-us/library/aa373605(VS.85).aspx

> +
> +    /* Compatible with Windows function 0x00 */
> +    DWORD svcctl_CloseServiceHandle(
> +        [in] SvcCtlRpcHandle rpc_handle,
> +        [in,out] POLICY_HANDLE *handle
> +    );
>   

There's no need for the rpc_handle here once you make the second 
parameter into a context handle.

> +
> +    /* Compatible with Windows function 0x0f */
> +    DWORD svcctl_OpenSCManagerW(
> +        SvcCtlRpcHandle rpc_handle,
> +        [in,unique] LPCWSTR MachineName,
> +        [in,unique] LPCWSTR DatabaseName,
> +        [in] DWORD dwAccessMask,
> +        [out] POLICY_HANDLE *handle
> +    );
> +
> +}
>   

-- 
Rob Shearman



From wine at eternaldusk.com  Mon Mar 17 18:34:57 2008
From: wine at eternaldusk.com (Evil Jay)
Date: Mon, 17 Mar 2008 18:34:57 -0500
Subject: Make XP emulation the default?
In-Reply-To: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>
References: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>
Message-ID: <47DF0021.9050207@eternaldusk.com>

Dan Kegel wrote:
> What would break if we made XP the default windows version in Wine?
>
> I've run into several apps that fail to install unless I change that
> setting lately..

The only thing I can think of off-hand is IE6.  It will claim that an
equal/later version is already installed (even after
registry/file-system changes) if the Windows version is > Win2k.


-J


From dank at kegel.com  Mon Mar 17 18:40:54 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 16:40:54 -0700
Subject: Make XP emulation the default?
In-Reply-To: <47DF0021.9050207@eternaldusk.com>
References: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>
	<47DF0021.9050207@eternaldusk.com>
Message-ID: <a71bd89a0803171640h2eb57c38j8e6bd7895306da79@mail.gmail.com>

On Mon, Mar 17, 2008 at 4:34 PM, Evil Jay <wine at eternaldusk.com> wrote:
>  > What would break if we made XP the default windows version in Wine?
>  >
>  > I've run into several apps that fail to install unless I change that
>  > setting lately..
>
>  The only thing I can think of off-hand is IE6.  It will claim that an
>  equal/later version is already installed (even after
>  registry/file-system changes) if the Windows version is > Win2k.

Who's going to be affected by that?

ies4linux's author can work around that just fine, he won't mind.
- Dan


From rob at codeweavers.com  Mon Mar 17 18:55:46 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 17 Mar 2008 23:55:46 +0000
Subject: services.exe/advapi32[5/7]: Move QueryServiceConfig to
	services.exe
In-Reply-To: <47DD922D.1080505@zalewski.pl>
References: <47DD922D.1080505@zalewski.pl>
Message-ID: <47DF0502.4060700@codeweavers.com>

In the next patch you've found a problem:

Miko?aj Zalewski wrote:
> +#if 0 /* for some reason (rpcrt4 bug?) QueryServiceConfig for a non-NULL lpLoadOrder crashes Wine */
>   

The issue is to do with this code:

>                       LPQUERY_SERVICE_CONFIGW lpServiceConfig,
>                       DWORD cbBufSize, LPDWORD pcbBytesNeeded)
>  {
> -    WCHAR str_buffer[ MAX_PATH ];
> -    LONG r;
> -    DWORD type, val, sz, total, n;
> -    LPBYTE p;
> -    HKEY hKey;
> +    QUERY_SERVICE_CONFIGW config;
>      struct sc_service *hsvc;
> +    DWORD total;
> +    DWORD err;
> +    BYTE *bufpos;
>  
>      TRACE("%p %p %d %p\n", hService, lpServiceConfig,
>             cbBufSize, pcbBytesNeeded);
> @@ -1886,58 +1908,21 @@ QueryServiceConfigW( SC_HANDLE hService,
>          SetLastError( ERROR_INVALID_HANDLE );
>          return FALSE;
>      }
> -    hKey = hsvc->hkey;
> -
> -    /* TODO: Check which members are mandatory and what the registry types
> -     * should be. This should of course also be tested when a service is
> -     * created.
> -     */
> -
> -    /* calculate the size required first */
> -    total = sizeof (QUERY_SERVICE_CONFIGW);
>  
> -    sz = sizeof(str_buffer);
> -    r = RegQueryValueExW( hKey, szImagePath, 0, &type, (LPBYTE) str_buffer, &sz );
> -    if( ( r == ERROR_SUCCESS ) && ( type == REG_SZ || type == REG_EXPAND_SZ ) )
> +    if ((err = svcctl_QueryServiceConfigW(hsvc->hdr.rpc_handle, &hsvc->hdr.server_handle, &config)) != 0)
>   

The problem is that QUERY_SERVICE_CONFIGW contains pointers and the 
DCE/RPC programming model ensures that non-NULL pointers that are being 
unmarshalled into are used (presumably to reduce memory allocations). So 
the issue here is that you're not initialising config before passing it 
into svcctl_QueryServiceConfigW and it is blowing up just by chance on 
the pointer occupying the lpLoadOrderGroup; it could just as well have 
been lpBinaryName, lpServiceStartName or lpDisplayName.

> +
> +    /* Windows function 0x11 must be using a different prototype - not compatible */
> +    /* Robert Shearman thinks there should be a byte_count attribute but (as of Sep 2007)
> +     * this isn't supported by widl nor by rpcrt4 */
> +    DWORD svcctl_QueryServiceConfigW(
> +        SvcCtlRpcHandle rpc_handle,
> +        [in] POLICY_HANDLE *handle,
> +        [out] QUERY_SERVICE_CONFIGW *config);
> +
>  }
>   

The byte_count attribute is officially deprecated by Microsoft and it's 
not part of the DCE/RPC standard, plus you've already done the work and 
it's wire compatible (I think) without the attribute, so you can remove 
the comment about it.

-- 
Rob Shearman



From rob at codeweavers.com  Mon Mar 17 18:55:53 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 17 Mar 2008 23:55:53 +0000
Subject: services.exe/advapi32[7/7]: move GetServiceDisplayName to
	services.exe and implement GetServiceKeyName
In-Reply-To: <47DD934B.8050405@zalewski.pl>
References: <47DD934B.8050405@zalewski.pl>
Message-ID: <47DF0509.7010109@codeweavers.com>

Miko?aj Zalewski wrote:
> +    /* Windows function 0x14 must be using a different prototype - not compatible */
> +    DWORD svcctl_GetServiceDisplayNameW(
> +        SvcCtlRpcHandle rpc_handle,
> +        [in] POLICY_HANDLE *hSCManager,
> +        [in] LPCWSTR lpServiceName,
> +        [in,out,size_is(cchBufSize)] WCHAR lpBuffer[],
> +        [in] DWORD cchBufSize,
> +        [out] DWORD *cchLength);
> +
> +    /* Windows function 0x15 must be using a different prototype - not compatible */
> +    DWORD svcctl_GetServiceKeyNameW(
> +        SvcCtlRpcHandle rpc_handle,
> +        [in] POLICY_HANDLE *hSCManager,
> +        [in] LPCWSTR lpServiceDisplayName,
> +        [in,out,size_is(cchBufSize)] WCHAR lpBuffer[],
> +        [in] DWORD cchBufSize,
> +        [out] DWORD *cchLength);
>  }
>   

The lpBuffer parameter should be out-only instead of in and out. I 
believe this will make the prototype compatible.

-- 
Rob Shearman



From wine.dev at web.de  Mon Mar 17 18:59:34 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Tue, 18 Mar 2008 00:59:34 +0100
Subject: appdb request: "Browse Regressions"
In-Reply-To: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>
References: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>
Message-ID: <1205798374.17905.10.camel@p4>

On So, 2008-03-16 at 07:30 -0700, Dan Kegel wrote:
> want to use the appdb itself
> to see which apps have recently fallen in rating.

Nice Idea.

> Following past appdb practice, one would implement
> that by adding a new "Browse Regressions" menu
> item on the left,

I created recently the Patch for Bugzilla:
"Task Lists" => "Regressions"

http://bugs.winehq.org/buglist.cgi?bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&product=Wine&keywords=regression&keywords_type=anywords



-- 
 
By by ... Detlef




From dank at kegel.com  Mon Mar 17 19:21:33 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 17:21:33 -0700
Subject: appdb request: "Browse Regressions"
In-Reply-To: <20080316155323.139350@gmx.net>
References: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>
	<20080316155323.139350@gmx.net>
Message-ID: <a71bd89a0803171721o78f05734g240b09094f99312e@mail.gmail.com>

On Sun, Mar 16, 2008 at 8:53 AM, Roderick Colenbrander
<thunderbird2k at gmx.net> wrote:
>  Personally I don't trust appdb regressions much.

We could work around some of the problems by only listing
apps where the same reviewer gave it a lower rating in a
newer version of wine.  That compensates for the lack
of a uniform rating system somewhat.


From stefan at codeweavers.com  Mon Mar 17 19:35:33 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 01:35:33 +0100
Subject: 1/6 WineD3D: CheckDeviceFormat rewrite
In-Reply-To: <20080317192258.74730@gmx.net>
References: <20080317192258.74730@gmx.net>
Message-ID: <200803180135.33788.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 20:22:58 schrieb Roderick Colenbrander:
> Hi,
>
> This patch puts legacy bump mapping in its own function.
Battlefield 1942 is broken for me after these patches, apparently because 
D3DFMT_R8G8B8 is enabled again. As far as I can see this is due to the early 
if(!Usage) return in the texture resource check, the code never reaches the if 
condition that disables R8G8B8. Is this early return needed at all? It seems 
confusing to me and is only going to cause breakage similarly to the old 
code.

The old code enabled R8G8B8 for d3d7, but I think you can remove that and keep 
the format disabled altogether. As far as I can see Windows does not support 
it in ddraw either, and enabling it for d3d7 but not d3d8 wouldn't make 
sense.

By the way, I noticed(a bit late) that the patches from yesterday broke depth 
stencil selection for me. These patches fix this problem again, but I'm 
afraid it will cause some issues for regression testing.


From stefan at codeweavers.com  Mon Mar 17 19:35:33 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 01:35:33 +0100
Subject: 1/6 WineD3D: CheckDeviceFormat rewrite
In-Reply-To: <20080317192258.74730@gmx.net>
References: <20080317192258.74730@gmx.net>
Message-ID: <200803180135.33788.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 20:22:58 schrieb Roderick Colenbrander:
> Hi,
>
> This patch puts legacy bump mapping in its own function.
Battlefield 1942 is broken for me after these patches, apparently because 
D3DFMT_R8G8B8 is enabled again. As far as I can see this is due to the early 
if(!Usage) return in the texture resource check, the code never reaches the if 
condition that disables R8G8B8. Is this early return needed at all? It seems 
confusing to me and is only going to cause breakage similarly to the old 
code.

The old code enabled R8G8B8 for d3d7, but I think you can remove that and keep 
the format disabled altogether. As far as I can see Windows does not support 
it in ddraw either, and enabling it for d3d7 but not d3d8 wouldn't make 
sense.

By the way, I noticed(a bit late) that the patches from yesterday broke depth 
stencil selection for me. These patches fix this problem again, but I'm 
afraid it will cause some issues for regression testing.


From chris.kcat at gmail.com  Mon Mar 17 19:46:33 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Mon, 17 Mar 2008 16:46:33 -0800
Subject: ntoskrnl.exe: Implement MmIsAddressValid (bug 11082)
In-Reply-To: <1205795360.17905.4.camel@p4>
References: <1205795360.17905.4.camel@p4>
Message-ID: <200803171746.33498.chris.kcat@gmail.com>

On Monday 17 March 2008 04:09:20 pm Detlef Riekenberg wrote:
> + ? ? ? ?(info.Protect & (PAGE_READWRITE || PAGE_EXECUTE_READWRITE)) &&

Did you mean | instead of || there?


From jim at pagesmiths.com  Mon Mar 17 19:51:14 2008
From: jim at pagesmiths.com (Jim White)
Date: Mon, 17 Mar 2008 17:51:14 -0700
Subject: appdb request: "Browse Regressions"
In-Reply-To: <a71bd89a0803171721o78f05734g240b09094f99312e@mail.gmail.com>
References: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>	<20080316155323.139350@gmx.net>
	<a71bd89a0803171721o78f05734g240b09094f99312e@mail.gmail.com>
Message-ID: <47DF1202.1080607@pagesmiths.com>

Dan Kegel wrote:
> On Sun, Mar 16, 2008 at 8:53 AM, Roderick Colenbrander
> <thunderbird2k at gmx.net> wrote:
> 
>> Personally I don't trust appdb regressions much.
> 
> We could work around some of the problems by only listing
> apps where the same reviewer gave it a lower rating in a
> newer version of wine.  That compensates for the lack
> of a uniform rating system somewhat.

Reminds me of a bit I just read on a guy who's doing really well in the 
Netflix competition.  One of the good heuristics he uses is to track the 
levels that a particular person uses to adjust for the "anchoring effect".

http://www.wired.com/techbiz/media/magazine/16-03/mf_netflix?currentPage=all

> One such phenomenon is the anchoring effect, a problem endemic to any
> numerical rating scheme. If a customer watches three movies in a row
> that merit four stars ? say, the Star Wars trilogy ? and then sees
> one that's a bit better ? say, Blade Runner ? they'll likely give the
> last movie five stars. But if they started the week with one-star
> stinkers like the Star Wars prequels, Blade Runner might get only a 4
> or even a 3. Anchoring suggests that rating systems need to take
> account of inertia ? a user who has recently given a lot of
> above-average ratings is likely to continue to do so. Potter finds
> precisely this phenomenon in the Netflix data; and by being aware of
> it, he's able to account for its biasing effects and thus more
> accurately pin down users' true tastes.

Jim


From dmitry at codeweavers.com  Mon Mar 17 20:09:37 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 18 Mar 2008 09:09:37 +0800
Subject: ntoskrnl.exe: Implement MmIsAddressValid (bug 11082)
References: <1205795360.17905.4.camel@p4>
Message-ID: <016e01c88894$be6b0080$a600fea9@DMITRY>

"Detlef Riekenberg" <wine.dev at web.de> wrote:

> +    len = VirtualQuery(VirtualAddress, &info, sizeof(MEMORY_BASIC_INFORMATION));
> +
> +    if ((len == sizeof(MEMORY_BASIC_INFORMATION)) && 
> +        (info.Protect & (PAGE_READWRITE || PAGE_EXECUTE_READWRITE)) &&
> +        ((info.Protect & PAGE_NOACCESS) == 0) &&
> +        (info.Type & MEM_COMMIT))
> +    {
> +        return TRUE;
> +    }

Besides the already pointed out '||' vs. '|' mismatch your code doesn't
handle PAGE_READONLY and others implying read-only access. Probably checking
for PAGE_NOACCESS and MEM_COMMIT should be enough.

-- 
Dmitry.


From wine at eternaldusk.com  Mon Mar 17 20:18:36 2008
From: wine at eternaldusk.com (Evil Jay)
Date: Mon, 17 Mar 2008 20:18:36 -0500
Subject: Make XP emulation the default?
In-Reply-To: <a71bd89a0803171640h2eb57c38j8e6bd7895306da79@mail.gmail.com>
References: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>	
	<47DF0021.9050207@eternaldusk.com>
	<a71bd89a0803171640h2eb57c38j8e6bd7895306da79@mail.gmail.com>
Message-ID: <47DF186C.9080707@eternaldusk.com>

Dan Kegel wrote:
> Who's going to be affected by that?
>
> ies4linux's author can work around that just fine, he won't mind.
> - Dan
>   
You do have an incredibly good point there...

-J


From dank at kegel.com  Mon Mar 17 20:24:52 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 18:24:52 -0700
Subject: Fresh valgrind errors in richedit
Message-ID: <a71bd89a0803171824s5d998e2bgcf56300e72542ba4@mail.gmail.com>

Eric, could you have a look at

http://kegel.com/wine/valgrind/logs-2008-03-17/vg-riched20_editor-diff.txt

There are several new errors of the sort:

+ Conditional jump or move depends on uninitialised value(s)
+    at  ME_SetParaFormat (para.c:400)
+    by  ME_SetSelectionParaFormat (para.c:436)
+    by  ME_RTFReadHook (editor.c:662)
+    by  RTFGetToken (reader.c:417)
+    by  RTFRead (reader.c:333)
+    by  ME_StreamIn (editor.c:1095)
+    by  RichEditWndProc_common (editor.c:2432)
+    by  RichEditWndProcA (editor.c:3237)
+    by  (within /home/dank/wine-git/dlls/user32/user32.dll.so)
+    by  call_window_proc (winproc.c:457)
+    by  WINPROC_call_window (winproc.c:2207)
+    by  call_window_proc (message.c:1615)
+    by  send_message (message.c:2430)
+    by  SendMessageA (message.c:2575)
+    by  test_EM_SETTEXTMODE (editor.c:471)
+    by  func_editor (editor.c:2705)
+    by  run_test (test.h:406)
+    by  main (test.h:455)


From stefan at codeweavers.com  Mon Mar 17 20:37:25 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 02:37:25 +0100
Subject: [19/22] WineD3D: Enable V8U8 for legacy bump mapping with ati
	extensions
In-Reply-To: <200803171946.45445.stefan@codeweavers.com>
References: <200803162209.22453.stefan@codeweavers.com>
	<200803171946.45445.stefan@codeweavers.com>
Message-ID: <200803180237.25318.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 19:46:45 schrieb Stefan D?singer:
> Here is an updated patch that takes Roderick's recent changes into account
Yet another patch, it takes Rodericks patches from today into account. Feel 
free to apply whatever patch suits better. If none of them are applied I will 
resend all the patches when Roderick is done with his CheckDeviceFormat 
rewite

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0024-WineD3D-Enable-V8U8-for-legacy-bump-mapping-with-at.patch
Type: text/x-diff
Size: 1040 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080318/6341d694/attachment.patch 

From m.b.lankhorst at gmail.com  Tue Mar 18 00:08:32 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 17 Mar 2008 22:08:32 -0700
Subject: Google Summer of Code 2008 is on!
In-Reply-To: <b130c85e0803171345g2d50b559g6697b1a4cf7ea5b8@mail.gmail.com>
References: <b130c85e0803171345g2d50b559g6697b1a4cf7ea5b8@mail.gmail.com>
Message-ID: <b130c85e0803172208xde9970do4c346dd6b7a5599f@mail.gmail.com>

Hello all,

2008/3/17, Maarten Lankhorst <m.b.lankhorst at gmail.com>:
>  Wine has been officially accepted as mentoring organisation for
>  2008!!!!!!!! Just thought I'd share.
>
>  I hope this will be the best summer of code for wine yet!
Can everyone who wants to volunteer as mentor sign up at
http://code.google.com/soc/mentor_step1.html please?

Thanks!

Maarten


From andrewriedi at gmail.com  Tue Mar 18 00:11:06 2008
From: andrewriedi at gmail.com (Andrew Riedi)
Date: Mon, 17 Mar 2008 22:11:06 -0700
Subject: user32: Add test_CreateIconFromResourceEx().
In-Reply-To: <01bc01c887ec$78e0f720$a600fea9@DMITRY>
References: <689de9370803161544j310ad57p312e928e460aa3d0@mail.gmail.com>
	<01bc01c887ec$78e0f720$a600fea9@DMITRY>
Message-ID: <689de9370803172211w1cc996c2k517b1c0b8a8090d7@mail.gmail.com>

On Sun, Mar 16, 2008 at 10:05 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> "Andrew Riedi" <andrewriedi at gmail.com> wrote:
>
>  > changelog: user32: Add test_CreateIconFromResourceEx().
>
>  What this patch is supposed to test? Just that CreateIconFromResourceEx
>  returns a valid icon handle? What about the resulting icon contents?
>  What about cases when CreateIconFromResourceEx should fail?
>
>  --
>  Dmitry.
>
Mostly, this patch is just to serve as a check to make sure I don't
horribly screw up CreateIconFromResourceEx().  I need to abstract some
of the functionality out, and make use of it elsewhere.  Right now our
CreateIconFromResourceEx() works flawlessly, as far as I know.
Checking for contents afterwards would be a good idea though - I will
send an updated patch to do exactly that before I touch our
CreateIconFromResourceEx().

As always, thanks for looking over my code, Dmitry.  :)

-- 
Andrew Riedi


From dmitry at codeweavers.com  Tue Mar 18 00:35:31 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 18 Mar 2008 13:35:31 +0800
Subject: user32: Add test_CreateIconFromResourceEx().
References: <689de9370803161544j310ad57p312e928e460aa3d0@mail.gmail.com><01bc01c887ec$78e0f720$a600fea9@DMITRY>
	<689de9370803172211w1cc996c2k517b1c0b8a8090d7@mail.gmail.com>
Message-ID: <006901c888b9$e314af10$a600fea9@DMITRY>

"Andrew Riedi" <andrewriedi at gmail.com> wrote:

> Mostly, this patch is just to serve as a check to make sure I don't
> horribly screw up CreateIconFromResourceEx().  I need to abstract some
> of the functionality out, and make use of it elsewhere.  Right now our
> CreateIconFromResourceEx() works flawlessly, as far as I know.
> Checking for contents afterwards would be a good idea though - I will
> send an updated patch to do exactly that before I touch our
> CreateIconFromResourceEx().

I'd suggest to add the tests not only for various parameters passed
to CreateIconFromResourceEx (not just a random one), but also add to
the resources icons/images with different color depth and test how they
are loaded (for instance the bug 10854 mentions an app which has 24-bpp
bitmap or icon in its resources, and that leads to the problem later
on when the app usess the returned handle to draw an image).

-- 
Dmitry.


From paul.vriens.wine at gmail.com  Tue Mar 18 02:16:24 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 18 Mar 2008 08:16:24 +0100
Subject: wined3d: Check with "&& FALSE"
In-Reply-To: <200803171908.28947.stefan@codeweavers.com>
References: <47DE6250.6000506@gmail.com>
	<d658b69e0803170539h2a386946k35b1d82c9437a7f5@mail.gmail.com>
	<47DE689E.4030606@gmail.com>
	<200803171908.28947.stefan@codeweavers.com>
Message-ID: <47DF6C48.4050207@gmail.com>

Stefan D?singer wrote:
> Am Montag, 17. M?rz 2008 13:48:30 schrieb Paul Vriens:
>> H. Verbeet wrote:
>>> On 17/03/2008, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>>>>  Is this line correct? Doesn't this alway return FALSE?
>>> Looks like leftover debug code to me.
> Yes, this is leftover debugging code. Feel free to send a patch to remove it
> 
> 
A patch to remove the debugging code is no problem. It's the surrounding 
comments that worry me (what's should stay, what should go, what should change).

I'd rather have you (or any other volunteer) put this somewhere on your 
todo-list :-)

-- 
Cheers,

Paul.


From dank at kegel.com  Tue Mar 18 02:33:06 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 00:33:06 -0700
Subject: SoC page insurrection! Idea details needed, please read.
Message-ID: <a71bd89a0803180033r70a59ccatd14d11de179be174@mail.gmail.com>

Looking at our Summer of Code ideas page,
I realized it was getting dense and unruly,
so I and Maarten moved it off to the side
and did a simpler one; see
http://wiki.winehq.org/SummerOfCode

The DirectX stuff in particular could use some
more detail; could the knowledgeable people flesh it out?

Also each idea should probably have a sponsor
the students could turn to for ideas.  I've put a
few obvious ones in, but it'd be nice if each one
was claimed.

Thanks,
Dan


From thunderbird2k at gmx.net  Tue Mar 18 03:27:01 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 18 Mar 2008 09:27:01 +0100
Subject: 1/6 WineD3D: CheckDeviceFormat rewrite
In-Reply-To: <200803180135.33788.stefan@codeweavers.com>
References: <20080317192258.74730@gmx.net>
	<200803180135.33788.stefan@codeweavers.com>
Message-ID: <20080318082701.173790@gmx.net>

> > Hi,
> >
> > This patch puts legacy bump mapping in its own function.
> Battlefield 1942 is broken for me after these patches, apparently because 
> D3DFMT_R8G8B8 is enabled again. As far as I can see this is due to the
> early 
> if(!Usage) return in the texture resource check, the code never reaches
> the if 
> condition that disables R8G8B8. Is this early return needed at all? It
> seems 
> confusing to me and is only going to cause breakage similarly to the old 
> code.
> 
> The old code enabled R8G8B8 for d3d7, but I think you can remove that and
> keep 
> the format disabled altogether. As far as I can see Windows does not
> support 
> it in ddraw either, and enabling it for d3d7 but not d3d8 wouldn't make 
> sense.
> 
> By the way, I noticed(a bit late) that the patches from yesterday broke
> depth 
> stencil selection for me. These patches fix this problem again, but I'm 
> afraid it will cause some issues for regression testing.
> 

The patches from yesterday where the start. These new 6 patches will move most of the other code around. After it the change is done for about 90%. Today I will send a bunch of other patches which will move some smaller parts like one which takes care of this r8g8b8 version check (I moved it to the top of the function but I could also keep it where it is and remove !Usage checks). I also need to enable set dynamic / softwareprocessing and a few others.

I think it is best to continue now. I'll prepare some of the other patches now.

Roderick
-- 
Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen! 
Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer


From thunderbird2k at gmx.net  Tue Mar 18 03:44:28 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 18 Mar 2008 09:44:28 +0100
Subject: 1/6 WineD3D: CheckDeviceFormat rewrite
In-Reply-To: <20080318082701.173790@gmx.net>
References: <20080317192258.74730@gmx.net>
	<200803180135.33788.stefan@codeweavers.com>
	<20080318082701.173790@gmx.net>
Message-ID: <20080318084428.191020@gmx.net>

> > > Hi,
> > >
> > > This patch puts legacy bump mapping in its own function.
> > Battlefield 1942 is broken for me after these patches, apparently
> because 
> > D3DFMT_R8G8B8 is enabled again. As far as I can see this is due to the
> > early 
> > if(!Usage) return in the texture resource check, the code never reaches
> > the if 
> > condition that disables R8G8B8. Is this early return needed at all? It
> > seems 
> > confusing to me and is only going to cause breakage similarly to the old
> > code.
> > 
> > The old code enabled R8G8B8 for d3d7, but I think you can remove that
> and
> > keep 
> > the format disabled altogether. As far as I can see Windows does not
> > support 
> > it in ddraw either, and enabling it for d3d7 but not d3d8 wouldn't make 
> > sense.
> > 
> > By the way, I noticed(a bit late) that the patches from yesterday broke
> > depth 
> > stencil selection for me. These patches fix this problem again, but I'm 
> > afraid it will cause some issues for regression testing.
> > 
> 
> The patches from yesterday where the start. These new 6 patches will move
> most of the other code around. After it the change is done for about 90%.
> Today I will send a bunch of other patches which will move some smaller
> parts like one which takes care of this r8g8b8 version check (I moved it to the
> top of the function but I could also keep it where it is and remove !Usage
> checks). I also need to enable set dynamic / softwareprocessing and a few
> others.
> 
> I think it is best to continue now. I'll prepare some of the other patches
> now.
> 
> Roderick

Patch 7/6, 8/6, 9/6 should take away most issues. Yesterday I didn't have the time to prepare those but they should be fine.

Roderick
-- 
Psssst! Schon vom neuen GMX MultiMessenger geh?rt?
Der kann`s mit allen: http://www.gmx.net/de/go/multimessenger


From epssyis at gmail.com  Tue Mar 18 05:30:45 2008
From: epssyis at gmail.com (Edward Savage)
Date: Tue, 18 Mar 2008 21:30:45 +1100
Subject: Please create 1.2.0 milestone in Bugzilla
In-Reply-To: <a71bd89a0803171615u6de6d3a6oca591b54a611bb21@mail.gmail.com>
References: <a71bd89a0803171615u6de6d3a6oca591b54a611bb21@mail.gmail.com>
Message-ID: <d6c5d7290803180330x21e79457kebc236789952afdd@mail.gmail.com>

On Tue, Mar 18, 2008 at 10:15 AM, Dan Kegel <dank at kegel.com> wrote:
> The 1.1.x releases will be development releases,
>  so a 1.1.0 milestone doesn't make much sense.
>  Please create a 1.2.0 milestone in Bugzilla.
>  Thanks!
>  - Dan
>

Is there a reason we wont be continuing the current y.y.x (ie 0.9.x
and 1.0.x) style releases for development?

Most foss applications seem to have moved away from the even odd
release cycle and due to wines long lead times between releases having
it this way could get rather confusing for newer users not expecting
it.

Edward

Ps Sorry for the dupe dan, hit the wrong button.


From julliard at winehq.org  Tue Mar 18 05:56:16 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 18 Mar 2008 11:56:16 +0100
Subject: 6/6 WineD3D: CheckDeviceFormat rewrite
In-Reply-To: <20080317192720.74730@gmx.net> (Roderick Colenbrander's message
	of "Mon, 17 Mar 2008 20:27:20 +0100")
References: <20080317192720.74730@gmx.net>
Message-ID: <87y78g9u7j.fsf@wine.dyndns.org>

"Roderick Colenbrander" <thunderbird2k at gmx.net> writes:

> This patch removes some code which isn't needed anymore. All of this is now handled inside the resource type checks.

It doesn't work here:

../../../tools/runtest -q -P wine -M d3d9.dll -T ../../.. -p d3d9_test.exe.so visual.c && touch visual.ok
visual.c:2555: Test failed: quad 1 has color 00000000, expected 0x00FFFF00
visual.c:2559: Test failed: quad 3 has color 00000000, expected 0x0000FF00
visual.c:2642: Test failed: quad 1 has color 00000000, expected 0x00FF0000
visual.c:2649: Test failed: quad 4 has color 00000000, expected 0x0033cc00
wine: Unhandled page fault on write access to 0x05594884 at address 0x601cdcb6 (thread 0036), starting debugger...

-- 
Alexandre Julliard
julliard at winehq.org


From tony.wasserka at freenet.de  Tue Mar 18 06:05:49 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Tue, 18 Mar 2008 12:05:49 +0100
Subject: Proposal for debugging improvement
Message-ID: <E1JbZdd-0007MN-Dp@www14.emo.freenet-rz.de>

Hi,
When I was trying to find out how the native d3dx9_36.dll handles ID3DXRenderToSurface->BeginScene()
with WINEDEBUG="+d3d9,heap" I had the problem that I had to find out what functions are called
within the dll and what functions are called by the d3d9 functions (and thus are irrelevant for d3dx9).
For example this is what I got for BeginScene: (fixmes were disabled)

> trace:d3d9:IDirect3DSurface9Impl_GetDesc (0xc3b428) Relay
> trace:d3d9:IDirect3DDevice9Impl_CreateDepthStencilSurface Relay
> trace:d3d9:IDirect3DDevice9Impl_CreateSurface (0x1264c8) Relay
> trace:heap:RtlAllocateHeap (0x110000,0000000a,0000001c): returning 0xc3b450
> trace:d3d9:IDirect3DDevice9Impl_CreateSurface (0x1264c8) : w(256) h(256) fmt(0) surf@(nil)
> trace:heap:RtlAllocateHeap (0x110000,0000000a,00000114): returning 0x1b81e0
> trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 4
> trace:d3d9:IDirect3DDevice9Impl_CreateSurface (0x1264c8) : Created surface 0xc3b450
> trace:d3d9:IDirect3DDevice9Impl_BeginStateBlock (0x1264c8) Relay
> trace:heap:RtlAllocateHeap (0x110000,0000000a,0000c994): returning 0xd1df30
> trace:heap:RtlAllocateHeap (0x110000,0000000a,000006a0): returning 0xc3b820
> trace:heap:RtlAllocateHeap (0x110000,0000000a,000001a8): returning 0xa7b7e8
> trace:heap:RtlAllocateHeap (0x110000,0000000a,000006b0): returning 0x1b8300
> trace:heap:RtlAllocateHeap (0x110000,0000000a,000001ac): returning 0xd2a8d0
> trace:heap:RtlAllocateHeap (0x110000,00000002,000001ac): returning 0xc3bec8
> trace:heap:RtlAllocateHeap (0x110000,00000002,000001a8): returning 0xa7b998
> trace:d3d9:IDirect3DDevice9Impl_SetViewport (0x1264c8)0xc3b384 Relay
> trace:d3d9:IDirect3DDevice9Impl_EndStateBlock (0x1264c8) Relay
> trace:heap:RtlAllocateHeap (0x110000,0000000a,00000010): returning 0xd1dec8
> trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 5
> trace:d3d9:IDirect3DDevice9Impl_EndStateBlock (0x1264c8)Returning 0xd1dec8 0xd1df30
> trace:d3d9:IDirect3DStateBlock9Impl_Capture (0xd1dec8) Relay
> trace:d3d9:IDirect3DDevice9Impl_GetRenderTarget (0x1264c8) Relay
> trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d20)
> trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 6
> trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d20) : AddRef from 0
> trace:d3d9:IDirect3DDevice9Impl_GetDepthStencilSurface (0x1264c8) Relay
> trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d48)
> trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 7
> trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d48) : AddRef from 0
> trace:d3d9:IDirect3DDevice9Impl_SetRenderTarget (0x1264c8) Relay
> trace:heap:RtlFreeHeap (0x110000,00000002,0x178110): returning TRUE
> trace:d3d9:IDirect3DDevice9Impl_SetDepthStencilSurface (0x1264c8) Relay
> trace:d3d9:IDirect3DDevice9Impl_SetViewport (0x1264c8)0xc3b384 Relay
> trace:d3d9:IDirect3DDevice9Impl_BeginScene (0x1264c8) Relay
> trace:d3d9:IDirect3DSurface9Impl_AddRef (0xc3b428)
> trace:d3d9:IDirect3DSurface9Impl_AddRef (0xc3b428) : Forwarding to 0xa7b6e8
> trace:d3d9:IDirect3DTexture9Impl_AddRef (0xa7b6e8) : AddRef from 2
> trace:heap:RtlAllocateHeap (0x110000,00000002,0000001d): returning 0xc3b478

However, after distinguishing the direct and the indirect function calls, I would've found an output like this much better:
> trace:d3d9:IDirect3DSurface9Impl_GetDesc (0xc3b428) Relay
> trace:d3d9:IDirect3DDevice9Impl_CreateDepthStencilSurface Relay
>   trace:d3d9:IDirect3DDevice9Impl_CreateSurface (0x1264c8) Relay
>     trace:heap:RtlAllocateHeap (0x110000,0000000a,0000001c): returning 0xc3b450
>     trace:d3d9:IDirect3DDevice9Impl_CreateSurface (0x1264c8) : w(256) h(256) fmt(0) surf@(nil)
>     trace:heap:RtlAllocateHeap (0x110000,0000000a,00000114): returning 0x1b81e0
>     trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 4
> trace:d3d9:IDirect3DDevice9Impl_CreateSurface (0x1264c8) : Created surface 0xc3b450
> trace:d3d9:IDirect3DDevice9Impl_BeginStateBlock (0x1264c8) Relay
>   trace:heap:RtlAllocateHeap (0x110000,0000000a,0000c994): returning 0xd1df30
>   trace:heap:RtlAllocateHeap (0x110000,0000000a,000006a0): returning 0xc3b820
>   trace:heap:RtlAllocateHeap (0x110000,0000000a,000001a8): returning 0xa7b7e8
>   trace:heap:RtlAllocateHeap (0x110000,0000000a,000006b0): returning 0x1b8300
>   trace:heap:RtlAllocateHeap (0x110000,0000000a,000001ac): returning 0xd2a8d0
>   trace:heap:RtlAllocateHeap (0x110000,00000002,000001ac): returning 0xc3bec8
>   trace:heap:RtlAllocateHeap (0x110000,00000002,000001a8): returning 0xa7b998
> trace:d3d9:IDirect3DDevice9Impl_SetViewport (0x1264c8)0xc3b384 Relay
> trace:d3d9:IDirect3DDevice9Impl_EndStateBlock (0x1264c8) Relay
>   trace:heap:RtlAllocateHeap (0x110000,0000000a,00000010): returning 0xd1dec8
>   trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 5
>   trace:d3d9:IDirect3DDevice9Impl_EndStateBlock (0x1264c8)Returning 0xd1dec8 0xd1df30
> trace:d3d9:IDirect3DStateBlock9Impl_Capture (0xd1dec8) Relay
> trace:d3d9:IDirect3DDevice9Impl_GetRenderTarget (0x1264c8) Relay
>   trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d20)
>     trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 6
>     trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d20) : AddRef from 0
> trace:d3d9:IDirect3DDevice9Impl_GetRenderTarget (0x1264c8) Finished
> trace:d3d9:IDirect3DDevice9Impl_GetDepthStencilSurface (0x1264c8) Relay
>   trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d48)
>     trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 7
>   trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d48) : AddRef from 0
> trace:d3d9:IDirect3DDevice9Impl_SetRenderTarget (0x1264c8) Relay
>   trace:heap:RtlFreeHeap (0x110000,00000002,0x178110): returning TRUE
> trace:d3d9:IDirect3DDevice9Impl_SetDepthStencilSurface (0x1264c8) Relay
> trace:d3d9:IDirect3DDevice9Impl_SetViewport (0x1264c8)0xc3b384 Relay
> trace:d3d9:IDirect3DDevice9Impl_BeginScene (0x1264c8) Relay
>   trace:d3d9:IDirect3DSurface9Impl_AddRef (0xc3b428)
>     trace:d3d9:IDirect3DSurface9Impl_AddRef (0xc3b428) : Forwarding to 0xa7b6e8
>   trace:d3d9:IDirect3DTexture9Impl_AddRef (0xa7b6e8) : AddRef from 2
>   trace:heap:RtlAllocateHeap (0x110000,00000002,0000001d): returning 0xc3b478

I have to admit that I have yet no real idea if this distinction is correct, but I hope it makes clear what I want to approach.
All traces that have been made inside of a nested function call are written a bit more right, so that one
can easily see that it hasn't been called directly by an application.


A suggestion for how to realize this system would be to
1) add a variable that counts how much right a debug output should be
2) modify the debug macros TRACE, FIXME, etc... in such a way that they recognize this variable
3) replace all TRACE("(%p): relayn", This) calls, which are usually at the beginning of a function,
    with a new macro, let's say NEWTRACE, which does exactly the same but also increments our
    tab (or space) counter by one.
4) make sure that there's also an ENDTRACE macro at the end of each function that decrements
    the counter again.


At least I would find this idea very useful, so feel free to leave a comment about either the thing itself
or my implementation idea of it.

Best regards,
    Tony


PS: I know that there would be several workarounds that would help me in this case,
       but I'd like this proposal to get into the official tree if others like it, too.

PPS: We could also add a WINEDEBUG option that filters out any indirect function calls
          from e.g. the 4th level to make things more overviewable, however, it's just another idea, too ;-)











From wine-devel at kievinfo.com  Tue Mar 18 06:17:03 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 18 Mar 2008 05:17:03 -0600
Subject: Proposal for debugging improvement
In-Reply-To: <E1JbZdd-0007MN-Dp@www14.emo.freenet-rz.de>
References: <E1JbZdd-0007MN-Dp@www14.emo.freenet-rz.de>
Message-ID: <47DFA4AF.7040105@kievinfo.com>

tony.wasserka at freenet.de wrote:
> A suggestion for how to realize this system would be to
> 1) add a variable that counts how much right a debug output should be
> 2) modify the debug macros TRACE, FIXME, etc... in such a way that they recognize this variable
> 3) replace all TRACE("(%p): relayn", This) calls, which are usually at the beginning of a function,
>     with a new macro, let's say NEWTRACE, which does exactly the same but also increments our
>     tab (or space) counter by one.
> 4) make sure that there's also an ENDTRACE macro at the end of each function that decrements
>     the counter again.

Have you looked at tools/examine-relay script?
What you proposing will add unnecessary processing everywhere the debugging 
output is called. While it would only be useful for relay, which is already 
horribly slow just because it outputs so much.

Vitaliy.


From julliard at winehq.org  Tue Mar 18 06:53:31 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 18 Mar 2008 12:53:31 +0100
Subject: (X11 Series 2/3) Fix handling of non-default visuals
In-Reply-To: <1205698113.7447.12.camel@hermes2.karcher.local> (Michael
	Karcher's message of "Sun, 16 Mar 2008 21:08:33 +0100")
References: <1205698113.7447.12.camel@hermes2.karcher.local>
Message-ID: <87tzj49rk4.fsf@wine.dyndns.org>

Michael Karcher <wine at mkarcher.dialup.fu-berlin.de> writes:

> @@ -144,7 +170,7 @@ BOOL X11DRV_CreateDC( HDC hdc, X11DRV_PDEVICE **pdev, LPCWSTR driver, LPCWSTR de
>      else
>      {
>          physDev->bitmap    = NULL;
> -        physDev->drawable  = root_window;
> +        physDev->drawable  = template_window;
>          physDev->depth     = screen_depth;
>          physDev->drawable_rect = virtual_screen_rect;
>          SetRect( &physDev->dc_rect, 0, 0, virtual_screen_rect.right - virtual_screen_rect.left,

This won't work, a screen DC has to be able to paint on the root
window. I'm afraid that supporting different depths properly is pretty
complicated.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Tue Mar 18 06:53:13 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 12:53:13 +0100
Subject: 1/6 WineD3D: CheckDeviceFormat rewrite
In-Reply-To: <20080318084428.191020@gmx.net>
References: <20080317192258.74730@gmx.net> <20080318082701.173790@gmx.net>
	<20080318084428.191020@gmx.net>
Message-ID: <200803181253.13172.stefan@codeweavers.com>

Am Dienstag, 18. M?rz 2008 09:44:28 schrieb Roderick Colenbrander:
> Patch 7/6, 8/6, 9/6 should take away most issues. Yesterday I didn't have
> the time to prepare those but they should be fine.
Usually the idea is to apply patches in a order that does not cause known 
regressions, as this can make bisecting unknown regressions a hell. 


From mstefani at redhat.com  Tue Mar 18 07:30:40 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Tue, 18 Mar 2008 13:30:40 +0100
Subject: Translations and Wine 1.0
Message-ID: <47DFB5F0.1040304@redhat.com>

Hello!

We should try to update the translations of Wine to other languages for
1.0. The code freeze during the release candidate time frame is perfect
for this as the translations don't have to track a moving target.

Somebody had scripts/a web page to check for missing translations or
broken ones in the .rc files. But I seem to not enter the right search
words to find any info regarding that; if somebody has a pointer please
let me know. It would be nice if we could run that scripts regularly
during the release candidate time.

bye
	michael


From paul.vriens.wine at gmail.com  Tue Mar 18 07:53:46 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 18 Mar 2008 13:53:46 +0100
Subject: Translations and Wine 1.0
In-Reply-To: <47DFB5F0.1040304@redhat.com>
References: <47DFB5F0.1040304@redhat.com>
Message-ID: <47DFBB5A.9050708@gmail.com>

Michael Stefaniuc wrote:
> Hello!
> 
> We should try to update the translations of Wine to other languages for
> 1.0. The code freeze during the release candidate time frame is perfect
> for this as the translations don't have to track a moving target.
> 
> Somebody had scripts/a web page to check for missing translations or
> broken ones in the .rc files. But I seem to not enter the right search
> words to find any info regarding that; if somebody has a pointer please
> let me know. It would be nice if we could run that scripts regularly
> during the release candidate time.
> 
> bye
> 	michael
> 
> 
> 
You mean:

http://pf128.krakow.sdi.tpnet.pl/wine-transl/

-- 
Cheers,

Paul.


From mstefani at redhat.com  Tue Mar 18 07:59:56 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Tue, 18 Mar 2008 13:59:56 +0100
Subject: Translations and Wine 1.0
In-Reply-To: <47DFBB5A.9050708@gmail.com>
References: <47DFB5F0.1040304@redhat.com> <47DFBB5A.9050708@gmail.com>
Message-ID: <47DFBCCC.8020307@redhat.com>

Paul Vriens wrote:
> Michael Stefaniuc wrote:
>> Hello!
>>
>> We should try to update the translations of Wine to other languages for
>> 1.0. The code freeze during the release candidate time frame is perfect
>> for this as the translations don't have to track a moving target.
>>
>> Somebody had scripts/a web page to check for missing translations or
>> broken ones in the .rc files. But I seem to not enter the right search
>> words to find any info regarding that; if somebody has a pointer please
>> let me know. It would be nice if we could run that scripts regularly
>> during the release candidate time.

> http://pf128.krakow.sdi.tpnet.pl/wine-transl/
Yepp! Thanks!

bye
	michael
-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Hauptst?tter Strasse 58, 70178 Stuttgart
Handelsregister: Amtsgericht Stuttgart HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                 Werner Knoblich


From stefan at codeweavers.com  Tue Mar 18 08:26:23 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 14:26:23 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803172229.30779.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171647.39614.stefan@codeweavers.com>
	<200803172229.30779.stefan@codeweavers.com>
Message-ID: <200803181426.23481.stefan@codeweavers.com>

Hi,

Given the past discussion, do you agree with the code now? Alexandre wants 
your OKs before applying the patches.

Thanks,
Stefan


From julliard at winehq.org  Tue Mar 18 08:28:39 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 18 Mar 2008 14:28:39 +0100
Subject: [1/22] WineD3D: Add GL_ATI_fragment_shader
In-Reply-To: <200803162201.26223.stefan@codeweavers.com> ("Stefan
	=?utf-8?Q?D=C3=B6singer=22's?=
	message of "Sun, 16 Mar 2008 22:01:26 +0100")
References: <200803162201.26223.stefan@codeweavers.com>
Message-ID: <87prts9n5k.fsf@wine.dyndns.org>

Stefan D?singer <stefan at codeweavers.com> writes:

> Note that the extension is disabled for now. This allows a bottom-up
> contruction of the GL_ATI_fragment_shader replacement pipeline in the
> code with separate patches, and activating it at the end when it is at
> the same feature level as the existing ARB_texture_env_combine code it
> can be enabled at once, thus avoiding additional troubles when running
> regression tests.

It may avoid trouble, but it also makes regression testing useless,
since all problems with this code will point to the patch that enables
it. It's not a good idea to add code without making use of it.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Tue Mar 18 08:32:40 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Tue, 18 Mar 2008 14:32:40 +0100
Subject: [1/22] WineD3D: Add GL_ATI_fragment_shader
In-Reply-To: <87prts9n5k.fsf@wine.dyndns.org>
References: <200803162201.26223.stefan@codeweavers.com>
	<87prts9n5k.fsf@wine.dyndns.org>
Message-ID: <200803181432.40574.stefan@codeweavers.com>

Am Dienstag, 18. M?rz 2008 14:28:39 schrieb Alexandre Julliard:
> It may avoid trouble, but it also makes regression testing useless,
> since all problems with this code will point to the patch that enables
> it. It's not a good idea to add code without making use of it.
Otherwise regression testing would be useless as well, because I can only move 
all D3DOPS over at the same time or none. I can't say I use the new code only 
if the app does this or that. By enabling the code as it is added, I cause 
additional problems during the span of patches where the new codepath is not 
yet as feature-rich as the old one.

So I only see two ways, the one I've chosen here, or sending one huge patch 
that does everything at once


From ben at atomnet.co.uk  Tue Mar 18 09:13:21 2008
From: ben at atomnet.co.uk (Ben Hodgetts)
Date: Tue, 18 Mar 2008 14:13:21 +0000
Subject: Please create 1.2.0 milestone in Bugzilla
In-Reply-To: <d6c5d7290803180330x21e79457kebc236789952afdd@mail.gmail.com>
References: <a71bd89a0803171615u6de6d3a6oca591b54a611bb21@mail.gmail.com>
	<d6c5d7290803180330x21e79457kebc236789952afdd@mail.gmail.com>
Message-ID: <47DFCE01.5080703@atomnet.co.uk>



Edward Savage wrote:
> On Tue, Mar 18, 2008 at 10:15 AM, Dan Kegel <dank at kegel.com> wrote:
>   
>> The 1.1.x releases will be development releases,
>>  so a 1.1.0 milestone doesn't make much sense.
>>  Please create a 1.2.0 milestone in Bugzilla.
>>  Thanks!
>>  - Dan
>>
>>     
>
> Is there a reason we wont be continuing the current y.y.x (ie 0.9.x
> and 1.0.x) style releases for development?
>
> Most foss applications seem to have moved away from the even odd
> release cycle and due to wines long lead times between releases having
> it this way could get rather confusing for newer users not expecting
> it.
>
> Edward
>
> Ps Sorry for the dupe dan, hit the wrong button.
>
>
>   

As far as I'm aware, 1.2.0 will be a long time off (as would 1.1.0) it's 
just the next _big_ milestone. He doesn't mean that after 1.0.0 there 
wont be anything before 1.1.0. It's just a point to aim to fix the main 
bugs by.

Ben H.


From paul.vriens.wine at gmail.com  Tue Mar 18 09:29:26 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 18 Mar 2008 15:29:26 +0100
Subject: msi/tests: Skip the tests if we are unable to identify the user
	SID.	This fixes crashes on Win9x.
In-Reply-To: <alpine.DEB.1.00.0803181520420.12580@amboise.dolphin>
References: <alpine.DEB.1.00.0803181520420.12580@amboise.dolphin>
Message-ID: <47DFD1C6.1040606@gmail.com>

Francois Gouget wrote:
> ---
>  dlls/msi/tests/source.c |   50 ++++++++++++++++++++++++++++++++++++++--------
>  1 files changed, 41 insertions(+), 9 deletions(-)
> 
> diff --git a/dlls/msi/tests/source.c b/dlls/msi/tests/source.c
> index 49e40c7..5f75159 100644
> --- a/dlls/msi/tests/source.c
> +++ b/dlls/msi/tests/source.c
> @@ -122,18 +122,22 @@ static void create_test_guid(LPSTR prodcode, LPSTR squashed)
>      WideCharToMultiByte(CP_ACP, 0, squashedW, -1, squashed, MAX_PATH, NULL, NULL);
>  }
>  
> -static void get_user_sid(LPSTR *usersid)
> +static int get_user_sid(LPSTR *usersid)
>  {
>      HANDLE token;
>      BYTE buf[1024];
>      DWORD size;
>      PTOKEN_USER user;
> +    BOOL rc;
>  
> -    OpenProcessToken(GetCurrentProcess(), TOKEN_QUERY, &token);
> +    rc=OpenProcessToken(GetCurrentProcess(), TOKEN_QUERY, &token);
> +    if (!rc && GetLastError() == ERROR_CALL_NOT_IMPLEMENTED)
> +        return 0;
>      size = sizeof(buf);
>      GetTokenInformation(token, TokenUser, (void *)buf, size, &size);
>      user = (PTOKEN_USER)buf;
>      pConvertSidToStringSidA(user->User.Sid, usersid);
> +    return 1;
>  }
>  
>  static void check_reg_str(HKEY prodkey, LPCSTR name, LPCSTR expected, BOOL bcase, DWORD line)
> @@ -186,7 +190,11 @@ static void test_MsiSourceListGetInfo(void)
>      }
>  
>      create_test_guid(prodcode, prod_squashed);
> -    get_user_sid(&usersid);
> +    if (!get_user_sid(&usersid))
> +    {
> +        skip("User SID not available -> skipping MsiSourceListGetInfoA tests\n");
> +        return;
> +    }
>  

Couldn't we just check for pConvertSidToStringSidA like we do in the msi.c tests 
(line 6039)?

-- 
Cheers,

Paul.


From thestig at google.com  Tue Mar 18 09:56:02 2008
From: thestig at google.com (Lei Zhang)
Date: Tue, 18 Mar 2008 07:56:02 -0700
Subject: Translations and Wine 1.0
In-Reply-To: <47DFB5F0.1040304@redhat.com>
References: <47DFB5F0.1040304@redhat.com>
Message-ID: <558b2f5c0803180756s6904a163h38c6d2210bdbfc38@mail.gmail.com>

On Tue, Mar 18, 2008 at 5:30 AM, Michael Stefaniuc <mstefani at redhat.com> wrote:
> Hello!
>
>  We should try to update the translations of Wine to other languages for
>  1.0. The code freeze during the release candidate time frame is perfect
>  for this as the translations don't have to track a moving target.
>
>  Somebody had scripts/a web page to check for missing translations or
>  broken ones in the .rc files. But I seem to not enter the right search
>  words to find any info regarding that; if somebody has a pointer please
>  let me know. It would be nice if we could run that scripts regularly
>  during the release candidate time.
>
>  bye
>         michael
>
>
>

Would the Launchpad translations site be helpful?

https://translations.launchpad.net/

I think basically the workflow is:

* put phrases that need translation into the work queue.
* select the languages it needs to be translated into.
* people offer suggestions, and launchpad offers suggestions for the
same phrase already translated in other projects.
* pick the most appropriate suggestion.
* watch the percentage bars go up.

(please correct me if this is inaccurate)

- Lei


From mstefani at redhat.com  Tue Mar 18 10:06:48 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Tue, 18 Mar 2008 16:06:48 +0100
Subject: Translations and Wine 1.0
In-Reply-To: <558b2f5c0803180756s6904a163h38c6d2210bdbfc38@mail.gmail.com>
References: <47DFB5F0.1040304@redhat.com>
	<558b2f5c0803180756s6904a163h38c6d2210bdbfc38@mail.gmail.com>
Message-ID: <47DFDA88.3010906@redhat.com>

Hello Lei,

Lei Zhang wrote:
> On Tue, Mar 18, 2008 at 5:30 AM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>>  We should try to update the translations of Wine to other languages for
>>  1.0. The code freeze during the release candidate time frame is perfect
>>  for this as the translations don't have to track a moving target.
>>
>>  Somebody had scripts/a web page to check for missing translations or
>>  broken ones in the .rc files. But I seem to not enter the right search
>>  words to find any info regarding that; if somebody has a pointer please
>>  let me know. It would be nice if we could run that scripts regularly
>>  during the release candidate time.

> Would the Launchpad translations site be helpful?
> 
> https://translations.launchpad.net/
Something like that would be useful.


> I think basically the workflow is:
> 
> * put phrases that need translation into the work queue.
> * select the languages it needs to be translated into.
> * people offer suggestions, and launchpad offers suggestions for the
> same phrase already translated in other projects.
> * pick the most appropriate suggestion.
> * watch the percentage bars go up.
> 
> (please correct me if this is inaccurate)
Wine is already there:
"Translation setup needed
The Wine project is not set up for translation in Launchpad.
If you are Scott Ritchie, log in to begin the setup process.
Otherwise, you might want to talk with Scott Ritchie, the project
registrant, about using Launchpad for translations."

bye
	michael


From jnewman at codeweavers.com  Tue Mar 18 10:19:42 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Tue, 18 Mar 2008 10:19:42 -0500
Subject: Redirect http://forums.winehq.org -> http://forum.winehq.org.
In-Reply-To: <689de9370803161553v195b60f2h3c714782b63e9b70@mail.gmail.com>
References: <689de9370803161553v195b60f2h3c714782b63e9b70@mail.gmail.com>
Message-ID: <47DFDD8E.30801@codeweavers.com>

Done.

Andrew Riedi wrote:
> Because many other sites have forums spelled in the plural, such as
> http://ubuntuforums.org and http://forums.gentoo.org, many users
> simply assume we will too.  I would like to request a redirect from
> http://fourms.winehq.org to http://forum.winehq.org.
> 
> Note, even one of own developers made this mistake, which I sent in a
> fix for at:  http://article.gmane.org/gmane.comp.emulators.wine.patches/48512
> .
> 


From dank at kegel.com  Tue Mar 18 10:32:29 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 08:32:29 -0700
Subject: Please create 1.2.0 milestone in Bugzilla
In-Reply-To: <d6c5d7290803180330x21e79457kebc236789952afdd@mail.gmail.com>
References: <a71bd89a0803171615u6de6d3a6oca591b54a611bb21@mail.gmail.com>
	<d6c5d7290803180330x21e79457kebc236789952afdd@mail.gmail.com>
Message-ID: <a71bd89a0803180832n5f5f33c3v22907ebc413e7800@mail.gmail.com>

On Tue, Mar 18, 2008 at 3:30 AM, Edward Savage <epssyis at gmail.com> wrote:
> Is there a reason we wont be continuing the current y.y.x (ie 0.9.x
>  and 1.0.x) style releases for development?

We will, actually.  What made you think we wouldn't?
Is http://wiki.winehq.org/WineReleasePlan poorly written?

1.1.x will be our trunk during the 1.1 era.
We may or may not have development on the 1.0 branch;
depends on if there's demand and volunteer manpower.
- Dan


From dank at kegel.com  Tue Mar 18 10:43:49 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 08:43:49 -0700
Subject: Which IRC room to send SoC people to?
Message-ID: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>

http://wiki.winehq.org/SummerOfCode
currently sends people to #WineHQ.
Should it send them to #winehackers?


From hverbeet at gmail.com  Tue Mar 18 10:44:00 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Tue, 18 Mar 2008 16:44:00 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803181426.23481.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171647.39614.stefan@codeweavers.com>
	<200803172229.30779.stefan@codeweavers.com>
	<200803181426.23481.stefan@codeweavers.com>
Message-ID: <d658b69e0803180844q3d1918ads70c4a39e684c7f1c@mail.gmail.com>

On 18/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Hi,
>
>  Given the past discussion, do you agree with the code now? Alexandre wants
>  your OKs before applying the patches.
>
I don't think putting this stuff in its own shader backend is the
right approach. On the other hand, given my current level of
involvement with wined3d, I wouldn't mind too much if it got committed
anyway.


From hverbeet at gmail.com  Tue Mar 18 10:49:18 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Tue, 18 Mar 2008 16:49:18 +0100
Subject: Which IRC room to send SoC people to?
In-Reply-To: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>
References: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>
Message-ID: <d658b69e0803180849g7cb6ce1ak246b5876c625d240@mail.gmail.com>

On 18/03/2008, Dan Kegel <dank at kegel.com> wrote:
> http://wiki.winehq.org/SummerOfCode
>  currently sends people to #WineHQ.
>  Should it send them to #winehackers?
>
I'd say yes.


From mstefani at redhat.com  Tue Mar 18 10:49:24 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Tue, 18 Mar 2008 16:49:24 +0100
Subject: Which IRC room to send SoC people to?
In-Reply-To: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>
References: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>
Message-ID: <47DFE484.50906@redhat.com>

Dan Kegel wrote:
> http://wiki.winehq.org/SummerOfCode
> currently sends people to #WineHQ.
> Should it send them to #winehackers?
#winehackers is probably better.

bye
	michael


From stefan at codeweavers.com  Tue Mar 18 10:55:46 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 16:55:46 +0100
Subject: Which IRC room to send SoC people to?
In-Reply-To: <d658b69e0803180849g7cb6ce1ak246b5876c625d240@mail.gmail.com>
References: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>
	<d658b69e0803180849g7cb6ce1ak246b5876c625d240@mail.gmail.com>
Message-ID: <200803181655.47263.stefan@codeweavers.com>

Am Dienstag, 18. M?rz 2008 16:49:18 schrieb H. Verbeet:
> On 18/03/2008, Dan Kegel <dank at kegel.com> wrote:
> > http://wiki.winehq.org/SummerOfCode
> >  currently sends people to #WineHQ.
> >  Should it send them to #winehackers?
>
> I'd say yes.
Agreed as well


From saulius2 at ar.fi.lt  Tue Mar 18 11:34:31 2008
From: saulius2 at ar.fi.lt (Saulius Krasuckas)
Date: Tue, 18 Mar 2008 18:34:31 +0200 (EET)
Subject: user32: Test destroying the cursor of a parent process.
In-Reply-To: <4783D93F.7060800@orange.fr>
References: <689de9370801080507h7f7816cfh4271375aab126d45@mail.gmail.com>
	<4783D93F.7060800@orange.fr>
Message-ID: <Pine.LNX.4.62.0803181826560.10409@tvarka.ar.fi.lt>

* On Tue, 8 Jan 2008, Eric Pouech wrote:
> * Andrew Riedi a ?crit :
> >
> >  dlls/user32/tests/cursoricon.c |  201 ++++++++++++++++++++++++++++++++++++++++
    ...
> > +static void do_child(void)
> > +{
> > +    WNDCLASS class;
> > +    MSG msg;
> > +    BOOL ret;
> > +
> > +    /* Register a new class. */
> > +    class.style = CS_GLOBALCLASS;
> > +    class.lpfnWndProc = callback_child;
> > +    class.cbClsExtra = 0;
> > +    class.cbWndExtra = 0;
> > +    class.hInstance = GetModuleHandle(NULL);
> > +    class.hIcon = NULL;
> > +    class.hCursor = NULL;
> > +    class.hbrBackground = NULL;
> > +    class.lpszMenuName = NULL;
> > +    class.lpszClassName = "cursor_child";
> > +
> > +    SetLastError(0xdeadbeef);
> > +    ret = RegisterClass(&class);
> > +    ok(ret, "Failed to register window class. Error: %d\n", GetLastError());
  ...
>
> IMO, the ok() tests in the child process are a bad idea (they won't be 
> counted, nor returned as errors, by the parent process)

Was Wine test framework architecture done such way on a purpose?  Why 
would it be a bad idea to take into account a child output also?

From stefan at codeweavers.com  Tue Mar 18 10:55:46 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 16:55:46 +0100
Subject: Which IRC room to send SoC people to?
In-Reply-To: <d658b69e0803180849g7cb6ce1ak246b5876c625d240@mail.gmail.com>
References: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>
	<d658b69e0803180849g7cb6ce1ak246b5876c625d240@mail.gmail.com>
Message-ID: <200803181655.47263.stefan@codeweavers.com>

Am Dienstag, 18. M?rz 2008 16:49:18 schrieb H. Verbeet:
> On 18/03/2008, Dan Kegel <dank at kegel.com> wrote:
> > http://wiki.winehq.org/SummerOfCode
> >  currently sends people to #WineHQ.
> >  Should it send them to #winehackers?
>
> I'd say yes.
Agreed as well


From austinenglish at gmail.com  Tue Mar 18 11:28:29 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 18 Mar 2008 11:28:29 -0500
Subject: Please create 1.2.0 milestone in Bugzilla
In-Reply-To: <a71bd89a0803180832n5f5f33c3v22907ebc413e7800@mail.gmail.com>
References: <a71bd89a0803171615u6de6d3a6oca591b54a611bb21@mail.gmail.com>
	<d6c5d7290803180330x21e79457kebc236789952afdd@mail.gmail.com>
	<a71bd89a0803180832n5f5f33c3v22907ebc413e7800@mail.gmail.com>
Message-ID: <b6bb06270803180928m42f075a3p470680d26c1367c6@mail.gmail.com>

On Tue, Mar 18, 2008 at 10:32 AM, Dan Kegel <dank at kegel.com> wrote:
> On Tue, Mar 18, 2008 at 3:30 AM, Edward Savage <epssyis at gmail.com> wrote:
>  > Is there a reason we wont be continuing the current y.y.x (ie 0.9.x
>  >  and 1.0.x) style releases for development?
>
>  We will, actually.  What made you think we wouldn't?
>  Is http://wiki.winehq.org/WineReleasePlan poorly written?
>
>  1.1.x will be our trunk during the 1.1 era.
>  We may or may not have development on the 1.0 branch;
>  depends on if there's demand and volunteer manpower.
>  - Dan
>

If 1.1.0 is set to be released two weeks after 1.0, then we may need
to adjust the target milestones in bugzilla for some of them. I doubt,
for instance, that a DIB engine will be implemented in a that time.

-Austin

(Sorry for the dupe Dan, hit the wrong button).


From susancragin at earthlink.net  Tue Mar 18 11:46:16 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Tue, 18 Mar 2008 12:46:16 -0400 (EDT)
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
Message-ID: <152199.1205858776693.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>

The new default pulseaudio in Hardy screws up every program that isn't gnome, delivering terrible sound. 
https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
Question -- what does WINE do with pulseaudio?
http://forum.skype.com/index.php?showtopic=112021






From rob at codeweavers.com  Tue Mar 18 12:00:33 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Tue, 18 Mar 2008 17:00:33 +0000
Subject: user32: Test destroying the cursor of a parent process.
In-Reply-To: <Pine.LNX.4.62.0803181826560.10409@tvarka.ar.fi.lt>
References: <689de9370801080507h7f7816cfh4271375aab126d45@mail.gmail.com>	<4783D93F.7060800@orange.fr>
	<Pine.LNX.4.62.0803181826560.10409@tvarka.ar.fi.lt>
Message-ID: <47DFF531.8070107@codeweavers.com>

Saulius Krasuckas wrote:
> * On Tue, 8 Jan 2008, Eric Pouech wrote:
>   
>> * Andrew Riedi a ?crit :
>>     
>>>  dlls/user32/tests/cursoricon.c |  201 ++++++++++++++++++++++++++++++++++++++++
>>>       
>     ...
>   
>>> +static void do_child(void)
>>> +{
>>> +    WNDCLASS class;
>>> +    MSG msg;
>>> +    BOOL ret;
>>> +
>>> +    /* Register a new class. */
>>> +    class.style = CS_GLOBALCLASS;
>>> +    class.lpfnWndProc = callback_child;
>>> +    class.cbClsExtra = 0;
>>> +    class.cbWndExtra = 0;
>>> +    class.hInstance = GetModuleHandle(NULL);
>>> +    class.hIcon = NULL;
>>> +    class.hCursor = NULL;
>>> +    class.hbrBackground = NULL;
>>> +    class.lpszMenuName = NULL;
>>> +    class.lpszClassName = "cursor_child";
>>> +
>>> +    SetLastError(0xdeadbeef);
>>> +    ret = RegisterClass(&class);
>>> +    ok(ret, "Failed to register window class. Error: %d\n", GetLastError());
>>>       
>   ...
>   
>> IMO, the ok() tests in the child process are a bad idea (they won't be 
>> counted, nor returned as errors, by the parent process)
>>     
>
> Was Wine test framework architecture done such way on a purpose?  Why 
> would it be a bad idea to take into account a child output also?

The architecture has been fixed since the introduction of the 
winetest_wait_child_process function in include/wine/test.h.

-- 
Rob Shearman



From fgouget at free.fr  Tue Mar 18 13:01:08 2008
From: fgouget at free.fr (Francois Gouget)
Date: Tue, 18 Mar 2008 19:01:08 +0100 (CET)
Subject: Translations and Wine 1.0
In-Reply-To: <558b2f5c0803180756s6904a163h38c6d2210bdbfc38@mail.gmail.com>
References: <47DFB5F0.1040304@redhat.com>
	<558b2f5c0803180756s6904a163h38c6d2210bdbfc38@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0803181852060.10478@amboise.dolphin>

On Tue, 18 Mar 2008, Lei Zhang wrote:
[...]
> I think basically the workflow is:
> 
> * put phrases that need translation into the work queue.
> * select the languages it needs to be translated into.
> * people offer suggestions, and launchpad offers suggestions for the
> same phrase already translated in other projects.
> * pick the most appropriate suggestion.
> * watch the percentage bars go up.

I think the problem is extracting the strings to translate from the rc 
files, and combining the translations with the reference rc file to 
generate a translated rc file. Besides the issue of handling include 
files and macros, one aspect that spices things up is that the 
translation may need to tweak the widget sizes in order for the 
translated text to fit. How to represent that is not clear.

Still I think it would be doable with some conventions (e.g. prepend 
the geometry data to the string to be translated). Might make a good 
GSoC project:

   Create a tool to manage rc file translations and integrate them with 
   standard localisation tools such as the PO tools or 
   https://translations.launchpad.net/.

One possible starting point would bethe po4a project.
http://po4a.alioth.debian.org/

Btw, is the translations.launchpad using po files?

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
        It really galls me that most of the computer power in the world
                          is wasted on screen savers.
                     Chris Caldwell from the GIMPS project
                       http://www.mersenne.org/prime.htm


From mikolaj at zalewski.pl  Tue Mar 18 14:14:59 2008
From: mikolaj at zalewski.pl (=?UTF-8?B?TWlrb8WCYWogWmFsZXdza2k=?=)
Date: Tue, 18 Mar 2008 20:14:59 +0100
Subject: Translations and Wine 1.0
In-Reply-To: <alpine.DEB.1.00.0803181852060.10478@amboise.dolphin>
References: <47DFB5F0.1040304@redhat.com>	<558b2f5c0803180756s6904a163h38c6d2210bdbfc38@mail.gmail.com>
	<alpine.DEB.1.00.0803181852060.10478@amboise.dolphin>
Message-ID: <47E014B3.3080401@zalewski.pl>

  I think the release candidate phase for Wine 1.0 is a good time to add 
new translations and it's also important to fix out-of-sync resources. 
They may cause programs to run incorrectly when running under with a 
different language (I've filled a bug about it: 
http://bugs.winehq.org/show_bug.cgi?id=12097).
  The lanuchpad looks interesting. What's the format for 
importing/exporting data from it? Extracting strings from a *.res is 
quite easy. Building a *.rc from a *.res and strings is also not too 
hard. It would be more tricky if we would like to extract the #define'd 
symbolic names of resources or comments.
  There is the problem of changing dialogs geometry (but we could use 
special files for that and write a dialog editor to edit them) and that 
sometimes the same string have different translations - e.g. in same 
langauges the column "Size" for directory view (where it means file 
size) is translated differently then the column "Size" in My Computer 
(where is means disk size). But that can be solved by preppending the 
string id to the string.
  Having string in different files than the resources would also help 
fixing out-of-sync resources (we could use English string if translated 
ones are not available).

Mikolaj Zalewski



From marcus at jet.franken.de  Tue Mar 18 14:15:44 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Tue, 18 Mar 2008 20:15:44 +0100
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
In-Reply-To: <152199.1205858776693.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>
References: <152199.1205858776693.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>
Message-ID: <20080318191544.GA4674@galeere>

On Tue, Mar 18, 2008 at 12:46:16PM -0400, Susan Cragin wrote:
> The new default pulseaudio in Hardy screws up every program that isn't gnome, delivering terrible sound. 
> https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
> Question -- what does WINE do with pulseaudio?
> http://forum.skype.com/index.php?showtopic=112021

Just tell the pulseaudio guys to take it a notch down.

Or use the ALSA pulseaudio wrapper plugin.

Ciao, Marcus


From eric.pouech at orange.fr  Tue Mar 18 15:29:57 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Tue, 18 Mar 2008 21:29:57 +0100
Subject: Proposed EM_Fontrange Patch
In-Reply-To: <47DDDDE4.6050500@earthlink.net>
References: <47DDDDE4.6050500@earthlink.net>
Message-ID: <47E02645.7010408@orange.fr>

James McKenzie a ?crit :
> All:
>
> I would like to see the problems with EM_Fontrange be fixed.  The 
> attached patch is for comment/review and I would like SPECIFIC 
> guidance on how to implement this patch as it relates to a Wine 1.0 
> bug (bug/issue 6254) and fixes the problem specified there.  The 
> conformance tests are already in tests/editor.c and all they involve 
> is removing some todo_wine blocks related to this issue.  The entire 
> patch will do this.  Sorry that the patch is in UNIX diff format, I 
> could not get git to do what I wanted.  The actual patch will be git 
> format and use the daily git.
I think that a couple of things should be improved in the patch:
- there are 3 hDC stored in the context, while only 2 are of use 
(rendering and measure)
- there is some interdependency with the EM_SETTARGETDEVICE message 
implementation, that should be looked at
- patch is likely a bit too big and should be sliced before inclusion

A+



From eric.pouech at orange.fr  Tue Mar 18 15:36:40 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Tue, 18 Mar 2008 21:36:40 +0100
Subject: Fresh valgrind errors in richedit
In-Reply-To: <a71bd89a0803171824s5d998e2bgcf56300e72542ba4@mail.gmail.com>
References: <a71bd89a0803171824s5d998e2bgcf56300e72542ba4@mail.gmail.com>
Message-ID: <47E027D8.1030902@orange.fr>

Dan Kegel a ?crit :
> Eric, could you have a look at
>
> http://kegel.com/wine/valgrind/logs-2008-03-17/vg-riched20_editor-diff.txt
>
> There are several new errors of the sort:
>
> + Conditional jump or move depends on uninitialised value(s)
> +    at  ME_SetParaFormat (para.c:400)
> +    by  ME_SetSelectionParaFormat (para.c:436)
> +    by  ME_RTFReadHook (editor.c:662)
> +    by  RTFGetToken (reader.c:417)
> +    by  RTFRead (reader.c:333)
> +    by  ME_StreamIn (editor.c:1095)
> +    by  RichEditWndProc_common (editor.c:2432)
> +    by  RichEditWndProcA (editor.c:3237)
> +    by  (within /home/dank/wine-git/dlls/user32/user32.dll.so)
> +    by  call_window_proc (winproc.c:457)
> +    by  WINPROC_call_window (winproc.c:2207)
> +    by  call_window_proc (message.c:1615)
> +    by  send_message (message.c:2430)
> +    by  SendMessageA (message.c:2575)
> +    by  test_EM_SETTEXTMODE (editor.c:471)
> +    by  func_editor (editor.c:2705)
> +    by  run_test (test.h:406)
> +    by  main (test.h:455)
>
>
>
>
>   
likely the RTF writer that isn't 100% compliant with the RTF specs (or 
my interpretation thereof)
won't have too much time until this week-end anyway, so if some wants to 
look at it before, feel free
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From susancragin at earthlink.net  Tue Mar 18 16:04:08 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Tue, 18 Mar 2008 17:04:08 -0400 (EDT)
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
Message-ID: <12143308.1205874248588.JavaMail.root@elwamui-mouette.atl.sa.earthlink.net>

http://www.pulseaudio.org/ticket/198
I'm not sure it's possible to use the pulseaudio plugin. 
Pulse seems to think it's a wine defect. 

-----Original Message-----
>From: Marcus Meissner <marcus at jet.franken.de>
>Sent: Mar 18, 2008 3:15 PM
>To: Susan Cragin <susancragin at earthlink.net>
>Cc: wine-devel at winehq.org
>Subject: Re: Hardy Heron -- Pulseaudio interferes with non-gnome audio
>
>On Tue, Mar 18, 2008 at 12:46:16PM -0400, Susan Cragin wrote:
>> The new default pulseaudio in Hardy screws up every program that isn't gnome, delivering terrible sound. 
>> https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
>> Question -- what does WINE do with pulseaudio?
>> http://forum.skype.com/index.php?showtopic=112021
>
>Just tell the pulseaudio guys to take it a notch down.
>
>Or use the ALSA pulseaudio wrapper plugin.
>
>Ciao, Marcus





From tom at dbservice.com  Tue Mar 18 16:14:43 2008
From: tom at dbservice.com (Tomas Carnecky)
Date: Tue, 18 Mar 2008 22:14:43 +0100
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
In-Reply-To: <152199.1205858776693.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>
References: <152199.1205858776693.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>
Message-ID: <47E030C3.4060804@dbservice.com>

Susan Cragin wrote:
> The new default pulseaudio in Hardy screws up every program that isn't gnome, delivering terrible sound. 
> https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453

Applications that use ALSA should work fine with the alsa pulse plugin - 
  should. Unfortunately the plugin has a few bugs, and the developers 
(of both pulseaudio and alsa) have been unresponsive in this matter. See
  - http://www.pulseaudio.org/ticket/198
  - https://bugtrack.alsa-project.org/alsa-bug/view.php?id=2601

> Question -- what does WINE do with pulseaudio?

Some suggested to create a native PulseAudio wine driver. That would 
yield the best results as far as the performance and reliability goes. 
Unfortunately we'll be stuck with the alsa driver for some time to come, 
so I tried to do the best to make the alsa pulse plugin to work with 
wine. I had to patch both the wine alsa driver as well as the alsa pulse 
plugin and it worked fine for my taste.

I submitted the patch to wine-patches:
http://www.winehq.org/pipermail/wine-patches/2008-February/050561.html

I don't know if the relevant alsa pulse plugin patch is publicly 
available, I haven't looked at that matter in a long time. Some of the 
needed patches are probably still in my local repositories. It makes no 
sense for me to work on this anymore until the developers respond to my 
questions.

> http://forum.skype.com/index.php?showtopic=112021

I heard that the skype developers are very interested in getting skype 
working with pulseaudio, even helped tisting some patches. I have gotten 
skype to work with pulseaudio, I think if you apply the second patch 
attached to alsa bug #2601 skype will work. I haven't looked at the code 
since because apparently nobody from the alsa team is interested in 
fixing the bug.

tom


From scott at open-vote.org  Tue Mar 18 17:02:35 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Tue, 18 Mar 2008 15:02:35 -0700
Subject: SoC page insurrection! Idea details needed, please read.
In-Reply-To: <a71bd89a0803180033r70a59ccatd14d11de179be174@mail.gmail.com>
References: <a71bd89a0803180033r70a59ccatd14d11de179be174@mail.gmail.com>
Message-ID: <47E03BFB.80706@open-vote.org>

Dan Kegel wrote:
> Looking at our Summer of Code ideas page,
> I realized it was getting dense and unruly,
> so I and Maarten moved it off to the side
> and did a simpler one; see
> http://wiki.winehq.org/SummerOfCode
> 
> The DirectX stuff in particular could use some
> more detail; could the knowledgeable people flesh it out?
> 
> Also each idea should probably have a sponsor
> the students could turn to for ideas.  I've put a
> few obvious ones in, but it'd be nice if each one
> was claimed.
> 
> Thanks,
> Dan
> 
> 
Unfortunately I am unable to sponsor my own idea (Case-insensitive
FUSE), since I'm not too involved with Wine's C code.

Could someone else please volunteer to mentor the project if it gets
accepted by Google?

Thanks,
Scott Ritchie


From winehacker at gmail.com  Tue Mar 18 17:57:21 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 18 Mar 2008 17:57:21 -0500
Subject: SoC page insurrection! Idea details needed, please read.
In-Reply-To: <47E03BFB.80706@open-vote.org>
References: <a71bd89a0803180033r70a59ccatd14d11de179be174@mail.gmail.com>
	<47E03BFB.80706@open-vote.org>
Message-ID: <19e31a080803181557t462e0bf8w489336aeff9b24f4@mail.gmail.com>

On Tue, Mar 18, 2008 at 5:02 PM, Scott Ritchie <scott at open-vote.org> wrote:
>  Unfortunately I am unable to sponsor my own idea (Case-insensitive
>  FUSE), since I'm not too involved with Wine's C code.
>
>  Could someone else please volunteer to mentor the project if it gets
>  accepted by Google?

If anyone takes this up, we might see about expanding it to include
better support for FUSE iso mounted filesystems. Currently when you
use fuse to mount an iso image, you have to manually configure a fake
drive letter. It would be nice if we could query the loaded fuse
module for a listing of mounted iso images and automatically create
fake cdrom devices.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Tue Mar 18 18:01:05 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 16:01:05 -0700
Subject: Wine wiki cleanup
Message-ID: <a71bd89a0803181601m3b4be848mdab24b14a76b19eb@mail.gmail.com>

Over time, the Wine wiki front page grew rather unwieldy,
so I split the developer information off into two new pages,
leaving only a simplified front page behind,
mostly aimed at users.

It's radically simpler.  Hopefully it'll be more welcoming to new users.

Comments?


From dank at kegel.com  Tue Mar 18 18:07:35 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 16:07:35 -0700
Subject: Bugzilla request: add new milestone 1.2.0
Message-ID: <a71bd89a0803181607u698cd1c4obf5efad1902474cf@mail.gmail.com>

Ping.  I need this so I can start deferring 1.0 bugs to 1.2.
(Deferring them to 1.1 doesn't make a whole lot
of sense.)


From dank at kegel.com  Tue Mar 18 18:10:42 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 16:10:42 -0700
Subject: Appdb request: allow browsing for downloadable platinum apps
Message-ID: <a71bd89a0803181610w12d2c53fq880a301ab110b8ea@mail.gmail.com>

The appdb has a "browse by rating" and a "browse downloadable"
option, but there's no way to combine them.

Can we add a 'downloadable' checkbox in the 'browse by rating'
page, maybe?


From wine.dev at web.de  Tue Mar 18 18:09:19 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Wed, 19 Mar 2008 00:09:19 +0100
Subject: ntoskrnl.exe: Implement MmIsAddressValid (bug 11082)
In-Reply-To: <200803171746.33498.chris.kcat@gmail.com>
References: <1205795360.17905.4.camel@p4>
	<200803171746.33498.chris.kcat@gmail.com>
Message-ID: <1205881759.7976.10.camel@p4>

On Mo, 2008-03-17 at 16:46 -0800, Chris Robinson wrote:
> On Monday 17 March 2008 04:09:20 pm Detlef Riekenberg wrote:
> > +        (info.Protect & (PAGE_READWRITE || PAGE_EXECUTE_READWRITE)) &&
> 
> Did you mean | instead of || there?

Opps.

Will resend. Thanks for your hint.

-- 
 
By by ... Detlef




From ead1234 at hotmail.com  Tue Mar 18 18:17:22 2008
From: ead1234 at hotmail.com (EA Durbin)
Date: Tue, 18 Mar 2008 18:17:22 -0500
Subject: Appdb request: allow browsing for downloadable platinum apps
In-Reply-To: <a71bd89a0803181610w12d2c53fq880a301ab110b8ea@mail.gmail.com>
References: <a71bd89a0803181610w12d2c53fq880a301ab110b8ea@mail.gmail.com>
Message-ID: <BAY128-W2DFC75BCB3934BCF06E05AB060@phx.gbl>


Eventually when I get more time I'd like to scrap the browse_by_rating page and browse_newest and create a dynamic query page that allows for multiple custom queries like application type, rating, age of application, etc. And I'd like to see the screenshots page with links by letter, since they are sorted alphabetically, list A B C D E 0-9, etc., or an option to sort screenshots by application type, say "games" so you can find them easier.

----------------------------------------
> Date: Tue, 18 Mar 2008 16:10:42 -0700
> From: dank at kegel.com
> To: wine-devel at winehq.org
> Subject: Appdb request: allow browsing for downloadable platinum apps
> 
> The appdb has a "browse by rating" and a "browse downloadable"
> option, but there's no way to combine them.
> 
> Can we add a 'downloadable' checkbox in the 'browse by rating'
> page, maybe?
> 
> 

_________________________________________________________________
Climb to the top of the charts!?Play the word scramble challenge with star power.
http://club.live.com/star_shuffle.aspx?icid=starshuffle_wlmailtextlink_jan

From wine.dev at web.de  Tue Mar 18 18:22:29 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Wed, 19 Mar 2008 00:22:29 +0100
Subject: ntoskrnl.exe: Implement MmIsAddressValid (bug 11082)
In-Reply-To: <016e01c88894$be6b0080$a600fea9@DMITRY>
References: <1205795360.17905.4.camel@p4>
	<016e01c88894$be6b0080$a600fea9@DMITRY>
Message-ID: <1205882549.7976.22.camel@p4>

On Di, 2008-03-18 at 09:09 +0800, Dmitry Timoshkov wrote:
> "Detlef Riekenberg" <wine.dev at web.de> wrote:
> 
> > +    len = VirtualQuery(VirtualAddress, &info, sizeof(MEMORY_BASIC_INFORMATION));
> > +
> > +    if ((len == sizeof(MEMORY_BASIC_INFORMATION)) && 
> > +        (info.Protect & (PAGE_READWRITE || PAGE_EXECUTE_READWRITE)) &&
> > +        ((info.Protect & PAGE_NOACCESS) == 0) &&
> > +        (info.Type & MEM_COMMIT))
> > +    {
> > +        return TRUE;
> > +    }
> 
> Besides the already pointed out '||' vs. '|' mismatch your code doesn't
> handle PAGE_READONLY and others implying read-only access. Probably checking
> for PAGE_NOACCESS and MEM_COMMIT should be enough.

This is not enough, since PAGE_READONLY will Pagefault on Write.
>From OSR, the result is only TRUE, when the Address does not pagefault
on read or write access:
http://www.osronline.com/DDKx/kmarch/k106_3vle.htm

Thanks for your review.

-- 
 
By by ... Detlef




From austinenglish at gmail.com  Tue Mar 18 20:41:06 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 18 Mar 2008 20:41:06 -0500
Subject: Wine wiki cleanup
In-Reply-To: <a71bd89a0803181601m3b4be848mdab24b14a76b19eb@mail.gmail.com>
References: <a71bd89a0803181601m3b4be848mdab24b14a76b19eb@mail.gmail.com>
Message-ID: <b6bb06270803181841s11d47e9dpcc7403100d366ace@mail.gmail.com>

On Tue, Mar 18, 2008 at 6:01 PM, Dan Kegel <dank at kegel.com> wrote:
> Over time, the Wine wiki front page grew rather unwieldy,
>  so I split the developer information off into two new pages,
>  leaving only a simplified front page behind,
>  mostly aimed at users.
>
>  It's radically simpler.  Hopefully it'll be more welcoming to new users.
>
>  Comments?
>
>
>

Ahh, that's much nicer. I'd thought about doing that a week or two
ago, but then got busy with other things.


From dank at kegel.com  Tue Mar 18 20:22:57 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 18:22:57 -0700
Subject: cygwin runs!
Message-ID: <a71bd89a0803181822y1b687239o84aee2b308fc34a4@mail.gmail.com>

Hey!  Cygwin actually installs and runs inside Wine!
There are a few problems (gcc can't compile
"hello, world" yet, symlinks like the one for vi
don't work yet, the setup utility doesn't
resize properly, and mkpasswd -l aborts), but the shell starts up fine
and vim runs inside it!

Hats off to the Wine team!
- Dan


From tehblunderbuss at gmail.com  Tue Mar 18 23:42:58 2008
From: tehblunderbuss at gmail.com (TheBlunderbuss)
Date: Tue, 18 Mar 2008 23:42:58 -0500
Subject: cygwin runs!
In-Reply-To: <a71bd89a0803181822y1b687239o84aee2b308fc34a4@mail.gmail.com>
References: <a71bd89a0803181822y1b687239o84aee2b308fc34a4@mail.gmail.com>
Message-ID: <47E099D2.2020407@gmail.com>

Dan Kegel wrote:
> Hey!  Cygwin actually installs and runs inside Wine!
> There are a few problems (gcc can't compile
> "hello, world" yet, symlinks like the one for vi
> don't work yet, the setup utility doesn't
> resize properly, and mkpasswd -l aborts), but the shell starts up fine
> and vim runs inside it!
>
> Hats off to the Wine team!
> - Dan

Sounds like a recipe for absurdity :D


From ivg231 at gmail.com  Wed Mar 19 01:46:07 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Wed, 19 Mar 2008 02:46:07 -0400
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803181426.23481.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171647.39614.stefan@codeweavers.com>
	<200803172229.30779.stefan@codeweavers.com>
	<200803181426.23481.stefan@codeweavers.com>
Message-ID: <47E0B6AF.9000406@gmail.com>

Stefan D?singer wrote:
> Hi,
>
> Given the past discussion, do you agree with the code now? Alexandre wants 
> your OKs before applying the patches.
>   

I am not familiar with the state table, atifs, or recent developments in 
the d3d codebase. That's why I suggested a diagram, so that everyone can 
understand the discussion. My concern is long-term maintainability of 
the shader API.  I think the problem is with the definition of "shader 
backend".

The original intent, and the way it's currently used is:
    "A backend for the d3d shader pipeline ("d3d shader backend"), which 
happens to be implemented using some kind of gl shader".

The way this patchset is heading is:
    "A (gl shader backend), which implements both d3d shader and ffp 
pipeline, depending on the circumstances, through a mixed api"

I don't mind sharing the GL shader code to implement FFP or D3D shader 
pipelines - whether it's ATIfs, ARBfp/ARBvp, GLSL, or some other thing 
providing the implementation.  What I do mind is sharing that code 
through the same API for both the FFP and D3D pipeline codepaths. This 
leads to combining APIs that don't belong together, and odd multiplexing 
like you have in patch 004 - forcing the shader path through atifs, even 
though atifs currently doesn't support handling shaders properly, and 
has to "borrow code" from other backends, and implement routing to the 
right one based on what flags are set.

Why do you need to reroute the shader path through atifs to support an 
unrelated set of functionality (ffp replacement)? Isn't it possible to 
have an ffp_backend, and a shader_backend (shader being the d3d shader), 
and you can implement both differently, with different APIs?

Ivan





From dimi at lattica.com  Wed Mar 19 01:08:56 2008
From: dimi at lattica.com (Dimi Paun)
Date: Wed, 19 Mar 2008 02:08:56 -0400
Subject: cygwin runs!
In-Reply-To: <47E099D2.2020407@gmail.com>
References: <a71bd89a0803181822y1b687239o84aee2b308fc34a4@mail.gmail.com>
	<47E099D2.2020407@gmail.com>
Message-ID: <1205906936.6297.246.camel@dimi.lattica.com>

Dan Kegel wrote:
> Hey!  Cygwin actually installs and runs inside Wine!

This is way cool! Last time I've checked there were some
nasty problems, and I haven't seen the patches targeting
this problem.

So satisfying! :) 

Now, if we can get cygwin to run wine... <g>

-- 
Dimi Paun <dimi at lattica.com>
Lattica, Inc.



From chris.teague at gmail.com  Wed Mar 19 01:31:33 2008
From: chris.teague at gmail.com (Chris Teague)
Date: Tue, 18 Mar 2008 23:31:33 -0700
Subject: Version of Windows
Message-ID: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>

This is probably trivial, but I'm having a tough time figuring out the
current version of Windows that Wine is mimicking.  I have a situation
where I need to behave differently if the version is NT (0x0500)
versus when it is XP (0x0600).  I see the WINVER #define, but that
doesn't seem right to me since this must be a runtime variable.  Can
someone point me at an example of how to tell what the current version
of Windows is?  Thanks,
Chris


From xixsimplicityxix at gmail.com  Wed Mar 19 02:02:57 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 02:02:57 -0500
Subject: Version of Windows
In-Reply-To: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
References: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
Message-ID: <78a7dad00803190002rf99030dr17126d7c22760c94@mail.gmail.com>

On Wed, Mar 19, 2008 at 1:31 AM, Chris Teague <chris.teague at gmail.com> wrote:
> This is probably trivial, but I'm having a tough time figuring out the
>  current version of Windows that Wine is mimicking.  I have a situation
>  where I need to behave differently if the version is NT (0x0500)
>  versus when it is XP (0x0600).  I see the WINVER #define, but that
>  doesn't seem right to me since this must be a runtime variable.  Can
>  someone point me at an example of how to tell what the current version
>  of Windows is?  Thanks,
>  Chris
>
>
>

http://wiki.winehq.org/UsefulRegistryKeys

Search for Version


From xixsimplicityxix at gmail.com  Wed Mar 19 02:05:16 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 02:05:16 -0500
Subject: Version of Windows
In-Reply-To: <78a7dad00803190002rf99030dr17126d7c22760c94@mail.gmail.com>
References: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
	<78a7dad00803190002rf99030dr17126d7c22760c94@mail.gmail.com>
Message-ID: <78a7dad00803190005nc4735bfmd80b71ca81cd6d1b@mail.gmail.com>

On Wed, Mar 19, 2008 at 2:02 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>
> On Wed, Mar 19, 2008 at 1:31 AM, Chris Teague <chris.teague at gmail.com> wrote:
>  > This is probably trivial, but I'm having a tough time figuring out the
>  >  current version of Windows that Wine is mimicking.  I have a situation
>  >  where I need to behave differently if the version is NT (0x0500)
>  >  versus when it is XP (0x0600).  I see the WINVER #define, but that
>  >  doesn't seem right to me since this must be a runtime variable.  Can
>  >  someone point me at an example of how to tell what the current version
>  >  of Windows is?  Thanks,
>  >  Chris
>  >
>  >
>  >
>
>  http://wiki.winehq.org/UsefulRegistryKeys
>
>  Search for Version
>
More direct perhaps
http://source.winehq.org/git/wine.git/?a=blobdiff;f=tools/wine.inf;h=97a773533ec65020d175416852dae2cc4b6669ee;hp=cf4b7a026962efa47279d6d26a69918b62aaa36d;hb=f629dc4eb6006fbdc3f658d13186b9c7e08b189d;hpb=0e9d02ded40810272f8cf8dfc429f8d07e9e6fb9


From xixsimplicityxix at gmail.com  Wed Mar 19 03:07:45 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 03:07:45 -0500
Subject: Appdb nice urls: best way to test indexing of production data
Message-ID: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>

On my spring break and had some free time so I thought I'd take a shot
at implementing nice urls for the appdb that DanK had suggested a
while back.

I have decent bit of code in place that will interpret the url
http://appdb.winehq.org/app/what-you-want-here
and then feed the chunks into a hash table and return the match or
matches however it goes.

However indexing the large amount of data in the production appdb
database could take sometime so I was wanting to test it before I sent
my code in.

I was wondering if there was a way to download the data from the appdb?

--John Klehm


From meissner at suse.de  Wed Mar 19 04:20:21 2008
From: meissner at suse.de (Marcus Meissner)
Date: Wed, 19 Mar 2008 10:20:21 +0100
Subject: winex11.drv: Handle arbitrary length composed input.
In-Reply-To: <200803190916361590760006MAA6@nm06mta.auone-net.jp>
References: <200803190916361590760006MAA6@nm06mta.auone-net.jp>
Message-ID: <20080319092020.GA9675@suse.de>

On Wed, Mar 19, 2008 at 06:16:36PM +0900, Kusanagi Kouichi wrote:
> Fix bug #9838. http://bugs.winehq.org/show_bug.cgi?id=9838
> ---
>  dlls/winex11.drv/keyboard.c |   25 ++++++++++++++++---------
>  dlls/winex11.drv/xim.c      |   16 ++++++++++------
>  2 files changed, 26 insertions(+), 15 deletions(-)
> 
> diff --git a/dlls/winex11.drv/keyboard.c b/dlls/winex11.drv/keyboard.c
> index 33640db..386a471 100644
> --- a/dlls/winex11.drv/keyboard.c
> +++ b/dlls/winex11.drv/keyboard.c
> @@ -1365,22 +1365,29 @@ void X11DRV_KeyEvent( HWND hwnd, XEvent *xev )
>      wine_tsx11_lock();
>      /* Clients should pass only KeyPress events to XmbLookupString */
>      if (xic && event->type == KeyPress)
> +    {
>          ascii_chars = XmbLookupString(xic, event, Str, sizeof(Str), &keysym, &status);
> +
> +        if (status == XBufferOverflow)
> +        {
> +            char buf[ascii_chars];

You should not use dynamic sized arrays. Use HeapAlloc() to allocate them.

Ciao, Marcus


From julliard at winehq.org  Wed Mar 19 05:26:21 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 19 Mar 2008 11:26:21 +0100
Subject: [2/2] qmgr: Add a stub implementation of IBackgroundCopyJob2.
In-Reply-To: <20080319013102.GS4608@linux.ucla.edu> (Dan Hipschman's message
	of "Tue, 18 Mar 2008 18:31:02 -0700")
References: <20080319013102.GS4608@linux.ucla.edu>
Message-ID: <87d4pr80xe.fsf@wine.dyndns.org>

Dan Hipschman <dsh at linux.ucla.edu> writes:

> @@ -93,6 +93,10 @@ typedef struct
>      const IClassFactoryVtbl *lpVtbl;
>  } ClassFactoryImpl;
>  
> +/* This makes it easier to upgrade to IBackgroundCopyJob3, IBackgroundCopyJob4,
> +   and whatever else MS decides to tack on later.  */
> +typedef IBackgroundCopyJob2 BITS_IBackgroundCopyJob;

Please don't do that, vtable entries should use the correct types,
otherwise it will be very confusing. You'll just have to rename them
when switching to a newer version of the interface.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Wed Mar 19 05:31:40 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 19 Mar 2008 11:31:40 +0100
Subject: [Try 2] A nicer icon for msiexec
In-Reply-To: <799667.6943.qm@web25809.mail.ukl.yahoo.com> (=?utf-8?Q?=22He?=
	=?utf-8?Q?rv=C3=BFffffe9?=
	Chanal"'s message of "Tue, 18 Mar 2008 14:37:28 +0000 (GMT)")
References: <799667.6943.qm@web25809.mail.ukl.yahoo.com>
Message-ID: <878x0f80oj.fsf@wine.dyndns.org>

Herv?ffffe9 Chanal <chanal_herve at yahoo.fr> writes:

> It's a nicer icon for msiexec. From the last submit, several size are
> now included in the icon file. The icons are generated using a script
> i submitted to wine-patch a long time ago.  The svg source is not in
> this patch. I can submit it too.

Yes, we should include the svg source, and make sure we can rebuild the
icons from it. Last time I tried to do that using your script I didn't
get good results, the image was all mangled, so we need to look into
this further. Can you please resubmit the svg?

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Wed Mar 19 06:11:19 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 19 Mar 2008 12:11:19 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E0B6AF.9000406@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803181426.23481.stefan@codeweavers.com>
	<47E0B6AF.9000406@gmail.com>
Message-ID: <200803191211.19315.stefan@codeweavers.com>

Am Mittwoch, 19. M?rz 2008 07:46:07 schrieb Ivan Gyurdiev:
> Why do you need to reroute the shader path through atifs to support an
> unrelated set of functionality (ffp replacement)? Isn't it possible to
> have an ffp_backend, and a shader_backend (shader being the d3d shader),
> and you can implement both differently, with different APIs?
Sounds all great and cool, but: How do you handle a case of a d3d vertex 
shader + fixed function fragment processing using a GLSL shader replacement? 
An Uber-Shader-Backend that links the shaders together?

I can happily drop the strange routing through GLSL and the none shader 
backend for ATIFS, or with ARB pixel shaders enabled. In that case we'll just 
don't make use of it on ATI 9500+ cards until we have an ARB or GLSL 
replacement.


From stefan at codeweavers.com  Wed Mar 19 06:18:53 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 19 Mar 2008 12:18:53 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E0B6AF.9000406@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803181426.23481.stefan@codeweavers.com>
	<47E0B6AF.9000406@gmail.com>
Message-ID: <200803191218.53293.stefan@codeweavers.com>

Am Mittwoch, 19. M?rz 2008 07:46:07 schrieb Ivan Gyurdiev:
> The way this patchset is heading is:
>     "A (gl shader backend), which implements both d3d shader and ffp
> pipeline, depending on the circumstances, through a mixed api"
Yes, that's the only way that will work. The shader backend mutually talks to 
opengl, we have to design it around the requirements of the opengl 
(extension) APIs. Trying to stick the shader backend's design to d3d will not 
work properly

All in all we can only have a ffp replacement shader OR a d3d shader active. 
Some instance has to sort out what is active, and given that in GLSL we'll 
need to link vertex+fragment+geometry shaders the shader backend is the best 
place to find that out IMHO


From volker.groeschel at sap.com  Wed Mar 19 06:26:48 2008
From: volker.groeschel at sap.com (Groeschel, Volker)
Date: Wed, 19 Mar 2008 12:26:48 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
Message-ID: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>

The Patch points to wine-cvs. Shouldn't it point to wine-devel.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080319/69bdbf7d/attachment.htm 

From ken at codeweavers.com  Wed Mar 19 07:21:14 2008
From: ken at codeweavers.com (Ken Thomases)
Date: Wed, 19 Mar 2008 07:21:14 -0500
Subject: Maarten Lankhorst : winmm: Fix midi deadlock by not holding lock
	on release .
In-Reply-To: <E1JbbBJ-0005Pn-Lp@wine.codeweavers.com>
References: <E1JbbBJ-0005Pn-Lp@wine.codeweavers.com>
Message-ID: <91CE46D3-520F-4A92-85CC-8C086DEF8370@codeweavers.com>

This has a whiff of the double-checked locking anti-pattern.  I can't  
see a way where it would really bite us in this case, but that anti- 
pattern has several subtleties.  So, I just wanted to prompt people to  
double-check it (pun acknowledged).

Cheers,
Ken

On Mar 18, 2008, at 7:44 AM, Alexandre Julliard wrote:
> Module: wine
> Branch: master
> Commit: 15907b5035ea7f03b369a0463ab1f6ac2b24704e
> URL:    http://source.winehq.org/git/wine.git/?a=commit;h=15907b5035ea7f03b369a0463ab1f6ac2b24704e
>
> Author: Maarten Lankhorst <m.b.lankhorst at gmail.com>
> Date:   Mon Mar 17 13:15:42 2008 -0700
>
> winmm: Fix midi deadlock by not holding lock on release.
>
> ---
>
> dlls/winmm/mci.c |   22 ++++++++++++++--------
> 1 files changed, 14 insertions(+), 8 deletions(-)
>
> diff --git a/dlls/winmm/mci.c b/dlls/winmm/mci.c
> index b7b5ac2..c792d18 100644
> --- a/dlls/winmm/mci.c
> +++ b/dlls/winmm/mci.c
> @@ -1767,19 +1767,25 @@ static	DWORD MCI_Close(UINT16 wDevID, DWORD  
> dwParam, LPMCI_GENERIC_PARMS lpParms
>     TRACE("(%04x, %08X, %p)\n", wDevID, dwParam, lpParms);
>
>     if (wDevID == MCI_ALL_DEVICE_ID) {
> -	LPWINE_MCIDRIVER	next;
> -
> -	EnterCriticalSection(&WINMM_cs);
> 	/* FIXME: shall I notify once after all is done, or for
> 	 * each of the open drivers ? if the latest, which notif
> 	 * to return when only one fails ?
> 	 */
> -	for (wmd = MciDrivers; wmd; ) {
> -	    next = wmd->lpNext;
> -	    MCI_Close(wmd->wDeviceID, dwParam, lpParms);
> -	    wmd = next;
> +	while (MciDrivers) {
> +            /* Retrieve the device ID under lock, but send the  
> message without,
> +             * the driver might be calling some winmm functions  
> from another
> +             * thread before being fully stopped.
> +             */
> +            EnterCriticalSection(&WINMM_cs);
> +            if (!MciDrivers)
> +            {
> +                LeaveCriticalSection(&WINMM_cs);
> +                break;
> +            }
> +            wDevID = MciDrivers->wDeviceID;
> +            LeaveCriticalSection(&WINMM_cs);
> +            MCI_Close(wDevID, dwParam, lpParms);
> 	}
> -	LeaveCriticalSection(&WINMM_cs);
> 	return 0;
>     }
>
>
>
>



From ivg231 at gmail.com  Wed Mar 19 08:19:02 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Wed, 19 Mar 2008 09:19:02 -0400
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803191211.19315.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803181426.23481.stefan@codeweavers.com>
	<47E0B6AF.9000406@gmail.com>
	<200803191211.19315.stefan@codeweavers.com>
Message-ID: <47E112C6.1010205@gmail.com>

Stefan D?singer wrote:
> Am Mittwoch, 19. M?rz 2008 07:46:07 schrieb Ivan Gyurdiev:
>   
>> Why do you need to reroute the shader path through atifs to support an
>> unrelated set of functionality (ffp replacement)? Isn't it possible to
>> have an ffp_backend, and a shader_backend (shader being the d3d shader),
>> and you can implement both differently, with different APIs?
>>     
> Sounds all great and cool, but: How do you handle a case of a d3d vertex 
> shader + fixed function fragment processing using a GLSL shader replacement? 
> An Uber-Shader-Backend that links the shaders together?
>
> I can happily drop the strange routing through GLSL and the none shader 
> backend for ATIFS, or with ARB pixel shaders enabled. In that case we'll just 
> don't make use of it on ATI 9500+ cards until we have an ARB or GLSL 
> replacement.
>   

I'll get back to you on that later tonight, need to think about this 
some more - way late for work right now... (thanks to you!)
 
However, yes, I think there needs to be distinction between a standalone 
shader concept, and a pipeline concept, which is concerned with linking 
several multifunctional shaders together - your "uber-shader-backend".  
Lack of distinction on this point is causing all this confusion.

Ivan






From mstefani at redhat.com  Wed Mar 19 07:28:46 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 19 Mar 2008 13:28:46 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>
Message-ID: <47E106FE.2080404@redhat.com>

Groeschel, Volker wrote:
> The Patch points to wine-cvs. Shouldn't it point to wine-devel.
It points to wine-devel.

bye
	michael


From rob at codeweavers.com  Wed Mar 19 07:36:04 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 19 Mar 2008 12:36:04 +0000
Subject: Version of Windows
In-Reply-To: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
References: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
Message-ID: <47E108B4.4080903@codeweavers.com>

Chris Teague wrote:
> This is probably trivial, but I'm having a tough time figuring out the
> current version of Windows that Wine is mimicking.  I have a situation
> where I need to behave differently if the version is NT (0x0500)
> versus when it is XP (0x0600).  I see the WINVER #define, but that
> doesn't seem right to me since this must be a runtime variable.  Can
> someone point me at an example of how to tell what the current version
> of Windows is?  Thanks,
>   

Errm, GetVersion()?

If you're a developer for a Windows application it is a much better 
policy to check for features rather than checking the Windows version, 
since that feature may be implemented in a later service pack for that 
version of Windows.

-- 
Rob Shearman



From volker.groeschel at sap.com  Wed Mar 19 07:38:46 2008
From: volker.groeschel at sap.com (Groeschel, Volker)
Date: Wed, 19 Mar 2008 13:38:46 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <47E106FE.2080404@redhat.com>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>
	<47E106FE.2080404@redhat.com>
Message-ID: <1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>

>> Groeschel, Volker wrote:
>> The Patch points to wine-cvs. Shouldn't it point to wine-devel.
> Stefaniuc, Michael  wrote:
> It points to wine-devel.
> 
> bye
>     michael

No, it doesn't.
<A HREF="http://www.winehq.org/mailman/listinfo/wine-cvs">wine-devel at
winehq.org</A>


From rob at codeweavers.com  Wed Mar 19 07:38:30 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 19 Mar 2008 12:38:30 +0000
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>
Message-ID: <47E10946.9010800@codeweavers.com>

Groeschel, Volker wrote:
> The Patch points to wine-cvs. Shouldn't it point to wine-devel.

Not in the version of the patch I'm looking at:
>              if (! is_tablet_cursor(target->name, device_type))
>              {
> -                WARN("Skipping device %d [name %s|type %s]; not apparently a tablet cursor type device.  If this is wrong, please report to http://forums.winehq.org\n",
> +                WARN("Skipping device %d [name %s|type %s]; not apparently a tablet cursor type device.  If this is wrong, please report it to wine-devel at winehq.org\n",
>                       loop, devices[loop].name, device_type ? device_type : "");
>                  XFree(device_type);
>                  cursor_target --;
>   

-- 
Rob Shearman



From susancragin at earthlink.net  Wed Mar 19 08:03:27 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Wed, 19 Mar 2008 09:03:27 -0400 (GMT-04:00)
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
Message-ID: <14934900.1205931808148.JavaMail.root@elwamui-huard.atl.sa.earthlink.net>

Wine has two bugs filed for this also:
http://bugs.winehq.org/show_bug.cgi?id=10495
http://bugs.winehq.org/show_bug.cgi?id=10910
I am worried that everyone (WINE, ALSA, Pulse, Ubuntu) is not on the same page. Will try cross-posting bug information. 
Part of the problem seems to be that the most-missed application is Skype, and some are trying to get away with blaming closed-source issues. 
Tom -- I should include the link to your patch, yes, so that other developers have access to it?
Susan
Dan -- What do you think? Good idea?

-----Original Message-----
>From: Tomas Carnecky <tom at dbservice.com>
>Sent: Mar 18, 2008 5:14 PM
>To: Susan Cragin <susancragin at earthlink.net>
>Cc: wine-devel at winehq.org
>Subject: Re: Hardy Heron -- Pulseaudio interferes with non-gnome audio
>
>Susan Cragin wrote:
>> The new default pulseaudio in Hardy screws up every program that isn't gnome, delivering terrible sound. 
>> https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
>
>Applications that use ALSA should work fine with the alsa pulse plugin - 
>  should. Unfortunately the plugin has a few bugs, and the developers 
>(of both pulseaudio and alsa) have been unresponsive in this matter. See
>  - http://www.pulseaudio.org/ticket/198
>  - https://bugtrack.alsa-project.org/alsa-bug/view.php?id=2601
>
>> Question -- what does WINE do with pulseaudio?
>
>Some suggested to create a native PulseAudio wine driver. That would 
>yield the best results as far as the performance and reliability goes. 
>Unfortunately we'll be stuck with the alsa driver for some time to come, 
>so I tried to do the best to make the alsa pulse plugin to work with 
>wine. I had to patch both the wine alsa driver as well as the alsa pulse 
>plugin and it worked fine for my taste.
>
>I submitted the patch to wine-patches:
>http://www.winehq.org/pipermail/wine-patches/2008-February/050561.html
>
>I don't know if the relevant alsa pulse plugin patch is publicly 
>available, I haven't looked at that matter in a long time. Some of the 
>needed patches are probably still in my local repositories. It makes no 
>sense for me to work on this anymore until the developers respond to my 
>questions.
>
>> http://forum.skype.com/index.php?showtopic=112021
>
>I heard that the skype developers are very interested in getting skype 
>working with pulseaudio, even helped tisting some patches. I have gotten 
>skype to work with pulseaudio, I think if you apply the second patch 
>attached to alsa bug #2601 skype will work. I haven't looked at the code 
>since because apparently nobody from the alsa team is interested in 
>fixing the bug.
>
>tom





From mstefani at redhat.com  Wed Mar 19 08:14:41 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 19 Mar 2008 14:14:41 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>
Message-ID: <47E111C1.3010001@redhat.com>

Groeschel, Volker wrote:
>>> Groeschel, Volker wrote:
>>> The Patch points to wine-cvs. Shouldn't it point to wine-devel.
>> Stefaniuc, Michael  wrote:
>> It points to wine-devel.
>>
>
> No, it doesn't.
> <A HREF="http://www.winehq.org/mailman/listinfo/wine-cvs">wine-devel at
> winehq.org</A>
At what are you looking at? The only email in wine-cvs with the Subject
"Alexandre Julliard : winex11: Fix bug report address" is this commit
http://source.winehq.org/git/wine.git/?a=commit;h=075df1b609d283c5d0b83a3e1b9bd48e53cb5b74
and the diff
http://source.winehq.org/git/wine.git/?a=commitdiff;h=075df1b609d283c5d0b83a3e1b9bd48e53cb5b74;hp=2cab7ff2c7a11563436e014e2affc73987039bf6
shows only this:
+                WARN("Skipping device %d [name %s|type %s]; not
apparently a tablet cursor type device.  If this is wrong, please report
it to wine-devel at winehq.org\n",

I cannot see any wine-cvs in there.

bye
	michael
-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Hauptst?tter Strasse 58, 70178 Stuttgart
Handelsregister: Amtsgericht Stuttgart HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                 Werner Knoblich


From volker.groeschel at sap.com  Wed Mar 19 08:26:27 2008
From: volker.groeschel at sap.com (Groeschel, Volker)
Date: Wed, 19 Mar 2008 14:26:27 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <47E111C1.3010001@redhat.com>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>
	<47E111C1.3010001@redhat.com>
Message-ID: <1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>

I apologize I was not looking in the diff but in the wine-cvs message
http://www.winehq.org/pipermail/wine-cvs/2008-March/041392.html

There it points to wine-cvs. 

I don't know where this difference comes from.


From volker.groeschel at sap.com  Wed Mar 19 08:34:26 2008
From: volker.groeschel at sap.com (Groeschel, Volker)
Date: Wed, 19 Mar 2008 14:34:26 +0100
Subject: : Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <47E111C1.3010001@redhat.com>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>
	<47E111C1.3010001@redhat.com>
Message-ID: <1DE958D0164F8043BB57265BB40ACDF7A036D5@dewdfe16.wdf.sap.corp>

But wouldn't be http://www.winehq.org/mailman/listinfo/wine-devel better
than wine-devel at winehq.org?

I just quote: "Note: You should be subscribed to the lists before you
post to them, otherwise your posting will be treated as possible spam by
the mailing list software."


From mstefani at redhat.com  Wed Mar 19 08:33:32 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 19 Mar 2008 14:33:32 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>
	<47E111C1.3010001@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>
Message-ID: <47E1162C.9040400@redhat.com>

Groeschel, Volker wrote:
> I apologize I was not looking in the diff but in the wine-cvs message
> http://www.winehq.org/pipermail/wine-cvs/2008-March/041392.html
> 
> There it points to wine-cvs. 
> 
> I don't know where this difference comes from.
The list archives obfuscate email addresses, adds links, etc. It looks
like the website is translating wine-devel at redhat.com to "wine-devel at
winehq.org" but adds a link to the wrong list archives.

Jeremy, do you want a bugzilla entry against the website for that?

bye
	michael


From paul.vriens.wine at gmail.com  Wed Mar 19 08:34:44 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 19 Mar 2008 14:34:44 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>	<47E111C1.3010001@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>
Message-ID: <47E11674.5050909@gmail.com>

Groeschel, Volker wrote:
> I apologize I was not looking in the diff but in the wine-cvs message
> http://www.winehq.org/pipermail/wine-cvs/2008-March/041392.html
> 
> There it points to wine-cvs. 
> 
> I don't know where this difference comes from.
> 
> 
> 
It's pipermail obfuscating the email addresses. (Same is true if you hover over 
"julliard at winehq.org").

-- 
Cheers,

Paul.


From mstefani at redhat.com  Wed Mar 19 08:40:12 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 19 Mar 2008 14:40:12 +0100
Subject: : Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A036D5@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>	<47E111C1.3010001@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A036D5@dewdfe16.wdf.sap.corp>
Message-ID: <47E117BC.1070700@redhat.com>

Groeschel, Volker wrote:
> But wouldn't be http://www.winehq.org/mailman/listinfo/wine-devel better
> than wine-devel at winehq.org?
> 
> I just quote: "Note: You should be subscribed to the lists before you
> post to them, otherwise your posting will be treated as possible spam by
> the mailing list software."
No, you cannot report it to
http://www.winehq.org/mailman/listinfo/wine-devel as that are the read
only archives. wine-devel has moderators and the emails from not
subscribed people make it through though delayed. For a person reporting
an one time problem that is ok to not be subscribed.

bye
	michael


From jnewman at codeweavers.com  Wed Mar 19 09:24:56 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Wed, 19 Mar 2008 09:24:56 -0500
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <47E1162C.9040400@redhat.com>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>
	<47E111C1.3010001@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>
	<47E1162C.9040400@redhat.com>
Message-ID: <47E12238.2030004@codeweavers.com>

IMO, a better place to file a bug would be with the mailman devs. My 
policy is to try to keep with un-patched packages from Debian stable.

I can manually fix the archives though.

Michael Stefaniuc wrote:
> Groeschel, Volker wrote:
>> I apologize I was not looking in the diff but in the wine-cvs message
>> http://www.winehq.org/pipermail/wine-cvs/2008-March/041392.html
>>
>> There it points to wine-cvs. 
>>
>> I don't know where this difference comes from.
> The list archives obfuscate email addresses, adds links, etc. It looks
> like the website is translating wine-devel at redhat.com to "wine-devel at
> winehq.org" but adds a link to the wrong list archives.
> 
> Jeremy, do you want a bugzilla entry against the website for that?
> 
> bye
> 	michael


From mstefani at redhat.com  Wed Mar 19 09:40:11 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 19 Mar 2008 15:40:11 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <47E12238.2030004@codeweavers.com>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>	<47E111C1.3010001@redhat.com>	<1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>	<47E1162C.9040400@redhat.com>
	<47E12238.2030004@codeweavers.com>
Message-ID: <47E125CB.9040808@redhat.com>

Jeremy Newman wrote:
> IMO, a better place to file a bug would be with the mailman devs. My 
Huh? This looks to me like a configuration problem and not a mailman
bug. I doubt that mailman knows on it's own to expand
wine-devel at redhat.com to:
<A HREF="http://www.winehq.org/mailman/listinfo/wine-cvs">wine-devel at
winehq.org</A>

bye
	michael

> policy is to try to keep with un-patched packages from Debian stable.
> I can manually fix the archives though.
> 
> Michael Stefaniuc wrote:
>> Groeschel, Volker wrote:
>>> I apologize I was not looking in the diff but in the wine-cvs message
>>> http://www.winehq.org/pipermail/wine-cvs/2008-March/041392.html
>>>
>>> There it points to wine-cvs. 
>>>
>>> I don't know where this difference comes from.
>> The list archives obfuscate email addresses, adds links, etc. It looks
>> like the website is translating wine-devel at redhat.com to "wine-devel at
>> winehq.org" but adds a link to the wrong list archives.
>>
>> Jeremy, do you want a bugzilla entry against the website for that?


-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Hauptst?tter Strasse 58, 70178 Stuttgart
Handelsregister: Amtsgericht Stuttgart HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                 Werner Knoblich


From wine-devel at kievinfo.com  Wed Mar 19 09:56:32 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 19 Mar 2008 08:56:32 -0600
Subject: winex11drv: Distinguish left and right keys for shift, ctrl and
	alt.   (try 4)
In-Reply-To: <47DE0C9D.1010008@kievinfo.com>
References: <47DE0C9D.1010008@kievinfo.com>
Message-ID: <47E129A0.2090604@kievinfo.com>

Vitaliy Margolen wrote:
> This time with lots of tests that exposed number of other problems that 
> were fixed.
> 
> I could not separate this patch into separate pieces - they all linked 
> together and
> fixing one problem meant fixing or breaking something else. This 
> especially related
> to the tests that test everything together as a one black box.
> 
> There are still few problems remain that could be exposed by tightening 
> tests.
> ---

Anything wrong with this patch?
Vitaliy


From fgouget at free.fr  Wed Mar 19 09:59:56 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 19 Mar 2008 15:59:56 +0100 (CET)
Subject: The Linux/BSD DF kernel bug
Message-ID: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>


So I've just read the following article:

   GCC 4.3.0 exposes a kernel bug
   http://lwn.net/SubscriberLink/272048/ecf14f359bcdcd15/

And my question is: could this be relevant to Wine?
And I don't mean about GCC 4.3.0 but about MSVC.

Here's the core of the issue:

   The problem revolves around the x86 direction flag (DF), which 
   governs whether block memory operations operate forward through 
   memory or backwards. GCC [...] 4.3.0, assumes that the direction flag 
   has been cleared [...] at the entry of each function, as is specified 
   by the ABI [...] Prior to 4.3, GCC would emit a cld (clear direction 
   flag) opcode before doing inline string or memory operations.

So any compiler that not clear the direction flag at the start of each 
function can cause kernel crashes when running on a buggy Linux or BSD 
kernel.

So the questions are:

Does anyone know if MSVC does a cld in the right places?

What about other popular compilers used to compile Windows 
applications?

Mac OS X being (loosely) based on the BSD kernels, does it have 
this issue too?

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
          tcA thgirypoC muinelliM latigiD eht detaloiv tsuj evah uoY


From dank at kegel.com  Wed Mar 19 10:04:50 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 19 Mar 2008 08:04:50 -0700
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
In-Reply-To: <14934900.1205931808148.JavaMail.root@elwamui-huard.atl.sa.earthlink.net>
References: <14934900.1205931808148.JavaMail.root@elwamui-huard.atl.sa.earthlink.net>
Message-ID: <a71bd89a0803190804o3039dbc0s691feb948c8b73f9@mail.gmail.com>

On Wed, Mar 19, 2008 at 6:03 AM, Susan Cragin <susancragin at earthlink.net> wrote:
> Wine has two bugs filed for this also:
>  http://bugs.winehq.org/show_bug.cgi?id=10495
>  http://bugs.winehq.org/show_bug.cgi?id=10910
>  I am worried that everyone (WINE, ALSA, Pulse, Ubuntu) is not on the same page. Will try cross-posting bug information.
>  Part of the problem seems to be that the most-missed application is Skype, and some are trying to get away with blaming closed-source issues.
>  Tom -- I should include the link to your patch, yes, so that other developers have access to it?
>  Susan
>  Dan -- What do you think? Good idea?

Could be that a wiki page is the best way to provide a central rallying point
between two projects on an issue like this.

Really, though, the answer is for Wine to have a native pulse audio driver.
Maarten said he met somebody in IRC who is almost done with
one.  I do wish he would decloak...
- Dan


From fgouget at free.fr  Wed Mar 19 10:06:34 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 19 Mar 2008 16:06:34 +0100 (CET)
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
Message-ID: <alpine.DEB.1.00.0803191605180.32540@amboise.dolphin>

On Wed, 19 Mar 2008, Francois Gouget wrote:
[...]
> So any compiler that not clear the direction flag at the start of each 
> function can cause kernel crashes when running on a buggy Linux or BSD kernel.
                     ^^^^^^
                     remove

Sorry, it's just regular application crashes, not kernel crashes. It 
would still be interesting to know if that can impact Wine.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
     The software said it requires Win95 or better, so I installed Linux.


From zgold550 at gmail.com  Wed Mar 19 10:16:58 2008
From: zgold550 at gmail.com (Zachary Goldberg)
Date: Wed, 19 Mar 2008 11:16:58 -0400
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
Message-ID: <b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>

On Wed, Mar 19, 2008 at 4:07 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> On my spring break and had some free time so I thought I'd take a shot
>  at implementing nice urls for the appdb that DanK had suggested a
>  while back.
>
>  I have decent bit of code in place that will interpret the url
>  http://appdb.winehq.org/app/what-you-want-here
>  and then feed the chunks into a hash table and return the match or
>  matches however it goes.
>
>  However indexing the large amount of data in the production appdb
>  database could take sometime so I was wanting to test it before I sent
>  my code in.
>
>  I was wondering if there was a way to download the data from the appdb?
>
>  --John Klehm
>
>
>

I do this every week for the WWN to generate the status changes.

$file = "$year$mon$mday.tar.gz";
`wget -O appdb/wine-appdb-$file
ftp://ftp.winehq.org/pub/wine/wine-appdb-$file `;



-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From julliard at winehq.org  Wed Mar 19 10:18:43 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 19 Mar 2008 16:18:43 +0100
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
In-Reply-To: <a71bd89a0803190804o3039dbc0s691feb948c8b73f9@mail.gmail.com>
	(Dan Kegel's message of "Wed, 19 Mar 2008 08:04:50 -0700")
References: <14934900.1205931808148.JavaMail.root@elwamui-huard.atl.sa.earthlink.net>
	<a71bd89a0803190804o3039dbc0s691feb948c8b73f9@mail.gmail.com>
Message-ID: <87iqzi7ne4.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> Could be that a wiki page is the best way to provide a central rallying point
> between two projects on an issue like this.
>
> Really, though, the answer is for Wine to have a native pulse audio driver.

No, the right answer is to make the Alsa driver work right. We need to
stop rushing out to write a new driver every time there's a problem with
an existing one, all it leads to is more broken drivers.

-- 
Alexandre Julliard
julliard at winehq.org


From vostok at etersoft.ru  Wed Mar 19 10:26:03 2008
From: vostok at etersoft.ru (Anatoly Lyutin)
Date: Wed, 19 Mar 2008 18:26:03 +0300
Subject: wine.inf: Add "ShowMenuDelay" value
In-Reply-To: <47E12EC5.3060707@etersoft.ru>
References: <47E12EC5.3060707@etersoft.ru>
Message-ID: <47E1308B.9020008@etersoft.ru>

Anatoly Lyutin wrote:
> Changelog:
>    Add "ShowMenuDelay" value
Ooooops!
Right changelog:


Changelog:
 Add "MenuShowDelay" value.


-- 
Best regards
	Anatoly Lyutin.



From julliard at winehq.org  Wed Mar 19 10:28:55 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 19 Mar 2008 16:28:55 +0100
Subject: winex11drv: Distinguish left and right keys for shift,
	ctrl and alt.   (try 4)
In-Reply-To: <47E129A0.2090604@kievinfo.com> (Vitaliy Margolen's message of
	"Wed, 19 Mar 2008 08:56:32 -0600")
References: <47DE0C9D.1010008@kievinfo.com> <47E129A0.2090604@kievinfo.com>
Message-ID: <87abku7mx4.fsf@wine.dyndns.org>

Vitaliy Margolen <wine-devel at kievinfo.com> writes:

> Anything wrong with this patch?

The message patching inside peek_message looks very wrong, I have a hard
time believing that this is really where this should happen. It most
likely belongs somewhere like process_keyboard_message.

-- 
Alexandre Julliard
julliard at winehq.org


From xixsimplicityxix at gmail.com  Wed Mar 19 10:31:11 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 10:31:11 -0500
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
Message-ID: <78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>

On Wed, Mar 19, 2008 at 10:16 AM, Zachary Goldberg <zgold550 at gmail.com> wrote:
>
> On Wed, Mar 19, 2008 at 4:07 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  >  I was wondering if there was a way to download the data from the appdb?
>  >
>  >  --John Klehm
>  >
>
>  I do this every week for the WWN to generate the status changes.
>
>  $file = "$year$mon$mday.tar.gz";
>  `wget -O appdb/wine-appdb-$file
>  ftp://ftp.winehq.org/pub/wine/wine-appdb-$file `;
>

Thanks! =)


From susancragin at earthlink.net  Wed Mar 19 10:45:09 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Wed, 19 Mar 2008 11:45:09 -0400 (GMT-04:00)
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
Message-ID: <27071618.1205941509502.JavaMail.root@elwamui-hybrid.atl.sa.earthlink.net>

But wait! There are more! Alsa people tell me they have one for Ekiga. Gnome has one, too.
https://bugtrack.alsa-project.org/alsa-bug/view.php?id=3825
http://bugzilla.gnome.org/show_bug.cgi?id=413552
I think a wiki page is a great idea, and I'll set one up later on http://ossri.harvee.org


-----Original Message-----
>From: Susan Cragin <susancragin at earthlink.net>
>Sent: Mar 19, 2008 9:03 AM
>To: Wine Developers <wine-devel at winehq.org>
>Cc: Dan Kegel <dank06 at kegel.com>
>Subject: Re: Hardy Heron -- Pulseaudio interferes with non-gnome audio
>
>Wine has two bugs filed for this also:
>http://bugs.winehq.org/show_bug.cgi?id=10495
>http://bugs.winehq.org/show_bug.cgi?id=10910
>I am worried that everyone (WINE, ALSA, Pulse, Ubuntu) is not on the same page. Will try cross-posting bug information. 
>Part of the problem seems to be that the most-missed application is Skype, and some are trying to get away with blaming closed-source issues. 
>Tom -- I should include the link to your patch, yes, so that other developers have access to it?
>Susan
>Dan -- What do you think? Good idea?
>
>-----Original Message-----
>>From: Tomas Carnecky <tom at dbservice.com>
>>Sent: Mar 18, 2008 5:14 PM
>>To: Susan Cragin <susancragin at earthlink.net>
>>Cc: wine-devel at winehq.org
>>Subject: Re: Hardy Heron -- Pulseaudio interferes with non-gnome audio
>>
>>Susan Cragin wrote:
>>> The new default pulseaudio in Hardy screws up every program that isn't gnome, delivering terrible sound. 
>>> https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
>>
>>Applications that use ALSA should work fine with the alsa pulse plugin - 
>>  should. Unfortunately the plugin has a few bugs, and the developers 
>>(of both pulseaudio and alsa) have been unresponsive in this matter. See
>>  - http://www.pulseaudio.org/ticket/198
>>  - https://bugtrack.alsa-project.org/alsa-bug/view.php?id=2601
>>
>>> Question -- what does WINE do with pulseaudio?
>>
>>Some suggested to create a native PulseAudio wine driver. That would 
>>yield the best results as far as the performance and reliability goes. 
>>Unfortunately we'll be stuck with the alsa driver for some time to come, 
>>so I tried to do the best to make the alsa pulse plugin to work with 
>>wine. I had to patch both the wine alsa driver as well as the alsa pulse 
>>plugin and it worked fine for my taste.
>>
>>I submitted the patch to wine-patches:
>>http://www.winehq.org/pipermail/wine-patches/2008-February/050561.html
>>
>>I don't know if the relevant alsa pulse plugin patch is publicly 
>>available, I haven't looked at that matter in a long time. Some of the 
>>needed patches are probably still in my local repositories. It makes no 
>>sense for me to work on this anymore until the developers respond to my 
>>questions.
>>
>>> http://forum.skype.com/index.php?showtopic=112021
>>
>>I heard that the skype developers are very interested in getting skype 
>>working with pulseaudio, even helped tisting some patches. I have gotten 
>>skype to work with pulseaudio, I think if you apply the second patch 
>>attached to alsa bug #2601 skype will work. I haven't looked at the code 
>>since because apparently nobody from the alsa team is interested in 
>>fixing the bug.
>>
>>tom
>
>
>
>
>





From cesar at ecuarock.net  Wed Mar 19 10:54:23 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Wed, 19 Mar 2008 10:54:23 -0500
Subject: SoC page insurrection! Idea details needed, please read.
In-Reply-To: <19e31a080803181557t462e0bf8w489336aeff9b24f4@mail.gmail.com>
References: <a71bd89a0803180033r70a59ccatd14d11de179be174@mail.gmail.com>
	<47E03BFB.80706@open-vote.org>
	<19e31a080803181557t462e0bf8w489336aeff9b24f4@mail.gmail.com>
Message-ID: <e3d3ae8f0803190854n781b3edek471e09cf8ae5facb@mail.gmail.com>

I'm planning on applying for the FUSE project. I guess there are a lot
of possibilities on this area. I have some experience on implementing
FUSE filesystems with python and C. I'll post some ideas in a couple
of days.

On Tue, Mar 18, 2008 at 5:57 PM, Steven Edwards <winehacker at gmail.com> wrote:
> On Tue, Mar 18, 2008 at 5:02 PM, Scott Ritchie <scott at open-vote.org> wrote:
>  >  Unfortunately I am unable to sponsor my own idea (Case-insensitive
>  >  FUSE), since I'm not too involved with Wine's C code.
>  >
>  >  Could someone else please volunteer to mentor the project if it gets
>  >  accepted by Google?
>
>  If anyone takes this up, we might see about expanding it to include
>  better support for FUSE iso mounted filesystems. Currently when you
>  use fuse to mount an iso image, you have to manually configure a fake
>  drive letter. It would be nice if we could query the loaded fuse
>  module for a listing of mounted iso images and automatically create
>  fake cdrom devices.
>
>  --
>  Steven Edwards
>
>  "There is one thing stronger than all the armies in the world, and
>  that is an idea whose time has come." - Victor Hugo
>
>
>


From chmorgan at gmail.com  Wed Mar 19 10:55:47 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Wed, 19 Mar 2008 11:55:47 -0400
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
	<78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
Message-ID: <f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>

I can provide help with integrating the code with the appdb if you
have any questions. The real question I've got, since I haven't done
it before, is how to get the path the user specified, eg.
appdb.winehq.org/vendor/adobe (or whatever), into a php script so we
can redirect to the list of applications for the vendor 'adobe'.

Chris



On Wed, Mar 19, 2008 at 11:31 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> On Wed, Mar 19, 2008 at 10:16 AM, Zachary Goldberg <zgold550 at gmail.com> wrote:
>  >
>  > On Wed, Mar 19, 2008 at 4:07 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>
> >  >  I was wondering if there was a way to download the data from the appdb?
>  >  >
>  >  >  --John Klehm
>  >  >
>  >
>  >  I do this every week for the WWN to generate the status changes.
>  >
>  >  $file = "$year$mon$mday.tar.gz";
>  >  `wget -O appdb/wine-appdb-$file
>  >  ftp://ftp.winehq.org/pub/wine/wine-appdb-$file `;
>  >
>
>  Thanks! =)
>
>
>
>


From zgold550 at gmail.com  Wed Mar 19 11:01:49 2008
From: zgold550 at gmail.com (Zachary Goldberg)
Date: Wed, 19 Mar 2008 12:01:49 -0400
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
	<78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
	<f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
Message-ID: <b050a5e70803190901q18ba5851iffe1c5ed1bd2d714@mail.gmail.com>

On Wed, Mar 19, 2008 at 11:55 AM, Chris Morgan <chmorgan at gmail.com> wrote:
> I can provide help with integrating the code with the appdb if you
>  have any questions. The real question I've got, since I haven't done
>  it before, is how to get the path the user specified, eg.
>  appdb.winehq.org/vendor/adobe (or whatever), into a php script so we
>  can redirect to the list of applications for the vendor 'adobe'.
>
>  Chris
>
>
Is

$_SERVER["REQUEST_URI"];

what your looking for?



>
>
>
>  On Wed, Mar 19, 2008 at 11:31 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  > On Wed, Mar 19, 2008 at 10:16 AM, Zachary Goldberg <zgold550 at gmail.com> wrote:
>  >  >
>  >  > On Wed, Mar 19, 2008 at 4:07 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  >
>  > >  >  I was wondering if there was a way to download the data from the appdb?
>  >  >  >
>  >  >  >  --John Klehm
>  >  >  >
>  >  >
>  >  >  I do this every week for the WWN to generate the status changes.
>  >  >
>  >  >  $file = "$year$mon$mday.tar.gz";
>  >  >  `wget -O appdb/wine-appdb-$file
>  >  >  ftp://ftp.winehq.org/pub/wine/wine-appdb-$file `;
>  >  >
>  >
>  >  Thanks! =)
>  >
>  >
>  >
>  >
>



-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From chmorgan at gmail.com  Wed Mar 19 11:12:58 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Wed, 19 Mar 2008 12:12:58 -0400
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <b050a5e70803190901q18ba5851iffe1c5ed1bd2d714@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
	<78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
	<f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
	<b050a5e70803190901q18ba5851iffe1c5ed1bd2d714@mail.gmail.com>
Message-ID: <f3f1b91a0803190912s332b8273r8b9081461dd16990@mail.gmail.com>

Yep, I'm aware of that server parameter.

So the idea would be to add code to appdb.winehq.org/index.php and
look at REQUEST_URI for a particular format and redirect based on
that? That sounds feasible.

Chris


On Wed, Mar 19, 2008 at 12:01 PM, Zachary Goldberg <zgold550 at gmail.com> wrote:
> On Wed, Mar 19, 2008 at 11:55 AM, Chris Morgan <chmorgan at gmail.com> wrote:
>  > I can provide help with integrating the code with the appdb if you
>  >  have any questions. The real question I've got, since I haven't done
>  >  it before, is how to get the path the user specified, eg.
>  >  appdb.winehq.org/vendor/adobe (or whatever), into a php script so we
>  >  can redirect to the list of applications for the vendor 'adobe'.
>  >
>  >  Chris
>  >
>  >
>  Is
>
>  $_SERVER["REQUEST_URI"];
>
>  what your looking for?
>
>
>
>
>  >
>  >
>  >
>  >  On Wed, Mar 19, 2008 at 11:31 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  >  > On Wed, Mar 19, 2008 at 10:16 AM, Zachary Goldberg <zgold550 at gmail.com> wrote:
>  >  >  >
>  >  >  > On Wed, Mar 19, 2008 at 4:07 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  >  >
>  >  > >  >  I was wondering if there was a way to download the data from the appdb?
>  >  >  >  >
>  >  >  >  >  --John Klehm
>  >  >  >  >
>  >  >  >
>  >  >  >  I do this every week for the WWN to generate the status changes.
>  >  >  >
>  >  >  >  $file = "$year$mon$mday.tar.gz";
>  >  >  >  `wget -O appdb/wine-appdb-$file
>  >  >  >  ftp://ftp.winehq.org/pub/wine/wine-appdb-$file `;
>  >  >  >
>  >  >
>  >  >  Thanks! =)
>  >  >
>  >  >
>  >  >
>  >  >
>  >
>
>
>
>
>
> --
>  Zachary Goldberg
>  Computer Science & Engineering
>  Electrical Captain of Penn Electric Race Team
>  School of Engineering at the University of Pennsylvania
>
>


From xixsimplicityxix at gmail.com  Wed Mar 19 11:12:59 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 11:12:59 -0500
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
	<78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
	<f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
Message-ID: <78a7dad00803190912m451f3548k796d837b6a2963d8@mail.gmail.com>

On Wed, Mar 19, 2008 at 10:55 AM, Chris Morgan <chmorgan at gmail.com> wrote:
> I can provide help with integrating the code with the appdb if you
>  have any questions. The real question I've got, since I haven't done
>  it before, is how to get the path the user specified, eg.
>  appdb.winehq.org/vendor/adobe (or whatever), into a php script so we
>  can redirect to the list of applications for the vendor 'adobe'.
>
>  Chris
>
>
>


Well that did take a bit for me to work out as well here is what is
working for me on my apache 2.2.8

You have to have allowoveride Options in the parent conf files and then

filename: htdocs/appdb/.htaccess
RewriteEngine On
Options FollowSymLinks # need this as well as RewriteEngine On to
acutally get it going
RewriteBase /appdb/
RewriteRule ^app/(.*)$ matchAppByName.php?AppName=$1



This will let you have:  $1 is matched by the part of the url that is
not matched by http://hostname.com/appb/app/

e.g. appdb/app/adobe-photoshop-cs2
Results in matchAppByName.php?AppName=adobe-photoshop-cs2

I'm not adverse to help with appdb whatever gets it solved more quickly =)

Be careful when choosing your rewritebase as its more important than
you'd think =P

Hope this helps,
John


From chmorgan at gmail.com  Wed Mar 19 11:15:19 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Wed, 19 Mar 2008 12:15:19 -0400
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <78a7dad00803190912m451f3548k796d837b6a2963d8@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
	<78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
	<f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
	<78a7dad00803190912m451f3548k796d837b6a2963d8@mail.gmail.com>
Message-ID: <f3f1b91a0803190915y233e9783yd7c7f15b568abd8e@mail.gmail.com>

On Wed, Mar 19, 2008 at 12:12 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> On Wed, Mar 19, 2008 at 10:55 AM, Chris Morgan <chmorgan at gmail.com> wrote:
>  > I can provide help with integrating the code with the appdb if you
>  >  have any questions. The real question I've got, since I haven't done
>  >  it before, is how to get the path the user specified, eg.
>  >  appdb.winehq.org/vendor/adobe (or whatever), into a php script so we
>  >  can redirect to the list of applications for the vendor 'adobe'.
>  >
>  >  Chris
>  >
>  >
>  >
>
>
>  Well that did take a bit for me to work out as well here is what is
>  working for me on my apache 2.2.8
>
>  You have to have allowoveride Options in the parent conf files and then
>
>  filename: htdocs/appdb/.htaccess
>  RewriteEngine On
>  Options FollowSymLinks # need this as well as RewriteEngine On to
>  acutally get it going
>  RewriteBase /appdb/
>  RewriteRule ^app/(.*)$ matchAppByName.php?AppName=$1
>
>
>
>  This will let you have:  $1 is matched by the part of the url that is
>  not matched by http://hostname.com/appb/app/
>
>  e.g. appdb/app/adobe-photoshop-cs2
>  Results in matchAppByName.php?AppName=adobe-photoshop-cs2
>
>  I'm not adverse to help with appdb whatever gets it solved more quickly =)
>
>  Be careful when choosing your rewritebase as its more important than
>  you'd think =P
>
>  Hope this helps,
>  John
>

Right, this makes more sense. Checking REQUEST_URI in index.php won't
work because the path given won't match an existing page so you'll get
the 404 page instead.

Chris


From xixsimplicityxix at gmail.com  Wed Mar 19 11:44:07 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 11:44:07 -0500
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <f3f1b91a0803190915y233e9783yd7c7f15b568abd8e@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
	<78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
	<f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
	<78a7dad00803190912m451f3548k796d837b6a2963d8@mail.gmail.com>
	<f3f1b91a0803190915y233e9783yd7c7f15b568abd8e@mail.gmail.com>
Message-ID: <78a7dad00803190944h5b06e988h4405ae46c9c36413@mail.gmail.com>

On Wed, Mar 19, 2008 at 11:15 AM, Chris Morgan <chmorgan at gmail.com> wrote:
>
> On Wed, Mar 19, 2008 at 12:12 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  > On Wed, Mar 19, 2008 at 10:55 AM, Chris Morgan <chmorgan at gmail.com> wrote:
>  >  > I can provide help with integrating the code with the appdb if you
>  >  >  have any questions. The real question I've got, since I haven't done
>  >  >  it before, is how to get the path the user specified, eg.
>  >  >  appdb.winehq.org/vendor/adobe (or whatever), into a php script so we
>  >  >  can redirect to the list of applications for the vendor 'adobe'.
>  >  >
>  >  >  Chris

If it is desirable for winehq.org/appdb/show/verb/term (allows for
appdb.winehq.org/show/vender appdb.winehq.org/show/app
winehq.org/show/catagory) then this works for me:

RewriteEngine On
Options FollowSymLinks
RewriteBase /appdb/
#RewriteRule ^app/(.*)$ matchAppByName.php?AppName=$1
RewriteRule ^show/([a-zA-Z]+)/(.*)$ matchByVerbAndTerm.php?verb=$1&term=$2

E.g
appdb.winehq.org/show/vendor/adobe
=> matchByVerbAndTerm.php?verb=vendor&term=adobe

appdb.winehq.org/show/app/adobe-photoshop-cs2
=> matchByVerbAndTerm.php?verb=app&term=adobe-photoshop-cs2

Regards,
John


From msclrhd at googlemail.com  Wed Mar 19 02:12:01 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 19 Mar 2008 07:12:01 +0000
Subject: Version of Windows
In-Reply-To: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
References: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
Message-ID: <3f4fd2640803190012l5c8f7b57j4b9700df1683857c@mail.gmail.com>

On 19/03/2008, Chris Teague <chris.teague at gmail.com> wrote:
> This is probably trivial, but I'm having a tough time figuring out the
>  current version of Windows that Wine is mimicking.  I have a situation
>  where I need to behave differently if the version is NT (0x0500)
>  versus when it is XP (0x0600).  I see the WINVER #define, but that
>  doesn't seem right to me since this must be a runtime variable.  Can
>  someone point me at an example of how to tell what the current version
>  of Windows is?  Thanks,

Wine does not use the WINVER, or other associated version defines when
building a project - it automatically uses the latest Windows version
(although the API exposed may be incomplete due to missing functions).

Programatically, you can use GetVersionEx
[http://msdn2.microsoft.com/en-us/library/ms724451.aspx] to determine
the version of Windows at runtime in your program, although Microsoft
recommend using VerifyVersionInfo (see
[http://msdn2.microsoft.com/en-us/library/ms725491(VS.85).aspx] for an
example of its usage).

To change the version in Wine you can use winecfg (the 'Windows
Version' property on the 'Applications' tab).

HTH,
- Reece


From msclrhd at googlemail.com  Wed Mar 19 03:35:24 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 19 Mar 2008 08:35:24 +0000
Subject: Tests marked as todo are not displayed on the web results.
Message-ID: <3f4fd2640803190135icaac467q79f7bc3ee50e4c9f@mail.gmail.com>

Hi,

If you look at the output for a set of test results (e.g.
http://test.winehq.org/data/200803181000/), it indicates whether
particular tests need work on Wine. This is a great addition and works
very well... however, if you navigate to the information about that
test (e.g. http://test.winehq.org/data/200803181000/wine_xp_0.9.57-274-g5e463ac/gdiplus:graphicspath.txt),
you don't see what tests are marked as todo.

For example, using the above, it results in:

gdiplus:graphicspath start dlls/gdiplus/tests/graphicspath.c 1.13
graphicspath: 198 tests executed (5 marked as todo, 0 failures), 0 skipped.
gdiplus:graphicspath done (0)

...so does not tell me which of the 5 tests are todo and which are ok.

I haven't checked to see if this is also an issue with the `make test` output.

- Reece


From msclrhd at googlemail.com  Wed Mar 19 03:47:57 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 19 Mar 2008 08:47:57 +0000
Subject: [RFC] Improving the summary results on test.winehq.org
Message-ID: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>

Hi,

Looking at the results from a test run (e.g.
http://test.winehq.org/data/200803181000/), it would be nice to have:

    1.  A summary of a dlls overall results (i.e. the summation of all
its unit test results), preferably before the individual tests, but
could live with them at the bottom.

    2.  A summary of the entire test results (i.e. the summation of
all unit test results for all dlls). This would be best at the top
where it is easily visible.

    3.  Possibly display the number of tests run in a given pass (e.g.
0/12 or 1+3/27). This is to give an idea of how many tests have been
run easily (especially for the dll and overall summaries).

The idea is to get a quick idea of the health of the test results for
each operating system and dll.

- Reece


From volker.groeschel at sap.com  Wed Mar 19 06:09:22 2008
From: volker.groeschel at sap.com (Groeschel, Volker)
Date: Wed, 19 Mar 2008 12:09:22 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
Message-ID: <1DE958D0164F8043BB57265BB40ACDF7A03591@dewdfe16.wdf.sap.corp>

The Patch points to wine-cvs. Shouldn't it point to wine-devel.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080319/c124f521/attachment.htm 

From ian at ianmacfarlane.com  Wed Mar 19 09:01:54 2008
From: ian at ianmacfarlane.com (Ian Macfarlane)
Date: Wed, 19 Mar 2008 14:01:54 +0000
Subject: Wine1.0 and LGPLv3?
Message-ID: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>

Just to resurrect this topic, as last time, of the responses to my email,
two were positive (and the other just pointed out that I'd mistaken the
Samba licensing for LGPL instead of GPL) but nothing else happened after
that.

Seeing as Wine is officially going to be having a 1.0 in the not too distant
future, this would seem like the ideal time to introduce a license change (
e.g. Samba went to GPLv3 along with a version jump). I remember the WineConf
2007 presentation PDF from Alexandre mentioned it as a "post-1.0"
possibility - it would seem to me that 1.0 would in fact be the ideal time
to make such a change - being able to say "anything pre-1.0 is LGPLv2+ and
anything 1.0+ is LGPLv3+" is quite nice and is easy to understand.

LGPLv3 has a lot of benefits over the previous version (see my previous
email below), some of which are particularly pertinent given Microsoft's
attitude towards it (e.g. in the Novell agreement that led to a third draft
of the GPL, Wine would seem to be excluded from the patent protection
agreement - see http://tinyurl.com/25at6e).

It would be great to have a decision made on this - personally, I can't see
any reason why LGPLv3 would be detrimental to WINE (for example, I can't see
any reason CodeWeavers would dislike any of the new provisions, which mostly
target troll companies), and numerous reasons why it would be a good thing.

Ian Macfarlane

ps: Here's the email I sent about this some time back, but with the bits
about Samba and Solaris snipped out:

On 7/13/07, Ian Macfarlane <ian at ianmacfarlane.com> wrote:
>
> I've been meaning to ask about this since (L)GPL3 was released.
>
> The version 3 of the (L)GPL license has numerous benefits:
>
> - It's much more legally sound in the rest of the world (IMO one of
> the most important factors about the new license) - numerous reasons
> for this e.g. referencing WIPO rather than US laws.
>
> - It has an explicit patent agreement (really an extension of the
> above - (L)GPLv2 has an implicit patent agreement, but this is only
> valid in the US) - this means that people who contribute to and/or
> distribute WINE cannot sue WINE (or WINE users) for patent
> infringement.
>
> - It is compatible with the Apache 2.0 license, meaning that there is
> an even bigger pool of source code to draw from.
>
> - It helps ensure that companies cannot prevent people from modifying
> the source code by providing them explicit legal rights to change the
> code in these circumstances, and requiring information to allow users
> to change it.
>
> - For LGPL only, It makes 100% sure that GPL+linking exception and
> LGPL can be combined legally in all jurisdictions by merging them
> (which is essentially the only real difference, barring slightly
> different wording in the v2.1 of LGPL vs v2. of GPL)
>
> - It prevents patent agreements where only some people are protected.
>
> - It provides a mechanism for first-time accidental violations to be
> 'cured' more easily
>
> - ... and lots of other minor changes to improve the validity of the
> legal status of the license.


<snip>

So as you can see, (L)GPL version 3 has a lot of benefits. It also has
> broad support (excluding Linus of course, who I must point out objects
> only to a single clause in the license that can be resolved by adding
> an extra permission, as GPLv3 permits), including strong corporate
> backing (e.g. IBM, Red Hat, MySQL, Sun, even Novell). As one of the
> projects that Microsoft would most like to destroy, the added
> protections in this updated version of the license would seem even
> more valuable.
>
> Kind regards,
>
>
> Ian Macfarlane
>
>
> ps: As a last note to Damjan - all GPL versions have been considered
> both radical and political when they were released. In retrospect, the
> protections that they provided have been considered invaluable.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080319/6427820e/attachment.htm 

From xixsimplicityxix at gmail.com  Wed Mar 19 14:33:23 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 14:33:23 -0500
Subject: [RFC] Improving the summary results on test.winehq.org
In-Reply-To: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>
References: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>
Message-ID: <78a7dad00803191233o757b22f5oe91940b3ae8bc3d3@mail.gmail.com>

On Wed, Mar 19, 2008 at 3:47 AM, Reece Dunn <msclrhd at googlemail.com> wrote:
>
>     3.  Possibly display the number of tests run in a given pass (e.g.
>  0/12 or 1+3/27). This is to give an idea of how many tests have been
>  run easily (especially for the dll and overall summaries).
>
>  The idea is to get a quick idea of the health of the test results for
>  each operating system and dll.
>

You mouse over any of the results and it will give you the number of tests.

--John


From paul.vriens.wine at gmail.com  Wed Mar 19 14:37:25 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 19 Mar 2008 20:37:25 +0100
Subject: [RFC] Improving the summary results on test.winehq.org
In-Reply-To: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>
References: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>
Message-ID: <47E16B75.2070308@gmail.com>

Reece Dunn wrote:
> Hi,
> 
> Looking at the results from a test run (e.g.
> http://test.winehq.org/data/200803181000/), it would be nice to have:
> 
>     1.  A summary of a dlls overall results (i.e. the summation of all
> its unit test results), preferably before the individual tests, but
> could live with them at the bottom.
> 
>     2.  A summary of the entire test results (i.e. the summation of
> all unit test results for all dlls). This would be best at the top
> where it is easily visible.
> 
>     3.  Possibly display the number of tests run in a given pass (e.g.
> 0/12 or 1+3/27). This is to give an idea of how many tests have been
> run easily (especially for the dll and overall summaries).
> 
> The idea is to get a quick idea of the health of the test results for
> each operating system and dll.
> 
> - Reece
> 
> 
I think Francois already put a lot of these on his todo list:

http://www.winehq.org/pipermail/wine-devel/2008-March/063641.html

Cheers,

Paul.


From mstefani at redhat.com  Wed Mar 19 14:55:42 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 19 Mar 2008 20:55:42 +0100
Subject: Wine1.0 and LGPLv3?
In-Reply-To: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>
References: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>
Message-ID: <47E16FBE.3080207@redhat.com>

Ian Macfarlane wrote:
> Just to resurrect this topic, as last time, of the responses to my
> email, two were positive (and the other just pointed out that I'd
> mistaken the Samba licensing for LGPL instead of GPL) but nothing else
> happened after that.
> 
> Seeing as Wine is officially going to be having a 1.0 in the not too
> distant future, this would seem like the ideal time to introduce a
Quite the contrary, this is the worst time to introduce a license change
as it drags developer time into unnecessary license discussion.

> license change (e.g. Samba went to GPLv3 along with a version jump). I
> remember the WineConf 2007 presentation PDF from Alexandre mentioned it
Right, we discussed the issue at the Wine conference and there was 1
vote to move to LGPL v3. The rest didn't care and prefer to stay with
the existing LGPL v2 until there is a compelling reason to move to v3.

> as a "post-1.0" possibility - it would seem to me that 1.0 would in fact
> be the ideal time to make such a change - being able to say "anything
> pre-1.0 is LGPLv2+ and anything 1.0+ is LGPLv3+" is quite nice and is
> easy to understand.
Wine 1.0 should have been the X11 license ... ;)


bye
	michael

> LGPLv3 has a lot of benefits over the previous version (see my previous
> email below), some of which are particularly pertinent given Microsoft's
> attitude towards it (e.g. in the Novell agreement that led to a third
> draft of the GPL, Wine would seem to be excluded from the patent
> protection agreement - see http://tinyurl.com/25at6e).
> 
> It would be great to have a decision made on this - personally, I can't
> see any reason why LGPLv3 would be detrimental to WINE (for example, I
> can't see any reason CodeWeavers would dislike any of the new
> provisions, which mostly target troll companies), and numerous reasons
> why it would be a good thing.
> 
> Ian Macfarlane
> 
> ps: Here's the email I sent about this some time back, but with the bits
> about Samba and Solaris snipped out:
> 
> On 7/13/07, *Ian Macfarlane* <ian at ianmacfarlane.com
> <mailto:ian at ianmacfarlane.com>> wrote:
> 
>     I've been meaning to ask about this since (L)GPL3 was released.
> 
>     The version 3 of the (L)GPL license has numerous benefits:
> 
>     - It's much more legally sound in the rest of the world (IMO one of
>     the most important factors about the new license) - numerous reasons
>     for this e.g. referencing WIPO rather than US laws.
> 
>     - It has an explicit patent agreement (really an extension of the
>     above - (L)GPLv2 has an implicit patent agreement, but this is only
>     valid in the US) - this means that people who contribute to and/or
>     distribute WINE cannot sue WINE (or WINE users) for patent
>     infringement.
> 
>     - It is compatible with the Apache 2.0 license, meaning that there is
>     an even bigger pool of source code to draw from.
> 
>     - It helps ensure that companies cannot prevent people from modifying
>     the source code by providing them explicit legal rights to change the
>     code in these circumstances, and requiring information to allow users
>     to change it.
> 
>     - For LGPL only, It makes 100% sure that GPL+linking exception and
>     LGPL can be combined legally in all jurisdictions by merging them
>     (which is essentially the only real difference, barring slightly
>     different wording in the v2.1 of LGPL vs v2. of GPL)
> 
>     - It prevents patent agreements where only some people are protected.
> 
>     - It provides a mechanism for first-time accidental violations to be
>     'cured' more easily
> 
>     - ... and lots of other minor changes to improve the validity of the
>     legal status of the license.
> 
> 
> <snip>
> 
>     So as you can see, (L)GPL version 3 has a lot of benefits. It also has
>     broad support (excluding Linus of course, who I must point out objects
>     only to a single clause in the license that can be resolved by adding
>     an extra permission, as GPLv3 permits), including strong corporate
>     backing (e.g. IBM, Red Hat, MySQL, Sun, even Novell). As one of the
>     projects that Microsoft would most like to destroy, the added
>     protections in this updated version of the license would seem even
>     more valuable.
> 
>     Kind regards,
> 
> 
>     Ian Macfarlane
> 
> 
>     ps: As a last note to Damjan - all GPL versions have been considered
>     both radical and political when they were released. In retrospect, the
>     protections that they provided have been considered invaluable.




From dank at kegel.com  Wed Mar 19 15:05:48 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 19 Mar 2008 13:05:48 -0700
Subject: "winefix" - interesting wrapper for wine
In-Reply-To: <471D0065.3010603@open-vote.org>
References: <a71bd89a0710220320h26570f27q1eb3f3b301c176ad@mail.gmail.com>
	<471D0065.3010603@open-vote.org>
Message-ID: <a71bd89a0803191305t7f1954c5h73542e0f65ae02bb@mail.gmail.com>

On Mon, Oct 22, 2007 at 12:56 PM, Scott Ritchie <scott at open-vote.org> wrote:
> Dan Kegel wrote:
>  > Tom W. found and publicized a script called "winefix" by
>  > an ubuntu forums user named "deadlydeathcone":
>  > http://digg.com/linux_unix/Winefix_improved_desktop_integration_for_Wine
>  > http://wine-review.blogspot.com/2007/10/winefix-improved-desktop-integration.html
>  > http://ubuntuforums.org/showthread.php?s=6e904c1df87d3fd1698ab5d7bbdbf664&t=533257
>  >
>  > It's got a bunch of interesting stuff.
>  > I wonder if we could get him to join wine-devel and start
>  > contributing to wine itself...
>  >
>  Yeah, it's very strange that he just came out of nowhere.  I found out
>  about his script through Digg.
>
>  I'm gonna spend some time this week dissecting it and seeing what we can
>  put right into the Wine package.

Did you ever get around to this?  This came up again today in
https://answers.launchpad.net/ubuntu/+source/wine/+question/26260
- Dan


From m.b.lankhorst at gmail.com  Wed Mar 19 15:09:26 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 19 Mar 2008 13:09:26 -0700
Subject: Summer of code and bidi
Message-ID: <b130c85e0803191309y60476f14u2135bca9d3d4ce83@mail.gmail.com>

Hi Shachar,

I've removed the bi-directional entry from summer of code. I don't
think it is a good project because it involves a lot of changes in
pretty much all wine user controls. The only way to do this would be
by using the pango library to do the laying out of text, but I'm not
even sure whether that is a good summer of code idea, since it would
need someone already very experienced with the plumbing of wine.

Maarten.


From dank at kegel.com  Wed Mar 19 14:58:38 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 19 Mar 2008 12:58:38 -0700
Subject: Splitting wine wiki FAQ (was: Wine wiki cleanup)
Message-ID: <a71bd89a0803191258j45e3135egefcaf54d67047757@mail.gmail.com>

On Wed, Mar 19, 2008 at 10:40 AM, Jim <wineforum-user at winehq.org> wrote:
>  Should we do this for the FAQ as well?  I mean:
>
>          Make a separate developer DeveloperFaq (WikiName)
>
>          Move developer related topics from FAQ to DeveloperFAQ
>
>          Add question to FAQ "Where is the Developer FAQ?" to FAQ.  -OR- Possibly not as a FAQ question but a very visible Note at the top.  "Developers see DeveloperFaq"
>
>  A shorter FAQ may look less intimidating to lazy readers thus encouraging more readers and possibly fewer "noob" questions on the list.

Sounds good to me!

I'm cc'ing wine-devel; if nobody objects by Friday, go ahead and do it.
- Dan


From shachar at shemesh.biz  Wed Mar 19 15:45:17 2008
From: shachar at shemesh.biz (Shachar Shemesh)
Date: Wed, 19 Mar 2008 22:45:17 +0200
Subject: Summer of code and bidi
In-Reply-To: <b130c85e0803191309y60476f14u2135bca9d3d4ce83@mail.gmail.com>
References: <b130c85e0803191309y60476f14u2135bca9d3d4ce83@mail.gmail.com>
Message-ID: <47E17B5D.2040802@shemesh.biz>

Maarten Lankhorst wrote:

> Hi Shachar,
>
> I've removed the bi-directional entry from summer of code. I don't
> think it is a good project because it involves a lot of changes in
> pretty much all wine user controls.
Actually, I don't think any touching of the actual user controls is 
involved at all. I think the first bullet (which can be all we want for 
this year) only really involves the ExtTextOut function, as well as the 
Uniscribe functions. No user controls are touched at all.
>  The only way to do this would be
> by using the pango library to do the laying out of text,
I was about to say that the code is practically already there, but I 
really think you should know that, being how it was you who put it there 
:-). I really think that if we came this far, we had better split the 
Unicode algorithm into the components it requires and put it into 
Uniscribe. I don't think we need any reliance on external libraries 
(pango, fribidi, or any other) for that.
>  but I'm not
> even sure whether that is a good summer of code idea, since it would
> need someone already very experienced with the plumbing of wine.
>   
It would require someone to learn the BiDi algorithm and the Uniscribe 
interface, but the reason I offered to mentor it was precisely so that 
the student not have to follow the entire Wine structure. I really don't 
believe this task is heavier than some of the Direct3D stuff on that page.
> Maarten.
>   
Just MHO

Shachar


From m.b.lankhorst at gmail.com  Wed Mar 19 16:31:21 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 19 Mar 2008 14:31:21 -0700
Subject: Summer of code and bidi
In-Reply-To: <47E17B5D.2040802@shemesh.biz>
References: <b130c85e0803191309y60476f14u2135bca9d3d4ce83@mail.gmail.com>
	<47E17B5D.2040802@shemesh.biz>
Message-ID: <b130c85e0803191431o47a92bafjd4feb74ffbaa8367@mail.gmail.com>

Hello,

2008/3/19, Shachar Shemesh <shachar at shemesh.biz>:
> Maarten Lankhorst wrote:
>
>  > Hi Shachar,
>  >
>  > I've removed the bi-directional entry from summer of code. I don't
>  > think it is a good project because it involves a lot of changes in
>  > pretty much all wine user controls.
>
> Actually, I don't think any touching of the actual user controls is
>  involved at all. I think the first bullet (which can be all we want for
>  this year) only really involves the ExtTextOut function, as well as the
>  Uniscribe functions. No user controls are touched at all.
I already did this work, exttextout relies on the reference bidi
implementation now. Took about 3 days to adapt the reference
implementation to wine. (dlls/gdi32/bidi.c)

> >  The only way to do this would be
>  > by using the pango library to do the laying out of text,
>
> I was about to say that the code is practically already there, but I
>  really think you should know that, being how it was you who put it there
>  :-). I really think that if we came this far, we had better split the
>  Unicode algorithm into the components it requires and put it into
>  Uniscribe. I don't think we need any reliance on external libraries
>  (pango, fribidi, or any other) for that.
There are all kinds of rules that tell how it work, a real rendering
engine is complicated to write, and since there are already a few
working, tried and tested engines out there we don't want to write our
own.

> >  but I'm not
>  > even sure whether that is a good summer of code idea, since it would
>  > need someone already very experienced with the plumbing of wine.
>  >
>
> It would require someone to learn the BiDi algorithm and the Uniscribe
>  interface, but the reason I offered to mentor it was precisely so that
>  the student not have to follow the entire Wine structure. I really don't
>  believe this task is heavier than some of the Direct3D stuff on that page.
As I said, bidi is already implemented. A real uniscribe algorythm is
something we want to depend on as external library, because a proper
engine would be huge and impossible to maintain/debug.

-Maarten.


From galeru at gmail.com  Wed Mar 19 17:01:38 2008
From: galeru at gmail.com (Corey McClymonds)
Date: Wed, 19 Mar 2008 18:01:38 -0400
Subject: Google Summer of Code Test Suite project
Message-ID: <63ee2bc70803191501u7c44c13cse73fdc59c76b6b1d@mail.gmail.com>

I would like to work on the Regression Suite project, but I'm not
quite sure of the scope.  Would I be choosing a good 30 or 40
applications that run well on wine, using wpkg to install them, and
then test for failures?  Because that would seem as though I am only
doing installer testing, instead of actual application testing.  I
would also like to do some sort of automated regression testing for
actual features you can easily test, if that would be possible.

Corey


From thestig at google.com  Wed Mar 19 17:10:16 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 19 Mar 2008 15:10:16 -0700
Subject: Google Summer of Code Test Suite project
In-Reply-To: <63ee2bc70803191501u7c44c13cse73fdc59c76b6b1d@mail.gmail.com>
References: <63ee2bc70803191501u7c44c13cse73fdc59c76b6b1d@mail.gmail.com>
Message-ID: <558b2f5c0803191510u12a5b2c8ma72f204a7bb38a5e@mail.gmail.com>

On Wed, Mar 19, 2008 at 3:01 PM, Corey McClymonds <galeru at gmail.com> wrote:
> I would like to work on the Regression Suite project, but I'm not
>  quite sure of the scope.  Would I be choosing a good 30 or 40
>  applications that run well on wine, using wpkg to install them, and
>  then test for failures?  Because that would seem as though I am only
>  doing installer testing, instead of actual application testing.  I
>  would also like to do some sort of automated regression testing for
>  actual features you can easily test, if that would be possible.
>
>  Corey

Let's just say you're going to write an installer tester. How do you
define a failure? If you're  doing silent installers, do you just look
at the return value from the installer? If you installed app foo, and
the installer created file bar on Windows with a checksum of qux, but
not in Wine, does that count as a failure? How about if a registry key
is missing on Wine?


From galeru at gmail.com  Wed Mar 19 18:07:14 2008
From: galeru at gmail.com (Corey McClymonds)
Date: Wed, 19 Mar 2008 19:07:14 -0400
Subject: Google Summer of Code Test Suite project
In-Reply-To: <558b2f5c0803191510u12a5b2c8ma72f204a7bb38a5e@mail.gmail.com>
References: <63ee2bc70803191501u7c44c13cse73fdc59c76b6b1d@mail.gmail.com>
	<558b2f5c0803191510u12a5b2c8ma72f204a7bb38a5e@mail.gmail.com>
Message-ID: <63ee2bc70803191607o3c1739a9l3d8196701ae9e669@mail.gmail.com>

On 3/19/08, Lei Zhang <thestig at google.com> wrote:
> On Wed, Mar 19, 2008 at 3:01 PM, Corey McClymonds <galeru at gmail.com> wrote:
>  > I would like to work on the Regression Suite project, but I'm not
>  >  quite sure of the scope.  Would I be choosing a good 30 or 40
>  >  applications that run well on wine, using wpkg to install them, and
>  >  then test for failures?  Because that would seem as though I am only
>  >  doing installer testing, instead of actual application testing.  I
>  >  would also like to do some sort of automated regression testing for
>  >  actual features you can easily test, if that would be possible.
>  >
>  >  Corey
>
>
> Let's just say you're going to write an installer tester. How do you
>  define a failure? If you're  doing silent installers, do you just look
>  at the return value from the installer? If you installed app foo, and
>  the installer created file bar on Windows with a checksum of qux, but
>  not in Wine, does that count as a failure? How about if a registry key
>  is missing on Wine?
>

It depends if any functionality is lost.  You could argue that if
anything is different, then wine isn't implementing something
correctly, but I would be fine with it completing and working as
intended.  I would probably do checks on all 3 things you talked
about, and likely anything else that could be easily checked for by a
computer.


From austinenglish at gmail.com  Wed Mar 19 18:15:05 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 19 Mar 2008 18:15:05 -0500
Subject: Google Summer of Code Test Suite project
In-Reply-To: <63ee2bc70803191607o3c1739a9l3d8196701ae9e669@mail.gmail.com>
References: <63ee2bc70803191501u7c44c13cse73fdc59c76b6b1d@mail.gmail.com>
	<558b2f5c0803191510u12a5b2c8ma72f204a7bb38a5e@mail.gmail.com>
	<63ee2bc70803191607o3c1739a9l3d8196701ae9e669@mail.gmail.com>
Message-ID: <b6bb06270803191615w50428d95k81d6cb394dec861f@mail.gmail.com>

On Wed, Mar 19, 2008 at 6:07 PM, Corey McClymonds <galeru at gmail.com> wrote:
>
> On 3/19/08, Lei Zhang <thestig at google.com> wrote:
>  > On Wed, Mar 19, 2008 at 3:01 PM, Corey McClymonds <galeru at gmail.com> wrote:
>  >  > I would like to work on the Regression Suite project, but I'm not
>  >  >  quite sure of the scope.  Would I be choosing a good 30 or 40
>  >  >  applications that run well on wine, using wpkg to install them, and
>  >  >  then test for failures?  Because that would seem as though I am only
>  >  >  doing installer testing, instead of actual application testing.  I
>  >  >  would also like to do some sort of automated regression testing for
>  >  >  actual features you can easily test, if that would be possible.
>  >  >
>  >  >  Corey
>  >
>  >
>  > Let's just say you're going to write an installer tester. How do you
>  >  define a failure? If you're  doing silent installers, do you just look
>  >  at the return value from the installer? If you installed app foo, and
>  >  the installer created file bar on Windows with a checksum of qux, but
>  >  not in Wine, does that count as a failure? How about if a registry key
>  >  is missing on Wine?
>  >
>
>  It depends if any functionality is lost.  You could argue that if
>  anything is different, then wine isn't implementing something
>  correctly, but I would be fine with it completing and working as
>  intended.  I would probably do checks on all 3 things you talked
>  about, and likely anything else that could be easily checked for by a
>  computer.
>
>
>

Using a program like AutoHotkey to install a program and test its
features would be a better route IMHO.


From wine-devel at kievinfo.com  Wed Mar 19 18:18:46 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 19 Mar 2008 17:18:46 -0600
Subject: winex11drv: Distinguish left and right keys for shift, ctrl and
	alt.   (try 4)
In-Reply-To: <87abku7mx4.fsf@wine.dyndns.org>
References: <47DE0C9D.1010008@kievinfo.com> <47E129A0.2090604@kievinfo.com>
	<87abku7mx4.fsf@wine.dyndns.org>
Message-ID: <47E19F56.6000107@kievinfo.com>

Alexandre Julliard wrote:
> Vitaliy Margolen <wine-devel at kievinfo.com> writes:
> 
>> Anything wrong with this patch?
> 
> The message patching inside peek_message looks very wrong, I have a hard
> time believing that this is really where this should happen. It most
> likely belongs somewhere like process_keyboard_message.
> 
Thank you. I wasn't sure where it should go myself. The 
process_keyboard_message is the last in the chain place it can go in. Some 
simple tests showed that journal hook gets the normal VK_SHIFT not 
left/right shift.


From dank at kegel.com  Wed Mar 19 18:31:03 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 19 Mar 2008 16:31:03 -0700
Subject: Google Summer of Code Test Suite project
Message-ID: <a71bd89a0803191631j7a96bbc1m4452b48926f88c88@mail.gmail.com>

On Wed, Mar 19, 2008 at 3:01 PM, Corey McClymonds <galeru at gmail.com> wrote:
> I would like to work on the Regression Suite project, but I'm not
>  quite sure of the scope.  Would I be choosing a good 30 or 40
>  applications that run well on wine, using wpkg to install them, and
>  then test for failures?  Because that would seem as though I am only
>  doing installer testing, instead of actual application testing.

That would be fine for starters.

>  I
>  would also like to do some sort of automated regression testing for
>  actual features you can easily test, if that would be possible.

That would be icing on the cake.

Application testing is insanely difficult.  Even installer testing
is difficult to actually deliver.  I would prefer that you aim
to get a simple run-this-script-and-it-tests-N-installers
script working and in the wine developers' hot little
hands ASAP before you get fancy and try to make
it test more than just installs.  Because essentially
all efforts to do that in the past have failed.

Make sense?

FWIW, here's my first try at it from long ago.  It's a minimal little
script that just tests one app's installer.   I would prefer you
start with something this simple.
http://www.winehq.org/pipermail/wine-devel/2006-July/049913.html
Also, maybe you could make some use of Lei's yawt script,
http://code.google.com/p/yawt/
It's kind of overkill, but it takes care of comparing registry keys and files
created by the installer.
- Dan


From galeru at gmail.com  Wed Mar 19 21:04:17 2008
From: galeru at gmail.com (Corey McClymonds)
Date: Wed, 19 Mar 2008 22:04:17 -0400
Subject: wine-devel Digest, Vol 32, Issue 75
In-Reply-To: <mailman.3838.1205969477.3734.wine-devel@winehq.org>
References: <mailman.3838.1205969477.3734.wine-devel@winehq.org>
Message-ID: <63ee2bc70803191904y56bcbe92m597ab47d27cf1ca@mail.gmail.com>

> From: "Dan Kegel" <dank at kegel.com>
> To: "Wine Developers List" <wine-devel at winehq.org>
> Date: Wed, 19 Mar 2008 16:31:03 -0700
> Subject: re: Google Summer of Code Test Suite project
> On Wed, Mar 19, 2008 at 3:01 PM, Corey McClymonds <galeru at gmail.com> wrote:
>  > I would like to work on the Regression Suite project, but I'm not
>  >  quite sure of the scope.  Would I be choosing a good 30 or 40
>  >  applications that run well on wine, using wpkg to install them, and
>  >  then test for failures?  Because that would seem as though I am only
>  >  doing installer testing, instead of actual application testing.
>
>  That would be fine for starters.
>
>  >  I
>  >  would also like to do some sort of automated regression testing for
>  >  actual features you can easily test, if that would be possible.
>
>  That would be icing on the cake.
>
>  Application testing is insanely difficult.  Even installer testing
>  is difficult to actually deliver.  I would prefer that you aim
>  to get a simple run-this-script-and-it-tests-N-installers
>  script working and in the wine developers' hot little
>  hands ASAP before you get fancy and try to make
>  it test more than just installs.  Because essentially
>  all efforts to do that in the past have failed.
>
>  Make sense?
>
>  FWIW, here's my first try at it from long ago.  It's a minimal little
>  script that just tests one app's installer.   I would prefer you
>  start with something this simple.
>  http://www.winehq.org/pipermail/wine-devel/2006-July/049913.html
>  Also, maybe you could make some use of Lei's yawt script,
>  http://code.google.com/p/yawt/
>  It's kind of overkill, but it takes care of comparing registry keys and files
>  created by the installer.
>  - Dan
>
>

Yeah, I was unaware of how difficult it would be, although now that I
put on my programmers cap, I can see how it would be really difficult
to do so.  In that case, I would still like to do a regression test
for installations to help out the wine project.


From dimi at lattica.com  Wed Mar 19 21:13:06 2008
From: dimi at lattica.com (Dimi Paun)
Date: Wed, 19 Mar 2008 22:13:06 -0400
Subject: wineboot: Add the Romanian translation.
In-Reply-To: <20080319225726.GD7092@redhat.com>
References: <20080319225726.GD7092@redhat.com>
Message-ID: <1205979186.6297.248.camel@dimi.lattica.com>


On Wed, 2008-03-19 at 23:57 +0100, Michael Stefaniuc wrote:
> +    LTEXT           "O ?e?ire sau oprire simulat? este ?n curs dar
> acest proces nu r?spunde.",

This should be "O ie?ire" not "O ?e?ire", no?

-- 
Dimi Paun <dimi at lattica.com>
Lattica, Inc.



From jjmckenzie51 at sprintpcs.com  Wed Mar 19 21:24:56 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Wed, 19 Mar 2008 19:24:56 -0700
Subject: Proposed EM_Fontrange Patch
In-Reply-To: <47E02645.7010408@orange.fr>
References: <47DDDDE4.6050500@earthlink.net> <47E02645.7010408@orange.fr>
Message-ID: <47E1CAF8.1020604@sprintpcs.com>

Eric Pouech wrote:
> James McKenzie a ?crit :
>   
>> All:
>>
>> I would like to see the problems with EM_Fontrange be fixed.  The 
>> attached patch is for comment/review and I would like SPECIFIC 
>> guidance on how to implement this patch as it relates to a Wine 1.0 
>> bug (bug/issue 6254) and fixes the problem specified there.  The 
>> conformance tests are already in tests/editor.c and all they involve 
>> is removing some todo_wine blocks related to this issue.  The entire 
>> patch will do this.  Sorry that the patch is in UNIX diff format, I 
>> could not get git to do what I wanted.  The actual patch will be git 
>> format and use the daily git.
>>     
> I think that a couple of things should be improved in the patch:
> - there are 3 hDC stored in the context, while only 2 are of use 
> (rendering and measure)
>   
Actually, there are four, but it appears the one that is not needed is 
fr.hdcTarget.  Does it appear to be not used in normal usage of this 
feature?  If so, then the portion of code that was written for this use 
of this handle would not be needed. That would remove a few lines of code.
> - there is some interdependency with the EM_SETTARGETDEVICE message 
> implementation, that should be looked at
>   
I will look at this when I can.  My time has become very limited as of 
late.  That may be changing in a few months, however.
> - patch is likely a bit too big and should be sliced before inclusion
>
>   
This is the most difficult part.  Where should I make the 'slice' at?  
With only the part that implements the called code first and then the 
calling code?  That would make the most sense to me.

James McKenzie



From stefan at codeweavers.com  Wed Mar 19 21:44:53 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 20 Mar 2008 03:44:53 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <alpine.DEB.1.00.0803191605180.32540@amboise.dolphin>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<alpine.DEB.1.00.0803191605180.32540@amboise.dolphin>
Message-ID: <200803200344.53338.stefan@codeweavers.com>

Am Mittwoch, 19. M?rz 2008 16:06:34 schrieb Francois Gouget:
> On Wed, 19 Mar 2008, Francois Gouget wrote:
> [...]
>
> > So any compiler that not clear the direction flag at the start of each
> > function can cause kernel crashes when running on a buggy Linux or BSD
> > kernel.
>
>                      ^^^^^^
>                      remove
>
> Sorry, it's just regular application crashes, not kernel crashes. It
> would still be interesting to know if that can impact Wine.
Wouldn't the WINAPI function declaration sort this sort of issues out, if GCC 
implements it correctly?


From ivg231 at gmail.com  Wed Mar 19 23:51:23 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Thu, 20 Mar 2008 00:51:23 -0400
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803200213.14491.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803191211.19315.stefan@codeweavers.com>
	<47E112C6.1010205@gmail.com>
	<200803200213.14491.stefan@codeweavers.com>
Message-ID: <47E1ED4B.9000309@gmail.com>

Stefan D?singer wrote:
>> I'll get back to you on that later tonight, need to think about this
>> some more - way late for work right now... (thanks to you!)
>>
>> However, yes, I think there needs to be distinction between a standalone
>> shader concept, and a pipeline concept, which is concerned with linking
>> several multifunctional shaders together - your "uber-shader-backend".
>> Lack of distinction on this point is causing all this confusion.
>>     
> Cool, I'm looking forward to suggestions.
>   
It looks to me as if shader_backend is being overloaded for many 
different purposes that are not really related to each other. Typical 
object structure is to group related data an functions in one place, but 
what's happening in shader_backend is that it has no data of its own, 
and it's a vtable routing between different GL extensions with the data 
being scattered across multiple different places.

    - some functions are related to management of a single shader and 
its resources [ state is BaseShader ]
    - other code manages the link between vertex and fragment shader [ 
glsl programs stored in the Device ]
    - other code manages a group of 2 shaders to handle some fixed 
function purpose [ _blt, using Device->shader_priv_data ]
    - now you want to replace the main fixed function fragment 
processing [ state is in the state table ]

I think it would be worthwhile to review all of this, and see if this 
organization makes sense.  Why aren't the functions grouped together 
with the data ? Why is some of the data in the device object ? Why are 
functions managing different data containers in the same vtable ?

I am no longer familiar with the details, but there's way too many 
things called "shader" by now - d3d shader, gl shader, this made up 
"shader_backend" that actually does fixed function stuff and represents 
neither.  Maybe it makes sense to create new object types - like a 
'pipeline', containing a 'vertex processor', 'fragment processor' (not 
necessarily implemented via shaders).  Maybe each of these should have a 
"fixed" and "dynamic" facing d3d API, but attach or detach to the 
pipeline in the same way. Maybe they can have different gl extensions 
"backend" implementing each.

> Meanwhile, I've separated the ATIFS implementation and the shader backend 
> changes in my patches. The result is attached. The patches 
> named "1", "2", ... will be merged together to avoid regressions due to 
> partial implementations, and they need some reordering. I've hacked that 
> together during my train ride, so I've no idea if it really works.
>   
Will take a look...



From mishra.anurag07 at gmail.com  Wed Mar 19 23:02:40 2008
From: mishra.anurag07 at gmail.com (Anurag Mishra)
Date: Thu, 20 Mar 2008 09:32:40 +0530
Subject: Questions regarding Summer of Code( and Dplay)
Message-ID: <e7ea0e360803192102i730d6fb2i5584209783ff27f3@mail.gmail.com>

Hi,
  I am student at IIT Kanpur[1]. I have quite good knowledge about C
and have been tracking development of Wine over a period of 6 months
or so. I have good knowledge about C(and using it theoretically to
implement stacks, efficient structures and so on). However, I have
little real life experience about programming a project. I have little
experience about Window's API.
  I was looking to participate in Wine development this summer. On SoC
page, the idea of Dplay was bought up. I am interested in trying hands
on that. Can anyone suggest what would be a good starting point?

Thanks,
Anurag Mishra.

[1] http://www.iitk.ac.in


From ovek at arcticnet.no  Wed Mar 19 23:54:47 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Thu, 20 Mar 2008 05:54:47 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
Message-ID: <47E1EE17.7090002@arcticnet.no>

Francois Gouget skrev:
>    The problem revolves around the x86 direction flag (DF), which 
>    governs whether block memory operations operate forward through 
>    memory or backwards. GCC [...] 4.3.0, assumes that the direction flag 
>    has been cleared [...] at the entry of each function, as is specified 
>    by the ABI [...] Prior to 4.3, GCC would emit a cld (clear direction 
>    flag) opcode before doing inline string or memory operations.
> 
> So any compiler that not clear the direction flag at the start of each 
> function can cause kernel crashes when running on a buggy Linux or BSD 
> kernel.

No, it doesn't say that. The kernel is unaffected. The problem is only 
with user-mode signal handlers; if DF is set when a signal occurs, the 
signal handler may get confused.

> Does anyone know if MSVC does a cld in the right places?

Maybe. But it hardly matters. Only GCC-generated code is affected. The 
problem might then show up in Wine signal/exception handling. Things 
like, say, copying the CONTEXT structures around, for example.

In Wine, you can probably easily manually clear the flag on Wine signal 
handler entry (init_handler), if you're worried.




From m.b.lankhorst at gmail.com  Thu Mar 20 00:52:21 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 19 Mar 2008 22:52:21 -0700
Subject: Questions regarding Summer of Code( and Dplay)
In-Reply-To: <b130c85e0803192251i19bce0eeof6fa098503273806@mail.gmail.com>
References: <e7ea0e360803192102i730d6fb2i5584209783ff27f3@mail.gmail.com>
	<b130c85e0803192251i19bce0eeof6fa098503273806@mail.gmail.com>
Message-ID: <b130c85e0803192252r28dbcf12nbb2633aab24f74a7@mail.gmail.com>

Hello Anurag,

 2008/3/19, Anurag Mishra <mishra.anurag07 at gmail.com>:

>   I am student at IIT Kanpur[1]. I have quite good knowledge about C
 >  and have been tracking development of Wine over a period of 6 months
 >  or so. I have good knowledge about C(and using it theoretically to
 >  implement stacks, efficient structures and so on). However, I have
 >  little real life experience about programming a project. I have little
 >  experience about Window's API.
 >   I was looking to participate in Wine development this summer. On SoC
 >  page, the idea of Dplay was bought up. I am interested in trying hands
 >  on that. Can anyone suggest what would be a good starting point?


There are only a few important things to directplay as far as I know.
 The first one is find a game that runs in wine and uses it, and works
 reasonably well single player but not at all multiplayer or online
 because of the missing things (fixmes on dplay in console). After you
 played the game a little bit, think of a plan on how you want to
 tackle this problem.

 Have you managed to compile a git version of wine yet?

 Cheers,

Maarten.


From ovek at arcticnet.no  Thu Mar 20 03:14:49 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Thu, 20 Mar 2008 09:14:49 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <47E1EE17.7090002@arcticnet.no>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<47E1EE17.7090002@arcticnet.no>
Message-ID: <47E21CF9.6070807@arcticnet.no>

Ove Kaaven skrev:
>> Does anyone know if MSVC does a cld in the right places?
> 
> Maybe. But it hardly matters. Only GCC-generated code is affected.

In order to avoid confusion about my answer, I should probably clarify. 
I was answering this question only:

"Could this kernel bug affect MSVC code?"

To this, the answer is "no", as Wine doesn't run application code from 
signal handlers. However, some may wonder what we can *learn* from the 
kernel bug, and maybe formulate a different question:

"Could the new *GCC* cause trouble for Wine, then?"

It's a completely different question, and it also goes far beyond 
whether Wine's own setup_exception clears DF before invoking exception 
handlers (currently it doesn't), and into the realm of differences 
between the Win32 and the Linux ABI. Here, the answer is "yes", but this 
is the case regardless of the kernel issue, and it is also not limited 
to exceptions, but applies to *any* call from application code to Wine.




From dmitry at codeweavers.com  Thu Mar 20 03:15:23 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 20 Mar 2008 16:15:23 +0800
Subject: [1/2] reg: Implement basic 'reg add'.
References: <689de9370803200034g24140491xea25c1deb8c6fcf@mail.gmail.com>
Message-ID: <002001c88a62$8d876d30$a600fea9@DMITRY>

"Andrew Riedi" <andrewriedi at gmail.com> wrote:

> +int reg_lstrncmpiW(const WCHAR *s1, const WCHAR *s2, size_t n)

CompareString is better.

> +    const WCHAR hkcrW[] = {'h','k','c','r',0};
> +    const WCHAR hkcuW[] = {'h','k','c','u',0};
> +    const WCHAR hklmW[] = {'h','k','l','m',0};
> +    const WCHAR hkuW[] = {'h','k','u',0};
> +    const WCHAR hkccW[] = {'h','k','c','c',0};
> +    const WCHAR hkddW[] = {'h','k','d','d',0};

You should make all const strings static.

> +    /* TODO: Remote registry editing. */
> +    if (key_name[0] == '\\' && key_name[1] == '\\')
> +    {
> +        fprintf(stderr, "Remote registry editing not implemented.\n");
> +        return 1;
> +    }

Please use normal WINE_TRACE, WINE_ERR, etc instead of fprintf.


-- 
Dmitry.


From martin at hinner.info  Thu Mar 20 04:26:20 2008
From: martin at hinner.info (Martin Hinner)
Date: Thu, 20 Mar 2008 10:26:20 +0100
Subject: First steps to make Win32 app running under Wine
Message-ID: <24d1a1690803200226p539396fat21bcdc7a9932e2e2@mail.gmail.com>

Hi,

   I am solving problem how to get one Win32 app (for which I have
source code) running under Wine. The biggest issue is drivers and
ioctls. Linux has driver support for what we need and provides similar
ioctls for some stuff, but it differs from Windows.

  The difference is *so big* that I would prefer to modify our source
code to use different pieces of code when it detects Wine. I
understand, that this is *against* Wine policy and generally should
not be used. But writing built-in replacement for some DLLs (hack
Linux-style drivers into Windows-style) would be a nightmare, so
having small mods to Win code would be much easier. I am not talking
about "generic" functions, but about specific drivers/etc.

Imagine this: Under windows you get usb driver with some ioctl-based
interface, sometimes with DLL or without it (vendor provides only .lib
file that gets statically linked). Under Linux there is libusb used.
Difference between these two ways of driver implementation is *huge*
and making libusb driver compatible with Win32 driver is almost
impossible (in Win you have a real file handle, under libusb only
pointer, etc.).

It would greatly help for this case to be able to:

- detect wine and platform from Win32 app (.exe)
- load native Linux library and perform ioctls (ioctl(2), not Windows
IOCTL!) on file handles
- get somehow access to files in Linux filesystem (i.e. in /dev)

This would allow to easily modify our source code in a few places
(i.e. hardware routines) and get it quickly running under Linux.

I can do all above by writing some built-in dll that would work just
for my case, but I think *maybe* it's worth it to provide some generic
interface in Wine??

Martin


From julliard at winehq.org  Thu Mar 20 04:31:44 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 Mar 2008 10:31:44 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <47E1EE17.7090002@arcticnet.no> (Ove Kaaven's message of "Thu, 20
	Mar 2008 05:54:47 +0100")
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<47E1EE17.7090002@arcticnet.no>
Message-ID: <877ifxspvj.fsf@wine.dyndns.org>

Ove Kaaven <ovek at arcticnet.no> writes:

> Francois Gouget skrev:
>> Does anyone know if MSVC does a cld in the right places?
>
> Maybe. But it hardly matters. Only GCC-generated code is affected. The 
> problem might then show up in Wine signal/exception handling. Things 
> like, say, copying the CONTEXT structures around, for example.

It matters in the sense that Wine currently doesn't clear the direction
flag before calling an exception handler, so if MSVC doesn't do a cld
then we'd have the same bug WRT msvc as the Linux kernel has WRT gcc.
Of course now that gcc is changed we'll have to make sure to clear the
flag regardless of what MSVC does.

-- 
Alexandre Julliard
julliard at winehq.org


From meissner at suse.de  Thu Mar 20 04:52:28 2008
From: meissner at suse.de (Marcus Meissner)
Date: Thu, 20 Mar 2008 10:52:28 +0100
Subject: First steps to make Win32 app running under Wine
In-Reply-To: <24d1a1690803200226p539396fat21bcdc7a9932e2e2@mail.gmail.com>
References: <24d1a1690803200226p539396fat21bcdc7a9932e2e2@mail.gmail.com>
Message-ID: <20080320095228.GA12971@suse.de>

On Thu, Mar 20, 2008 at 10:26:20AM +0100, Martin Hinner wrote:
> Hi,
> 
>    I am solving problem how to get one Win32 app (for which I have
> source code) running under Wine. The biggest issue is drivers and
> ioctls. Linux has driver support for what we need and provides similar
> ioctls for some stuff, but it differs from Windows.
> 
>   The difference is *so big* that I would prefer to modify our source
> code to use different pieces of code when it detects Wine. I
> understand, that this is *against* Wine policy and generally should
> not be used. But writing built-in replacement for some DLLs (hack
> Linux-style drivers into Windows-style) would be a nightmare, so
> having small mods to Win code would be much easier. I am not talking
> about "generic" functions, but about specific drivers/etc.
> 
> Imagine this: Under windows you get usb driver with some ioctl-based
> interface, sometimes with DLL or without it (vendor provides only .lib
> file that gets statically linked). Under Linux there is libusb used.
> Difference between these two ways of driver implementation is *huge*
> and making libusb driver compatible with Win32 driver is almost
> impossible (in Win you have a real file handle, under libusb only
> pointer, etc.).
> 
> It would greatly help for this case to be able to:
> 
> - detect wine and platform from Win32 app (.exe)

Best bet is to just check for the registry key HKLM\Software\Wine

> - load native Linux library and perform ioctls (ioctl(2), not Windows
> IOCTL!) on file handles

Needs code in your application, but is technically possible. 

> - get somehow access to files in Linux filesystem (i.e. in /dev)

Same as above. No need for any specific code if you map Z: to / for instance.

> This would allow to easily modify our source code in a few places
> (i.e. hardware routines) and get it quickly running under Linux.
> 
> I can do all above by writing some built-in dll that would work just
> for my case, but I think *maybe* it's worth it to provide some generic
> interface in Wine??

Hmm. We might be able to do this via msvcrt ioctl perhaps? No idea.

Ciao, Marcus


From martin at hinner.info  Thu Mar 20 05:31:08 2008
From: martin at hinner.info (Martin Hinner)
Date: Thu, 20 Mar 2008 11:31:08 +0100
Subject: First steps to make Win32 app running under Wine
In-Reply-To: <20080320095228.GA12971@suse.de>
References: <24d1a1690803200226p539396fat21bcdc7a9932e2e2@mail.gmail.com>
	<20080320095228.GA12971@suse.de>
Message-ID: <24d1a1690803200331q47930682r1acd9f302c191168@mail.gmail.com>

On 3/20/08, Marcus Meissner <meissner at suse.de> wrote:
> Best bet is to just check for the registry key HKLM\Software\Wine

I know also other methods, this is not a problem, I just wanted to ask
if it's possible to get some "official wine api" for all this stuff.

>  > - load native Linux library and perform ioctls (ioctl(2), not Windows
>  > IOCTL!) on file handles
> Needs code in your application, but is technically possible.

I know, the question is again about getting this officially into wine
so as I don't have to make my own built-in .dll.so

>  > - get somehow access to files in Linux filesystem (i.e. in /dev)
> Same as above. No need for any specific code if you map Z: to / for instance.

And if user does not? It would be nice to do
_wine_open("/dev/something", O_RDWR) from my app.

>  > This would allow to easily modify our source code in a few places
>  > (i.e. hardware routines) and get it quickly running under Linux.
>  >
>  > I can do all above by writing some built-in dll that would work just
>  > for my case, but I think *maybe* it's worth it to provide some generic
>  > interface in Wine??
> Hmm. We might be able to do this via msvcrt ioctl perhaps? No idea.

IMHO it would be nice to have "standard" wineapp.dll.so that would
work as a proxy between posix functions for applications that are
aware about Wine. Such DLL would be a great helper! In fact I would
need only dlopen() and dlsym(), maybe also uname()  :-).

This library could be loaded from Win32 app using LoadModule(..) on-demand.

Martin


From ovek at arcticnet.no  Thu Mar 20 05:33:45 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Thu, 20 Mar 2008 11:33:45 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <877ifxspvj.fsf@wine.dyndns.org>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>	<47E1EE17.7090002@arcticnet.no>
	<877ifxspvj.fsf@wine.dyndns.org>
Message-ID: <47E23D89.2030309@arcticnet.no>

Alexandre Julliard skrev:
> Ove Kaaven <ovek at arcticnet.no> writes:
> 
>> Francois Gouget skrev:
>>> Does anyone know if MSVC does a cld in the right places?
>> Maybe. But it hardly matters. Only GCC-generated code is affected. The 
>> problem might then show up in Wine signal/exception handling. Things 
>> like, say, copying the CONTEXT structures around, for example.
> 
> It matters in the sense that Wine currently doesn't clear the direction
> flag before calling an exception handler, so if MSVC doesn't do a cld
> then we'd have the same bug WRT msvc as the Linux kernel has WRT gcc.

But that's a bit of a different issue, unrelated to the kernel flaw. I 
was only talking about that flaw. I kind of tried to clarify that in my 
next followup... oh well.

When it comes to ABI issues with MSVC code, the question isn't so much 
whether it uses cld, but what Windows does when throwing exceptions. 
Does Windows clear the DF when it calls exception handlers? If not, then 
there's hardly any Wine bug here (that doesn't exist on Windows anyway). 
Perhaps someone should test, but my guess is that Windows doesn't clear it.

(And anyway, my experience is that MSVC assumes DF is undefined, and 
does the cld.)

> Of course now that gcc is changed we'll have to make sure to clear the
> flag regardless of what MSVC does.

But not just in the exception handling. Everywhere... there's no special 
case here.




From mstefani at redhat.com  Thu Mar 20 05:54:14 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 20 Mar 2008 11:54:14 +0100
Subject: wineboot: Add the Romanian translation.
In-Reply-To: <1205979186.6297.248.camel@dimi.lattica.com>
References: <20080319225726.GD7092@redhat.com>
	<1205979186.6297.248.camel@dimi.lattica.com>
Message-ID: <47E24256.1080707@redhat.com>

Dimi Paun wrote:
> On Wed, 2008-03-19 at 23:57 +0100, Michael Stefaniuc wrote:
>> +    LTEXT           "O ?e?ire sau oprire simulat? este ?n curs dar
>> acest proces nu r?spunde.",
> 
> This should be "O ie?ire" not "O ?e?ire", no?
Thanks man, I've resent it!

bye
	michael


From dgerard at gmail.com  Wed Mar 19 15:20:49 2008
From: dgerard at gmail.com (David Gerard)
Date: Wed, 19 Mar 2008 20:20:49 +0000
Subject: [Wine] Splitting wine wiki FAQ (was: Wine wiki cleanup)
In-Reply-To: <a71bd89a0803191258j45e3135egefcaf54d67047757@mail.gmail.com>
References: <a71bd89a0803191258j45e3135egefcaf54d67047757@mail.gmail.com>
Message-ID: <fbad4e140803191320m15d2464ei5cad4d43bb21f873@mail.gmail.com>

On 19/03/2008, Dan Kegel <dank at kegel.com> wrote:

>  Sounds good to me!
>  I'm cc'ing wine-devel; if nobody objects by Friday, go ahead and do it.


The thing to keep in mind is: with the new forum gateway, wine-users
is getting a flood of regular non-geek users - the sort of people who
are not geeks at all, but who are sick of Windows being flaky, so they
try Linux (often Ubuntu) and try Wine for that one Windows program
they're stuck with.

And with Wine 1.0 just around the corner, they're going to appear in a
*FLOOD*. You think wine-users has lots of n00bs now? This is NOTHING
to the flood that's about to show up ...

So yeah, the key thing to keep in mind will be to very clearly steer
them to stuff that answers the n00b questions well!

(And thus keep them out of the developers' hair, except the valiant
n00b-helpers who have been writing decent bug reports from scanty
information in the last few weeks from forum/list posts ...)


- d.


From stefan at codeweavers.com  Wed Mar 19 20:13:14 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 20 Mar 2008 02:13:14 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E112C6.1010205@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803191211.19315.stefan@codeweavers.com>
	<47E112C6.1010205@gmail.com>
Message-ID: <200803200213.14491.stefan@codeweavers.com>

> I'll get back to you on that later tonight, need to think about this
> some more - way late for work right now... (thanks to you!)
>
> However, yes, I think there needs to be distinction between a standalone
> shader concept, and a pipeline concept, which is concerned with linking
> several multifunctional shaders together - your "uber-shader-backend".
> Lack of distinction on this point is causing all this confusion.
Cool, I'm looking forward to suggestions.

Meanwhile, I've separated the ATIFS implementation and the shader backend 
changes in my patches. The result is attached. The patches 
named "1", "2", ... will be merged together to avoid regressions due to 
partial implementations, and they need some reordering. I've hacked that 
together during my train ride, so I've no idea if it really works.

I've separated the shader model changes and the atifs implementation to make 
Alexandre happy. I'm now also enabling ATIFS only if ARB vertex shaders are 
enabled, pixel shaders not disabled, GLSL not supported and 
ARB_fragment_program not supported. Thus atifs only inherits from the arb 
backend, which avoids the 3 shader backend structures and makes dealing with 
the private data easier. So I think it partially addresses your concerns. 
atifs still has to route vertex processing through the ARB backend, but we 
will need that if we implement d3d pixel shaders using atifs, unless we split 
up vertex and fragment shader processing backends(So separating fixed 
function and programmable won't help there).
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0.tar.bz2
Type: application/x-tbz
Size: 43138 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080320/b97692ad/attachment-0001.bin 

From fgouget at free.fr  Thu Mar 20 06:00:34 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 20 Mar 2008 12:00:34 +0100 (CET)
Subject: Google Summer of Code Test Suite project
In-Reply-To: <b6bb06270803191615w50428d95k81d6cb394dec861f@mail.gmail.com>
References: <63ee2bc70803191501u7c44c13cse73fdc59c76b6b1d@mail.gmail.com>
	<558b2f5c0803191510u12a5b2c8ma72f204a7bb38a5e@mail.gmail.com>
	<63ee2bc70803191607o3c1739a9l3d8196701ae9e669@mail.gmail.com>
	<b6bb06270803191615w50428d95k81d6cb394dec861f@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0803201143170.8197@amboise.dolphin>

On Wed, 19 Mar 2008, Austin English wrote:
[...]
> Using a program like AutoHotkey to install a program and test its
> features would be a better route IMHO.

I agree but I'm not sure AutoHotKey is quite ready yet. But I think that 
getting a robust graphical testing environment would be hugely 
beneficial for Wine.

There are a couple of options to get there:
 * cxtest
   http://www.cxtest.org/
   It has tools to record and replay clicks.
   One big drawback is that in its current form it is very Unixy, that 
   is you need bash and VNC in order to record an application 
   installation. This prevents running it on Windows which is really 
   needed imho. On the other hand it can handle both Unix and Windows 
   scripting. It is also missing support for some things like menus and 
   combo boxes.
   However it has a great backend for automating and reporting the 
   tests, identifying known issues and automatically grouping them 
   together, etc.

 * AutoHotKey
   http://www.autohotkey.com/
   It runs on Windows and has a very nice 'record' feature: you can 
   start it in record mode, install your application, stop the recording 
   and presto, you have a script ready to replay. However it generates 
   scripts that are coordinates based (i.e. left-click at 123x456), 
   rather than 'controls' based (i.e. left-click on the 'Ok' button in 
   the 'Step 3 windows'). That worries me as I'm not convinced these 
   coordinates will match well when the application is run in Wine 
   (potential font issues). I suspect that even on Windows there could 
   be issues if the user changes the font size, DPI or stuff like that. 
   However I don't know how commercial graphical regression testing 
   tools handle that so maybe it's not such a big issue.
   Also AutoHotKey has not yet been integrated in a framework with a 
   good backend.

So one thing that would be very good for Wine would be to improve 
AutoHotKey so it really does all that we need. It should be good enough 
that open-source projects would want to use it for their own regression 
testing on Windows, so that we would just reuse their scripts. However I 
don't know if it's suitable for a GSoC project. Also it may be more of 
an AutoHotKey GSoC than a Wine one.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
    Indifference will certainly be the downfall of mankind, but who cares?


From julliard at winehq.org  Thu Mar 20 06:12:14 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 Mar 2008 12:12:14 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <47E23D89.2030309@arcticnet.no> (Ove Kaaven's message of "Thu, 20
	Mar 2008 11:33:45 +0100")
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<47E1EE17.7090002@arcticnet.no> <877ifxspvj.fsf@wine.dyndns.org>
	<47E23D89.2030309@arcticnet.no>
Message-ID: <87y78dr6nl.fsf@wine.dyndns.org>

Ove Kaaven <ovek at arcticnet.no> writes:

> But that's a bit of a different issue, unrelated to the kernel flaw. I
> was only talking about that flaw. I kind of tried to clarify that in
> my next followup... oh well.

Sure, it has nothing to do with the kernel bug, except that it points to
a similar bug in the Wine kernel.

>> Of course now that gcc is changed we'll have to make sure to clear the
>> flag regardless of what MSVC does.
>
> But not just in the exception handling. Everywhere... there's no
> special case here.

It depends if MSVC respects that ABI constraint or not. If it doesn't
and calls API functions with the flag set then yes, we'd have to clear
it everywhere. But if it does respect the ABI, then exception handling
is definitely a special case, and we have to clear the flag there, and
nowhere else.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Mar 20 06:30:53 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 Mar 2008 12:30:53 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <47E23D89.2030309@arcticnet.no> (Ove Kaaven's message of "Thu, 20
	Mar 2008 11:33:45 +0100")
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<47E1EE17.7090002@arcticnet.no> <877ifxspvj.fsf@wine.dyndns.org>
	<47E23D89.2030309@arcticnet.no>
Message-ID: <87skylr5si.fsf@wine.dyndns.org>

Ove Kaaven <ovek at arcticnet.no> writes:

> When it comes to ABI issues with MSVC code, the question isn't so much
> whether it uses cld, but what Windows does when throwing
> exceptions. Does Windows clear the DF when it calls exception
> handlers? If not, then there's hardly any Wine bug here (that doesn't
> exist on Windows anyway). Perhaps someone should test, but my guess is
> that Windows doesn't clear it.
>
> (And anyway, my experience is that MSVC assumes DF is undefined, and
> does the cld.)

A quick test on Vista shows that the flag is cleared when calling
exception handlers, and that API functions (at least lstrcat) expect it
to be cleared on entry and don't do a cld.

-- 
Alexandre Julliard
julliard at winehq.org


From ovek at arcticnet.no  Thu Mar 20 07:04:06 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Thu, 20 Mar 2008 13:04:06 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <87y78dr6nl.fsf@wine.dyndns.org>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>	<47E1EE17.7090002@arcticnet.no>
	<877ifxspvj.fsf@wine.dyndns.org>	<47E23D89.2030309@arcticnet.no>
	<87y78dr6nl.fsf@wine.dyndns.org>
Message-ID: <47E252B6.9060207@arcticnet.no>

Alexandre Julliard skrev:
> Ove Kaaven <ovek at arcticnet.no> writes:
> 
>> But that's a bit of a different issue, unrelated to the kernel flaw. I
>> was only talking about that flaw. I kind of tried to clarify that in
>> my next followup... oh well.
> 
> Sure, it has nothing to do with the kernel bug, except that it points to
> a similar bug in the Wine kernel.

Yeah, I mentioned that.

>>> Of course now that gcc is changed we'll have to make sure to clear the
>>> flag regardless of what MSVC does.
>> But not just in the exception handling. Everywhere... there's no
>> special case here.
> 
> It depends if MSVC respects that ABI constraint or not.

Only if you want to make Wine depend on the compiler used to compile 
Windows applications. Not all of them are called "MSVC". I know Borland 
Delphi is used by some these days, and its ABI expectations might be 
different.

Well, I took a look to see what msvcrt expects these days. Looks like it 
expects DF clear now. But I don't think this was always the case in the 
past... (though it's also possible I'm thinking back to win16 here.)




From julliard at winehq.org  Thu Mar 20 07:12:14 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 Mar 2008 13:12:14 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <47E252B6.9060207@arcticnet.no> (Ove Kaaven's message of "Thu, 20
	Mar 2008 13:04:06 +0100")
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<47E1EE17.7090002@arcticnet.no> <877ifxspvj.fsf@wine.dyndns.org>
	<47E23D89.2030309@arcticnet.no> <87y78dr6nl.fsf@wine.dyndns.org>
	<47E252B6.9060207@arcticnet.no>
Message-ID: <87k5jxr3vl.fsf@wine.dyndns.org>

Ove Kaaven <ovek at arcticnet.no> writes:

> Alexandre Julliard skrev:
>> It depends if MSVC respects that ABI constraint or not.
>
> Only if you want to make Wine depend on the compiler used to compile
> Windows applications. Not all of them are called "MSVC". I know
> Borland Delphi is used by some these days, and its ABI expectations
> might be different.

All other Windows compilers have to respect the ABI as defined by MSVC,
if only because all the system dlls are built with MSVC.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Thu Mar 20 07:24:45 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 05:24:45 -0700
Subject: First steps to make Win32 app running under Wine
Message-ID: <a71bd89a0803200524r5f560c29pb4c43b8a6f09270f@mail.gmail.com>

Martin Hinner wrote:
>  I am solving problem how to get one Win32 app (for which I have
> source code) running under Wine. The biggest issue is drivers and
> ioctls. Linux has driver support for what we need and provides similar
> ioctls for some stuff, but it differs from Windows.

What drivers and ioctls, exactly?

Which driver framework are you using?
http://en.wikipedia.org/wiki/User-Mode_Driver_Framework
might be easier for us to directly support...
- Dan


From ovek at arcticnet.no  Thu Mar 20 07:26:25 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Thu, 20 Mar 2008 13:26:25 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <87k5jxr3vl.fsf@wine.dyndns.org>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>	<47E1EE17.7090002@arcticnet.no>
	<877ifxspvj.fsf@wine.dyndns.org>	<47E23D89.2030309@arcticnet.no>
	<87y78dr6nl.fsf@wine.dyndns.org>	<47E252B6.9060207@arcticnet.no>
	<87k5jxr3vl.fsf@wine.dyndns.org>
Message-ID: <47E257F1.3030604@arcticnet.no>

Alexandre Julliard skrev:
> Ove Kaaven <ovek at arcticnet.no> writes:
> 
>> Alexandre Julliard skrev:
>>> It depends if MSVC respects that ABI constraint or not.
>> Only if you want to make Wine depend on the compiler used to compile
>> Windows applications. Not all of them are called "MSVC". I know
>> Borland Delphi is used by some these days, and its ABI expectations
>> might be different.
> 
> All other Windows compilers have to respect the ABI as defined by MSVC,
> if only because all the system dlls are built with MSVC.

Well, we don't really know how the system dlls are built, they could 
have different compiler flags and pragmas than the msvcrt, just to 
protect them against this sort of thing (I doubt a system like Delphi 
would really need msvcrt, so it wouldn't have to conform to the MSVC 
ABI, it'd just have to not crash the system DLLs). I don't know, but 
it's a possibility I wouldn't dismiss out of hand.





From julliard at winehq.org  Thu Mar 20 07:40:13 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 Mar 2008 13:40:13 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <47E257F1.3030604@arcticnet.no> (Ove Kaaven's message of "Thu, 20
	Mar 2008 13:26:25 +0100")
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<47E1EE17.7090002@arcticnet.no> <877ifxspvj.fsf@wine.dyndns.org>
	<47E23D89.2030309@arcticnet.no> <87y78dr6nl.fsf@wine.dyndns.org>
	<47E252B6.9060207@arcticnet.no> <87k5jxr3vl.fsf@wine.dyndns.org>
	<47E257F1.3030604@arcticnet.no>
Message-ID: <87d4ppr2ky.fsf@wine.dyndns.org>

Ove Kaaven <ovek at arcticnet.no> writes:

> Alexandre Julliard skrev:
>> All other Windows compilers have to respect the ABI as defined by MSVC,
>> if only because all the system dlls are built with MSVC.
>
> Well, we don't really know how the system dlls are built, they could
> have different compiler flags and pragmas than the msvcrt, just to
> protect them against this sort of thing (I doubt a system like Delphi
> would really need msvcrt, so it wouldn't have to conform to the MSVC
> ABI, it'd just have to not crash the system DLLs). I don't know, but
> it's a possibility I wouldn't dismiss out of hand.

My test with lstrcat demonstrates that this is not the case (lstrcat is
in kernel32, not in msvcrt). I don't see any reason to believe that
msvcrt is built with a different ABI than the rest of the system.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Thu Mar 20 08:00:23 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 20 Mar 2008 14:00:23 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E1ED4B.9000309@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803200213.14491.stefan@codeweavers.com>
	<47E1ED4B.9000309@gmail.com>
Message-ID: <200803201400.24280.stefan@codeweavers.com>

Am Donnerstag, 20. M?rz 2008 05:51:23 schrieb Ivan Gyurdiev:
> It looks to me as if shader_backend is being overloaded for many
> different purposes that are not really related to each other. Typical
> object structure is to group related data an functions in one place, but
> what's happening in shader_backend is that it has no data of its own,
> and it's a vtable routing between different GL extensions with the data
> being scattered across multiple different places.
Yes, you're right, the shader backend does a few things right now. You have to 
see it as something dealing with OpenGL settings, don't see it as something 
talking D3D slang. Maybe renaming it to gl_pipeline_backend would give it a 
more suitable name.

> I think it would be worthwhile to review all of this, and see if this
> organization makes sense.  Why aren't the functions grouped together
> with the data ? Why is some of the data in the device object ? Why are
> functions managing different data containers in the same vtable ?
Henri once suggested making the shader_backend_t structure a COM object, that 
is created and destroyed by the device. That would make the state of the data 
it manages clearer(belongs to the shader object), though it would add some 
stuff we don't need, like the IUnknown parts, refcounting. If we did that we 
could call the "shader function routing" "inheritance" and are well within 
OOP slang again.

Keep in mind though that a D3DDevice is a conglomerate of many different 
things(fixed function, shaders, evaluators, resource management, ...), and 
many of the critiques you mentioned apply to the D3D API as a whole. And even 
if our shader_backend_t is opengl-centric, we can't fully ignore the D3D 
design.

> I am no longer familiar with the details, but there's way too many
> things called "shader" by now - d3d shader, gl shader, this made up
> "shader_backend" that actually does fixed function stuff and represents
> neither.  Maybe it makes sense to create new object types - like a
> 'pipeline', containing a 'vertex processor', 'fragment processor' (not
> necessarily implemented via shaders).  Maybe each of these should have a
> "fixed" and "dynamic" facing d3d API, but attach or detach to the
> pipeline in the same way. Maybe they can have different gl extensions
> "backend" implementing each.
My concern is that if we break up the shader structure into multiple 
objects(e.g. vertex shader handler, pixel shader handler, fixed function 
vertex replacement, fixed function pipeline replacement, depth blit handler, 
pipeline linker), then we'll get simple single objects, but the putting these 
parts together adds more complexity than we save in the first place. Often in 
OOP programs(and other paradigms as well) you don't know what one component 
does without knowing the whole program.


From hverbeet at gmail.com  Thu Mar 20 08:17:56 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Thu, 20 Mar 2008 14:17:56 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803201400.24280.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803200213.14491.stefan@codeweavers.com>
	<47E1ED4B.9000309@gmail.com>
	<200803201400.24280.stefan@codeweavers.com>
Message-ID: <d658b69e0803200617g64128da9ja130cf8a011d4215@mail.gmail.com>

On 20/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Henri once suggested making the shader_backend_t structure a COM object, that
>  is created and destroyed by the device. That would make the state of the data
I never mentioned COM there.


From volker.groeschel at sap.com  Thu Mar 20 08:40:32 2008
From: volker.groeschel at sap.com (Groeschel, Volker)
Date: Thu, 20 Mar 2008 14:40:32 +0100
Subject: Game Performance and Grafik Cards
Message-ID: <1DE958D0164F8043BB57265BB40ACDF7A448DD@dewdfe16.wdf.sap.corp>

Hi,
 
I have read many valuable information from Detlef, Roderick and Stefan
about this topic. Thank you very much for this so far!
 
e.g. 
http://wiki.winehq.org/DirectDraw
http://wiki.winehq.org/UsefulRegistryKeys
 
and some comments in bugzilla.
 
But it is still very hard for me to tell what I need to do to improve
performance. All I have is trial and error.
 
What I'm missing ist some kind of feature list for the different grafic
drivers. It would be very helpfull to have more infomation which
features are supported and how well supported with the most important
drivers and for which cards:
 - RADEON
 - AMD Catalyst
 - Nvidia binary
 
Another thing I'm missing is a guid how I can tell which features my
game needs.
 
Then I could bring this information together and find the best match.
 
Like "your games uses xxx and the driver supports yyy, in this case use
switch zzz for best results".
 
Is there any chance that we can get this in the Wiki?
 
Once this information is available the application maintainers in the
AppDB could start to add recommendations for each game and make it more
easy for beginners as well.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080320/d9f7b1ea/attachment-0001.htm 

From stefan at codeweavers.com  Thu Mar 20 08:46:57 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 20 Mar 2008 14:46:57 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803200617g64128da9ja130cf8a011d4215@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803201400.24280.stefan@codeweavers.com>
	<d658b69e0803200617g64128da9ja130cf8a011d4215@mail.gmail.com>
Message-ID: <200803201446.57709.stefan@codeweavers.com>

Am Donnerstag, 20. M?rz 2008 14:17:56 schrieb H. Verbeet:
> On 20/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> > Henri once suggested making the shader_backend_t structure a COM object,
> > that is created and destroyed by the device. That would make the state of
> > the data
>
> I never mentioned COM there.
On IRC I think you once mentioned making the shader backend an object, and 
since we don't have a C++ compiler anyway I concluded COM. (That was a 
follow-up discussion on the patch that moved the shader backend resources 
into a device instead of using static variables). I'm sorry if I put words in 
your mouth you didn't say.



From hverbeet at gmail.com  Thu Mar 20 09:26:07 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Thu, 20 Mar 2008 15:26:07 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803201446.57709.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803201400.24280.stefan@codeweavers.com>
	<d658b69e0803200617g64128da9ja130cf8a011d4215@mail.gmail.com>
	<200803201446.57709.stefan@codeweavers.com>
Message-ID: <d658b69e0803200726v56aaf604mc37290aaa66afc4@mail.gmail.com>

On 20/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> On IRC I think you once mentioned making the shader backend an object, and
>  since we don't have a C++ compiler anyway I concluded COM. (That was a
In essence an object is just a call table with some data, you don't
really need a C++ compiler for that. (And that specific discussion was
about moving the private data of the shader backend out of the device
and into the backend itself). COM would add a lot of stuff that we
don't really need.


From paul.vriens.wine at gmail.com  Thu Mar 20 09:36:30 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 20 Mar 2008 15:36:30 +0100
Subject: Testing service/driver install via setupapi
Message-ID: <47E2766E.9040605@gmail.com>

Hi,

I'm looking into bug 12030 (http://bugs.winehq.org/show_bug.cgi?id=12030). The 
driver service is not installed by our InstallHinfSection function.

I'm first trying to come up with a test before even trying to do the 
implementation. The question I'm having is whether I should be doing the test 
with InstallHinfSection and/or SetupInstallServicesFromInfSection[Ex]?

The current setupapi tests only test InstallHinfSection. But in the end 
SetupInstallFromInfSection will be called from within InstallHinfSection.

Should I take the same approach for the services piece?. So,

1) Implement in SetupInstallServicesFromInfSection[Ex]
2) Test via InstallHinfSection

-- 
Cheers,

Paul.


From thunderbird2k at gmx.net  Thu Mar 20 09:42:10 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Thu, 20 Mar 2008 15:42:10 +0100
Subject: Game Performance and Grafik Cards
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A448DD@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A448DD@dewdfe16.wdf.sap.corp>
Message-ID: <20080320144210.40360@gmx.net>

> Hi,
>  
> I have read many valuable information from Detlef, Roderick and Stefan
> about this topic. Thank you very much for this so far!
>  
> e.g. 
> http://wiki.winehq.org/DirectDraw
> http://wiki.winehq.org/UsefulRegistryKeys
>  
> and some comments in bugzilla.
>  
> But it is still very hard for me to tell what I need to do to improve
> performance. All I have is trial and error.
>  
> What I'm missing ist some kind of feature list for the different grafic
> drivers. It would be very helpfull to have more infomation which
> features are supported and how well supported with the most important
> drivers and for which cards:
>  - RADEON
>  - AMD Catalyst
>  - Nvidia binary
>  
> Another thing I'm missing is a guid how I can tell which features my
> game needs.
>  
> Then I could bring this information together and find the best match.
>  
> Like "your games uses xxx and the driver supports yyy, in this case use
> switch zzz for best results".
>  
> Is there any chance that we can get this in the Wiki?
>  
> Once this information is available the application maintainers in the
> AppDB could start to add recommendations for each game and make it more
> easy for beginners as well.

I think we want to discourage the use of register settings as much as possible. A lot of users don't understand well what options mean and use bad combinations. We are thinking about detecting the best settings at wine startup using perhaps basic benchmark tests. That would be the best for everyone. Using registry settings you would then be able to override the automatic option.

That's just my opinion.

Roderick
-- 
Psssst! Schon vom neuen GMX MultiMessenger geh?rt?
Der kann`s mit allen: http://www.gmx.net/de/go/multimessenger


From stefan at codeweavers.com  Thu Mar 20 09:45:37 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 20 Mar 2008 15:45:37 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803200726v56aaf604mc37290aaa66afc4@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803201446.57709.stefan@codeweavers.com>
	<d658b69e0803200726v56aaf604mc37290aaa66afc4@mail.gmail.com>
Message-ID: <200803201545.37308.stefan@codeweavers.com>

Am Donnerstag, 20. M?rz 2008 15:26:07 schrieb H. Verbeet:
> On 20/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> > On IRC I think you once mentioned making the shader backend an object,
> > and since we don't have a C++ compiler anyway I concluded COM. (That was
> > a
>
> In essence an object is just a call table with some data, you don't
> really need a C++ compiler for that. (And that specific discussion was
> about moving the private data of the shader backend out of the device
> and into the backend itself). COM would add a lot of stuff that we
> don't really need.
Agreed. However, I'd rather use COM and have a few simple IUnknown methods 
hanging around that are not used instead of inventing yet another way to 
implement object to keep the code more readable. COM is a well-known scheme, 
so it will keep the code more understandable.

If we use COM and make the state table a per-shader-backend property I'd 
shadow the pointer in the device though, to avoid an extra function call in 
each MarkStateDirty call.


From pure_evil at mail.bg  Thu Mar 20 10:05:51 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Thu, 20 Mar 2008 17:05:51 +0200
Subject: developing hints appreciated
Message-ID: <200803201705.51626.pure_evil@mail.bg>

Folks, I'm working with Dan Kegel on the idea of a winecfg/control panel 
merger; I did a .cpl or two a few days ago, but it seems I didn't quite 
understand the rules of the dev on wine/ or on linux for that matter :(
I need someone to show me the ropes...
Basically, The Toolbox. 
Question 1: I need to mess about with winecfg. I want to compile only 
winecfg.exe so I can immediately see when I made a mistake /rather than 
trying to build the entire source of wine/. What's the console command(s) I 
need to execute in order to get a winecfg.exe or any other single file, 
executable or otherwise out of the source /preferably not overwriting the 
real one in use/?
Question 2: The cpls/any additional executables that have to be added to wine 
have to be in source form (duh!). Any particular quirks I should know about?
Say, example.exe has to be created when wine is built; it goes into "c:
\windows\system32". Is there anything special (some obscure settings?) that 
needs to be done in order for "./tools/wineinstall" and 
then "wineprefixcreate" to create "c:\windows\system32\example.exe" out of 
the source located in "<winesource>/programs/example"?
Sorry if the questions appear newbie-ish :(


From mpartap at gmx.net  Thu Mar 20 11:13:24 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Thu, 20 Mar 2008 17:13:24 +0100
Subject: developing hints appreciated
In-Reply-To: <200803201705.51626.pure_evil@mail.bg>
References: <200803201705.51626.pure_evil@mail.bg>
Message-ID: <47E28D24.1000000@gmx.net>

> but it seems I didn't quite understand the rules of
 > the dev on wine/ or on linux for that matter :(
> I need someone to show me the ropes...
> Basically, The Toolbox. 
Last year THAT was my biggest initial problem as well. There are really a few caveats you will most 
probably hit (seems to me I hit ALL of them at some point *g) so if you do just drop me a message 
and I'll try and help, so is anyone on winehackers and this mailing list.

> Question 1: I need to mess about with winecfg. I want to compile only 
> winecfg.exe so I can immediately see when I made a mistake /rather than 
> trying to build the entire source of wine/. What's the console command(s) I 
> need to execute in order to get a winecfg.exe or any other single file, 
> executable or otherwise out of the source /preferably not overwriting the 
> real one in use/?
Build Wine once, then cd into the directory (i.e. programs/winecfg) and issue a 'make' everytime you 
changed source files, make will only rebuilt those object files and link to the rest of the build. 
Then run wine with
LD_LIBRARY_PATH=/pathtoyourwinetree/libs /pathtoyourwinetree/wine something.exe... here's an example 
from a shell script I used during development:
make; WINEDEBUG=loaddll,all,snoop,eng LD_LIBRARY_PATH=/home/google-soc/wine-git/libs \
/home/google-soc/wine-git/wine printfile.exe "Canon PIXMA iP3000" &> printfile.log

> Question 2: The cpls/any additional executables that have to be added to wine 
> have to be in source form (duh!). Any particular quirks I should know about?
> Say, example.exe has to be created when wine is built; it goes into "c:
> \windows\system32". Is there anything special (some obscure settings?) that 
> needs to be done in order for "./tools/wineinstall" and 
I have no clue about that, but here's a hint: the gnu tools are your friends. Study the grep manual 
page.. f.e. grep -nIErC3 'foo[1-9]*' . will recursively (-r) search all non-binary (-I) files within 
the current directory (.) and output any matches like foo42 with three lines of context (-C3) and 
line number (-n). Very very handy working with wine. Also if you have the KDE libs installed, try 
kscope, an incredible useful tool for C-development.

last but not least, compiler messages in quotes fed into a search engine often results in useful 
hints but you may have to dig a bit.. :)
regards, marcel.


From thestig at google.com  Thu Mar 20 11:31:13 2008
From: thestig at google.com (Lei Zhang)
Date: Thu, 20 Mar 2008 09:31:13 -0700
Subject: developing hints appreciated
In-Reply-To: <47E28D24.1000000@gmx.net>
References: <200803201705.51626.pure_evil@mail.bg> <47E28D24.1000000@gmx.net>
Message-ID: <558b2f5c0803200931w35dc8087i31c7fe0bb8901cfe@mail.gmail.com>

On Thu, Mar 20, 2008 at 9:13 AM, Marcel Partap <mpartap at gmx.net> wrote:
> > but it seems I didn't quite understand the rules of
>   > the dev on wine/ or on linux for that matter :(
>  > I need someone to show me the ropes...
>  > Basically, The Toolbox.
>  Last year THAT was my biggest initial problem as well. There are really a few caveats you will most
>  probably hit (seems to me I hit ALL of them at some point *g) so if you do just drop me a message
>  and I'll try and help, so is anyone on winehackers and this mailing list.

Can you be more specific on what the issues are here? Just curious.


From stefan at codeweavers.com  Thu Mar 20 11:21:08 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 20 Mar 2008 17:21:08 +0100
Subject: developing hints appreciated
In-Reply-To: <200803201705.51626.pure_evil@mail.bg>
References: <200803201705.51626.pure_evil@mail.bg>
Message-ID: <200803201721.08898.stefan@codeweavers.com>

Am Donnerstag, 20. M?rz 2008 16:05:51 schrieb pure_evil at mail.bg:
> Question 1: I need to mess about with winecfg. I want to compile only
> winecfg.exe so I can immediately see when I made a mistake /rather than
> trying to build the entire source of wine/. What's the console command(s) I
> need to execute in order to get a winecfg.exe or any other single file,
> executable or otherwise out of the source /preferably not overwriting the
> real one in use/?
I use it mainly as a mesure of saving compile time, so I am not quite sure if 
it does what you want. But you can compile just the programs/winecfg 
subdirectory in the wine source, and run wine via /path/to/winesrc/wine 
winecfg, and it will run your new winecfg program. This saves you the time of 
make checking all directories, as well as the "make install" time.

> Question 2: The cpls/any additional executables that have to be added to
> wine have to be in source form (duh!). Any particular quirks I should know
> about? Say, example.exe has to be created when wine is built; it goes into
> "c: \windows\system32". Is there anything special (some obscure settings?)
> that needs to be done in order for "./tools/wineinstall" and
> then "wineprefixcreate" to create "c:\windows\system32\example.exe" out of
> the source located in "<winesource>/programs/example"?
I think that's done in wine.inf, but I am not sure. Wine itself does not need 
anything in C:\windows\system32, this is mainly done for Windows applications 
that check if the file is present and check the version. You do not have to 
put fake DLLs in there for wine-private things.




From dank at kegel.com  Thu Mar 20 12:11:15 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 10:11:15 -0700
Subject: developing hints appreciated
Message-ID: <a71bd89a0803201011r1efea1b2m3aec77f2de9d06bf@mail.gmail.com>

I think he's a windows developer, comfortable mostly
with IDEs like Visual C++.  He'd like to build winecfg
as a .exe on Wine, test it there, and also try running
it on Windows (at least part of it should kinda work there).

Here's what I told him:

On Ubuntu, 'sudo apt-get install mingw' should install a good compiler.
However, it might not be easy to build winecfg with mingw.
Ask on wine-devel if you have trouble.  See also
http://wiki.winehq.org/JohnKlehm
http://www.winehq.org/pipermail/wine-devel/2006-December/053069.html
If I were you, I'd just use Wine's normal build system on linux
and not even try to generate .exe's for now.
- Dan


From maxspamemail at gmail.com  Thu Mar 20 13:21:25 2008
From: maxspamemail at gmail.com (Max99x)
Date: Thu, 20 Mar 2008 11:21:25 -0700 (PDT)
Subject: GSoC: reg.exe
Message-ID: <16185690.post@talk.nabble.com>


Greetings,

I've noticed Wine is participating in GSoC and one of the ideas is an OSS
implementation of reg.exe. I'm very interested in working on this project,
but looking around the list it seems the stub was posted only a few days
ago, and the author is willing to work on it in the future (I believe a
patch was added even today). Does that mean the project is no longer free
for grabs?
-- 
View this message in context: http://www.nabble.com/GSoC%3A-reg.exe-tp16185690p16185690.html
Sent from the Wine - Devel mailing list archive at Nabble.com.



From austinenglish at gmail.com  Thu Mar 20 14:32:23 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 20 Mar 2008 14:32:23 -0500
Subject: Website: Update PC-BSD download link and icon
Message-ID: <b6bb06270803201232x3da43d5qf2ee629757516c0a@mail.gmail.com>

Any reason this patch wasn't applied?

http://www.winehq.org/pipermail/wine-patches/2008-March/051747.html


From m.b.lankhorst at gmail.com  Thu Mar 20 15:34:21 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 20 Mar 2008 13:34:21 -0700
Subject: quartz: Replace second EnterCriticalSection with
	LeaveCriticalSection (Smatch).
In-Reply-To: <20080320201527.GA18245@redhat.com>
References: <20080320201527.GA18245@redhat.com>
Message-ID: <b130c85e0803201334m30cd87c0w2ec50353a9382081@mail.gmail.com>

Hi Michael,

2008/3/20, Michael Stefaniuc <mstefani at redhat.de>:
>  This looks like an cut'n'paste error to me.
>
>  -    EnterCriticalSection(This->crst);
>  +    LeaveCriticalSection(This->crst);
Many thanks for catching that!

Cheers,
Maarten.


From dank at kegel.com  Thu Mar 20 16:45:47 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 14:45:47 -0700
Subject: GSoC: reg.exe
Message-ID: <a71bd89a0803201445k65ab0bbfi32a138341a8a16ca@mail.gmail.com>

> [Somebody is already working on reg.exe.]
> Does that mean the project is no longer free for grabs?

It depends.  The SoC staff frown on joint projects, but
it's possible.  I would suggest looking at other useful
commandline utilities (see e.g. the list at
http://commandwindows.com ) and check wine's bugzilla
to see if any have been requested, and then propose those.
- Dan


From julliard at winehq.org  Thu Mar 20 17:28:50 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 Mar 2008 23:28:50 +0100
Subject: loader: more stringent sanity check
In-Reply-To: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	(Dan Kegel's message of "Thu, 20 Mar 2008 14:15:18 -0700")
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
Message-ID: <87wsnxowrh.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> +    if (!strcmp( argv[1], "--nosanitycheck" ))
> +    {
> +        perform_sanity_check = 0;
> +
> +        /* Delete --nosanitycheck from argv */
> +
> +        /* Size of argv before is argc +1 for argv[0], +1 for argv[argc]=0 */
> +        /* Size of argv afterwards is one less */
> +        argv = malloc((argc + 1) * sizeof (char *));	
> +        argv[0] = (*pargv)[0];
> +        memcpy(argv+1, *pargv + 2, argc * sizeof(char *));  /* final 0, too */
> +        argc--;
> +        *pargc = argc;
> +        *pargv = argv;
> +    }
> +
> +    if (perform_sanity_check && !geteuid())
> +    {
> +        fprintf( stderr, "%s\n%s\n",
> +          "Please don't run wine as root!  See http://wiki.winehq.org/NoRoot",
> +           usage );
> +        exit(1);
> +    }

I hope you are not seriously suggesting that we do this...

I'm not at all convinced that we need even a warning, there doesn't seem
to be much concrete evidence that running as root is actually harmful,
and it's necessary in many cases. Refusing to run is clearly not an
option.

If we really need to have something then it should be at most a one-time
warning (in a message box so people have a chance to see it) at
wineprefixcreate time, with an easy way to disable it.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Thu Mar 20 17:41:00 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 15:41:00 -0700
Subject: loader: more stringent sanity check
In-Reply-To: <87wsnxowrh.fsf@wine.dyndns.org>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
Message-ID: <a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>

On Thu, Mar 20, 2008 at 3:28 PM, Alexandre Julliard <julliard at winehq.org> wrote:
>  I hope you are not seriously suggesting that we do this...

Seriously.

>  I'm not at all convinced that we need even a warning, there doesn't seem
>  to be much concrete evidence that running as root is actually harmful,

Many, many newbies are running wine as root without
really needing to.  They are much more likely to screw
up their systems this way.  Are you saying we should stop
advising against this?

>  and it's necessary in many cases. Refusing to run is clearly not an
>  option.

That's why the override is provided.

>  If we really need to have something then it should be at most a one-time
>  warning (in a message box so people have a chance to see it) at
>  wineprefixcreate time, with an easy way to disable it.

Then the newbies will just click past it.
- Dan


From mstefani at redhat.com  Thu Mar 20 17:55:43 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 20 Mar 2008 23:55:43 +0100
Subject: loader: more stringent sanity check
In-Reply-To: <a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
Message-ID: <47E2EB6F.6020401@redhat.com>

Dan Kegel wrote:
> On Thu, Mar 20, 2008 at 3:28 PM, Alexandre Julliard <julliard at winehq.org> wrote:
>>  I hope you are not seriously suggesting that we do this...
> 
> Seriously.
> 
>>  I'm not at all convinced that we need even a warning, there doesn't seem
>>  to be much concrete evidence that running as root is actually harmful,
> 
> Many, many newbies are running wine as root without
> really needing to.  They are much more likely to screw
> up their systems this way.  Are you saying we should stop
> advising against this?
They are working as root. They are screwed already! Though I would keep
the warning.

>>  and it's necessary in many cases. Refusing to run is clearly not an
>>  option.
> 
> That's why the override is provided.
> 
>>  If we really need to have something then it should be at most a one-time
>>  warning (in a message box so people have a chance to see it) at
>>  wineprefixcreate time, with an easy way to disable it.
> 
> Then the newbies will just click past it.
Put in a timer forcing the people to read it for 10 to 20 seconds. If
they click past that and still go on ... *shrug*. Welcome to the real
world: they are screwed already so let them screw them self up a little
bit more if they want. Freedom of choice.

bye
	michael


From dank at kegel.com  Thu Mar 20 18:04:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 16:04:18 -0700
Subject: loader: more stringent sanity check
In-Reply-To: <47E2EB6F.6020401@redhat.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<47E2EB6F.6020401@redhat.com>
Message-ID: <a71bd89a0803201604y3e4fce3cwd536fc03a918ebf4@mail.gmail.com>

On Thu, Mar 20, 2008 at 3:55 PM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>  >>  If we really need to have something then it should be at most a one-time
>  >>  warning (in a message box so people have a chance to see it) at
>  >>  wineprefixcreate time, with an easy way to disable it.
>  >
>  > Then the newbies will just click past it.
>
>  Put in a timer forcing the people to read it for 10 to 20 seconds. If
>  they click past that and still go on ... *shrug*. Welcome to the real
>  world: they are screwed already so let them screw them self up a little
>  bit more if they want.

We want to minimize power user annoyance
while also minimizing newbie system damage
and number of posts in wine-users saying "never run wine as root".

Four ideas are on the table:
- do nothing (but then wine-users is intolerable)
- just tell people in wine-users "don't tell people to not run wine as
root" (but that's poor practice)
- have wine abort (possibly with a gui warning) if run as root without
--nosanitycheck (but that might annoy power users)
- same, but put the check in wineprefixcreate (but newbies might bypass this)

Although I suspect users will just bypass the check if it's
only in wineprefixcreate, I'll code up that approach, it's
better than nothing, and Alexandre might go for it.
- Dan


From butterwell at gmail.com  Thu Mar 20 18:11:44 2008
From: butterwell at gmail.com (Christopher Buck)
Date: Thu, 20 Mar 2008 17:11:44 -0600
Subject: loader: more stringent sanity check
In-Reply-To: <a71bd89a0803201604y3e4fce3cwd536fc03a918ebf4@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<47E2EB6F.6020401@redhat.com>
	<a71bd89a0803201604y3e4fce3cwd536fc03a918ebf4@mail.gmail.com>
Message-ID: <2c95cb3f0803201611w498387a2h98619dc885072c5f@mail.gmail.com>

Strictly speaking, running as root is a OS level issue, not a wine
issue.   That being said, wine is being friendly if it notes the
possible issues with running as root.  That being said, letting the
user know the bypass switch or  when wine doesn't start up right away
is also friendly.

Perhaps we should be telling newbies how run "not as root", but that's
even further into the "it's not a wine issue" territory.

-Buck

On Thu, Mar 20, 2008 at 5:04 PM, Dan Kegel <dank at kegel.com> wrote:
> On Thu, Mar 20, 2008 at 3:55 PM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>  >  >>  If we really need to have something then it should be at most a one-time
>  >  >>  warning (in a message box so people have a chance to see it) at
>  >  >>  wineprefixcreate time, with an easy way to disable it.
>  >  >
>  >  > Then the newbies will just click past it.
>  >
>  >  Put in a timer forcing the people to read it for 10 to 20 seconds. If
>  >  they click past that and still go on ... *shrug*. Welcome to the real
>  >  world: they are screwed already so let them screw them self up a little
>  >  bit more if they want.
>
>  We want to minimize power user annoyance
>  while also minimizing newbie system damage
>  and number of posts in wine-users saying "never run wine as root".
>
>  Four ideas are on the table:
>  - do nothing (but then wine-users is intolerable)
>  - just tell people in wine-users "don't tell people to not run wine as
>  root" (but that's poor practice)
>  - have wine abort (possibly with a gui warning) if run as root without
>  --nosanitycheck (but that might annoy power users)
>  - same, but put the check in wineprefixcreate (but newbies might bypass this)
>
>  Although I suspect users will just bypass the check if it's
>  only in wineprefixcreate, I'll code up that approach, it's
>  better than nothing, and Alexandre might go for it.
>  - Dan
>
>
>


From dank at kegel.com  Thu Mar 20 18:21:59 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 16:21:59 -0700
Subject: loader: more stringent sanity check
In-Reply-To: <2c95cb3f0803201611w498387a2h98619dc885072c5f@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<47E2EB6F.6020401@redhat.com>
	<a71bd89a0803201604y3e4fce3cwd536fc03a918ebf4@mail.gmail.com>
	<2c95cb3f0803201611w498387a2h98619dc885072c5f@mail.gmail.com>
Message-ID: <a71bd89a0803201621x1b6fa1d3t82c49367ea0ca3ca@mail.gmail.com>

On Thu, Mar 20, 2008 at 4:11 PM, Christopher Buck <butterwell at gmail.com> wrote:
> Strictly speaking, running as root is a OS level issue, not a wine
> issue.

Wine is a newbie magnet, though; it's what pulls a lot of
Windows users onto this OS.  So it's kind of our fault,
it's best if we clean up the mess at the source...


From marcus at jet.franken.de  Thu Mar 20 18:28:34 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Fri, 21 Mar 2008 00:28:34 +0100
Subject: loader: more stringent sanity check
In-Reply-To: <a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
Message-ID: <20080320232833.GA5617@galeere>

On Thu, Mar 20, 2008 at 03:41:00PM -0700, Dan Kegel wrote:
> On Thu, Mar 20, 2008 at 3:28 PM, Alexandre Julliard <julliard at winehq.org> wrote:
> >  I hope you are not seriously suggesting that we do this...
> 
> Seriously.
> 
> >  I'm not at all convinced that we need even a warning, there doesn't seem
> >  to be much concrete evidence that running as root is actually harmful,
> 
> Many, many newbies are running wine as root without
> really needing to.  They are much more likely to screw
> up their systems this way.  Are you saying we should stop
> advising against this?

QUestion is ... Why do they do this?

Ciao, Marcus


From dank at kegel.com  Thu Mar 20 18:37:03 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 16:37:03 -0700
Subject: loader: more stringent sanity check
In-Reply-To: <20080320232833.GA5617@galeere>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
Message-ID: <a71bd89a0803201637k3a2bd694xbe74e8a88befb9d4@mail.gmail.com>

On Thu, Mar 20, 2008 at 4:28 PM, Marcus Meissner <marcus at jet.franken.de> wrote:
>  > Many, many newbies are running wine as root without
>  > really needing to.
>
>  QUestion is ... Why do they do this?

They don't know any better...


From thestig at google.com  Thu Mar 20 18:40:00 2008
From: thestig at google.com (Lei Zhang)
Date: Thu, 20 Mar 2008 16:40:00 -0700
Subject: loader: more stringent sanity check
In-Reply-To: <20080320232833.GA5617@galeere>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
Message-ID: <558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>

On Thu, Mar 20, 2008 at 4:28 PM, Marcus Meissner <marcus at jet.franken.de> wrote:
> On Thu, Mar 20, 2008 at 03:41:00PM -0700, Dan Kegel wrote:
>  > On Thu, Mar 20, 2008 at 3:28 PM, Alexandre Julliard <julliard at winehq.org> wrote:
>  > >  I hope you are not seriously suggesting that we do this...
>  >
>  > Seriously.
>  >
>  > >  I'm not at all convinced that we need even a warning, there doesn't seem
>  > >  to be much concrete evidence that running as root is actually harmful,
>  >
>  > Many, many newbies are running wine as root without
>  > really needing to.  They are much more likely to screw
>  > up their systems this way.  Are you saying we should stop
>  > advising against this?
>
>  QUestion is ... Why do they do this?
>
>  Ciao, Marcus
>
>
>

On Ubuntu, you cannot even login as root, they'd have to run "sudo
wine". On many other distros, if you login as root, you'll get a
dialog warning you about it, and the desktop background will be bright
red. Are people going out of their way to run Wine as root?


From austinenglish at gmail.com  Thu Mar 20 19:39:22 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 20 Mar 2008 19:39:22 -0500
Subject: loader: more stringent sanity check
In-Reply-To: <558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
	<558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
Message-ID: <b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>

On Thu, Mar 20, 2008 at 6:40 PM, Lei Zhang <thestig at google.com> wrote:
>  On Ubuntu, you cannot even login as root, they'd have to run "sudo
>  wine". On many other distros, if you login as root, you'll get a
>  dialog warning you about it, and the desktop background will be bright
>  red. Are people going out of their way to run Wine as root?
>

I suspect it's more often people sudo'ing. I haven't tried it, but I
know that Alexandre committed a fix that checks if you're running with
sudo after the inital .wine directory is made, but I'm not sure about
what happens if you do it initially. I.e.,
$ wineprefixcreate
$ sudo wine notepad # gives an error about permissions

but does:

$ rm -rf ~/.wine
$ sudo wine notepad

give the same error (not at home or else I'd check).

Something should be done regardless, I'd personally rather see a gui
warning each time wine is run as root without a switch, but at least
if it is done at wineprefixcreate, then it'll catch most (and the
permissions check should catch those that run sudo on their user's
.wine directory). Those two efforts combined should catch most issues,
IMHO.


From ivg231 at gmail.com  Thu Mar 20 21:07:48 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Thu, 20 Mar 2008 22:07:48 -0400
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803201400.24280.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803200213.14491.stefan@codeweavers.com>
	<47E1ED4B.9000309@gmail.com>
	<200803201400.24280.stefan@codeweavers.com>
Message-ID: <47E31874.4000206@gmail.com>


> Henri once suggested making the shader_backend_t structure a COM object, that 
> is created and destroyed by the device. That would make the state of the data 
> it manages clearer(belongs to the shader object), though it would add some 
> stuff we don't need, like the IUnknown parts, refcounting. If we did that we 
> could call the "shader function routing" "inheritance" and are well within 
> OOP slang again.
>   
Yes, what you are doing is exactly inheritance - whether it's done 
through COM or not doesn't really matter.

However, since there are 3 base things to inherit from (arb, glsl, 
none), you're inheriting each of them and now you have 6 "backends". It 
seems that the base functionality is fairly independent of the derived 
functionality, so that's why I suggested composition over inheritance 
here. I understand you're concerned with linking vertex and fragment 
together - but that should probably go in a separate object.
> My concern is that if we break up the shader structure into multiple 
> objects(e.g. vertex shader handler, pixel shader handler, fixed function 
> vertex replacement, fixed function pipeline replacement, depth blit handler, 
> pipeline linker), then we'll get simple single objects, but the putting these 
> parts together adds more complexity than we save in the first place. Often in 
> OOP programs(and other paradigms as well) you don't know what one component 
> does without knowing the whole program.
>   
Sure, there are always tradeoffs - it's your call, I'm just offering a 
semi-informed opinion :)

I'm sure any approach will be successful in the end, but it will be 
interesting to see how code that's written now scales to GL3, D3D10, 
geometry shaders, and upcoming extensions. In that respect, it seems 
like a good idea to try an ATIfs backend now as a test of the underlying 
framework.

Ivan












From jjmckenzie51 at sprintpcs.com  Thu Mar 20 22:31:36 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Thu, 20 Mar 2008 20:31:36 -0700
Subject: Make XP emulation the default?
In-Reply-To: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>
References: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>
Message-ID: <47E32C18.4070706@sprintpcs.com>

Dan Kegel wrote:
> What would break if we made XP the default windows version in Wine?
>
> I've run into several apps that fail to install unless I change that
> setting lately...
>
>
>   
+1 to making XP the default.  Windows98 and Windows2000 are no longer 
supported by Microsoft, leaving XP as the last supported Windows OS for 
Home Users.

James McKenzie



From wine-devel at kievinfo.com  Thu Mar 20 22:48:31 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Thu, 20 Mar 2008 21:48:31 -0600
Subject: loader: more stringent sanity check
In-Reply-To: <b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>	<87wsnxowrh.fsf@wine.dyndns.org>	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>	<20080320232833.GA5617@galeere>	<558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
	<b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
Message-ID: <47E3300F.4080209@kievinfo.com>

Austin English wrote:
> On Thu, Mar 20, 2008 at 6:40 PM, Lei Zhang <thestig at google.com> wrote:
>>  On Ubuntu, you cannot even login as root, they'd have to run "sudo
>>  wine". On many other distros, if you login as root, you'll get a
>>  dialog warning you about it, and the desktop background will be bright
>>  red. Are people going out of their way to run Wine as root?
>>
> 
> I suspect it's more often people sudo'ing. I haven't tried it, but I
> know that Alexandre committed a fix that checks if you're running with
> sudo after the inital .wine directory is made, but I'm not sure about
> what happens if you do it initially. I.e.,
> $ wineprefixcreate
> $ sudo wine notepad # gives an error about permissions
> 
> but does:
> 
> $ rm -rf ~/.wine
> $ sudo wine notepad
> 
> give the same error (not at home or else I'd check).
> 
> Something should be done regardless, I'd personally rather see a gui
> warning each time wine is run as root without a switch, but at least
> if it is done at wineprefixcreate, then it'll catch most (and the
> permissions check should catch those that run sudo on their user's
> .wine directory). Those two efforts combined should catch most issues,
> IMHO.
> 
> 
GUI warning won't work - in some configurations root does not have $DISPLAY 
defined. So if a users logs in as a normal user then tries to do "sudo wine" 
it will be limited to text terminal only.

That btw is the main reason why we have to stop Wine from being run as a root.

Vitaliy.


From truiken at gmail.com  Fri Mar 21 00:09:36 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 20 Mar 2008 22:09:36 -0700
Subject: Make XP emulation the default?
In-Reply-To: <47E32C18.4070706@sprintpcs.com>
References: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>
	<47E32C18.4070706@sprintpcs.com>
Message-ID: <22821af30803202209y74cf2becw4c3fe1a37df1e973@mail.gmail.com>

On Thu, Mar 20, 2008 at 8:31 PM, James McKenzie
<jjmckenzie51 at sprintpcs.com> wrote:
>
> Dan Kegel wrote:
>  > What would break if we made XP the default windows version in Wine?
>  >
>  > I've run into several apps that fail to install unless I change that
>  > setting lately...
>  >
>  >
>  >
>  +1 to making XP the default.  Windows98 and Windows2000 are no longer
>  supported by Microsoft, leaving XP as the last supported Windows OS for
>  Home Users.
>

xp is default in git.

-- 
James Hawkins


From truiken at gmail.com  Fri Mar 21 00:21:11 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 20 Mar 2008 22:21:11 -0700
Subject: [Bug 12131] New: Need a 1.2.0 milestone
In-Reply-To: <bug-12131-11@http.bugs.winehq.org/>
References: <bug-12131-11@http.bugs.winehq.org/>
Message-ID: <22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>

On Thu, Mar 20, 2008 at 9:40 PM,  <wine-bugs at winehq.org> wrote:
> http://bugs.winehq.org/show_bug.cgi?id=12131
>
>            Summary: Need a 1.2.0 milestone
>            Product: WineHQ Bugzilla
>            Version: unspecified
>           Platform: Other
>         OS/Version: other
>             Status: NEW
>           Severity: enhancement
>           Priority: P2
>          Component: bugzilla-unknown
>         AssignedTo: wine-bugs at winehq.org
>         ReportedBy: dank at kegel.com
>
>
>  Please create a 1.2.0 target in bugzilla.
>
>  I've requested it a few times on the mailing list,
>  but it hasn't been created, so I'm trying it
>  on bugzilla now.
>

This is related to the problem, but there needs to be at least one
other bugzilla super-admin.  The only active bugzilla admin I know of
is Jan Zerebecki, and he is not online enough to keep up with the pace
of wine development, especially this close to the 1.0 release.  Who is
in charge of this and can add another super-admin?

-- 
James Hawkins


From xixsimplicityxix at gmail.com  Fri Mar 21 01:45:40 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 21 Mar 2008 01:45:40 -0500
Subject: [Bug 12131] New: Need a 1.2.0 milestone
In-Reply-To: <22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>
References: <bug-12131-11@http.bugs.winehq.org/>
	<22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>
Message-ID: <78a7dad00803202345h725a32c9x4d6c0d64e6566788@mail.gmail.com>

>  This is related to the problem, but there needs to be at least one
>  other bugzilla super-admin.  The only active bugzilla admin I know of
>  is Jan Zerebecki, and he is not online enough to keep up with the pace
>  of wine development, especially this close to the 1.0 release.  Who is
>  in charge of this and can add another super-admin?
>
>  --
>  James Hawkins

Maybe we could keep a list of the admins for wine collab tools on a
wiki page so people would know who to contact about stuff?

http://wiki.winehq.org/WhosWho

--John


From truiken at gmail.com  Fri Mar 21 02:03:09 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 21 Mar 2008 00:03:09 -0700
Subject: [Bug 12131] New: Need a 1.2.0 milestone
In-Reply-To: <78a7dad00803202345h725a32c9x4d6c0d64e6566788@mail.gmail.com>
References: <bug-12131-11@http.bugs.winehq.org/>
	<22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>
	<78a7dad00803202345h725a32c9x4d6c0d64e6566788@mail.gmail.com>
Message-ID: <22821af30803210003i6067e7abn134b0ec72a4b174d@mail.gmail.com>

On Thu, Mar 20, 2008 at 11:45 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> >  This is related to the problem, but there needs to be at least one
>  >  other bugzilla super-admin.  The only active bugzilla admin I know of
>  >  is Jan Zerebecki, and he is not online enough to keep up with the pace
>  >  of wine development, especially this close to the 1.0 release.  Who is
>  >  in charge of this and can add another super-admin?
>  >
>  >  --
>  >  James Hawkins
>
>  Maybe we could keep a list of the admins for wine collab tools on a
>  wiki page so people would know who to contact about stuff?
>
>  http://wiki.winehq.org/WhosWho
>

We know who the admins are.  The issue is that none of the current
super-admins (Jan and Tony that I know of) keep up with wine-devel on
a daily basis.  We need another admin, and this has been the case for
some time.

-- 
James Hawkins


From marcus at jet.franken.de  Fri Mar 21 03:28:18 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Fri, 21 Mar 2008 09:28:18 +0100
Subject: wineprefixcreate: more stringent sanity check (try 2)
In-Reply-To: <a71bd89a0803201725w407d58afre1c56775025ae617@mail.gmail.com>
References: <a71bd89a0803201725w407d58afre1c56775025ae617@mail.gmail.com>
Message-ID: <20080321082818.GB5617@galeere>

On Thu, Mar 20, 2008 at 05:25:12PM -0700, Dan Kegel wrote:
> (Moved check to wineprefixcreate as Alexandre suggested.)
> 
> Many newbies mistakenly run wine as root.  Catch
> this in wineprefixcreate and direct them to the wiki.
> Power users can bypass the check with --nosanitycheck.
> Fixes the remainder of http://bugs.winehq.org/show_bug.cgi?id=10324

> +if [ $do_sanitycheck = 1 ] && [ -w / ]; then 
> +    cat > /tmp/wineprefixcreate.$$.txt <<_EOF

Bad from a security point of view at least, its predictable
and should perhaps be removed later on.

Pass it directly as argument to botyh xmessage and echo I would say.

txt=<<EOL
...here the text ...
EOL

xmessage ... "$txt"

Ciao, Marcus


From marcus at jet.franken.de  Fri Mar 21 03:30:42 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Fri, 21 Mar 2008 09:30:42 +0100
Subject: loader: more stringent sanity check
In-Reply-To: <47E3300F.4080209@kievinfo.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
	<558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
	<b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
	<47E3300F.4080209@kievinfo.com>
Message-ID: <20080321083042.GC5617@galeere>

On Thu, Mar 20, 2008 at 09:48:31PM -0600, Vitaliy Margolen wrote:
> Austin English wrote:
> > On Thu, Mar 20, 2008 at 6:40 PM, Lei Zhang <thestig at google.com> wrote:
> >>  On Ubuntu, you cannot even login as root, they'd have to run "sudo
> >>  wine". On many other distros, if you login as root, you'll get a
> >>  dialog warning you about it, and the desktop background will be bright
> >>  red. Are people going out of their way to run Wine as root?
> >>
> > 
> > I suspect it's more often people sudo'ing. I haven't tried it, but I
> > know that Alexandre committed a fix that checks if you're running with
> > sudo after the inital .wine directory is made, but I'm not sure about
> > what happens if you do it initially. I.e.,
> > $ wineprefixcreate
> > $ sudo wine notepad # gives an error about permissions
> > 
> > but does:
> > 
> > $ rm -rf ~/.wine
> > $ sudo wine notepad
> > 
> > give the same error (not at home or else I'd check).
> > 
> > Something should be done regardless, I'd personally rather see a gui
> > warning each time wine is run as root without a switch, but at least
> > if it is done at wineprefixcreate, then it'll catch most (and the
> > permissions check should catch those that run sudo on their user's
> > .wine directory). Those two efforts combined should catch most issues,
> > IMHO.
> > 
> > 
> GUI warning won't work - in some configurations root does not have $DISPLAY 
> defined. So if a users logs in as a normal user then tries to do "sudo wine" 
> it will be limited to text terminal only.
> 
> That btw is the main reason why we have to stop Wine from being run as a root.

And the question still stands, why they think "sudo root" is necessary for Wine ...

We want to definitely fix the misconception in the users heads / documentation
in the Internet.

eg on http://appdb.winehq.org/objectManager.php?sClass=version&iId=9297&iTestingId=15991
like google just gave me... *sigh*

Ciao, Marcus


From julliard at winehq.org  Fri Mar 21 03:32:30 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 21 Mar 2008 09:32:30 +0100
Subject: loader: more stringent sanity check
In-Reply-To: <a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com> (Dan
	Kegel's message of "Thu, 20 Mar 2008 15:41:00 -0700")
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
Message-ID: <87skykpjdt.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> Many, many newbies are running wine as root without
> really needing to.  They are much more likely to screw
> up their systems this way.  Are you saying we should stop
> advising against this?

I have seen very little evidence that anybody screwed up their system by
running Wine as root, I think that's just paranoia. Of course it's
possible in theory, but you can screw up your system by running 'cat' as
root too, that doesn't mean it needs a warning.

Pretty much the only case I'm aware of is someone's system rebooting
because an app was searching through /proc and triggered the watchdog.
That shouldn't be hard to avoid, and it's really minor compared to the
thousands of people who reboot their box as normal users just by
starting OpenGL.

So yes, I'd say stop the "don't run as root" crusade, and fix the actual
problems that running as root causes, if there are any.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Mar 21 03:37:02 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 21 Mar 2008 09:37:02 +0100
Subject: loader: more stringent sanity check
In-Reply-To: <b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
	(Austin English's message of "Thu, 20 Mar 2008 19:39:22 -0500")
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
	<558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
	<b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
Message-ID: <87od98pj69.fsf@wine.dyndns.org>

"Austin English" <austinenglish at gmail.com> writes:

> I suspect it's more often people sudo'ing. I haven't tried it, but I
> know that Alexandre committed a fix that checks if you're running with
> sudo after the inital .wine directory is made, but I'm not sure about
> what happens if you do it initially. I.e.,
> $ wineprefixcreate
> $ sudo wine notepad # gives an error about permissions
>
> but does:
>
> $ rm -rf ~/.wine
> $ sudo wine notepad
>
> give the same error (not at home or else I'd check).

That's a good point, we could certainly prevent running wineprefixcreate
as root in that case too, that would probably solve most of the
problem. Then people have to explicitly login as root, and in that case
I don't think we want a warning at all.

-- 
Alexandre Julliard
julliard at winehq.org


From maxspamemail at gmail.com  Fri Mar 21 03:41:45 2008
From: maxspamemail at gmail.com (Max99x)
Date: Fri, 21 Mar 2008 01:41:45 -0700 (PDT)
Subject: GSoC: reg.exe
In-Reply-To: <a71bd89a0803201445k65ab0bbfi32a138341a8a16ca@mail.gmail.com>
References: <16185690.post@talk.nabble.com>
	<a71bd89a0803201445k65ab0bbfi32a138341a8a16ca@mail.gmail.com>
Message-ID: <16194940.post@talk.nabble.com>


> [Look at other command line utilities]

Thanks for the advice. So far it seems the stuff on the ConsoleConfiguration
wiki page is the only requested config-related console programs. I'd be
interested in implementing ftype.exe and assoc.exe from the list you linked
to, but when reg.exe is completed, they would become pretty redundant - a
shell script would be able to do the same tasks with much less code.
-- 
View this message in context: http://www.nabble.com/GSoC%3A-reg.exe-tp16185690p16194940.html
Sent from the Wine - Devel mailing list archive at Nabble.com.



From austinenglish at gmail.com  Fri Mar 21 03:44:44 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 21 Mar 2008 03:44:44 -0500
Subject: [Bug 12131] New: Need a 1.2.0 milestone
In-Reply-To: <22821af30803210003i6067e7abn134b0ec72a4b174d@mail.gmail.com>
References: <bug-12131-11@http.bugs.winehq.org/>
	<22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>
	<78a7dad00803202345h725a32c9x4d6c0d64e6566788@mail.gmail.com>
	<22821af30803210003i6067e7abn134b0ec72a4b174d@mail.gmail.com>
Message-ID: <b6bb06270803210144x44f96912q7a1f95a18dbc7f0e@mail.gmail.com>

On Fri, Mar 21, 2008 at 2:03 AM, James Hawkins <truiken at gmail.com> wrote:
>  We know who the admins are.  The issue is that none of the current
>  super-admins (Jan and Tony that I know of) keep up with wine-devel on
>  a daily basis.  We need another admin, and this has been the case for
>  some time.
>
>  --
>  James Hawkins
>
>
>

Correct me if I'm wrong, but I thought Dan also had quite a few
bugzilla privs. If not, he's on wine-devel quite a bit/been around a
while...


From hverbeet at gmail.com  Fri Mar 21 03:50:22 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Fri, 21 Mar 2008 09:50:22 +0100
Subject: d3dx9: Implement D3DXCreateRenderToSurface [PATCH 2/7]
In-Reply-To: <E1JcPs0-0006fy-79@www20.emo.freenet-rz.de>
References: <E1JcPs0-0006fy-79@www20.emo.freenet-rz.de>
Message-ID: <d658b69e0803210150r4e4a2691qbd693c56e343c7ef@mail.gmail.com>

On 20/03/2008, tony.wasserka at freenet.de <tony.wasserka at freenet.de> wrote:
> Just a little note: All functions have been coded using the output of WINEDEBUG="d3d9",
>  i.e. my implementation is doing exactly the same things as the native d3dx9 regarding
>  d3d stuff.
It would probably be better to avoid doing that. It isn't quite the
same as disassembling the native implementation, but in general you
want to avoid looking at how the native implementation is implemented
rather than how it behaves.


From ilia.klimov at gmail.com  Fri Mar 21 03:52:45 2008
From: ilia.klimov at gmail.com (Xanf)
Date: Fri, 21 Mar 2008 11:52:45 +0300
Subject: GSoC'08 - Tools - Scriptable Configuration
Message-ID: <4aa399f00803210152j6885fc52t1b89ec51ba485ac3@mail.gmail.com>

Hello, everyone.
My name is Illya  and I'm interested in taking part in GSoC 2008 for
implementing scriptable configuration for wine.

So I'd liked to discuss it with community.

First of all - why I'm interested in that project?

Currently I'm working as a kind of "software consultant" in my city.
My primary The  primary aim of work  - helping migrating from MS
Windows platform to Linux & Open Source. Unfortunately, a great number
of different applications were written and still heavily used in
companies of my city for Windows. And this is a place where Wine makes
great help.
Need of scriptable configuration is quite critical for helping me
quickly perform standard configuration for some apps, and even more -
make "install packages" which will help users unfamiliar with Wine
quickly run their software.


Now - Why me?
Quite hard question. First of all, I have a personal interest (see
above :) ). Second - now I have strong will and real possibility (as I
estimate) to implement that project. I've looked for projects of
GSoC'07 year ago - and realized that I wasn't ready for them.

Although I'm absolutely new to wine-devel, I've been using Wine (and
no windows at my computer at all) for about a year. I have experience
working on some big projects (it is mangos WoW emulator
(http://mangosproject.org/) and especially ScriptDev2 (scripting
engine for mangos) (http://scriptdev2.com) ). Currently I have strong
skills in reading and understanding code written by others.
I have quite strong C/C++ (mostly C++) skills. I've participated in
ACM contests and received 1 place in Ukraine and we (My team) were in
top-ten in Eastern Europe Region contests.

How I see my future work?
First of all, in short term after this message (possibly on weekend)
if I receive a positive (or at least non-negative response) from
community I plan to create a specification of CLI syntax, which I
expect to be implemented by me, divided in stages to have a
step-by-step working guide. After obtaining community suggestions
that'll become a future work plan for summer. Then I'll spend some
time in wine code reading (I've already have experience in some
"hacking" for my brother's favorite games, but I need some time for
deeper understanding). And after that - the work will start. I expect
to make a weekly "reports" how the work going on, and create a series
of patches for each step defined above.

Thanks for reading probably a bit long letter, and sorry for possibly
bad English - it is far away from my mother tongue.

Best regards,
Illya Klimov


From hverbeet at gmail.com  Fri Mar 21 03:53:53 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Fri, 21 Mar 2008 09:53:53 +0100
Subject: d3dx9: Implement ID3DXRenderToSurface_EndScene [PATCH 6/7]
In-Reply-To: <E1JcQ0Z-00037d-Pp@www19.emo.freenet-rz.de>
References: <E1JcQ0Z-00037d-Pp@www19.emo.freenet-rz.de>
Message-ID: <d658b69e0803210153k474a9761t1de709b0bfbb673c@mail.gmail.com>

On 20/03/2008, tony.wasserka at freenet.de <tony.wasserka at freenet.de> wrote:
> ...and clean up everything again.
>  I have no idea why it's StretchRect and not UpdateSurface or something, but the native dll is doing it like this.
>
>  +        /* The native d3dx9 does a buffer->GetDevice(&bufdev) here.
...and that's pretty much unacceptable.


From austinenglish at gmail.com  Fri Mar 21 03:56:08 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 21 Mar 2008 03:56:08 -0500
Subject: loader: more stringent sanity check
In-Reply-To: <87od98pj69.fsf@wine.dyndns.org>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
	<558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
	<b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
	<87od98pj69.fsf@wine.dyndns.org>
Message-ID: <b6bb06270803210156x37ce054foe4d32c4c45f63d91@mail.gmail.com>

On Fri, Mar 21, 2008 at 3:37 AM, Alexandre Julliard <julliard at winehq.org> wrote:
> "Austin English" <austinenglish at gmail.com> writes:
>
>  > I suspect it's more often people sudo'ing. I haven't tried it, but I
>  > know that Alexandre committed a fix that checks if you're running with
>  > sudo after the inital .wine directory is made, but I'm not sure about
>  > what happens if you do it initially. I.e.,
>  > $ wineprefixcreate
>  > $ sudo wine notepad # gives an error about permissions
>  >
>  > but does:
>  >
>  > $ rm -rf ~/.wine
>  > $ sudo wine notepad

Just tested this:
$ wineprefixcreate
$ sudo wine notepad
Fails with 'wine: /home/austin/.wine is not owned by you'

$ rm -rf ~/.wine
$ sudo wineprefixcreate
$ wine notepad
Fails with 'wine: /home/austin/.wine is not owned by you'

But:
$ rm -rf ~/.wine
$ sudo wine notepad
Works fine. Until you attempt to run wine as a normal user at least...

>  That's a good point, we could certainly prevent running wineprefixcreate
>  as root in that case too, that would probably solve most of the
>  problem. Then people have to explicitly login as root, and in that case
>  I don't think we want a warning at all.

Agreed. IMHO, we should not permit running wineprefixcreate with sudo
(or any other wine commands), but if someone explicitly logs in as
root, they (hopefully) know what they're doing. Running sudo on a
current wine directory already issues a warning. While it may be
paranoia based, I prefer to think of it as a preventative precaution,
since in due time (if measures aren't taken) someone's bound to take a
windows virus and screw up  a *nix machine severely. Might as well
prevent it early (especially well in advance of 1.0.0. It doesn't take
much effort, and prevents a lot of headache.


From hverbeet at gmail.com  Fri Mar 21 03:56:58 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Fri, 21 Mar 2008 09:56:58 +0100
Subject: d3dx9: Implement ID3DXRenderToSurface_OnLostDevice/OnResetDevice
	[PATCH 7/7]
In-Reply-To: <E1JcQ3s-0006Fz-Kp@www13.emo.freenet-rz.de>
References: <E1JcQ3s-0006Fz-Kp@www13.emo.freenet-rz.de>
Message-ID: <d658b69e0803210156o46786a33ua3068f4b0fbac4b3@mail.gmail.com>

On 20/03/2008, tony.wasserka at freenet.de <tony.wasserka at freenet.de> wrote:
> These are not very interesting...
>  On winehackers I was told that under wine the device won't ever get invalid anyways so these patches are just
>  for having the implementation complete.
>
It might be true that on wine the device never becomes invalid, but
that might not always remain true, and IMO our d3dx9 dlls should work
on native win32 as well.


From madscientist343 at gmail.com  Thu Mar 20 15:10:30 2008
From: madscientist343 at gmail.com (Mad Scientist)
Date: Thu, 20 Mar 2008 16:10:30 -0400
Subject: GSoC application
Message-ID: <e8dd149b0803201310v49d88891vcb601615e9eb53fd@mail.gmail.com>

Hello wine-devel,
I would like to submit my GSoC application link:
http://wiki.winehq.org/LouisLadas?action=show
Thanks :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080320/8977ff4f/attachment.htm 

From tony.wasserka at freenet.de  Fri Mar 21 04:10:20 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Fri, 21 Mar 2008 10:10:20 +0100
Subject: Implement ID3DXRenderToSurface*
Message-ID: <E1JcdGW-0001L8-AH@www14.emo.freenet-rz.de>

> It would probably be better to avoid doing that. It isn't quite the
> same as disassembling the native implementation, but in general you
> want to avoid looking at how the native implementation is implemented
> rather than how it behaves.
I have to admit that I didn't think of these kind of things, however for
D3DXCreateRenderToSurface this isn't a problem as all what I got
from the output was that I have to call no d3d functions.

> ...and that's pretty much unacceptable.
I see, this will probably need a fixed patch.

> It might be true that on wine the device never becomes invalid, but
> that might not always remain true, and IMO our d3dx9 dlls should work
> on native win32 as well.
The code should run on native windows, too, though it isn't that well tested.
(IMO there isn't much to test about a few release calls anyways).
Also, ResetDevice is the same as D3DXCreateRenderToSurface,
as it doesn't do anything either.

But thank you for the time you spent on reviewing my patches :)

 Best regards
    Tony




Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain inkl.
http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/index.html



From stefan at codeweavers.com  Fri Mar 21 06:48:27 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 21 Mar 2008 12:48:27 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E31874.4000206@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803201400.24280.stefan@codeweavers.com>
	<47E31874.4000206@gmail.com>
Message-ID: <200803211248.27279.stefan@codeweavers.com>

Am Freitag, 21. M?rz 2008 03:07:48 schrieb Ivan Gyurdiev:
> However, since there are 3 base things to inherit from (arb, glsl,
> none), you're inheriting each of them and now you have 6 "backends". It
> seems that the base functionality is fairly independent of the derived
> functionality, so that's why I suggested composition over inheritance
> here. I understand you're concerned with linking vertex and fragment
> together - but that should probably go in a separate object.
Thinking about it a bit more I am less convinced that having a separate linker 
object is going to work, thanks to the different varying handling.

Shader Model 3.0 and earlier versions have different ways to pass varyings 
from vertex to pixel shader. In the end this means that the pixel shader is 
dependent on the vertex shader. If the vertex shader is a GLSL shader, it can 
read either the builtin varyings or the declared ones, the GLSL vertex shader 
writes both and the driver (should) sort it out. If the vertex shader is not 
a GLSL shader, we can only write to builtin varyings, so a GLSL pixel shader 
has to use different code. Currently the GLSL linking code sorts it out, but 
we have dependencies between vertex and pixel shaders. In the end I think at 
least the linker object has to know way too many things about the shaders, 
and the shaders have to know things about each other.

(The visual tests suggest that the ATI driver on Windows does not handle 
pre-3.0 <-> 3.0 shader varying passing properly, but it is in violation of 
the refrast. While that suggests that games are unlikely to depend on this 
tricky behavior, I do not like the idea of justifying our design with an ATI 
driver bug)


From stefan at codeweavers.com  Fri Mar 21 09:20:09 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 21 Mar 2008 15:20:09 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E31874.4000206@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803201400.24280.stefan@codeweavers.com>
	<47E31874.4000206@gmail.com>
Message-ID: <200803211520.09665.stefan@codeweavers.com>

Am Freitag, 21. M?rz 2008 03:07:48 schrieb Ivan Gyurdiev:
> However, since there are 3 base things to inherit from (arb, glsl,
> none), you're inheriting each of them and now you have 6 "backends".
That's what I got rid of in the newest patches I sent to this list.



From felix at compsoc.nuigalway.ie  Fri Mar 21 09:37:28 2008
From: felix at compsoc.nuigalway.ie (Darragh Bailey)
Date: Fri, 21 Mar 2008 14:37:28 +0000
Subject: loader: more stringent sanity check
In-Reply-To: <b6bb06270803210156x37ce054foe4d32c4c45f63d91@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
	<558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
	<b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
	<87od98pj69.fsf@wine.dyndns.org>
	<b6bb06270803210156x37ce054foe4d32c4c45f63d91@mail.gmail.com>
Message-ID: <20080321143728.GB23806@compsoc.nuigalway.ie>

On Fri, Mar 21, 2008 at 03:56:08AM -0500, Austin English wrote:
> On Fri, Mar 21, 2008 at 3:37 AM, Alexandre Julliard <julliard at winehq.org> wrote:
<snipped>
> >  That's a good point, we could certainly prevent running wineprefixcreate
> >  as root in that case too, that would probably solve most of the
> >  problem. Then people have to explicitly login as root, and in that case
> >  I don't think we want a warning at all.
> 
> Agreed. IMHO, we should not permit running wineprefixcreate with sudo
> (or any other wine commands), but if someone explicitly logs in as
> root, they (hopefully) know what they're doing. Running sudo on a
> current wine directory already issues a warning. While it may be
> paranoia based, I prefer to think of it as a preventative precaution,
> since in due time (if measures aren't taken) someone's bound to take a
> windows virus and screw up  a *nix machine severely. Might as well
> prevent it early (especially well in advance of 1.0.0. It doesn't take
> much effort, and prevents a lot of headache.


I recall seeing an application intended to be run only by normal user
popping up a warning message if started by root. If I recall correctly
it didn't prevent the app from running, but was just a warning against
running the app as root unless you really, really have a good reason to,
with a timer for a couple of seconds to allow the user to abort the
opperation. If the user didn't do anything it would continue on after
timeout.

I think that would help avoid a lot users unnecessarily running wine as
root. It would also get the message out that it's not necessary.

-- 
Darragh

"Nothing is foolproof to a sufficiently talented fool."


From dank at kegel.com  Fri Mar 21 09:51:25 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 21 Mar 2008 07:51:25 -0700
Subject: [Bug 12131] New: Need a 1.2.0 milestone
In-Reply-To: <b6bb06270803210144x44f96912q7a1f95a18dbc7f0e@mail.gmail.com>
References: <bug-12131-11@http.bugs.winehq.org/>
	<22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>
	<78a7dad00803202345h725a32c9x4d6c0d64e6566788@mail.gmail.com>
	<22821af30803210003i6067e7abn134b0ec72a4b174d@mail.gmail.com>
	<b6bb06270803210144x44f96912q7a1f95a18dbc7f0e@mail.gmail.com>
Message-ID: <a71bd89a0803210751u16074ebct853ba1871e7327bd@mail.gmail.com>

On Fri, Mar 21, 2008 at 1:44 AM, Austin English <austinenglish at gmail.com> wrote:
> On Fri, Mar 21, 2008 at 2:03 AM, James Hawkins <truiken at gmail.com> wrote:
>  >  We know who the admins are.  The issue is that none of the current
>  >  super-admins (Jan and Tony that I know of) keep up with wine-devel on
>  >  a daily basis.  We need another admin, and this has been the case for
>  >  some time.
>
>  Correct me if I'm wrong, but I thought Dan also had quite a few
>  bugzilla privs. If not, he's on wine-devel quite a bit/been around a
>  while...

Jan says I've got privs.  Now if somebody would only show me
how to use them :-)


From ivg231 at gmail.com  Fri Mar 21 10:22:41 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Fri, 21 Mar 2008 11:22:41 -0400
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803211248.27279.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803201400.24280.stefan@codeweavers.com>
	<47E31874.4000206@gmail.com>
	<200803211248.27279.stefan@codeweavers.com>
Message-ID: <47E3D2C1.5020000@gmail.com>


> Shader Model 3.0 and earlier versions have different ways to pass varyings 
> from vertex to pixel shader. In the end this means that the pixel shader is 
> dependent on the vertex shader. If the vertex shader is a GLSL shader, it can 
> read either the builtin varyings or the declared ones, the GLSL vertex shader 
> writes both and the driver (should) sort it out. If the vertex shader is not 
> a GLSL shader, we can only write to builtin varyings, so a GLSL pixel shader 
> has to use different code. Currently the GLSL linking code sorts it out, but 
> we have dependencies between vertex and pixel shaders. In the end I think at 
> least the linker object has to know way too many things about the shaders, 
> and the shaders have to know things about each other.
>   
You mean the code in generate_param_reoder_function ? That's exactly the 
kind of thing that should go in a "linker" object - it takes as input a 
vertex and pixel shader, and handles how they talk to each other.  The 
"semantics" map is the interface between them that describes varyings - 
of course the interface has to be available to the linker to read the 
vertex outputs and make decisions as to the pixel inputs . Your "linker" 
could be backend-independent and try to support odd combinations like  
software vs / glsl ps or something like that, or it could be 
glsl-specific, and basically know how to link one glsl vertex shader to 
one glsl pixel shader (you could use a different linker for other things).

Why is the vertex/pixel linkage related to how you generated the vertex 
(or pixel) shader ? Does it matter if your shader was created from the 
fixed or programmable interface on the d3d-side in order to link it to 
the other one?

How will geometry shaders fit into the picture ?

Ivan



From stefan at codeweavers.com  Fri Mar 21 10:40:14 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 21 Mar 2008 16:40:14 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E3D2C1.5020000@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803211248.27279.stefan@codeweavers.com>
	<47E3D2C1.5020000@gmail.com>
Message-ID: <200803211640.15141.stefan@codeweavers.com>

Am Freitag, 21. M?rz 2008 16:22:41 schrieb Ivan Gyurdiev:
> > Shader Model 3.0 and earlier versions have different ways to pass
> > varyings from vertex to pixel shader. In the end this means that the
> > pixel shader is dependent on the vertex shader. If the vertex shader is a
> > GLSL shader, it can read either the builtin varyings or the declared
> > ones, the GLSL vertex shader writes both and the driver (should) sort it
> > out. If the vertex shader is not a GLSL shader, we can only write to
> > builtin varyings, so a GLSL pixel shader has to use different code.
> > Currently the GLSL linking code sorts it out, but we have dependencies
> > between vertex and pixel shaders. In the end I think at least the linker
> > object has to know way too many things about the shaders, and the shaders
> > have to know things about each other.
>
> You mean the code in generate_param_reoder_function ?
No, I mean pshader_glsl_input_pack, or rather its callers. As for the 
generate_param_reoder_function you're perfectly right, it is part of the 
linking code.

> Why is the vertex/pixel linkage related to how you generated the vertex
> (or pixel) shader ? Does it matter if your shader was created from the
> fixed or programmable interface on the d3d-side in order to link it to
> the other one?
It matters wether or not the vertex shader writes to the implicit opengl 
varyings(gl_TexCoord[], gl_Color, gl_SecondaryColor, ... in GLSL terms,  
output.* in ARB terms) or custom varyings("varying vec4 foo" in GLSL). If 
both shaders are GLSL, everything's fine, the vertex shader writes to both 
and lets the linker and the driver sort things out. But if the vertex 
processing is non-GLSL(fixed function, ARB or whatever), and the D3D pixel 
shader needs custom varyings(3.0 shader), then the GLSL fragment shader has 
to fetch them from the implicit varyings.


From dank at kegel.com  Fri Mar 21 11:29:22 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 21 Mar 2008 09:29:22 -0700
Subject: GSoC'08 - Tools - Scriptable Configuration
Message-ID: <a71bd89a0803210929p7109c4acu8efc1251c71fcda@mail.gmail.com>

Illya wrote:
>Currently I'm working as a kind of "software consultant" in my city.
>My primary The  primary aim of work  - helping migrating from MS
>Windows platform to Linux & Open Source. Unfortunately, a great number
>of different applications were written and still heavily used in
>companies of my city for Windows. And this is a place where Wine
>makes great help.
>Need of scriptable configuration is quite critical for helping me
>quickly perform standard configuration for some apps, and even more -
>make "install packages" which will help users unfamiliar with Wine
>quickly run their software.

Can you give some examples?

This sounds kind of like the wine-robot, wine-doors, and wpkg.org
efforts.  And there might be a lot of overlap with the
automated application test idea from
http://wiki.winehq.org/SummerOfCode
- Dan


From mpartap at gmx.net  Fri Mar 21 11:44:20 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Fri, 21 Mar 2008 17:44:20 +0100
Subject: developing hints appreciated
In-Reply-To: <558b2f5c0803200931w35dc8087i31c7fe0bb8901cfe@mail.gmail.com>
References: <200803201705.51626.pure_evil@mail.bg> <47E28D24.1000000@gmx.net>
	<558b2f5c0803200931w35dc8087i31c7fe0bb8901cfe@mail.gmail.com>
Message-ID: <47E3E5E4.7090204@gmx.net>

 > Can you be more specific on what the issues are here? Just curious.
Well.. basically everything that goes beyond compiling small one-file programs not using the win32api :)
I have to add that i didn't start hacking wine as first step but built an exe file outside of wine, 
so everything that is managed by the wine build system I had to find out by trial and error 
approach.. cross compiling linker flags, win32isms, pointer stuff, c macro syntax, grasping the nt 
printing subsystem.. it really was a tough way from start to.. well the finish line has yet to be 
crossed. Jesse and me will have to cooperate on getting our work merged into wine 1.1. I haven't 
worked on my code for more then three months and first have to check out a current git and look into 
the changes that went into x11drv and what that means for the eventual implementation of a git engine.
Having said that it was a very difficult thing to do and I am nowhere near personal satisfaction 
about my outcome, it was a great experience and VERY VERY valuable to me. After first being 
introduced to 'real' (complex) programs during the SoC time I am now starting to feel comfortable 
coding and will commit some small code changes to various FOSS projects (wine, kde, vlc, drupal..) 
in the next few months. And wearing that shirt just totally rulez. :D
sincerely,
marcel

-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>




From truiken at gmail.com  Fri Mar 21 12:12:34 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 21 Mar 2008 10:12:34 -0700
Subject: GSoC'08 - Tools - Scriptable Configuration
In-Reply-To: <4aa399f00803210152j6885fc52t1b89ec51ba485ac3@mail.gmail.com>
References: <4aa399f00803210152j6885fc52t1b89ec51ba485ac3@mail.gmail.com>
Message-ID: <22821af30803211012g53c180b0j8e57109c5c49bab7@mail.gmail.com>

On Fri, Mar 21, 2008 at 1:52 AM, Xanf <ilia.klimov at gmail.com> wrote:
> Hello, everyone.
>  My name is Illya  and I'm interested in taking part in GSoC 2008 for
>  implementing scriptable configuration for wine.
>
>  So I'd liked to discuss it with community.
>
>  First of all - why I'm interested in that project?
>
>  Currently I'm working as a kind of "software consultant" in my city.
>  My primary The  primary aim of work  - helping migrating from MS
>  Windows platform to Linux & Open Source. Unfortunately, a great number
>  of different applications were written and still heavily used in
>  companies of my city for Windows. And this is a place where Wine makes
>  great help.
>

Are you a student at a university?

-- 
James Hawkins


From ken at codeweavers.com  Fri Mar 21 12:41:17 2008
From: ken at codeweavers.com (Ken Thomases)
Date: Fri, 21 Mar 2008 12:41:17 -0500
Subject: winex11.drv: Indirection level fix
In-Reply-To: <200803211530.01744.andrew.talbot@talbotville.com>
References: <200803211530.01744.andrew.talbot@talbotville.com>
Message-ID: <96B08A1C-F87E-4846-A4DD-FA78057EFD03@codeweavers.com>

On Mar 21, 2008, at 10:30 AM, Andrew Talbot wrote:
> It seems that either "packet" should not be a WTPACKET **, or the  
> first
> parameter to the memcpy() should be *packet. Unable to find this  
> function being
> used anywhere, I guessed the former.

It's used in dlls/wintab32/wintab32.c via pGetCurrentPacket and you  
appear to have guessed correctly.

Cheers,
Ken


From raccoonone at procyongames.com  Fri Mar 21 14:16:55 2008
From: raccoonone at procyongames.com (Christopher)
Date: Fri, 21 Mar 2008 12:16:55 -0700
Subject: AppDB?
Message-ID: <47E409A7.1060209@procyongames.com>

Who's in charge of AppDB? I sent in a couple requests a week ago, and 
they still haven't been approved (or denied). The first was for a new 
application, PhoenixRC, which I'll be happy to maintain. And the other 
was for a new vendor, Mozy, Inc., so that I could update MozyHome to 
have the correct vendor.
Christopher


From dank at kegel.com  Fri Mar 21 16:13:10 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 21 Mar 2008 14:13:10 -0700
Subject: GSoC application
Message-ID: <a71bd89a0803211413y297794bcs63f4e248cbd4da5e@mail.gmail.com>

> I would like to submit my GSoC application link:
> http://wiki.winehq.org/LouisLadas

Hi Louis,
you should probably look for a couple backup apps to
implement as I suggested to the other applicant here:
http://winehq.org/pipermail/wine-devel/2008-March/063828.html

Have you already built wine from source?

Also, no reason to wait for SoC to start; you should
consider submitting patches ahead of time,
it'll help you ramp up.
- Dan


From Andrew.Talbot at talbotville.com  Fri Mar 21 16:16:36 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Fri, 21 Mar 2008 21:16:36 +0000
Subject: winex11.drv: Indirection level fix
References: <200803211530.01744.andrew.talbot@talbotville.com>
	<96B08A1C-F87E-4846-A4DD-FA78057EFD03@codeweavers.com>
Message-ID: <fs18jk$hsf$1@ger.gmane.org>

Ken Thomases wrote:

> It's used in dlls/wintab32/wintab32.c via pGetCurrentPacket and you
> appear to have guessed correctly.
> 
> Cheers,
> Ken

Looking good! Thanks for this, Ken.

-- 
Andy.



From stefan at codeweavers.com  Fri Mar 21 16:58:16 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 21 Mar 2008 22:58:16 +0100
Subject: 5/6 WineD3D: CheckDeviceFormat texture
In-Reply-To: <20080321210717.191010@gmx.net>
References: <20080321210717.191010@gmx.net>
Message-ID: <200803212258.16824.stefan@codeweavers.com>

Am Freitag, 21. M?rz 2008 22:07:17 schrieb Roderick Colenbrander:
> Hi,
>
> Don't continue with CheckDeviceFormat if a texture format isn't around.
What happens with volumetextures here?


From stefan at codeweavers.com  Fri Mar 21 17:03:01 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 21 Mar 2008 23:03:01 +0100
Subject: 6/6 WineD3D: CheckDeviceFormat remove dead code
In-Reply-To: <20080321211148.191010@gmx.net>
References: <20080321211148.191010@gmx.net>
Message-ID: <200803212303.01096.stefan@codeweavers.com>

Am Freitag, 21. M?rz 2008 22:11:48 schrieb Roderick Colenbrander:
> I expect a number of other 'fake' regressions like the one regarding srgb
> writing but those can only become visible after this patch.
Note that we perfectly well support srgb writing on all formats if ARB or GLSL 
pixel shaders are supported. We emulate the srgb correction in the shader

Note that this is not 100% there, if the game is using the fixed function 
fragment pipeline we currently have no ARB or GLSL pixel shader which could 
do the gamma correction. However, many games(like HL2) require srgb 
correction, so we should keep it enabled.


From stefan at codeweavers.com  Fri Mar 21 17:04:51 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 21 Mar 2008 23:04:51 +0100
Subject: 7/6 WineD3D: CheckDeviceFormat srgb write support
In-Reply-To: <20080321214905.191020@gmx.net>
References: <20080321214905.191020@gmx.net>
Message-ID: <200803212304.51826.stefan@codeweavers.com>

Am Freitag, 21. M?rz 2008 22:49:05 schrieb Roderick Colenbrander:
> Hi,
>
> This patch adds srgb write support to CheckDeviceFormat. Before we
> implicitly allowed it. Stefan said that we offer it using ARB/GLSL shaders
> when the format is X8R8G8B8 or A8R8G8B8.
Ah, looks like you were faster than I was with replying :-)

Did you check which formats offer srgb writing on Windows? Our pixel shader 
code offers it for all formats, although srgb correction is pretty pointless 
on float buffers


From jeroen.janssen at gmail.com  Fri Mar 21 16:06:24 2008
From: jeroen.janssen at gmail.com (Jeroen Janssen)
Date: Fri, 21 Mar 2008 21:06:24 +0000 (UTC)
Subject: wine + mono instead of .net framework?
Message-ID: <loom.20080321T210200-541@post.gmane.org>

Hi,

I was wondering if it is possible to use mono instead of the (microsoft) .net
framework for windows applications running under wine.

i.e. I have an application that 'requires' .net 2.0, and wants me to install it.
With mono 'installed' it would see that .net 2.0 is "already installed" and just
work ;)

Any thoughts on if this is possible (or even wanted?)

Best regards,

Jeroen Janssen



From xixsimplicityxix at gmail.com  Fri Mar 21 17:40:30 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 21 Mar 2008 17:40:30 -0500
Subject: wine + mono instead of .net framework?
In-Reply-To: <loom.20080321T210200-541@post.gmane.org>
References: <loom.20080321T210200-541@post.gmane.org>
Message-ID: <78a7dad00803211540s4c3e0d17nd2fb29ea8cf63da6@mail.gmail.com>

On Fri, Mar 21, 2008 at 4:06 PM, Jeroen Janssen
<jeroen.janssen at gmail.com> wrote:
> Hi,
>
>  I was wondering if it is possible to use mono instead of the (microsoft) .net
>  framework for windows applications running under wine.
>
>  i.e. I have an application that 'requires' .net 2.0, and wants me to install it.
>  With mono 'installed' it would see that .net 2.0 is "already installed" and just
>  work ;)
>
>  Any thoughts on if this is possible (or even wanted?)
>

Sure is. Simplest way is to grab the win32 installer from the mono page:
http://www.go-mono.com/mono-downloads/download.html

Tracked in appdb here:
http://appdb.winehq.org/objectManager.php?sClass=application&iId=4982

Or if you have winetricks it supports installing mono too:
http://wiki.winehq.org/winetricks

--John


From jan.wine at zerebecki.de  Fri Mar 21 17:59:40 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Fri, 21 Mar 2008 23:59:40 +0100
Subject: GSoC: reg.exe
In-Reply-To: <a71bd89a0803201445k65ab0bbfi32a138341a8a16ca@mail.gmail.com>
References: <a71bd89a0803201445k65ab0bbfi32a138341a8a16ca@mail.gmail.com>
Message-ID: <20080321225940.GL3557@crissy.swd.zerebecki.de>

On Thu, Mar 20, 2008 at 02:45:47PM -0700, Dan Kegel wrote:
> > [Somebody is already working on reg.exe.]
> > Does that mean the project is no longer free for grabs?
> It depends.  The SoC staff frown on joint projects, but
> it's possible.

It seem that Andrew Riedi, the author of the reg.exe stub woun't
participate in this years GSoC and is willing to leave work to a
GSoC student. I suppose that can be cleanly enough separated so
that it couldn't be seen as a joint project anymore than the
whole Wine itself.

I have no idea how much work there is in a reg.exe
implementation... but if there is (or will be) enough left that
means this project is still free.


Jan



From thunderbird2k at gmx.net  Fri Mar 21 18:06:26 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sat, 22 Mar 2008 00:06:26 +0100
Subject: 5/6 WineD3D: CheckDeviceFormat texture
In-Reply-To: <200803212258.16824.stefan@codeweavers.com>
References: <20080321210717.191010@gmx.net>
	<200803212258.16824.stefan@codeweavers.com>
Message-ID: <20080321230626.106920@gmx.net>

> > Hi,
> >
> > Don't continue with CheckDeviceFormat if a texture format isn't around.
> What happens with volumetextures here?
> 
This is already handled for Volume textures.

Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.gmx.net/de/entertainment/games/free


From thunderbird2k at gmx.net  Fri Mar 21 18:20:05 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sat, 22 Mar 2008 00:20:05 +0100
Subject: 7/6 WineD3D: CheckDeviceFormat srgb write support
In-Reply-To: <200803212304.51826.stefan@codeweavers.com>
References: <20080321214905.191020@gmx.net>
	<200803212304.51826.stefan@codeweavers.com>
Message-ID: <20080321232005.106920@gmx.net>

> > Hi,
> >
> > This patch adds srgb write support to CheckDeviceFormat. Before we
> > implicitly allowed it. Stefan said that we offer it using ARB/GLSL
> shaders
> > when the format is X8R8G8B8 or A8R8G8B8.
> Ah, looks like you were faster than I was with replying :-)
> 
> Did you check which formats offer srgb writing on Windows? Our pixel
> shader 
> code offers it for all formats, although srgb correction is pretty
> pointless 
> on float buffers
> 

The geforce7/8 offer it on R5G6B5 and the *8R8G8B8 formats. Not sure about ati or intel but I think ati at least offers it on 32bit formats.

Roderick
-- 
GMX startet ShortView.de. Hier findest Du Leute mit Deinen Interessen!
Jetzt dabei sein: http://www.shortview.de/?mc=sv_ext_mf at gmx


From austinenglish at gmail.com  Fri Mar 21 19:03:03 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 21 Mar 2008 19:03:03 -0500
Subject: Fun Projects page - needs update
Message-ID: <b6bb06270803211703s43ce8a1cgda7c8c3dbfe83703@mail.gmail.com>

Looking at http://winehq.org/site/fun_projects, A LOT of it is out of
date. I've been looking through the documentation and starting to
update some of it, but this is one I don't know too much about. Would
everyone mind taking a look and updating whatever they know is
fixed/what they're working on/etc. Perhaps we should move this to the
wiki...If not, send me an e-mail and I'll update it for you.

-Austin


From thunderbird2k at gmx.net  Fri Mar 21 18:20:05 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sat, 22 Mar 2008 00:20:05 +0100
Subject: 7/6 WineD3D: CheckDeviceFormat srgb write support
In-Reply-To: <200803212304.51826.stefan@codeweavers.com>
References: <20080321214905.191020@gmx.net>
	<200803212304.51826.stefan@codeweavers.com>
Message-ID: <20080321232005.106920@gmx.net>

> > Hi,
> >
> > This patch adds srgb write support to CheckDeviceFormat. Before we
> > implicitly allowed it. Stefan said that we offer it using ARB/GLSL
> shaders
> > when the format is X8R8G8B8 or A8R8G8B8.
> Ah, looks like you were faster than I was with replying :-)
> 
> Did you check which formats offer srgb writing on Windows? Our pixel
> shader 
> code offers it for all formats, although srgb correction is pretty
> pointless 
> on float buffers
> 

The geforce7/8 offer it on R5G6B5 and the *8R8G8B8 formats. Not sure about ati or intel but I think ati at least offers it on 32bit formats.

Roderick
-- 
GMX startet ShortView.de. Hier findest Du Leute mit Deinen Interessen!
Jetzt dabei sein: http://www.shortview.de/?mc=sv_ext_mf at gmx


From austinenglish at gmail.com  Fri Mar 21 20:19:12 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 21 Mar 2008 20:19:12 -0500
Subject: bug_report.pl
Message-ID: <b6bb06270803211819j7dabbcfek9bec850134c64465@mail.gmail.com>

In cleaning up the documentation, I found that we still reference
tools/bug_report.pl. The script is about 8-9 years old! I haven't seen
it referenced in a while, and looking in the archives, the last time
it was mentioned was in 2002:
http://www.winehq.org/pipermail/wine-devel/2002-May/006741.html

Which even then, some thought it should be removed, or drastically
updated. It currently strips down to 100 lines, which in most cases is
pretty useless. As I see it, there are a couple options (which,
coincidentally, were the same 6 years ago):
1) remove bug_report.pl, update the documentation for more useful debug info
2) have a perl mongerer update it drastically to where it is of some use.

Thoughts?


From truiken at gmail.com  Fri Mar 21 21:12:56 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 21 Mar 2008 19:12:56 -0700
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
In-Reply-To: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
References: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
Message-ID: <22821af30803211912x3929f20bkd446382996a9084a@mail.gmail.com>

On Fri, Mar 21, 2008 at 6:43 PM, Dan Kegel <dank at kegel.com> wrote:
> While investigating a crash in gs-auftrag in bug 9039, noticed
>  WideCharToMultiByte
>  wasn't quite conformant for negative destlen.  Fixed, with tests.
>

> diff --git a/dlls/kernel32/locale.c b/dlls/kernel32/locale.c
> index 1130349..2decf85 100644
> --- a/dlls/kernel32/locale.c
> +++ b/dlls/kernel32/locale.c
> @@ -31,6 +31,7 @@ #include <stdarg.h>
>  #include <stdio.h>
>  #include <ctype.h>
>  #include <stdlib.h>
> +#include <limits.h>
>
>  #ifdef __APPLE__
>  # include <CoreFoundation/CFBundle.h>

Leftover from a previous version of the patch?

-- 
James Hawkins


From dank at kegel.com  Fri Mar 21 22:21:59 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 21 Mar 2008 20:21:59 -0700
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
In-Reply-To: <22821af30803211912x3929f20bkd446382996a9084a@mail.gmail.com>
References: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
	<22821af30803211912x3929f20bkd446382996a9084a@mail.gmail.com>
Message-ID: <a71bd89a0803212021k641a302er1add00f7cf90416c@mail.gmail.com>

On Fri, Mar 21, 2008 at 7:12 PM, James Hawkins <truiken at gmail.com> wrote:
>  > +#include <limits.h>
>
>  Leftover from a previous version of the patch?

Whoops, yes.  I'll resend it Monday.


From kai.blin at gmail.com  Sat Mar 22 03:46:47 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Sat, 22 Mar 2008 09:46:47 +0100
Subject: Wine1.0 and LGPLv3?
In-Reply-To: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>
References: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>
Message-ID: <200803220946.51144.kai.blin@gmail.com>

On Wednesday 19 March 2008 15:01:54 Ian Macfarlane wrote:
> Just to resurrect this topic, as last time, of the responses to my email,
> two were positive (and the other just pointed out that I'd mistaken the
> Samba licensing for LGPL instead of GPL) but nothing else happened after
> that.

I think the agreement from WineConf 2007 was to change as soon as there's a 
reason to do so. So far it seems like there isn't.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080322/5c63c150/attachment.pgp 

From julliard at winehq.org  Sat Mar 22 07:20:39 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 22 Mar 2008 13:20:39 +0100
Subject: quartz: Parse audio packets in mpeg splitter to obtain the
	duration
In-Reply-To: <b130c85e0803211853p664f6370mc30129f853665fa5@mail.gmail.com>
	(Maarten Lankhorst's message of "Fri, 21 Mar 2008 18:53:25 -0700")
References: <b130c85e0803211853p664f6370mc30129f853665fa5@mail.gmail.com>
Message-ID: <87ve3frluw.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> +    /* Destination sample should contain no data! But the source sample should */
> +    assert(!dlen);
> +    assert(*flen);

Are all these asserts really internal code invariants?  It seems to me
they could be triggered by invalid input data, and in that case an
assert is not the appropriate response.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Sat Mar 22 09:21:05 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 22 Mar 2008 07:21:05 -0700
Subject: wine 1.0 status: T minus 76 days. 87 open bugs.
Message-ID: <a71bd89a0803220721w37dbbb02xd3d6ab2e7ff0eccc@mail.gmail.com>

76 days to go before release.

I'm slowly going through the 1.0 bug list and deferring bugs
that only affect single non-required apps and don't have good analysis
or patches,
or that can't be fixed in time.  e.g. I deferred bug 6971 (Mouse
"escapes" window)
even though lots of people voted for it, simply because it probably
requires changes
in X.

As of now we're down to 87 bugs.  My guess is we'll eventually fix 30
or so of these
(about ten look easy), and the other 57 or so will be deferred.
Here's the list, sorted
by component:

# 	 Comp  	 Votes  	 Summary
5948 	-unknown 	1 	Star Trek: Armada does not install
4971 	-unknown 	3 	Corel Draw 12 demo install fails
12097 	-unknown 	1 	Wine 1.0 should not ship out-of-sync resource translations
5055 	-unknown 	5 	Deleting files from a window in wine doesn't send
them to the Trash
11281 	-unknown 	2 	CJK input many issues
7477 	-unknown 	1 	Uplink demo crashes
7915 	-unknown 	4 	15 of the internal tests of wine fail on Mac OS X
5402 	-unknown 	0 	Trying to run PhotoStitch 3.1
8125 	-unknown 	0 	Marratech 6.1 crashes on start
9916 	-unknown 	5 	"make test" usually fails
5024 	-unknown 	3 	Thief: Deadly Shadows crashes:page fault on read
access to 0x0000040c
7404 	-unknown 	2 	ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
9459 	-unknown 	8 	FIFA 2007 crashes with the recent versions
5061 	-unknown 	5 	Copying from Windows Firefox in Wine and pasting to
Linux OpenOffice pastes metadata as data
5844 	-unknown 	8 	tray minimize
10815 	-unknown 	1 	Cannot drag images into Adobe Photoshop 7 from the
web / desktop
9178 	-unknown 	8 	"hello world" dos program hangs
10147 	-unknown 	0 	Word Viewer 2003 - Tab behavior differs from Windows
9959 	-unknown 	8 	Make wine updates work even if the registry changed
556 	build-en 	2 	Reconcile the Windows and Wine spec files
1114 	comctl32 	2 	Winrar2.90/3.00: Comboex doesn't trigger a event
when you mouse-click in some value of it
10111 	comctl32 	2 	WINEDEBUG=warn+heap "make test" has heap error in
comdlg32/tests/printdlg.c
2493 	comctl32 	1 	Multi-select listview: Shift-arrow up only selects
top two items
9104 	comdlg32 	1 	Pdf-xchange viewer crashes
11681 	directx- 	11 	Add support for video overlay
9030 	directx- 	0 	army men hangs on black screen
5955 	directx- 	6 	DirectDrawCreate crash on non-OpenGL desktop
1347 	directx- 	20 	Screen is wiped/blanked on usage of DirectDraw
5535 	directx- 	16 	Planescape:Torment doesn't work
82 	document 	1 	Stabilize Winelib User Guide Table of Contents
638 	document 	7 	Document Wine debugging channels
9926 	gdi32 	4 	gdi32.dll should not have exported function pointers
6519 	gdi32 	6 	Wine blacks out rotated font bitmap
9771 	gdi32 	37 	Steam Friends doesn't work (fails to render correctly
or refresh)
3270 	gdi32 	12 	Problem with minimized top-level windows
7571 	gdi32 	1 	Accented character glyphs are mixed up with TrueType
fonts (affects e.g. Lotus Notes R5)
9484 	kernel32 	17 	Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
5541 	kernel32 	0 	WriteConsole can't write to stdout; affects e.g.
wsh's cscript's usage message
6526 	kernel32 	1 	Typing Instructor for Kids 2 fails to install
9039 	kernel32 	0 	GS-Auftrag Professional SQL aborts on startup
5351 	kernel32 	8 	Windows Installer 3.1 cannot install because of
non-standard drive labeling
4733 	kernel32 	4 	Get optimized/compressed/packed executables (non-upx) working
7098 	mscoree 	1 	RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
5163 	msi 	11 	Office XP 2002 crashes on installation
8783 	ntdll 	11 	USB serial ports do not work
9356 	ntdll 	5 	Serial communication not working since wine-0.9.33
6607 	ole 	6 	Drag and Drop not working
9942 	ole 	2 	Powerpoint Viewer 2007 crashes opening .pptx files
2539 	ole 	2 	XDND (Drag and drop for X Windows) doesn't copy text
8095 	ole 	0 	PQ Teaching toy crashes
4770 	ole 	2 	BlackBerry Device Manager fails to install under wine
5926 	programs 	0 	Wine does not provide an implementation of winhlp32.exe
4803 	programs 	5 	Steam: not all lnk files are processed into linux shortcuts
6254 	richedit 	3 	Installer infinite loop from rich text error
6095 	shdocvw 	11 	MOTD in counter-strike 1.6 and counter-strike
source does not render
6795 	shdocvw 	0 	Skype 3.0.0.137 Beta dies trying to login in win98, winme mode
9304 	shdocvw 	3 	Temple of Elemental Evil demo doesn't start - gui irresponsive
3546 	shdocvw 	2 	CLSID_InternetShortcut not available...
8898 	shdocvw 	0 	Run Time Error "445": Object doesn't support this
action in Europa Knowledgebase
10905 	shell32 	0 	thinstall firefox demo requires native msvcrt
8439 	shell32 	4 	Visual Studio .NET (7) install fails
9809 	shell32 	4 	Autodesk Revit Architecture 2008 install fails
11742 	shlwapi 	8 	Small .net 1.1 app (FastMD5 1.3) fails to start up
12074 	testcase 	2 	The conformance tests fail on Windows
6604 	tools 	2 	Ship icons for the wine-tools that can be used in .desktop files
8246 	urlmon 	2 	invoking htmlhelp:HtmlHelpW crashes wine
10708 	user32 	21 	Wine lacks support for animated cursors
664 	user32 	5 	The help menu functionality inside programs is broken
(messaging problem)
11431 	user32 	5 	Adobe Photoshop CS2: z-overlay of image containers
3023 	user32 	5 	Orcad - "Place Part" never tries to put down a part
4523 	user32 	5 	Can't copy from Firefox 1.5 and paste into OpenOffice
2 under Wine
3534 	user32 	14 	Systray icons are not transparent...
124 	wineserv 	2 	Review of Wine Server Protocol
10984 	winex11. 	2 	sun jre 5 update 10 installer hangs in 0.9.52
7372 	winex11. 	12 	can't copy and paste between gnome apps eg
openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
5623 	winex11. 	2 	GetAsyncKeyState wrong if querying process doesn't have focus
1990 	winex11. 	1 	modifier keys not released when switching desktop
5828 	winex11. 	23 	Command and Conquer Generals (Zero Hour) doesn't
change the mouse cursor from the default X mouse
11884 	winex11. 	1 	Copy and paste garbage on end
3297 	winex11. 	9 	UpdateWindow() doesn't call XFlush()
11019 	winex11. 	1 	matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
2368 	winex11. 	4 	Wine loses its X-Window when switching to another
virt. desktop in Fvwm
3711 	winsock 	0 	Musicmatch fails to install (missing registry key,
HTTP_HttpOpenRequest() problem)
9787 	winsock 	44 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
10032 	winsock 	1 	Wine must not use unix select() for networking
where there might be high fd's
5625 	winsock 	3 	Wine does not handle internet proxy settings conveniently
12005 	wintab32 	0 	Regression in pressure sensitivity with wizardpen
tablet driver and Photoshop 7


From Andrew.Talbot at talbotville.com  Sat Mar 22 09:57:39 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 22 Mar 2008 14:57:39 +0000
Subject: Richedit regression
References: <200803221454.05287.andrew.talbot@talbotville.com>
Message-ID: <fs36p3$pld$1@ger.gmane.org>

Whoops! Sorry, I meant to send this to Eric [Pouech]. D'oh!

-- 
Andy.




From stefan at codeweavers.com  Sat Mar 22 09:59:13 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 22 Mar 2008 15:59:13 +0100
Subject: Richedit regression
In-Reply-To: <200803221454.05287.andrew.talbot@talbotville.com>
References: <200803221454.05287.andrew.talbot@talbotville.com>
Message-ID: <200803221559.13954.stefan@codeweavers.com>

Am Samstag, 22. M?rz 2008 15:54:05 schrieb Andrew Talbot:
> Hi Eric,
>
> An app I use - Blitzin2 - has a richedit control that used to wrap, and
> since your patch "richedit: Added support for EM_SETTARGETDEVICE with a
> NULL DC"
Wrong mailing list?



From Andrew.Talbot at talbotville.com  Sat Mar 22 10:07:23 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 22 Mar 2008 15:07:23 +0000
Subject: Richedit regression
References: <200803221454.05287.andrew.talbot@talbotville.com>
	<200803221559.13954.stefan@codeweavers.com>
Message-ID: <fs37bb$rlo$1@ger.gmane.org>

Stefan D?singer wrote:

> Am Samstag, 22. M?rz 2008 15:54:05 schrieb Andrew Talbot:
>> Hi Eric,
>>
>> An app I use - Blitzin2 - has a richedit control that used to wrap, and
>> since your patch "richedit: Added support for EM_SETTARGETDEVICE with a
>> NULL DC"
> Wrong mailing list?

Wrong address entirely. My patch-sending autopilot kicked in at the wrong
moment. :)

-- 
Andy.




From dank at kegel.com  Sat Mar 22 11:57:59 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 22 Mar 2008 09:57:59 -0700
Subject: Richedit regression
Message-ID: <a71bd89a0803220957s181da44bh294e840d9ca1de23@mail.gmail.com>

 Andrew Talbot wrote:
> An app I use - Blitzin2 - has a richedit control that used to wrap, and since
>  "richedit: Added support for EM_SETTARGETDEVICE with a NULL DC"
> (http://source.winehq.org/git/wine.git/?a=commit;h=33d7cea120bd7d37175cd5c89aa2a66d5c909f37)
> the text gets truncated, instead.

Yep.  I filed http://bugs.winehq.org/show_bug.cgi?id=12098
a while ago, it hits several apps.  Please append your info there.


From wine-devel at kievinfo.com  Sat Mar 22 12:14:40 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 22 Mar 2008 11:14:40 -0600
Subject: Please add new version 0.9.58 to bugzilla & appdb please
Message-ID: <47E53E80.8080207@kievinfo.com>

Please add new version 0.9.58 to bugzilla & appdb please.

Vitaliy.


From Andrew.Talbot at talbotville.com  Sat Mar 22 12:24:26 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 22 Mar 2008 17:24:26 +0000
Subject: Richedit regression
References: <a71bd89a0803220957s181da44bh294e840d9ca1de23@mail.gmail.com>
Message-ID: <fs3fca$l9t$1@ger.gmane.org>

Dan Kegel wrote:

> Yep.  I filed http://bugs.winehq.org/show_bug.cgi?id=12098
> a while ago, it hits several apps.  Please append your info there.

Done.




From stefan at codeweavers.com  Sat Mar 22 14:04:52 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 22 Mar 2008 20:04:52 +0100
Subject: wined3d: Initialize maxAttribs in case it isn't changed by
	glGetIntegerv.
In-Reply-To: <20080322172852.GA16190@zorkmid.localnetwork>
References: <20080322172852.GA16190@zorkmid.localnetwork>
Message-ID: <200803222004.52603.stefan@codeweavers.com>

Am Samstag, 22. M?rz 2008 18:28:52 schrieb Philip Nilsson:
> My OpenGL implementation (NVIDIA's binary driver, version 169.12)
> returns GL_NO_ERROR in this function, but doesn't change the passed
> value.  Uninitialized maxAttribs might be about 1500000 and thus
> generate a couple hundred megabytes of GL_CHECK_CALL errors.
>
> 16 is what is set if glGetIntegerv returns some error, and is also the
> minimum value required by an implementation.
I've seen this behavior very old drivers(87.xx), but I am kinda puzzled why it 
happens with the new drivers. The patch is OK, but we should investigate why 
the call fails for you


From stefan at codeweavers.com  Sat Mar 22 14:04:52 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 22 Mar 2008 20:04:52 +0100
Subject: wined3d: Initialize maxAttribs in case it isn't changed by
	glGetIntegerv.
In-Reply-To: <20080322172852.GA16190@zorkmid.localnetwork>
References: <20080322172852.GA16190@zorkmid.localnetwork>
Message-ID: <200803222004.52603.stefan@codeweavers.com>

Am Samstag, 22. M?rz 2008 18:28:52 schrieb Philip Nilsson:
> My OpenGL implementation (NVIDIA's binary driver, version 169.12)
> returns GL_NO_ERROR in this function, but doesn't change the passed
> value.  Uninitialized maxAttribs might be about 1500000 and thus
> generate a couple hundred megabytes of GL_CHECK_CALL errors.
>
> 16 is what is set if glGetIntegerv returns some error, and is also the
> minimum value required by an implementation.
I've seen this behavior very old drivers(87.xx), but I am kinda puzzled why it 
happens with the new drivers. The patch is OK, but we should investigate why 
the call fails for you


From pnilsson at nullref.se  Sat Mar 22 14:31:24 2008
From: pnilsson at nullref.se (Philip Nilsson)
Date: Sat, 22 Mar 2008 20:31:24 +0100
Subject: wined3d: Initialize maxAttribs in case it isn't changed by
	glGetIntegerv.
In-Reply-To: <200803222004.52603.stefan@codeweavers.com>
References: <20080322172852.GA16190@zorkmid.localnetwork>
	<200803222004.52603.stefan@codeweavers.com>
Message-ID: <20080322193124.GA18198@zorkmid.localnetwork>

On Sat, Mar 22, 2008 at 08:04:52PM +0100, Stefan D?singer wrote:
> Am Samstag, 22. M?rz 2008 18:28:52 schrieb Philip Nilsson:
> > glGetIntegerv
> I've seen this behavior very old drivers(87.xx), but I am kinda puzzled why it 
> happens with the new drivers. The patch is OK, but we should investigate why 
> the call fails for you

It appears to do nothing whichever enum I query.  It doesn't even care
if it's fed (-1, NULL).

I'll try some things.


From wine-devel at kievinfo.com  Sat Mar 22 15:21:29 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 22 Mar 2008 14:21:29 -0600
Subject: Failing user message sequences
Message-ID: <47E56A49.70602@kievinfo.com>

I've looked at the user32/tests/msg.c and there are some number of tests 
that are set to todo_wine. Conincedentaly number of those tests are a 
biggest problems (looking at bugzilla). For example WmSHOWNATopInvisible 
message sequence is failing on Wine because of absent WM_NCPAINT message. 
Could this be the source of the problem for all those full-screen programs 
that are being "lost" when switching between displays or minimizing / 
restoring windows.

I've tried to track this problem down but can't pinpoint the exact location 
where this masage should be sent. Is Wine missing a step somewhere (see 
attachment)? From what I can tell it should be somewhere between mapping the 
window and WM_WINDOWPOSCHANGED notification.

Also worth noting all the MDI tests that fail on Wine. It seems there are 
fair amount of bugs filed that are related to this tests.

IMHO some if not all of those failing tests should be fixed. This is core 
functionality and there are no excuses for not having it working.

I'd say that is much more important them some bugs listed on 1.0 list.

Vitaliy.
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: SW_SHOWNA.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080322/03472c88/attachment.txt 

From wine-devel at kievinfo.com  Sat Mar 22 15:37:39 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 22 Mar 2008 14:37:39 -0600
Subject: Disable editing/deleting/locking posts in wine-forum
Message-ID: <47E56E13.30307@kievinfo.com>

Jeremy,

Could you disable this functionality? It makes no sense with the link to the 
ML where one can't do that. Or now we are getting some users that think they 
can edit the post and everyone can see that.

Vitaliy.


From gynvael at coldwind.pl  Sat Mar 22 16:05:54 2008
From: gynvael at coldwind.pl (Gynvael Coldwind)
Date: Sat, 22 Mar 2008 22:05:54 +0100
Subject: Hello Email
Message-ID: <bd3a94bf0803221405k482ff7b0l3aac2dbb8d5855aa@mail.gmail.com>

Hello Wine Developers,

My name is Michael "Gynvael Coldwind" Skladnikiewicz, and I am
thinking about applying for the Google SoC to work on Wine. Please
excuse my English, I am not a native English speaker.

The first step written on the Wine Ideas page was -introduction-, so..
a little about myself.
I am currently at the Wroclaw Univeristy of Technology (it's
Politechnika Wroc?awska in Polish) on the faculty of Computer Science
and Management (Wydzia? Informatyki i Zarz?dzania), and my field of
study is Computer Science. I am currently at the first year of the
second degree - I already graduated the first degree, and I have the
right to the degree "in?ynier" (it's equal to BSc). I have graduated
the same University, but another faculty - The Fundamental Problems of
Technology Faculty, where my field of study was also Computer Science.
In addition to being a full-time student, I am also working (remotly)
at Hispasec Sistemat, where I am a malware reverse engineer, a
security researcher and a coder (mostly Windows stuff, both user and
kernel mode). Earlier I have worked at Arcabit, a Polish antivirus
company, where I created static unpackers for common PE
crypters/packers.

I started to code when I was about 7 years old (now I'm 24) on an
Atari 800 XL, and as the time passed I've moved to a PC and started to
code in other languages, like C, C++, Java, Assembler, PHP, and many
others. My personal field of interest is computer security (up to date
I have found some vulnerabilities in Mozilla Firefox, Opera, Blizzard
Starcraft, and few others), reverse engineering, computer graphics
(software rendering algorithms and OpenGL mostly), game developement
(and playing ;>), and OS research (mostly I focus on Microsoft
Windows, but I am also interested in Linux and QNX).
Some of my research papers can be found on http://vexillium.org/ and
http://gynvael.vexillium.org/.

I guess that is enough for introducing myself ;>
If You have any questions, don't hesitate to ask ;>

Best regards,
-- 
gynvael.coldwind//vx

From m.b.lankhorst at gmail.com  Sat Mar 22 18:21:58 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sat, 22 Mar 2008 16:21:58 -0700
Subject: quartz: Parse audio packets in mpeg splitter to obtain the duration
In-Reply-To: <b130c85e0803221620m16c70ad2xc952bc87369d18f@mail.gmail.com>
References: <b130c85e0803211853p664f6370mc30129f853665fa5@mail.gmail.com>
	<87ve3frluw.fsf@wine.dyndns.org>
	<b130c85e0803221620m16c70ad2xc952bc87369d18f@mail.gmail.com>
Message-ID: <b130c85e0803221621j2ebd84d6re958ac0e04ca547a@mail.gmail.com>

Hello Alexandre,

2008/3/22, Alexandre Julliard <julliard at winehq.org>:

> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:
>
>  > +    /* Destination sample should contain no data! But the source sample should */
>  > +    assert(!dlen);
>  > +    assert(*flen);
>
>  Are all these asserts really internal code invariants?  It seems to me
>  they could be triggered by invalid input data, and in that case an
>  assert is not the appropriate response.

They are invariants as far as I know, even with corrupt data. Source
sample has a value because that is the condition of the while loop.
The destination sample is empty because the loop makes the length zero
before handing it over. If it somehow had a length larger or equal to
4 (less then 4 is possible and handled) there is something seriously
wrong in the handling code since this should not happen, even in
invalid input.

Cheers,

Maarten.


From dank at kegel.com  Sat Mar 22 21:32:31 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 22 Mar 2008 19:32:31 -0700
Subject: Hello Email
Message-ID: <a71bd89a0803221932y7231542eledae357b986becc3@mail.gmail.com>

Hi Michael!  Any idea what you'll be proposing for SoC yet?


From raccoonone at procyongames.com  Sat Mar 22 22:08:02 2008
From: raccoonone at procyongames.com (Christopher)
Date: Sat, 22 Mar 2008 20:08:02 -0700
Subject: Adding a vendor to AppDB
Message-ID: <47E5C992.50807@procyongames.com>

I sent an email to appdb at winehq.org <mailto:appdb at winehq.org> asking to 
have the vendor "Mozy, Inc." added. Does anyone check that email 
address? I sent my request over a week ago. If anyone can add it for me, 
please add "Mozy, Inc." url=<http://mozy.com/about>. I'm the new 
MozyHome maintainer and the vendor which is listed is wrong.
Thanks,
Christopher Berner

p.s.
I just noticed that I'm not in the AUTHORS file, even though several of 
my patches have been accepted to Wine. Was I suppose to add myself, or 
is that automatically generated (in which case, why did it leave me out?)


From thestig at google.com  Sat Mar 22 22:53:22 2008
From: thestig at google.com (Lei Zhang)
Date: Sat, 22 Mar 2008 20:53:22 -0700
Subject: Adding a vendor to AppDB
In-Reply-To: <47E5C992.50807@procyongames.com>
References: <47E5C992.50807@procyongames.com>
Message-ID: <558b2f5c0803222053j37d5eeabu87851a63681845e7@mail.gmail.com>

On Sat, Mar 22, 2008 at 8:08 PM, Christopher
<raccoonone at procyongames.com> wrote:
>  p.s.
>  I just noticed that I'm not in the AUTHORS file, even though several of
>  my patches have been accepted to Wine. Was I suppose to add myself, or
>  is that automatically generated (in which case, why did it leave me out?)
>

The authors file gets updated about once a year. I'm sure someone will
update it for Wine 1.0.

http://source.winehq.org/git/wine.git/?a=history;f=AUTHORS;h=b72bfe83251e39beb03de98193b91a8707830388;hb=HEAD


From ns03ja at brocku.ca  Sun Mar 23 01:09:37 2008
From: ns03ja at brocku.ca (Neil Skrypuch)
Date: Sun, 23 Mar 2008 02:09:37 -0400
Subject: developing hints appreciated
In-Reply-To: <47E28D24.1000000@gmx.net>
References: <200803201705.51626.pure_evil@mail.bg> <47E28D24.1000000@gmx.net>
Message-ID: <200803230209.37405.ns03ja@brocku.ca>

On Thursday 20 March 2008, Marcel Partap wrote:
> Then run wine with
> LD_LIBRARY_PATH=/pathtoyourwinetree/libs /pathtoyourwinetree/wine
> something.exe...

I'm pretty sure you don't need to set LD_LIBRARY_PATH there, at least I've 
never needed to (and the wine script appears to do that).

- Neil


From m.b.lankhorst at gmail.com  Sun Mar 23 02:20:42 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 23 Mar 2008 00:20:42 -0700
Subject: C&C :D
Message-ID: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>

Hi all!

After an announcement that the original Command and conquer is
available free for download, I decided to test it. Command and Conquer
works perfectly in wine, I haven't tested network gaming over ipx, but
that will probably not work. For the rest it's flawless, apart from
the losing focus behavior, but playing it in a wine desktop helps.

Remember: KANE IS A TRAITOR! LONG LIVE THE GDI!

Cheers,
Maarten.


From thunderbird2k at gmx.net  Sun Mar 23 03:43:58 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 23 Mar 2008 09:43:58 +0100
Subject: Regression fix in directx.c
In-Reply-To: <47E5C94E.40006@gmail.com>
References: <47E5C94E.40006@gmail.com>
Message-ID: <20080323084358.40360@gmx.net>

> The flag that was removed with the patch in the link here:
> http://source.winehq.org/git/wine.git/?a=blobdiff;f=dlls/wined3d/directx.c;h=6665a4201311af5c494a77c64c43598ac84ca332;hp=1c7d9e397b8b02e7817e4c8142e8a63061a36ae3;hb=9e9ef6238a5f27423e28c8f95f69fb02b98d8f27;hpb=5d151c0ffc60627b1d54ae397a83ef1770491d1b
> caused the game "Sins of a solar empire" to not startup anymore.

This is not the right way to fix it. The code is quite new but works very differently from the old code. What videocard are you using? At what color depth? What offscreen rendering method are you using? Further could you provide your glxinfo output?

Thanks,
Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.gmx.net/de/entertainment/games/free


From thunderbird2k at gmx.net  Sun Mar 23 03:47:30 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 23 Mar 2008 09:47:30 +0100
Subject: C&C :D
In-Reply-To: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
References: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
Message-ID: <20080323084730.40340@gmx.net>

> Hi all!
> 
> After an announcement that the original Command and conquer is
> available free for download, I decided to test it. Command and Conquer
> works perfectly in wine, I haven't tested network gaming over ipx, but
> that will probably not work. For the rest it's flawless, apart from
> the losing focus behavior, but playing it in a wine desktop helps.
> 
> Remember: KANE IS A TRAITOR! LONG LIVE THE GDI!
> 
> Cheers,
> Maarten.
> 

Hi Maarten,

It will likely run better if you use DirectDrawRenderer=opengl + RenderTargetLockMode=readtex (at least on Nvidia hardware that is fast). Second IPX network should work (if this is the c&c version with updated ipx) but you need root as plain users don't have enough permissions to create a raw ipx socket.

Roderick
-- 
GMX startet ShortView.de. Hier findest Du Leute mit Deinen Interessen!
Jetzt dabei sein: http://www.shortview.de/?mc=sv_ext_mf at gmx


From thunderbird2k at gmx.net  Sun Mar 23 04:05:25 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 23 Mar 2008 10:05:25 +0100
Subject: Regression fix in directx.c
In-Reply-To: <20080323084344.40340@gmx.net>
References: <47E5C94E.40006@gmail.com> <20080323084344.40340@gmx.net>
Message-ID: <20080323090525.110830@gmx.net>

> > The flag that was removed with the patch in the link here:
> >
> http://source.winehq.org/git/wine.git/?a=blobdiff;f=dlls/wined3d/directx.c;h=6665a4201311af5c494a77c64c43598ac84ca332;hp=1c7d9e397b8b02e7817e4c8142e8a63061a36ae3;hb=9e9ef6238a5f27423e28c8f95f69fb02b98d8f27;hpb=5d151c0ffc60627b1d54ae397a83ef1770491d1b
> > caused the game "Sins of a solar empire" to not startup anymore.
> 
> This is not the right way to fix it. The code is quite new but works very
> differently from the old code. What videocard are you using? At what color
> depth? What offscreen rendering method are you using? Further could you
> provide your glxinfo output?
> 
> Thanks,
> Roderick

Also have you tried the latest GIT version? As there have been a number of CheckDeviceFormat fixes after .58.

Roderick
-- 
Psssst! Schon vom neuen GMX MultiMessenger geh?rt?
Der kann`s mit allen: http://www.gmx.net/de/go/multimessenger


From dank at kegel.com  Sun Mar 23 06:22:07 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 04:22:07 -0700
Subject: crash on exit in hardy on intel graphics?
Message-ID: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>

Grumble.  wineprefixcreate is showing a crash
while running
rundll32.exe setupapi.dll,InstallHinfSection DefaultInstall 128 wine.inf

No traceback is shown normally, but running that command under winedbg
shows one on exit:

Unhandled exception: page fault on read access to 0x00000200 in 32-bit
code (0xb7f03bad).
Register dump:
 CS:0073 SS:007b DS:007b ES:007b FS:0033 GS:003b
 EIP:b7f03bad ESP:0034fa90 EBP:0034fab8 EFLAGS:00010292(   - 00      -RISA1)
 EAX:b7f0bce0 EBX:b7f0bff4 ECX:b7efe5b9 EDX:b7c5e6ac
 ESI:00000000 EDI:00000000
Stack dump:
0x0034fa90:  b7ef0eec b7f0bff4 0034fae0 7c017834
0x0034faa0:  0034fb14 b7efa059 0034fb5c b7c61ff4
0x0034fab0:  00000000 7c003188 0034fac8 b7c5fcb4
0x0034fac0:  00000000 b7f0bff4 0034fba8 b7efe5d6
0x0034fad0:  00000000 00000000 0034fb38 b7cce2d1
0x0034fae0:  7c003190 7c003198 7c003194 b7c5e6ac
Backtrace:
=>1 0xb7f03bad in ld-linux.so.2 (+0x12bad) (0x0034fab8)
  2 0xb7c5fcb4 GLIBC_2+0xcb4() in libdl.so.2 (0x0034fac8)
  3 0xb7efe5d6 in ld-linux.so.2 (+0xd5d6) (0x0034fba8)
  4 0xb7c602bc in libdl.so.2 (+0x12bc) (0x0034fbc8)
  5 0xb7c5fcea GLIBC_2+0xcea() in libdl.so.2 (0x0034fbd8)
  6 0x7dda57bd in libgl.so.1 (+0x477bd) (0x0034fbf8)
  7 0x7dd8584a in libgl.so.1 (+0x2784a) (0x0034fc18)
  8 0x7dd87924 in libgl.so.1 (+0x29924) (0x0034fc48)
  9 0x7dd80ba4 in libgl.so.1 (+0x22ba4) (0x0034fc58)
  10 0x7ddc39bc glIsRenderbufferEXT+0x16c() in libgl.so.1 (0x0034fc68)
  11 0xb7efefdf in ld-linux.so.2 (+0xdfdf) (0x0034fe18)
  12 0xb7c90f74 exit+0xd4() in libc.so.6 (0x0034fe38)
  13 0x7efacc80 RtlGetCurrentPeb()
[/home/dank/wine-git/dlls/ntdll/process.c:70] in ntdll (0x0034fec8)
  14 0x7ee7d62f ExitProcess+0x2f(status=0x0)
[/home/dank/wine-git/dlls/kernel32/process.c:2046] in kernel32
(0x0034fee8)
  15 0x7ecad3ba __wine_spec_exe_entry+0x6a(peb=0x7ffdf000)
[/home/dank/wine-git/dlls/winecrt0/exe_entry.c:38] in rundll32
(0x0034ff08)
  16 0x7ee7fd4e start_process+0xee(arg=0x0)
[/home/dank/wine-git/dlls/kernel32/process.c:883] in kernel32
(0x0034ffe8)
  17 0xb7de18f7 wine_switch_to_stack+0x17() in libwine.so.1 (0x00000000)
0xb7f03bad: testb       $0x8,0x200(%edi)

libgl.so is involved, so perhaps the is a graphics driver bug?
The system is a thinkpad x60 with intel graphics.  glxgears
gets 960 fps.

Anybody else seeing this?

It seems kind of benign, and doesn't keep 'wine notepad' from working...


From gynvael at coldwind.pl  Sun Mar 23 06:28:52 2008
From: gynvael at coldwind.pl (Gynvael Coldwind)
Date: Sun, 23 Mar 2008 12:28:52 +0100
Subject: Hello Email
In-Reply-To: <5f9140a20803222352t624fdebes9abba31adaf7ddaf@mail.gmail.com>
References: <5f9140a20803221417v154a7e87ree6b61a080d97aca@mail.gmail.com>
	<bd3a94bf0803221430u1864febay9a7e1572dd4d53b@mail.gmail.com>
	<5f9140a20803222352t624fdebes9abba31adaf7ddaf@mail.gmail.com>
Message-ID: <bd3a94bf0803230428n7516d52j7b15e8785d8915fb@mail.gmail.com>

Hello again:

On Sun, Mar 23, 2008 at 3:32 AM, Dan Kegel <dank at kegel.com> wrote:
> Hi Michael!  Any idea what you'll be proposing for SoC yet?
Oh, sorry, I've missclicked and sent the ideas to David only.

I am currently thinking which idea interests me the most. The
following things are currently interesting me the most:
GDI+ - implement missing functions
Tools - Merge winecfg and control panel
DirectPlay - Implement the core protocol
Print Dialog
(from the most interesting to the least).


On Sun, Mar 23, 2008 at 7:52 AM, David Adam <david.adam.cnrs at gmail.com> wrote:
> You need to choose by yourself. Do not ask to us to decide for you. When you
> decided which of part of wine you want to work, please contact a mentor to
> have some indications. Before applicating officialy for a GSoC, you should
> prove that you can achieve some good jobs by sendind patches for wine in the
> area that you decided to work.

Please do not get me wrong, I am not asking You to decide for me, I'm
just asking for Your personal opinion. Don't worry, I'll choose what
to apply for by myself ;>
Anyway, thanks for Your reply, I'll contact the mentors of the
interesting me things.

Best regards,
-- 
gynvael.coldwind//vx


From dank at kegel.com  Sun Mar 23 06:39:12 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 04:39:12 -0700
Subject: Hello Email
In-Reply-To: <bd3a94bf0803230428n7516d52j7b15e8785d8915fb@mail.gmail.com>
References: <5f9140a20803221417v154a7e87ree6b61a080d97aca@mail.gmail.com>
	<bd3a94bf0803221430u1864febay9a7e1572dd4d53b@mail.gmail.com>
	<5f9140a20803222352t624fdebes9abba31adaf7ddaf@mail.gmail.com>
	<bd3a94bf0803230428n7516d52j7b15e8785d8915fb@mail.gmail.com>
Message-ID: <a71bd89a0803230439s8e24207r53b840f4a94618c8@mail.gmail.com>

On Sun, Mar 23, 2008 at 4:28 AM, Gynvael Coldwind <gynvael at coldwind.pl> wrote:
>  I am currently thinking which idea interests me the most. The
>  following things are currently interesting me the most:
>  GDI+ - implement missing functions
>  Tools - Merge winecfg and control panel
>  DirectPlay - Implement the core protocol
>  Print Dialog
>  (from the most interesting to the least).

GDI+, the one you say is most interesting, is
an excellent choice.  Lei and I had good luck
mentoring a group of UCLA students to implement
a bunch of missing GDI+ functions, and there
are tons more to do.  A google search for
  "unimplemented function gdiplus"
finds a dozen or so candidates.
- Dan


From mle+win at mega-nerd.com  Sun Mar 23 06:43:31 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 23 Mar 2008 22:43:31 +1100
Subject: winegcc: A spec file is currently needed in shared mode?
Message-ID: <20080323224331.b79254e9.mle+win@mega-nerd.com>

Hi all,

Any idea what the above means and how to fix it?

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"You can have quality software, or you can have pointer arithmetic;
but you cannot have both at the same time." -- Bertrand Meyer, 1989


From dank at kegel.com  Sun Mar 23 06:45:35 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 04:45:35 -0700
Subject: crash on exit in hardy on intel graphics?
In-Reply-To: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
References: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
Message-ID: <a71bd89a0803230445x32cb370h659dd7c997297db8@mail.gmail.com>

It's not so benign.  Apps fail to start because of this.
The workaround is to run wineprefixcreate by
hand; it still fails, but then when you run wine all is well.

Here's an example of the symptom.  In this case I was
trying to install the photoshop 7 trial without an existing .wine
directory:

wine: Unhandled page fault on read access to 0x00000200 at address
0xb7f28bad (thread 0009), starting debugger...
wine: wineprefixcreate failed while creating '/home/dank/.wine'.
dank at lappy:~/installers/adobe$ wineserver: could not save registry
branch to /home/dank/.wine-AGXTqe/system.reg : No such file or
directory
wineserver: could not save registry branch to
/home/dank/.wine-AGXTqe/userdef.reg : No such file or directory
wineserver: could not save registry branch to
/home/dank/.wine-AGXTqe/user.reg : No such file or directory


From stefan at codeweavers.com  Sun Mar 23 07:00:38 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 23 Mar 2008 13:00:38 +0100
Subject: crash on exit in hardy on intel graphics?
In-Reply-To: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
References: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
Message-ID: <200803231300.38257.stefan@codeweavers.com>

Am Sonntag, 23. M?rz 2008 12:22:07 schrieb Dan Kegel:
>   10 0x7ddc39bc glIsRenderbufferEXT+0x16c() in libgl.so.1 (0x0034fc68)
>   11 0xb7efefdf in ld-linux.so.2 (+0xdfdf) (0x0034fe18)
>   12 0xb7c90f74 exit+0xd4() in libc.so.6 (0x0034fe38)
Why would exit call glIsRenderbuffer() ? That doesn't make sense to me


From stefan at codeweavers.com  Sun Mar 23 07:04:54 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 23 Mar 2008 13:04:54 +0100
Subject: 5/3 WineD3D: Don't use blending on pixel formats which don't
	support it in combination with shaders
In-Reply-To: <20080322230800.41530@gmx.net>
References: <20080322230800.41530@gmx.net>
Message-ID: <200803231304.54583.stefan@codeweavers.com>

Am Sonntag, 23. M?rz 2008 00:08:00 schrieb Roderick Colenbrander:
> Hi,
>
> Windows drivers only offer post pixel shader blending support on generic
> (A)RGB-like formats and in case of dx10-class cards like the Geforce8 also
> on some float formats. Right now we enable blending even when it isn't
> needed. In case of R32F (if you would disable the software conversion code)
> this gives a 400% performance boost in
> http://www.angelcode.com/dev/shadow/.
Don't disable GL_BLEND() in context.c . This will be overwritten by the 
state_blend() state handler later if the state is dirty for some reason. 
Instead mark the state dirty and let the state handler code you added handle 
this.

You're checking for use_ps() in the state_blend handler, in this case you'll 
have to make sure that a pixel shader change updates this. However, I suspect 
that the pixel shader does not have any effect on blending and the flag's 
name is a red herring. Can you write a test testing blending on formats that 
do not support post pixel shader blending?


From dank at kegel.com  Sun Mar 23 07:10:26 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 05:10:26 -0700
Subject: crash on exit in hardy on intel graphics?
In-Reply-To: <200803231300.38257.stefan@codeweavers.com>
References: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
	<200803231300.38257.stefan@codeweavers.com>
Message-ID: <a71bd89a0803230510t19525745id6cfa5b5a23fd329@mail.gmail.com>

On Sun, Mar 23, 2008 at 5:00 AM, Stefan D?singer <stefan at codeweavers.com> wrote:
> >   10 0x7ddc39bc glIsRenderbufferEXT+0x16c() in libgl.so.1 (0x0034fc68)
>  >   11 0xb7efefdf in ld-linux.so.2 (+0xdfdf) (0x0034fe18)
>  >   12 0xb7c90f74 exit+0xd4() in libc.so.6 (0x0034fe38)
>  Why would exit call glIsRenderbuffer() ? That doesn't make sense to me

No idea... I guess I figured it was in an onexit handler installed
by opengl for some reason?


From stefan at codeweavers.com  Sun Mar 23 07:14:10 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 23 Mar 2008 13:14:10 +0100
Subject: [PATCH 3/5] wined3d: Handle zero primitive count.
In-Reply-To: <47E59D74.1050503@inbox.lv>
References: <47E59D74.1050503@inbox.lv>
Message-ID: <200803231314.10749.stefan@codeweavers.com>

Am Sonntag, 23. M?rz 2008 00:59:48 schrieb Alexander Dorofeyev:
> Native can handle zero primitive count both when using old interfaces
> (execute buffers etc) and when using d3d8 interface. Wine can crash in
> drawprim.c routines like drawStridedSlow and possibly others too, so filter
> it out in IWineD3DDeviceImpl_DrawIndexedPrimitiveUP. Fixes crash in
> Forsaken. ---
>   dlls/wined3d/device.c |    2 ++
>   1 files changed, 2 insertions(+), 0 deletions(-)
How will this work for other drawing functions? Shouldn't you filter it in the 
common drawPrimive() in drawprim.c?


From stefan at codeweavers.com  Sun Mar 23 07:15:05 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 23 Mar 2008 13:15:05 +0100
Subject: ddraw: Don't clear the returnvalue anymore,
	we keep the dwSize and fill out the rest anyway
In-Reply-To: <187148.4549.qm@web44803.mail.sp1.yahoo.com>
References: <187148.4549.qm@web44803.mail.sp1.yahoo.com>
Message-ID: <200803231315.05697.stefan@codeweavers.com>

Am Sonntag, 23. M?rz 2008 03:33:56 schrieb Kolbj?rn Fredheim:
> Fixes a crash in Anarchy Online
I think we need a test case for that - see dlls/ddraw/tests/d3d.c


From mle+win at mega-nerd.com  Sun Mar 23 07:32:41 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 23 Mar 2008 23:32:41 +1100
Subject: winegcc: A spec file is currently needed in shared mode?
In-Reply-To: <20080323224331.b79254e9.mle+win@mega-nerd.com>
References: <20080323224331.b79254e9.mle+win@mega-nerd.com>
Message-ID: <20080323233241.ca5f9668.mle+win@mega-nerd.com>

Erik de Castro Lopo wrote:

> Any idea what the above means and how to fix it?

Ah, I figured it out. For the record, I needed a .DEF file in order
to generate the DLL.

Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"Projects promoting programming in natural language are intrinsically
doomed to fail." -- Edsger Dijkstra


From alexd4 at inbox.lv  Sun Mar 23 07:27:42 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Sun, 23 Mar 2008 14:27:42 +0200
Subject: [PATCH 3/5] wined3d: Handle zero primitive count.
In-Reply-To: <200803231314.10749.stefan@codeweavers.com>
References: <47E59D74.1050503@inbox.lv>
	<200803231314.10749.stefan@codeweavers.com>
Message-ID: <47E64CBE.1090903@inbox.lv>

Stefan D?singer wrote:
> Am Sonntag, 23. M?rz 2008 00:59:48 schrieb Alexander Dorofeyev:
>> Native can handle zero primitive count both when using old interfaces
>> (execute buffers etc) and when using d3d8 interface. Wine can crash in
>> drawprim.c routines like drawStridedSlow and possibly others too, so filter
>> it out in IWineD3DDeviceImpl_DrawIndexedPrimitiveUP. Fixes crash in
>> Forsaken. ---
>>   dlls/wined3d/device.c |    2 ++
>>   1 files changed, 2 insertions(+), 0 deletions(-)
> How will this work for other drawing functions? Shouldn't you filter it in the 
> common drawPrimive() in drawprim.c?

You are right, drawPrimive() is a better place. I'll update the patch.


From coolbeer1980 at yahoo.com  Sun Mar 23 07:55:59 2008
From: coolbeer1980 at yahoo.com (=?iso-8859-1?Q?Kolbj=F8rn_Fredheim?=)
Date: Sun, 23 Mar 2008 05:55:59 -0700 (PDT)
Subject: ddraw: Don't clear the returnvalue anymore,
	we keep the dwSize and fill out the rest anyway
Message-ID: <874860.51512.qm@web44801.mail.sp1.yahoo.com>

Stefan Wrote:
>Am Sonntag, 23. M?rz 2008 03:33:56 schrieb Kolbj?rn Fredheim:
>> Fixes a crash in Anarchy Online
>I think we need a test case for that - see dlls/ddraw/tests/d3d.c

Not really a need for it, we fill out the whole struct when passing through the function, so there should be no need to memset it to 0, in the worst case we could take the size of the struct as the memset, but using the dwSize is not a good thing imo, it will only crash wine/the program if the program is passing some bizarre value there.

I do however have a testcase for it, but it is really messy and spews out alot of junk, so I _really_ didn't want it included in winecode.

I could clean up the test, but I'm unshure on how to pass or fail the test, as all I'm doing now is spewing out the raw data of the struct after it's been through the function.


      ____________________________________________________________________________________
Looking for last minute shopping deals?  
Find them fast with Yahoo! Search.  http://tools.search.yahoo.com/newsearch/category.php?category=shopping



From cesar at ecuarock.net  Sun Mar 23 11:06:43 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Sun, 23 Mar 2008 11:06:43 -0500
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<47D0296F.9020404@gmx.net>
	<e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>
Message-ID: <e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>

Here are some ideas of what I think could be implemented for the FUSE
project for GSOC.

- This FUSE can be a "proxy" filesystem. This means that we could use
an existing filesystem and mount this proxy filesystem and make it
appear as case insensitive. This means that if there's a file named
"A.txt" on a folder and I copy "a.txt", "A.txt" should be overridden.
Same logic for other cases.

- A utility to test for invalid filenames (like "A.txt" and "a.txt" on
the same original directory)

- Is there any need to simulate windows' permission schemes
(inheritance, ACLs) when using this filesystem?

- Since this will be a proxy filesystem, there is the chance to
present some folders with different names. For example "Program Files"
could be presented as "Archivos de Programa" when mounting the
filesystem with a Spanish locale. The original folder will be still
there and you could cd to it and both will point to the same back end
folder.

If you have any other ideas please let me know.

Cesar

On Thu, Mar 6, 2008 at 6:47 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
> Thanks for your help. I'll prepare something and post it here for
> suggestions soon.
>
>
>
> On Thu, Mar 6, 2008 at 12:27 PM, Marcel Partap <mpartap at gmx.net> wrote:
>
> >
> > > Is there any formal process I must go through to enter google summer
> > > of code for wine?
> > Just filing Google's application will do, although you may want to crash
> in #winehackers ..
> > What you should do IN TIME is to get intimate with the toolchain! That was
> the hardest part for me -
> > getting started on WINE - but if you already have programming experience I
> doubt that is a problem.
> > However, from personal experience of last years SoC, communicate your
> implementation ideas as early
> > as possible and don't be afraid to ask for help here on the list would
> probably be the two most
> > important things...
> > And another lesson learned: it takes a lot of polish for your patches to
> be approved and committed
> > by officer Julliard, be prepared to reiterate over your submitted code
> several times :D
> > Else - go for it, task sounds reasonable achievable. And the t-shirt is
> really worth the effort :)
> > regards
> >
> > --
> > <div id="signature">
> >   "Obstacles are those frightful things you see when you take your eyes
> off your goal."
> >                                                               -- Henry
> Ford (1863-1947)
> >   Change the world! Vote revolution: http://hfopi.org/vote-future
> > </div>
> >
>
>


From smoki00790 at gmail.com  Sun Mar 23 11:12:51 2008
From: smoki00790 at gmail.com (=?ISO-8859-2?Q?Milan_Kosti=E6?=)
Date: Sun, 23 Mar 2008 17:12:51 +0100
Subject: =?ISO-8859-1?Q?Regression_introduced_with_one_old_D=F6singer's_commit?=
Message-ID: <e1d9e62c0803230912hd422276qbc9f516264283b2e@mail.gmail.com>

http://source.winehq.org/git/wine.git?a=commit;h=fe0f0eb48a12e29af6a9e7407d4eec8bc500a057

 OK this is that commit with problem, but don't know what is corect
solution... i just remove it back and all my problems with water
flowing ine games is gone:). Problem is with changes just in utils.c
file and that is not working properly with Mesa drivers that i use (i
don't know for other drivers). Primer: water flow, wrong animation in
portals, etc in Dungeon Siege 2 and all other games with
similar functions.

 I'm just revert minus lines and remove plus:):

-        mat[12] = mat[8];
-        mat[13] = mat[9];
+        switch(coordtype) {
+            case WINED3DDECLTYPE_FLOAT1:
+                /* Direct3D passes the default 1.0 in the 2nd coord,
while gl passes it in the 4th.
+                 * swap 2nd and 4th coord. No need to store the value
of mat[12] in mat[4] because
+                 * the input value to the transformation will be 0,
so the matrix value is irrelevant
+                 */
+                mat[12] = mat[4];
+                mat[13] = mat[5];
+                mat[14] = mat[6];
+                mat[15] = mat[7];
+                break;
+            case WINED3DDECLTYPE_FLOAT2:
+                /* See above, just 3rd and 4th coord
+                 */
+                mat[12] = mat[8];
+                mat[13] = mat[9];
+                mat[14] = mat[10];
+                mat[15] = mat[11];
+                break;
+            case WINED3DDECLTYPE_FLOAT3: /* Opengl defaults match dx
defaults */
+            case WINED3DDECLTYPE_FLOAT4: /* No defaults apply, all
app defined */
+
+            /* This is to prevent swaping the matrix lines and put
the default 4th coord = 1.0
+             * into a bad place. The division elimination below will
apply to make sure the
+             * 1.0 doesn't do anything bad. The caller will set this
value if the stride is 0
+             */
+            case WINED3DDECLTYPE_UNUSED: /* No texture coords,
0/0/0/1 defaults are passed */
+                break;
+            default:
+                FIXME("Unexpected fixed function texture coord input\n");
+        }
+        switch (flags & ~WINED3DTTFF_PROJECTED) {
+            /* case WINED3DTTFF_COUNT1: Won't ever get here */
+            case WINED3DTTFF_COUNT2: mat[2] = mat[6] = mat[10] = mat[14] = 0;
+            /* OpenGL divides the first 3 vertex coord by the 4th by default,
+             * which is essentially the same as D3DTTFF_PROJECTED.
Make sure that
+             * the 4th coord evaluates to 1.0 to eliminate that.
+             *
+             * If the fixed function pipeline is used, the 4th value
remains unused,
+             * so there is no danger in doing this. With vertex
shaders we have a
+             * problem. Should an app hit that problem, the code here
would have to
+             * check for pixel shaders, and the shader has to undo
the default gl divide.
+             *
+             * A more serious problem occurs if the app passes 4
coordinates in, and the
+             * 4th is != 1.0(opengl default). This would have to be
fixed in drawStridedSlow
+             * or a replacement shader
+             */
+            default: mat[3] = mat[7] = mat[11] = 0; mat[15] = 1;
+        }

 and all problems with water animation is gone. Seems to any other
games not have problems with that i do, but i don't know is this
correct? Maybe someone of the developers knows better solution for
this?

 edit: this is tried in wine-0.9.58, Mesa versions 6.52, 7.0, 7.01,
7.02, 7.03rc2 (no problem with all this Mesas) and ATI 9250(r200) and
also ATI 9800(r300) cards.


From stefan at codeweavers.com  Sun Mar 23 11:51:43 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Sun, 23 Mar 2008 17:51:43 +0100
Subject: Regression introduced with one old =?utf-8?q?D=C3=B6singer=27s?=
	commit
In-Reply-To: <e1d9e62c0803230912hd422276qbc9f516264283b2e@mail.gmail.com>
References: <e1d9e62c0803230912hd422276qbc9f516264283b2e@mail.gmail.com>
Message-ID: <200803231751.43635.stefan@codeweavers.com>

Am Sonntag, 23. M?rz 2008 17:12:51 schrieb Milan Kosti?:
> ?OK this is that commit with problem, but don't know what is corect
> solution... i just remove it back and all my problems with water
> flowing ine games is gone:). Problem is with changes just in utils.c
> file and that is not working properly with Mesa drivers that i use (i
> don't know for other drivers). Primer: water flow, wrong animation in
> portals, etc in Dungeon Siege 2 and all other games with
> similar functions.
I recommend you to write a test for this to see how WineD3D should behave. 
Take a look at dlls/d3d9/tests/visual.c, function 
texture_transform_flags_test(). There are a lot of tests for this code 
already. The function is a bit messy unfortunately.

There are a few bug reports about regressions due to this patch. I fixed most 
of them already, but it seems that one bug is still remaining, which is the 
same as the one you're seeing.


From stefan at codeweavers.com  Sun Mar 23 11:51:43 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Sun, 23 Mar 2008 17:51:43 +0100
Subject: Regression introduced with one old =?utf-8?q?D=C3=B6singer=27s?=
	commit
In-Reply-To: <e1d9e62c0803230912hd422276qbc9f516264283b2e@mail.gmail.com>
References: <e1d9e62c0803230912hd422276qbc9f516264283b2e@mail.gmail.com>
Message-ID: <200803231751.43635.stefan@codeweavers.com>

Am Sonntag, 23. M?rz 2008 17:12:51 schrieb Milan Kosti?:
> ?OK this is that commit with problem, but don't know what is corect
> solution... i just remove it back and all my problems with water
> flowing ine games is gone:). Problem is with changes just in utils.c
> file and that is not working properly with Mesa drivers that i use (i
> don't know for other drivers). Primer: water flow, wrong animation in
> portals, etc in Dungeon Siege 2 and all other games with
> similar functions.
I recommend you to write a test for this to see how WineD3D should behave. 
Take a look at dlls/d3d9/tests/visual.c, function 
texture_transform_flags_test(). There are a lot of tests for this code 
already. The function is a bit messy unfortunately.

There are a few bug reports about regressions due to this patch. I fixed most 
of them already, but it seems that one bug is still remaining, which is the 
same as the one you're seeing.


From jgardou at yahoo.fr  Sun Mar 23 13:52:05 2008
From: jgardou at yahoo.fr (=?iso-8859-1?q?J=E9r=F4me_Gardou?=)
Date: Sun, 23 Mar 2008 19:52:05 +0100
Subject: winegcc: A spec file is currently needed in shared mode?
In-Reply-To: <20080323224331.b79254e9.mle+win@mega-nerd.com>
References: <20080323224331.b79254e9.mle+win@mega-nerd.com>
Message-ID: <200803231952.05724.jgardou@yahoo.fr>

Le Sunday 23 March 2008 12:43:31 Erik de Castro Lopo, vous avez ?crit?:
> Hi all,
>
> Any idea what the above means and how to fix it?
>
> Cheers,
> Erik

This means that winegcc is currently unable to know what function should be 
exported when building in shared mode. The only way to "fix" this is writing 
a spec file and passing it in winegcc args. See winegcc --help.

	

	
		
___________________________________________________________________________ 
Yahoo! Mail r?invente le mail ! D?couvrez le nouveau Yahoo! Mail et son interface r?volutionnaire.
http://fr.mail.yahoo.com



From thunderbird2k at gmx.net  Sun Mar 23 15:17:12 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 23 Mar 2008 21:17:12 +0100
Subject: 5/3 WineD3D: Don't use blending on pixel formats which don't
	support	it in combination with shaders
In-Reply-To: <20080322230800.41530@gmx.net>
References: <20080322230800.41530@gmx.net>
Message-ID: <20080323201712.182030@gmx.net>

Skip this one among with 5/3, 6/3 and 7/3. All other patches like 8/3 and 9/3 don't require this one and should apply fine.

Roderick

> Hi,
> 
> Windows drivers only offer post pixel shader blending support on generic
> (A)RGB-like formats and in case of dx10-class cards like the Geforce8 also
> on some float formats. Right now we enable blending even when it isn't
> needed. In case of R32F (if you would disable the software conversion code) this
> gives a 400% performance boost in http://www.angelcode.com/dev/shadow/.
> 
> A next patch will add D3DUSAGE_QUERY_PIXELFORMAT_BLENDING support.
> 
> Regards,
> Roderick Colenbrander

-- 
Ist Ihr Browser Vista-kompatibel? Jetzt die neuesten 
Browser-Versionen downloaden: http://www.gmx.net/de/go/browser


From galeru at gmail.com  Sun Mar 23 18:11:38 2008
From: galeru at gmail.com (Corey McClymonds)
Date: Sun, 23 Mar 2008 19:11:38 -0400
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<47D0296F.9020404@gmx.net>
	<e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>
	<e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>
Message-ID: <63ee2bc70803231611k31e16781j82f1de4e6cb73cf4@mail.gmail.com>

On 3/23/08, Cesar Izurieta <cesar at ecuarock.net> wrote:
> Here are some ideas of what I think could be implemented for the FUSE
>  project for GSOC.
>
>  - This FUSE can be a "proxy" filesystem. This means that we could use
>  an existing filesystem and mount this proxy filesystem and make it
>  appear as case insensitive. This means that if there's a file named
>  "A.txt" on a folder and I copy "a.txt", "A.txt" should be overridden.
>  Same logic for other cases.
>
>  - A utility to test for invalid filenames (like "A.txt" and "a.txt" on
>  the same original directory)
>
>  - Is there any need to simulate windows' permission schemes
>  (inheritance, ACLs) when using this filesystem?
>
>  - Since this will be a proxy filesystem, there is the chance to
>  present some folders with different names. For example "Program Files"
>  could be presented as "Archivos de Programa" when mounting the
>  filesystem with a Spanish locale. The original folder will be still
>  there and you could cd to it and both will point to the same back end
>  folder.
>
>  If you have any other ideas please let me know.
>
>  Cesar

Are you going to do integration under wine, or are you going to just
do the file system.  For instance, what happens if you run wine in a
folder that isn't case insensitive?
>
>  On Thu, Mar 6, 2008 at 6:47 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
>  > Thanks for your help. I'll prepare something and post it here for
>  > suggestions soon.
>  >
>  >
>  >
>  > On Thu, Mar 6, 2008 at 12:27 PM, Marcel Partap <mpartap at gmx.net> wrote:
>  >
>  > >
>  > > > Is there any formal process I must go through to enter google summer
>  > > > of code for wine?
>  > > Just filing Google's application will do, although you may want to crash
>  > in #winehackers ..
>  > > What you should do IN TIME is to get intimate with the toolchain! That was
>  > the hardest part for me -
>  > > getting started on WINE - but if you already have programming experience I
>  > doubt that is a problem.
>  > > However, from personal experience of last years SoC, communicate your
>  > implementation ideas as early
>  > > as possible and don't be afraid to ask for help here on the list would
>  > probably be the two most
>  > > important things...
>  > > And another lesson learned: it takes a lot of polish for your patches to
>  > be approved and committed
>  > > by officer Julliard, be prepared to reiterate over your submitted code
>  > several times :D
>  > > Else - go for it, task sounds reasonable achievable. And the t-shirt is
>  > really worth the effort :)
>  > > regards
>  > >
>  > > --
>  > > <div id="signature">
>  > >   "Obstacles are those frightful things you see when you take your eyes
>  > off your goal."
>  > >                                                               -- Henry
>  > Ford (1863-1947)
>  > >   Change the world! Vote revolution: http://hfopi.org/vote-future
>  > > </div>
>  > >
>  >
>  >
>
>
>


From dank at kegel.com  Sun Mar 23 18:36:53 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 16:36:53 -0700
Subject: winemenubuilder: Add support for 24 and 32 bit icons using png
	format.
Message-ID: <a71bd89a0803231636p27995ab1u7a5608570f1ce82@mail.gmail.com>

Your patch applies and creates .png icons...
But it seems to create the icons with two suffixes, e.g. file shows
  a680_forum.png.xpm: PNG image data, 32 x 32, 8-bit/color RGB, non-interlaced
Shouldn't that just be .png, not .png.xpm?

(This is for http://bugs.winehq.org/show_bug.cgi?id=4803 )


From wine-devel at kievinfo.com  Sun Mar 23 19:45:20 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 23 Mar 2008 18:45:20 -0600
Subject: winemenubuilder: Add support for 24 and 32 bit icons using png
	format.
In-Reply-To: <a71bd89a0803231636p27995ab1u7a5608570f1ce82@mail.gmail.com>
References: <a71bd89a0803231636p27995ab1u7a5608570f1ce82@mail.gmail.com>
Message-ID: <47E6F9A0.7080507@kievinfo.com>

Dan Kegel wrote:
> Your patch applies and creates .png icons...
> But it seems to create the icons with two suffixes, e.g. file shows
>   a680_forum.png.xpm: PNG image data, 32 x 32, 8-bit/color RGB, non-interlaced
> Shouldn't that just be .png, not .png.xpm?
> 
> (This is for http://bugs.winehq.org/show_bug.cgi?id=4803 )

Where are seeing that file? Also are you sure you are using patches 
wineshelllink? That's what copies the icon from c:\windows\temp to 
~/.local/share/icons

Vitaliy.


From dank at kegel.com  Sun Mar 23 19:53:21 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 17:53:21 -0700
Subject: crash on exit in hardy on intel graphics?
In-Reply-To: <a71bd89a0803230510t19525745id6cfa5b5a23fd329@mail.gmail.com>
References: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
	<200803231300.38257.stefan@codeweavers.com>
	<a71bd89a0803230510t19525745id6cfa5b5a23fd329@mail.gmail.com>
Message-ID: <a71bd89a0803231753m7371015ah885830fbb777cc11@mail.gmail.com>

On Sun, Mar 23, 2008 at 5:10 AM, Dan Kegel <dank at kegel.com> wrote:
> On Sun, Mar 23, 2008 at 5:00 AM, Stefan D?singer <stefan at codeweavers.com> wrote:
>  > >   10 0x7ddc39bc glIsRenderbufferEXT+0x16c() in libgl.so.1 (0x0034fc68)
>  >  >   11 0xb7efefdf in ld-linux.so.2 (+0xdfdf) (0x0034fe18)
>  >  >   12 0xb7c90f74 exit+0xd4() in libc.so.6 (0x0034fe38)
>  >  Why would exit call glIsRenderbuffer() ? That doesn't make sense to me
>
>  No idea... I guess I figured it was in an onexit handler installed
>  by opengl for some reason?

Now I'm getting that crash on exit from a game, American McGee's Alice demo.
Anybody else testing Hardy?
- Dan

p.s. here's the stack:

Unhandled exception: page fault on read access to 0x00000200 in 32-bit
code (0xb7f7cbad).
Register dump:
 CS:0073 SS:007b DS:007b ES:007b FS:0033 GS:003b
 EIP:b7f7cbad ESP:0174d868 EBP:0174d890 EFLAGS:00210292(   - 00      -RISA1)
 EAX:b7f84ce0 EBX:b7f84ff4 ECX:b7f775b9 EDX:b7cd76ac
 ESI:00000000 EDI:00000000
Stack dump:
0x0174d868:  b7f69eec b7f84ff4 0174d8b8 7c028dc4
0x0174d878:  0174d8ec b7f73059 0174d890 b7cdaff4
0x0174d888:  00000000 7c003188 0174d8a0 b7cd8cb4
0x0174d898:  00000000 b7f84ff4 0174d980 b7f775d6
0x0174d8a8:  00000000 00000000 00000000 00000000
0x0174d8b8:  7c003190 7c003198 7c003194 b7cd76ac
Backtrace:
=>1 0xb7f7cbad in ld-linux.so.2 (+0x12bad) (0x0174d890)
  2 0xb7cd8cb4 GLIBC_2+0xcb4() in libdl.so.2 (0x0174d8a0)
  3 0xb7f775d6 in ld-linux.so.2 (+0xd5d6) (0x0174d980)
  4 0xb7cd92bc in libdl.so.2 (+0x12bc) (0x0174d9a0)
  5 0xb7cd8cea GLIBC_2+0xcea() in libdl.so.2 (0x0174d9b0)
  6 0x7dc157bd in libgl.so.1 (+0x477bd) (0x0174d9d0)
  7 0x7dbf584a in libgl.so.1 (+0x2784a) (0x0174d9f0)
  8 0x7dbf7924 in libgl.so.1 (+0x29924) (0x0174da20)
  9 0x7dbf0ba4 in libgl.so.1 (+0x22ba4) (0x0174da30)
  10 0x7dc339bc glIsRenderbufferEXT+0x16c() in libgl.so.1 (0x0174da40)
  11 0xb7f77fdf in ld-linux.so.2 (+0xdfdf) (0x0174db90)
  12 0xb7d09f74 exit+0xd4() in libc.so.6 (0x0174dbb0)
  13 0x7efacc80 RtlGetCurrentPeb()
[/home/dank/wine-git/dlls/ntdll/process.c:70] in ntdll (0x0174dc40)
  14 0x7ee7d62f ExitProcess+0x2f(status=0x0)
[/home/dank/wine-git/dlls/kernel32/process.c:2046] in kernel32
(0x0174dc60)
  15 0x004e9767 in alice (+0xe9767) (0x00bd54c0)
0xb7f7cbad: testb       $0x8,0x200(%edi)


From dank at kegel.com  Sun Mar 23 20:48:34 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 18:48:34 -0700
Subject: winemenubuilder: Add support for 24 and 32 bit icons using png
	format.
In-Reply-To: <47E6F9A0.7080507@kievinfo.com>
References: <a71bd89a0803231636p27995ab1u7a5608570f1ce82@mail.gmail.com>
	<47E6F9A0.7080507@kievinfo.com>
Message-ID: <a71bd89a0803231848y46fa8255p40bc6d59301a69f7@mail.gmail.com>

On Sun, Mar 23, 2008 at 5:45 PM, Vitaliy Margolen
<wine-devel at kievinfo.com> wrote:
>  Where are seeing that file? Also are you sure you are using patches
>  wineshelllink?

My bad.  To use a noninstalled wineshelllink, you have
to start the installer with
   PATH=$HOME/wine-git/tools:$PATH wine-git/wine installers/BLMInstall277.exe
and then the icons are fine, since it's using the new code in the build tree.

Oddly, the link and shortcut on the desktop don't use any
of the icons, but the ones in the Wine menu look good.


From wine-devel at kievinfo.com  Sun Mar 23 20:55:09 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 23 Mar 2008 19:55:09 -0600
Subject: winemenubuilder: Add support for 24 and 32 bit icons using png
	format.
In-Reply-To: <a71bd89a0803231848y46fa8255p40bc6d59301a69f7@mail.gmail.com>
References: <a71bd89a0803231636p27995ab1u7a5608570f1ce82@mail.gmail.com>	
	<47E6F9A0.7080507@kievinfo.com>
	<a71bd89a0803231848y46fa8255p40bc6d59301a69f7@mail.gmail.com>
Message-ID: <47E709FD.1080403@kievinfo.com>

Dan Kegel wrote:
> On Sun, Mar 23, 2008 at 5:45 PM, Vitaliy Margolen
> <wine-devel at kievinfo.com> wrote:
>>  Where are seeing that file? Also are you sure you are using patches
>>  wineshelllink?
> 
> My bad.  To use a noninstalled wineshelllink, you have
> to start the installer with
>    PATH=$HOME/wine-git/tools:$PATH wine-git/wine installers/BLMInstall277.exe
> and then the icons are fine, since it's using the new code in the build tree.
> 
I just did 'ln -s wine.git/tools/wineshelllink ~/bin/wineshelllink'

> Oddly, the link and shortcut on the desktop don't use any
> of the icons, but the ones in the Wine menu look good.
Strange, unless there are some other problems with extracting an icon. Can 
you run this and attach the output?

WINEDEBUG=+menubuilder wine winemenubuilder 
"c:\windows\profiles\\$USER\desktop\file.lnk"

Vitaliy.


From m.b.lankhorst at gmail.com  Sun Mar 23 23:22:44 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 23 Mar 2008 21:22:44 -0700
Subject: Proposal template for SOC2008?
Message-ID: <b130c85e0803232122m6b4b8481nd9622ca4f584bb99@mail.gmail.com>

Hi all,

I was thinking of copying the template perl uses for people wanting to
submit a proposal.

Anyone sees anything wrong with using
http://www.perlfoundation.org/perl5/index.cgi?gsoc2008_proposal_template
?

Cheers,
Maarten.


From dank at kegel.com  Mon Mar 24 01:00:31 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 23:00:31 -0700
Subject: wine 1.0 status: T minus 75 days. 82 open bugs.
Message-ID: <a71bd89a0803232300g168a6600j79b2b6f365cb09a3@mail.gmail.com>

This weekend, two bugs were resolved:
5535   directx-        16      Planescape:Torment doesn't work
6526   kernel32        1       Typing Instructor for Kids 2 fails to install

Four were deferred:
1347   directx-        20      Screen is wiped/blanked on usage of DirectDraw
3534   user32  14      Systray icons are not transparent...
6795   shdocvw 0       Skype 3.0.0.137 Beta dies trying to login in
win98, winme mode
10708  user32  21      Wine lacks support for animated cursors

And one more bug was nominated for 1.0.0 (!),
10040 	crypt32 	1 	Steam crashes during the startup

That takes us down from 87 bugs and 76 days to 82 bugs and 75 days.

Here's a list of the currently open 1.0 bugs, sorted by component, with votes:

5948   	-unknown  	1  	Star Trek: Armada does not install
5055 	-unknown 	5 	Deleting files from a window in wine doesn't send
them to the Trash
8125 	-unknown 	0 	Marratech 6.1 crashes on start
9916 	-unknown 	6 	"make test" usually fails
5844 	-unknown 	8 	tray minimize
7404 	-unknown 	2 	ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
9459 	-unknown 	8 	FIFA 2007 crashes with the recent versions
5402 	-unknown 	0 	Trying to run PhotoStitch 3.1
5024 	-unknown 	3 	Thief: Deadly Shadows crashes:page fault on read
access to 0x0000040c
10815 	-unknown 	1 	Cannot drag images into Adobe Photoshop 7 from the
web / desktop
9178 	-unknown 	7 	"hello world" dos program hangs
5061 	-unknown 	5 	Copying from Windows Firefox in Wine and pasting to
Linux OpenOffice pastes metadata as data
12097 	-unknown 	1 	Wine 1.0 should not ship out-of-sync resource translations
11281 	-unknown 	2 	CJK input many issues
7477 	-unknown 	1 	Uplink demo crashes
4971 	-unknown 	3 	Corel Draw 12 demo install fails
7915 	-unknown 	4 	15 of the internal tests of wine fail on Mac OS X
10147 	-unknown 	0 	Word Viewer 2003 - Tab behavior differs from Windows
9959 	-unknown 	8 	Make wine updates work even if the registry changed
556 	build-en 	2 	Reconcile the Windows and Wine spec files
1114 	comctl32 	2 	Winrar2.90/3.00: Comboex doesn't trigger a event
when you mouse-click in some value of it
10111 	comctl32 	2 	WINEDEBUG=warn+heap "make test" has heap error in
comdlg32/tests/printdlg.c
2493 	comctl32 	1 	Multi-select listview: Shift-arrow up only selects
top two items
9104 	comdlg32 	1 	Pdf-xchange viewer crashes
10040 	crypt32 	1 	Steam crashes during the startup
11681 	directx- 	11 	Add support for video overlay
5955 	directx- 	6 	DirectDrawCreate crash on non-OpenGL desktop
9030 	directx- 	0 	army men hangs on black screen
82 	document 	1 	Stabilize Winelib User Guide Table of Contents
638 	document 	7 	Document Wine debugging channels
3270 	gdi32 	12 	Problem with minimized top-level windows
9771 	gdi32 	37 	Steam Friends doesn't work (fails to render correctly
or refresh)
6519 	gdi32 	6 	Wine blacks out rotated font bitmap
9926 	gdi32 	4 	gdi32.dll should not have exported function pointers
7571 	gdi32 	1 	Accented character glyphs are mixed up with TrueType
fonts (affects e.g. Lotus Notes R5)
9484 	kernel32 	17 	Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
9039 	kernel32 	0 	GS-Auftrag Professional SQL aborts on startup
5351 	kernel32 	8 	Windows Installer 3.1 cannot install because of
non-standard drive labeling
5541 	kernel32 	0 	WriteConsole can't write to stdout; affects e.g.
wsh's cscript's usage message
4733 	kernel32 	4 	Get optimized/compressed/packed executables (non-upx) working
7098 	mscoree 	1 	RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
5163 	msi 	12 	Office XP 2002 crashes on installation
8783 	ntdll 	11 	USB serial ports do not work
9356 	ntdll 	5 	Serial communication not working since wine-0.9.33
6607 	ole 	6 	Drag and Drop not working
9942 	ole 	2 	Powerpoint Viewer 2007 crashes opening .pptx files
2539 	ole 	2 	XDND (Drag and drop for X Windows) doesn't copy text
8095 	ole 	0 	PQ Teaching toy crashes
4770 	ole 	2 	BlackBerry Device Manager fails to install under wine
5926 	programs 	0 	Wine does not provide an implementation of winhlp32.exe
4803 	programs 	5 	Steam: not all lnk files are processed into linux shortcuts
6254 	richedit 	3 	Installer infinite loop from rich text error
9304 	shdocvw 	3 	Temple of Elemental Evil demo doesn't start - gui irresponsive
6095 	shdocvw 	11 	MOTD in counter-strike 1.6 and counter-strike
source does not render
8898 	shdocvw 	0 	Run Time Error "445": Object doesn't support this
action in Europa Knowledgebase
3546 	shdocvw 	2 	CLSID_InternetShortcut not available...
10905 	shell32 	0 	thinstall firefox demo requires native msvcrt
8439 	shell32 	4 	Visual Studio .NET (7) install fails
9809 	shell32 	4 	Autodesk Revit Architecture 2008 install fails
11742 	shlwapi 	8 	Small .net 1.1 app (FastMD5 1.3) fails to start up
12074 	testcase 	2 	The conformance tests fail on Windows
6604 	tools 	2 	Ship icons for the wine-tools that can be used in .desktop files
8246 	urlmon 	3 	invoking htmlhelp:HtmlHelpW crashes wine
11431 	user32 	5 	Adobe Photoshop CS2: z-overlay of image containers
664 	user32 	5 	The help menu functionality inside programs is broken
(messaging problem)
4523 	user32 	5 	Can't copy from Firefox 1.5 and paste into OpenOffice
2 under Wine
3023 	user32 	5 	Orcad - "Place Part" never tries to put down a part
124 	wineserv 	2 	Review of Wine Server Protocol
11884 	winex11. 	1 	Copy and paste garbage on end
2368 	winex11. 	5 	Wine loses its X-Window when switching to another
virt. desktop in Fvwm
11019 	winex11. 	1 	matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
5623 	winex11. 	2 	GetAsyncKeyState wrong if querying process doesn't have focus
5828 	winex11. 	23 	Command and Conquer Generals (Zero Hour) doesn't
change the mouse cursor from the default X mouse
1990 	winex11. 	1 	modifier keys not released when switching desktop
10984 	winex11. 	2 	sun jre 5 update 10 installer hangs in 0.9.52
7372 	winex11. 	12 	can't copy and paste between gnome apps eg
openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
3297 	winex11. 	9 	UpdateWindow() doesn't call XFlush()
3711 	winsock 	0 	Musicmatch fails to install (missing registry key,
HTTP_HttpOpenRequest() problem)
10032 	winsock 	1 	Wine must not use unix select() for networking
where there might be high fd's
9787 	winsock 	44 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
5625 	winsock 	3 	Wine does not handle internet proxy settings conveniently
12005 	wintab32 	0 	Regression in pressure sensitivity with wizardpen
tablet driver and Photoshop 7


From m.b.lankhorst at gmail.com  Mon Mar 24 01:36:53 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 23 Mar 2008 23:36:53 -0700
Subject: C&C :D
In-Reply-To: <20080323084730.40340@gmx.net>
References: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
	<20080323084730.40340@gmx.net>
Message-ID: <b130c85e0803232336w1d5326b4wb68cb71929017a6@mail.gmail.com>

Hi Roderick,

2008/3/23, Roderick Colenbrander <thunderbird2k at gmx.net>:
> > Hi all!
>  >
>  > After an announcement that the original Command and conquer is
>  > available free for download, I decided to test it. Command and Conquer
>  > works perfectly in wine, I haven't tested network gaming over ipx, but
>  > that will probably not work. For the rest it's flawless, apart from
>  > the losing focus behavior, but playing it in a wine desktop helps.
>  >
>  > Remember: KANE IS A TRAITOR! LONG LIVE THE GDI!
>  >
>  > Cheers,
>  > Maarten.
>  >
>
>
> Hi Maarten,
>
>  It will likely run better if you use DirectDrawRenderer=opengl + RenderTargetLockMode=readtex (at least on Nvidia hardware that is fast). Second IPX network should work (if this is the c&c version with updated ipx) but you need root as plain users don't have enough permissions to create a raw ipx socket.
Tested that, none of the opengl modes work well:

disabled: In the menu I only get the menu, not the text that's written on it.
readtex: I get a white texture with only the text
textex: Nothing at all
readdraw: fails too

I'll play without opengl I think.

Cheers,
Maarten.


From m.b.lankhorst at gmail.com  Mon Mar 24 01:44:55 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 23 Mar 2008 23:44:55 -0700
Subject: C&C :D
In-Reply-To: <b130c85e0803232336w1d5326b4wb68cb71929017a6@mail.gmail.com>
References: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
	<20080323084730.40340@gmx.net>
	<b130c85e0803232336w1d5326b4wb68cb71929017a6@mail.gmail.com>
Message-ID: <b130c85e0803232344v57a8d65r7ec38f810758e760@mail.gmail.com>

Hello,

2008/3/23, Maarten Lankhorst <m.b.lankhorst at gmail.com>:
>  2008/3/23, Roderick Colenbrander <thunderbird2k at gmx.net>:
>
> > > Hi all!
>  >  >
>  >  > After an announcement that the original Command and conquer is
>  >  > available free for download, I decided to test it. Command and Conquer
>  >  > works perfectly in wine, I haven't tested network gaming over ipx, but
>  >  > that will probably not work. For the rest it's flawless, apart from
>  >  > the losing focus behavior, but playing it in a wine desktop helps.
>  >  >
>  >  > Remember: KANE IS A TRAITOR! LONG LIVE THE GDI!
>  >  >
>  >  > Cheers,
>  >  > Maarten.
>  >  >
>  >
>  >
>  > Hi Maarten,
>  >
>  >  It will likely run better if you use DirectDrawRenderer=opengl + RenderTargetLockMode=readtex (at least on Nvidia hardware that is fast). Second IPX network should work (if this is the c&c version with updated ipx) but you need root as plain users don't have enough permissions to create a raw ipx socket.
>
> Tested that, none of the opengl modes work well:
>
>  disabled: In the menu I only get the menu, not the text that's written on it.
>  readtex: I get a white texture with only the text
>  textex: Nothing at all
>  readdraw: fails too
>
>  I'll play without opengl I think.
Hold on, even without opengl it will fail sometimes dramatically, it
will stop updating the screen entirely if you fiddle around with the
menu too much. After that it doesn't work any more at all.


From sirnuke at gmail.com  Mon Mar 24 01:58:40 2008
From: sirnuke at gmail.com (Bryan DeGrendel)
Date: Mon, 24 Mar 2008 02:58:40 -0400
Subject: C&C :D
In-Reply-To: <b130c85e0803232344v57a8d65r7ec38f810758e760@mail.gmail.com>
References: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
	<20080323084730.40340@gmx.net>
	<b130c85e0803232336w1d5326b4wb68cb71929017a6@mail.gmail.com>
	<b130c85e0803232344v57a8d65r7ec38f810758e760@mail.gmail.com>
Message-ID: <82b7f9ee0803232358i123ef807od901f30efa614339@mail.gmail.com>

On Mon, Mar 24, 2008 at 2:44 AM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Hello,
>
>  2008/3/23, Maarten Lankhorst <m.b.lankhorst at gmail.com>:
>
>
> >  2008/3/23, Roderick Colenbrander <thunderbird2k at gmx.net>:
>  >
>  > > > Hi all!
>  >  >  >
>  >  >  > After an announcement that the original Command and conquer is
>  >  >  > available free for download, I decided to test it. Command and Conquer
>  >  >  > works perfectly in wine, I haven't tested network gaming over ipx, but
>  >  >  > that will probably not work. For the rest it's flawless, apart from
>  >  >  > the losing focus behavior, but playing it in a wine desktop helps.
>  >  >  >
>  >  >  > Remember: KANE IS A TRAITOR! LONG LIVE THE GDI!
>  >  >  >
>  >  >  > Cheers,
>  >  >  > Maarten.
>  >  >  >
>  >  >
>  >  >
>  >  > Hi Maarten,
>  >  >
>  >  >  It will likely run better if you use DirectDrawRenderer=opengl + RenderTargetLockMode=readtex (at least on Nvidia hardware that is fast). Second IPX network should work (if this is the c&c version with updated ipx) but you need root as plain users don't have enough permissions to create a raw ipx socket.
>  >
>  > Tested that, none of the opengl modes work well:
>  >
>  >  disabled: In the menu I only get the menu, not the text that's written on it.
>  >  readtex: I get a white texture with only the text
>  >  textex: Nothing at all
>  >  readdraw: fails too
>  >
>  >  I'll play without opengl I think.
>  Hold on, even without opengl it will fail sometimes dramatically, it
>  will stop updating the screen entirely if you fiddle around with the
>  menu too much. After that it doesn't work any more at all.
>
>
>

Are you working on a SMP system?  I had redraw problems with C&C Red
Alert on my Athlon X2, but the schedtool solution presented in bug
4487 worked for me [ http://bugs.winehq.org/show_bug.cgi?id=4487 ].

schedtool -a 0x2 -e wine

Bryan DeGrendel


From kai.blin at gmail.com  Mon Mar 24 05:09:29 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 24 Mar 2008 11:09:29 +0100
Subject: Proposal template for SOC2008?
In-Reply-To: <b130c85e0803232122m6b4b8481nd9622ca4f584bb99@mail.gmail.com>
References: <b130c85e0803232122m6b4b8481nd9622ca4f584bb99@mail.gmail.com>
Message-ID: <200803241109.33851.kai.blin@gmail.com>

On Monday 24 March 2008 05:22:44 Maarten Lankhorst wrote:
> Hi all,
>
> I was thinking of copying the template perl uses for people wanting to
> submit a proposal.
>
> Anyone sees anything wrong with using
> http://www.perlfoundation.org/perl5/index.cgi?gsoc2008_proposal_template

I think this is more verbose than all the applications I've ever written. :)
I think it's nice to give as a guidance if we don't require people to 100% 
stick to the template just for the template's sake.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080324/234f37da/attachment.pgp 

From smoki00790 at gmail.com  Mon Mar 24 05:20:38 2008
From: smoki00790 at gmail.com (=?ISO-8859-2?Q?Milan_Kosti=E6?=)
Date: Mon, 24 Mar 2008 11:20:38 +0100
Subject: =?ISO-8859-1?Q?Re:_Regression_introduced_with_one_old_D=F6singer's_commit?=
In-Reply-To: <200803231751.43635.stefan@codeweavers.com>
References: <e1d9e62c0803230912hd422276qbc9f516264283b2e@mail.gmail.com>
	<200803231751.43635.stefan@codeweavers.com>
Message-ID: <e1d9e62c0803240320l6c49e76ex3ef0fbd662139def@mail.gmail.com>

 Sorry Stefan but i'm prety new with Wine and for now don't understand
many things:(, i'm test games for now and don't know how to test tests
with wined3d.
 I tried to not remove any code from v0.9.58 utils.c, i'm just add
mat[12] = mat[8] and mat[13] = mat[9] like this:

             break;
        }
    } else { /* under directx the R/Z coord can be used for
translation, under opengl we use the Q coord instead */
	mat[12] = mat[8];
	mat[13] = mat[9];
        if(!calculatedCoords) {
            switch(coordtype) {
                case WINED3DDECLTYPE_FLOAT1:

 With that water flowing and portals also works good for me.


From julliard at winehq.org  Mon Mar 24 07:25:54 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 24 Mar 2008 13:25:54 +0100
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
In-Reply-To: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
	(Dan Kegel's message of "Fri, 21 Mar 2008 18:43:56 -0700")
References: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
Message-ID: <87skygqpf1.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> +static void test_negative_dest_length(void)
> +{
> +    int len;
> +    char buf[10];
> +
> +    /* Test return on negative dest length */
> +    SetLastError( 0xdeadbeef );
> +    memset(buf,'x',sizeof(buf));
> +    len = WideCharToMultiByte(CP_ACP, 0, foobarW, -1, buf, -1, NULL, NULL);
> +    ok(len == 0 && GetLastError() == ERROR_INVALID_PARAMETER,
> +       "WideCharToMultiByte(destlen -1): len=%d error=%x\n", len, GetLastError());

If you want to determine the behavior for negative values you have to
test more than just -1, it may well be special.

-- 
Alexandre Julliard
julliard at winehq.org


From epssyis at gmail.com  Mon Mar 24 07:47:10 2008
From: epssyis at gmail.com (Edward Savage)
Date: Mon, 24 Mar 2008 23:47:10 +1100
Subject: Wine1.0 and LGPLv3?
In-Reply-To: <200803220946.51144.kai.blin@gmail.com>
References: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>
	<200803220946.51144.kai.blin@gmail.com>
Message-ID: <d6c5d7290803240547v4328fa03u1bab261be70c3bc7@mail.gmail.com>

>  I think the agreement from WineConf 2007 was to change as soon as there's a
>  reason to do so. So far it seems like there isn't.
>

With my understanding of the new clauses (or protections) isn't this
attitude akin to not replacing the battery in your fire alarm until
you smell smoke?

I've noticed this stance from several gpl projects and it worries me
that every one is going to simply ignore the issues raised from gplv3
until some project gets burnt and there will be a made rush by every
one else to protect themselves.  What if wine is that project?

On the other hand the process of updating to the v3 license would be
rather time consuming (at least according to the time line fsf put
out) for the wine project and I agree that 1.0 probably wouldn't be
the time to do it and as we all know, none of the doom and gloom
predicted has come to pass (at least yet).

Could I suggest making a firm commitment to either stay with v2 or
move to v3 and set a release (or date)  that this will happen by as a
proper way of dealing with any change.


From kai.blin at gmail.com  Mon Mar 24 07:59:58 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 24 Mar 2008 13:59:58 +0100
Subject: Wine1.0 and LGPLv3?
In-Reply-To: <d6c5d7290803240547v4328fa03u1bab261be70c3bc7@mail.gmail.com>
References: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>
	<200803220946.51144.kai.blin@gmail.com>
	<d6c5d7290803240547v4328fa03u1bab261be70c3bc7@mail.gmail.com>
Message-ID: <200803241400.02463.kai.blin@gmail.com>

On Monday 24 March 2008 13:47:10 Edward Savage wrote:
> >  I think the agreement from WineConf 2007 was to change as soon as
> > there's a reason to do so. So far it seems like there isn't.
>
> I've noticed this stance from several gpl projects and it worries me
> that every one is going to simply ignore the issues raised from gplv3
> until some project gets burnt and there will be a made rush by every
> one else to protect themselves.  What if wine is that project?

That's about the patent protection, isn't it? We'll have to consider that when 
Microsoft starts contributing patches. ;)

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080324/54a45d1d/attachment.pgp 

From tony.wasserka at freenet.de  Mon Mar 24 07:56:26 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Mon, 24 Mar 2008 13:56:26 +0100
Subject: d3d9_36: partially implement D3DXCreateTextureFromFile
Message-ID: <E1JdmDy-00035O-5S@www20.emo.freenet-rz.de>

> Hello
> 
> 1) use 4 spaces instead of tab in
> 
>  	d3dx9_36_main.c 
>  	font.c 
> -	math.c
> +	math.c 
> +        texture.c
> 
> 
> 2) D3DXCreateTextureFromFileW(ptr wstr ptr) should be forwarded to its d3dx8 counterpart and you implement it in d3dx8 dll
> 
> 
> David

No, tabs are okay in Makefile.in (every dll is using tabs there). Also, the first parameter of D3DXCreateTextureFromFile is an LPDIRECT3DDEVICE8 in d3dx8 and an LPDIRECT3DDEVICE9 in d3dx9, i.e. this call can't be forwarded.
However, you should probably call D3DXCreateTextureFromFileEx here to prevent duplicated code. If you're going to implement that function, too, you may need to stub D3DXFilterTexture (just from looking at the parameter list of the extended function, not sure if you REALLY need to do so).

    Tony




Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain inkl.
http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/index.html



From kai.blin at gmail.com  Mon Mar 24 08:10:26 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 24 Mar 2008 14:10:26 +0100
Subject: wine 1.0 status: T minus 75 days. 82 open bugs.
In-Reply-To: <a71bd89a0803232300g168a6600j79b2b6f365cb09a3@mail.gmail.com>
References: <a71bd89a0803232300g168a6600j79b2b6f365cb09a3@mail.gmail.com>
Message-ID: <200803241410.26516.kai.blin@gmail.com>

On Monday 24 March 2008 07:00:31 Dan Kegel wrote:

> 3711 	winsock 	0 	Musicmatch fails to install (missing registry key,
> HTTP_HttpOpenRequest() problem)

That's a wininet bug, I've changed the component.

> 10032 	winsock 	1 	Wine must not use unix select() for networking
> where there might be high fd's

Sent a patch for that.

> 9787 	winsock 	44 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)

That one's Andrey Turkin's playground.

> 5625 	winsock 	3 	Wine does not handle internet proxy settings conveniently

This is a wininet bug as well.

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080324/2d9588df/attachment.pgp 

From kai.blin at gmail.com  Mon Mar 24 08:28:10 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 24 Mar 2008 14:28:10 +0100
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>
	<e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>
Message-ID: <200803241428.10359.kai.blin@gmail.com>

On Sunday 23 March 2008 17:06:43 Cesar Izurieta wrote:
> Here are some ideas of what I think could be implemented for the FUSE
> project for GSOC.
>
> - This FUSE can be a "proxy" filesystem. This means that we could use
> an existing filesystem and mount this proxy filesystem and make it
> appear as case insensitive. This means that if there's a file named
> "A.txt" on a folder and I copy "a.txt", "A.txt" should be overridden.
> Same logic for other cases.
>
> - A utility to test for invalid filenames (like "A.txt" and "a.txt" on
> the same original directory)

Perhaps this shouldn't be an extra tool but more like a setting what to do in 
a case like that.

> - Is there any need to simulate windows' permission schemes
> (inheritance, ACLs) when using this filesystem?

Alexandre said that wasn't interesting until Wine goes multi-user. So don't 
worry about that for now.

> - Since this will be a proxy filesystem, there is the chance to
> present some folders with different names. For example "Program Files"
> could be presented as "Archivos de Programa" when mounting the
> filesystem with a Spanish locale. The original folder will be still
> there and you could cd to it and both will point to the same back end
> folder.

I'm not sure if that's really useful. IIRC wineprefixcreate already creates a 
localized directory layout.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080324/010b0123/attachment-0001.pgp 

From julliard at winehq.org  Mon Mar 24 08:48:20 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 24 Mar 2008 14:48:20 +0100
Subject: [PATCH 01/45] [WinHelp]: now setting the text Window as a
	richedit one
In-Reply-To: <20080323091622.18009.13901.stgit@localhost> (Eric Pouech's
	message of "Sun, 23 Mar 2008 10:16:23 +0100")
References: <20080323091354.18009.31730.stgit@localhost>
	<20080323091622.18009.13901.stgit@localhost>
Message-ID: <87wsnsnsgr.fsf@wine.dyndns.org>

Eric Pouech <eric.pouech at orange.fr> writes:

> - all popups are now of MainWindow kind (and embed a richedit control)
>
> A+
> ---
>
>  programs/winhelp/string.c  |    1 
>  programs/winhelp/winhelp.c |  932 ++------------------------------------------
>  programs/winhelp/winhelp.h |   42 --
>  3 files changed, 40 insertions(+), 935 deletions(-)

This seems to break the text window pretty badly, the window is now
completely blank with just a blinking caret.

-- 
Alexandre Julliard
julliard at winehq.org


From juan.lang at gmail.com  Mon Mar 24 10:32:29 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Mon, 24 Mar 2008 08:32:29 -0700
Subject: Confusing SOCKET and int in netapi32
Message-ID: <3a768c550803240832l78bd03d0ld4151d70fb7c9a@mail.gmail.com>

Hi, commit 63504e9e80acb35666f8689526c67dd99c4fb3ba (janitorial: Use
poll() instead of select().) appears to confuse the use of a SOCKET
with an int:

 #include "winsock2.h"
 #include "windef.h"
@@ -302,13 +311,12 @@ static UCHAR NetBTWaitForNameResponse(const
NetBTAdapter *adapter, SOCKET fd,
     while (!found && ret == NRC_GOODRET && (now = GetTickCount()) < waitUntil)
     {
         DWORD msToWait = waitUntil - now;
-        struct fd_set fds;
-        struct timeval timeout = { msToWait / 1000, msToWait % 1000 };
+        struct pollfd pfd;
         int r;

-        FD_ZERO(&fds);
-        FD_SET(fd, &fds);
-        r = select(fd + 1, &fds, NULL, NULL, &timeout);
+        pfd.fd = fd;
+        pfd.events = POLLIN;
+        r = poll(&pfd, 1, msToWait);

I can't imagine how this could work.  Notice that netapi32 is linked
against ws2_32, includes winsock2.h, and that fd is a SOCKET.  Could
this part of the commit be reverted, please?
--Juan


From m.b.lankhorst at gmail.com  Mon Mar 24 10:54:34 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 24 Mar 2008 08:54:34 -0700
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
In-Reply-To: <87skygqpf1.fsf@wine.dyndns.org>
References: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
	<87skygqpf1.fsf@wine.dyndns.org>
Message-ID: <b130c85e0803240854n71dd0daao43a7272f85d84916@mail.gmail.com>

Hello Dan and AJ,

2008/3/24, Alexandre Julliard <julliard at winehq.org>:
> "Dan Kegel" <dank at kegel.com> writes:
>
>  > +static void test_negative_dest_length(void)
>  > +{
>  > +    int len;
>  > +    char buf[10];
>  > +
>  > +    /* Test return on negative dest length */
>  > +    SetLastError( 0xdeadbeef );
>  > +    memset(buf,'x',sizeof(buf));
>  > +    len = WideCharToMultiByte(CP_ACP, 0, foobarW, -1, buf, -1, NULL, NULL);
>  > +    ok(len == 0 && GetLastError() == ERROR_INVALID_PARAMETER,
>  > +       "WideCharToMultiByte(destlen -1): len=%d error=%x\n", len, GetLastError());
>
>  If you want to determine the behavior for negative values you have to
>  test more than just -1, it may well be special.
The test is valid at least on xp, however it could be that wine
internally relies on the broken behavior, so I'm not 100% sure whether
it can be committed without checking for that first?

Cheers,
Maarten


From kai.blin at gmail.com  Mon Mar 24 11:06:43 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 24 Mar 2008 17:06:43 +0100
Subject: Confusing SOCKET and int in netapi32
In-Reply-To: <3a768c550803240832l78bd03d0ld4151d70fb7c9a@mail.gmail.com>
References: <3a768c550803240832l78bd03d0ld4151d70fb7c9a@mail.gmail.com>
Message-ID: <200803241706.48440.kai.blin@gmail.com>

On Monday 24 March 2008 16:32:29 Juan Lang wrote:
> Hi, commit 63504e9e80acb35666f8689526c67dd99c4fb3ba (janitorial: Use
> poll() instead of select().) appears to confuse the use of a SOCKET
> with an int:

D'oh, you're right. I've sent a partial revert for this. Seems like that part 
isn't tested, as make test in netapi32 worked without any problems.

Thanks for the catch,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080324/97ea70ea/attachment.pgp 

From juan.lang at gmail.com  Mon Mar 24 11:09:29 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Mon, 24 Mar 2008 09:09:29 -0700
Subject: Confusing SOCKET and int in netapi32
In-Reply-To: <200803241706.48440.kai.blin@gmail.com>
References: <3a768c550803240832l78bd03d0ld4151d70fb7c9a@mail.gmail.com>
	<200803241706.48440.kai.blin@gmail.com>
Message-ID: <3a768c550803240909y244d7c34h86241f33d9acea70@mail.gmail.com>

>  D'oh, you're right. I've sent a partial revert for this. Seems like that part
>  isn't tested, as make test in netapi32 worked without any problems.

Right, there isn't any way to test it.  We can't run NBT servers in
Wine as normal users (requires a low port #, conflicts with Samba),
and we can't count on an external server being present.

--Juan


From truiken at gmail.com  Mon Mar 24 11:15:06 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 24 Mar 2008 11:15:06 -0500
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
In-Reply-To: <b130c85e0803240854n71dd0daao43a7272f85d84916@mail.gmail.com>
References: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
	<87skygqpf1.fsf@wine.dyndns.org>
	<b130c85e0803240854n71dd0daao43a7272f85d84916@mail.gmail.com>
Message-ID: <22821af30803240915w77f600f6ieb0d65afbb86c04b@mail.gmail.com>

On Mon, Mar 24, 2008 at 10:54 AM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Hello Dan and AJ,
>
>  2008/3/24, Alexandre Julliard <julliard at winehq.org>:
>
>
> > "Dan Kegel" <dank at kegel.com> writes:
>  >
>  >  > +static void test_negative_dest_length(void)
>  >  > +{
>  >  > +    int len;
>  >  > +    char buf[10];
>  >  > +
>  >  > +    /* Test return on negative dest length */
>  >  > +    SetLastError( 0xdeadbeef );
>  >  > +    memset(buf,'x',sizeof(buf));
>  >  > +    len = WideCharToMultiByte(CP_ACP, 0, foobarW, -1, buf, -1, NULL, NULL);
>  >  > +    ok(len == 0 && GetLastError() == ERROR_INVALID_PARAMETER,
>  >  > +       "WideCharToMultiByte(destlen -1): len=%d error=%x\n", len, GetLastError());
>  >
>  >  If you want to determine the behavior for negative values you have to
>  >  test more than just -1, it may well be special.
>  The test is valid at least on xp, however it could be that wine
>  internally relies on the broken behavior, so I'm not 100% sure whether
>  it can be committed without checking for that first?
>

It's invalid because -1 may be a special case, as Alexandre stated.
That is, there may be a difference between length -1 and length -x,
where x is a positive integer > 1.

-- 
James Hawkins


From truiken at gmail.com  Mon Mar 24 12:51:13 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 24 Mar 2008 12:51:13 -0500
Subject: [Bug 9484] Program refuses to run because of ProtectCD/
	ProtectDISC copy-protection
In-Reply-To: <E1JdqiA-0001ij-Ul@wine.codeweavers.com>
References: <bug-9484-11@http.bugs.winehq.org/>
	<E1JdqiA-0001ij-Ul@wine.codeweavers.com>
Message-ID: <22821af30803241051g2b04962cub3749ee800bb96f7@mail.gmail.com>

On 3/24/08, wine-bugs at winehq.org <wine-bugs at winehq.org> wrote:
> http://bugs.winehq.org/show_bug.cgi?id=9484
>
>
> --- Comment #9 from Austin English <austinenglish at gmail.com>  2008-03-24 12:43:54 ---
>  Can anyone test this in wine 0.9.58? Some other copy protections are working
>  better, and if this isn't working yet, we might want to delay it to wine 1.2...
>

What's the point of having a blocker list if we keep deferring those
bugs?  Granted not every bug in the list deserves a spot, but we need
to knuckle down and get these bugs fixed.  When we get closer to the
release date, we can get a better idea of which bugs are not feasible
to fix before the release.  Until that point, this bug list needs to
receive top priority.

-- 
James Hawkins


From truiken at gmail.com  Mon Mar 24 12:33:05 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 24 Mar 2008 12:33:05 -0500
Subject: Download.template: Update PC-BSD download link and icon [Resend]
In-Reply-To: <b6bb06270803241005m353613a8l9baba479359114fc@mail.gmail.com>
References: <b6bb06270803241005m353613a8l9baba479359114fc@mail.gmail.com>
Message-ID: <22821af30803241033i3c3811fey9a8f3d447627cf7e@mail.gmail.com>

On 3/24/08, Austin English <austinenglish at gmail.com> wrote:
> Not sure why it wasn't applied the first time. Didn't receive any
>  comments on it. Anywho, in case it was accidently sent to /dev/null,
>  here it is again. Fixes bug 12095.
>  http://bugs.winehq.org/show_bug.cgi?id=12095
>

No patch attached.

-- 
James Hawkins


From austinenglish at gmail.com  Mon Mar 24 13:02:27 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 24 Mar 2008 13:02:27 -0500
Subject: [Bug 9484] Program refuses to run because of ProtectCD/
	ProtectDISC copy-protection
In-Reply-To: <22821af30803241051g2b04962cub3749ee800bb96f7@mail.gmail.com>
References: <bug-9484-11@http.bugs.winehq.org/>
	<E1JdqiA-0001ij-Ul@wine.codeweavers.com>
	<22821af30803241051g2b04962cub3749ee800bb96f7@mail.gmail.com>
Message-ID: <b6bb06270803241102g5c991ab5y877e35f8962138a1@mail.gmail.com>

On Mon, Mar 24, 2008 at 12:51 PM, James Hawkins <truiken at gmail.com> wrote:
> On 3/24/08, wine-bugs at winehq.org <wine-bugs at winehq.org> wrote:
>  > http://bugs.winehq.org/show_bug.cgi?id=9484
>  >
>  >
>  > --- Comment #9 from Austin English <austinenglish at gmail.com>  2008-03-24 12:43:54 ---
>  >  Can anyone test this in wine 0.9.58? Some other copy protections are working
>  >  better, and if this isn't working yet, we might want to delay it to wine 1.2...
>  >
>
>  What's the point of having a blocker list if we keep deferring those
>  bugs?  Granted not every bug in the list deserves a spot, but we need
>  to knuckle down and get these bugs fixed.  When we get closer to the
>  release date, we can get a better idea of which bugs are not feasible
>  to fix before the release.  Until that point, this bug list needs to
>  receive top priority.
>
>  --
>  James Hawkins
>

I was going through a few of the 1.0 bugs that haven't been tested in
a while. Since it has no demo, I can't personally test it, and was
trying to see if any progress has been made in the past few months (as
has been with SafeDisc). While it is certainly hard to tell if it can
be fixed by 1.0, having someone test it and see how much closer we are
to fixing it is the first step in figuring that out.


From truiken at gmail.com  Mon Mar 24 13:06:30 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 24 Mar 2008 13:06:30 -0500
Subject: [Bug 9484] Program refuses to run because of ProtectCD/
	ProtectDISC copy-protection
In-Reply-To: <b6bb06270803241102g5c991ab5y877e35f8962138a1@mail.gmail.com>
References: <bug-9484-11@http.bugs.winehq.org/>
	<E1JdqiA-0001ij-Ul@wine.codeweavers.com>
	<22821af30803241051g2b04962cub3749ee800bb96f7@mail.gmail.com>
	<b6bb06270803241102g5c991ab5y877e35f8962138a1@mail.gmail.com>
Message-ID: <22821af30803241106t1ff4c08cw81fde6ad3cc05db@mail.gmail.com>

On Mon, Mar 24, 2008 at 1:02 PM, Austin English <austinenglish at gmail.com> wrote:
>
> On Mon, Mar 24, 2008 at 12:51 PM, James Hawkins <truiken at gmail.com> wrote:
> > On 3/24/08, wine-bugs at winehq.org <wine-bugs at winehq.org> wrote:
> >  > http://bugs.winehq.org/show_bug.cgi?id=9484
> >  >
> >  >
> >  > --- Comment #9 from Austin English <austinenglish at gmail.com>  2008-03-24 12:43:54 ---
> >  >  Can anyone test this in wine 0.9.58? Some other copy protections are working
> >  >  better, and if this isn't working yet, we might want to delay it to wine 1.2...
> >  >
> >
> >  What's the point of having a blocker list if we keep deferring those
> >  bugs?  Granted not every bug in the list deserves a spot, but we need
> >  to knuckle down and get these bugs fixed.  When we get closer to the
> >  release date, we can get a better idea of which bugs are not feasible
> >  to fix before the release.  Until that point, this bug list needs to
> >  receive top priority.
> >
> >  --
> >  James Hawkins
> >
>
> I was going through a few of the 1.0 bugs that haven't been tested in
> a while. Since it has no demo, I can't personally test it, and was
> trying to see if any progress has been made in the past few months (as
> has been with SafeDisc). While it is certainly hard to tell if it can
> be fixed by 1.0, having someone test it and see how much closer we are
> to fixing it is the first step in figuring that out.
>

No objection there.  My point about deferring bugs stands though.

-- 
James Hawkins


From alex at thehandofagony.com  Mon Mar 24 13:16:54 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Mon, 24 Mar 2008 19:16:54 +0100
Subject: Appdb request: allow browsing for downloadable platinum apps
In-Reply-To: <a71bd89a0803181610w12d2c53fq880a301ab110b8ea@mail.gmail.com>
References: <a71bd89a0803181610w12d2c53fq880a301ab110b8ea@mail.gmail.com>
Message-ID: <200803241916.55294.alex@thehandofagony.com>

> The appdb has a "browse by rating" and a "browse downloadable"
> option, but there's no way to combine them.
>
> Can we add a 'downloadable' checkbox in the 'browse by rating'
> page, maybe?

We do have some filtering code lying around; hopefully there will be time to 
merge it in soon.


Alexander N. S?rnes


From julliard at winehq.org  Mon Mar 24 13:33:47 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 24 Mar 2008 19:33:47 +0100
Subject: winex11.drv: Don't add owned windows to the taskbar
In-Reply-To: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com> (Dmitry Timoshkov's
	message of "Mon, 24 Mar 2008 14:33:34 +0800")
References: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com>
Message-ID: <87fxugnf90.fsf@wine.dyndns.org>

Dmitry Timoshkov <dmitry at codeweavers.com> writes:

> this patch fixes the bug 12160. According to my tests explorer in XP
> doesn't add owned windows to the taskbar.

Do we really want to remove them from the pager too?

-- 
Alexandre Julliard
julliard at winehq.org


From mishra.anurag07 at gmail.com  Mon Mar 24 14:00:33 2008
From: mishra.anurag07 at gmail.com (Anurag Mishra)
Date: Tue, 25 Mar 2008 00:30:33 +0530
Subject: Fwd: Questions regarding Summer of Code( and Dplay)
In-Reply-To: <e7ea0e360803241200v5007b504m3e40e52e2c1dda59@mail.gmail.com>
References: <e7ea0e360803192102i730d6fb2i5584209783ff27f3@mail.gmail.com>
	<b130c85e0803192251i19bce0eeof6fa098503273806@mail.gmail.com>
	<e7ea0e360803241200v5007b504m3e40e52e2c1dda59@mail.gmail.com>
Message-ID: <e7ea0e360803241200h302f64f8va363dbbb0fdf6178@mail.gmail.com>

---------- Forwarded message ----------
From: Anurag Mishra <mishra.anurag07 at gmail.com>
Date: Tue, Mar 25, 2008 at 12:30 AM
Subject: Re: Questions regarding Summer of Code( and Dplay)
To: Maarten Lankhorst <m.b.lankhorst at gmail.com>


Hi,
  I have already compiled git version and am learning the basics of
 using git now.
  Someone on irc suggested to first write test cases about the
 functions in wine(that may be missing) and crosscheck on windows.
 Right now, I am looking to start in that direction.

 Thanks,
 Anurag.



 On Thu, Mar 20, 2008 at 11:21 AM, Maarten Lankhorst
 <m.b.lankhorst at gmail.com> wrote:
 > Hello Anurag,
 >
 >  2008/3/19, Anurag Mishra <mishra.anurag07 at gmail.com>:
 >
 >
 > >   I am student at IIT Kanpur[1]. I have quite good knowledge about C
 >  >  and have been tracking development of Wine over a period of 6 months
 >  >  or so. I have good knowledge about C(and using it theoretically to
 >  >  implement stacks, efficient structures and so on). However, I have
 >  >  little real life experience about programming a project. I have little
 >  >  experience about Window's API.
 >  >   I was looking to participate in Wine development this summer. On SoC
 >  >  page, the idea of Dplay was bought up. I am interested in trying hands
 >  >  on that. Can anyone suggest what would be a good starting point?
 >
 >  There are only a few important things to directplay as far as I know.
 >  The first one is find a game that runs in wine and uses it, and works
 >  reasonably well single player but not at all multiplayer or online
 >  because of the missing things (fixmes on dplay in console). After you
 >  played the game a little bit, think of a plan on how you want to
 >  tackle this problem.
 >
 >  Have you managed to compile a git version of wine yet?
 >
 >  Cheers,
 >  Maarten.
 >


From julliard at winehq.org  Mon Mar 24 15:17:21 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 24 Mar 2008 21:17:21 +0100
Subject: user32: Implement BroadcastSystemMessage, try 5.1
In-Reply-To: <b130c85e0803240515y66991587x19c0cebb899d7461@mail.gmail.com>
	(Maarten Lankhorst's message of "Mon, 24 Mar 2008 05:15:11 -0700")
References: <b130c85e0803240515y66991587x19c0cebb899d7461@mail.gmail.com>
Message-ID: <87zlsnnage.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> +    TRACE("Flags: %08x, recipients: %p(0x%x), msg: %04x, wparam: %08lx, lparam: %08lx\n", flags, recipients,
> +         (recipients ? *recipients : recips), msg, wp, lp);
> +
> +    if (flags > BSF_LUID)

It doesn't make sense to compare flags with >. What are you trying to
check for?

> -}
> +    else
> +        FIXME("Recipients %08x not supported!\n", *recipients);
> +
> +    if (ret > 0 && !GetLastError())
> +        SetLastError(lasterror);

In general if you have to save and restore last error you are doing
something wrong.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Mon Mar 24 15:20:09 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 24 Mar 2008 21:20:09 +0100
Subject: (resend)imm: implement ImmGetIMEFileNameW and ImmGetIMEFileNameA
	correct registry lookups
In-Reply-To: <47E7D1C5.1010409@codeweavers.com> (Aric Stewart's message of
	"Mon, 24 Mar 2008 11:07:33 -0500")
References: <47E7D1C5.1010409@codeweavers.com>
Message-ID: <87ve3bnabq.fsf@wine.dyndns.org>

Aric Stewart <aric at codeweavers.com> writes:

> +    if (rc > 0)
> +    {
> +        if (uBufLen && lpszFileName)
> +            rc = WideCharToMultiByte(CP_ACP, 0, bufW, uBufLen, lpszFileName,
> +                                 uBufLen, NULL, NULL);
> +        else /* get the length */
> +            rc = WideCharToMultiByte(CP_ACP, 0, bufW, wBufLen, NULL, 0, NULL,
> +                                     NULL);

The source length should be -1, you don't want to convert the whole
buffer.

> +    static CHAR KeyboardKey[] = "System\\CurrentControlSet\\Control\\Keyboard Layouts";
> +    static WCHAR szImeFileW[] = {'I','m','e',' ','F','i','l','e',0};
> +
> +    HKEY keyboardKey;
> +    DWORD length;
> +    DWORD rc;
> +    CHAR regKey[sizeof(KeyboardKey) + 11];
> +
> +    wsprintfA( regKey, "%s\\%08x", KeyboardKey, (unsigned)hKL );
> +    rc = RegOpenKeyA( HKEY_LOCAL_MACHINE, regKey, &keyboardKey);

This should use Unicode like the rest of the function.

-- 
Alexandre Julliard
julliard at winehq.org


From thestig at google.com  Mon Mar 24 17:05:01 2008
From: thestig at google.com (Lei Zhang)
Date: Mon, 24 Mar 2008 15:05:01 -0700
Subject: bugzilla patches
Message-ID: <558b2f5c0803241505q643908ebn4a0cbf08672d4c48@mail.gmail.com>

Hi,

Can someone take a look at my bugzilla patches from over a week ago?

http://www.winehq.org/pipermail/wine-patches/2008-March/051551.html
http://www.winehq.org/pipermail/wine-patches/2008-March/051552.html
http://www.winehq.org/pipermail/wine-patches/2008-March/051553.html
http://www.winehq.org/pipermail/wine-patches/2008-March/051768.html

- Lei


From jnewman at codeweavers.com  Mon Mar 24 17:20:01 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Mon, 24 Mar 2008 17:20:01 -0500
Subject: bugzilla patches
In-Reply-To: <558b2f5c0803241505q643908ebn4a0cbf08672d4c48@mail.gmail.com>
References: <558b2f5c0803241505q643908ebn4a0cbf08672d4c48@mail.gmail.com>
Message-ID: <47E82911.5010605@codeweavers.com>

I plan to, just in the middle of a ton of CW work ATM.

Lei Zhang wrote:
> Hi,
> 
> Can someone take a look at my bugzilla patches from over a week ago?
> 
> http://www.winehq.org/pipermail/wine-patches/2008-March/051551.html
> http://www.winehq.org/pipermail/wine-patches/2008-March/051552.html
> http://www.winehq.org/pipermail/wine-patches/2008-March/051553.html
> http://www.winehq.org/pipermail/wine-patches/2008-March/051768.html
> 
> - Lei
> 
> 


From cesar at ecuarock.net  Mon Mar 24 19:38:31 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Mon, 24 Mar 2008 19:38:31 -0500
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <63ee2bc70803231611k31e16781j82f1de4e6cb73cf4@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<47D0296F.9020404@gmx.net>
	<e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>
	<e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>
	<63ee2bc70803231611k31e16781j82f1de4e6cb73cf4@mail.gmail.com>
Message-ID: <e3d3ae8f0803241738j174283e7na8ce59616bfa20c7@mail.gmail.com>

On Sun, Mar 23, 2008 at 6:11 PM, Corey McClymonds <galeru at gmail.com> wrote:
> On 3/23/08, Cesar Izurieta <cesar at ecuarock.net> wrote:
>  > Here are some ideas of what I think could be implemented for the FUSE
>  >  project for GSOC.
>  >
>  >  - This FUSE can be a "proxy" filesystem. This means that we could use
>  >  an existing filesystem and mount this proxy filesystem and make it
>  >  appear as case insensitive. This means that if there's a file named
>  >  "A.txt" on a folder and I copy "a.txt", "A.txt" should be overridden.
>  >  Same logic for other cases.
>  >
>  >  - A utility to test for invalid filenames (like "A.txt" and "a.txt" on
>  >  the same original directory)
>  >
>  >  - Is there any need to simulate windows' permission schemes
>  >  (inheritance, ACLs) when using this filesystem?
>  >
>  >  - Since this will be a proxy filesystem, there is the chance to
>  >  present some folders with different names. For example "Program Files"
>  >  could be presented as "Archivos de Programa" when mounting the
>  >  filesystem with a Spanish locale. The original folder will be still
>  >  there and you could cd to it and both will point to the same back end
>  >  folder.
>  >
>  >  If you have any other ideas please let me know.
>  >
>  >  Cesar
>
>  Are you going to do integration under wine, or are you going to just
>  do the file system.  For instance, what happens if you run wine in a
>  folder that isn't case insensitive?
>

You could mount a case insensitive proxy to the whole file system
(starting from /) somewhere in .wine, maybe .wine/drives/x or
something like that and have wine access files only through .wine and
never from outside.

I'm pretty sure this could have performance penalties but I guess we
will have to find out how much performance you loose by using this
approach using some benchmarking tools or writing some test code for
that.


From cesar at ecuarock.net  Mon Mar 24 19:45:11 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Mon, 24 Mar 2008 19:45:11 -0500
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <200803241428.10359.kai.blin@gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>
	<e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>
	<200803241428.10359.kai.blin@gmail.com>
Message-ID: <e3d3ae8f0803241745h2c83d4d6lcb02059b211eddd7@mail.gmail.com>

On Mon, Mar 24, 2008 at 8:28 AM, Kai Blin <kai.blin at gmail.com> wrote:
> On Sunday 23 March 2008 17:06:43 Cesar Izurieta wrote:
>  > Here are some ideas of what I think could be implemented for the FUSE
>  > project for GSOC.
>  >
>  > - This FUSE can be a "proxy" filesystem. This means that we could use
>  > an existing filesystem and mount this proxy filesystem and make it
>  > appear as case insensitive. This means that if there's a file named
>  > "A.txt" on a folder and I copy "a.txt", "A.txt" should be overridden.
>  > Same logic for other cases.
>  >
>  > - A utility to test for invalid filenames (like "A.txt" and "a.txt" on
>  > the same original directory)
>
>  Perhaps this shouldn't be an extra tool but more like a setting what to do in
>  a case like that.
>

That sounds good. Maybe doing something like what windows does to long
file names when looking those files in a console, for example
"C:\Program Files" gets converted to "C:\Progra~1", we could apply the
same logic, have the first file "A.txt" and the second "a~1.txt". What
do you think?

>
>  > - Is there any need to simulate windows' permission schemes
>  > (inheritance, ACLs) when using this filesystem?
>
>  Alexandre said that wasn't interesting until Wine goes multi-user. So don't
>  worry about that for now.
>
>
>  > - Since this will be a proxy filesystem, there is the chance to
>  > present some folders with different names. For example "Program Files"
>  > could be presented as "Archivos de Programa" when mounting the
>  > filesystem with a Spanish locale. The original folder will be still
>  > there and you could cd to it and both will point to the same back end
>  > folder.
>
>  I'm not sure if that's really useful. IIRC wineprefixcreate already creates a
>  localized directory layout.
>
>  Cheers,
>  Kai
>
>  --
>  Kai Blin
>  WorldForge developer  http://www.worldforge.org/
>  Wine developer        http://wiki.winehq.org/KaiBlin
>  Samba team member     http://www.samba.org/samba/team/
>  --
>  Will code for cotton.
>
>
>
>


From stefan at codeweavers.com  Mon Mar 24 20:21:15 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 25 Mar 2008 02:21:15 +0100
Subject: [PATCH 9/9] d3d9/tests: Fix precision problems in shademode_test.
In-Reply-To: <47E8417A.6090104@inbox.lv>
References: <47E8417A.6090104@inbox.lv>
Message-ID: <200803250221.15369.stefan@codeweavers.com>

Am Dienstag, 25. M?rz 2008 01:04:10 schrieb Alexander Dorofeyev:
> ---
>   dlls/d3d9/tests/visual.c |   26 +++++++++++++++++++++-----
>   1 files changed, 21 insertions(+), 5 deletions(-)
The drawback of this is that if a driver behaves differently in 
D3DSHADEMODE_PHONG this will slip through as imprecision most likely. That is 
something we have to live with I am afraid


From raccoonone at procyongames.com  Tue Mar 25 00:18:50 2008
From: raccoonone at procyongames.com (Christopher)
Date: Mon, 24 Mar 2008 22:18:50 -0700
Subject: USB Human Interface Device support
Message-ID: <47E88B3A.3060003@procyongames.com>

I have a flight sim, PhoenixRC, which I'd like to get working under 
Wine. As of a couple months ago most of the DirectX problems have been 
fixed, but the game uses a USB adapter to connect various controllers to 
the computer. The USB adapter is an HID and is recognized by Linux; 
however I can't get it to work through Wine. At least part of the 
problem seems to be that SetupDiGetClassDevs calls 
SETUPDI_EnumerateInterfaces which tries to open registry keys that don't 
exist. There isn't an entry in 
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses for 
HID interfaces, in fact that whole set of registry keys seems to be 
missing. Is anyone working on patches to make this work, or can someone 
point me to the function(s) that need to be implemented for HIDs to be 
setup in the registry correctly? I'm not sure when/how those keys are 
suppose to be created.
Thanks,
Christopher Berner


From dank at kegel.com  Tue Mar 25 00:50:25 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 24 Mar 2008 22:50:25 -0700
Subject: Wine 1.0 status: T minus 74 days. 78 open bugs.
Message-ID: <a71bd89a0803242250g392d1c48r15094dd056bca78c@mail.gmail.com>

Today, three bugs were resolved:
4803   programs        5       Steam: not all lnk files are processed
into linux shortcuts
10032  winsock         1       Wine must not use unix select() for
networking where there might be high fd's
11431  user32  5       Adobe Photoshop CS2: z-overlay of image containers
(although 10032's fix went too far, and one hunk is pending reversion).

and one bug was deferred:
7915   -unknown        4       15 of the internal tests of wine fail on Mac OS X

History:
3/22: 87 bugs, 76 days to go
3/23: 82 bugs, 75 days to go
3/24: 78 bugs, 74 days to go
Excellent progress.  Too bad past performance is no indication of
future results :-)

Here's a list of the currently open 1.0 bugs, sorted by component, with votes:
5948    -unknown  	1  	Star Trek: Armada does not install
11281 	-unknown 	2 	CJK input many issues
5024 	-unknown 	4 	Thief: Deadly Shadows crashes:page fault on read
access to 0x0000040c
8125 	-unknown 	0 	Marratech 6.1 crashes on start
9916 	-unknown 	6 	"make test" usually fails
5061 	-unknown 	6 	Copying from Windows Firefox in Wine and pasting to
Linux OpenOffice pastes metadata as data
9459 	-unknown 	8 	FIFA 2007 crashes with the recent versions
12097 	-unknown 	2 	Wine 1.0 should not ship out-of-sync resource translations
7477 	-unknown 	1 	Uplink demo crashes
4971 	-unknown 	3 	Corel Draw 12 demo install fails
9178 	-unknown 	7 	"hello world" dos program hangs
5055 	-unknown 	5 	Deleting files from a window in wine doesn't send
them to the Trash
5844 	-unknown 	9 	tray minimize
10815 	-unknown 	2 	Cannot drag images into Adobe Photoshop 7 from the
web / desktop
7404 	-unknown 	2 	ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
5402 	-unknown 	0 	Trying to run PhotoStitch 3.1
10147 	-unknown 	0 	Word Viewer 2003 - Tab behavior differs from Windows
9959 	-unknown 	8 	Make wine updates work even if the registry changed
556 	build-en 	2 	Reconcile the Windows and Wine spec files
1114 	comctl32 	2 	Winrar2.90/3.00: Comboex doesn't trigger a event
when you mouse-click in some value of it
2493 	comctl32 	1 	Multi-select listview: Shift-arrow up only selects
top two items
10111 	comctl32 	2 	WINEDEBUG=warn+heap "make test" has heap error in
comdlg32/tests/printdlg.c
9104 	comdlg32 	2 	Pdf-xchange viewer crashes
10040 	crypt32 	2 	Steam crashes during the startup
11681 	directx- 	13 	Add support for video overlay
5955 	directx- 	6 	DirectDrawCreate crash on non-OpenGL desktop
9030 	directx- 	0 	army men hangs on black screen
82 	document 	1 	Stabilize Winelib User Guide Table of Contents
638 	document 	7 	Document Wine debugging channels
6519 	gdi32 	7 	Wine blacks out rotated font bitmap
9771 	gdi32 	37 	Steam Friends doesn't work (fails to render correctly
or refresh)
3270 	gdi32 	13 	Problem with minimized top-level windows
9926 	gdi32 	4 	gdi32.dll should not have exported function pointers
7571 	gdi32 	1 	Accented character glyphs are mixed up with TrueType
fonts (affects e.g. Lotus Notes R5)
9484 	kernel32 	17 	Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
5351 	kernel32 	8 	Windows Installer 3.1 cannot install because of
non-standard drive labeling
5541 	kernel32 	0 	WriteConsole can't write to stdout; affects e.g.
wsh's cscript's usage message
9039 	kernel32 	0 	GS-Auftrag Professional SQL aborts on startup
4733 	kernel32 	4 	Get optimized/compressed/packed executables (non-upx) working
7098 	mscoree 	1 	RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
5163 	msi 	12 	Office XP 2002 crashes on installation
8783 	ntdll 	11 	USB serial ports do not work
9356 	ntdll 	6 	Serial communication not working since wine-0.9.33
6607 	ole 	8 	Drag and Drop not working
9942 	ole 	2 	Powerpoint Viewer 2007 crashes opening .pptx files
2539 	ole 	3 	XDND (Drag and drop for X Windows) doesn't copy text
8095 	ole 	0 	PQ Teaching toy crashes
4770 	ole 	2 	BlackBerry Device Manager fails to install under wine
5926 	programs 	0 	Wine does not provide an implementation of winhlp32.exe
6254 	richedit 	4 	Installer infinite loop from rich text error
9304 	shdocvw 	3 	Temple of Elemental Evil demo doesn't start - gui irresponsive
8898 	shdocvw 	0 	Run Time Error "445": Object doesn't support this
action in Europa Knowledgebase
3546 	shdocvw 	2 	CLSID_InternetShortcut not available...
6095 	shdocvw 	11 	MOTD in counter-strike 1.6 and counter-strike
source does not render
8439 	shell32 	5 	Visual Studio .NET (7) install fails
10905 	shell32 	0 	thinstall firefox demo requires native msvcrt
9809 	shell32 	4 	Autodesk Revit Architecture 2008 install fails
11742 	shlwapi 	8 	Small .net 1.1 app (FastMD5 1.3) fails to start up
12074 	testcase 	2 	The conformance tests fail on Windows
6604 	tools 	2 	Ship icons for the wine-tools that can be used in .desktop files
8246 	urlmon 	3 	invoking htmlhelp:HtmlHelpW crashes wine
664 	user32 	5 	The help menu functionality inside programs is broken
(messaging problem)
3023 	user32 	5 	Orcad - "Place Part" never tries to put down a part
4523 	user32 	5 	Can't copy from Firefox 1.5 and paste into OpenOffice
2 under Wine
124 	wineserv 	2 	Review of Wine Server Protocol
5623 	winex11. 	2 	GetAsyncKeyState wrong if querying process doesn't have focus
3297 	winex11. 	11 	UpdateWindow() doesn't call XFlush()
5828 	winex11. 	24 	Command and Conquer Generals (Zero Hour) doesn't
change the mouse cursor from the default X mouse
7372 	winex11. 	12 	can't copy and paste between gnome apps eg
openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
2368 	winex11. 	5 	Wine loses its X-Window when switching to another
virt. desktop in Fvwm
11019 	winex11. 	1 	matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
11884 	winex11. 	1 	Copy and paste garbage on end
1990 	winex11. 	1 	modifier keys not released when switching desktop
10984 	winex11. 	2 	sun jre 5 update 10 installer hangs in 0.9.52
3711 	wininet 	1 	Musicmatch fails to install (missing registry key,
HTTP_HttpOpenRequest() problem)
5625 	wininet 	3 	Wine does not handle internet proxy settings conveniently
9787 	winsock 	45 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
12005 	wintab32 	0 	Regression in pressure sensitivity with wizardpen
tablet driver and Photoshop 7


From kai.blin at gmail.com  Tue Mar 25 02:26:50 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Tue, 25 Mar 2008 08:26:50 +0100
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <e3d3ae8f0803241745h2c83d4d6lcb02059b211eddd7@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<200803241428.10359.kai.blin@gmail.com>
	<e3d3ae8f0803241745h2c83d4d6lcb02059b211eddd7@mail.gmail.com>
Message-ID: <200803250826.55379.kai.blin@gmail.com>

On Tuesday 25 March 2008 01:45:11 Cesar Izurieta wrote:

> >  Perhaps this shouldn't be an extra tool but more like a setting what to
> > do in a case like that.
>
> That sounds good. Maybe doing something like what windows does to long
> file names when looking those files in a console, for example
> "C:\Program Files" gets converted to "C:\Progra~1", we could apply the
> same logic, have the first file "A.txt" and the second "a~1.txt". What
> do you think?

Well, that's probably an option. But I wouldn't even mind a mode that simply 
deletes one of A.txt or a.txt on mounting. If we start using a file system 
like that for ~/.wine/drive_c and people want to screw around in that 
directory manually, we can expect them to know what they're doing.

Cheers,
Kai
-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080325/b99780d3/attachment.pgp 

From thunderbird2k at gmx.net  Tue Mar 25 03:45:24 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 25 Mar 2008 09:45:24 +0100
Subject: [PATCH 8/9] wined3d: remove ENTER_GL/LEAVE_GL in texture and cube
	texture PreLoad.
In-Reply-To: <47E84178.6070908@inbox.lv>
References: <47E84178.6070908@inbox.lv>
Message-ID: <20080325084524.44120@gmx.net>

> 
> Not really needed for anything and can lead to ActivateContext being
> called 
> while holding lock.
> ---
>   dlls/wined3d/cubetexture.c |    2 --
>   dlls/wined3d/texture.c     |    3 +--
>   2 files changed, 1 insertions(+), 4 deletions(-)

Sure this is a problem but there needs to be a place which calls ENTER_GL/LEAVE_GL. I believe LoadTexture and some of the other functions aren't handling that properly yet, so I wouldn't add this yet.

It is very tricky.

Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.gmx.net/de/entertainment/games/free


From dmitry at codeweavers.com  Tue Mar 25 04:07:22 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 25 Mar 2008 17:07:22 +0800
Subject: Create stub dosx.exe
References: <47E87B6F.5080704@nexicom.net>
Message-ID: <015801c88e57$a42f2070$a600fea9@DMITRY>

"Justin Chevrier" <jchevrier at nexicom.net> wrote:

> +#define WIN32_LEAN_AND_MEAN
> +
> +#include <windows.h>

What's the reason to include anything in an empty stub?

> +int main(int argc, char *argv[])
> +{
> +    return 0;
> +}

-- 
Dmitry.


From paul.vriens.wine at gmail.com  Tue Mar 25 04:08:12 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 25 Mar 2008 10:08:12 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
Message-ID: <47E8C0FC.2010700@gmail.com>

Hi,

We didn't have a new winetest executable for the last few days. MinGW doesn't 
know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.

Especially while in the process of getting ready for 1.0 we should have winetest 
run as much as possible.

My main focus will be adding tests btw until 1.0 is out. These will be both 
tests to proof the correctness of the current implementation as well as tests to 
show missing stuff. There are loads of functions for which we have no tests yet 
and with the 1.0 in sight I think it becomes very important to have tests for 
virtually every function we (have) implement(ed).

-- 
Cheers,

Paul.


From truiken at gmail.com  Tue Mar 25 04:17:29 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 25 Mar 2008 04:17:29 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47E8C0FC.2010700@gmail.com>
References: <47E8C0FC.2010700@gmail.com>
Message-ID: <22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>

On Tue, Mar 25, 2008 at 4:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi,
>
>  We didn't have a new winetest executable for the last few days. MinGW doesn't
>  know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.
>
>  Especially while in the process of getting ready for 1.0 we should have winetest
>  run as much as possible.
>
>  My main focus will be adding tests btw until 1.0 is out. These will be both
>  tests to proof the correctness of the current implementation as well as tests to
>  show missing stuff. There are loads of functions for which we have no tests yet
>  and with the 1.0 in sight I think it becomes very important to have tests for
>  virtually every function we (have) implement(ed).
>

While that's a worthy goal, I think a better short-term goal for the
run up to 1.0 is to fix the current failing tests in Windows.

-- 
James Hawkins


From paul.vriens.wine at gmail.com  Tue Mar 25 04:27:24 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 25 Mar 2008 10:27:24 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
Message-ID: <47E8C57C.9030708@gmail.com>

James Hawkins wrote:
> On Tue, Mar 25, 2008 at 4:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> Hi,
>>
>>  We didn't have a new winetest executable for the last few days. MinGW doesn't
>>  know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.
>>
>>  Especially while in the process of getting ready for 1.0 we should have winetest
>>  run as much as possible.
>>
>>  My main focus will be adding tests btw until 1.0 is out. These will be both
>>  tests to proof the correctness of the current implementation as well as tests to
>>  show missing stuff. There are loads of functions for which we have no tests yet
>>  and with the 1.0 in sight I think it becomes very important to have tests for
>>  virtually every function we (have) implement(ed).
>>
> 
> While that's a worthy goal, I think a better short-term goal for the
> run up to 1.0 is to fix the current failing tests in Windows.
> 
But either way we need an up-to-date winetest executable ;-)

Fixing currently failing tests is as always top on my list as well until I have 
some real time to spend again on implementing stuff.

-- 
Cheers,

Paul.


From truiken at gmail.com  Tue Mar 25 04:30:42 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 25 Mar 2008 04:30:42 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47E8C57C.9030708@gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
Message-ID: <22821af30803250230k4b96628epb096b01290398501@mail.gmail.com>

On Tue, Mar 25, 2008 at 4:27 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>
> James Hawkins wrote:
>  > On Tue, Mar 25, 2008 at 4:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>  >> Hi,
>  >>
>  >>  We didn't have a new winetest executable for the last few days. MinGW doesn't
>  >>  know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.
>  >>
>  >>  Especially while in the process of getting ready for 1.0 we should have winetest
>  >>  run as much as possible.
>  >>
>  >>  My main focus will be adding tests btw until 1.0 is out. These will be both
>  >>  tests to proof the correctness of the current implementation as well as tests to
>  >>  show missing stuff. There are loads of functions for which we have no tests yet
>  >>  and with the 1.0 in sight I think it becomes very important to have tests for
>  >>  virtually every function we (have) implement(ed).
>  >>
>  >
>  > While that's a worthy goal, I think a better short-term goal for the
>  > run up to 1.0 is to fix the current failing tests in Windows.
>  >
>  But either way we need an up-to-date winetest executable ;-)
>

No argument there.  I've been waiting all weekend.  Hopefully we can
get the issue resolved and a new build out to test.

-- 
James Hawkins


From thunderbird2k at gmx.net  Tue Mar 25 04:39:48 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 25 Mar 2008 10:39:48 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47E8C0FC.2010700@gmail.com>
References: <47E8C0FC.2010700@gmail.com>
Message-ID: <20080325093948.145810@gmx.net>

> Hi,
> 
> We didn't have a new winetest executable for the last few days. MinGW
> doesn't 
> know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36
> tests.
> 
> Especially while in the process of getting ready for 1.0 we should have
> winetest 
> run as much as possible.
> 
> My main focus will be adding tests btw until 1.0 is out. These will be
> both 
> tests to proof the correctness of the current implementation as well as
> tests to 
> show missing stuff. There are loads of functions for which we have no
> tests yet 
> and with the 1.0 in sight I think it becomes very important to have tests
> for 
> virtually every function we (have) implement(ed).
> 
> -- 
> Cheers,
> 
> Paul.
> 

As a sidenote. You are also cross compiling wine dlls so now and then. It would be useful to also cross compile d3d8/d3d9 and wined3d but for wined3d -DUSE_WIN32_OPENGL must be set.

Roderick
-- 
Ist Ihr Browser Vista-kompatibel? Jetzt die neuesten 
Browser-Versionen downloaden: http://www.gmx.net/de/go/browser


From julliard at winehq.org  Tue Mar 25 05:08:58 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 25 Mar 2008 11:08:58 +0100
Subject: Create stub dosx.exe
In-Reply-To: <47E87B6F.5080704@nexicom.net> (Justin Chevrier's message of
	"Tue, 25 Mar 2008 00:11:27 -0400")
References: <47E87B6F.5080704@nexicom.net>
Message-ID: <877ifrund1.fsf@wine.dyndns.org>

Justin Chevrier <jchevrier at nexicom.net> writes:

> Changelog:
>
> Create stub dosx.exe

Why do you need this?

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Tue Mar 25 05:57:13 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 25 Mar 2008 11:57:13 +0100
Subject: [PATCH 7/9] wined3d: Make device palettes dynamically allocated.
In-Reply-To: <47E84175.7090205@inbox.lv> (Alexander Dorofeyev's message of
	"Tue, 25 Mar 2008 02:04:05 +0200")
References: <47E84175.7090205@inbox.lv>
Message-ID: <873aqful4m.fsf@wine.dyndns.org>

Alexander Dorofeyev <alexd4 at inbox.lv> writes:

> +    if (PaletteNumber >= This->NumberOfPalettes) {
> +        NewSize = This->NumberOfPalettes;
> +        do {
> +           NewSize *= 2;
> +        } while(PaletteNumber >= NewSize);
> +        palettes = HeapReAlloc(GetProcessHeap(), 0, This->palettes, sizeof(PALETTEENTRY[256]) * NewSize);

You should be using an array of pointers, not a single array for all
palettes, so that you don't need to move around the whole data on each
realloc.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Tue Mar 25 06:13:26 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 25 Mar 2008 12:13:26 +0100
Subject: WineD3D: Always report D16 (fixes bug 12130) [attempt 2]
In-Reply-To: <20080325102426.245230@gmx.net>
References: <20080325095746.230820@gmx.net> <20080325102426.245230@gmx.net>
Message-ID: <200803251213.26975.stefan@codeweavers.com>

> > 3dmark2000 broke recently because we aren't offering D16 anymore if a
> > card doesn't expose it using GLX. On a Geforce 8800 it isn't offered by
> > GLX (because the hardware is 24bit) but D3D9 on Windows offers it, so
> > offer it too. Second D3D <= 7 requires it too as at that time there was
> > no 24bit z-buffer.
The bug in 3Dmark2000 is a bug in ddraw, we do not report 24/32 bit formats in 
a way the game likes. I have a patch for that deep down in my sending queue 
that fixes the depth and stencil masks.

This patch is still perfectly valid, just pointing out that in case of 
3DMark2k it fixes the wrong bug. Other older apps are likely do demand D16, 
just 3Dmark2000 doesn't.



From aric at codeweavers.com  Tue Mar 25 06:28:49 2008
From: aric at codeweavers.com (Aric Stewart)
Date: Tue, 25 Mar 2008 06:28:49 -0500
Subject: (resend)imm: implement ImmGetIMEFileNameW and ImmGetIMEFileNameA
	correct registry lookups
In-Reply-To: <87ve3bnabq.fsf@wine.dyndns.org>
References: <47E7D1C5.1010409@codeweavers.com> <87ve3bnabq.fsf@wine.dyndns.org>
Message-ID: <47E8E1F1.1050909@codeweavers.com>

ok thanks. I will rework this.
-aric

Alexandre Julliard wrote:
> Aric Stewart <aric at codeweavers.com> writes:
> 
>> +    if (rc > 0)
>> +    {
>> +        if (uBufLen && lpszFileName)
>> +            rc = WideCharToMultiByte(CP_ACP, 0, bufW, uBufLen, lpszFileName,
>> +                                 uBufLen, NULL, NULL);
>> +        else /* get the length */
>> +            rc = WideCharToMultiByte(CP_ACP, 0, bufW, wBufLen, NULL, 0, NULL,
>> +                                     NULL);
> 
> The source length should be -1, you don't want to convert the whole
> buffer.
> 
>> +    static CHAR KeyboardKey[] = "System\\CurrentControlSet\\Control\\Keyboard Layouts";
>> +    static WCHAR szImeFileW[] = {'I','m','e',' ','F','i','l','e',0};
>> +
>> +    HKEY keyboardKey;
>> +    DWORD length;
>> +    DWORD rc;
>> +    CHAR regKey[sizeof(KeyboardKey) + 11];
>> +
>> +    wsprintfA( regKey, "%s\\%08x", KeyboardKey, (unsigned)hKL );
>> +    rc = RegOpenKeyA( HKEY_LOCAL_MACHINE, regKey, &keyboardKey);
> 
> This should use Unicode like the rest of the function.
> 


From mle+win at mega-nerd.com  Tue Mar 25 07:45:57 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Tue, 25 Mar 2008 23:45:57 +1100
Subject: Patch : fixme:msvcrt:MSVCRT__sopen : pmode 0x01a0 ignored
Message-ID: <20080325234557.8fc781fc.mle+win@mega-nerd.com>

Hi all,

My interest in Wine is mainly because it allows me run the test suite
for my projects when I use the Linux -> windows MinGW compiler.

Currently, the programs in my test suite spit out a lot of fixme
warnings like:

    fixme:msvcrt:MSVCRT__sopen : pmode 0x01a0 ignored

I've tracked this down in the code to the function in
dlls/msvcrt/file.c.

The patch below removes this fixme warning. I beleive that simply removing
the warning is valid in this case because the variable being warned about,
pmode, is not used after the warning. In fact, the only use of this variable
is the FIXME or WARN messages.

Cheers,
Erik

--- dlls/msvcrt/file.c~ 2008-03-25 23:42:47.000000000 +1100
+++ dlls/msvcrt/file.c  2008-03-25 23:44:14.000000000 +1100
@@ -1442,11 +1442,6 @@
       pmode = va_arg(ap, int);
     va_end(ap);
 
-    if(pmode & ~(MSVCRT__S_IREAD | MSVCRT__S_IWRITE))
-      FIXME(": pmode 0x%04x ignored\n", pmode);
-    else
-      WARN(": pmode 0x%04x ignored\n", pmode);
-
     if (oflags & MSVCRT__O_EXCL)
       creation = CREATE_NEW;
     else if (oflags & MSVCRT__O_TRUNC)


-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
Only people who suck have a problem with elitism.


From jchevrier at nexicom.net  Tue Mar 25 06:59:52 2008
From: jchevrier at nexicom.net (Justin Chevrier)
Date: Tue, 25 Mar 2008 07:59:52 -0400
Subject: Create stub dosx.exe
In-Reply-To: <877ifrund1.fsf@wine.dyndns.org>
References: <47E87B6F.5080704@nexicom.net> <877ifrund1.fsf@wine.dyndns.org>
Message-ID: <47E8E938.9080500@nexicom.net>

Alexandre Julliard wrote:
> Justin Chevrier <jchevrier at nexicom.net> writes:
>
>   
>> Changelog:
>>
>> Create stub dosx.exe
>>     
>
> Why do you need this?
>
>   
I've got a console app (Master of Orion 2 1.40p23 patch 
http://www.spheriumnorth.com/blog-images/Moo2v140b23.zip ) that crashes 
if it doesn't find dosx.exe in the system32 folder.




From julliard at winehq.org  Tue Mar 25 08:00:49 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 25 Mar 2008 14:00:49 +0100
Subject: Create stub dosx.exe
In-Reply-To: <47E8E938.9080500@nexicom.net> (Justin Chevrier's message of
	"Tue, 25 Mar 2008 07:59:52 -0400")
References: <47E87B6F.5080704@nexicom.net> <877ifrund1.fsf@wine.dyndns.org>
	<47E8E938.9080500@nexicom.net>
Message-ID: <87skyft0u6.fsf@wine.dyndns.org>

Justin Chevrier <jchevrier at nexicom.net> writes:

> I've got a console app (Master of Orion 2 1.40p23 patch
> http://www.spheriumnorth.com/blog-images/Moo2v140b23.zip ) that
> crashes if it doesn't find dosx.exe in the system32 folder.

Does it just need to file to exist, or does it actually try to run it?

-- 
Alexandre Julliard
julliard at winehq.org


From research at science.su  Tue Mar 25 07:18:59 2008
From: research at science.su (L. Rahyen)
Date: Tue, 25 Mar 2008 12:18:59 +0000
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <200803250826.55379.kai.blin@gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<e3d3ae8f0803241745h2c83d4d6lcb02059b211eddd7@mail.gmail.com>
	<200803250826.55379.kai.blin@gmail.com>
Message-ID: <200803251219.00048.research@science.su>

On Tuesday March 25 2008 07:26:50 Kai Blin wrote:
> On Tuesday 25 March 2008 01:45:11 Cesar Izurieta wrote:
> > >  Perhaps this shouldn't be an extra tool but more like a setting what
> > > to do in a case like that.
> >
> > That sounds good. Maybe doing something like what windows does to long
> > file names when looking those files in a console, for example
> > "C:\Program Files" gets converted to "C:\Progra~1", we could apply the
> > same logic, have the first file "A.txt" and the second "a~1.txt". What
> > do you think?
>
> Well, that's probably an option. But I wouldn't even mind a mode that
> simply deletes one of A.txt or a.txt on mounting.

	Deleting files like that (just because of case insensitive match) on mounting 
is very, very bad idea. And I don't see any reason for such destructive 
actions. Better idea to pick up one and use it (for example, choice may be 
either pseudo-random or by alphabetical order where big letters comes first - 
latter is more preferable in my opinion because it let easily guess what 
file/directory will be used).
	However it is understandable and intuitive that if I have *already* mounted 
case-insensitive file system then I cannot create both A.txt and a.txt there. 
But this is safe because I can get a warning that I'm going to overwrite 
existing file.


From jchevrier at nexicom.net  Tue Mar 25 08:46:08 2008
From: jchevrier at nexicom.net (Justin Chevrier)
Date: Tue, 25 Mar 2008 09:46:08 -0400
Subject: Create stub dosx.exe
In-Reply-To: <87skyft0u6.fsf@wine.dyndns.org>
References: <47E87B6F.5080704@nexicom.net>
	<877ifrund1.fsf@wine.dyndns.org>	<47E8E938.9080500@nexicom.net>
	<87skyft0u6.fsf@wine.dyndns.org>
Message-ID: <47E90220.6090901@nexicom.net>

Alexandre Julliard wrote:
> Justin Chevrier <jchevrier at nexicom.net> writes:
>
>   
>> I've got a console app (Master of Orion 2 1.40p23 patch
>> http://www.spheriumnorth.com/blog-images/Moo2v140b23.zip ) that
>> crashes if it doesn't find dosx.exe in the system32 folder.
>>     
>
> Does it just need to file to exist, or does it actually try to run it?
>
>   
It just needs the file to exist in the system32 folder.


From jchevrier at nexicom.net  Tue Mar 25 08:48:33 2008
From: jchevrier at nexicom.net (Justin Chevrier)
Date: Tue, 25 Mar 2008 09:48:33 -0400
Subject: Create stub dosx.exe
In-Reply-To: <015801c88e57$a42f2070$a600fea9@DMITRY>
References: <47E87B6F.5080704@nexicom.net>
	<015801c88e57$a42f2070$a600fea9@DMITRY>
Message-ID: <47E902B1.1000505@nexicom.net>

Dmitry Timoshkov wrote:
> "Justin Chevrier" <jchevrier at nexicom.net> wrote:
>
>> +#define WIN32_LEAN_AND_MEAN
>> +
>> +#include <windows.h>
>
> What's the reason to include anything in an empty stub?
>
>> +int main(int argc, char *argv[])
>> +{
>> +    return 0;
>> +}
>
Ya, that shouldn't be there. Thanks Dmitry.


From julliard at winehq.org  Tue Mar 25 08:52:39 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 25 Mar 2008 14:52:39 +0100
Subject: Create stub dosx.exe
In-Reply-To: <47E90220.6090901@nexicom.net> (Justin Chevrier's message of
	"Tue, 25 Mar 2008 09:46:08 -0400")
References: <47E87B6F.5080704@nexicom.net> <877ifrund1.fsf@wine.dyndns.org>
	<47E8E938.9080500@nexicom.net> <87skyft0u6.fsf@wine.dyndns.org>
	<47E90220.6090901@nexicom.net>
Message-ID: <87od92ud08.fsf@wine.dyndns.org>

Justin Chevrier <jchevrier at nexicom.net> writes:

> Alexandre Julliard wrote:
>> Does it just need to file to exist, or does it actually try to run it?
>>
>>   
> It just needs the file to exist in the system32 folder.

OK, then the wine.inf change should be enough, no need to create a real
program.

-- 
Alexandre Julliard
julliard at winehq.org


From kai.blin at gmail.com  Tue Mar 25 09:08:17 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Tue, 25 Mar 2008 15:08:17 +0100
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <200803251219.00048.research@science.su>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<200803250826.55379.kai.blin@gmail.com>
	<200803251219.00048.research@science.su>
Message-ID: <200803251508.21754.kai.blin@gmail.com>

On Tuesday 25 March 2008 13:18:59 L. Rahyen wrote:

> 	Deleting files like that (just because of case insensitive match) on
> mounting is very, very bad idea. And I don't see any reason for such
> destructive actions. Better idea to pick up one and use it (for example,
> choice may be either pseudo-random or by alphabetical order where big
> letters comes first - latter is more preferable in my opinion because it
> let easily guess what file/directory will be used).

Ok, let's think about the use case here. My idea is that this is going to be 
used on a new WINEPREFIX on a call to wineprefixcreate. We create a new 
directory here and can make sure we're not doing anything stupid here. I'm 
not suggesting to use this for the whole file system. If I have two files 
with filenames that only differ in capitalization, this will only add 
confusion.

That's why I still think having an option to delete unwanted files is useful.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080325/99257989/attachment.pgp 

From juan.lang at gmail.com  Tue Mar 25 09:37:47 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 25 Mar 2008 07:37:47 -0700
Subject: USB Human Interface Device support
In-Reply-To: <47E88B3A.3060003@procyongames.com>
References: <47E88B3A.3060003@procyongames.com>
Message-ID: <3a768c550803250737n28f9a235ga84d52bc817c3502@mail.gmail.com>

Hi Christopher,

>  There isn't an entry in
>  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses for
>  HID interfaces, in fact that whole set of registry keys seems to be
>  missing. Is anyone working on patches to make this work, or can someone
>  point me to the function(s) that need to be implemented for HIDs to be
>  setup in the registry correctly? I'm not sure when/how those keys are
>  suppose to be created.

Those should be created by explorer; see hal.c.  No one's working on
this that I know of.
--Juan


From juan.lang at gmail.com  Tue Mar 25 09:43:48 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 25 Mar 2008 07:43:48 -0700
Subject: Patch : fixme:msvcrt:MSVCRT__sopen : pmode 0x01a0 ignored
In-Reply-To: <20080325234557.8fc781fc.mle+win@mega-nerd.com>
References: <20080325234557.8fc781fc.mle+win@mega-nerd.com>
Message-ID: <3a768c550803250743i708d089bsea3202a858e13f78@mail.gmail.com>

>  The patch below removes this fixme warning. I beleive that simply removing
>  the warning is valid in this case because the variable being warned about,
>  pmode, is not used after the warning. In fact, the only use of this variable
>  is the FIXME or WARN messages.

Don't you think the reason for the warning is that pmode isn't used
when perhaps it should be?  Removing it without understanding it isn't
a help.
--Juan


From dank at kegel.com  Tue Mar 25 10:18:37 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 25 Mar 2008 08:18:37 -0700
Subject: New valgrind errors in GdiRealizationInfo?!
Message-ID: <a71bd89a0803250818r12d4176bx6fe4cf308d3b1be@mail.gmail.com>

http://kegel.com/wine/valgrind/logs-2008-03-24/vg-gdi32_font-diff.txt
shows a number of new warnings, e.g.

-fixme:font:GdiRealizationInfo (0x2e8, 0x7f22fc6c): stub!
-font.c:1774: Tests skipped: skipping GdiRealizationInfo with truetype font
...
+ Use of uninitialised value of size 4
+    at  WineEngGetGlyphOutline (freetype.c:4152)
+    by  GetGlyphOutlineW (font.c:2352)
+    by  GetGlyphOutlineA (font.c:2330)
+    by  enum_truetype_font_proc (font.c:1568)
+    by  FONT_EnumInstance (font.c:589)
+    by  WineEngEnumFonts (freetype.c:3762)
+    by  FONT_EnumFontFamiliesEx (font.c:626)
+    by  EnumFontFamiliesExA (font.c:664)
+    by  func_font (font.c:1714)
+    by  run_test (test.h:406)
+    by  main (test.h:455)


From scott at open-vote.org  Tue Mar 25 11:01:47 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Tue, 25 Mar 2008 09:01:47 -0700
Subject: Implementing a new Direct3D function
In-Reply-To: <200803091952.12638.jgardou@yahoo.fr>
References: <E1JYPQa-0000lW-41@www10.emo.freenet-rz.de>
	<200803091952.12638.jgardou@yahoo.fr>
Message-ID: <47E921EB.8080408@open-vote.org>

J?r?me Gardou wrote:
> OK, then I'll do this that way. 
> Also, d3dx9 provides support for multiple file format (PNG, TGA, BMP...). I 
> assume I'll have to add those dependencies in the build process.
> 
> 	

Just a friendly reminder, but when your patches get committed please do
remember to tell the devel list that the build dependencies have
changed.  It makes it much easier on package maintainers who otherwise
wouldn't know to build with the libraries that make your code actually
run ;)


Thanks,
Scott Ritchie


From austinenglish at gmail.com  Tue Mar 25 11:21:20 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 25 Mar 2008 11:21:20 -0500
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <200803251508.21754.kai.blin@gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<200803250826.55379.kai.blin@gmail.com>
	<200803251219.00048.research@science.su>
	<200803251508.21754.kai.blin@gmail.com>
Message-ID: <b6bb06270803250921m3bcf5107p9e199e7109d27504@mail.gmail.com>

On Tue, Mar 25, 2008 at 9:08 AM, Kai Blin <kai.blin at gmail.com> wrote:
>  Ok, let's think about the use case here. My idea is that this is going to be
>  used on a new WINEPREFIX on a call to wineprefixcreate. We create a new
>  directory here and can make sure we're not doing anything stupid here. I'm
>  not suggesting to use this for the whole file system. If I have two files
>  with filenames that only differ in capitalization, this will only add
>  confusion.
>
>  That's why I still think having an option to delete unwanted files is useful.
>

An option yes, but it should not be the default course of action. As
Rahyen said, a predictable order should be used, and when there are
conflicts, pick the first in that order for presentation through the
FUSE system. User can then rename files/delete files to get the one
they want (or if possible, have a configuration menu to adjust chosen
file order/allow exceptions, etc.).


From kai.blin at gmail.com  Tue Mar 25 12:02:32 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Tue, 25 Mar 2008 18:02:32 +0100
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <b6bb06270803250921m3bcf5107p9e199e7109d27504@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<200803251508.21754.kai.blin@gmail.com>
	<b6bb06270803250921m3bcf5107p9e199e7109d27504@mail.gmail.com>
Message-ID: <200803251802.38804.kai.blin@gmail.com>

On Tuesday 25 March 2008 17:21:20 Austin English wrote:

> An option yes, but it should not be the default course of action. As
> Rahyen said, a predictable order should be used, and when there are
> conflicts, pick the first in that order for presentation through the
> FUSE system. User can then rename files/delete files to get the one
> they want (or if possible, have a configuration menu to adjust chosen
> file order/allow exceptions, etc.).

As long as it's configurable, I don't care about the default. I'm just 
concerned that the most important reason to use a case sensitive file system 
(i.e. not having to check for all possible capitalizations) will suffer from 
having to check if we're allowed to just overwrite or not will suffer.

How about simply refusing to mount if there's e.g. two files like foo and Foo? 
Then the user gets to clean up manually before being able to mount.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080325/8e72d6b0/attachment.pgp 

From alexd4 at inbox.lv  Tue Mar 25 12:00:55 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Tue, 25 Mar 2008 19:00:55 +0200
Subject: [PATCH 8/9] wined3d: remove ENTER_GL/LEAVE_GL in texture and
	cube	texture PreLoad.
In-Reply-To: <20080325084524.44120@gmx.net>
References: <47E84178.6070908@inbox.lv> <20080325084524.44120@gmx.net>
Message-ID: <47E92FC7.3080708@inbox.lv>

Why, I checked what routines get called from that ENTER_GL/LEAVE_GL block in 
PreLoad, and they all seem to be pretty safe. LoadTexture doesn't do gl calls 
itself, but it calls LoadLocation. Other calls made in PreLoad like AddDirtyRect 
also don't do gl calls but may call LoadLocation. So it all comes down to 
LoadLocation (with location either INSYSMEM or INTEXTURE), and LoadLocation and 
all its callees that do gl calls appear to be handling this correctly.

Roderick Colenbrander wrote:
>> Not really needed for anything and can lead to ActivateContext being
>> called 
>> while holding lock.
> 
> Sure this is a problem but there needs to be a place which calls ENTER_GL/LEAVE_GL. I believe LoadTexture and some of the other functions aren't handling that properly yet, so I wouldn't add this yet.
> 
> It is very tricky.
> 
> Roderick



From m.b.lankhorst at gmail.com  Tue Mar 25 14:36:51 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 25 Mar 2008 12:36:51 -0700
Subject: Summer of Coders wanted!
Message-ID: <b130c85e0803251236j3e89062i460c9b4d6627dcd9@mail.gmail.com>

Hi all,

Since yesterday google is accepting applications for all participating
projects. See http://code.google.com/soc for how to apply and read the
faq linked there! The past few days a lot of good proposals were
discussed, but you really need to submit them to the google web
application officially to make them count. The deadline for this is 1
april 2008 00:00 UTC, but I would recommend submitting your
application a few days before that to be sure.

It optional, but recommended to slip a patch past Alexandre Julliard,
he's Swiss so bribing with chocolate doesn't work! It doesn't have to
be a big patch, just so that we know you can check out the wine git
tree, and know how to get a patch in. Of course if you already did
this once you don't have to do it again.

A good guideline to what should be in an application is at
http://www.perlfoundation.org/perl5/index.cgi?gsoc2008_proposal_template
You don't have to follow this, but it's a good indication of what an
application should contain. It's also a good idea to separate your
goals into must-haves and nice-to-haves. The must haves you definitely
want to do before the end of the summer, and the nice-to-haves are for
the goals that you want to do, but  you're not sure if you have all
the time for them.

Cheers,

Maarten.

PS: Mentors wanted, too! If you want to be a mentor, but have
questions or doubts, contact me privately. To sign up as mentor:
http://tinyurl.com/29awt6


From alexd4 at inbox.lv  Tue Mar 25 14:48:56 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Tue, 25 Mar 2008 21:48:56 +0200
Subject: winex11.drv: Don't add owned windows to the taskbar
In-Reply-To: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com>
References: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com>
Message-ID: <47E95728.8090202@inbox.lv>

Hi.

There's a regression in IDA Pro disassembler. Nothing is added to the taskbar at 
all, furthermore, when you are starting debugger, before there was a window 
appearing that asks pass control to the application or not. Now it's not 
appearing, and can't be found because there's nothing on the taskbar, which is 
pretty bad because the app doesn't respond to any other input at that moment. 
Minimizing  the main window makes the app disappear altogether, so it's pretty 
unusable.

I've KDE 3.5.

You can get free version (that has same symptoms) from 
http://www.datarescue.com/ to help tweaking this.

Dmitry Timoshkov wrote:
> Hello,
> 
> this patch fixes the bug 12160. According to my tests explorer in XP
> doesn't add owned windows to the taskbar.
> 
> Changelog:
>     winex11.drv: Don't add owned windows to the taskbar.
> ---



From artur.szymiec at gmail.com  Tue Mar 25 15:30:44 2008
From: artur.szymiec at gmail.com (Artur Szymiec)
Date: Tue, 25 Mar 2008 21:30:44 +0100
Subject: Google SoC proposal
Message-ID: <47E960F4.2080602@gmail.com>

Greetings,

I would like to participate in Wine SoC this year.
I propose to implement WINED3DPMISCCAPS_TSSARGTEMP which is
needed by some d3d games/apps using GL_ARB_fragment_program pixel shaders.

Do you think it's a good proposal for SoC ?

Best regards
Artur Szymiec

-- 
--------------------------------------------------------------------------
Registered User No 397465
Linux Debian 2.6.24.2 AMD Athlon(tm) 64 X2 Dual Core 5000+
Conquer your Desktop! http://www.kde.org/trykde/
Reclaim Your Inbox!   http://www.mozilla.org/products/thunderbird/
--------------------------------------------------------------------------



From mstefani at redhat.com  Tue Mar 25 15:36:25 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Tue, 25 Mar 2008 21:36:25 +0100
Subject: Alistair Leslie-Hughes : msxml3: Added support for SAXXMLReader.
In-Reply-To: <E1Je7nG-0003cU-OL@wine.codeweavers.com>
References: <E1Je7nG-0003cU-OL@wine.codeweavers.com>
Message-ID: <47E96249.7000108@redhat.com>

Hello Alistair,

Alexandre Julliard wrote:
> Module: wine
> Branch: master
> Commit: 264be58812fedf9a066bac521f9fff5821759890
> URL:    http://source.winehq.org/git/wine.git/?a=commit;h=264be58812fedf9a066bac521f9fff5821759890
> 
> Author: Alistair Leslie-Hughes <leslie_alistair at hotmail.com>
> Date:   Tue Mar 25 14:19:10 2008 +1100
> 
> msxml3: Added support for SAXXMLReader.
Smatch is complaining about SAXXMLReader_create() loosing memory.

HRESULT SAXXMLReader_create(IUnknown *pUnkOuter, LPVOID *ppObj)
{
    saxreader *reader;

    TRACE("(%p,%p)\n", pUnkOuter, ppObj);

    reader = HeapAlloc( GetProcessHeap(), 0, sizeof (*reader) );
    if( !reader )
        return E_OUTOFMEMORY;

    reader->lpVtbl = &saxreader_vtbl;
    reader->ref = 1;

    TRACE("returning iface %p\n", *ppObj);
    return S_OK;
}

reader is a local variable with function scope. Stuff gets assigned to
it but there is no usage of it nor is it "exported" aka made visible
outside of the function. Is there something missing here?

bye
	michael

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: OpenPGP digital signature
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080325/4150154f/attachment.pgp 

From truiken at gmail.com  Tue Mar 25 15:44:01 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 25 Mar 2008 15:44:01 -0500
Subject: Alistair Leslie-Hughes : msxml3: Added support for SAXXMLReader.
In-Reply-To: <47E96249.7000108@redhat.com>
References: <E1Je7nG-0003cU-OL@wine.codeweavers.com>
	<47E96249.7000108@redhat.com>
Message-ID: <22821af30803251344y41b87f89p7faa185d0fc4ed38@mail.gmail.com>

On Tue, Mar 25, 2008 at 3:36 PM, Michael Stefaniuc <mstefani at redhat.com> wrote:
> Hello Alistair,
>
>
>  Alexandre Julliard wrote:
>  > Module: wine
>  > Branch: master
>  > Commit: 264be58812fedf9a066bac521f9fff5821759890
>  > URL:    http://source.winehq.org/git/wine.git/?a=commit;h=264be58812fedf9a066bac521f9fff5821759890
>  >
>  > Author: Alistair Leslie-Hughes <leslie_alistair at hotmail.com>
>  > Date:   Tue Mar 25 14:19:10 2008 +1100
>  >
>  > msxml3: Added support for SAXXMLReader.
>  Smatch is complaining about SAXXMLReader_create() loosing memory.
>
>  HRESULT SAXXMLReader_create(IUnknown *pUnkOuter, LPVOID *ppObj)
>  {
>     saxreader *reader;
>
>     TRACE("(%p,%p)\n", pUnkOuter, ppObj);
>
>     reader = HeapAlloc( GetProcessHeap(), 0, sizeof (*reader) );
>     if( !reader )
>         return E_OUTOFMEMORY;
>
>     reader->lpVtbl = &saxreader_vtbl;
>     reader->ref = 1;

----------- added -----------

        *ppObj = (LPVOID *)reader;

-----------   end  ------------

>
>     TRACE("returning iface %p\n", *ppObj);
>     return S_OK;
>  }
>
>  reader is a local variable with function scope. Stuff gets assigned to
>  it but there is no usage of it nor is it "exported" aka made visible
>  outside of the function. Is there something missing here?
>

There should probably also be a check for NULL ppObj.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Tue Mar 25 15:48:19 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 25 Mar 2008 13:48:19 -0700
Subject: USB Human Interface Device support
In-Reply-To: <3a768c550803250737n28f9a235ga84d52bc817c3502@mail.gmail.com>
References: <47E88B3A.3060003@procyongames.com>
	<3a768c550803250737n28f9a235ga84d52bc817c3502@mail.gmail.com>
Message-ID: <b130c85e0803251348k554ca9b4g1c387b6acc533413@mail.gmail.com>

Hello Luang,

2008/3/25, Juan Lang <juan.lang at gmail.com>:
>  >  There isn't an entry in
>  >  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses for
>  >  HID interfaces, in fact that whole set of registry keys seems to be
>  >  missing. Is anyone working on patches to make this work, or can someone
>  >  point me to the function(s) that need to be implemented for HIDs to be
>  >  setup in the registry correctly? I'm not sure when/how those keys are
>  >  suppose to be created.
>
>
> Those should be created by explorer; see hal.c.  No one's working on
>  this that I know of.
I have been working on hal, but it's mostly moving everything to
mountmgr so I can get ipods (except iphone/ipod touch) working, if you
populate control\deviceclasses and control\enum a hid device is
'added'. Just copy those keys from a windows installation.

Cheers,
Maarten.


From thestig at google.com  Tue Mar 25 15:51:18 2008
From: thestig at google.com (Lei Zhang)
Date: Tue, 25 Mar 2008 13:51:18 -0700
Subject: Alistair Leslie-Hughes : msxml3: Added support for SAXXMLReader.
In-Reply-To: <22821af30803251344y41b87f89p7faa185d0fc4ed38@mail.gmail.com>
References: <E1Je7nG-0003cU-OL@wine.codeweavers.com>
	<47E96249.7000108@redhat.com>
	<22821af30803251344y41b87f89p7faa185d0fc4ed38@mail.gmail.com>
Message-ID: <558b2f5c0803251351u5ab98d23hf477389adb8b89a@mail.gmail.com>

On Tue, Mar 25, 2008 at 1:44 PM, James Hawkins <truiken at gmail.com> wrote:
> On Tue, Mar 25, 2008 at 3:36 PM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>  > Hello Alistair,
>  >
>  >
>  >  Alexandre Julliard wrote:
>  >  > Module: wine
>  >  > Branch: master
>  >  > Commit: 264be58812fedf9a066bac521f9fff5821759890
>  >  > URL:    http://source.winehq.org/git/wine.git/?a=commit;h=264be58812fedf9a066bac521f9fff5821759890
>  >  >
>  >  > Author: Alistair Leslie-Hughes <leslie_alistair at hotmail.com>
>  >  > Date:   Tue Mar 25 14:19:10 2008 +1100
>  >  >
>  >  > msxml3: Added support for SAXXMLReader.
>  >  Smatch is complaining about SAXXMLReader_create() loosing memory.
>  >
>  >  HRESULT SAXXMLReader_create(IUnknown *pUnkOuter, LPVOID *ppObj)
>  >  {
>  >     saxreader *reader;
>  >
>  >     TRACE("(%p,%p)\n", pUnkOuter, ppObj);
>  >
>  >     reader = HeapAlloc( GetProcessHeap(), 0, sizeof (*reader) );
>  >     if( !reader )
>  >         return E_OUTOFMEMORY;
>  >
>  >     reader->lpVtbl = &saxreader_vtbl;
>  >     reader->ref = 1;
>
>  ----------- added -----------
>
>         *ppObj = (LPVOID *)reader;
>
>  -----------   end  ------------
>
>
>  >
>  >     TRACE("returning iface %p\n", *ppObj);
>  >     return S_OK;
>  >  }
>  >
>  >  reader is a local variable with function scope. Stuff gets assigned to
>  >  it but there is no usage of it nor is it "exported" aka made visible
>  >  outside of the function. Is there something missing here?
>  >
>
>  There should probably also be a check for NULL ppObj.
>
>  --
>  James Hawkins
>
>
>

BTW, on systems without libxml2-dev, saxreader.c does not compile.


From stefan at codeweavers.com  Tue Mar 25 16:02:00 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 25 Mar 2008 22:02:00 +0100
Subject: Google SoC proposal
In-Reply-To: <47E960F4.2080602@gmail.com>
References: <47E960F4.2080602@gmail.com>
Message-ID: <200803252202.00906.stefan@codeweavers.com>

Am Dienstag, 25. M?rz 2008 21:30:44 schrieb Artur Szymiec:
> Greetings,
>
> I would like to participate in Wine SoC this year.
> I propose to implement WINED3DPMISCCAPS_TSSARGTEMP which is
> needed by some d3d games/apps using GL_ARB_fragment_program pixel shaders.
You phrased it a bit unluckily. What you'd have to do that way is to write a 
fragment processing replacement pipeline. Implementing TSSARGTEMP in the 
current GL_ATI_fragment_shader and GL_NV_register_combiners code is fairly 
easy and too small for gsoc. I think writing a plain fragment shader 
replacement in GL_ARB_fragment_program is a pretty small task as well, I'd 
estimate a work of one week. However, if you include vertex processing as 
well using GL_ARB_vertex_program I think it would work quite well.

For the application it would be very helpful to have a small demonstration 
that you understand what you are going to do. This could be some loose 
conceptual design and integration plans, and some shader code sniplets for 
various aspects of the fixed function pipelines(e.g. transformation, light 
types, texture operations, ...), or whatever you think is suitable.



From jan at zerebecki.de  Fri Mar 21 18:33:20 2008
From: jan at zerebecki.de (Jan Zerebecki)
Date: Sat, 22 Mar 2008 00:33:20 +0100
Subject: [Bug 12131] New: Need a 1.2.0 milestone
In-Reply-To: <a71bd89a0803210751u16074ebct853ba1871e7327bd@mail.gmail.com>
References: <bug-12131-11@http.bugs.winehq.org/>
	<22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>
	<78a7dad00803202345h725a32c9x4d6c0d64e6566788@mail.gmail.com>
	<22821af30803210003i6067e7abn134b0ec72a4b174d@mail.gmail.com>
	<b6bb06270803210144x44f96912q7a1f95a18dbc7f0e@mail.gmail.com>
	<a71bd89a0803210751u16074ebct853ba1871e7327bd@mail.gmail.com>
Message-ID: <20080321233320.GM3557@crissy.swd.zerebecki.de>

All our Bugzilla administrators can give that permission to others.

On Fri, Mar 21, 2008 at 07:51:25AM -0700, Dan Kegel wrote:
> On Fri, Mar 21, 2008 at 1:44 AM, Austin English <austinenglish at gmail.com> wrote:
> >  Correct me if I'm wrong, but I thought Dan also had quite a few
> >  bugzilla privs. If not, he's on wine-devel quite a bit/been around a
> >  while...
> 
> Jan says I've got privs.  Now if somebody would only show me
> how to use them :-)

You can ask me per mail or IRC. Most administrative actions can
be invoked through the "Edit:"-line on the bottom of any bugzilla
page. ( I always wondered why you were saying things like you
didn't have admin priv.s :) )


Jan



From msclrhd at googlemail.com  Sat Mar 22 10:09:39 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sat, 22 Mar 2008 15:09:39 +0000
Subject: wine 1.0 status: T minus 76 days. 87 open bugs.
In-Reply-To: <a71bd89a0803220721w37dbbb02xd3d6ab2e7ff0eccc@mail.gmail.com>
References: <a71bd89a0803220721w37dbbb02xd3d6ab2e7ff0eccc@mail.gmail.com>
Message-ID: <3f4fd2640803220809kdc774ke80d58ee73032726@mail.gmail.com>

On 22/03/2008, Dan Kegel <dank at kegel.com> wrote:
> 76 days to go before release.
>
>  I'm slowly going through the 1.0 bug list and deferring bugs
>  that only affect single non-required apps and don't have good analysis
>  or patches,

I'm busy improving the conformance tests for Wine. As a part of this,
I can contribute test cases for various bugs on the 1.0 list.

>  1114    comctl32        2       Winrar2.90/3.00: Comboex doesn't trigger a event
>  when you mouse-click in some value of it

I was going to have a look and see if I can add tests for this.

Are there any specific areas that would be useful for me to
concentrate on (specifically in the UI area - user32, comctl32, etc)?

- Reece


From msclrhd at googlemail.com  Sat Mar 22 15:53:21 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sat, 22 Mar 2008 20:53:21 +0000
Subject: package install script for Ubuntu Hardy
Message-ID: <3f4fd2640803221353kcc32142p66af036648029fba@mail.gmail.com>

Hi,

I have tried out an alpha of Ubuntu Hardy Heron recently (I am
currently using Gutsy), and have updated Dan's gutsy.sh script to get
the correct packages to build wine.

Hardy does not have the libopencdk8-dev package, and didn't have time
to investigate which package to use (probably libopencdk9-dev).

They have also removed the cogito package, so I replaced it with gitk.

Dan: feel free to add this to your site along with the others and
update it as needed.

- Reece
-------------- next part --------------
A non-text attachment was scrubbed...
Name: hardy.sh
Type: application/x-sh
Size: 2638 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080322/7520f67b/attachment.sh 

From msclrhd at googlemail.com  Sun Mar 23 03:01:48 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 23 Mar 2008 08:01:48 +0000
Subject: C&C :D
In-Reply-To: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
References: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
Message-ID: <3f4fd2640803230101y4d70b4s77fd67d8f7ba275f@mail.gmail.com>

On 23/03/2008, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> Hi all!
>
>  After an announcement that the original Command and conquer is
>  available free for download, I decided to test it. Command and Conquer
>  works perfectly in wine, I haven't tested network gaming over ipx, but
>  that will probably not work. For the rest it's flawless, apart from
>  the losing focus behavior, but playing it in a wine desktop helps.
>
>  Remember: KANE IS A TRAITOR! LONG LIVE THE GDI!

This is great.

Welcome back commander!
- Reece


From erikd at mega-nerd.com  Sun Mar 23 05:07:51 2008
From: erikd at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 23 Mar 2008 21:07:51 +1100
Subject: winegcc: A spec file is currently needed in shared mode?
Message-ID: <20080323210751.49ed967b.erikd@mega-nerd.com>

Hi all,

Any idea what the above means and how to fix it?

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"You can have quality software, or you can have pointer arithmetic;
but you cannot have both at the same time." -- Bertrand Meyer, 1989


From msclrhd at googlemail.com  Sun Mar 23 13:07:44 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 23 Mar 2008 18:07:44 +0000
Subject: qmgr test needs bits.lib to link using the MSVC headers
Message-ID: <3f4fd2640803231107k3fecb704l43f87235f32b9744@mail.gmail.com>

Hi,

I have been going through the tests to see if I can make them work
using MSVC headers.

When building the qmgr tests, I have found that you need to add
bits.lib to LIBS (Linker/Input/Additional Dependencies). Doing this
gets the test to link properly.

Does anyone know how to add this to Wine? Adding EXTRALIBS=-lbits to
Makefile.in does not work on Wine itself. Is this the right way to go?

- Reece


From gmane at drealm.info  Mon Mar 24 12:01:43 2008
From: gmane at drealm.info (Peter L Jones)
Date: Mon, 24 Mar 2008 17:01:43 +0000 (UTC)
Subject: wineasio: source now hosted on SourceForge
Message-ID: <loom.20080324T170127-228@post.gmane.org>

I thought I'd post here to let interested parties know that the various strands
of source for wineasio have been brought together in a single SourceForge
project.  After a great deal of thought, the project name "wineasio" was chosen
by unanimous vote (okay, so only I got a say...).

Robert Reif and the early JackLab code branches are both preserved with change
history.  The trunk is wineasio-0.7.x, which is under "active" development.

Bug reports, feature requests, offers of help and code via the SF project
trackers, please.  Let me know your SF.net ID if you want to commit to the
project (and show some code...).

Thanks,

-- Peter
http://www.sourceforge.net/projects/wineasio




From mattshanks86 at googlemail.com  Mon Mar 24 16:42:11 2008
From: mattshanks86 at googlemail.com (Matt Shanks)
Date: Mon, 24 Mar 2008 21:42:11 +0000
Subject: GSoc: Scriptable Configuration
Message-ID: <847a3d070803241442t27ceaa92w8b964dc798abfb2f@mail.gmail.com>

Hello all,

Am quite keen to get involved with Wine for GSoC - specifically the project
titled "Scriptable Configuration <http://wiki.winehq.org/SummerOfCode>"

Having spoken briefly to Lei, he essentially said that the more features
added to the reg.exe in Wine, the better.

I looked up what the Windows version does, and it seems like a pretty solid
list of features to aim for;

- add               Adds a new subkey or entry into the registry
- delete           Deletes a subkey or entries from the registry
- query            Displays the data in a subkey or a value
- compare       Compares specified registry subkeys or entries
- copy             Copy a subkey to another subkey
- Save             Saves a copy of specified subkeys, entries, and values of
the registry in hive (binary) format-- could be changed to save as
plaintext/flatfile format
- Load             Load a key values
etc

(Source <http://commandwindows.com/reg.htm>)

An apparent missing feature seems to be editing an existing key value

Also, for the command line tools for wine, beyond uninstallation and
windows-version calls, (from Console
Configuration<http://wiki.winehq.org/ConsoleConfiguration>)
are there any other particularly desirable features?

Any input/comments from anyone is much appreciated,

Kind regards,

Matt Shanks
('napi' on IRC)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080324/7878cabf/attachment.htm 

From gmane at drealm.info  Mon Mar 24 17:40:19 2008
From: gmane at drealm.info (Peter L Jones)
Date: Mon, 24 Mar 2008 22:40:19 +0000
Subject: [Repost] wineasio source now on SourceForge
Message-ID: <fs9akj$6f6$1@ger.gmane.org>

Hi all,

wineasio, the ASIO to JACK driver for WINE, has been under some development
over recent months by various interested parties.  Co-ordination has been on a
best endeavours basis but really needed something more organised.  The project
really needed a proper home, too.

So I've gathered the various threads of source and committed them into a
SourceForge SVN project.  Robert Reif's wineasio-0.0.x and the JackLab work on
wineasio-0.x have their own branches.  The current work on wineasio-0.7.x forms
the SVN trunk.

wineasio-0.7.x releases (i.e. 0, 1, 2 and 3) are tagged.  HEAD currently has
two changes pending release (a fix for Nuendo and a possible fix for some xruns
being experienced by a 64studio user).

wineasio developers and packagers are encouraged to consider using the
SourceForge facilities - let me know if you want to be added as a committer and
please use the trackers for bugs, feature request, etc.

Right now, feedback would be appreciated on the current code in HEAD and around
the xrun issued mentioned, more details here:
http://forum.jacklab.net/viewtopic.php?f=2&t=726

I spent oh... seconds... considering a name for the SourceForge project.
Fortunately "wineasio" was available.  You can find the project on the end of
this url:
http://sf.net/projects/wineasio

wineasio would not exist without Robert Reif.  Ralf Beck undertook much work
for JackLab.  William Steidtmann and Nedko Arnaudov had provided bug fixes.  I
provided the config file handling and tried to combine Ralf and Robert's work
(thus kicking off 0.7.x).

Many thanks,

-- Peter



From mat at brain-dump.org  Tue Mar 25 16:33:51 2008
From: mat at brain-dump.org (Marc Andre Tanner)
Date: Tue, 25 Mar 2008 22:33:51 +0100
Subject: [GSoC][RFC] Case Insensitive Filesystem
Message-ID: <20080325213351.GA3237@debbook.brain-dump.org>

Hi,

During the last week i have been playing around with the idea
of writing a case insensitive fuse filesystem and i am know 
at the point were i can demonstrate a proof of concept 
implementation. And yes i have seen that there is already 
someone else interested in doing this but i thought it was fun
anyways.

The filesystem converts every path to lower case before further
operations take place. On file creation the original filename is
stored in an extended attribute and later returned upon request.

This means you will have a directory on a regular POSIX filesystem
with all filenames in lower case, this directory can then be mounted
in case insensitive fashion.

In order to compile the code you will need the fuse and libattr[1]
development files. Furthermore you will have to make sure that the
underlying filesystem supports extended attributes (for example 
for ext{2,3} you need a kernel with CONFIG_EXT{2,3}_FS_XATTR enabled). 
You probably also want to mount the underlying filesystem with the 
user_xattr option which allows non root users to create	extended 
attributes.

So fetch the code from the url below, extract the archive and type
make. This should generate a binary named ciopfs (which stands for
Case Insenstive On Purpose File System, alternative naming suggestions 
are welcome ;).
 
 http://www.brain-dump.org/projects/ciopfs/ciopfs-25.03.2008.tar.gz

Mounting the file system is straight forward, see `ciopfs -h` for
further options. But be carefull i haven't yet done any serious
testing, so only use it with unimportant data [insert standard 
warning about possible data loss here].

 ciopfs /path/to/my/directory /path/to/my/mountpoint

As i said before the current implementation is just a proof of
concept. That's why it currently only supports ascii filenames, or
whatever tolower(3) can cope with. This brings us to another 
problem[2,3], in certain languages there isn't a direct mapping 
between upper and lower case characters and case insensitivity in
filesystem is generally a bad thing.

Any comments are appreciated.

Regards,
Marc

[1] http://acl.bestbits.at/download.html#Attr
[2] http://www.somethinkodd.com/oddthinking/2005/10/25/the-world-of-upper-lower-case-mappings/
[3] http://drewthaler.blogspot.com/2007/12/case-against-insensitivity.html
-- 
 Marc Andre Tanner >< http://www.brain-dump.org/ >< GPG key: CF7D56C0


From cesar at ecuarock.net  Tue Mar 25 20:24:35 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Tue, 25 Mar 2008 20:24:35 -0500
Subject: fuse-iso and remote named pipes for GSOC
Message-ID: <e3d3ae8f0803251824s75bbd9f0ia25c930dfa7a80e@mail.gmail.com>

Besides the FUSE project for GSOC I see two items listed on the
http://wiki.winehq.org/SummerOfCode page:

# Better ISO FUSE file system integration
# A FUSE wrapper for remote named pipes using libsmbclient

Can anybody elaborate a little bit more on this?


From cesar at ecuarock.net  Tue Mar 25 20:43:43 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Tue, 25 Mar 2008 20:43:43 -0500
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <200803251802.38804.kai.blin@gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<200803251508.21754.kai.blin@gmail.com>
	<b6bb06270803250921m3bcf5107p9e199e7109d27504@mail.gmail.com>
	<200803251802.38804.kai.blin@gmail.com>
Message-ID: <e3d3ae8f0803251843h262099a3o10c8dc224ea8a4c6@mail.gmail.com>

On Tue, Mar 25, 2008 at 12:02 PM, Kai Blin <kai.blin at gmail.com> wrote:
> On Tuesday 25 March 2008 17:21:20 Austin English wrote:
>
>  > An option yes, but it should not be the default course of action. As
>  > Rahyen said, a predictable order should be used, and when there are
>  > conflicts, pick the first in that order for presentation through the
>  > FUSE system. User can then rename files/delete files to get the one
>  > they want (or if possible, have a configuration menu to adjust chosen
>  > file order/allow exceptions, etc.).
>
>  As long as it's configurable, I don't care about the default. I'm just
>  concerned that the most important reason to use a case sensitive file system
>  (i.e. not having to check for all possible capitalizations) will suffer from
>  having to check if we're allowed to just overwrite or not will suffer.
>
>  How about simply refusing to mount if there's e.g. two files like foo and Foo?
>  Then the user gets to clean up manually before being able to mount.
>
>
>
>  Cheers,
>  Kai
>
>  --
>  Kai Blin
>  WorldForge developer  http://www.worldforge.org/
>  Wine developer        http://wiki.winehq.org/KaiBlin
>  Samba team member     http://www.samba.org/samba/team/
>  --
>  Will code for cotton.
>
>
>
>

There could some sort of a warning and present the conflicted file
with a different name. Depending on how efficient the checking is, it
could take some time to traverse the whole file system (supposing we
also mount the root / in .wine/something ). If that is the case we
might need just to mount without checks and present the files with a
different name when doing a directory listing.


From winehacker at gmail.com  Tue Mar 25 21:34:05 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 25 Mar 2008 22:34:05 -0400
Subject: fuse-iso and remote named pipes for GSOC
In-Reply-To: <e3d3ae8f0803251824s75bbd9f0ia25c930dfa7a80e@mail.gmail.com>
References: <e3d3ae8f0803251824s75bbd9f0ia25c930dfa7a80e@mail.gmail.com>
Message-ID: <19e31a080803251934k1601e179j386f5ff9bd769a93@mail.gmail.com>

On Tue, Mar 25, 2008 at 9:24 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
> Besides the FUSE project for GSOC I see two items listed on the
>  http://wiki.winehq.org/SummerOfCode page:
>
>  # Better ISO FUSE file system integration

I don't know if the FUSE api supports enumeration of mounts in the VFS
but it would be cool if explorer could detect if a FUSE iso mounted
filesystem is mounted somewhere in the VFS and auto-magically create a
fake cdrom device associated with this mount. It would solve some of
the complexity we have in cxtest where you have to mount iso images
for regression testing, plus it would just save a bunch of time for
stupid installers that assume they are always running from a real
cdrom.

Thanks
-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Tue Mar 25 21:39:18 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 25 Mar 2008 22:39:18 -0400
Subject: qmgr test needs bits.lib to link using the MSVC headers
In-Reply-To: <3f4fd2640803231107k3fecb704l43f87235f32b9744@mail.gmail.com>
References: <3f4fd2640803231107k3fecb704l43f87235f32b9744@mail.gmail.com>
Message-ID: <19e31a080803251939n4aebc0adrba0cab90bc7c2bf7@mail.gmail.com>

On Sun, Mar 23, 2008 at 2:07 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
>  Does anyone know how to add this to Wine? Adding EXTRALIBS=-lbits to
>  Makefile.in does not work on Wine itself. Is this the right way to go?

Normally if you were using configure to generate the makefiles and
config.h you would use something like

EXTRALIBS=@BITSLIB@

That would seem to still be the right thing to do, you will just need
to extend msvcmaker to understand what BITSLIB really is and will we
just keep ignoring it on Unix.

See dlls/wininet/Makefile.in for EXTRALIBS=@SOCKETLIB@ for an example.
If your building with mingw configure defines @SOCKETLIB@ to -lws2_32
but if you use Unix this is ignored and we use normal unix sockets.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Tue Mar 25 23:01:45 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 26 Mar 2008 12:01:45 +0800
Subject: winex11.drv: Don't add owned windows to the taskbar
References: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com>
	<47E95728.8090202@inbox.lv>
Message-ID: <000f01c88ef6$21f7dc10$a600fea9@DMITRY>

"Alexander Dorofeyev" <alexd4 at inbox.lv> wrote:

> There's a regression in IDA Pro disassembler. Nothing is added to the taskbar at 
> all, furthermore, when you are starting debugger, before there was a window 
> appearing that asks pass control to the application or not. Now it's not 
> appearing, and can't be found because there's nothing on the taskbar, which is 
> pretty bad because the app doesn't respond to any other input at that moment. 
> Minimizing  the main window makes the app disappear altogether, so it's pretty 
> unusable.

The problem with IDA is that the button you see in the Windows task bar
does not belong to the main IDA window, it belongs to a zero sized visible
window with the same caption. Since it's zero sized Wine doesn't map it all.
So, while formally it's a regression, technically it's not: main IDA window
has never been added to the task bar before my patch. This all can be easily
discovered with spy++ and a simple test app.

-- 
Dmitry.


From m.b.lankhorst at gmail.com  Wed Mar 26 00:46:41 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 25 Mar 2008 22:46:41 -0700
Subject: GSoc: Scriptable Configuration
In-Reply-To: <847a3d070803241442t27ceaa92w8b964dc798abfb2f@mail.gmail.com>
References: <847a3d070803241442t27ceaa92w8b964dc798abfb2f@mail.gmail.com>
Message-ID: <b130c85e0803252246h41569f37xdd55ae455d32d92f@mail.gmail.com>

Hello Matt,

2008/3/24, Matt Shanks <mattshanks86 at googlemail.com>:
> Am quite keen to get involved with Wine for GSoC - specifically the project
> titled "Scriptable Configuration"
We have about 2 or 3 others also willing to do that project. I think
you would have a better chance of doing something like the print
dialog or one of the rich editor projects. They are good projects with
a known boundary.

> Having spoken briefly to Lei, he essentially said that the more features
> added to the reg.exe in Wine, the better.
>
> I looked up what the Windows version does, and it seems like a pretty solid
> list of features to aim for;
True, however most of them seem to map onto an existing advapi call,
so I'm not sure if it's that much work to implement.

> An apparent missing feature seems to be editing an existing key value
>
> Also, for the command line tools for wine, beyond uninstallation and
> windows-version calls, (from Console Configuration) are there any other
> particularly desirable features?
See above, you'll have more chance of being accepted by choosing
another project idea. Good luck!

Cheers,
Maarten


From raccoonone at procyongames.com  Wed Mar 26 01:02:54 2008
From: raccoonone at procyongames.com (Christopher)
Date: Tue, 25 Mar 2008 23:02:54 -0700
Subject: USB Human Interface Device support
In-Reply-To: <b130c85e0803251348k554ca9b4g1c387b6acc533413@mail.gmail.com>
References: <47E88B3A.3060003@procyongames.com>	
	<3a768c550803250737n28f9a235ga84d52bc817c3502@mail.gmail.com>
	<b130c85e0803251348k554ca9b4g1c387b6acc533413@mail.gmail.com>
Message-ID: <47E9E70E.6030509@procyongames.com>

Maarten Lankhorst wrote:
> Hello Luang,
>
> 2008/3/25, Juan Lang <juan.lang at gmail.com>:
>   
>>  >  There isn't an entry in
>>  >  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses for
>>  >  HID interfaces, in fact that whole set of registry keys seems to be
>>  >  missing. Is anyone working on patches to make this work, or can someone
>>  >  point me to the function(s) that need to be implemented for HIDs to be
>>  >  setup in the registry correctly? I'm not sure when/how those keys are
>>  >  suppose to be created.
>>
>>
>> Those should be created by explorer; see hal.c.  No one's working on
>>  this that I know of.
>>     
> I have been working on hal, but it's mostly moving everything to
> mountmgr so I can get ipods (except iphone/ipod touch) working, if you
> populate control\deviceclasses and control\enum a hid device is
> 'added'. Just copy those keys from a windows installation.
>
> Cheers,
> Maarten.
>
>   
Thanks! SetupDiGetClassDevs and GetDeviceInterfaceData seem to work now, 
but GetDeviceInterfaceDetailData causes several errors. I'll look into 
it now that I have somewhere concrete to start.
Christopher


From m.b.lankhorst at gmail.com  Wed Mar 26 01:22:21 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 25 Mar 2008 23:22:21 -0700
Subject: USB Human Interface Device support
In-Reply-To: <47E9E70E.6030509@procyongames.com>
References: <47E88B3A.3060003@procyongames.com>
	<3a768c550803250737n28f9a235ga84d52bc817c3502@mail.gmail.com>
	<b130c85e0803251348k554ca9b4g1c387b6acc533413@mail.gmail.com>
	<47E9E70E.6030509@procyongames.com>
Message-ID: <b130c85e0803252322s168b9ad3i90b4a93ceca92b51@mail.gmail.com>

Hello Christopher,

2008/3/25, Christopher <raccoonone at procyongames.com>:
> Maarten Lankhorst wrote:
>  > Hello Luang,
>  >
>  > 2008/3/25, Juan Lang <juan.lang at gmail.com>:
>  >
>  >>  >  There isn't an entry in
>  >>  >  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses for
>  >>  >  HID interfaces, in fact that whole set of registry keys seems to be
>  >>  >  missing. Is anyone working on patches to make this work, or can someone
>  >>  >  point me to the function(s) that need to be implemented for HIDs to be
>  >>  >  setup in the registry correctly? I'm not sure when/how those keys are
>  >>  >  suppose to be created.
>  >>
>  >>
>  >> Those should be created by explorer; see hal.c.  No one's working on
>  >>  this that I know of.
>  >>
>  > I have been working on hal, but it's mostly moving everything to
>  > mountmgr so I can get ipods (except iphone/ipod touch) working, if you
>  > populate control\deviceclasses and control\enum a hid device is
>  > 'added'. Just copy those keys from a windows installation.
>  >
>  > Cheers,
>  > Maarten.
>  >
>  >
>
> Thanks! SetupDiGetClassDevs and GetDeviceInterfaceData seem to work now,
>  but GetDeviceInterfaceDetaiData causes several errors. I'll look into
>  it now that I have somewhere concrete to start.
It probably asks for the specific keys in
\ENUM\category\devicename\idname so if you copy these over it will
probably work. WINEDEBUG=+setupapi is your friend.

Cheers,
Maarten.


From m.b.lankhorst at gmail.com  Wed Mar 26 02:26:27 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 26 Mar 2008 00:26:27 -0700
Subject: Scriptable configuration (reg.exe) proposals
Message-ID: <b130c85e0803260026p3ccc34c0m5f7ca044c8933f29@mail.gmail.com>

Hello potential students,

There have been at least 4 people interested in doing the reg.exe
project for summer of code, but unfortunately this is not really a
good project idea, becuse you can pretty much implement it all in a
single day by just calling the right advapi calls. Making winecfg work
from the command line is also not hard and you can't fill up 2 or 3
months with this.

I'm sorry for not investigating reg.exe further. This should never
have been on the ideas list to begin with, and I should be the one to
be blamed for not spotting it earlier.

I would strongly recommend adding a proposal for another project. It
doesn't have to be one from the ideas list, on the contrary: The most
succesful applications have been initiatives from people themselves.
As long as you work, interact with the community and communicate with
your mentor and share your code and ideas you will get paid.

I hope that you will have luck in finding other proposals, and that
you will be able to participate and complete gsoc succesfully.

Regards,
Maarten.


From kai.blin at gmail.com  Wed Mar 26 03:42:15 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Wed, 26 Mar 2008 09:42:15 +0100
Subject: fuse-iso and remote named pipes for GSOC
In-Reply-To: <e3d3ae8f0803251824s75bbd9f0ia25c930dfa7a80e@mail.gmail.com>
References: <e3d3ae8f0803251824s75bbd9f0ia25c930dfa7a80e@mail.gmail.com>
Message-ID: <200803260942.19076.kai.blin@gmail.com>

On Wednesday 26 March 2008 02:24:35 Cesar Izurieta wrote:
> Besides the FUSE project for GSOC I see two items listed on the
> http://wiki.winehq.org/SummerOfCode page:
>
> # Better ISO FUSE file system integration

Steven already took care of this part, so I'll wrap up the next one.

> # A FUSE wrapper for remote named pipes using libsmbclient

The goal of this is to be able to do RPC via Windows named pipes to remote 
machines. Of course the best solution would be to just use libsmbclient from 
Wine directly, but libsmbclient is under the GPL and Wine is under the LGPL, 
so that's not going to work.

So the obvious idea is some solution where we can use libsmbclient for what we 
need without having to link to libsmbclient. FUSE can provide this 
abstraction.

The idea would be to create a pipe subdirectory of WINEPREFIX and mount our 
pipefs there. Accessing pipe/server/pipename should connect to 
\\server\pipe\pipename, if possible.
One more thing that needs to be supported is mode switching on the named pipe.

I'd suggest to read up on remote named pipes to get a better idea what they're 
used for.

If you've got any more questions, I'm happy to help.
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080326/a5e2dcb7/attachment.pgp 

From pure_evil at mail.bg  Wed Mar 26 05:16:50 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Wed, 26 Mar 2008 12:16:50 +0200
Subject: DLL exports... HELP?!
Message-ID: <20080326121650.so9h52gms8gcs0go@mail.bg>



   Folks, I've been trying to make a bunch of control panel applets  
for wine for some time now.

   a CPL is basically a DLL which (the most importnat part) exports a  
function called "CPlApplet"; Without it, the cpl isn't worth a thing.  
It is the presence of that export which basically identifies it as a  
control panel applet.

   Indeed, opening a random .cpl with dllexp yields:

   Function: CPlApplet  Address: 0x0041b604 Relative Address:  
0x0041b604 Ordinal 1 (0x1) Filename: intl.cpl

   This one is from the cpl I wrote some time ago in Delphi, and it's  
the same with all other 'doze cpls. I'm working on porting it to C and  
wine, but that export is really getting the best of me.

   However, dllexp doesn't detect _any_ DLL exports in wine's .dlls,  
so I'm stuck without a template :( Am I missing something? (A simple  
*hello world* dll source that compiles against wine's source and  
exports ANY function would be greatly appreciated)

   Thanks in advance,

   Stefanov.

-------------------------------------

????? 2 ????????? ?????? ??? ADSL!
??????? online ?o 20 ???? 2008!
???????? ??????????????? ????????!
  http://www.btc.bg/bg/adsl_order.php?residential&action=order&view_pack=1
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080326/c5f0b132/attachment-0002.htm 
-------------- next part --------------


   Folks, I've been trying to make a bunch of control panel applets  
for wine for some time now.

   a CPL is basically a DLL which (the most importnat part) exports a  
function called "CPlApplet"; Without it, the cpl isn't worth a thing.  
It is the presence of that export which basically identifies it as a  
control panel applet.

   Indeed, opening a random .cpl with dllexp yields:

   Function: CPlApplet? Address: 0x0041b604 Relative Address:  
0x0041b604 Ordinal 1 (0x1) Filename: intl.cpl

   This one is from the cpl I wrote some time ago in Delphi, and it's  
the same with all other 'doze cpls. I'm working on porting it to C and  
wine, but that export is really getting the best of me.

   However, dllexp doesn't detect _any_ DLL exports in wine's .dlls,  
so I'm stuck without a template :( Am I missing something? (A simple  
*hello world* dll source that compiles against wine's source and  
exports ANY function would be greatly appreciated)

   Thanks in advance,

   Stefanov.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080326/c5f0b132/attachment-0003.htm 

From julliard at winehq.org  Wed Mar 26 05:21:04 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 11:21:04 +0100
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
	(take 2)
In-Reply-To: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
	(Dan Kegel's message of "Tue, 25 Mar 2008 19:23:54 -0700")
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
Message-ID: <87ej9xu6pb.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> While investigating a crash in gs-auftrag in bug 9039, noticed
> WideCharToMultiByte wasn't quite conformant for negative destlen.
> Fixed, with tests.  Passes for me in Wine and Win XP.

This would require reviewing all uses of WideCharToMultiByte in Wine,
many places get this wrong. Unless you have an app that requires this
fix I'd suggest to leave the test as todo_wine for now.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Wed Mar 26 05:28:50 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 11:28:50 +0100
Subject: [2/2] comctl32: tab.c The Item Interior should use HotTracking
	color not Hilight color (resend).
In-Reply-To: <47E92543.3070109@etersoft.ru> (Anatoly Lyutin's message of "Tue, 
	25 Mar 2008 19:16:03 +0300")
References: <47E92543.3070109@etersoft.ru>
Message-ID: <87abklu6cd.fsf@wine.dyndns.org>

Anatoly Lyutin <vostok at etersoft.ru> writes:

> @@ -1633,7 +1633,7 @@ TAB_DrawItemInterior(const TAB_INFO *inf
>        SetTextColor(hdc, (((lStyle & TCS_HOTTRACK) && (iItem == infoPtr->iHotTracked) 
>                            && !(lStyle & TCS_FLATBUTTONS)) 
>                          | (TAB_GetItem(infoPtr, iItem)->dwState & TCIS_HIGHLIGHTED)) ?
> -                        comctl32_color.clrHighlight : comctl32_color.clrBtnText);
> +                        comctl32_color.clrHotTrackingColor : comctl32_color.clrBtnText);

Shouldn't you distinguish between TCS_HOTTRACK and TCIS_HIGHLIGHTED
here?

-- 
Alexandre Julliard
julliard at winehq.org


From thunderbird2k at gmx.net  Wed Mar 26 05:39:39 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Wed, 26 Mar 2008 11:39:39 +0100
Subject: DLL exports... HELP?!
In-Reply-To: <20080326121650.so9h52gms8gcs0go@mail.bg>
References: <20080326121650.so9h52gms8gcs0go@mail.bg>
Message-ID: <20080326103939.115280@gmx.net>

If you build a wine dll inside the wine source tree we use gcc in combination with some wine magic for compilation. Exporting of functions in that case happens through a '.spec' file.

When you want to work outside the wine tree (as it can be more convenient) you could also use 'winegcc' for building a library. It will handle all the magic for you.

Roderick

> 
> 
>    Folks, I've been trying to make a bunch of control panel applets  
> for wine for some time now.
> 
>    a CPL is basically a DLL which (the most importnat part) exports a  
> function called "CPlApplet"; Without it, the cpl isn't worth a thing.  
> It is the presence of that export which basically identifies it as a  
> control panel applet.
> 
>    Indeed, opening a random .cpl with dllexp yields:
> 
>    Function: CPlApplet  Address: 0x0041b604 Relative Address:  
> 0x0041b604 Ordinal 1 (0x1) Filename: intl.cpl
> 
>    This one is from the cpl I wrote some time ago in Delphi, and it's  
> the same with all other 'doze cpls. I'm working on porting it to C and  
> wine, but that export is really getting the best of me.
> 
>    However, dllexp doesn't detect _any_ DLL exports in wine's .dlls,  
> so I'm stuck without a template :( Am I missing something? (A simple  
> *hello world* dll source that compiles against wine's source and  
> exports ANY function would be greatly appreciated)
> 
>    Thanks in advance,
> 
>    Stefanov.
> 
> -------------------------------------
> 
> ????? 2 ????????? ?????? ??? ADSL!
> ??????? online ?o 20 ???? 2008!
> ???????? ??????????????? ????????!
>   http://www.btc.bg/bg/adsl_order.php?residential&action=order&view_pack=1

-- 
Ist Ihr Browser Vista-kompatibel? Jetzt die neuesten 
Browser-Versionen downloaden: http://www.gmx.net/de/go/browser


From mstefani at redhat.com  Wed Mar 26 06:04:41 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 26 Mar 2008 12:04:41 +0100
Subject: kernel32: WideCharToMultiByte: return error on negative dest
	len	(take 2)
In-Reply-To: <87ej9xu6pb.fsf@wine.dyndns.org>
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
	<87ej9xu6pb.fsf@wine.dyndns.org>
Message-ID: <47EA2DC9.9030505@redhat.com>

Alexandre Julliard wrote:
> "Dan Kegel" <dank at kegel.com> writes:
> 
>> While investigating a crash in gs-auftrag in bug 9039, noticed
>> WideCharToMultiByte wasn't quite conformant for negative destlen.
>> Fixed, with tests.  Passes for me in Wine and Win XP.
> 
> This would require reviewing all uses of WideCharToMultiByte in Wine,
> many places get this wrong. Unless you have an app that requires this
> fix I'd suggest to leave the test as todo_wine for now.
Would that be a good janitorial work to be done before Wine 1.0? I feel
like I'm getting tired of translating ...

bye
	michael


From hans at it.vu.nl  Wed Mar 26 06:12:38 2008
From: hans at it.vu.nl (Hans Leidekker)
Date: Wed, 26 Mar 2008 12:12:38 +0100
Subject: Wine 1.0 status: T minus 74 days. 78 open bugs.
In-Reply-To: <a71bd89a0803242250g392d1c48r15094dd056bca78c@mail.gmail.com>
References: <a71bd89a0803242250g392d1c48r15094dd056bca78c@mail.gmail.com>
Message-ID: <200803261212.38493.hans@it.vu.nl>

On Tuesday 25 March 2008 06:50:25 am Dan Kegel wrote:

> 3711 ???wininet ????????1 ??????Musicmatch fails to install (missing registry key, HTTP_HttpOpenRequest() problem)
> 5625 ???wininet ????????3 ??????Wine does not handle internet proxy settings conveniently

I'll look into these two bugs.

 -Hans


From julliard at winehq.org  Wed Mar 26 06:17:40 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 12:17:40 +0100
Subject: kernel32: WideCharToMultiByte: return error on negative dest
	len	(take 2)
In-Reply-To: <47EA2DC9.9030505@redhat.com> (Michael Stefaniuc's message of
	"Wed, 26 Mar 2008 12:04:41 +0100")
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
	<87ej9xu6pb.fsf@wine.dyndns.org> <47EA2DC9.9030505@redhat.com>
Message-ID: <8763v9u42z.fsf@wine.dyndns.org>

Michael Stefaniuc <mstefani at redhat.com> writes:

> Would that be a good janitorial work to be done before Wine 1.0? I feel
> like I'm getting tired of translating ...

Sure, if you feel like doing it go ahead. I'm not sure the fix will go
in before 1.0, but already fixing as many callers as possible certainly
can't hurt.

-- 
Alexandre Julliard
julliard at winehq.org


From pure_evil at mail.bg  Wed Mar 26 06:46:01 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Wed, 26 Mar 2008 13:46:01 +0200
Subject: DLL exports... HELP?!
In-Reply-To: <20080326103939.115280@gmx.net>
References: <20080326121650.so9h52gms8gcs0go@mail.bg>
	<20080326103939.115280@gmx.net>
Message-ID: <200803261346.01843.pure_evil@mail.bg>

On Wednesday 26 March 2008 12:39:39 pm you wrote:
> If you build a wine dll inside the wine source tree we use gcc in
> combination with some wine magic for compilation. Exporting of functions in
> that case happens through a '.spec' file.
>
> When you want to work outside the wine tree (as it can be more convenient)
> you could also use 'winegcc' for building a library. It will handle all the
> magic for you.
>
> Roderick
cplskeleton.spec:
"
1 stdcall CPlApplet(long long long long)
"
"
libcplskeleton.def

; File generated automatically from ./cplskeleton.spec; do not edit!

LIBRARY cplskeleton.dll

EXPORTS
  CPlApplet at 16 @1
"


From fgouget at free.fr  Wed Mar 26 06:49:16 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 26 Mar 2008 12:49:16 +0100 (CET)
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <20080325213351.GA3237@debbook.brain-dump.org>
References: <20080325213351.GA3237@debbook.brain-dump.org>
Message-ID: <alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>

On Tue, 25 Mar 2008, Marc Andre Tanner wrote:
[...]
> The filesystem converts every path to lower case before further
> operations take place. On file creation the original filename is
> stored in an extended attribute and later returned upon request.

Shouldn't it be the other way around? I guess the way you've done it is 
simpler because you can simply rely on the standard kernel code to 
ensure filename uniqueness, but it also means that anyone accessing the 
underlying files directly will lose the case information.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
  Any sufficiently advanced Operating System is indistinguishable from Linux


From mpartap at gmx.net  Wed Mar 26 06:51:59 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Wed, 26 Mar 2008 12:51:59 +0100
Subject: DLL exports... HELP?!
In-Reply-To: <20080326121650.so9h52gms8gcs0go@mail.bg>
References: <20080326121650.so9h52gms8gcs0go@mail.bg>
Message-ID: <47EA38DF.3060501@gmx.net>

Hi Stefanov,
attached is the code of a standalone proxy DLL I developed last year during SoC, have a look 
especially at the makefile for cross-compilation...
regards marcel.

-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: printerproxydriver.tar.gz
Type: application/gzip
Size: 14302 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080326/0316aceb/attachment-0001.bin 

From julliard at winehq.org  Wed Mar 26 07:50:07 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 13:50:07 +0100
Subject: [PATCH 1 of 2] explorer: add /startfile switch for starting files
	from file managers
In-Reply-To: <ced95fe0803201906t70760536g828ebd2d5fc9dbc4@mail.gmail.com>
	(Vincent Povirk's message of "Thu, 20 Mar 2008 22:06:46 -0400")
References: <ced95fe0803201906t70760536g828ebd2d5fc9dbc4@mail.gmail.com>
Message-ID: <871w5xtzsw.fsf@wine.dyndns.org>

"Vincent Povirk" <madewokherd+d41d at gmail.com> writes:

> My last attempt created a new winelib program; apparently this
> functionality fits in explorer.

start.exe is probably more appropriate. Either way you are trying to
make it too smart; it should take a straight Unix path, and not try to
guess anything.

-- 
Alexandre Julliard
julliard at winehq.org


From madewokherd+d41d at gmail.com  Wed Mar 26 08:17:32 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Wed, 26 Mar 2008 09:17:32 -0400
Subject: [PATCH 1 of 2] explorer: add /startfile switch for starting files
	from file managers
In-Reply-To: <871w5xtzsw.fsf@wine.dyndns.org>
References: <ced95fe0803201906t70760536g828ebd2d5fc9dbc4@mail.gmail.com>
	<871w5xtzsw.fsf@wine.dyndns.org>
Message-ID: <ced95fe0803260617l34d03fbcu1a1414dfaac52818@mail.gmail.com>

My understanding is that start.exe will not work because it must be
compatible with the windows version of start. In any case, I don't
think I could usefully share code with the rest of start.

Attempting to guess between unix and windows paths is not necessary (I
saw no reason not to do it, but I can remove it).

I would like to keep the distinction between .exe and other files so
that bug 5368 can be fixed.

On Wed, Mar 26, 2008 at 8:50 AM, Alexandre Julliard <julliard at winehq.org> wrote:
> "Vincent Povirk" <madewokherd+d41d at gmail.com> writes:
>
>  > My last attempt created a new winelib program; apparently this
>  > functionality fits in explorer.
>
>  start.exe is probably more appropriate. Either way you are trying to
>  make it too smart; it should take a straight Unix path, and not try to
>  guess anything.
>
>  --
>  Alexandre Julliard
>  julliard at winehq.org
>



-- 
Vincent Povirk


From dank at kegel.com  Wed Mar 26 08:31:31 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 26 Mar 2008 06:31:31 -0700
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
	(take 2)
In-Reply-To: <47EA2DC9.9030505@redhat.com>
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
	<87ej9xu6pb.fsf@wine.dyndns.org> <47EA2DC9.9030505@redhat.com>
Message-ID: <a71bd89a0803260631q45e2e9bo1a53a1cdafddcddd@mail.gmail.com>

On Wed, Mar 26, 2008 at 4:04 AM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>  > This would require reviewing all uses of WideCharToMultiByte in Wine,
>  > many places get this wrong. Unless you have an app that requires this
>  > fix I'd suggest to leave the test as todo_wine for now.
>
>  Would that be a good janitorial work to be done before Wine 1.0? I feel
>  like I'm getting tired of translating ...

Sure.  A quick grep finds some obvious ones:

$ find . -name '*.c' | xargs grep WideCharToMultiByte | grep ' -1, NULL, NULL)'
./wininet/urlcache.c:        WideCharToMultiByte(CP_ACP, 0,
lpszLocalFileName, -1, achFile, -1, NULL, NULL);
./mshtml/editor.c:        WideCharToMultiByte(CP_ACP, 0, V_BSTR(in),
-1, stra, -1, NULL, NULL);
./mshtml/persist.c:            WideCharToMultiByte(CP_ACP, 0, headers,
-1, data, -1, NULL, NULL);
./mshtml/install.c:    WideCharToMultiByte(CP_ACP, 0, file_name, -1,
file_name_a, -1, NULL, NULL);
./mshtml/nsio.c:            WideCharToMultiByte(CP_ACP, 0,
container->doc->mime, -1, This->content, -1, NULL, NULL);
./mshtml/navigate.c:        WideCharToMultiByte(CP_ACP, 0,
szStatusText, -1, This->nschannel->content, -1, NULL, NULL);
./advapi32/cred.c:        string_len = WideCharToMultiByte(CP_ACP, 0,
CredentialW->TargetName, -1, CredentialA->TargetName, -1, NULL, NULL);
./advapi32/cred.c:        string_len = WideCharToMultiByte(CP_ACP, 0,
CredentialW->Comment, -1, CredentialA->Comment, -1, NULL, NULL);
./advapi32/cred.c:        string_len = WideCharToMultiByte(CP_ACP, 0,
CredentialW->TargetAlias, -1, CredentialA->TargetAlias, -1, NULL,
NULL);
./advapi32/cred.c:        string_len = WideCharToMultiByte(CP_ACP, 0,
CredentialW->UserName, -1, CredentialA->UserName, -1, NULL, NULL);
./urlmon/sec_mgr.c:    WideCharToMultiByte(CP_ACP, 0, url, -1,
(LPSTR)pbSecurityId, -1, NULL, NULL)

(I peeked at that last one.  The code is enforcing the length limit itself and
then telling WideCharToMultiByte that there's no limit.  May as well
pass the proper
limit to WideCharToMultiByte and let it do the length checking?)

The first step, as Alexandre says, is to add the test with a todo_wine
around the negative destlen test.
I would have done it but I'm more than happy to let you run with it.

I haven't quite figured out the fix for bug 9039, this is just something
I noticed along the way.
- Dan


From mstefani at redhat.com  Wed Mar 26 08:38:07 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 26 Mar 2008 14:38:07 +0100
Subject: kernel32: WideCharToMultiByte: return error on negative dest
	len	(take 2)
In-Reply-To: <a71bd89a0803260631q45e2e9bo1a53a1cdafddcddd@mail.gmail.com>
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>	<87ej9xu6pb.fsf@wine.dyndns.org>
	<47EA2DC9.9030505@redhat.com>
	<a71bd89a0803260631q45e2e9bo1a53a1cdafddcddd@mail.gmail.com>
Message-ID: <47EA51BF.5030308@redhat.com>

Dan Kegel wrote:
> On Wed, Mar 26, 2008 at 4:04 AM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>>  > This would require reviewing all uses of WideCharToMultiByte in Wine,
>>  > many places get this wrong. Unless you have an app that requires this
>>  > fix I'd suggest to leave the test as todo_wine for now.
>>
>>  Would that be a good janitorial work to be done before Wine 1.0? I feel
>>  like I'm getting tired of translating ...
> 
> Sure.  A quick grep finds some obvious ones:
> 
> $ find . -name '*.c' | xargs grep WideCharToMultiByte | grep ' -1, NULL, NULL)'

> The first step, as Alexandre says, is to add the test with a todo_wine
> around the negative destlen test.
> I would have done it but I'm more than happy to let you run with it.
Please go ahead and resubmit the patch with todo_wine around it. I don't
want to claim ownership for the patch you wrote.

bye
	michael


From patrol at sinus.cz  Wed Mar 26 08:49:21 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Wed, 26 Mar 2008 14:49:21 +0100
Subject: Can't determine disk space, install fails
Message-ID: <20080326134921.GA16578@tangens.sinus.cz>

Hi!
  We have a long-persisting problem there. It persists for many wine versions
and prevents some programs from installing.
  As an example, today my son complained about impossibility to install WoW.
The installer was not able to determine the free space on the disk (there was
a dash instead of a number in the box) and the Continue button was greyed out,
so it was not possible to proceed.
  There are other cases, in which the installers say that there is not enough
space on the disk and fail. Of course there is enough space, but the installer
is not able to find it.
  Especially WoW has Gold rating and these problems are not mentioned, so I
don't think that this is a common wine problem, thus I'm not going to open
a bug for it. I'm begging for a hint instead, what to try to find the cause
of the problem.
  Wine is always manually compiled and it runs on a "generic Linux system",
not on any particular, publicly known distro.

  With regards, Pavel Troller


From dank at kegel.com  Wed Mar 26 08:50:58 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 26 Mar 2008 06:50:58 -0700
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
	(take 2)
In-Reply-To: <47EA51BF.5030308@redhat.com>
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
	<87ej9xu6pb.fsf@wine.dyndns.org> <47EA2DC9.9030505@redhat.com>
	<a71bd89a0803260631q45e2e9bo1a53a1cdafddcddd@mail.gmail.com>
	<47EA51BF.5030308@redhat.com>
Message-ID: <a71bd89a0803260650y2e16ed95o8d3a7ff206f6dac@mail.gmail.com>

On Wed, Mar 26, 2008 at 6:38 AM, Michael Stefaniuc <mstefani at redhat.com> wrote:
> > The first step, as Alexandre says, is to add the test with a todo_wine
>  > around the negative destlen test.
>  > I would have done it but I'm more than happy to let you run with it.
>
>  Please go ahead and resubmit the patch with todo_wine around it.

Done.

> I don't want to claim ownership for the patch you wrote.

Don't worry, Alexandre usually gets that right.


From julliard at winehq.org  Wed Mar 26 08:53:13 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 14:53:13 +0100
Subject: [1/2] reg: Implement basic 'reg add'. [try 2]
In-Reply-To: <689de9370803240108w44d1730sbb3cd1fb41e10f6f@mail.gmail.com>
	(Andrew Riedi's message of "Mon, 24 Mar 2008 01:08:47 -0700")
References: <689de9370803240108w44d1730sbb3cd1fb41e10f6f@mail.gmail.com>
Message-ID: <87wsnpsiba.fsf@wine.dyndns.org>

"Andrew Riedi" <andrewriedi at gmail.com> writes:

> +{
> +    LPCTSTR lpSubKey;

Please don't use TCHAR types.

> +    static const WCHAR hkcrW[] = {'h','k','c','r',0};
> +    static const WCHAR hkcuW[] = {'h','k','c','u',0};
> +    static const WCHAR hklmW[] = {'h','k','l','m',0};
> +    static const WCHAR hkuW[] = {'h','k','u',0};
> +    static const WCHAR hkpdW[] = {'h','k','p','d',0};
> +    static const WCHAR hkccW[] = {'h','k','c','c',0};
> +    static const WCHAR hkddW[] = {'h','k','d','d',0};
> +
> +    /* Determine key type. */
> +    if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 4, hkcrW, 4) == CSTR_EQUAL)
> +        *hKey = HKEY_CLASSES_ROOT;
> +    else if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 4, hkcuW, 4) == CSTR_EQUAL)
> +        *hKey = HKEY_CURRENT_USER;
> +    else if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 4, hklmW, 4) == CSTR_EQUAL)
> +        *hKey = HKEY_LOCAL_MACHINE;
> +    else if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 3, hkuW, 3) == CSTR_EQUAL)
> +        *hKey = HKEY_USERS;
> +    else if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 4, hkpdW, 4) == CSTR_EQUAL)
> +        *hKey = HKEY_PERFORMANCE_DATA;
> +    else if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 4, hkccW, 4) == CSTR_EQUAL)
> +        *hKey = HKEY_CURRENT_CONFIG;
> +    else if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 4, hkddW, 4) == CSTR_EQUAL)
> +        *hKey = HKEY_DYN_DATA;

You should use some sort of array instead of duplicating all that code,
and you need to check the next character of the string too.

-- 
Alexandre Julliard
julliard at winehq.org


From vit.hrachovy at sandbox.cz  Wed Mar 26 09:05:23 2008
From: vit.hrachovy at sandbox.cz (Vit Hrachovy)
Date: Wed, 26 Mar 2008 15:05:23 +0100
Subject: Can't determine disk space, install fails
In-Reply-To: <20080326134921.GA16578@tangens.sinus.cz>
References: <20080326134921.GA16578@tangens.sinus.cz>
Message-ID: <47EA5823.5020003@sandbox.cz>

Hi Pavel,
I've ran into similar issues when, for example, I've got more than 64GB 
free space on the partition, and the old Win installers just told me 
there was -1 bytes free. I'd vote for some Wine (or 3rd party tool) 
functionality that would decrease the reported bytes available per 
user's request.

As a temporary solution for such problems, I've used a small partition 
for installation with just 2GBs free and it worked for me. I've then 
moved the wineprefix into the target partition.
Regards
Vit Hrachovy

Pavel Troller wrote:
> Hi!
>   We have a long-persisting problem there. It persists for many wine versions
> and prevents some programs from installing.
>   As an example, today my son complained about impossibility to install WoW.
> The installer was not able to determine the free space on the disk (there was
> a dash instead of a number in the box) and the Continue button was greyed out,
> so it was not possible to proceed.
>   There are other cases, in which the installers say that there is not enough
> space on the disk and fail. Of course there is enough space, but the installer
> is not able to find it.
>   Especially WoW has Gold rating and these problems are not mentioned, so I
> don't think that this is a common wine problem, thus I'm not going to open
> a bug for it. I'm begging for a hint instead, what to try to find the cause
> of the problem.
>   Wine is always manually compiled and it runs on a "generic Linux system",
> not on any particular, publicly known distro.
> 
>   With regards, Pavel Troller
> 
> 



From rob at codeweavers.com  Wed Mar 26 09:02:46 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 26 Mar 2008 14:02:46 +0000
Subject: wininet: Implement chunked reads.
In-Reply-To: <200803261131.22218.hans@it.vu.nl>
References: <200803261131.22218.hans@it.vu.nl>
Message-ID: <47EA5786.2080108@codeweavers.com>

Hans Leidekker wrote:
>  static DWORD HTTPREQ_ReadFile(WININETHANDLEHEADER *hdr, void *buffer, DWORD size, DWORD *read)
>  {
>      WININETHTTPREQW *req = (WININETHTTPREQW*)hdr;
> +    static WCHAR encoding[20];
> +    DWORD buflen = sizeof(encoding);
> +    static const WCHAR szChunked[] = {'c','h','u','n','k','e','d',0}; 
>   

encoding shouldn't be static.

-- 
Rob Shearman



From julliard at winehq.org  Wed Mar 26 09:04:33 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 15:04:33 +0100
Subject: [PATCH 1 of 2] explorer: add /startfile switch for starting files
	from file managers
In-Reply-To: <ced95fe0803260617l34d03fbcu1a1414dfaac52818@mail.gmail.com>
	(Vincent Povirk's message of "Wed, 26 Mar 2008 09:17:32 -0400")
References: <ced95fe0803201906t70760536g828ebd2d5fc9dbc4@mail.gmail.com>
	<871w5xtzsw.fsf@wine.dyndns.org>
	<ced95fe0803260617l34d03fbcu1a1414dfaac52818@mail.gmail.com>
Message-ID: <87skydshse.fsf@wine.dyndns.org>

"Vincent Povirk" <madewokherd+d41d at gmail.com> writes:

> My understanding is that start.exe will not work because it must be
> compatible with the windows version of start. In any case, I don't
> think I could usefully share code with the rest of start.

It has to be compatible, but adding new options that don't exist on
Windows shouldn't be a problem. That's what you'd have to do in explorer
too anyway.

> I would like to keep the distinction between .exe and other files so
> that bug 5368 can be fixed.

I'm not sure I understand why you need that for 5368.

-- 
Alexandre Julliard
julliard at winehq.org


From htl10 at users.sourceforge.net  Wed Mar 26 09:05:25 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 14:05:25 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
Message-ID: <492306.48686.qm@web23110.mail.ird.yahoo.com>

I found a .NET2/System.Windows.Forms application which was running alright
in 0.9.56/0.9.57 with the appdb adaptations broke in 0.9.58. So I did a git bisect
and found that it is a commit to gdi32/freetype.c from Huw Davies which broke it. 
It is known that .NET does some strange things with fonts and font-related part of 
the registry (See http://bugs.winehq.org/show_bug.cgi?id=10467#c2 for discussion) and
the commit apparently breaks that... I believe I see what that specific commit does
and how it breaks .NET2, but I am not sure I understand *why* the commit was accepted
in the first place and what was its purpose... Can somebody explain, and possibly
either back-out the commit or at least modify it to make it not break stuff?

    commit 0436a5d14abf22af6ec10640496f9e0298a65f69
    Author: Huw Davies <huw at codeweavers.com>
    Date:   Mon Mar 10 12:31:43 2008 +0000

    gdi32: Store the Windows path (if it's available) in the font registry entries.

The error message I got was 'attempt to read or write protected memory. This is often
an indication that other memory is corrupt'.


      __________________________________________________________
Sent from Yahoo! Mail.
More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html


From thunderbird2k at gmx.net  Tue Mar 25 03:45:24 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 25 Mar 2008 09:45:24 +0100
Subject: [PATCH 8/9] wined3d: remove ENTER_GL/LEAVE_GL in texture and cube
	texture PreLoad.
In-Reply-To: <47E84178.6070908@inbox.lv>
References: <47E84178.6070908@inbox.lv>
Message-ID: <20080325084524.44120@gmx.net>

> 
> Not really needed for anything and can lead to ActivateContext being
> called 
> while holding lock.
> ---
>   dlls/wined3d/cubetexture.c |    2 --
>   dlls/wined3d/texture.c     |    3 +--
>   2 files changed, 1 insertions(+), 4 deletions(-)

Sure this is a problem but there needs to be a place which calls ENTER_GL/LEAVE_GL. I believe LoadTexture and some of the other functions aren't handling that properly yet, so I wouldn't add this yet.

It is very tricky.

Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.gmx.net/de/entertainment/games/free




From thestig at google.com  Wed Mar 26 09:40:43 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 26 Mar 2008 07:40:43 -0700
Subject: Can't determine disk space, install fails
In-Reply-To: <20080326134921.GA16578@tangens.sinus.cz>
References: <20080326134921.GA16578@tangens.sinus.cz>
Message-ID: <558b2f5c0803260740s5f6e5c14if5220e95c12c4e71@mail.gmail.com>

On Wed, Mar 26, 2008 at 6:49 AM, Pavel Troller <patrol at sinus.cz> wrote:
> Hi!
>   We have a long-persisting problem there. It persists for many wine versions
>  and prevents some programs from installing.
>   As an example, today my son complained about impossibility to install WoW.
>  The installer was not able to determine the free space on the disk (there was
>  a dash instead of a number in the box) and the Continue button was greyed out,
>  so it was not possible to proceed.
>   There are other cases, in which the installers say that there is not enough
>  space on the disk and fail. Of course there is enough space, but the installer
>  is not able to find it.
>   Especially WoW has Gold rating and these problems are not mentioned, so I
>  don't think that this is a common wine problem, thus I'm not going to open
>  a bug for it. I'm begging for a hint instead, what to try to find the cause
>  of the problem.
>   Wine is always manually compiled and it runs on a "generic Linux system",
>  not on any particular, publicly known distro.
>
>   With regards, Pavel Troller
>
>
>

Can you file a bug for this on Wine's bugzilla? [1] I'm really
surprised WoW does not install for you, considering it's probably one
of the most popular apps out there.

[1] http://bugs.winehq.org/


From galeru at gmail.com  Wed Mar 26 09:41:06 2008
From: galeru at gmail.com (Corey McClymonds)
Date: Wed, 26 Mar 2008 10:41:06 -0400
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <e3d3ae8f0803251843h262099a3o10c8dc224ea8a4c6@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<200803251508.21754.kai.blin@gmail.com>
	<b6bb06270803250921m3bcf5107p9e199e7109d27504@mail.gmail.com>
	<200803251802.38804.kai.blin@gmail.com>
	<e3d3ae8f0803251843h262099a3o10c8dc224ea8a4c6@mail.gmail.com>
Message-ID: <63ee2bc70803260741q7148dcc7sc97acfce7c84250d@mail.gmail.com>

On Tue, Mar 25, 2008 at 9:43 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
>
> On Tue, Mar 25, 2008 at 12:02 PM, Kai Blin <kai.blin at gmail.com> wrote:
>  > On Tuesday 25 March 2008 17:21:20 Austin English wrote:
>  >
>  >  > An option yes, but it should not be the default course of action. As
>  >  > Rahyen said, a predictable order should be used, and when there are
>  >  > conflicts, pick the first in that order for presentation through the
>  >  > FUSE system. User can then rename files/delete files to get the one
>  >  > they want (or if possible, have a configuration menu to adjust chosen
>  >  > file order/allow exceptions, etc.).
>  >

Wouldn't it make the most sense to use whichever one was modified
last?  In most cases. that gives you the right response, eg. you put
in a modified executable via patch or similar, and want it to use that
version.

[snip]


From vostok at etersoft.ru  Wed Mar 26 09:59:38 2008
From: vostok at etersoft.ru (Anatoly Lyutin)
Date: Wed, 26 Mar 2008 17:59:38 +0300
Subject: [2/2] comctl32: tab.c The Item Interior should use HotTracking
	color not Hilight color (resend).
In-Reply-To: <87abklu6cd.fsf@wine.dyndns.org>
References: <47E92543.3070109@etersoft.ru> <87abklu6cd.fsf@wine.dyndns.org>
Message-ID: <47EA64DA.9070905@etersoft.ru>

Alexandre Julliard wrote:
>> @@ -1633,7 +1633,7 @@ TAB_DrawItemInterior(const TAB_INFO *inf
>>        SetTextColor(hdc, (((lStyle & TCS_HOTTRACK) && (iItem == infoPtr->iHotTracked) 
>>                            && !(lStyle & TCS_FLATBUTTONS)) 
>>                          | (TAB_GetItem(infoPtr, iItem)->dwState & TCIS_HIGHLIGHTED)) ?
>> -                        comctl32_color.clrHighlight : comctl32_color.clrBtnText);
>> +                        comctl32_color.clrHotTrackingColor : comctl32_color.clrBtnText);
>>     
>
> Shouldn't you distinguish between TCS_HOTTRACK and TCIS_HIGHLIGHTED
> here?
I could not find anywhere documentation about TCIS_HIGHLIGHTED...
I just changed the registry value "HotTrackingColor" in Windows and 
after that I have seen that the tab flashes HotTracking color not Hilight.

Please tell me right way to fix this mistake.


-- 
Best regards
	Anatoly Lyutin.



From julliard at winehq.org  Wed Mar 26 09:13:33 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 15:13:33 +0100
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
	(take 2)
In-Reply-To: <a71bd89a0803260650y2e16ed95o8d3a7ff206f6dac@mail.gmail.com> (Dan
	Kegel's message of "Wed, 26 Mar 2008 06:50:58 -0700")
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
	<87ej9xu6pb.fsf@wine.dyndns.org> <47EA2DC9.9030505@redhat.com>
	<a71bd89a0803260631q45e2e9bo1a53a1cdafddcddd@mail.gmail.com>
	<47EA51BF.5030308@redhat.com>
	<a71bd89a0803260650y2e16ed95o8d3a7ff206f6dac@mail.gmail.com>
Message-ID: <87myolshde.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

>> I don't want to claim ownership for the patch you wrote.
>
> Don't worry, Alexandre usually gets that right.

Maybe, but I don't like it. I really prefer for people to send their own
patches instead of having others do it for them.

-- 
Alexandre Julliard
julliard at winehq.org


From htl10 at users.sourceforge.net  Wed Mar 26 09:55:07 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 14:55:07 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <20080326144712.GB31599@merlot.physics.ox.ac.uk>
Message-ID: <394725.32322.qm@web23102.mail.ird.yahoo.com>

--- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
<snipped>
> > The error message I got was 'attempt to read or
> write protected memory. This is often
> > an indication that other memory is corrupt'.
>  
> Hi,
> 
> Could you explain how this breaks .NET2, I can't see
> why it should at the moment?
> The purpose of the commit is to do what Windows does.

I am not entirely sure myself - all I know is I did a git bisect to find what was 
the problematic commit, and reverting this particular commit on top of 0.9.58 fixes my problem. 

My understanding is that the .NET framework uses the windows registry font
entries for font look-ups, according to the discussion in http://bugs.winehq.org/show_bug.cgi?id=10467#c2, and it loads fonts directly based on the registry font list and does its own rendering thing with the font files directly; 
So changing font registry entries break things.



      ___________________________________________________________ 
Rise to the challenge for Sport Relief with Yahoo! For Good  

http://uk.promotions.yahoo.com/forgood/


From huw at codeweavers.com  Wed Mar 26 10:21:02 2008
From: huw at codeweavers.com (Huw Davies)
Date: Wed, 26 Mar 2008 15:21:02 +0000
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <394725.32322.qm@web23102.mail.ird.yahoo.com>
References: <20080326144712.GB31599@merlot.physics.ox.ac.uk>
	<394725.32322.qm@web23102.mail.ird.yahoo.com>
Message-ID: <20080326152102.GC31599@merlot.physics.ox.ac.uk>

On Wed, Mar 26, 2008 at 02:55:07PM +0000, Hin-Tak Leung wrote:
> --- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
> <snipped>
> > > The error message I got was 'attempt to read or
> > write protected memory. This is often
> > > an indication that other memory is corrupt'.
> >  
> > Hi,
> > 
> > Could you explain how this breaks .NET2, I can't see
> > why it should at the moment?
> > The purpose of the commit is to do what Windows does.
> 
> I am not entirely sure myself - all I know is I did a git bisect to find what was 
> the problematic commit, and reverting this particular commit on top of 0.9.58 fixes my problem. 
> 
> My understanding is that the .NET framework uses the windows registry font
> entries for font look-ups, according to the discussion in http://bugs.winehq.org/show_bug.cgi?id=10467#c2, and it loads fonts directly based on the registry font list and does its own rendering thing with the font files directly; 
> So changing font registry entries break things.

Well yes, but that doesn't actually mean the patch is incorrect.

Do you by any chance have the font 'ukai.ttf' installed?  If so could
you try removing it from your fontconfig path and see if that helps?

Huw.
-- 
Huw Davies
huw at codeweavers.com


From huw at codeweavers.com  Wed Mar 26 09:47:12 2008
From: huw at codeweavers.com (Huw Davies)
Date: Wed, 26 Mar 2008 14:47:12 +0000
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <492306.48686.qm@web23110.mail.ird.yahoo.com>
References: <492306.48686.qm@web23110.mail.ird.yahoo.com>
Message-ID: <20080326144712.GB31599@merlot.physics.ox.ac.uk>

On Wed, Mar 26, 2008 at 02:05:25PM +0000, Hin-Tak Leung wrote:
> I found a .NET2/System.Windows.Forms application which was running alright
> in 0.9.56/0.9.57 with the appdb adaptations broke in 0.9.58. So I did a git bisect
> and found that it is a commit to gdi32/freetype.c from Huw Davies which broke it. 
> It is known that .NET does some strange things with fonts and font-related part of 
> the registry (See http://bugs.winehq.org/show_bug.cgi?id=10467#c2 for discussion) and
> the commit apparently breaks that... I believe I see what that specific commit does
> and how it breaks .NET2, but I am not sure I understand *why* the commit was accepted
> in the first place and what was its purpose... Can somebody explain, and possibly
> either back-out the commit or at least modify it to make it not break stuff?
> 
>     commit 0436a5d14abf22af6ec10640496f9e0298a65f69
>     Author: Huw Davies <huw at codeweavers.com>
>     Date:   Mon Mar 10 12:31:43 2008 +0000
> 
>     gdi32: Store the Windows path (if it's available) in the font registry entries.
> 
> The error message I got was 'attempt to read or write protected memory. This is often
> an indication that other memory is corrupt'.
 
Hi,

Could you explain how this breaks .NET2, I can't see why it should at the moment?
The purpose of the commit is to do what Windows does.

Thanks,
Huw.
-- 
Huw Davies
huw at codeweavers.com


From htl10 at users.sourceforge.net  Wed Mar 26 10:33:27 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 15:33:27 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <20080326152102.GC31599@merlot.physics.ox.ac.uk>
Message-ID: <202895.60473.qm@web23114.mail.ird.yahoo.com>

--- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:

> From: Huw Davies <huw at codeweavers.com>
> Subject: Re: gdi32-related commit between 0.9.57<->0.9.58 broken .NET2/Systems.Windows.Forms
> To: "Hin-Tak Leung" <htl10 at users.sourceforge.net>
> Cc: wine-devel at winehq.org
> Date: Wednesday, 26 March, 2008, 3:21 PM
> On Wed, Mar 26, 2008 at 02:55:07PM +0000, Hin-Tak Leung
> wrote:
> > --- On Wed, 26/3/08, Huw Davies
> <huw at codeweavers.com> wrote:
> > <snipped>
> > > > The error message I got was 'attempt to
> read or
> > > write protected memory. This is often
> > > > an indication that other memory is
> corrupt'.
> > >  
> > > Hi,
> > > 
> > > Could you explain how this breaks .NET2, I
> can't see
> > > why it should at the moment?
> > > The purpose of the commit is to do what Windows
> does.
> > 
> > I am not entirely sure myself - all I know is I did a
> git bisect to find what was 
> > the problematic commit, and reverting this particular
> commit on top of 0.9.58 fixes my problem. 
> > 
> > My understanding is that the .NET framework uses the
> windows registry font
> > entries for font look-ups, according to the discussion
> in http://bugs.winehq.org/show_bug.cgi?id=10467#c2, and it
> loads fonts directly based on the registry font list and
> does its own rendering thing with the font files directly; 
> > So changing font registry entries break things.
> 
> Well yes, but that doesn't actually mean the patch is
> incorrect.

Well, it is certainly doing something that the .NET framework doesn't like -  
or, maybe exposing a bug elsewhere which wasn't reached due to incompleteness before.
Can you explain the purpose of your patch?

> Do you by any chance have the font 'ukai.ttf'
> installed?  If so could
> you try removing it from your fontconfig path and see if
> that helps?

Yes, I have ukai.ttf on my system (and others came with Fedora 8), 
but I am running wine in  LANG=en_US.UTF-8 . I'll give your suggestion a 
try.


      __________________________________________________________
Sent from Yahoo! Mail.
More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html


From msclrhd at googlemail.com  Tue Mar 25 17:55:26 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 25 Mar 2008 22:55:26 +0000
Subject: prevents WM_DISPLAYCHANGE message being sent when a call to
	ChangeDisplaySettingsEx fails due to the requested change to
	the display not occurring.
In-Reply-To: <47E7CBC0.8050806@mail.leather-wallet.co.uk>
References: <47E7CBC0.8050806@mail.leather-wallet.co.uk>
Message-ID: <3f4fd2640803251555r47d6fc73r2462567c7bd84286@mail.gmail.com>

On 24/03/2008, chris morgan <cmorgan at mail.leather-wallet.co.uk> wrote:
>  test code run on windows nt4 sp6, messages checked using ms spk++:
>
>       DEVMODE dev_mode;
>       memset(&dev_mode,0,sizeof(DEVMODE));
>       dev_mode.dmSize = sizeof(DEVMODE);
>
>       // Get the current display settings
>       if (!EnumDisplaySettings(NULL,ENUM_CURRENT_SETTINGS,&dev_mode))
>       {
>           printf("Could not EnumDisplaySettings, giving up.\n");
>           return 0;
>       }
>
>       // Call ChangeDisplaySettings with the current settings,
>       // No WM_DISPLAYCHANGE message sent
>       ChangeDisplaySettings(&dev_mode, 0);
>
>       // Change something (that works)
>       dev_mode.dmBitsPerPel = 32;
>
>       // WM_DISPLAYCHANGE message sent
>       ChangeDisplaySettings(&dev_mode, 0);
>
>       // Change something to an impossible value
>       dev_mode.dmBitsPerPel = 999;
>
>       // No WM_DISPLAYCHANGE message sent
>       ChangeDisplaySettings(&dev_mode, 0);

This should be incorporated into a conformance/regression test. That
way, this bug will not reappear and can also be verified as the
correct behaviour on different versions of Windows.

> +    if (width == screen_width && height == screen_height)
> +    {
> +	return;
> +    }

w.r.t. the implementation:
  *  ChangeDisplaySettings returns a long
(http://msdn2.microsoft.com/en-us/library/ms533260(VS.85).aspx), so
the correct value must be returned on error;
  *  the fix does not match the test cases (screen size vs colour depth).

In addition, your tests should:
  *  check that changing the screen resolution causes a
WM_DISPLAYCHANGE message to be sent;
  *  if there are no other tests, ChangeDisplaySettings should be
checked to see what happens with invalid arguments (for completeness);
  *  the return value is not checked for expected values (see
http://msdn2.microsoft.com/en-us/library/ms533260(VS.85).aspx);
  *  GetLastError() is not checked to see what it is set to (see other
tests for examples);
  *  restore the display settings back to what they were before the tests.

Thanks for improving Wine,
- Reece


From msclrhd at googlemail.com  Wed Mar 26 02:49:30 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 26 Mar 2008 07:49:30 +0000
Subject: [1/2] shlwapi: added tests for SHCreateStreamOnFile IStream_Read.
In-Reply-To: <3f4fd2640803251634k6951a4e0oa737b2c787115e84@mail.gmail.com>
References: <3f4fd2640803251634k6951a4e0oa737b2c787115e84@mail.gmail.com>
Message-ID: <3f4fd2640803260049r14b9885an3f6f5d8d730b171e@mail.gmail.com>

On 25/03/2008, Reece Dunn <msclrhd at googlemail.com> wrote:
> This patch adds some basic tests for the Read method of the various
>  SHCreateStreamOnFile APIs, while making it possible to add other
>  IStream method tests.
>
>  At the moment, these tests are being skipped on Wine because it is not
>  returning a valid stream object in the tests.

Alexandre: please ignore these patches for now. I am working on a more
comprehensive series of tests for the various IStream methods.

Thanks,
- Reece


From =?UTF-8?B?0J3QvtCy0LjQutC+0LIg0KDQvtC80LDQvSDQmtC+0L3RgdGC0LDQvdGC0Lg=?=  Wed Mar 26 04:57:56 2008
From: =?UTF-8?B?0J3QvtCy0LjQutC+0LIg0KDQvtC80LDQvSDQmtC+0L3RgdGC0LDQvdGC0Lg=?= (=?UTF-8?B?0J3QvtCy0LjQutC+0LIg0KDQvtC80LDQvSDQmtC+0L3RgdGC0LDQvdGC0Lg=?=)
Date: Wed, 26 Mar 2008 12:57:56 +0300
Subject: Trouble in compiling Wine 0.9.57 and 0.9.58 on Solaris 10 08/07
Message-ID: <47EA1E24.8010700@hisoft.ru>

Hi guys!
I've got some trouble with compiling Wine 0.9.57 & 0.9.58 on Solaris 10 
08/07
After 40 minutes of the compilation the process halted with messages:
wined3d_private.h: In function `float_32_to_16':
wined3d_private.h:159: warning: implicit declaration of function `isinf'
wined3d_main.c: At top level:
wined3d_main.c:271: warning: visibility attribute not supported in this 
configuration; ignored
(the last string repeated for many times)
I suppose the situation is connected with Solaris 'isinf' but I am too 
far from programming under UNIX...
My version of gcc is 3.4.3 (Solaris native):
bash-3.00# gcc -v
Reading specs from /usr/sfw/lib/gcc/i386-pc-solaris2.10/3.4.3/specs
Configured with: /builds/sfw10-gate/usr/src/cmd/gcc/gcc-3.4.3/configure 
--prefix=/usr/sfw --with-as=/usr/sfw/bin/gas --with-gnu-as 
--with-ld=/usr/ccs/bin/ld --without-gnu-ld --enable-languages=c,c++ 
--enable-shared
Thread model: posix
gcc version 3.4.3 (csl-sol210-3_4-branch+sol_rpath)

My configure string is:
./configure --enable-win64 --with-x --x-includes=/usr --x-libraries=/usr
I built successfully Wine 0.9.56 and earlier..
What can I do with this?
Thanks in advance.

Rome



From msclrhd at googlemail.com  Tue Mar 25 17:55:26 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 25 Mar 2008 22:55:26 +0000
Subject: prevents WM_DISPLAYCHANGE message being sent when a call to
	ChangeDisplaySettingsEx fails due to the requested change to
	the display not occurring.
In-Reply-To: <47E7CBC0.8050806@mail.leather-wallet.co.uk>
References: <47E7CBC0.8050806@mail.leather-wallet.co.uk>
Message-ID: <3f4fd2640803251555r47d6fc73r2462567c7bd84286@mail.gmail.com>

On 24/03/2008, chris morgan <cmorgan at mail.leather-wallet.co.uk> wrote:
>  test code run on windows nt4 sp6, messages checked using ms spk++:
>
>       DEVMODE dev_mode;
>       memset(&dev_mode,0,sizeof(DEVMODE));
>       dev_mode.dmSize = sizeof(DEVMODE);
>
>       // Get the current display settings
>       if (!EnumDisplaySettings(NULL,ENUM_CURRENT_SETTINGS,&dev_mode))
>       {
>           printf("Could not EnumDisplaySettings, giving up.\n");
>           return 0;
>       }
>
>       // Call ChangeDisplaySettings with the current settings,
>       // No WM_DISPLAYCHANGE message sent
>       ChangeDisplaySettings(&dev_mode, 0);
>
>       // Change something (that works)
>       dev_mode.dmBitsPerPel = 32;
>
>       // WM_DISPLAYCHANGE message sent
>       ChangeDisplaySettings(&dev_mode, 0);
>
>       // Change something to an impossible value
>       dev_mode.dmBitsPerPel = 999;
>
>       // No WM_DISPLAYCHANGE message sent
>       ChangeDisplaySettings(&dev_mode, 0);

This should be incorporated into a conformance/regression test. That
way, this bug will not reappear and can also be verified as the
correct behaviour on different versions of Windows.

> +    if (width == screen_width && height == screen_height)
> +    {
> +	return;
> +    }

w.r.t. the implementation:
  *  ChangeDisplaySettings returns a long
(http://msdn2.microsoft.com/en-us/library/ms533260(VS.85).aspx), so
the correct value must be returned on error;
  *  the fix does not match the test cases (screen size vs colour depth).

In addition, your tests should:
  *  check that changing the screen resolution causes a
WM_DISPLAYCHANGE message to be sent;
  *  if there are no other tests, ChangeDisplaySettings should be
checked to see what happens with invalid arguments (for completeness);
  *  the return value is not checked for expected values (see
http://msdn2.microsoft.com/en-us/library/ms533260(VS.85).aspx);
  *  GetLastError() is not checked to see what it is set to (see other
tests for examples);
  *  restore the display settings back to what they were before the tests.

Thanks for improving Wine,
- Reece


From hintak_leung at yahoo.co.uk  Wed Mar 26 09:47:31 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 14:47:31 +0000 (GMT)
Subject: DLL exports... HELP?!
In-Reply-To: <47EA38DF.3060501@gmx.net>
Message-ID: <494035.78583.qm@web23110.mail.ird.yahoo.com>

Wow :-). I have almost wanted to suggest such a native wine-based printer driver 
as a linux foundation/openprinting GOSC project (I am one of the mentors under the
openprinting umbrella https://www.linux-foundation.org/en/Google_Summer_of_Code). 
I am glad I didn't :-).

I suppose under the terms of the license you don't mind we do some work based
on your work? I'll let "the other printing folks" know. 

--- On Wed, 26/3/08, Marcel Partap <mpartap at gmx.net> wrote:

> From: Marcel Partap <mpartap at gmx.net>
> Subject: Re: DLL exports... HELP?!
> To: pure_evil at mail.bg
> Cc: wine-devel at winehq.org
> Date: Wednesday, 26 March, 2008, 11:51 AM
> Hi Stefanov,
> attached is the code of a standalone proxy DLL I developed
> last year during SoC, have a look 
> especially at the makefile for cross-compilation...
> regards marcel.
> 
> -- 
> <div id="signature">
>    "Obstacles are those frightful things you see when
> you take your eyes off your goal."
>                                                            
>    -- Henry Ford (1863-1947)
>    Change the world! Vote revolution:
> http://hfopi.org/vote-future
> </div>


      ___________________________________________________________ 
Rise to the challenge for Sport Relief with Yahoo! For Good  

http://uk.promotions.yahoo.com/forgood/


From huw at codeweavers.com  Wed Mar 26 10:40:53 2008
From: huw at codeweavers.com (Huw Davies)
Date: Wed, 26 Mar 2008 15:40:53 +0000
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <202895.60473.qm@web23114.mail.ird.yahoo.com>
References: <20080326152102.GC31599@merlot.physics.ox.ac.uk>
	<202895.60473.qm@web23114.mail.ird.yahoo.com>
Message-ID: <20080326154053.GD31599@merlot.physics.ox.ac.uk>

On Wed, Mar 26, 2008 at 03:33:27PM +0000, Hin-Tak Leung wrote:
> --- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
> > Well yes, but that doesn't actually mean the patch is
> > incorrect.
> 
> Well, it is certainly doing something that the .NET framework doesn't like -  
> or, maybe exposing a bug elsewhere which wasn't reached due to incompleteness before.
> Can you explain the purpose of your patch?

I think it's a bug in *native* gdiplus.  If you install ukai.ttf on
Windows then apps that use gdiplus will crash too.

> > Do you by any chance have the font 'ukai.ttf'
> > installed?  If so could
> > you try removing it from your fontconfig path and see if
> > that helps?
> 
> Yes, I have ukai.ttf on my system (and others came with Fedora 8), 
> but I am running wine in  LANG=en_US.UTF-8 . I'll give your suggestion a 
> try.

Actually I've just attached a hack to the bug, try that instead.

Thanks,
Huw.
-- 
Huw Davies
huw at codeweavers.com


From madewokherd+d41d at gmail.com  Wed Mar 26 11:09:08 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Wed, 26 Mar 2008 12:09:08 -0400
Subject: [PATCH 1 of 2] explorer: add /startfile switch for starting files
	from file managers
In-Reply-To: <87skydshse.fsf@wine.dyndns.org>
References: <ced95fe0803201906t70760536g828ebd2d5fc9dbc4@mail.gmail.com>
	<871w5xtzsw.fsf@wine.dyndns.org>
	<ced95fe0803260617l34d03fbcu1a1414dfaac52818@mail.gmail.com>
	<87skydshse.fsf@wine.dyndns.org>
Message-ID: <ced95fe0803260909w1351b9dbxc4f9ae8154f3051f@mail.gmail.com>

On Wed, Mar 26, 2008 at 10:04 AM, Alexandre Julliard
<julliard at winehq.org> wrote:
> "Vincent Povirk" <madewokherd+d41d at gmail.com> writes:
>
>
> > My understanding is that start.exe will not work because it must be
>  > compatible with the windows version of start. In any case, I don't
>  > think I could usefully share code with the rest of start.
>
>  It has to be compatible, but adding new options that don't exist on
>  Windows shouldn't be a problem. That's what you'd have to do in explorer
>  too anyway.
>
Ok, I'll have to look at this in more detail when I am at home.

>  > I would like to keep the distinction between .exe and other files so
>  > that bug 5368 can be fixed.
>
>  I'm not sure I understand why you need that for 5368.
>
It's more the combination of 5224 and 5368.

5224 requires quotes around the exe filename in the command line, even
if the filename contains no spaces. ShellExecuteEx does not let me put
in the quotes. I think I tested start.exe on windows and it also did
not let me add quotes, but I will check again.

5368 isn't very clear (someone apparently wants to make windows file
associations somehow work like those on Linux), but it seems like it
could be partially solved by having something that users can open
non-exe files with in nautilus to start it with the file association
in wine. I think it makes sense from a user perspective to do this by
starting them with "wine". For that to work, nautilus needs to be able
to start them with the same method as exe files.

I don't think starting non-exe files should be considered a separate
feature. wine.desktop really should do what windows explorer would do,
and that's the problem I want to solve here.

-- 
Vincent Povirk


From htl10 at users.sourceforge.net  Wed Mar 26 11:38:26 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 16:38:26 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <20080326154053.GD31599@merlot.physics.ox.ac.uk>
Message-ID: <887519.50316.qm@web23105.mail.ird.yahoo.com>

--- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
<snipped>
> I think it's a bug in *native* gdiplus.  If you install
> ukai.ttf on
> Windows then apps that use gdiplus will crash too.

oh. I suppose it is fair enough that installing any fonts
on windows can have bad effects. 

But, OTOH, should one expose the whole of fontconfig-available
fonts to wine? A lot of them may be dubious to various extent. 

If ukai is affected, I would suspect uming (also from Arphic)
would be the same? and how many non-english fonts one want to 
"work-around" like this?


> 
> > > Do you by any chance have the font
> 'ukai.ttf'
> > > installed?  If so could
> > > you try removing it from your fontconfig path and
> see if
> > > that helps?
> > 
> > Yes, I have ukai.ttf on my system (and others came
> with Fedora 8), 
> > but I am running wine in  LANG=en_US.UTF-8 . I'll
> give your suggestion a 
> > try.
> 
> Actually I've just attached a hack to the bug, try that
> instead.

Thanks - but I also have uming, and a a fair number of other fonts
shipped from fedora for non-english. (over 100).


      __________________________________________________________
Sent from Yahoo! Mail.
More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html


From austinenglish at gmail.com  Wed Mar 26 11:44:24 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 26 Mar 2008 11:44:24 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47E8C0FC.2010700@gmail.com>
References: <47E8C0FC.2010700@gmail.com>
Message-ID: <b6bb06270803260944r36fb307ar5911708dffa34e26@mail.gmail.com>

On Tue, Mar 25, 2008 at 4:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi,
>
>  We didn't have a new winetest executable for the last few days. MinGW doesn't
>  know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.
>
>  Especially while in the process of getting ready for 1.0 we should have winetest
>  run as much as possible.
>
>  My main focus will be adding tests btw until 1.0 is out. These will be both
>  tests to proof the correctness of the current implementation as well as tests to
>  show missing stuff. There are loads of functions for which we have no tests yet
>  and with the 1.0 in sight I think it becomes very important to have tests for
>  virtually every function we (have) implement(ed).

Might make a good SoC project?


From patrol at sinus.cz  Wed Mar 26 11:44:27 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Wed, 26 Mar 2008 17:44:27 +0100
Subject: Can't determine disk space, install fails
In-Reply-To: <47EA5823.5020003@sandbox.cz>
References: <20080326134921.GA16578@tangens.sinus.cz>
	<47EA5823.5020003@sandbox.cz>
Message-ID: <20080326164427.GA28884@tangens.sinus.cz>

Ahoj Vito / Hi Vit,
  many thanks for your valuable help! In our case, it depends on the
partition size, not on the free space remaining. We've found that on every
partition bigger than 64G, the installation fails.
  Now we are performing an experimental installation in /var/tmp, where /var
has only 15G in our case, and it works like a charm.
  What debugging options could we set to collect symptoms of the problem ?
  With regards,
     Pavel Troller
  
> Hi Pavel,
> I've ran into similar issues when, for example, I've got more than 64GB 
> free space on the partition, and the old Win installers just told me 
> there was -1 bytes free. I'd vote for some Wine (or 3rd party tool) 
> functionality that would decrease the reported bytes available per 
> user's request.
> 
> As a temporary solution for such problems, I've used a small partition 
> for installation with just 2GBs free and it worked for me. I've then 
> moved the wineprefix into the target partition.
> Regards
> Vit Hrachovy
> 
> Pavel Troller wrote:
> > Hi!
> >   We have a long-persisting problem there. It persists for many wine versions
> > and prevents some programs from installing.
> >   As an example, today my son complained about impossibility to install WoW.
> > The installer was not able to determine the free space on the disk (there was
> > a dash instead of a number in the box) and the Continue button was greyed out,
> > so it was not possible to proceed.
> >   There are other cases, in which the installers say that there is not enough
> > space on the disk and fail. Of course there is enough space, but the installer
> > is not able to find it.
> >   Especially WoW has Gold rating and these problems are not mentioned, so I
> > don't think that this is a common wine problem, thus I'm not going to open
> > a bug for it. I'm begging for a hint instead, what to try to find the cause
> > of the problem.
> >   Wine is always manually compiled and it runs on a "generic Linux system",
> > not on any particular, publicly known distro.
> > 
> >   With regards, Pavel Troller
> > 
> > 
> 
> 


From htl10 at users.sourceforge.net  Wed Mar 26 11:51:31 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 16:51:31 +0000 (GMT)
Subject: Fw: Re: Google Summer of Code 2008 - joined openprinting+wine project?
Message-ID: <94951.56539.qm@web23105.mail.ird.yahoo.com>

Hi, anybody on wine-devel want to take this on and make this more concrete?

--- On Wed, 26/3/08, Till Kamppeter <till.kamppeter at gmail.com> wrote:

> From: Till Kamppeter <till.kamppeter at gmail.com>
> Subject: Re: Google Summer of Code 2008 - Some general instructions for reviewing the student's applications
> To: "Hin-Tak Leung" <hintak_leung at yahoo.co.uk>
> Cc: "Casey Schaufler" <casey at schaufler-ca.com>, "'Glen Petrie'" <glen.petrie at eitc.epson.com>, "Rik van Riel" <riel at redhat.com>, "Jeff Licquia" <licquia at debian.org>, "Jon Masters" <jonmasters at gmail.com>, "Jonathan Riddell" <jriddell at ubuntu.com>, "Josef Spillner" <spillner at kde.org>, Matt_Domsch at dell.com, "Pekka Enberg" <penberg at cs.helsinki.fi>
> Date: Wednesday, 26 March, 2008, 4:34 PM
> Hin-Tak Leung wrote:
> > Hi Till and the rest of the gang.
> > 
> > Two people had got in touch with with about the
> IJS+PDF workflow, and I replied. 
> > (sorry I don't check the "other" e-mail
> often - I probably should set up re-direction).
> >
> 
> Great!
> 
> > I thought I should also mentioned that it has just
> came to my attention in some unrelated discussion on
> wine-devel - been doing some non-printing wine-related
> stuff lately - that there *was* a google summer of code
> 2007 project for a
> > wine-based native printer driver proxy - this is the
> sort of thing I have had in mind
> > for a while and I thought it would be interesting to
> do but I don't have in-depth
> > windows knowledge to make it happen, but the wine
> people already did!
> > http://google-summer-of-code-2007-wine.googlecode.com/
> > 
> > I just downloaded the gsoc 2007 printerproxy code. It
> seems that it is just for use
> > from within wine, but it just might be interesting to
> make it more general - via opvp
> > or IJS. We should follow up on this.
> 
> If this project still requires coding, it is not too late
> to add it as 
> project idea to the ideas pages of both the Linux
> Foundation and WINE 
> (having it presented at two mentoring organizations raises
> the chances 
> to find a student).
> 
> Our ideas page is a Wiki and you can simply edit it:
> 
> https://www.linux-foundation.org/en/Google_Summer_of_Code
> 
>     Till


      __________________________________________________________
Sent from Yahoo! Mail.
More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html


From huw at codeweavers.com  Wed Mar 26 11:51:41 2008
From: huw at codeweavers.com (Huw Davies)
Date: Wed, 26 Mar 2008 16:51:41 +0000
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <887519.50316.qm@web23105.mail.ird.yahoo.com>
References: <20080326154053.GD31599@merlot.physics.ox.ac.uk>
	<887519.50316.qm@web23105.mail.ird.yahoo.com>
Message-ID: <20080326165141.GE31599@merlot.physics.ox.ac.uk>

On Wed, Mar 26, 2008 at 04:38:26PM +0000, Hin-Tak Leung wrote:
> --- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
> But, OTOH, should one expose the whole of fontconfig-available
> fonts to wine? A lot of them may be dubious to various extent. 

Well we already did that anyway.  It was just the native gdiplus apps
didn't see them because of a bug that this commit fixed.

> If ukai is affected, I would suspect uming (also from Arphic)
> would be the same? and how many non-english fonts one want to 
> "work-around" like this?

I've not seen any problems with uming.  Most 'non-english' fonts will
work fine.  There's something very specific about ukai that causes
native gdiplis to have problems.

> > Actually I've just attached a hack to the bug, try that
> > instead.
> 
> Thanks - but I also have uming, and a a fair number of other fonts
> shipped from fedora for non-english. (over 100).

Please try the patch and report back.

Huw.
-- 
Huw Davies
huw at codeweavers.com


From mat at brain-dump.org  Wed Mar 26 11:59:10 2008
From: mat at brain-dump.org (Marc Andre Tanner)
Date: Wed, 26 Mar 2008 17:59:10 +0100
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
References: <20080325213351.GA3237@debbook.brain-dump.org>
	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
Message-ID: <20080326165909.GA3213@debbook.brain-dump.org>

On Wed, Mar 26, 2008 at 12:49:16PM +0100, Francois Gouget wrote:
> On Tue, 25 Mar 2008, Marc Andre Tanner wrote:
> [...]
> > The filesystem converts every path to lower case before further
> > operations take place. On file creation the original filename is
> > stored in an extended attribute and later returned upon request.
> 
> Shouldn't it be the other way around? I guess the way you've done it is 
> simpler because you can simply rely on the standard kernel code to 
> ensure filename uniqueness, but it also means that anyone accessing the 
> underlying files directly will lose the case information.

Yes that's true the case information is lost but is it really needed? 
If you create the files with the original mixed case you will have to
scan the whole directory in order to match it to a given filename. 
And if i am not mistaken this is exactly what wine does. 

Note also that in the current form having files with upper case letters in 
the underlying directory will cause problems (i will probably just ignore
them in readdir for now). Another quite crazy idea is to transform the
whole directory to lowercase on mount and then on unmount back to the 
original mixed case representation. That would preserve the case information,
but the mount/unmount will be quite expensive and probably cause some
problems if someone is messing around with de underlying directory 
directly.

By the way there is now a git repository available for those who want
to play with it.

  git clone git://repo.or.cz/ciopfs.git

Regards,
Marc

-- 
 Marc Andre Tanner >< http://www.brain-dump.org/ >< GPG key: CF7D56C0


From julliard at winehq.org  Wed Mar 26 12:10:16 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 18:10:16 +0100
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <20080326165909.GA3213@debbook.brain-dump.org> (Marc Andre
	Tanner's message of "Wed, 26 Mar 2008 17:59:10 +0100")
References: <20080325213351.GA3237@debbook.brain-dump.org>
	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
	<20080326165909.GA3213@debbook.brain-dump.org>
Message-ID: <87iqz9s96v.fsf@wine.dyndns.org>

Marc Andre Tanner <mat at brain-dump.org> writes:

> Yes that's true the case information is lost but is it really needed? 
> If you create the files with the original mixed case you will have to
> scan the whole directory in order to match it to a given filename. 
> And if i am not mistaken this is exactly what wine does. 

Yes, and that's precisely because Wine wants to preserve case, so that
tools that look at the filesystem directly see the right thing. If you
are going to store everything lowercase in the filesystem, then we could
just as well do that inside Wine, without a FUSE module.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Wed Mar 26 12:30:44 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Wed, 26 Mar 2008 18:30:44 +0100
Subject: Trouble in compiling Wine 0.9.57 and 0.9.58 on Solaris 10 08/07
In-Reply-To: <47EA1E24.8010700@hisoft.ru>
References: <47EA1E24.8010700@hisoft.ru>
Message-ID: <200803261830.44932.stefan@codeweavers.com>

Am Mittwoch, 26. M?rz 2008 10:57:56 schrieb ??????? ????? ??????????????:
> After 40 minutes of the compilation the process halted with messages:
> wined3d_private.h: In function `float_32_to_16':
> wined3d_private.h:159: warning: implicit declaration of function `isinf'
> wined3d_main.c: At top level:
> wined3d_main.c:271: warning: visibility attribute not supported in this
> configuration; ignored
> (the last string repeated for many times)
> I suppose the situation is connected with Solaris 'isinf' but I am too
> far from programming under UNIX...
isinf is a function / macro which returns wether or not a float is positive 
infinite or negative infinite. I think it is a standard C function. Maybe 
solaris declares it in some header that needs to be included, like math.h?


From thestig at google.com  Wed Mar 26 13:38:59 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 26 Mar 2008 11:38:59 -0700
Subject: dlls/user32/tests/cursoricon.c - test succeeded inside todo block
Message-ID: <558b2f5c0803261138r2b942d8eo139082ed394644d8@mail.gmail.com>

Anyone else seeing this?

../../../tools/runtest -q -P wine -M user32.dll -T ../../.. -p
user32_test.exe.so cursoricon.c && touch cursoricon.ok
cursoricon.c:656: Test succeeded inside todo block: No hbmColor!
make: *** [cursoricon.ok] Error 1


From truiken at gmail.com  Wed Mar 26 13:42:27 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 26 Mar 2008 13:42:27 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47E8C57C.9030708@gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
Message-ID: <22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>

On Tue, Mar 25, 2008 at 4:27 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>
> James Hawkins wrote:
>  > On Tue, Mar 25, 2008 at 4:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>  >> Hi,
>  >>
>  >>  We didn't have a new winetest executable for the last few days. MinGW doesn't
>  >>  know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.
>  >>
>  >>  Especially while in the process of getting ready for 1.0 we should have winetest
>  >>  run as much as possible.
>  >>
>  >>  My main focus will be adding tests btw until 1.0 is out. These will be both
>  >>  tests to proof the correctness of the current implementation as well as tests to
>  >>  show missing stuff. There are loads of functions for which we have no tests yet
>  >>  and with the 1.0 in sight I think it becomes very important to have tests for
>  >>  virtually every function we (have) implement(ed).
>  >>
>  >
>  > While that's a worthy goal, I think a better short-term goal for the
>  > run up to 1.0 is to fix the current failing tests in Windows.
>  >
>  But either way we need an up-to-date winetest executable ;-)
>

Are you currently working on this?  Is it a problem that needs to be
fixed on the mingw side?

-- 
James Hawkins


From paul.vriens.wine at gmail.com  Wed Mar 26 14:19:28 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 26 Mar 2008 20:19:28 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>	
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>	
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
Message-ID: <47EAA1C0.5050004@gmail.com>

James Hawkins wrote:
> On Tue, Mar 25, 2008 at 4:27 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> James Hawkins wrote:
>>  > On Tue, Mar 25, 2008 at 4:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>>  >> Hi,
>>  >>
>>  >>  We didn't have a new winetest executable for the last few days. MinGW doesn't
>>  >>  know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.
>>  >>
>>  >>  Especially while in the process of getting ready for 1.0 we should have winetest
>>  >>  run as much as possible.
>>  >>
>>  >>  My main focus will be adding tests btw until 1.0 is out. These will be both
>>  >>  tests to proof the correctness of the current implementation as well as tests to
>>  >>  show missing stuff. There are loads of functions for which we have no tests yet
>>  >>  and with the 1.0 in sight I think it becomes very important to have tests for
>>  >>  virtually every function we (have) implement(ed).
>>  >>
>>  >
>>  > While that's a worthy goal, I think a better short-term goal for the
>>  > run up to 1.0 is to fix the current failing tests in Windows.
>>  >
>>  But either way we need an up-to-date winetest executable ;-)
>>
> 
> Are you currently working on this?  Is it a problem that needs to be
> fixed on the mingw side?
> 
It's indeed a mingw issue and has to be fixed on that side.

I've never touched mingw so I'm relying on either Hans Leidekker, Stefan 
Leichter or Paul Millar to take this up.

Cheers,

Paul (Vriens).




From htl10 at users.sourceforge.net  Wed Mar 26 14:35:56 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 19:35:56 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <20080326165141.GE31599@merlot.physics.ox.ac.uk>
Message-ID: <137645.21992.qm@web23108.mail.ird.yahoo.com>

--- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
<snipped>
> > If ukai is affected, I would suspect uming (also from
> Arphic)
> > would be the same? and how many non-english fonts one
> want to 
> > "work-around" like this?
> 
> I've not seen any problems with uming.  Most
> 'non-english' fonts will
> work fine.  There's something very specific about ukai
> that causes
> native gdiplis to have problems.
> 
> > > Actually I've just attached a hack to the
> bug, try that
> > > instead.
> > 
> > Thanks - but I also have uming, and a a fair number of
> other fonts
> > shipped from fedora for non-english. (over 100).
> 
> Please try the patch and report back.

Yes, your patch works alright - it is just ukai and nothing else. I'll put it on the bug report as well. Ukai (or rather, the original Arphic kai font) was the first
commercial quality chinese font released under an open license, so you are going to
have a lot of people - 20% of the world is Chinese, and also linux is rather more officially popular in China due to licensing/cost/idealological reasons and some
non-chinese will install "everything" - being affected by this. I don't know if it 
is ukai-specific or any Arphic kai derivatives, but if it affects any Arphic kai derivatives, filtering by font name as your patch did won't be effective. 
 



      __________________________________________________________
Sent from Yahoo! Mail.
More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html


From owen at owenrudge.net  Wed Mar 26 16:27:58 2008
From: owen at owenrudge.net (Owen Rudge)
Date: Wed, 26 Mar 2008 21:27:58 -0000
Subject: GSOC proposal - control panel
Message-ID: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>

Hi everyone,

I'm intending to apply for a Google Summer of Code placement working on the 
Wine control panel support. My main intention is to work on a proper Control 
Panel application for Wine that accepts standard .cpl files, and turn 
winecfg's configuration sections into appropriate control panels. (I notice 
that pure_evil @ mail.bg has been doing some work on this - if I were to get 
accepted to work on this, then I would like to continue his line of work, or 
assist him with it.) However, as I don't believe that project alone would 
necessarily take up an entire summer, my intention would also be to work on 
some new control panel applets for Wine. The examples given on the GSOC wiki 
pages (basic desktop/screen resizing, general network information, and font 
details) would be good applets for me to implement, but I would also be 
interested in working on some other applets, such as an Add/Remove Programs 
applet, or a Multimedia applet. Obviously, there wouldn't necessarily be 
time to implement all of these, so my intention would be to get the main 
control panel and basic Wine control panel applets from winecfg working well 
first, and then look at other applets that could be implemented.

I've developed applications and, indeed, Control Panel applets for Windows 
for many years now (I started programming using the Windows API when I was 
12!), so I feel confident that this is a task I would be able to handle. I 
believe that a good configuration interface for Wine that supports 
third-party control panels is something that would be very useful for 
end-users.

If anyone has any comments or suggestions regarding my proposal, I'd very 
much appreciate any feedback.

Regards,

-- 
Owen Rudge
http://www.owenrudge.net/ 



From winehacker at gmail.com  Wed Mar 26 16:42:53 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Wed, 26 Mar 2008 17:42:53 -0400
Subject: GSOC proposal - control panel
In-Reply-To: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
References: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
Message-ID: <19e31a080803261442w54c5c248sba3c0bd8d2f9e2f0@mail.gmail.com>

Hi Owen,

On Wed, Mar 26, 2008 at 5:27 PM, Owen Rudge <owen at owenrudge.net> wrote:
<snip>

>  interested in working on some other applets, such as an Add/Remove Programs
>  applet, or a Multimedia applet. Obviously, there wouldn't necessarily be
>  time to implement all of these, so my intention would be to get the main
>  control panel and basic Wine control panel applets from winecfg working well
>  first, and then look at other applets that could be implemented.
>
>  I've developed applications and, indeed, Control Panel applets for Windows
>  for many years now (I started programming using the Windows API when I was
>  12!), so I feel confident that this is a task I would be able to handle. I
>  believe that a good configuration interface for Wine that supports
>  third-party control panels is something that would be very useful for
>  end-users.
>
>  If anyone has any comments or suggestions regarding my proposal, I'd very
>  much appreciate any feedback.

I don't really know if we want to just focus on applets or if we
should not aim for having this project provide better integration with
the native desktop. As far as I understand there is some
infrastructure work that will need to be done in shell32 as I don't
think we fully implement the entire Control Panel shellname space. I
expect implementing this properly will take a good bit of time. What
would be cool would be if we fully supported the namespace so that
when you called control.exe it loaded the control panel window and
that could be embedded in a GTK or QT window for use by native
applications. There was a patch floating around on wine-patches a few
months back to allow for embedding a Win32 Wine window inside of an
existing X window that should do the trick.

As far as migration of the stuff in winecfg and other programs go, I
think starting with the Add/Remove applet is a good. I don't think it
would be too hard to take all of the current logic in
wine/programs/uninstall and wrap it in a proper applet. We want to
make sure that we don't introduce any sort of regression when we make
the switch over so reusing that code would be a good place to start.

So to recap, (this just goes for for me) I think the project should be
laid out as follows

1. A fully working Control Panel Namespace
2. The ability to embed the Control Panel window in a native window
3. Have a collection of applets to configure wine

I don't know who is mentoring this project so I think we should get
their thoughts on it.

Thanks
-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From mstefani at redhat.com  Wed Mar 26 16:47:49 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 26 Mar 2008 22:47:49 +0100
Subject: gdi32: PlgBlt implementation
In-Reply-To: <47EAC0E6.9070300@gmail.com>
References: <47EAC0E6.9070300@gmail.com>
Message-ID: <47EAC485.5000309@redhat.com>

Hello Nikolay,

thanks for the patch.

Nikolay Sivov wrote:
> Changelog:
>      gdi32: initial implementation using  coord transformation and MaskBlt
>      patch is made in Windows using TortoiseCVS functionality (all that 
> I can use at this moment, shouldn't be a problem I hope)
No that's not a problem as long as you do the cvs diff from the top
level wine directory.

Please do not use C++ style comments but the traditional /* */.

bye
	michael

> 
> Index: bitblt.c
> ===================================================================
> RCS file: /home/wine/wine/dlls/gdi32/bitblt.c,v
> retrieving revision 1.4
> diff -u -r1.4 bitblt.c
> --- bitblt.c    18 Sep 2007 10:32:56 -0000    1.4
> +++ bitblt.c    26 Mar 2008 21:19:31 -0000
> @@ -26,6 +26,9 @@
>  #include "gdi_private.h"
>  #include "wine/debug.h"
>  
> +#include <math.h>
> +#include <float.h>
> +
>  WINE_DEFAULT_DEBUG_CHANNEL(bitblt);
>  
>  
> @@ -522,9 +525,72 @@
>   *
>   */
>  BOOL WINAPI PlgBlt( HDC hdcDest, const POINT *lpPoint,
> -                        HDC hdcSrc, INT nXDest, INT nYDest, INT nWidth,
> +                        HDC hdcSrc, INT nXSrc, INT nYSrc, INT nWidth,
>                          INT nHeight, HBITMAP hbmMask, INT xMask, INT yMask)
>  {
> -    FIXME("PlgBlt, stub\n");
> -        return 1;
> +    //save actual mode, set GM_ADVANCED
> +    int oldgMode = SetGraphicsMode(hdcDest,GM_ADVANCED);
> +    if (oldgMode == 0)
> +        return FALSE;
> +
> +    //parallelogram coords
> +    POINT plg[3];
> +    memcpy(plg,lpPoint,sizeof(POINT)*3);
> +    //rect coords
> +    POINT rect[3];
> +    rect[0].x = nXSrc;
> +    rect[0].y = nYSrc;
> +    rect[1].x = nXSrc + nWidth;
> +    rect[1].y = nYSrc;
> +    rect[2].x = nXSrc;
> +    rect[2].y = nYSrc + nHeight;
> +    //calc XFORM matrix to transform hdcDest -> hdcSrc (parallelogram 
> to rectangle)
> +    XFORM xf;
> +    //determinant
> +    FLOAT det = (FLOAT)(rect[1].x*(rect[2].y - rect[0].y) - 
> rect[2].x*(rect[1].y - rect[0].y) - rect[0].x*(rect[2].y - rect[1].y));
> +
> +    if (fabs(det) < FLT_EPSILON)
> +    {
> +        SetGraphicsMode(hdcDest,oldgMode);
> +        return FALSE;
> +    }
> +  
> +    TRACE("hdcSrc=%p %d,%d,%dx%d -> hdcDest=%p %d,%d,%d,%d,%d,%d\n",
> +        hdcSrc, nXSrc, nYSrc, nWidth, nHeight, hdcDest, plg[0].x, 
> plg[0].y, plg[1].x, plg[1].y, plg[2].x, plg[2].y);
> +
> +    //X components
> +    xf.eM11 = (plg[1].x*(rect[2].y - rect[0].y) - plg[2].x*(rect[1].y - 
> rect[0].y) - plg[0].x*(rect[2].y - rect[1].y)) / det;
> +    xf.eM21 = (rect[1].x*(plg[2].x - plg[0].x) - rect[2].x*(plg[1].x - 
> plg[0].x) - rect[0].x*(plg[2].x - plg[1].x)) / det;
> +    xf.eDx  = (rect[0].x*(rect[1].y*plg[2].x - rect[2].y*plg[1].x) -
> +               rect[1].x*(rect[0].y*plg[2].x - rect[2].y*plg[0].x) +
> +               rect[2].x*(rect[0].y*plg[1].x - rect[1].y*plg[0].x)
> +               ) / det;
> +
> +    //Y components
> +    xf.eM12 = (plg[1].y*(rect[2].y - rect[0].y) - plg[2].y*(rect[1].y - 
> rect[0].y) - plg[0].y*(rect[2].y - rect[1].y)) / det;
> +    xf.eM22 = (plg[1].x*(rect[2].y - rect[0].y) - plg[2].x*(rect[1].y - 
> rect[0].y) - plg[0].x*(rect[2].y - rect[1].y)) / det;
> +    xf.eDy  = (rect[0].x*(rect[1].y*plg[2].y - rect[2].y*plg[1].y) -
> +               rect[1].x*(rect[0].y*plg[2].y - rect[2].y*plg[0].y) +
> +               rect[2].x*(rect[0].y*plg[1].y - rect[1].y*plg[0].y)
> +               ) / det;
> +
> +    XFORM SrcXf;
> +    GetWorldTransform(hdcSrc,&SrcXf);
> +    CombineTransform(&xf,&xf,&SrcXf);
> +   
> +    //save actual dest transform
> +    XFORM oldDestXf;
> +    GetWorldTransform(hdcDest,&oldDestXf);
> +    //
> +    SetWorldTransform(hdcDest,&xf);
> +    //now destination and source DCs use same coords
> +    MaskBlt(hdcDest,nXSrc,nYSrc,nWidth,nHeight,
> +            hdcSrc, nXSrc,nYSrc,
> +            hbmMask,xMask,yMask,
> +            SRCCOPY);
> +    //restore dest DC
> +    SetWorldTransform(hdcDest,&oldDestXf);
> +    SetGraphicsMode(hdcDest,oldgMode);
> +
> +    return TRUE;
>  }
> 
> 
> 



From owen at owenrudge.net  Wed Mar 26 16:57:06 2008
From: owen at owenrudge.net (Owen Rudge)
Date: Wed, 26 Mar 2008 21:57:06 -0000
Subject: GSOC proposal - control panel
References: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
	<19e31a080803261442w54c5c248sba3c0bd8d2f9e2f0@mail.gmail.com>
Message-ID: <016201c88f8c$56988a50$842a204e@lan.owenrudge.net>

Hi Steven,

> I don't really know if we want to just focus on applets or if we
> should not aim for having this project provide better integration with
> the native desktop. As far as I understand there is some
> infrastructure work that will need to be done in shell32 as I don't
> think we fully implement the entire Control Panel shellname space. I
> expect implementing this properly will take a good bit of time. What
> would be cool would be if we fully supported the namespace so that
> when you called control.exe it loaded the control panel window and
> that could be embedded in a GTK or QT window for use by native
> applications. There was a patch floating around on wine-patches a few
> months back to allow for embedding a Win32 Wine window inside of an
> existing X window that should do the trick.

Implementing the proper Control Panel namespace would certainly make the 
control panel section of the project a much longer one. My initial thoughts 
were that it may be an easier task to implement the Control Panel in a more 
old-fashioned style of simply having a list view into which the control 
panel icons were placed - this would certainly provide a sufficient 
interface for accessing the control panel. However, it probably would be 
better in the long run to implement things "properly", and at the very least 
getting Control Panel integrated with the shell namespace. Integration with 
native applications certainly looks as though it would provide an added 
challenge to that project, but is an interesting idea that could work quite 
nicely.

> As far as migration of the stuff in winecfg and other programs go, I
> think starting with the Add/Remove applet is a good. I don't think it
> would be too hard to take all of the current logic in
> wine/programs/uninstall and wrap it in a proper applet. We want to
> make sure that we don't introduce any sort of regression when we make
> the switch over so reusing that code would be a good place to start.

Indeed, my plan was to make use of appropriate Wine tools where they 
existed, such as in the case of the uninstaller, and flesh them out into 
fully-featured control panel applets.

> So to recap, (this just goes for for me) I think the project should be
> laid out as follows
>
> 1. A fully working Control Panel Namespace
> 2. The ability to embed the Control Panel window in a native window
> 3. Have a collection of applets to configure wine

This sounds like a pretty decent way of going about things. Number 2 was 
something I hadn't particularly considered doing initially, but I'll have a 
look for the patch that was posted recently and see what I think about it 
and how much work is likely to be involved.

Cheers,

-- 
Owen Rudge
http://www.owenrudge.net/



From mat at brain-dump.org  Wed Mar 26 17:17:28 2008
From: mat at brain-dump.org (Marc Andre Tanner)
Date: Wed, 26 Mar 2008 23:17:28 +0100
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <87iqz9s96v.fsf@wine.dyndns.org>
References: <20080325213351.GA3237@debbook.brain-dump.org>
	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
	<20080326165909.GA3213@debbook.brain-dump.org>
	<87iqz9s96v.fsf@wine.dyndns.org>
Message-ID: <20080326221728.GA1896@debbook.brain-dump.org>

On Wed, Mar 26, 2008 at 06:10:16PM +0100, Alexandre Julliard wrote:
> Marc Andre Tanner <mat at brain-dump.org> writes:
> 
> > Yes that's true the case information is lost but is it really needed? 
> > If you create the files with the original mixed case you will have to
> > scan the whole directory in order to match it to a given filename. 
> > And if i am not mistaken this is exactly what wine does. 
> 
> Yes, and that's precisely because Wine wants to preserve case, so that
> tools that look at the filesystem directly see the right thing. If you
> are going to store everything lowercase in the filesystem, then we could
> just as well do that inside Wine, without a FUSE module.

I am not quite sure whether i understand what you mean. Let's say we
mount the case insensitive filesystem at ~/.wine/drive_c this will
then preserve the case of the filenames the actual data which is all
lowercase is in ~/.wine/.drive_c. So as long as the applications are
looking for the files in ~/.wine/drive_c everything is fine. Now when
you unmount the filesystem or simply look into ~/.wine/.drive_c the 
case information is 'lost' (it's still there in the extended attributes 
but no one cares about it).

If this is all wrong, then what is the FUSE module supposed to do?

Thanks,
Marc

-- 
 Marc Andre Tanner >< http://www.brain-dump.org/ >< GPG key: CF7D56C0


From winehacker at gmail.com  Wed Mar 26 17:37:18 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Wed, 26 Mar 2008 18:37:18 -0400
Subject: GSOC proposal - control panel
In-Reply-To: <016201c88f8c$56988a50$842a204e@lan.owenrudge.net>
References: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
	<19e31a080803261442w54c5c248sba3c0bd8d2f9e2f0@mail.gmail.com>
	<016201c88f8c$56988a50$842a204e@lan.owenrudge.net>
Message-ID: <19e31a080803261537v27ab1f9cr41aaacd5d22c70fb@mail.gmail.com>

On Wed, Mar 26, 2008 at 5:57 PM, Owen Rudge <owen at owenrudge.net> wrote:
>  This sounds like a pretty decent way of going about things. Number 2 was
>  something I hadn't particularly considered doing initially, but I'll have a
>  look for the patch that was posted recently and see what I think about it
>  and how much work is likely to be involved.

I think the existing wine/programs/control should display the
enumerated applets but I've never really played with it. In ReactOS we
wrote a version of control.exe more enhanced version that did as you
suggested, creating a listview with item description and name and I
think it was rejected before because Alexandre preferred implementing
the namespace properly.

As for embedding the pseudo-control panel window in the X11 window,
here is the patch in question

http://www.winehq.org/pipermail/wine-patches/2008-February/050117.html

I don't know how Alexandre feels about this either as he did not merge
it in to Winehq. Perhaps he wants to do it some other way...

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From juan.lang at gmail.com  Wed Mar 26 17:42:12 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Wed, 26 Mar 2008 15:42:12 -0700
Subject: gdi32: PlgBlt implementation
In-Reply-To: <47EAC485.5000309@redhat.com>
References: <47EAC0E6.9070300@gmail.com> <47EAC485.5000309@redhat.com>
Message-ID: <3a768c550803261542t10ed5a47w128f8e37eddc569a@mail.gmail.com>

One more comment on your patch:

>  BOOL WINAPI PlgBlt( HDC hdcDest, const POINT *lpPoint,
> -                        HDC hdcSrc, INT nXDest, INT nYDest, INT nWidth,
> +                        HDC hdcSrc, INT nXSrc, INT nYSrc, INT nWidth,
>                          INT nHeight, HBITMAP hbmMask, INT xMask, INT yMask)
>  {
> -    FIXME("PlgBlt, stub\n");
> -        return 1;
> +    //save actual mode, set GM_ADVANCED
> +    int oldgMode = SetGraphicsMode(hdcDest,GM_ADVANCED);
> +    if (oldgMode == 0)
> +        return FALSE;
> +
> +    //parallelogram coords
> +    POINT plg[3];

Variables must be declared at the beginning of the function.  We
require strict ANSI C.
--Juan


From scott at open-vote.org  Wed Mar 26 18:17:57 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Wed, 26 Mar 2008 16:17:57 -0700
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <87iqz9s96v.fsf@wine.dyndns.org>
References: <20080325213351.GA3237@debbook.brain-dump.org>	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>	<20080326165909.GA3213@debbook.brain-dump.org>
	<87iqz9s96v.fsf@wine.dyndns.org>
Message-ID: <47EAD9A5.3050600@open-vote.org>

Alexandre Julliard wrote:
> Marc Andre Tanner <mat at brain-dump.org> writes:
> 
>> Yes that's true the case information is lost but is it really needed? 
>> If you create the files with the original mixed case you will have to
>> scan the whole directory in order to match it to a given filename. 
>> And if i am not mistaken this is exactly what wine does. 
> 
> Yes, and that's precisely because Wine wants to preserve case, so that
> tools that look at the filesystem directly see the right thing. If you
> are going to store everything lowercase in the filesystem, then we could
> just as well do that inside Wine, without a FUSE module.
> 

It seems like we have a few goals:

* Prevent having to read the whole directory when looking for a
case-insensitive file
* Allow non-Wine programs to work with the cased filenames
* Prevent the creation of conflicting files

The last one is important, as we need to have a 1:1 correspondence
between cased and uncased files in the .wine folder to prevent breakages
when someone, say, installs a patch with different casing from a zip file.

I don't see any reason why it would be bad to have the FUSE module
mounted at login rather than when Wine starts.  This would make your
Wine folder no different to other apps than, say, a vfat disk mounted
there.  I should be able to extract a zip with file-roller containing
"foo.txt" and have it overwrite "Foo.txt" even if Wine isn't running.

Thanks,
Scott Ritchie


From mpartap at gmx.net  Wed Mar 26 18:23:40 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Thu, 27 Mar 2008 00:23:40 +0100
Subject: Fw: Re: Google Summer of Code 2008 - joined openprinting+wine
	project?
In-Reply-To: <94951.56539.qm@web23105.mail.ird.yahoo.com>
References: <94951.56539.qm@web23105.mail.ird.yahoo.com>
Message-ID: <47EADAFC.8000206@gmx.net>

Hi Hin-Tak,
to sum it up, I was the one working on that project and I hit some ehh.. problems ;)
Anyways, my final result was that I got something out of the printer drivers I tried with, but 
useful results depended on something that is referred to as the ominous 'DIB engine'. Coincidently, 
there was another SoC project done by Jesse Allen which started implementing that. That code ended 
up at http://repo.or.cz/w/wine/dibdrv.git, and just as mine, general+AJ's consensus was to start 
merging it post-1.0. Now I didn't have time to look again at it up to now (uni!) but I still want to 
finish this, just not as part of a SoC project. Also I wouldn't recommend that to anyone, except he 
REEEAAALLY does grok all those mysterious inner-GDI concepts (DIB DDB DDI...) that this project 
touches. I myself have not fully reached insight of how best to merge the current winex11drv, 
wined3d and Jesse's dib engine, but I'll have a thorough look at it in the next few days. Another 
unsolved issue is whether to teach wine's internal GDI functions to speak DDI or rather to build a 
wineddi.drv bridge thing. I tried both approaches but there was no clear decision whether to use one 
or the other, with Alexandre's stance being 'once something actually works we can talk about that'.
Also my code to make printer drivers work depends on some stuff within the localspooler code, I have 
to investigate how far Detlef got it to work regarding installation of drivers.
Oh yeah and that printer proxy was only a DLL to see how native windows communicates with the 
drivers without getting into disassembling stuff.. the results scared me, astonishing levels of 
redundancy.. Anyways, even though all the bits and pieces of how to make native drivers actually 
work with wine are lying around, this is neither a fun nor a beginner's task (I know that now *g). 
That said, I'm going to look into it and hope to come up with something in the next few days.
regards marcel.


Hin-Tak Leung wrote:
> Hi, anybody on wine-devel want to take this on and make this more concrete?
> 
> --- On Wed, 26/3/08, Till Kamppeter <till.kamppeter at gmail.com> wrote:
> 
>> From: Till Kamppeter <till.kamppeter at gmail.com>
>> Subject: Re: Google Summer of Code 2008 - Some general instructions for reviewing the student's applications
>> To: "Hin-Tak Leung" <hintak_leung at yahoo.co.uk>
>> Cc: "Casey Schaufler" <casey at schaufler-ca.com>, "'Glen Petrie'" <glen.petrie at eitc.epson.com>, "Rik van Riel" <riel at redhat.com>, "Jeff Licquia" <licquia at debian.org>, "Jon Masters" <jonmasters at gmail.com>, "Jonathan Riddell" <jriddell at ubuntu.com>, "Josef Spillner" <spillner at kde.org>, Matt_Domsch at dell.com, "Pekka Enberg" <penberg at cs.helsinki.fi>
>> Date: Wednesday, 26 March, 2008, 4:34 PM
>> Hin-Tak Leung wrote:
>>> Hi Till and the rest of the gang.
>>>
>>> Two people had got in touch with with about the
>> IJS+PDF workflow, and I replied. 
>>> (sorry I don't check the "other" e-mail
>> often - I probably should set up re-direction).
>> Great!
>>
>>> I thought I should also mentioned that it has just
>> came to my attention in some unrelated discussion on
>> wine-devel - been doing some non-printing wine-related
>> stuff lately - that there *was* a google summer of code
>> 2007 project for a
>>> wine-based native printer driver proxy - this is the
>> sort of thing I have had in mind
>>> for a while and I thought it would be interesting to
>> do but I don't have in-depth
>>> windows knowledge to make it happen, but the wine
>> people already did!
>>> http://google-summer-of-code-2007-wine.googlecode.com/
>>>
>>> I just downloaded the gsoc 2007 printerproxy code. It
>> seems that it is just for use
>>> from within wine, but it just might be interesting to
>> make it more general - via opvp
>>> or IJS. We should follow up on this.
>> If this project still requires coding, it is not too late
>> to add it as 
>> project idea to the ideas pages of both the Linux
>> Foundation and WINE 
>> (having it presented at two mentoring organizations raises
>> the chances 
>> to find a student).
>>
>> Our ideas page is a Wiki and you can simply edit it:
>>
>> https://www.linux-foundation.org/en/Google_Summer_of_Code
>>
>>     Till
> 
> 
>       __________________________________________________________
> Sent from Yahoo! Mail.
> More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html
> 


-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>


From cesar at ecuarock.net  Wed Mar 26 18:39:22 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Wed, 26 Mar 2008 18:39:22 -0500
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <47EAD9A5.3050600@open-vote.org>
References: <20080325213351.GA3237@debbook.brain-dump.org>
	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
	<20080326165909.GA3213@debbook.brain-dump.org>
	<87iqz9s96v.fsf@wine.dyndns.org> <47EAD9A5.3050600@open-vote.org>
Message-ID: <e3d3ae8f0803261639t5a275fc6pc03bd0cdff071386@mail.gmail.com>

On Wed, Mar 26, 2008 at 6:17 PM, Scott Ritchie <scott at open-vote.org> wrote:
>
> Alexandre Julliard wrote:
>  > Marc Andre Tanner <mat at brain-dump.org> writes:
>  >
>  >> Yes that's true the case information is lost but is it really needed?
>  >> If you create the files with the original mixed case you will have to
>  >> scan the whole directory in order to match it to a given filename.
>  >> And if i am not mistaken this is exactly what wine does.
>  >
>  > Yes, and that's precisely because Wine wants to preserve case, so that
>  > tools that look at the filesystem directly see the right thing. If you
>  > are going to store everything lowercase in the filesystem, then we could
>  > just as well do that inside Wine, without a FUSE module.
>  >
>
>  It seems like we have a few goals:
>
>  * Prevent having to read the whole directory when looking for a
>  case-insensitive file
>  * Allow non-Wine programs to work with the cased filenames
>  * Prevent the creation of conflicting files

We could do this for the drive_c directory but what about /? you
cannot enforce that there. Maybe this part project should be divided
into two different problems. 1. How to achieve that for drive_c, and
2. how to mount a proxy filesystem for / and apply some rules when
conflicting files exist, as keep the newest conflicting file with the
original name and rename other files like it was proposed on another
thread on this list.

>
>  The last one is important, as we need to have a 1:1 correspondence
>  between cased and uncased files in the .wine folder to prevent breakages
>  when someone, say, installs a patch with different casing from a zip file.
>
>  I don't see any reason why it would be bad to have the FUSE module
>  mounted at login rather than when Wine starts.  This would make your
>  Wine folder no different to other apps than, say, a vfat disk mounted
>  there.  I should be able to extract a zip with file-roller containing
>  "foo.txt" and have it overwrite "Foo.txt" even if Wine isn't running.
>
>  Thanks,
>  Scott Ritchie
>
>
>


From fgouget at free.fr  Wed Mar 26 18:36:55 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 27 Mar 2008 00:36:55 +0100 (CET)
Subject: Tests marked as todo are not displayed on the web results.
In-Reply-To: <3f4fd2640803190135icaac467q79f7bc3ee50e4c9f@mail.gmail.com>
References: <3f4fd2640803190135icaac467q79f7bc3ee50e4c9f@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0803270034530.759@amboise.dolphin>

On Wed, 19 Mar 2008, Reece Dunn wrote:
[...]
> For example, using the above, it results in:
> 
> gdiplus:graphicspath start dlls/gdiplus/tests/graphicspath.c 1.13
> graphicspath: 198 tests executed (5 marked as todo, 0 failures), 0 skipped.
> gdiplus:graphicspath done (0)
> 
> ...so does not tell me which of the 5 tests are todo and which are ok.
> 
> I haven't checked to see if this is also an issue with the `make test` output.

Yep, that's because make test does not print the todo tests.
Maybe they should be printed but with 'Test failed' replaced with 'Todo 
test' or something like that. Maybe it should depend on WINETEST_DEBUG.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
           If it stinks, it's chemistry. If it moves, it's biology.
                  If it does not work, It's computer science.


From fgouget at free.fr  Wed Mar 26 18:43:10 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 27 Mar 2008 00:43:10 +0100 (CET)
Subject: [RFC] Improving the summary results on test.winehq.org
In-Reply-To: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>
References: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0803270038150.759@amboise.dolphin>

On Wed, 19 Mar 2008, Reece Dunn wrote:

> Hi,
> 
> Looking at the results from a test run (e.g.
> http://test.winehq.org/data/200803181000/), it would be nice to have:
> 
>     1.  A summary of a dlls overall results (i.e. the summation of all
> its unit test results), preferably before the individual tests, but
> could live with them at the bottom.

I'm not sure this one is worth it. It would add quite a lot of lines 
too.


>     2.  A summary of the entire test results (i.e. the summation of
> all unit test results for all dlls). This would be best at the top
> where it is easily visible.

I've sent a patch doing just that, with the percentage of unit tests 
that have errors too.


>     3.  Possibly display the number of tests run in a given pass (e.g.
> 0/12 or 1+3/27). This is to give an idea of how many tests have been
> run easily (especially for the dll and overall summaries).

As mentioned before you get the number of individual checks that where 
run in the per-test tooltip. The 'statistics' patch also provides the 
total number of unit tests in a tooltip.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                            1 + e ^ ( i * pi ) = 0


From msclrhd at googlemail.com  Wed Mar 26 14:07:19 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 26 Mar 2008 19:07:19 +0000
Subject: dlls/user32/tests/cursoricon.c - test succeeded inside todo block
In-Reply-To: <558b2f5c0803261138r2b942d8eo139082ed394644d8@mail.gmail.com>
References: <558b2f5c0803261138r2b942d8eo139082ed394644d8@mail.gmail.com>
Message-ID: <3f4fd2640803261207q4daa953en5a7aaab2c91c8e69@mail.gmail.com>

On 26/03/2008, Lei Zhang <thestig at google.com> wrote:
> Anyone else seeing this?
>
>  ../../../tools/runtest -q -P wine -M user32.dll -T ../../.. -p
>  user32_test.exe.so cursoricon.c && touch cursoricon.ok
>  cursoricon.c:656: Test succeeded inside todo block: No hbmColor!
>  make: *** [cursoricon.ok] Error 1

http://test.winehq.org/data/200803211000/#group_Wine:user32:cursoricon

user32:cursoricon start dlls/user32/tests/cursoricon.c 1.11
cursoricon.c:655: Test succeeded inside todo block: yHotspot is 1.
cursoricon: 5 tests executed (2 marked as todo, 0 failures), 0 skipped.
cursoricon: 357 tests executed (10 marked as todo, 1 failure), 0 skipped.
user32:cursoricon done (1)

or

user32:cursoricon start dlls/user32/tests/cursoricon.c 1.11
cursoricon.c:655: Test succeeded inside todo block: yHotspot is 1.
cursoricon.c:656: Test succeeded inside todo block: No hbmColor!
cursoricon: 5 tests executed (2 marked as todo, 0 failures), 0 skipped.
cursoricon: 357 tests executed (9 marked as todo, 2 failures), 0 skipped.
user32:cursoricon done (2)

so yes.

- Reece


From austinenglish at gmail.com  Wed Mar 26 20:25:09 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 26 Mar 2008 20:25:09 -0500
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <e3d3ae8f0803261639t5a275fc6pc03bd0cdff071386@mail.gmail.com>
References: <20080325213351.GA3237@debbook.brain-dump.org>
	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
	<20080326165909.GA3213@debbook.brain-dump.org>
	<87iqz9s96v.fsf@wine.dyndns.org> <47EAD9A5.3050600@open-vote.org>
	<e3d3ae8f0803261639t5a275fc6pc03bd0cdff071386@mail.gmail.com>
Message-ID: <b6bb06270803261825p3870e195t9e8d6a4d4c8a6c47@mail.gmail.com>

On Wed, Mar 26, 2008 at 6:39 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
>  > Alexandre Julliard wrote:
>  >  > Yes, and that's precisely because Wine wants to preserve case, so that
>  >  > tools that look at the filesystem directly see the right thing. If you
>  >  > are going to store everything lowercase in the filesystem, then we could
>  >  > just as well do that inside Wine, without a FUSE module.
>
>  We could do this for the drive_c directory but what about /? you
>  cannot enforce that there. Maybe this part project should be divided
>  into two different problems. 1. How to achieve that for drive_c, and
>  2. how to mount a proxy filesystem for / and apply some rules when
>  conflicting files exist, as keep the newest conflicting file with the
>  original name and rename other files like it was proposed on another
>  thread on this list.

We could do this in wine itself for drive_c, which is where most of
the problem seems to lie (assuming no one links their program files to
a different mount point). Most performance issues/problem are with
patches or with installers searching for lots of files (within
drive_c). While it would be ideal to do this for the entire FS, doing
it  for drive_c should resolve most issues.


From scott at open-vote.org  Wed Mar 26 21:03:13 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Wed, 26 Mar 2008 19:03:13 -0700
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <b6bb06270803261825p3870e195t9e8d6a4d4c8a6c47@mail.gmail.com>
References: <20080325213351.GA3237@debbook.brain-dump.org>	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>	<20080326165909.GA3213@debbook.brain-dump.org>	<87iqz9s96v.fsf@wine.dyndns.org>
	<47EAD9A5.3050600@open-vote.org>	<e3d3ae8f0803261639t5a275fc6pc03bd0cdff071386@mail.gmail.com>
	<b6bb06270803261825p3870e195t9e8d6a4d4c8a6c47@mail.gmail.com>
Message-ID: <47EB0061.8070803@open-vote.org>

Austin English wrote:
> On Wed, Mar 26, 2008 at 6:39 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
>>  > Alexandre Julliard wrote:
>>  >  > Yes, and that's precisely because Wine wants to preserve case, so that
>>  >  > tools that look at the filesystem directly see the right thing. If you
>>  >  > are going to store everything lowercase in the filesystem, then we could
>>  >  > just as well do that inside Wine, without a FUSE module.
>>
>>  We could do this for the drive_c directory but what about /? you
>>  cannot enforce that there. Maybe this part project should be divided
>>  into two different problems. 1. How to achieve that for drive_c, and
>>  2. how to mount a proxy filesystem for / and apply some rules when
>>  conflicting files exist, as keep the newest conflicting file with the
>>  original name and rename other files like it was proposed on another
>>  thread on this list.
> 
> We could do this in wine itself for drive_c, which is where most of
> the problem seems to lie (assuming no one links their program files to
> a different mount point). Most performance issues/problem are with
> patches or with installers searching for lots of files (within
> drive_c). While it would be ideal to do this for the entire FS, doing
> it  for drive_c should resolve most issues.
> 

You're very right that doing this for just drive_c solves most issues
(as we can always fall back on Wine's existing behavior if we're outside
of C), however unless we have some Wine process always running there's
no way we can guarantee preserving the case integrity of drive_c just
inside Wine.

Thanks,
Scott Ritchie


From wine-devel at kievinfo.com  Wed Mar 26 21:22:25 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 26 Mar 2008 20:22:25 -0600
Subject: gdi32-related commit between 0.9.57<->0.9.58
	broken	.NET2/Systems.Windows.Forms
In-Reply-To: <137645.21992.qm@web23108.mail.ird.yahoo.com>
References: <137645.21992.qm@web23108.mail.ird.yahoo.com>
Message-ID: <47EB04E1.7020206@kievinfo.com>

Hin-Tak Leung wrote:
> --- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
> <snipped>
>>> If ukai is affected, I would suspect uming (also from
>> Arphic)
>>> would be the same? and how many non-english fonts one
>> want to 
>>> "work-around" like this?
>> I've not seen any problems with uming.  Most
>> 'non-english' fonts will
>> work fine.  There's something very specific about ukai
>> that causes
>> native gdiplis to have problems.
>>
>>>> Actually I've just attached a hack to the
>> bug, try that
>>>> instead.
>>> Thanks - but I also have uming, and a a fair number of
>> other fonts
>>> shipped from fedora for non-english. (over 100).
>> Please try the patch and report back.
> 
> Yes, your patch works alright - it is just ukai and nothing else. I'll put it on the bug report as well. Ukai (or rather, the original Arphic kai font) was the first
> commercial quality chinese font released under an open license, so you are going to
> have a lot of people - 20% of the world is Chinese, and also linux is rather more officially popular in China due to licensing/cost/idealological reasons and some
> non-chinese will install "everything" - being affected by this. I don't know if it 
> is ukai-specific or any Arphic kai derivatives, but if it affects any Arphic kai derivatives, filtering by font name as your patch did won't be effective. 
>  
Looks like a time to start blacklisting fonts then. If the font is invalid 
and does not work even on windows yet it is available in the system - that's 
the only thing Wine can do. Or just contact all distros to remove it. Or 
request packagers to refuse installing Wine if said font found in the system.

Vitaliy.


From wine-devel at kievinfo.com  Wed Mar 26 21:26:18 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 26 Mar 2008 20:26:18 -0600
Subject: [PATCH 1/2] user32: Properly translate keyboard left/right-shift, 
	alt, ctrl keys hardware messages.
In-Reply-To: <47E199CB.508@kievinfo.com>
References: <47E199CB.508@kievinfo.com>
Message-ID: <47EB05CA.6050200@kievinfo.com>

Vitaliy Margolen wrote:
> ---
>  dlls/user32/message.c |   15 +++++++++++++++
>  1 files changed, 15 insertions(+), 0 deletions(-)
> 
> 
> [PATCH 2/2] winex11drv: Distinguish left and right keys for shift, ctrl and alt. (try 5)

Alexandre, what was wrong with these patches? I moved the remapping of 
messages as you suggested.

Vitaliy.


From dank at kegel.com  Wed Mar 26 22:37:12 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 26 Mar 2008 20:37:12 -0700
Subject: Wine 1.0 status: T minus 72 days. 74 open bugs.
Message-ID: <a71bd89a0803262037o5b6e2477r9ce71e492f34d5c7@mail.gmail.com>

44 days to code freeze.

Four bugs fixed in the last two days:

9104   comdlg32      2       Pdf-xchange viewer crashes
10040  crypt32         2       Steam crashes during the startup
10111  comctl32      2       WINEDEBUG=warn+heap "make test" has heap
error in comdlg32/tests/printdlg.c
11884  winex11.       1       Copy and paste garbage on end

History:
3/22: 87 bugs, 76 days to go
3/23: 82 bugs, 75 days to go
3/24: 78 bugs, 74 days to go
3/26: 74 bugs, 72 days to go

Here's a list of the currently open 1.0 bugs, sorted by component, with votes:
5948	-unknown  	1  	Star Trek: Armada does not install
4971 	-unknown 	3 	Corel Draw 12 demo install fails
5024 	-unknown 	4 	Thief: Deadly Shadows crashes:page fault on read
access to 0x0000040c
5055 	-unknown 	5 	Deleting files from a window in wine doesn't send
them to the Trash
5061 	-unknown 	6 	Copying from Windows Firefox in Wine and pasting to
Linux OpenOffice pastes metadata as data
5402 	-unknown 	0 	Trying to run PhotoStitch 3.1
5844 	-unknown 	10 	tray minimize
7404 	-unknown 	2 	ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
7477 	-unknown 	1 	Uplink demo crashes
8125 	-unknown 	0 	Marratech 6.1 crashes on start
9178 	-unknown 	7 	"hello world" dos program hangs
9459 	-unknown 	8 	FIFA 2007 crashes with the recent versions
9916 	-unknown 	6 	"make test" usually fails
9959 	-unknown 	8 	Make wine updates work even if the registry changed
10147 	-unknown 	1 	Word Viewer 2003 - Tab behavior differs from Windows
10815 	-unknown 	2 	Cannot drag images into Adobe Photoshop 7 from the
web / desktop
11281 	-unknown 	2 	CJK input many issues
12097 	-unknown 	2 	Wine 1.0 should not ship out-of-sync resource translations
556 	build-en 	2 	Reconcile the Windows and Wine spec files
1114 	comctl32 	2 	Winrar2.90/3.00: Comboex doesn't trigger a event
when you mouse-click in some value of it
2493 	comctl32 	2 	Multi-select listview: Shift-arrow up only selects
top two items
5955 	directx- 	7 	DirectDrawCreate crash on non-OpenGL desktop
9030 	directx- 	0 	army men hangs on black screen
11681 	directx- 	14 	Add support for video overlay
82 	document 	2 	Stabilize Winelib User Guide Table of Contents
638 	document 	8 	Document Wine debugging channels
12217 	document 	0 	Documentation should be in XML and not SGML format
3270 	gdi32 	14 	Problem with minimized top-level windows
6519 	gdi32 	7 	Wine blacks out rotated font bitmap
7571 	gdi32 	1 	Accented character glyphs are mixed up with TrueType
fonts (affects e.g. Lotus Notes R5)
9771 	gdi32 	38 	Steam Friends doesn't work (fails to render correctly
or refresh)
9926 	gdi32 	5 	gdi32.dll should not have exported function pointers
4733 	kernel32 	5 	Get optimized/compressed/packed executables (non-upx) working
5351 	kernel32 	9 	Windows Installer 3.1 cannot install because of
non-standard drive labeling
5541 	kernel32 	0 	WriteConsole can't write to stdout; affects e.g.
wsh's cscript's usage message
9039 	kernel32 	0 	GS-Auftrag Professional SQL aborts on startup
9484 	kernel32 	17 	Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
7098 	mscoree 	1 	RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
5163 	msi 	12 	Office XP 2002 crashes on installation
8783 	ntdll 	11 	USB serial ports do not work
9356 	ntdll 	6 	Serial communication not working since wine-0.9.33
2539 	ole 	3 	XDND (Drag and drop for X Windows) doesn't copy text
4770 	ole 	3 	BlackBerry Device Manager fails to install under wine
6607 	ole 	8 	Drag and Drop not working
8095 	ole 	0 	PQ Teaching toy crashes
9942 	ole 	2 	Powerpoint Viewer 2007 crashes opening .pptx files
5926 	programs 	0 	Wine does not provide an implementation of winhlp32.exe
6254 	richedit 	4 	Installer infinite loop from rich text error
3546 	shdocvw 	2 	CLSID_InternetShortcut not available...
6095 	shdocvw 	12 	MOTD in counter-strike 1.6 and counter-strike
source does not render
8898 	shdocvw 	0 	Run Time Error "445": Object doesn't support this
action in Europa Knowledgebase
9304 	shdocvw 	3 	Temple of Elemental Evil demo doesn't start - gui irresponsive
8439 	shell32 	7 	Visual Studio .NET (7) install fails
9809 	shell32 	4 	Autodesk Revit Architecture 2008 install fails
10905 	shell32 	0 	thinstall firefox demo requires native msvcrt
11742 	shlwapi 	8 	Small .net 1.1 app (FastMD5 1.3) fails to start up
12074 	testcase 	2 	The conformance tests fail on Windows
6604 	tools 	2 	Ship icons for the wine-tools that can be used in .desktop files
8246 	urlmon 	3 	invoking htmlhelp:HtmlHelpW crashes wine
664 	user32 	6 	The help menu functionality inside programs is broken
(messaging problem)
3023 	user32 	5 	Orcad - "Place Part" never tries to put down a part
4523 	user32 	5 	Can't copy from Firefox 1.5 and paste into OpenOffice
2 under Wine
124 	wineserv 	2 	Review of Wine Server Protocol
1990 	winex11. 	1 	modifier keys not released when switching desktop
2368 	winex11. 	6 	Wine loses its X-Window when switching to another
virt. desktop in Fvwm
3297 	winex11. 	12 	UpdateWindow() doesn't call XFlush()
5623 	winex11. 	3 	GetAsyncKeyState wrong if querying process doesn't have focus
5828 	winex11. 	24 	Command and Conquer Generals (Zero Hour) doesn't
change the mouse cursor from the default X mouse
7372 	winex11. 	12 	can't copy and paste between gnome apps eg
openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
10984 	winex11. 	4 	sun jre 5 update 10 installer hangs in 0.9.52
11019 	winex11. 	2 	matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
3711 	wininet 	1 	Musicmatch fails to install (missing registry key,
HTTP_HttpOpenRequest() problem)
5625 	wininet 	3 	Wine does not handle internet proxy settings conveniently
9787 	winsock 	46 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
12005 	wintab32 	0 	Regression in pressure sensitivity with wizardpen
tablet driver and Photoshop 7


From dmitry at codeweavers.com  Wed Mar 26 23:13:32 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 12:13:32 +0800
Subject: gdi32-related commit between
	0.9.57<->0.9.58broken	.NET2/Systems.Windows.Forms
References: <137645.21992.qm@web23108.mail.ird.yahoo.com>
	<47EB04E1.7020206@kievinfo.com>
Message-ID: <015b01c88fc0$edbdc970$a600fea9@DMITRY>

"Vitaliy Margolen" <wine-devel at kievinfo.com> wrote:

> Looks like a time to start blacklisting fonts then. If the font is invalid 
> and does not work even on windows yet it is available in the system - that's 
> the only thing Wine can do. Or just contact all distros to remove it. Or 
> request packagers to refuse installing Wine if said font found in the system.

Black listing the fonts is not an appropriate fix/workaround. There is
already a fixed version of ukai.ttf, and a broken one was causing problems
in a lot of native programs besides Wine.

-- 
Dmitry.


From iammisc at gmail.com  Thu Mar 27 00:43:32 2008
From: iammisc at gmail.com (Travis Athougies)
Date: Wed, 26 Mar 2008 22:43:32 -0700
Subject: Contributing
Message-ID: <91fef9720803262243r6ee697fk93cdda05572cc8b2@mail.gmail.com>

Hi,

I would like to help contribute to WINE because I use it so much yet
I've never actually contributed to it. I was wondering if there are
any simple bugs or other tasks that someone new to WINE development
could undertake.

Thanks.

-- 
From: Travis Athougies
2 + 2 = 4


From mat at brain-dump.org  Thu Mar 27 02:42:24 2008
From: mat at brain-dump.org (Marc Andre Tanner)
Date: Thu, 27 Mar 2008 08:42:24 +0100
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <47EAD9A5.3050600@open-vote.org>
References: <20080325213351.GA3237@debbook.brain-dump.org>
	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
	<20080326165909.GA3213@debbook.brain-dump.org>
	<87iqz9s96v.fsf@wine.dyndns.org> <47EAD9A5.3050600@open-vote.org>
Message-ID: <20080327074224.GA1829@debbook.brain-dump.org>

On Wed, Mar 26, 2008 at 04:17:57PM -0700, Scott Ritchie wrote:
> Alexandre Julliard wrote:
> > Marc Andre Tanner <mat at brain-dump.org> writes:
> > 
> >> Yes that's true the case information is lost but is it really needed? 
> >> If you create the files with the original mixed case you will have to
> >> scan the whole directory in order to match it to a given filename. 
> >> And if i am not mistaken this is exactly what wine does. 
> > 
> > Yes, and that's precisely because Wine wants to preserve case, so that
> > tools that look at the filesystem directly see the right thing. If you
> > are going to store everything lowercase in the filesystem, then we could
> > just as well do that inside Wine, without a FUSE module.
> > 
> 
> It seems like we have a few goals:
> 
> * Prevent having to read the whole directory when looking for a
> case-insensitive file

So what are the different method's to achieve this? Apart from
translating every thing to lower case which i did.

> * Allow non-Wine programs to work with the cased filenames
> * Prevent the creation of conflicting files

With my proposal it basically works as long as your accessing the files
via the mount point of the fuse filesystem, however when you start messing
around with the underlying directory directly things may go wrong.

> The last one is important, as we need to have a 1:1 correspondence
> between cased and uncased files in the .wine folder to prevent breakages
> when someone, say, installs a patch with different casing from a zip file.
> 
> I don't see any reason why it would be bad to have the FUSE module
> mounted at login rather than when Wine starts.  This would make your
> Wine folder no different to other apps than, say, a vfat disk mounted
> there.  I should be able to extract a zip with file-roller containing
> "foo.txt" and have it overwrite "Foo.txt" even if Wine isn't running.

Again this will work if you do it via the mountpoint:

  mkdir -p ~/ciopfs/{data,mountpoint} && cd ~/ciopfs
  ciopfs -d data mountpoint
  echo Testdata > mountpoint/Foo.txt

at this point your directories should look like this:
 
 |-- data
 |   `-- foo.txt
 `-- mountpoint
     `-- Foo.txt

and 'getfattr -dR data' should show the original file name of foo.txt:

 # file: data/foo.txt
 user.filename="Foo.txt"

now you extract your archive in mountpoint and should get:

 |-- data
 |   `-- foo.txt
 `-- mountpoint
     `-- foo.txt

What i am trying to say is that as long as you interact with your data
via mountpoint everything is fine.

When you start creating files directly in data which are not all
lowercase they will currently simply be ignored.

So the question is whether it is acceptable to say: don't touch data
directly do everything via mountpoint? 

Regards,
Marc

-- 
 Marc Andre Tanner >< http://www.brain-dump.org/ >< GPG key: CF7D56C0


From julliard at winehq.org  Thu Mar 27 05:31:09 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 27 Mar 2008 11:31:09 +0100
Subject: [3/5] D3D8: Reject broken normal declaration types with fixed
	function
In-Reply-To: <200803262023.25735.stefan@codeweavers.com> ("Stefan
	=?utf-8?Q?D=C3=B6singer=22's?=
	message of "Wed, 26 Mar 2008 20:23:25 +0100")
References: <200803262023.25735.stefan@codeweavers.com>
Message-ID: <877ifosbki.fsf@wine.dyndns.org>

Stefan D?singer <stefan at codeweavers.com> writes:

> From d9182d3da1416e0bfa06b1fe879c4c74c66b0c3e Mon Sep 17 00:00:00 2001
> From: Stefan Doesinger <stefan at codeweavers.com>
> Date: Wed, 12 Mar 2008 01:06:38 +0100
> Subject: [PATCH] D3D8: Reject broken normal declaration types with fixed function

This doesn't work for me:

../../../tools/runtest -q -P wine -M d3d8.dll -T ../../.. -p d3d8_test.exe.so visual.c && touch visual.ok
visual.c:1184: Test failed: IDirect3DDevice8_CreateVertexShader returned with 0x8876086c
make[2]: *** [visual.ok] Error 1

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Mar 27 05:34:04 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 27 Mar 2008 11:34:04 +0100
Subject: [PATCH] user32: add a DrawText test for bug 12226.
In-Reply-To: <558b2f5c0803261524s12a6a911u6988cccf0c634855@mail.gmail.com>
	(Lei Zhang's message of "Wed, 26 Mar 2008 15:24:35 -0700")
References: <558b2f5c0803261524s12a6a911u6988cccf0c634855@mail.gmail.com>
Message-ID: <873aqcsbfn.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> +static void test_Bug12226(void)
> +{

Please name functions according to what they do, not their bug
number. The code must be understandable without having to look things up
in bugzilla. In any case this should most likely go into the existing
test_DrawTextCalcRect() function.

> +    height = DrawTextA(hdc, "", -1, &rect,
> +                       DT_CALCRECT | DT_LEFT | DT_SINGLELINE);
> +    todo_wine ok(16 == height, "expected %d, got %d\n", 16, height);

I don't think you can hardcode 16, that should depend on the font
metrics.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Mar 27 05:52:40 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 27 Mar 2008 11:52:40 +0100
Subject: widl: Use is_string_type for detecting strings in
	write_typeformatstring_var to make it consistent with
	write_remoting_arg.
In-Reply-To: <47EA53E3.10200@codeweavers.com> (Robert Shearman's message of
	"Wed, 26 Mar 2008 13:47:15 +0000")
References: <47EA53E3.10200@codeweavers.com>
Message-ID: <87y784qw07.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> Fix the is_string_type function used for detecting strings by only
> examining aliases instead of both aliases and pointers. This is due to
> the requirement that pointers to strings be handled as pointers and so
> not detected as strings.

This breaks qmgr:

../../../tools/runtest -q -P wine -M qmgr.dll -T ../../.. -p qmgr_test.exe.so file.c && touch file.ok
file.c:127: Test failed: Got incorrect remote name
file.c:144: Test failed: Got incorrect local name
make: *** [file.ok] Error 2

-- 
Alexandre Julliard
julliard at winehq.org


From scott at open-vote.org  Thu Mar 27 05:59:54 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Thu, 27 Mar 2008 03:59:54 -0700
Subject: GSOC proposal - control panel
In-Reply-To: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
References: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
Message-ID: <47EB7E2A.10302@open-vote.org>

Owen Rudge wrote:
> The examples given on the GSOC wiki 
> pages (basic desktop/screen resizing, general network information, and font 
> details) would be good applets for me to implement, but I would also be 
> interested in working on some other applets, such as an Add/Remove Programs 
> applet, or a Multimedia applet. 

What I and the other Ubuntu UI people would really like to see is the
ability to uninstall Wine programs from within gnome-app-install (The
Gnome applet the user interacts with after selecting
Applications->Add/Remove).

The UI is a fairly intuitive step - just add a "Windows Applications"
category and list the installed Wine apps on the right.  Once that's
done, we don't need a special Wine program for uninstalling anymore,
since we can expand the functionality in a similar place where the user
could reasonably expects to find it.

As for what you'll need to do this done, uninstalling applications from
the command line isn't yet supported, though I believe someone else is
working on that through reg.exe.

Thanks,
Scott Ritchie


From chris.kcat at gmail.com  Thu Mar 27 06:15:42 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Thu, 27 Mar 2008 04:15:42 -0700
Subject: GSOC proposal - control panel
In-Reply-To: <47EB7E2A.10302@open-vote.org>
References: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
	<47EB7E2A.10302@open-vote.org>
Message-ID: <200803270415.43052.chris.kcat@gmail.com>

On Thursday 27 March 2008 03:59:54 am Scott Ritchie wrote:
> The UI is a fairly intuitive step - just add a "Windows Applications"
> category and list the installed Wine apps on the right.  Once that's
> done, we don't need a special Wine program for uninstalling anymore,
> since we can expand the functionality in a similar place where the user
> could reasonably expects to find it.
>
> As for what you'll need to do this done, uninstalling applications from
> the command line isn't yet supported, though I believe someone else is
> working on that through reg.exe.

Uninstallable Windows apps are listed in the registry at 
HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\*, and they contain 
the description of the app, as well as the command to uninstall it. Couldn't 
you use something like reg.exe (after it's implemented enough) to parse those 
registry keys and list the apps, and when the user asks to uninstall it, 
run "wine <uninstall string>"? No need for the control panel or applets at 
all.


From leslie_alistair at hotmail.com  Thu Mar 27 06:43:27 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Thu, 27 Mar 2008 22:43:27 +1100
Subject: midl question
Message-ID: <fsg18l$7c2$1@ger.gmane.org>

Hi,
  
In an IDL file I need to define the following
typedef HRESULT (__stdcall *FExecuteInAppDomainCallback) (void* cookie);

How do i get midl to understand what __stdcall is defined to?

Best Regards

Alistair Leslie-Hughes




From paul.vriens.wine at gmail.com  Thu Mar 27 07:06:32 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 27 Mar 2008 13:06:32 +0100
Subject: setupapi: Implement pSetupGetField, with tests.
Message-ID: <47EB8DC8.4030708@gmail.com>

Hi James,

I'm looking into a crash of the setupapi/parser test on Vista.

It crashes in this piece:

  465         ret = HeapFree( GetProcessHeap(), 0, (LPVOID)field );
  466         ok( !ret, "Expected HeapFree to fail\n" );
  467         ok( GetLastError() == ERROR_INVALID_PARAMETER,
  468             "Expected ERROR_INVALID_PARAMETER, got %u\n", GetLastError() );

when trying the second field.

It's been added by a patch of yours:

http://source.winehq.org/git/wine.git/?a=commit;h=7588b669d8331ff64fc3b75cebe40ef518cd0de1

What's the reason for checking the HeapFree here? Or what's the reason for doing 
it at all?

-- 
Cheers,

Paul.


From leslie_alistair at hotmail.com  Thu Mar 27 07:21:24 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Thu, 27 Mar 2008 23:21:24 +1100
Subject: midl question
In-Reply-To: <039601c89000$c66e8270$a600fea9@DMITRY>
References: <fsg18l$7c2$1@ger.gmane.org>
	<039601c89000$c66e8270$a600fea9@DMITRY>
Message-ID: <BAY117-W404160B8BD9054E0971F7693FE0@phx.gbl>





> From: dmitry at codeweavers.com> To: leslie_alistair at hotmail.com> CC: wine-devel at winehq.org> Subject: Re: midl question> Date: Thu, 27 Mar 2008 19:50:34 +0800> > "Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote:> > > In an IDL file I need to define the following> > typedef HRESULT (__stdcall *FExecuteInAppDomainCallback) (void* cookie);> > > > How do i get midl to understand what __stdcall is defined to?> > indexsrv.idl does:> > cpp_quote("struct tagTEXT_SOURCE;")> cpp_quote("typedef HRESULT (WINAPI *PFNFILLTEXTBUFFER)(struct tagTEXT_SOURCE *pTextSource);") Hi Dmitry,
  This isnt going to work for me.  Here is more information that I should of included in the first email.
interface ICLRRuntimeHost : IUnknown
...
HRESULT ExecuteInAppDomain([in] DWORD dwAppDomainId,                               [in] FExecuteInAppDomainCallback pCallback,                               [in] void* cookie);
...
So FExecuteInAppDomainCallback has to be defined or I will get compile errors.
 
Best Regards
 Alistair Leslie-Hughes
_________________________________________________________________
Are you paid what you're worth? Find out: SEEK Salary Centre
http://a.ninemsn.com.au/b.aspx?URL=http%3A%2F%2Fninemsn%2Eseek%2Ecom%2Eau%2Fcareer%2Dresources%2Fsalary%2Dcentre%2F%3Ftracking%3Dsk%3Ahet%3Asc%3Anine%3A0%3Ahot%3Atext&_t=764565661&_r=OCT07_endtext_salary&_m=EXT
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080327/e535a3b7/attachment.htm 

From rob at codeweavers.com  Thu Mar 27 07:42:54 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 27 Mar 2008 12:42:54 +0000
Subject: midl question
In-Reply-To: <fsg18l$7c2$1@ger.gmane.org>
References: <fsg18l$7c2$1@ger.gmane.org>
Message-ID: <47EB964E.7070101@codeweavers.com>

Alistair Leslie-Hughes wrote:
> Hi,
>   
> In an IDL file I need to define the following
> typedef HRESULT (__stdcall *FExecuteInAppDomainCallback) (void* cookie);
>
> How do i get midl to understand what __stdcall is defined to?

midl or widl? AFAIK midl supports the __stdcall keyword.


-- 
Rob Shearman



From leslie_alistair at hotmail.com  Thu Mar 27 07:48:37 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Thu, 27 Mar 2008 23:48:37 +1100
Subject: midl question
In-Reply-To: <47EB964E.7070101@codeweavers.com>
References: <fsg18l$7c2$1@ger.gmane.org> <47EB964E.7070101@codeweavers.com>
Message-ID: <BAY117-W391ACAA1FD9E0601C7A57293FE0@phx.gbl>



> Date: Thu, 27 Mar 2008 12:42:54 +0000> From: rob at codeweavers.com> To: leslie_alistair at hotmail.com> CC: wine-devel at winehq.org> Subject: Re: midl question> > Alistair Leslie-Hughes wrote:> > Hi,> > > > In an IDL file I need to define the following> > typedef HRESULT (__stdcall *FExecuteInAppDomainCallback) (void* cookie);> >> > How do i get midl to understand what __stdcall is defined to?> > midl or widl? AFAIK midl supports the __stdcall keyword.> Hi Rob,
 
widl.
 
Best Regards
 Alistair Leslie-Hughes
_________________________________________________________________
Are you paid what you're worth? Find out: SEEK Salary Centre
http://a.ninemsn.com.au/b.aspx?URL=http%3A%2F%2Fninemsn%2Eseek%2Ecom%2Eau%2Fcareer%2Dresources%2Fsalary%2Dcentre%2F%3Ftracking%3Dsk%3Ahet%3Asc%3Anine%3A0%3Ahot%3Atext&_t=764565661&_r=OCT07_endtext_salary&_m=EXT
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080327/06f0e4d2/attachment.htm 

From dmitry at codeweavers.com  Thu Mar 27 08:24:52 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 21:24:52 +0800
Subject: [1/2] Added a test: registering device interface and getting
	devicepath
References: <200803271422.57559.amorozov@etersoft.ru>
Message-ID: <049a01c8900d$f20ad570$a600fea9@DMITRY>

"Alexander Morozov" <amorozov at etersoft.ru> wrote:

> Changelog:
> Added a test for setupapi: registering device interface and getting device 
> path

Please consistently print GetLastError() values as %u (not %08x or %d),
otherwise the test looks good to me.


-- 
Dmitry.


From dmitry at codeweavers.com  Thu Mar 27 06:50:34 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 19:50:34 +0800
Subject: midl question
References: <fsg18l$7c2$1@ger.gmane.org>
Message-ID: <039601c89000$c66e8270$a600fea9@DMITRY>

"Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote:

> In an IDL file I need to define the following
> typedef HRESULT (__stdcall *FExecuteInAppDomainCallback) (void* cookie);
> 
> How do i get midl to understand what __stdcall is defined to?

indexsrv.idl does:

cpp_quote("struct tagTEXT_SOURCE;")
cpp_quote("typedef HRESULT (WINAPI *PFNFILLTEXTBUFFER)(struct tagTEXT_SOURCE *pTextSource);")

-- 
Dmitry.


From rob at codeweavers.com  Thu Mar 27 07:15:22 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 27 Mar 2008 12:15:22 +0000
Subject: widl: Use is_string_type for detecting strings in
	write_typeformatstring_var
	to make it consistent with write_remoting_arg.
In-Reply-To: <87y784qw07.fsf@wine.dyndns.org>
References: <47EA53E3.10200@codeweavers.com> <87y784qw07.fsf@wine.dyndns.org>
Message-ID: <47EB8FDA.7080806@codeweavers.com>

Alexandre Julliard wrote:
> Robert Shearman <rob at codeweavers.com> writes:
>
>   
>> Fix the is_string_type function used for detecting strings by only
>> examining aliases instead of both aliases and pointers. This is due to
>> the requirement that pointers to strings be handled as pointers and so
>> not detected as strings.
>>     
>
> This breaks qmgr:
>
> ../../../tools/runtest -q -P wine -M qmgr.dll -T ../../.. -p qmgr_test.exe.so file.c && touch file.ok
> file.c:127: Test failed: Got incorrect remote name
> file.c:144: Test failed: Got incorrect local name
> make: *** [file.ok] Error 2

Thanks, there was a typo in the patch. I'll resend it with the typo fixed.

I believe the patches titled "widl: Support using context handles as the 
binding handle in client functions." and "widl: Add support for generic 
binding handles." will still apply without this patch being committed first.

-- 
Rob Shearman



From dmitry at codeweavers.com  Thu Mar 27 08:27:57 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 21:27:57 +0800
Subject: [2/2] Setupapi patch
References: <200803271423.08655.amorozov@etersoft.ru>
Message-ID: <04a501c8900e$61142070$a600fea9@DMITRY>

"Alexander Morozov" <amorozov at etersoft.ru> wrote:

> +    if (ReferenceString && lstrlenW(ReferenceString))
>      {
>          /* space for a hash between string and reference string: */
>          len += lstrlenW(ReferenceString) + 1;
> @@ -258,10 +258,10 @@ static LPWSTR SETUPDI_CreateSymbolicLink
>          /* replace '\\' with '#' after the "\\\\?\\" beginning */
>          for (ptr = strchrW(ret + 4, '\\'); ptr; ptr = strchrW(ptr + 1, '\\'))
>              *ptr = '#';
> -        if (ReferenceString)
> +        if (ReferenceString && lstrlenW(ReferenceString))

Calling lstrlenW on ReferenceString is not needed, checking *ReferenceString
is enough.

-- 
Dmitry.


From paul.vriens.wine at gmail.com  Thu Mar 27 08:44:41 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 27 Mar 2008 14:44:41 +0100
Subject: [Tools 3/6] winetest: Fix merging of the individual test results
	into one group result,
	especially when they all report the dll is missing
	or that the test crashed, etc.
In-Reply-To: <alpine.DEB.1.00.0803262335490.10184@amboise.dolphin>
References: <alpine.DEB.1.00.0803262335490.10184@amboise.dolphin>
Message-ID: <47EBA4C9.9020207@gmail.com>

Francois Gouget wrote:
> Merge all the data for a given unit test to a single structure instead of scattering them into multiple hashtables.
> The new result data structure makes it possible for the same code to work for both group and individual report results.
> ---
> 
> This fixes the many '.' found in the summary table.
> 
>  winetest/gather |  333 ++++++++++++++++++++++++++++++++++---------------------
>  1 files changed, 204 insertions(+), 129 deletions(-)
> 
> diff --git a/winetest/gather b/winetest/gather
> index d032e23..881134a 100755
> --- a/winetest/gather
> +++ b/winetest/gather
> @@ -37,32 +37,45 @@ $name0 =~ s+^.*/++;
>  my $summary_version=4;
>  
>  
....
>  
> +sub min_to_max($)
> +{
> +    my ($minmax)=@_;
> +    return $minmax->[0] if ($minmax->[0] == $minmax->[1]);
> +    return "$minmax->[0] to $minmax->[1]";
> +}
> +

Don't we need quotes around "x to y"? Firebug complains about this.

> +        my $mm_count=min_to_max($result->{count});
> +        my $mm_errors=min_to_max($result->{errors});
> +        my $mm_todos=min_to_max($result->{todos});
> +        my $mm_skips=min_to_max($result->{skips});
> +        my $title="$mm_count tests, $mm_errors errors, $mm_todos todos, $mm_skips skips";

Or put the quotes here of course.

The results of your latest patches can be seen at:

http://test.winehq.org/data/200803191000/

-- 
Cheers,

Paul.


From dmitry at codeweavers.com  Thu Mar 27 09:09:19 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 22:09:19 +0800
Subject: [1/2] Added a test: registering device interface and getting
	devicepath
References: <200803271422.57559.amorozov@etersoft.ru>
	<049a01c8900d$f20ad570$a600fea9@DMITRY>
	<200803271655.16334.amorozov@etersoft.ru>
Message-ID: <050c01c89014$27a74b40$a600fea9@DMITRY>

"Alexander Morozov" <amorozov at etersoft.ru> wrote:

> > Please consistently print GetLastError() values as %u (not %08x or %d),
> > otherwise the test looks good to me.
> 
> Edit every test in tests/devinst.c or only testRegisterAndGetDetail?

My comment was about newly added code. If there are other places, then
they should be fixed as well, but in a separate patch.

-- 
Dmitry.


From pure_evil at mail.bg  Thu Mar 27 09:21:06 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Thu, 27 Mar 2008 16:21:06 +0200
Subject: GSOC proposal - control panel
Message-ID: <200803271621.06760.pure_evil@mail.bg>

No dice.
CPls are DLLs that export a function - CPlApplet(). 
winegcc coughs on dllexport. - not implemented.
I've been hacking at it for days on end now. 
Result: CPl can be compiled under windows and run under wine. CPls compiled 
with winegcc don't export that function => not treated as control panel 
applets.
software to aid anyone: dllexp.exe. Download and run on any dll/cpl of 
windows, you get exports in it; run on wine dlls - nada. (hence, No Template 
in wine's source. Twain DLL exports some methods though.)

MICROSOFT ISSUE: EASY TO DISTINGUISH BETWEEN WINE DLLS AND WINDOWS DLLS. 

If dllexp.exe can do it, so can they. Solution: M$ implements a code that 
*checks for a dll version* (based on what the DLL exports). Doesn't find 
export => coughs and dies with an "Incompatible DLL version". Happened before 
with OS2 / Windows. Maybe has happened now with all M$ that cough on wine.

Not enough intimate knowledge => can a soft cough and die based on a call to a 
DLL export which isn't there, without being designed to do so?


From paul.vriens.wine at gmail.com  Thu Mar 27 09:19:11 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 27 Mar 2008 15:19:11 +0100
Subject: [1/2] Added a test: registering device interface and getting
	devicepath
In-Reply-To: <050c01c89014$27a74b40$a600fea9@DMITRY>
References: <200803271422.57559.amorozov@etersoft.ru>	<049a01c8900d$f20ad570$a600fea9@DMITRY>	<200803271655.16334.amorozov@etersoft.ru>
	<050c01c89014$27a74b40$a600fea9@DMITRY>
Message-ID: <47EBACDF.8040309@gmail.com>

Dmitry Timoshkov wrote:
> "Alexander Morozov" <amorozov at etersoft.ru> wrote:
> 
>>> Please consistently print GetLastError() values as %u (not %08x or %d),
>>> otherwise the test looks good to me.
>> Edit every test in tests/devinst.c or only testRegisterAndGetDetail?
> 
> My comment was about newly added code. If there are other places, then
> they should be fixed as well, but in a separate patch.
> 

Is this just for this file or do you generally want %u instead of %d/%08x ?

-- 
Cheers,

Paul.


From fgouget at free.fr  Thu Mar 27 09:27:19 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 27 Mar 2008 15:27:19 +0100 (CET)
Subject: [Tools 3/6] winetest: Fix merging of the individual test results
	into one group result,
	especially when they all report the dll is missing
	or that the test crashed, etc.
In-Reply-To: <47EBA4C9.9020207@gmail.com>
References: <alpine.DEB.1.00.0803262335490.10184@amboise.dolphin>
	<47EBA4C9.9020207@gmail.com>
Message-ID: <alpine.DEB.1.00.0803271526270.19839@amboise.dolphin>

On Thu, 27 Mar 2008, Paul Vriens wrote:
[...]
> >  +sub min_to_max($)
> > +{
> > +    my ($minmax)=@_;
> > +    return $minmax->[0] if ($minmax->[0] == $minmax->[1]);
> > +    return "$minmax->[0] to $minmax->[1]";
> > +}
> > +
> 
> Don't we need quotes around "x to y"? Firebug complains about this.

Ah, I see, I forgot to put quotes for the refresh() parameters.
I'll send a patch.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
The nice thing about meditation is that it makes doing nothing quite respectable
                                  -- Paul Dean


From paul.vriens.wine at gmail.com  Thu Mar 27 09:30:34 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 27 Mar 2008 15:30:34 +0100
Subject: [1/2] Added a test: registering device interface and getting
	devicepath
In-Reply-To: <47EBACDF.8040309@gmail.com>
References: <200803271422.57559.amorozov@etersoft.ru>	<049a01c8900d$f20ad570$a600fea9@DMITRY>	<200803271655.16334.amorozov@etersoft.ru>
	<050c01c89014$27a74b40$a600fea9@DMITRY>
	<47EBACDF.8040309@gmail.com>
Message-ID: <47EBAF8A.1050302@gmail.com>

Paul Vriens wrote:
> Dmitry Timoshkov wrote:
>> "Alexander Morozov" <amorozov at etersoft.ru> wrote:
>>
>>>> Please consistently print GetLastError() values as %u (not %08x or %d),
>>>> otherwise the test looks good to me.
>>> Edit every test in tests/devinst.c or only testRegisterAndGetDetail?
>>
>> My comment was about newly added code. If there are other places, then
>> they should be fixed as well, but in a separate patch.
>>
> 
> Is this just for this file or do you generally want %u instead of %d/%08x ?
> 

I'm just asking as for most of the setupapi errors %08x looks much better than 
%u (and is easier traceable in the setupapi.h include file).

For example:

#define ERROR_INVALID_MACHINENAME 
(APPLICATION_ERROR_MASK|ERROR_SEVERITY_ERROR|0x220)

%u : 3758096928
%08x : e0000220

-- 
Cheers,

Paul.


From dmitry at codeweavers.com  Thu Mar 27 09:31:48 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 22:31:48 +0800
Subject: [1/2] Added a test: registering device interface and
	gettingdevicepath
References: <200803271422.57559.amorozov@etersoft.ru>	<049a01c8900d$f20ad570$a600fea9@DMITRY>	<200803271655.16334.amorozov@etersoft.ru><050c01c89014$27a74b40$a600fea9@DMITRY>
	<47EBACDF.8040309@gmail.com>
Message-ID: <054e01c89017$4d258050$a600fea9@DMITRY>

"Paul Vriens" <paul.vriens.wine at gmail.com> wrote:

> Is this just for this file or do you generally want %u instead of %d/%08x ?

GetLastError() returns an unsigned value, and winerror.h lists error values
in decimal (if anyone really wants to match a trace with a symbolic name).

-- 
Dmitry.


From rob at codeweavers.com  Thu Mar 27 09:53:36 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 27 Mar 2008 14:53:36 +0000
Subject: GSOC proposal - control panel
In-Reply-To: <200803271621.06760.pure_evil@mail.bg>
References: <200803271621.06760.pure_evil@mail.bg>
Message-ID: <47EBB4F0.5050009@codeweavers.com>

pure_evil at mail.bg wrote:
> No dice.
> CPls are DLLs that export a function - CPlApplet(). 
> winegcc coughs on dllexport. - not implemented.
>   

__declspec(dllexport) is a MSVC-only feature. Hence, when compiling with 
gcc (even using winegcc) it won't actually export the function. As has 
been stated before, you need to use a .spec or .def file to export it.

> I've been hacking at it for days on end now. 
> Result: CPl can be compiled under windows and run under wine. CPls compiled 
> with winegcc don't export that function => not treated as control panel 
> applets.
> software to aid anyone: dllexp.exe. Download and run on any dll/cpl of 
> windows, you get exports in it; run on wine dlls - nada. (hence, No Template 
> in wine's source. Twain DLL exports some methods though.)
>
> MICROSOFT ISSUE: EASY TO DISTINGUISH BETWEEN WINE DLLS AND WINDOWS DLLS. 
>
> If dllexp.exe can do it, so can they. Solution: M$ implements a code that 
> *checks for a dll version* (based on what the DLL exports). Doesn't find 
> export => coughs and dies with an "Incompatible DLL version". Happened before 
> with OS2 / Windows. Maybe has happened now with all M$ that cough on wine.
>
> Not enough intimate knowledge => can a soft cough and die based on a call to a 
> DLL export which isn't there, without being designed to do so?

A DLL compiled as a winelib DLL won't be parsed by a tool that reads PE 
DLLs, because winelib DLLs are Elf shared objects. Use winedump instead.

-- 
Rob Shearman



From pure_evil at mail.bg  Thu Mar 27 10:03:48 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Thu, 27 Mar 2008 17:03:48 +0200
Subject: GSOC proposal - control panel
In-Reply-To: <47EBB4F0.5050009@codeweavers.com>
References: <200803271621.06760.pure_evil@mail.bg>
	<47EBB4F0.5050009@codeweavers.com>
Message-ID: <200803271703.48555.pure_evil@mail.bg>

> __declspec(dllexport) is a MSVC-only feature. Hence, when compiling with
> gcc (even using winegcc) it won't actually export the function. As has
> been stated before, you need to use a .spec or .def file to export it.

Yes. 

> A DLL compiled as a winelib DLL won't be parsed by a tool that reads PE
> DLLs, because winelib DLLs are Elf shared objects. Use winedump instead.

Precisely. Easy to distinguish between wine and doze Dlls. 

> Use winedump instead.

I did. It dumps the CPlApplet() function nicely from all cpls (including one I 
made in Delphi). 



From truiken at gmail.com  Thu Mar 27 10:35:43 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 27 Mar 2008 10:35:43 -0500
Subject: Contributing
In-Reply-To: <91fef9720803262243r6ee697fk93cdda05572cc8b2@mail.gmail.com>
References: <91fef9720803262243r6ee697fk93cdda05572cc8b2@mail.gmail.com>
Message-ID: <22821af30803270835t67205ba5n6b415294cb4041e7@mail.gmail.com>

On Thu, Mar 27, 2008 at 12:43 AM, Travis Athougies <iammisc at gmail.com> wrote:
> Hi,
>
>  I would like to help contribute to WINE because I use it so much yet
>  I've never actually contributed to it. I was wondering if there are
>  any simple bugs or other tasks that someone new to WINE development
>  could undertake.
>

http://wiki.winehq.org/DeveloperDoc

-- 
James Hawkins


From truiken at gmail.com  Thu Mar 27 10:44:22 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 27 Mar 2008 10:44:22 -0500
Subject: setupapi: Implement pSetupGetField, with tests.
In-Reply-To: <47EB8DC8.4030708@gmail.com>
References: <47EB8DC8.4030708@gmail.com>
Message-ID: <22821af30803270844w37ab0472la98e1e992e793f45@mail.gmail.com>

On Thu, Mar 27, 2008 at 7:06 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi James,
>
>  I'm looking into a crash of the setupapi/parser test on Vista.
>
>  It crashes in this piece:
>
>   465         ret = HeapFree( GetProcessHeap(), 0, (LPVOID)field );
>   466         ok( !ret, "Expected HeapFree to fail\n" );
>   467         ok( GetLastError() == ERROR_INVALID_PARAMETER,
>   468             "Expected ERROR_INVALID_PARAMETER, got %u\n", GetLastError() );
>
>  when trying the second field.
>
>  It's been added by a patch of yours:
>
>  http://source.winehq.org/git/wine.git/?a=commit;h=7588b669d8331ff64fc3b75cebe40ef518cd0de1
>
>  What's the reason for checking the HeapFree here? Or what's the reason for doing
>  it at all?
>

To show that the value returned is not in the heap.

-- 
James Hawkins


From dmitry at codeweavers.com  Thu Mar 27 10:52:58 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 23:52:58 +0800
Subject: setupapi: Implement pSetupGetField, with tests.
References: <47EB8DC8.4030708@gmail.com>
	<22821af30803270844w37ab0472la98e1e992e793f45@mail.gmail.com>
Message-ID: <05f501c89022$a37d12f0$a600fea9@DMITRY>

"James Hawkins" <truiken at gmail.com> wrote:

>>  What's the reason for checking the HeapFree here? Or what's the reason for doing
>>  it at all?
>>
> 
> To show that the value returned is not in the heap.

Isn't any of HeapValidate or HeapSize better in that case?

-- 
Dmitry.


From truiken at gmail.com  Thu Mar 27 11:05:42 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 27 Mar 2008 11:05:42 -0500
Subject: setupapi: Implement pSetupGetField, with tests.
In-Reply-To: <05f501c89022$a37d12f0$a600fea9@DMITRY>
References: <47EB8DC8.4030708@gmail.com>
	<22821af30803270844w37ab0472la98e1e992e793f45@mail.gmail.com>
	<05f501c89022$a37d12f0$a600fea9@DMITRY>
Message-ID: <22821af30803270905m6af22becj6358c53fcf98cb5b@mail.gmail.com>

On Thu, Mar 27, 2008 at 10:52 AM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> "James Hawkins" <truiken at gmail.com> wrote:
>
>  >>  What's the reason for checking the HeapFree here? Or what's the reason for doing
>  >>  it at all?
>  >>
>  >
>  > To show that the value returned is not in the heap.
>
>  Isn't any of HeapValidate or HeapSize better in that case?
>

Sure.  It worked on XP and earlier so I didn't really think twice
about it when I wrote the tests.

-- 
James Hawkins


From remco47 at gmail.com  Thu Mar 27 11:13:33 2008
From: remco47 at gmail.com (Remco)
Date: Thu, 27 Mar 2008 17:13:33 +0100
Subject: GSOC proposal - control panel
In-Reply-To: <200803271703.48555.pure_evil@mail.bg>
References: <200803271621.06760.pure_evil@mail.bg>
	<47EBB4F0.5050009@codeweavers.com>
	<200803271703.48555.pure_evil@mail.bg>
Message-ID: <36a11a3a0803270913p65d533eei3f89cf72d00939a8@mail.gmail.com>

On Thu, Mar 27, 2008 at 4:03 PM,  <pure_evil at mail.bg> wrote:
>  > A DLL compiled as a winelib DLL won't be parsed by a tool that reads PE
>  > DLLs, because winelib DLLs are Elf shared objects. Use winedump instead.
>
>  Precisely. Easy to distinguish between wine and doze Dlls.

Wine is easily detectable anyway. Just look at the Wine regkeys, or
try some Unix-calls. It's impossible to stop childish companies from
blocking Wine.

Remco


From juan.lang at gmail.com  Thu Mar 27 11:15:32 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 27 Mar 2008 09:15:32 -0700
Subject: [1/2] Added a test: registering device interface and
	gettingdevicepath
In-Reply-To: <054e01c89017$4d258050$a600fea9@DMITRY>
References: <200803271422.57559.amorozov@etersoft.ru>
	<049a01c8900d$f20ad570$a600fea9@DMITRY>
	<200803271655.16334.amorozov@etersoft.ru>
	<050c01c89014$27a74b40$a600fea9@DMITRY> <47EBACDF.8040309@gmail.com>
	<054e01c89017$4d258050$a600fea9@DMITRY>
Message-ID: <3a768c550803270915i354e1c7ta338dc1dd1a62c7b@mail.gmail.com>

>  GetLastError() returns an unsigned value, and winerror.h lists error values
>  in decimal (if anyone really wants to match a trace with a symbolic name).

That's not strictly true.  The cryptoapi errors are defined as
HRESULTs , but are returned via GetLastError.  More relevant to this
patch is that the setupapi errors are defined as bitmasks, and are
also returned via GetLastError.

I picked %08x for a reason in this code--it's far easier to find the
relevant error using it than using %u.
--Juan


From owen at owenrudge.net  Thu Mar 27 11:31:15 2008
From: owen at owenrudge.net (Owen Rudge)
Date: Thu, 27 Mar 2008 16:31:15 -0000
Subject: GSOC proposal - control panel
References: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
	<47EB7E2A.10302@open-vote.org>
Message-ID: <025601c89027$fbc2c8b0$842a204e@lan.owenrudge.net>

> What I and the other Ubuntu UI people would really like to see is the
> ability to uninstall Wine programs from within gnome-app-install (The
> Gnome applet the user interacts with after selecting
> Applications->Add/Remove).
>
> The UI is a fairly intuitive step - just add a "Windows Applications"
> category and list the installed Wine apps on the right.  Once that's
> done, we don't need a special Wine program for uninstalling anymore,
> since we can expand the functionality in a similar place where the user
> could reasonably expects to find it.

This sounds somewhat like it'd be a bit of a side project to my intended 
plan. Implementing such a "Windows Applications" category wouldn't involve 
much more than interating through the registry, and then calling wine on the 
appropriate uninstaller .exe.

I would still suggest a proper Control Panel namespace for Wine would be 
best. Implementing functionality to embed the Wine control panel into other 
X windows would then be possible too, although looking at the patch 
submitted a few months ago, I fear the implementation of it may not be the 
most tidy thing. The idea of a side project implementing a basic set of 
reusable functions to iterate through the registry to retrieve application 
details (for Add/Remove Programs, at least) may be better.

Regards,

-- 
Owen Rudge
http://www.owenrudge.net/



From owen at owenrudge.net  Thu Mar 27 11:36:35 2008
From: owen at owenrudge.net (Owen Rudge)
Date: Thu, 27 Mar 2008 16:36:35 -0000
Subject: GSOC proposal - control panel
References: <200803271621.06760.pure_evil@mail.bg>
Message-ID: <026901c89028$baa29d50$842a204e@lan.owenrudge.net>

> No dice.
> CPls are DLLs that export a function - CPlApplet().
> winegcc coughs on dllexport. - not implemented.
> I've been hacking at it for days on end now.
> Result: CPl can be compiled under windows and run under wine. CPls 
> compiled
> with winegcc don't export that function => not treated as control panel
> applets.

I'm sure it must be possible to export routines in Wine .dll.so libraries 
via .def files or similar - whether GetProcAddress supports Wine "DLLs" is 
the issue. Even if for some reason it's not possible, I don't see that it 
would be impossible to detect that the .cpl file is actually a Wine DLL, and 
to use the appropriate dlopen-type routines to read it.

-- 
Owen Rudge
http://www.owenrudge.net/



From pure_evil at mail.bg  Thu Mar 27 11:51:47 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Thu, 27 Mar 2008 18:51:47 +0200
Subject: GSOC proposal - control panel
Message-ID: <200803271851.47420.pure_evil@mail.bg>

<off-topic>Sorry bout that, went a lil' /too/ paranoid. Thing is, I've spent 
so many days obsessing with the cpls, trying to get anything resembling a 
somewhat stable dev environment to produce anything resembling a *compilable* 
code, reverse-engineering Makefiles, and Makefile.ins, and defs and specs and 
C and gcc and ReactOS cpls and so forth /and being handed a code whose dev 
jumped on me for trying to cross-compile it, though that was what I asked for 
in the first place btw/ and when finally, SOMETHING compiled (a sample cpl 
included in Reactos 3.0. source code), I suddenly discovered that

A.) They can't be done the normal way /e.g. compiled against wine's 
source-tree by winegcc/
B.) If they could, they would've been done long ago (Reactos has 'em; Someone 
would've ported them by now, if not do 'em from scratch)

It was just too much for two weeks, sorry again.
</off-topic>

On-topic: CPls the normal way -> no-go. Binary CPls compiled on 'doze or with 
a 'doze compiler under wine -> yes. 

Sorry again.


From amorozov at etersoft.ru  Thu Mar 27 08:55:12 2008
From: amorozov at etersoft.ru (Alexander Morozov)
Date: Thu, 27 Mar 2008 16:55:12 +0300
Subject: [1/2] Added a test: registering device interface and getting
	devicepath
In-Reply-To: <049a01c8900d$f20ad570$a600fea9@DMITRY>
References: <200803271422.57559.amorozov@etersoft.ru>
	<049a01c8900d$f20ad570$a600fea9@DMITRY>
Message-ID: <200803271655.16334.amorozov@etersoft.ru>

? ????????? ?? Thursday 27 March 2008 16:24:52 Dmitry Timoshkov ???????(?):
> "Alexander Morozov" <amorozov at etersoft.ru> wrote:
> > Changelog:
> > Added a test for setupapi: registering device interface and getting
> > device path
>
> Please consistently print GetLastError() values as %u (not %08x or %d),
> otherwise the test looks good to me.

Edit every test in tests/devinst.c or only testRegisterAndGetDetail?


From cmorgan at mail.leather-wallet.co.uk  Thu Mar 27 15:00:03 2008
From: cmorgan at mail.leather-wallet.co.uk (chris morgan)
Date: Thu, 27 Mar 2008 20:00:03 +0000
Subject: prevents WM_DISPLAYCHANGE message being sent when a call to
	ChangeDisplaySettingsEx
	fails due to the requested change to the display not occurring.
In-Reply-To: <3f4fd2640803251555r47d6fc73r2462567c7bd84286@mail.gmail.com>
References: <47E7CBC0.8050806@mail.leather-wallet.co.uk>
	<3f4fd2640803251555r47d6fc73r2462567c7bd84286@mail.gmail.com>
Message-ID: <47EBFCC3.90907@mail.leather-wallet.co.uk>

thanks for the feedback, i'm new to this so it's very much appreciated - 
helped a lot.

I've updated the patch which hopefully covers the issues raised, but 
wanted to ask about the returning of an error:
> w.r.t. the implementation:
>   *  ChangeDisplaySettings returns a long
> (http://msdn2.microsoft.com/en-us/library/ms533260(VS.85).aspx), so
> the correct value must be returned on error;
>   
as failure to change the colour depth currently isn't treated as an 
error which seems sensible as it enables many older apps to run 
presumably without issue so thought it better not to change that.

from X11DRV_desktop_SetCurrentMode

        /* Ignore the depth mismatch
         *
         * Some (older) applications require a specific bit depth, this 
will allow them
         * to run. X11drv performs a color depth conversion if needed.
         */
>   *  the fix does not match the test cases (screen size vs colour depth). 
oops, bad oversight. to fix this i've created a variable to store the 
state of screens colour depth as it would be perceived by a client. this 
is used to detect changes to screen depth and prevent unexpected 
WM_DISPLAYCHANGE from being sent.

i.e. a program calls ChangeDisplaySettings changing the colour depth and 
receives back a WM_DISPLAYCHANGE message. As far as the client is 
concerned the screen is at the new colour depth as it's call to 
ChangeDisplaySettings succeeded.

If the program called ChangeDisplaySettings with setting the same colour 
depth as it's previous call then, if no other setting had changed, it 
would not expect to receive a WM_DISPLAYCHANGE message as it's view of 
the screen's colour depth had not changed.

> In addition, your tests should:
>   *  check that changing the screen resolution causes a
> WM_DISPLAYCHANGE message to be sent;
>   *  if there are no other tests, ChangeDisplaySettings should be
> checked to see what happens with invalid arguments (for completeness);
>   *  the return value is not checked for expected values (see
> http://msdn2.microsoft.com/en-us/library/ms533260(VS.85).aspx);
>   *  GetLastError() is not checked to see what it is set to (see other
> tests for examples);
>   *  restore the display settings back to what they were before the tests.  
found the existing test now which seem to cover much of this but will 
try and extend them further. the new patch seems to pass ok

new patch:

---
 dlls/winex11.drv/desktop.c     |   12 +++++++++++-
 dlls/winex11.drv/event.c       |    1 +
 dlls/winex11.drv/winpos.c      |    4 ++--
 dlls/winex11.drv/x11drv.h      |    1 +
 dlls/winex11.drv/x11drv_main.c |    3 ++-
 dlls/winex11.drv/xrandr.c      |   12 +++++++++++-
 6 files changed, 28 insertions(+), 5 deletions(-)
--------------1.5.2.5
Content-Type: text/x-patch; 
name="c65ac7a7c58d8d36c05bf789daf2c5f3cbb64959.diff"
Content-Transfer-Encoding: 8bit
Content-Disposition: attachment; 
filename="c65ac7a7c58d8d36c05bf789daf2c5f3cbb64959.diff"

diff --git a/dlls/winex11.drv/desktop.c b/dlls/winex11.drv/desktop.c
index 1699318..04ac482 100644
--- a/dlls/winex11.drv/desktop.c
+++ b/dlls/winex11.drv/desktop.c
@@ -94,8 +94,18 @@ static LONG X11DRV_desktop_SetCurrentMode(int mode)
          * to run. X11drv performs a color depth conversion if needed.
          */
     }
+
     TRACE("Resizing Wine desktop window to %dx%d\n", 
dd_modes[mode].dwWidth, dd_modes[mode].dwHeight);
-    X11DRV_resize_desktop(dd_modes[mode].dwWidth, dd_modes[mode].dwHeight);
+
+    if (client_bpp != dd_modes[mode].dwBPP ||
+        screen_width != dd_modes[mode].dwWidth ||
+        screen_height != dd_modes[mode].dwHeight)
+    {
+        // Only call if the desktop has acutally changed
+        client_bpp = dd_modes[mode].dwBPP;
+        X11DRV_resize_desktop(dd_modes[mode].dwWidth, 
dd_modes[mode].dwHeight);
+    }
+
     return DISP_CHANGE_SUCCESSFUL;
 }

diff --git a/dlls/winex11.drv/event.c b/dlls/winex11.drv/event.c
index cd6eaf6..6795d90 100644
--- a/dlls/winex11.drv/event.c
+++ b/dlls/winex11.drv/event.c
@@ -1106,6 +1106,7 @@ LRESULT X11DRV_WindowMessage( HWND hwnd, UINT msg, 
WPARAM wp, LPARAM lp )
     case WM_X11DRV_SET_WIN_FORMAT:
         return X11DRV_set_win_format( hwnd, (XID)wp );
     case WM_X11DRV_RESIZE_DESKTOP:
+        client_bpp = wp;
         X11DRV_resize_desktop( LOWORD(lp), HIWORD(lp) );
         return 0;
     default:
diff --git a/dlls/winex11.drv/winpos.c b/dlls/winex11.drv/winpos.c
index ad62236..6c68858 100644
--- a/dlls/winex11.drv/winpos.c
+++ b/dlls/winex11.drv/winpos.c
@@ -564,7 +564,7 @@ void X11DRV_resize_desktop( unsigned int width, 
unsigned int height )

     if (GetWindowThreadProcessId( hwnd, NULL ) != GetCurrentThreadId())
     {
-        SendMessageW( hwnd, WM_X11DRV_RESIZE_DESKTOP, 0, MAKELPARAM( 
width, height ) );
+        SendMessageW( hwnd, WM_X11DRV_RESIZE_DESKTOP, client_bpp, 
MAKELPARAM( width, height ) );
     }
     else
     {
@@ -573,7 +573,7 @@ void X11DRV_resize_desktop( unsigned int width, 
unsigned int height )
                       virtual_screen_rect.right - virtual_screen_rect.left,
                       virtual_screen_rect.bottom - virtual_screen_rect.top,
                       SWP_NOZORDER | SWP_NOACTIVATE | SWP_DEFERERASE );
-        SendMessageTimeoutW( HWND_BROADCAST, WM_DISPLAYCHANGE, screen_bpp,
+        SendMessageTimeoutW( HWND_BROADCAST, WM_DISPLAYCHANGE, client_bpp,
                              MAKELPARAM( width, height ), 
SMTO_ABORTIFHUNG, 2000, NULL );
     }

diff --git a/dlls/winex11.drv/x11drv.h b/dlls/winex11.drv/x11drv.h
index 52670e8..8c28f81 100644
--- a/dlls/winex11.drv/x11drv.h
+++ b/dlls/winex11.drv/x11drv.h
@@ -525,6 +525,7 @@ extern Window root_window;
 extern unsigned int screen_width;
 extern unsigned int screen_height;
 extern unsigned int screen_bpp;
+extern unsigned int client_bpp;
 extern unsigned int screen_depth;
 extern RECT virtual_screen_rect;
 extern unsigned int text_caps;
diff --git a/dlls/winex11.drv/x11drv_main.c b/dlls/winex11.drv/x11drv_main.c
index d445e64..58dd680 100644
--- a/dlls/winex11.drv/x11drv_main.c
+++ b/dlls/winex11.drv/x11drv_main.c
@@ -71,6 +71,7 @@ Visual *visual;
 unsigned int screen_width;
 unsigned int screen_height;
 unsigned int screen_bpp;
+unsigned int client_bpp;
 unsigned int screen_depth;
 RECT virtual_screen_rect;
 Window root_window;
@@ -517,7 +518,7 @@ static BOOL process_attach(void)
         }
     }
     if (!screen_depth) screen_depth = DefaultDepthOfScreen( screen );
-    screen_bpp = depth_to_bpp( screen_depth );
+    client_bpp = screen_bpp = depth_to_bpp( screen_depth );

     XInternAtoms( display, (char **)atom_names, NB_XATOMS - 
FIRST_XATOM, False, X11DRV_Atoms );

diff --git a/dlls/winex11.drv/xrandr.c b/dlls/winex11.drv/xrandr.c
index fd930a2..e977aa1 100644
--- a/dlls/winex11.drv/xrandr.c
+++ b/dlls/winex11.drv/xrandr.c
@@ -179,6 +179,7 @@ static LONG X11DRV_XRandR_SetCurrentMode(int mode)
     unsigned int i;
     int j;
     DWORD dwBpp = screen_bpp;
+    DWORD modeBPP = dd_modes[mode].dwBPP;

     wine_tsx11_lock();
     root = RootWindow (gdi_display, DefaultScreen(gdi_display));
@@ -188,6 +189,7 @@ static LONG X11DRV_XRandR_SetCurrentMode(int mode)
     {
         FIXME("Cannot change screen BPP from %d to %d\n", dwBpp, 
dd_modes[mode].dwBPP);
     }
+
     mode = mode%real_xrandr_modes_count;

     TRACE("Changing Resolution to %dx%d @%d Hz\n",
@@ -229,7 +231,15 @@ static LONG X11DRV_XRandR_SetCurrentMode(int mode)
     wine_tsx11_unlock();
     if (stat == RRSetConfigSuccess)
     {
-        X11DRV_resize_desktop( dd_modes[mode].dwWidth, 
dd_modes[mode].dwHeight );
+        if (client_bpp != modeBPP ||
+            screen_width != dd_modes[mode].dwWidth ||
+            screen_height != dd_modes[mode].dwHeight)
+        {
+            // Only call if the desktop has acutally changed
+            client_bpp = modeBPP;
+            X11DRV_resize_desktop( dd_modes[mode].dwWidth, 
dd_modes[mode].dwHeight );
+        }
+
         return DISP_CHANGE_SUCCESSFUL;
     }






From mstefani at redhat.com  Thu Mar 27 15:37:37 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 27 Mar 2008 21:37:37 +0100
Subject: comdlg32->printdlg: bug fixed
In-Reply-To: <200803272148.12065.vitperov@etersoft.ru>
References: <200803272148.12065.vitperov@etersoft.ru>
Message-ID: <47EC0591.9020600@redhat.com>

Vitaly Perov wrote:
> Bug is the following:
>  When a application is responsible for printing multiple copies printer prints 
> X^2 copies (4 instead of 2, 9 instead of 3 ...)
> It happen bacause application already prepared requested copies, and printer 
> driver prints copies ( number placed in dmCopies) of whole document.
> 
> Changelog:
> - When PD_USEDEVMODECOPIESANDCOLLATE flag is not set dmCopies must be 1.

You didn't attached the diff but the whole file.

bye
	michael


From htl10 at users.sourceforge.net  Thu Mar 27 15:39:23 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Thu, 27 Mar 2008 20:39:23 +0000 (GMT)
Subject: Fw: Re: Google Summer of Code 2008 - joined openprinting+wine
	project?
In-Reply-To: <47EADAFC.8000206@gmx.net>
Message-ID: <818031.96955.qm@web23108.mail.ird.yahoo.com>

Thanks for the info... I have updated the linux foundation GSOC page with some of my ideas.

Naively, I think it is almost scriptable - get cups to dump the input as temp postscript, use wine to run win32 ghostscript (which works quite well in wine, 
my first-hand experience) to render through GDI and if the printer proxy can receive 
the data that way, let wine send the data out through lpX, libusb or the network... just a thought, and maybe a pipe dream :-). This is slow, but maybe viable?

I have a fair amount of mingw-cross experience, and lately rather into wine. 

--- On Wed, 26/3/08, Marcel Partap <mpartap at gmx.net> wrote:

> From: Marcel Partap <mpartap at gmx.net>
> Subject: Re: Fw: Re: Google Summer of Code 2008 - joined openprinting+wine project?
> To: htl10 at users.sourceforge.net
> Cc: wine-devel at winehq.org, "Till Kamppeter" <till.kamppeter at gmail.com>
> Date: Wednesday, 26 March, 2008, 11:23 PM
> Hi Hin-Tak,
> to sum it up, I was the one working on that project and I
> hit some ehh.. problems ;)
> Anyways, my final result was that I got something out of
> the printer drivers I tried with, but 
> useful results depended on something that is referred to as
> the ominous 'DIB engine'. Coincidently, 
> there was another SoC project done by Jesse Allen which
> started implementing that. That code ended 
> up at http://repo.or.cz/w/wine/dibdrv.git, and just as
> mine, general+AJ's consensus was to start 
> merging it post-1.0. Now I didn't have time to look
> again at it up to now (uni!) but I still want to 
> finish this, just not as part of a SoC project. Also I
> wouldn't recommend that to anyone, except he 
> REEEAAALLY does grok all those mysterious inner-GDI
> concepts (DIB DDB DDI...) that this project 
> touches. I myself have not fully reached insight of how
> best to merge the current winex11drv, 
> wined3d and Jesse's dib engine, but I'll have a
> thorough look at it in the next few days. Another 
> unsolved issue is whether to teach wine's internal GDI
> functions to speak DDI or rather to build a 
> wineddi.drv bridge thing. I tried both approaches but there
> was no clear decision whether to use one 
> or the other, with Alexandre's stance being 'once
> something actually works we can talk about that'.
> Also my code to make printer drivers work depends on some
> stuff within the localspooler code, I have 
> to investigate how far Detlef got it to work regarding
> installation of drivers.
> Oh yeah and that printer proxy was only a DLL to see how
> native windows communicates with the 
> drivers without getting into disassembling stuff.. the
> results scared me, astonishing levels of 
> redundancy.. Anyways, even though all the bits and pieces
> of how to make native drivers actually 
> work with wine are lying around, this is neither a fun nor
> a beginner's task (I know that now *g). 
> That said, I'm going to look into it and hope to come
> up with something in the next few days.
> regards marcel.
> 
> 
> Hin-Tak Leung wrote:
> > Hi, anybody on wine-devel want to take this on and
> make this more concrete?
> > 
> > --- On Wed, 26/3/08, Till Kamppeter
> <till.kamppeter at gmail.com> wrote:
> > 
> >> From: Till Kamppeter
> <till.kamppeter at gmail.com>
> >> Subject: Re: Google Summer of Code 2008 - Some
> general instructions for reviewing the student's
> applications
> >> To: "Hin-Tak Leung"
> <hintak_leung at yahoo.co.uk>
> >> Cc: "Casey Schaufler"
> <casey at schaufler-ca.com>, "'Glen
> Petrie'" <glen.petrie at eitc.epson.com>,
> "Rik van Riel" <riel at redhat.com>,
> "Jeff Licquia" <licquia at debian.org>,
> "Jon Masters" <jonmasters at gmail.com>,
> "Jonathan Riddell" <jriddell at ubuntu.com>,
> "Josef Spillner" <spillner at kde.org>,
> Matt_Domsch at dell.com, "Pekka Enberg"
> <penberg at cs.helsinki.fi>
> >> Date: Wednesday, 26 March, 2008, 4:34 PM
> >> Hin-Tak Leung wrote:
> >>> Hi Till and the rest of the gang.
> >>>
> >>> Two people had got in touch with with about
> the
> >> IJS+PDF workflow, and I replied. 
> >>> (sorry I don't check the "other"
> e-mail
> >> often - I probably should set up re-direction).
> >> Great!
> >>
> >>> I thought I should also mentioned that it has
> just
> >> came to my attention in some unrelated discussion
> on
> >> wine-devel - been doing some non-printing
> wine-related
> >> stuff lately - that there *was* a google summer of
> code
> >> 2007 project for a
> >>> wine-based native printer driver proxy - this
> is the
> >> sort of thing I have had in mind
> >>> for a while and I thought it would be
> interesting to
> >> do but I don't have in-depth
> >>> windows knowledge to make it happen, but the
> wine
> >> people already did!
> >>>
> http://google-summer-of-code-2007-wine.googlecode.com/
> >>>
> >>> I just downloaded the gsoc 2007 printerproxy
> code. It
> >> seems that it is just for use
> >>> from within wine, but it just might be
> interesting to
> >> make it more general - via opvp
> >>> or IJS. We should follow up on this.
> >> If this project still requires coding, it is not
> too late
> >> to add it as 
> >> project idea to the ideas pages of both the Linux
> >> Foundation and WINE 
> >> (having it presented at two mentoring
> organizations raises
> >> the chances 
> >> to find a student).
> >>
> >> Our ideas page is a Wiki and you can simply edit
> it:
> >>
> >>
> https://www.linux-foundation.org/en/Google_Summer_of_Code
> >>
> >>     Till
> > 
> > 
> >      
> __________________________________________________________
> > Sent from Yahoo! Mail.
> > More Ways to Keep in Touch.
> http://uk.docs.yahoo.com/nowyoucan.html
> > 
> 
> 
> -- 
> <div id="signature">
>    "Obstacles are those frightful things you see when
> you take your eyes off your goal."
>                                                            
>    -- Henry Ford (1863-1947)
>    Change the world! Vote revolution:
> http://hfopi.org/vote-future
> </div>


      __________________________________________________________
Sent from Yahoo! Mail.
More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html


From r.kalbermatter at hccnet.nl  Thu Mar 27 16:04:19 2008
From: r.kalbermatter at hccnet.nl (Rolf Kalbermatter)
Date: Thu, 27 Mar 2008 22:04:19 +0100
Subject: GSOC proposal - control panel
In-Reply-To: <200803271851.47420.pure_evil@mail.bg>
References: <200803271851.47420.pure_evil@mail.bg>
Message-ID: <001501c8904e$204bda70$4001a8c0@NATERS>

pure_evil at mail.bg [mailto:pure_evil at mail.bg] 

> On-topic: CPls the normal way -> no-go. Binary CPls compiled 
> on 'doze or with a 'doze compiler under wine -> yes. 

I may be very off here but isn't Wine's LoadLibrary/GetProcAddress
able to deal with wine shared library modules, even if they are not
really PE files?

Of course Windows can't deal with them. For a Windows compatible DLL
you do need a cross compiler like MingW or compile the sources in MSVC.
It should be the same here as what is actually the situation for the
test framework.

Rolf Kalbermatter



From cesar at ecuarock.net  Thu Mar 27 21:08:59 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Thu, 27 Mar 2008 21:08:59 -0500
Subject: fuse-iso and remote named pipes for GSOC
In-Reply-To: <200803260942.19076.kai.blin@gmail.com>
References: <e3d3ae8f0803251824s75bbd9f0ia25c930dfa7a80e@mail.gmail.com>
	<200803260942.19076.kai.blin@gmail.com>
Message-ID: <e3d3ae8f0803271908k4829097cid7ff7d0009066b75@mail.gmail.com>

On Wed, Mar 26, 2008 at 3:42 AM, Kai Blin <kai.blin at gmail.com> wrote:
> On Wednesday 26 March 2008 02:24:35 Cesar Izurieta wrote:
>  > Besides the FUSE project for GSOC I see two items listed on the
>  > http://wiki.winehq.org/SummerOfCode page:
>  >
>  > # Better ISO FUSE file system integration
>
>  Steven already took care of this part, so I'll wrap up the next one.
>
>
>  > # A FUSE wrapper for remote named pipes using libsmbclient
>
>  The goal of this is to be able to do RPC via Windows named pipes to remote
>  machines. Of course the best solution would be to just use libsmbclient from
>  Wine directly, but libsmbclient is under the GPL and Wine is under the LGPL,
>  so that's not going to work.
>
>  So the obvious idea is some solution where we can use libsmbclient for what we
>  need without having to link to libsmbclient. FUSE can provide this
>  abstraction.
>
>  The idea would be to create a pipe subdirectory of WINEPREFIX and mount our
>  pipefs there. Accessing pipe/server/pipename should connect to
>  \\server\pipe\pipename, if possible.
>  One more thing that needs to be supported is mode switching on the named pipe.

Implementing such a filesystem doesn't seem difficult at all.
libsmbclient contains all that is needed and we would only need to map
some samba structs to fuse structs. The only real problem that I see
is authentication. If we want to use this as a regular filesystem we
could mount one pipefs per connection (with authentication information
on connect) or provide login and domain information in the path itself
(doesn't sound like a good idea)

>
>  I'd suggest to read up on remote named pipes to get a better idea what they're
>  used for.
>
>  If you've got any more questions, I'm happy to help.
>  Kai
>
>  --
>  Kai Blin
>  WorldForge developer  http://www.worldforge.org/
>  Wine developer        http://wiki.winehq.org/KaiBlin
>  Samba team member     http://www.samba.org/samba/team/
>  --
>  Will code for cotton.
>


From dmitry at codeweavers.com  Thu Mar 27 22:07:15 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 28 Mar 2008 11:07:15 +0800
Subject: [1/2] Added a test: registering device interface
	andgettingdevicepath
References: <200803271422.57559.amorozov@etersoft.ru><049a01c8900d$f20ad570$a600fea9@DMITRY><200803271655.16334.amorozov@etersoft.ru><050c01c89014$27a74b40$a600fea9@DMITRY>
	<47EBACDF.8040309@gmail.com><054e01c89017$4d258050$a600fea9@DMITRY>
	<3a768c550803270915i354e1c7ta338dc1dd1a62c7b@mail.gmail.com>
Message-ID: <006d01c89080$d561f700$a600fea9@DMITRY>

"Juan Lang" <juan.lang at gmail.com> wrote:

>>  GetLastError() returns an unsigned value, and winerror.h lists error values
>>  in decimal (if anyone really wants to match a trace with a symbolic name).
> 
> That's not strictly true.  The cryptoapi errors are defined as
> HRESULTs , but are returned via GetLastError.  More relevant to this
> patch is that the setupapi errors are defined as bitmasks, and are
> also returned via GetLastError.
> 
> I picked %08x for a reason in this code--it's far easier to find the
> relevant error using it than using %u.

Then the tests should consistently use %08x, not a mixture of various
formats.

-- 
Dmitry.


From juan.lang at gmail.com  Thu Mar 27 22:12:24 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 27 Mar 2008 20:12:24 -0700
Subject: [1/2] Added a test: registering device interface
	andgettingdevicepath
In-Reply-To: <006d01c89080$d561f700$a600fea9@DMITRY>
References: <200803271422.57559.amorozov@etersoft.ru>
	<049a01c8900d$f20ad570$a600fea9@DMITRY>
	<200803271655.16334.amorozov@etersoft.ru>
	<050c01c89014$27a74b40$a600fea9@DMITRY> <47EBACDF.8040309@gmail.com>
	<054e01c89017$4d258050$a600fea9@DMITRY>
	<3a768c550803270915i354e1c7ta338dc1dd1a62c7b@mail.gmail.com>
	<006d01c89080$d561f700$a600fea9@DMITRY>
Message-ID: <3a768c550803272012x1614ad16g1b9e23873dea66e3@mail.gmail.com>

>  > I picked %08x for a reason in this code--it's far easier to find the
>  > relevant error using it than using %u.
>
>  Then the tests should consistently use %08x, not a mixture of various
>  formats.

Perhaps.  I generally chose a format that matched the "expected"
error.  Error values like ERROR_INVALID_PARAMETER should be %u--I
erroneously use %d, I think--whereas setupapi errors should be %08x.
But since the ok output is in exceptional conditions, it might be hard
to predict which range of values is more likely, so perhaps
consistency is better than trying to be smart about it.  I don't have
a firm opinion about that.
--Juan


From jim at darchons.net  Fri Mar 28 00:47:43 2008
From: jim at darchons.net (Jim Chen)
Date: Fri, 28 Mar 2008 01:47:43 -0400
Subject: Implement VBScript for Google Summer of Code
Message-ID: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>

Hi everyone,

I have this idea of implementing vbscript.dll for Google SoC. Any
comment would be appreciated before I start working on my proposal.

The reason for implementing vbscript.dll is because right now there's
nothing in the trunk about it. jscript.dll has a stub, but
vbscript.dll doesn't, and it's an area that I think I can work on.
VBScript is used by the Windows Installer, can be potentially be used
for DirectMusic script (from http://wiki.winehq.org/DirectX-ToDo), and
some applications use it.

Just the core language/runtime (vbscript.dll) is implemented, no extra
COM/OLE objects such as FSO (file system object), etc. (unless I have
time). The language by itself is designed to be simple and easy, so an
interpreter shouldn't be hard. I wrote a C-style script interpreter in
Java this past year. For a few years I used to hack VB, and I know the
language and VBScript is just a cousin of VB. The runtime library is
not big, and writing it shouldn't take too much time either.

I think the hardest part would be to implement the COM interfaces that
deal with scripting. And that's the area I know least about.

Thanks!
Jim


From paul.vriens.wine at gmail.com  Fri Mar 28 03:53:18 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 28 Mar 2008 09:53:18 +0100
Subject: [Tools 5/6] winetest: Add statistics for the number of unit tests
	with errors or todos.
In-Reply-To: <alpine.DEB.1.00.0803262337580.10184@amboise.dolphin>
References: <alpine.DEB.1.00.0803262337580.10184@amboise.dolphin>
Message-ID: <47ECB1FE.3020107@gmail.com>

Francois Gouget wrote:
> Also tweak the headers and footers a bit.
> ---
> 
> This gives us a better idea of how many unit tests are failing.
> 
>  winetest/gather |   67 ++++++++++++++++++++++++++++++++++++++++++++++++++----
>  1 files changed, 62 insertions(+), 5 deletions(-)
> 
> diff --git a/winetest/gather b/winetest/gather

Hi Francois,

I think something is 'wrong' with the statistics for the Wine group:

http://test.winehq.org/data/200803211000/#group_Wine

They are the same for every box with respect to the "X + Y". The title (on mouse 
  over) is correct though.

-- 
Cheers,

Paul.


From paul.vriens.wine at gmail.com  Fri Mar 28 03:55:29 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 28 Mar 2008 09:55:29 +0100
Subject: [Tools 5/6] winetest: Add statistics for the number of unit tests
	with errors or todos.
In-Reply-To: <47ECB1FE.3020107@gmail.com>
References: <alpine.DEB.1.00.0803262337580.10184@amboise.dolphin>
	<47ECB1FE.3020107@gmail.com>
Message-ID: <47ECB281.4080505@gmail.com>

Paul Vriens wrote:
> Francois Gouget wrote:
>> Also tweak the headers and footers a bit.
>> ---
>>
>> This gives us a better idea of how many unit tests are failing.
>>
>>  winetest/gather |   67 
>> ++++++++++++++++++++++++++++++++++++++++++++++++++----
>>  1 files changed, 62 insertions(+), 5 deletions(-)
>>
>> diff --git a/winetest/gather b/winetest/gather
> 
> Hi Francois,
> 
> I think something is 'wrong' with the statistics for the Wine group:
> 
> http://test.winehq.org/data/200803211000/#group_Wine
> 
> They are the same for every box with respect to the "X + Y". The title 
> (on mouse  over) is correct though.
> 

Would this do? :

diff --git a/winetest/gather b/winetest/gather
index 294ad06..fdacff5 100755
--- a/winetest/gather
+++ b/winetest/gather
@@ -362,7 +362,7 @@ EOF
                      "pass";
          my $count=!$report->{todos} ? $report->{errors} :
                    !$report->{errors} ? $report->{todos} :
-                  "$group->{errors}+$group->{todos}";
+                  "$report->{errors}+$report->{todos}";

          my $prcnt=!$report->{todos} ? percent($report->{errors}, $unit_count) :
                    !$report->{errors} ? percent($report->{todos}, $unit_count) :


-- 
Cheers,

Paul.


From xixsimplicityxix at gmail.com  Fri Mar 28 04:44:21 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 28 Mar 2008 04:44:21 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47EAA1C0.5050004@gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
Message-ID: <78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>

>  > Are you currently working on this?  Is it a problem that needs to be
>  > fixed on the mingw side?
>  >
>  It's indeed a mingw issue and has to be fixed on that side.
>
>  I've never touched mingw so I'm relying on either Hans Leidekker, Stefan
>  Leichter or Paul Millar to take this up.
>

The problem is that it is a mingw issue but they don't want any
patches from wines win32 api in their mingw w32api.  They believe that
looking at the actual ms header files taints our headers legally
speaking.  Stefan, hans, and PaulM maintain a rather large set of
patches against w32api.  [1]

So its a constant catchup game from when wines headers get new
additions until someone sends paulm a patch updating the mingw w32api.

I made a script [2] that will cross build winetest from git source no
mingw patches needed. In theory this could be useful in keeping the
cross built winetest.exe's rolling.

To use the script you need 3 dirs a wine-git, wine-native, and a
wine-pe.  Set those locations in the config part of the script as well
as the build and host settings for your compiler and cross compiler.
At the end winetest.exe will be in wine-pe/programs/winetest/ folder.
 This setup is from PaulMs recipe [3] with some tweaking.

Also if you trust me and just want the exe its at [4].


Hope this helps,
John

P.S. I logged some test results from my win2k machine, it seems they
are at [5].  Seems like I missed some setting though as the date is
not right.  Advice on how to fix that would be delicious =)


[1] http://readlist.com/lists/lists.sourceforge.net/mingw-users/1/5419.html
[2] http://klehm.net/wine/crossbuild_winetest.sh
[3] http://www.winehq.org/pipermail/wine-devel/2006-December/053069.html
[4] http://klehm.net/wine/winetest.exe
[5] http://test.winehq.org/data/06d429d6b6b6d63beaeda130a3bb261ef3b9fb41/


From paul.vriens.wine at gmail.com  Fri Mar 28 04:52:02 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 28 Mar 2008 10:52:02 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>	
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>	
	<47E8C57C.9030708@gmail.com>	
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>	
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
Message-ID: <47ECBFC2.2010805@gmail.com>

John Klehm wrote:
> 
> P.S. I logged some test results from my win2k machine, it seems they
> are at [5].  Seems like I missed some setting though as the date is
> not right.  Advice on how to fix that would be delicious =)
> 

It uses the file programs/winetest/build.id for this.

-- 
Cheers,

Paul.


From canterbury.matt at gmail.com  Thu Mar 27 13:50:02 2008
From: canterbury.matt at gmail.com (Matthew Canterbury)
Date: Thu, 27 Mar 2008 14:50:02 -0400
Subject: GSOC proposal: DirectPlay4
Message-ID: <8ec28a80803271150x2993ca08y98b15d409758f70a@mail.gmail.com>

Hello everybody,

I plan on applying for Google's Summer of Code to work on DirectPlay4
support in wine. (This was mentioned on the ideas page,
http://wiki.winehq.org/SummerOfCode). I've looked at the code currently in
wine, and it looks like there is some work done, but a number of the
functions exported in the corresponding dlls are stubs or partial stubs.
Alot of work needs to be done to dplay to make it more compliant (or at
least more functional). This would allow several games that depend on
DirectPlay to work without copying dll's from a windows partition. So I
intend to makes sure the IDirectPlay4 COM interface is sufficiently
implemented and that it meets the requirements set forth in in the
DirectPlay4 specification. If time permits, I'd like to look into the
Reliable Specification for DirectPlay4, but i think implementing just the
core specification will keep me busy. I've never worked on an open source
project before, but I have wanted to for quite some time. I'm looking
forward to contributing to a project that I've used quite a bit in the past
few years. ;)

I thought I would introduce myself a bit here. I'm currently a computer
engineering student at a University in the United States. I've been
programming since I was about 13, and I've had all kinds of personal
projects from a somewhat functional 3D game engines to a ray tracer. I was
also chosen to participate on our school's team for the ACM programming
competition. In short, I'm a programmer at heart.

I'm putting the final touches on my application and would greatly appreciate
any thoughts or comments before I submit it through Google.

Thanks,

Matthew Canterbury
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080327/672e0409/attachment.htm 

From julliard at winehq.org  Fri Mar 28 05:04:46 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 28 Mar 2008 11:04:46 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	(John Klehm's message of "Fri, 28 Mar 2008 04:44:21 -0500")
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
Message-ID: <877ifnqi4h.fsf@wine.dyndns.org>

"John Klehm" <xixsimplicityxix at gmail.com> writes:

> P.S. I logged some test results from my win2k machine, it seems they
> are at [5].  Seems like I missed some setting though as the date is
> not right.  Advice on how to fix that would be delicious =)

It's now using the git commit sha1 instead of a date when building from
a git tree, that's a feature. I'm hoping we can standardize on that to
make sure all test runs properly identify the exact source used.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Fri Mar 28 05:36:47 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 28 Mar 2008 10:36:47 +0000
Subject: amstream: IAMMultiMediaStream::EnumMediaStreams
In-Reply-To: <47EC3799.2060106@gmail.com>
References: <47EC3799.2060106@gmail.com>
Message-ID: <47ECCA3F.5020508@codeweavers.com>

Nikolay Sivov wrote:
> @@ -144,9 +144,18 @@
>  {
>      IAMMultiMediaStreamImpl *This = (IAMMultiMediaStreamImpl *)iface;
>  
> -    FIXME("(%p/%p)->(%ld,%p) stub!\n", This, iface, Index, ppMediaStream); 
> +    TRACE("(%p/%p)->(%d,%p)\n", This, iface, Index, ppMediaStream);
>  
> -    return E_NOTIMPL;
> +    /* check out of range */
> +    if(Index < 0 || Index >= This->nbStreams)
> +        return S_FALSE;
> +    /* NULL pointer */
> +    if(!(*ppMediaStream))
> +        return E_POINTER;
> +    
> +    *ppMediaStream = This->pStreams[Index];
> +    
> +    return S_OK;
>  }
>   

You need to call IMediaStream_AddRef on the returned stream.


-- 
Rob Shearman



From xixsimplicityxix at gmail.com  Fri Mar 28 06:05:57 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 28 Mar 2008 06:05:57 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <20080325093948.145810@gmx.net>
References: <47E8C0FC.2010700@gmail.com> <20080325093948.145810@gmx.net>
Message-ID: <78a7dad00803280405w3da1fd8dv383a1c7dc6688bfa@mail.gmail.com>

On Tue, Mar 25, 2008 at 4:39 AM, Roderick Colenbrander
<thunderbird2k at gmx.net> wrote:
>
>  As a sidenote. You are also cross compiling wine dlls so now and then. It would be useful to also cross compile d3d8/d3d9 and wined3d but for wined3d -DUSE_WIN32_OPENGL must be set.
>

Well let me know how this works for you.  I'll refactor my script a
bit later today but for right now you have to run this one after the
winetest script, as this one counts on the environment that the
winetest script sets up.

Script to crossbuild d3d dlls [1] and the dlls themselves [2], [3],
[4] are out there.


John

[1] http://klehm.net/wine/crossbuild_d3d_dlls.sh
[2] http://klehm.net/wine/d3d8.dll
[3] http://klehm.net/wine/d3d9.dll
[4] http://klehm.net/wine/wined3d.dll


From xixsimplicityxix at gmail.com  Fri Mar 28 06:50:43 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 28 Mar 2008 06:50:43 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <78a7dad00803280405w3da1fd8dv383a1c7dc6688bfa@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com> <20080325093948.145810@gmx.net>
	<78a7dad00803280405w3da1fd8dv383a1c7dc6688bfa@mail.gmail.com>
Message-ID: <78a7dad00803280450m69c5ff39v6cc90c33dc96473c@mail.gmail.com>

On Fri, Mar 28, 2008 at 6:05 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> On Tue, Mar 25, 2008 at 4:39 AM, Roderick Colenbrander
>  <thunderbird2k at gmx.net> wrote:
>  >
>
> >  As a sidenote. You are also cross compiling wine dlls so now and then. It would be useful to also cross compile d3d8/d3d9 and wined3d but for wined3d -DUSE_WIN32_OPENGL must be set.
>  >
>
>  Well let me know how this works for you.  I'll refactor my script a
>  bit later today but for right now you have to run this one after the
>  winetest script, as this one counts on the environment that the
>  winetest script sets up.
>
>  Script to crossbuild d3d dlls [1] and the dlls themselves [2], [3],
>  [4] are out there.
>
>
>  John
>
>  [1] http://klehm.net/wine/crossbuild_d3d_dlls.sh
>  [2] http://klehm.net/wine/d3d8.dll
>  [3] http://klehm.net/wine/d3d9.dll
>  [4] http://klehm.net/wine/wined3d.dll
>

Sorry I forgot it the first time, but you'll also need libwine.dll [1]
in addition to the other d3d dlls.  Test them out on your own window
machine with [2].  Just put them in the same directory as the program.

John

[1] http://klehm.net/wine/libwine.dll
[2] http://www.codesampler.com/source/dx8_multitexture.zip


From stefan at codeweavers.com  Fri Mar 28 07:04:34 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 28 Mar 2008 13:04:34 +0100
Subject: 2/2 WineD3D: initial post pixelshader blending support
In-Reply-To: <20080328092531.190990@gmx.net>
References: <20080328092531.190990@gmx.net>
Message-ID: <200803281304.34836.stefan@codeweavers.com>

Am Freitag, 28. M?rz 2008 10:25:31 schrieb Roderick Colenbrander:
> Hi,
>
> Store a flag whether a format supports blending in the formats table. This
> patch uses the flag in the blending code and in a few other places to
> verify if we should turn on blending for the given format. A next patch
> will also us e this flag for a CheckPixelShaderBlendingCapability call for
> CheckDeviceFormat. Later on I plan to move more of the Check*Capability
> functions over to the table.
Regarding the glDisable(GL_BLEND) in the CTXUSAGE_CLEAR setup: You have to 
mark the D3D state dirty in the context when doing that, otherwise blending 
might not be re-enabled properly on the next draw. I also think that 
disabling blending for clearing is orthogonal to the rest of the patch and 
should be done in a separate patch.

> +#define WINED3DFMT_FLAG_POSTPIXELSHADER_BLENDING 1
Maybe use 0x1 instead of 1? That will make adding new flags beyond 8 clearer.

Otherwise it looks good!




From stefan at codeweavers.com  Fri Mar 28 07:12:44 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 28 Mar 2008 13:12:44 +0100
Subject: [3/5] WineD3D: Support clipplanes with GLSL shaders
In-Reply-To: <200803280257.46649.stefan@codeweavers.com>
References: <200803280257.46649.stefan@codeweavers.com>
Message-ID: <200803281312.44946.stefan@codeweavers.com>

Am Freitag, 28. M?rz 2008 02:57:46 schrieb Stefan D?singer:
Please do not apply this patch yet. We are not sure if we should write the Z 
corrected coord as clip coord or not


From kai.blin at gmail.com  Fri Mar 28 07:34:18 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Fri, 28 Mar 2008 13:34:18 +0100
Subject: GSOC proposal: DirectPlay4
In-Reply-To: <8ec28a80803271150x2993ca08y98b15d409758f70a@mail.gmail.com>
References: <8ec28a80803271150x2993ca08y98b15d409758f70a@mail.gmail.com>
Message-ID: <200803281334.25132.kai.blin@gmail.com>

On Thursday 27 March 2008 19:50:02 Matthew Canterbury wrote:
> Hello everybody,
>
> I plan on applying for Google's Summer of Code to work on DirectPlay4
> support in wine. (This was mentioned on the ideas page,
> http://wiki.winehq.org/SummerOfCode). I've looked at the code currently in
> wine, and it looks like there is some work done, but a number of the
> functions exported in the corresponding dlls are stubs or partial stubs.
> Alot of work needs to be done to dplay to make it more compliant (or at
> least more functional).

Currently all it does is to not crash apps trying to load it. :)

> This would allow several games that depend on 
> DirectPlay to work without copying dll's from a windows partition. So I
> intend to makes sure the IDirectPlay4 COM interface is sufficiently
> implemented and that it meets the requirements set forth in in the
> DirectPlay4 specification.

Good, the idea here is to finish up the COM interface and make it send the 
appropriate dplay messages.

> If time permits, I'd like to look into the 
> Reliable Specification for DirectPlay4, but i think implementing just the
> core specification will keep me busy.

He, probably not worth the effort for now. I'd focus on the core protocol. My 
guess is that we can get all games to work without it.

You need to think about how you want to go about implementing the protocol 
step by step and what game you want to be using for testing.

Have you played with the DirectPlay dissector in Wireshark already? You need 
to get Wireshark from SVN to get the latest, greatest version of the 
dissector.

Try and get some network captures of the game you want to test to see what the 
messages look like on the wire and how a typical dplay session looks like.

Looking forward to your application,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080328/4f899ab3/attachment.pgp 

From dmitry at codeweavers.com  Fri Mar 28 07:52:19 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 28 Mar 2008 20:52:19 +0800
Subject: MinGW cross compilation fails for d3dx9_36/tests
References: <47E8C0FC.2010700@gmail.com><22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com><47E8C57C.9030708@gmail.com><22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com><47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
Message-ID: <00b601c890d2$919ac3b0$a600fea9@DMITRY>

"John Klehm" <xixsimplicityxix at gmail.com> wrote:

> The problem is that it is a mingw issue but they don't want any
> patches from wines win32 api in their mingw w32api.  They believe that
> looking at the actual ms header files taints our headers legally
> speaking.  Stefan, hans, and PaulM maintain a rather large set of
> patches against w32api.  [1]
> 
> So its a constant catchup game from when wines headers get new
> additions until someone sends paulm a patch updating the mingw w32api.

Then perhaps we (Alexandre) should reconsider the stance about using
Wine headers and import libraries in preference to mingw ones.

-- 
Dmitry.


From julliard at winehq.org  Fri Mar 28 08:35:31 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 28 Mar 2008 14:35:31 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <00b601c890d2$919ac3b0$a600fea9@DMITRY> (Dmitry Timoshkov's
	message of "Fri, 28 Mar 2008 20:52:19 +0800")
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
Message-ID: <873aqbq8d8.fsf@wine.dyndns.org>

"Dmitry Timoshkov" <dmitry at codeweavers.com> writes:

> "John Klehm" <xixsimplicityxix at gmail.com> wrote:
>
>> The problem is that it is a mingw issue but they don't want any
>> patches from wines win32 api in their mingw w32api.  They believe that
>> looking at the actual ms header files taints our headers legally
>> speaking.  Stefan, hans, and PaulM maintain a rather large set of
>> patches against w32api.  [1]
>> 
>> So its a constant catchup game from when wines headers get new
>> additions until someone sends paulm a patch updating the mingw w32api.
>
> Then perhaps we (Alexandre) should reconsider the stance about using
> Wine headers and import libraries in preference to mingw ones.

Agreed, the idea of using w32api is that we want to help improve mingw
by finding problems in their headers and libraries, but if they are not
going to accept our patches anyway, then there's clearly no point in
continuing to make our life harder by using their stuff.

-- 
Alexandre Julliard
julliard at winehq.org


From paul.vriens.wine at gmail.com  Fri Mar 28 08:41:55 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 28 Mar 2008 14:41:55 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <873aqbq8d8.fsf@wine.dyndns.org>
References: <47E8C0FC.2010700@gmail.com>	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>	<47E8C57C.9030708@gmail.com>	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>	<47EAA1C0.5050004@gmail.com>	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<873aqbq8d8.fsf@wine.dyndns.org>
Message-ID: <47ECF5A3.8090504@gmail.com>

Alexandre Julliard wrote:
> "Dmitry Timoshkov" <dmitry at codeweavers.com> writes:
> 
>> "John Klehm" <xixsimplicityxix at gmail.com> wrote:
>>
>>> The problem is that it is a mingw issue but they don't want any
>>> patches from wines win32 api in their mingw w32api.  They believe that
>>> looking at the actual ms header files taints our headers legally
>>> speaking.  Stefan, hans, and PaulM maintain a rather large set of
>>> patches against w32api.  [1]
>>>
>>> So its a constant catchup game from when wines headers get new
>>> additions until someone sends paulm a patch updating the mingw w32api.
>> Then perhaps we (Alexandre) should reconsider the stance about using
>> Wine headers and import libraries in preference to mingw ones.
> 
> Agreed, the idea of using w32api is that we want to help improve mingw
> by finding problems in their headers and libraries, but if they are not
> going to accept our patches anyway, then there's clearly no point in
> continuing to make our life harder by using their stuff.
> 

And can't we just start creating the winetest executable at winehq somewhere?

-- 
Cheers,

Paul.


From julliard at winehq.org  Fri Mar 28 08:48:42 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 28 Mar 2008 14:48:42 +0100
Subject: [PATCH 3/7] services: Start a local RPC server.
In-Reply-To: <47EBCBA4.8070504@codeweavers.com> (Robert Shearman's message of
	"Thu, 27 Mar 2008 16:30:28 +0000")
References: <47EBCBA4.8070504@codeweavers.com>
Message-ID: <87y783ot6t.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> +handle_t __RPC_USER MACHINE_HANDLEW_bind(MACHINE_HANDLEW MachineName)
> +{
> +    WCHAR transport[] = SVCCTL_TRANSPORT;
> +    WCHAR endpoint[] = SVCCTL_ENDPOINT;
> +    LPWSTR server_copy = NULL;
> +    RPC_WSTR binding_str;
> +    RPC_STATUS status;
> +    handle_t rpc_handle;
> +    
> +    /* unlike Windows we start services.exe on demand. We start it always as
> +     * checking if this is our address can be tricky */
> +    if (!check_services_exe())
> +        return NULL;

I think it would be OK to assume that services.exe is started by
wineboot and is always running, since we'll have at least the mountmgr
service running all the time.

> +/* Not the Windows event name - if needed the true one can be found in Inside Windows */
> +cpp_quote("#define SVCCTL_STARTED_EVENT (const WCHAR[]){'_','_','w','i','n','e','_','S','v','c','c','t','l','S','t','a','r','t','e','d',0}")

That's gcc-specific syntax, it would need some #ifdefs.

-- 
Alexandre Julliard
julliard at winehq.org


From fgouget at free.fr  Fri Mar 28 09:06:35 2008
From: fgouget at free.fr (Francois Gouget)
Date: Fri, 28 Mar 2008 15:06:35 +0100 (CET)
Subject: [Tools 5/6] winetest: Add statistics for the number of unit
	tests with errors or todos.
In-Reply-To: <47ECB281.4080505@gmail.com>
References: <alpine.DEB.1.00.0803262337580.10184@amboise.dolphin>
	<47ECB1FE.3020107@gmail.com> <47ECB281.4080505@gmail.com>
Message-ID: <alpine.DEB.1.00.0803281505550.26031@amboise.dolphin>

[...]
> Would this do? :
> 
> diff --git a/winetest/gather b/winetest/gather
> index 294ad06..fdacff5 100755
> --- a/winetest/gather
> +++ b/winetest/gather
> @@ -362,7 +362,7 @@ EOF
>                      "pass";
>          my $count=!$report->{todos} ? $report->{errors} :
>                    !$report->{errors} ? $report->{todos} :
> -                  "$group->{errors}+$group->{todos}";
> +                  "$report->{errors}+$report->{todos}";
> 
>          my $prcnt=!$report->{todos} ? percent($report->{errors}, $unit_count)
> :
>                    !$report->{errors} ? percent($report->{todos}, $unit_count)
> :

Yes, this patch is correct. Please, submit it to wine-patches.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
           Cahn's Axiom: When all else fails, read the instructions.


From winehacker at gmail.com  Fri Mar 28 10:25:09 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 28 Mar 2008 11:25:09 -0400
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <873aqbq8d8.fsf@wine.dyndns.org>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<873aqbq8d8.fsf@wine.dyndns.org>
Message-ID: <19e31a080803280825w3e8baf8ds42edaf0b43d60b50@mail.gmail.com>

On Fri, Mar 28, 2008 at 9:35 AM, Alexandre Julliard <julliard at winehq.org> wrote:
>  Agreed, the idea of using w32api is that we want to help improve mingw
>  by finding problems in their headers and libraries, but if they are not
>  going to accept our patches anyway, then there's clearly no point in
>  continuing to make our life harder by using their stuff.

Thank you!

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From juan.lang at gmail.com  Fri Mar 28 10:49:46 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 28 Mar 2008 08:49:46 -0700
Subject: [2/2] [try 2] Setupapi patch
Message-ID: <3a768c550803280849p4e745fb2h8fc299dd069b2798@mail.gmail.com>

Hi Alexander,

> Changelog:
> 1 - Creating device interface keys in registry as in Windows XP
> 2 - Creating DeviceInstance value in registry
> 3 - Creating SymbolicLink value in registry as in Windows XP
> 4 - SETUPDI_AddDeviceToSet: changing pointers on SP_DEVINFO_DATA after
> allocating new memory block for their array

One fix per patch, please.
--Juan


From paul.vriens.wine at gmail.com  Fri Mar 28 10:52:09 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 28 Mar 2008 16:52:09 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <877ifnqi4h.fsf@wine.dyndns.org>
References: <47E8C0FC.2010700@gmail.com>	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>	<47E8C57C.9030708@gmail.com>	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>	<47EAA1C0.5050004@gmail.com>	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<877ifnqi4h.fsf@wine.dyndns.org>
Message-ID: <47ED1429.6040308@gmail.com>

Alexandre Julliard wrote:
> "John Klehm" <xixsimplicityxix at gmail.com> writes:
> 
>> P.S. I logged some test results from my win2k machine, it seems they
>> are at [5].  Seems like I missed some setting though as the date is
>> not right.  Advice on how to fix that would be delicious =)
> 
> It's now using the git commit sha1 instead of a date when building from
> a git tree, that's a feature. I'm hoping we can standardize on that to
> make sure all test runs properly identify the exact source used.
> 

Wouldn't it be nicer to have something like:

0.9.58-06d429d6b6b6d63beaeda130a3bb261ef3b9fb41

Just a thought? The SHA's itself are not very pleasant for the eye. With the 
above you can at least group them visually.

-- 
Cheers,

Paul.


From juan.lang at gmail.com  Fri Mar 28 10:57:16 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 28 Mar 2008 08:57:16 -0700
Subject: Implement VBScript for Google Summer of Code
In-Reply-To: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
References: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
Message-ID: <3a768c550803280857o15d6546au64b95a6ce3929fff@mail.gmail.com>

Hi Jim,

>  I have this idea of implementing vbscript.dll for Google SoC. Any
>  comment would be appreciated before I start working on my proposal.

That sounds ambitious, but you're welcome to try!

>  For a few years I used to hack VB, and I know the
>  language and VBScript is just a cousin of VB. The runtime library is
>  not big, and writing it shouldn't take too much time either.

If you say so ;-)

>  I think the hardest part would be to implement the COM interfaces that
>  deal with scripting. And that's the area I know least about.

The recently added jscript stubs are probably a decent place to start.
 Getting yourself familiar with COM is probably important to the
success of your project.  I'd recommend a copy of Don Box's Essential
Com as the best way to "get" COM in a hurry.  There are plenty of
online references too, of course.

One general point is that people often don't plan for the amount of
time needed to get patches accepted--it's often more than people
realize.  You might start by trying to get a stub DLL for vbscript
accepted, just to get the hang of the development process.  Check out
the git tree, build it, make some changes, commit to it, and send the
patches in.  You'll find instructions on how to do all that on the
wiki.

Looking forward to seeing your application.  Good luck,
--Juan


From julliard at winehq.org  Fri Mar 28 11:16:32 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 28 Mar 2008 17:16:32 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47ED1429.6040308@gmail.com> (Paul Vriens's message of "Fri, 28
	Mar 2008 16:52:09 +0100")
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<877ifnqi4h.fsf@wine.dyndns.org> <47ED1429.6040308@gmail.com>
Message-ID: <87iqz6q0wv.fsf@wine.dyndns.org>

Paul Vriens <paul.vriens.wine at gmail.com> writes:

> Wouldn't it be nicer to have something like:
>
> 0.9.58-06d429d6b6b6d63beaeda130a3bb261ef3b9fb41
>
> Just a thought? The SHA's itself are not very pleasant for the
> eye. With the above you can at least group them visually.

Presentation issues should be separate from the actual id. Once all
builds are using SHA1 we can do a lot of fancy stuff in how we display
them.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Mar 28 11:22:14 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 28 Mar 2008 17:22:14 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47ECF5A3.8090504@gmail.com> (Paul Vriens's message of "Fri, 28
	Mar 2008 14:41:55 +0100")
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<873aqbq8d8.fsf@wine.dyndns.org> <47ECF5A3.8090504@gmail.com>
Message-ID: <878x02q0nd.fsf@wine.dyndns.org>

Paul Vriens <paul.vriens.wine at gmail.com> writes:

> And can't we just start creating the winetest executable at winehq somewhere?

We probably can, but how would this help?

-- 
Alexandre Julliard
julliard at winehq.org


From paul.vriens.wine at gmail.com  Fri Mar 28 11:26:21 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 28 Mar 2008 17:26:21 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <878x02q0nd.fsf@wine.dyndns.org>
References: <47E8C0FC.2010700@gmail.com>	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>	<47E8C57C.9030708@gmail.com>	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>	<47EAA1C0.5050004@gmail.com>	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>	<00b601c890d2$919ac3b0$a600fea9@DMITRY>	<873aqbq8d8.fsf@wine.dyndns.org>
	<47ECF5A3.8090504@gmail.com> <878x02q0nd.fsf@wine.dyndns.org>
Message-ID: <47ED1C2D.20005@gmail.com>

Alexandre Julliard wrote:
> Paul Vriens <paul.vriens.wine at gmail.com> writes:
> 
>> And can't we just start creating the winetest executable at winehq somewhere?
> 
> We probably can, but how would this help?
> 

It wouldn't help as we will face the same issues. It's just that it seems more 
logical to create this where multiple resources have access in case there are 
issues.

We need a place where people can download the latest winetest executable and in 
the past it has been proven difficult to have it available all the time. Despite 
the excellent work that Paul Millar (and of course Hans and Stefan) is doing.

So having this at winehq has nothing to do with fixing this particular issue.

-- 
Cheers,

Paul.


From rob at codeweavers.com  Fri Mar 28 11:52:53 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 28 Mar 2008 16:52:53 +0000
Subject: [PATCH 3/7] services: Start a local RPC server.
In-Reply-To: <87y783ot6t.fsf@wine.dyndns.org>
References: <47EBCBA4.8070504@codeweavers.com> <87y783ot6t.fsf@wine.dyndns.org>
Message-ID: <47ED2265.5000103@codeweavers.com>

Alexandre Julliard wrote:
> Robert Shearman <rob at codeweavers.com> writes:
>
>   
>> +handle_t __RPC_USER MACHINE_HANDLEW_bind(MACHINE_HANDLEW MachineName)
>> +{
>> +    WCHAR transport[] = SVCCTL_TRANSPORT;
>> +    WCHAR endpoint[] = SVCCTL_ENDPOINT;
>> +    LPWSTR server_copy = NULL;
>> +    RPC_WSTR binding_str;
>> +    RPC_STATUS status;
>> +    handle_t rpc_handle;
>> +    
>> +    /* unlike Windows we start services.exe on demand. We start it always as
>> +     * checking if this is our address can be tricky */
>> +    if (!check_services_exe())
>> +        return NULL;
>>     
>
> I think it would be OK to assume that services.exe is started by
> wineboot and is always running, since we'll have at least the mountmgr
> service running all the time.
>   

I'm not sure that is a valid assumption, as we could have an option to 
disable wineboot in the future due to performance reasons.

>> +/* Not the Windows event name - if needed the true one can be found in Inside Windows */
>> +cpp_quote("#define SVCCTL_STARTED_EVENT (const WCHAR[]){'_','_','w','i','n','e','_','S','v','c','c','t','l','S','t','a','r','t','e','d',0}")
>>     
>
> That's gcc-specific syntax, it would need some #ifdefs.

Well spotted. I'll fix that.

-- 
Rob Shearman



From rob at codeweavers.com  Fri Mar 28 12:02:05 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 28 Mar 2008 17:02:05 +0000
Subject: amstream: IMediaStream::GetMultiMediaStream
In-Reply-To: <47EC3C4A.4000908@gmail.com>
References: <47EC3C4A.4000908@gmail.com>
Message-ID: <47ED248D.1040402@codeweavers.com>

Nikolay Sivov wrote:
> @@ -109,9 +109,14 @@
>  {
>      IMediaStreamImpl *This = (IMediaStreamImpl *)iface;
>  
> -    FIXME("(%p/%p)->(%p) stub!\n", This, iface, ppMultiMediaStream); 
> +    TRACE("(%p/%p)->(%p)\n", This, iface, ppMultiMediaStream);
>  
> -    return S_FALSE;
> +    if(!(*ppMultiMediaStream))
> +        return E_POINTER;
> +
> +    *ppMultiMediaStream = This->Parent;
> +
> +    return S_OK;
>  }
>   

Although I haven't looked at the context, you also likely need to add a 
reference to the returned COM object here.

-- 
Rob Shearman



From julliard at winehq.org  Fri Mar 28 12:38:16 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 28 Mar 2008 18:38:16 +0100
Subject: [PATCH 3/7] services: Start a local RPC server.
In-Reply-To: <47ED2265.5000103@codeweavers.com> (Robert Shearman's message of
	"Fri, 28 Mar 2008 16:52:53 +0000")
References: <47EBCBA4.8070504@codeweavers.com>
	<87y783ot6t.fsf@wine.dyndns.org> <47ED2265.5000103@codeweavers.com>
Message-ID: <874paqpx4n.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> I'm not sure that is a valid assumption, as we could have an option to
> disable wineboot in the future due to performance reasons.

I don't think we want to support that. On the contrary, we want to move
more of the startup processing that we currently do for every process
into wineboot, so that it is done only once per session. This requires
that we can guarantee that wineboot is always executed.

We may of course make some of the more expensive parts of wineboot
optional, but starting services.exe shouldn't be in the expensive
category (and if it is that should be fixed).

-- 
Alexandre Julliard
julliard at winehq.org


From htl10 at users.sourceforge.net  Fri Mar 28 13:12:15 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Fri, 28 Mar 2008 18:12:15 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <015b01c88fc0$edbdc970$a600fea9@DMITRY>
Message-ID: <20080328181219.34725.qmail@web23101.mail.ird.yahoo.com>

--- On Thu, 27/3/08, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> "Vitaliy Margolen" <wine-devel at kievinfo.com>
> wrote:
> 
> > Looks like a time to start blacklisting fonts then. If
> the font is invalid 
> > and does not work even on windows yet it is available
> in the system - that's 
> > the only thing Wine can do. Or just contact all
> distros to remove it. Or 
> > request packagers to refuse installing Wine if said
> font found in the system.
> 
> Black listing the fonts is not an appropriate
> fix/workaround. There is
> already a fixed version of ukai.ttf, and a broken one was
> causing problems
> in a lot of native programs besides Wine.

I think blacklisting is not a good approach - what one wants is really "white-listing": 
given microsoft only ships a certain number of fonts, wine should provide emulation/substitutions of *only* those fonts fron known open-source alternatives,
rather than expose the whole of fontconfig-available fonts to win32 applications.
And applications should only expect to get those known MS fonts (or clones/substitutes).

OTOH, ukai (or one of its Arphic derivative sibings) is fairly critical for most 
chinese-reading person :-). 

I am not sure "There is a fixed version of ukai" - from the codeweaver wiki and freedesktop's web site, I have the latest ukai release via redhat, and the wiki seems 
to suggests a non-debian mod older ukai to replace a debian-modified one. 
So my finger-pointing tendency would say that somehow a debian ukai modification which breaks gdiplus has got into freedesktop uptream... 


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Inbox http://uk.docs.yahoo.com/nowyoucan.html


From winehacker at gmail.com  Fri Mar 28 13:27:03 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 28 Mar 2008 14:27:03 -0400
Subject: SoC idea: enhance the Program Manager, winefile and friends
Message-ID: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>

Hi All,

From thestig at google.com  Fri Mar 28 13:31:41 2008
From: thestig at google.com (Lei Zhang)
Date: Fri, 28 Mar 2008 11:31:41 -0700
Subject: gdi32-related commit between 0.9.57<->0.9.58broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <20080328181219.34725.qmail@web23101.mail.ird.yahoo.com>
References: <015b01c88fc0$edbdc970$a600fea9@DMITRY>
	<20080328181219.34725.qmail@web23101.mail.ird.yahoo.com>
Message-ID: <558b2f5c0803281131m274f7d3ya2a61a5f81d08d10@mail.gmail.com>

On Fri, Mar 28, 2008 at 11:12 AM, Hin-Tak Leung
<htl10 at users.sourceforge.net> wrote:
>  I think blacklisting is not a good approach - what one wants is really "white-listing":
>  given microsoft only ships a certain number of fonts, wine should provide emulation/substitutions of *only* those fonts fron known open-source alternatives,
>  rather than expose the whole of fontconfig-available fonts to win32 applications.
>  And applications should only expect to get those known MS fonts (or clones/substitutes).

Umm, I have friends who are font fanatics that have thousands of fonts
installed on their system. If they can do that on Windows, they
certainly should be able to do that on Linux. Are you suggesting we a)
limit ourselves to only support what ships with Windows, and ignore
all other fonts out there, or b) create a white list for every known
font out there?

>  OTOH, ukai (or one of its Arphic derivative sibings) is fairly critical for most
>  chinese-reading person :-).
>
>  I am not sure "There is a fixed version of ukai" - from the codeweaver wiki and freedesktop's web site, I have the latest ukai release via redhat, and the wiki seems
>  to suggests a non-debian mod older ukai to replace a debian-modified one.
>  So my finger-pointing tendency would say that somehow a debian ukai modification which breaks gdiplus has got into freedesktop uptream...

AFAIK, the bad version of the ukai font is 20060928. It shiped with
Ubuntu Feisty [1], Gutsy [2], and FC 8 [3]. Possibly with other
distros as well, I have not done an exhaustive search. Just don't use
that version and you should be fine.

[1] http://packages.ubuntu.com/feisty/ttf-arphic-ukai
[2] http://packages.ubuntu.com/gutsy/ttf-arphic-ukai
[3] http://rpm.pbone.net/index.php3/stat/4/idpl/5312345/com/cjkunifonts-ukai-0.1.20060928-4.fc8.noarch.rpm.html


From msclrhd at googlemail.com  Fri Mar 28 08:35:07 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Fri, 28 Mar 2008 13:35:07 +0000
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <00b601c890d2$919ac3b0$a600fea9@DMITRY>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
Message-ID: <3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>

On 28/03/2008, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> "John Klehm" <xixsimplicityxix at gmail.com> wrote:
>
> > The problem is that it is a mingw issue but they don't want any
>  > patches from wines win32 api in their mingw w32api.  They believe that
>  > looking at the actual ms header files taints our headers legally
>  > speaking.  Stefan, hans, and PaulM maintain a rather large set of
>  > patches against w32api.  [1]
>  >
>  > So its a constant catchup game from when wines headers get new
>  > additions until someone sends paulm a patch updating the mingw w32api.
>
> Then perhaps we (Alexandre) should reconsider the stance about using
>  Wine headers and import libraries in preference to mingw ones.

I would have expected that when building for mingw, Wine would use the
Wine headers and libraries. Otherwise, as mentioned above, if someone
adds tests that rely on items that are not in the mingw headers then
the tests will not be built for the conformance tests, as has been
seen recently. Also, what happens with the widl generated headers?

- Reece


From winehacker at gmail.com  Fri Mar 28 13:53:49 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 28 Mar 2008 14:53:49 -0400
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
Message-ID: <19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>

On Fri, Mar 28, 2008 at 9:35 AM, Reece Dunn <msclrhd at googlemail.com> wrote:
>  I would have expected that when building for mingw, Wine would use the
>  Wine headers and libraries. Otherwise, as mentioned above, if someone
>  adds tests that rely on items that are not in the mingw headers then
>  the tests will not be built for the conformance tests, as has been
>  seen recently. Also, what happens with the widl generated headers?

We have always depended on the w32api package for the tests and
programs partly to make sure our own code is sane by having another
coverage point like building with the MSVC headers when compiling on
MSVC. Dmitry and I have disagreed with this for years though because
the mingw w32api maintainers can be a real PITA about getting patches
in and also because of the breakages that result when something is
missing like you mention. Switching to a using the wine headers and
import libs everywhere is long overdue and welcome!

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From truiken at gmail.com  Fri Mar 28 14:01:22 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 28 Mar 2008 14:01:22 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
	<19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>
Message-ID: <22821af30803281201m61f97a09g50ab810d0d73b60e@mail.gmail.com>

On Fri, Mar 28, 2008 at 1:53 PM, Steven Edwards <winehacker at gmail.com> wrote:
> On Fri, Mar 28, 2008 at 9:35 AM, Reece Dunn <msclrhd at googlemail.com> wrote:
>  >  I would have expected that when building for mingw, Wine would use the
>  >  Wine headers and libraries. Otherwise, as mentioned above, if someone
>  >  adds tests that rely on items that are not in the mingw headers then
>  >  the tests will not be built for the conformance tests, as has been
>  >  seen recently. Also, what happens with the widl generated headers?
>
>  We have always depended on the w32api package for the tests and
>  programs partly to make sure our own code is sane by having another
>  coverage point like building with the MSVC headers when compiling on
>  MSVC. Dmitry and I have disagreed with this for years though because
>  the mingw w32api maintainers can be a real PITA about getting patches
>  in and also because of the breakages that result when something is
>  missing like you mention. Switching to a using the wine headers and
>  import libs everywhere is long overdue and welcome!
>

What is the process for making this switch?  Do we need to contact
Paul Millar?  The lack of a new winetest is putting a hamper on our
efforts to fix up the tests in Windows.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Fri Mar 28 14:08:30 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 28 Mar 2008 12:08:30 -0700
Subject: Implement VBScript for Google Summer of Code
In-Reply-To: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
References: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
Message-ID: <b130c85e0803281208h544d526ft574b73e80020e596@mail.gmail.com>

Hi Jim,

2008/3/27, Jim Chen <jim at darchons.net>:
> Hi everyone,
>
>  I have this idea of implementing vbscript.dll for Google SoC. Any
>  comment would be appreciated before I start working on my proposal.
>
>  The reason for implementing vbscript.dll is because right now there's
>  nothing in the trunk about it. jscript.dll has a stub, but
>  vbscript.dll doesn't, and it's an area that I think I can work on.
>  VBScript is used by the Windows Installer, can be potentially be used
>  for DirectMusic script (from http://wiki.winehq.org/DirectX-ToDo), and
>  some applications use it.
>
>  Just the core language/runtime (vbscript.dll) is implemented, no extra
>  COM/OLE objects such as FSO (file system object), etc. (unless I have
>  time). The language by itself is designed to be simple and easy, so an
>  interpreter shouldn't be hard. I wrote a C-style script interpreter in
>  Java this past year. For a few years I used to hack VB, and I know the
>  language and VBScript is just a cousin of VB. The runtime library is
>  not big, and writing it shouldn't take too much time either.
>
>  I think the hardest part would be to implement the COM interfaces that
>  deal with scripting. And that's the area I know least about.
I don't know if you could do all of it in 3 months, what if it takes
longer, would you still be interested in continuing work on it? COM
isn't that hard, if you run into troubles with it a lot of wine
developers know about it, and there are a lot of good com examples in
the wine code.

Cheers,
Maarten.


From wine.dev at web.de  Fri Mar 28 14:19:56 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Fri, 28 Mar 2008 20:19:56 +0100
Subject: DLL exports... HELP?! (wine based win32 printer drivers for
	openprinting)
In-Reply-To: <494035.78583.qm@web23110.mail.ird.yahoo.com>
References: <494035.78583.qm@web23110.mail.ird.yahoo.com>
Message-ID: <1206731997.8726.19.camel@p4>

On Mi, 2008-03-26 at 14:47 +0000, Hin-Tak Leung wrote:
> Wow :-). I have almost wanted to suggest such a native wine-based
> printer driver 
> as a linux foundation/openprinting GOSC project (I am one of the
> mentors under the
> openprinting umbrella
> https://www.linux-foundation.org/en/Google_Summer_of_Code). 
> I am glad I didn't :-).
> 

I'm away for the weekend, but some quick notes:

- The ddiwrapper-hack works only with a very small amount of
  self-contained drivers
- Most Drivers today are plugins for the unidrv or the pscipt5 Driver
  (you can install pscript5 from Adobe since ~ 1/2 Year)
- Drivers expect dlls, that are not present in wine-2005*
  (They will not load)
- Rendering with full Drivers (Raster-Mode) need most Eng* Functions
  and Friends (This is the DIB-Engine).
- Rendering with full Drivers (Postscript) need some Eng* Functions
  and Friends.
  Nothing in this Area is implemented / exported in current Wine:
  Driver will not load
- Sending the rendered Data to the Printer need sometimes a vendor-
  specific Portmonitor / Languagemonitor
  (Not supported in current Wine)



-- 
 
By by ... Detlef




From winehacker at gmail.com  Fri Mar 28 14:22:53 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 28 Mar 2008 15:22:53 -0400
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <22821af30803281201m61f97a09g50ab810d0d73b60e@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
	<19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>
	<22821af30803281201m61f97a09g50ab810d0d73b60e@mail.gmail.com>
Message-ID: <19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>

On Fri, Mar 28, 2008 at 3:01 PM, James Hawkins <truiken at gmail.com> wrote:
>  What is the process for making this switch?  Do we need to contact
>  Paul Millar?  The lack of a new winetest is putting a hamper on our
>  efforts to fix up the tests in Windows.

There should just be a few rules that need to be changed as far as I
know. Thats all that was needed for the programs case, I cannot Imagen
why the tests would be any more complex. If Alexandre has not already
done so, I'll look at it and submit patches tonight.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From jacek at codeweavers.com  Fri Mar 28 15:11:37 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Fri, 28 Mar 2008 20:11:37 +0000
Subject: Implement VBScript for Google Summer of Code
In-Reply-To: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
References: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
Message-ID: <47ED50F9.50208@codeweavers.com>

Jim Chen wrote:
> Hi everyone,
>
> I have this idea of implementing vbscript.dll for Google SoC. Any
> comment would be appreciated before I start working on my proposal.
>   
It would be great to have vbscript.dll implemented in Wine and I hope 
that some day we will have it, but I think you underestimate amount of 
work on it. It's a much bigger task than the usual SoC projects, IMO. 
Please do some research before deciding to work on it. I've found Eric 
Lippert's blog very useful for information about active scripts
http://blogs.msdn.com/ericlippert/default.aspx
esp. the archive from 2004. If you'll decide to apply for this project, 
please describe it well enough so we know that you can accomplish it.


Jacek


From leslie_alistair at hotmail.com  Fri Mar 28 15:16:47 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Sat, 29 Mar 2008 07:16:47 +1100
Subject: mscoree: Add missing interfaces
References: <fsg1am$7ip$1@ger.gmane.org>
Message-ID: <fsjjmn$h8s$1@ger.gmane.org>

"Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote in message 
news:fsg1am$7ip$1 at ger.gmane.org...
> Hi,
>
> Changelog:
> mscoree: Add missing interfaces
>
Anything wrong with this patch?

Best Regards
 Alistair Leslie-Hughes 




From juan.lang at gmail.com  Fri Mar 28 15:18:03 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 28 Mar 2008 13:18:03 -0700
Subject: SoC idea: enhance the Program Manager, winefile and friends
In-Reply-To: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
Message-ID: <3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>

>  From time to time the discussion comes up about having some sort of
>  Window manager or explorer replacement for when running in Desktop
>  mode.

Personally, I think enhancing explorer to have its own GUI (rather
than launching winefile) would be an interesting project.  If nothing
else, having a graphical way to explore the shell namespace might be
handy for debugging shell issues.  From there to an explorer for
desktop mode might not be such a big leap.

--Juan


From brian.vincent at gmail.com  Fri Mar 28 15:39:59 2008
From: brian.vincent at gmail.com (Brian Vincent)
Date: Fri, 28 Mar 2008 14:39:59 -0600
Subject: SoC idea: enhance the Program Manager, winefile and friends
In-Reply-To: <3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
Message-ID: <3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>

Hasn't someone else somewhere in the world already written an explorer
replacement and we could just get them to open source it so we can
include it with Wine?  No need to reinvent the wheel.

-Brian

On Fri, Mar 28, 2008 at 2:18 PM, Juan Lang <juan.lang at gmail.com> wrote:
> >  From time to time the discussion comes up about having some sort of
>  >  Window manager or explorer replacement for when running in Desktop
>  >  mode.
>
>  Personally, I think enhancing explorer to have its own GUI (rather
>  than launching winefile) would be an interesting project.  If nothing
>  else, having a graphical way to explore the shell namespace might be
>  handy for debugging shell issues.  From there to an explorer for
>  desktop mode might not be such a big leap.
>
>  --Juan
>
>
>


From juan.lang at gmail.com  Fri Mar 28 15:40:51 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 28 Mar 2008 13:40:51 -0700
Subject: SoC idea: enhance the Program Manager, winefile and friends
In-Reply-To: <3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
	<3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>
Message-ID: <3a768c550803281340m398fd884mf381980d5a3220cc@mail.gmail.com>

> Hasn't someone else somewhere in the world already written an explorer
>  replacement and we could just get them to open source it so we can
>  include it with Wine?  No need to reinvent the wheel.

There's the ReactOS one, but it's written in C++.  I don't know of any
ANSI C ones, but maybe I haven't looked hard enough.
--Juan


From austinenglish at gmail.com  Fri Mar 28 15:50:53 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 28 Mar 2008 15:50:53 -0500
Subject: SoC idea: enhance the Program Manager, winefile and friends
In-Reply-To: <3a768c550803281340m398fd884mf381980d5a3220cc@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
	<3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>
	<3a768c550803281340m398fd884mf381980d5a3220cc@mail.gmail.com>
Message-ID: <b6bb06270803281350h676c3334h238fd9cd4047696c@mail.gmail.com>

On Fri, Mar 28, 2008 at 3:40 PM, Juan Lang <juan.lang at gmail.com> wrote:
> > Hasn't someone else somewhere in the world already written an explorer
>  >  replacement and we could just get them to open source it so we can
>  >  include it with Wine?  No need to reinvent the wheel.
>
>  There's the ReactOS one, but it's written in C++.  I don't know of any
>  ANSI C ones, but maybe I haven't looked hard enough.
>  --Juan
>
>
>

http://www.google.com/search?q=windows+explorer+replacement&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a

List of windows explorer replacements:
http://gladiator-antivirus.com/forum/index.php?showtopic=50712&pid=167091&mode=threaded&show=&st=&

Here's direct links to a few I found:
http://www.xyplorer.com/index.htm
http://mustangpeak.net/
http://www.download32.com/directory-opus-i30453.html
http://www.explorerxp.com/
http://www.discount-softwares.com/soft/Utility/File_Disk_Management/9079_universal_explorer.htm

There's even an open source one (in visual basic though, bleh)
http://sourceforge.net/projects/pc-viewer


From juan.lang at gmail.com  Fri Mar 28 15:54:31 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 28 Mar 2008 13:54:31 -0700
Subject: SoC idea: enhance the Program Manager, winefile and friends
In-Reply-To: <b6bb06270803281350h676c3334h238fd9cd4047696c@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
	<3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>
	<3a768c550803281340m398fd884mf381980d5a3220cc@mail.gmail.com>
	<b6bb06270803281350h676c3334h238fd9cd4047696c@mail.gmail.com>
Message-ID: <3a768c550803281354x538b5381tde13d17a0ae297@mail.gmail.com>

>  http://www.google.com/search?q=windows+explorer+replacement&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a

Um.. yeah, I've heard of google, thanks.  How many are written in ANSI C?

Find me one of those, and I'll retract my suggestion as a SoC project.
 My suggestion is moot unless someone actually applies to do that
though.
--Juan


From stefan at codeweavers.com  Fri Mar 28 16:25:53 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 28 Mar 2008 22:25:53 +0100
Subject: wined3d: Improve detection of device palette change.
In-Reply-To: <47ED4833.3060609@inbox.lv>
References: <47ED4833.3060609@inbox.lv>
Message-ID: <200803282225.53467.stefan@codeweavers.com>

Am Freitag, 28. M?rz 2008 20:34:11 schrieb Alexander Dorofeyev:
>      ENTER_GL();
> +    if (This->resource.format == WINED3DFMT_P8 || This->resource.format == 
> WINED3DFMT_A8P8) {
> +         for (i = 0; i < This->baseTexture.levels; i++) {
> +            if(palette9_changed((IWineD3DSurfaceImpl *)This->surfaces[i])){
Why are you doing this inside ENTER_GL? I think LoadLocation locks on its own.


From stefan at codeweavers.com  Fri Mar 28 16:25:53 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 28 Mar 2008 22:25:53 +0100
Subject: wined3d: Improve detection of device palette change.
In-Reply-To: <47ED4833.3060609@inbox.lv>
References: <47ED4833.3060609@inbox.lv>
Message-ID: <200803282225.53467.stefan@codeweavers.com>

Am Freitag, 28. M?rz 2008 20:34:11 schrieb Alexander Dorofeyev:
>      ENTER_GL();
> +    if (This->resource.format == WINED3DFMT_P8 || This->resource.format == 
> WINED3DFMT_A8P8) {
> +         for (i = 0; i < This->baseTexture.levels; i++) {
> +            if(palette9_changed((IWineD3DSurfaceImpl *)This->surfaces[i])){
Why are you doing this inside ENTER_GL? I think LoadLocation locks on its own.


From xixsimplicityxix at gmail.com  Fri Mar 28 16:45:18 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 28 Mar 2008 16:45:18 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com> <47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
	<19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>
	<22821af30803281201m61f97a09g50ab810d0d73b60e@mail.gmail.com>
	<19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
Message-ID: <78a7dad00803281445y7f357b25t114057370cbfcbfd@mail.gmail.com>

On Fri, Mar 28, 2008 at 2:22 PM, Steven Edwards <winehacker at gmail.com> wrote:
> On Fri, Mar 28, 2008 at 3:01 PM, James Hawkins <truiken at gmail.com> wrote:
>  >  What is the process for making this switch?  Do we need to contact
>  >  Paul Millar?  The lack of a new winetest is putting a hamper on our
>  >  efforts to fix up the tests in Windows.
>
>  There should just be a few rules that need to be changed as far as I
>  know. Thats all that was needed for the programs case, I cannot Imagen
>  why the tests would be any more complex. If Alexandre has not already
>  done so, I'll look at it and submit patches tonight.
>

Winetest with todays git [1]

John

[1] http://klehm.net/wine/20080328-winetest-438868f37796e387cd6f6db5da1f73a7017b6e00.exe


From alexd4 at inbox.lv  Fri Mar 28 16:37:32 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Fri, 28 Mar 2008 23:37:32 +0200
Subject: wined3d: Improve detection of device palette change.
In-Reply-To: <200803282225.53467.stefan@codeweavers.com>
References: <47ED4833.3060609@inbox.lv>
	<200803282225.53467.stefan@codeweavers.com>
Message-ID: <47ED651C.9090805@inbox.lv>

Hi.

I just put it nearby other somewhat related calls. This code doesn't really need 
ENTER_GL/LEAVE_GL, but there's a bigger problem that this ENTER_GL/LEAVE_GL in 
PreLoad is around other routines too that mostly don't need it and leads to 
ActivateContext being called inside it etc. I've already sent a patch to remove 
ENTER_GL/LEAVE_GL in PreLoad, but it wasn't fully ok. I plan to fix and resend 
the latter patch after issues are taken care of (a bit of lack of consistency 
with holding / not-holding the lock in LoadLocation and its helper routines).

Stefan D?singer wrote:
> Am Freitag, 28. M?rz 2008 20:34:11 schrieb Alexander Dorofeyev:
>>      ENTER_GL();
>> +    if (This->resource.format == WINED3DFMT_P8 || This->resource.format == 
>> WINED3DFMT_A8P8) {
>> +         for (i = 0; i < This->baseTexture.levels; i++) {
>> +            if(palette9_changed((IWineD3DSurfaceImpl *)This->surfaces[i])){
> Why are you doing this inside ENTER_GL? I think LoadLocation locks on its own.



From a_villacis at palosanto.com  Fri Mar 28 17:13:40 2008
From: a_villacis at palosanto.com (=?ISO-8859-1?Q?Alex_Villac=ED=ADs_Lasso?=)
Date: Fri, 28 Mar 2008 17:13:40 -0500
Subject: winex11.drv: Don't add owned windows to the taskbar
In-Reply-To: <000f01c88ef6$21f7dc10$a600fea9@DMITRY>
References: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com>	<47E95728.8090202@inbox.lv>
	<000f01c88ef6$21f7dc10$a600fea9@DMITRY>
Message-ID: <47ED6D94.3090403@palosanto.com>

Dmitry Timoshkov escribio':
> "Alexander Dorofeyev" <alexd4 at inbox.lv> wrote:
>
>   
>> There's a regression in IDA Pro disassembler. Nothing is added to the taskbar at 
>> all, furthermore, when you are starting debugger, before there was a window 
>> appearing that asks pass control to the application or not. Now it's not 
>> appearing, and can't be found because there's nothing on the taskbar, which is 
>> pretty bad because the app doesn't respond to any other input at that moment. 
>> Minimizing  the main window makes the app disappear altogether, so it's pretty 
>> unusable.
>>     
>
> The problem with IDA is that the button you see in the Windows task bar
> does not belong to the main IDA window, it belongs to a zero sized visible
> window with the same caption. Since it's zero sized Wine doesn't map it all.
> So, while formally it's a regression, technically it's not: main IDA window
> has never been added to the task bar before my patch. This all can be easily
> discovered with spy++ and a simple test app.
>
>   
This also affects many, if not all, VB6 applications (and possibly many 
Delphi applications). Personally, I consider this a rather serious 
regression and propose backing out of commit 
cb3ff54789c652b02d852f40db71cafd9fd67ca9 as a fix.

BTW, this reminds me of bug 1598. If the explanation of the bug for IDA 
above is correct, then the "buggy" behavior of not assigning 
minimize/maximize buttons to the window that appears in the panel is 
sort of consistent with this regression. Maybe the behavior should be 
that visible windows owned by an invisible window should get mapped in 
the panel.

-- 
perl -e '$x=2.4;print sprintf("%.0f + %.0f = %.0f\n",$x,$x,$x+$x);'



From stefan at codeweavers.com  Fri Mar 28 17:39:04 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 28 Mar 2008 23:39:04 +0100
Subject: wined3d: Improve detection of device palette change.
In-Reply-To: <47ED651C.9090805@inbox.lv>
References: <47ED4833.3060609@inbox.lv>
	<200803282225.53467.stefan@codeweavers.com>
	<47ED651C.9090805@inbox.lv>
Message-ID: <200803282339.04546.stefan@codeweavers.com>

Am Freitag, 28. M?rz 2008 22:37:32 schrieb Alexander Dorofeyev:
> Hi.
>
> I just put it nearby other somewhat related calls. This code doesn't really
> need ENTER_GL/LEAVE_GL, but there's a bigger problem that this
> ENTER_GL/LEAVE_GL in PreLoad is around other routines too that mostly don't
> need it and leads to ActivateContext being called inside it etc. I've
> already sent a patch to remove ENTER_GL/LEAVE_GL in PreLoad, but it wasn't
> fully ok. I plan to fix and resend the latter patch after issues are taken
> care of (a bit of lack of consistency with holding / not-holding the lock
> in LoadLocation and its helper routines).
Ok, I am fine with this patch if the ENTER_GL/LEAVE_GL stuff needs a different 
fix anyway





From bunglehead at gmail.com  Fri Mar 28 19:15:31 2008
From: bunglehead at gmail.com (Nikolay Sivov)
Date: Sat, 29 Mar 2008 03:15:31 +0300
Subject: [Fwd: gdi32: PlgBlt implementation (resend)]
Message-ID: <47ED8A23.2070606@gmail.com>

What about this patch?

> Changelog (since first patch):
>     - HAVE_FLOAT_H used for #include
>     - all declarations moved to the beginning


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: bitblt.c.patch3
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080329/ea4815b1/attachment.txt 

From jim at darchons.net  Fri Mar 28 19:15:52 2008
From: jim at darchons.net (Jim Chen)
Date: Fri, 28 Mar 2008 20:15:52 -0400
Subject: Implement VBScript for Google Summer of Code
In-Reply-To: <b130c85e0803281208h544d526ft574b73e80020e596@mail.gmail.com>
References: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
	<b130c85e0803281208h544d526ft574b73e80020e596@mail.gmail.com>
Message-ID: <8133cc9f0803281715v1a4b29fdk46ede3a7644cc585@mail.gmail.com>

On Fri, Mar 28, 2008 at 3:08 PM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Hi Jim,
>
>  2008/3/27, Jim Chen <jim at darchons.net>:
>
>
> > Hi everyone,
>  >
>  >  I have this idea of implementing vbscript.dll for Google SoC. Any
>  >  comment would be appreciated before I start working on my proposal.
>  >
>  >  The reason for implementing vbscript.dll is because right now there's
>  >  nothing in the trunk about it. jscript.dll has a stub, but
>  >  vbscript.dll doesn't, and it's an area that I think I can work on.
>  >  VBScript is used by the Windows Installer, can be potentially be used
>  >  for DirectMusic script (from http://wiki.winehq.org/DirectX-ToDo), and
>  >  some applications use it.
>  >
>  >  Just the core language/runtime (vbscript.dll) is implemented, no extra
>  >  COM/OLE objects such as FSO (file system object), etc. (unless I have
>  >  time). The language by itself is designed to be simple and easy, so an
>  >  interpreter shouldn't be hard. I wrote a C-style script interpreter in
>  >  Java this past year. For a few years I used to hack VB, and I know the
>  >  language and VBScript is just a cousin of VB. The runtime library is
>  >  not big, and writing it shouldn't take too much time either.
>  >
>  >  I think the hardest part would be to implement the COM interfaces that
>  >  deal with scripting. And that's the area I know least about.
>  I don't know if you could do all of it in 3 months, what if it takes
>  longer, would you still be interested in continuing work on it? COM
>  isn't that hard, if you run into troubles with it a lot of wine
>  developers know about it, and there are a lot of good com examples in
>  the wine code.
>
>  Cheers,
>  Maarten.
>

Of course, if I end up doing it I will finish it till it's done. Isn't
that one of GSoC's purposes, to stay involved even after the program
ends? But obviously I still need to accomplish things during the
program so that's why I'm still doing research on it, to see how much
time I might need to get at least something done. I'm OK with the
basic COM stuff. IUnknown doesn't scar  e me :) But for more advanced
stuff, I'm sure I'll need to ask around.

Thanks!
Jim


From jim at darchons.net  Fri Mar 28 19:40:59 2008
From: jim at darchons.net (Jim Chen)
Date: Fri, 28 Mar 2008 20:40:59 -0400
Subject: Implement VBScript for Google Summer of Code
In-Reply-To: <47ED50F9.50208@codeweavers.com>
References: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
	<47ED50F9.50208@codeweavers.com>
Message-ID: <8133cc9f0803281740n1552db0dx18b1c9584b4fc2a9@mail.gmail.com>

On Fri, Mar 28, 2008 at 4:11 PM, Jacek Caban <jacek at codeweavers.com> wrote:
> Jim Chen wrote:
>  > Hi everyone,
>  >
>  > I have this idea of implementing vbscript.dll for Google SoC. Any
>  > comment would be appreciated before I start working on my proposal.
>  >
>  It would be great to have vbscript.dll implemented in Wine and I hope
>  that some day we will have it, but I think you underestimate amount of
>  work on it. It's a much bigger task than the usual SoC projects, IMO.
>  Please do some research before deciding to work on it. I've found Eric
>  Lippert's blog very useful for information about active scripts
>  http://blogs.msdn.com/ericlippert/default.aspx
>  esp. the archive from 2004. If you'll decide to apply for this project,
>  please describe it well enough so we know that you can accomplish it.
>
>
>  Jacek
>

Wow thanks for the link! Surprisingly useful (for something from MS :D)
I've been doing research and I understand it will be a huge effort.
I've already applied to the windowless Rich Edit project, which will
most likely be easier than this, but I think this one will be more
exciting because it's more challenging :) I'm more than willing to
continue after SoC if I end up working on it. I don't have to
implement the newest version either, with support for classes, etc. If
I just implement VBScript say up to 2.0 that's within reach, I think.

Thanks again!
Jim


From winehacker at gmail.com  Fri Mar 28 22:52:30 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 28 Mar 2008 23:52:30 -0400
Subject: SoC idea: enhance the Program Manager, winefile and friends
In-Reply-To: <3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
Message-ID: <19e31a080803282052u136eeb07r230e9eb497c618c4@mail.gmail.com>

Hey Juan!

On Fri, Mar 28, 2008 at 4:18 PM, Juan Lang <juan.lang at gmail.com> wrote:
>  Personally, I think enhancing explorer to have its own GUI (rather
>  than launching winefile) would be an interesting project.  If nothing
>  else, having a graphical way to explore the shell namespace might be
>  handy for debugging shell issues.  From there to an explorer for
>  desktop mode might not be such a big leap.

Enhancing our explorer to be a full explorer replacement would be cool
with me too, there were just a few reasons I suggested using Program
Manager and Winefile rather than trying to extend explorer for the UI

1. Its kind of massive and I don't think we need all of that for
desktop mode. I view desktop mode as kind of a corner case that only
should be used like 5% of the time.
2. We have winefile and the Program Manager already and both are in
really bad shape. They have for the most part bit-rotted in the tree
for as long as I can remember. It would be nice to see them polished
for Wine 1.0
3. This is just my taste but I don't really like having a Window style
explorer bar running in a window. It would make Wine feel more like a
VM like environment to me. Maybe we want that for Desktop mode to
further try to discourage users from running it, like case 1.

I'd like to see when Desktop mode is invoked, a working Program
Manager launch that already has program groups for all of the
installed Shortcuts plus existing Winelib applications we ship in the
tree. Perhaps even a My Computer group minimized with support for the
Shell Namespace builtin and or support for launching winefile with
shellnamespace support. I know its a bit of a departure from the
normal Windows UI and some may even say using the Program Manager like
that is a throwback to Windows 3.1 but it just seems like it would
flow better from a UI perspective. Plus it would leverage the code we
already have in tree.

All of that being said I don't know if I could mentor such a project
anyway, just throwing out ideas. As with everything it really comes
down to what Julliard wants.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Sat Mar 29 00:58:42 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sat, 29 Mar 2008 01:58:42 -0400
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com> <47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
	<19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>
	<22821af30803281201m61f97a09g50ab810d0d73b60e@mail.gmail.com>
	<19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
Message-ID: <19e31a080803282258y5af80babp404ddc4f0d7e27d@mail.gmail.com>

On Fri, Mar 28, 2008 at 3:22 PM, Steven Edwards <winehacker at gmail.com> wrote:
>  There should just be a few rules that need to be changed as far as I
>  know. Thats all that was needed for the programs case, I cannot Imagen
>  why the tests would be any more complex. If Alexandre has not already
>  done so, I'll look at it and submit patches tonight.

The rules for building the import libs has changed quite a bit since
the last time I looked at them and I am not quite sure about how to
fix a couple of problems so I'll wait for Alexandre to comment.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sat Mar 29 02:55:34 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 29 Mar 2008 15:55:34 +0800
Subject: winex11.drv: Don't add owned windows to the taskbar
References: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com>	<47E95728.8090202@inbox.lv><000f01c88ef6$21f7dc10$a600fea9@DMITRY>
	<47ED6D94.3090403@palosanto.com>
Message-ID: <01d101c89172$47da7ea0$a600fea9@DMITRY>

"Alex Villac??s Lasso" <a_villacis at palosanto.com> wrote:

>> The problem with IDA is that the button you see in the Windows task bar
>> does not belong to the main IDA window, it belongs to a zero sized visible
>> window with the same caption. Since it's zero sized Wine doesn't map it all.
>> So, while formally it's a regression, technically it's not: main IDA window
>> has never been added to the task bar before my patch. This all can be easily
>> discovered with spy++ and a simple test app.
>>
>>
> This also affects many, if not all, VB6 applications (and possibly many
> Delphi applications). Personally, I consider this a rather serious
> regression and propose backing out of commit
> cb3ff54789c652b02d852f40db71cafd9fd67ca9 as a fix.
>
> BTW, this reminds me of bug 1598. If the explanation of the bug for IDA
> above is correct, then the "buggy" behavior of not assigning
> minimize/maximize buttons to the window that appears in the panel is
> sort of consistent with this regression. Maybe the behavior should be
> that visible windows owned by an invisible window should get mapped in
> the panel.

1598 is closed as fixed, and I have no idea how missing minimize/maximize
buttons are related to owned windows, and why you think that it's somehow
related to the visibility of an owner.

What you need to be fixed is making a zero sized window with WS_VISIBLE
style set mapped, but X11/WMs doesn't handle that gracefully.

-- 
Dmitry. 



From julliard at winehq.org  Sat Mar 29 03:45:30 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 29 Mar 2008 09:45:30 +0100
Subject: winex11.drv: Connect to XIM server dynamically.
In-Reply-To: <200803290623351147810006MA71@nm06mta.auone-net.jp> (Kusanagi
	Kouichi's message of "Sat, 29 Mar 2008 15:23:34 +0900")
References: <200803290623351147810006MA71@nm06mta.auone-net.jp>
Message-ID: <87sky9sytx.fsf@wine.dyndns.org>

Kusanagi Kouichi <slash at ma.neweb.ne.jp> writes:

> If I want to use XIM, I must start XIM server before wine.
> Furthermore, if XIM server stops, wine can't use XIM again
> even if XIM server restarts.

You are changing too many things at once in your patches, including
things that don't necessarily need to be changed. Please try to do your
changes in smaller chunks.

-- 
Alexandre Julliard
julliard at winehq.org


From kwixbit at gmail.com  Sat Mar 29 05:12:16 2008
From: kwixbit at gmail.com (Warren Dumortier)
Date: Sat, 29 Mar 2008 11:12:16 +0100
Subject: Sims: Pet Stories Bug?
Message-ID: <f3a003030803290312s5b2d680bgb151050806a7b8b6@mail.gmail.com>

Hello everybody!

I send this mail because I made a bug report some time ago and nobody is
looking to help...
Here's the bug: http://bugs.winehq.org/show_bug.cgi?id=11946, is there any
person who could make this game work?

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080329/40e3f4f3/attachment.htm 

From paul at astro.gla.ac.uk  Sat Mar 29 06:01:15 2008
From: paul at astro.gla.ac.uk (Paul Millar)
Date: Sat, 29 Mar 2008 12:01:15 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <19e31a080803282258y5af80babp404ddc4f0d7e27d@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
	<19e31a080803282258y5af80babp404ddc4f0d7e27d@mail.gmail.com>
Message-ID: <200803291201.22475.paul@astro.gla.ac.uk>

Hi all,

I've added support in MinGW support for d3dx9 (with help from Stefan Leichter, 
thanks!) and a build has now gone through.  New results should start to 
appear as people upload their results.

On Saturday 29 March 2008 06:58:42 Steven Edwards wrote:
> On Fri, Mar 28, 2008 at 3:22 PM, Steven Edwards <winehacker at gmail.com> 
wrote:
> >  [...] If Alexandre has not already done so, I'll look at it and
> >  submit patches tonight. 
>
> The rules for building the import libs has changed quite a bit since
> the last time I looked at them and I am not quite sure about how to
> fix a couple of problems so I'll wait for Alexandre to comment.

I, too, was going to have a look at this (but, if you want to do it, Steven, 
feel free ;-).  I'm not sure how best to approach this, though.

Cheers,

Paul.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080329/e7bc411e/attachment-0001.pgp 

From stefandoesinger at gmx.at  Sat Mar 29 06:22:08 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 29 Mar 2008 12:22:08 +0100
Subject: Sims: Pet Stories Bug?
In-Reply-To: <f3a003030803290312s5b2d680bgb151050806a7b8b6@mail.gmail.com>
References: <f3a003030803290312s5b2d680bgb151050806a7b8b6@mail.gmail.com>
Message-ID: <200803291222.08993.stefandoesinger@gmx.at>

Am Samstag, 29. M?rz 2008 11:12:16 schrieb Warren Dumortier:
> Hello everybody!
>
> I send this mail because I made a bug report some time ago and nobody is
> looking to help...
> Here's the bug: http://bugs.winehq.org/show_bug.cgi?id=11946, is there any
> person who could make this game work?
I'm sorry, but open source projects do not work that way. Filed bug reports do 
not get lost, but we do not promise any bug response time as well.

Usually I send bug reports back to the end of my list when people become too 
naggy, but I've had a quick look at it:

> trace:d3d:IWineD3DDeviceImpl_SetVertexShaderConstantF (iface 0x3aacff8,
> srcData 0x20f80b0, start 0, count 1024) 
It's the same problem as Sims 2, we need software vertex shader emulation for 
this game.



From htl10 at users.sourceforge.net  Sat Mar 29 11:03:22 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Sat, 29 Mar 2008 16:03:22 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <558b2f5c0803281131m274f7d3ya2a61a5f81d08d10@mail.gmail.com>
Message-ID: <472646.42281.qm@web23108.mail.ird.yahoo.com>

--- On Fri, 28/3/08, Lei Zhang <thestig at google.com> wrote:

> From: Lei Zhang <thestig at google.com>
<snipped>
> Umm, I have friends who are font fanatics that have
> thousands of fonts
> installed on their system. If they can do that on Windows,
> they
> certainly should be able to do that on Linux. Are you
> suggesting we a)
> limit ourselves to only support what ships with Windows,
> and ignore
> all other fonts out there, or b) create a white list for
> every known
> font out there?

I don't have an answer to that - in a different machine, I have maybe a 100 
chinese fonts of various level of obcurity :-). but it is going to be a
nightmare for the wine developers to allow random fonts to break some part of it.

<snipped>


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Inbox http://uk.docs.yahoo.com/nowyoucan.html


From spedrosa at gmail.com  Sat Mar 29 11:20:13 2008
From: spedrosa at gmail.com (Stephen Eilert)
Date: Sat, 29 Mar 2008 13:20:13 -0300
Subject: Sims: Pet Stories Bug?
In-Reply-To: <200803291222.08993.stefandoesinger@gmx.at>
References: <f3a003030803290312s5b2d680bgb151050806a7b8b6@mail.gmail.com>
	<200803291222.08993.stefandoesinger@gmx.at>
Message-ID: <47EE6C3D.9020306@gmail.com>

Stefan D?singer wrote:
> Am Samstag, 29. M?rz 2008 11:12:16 schrieb Warren Dumortier:
>   
>> Hello everybody!
>>
>> I send this mail because I made a bug report some time ago and nobody is
>> looking to help...
>> Here's the bug: http://bugs.winehq.org/show_bug.cgi?id=11946, is there any
>> person who could make this game work?
>>     
> I'm sorry, but open source projects do not work that way. Filed bug reports do 
> not get lost, but we do not promise any bug response time as well.
>
> Usually I send bug reports back to the end of my list when people become too 
> naggy, but I've had a quick look at it:
>
>   
>> trace:d3d:IWineD3DDeviceImpl_SetVertexShaderConstantF (iface 0x3aacff8,
>> srcData 0x20f80b0, start 0, count 1024) 
>>     
> It's the same problem as Sims 2, we need software vertex shader emulation for 
> this game.
>
>
>
>   
Wouldn't that be a suitable project for the Summer of Code?


Stephen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080329/a92184ab/attachment.htm 

From truiken at gmail.com  Sat Mar 29 13:00:31 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 29 Mar 2008 13:00:31 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <200803291201.22475.paul@astro.gla.ac.uk>
References: <47E8C0FC.2010700@gmail.com>
	<19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
	<19e31a080803282258y5af80babp404ddc4f0d7e27d@mail.gmail.com>
	<200803291201.22475.paul@astro.gla.ac.uk>
Message-ID: <22821af30803291100u530c7329x315021e222fefb7b@mail.gmail.com>

On Sat, Mar 29, 2008 at 6:01 AM, Paul Millar <paul at astro.gla.ac.uk> wrote:
> Hi all,
>
>  I've added support in MinGW support for d3dx9 (with help from Stefan Leichter,
>  thanks!) and a build has now gone through.  New results should start to
>  appear as people upload their results.
>
>

Thanks Paul!

-- 
James Hawkins


From wine-devel at kievinfo.com  Sat Mar 29 13:30:12 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 29 Mar 2008 12:30:12 -0600
Subject: Two more janitorial tasks
Message-ID: <47EE8AB4.80107@kievinfo.com>

This is a bit more involved then regular janitorial task, but pretty small 
never the less. It is for some one who wants to get their feet wet in Wine.

Convert all console applications (net, regsvr32, eject, msiexec, etc) to 
unicode (see cmd for example). This is to better support international 
translations.

Use WriteConsoleW to output text to the console instead printf & co. Again 
for better support of the international translations and to avoid bugs in 
Wine's msvcrt which prints to the wrong terminal.

Vitaliy.


From stefan at codeweavers.com  Sat Mar 29 14:49:27 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 29 Mar 2008 20:49:27 +0100
Subject: Sims: Pet Stories Bug?
In-Reply-To: <47EE6C3D.9020306@gmail.com>
References: <f3a003030803290312s5b2d680bgb151050806a7b8b6@mail.gmail.com>
	<200803291222.08993.stefandoesinger@gmx.at>
	<47EE6C3D.9020306@gmail.com>
Message-ID: <200803292049.27540.stefan@codeweavers.com>

Am Samstag, 29. M?rz 2008 17:20:13 schrieb Stephen Eilert:
> > It's the same problem as Sims 2, we need software vertex shader emulation
> > for this game.
>
> Wouldn't that be a suitable project for the Summer of Code?
Maybe, but it has rather huge requirements:

-> The amount of work is HUGE(ok, we can limit it to e.g. Shader model 1.1)
-> There is some integration work to do(a bit easier since my shader/pipeline 
model changes)
-> It requires very good knowledge about x86 / x86_64 assembler
-> Mapping the shader instructions on regular FPUs is rather hard

So if there is someone who really enjoys coding in assembler and has excellent 
knowledge about it I am tempted to agree with shader emulation as a GSoC 
project. It surely isn't a project for a novice programmer.


From hintak_leung at yahoo.co.uk  Sat Mar 29 10:57:08 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Sat, 29 Mar 2008 15:57:08 +0000 (GMT)
Subject: DLL exports... HELP?!
In-Reply-To: <47EA38DF.3060501@gmx.net>
Message-ID: <229656.50098.qm@web23112.mail.ird.yahoo.com>

There are two comments about the tarball - it is a tbz2 file (not tar.gz as the name implied). and it does build alright with mingw, with a little editing.
There is a header problem (which seems to be newly introduced compared to the older(?) GSOC submission), and a couple of compiler warnings which should be fixed.

BTW, I am using mingw-cross gcc 4.2.1(?), probably shows a bit more warnings than 3.4.5. 
and I think cross-compiler built from the mingw camp tends to have i386-mingw-* rather
than i586-mingw-*; some 3rd party distributes i586-mingw-*'s. In any case, i386-mingw-*
is what I have. (I did build the cross-compiler myself, rather than a downloaded binary).

--- On Wed, 26/3/08, Marcel Partap <mpartap at gmx.net> wrote:

> From: Marcel Partap <mpartap at gmx.net>
> Subject: Re: DLL exports... HELP?!
> To: pure_evil at mail.bg
> Cc: wine-devel at winehq.org
> Date: Wednesday, 26 March, 2008, 11:51 AM
> Hi Stefanov,
> attached is the code of a standalone proxy DLL I developed
> last year during SoC, have a look 
> especially at the makefile for cross-compilation...
> regards marcel.
> 
> -- 
> <div id="signature">
>    "Obstacles are those frightful things you see when
> you take your eyes off your goal."
>                                                            
>    -- Henry Ford (1863-1947)
>    Change the world! Vote revolution:
> http://hfopi.org/vote-future
> </div>


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Inbox http://uk.docs.yahoo.com/nowyoucan.html


From hintak_leung at yahoo.co.uk  Sat Mar 29 10:51:44 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Sat, 29 Mar 2008 15:51:44 +0000 (GMT)
Subject: DLL exports... HELP?! (wine based win32 printer drivers for
	openprinting)
In-Reply-To: <1206731997.8726.19.camel@p4>
Message-ID: <15655.45446.qm@web23112.mail.ird.yahoo.com>

I had a better look at the wine 2007 GSOC work - works quite alright, found my CUPS
spooler; I am surprised that it uses the registry. It builds alright with mingw cross compiler (I have it around for other stuff and reasonably familiar with it), but a little surprised that there are a few compiler warnings which should be fixed,
for code base this small.

--- On Fri, 28/3/08, Detlef Riekenberg <wine.dev at web.de> wrote:
<snipped>
> I'm away for the weekend, but some quick notes:
> 
> - The ddiwrapper-hack works only with a very small amount
> of
>   self-contained drivers

Yes, but say, a GSOC project for distinguishing which are self-contained and which are not?

I haven't got round to look at ddiwrapper yet, but it is in my hard disc now. 

> - Most Drivers today are plugins for the unidrv or the
> pscipt5 Driver
>   (you can install pscript5 from Adobe since ~ 1/2 Year)
> - Drivers expect dlls, that are not present in wine-2005*
>   (They will not load)
> - Rendering with full Drivers (Raster-Mode) need most Eng*
> Functions
>   and Friends (This is the DIB-Engine).
> - Rendering with full Drivers (Postscript) need some Eng*
> Functions
>   and Friends.
>   Nothing in this Area is implemented / exported in current
> Wine:
>   Driver will not load

The time frame - GSOC work being a little after wine 1.0 (and the merge of the other work) - should be interesting and useful?

> - Sending the rendered Data to the Printer need sometimes a
> vendor-
>   specific Portmonitor / Languagemonitor
>   (Not supported in current Wine)

Yes, I think the epson epl windows driver does that...

A personal question: would be like to be involved if a student comes along, or in general in this area? (I looked it up, you were the mentor for the 2007 wine project for the printerproxy).


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Inbox http://uk.docs.yahoo.com/nowyoucan.html


From Andrew.Talbot at talbotville.com  Sat Mar 29 15:47:49 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 29 Mar 2008 20:47:49 +0000
Subject: ws2_32 janitorial questions
Message-ID: <fsm9tm$msj$1@ger.gmane.org>

Hi,

ws2_32/async.c has the following global declarations:

/* protoptypes of some functions in socket.c
 */
UINT16 wsaErrno(void);
UINT16 wsaHerrno(int errnr);

ws2_32/socket.c has the following global declarations:

UINT wsaErrno(void);
UINT wsaHerrno(int errnr);

Where are these functions defined? And, assuming that the above are
conflicting declarations, what type does each of these functions actually
return?

Thanks,

-- 
Andy.




From mle+win at mega-nerd.com  Sat Mar 29 20:24:03 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 30 Mar 2008 12:24:03 +1100
Subject: find_dll_file ignoring WINEDLLPATH?
Message-ID: <20080330122403.02d947a3.mle+win@mega-nerd.com>

Hi all,

I have a windows executable named floating_point_test.exe which
requires a windows DLL that is in another directory. I'm trying
to run the exe from the current dir using:

    WINEDLLPATH="/path/to/dll:$WINEDLLPATH" wine floating_point_test.exe

but wine is not able to find the DLL. I've traced through the code
and ended up in the file dlls/ntdll/loader.c and the function
find_dll_file (). I've added a few printfs and found that when
looking for my DLL, the code ends up in a section with the following
comment:

    /* if libname doesn't contain a path at all, we simply return the name as is,
     * to be loaded as builtin */

It seems that this function makes no use of WINEDLLPATH. Shouldn't
this function also search along the paths specified by the
environment variable?

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"I could never learn to use C++, because of the completely
overwhelming desire to redesign the language every time I tried
to use it, but this is the normal, healthy reaction to C++."
-- Erik Naggum


From mle+win at mega-nerd.com  Sat Mar 29 21:31:13 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 30 Mar 2008 13:31:13 +1100
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <20080330122403.02d947a3.mle+win@mega-nerd.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
Message-ID: <20080330133113.a8a4a594.mle+win@mega-nerd.com>

Erik de Castro Lopo wrote:

> It seems that this function makes no use of WINEDLLPATH. Shouldn't
> this function also search along the paths specified by the
> environment variable?

I've grepped the sources and the only place that looks at 
WINEDLLPATH is the funcion build_dll_path() in libs/wine/loader.c.

The function build_dll_path() fills in an array dll_paths with
is private to that file. Looking at other things in that file
it seems that stuff in that file is mostly related to loading
the native Linux versions of the windows DLLs. Is that right?
If so, it looks like some of the code in libs/wine/loader.c
needs to be cloned or shared with the code in
dlls/ntdll/loader.c.

I'm willing to hack up a fix for this if someone can point me
in the right direction.

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
Open Source and Free Software means that you never sacrifice quality
of the code for meeting deadlines set up by people not participating
directly in the software development process.
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"Patents are bad for the software industry.."
-- Bill Gates in 1991


From mpartap at gmx.net  Sat Mar 29 23:03:08 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Sun, 30 Mar 2008 06:03:08 +0200
Subject: DLL exports... HELP?! (wine based win32 printer drivers
	for	openprinting)
In-Reply-To: <15655.45446.qm@web23112.mail.ird.yahoo.com>
References: <15655.45446.qm@web23112.mail.ird.yahoo.com>
Message-ID: <47EF10FC.2060905@gmx.net>

Hi Hin-Tak,
no no misunderstanding ;) ...that printer proxy does exactly what the name says: it's only purpose 
is to log the calls a printer driver receives from the windows spooler. And yes, somehow some 
glitches creeped in ^ ^
The rest of my work - as Detlef has already stated - depends on a lot of stuff that has yet to be 
implemented (huw is working on the DIB engine..). Anyways, I am working on getting something 
merged.. For now the target is to get the Adobe pscript5 driver working which has its own raster 
renderer and thus does not depend on the dib engine. Just started by making AddPrinter correctly get 
a default devmode out of the driver, patch is attached, detlef please comment on it (and hope you 
got to your family dinner in time...;)
regards marcel.


-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-winspool-localspl-native-driver-dll-calls.patch
Type: text/x-patch
Size: 0 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080330/ac9250dc/attachment-0001.bin 

From mpartap at gmx.net  Sat Mar 29 22:13:16 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Sun, 30 Mar 2008 05:13:16 +0200
Subject: [PATCH] winspool & localspl native driver dll calls
Message-ID: <mailman.301.1206849805.3731.wine-devel@winehq.org>

---
 dlls/localspl/localspl_main.c |   16 ++++++-
 dlls/winspool.drv/info.c      |   97 +++++++++++++++++++++++++++++++---------
 include/ddk/winddiui.h        |   17 +++++++
 3 files changed, 107 insertions(+), 23 deletions(-)

diff --git a/dlls/localspl/localspl_main.c b/dlls/localspl/localspl_main.c
index 77fb730..30628bd 100644
--- a/dlls/localspl/localspl_main.c
+++ b/dlls/localspl/localspl_main.c
@@ -29,6 +29,7 @@
 #include "winreg.h"
 #include "winspool.h"
 #include "ddk/winsplp.h"
+#include "ddk/winddiui.h"
 #include "winuser.h"
 
 #include "wine/debug.h"
@@ -62,6 +63,7 @@ HINSTANCE LOCALSPL_hInstance = NULL;
 
 static const PRINTPROVIDOR * pp = NULL;
 
+static PFN_DrvDriverEvent pDrvDriverEvent = NULL;
 
 static const WCHAR backslashW[] = {'\\',0};
 static const WCHAR configuration_fileW[] = {'C','o','n','f','i','g','u','r','a','t','i','o','n',' ','F','i','l','e',0};
@@ -408,6 +410,7 @@ static BOOL WINAPI myAddPrinterDriverEx(DWORD level, LPBYTE pDriverInfo, DWORD d
     DWORD   disposition;
     DWORD   len;
     LONG    lres;
+    HINSTANCE   hcfgdll;
 
     /* we need to set all entries in the Registry, independent from the Level of
        DRIVER_INFO, that the caller supplied */
@@ -525,7 +528,18 @@ static BOOL WINAPI myAddPrinterDriverEx(DWORD level, LPBYTE pDriverInfo, DWORD d
     if (level > 5) TRACE("level %u for Driver %s is incomplete\n", level, debugstr_w(di.pName));
 
     RegCloseKey(hdrv);
-    TRACE("### DrvDriverEvent(...,DRIVEREVENT_INITIALIZE) not implemented yet\n");
+
+    apd.dst[apd.dstlen] = '\0';
+    lstrcatW(apd.dst, di.pConfigFile);
+    hcfgdll = LoadLibraryW(apd.dst);
+    if (hcfgdll) {
+        pDrvDriverEvent = (void*)GetProcAddress(hcfgdll, "DrvDriverEvent");
+        if (pDrvDriverEvent) {
+            lres = pDrvDriverEvent(DRIVER_EVENT_INITIALIZE, 3, (LPBYTE)&di, (LPARAM)NULL);
+            TRACE("DrvDriverEvent returned %d\n", lres);
+        }
+        FreeLibrary(hcfgdll);
+    }
 
     TRACE("=> TRUE with %u\n", GetLastError());
     return TRUE;
diff --git a/dlls/winspool.drv/info.c b/dlls/winspool.drv/info.c
index dadc61f..6229d41 100644
--- a/dlls/winspool.drv/info.c
+++ b/dlls/winspool.drv/info.c
@@ -56,6 +56,7 @@
 #include "wine/debug.h"
 #include "wine/list.h"
 #include "winnls.h"
+#include "ddk/winddiui.h"
 
 #include "ddk/winsplp.h"
 #include "wspool.h"
@@ -147,6 +148,7 @@ static INT (WINAPI *GDI_CallExtDeviceMode16)( HWND hwnd, LPDEVMODEA lpdmOutput,
                                               LPSTR lpszDevice, LPSTR lpszPort,
                                               LPDEVMODEA lpdmInput, LPSTR lpszProfile,
                                               DWORD fwMode );
+static PFN_DrvDocumentPropertySheets pDrvDocumentPropertySheets = NULL;
 
 static const WCHAR DriversW[] = { 'S','y','s','t','e','m','\\',
                                   'C','u', 'r','r','e','n','t','C','o','n','t','r','o','l','S','e','t','\\',
@@ -2136,6 +2138,49 @@ LONG WINAPI DocumentPropertiesA(HWND hWnd,HANDLE hPrinter,
     return ret;
 }
 
+/*****************************************************************************
+ *  WINSPOOL_CallDrvDocumentProperties (internal)
+ * calls native driver's DrvDocumentProperties
+ */
+static LONG WINSPOOL_CallDrvDocumentProperties(HANDLE hPrinter, LPWSTR pDeviceName,
+                                               LPDEVMODEW pdmOut, LPDEVMODEW pdmIn,
+                                               DWORD fMode)
+{
+    DRIVER_INFO_2W *di;
+    DWORD needed;
+    HINSTANCE hcfgdll;
+    DOCUMENTPROPERTYHEADER dph;
+    LONG lres;
+
+    GetPrinterDriverW(hPrinter, NULL, 2, NULL, 0, &needed);
+    di = HeapAlloc(GetProcessHeap(), 0, needed);
+    if (!GetPrinterDriverW(hPrinter, NULL, 2, di, needed, &needed)) {
+        ERR("GetPrinterDriver failed on %p\n", hPrinter);
+        return -1;
+    }
+    hcfgdll = LoadLibraryW(di->pConfigFile);
+    if (!hcfgdll) {
+       ERR("LoadLibrary failed on %s\n", debugstr_w(di->pConfigFile));
+       return -1;
+    }
+    pDrvDocumentPropertySheets = (void*)GetProcAddress(hcfgdll, "DrvDocumentPropertySheets");
+    if (!pDrvDocumentPropertySheets) {
+        ERR("GetProcAddress could not find DrvDocumentPropertySheets in %s\n", debugstr_w(di->pConfigFile));
+        return -1;
+    }
+    TRACE("hcfgdll=%p pDrvDocumentPropertySheets=%p\n", hcfgdll, pDrvDocumentPropertySheets);
+    memset(&dph, 0, sizeof(dph));
+    dph.cbSize = sizeof(dph);
+    dph.hPrinter = hPrinter;
+    dph.pszPrinterName = pDeviceName;
+    dph.pdmIn = pdmIn;
+    dph.pdmOut = pdmOut;
+    dph.fMode = fMode;
+    lres = pDrvDocumentPropertySheets(NULL, &dph);
+    TRACE("returning %d needed = %d\n", lres, dph.cbOut);
+    FreeLibrary(hcfgdll);
+    return lres;
+}
 
 /*****************************************************************************
  *          DocumentPropertiesW (WINSPOOL.@)
@@ -2158,15 +2203,24 @@ LONG WINAPI DocumentPropertiesW(HWND hWnd, HANDLE hPrinter,
 	  fMode);
     if(pDevModeOutput) {
         ret = DocumentPropertiesA(hWnd, hPrinter, pDeviceNameA, NULL, NULL, 0);
-	if(ret < 0) return ret;
-	pDevModeOutputA = HeapAlloc(GetProcessHeap(), 0, ret);
+	if(ret > 0) pDevModeOutputA = HeapAlloc(GetProcessHeap(), 0, ret);
     }
     ret = DocumentPropertiesA(hWnd, hPrinter, pDeviceNameA, pDevModeOutputA,
 			      pDevModeInputA, fMode);
-    if(pDevModeOutput) {
+    if(pDevModeOutputA) {
         DEVMODEcpyAtoW(pDevModeOutput, pDevModeOutputA);
 	HeapFree(GetProcessHeap(),0,pDevModeOutputA);
     }
+
+    /* handle native 32-bit drivers (only unicode/W) */
+    if (ret <= 0) {
+        if (!hPrinter) {
+            OpenPrinterW(pDeviceName, &hPrinter, NULL);
+        }
+        ret = WINSPOOL_CallDrvDocumentProperties(hPrinter, pDeviceName, pDevModeOutput,
+                                                                  pDevModeInput, fMode);
+    }
+
     if(fMode == 0 && ret > 0)
         ret += (CCHDEVICENAME + CCHFORMNAME);
     HeapFree(GetProcessHeap(),0,pDevModeInputA);
@@ -3073,6 +3127,24 @@ HANDLE WINAPI AddPrinterW(LPWSTR pName, DWORD Level, LPBYTE pPrinter)
     RegSetValueExW(hkeyPrinter, attributesW, 0, REG_DWORD,
 		   (LPBYTE)&pi->Attributes, sizeof(DWORD));
     set_reg_szW(hkeyPrinter, DatatypeW, pi->pDatatype);
+    set_reg_szW(hkeyPrinter, DescriptionW, pi->pComment);
+    set_reg_szW(hkeyPrinter, LocationW, pi->pLocation);
+    set_reg_szW(hkeyPrinter, NameW, pi->pPrinterName);
+    set_reg_szW(hkeyPrinter, ParametersW, pi->pParameters);
+
+    set_reg_szW(hkeyPrinter, PortW, pi->pPortName);
+    set_reg_szW(hkeyPrinter, Print_ProcessorW, pi->pPrintProcessor);
+    set_reg_szW(hkeyPrinter, Printer_DriverW, pi->pDriverName);
+    RegSetValueExW(hkeyPrinter, priorityW, 0, REG_DWORD,
+                   (LPBYTE)&pi->Priority, sizeof(DWORD));
+    set_reg_szW(hkeyPrinter, Separator_FileW, pi->pSepFile);
+    set_reg_szW(hkeyPrinter, Share_NameW, pi->pShareName);
+    RegSetValueExW(hkeyPrinter, start_timeW, 0, REG_DWORD,
+                   (LPBYTE)&pi->StartTime, sizeof(DWORD));
+    RegSetValueExW(hkeyPrinter, statusW, 0, REG_DWORD,
+                   (LPBYTE)&pi->Status, sizeof(DWORD));
+    RegSetValueExW(hkeyPrinter, until_timeW, 0, REG_DWORD,
+                   (LPBYTE)&pi->UntilTime, sizeof(DWORD));
 
     /* See if we can load the driver.  We may need the devmode structure anyway
      *
@@ -3119,25 +3191,6 @@ HANDLE WINAPI AddPrinterW(LPWSTR pName, DWORD Level, LPBYTE pPrinter)
         if(!pi->pDevMode)
             HeapFree(GetProcessHeap(), 0, dmW);
     }
-    set_reg_szW(hkeyPrinter, DescriptionW, pi->pComment);
-    set_reg_szW(hkeyPrinter, LocationW, pi->pLocation);
-    set_reg_szW(hkeyPrinter, NameW, pi->pPrinterName);
-    set_reg_szW(hkeyPrinter, ParametersW, pi->pParameters);
-
-    set_reg_szW(hkeyPrinter, PortW, pi->pPortName);
-    set_reg_szW(hkeyPrinter, Print_ProcessorW, pi->pPrintProcessor);
-    set_reg_szW(hkeyPrinter, Printer_DriverW, pi->pDriverName);
-    RegSetValueExW(hkeyPrinter, priorityW, 0, REG_DWORD,
-                   (LPBYTE)&pi->Priority, sizeof(DWORD));
-    set_reg_szW(hkeyPrinter, Separator_FileW, pi->pSepFile);
-    set_reg_szW(hkeyPrinter, Share_NameW, pi->pShareName);
-    RegSetValueExW(hkeyPrinter, start_timeW, 0, REG_DWORD,
-                   (LPBYTE)&pi->StartTime, sizeof(DWORD));
-    RegSetValueExW(hkeyPrinter, statusW, 0, REG_DWORD,
-                   (LPBYTE)&pi->Status, sizeof(DWORD));
-    RegSetValueExW(hkeyPrinter, until_timeW, 0, REG_DWORD,
-                   (LPBYTE)&pi->UntilTime, sizeof(DWORD));
-
     RegCloseKey(hkeyPrinter);
     RegCloseKey(hkeyPrinters);
     if(!OpenPrinterW(pi->pPrinterName, &retval, NULL)) {
diff --git a/include/ddk/winddiui.h b/include/ddk/winddiui.h
index 7c6e775..0650416 100644
--- a/include/ddk/winddiui.h
+++ b/include/ddk/winddiui.h
@@ -22,6 +22,7 @@
 #define __WINE_WINDDIUI_H
 
 #include <ddk/compstui.h>
+#include <wingdi.h>
 
 #ifdef __cplusplus
 extern "C" {
@@ -40,9 +41,25 @@ extern "C" {
 
 #define PRINTER_EVENT_FLAG_NO_UI 1
 
+typedef struct _DOCUMENTPROPERTYHEADER {
+    WORD cbSize;
+    WORD Reserved;
+    HANDLE hPrinter;
+    LPWSTR pszPrinterName;
+    PDEVMODEW pdmIn;
+    PDEVMODEW pdmOut;
+    DWORD cbOut;
+    DWORD fMode;
+} DOCUMENTPROPERTYHEADER, *PDOCUMENTPROPERTYHEADER;
+
+LONG WINAPI DrvDocumentPropertySheets(PPROPSHEETUI_INFO, LPARAM);
 BOOL WINAPI DrvDriverEvent(DWORD, DWORD, LPBYTE, LPARAM);
 BOOL WINAPI DrvPrinterEvent(LPWSTR, INT, DWORD, LPARAM);
 
+typedef LONG WINAPI (*PFN_DrvDocumentPropertySheets)(PPROPSHEETUI_INFO, LPARAM);
+typedef BOOL WINAPI (*PFN_DrvDriverEvent)(DWORD, DWORD, LPBYTE, LPARAM);
+typedef BOOL WINAPI (*PFN_DrvPrinterEvent)(LPWSTR, INT, DWORD, LPARAM);
+
 #ifdef __cplusplus
 } /* extern "C" */
 #endif
-- 
1.5.4.4


--------------040200000709000007010901--


From jjmckenzie51 at sprintpcs.com  Sat Mar 29 23:11:09 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 29 Mar 2008 21:11:09 -0700
Subject: SoC idea: enhance the Program Manager, winefile and friends -
	Converting VB program to ANSI C for Windows Explorer replacement.
In-Reply-To: <b6bb06270803281350h676c3334h238fd9cd4047696c@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
	<3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>
	<3a768c550803281340m398fd884mf381980d5a3220cc@mail.gmail.com>
	<b6bb06270803281350h676c3334h238fd9cd4047696c@mail.gmail.com>
Message-ID: <47EF12DD.8030103@sprintpcs.com>

Austin English wrote:
> On Fri, Mar 28, 2008 at 3:40 PM, Juan Lang <juan.lang at gmail.com> wrote:
>   
>>> Hasn't someone else somewhere in the world already written an explorer
>>>       
>>  >  replacement and we could just get them to open source it so we can
>>  >  include it with Wine?  No need to reinvent the wheel.
>>
>>  There's the ReactOS one, but it's written in C++.  I don't know of any
>>  ANSI C ones, but maybe I haven't looked hard enough.
>>  --Juan
>>
>>
>>
>>     
>
> http://www.google.com/search?q=windows+explorer+replacement&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a
>
> List of windows explorer replacements:
> http://gladiator-antivirus.com/forum/index.php?showtopic=50712&pid=167091&mode=threaded&show=&st=&
>
> Here's direct links to a few I found:
> http://www.xyplorer.com/index.htm
> http://mustangpeak.net/
> http://www.download32.com/directory-opus-i30453.html
> http://www.explorerxp.com/
> http://www.discount-softwares.com/soft/Utility/File_Disk_Management/9079_universal_explorer.htm
>
> There's even an open source one (in visual basic though, bleh)
> http://sourceforge.net/projects/pc-viewer
>
>   
It has been asked if any of these are written in ANSI C, how about 
converting the last one into ANSI C?  That would definitely be a mind 
expanding project, IMHO.  I've done language conversion in the past, and 
would do so now, if I had the available resource, time.   Would that be 
a good GSOC project?

James McKenzie


From winehacker at gmail.com  Sat Mar 29 23:29:19 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 30 Mar 2008 00:29:19 -0400
Subject: SoC idea: enhance the Program Manager,
	winefile and friends - Converting VB program to ANSI C for Windows
	Explorer replacement.
In-Reply-To: <47EF12DD.8030103@sprintpcs.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
	<3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>
	<3a768c550803281340m398fd884mf381980d5a3220cc@mail.gmail.com>
	<b6bb06270803281350h676c3334h238fd9cd4047696c@mail.gmail.com>
	<47EF12DD.8030103@sprintpcs.com>
Message-ID: <19e31a080803292129v3081cf52v519e82d4af2bed2@mail.gmail.com>

On Sun, Mar 30, 2008 at 12:11 AM, James McKenzie
<jjmckenzie51 at sprintpcs.com> wrote:
>  It has been asked if any of these are written in ANSI C, how about
>  converting the last one into ANSI C?  That would definitely be a mind
>  expanding project, IMHO.  I've done language conversion in the past, and
>  would do so now, if I had the available resource, time.   Would that be
>  a good GSOC project?

The real problem is most of the work needs to be done in shell32 not
explorer. If you look at Thomas Widenmullers explorer-new verses the
old ReactOS explorer (which is still default) you'll see that most of
windows explorer actually lives there and not enough of the shell
namespace and friends is actually implemented. Thats partly another
reason I suggested using Program Manager and Winefile. For examples
see below. I know linking to ReactOS code is normally not  acceptable
policy here but both the author of explorer Martin Fuchs and
explorer-new Thomas Widenmuller, have contributed quite a bit to Wine
in the past and besides, its obvious there is no way in hell they are
derived from Windows.

http://svn.reactos.org/svn/reactos/trunk/reactos/base/shell/explorer/
http://svn.reactos.org/svn/reactos/trunk/reactos/base/shell/explorer-new/

Explorer-new is written in C but it neither works on ReactOS or Wine
at this time. I don't think basing our explorer off of a third party
shell replacement that duplicated functionality that needs to be
reimplemented in shell32 is a good idea.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From xixsimplicityxix at gmail.com  Sun Mar 30 02:38:05 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Sun, 30 Mar 2008 02:38:05 -0500
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <20080330133113.a8a4a594.mle+win@mega-nerd.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
	<20080330133113.a8a4a594.mle+win@mega-nerd.com>
Message-ID: <78a7dad00803300038q654cb57buf87327ef7ab13a65@mail.gmail.com>

On Sat, Mar 29, 2008 at 9:31 PM, Erik de Castro Lopo
<mle+win at mega-nerd.com> wrote:
> Erik de Castro Lopo wrote:
>
>  > It seems that this function makes no use of WINEDLLPATH. Shouldn't
>  > this function also search along the paths specified by the
>  > environment variable?
>
>  I've grepped the sources and the only place that looks at
>  WINEDLLPATH is the funcion build_dll_path() in libs/wine/loader.c.
>
>  The function build_dll_path() fills in an array dll_paths with
>  is private to that file. Looking at other things in that file
>  it seems that stuff in that file is mostly related to loading
>  the native Linux versions of the windows DLLs. Is that right?
>  If so, it looks like some of the code in libs/wine/loader.c
>  needs to be cloned or shared with the code in
>  dlls/ntdll/loader.c.
>
>  I'm willing to hack up a fix for this if someone can point me
>  in the right direction.
>

When an app needs a certain dll windows (and wine) search according to
this:  directory of exe, current directory, system directory
(windows/system32),  windows directory (windows), and PATH env var.

What I would do if I were you is make a copy of that other needed dll
and put it in the applications exe directory.


From thestig at google.com  Sun Mar 30 02:59:09 2008
From: thestig at google.com (Lei Zhang)
Date: Sun, 30 Mar 2008 00:59:09 -0700
Subject: Two more janitorial tasks
In-Reply-To: <47EE8AB4.80107@kievinfo.com>
References: <47EE8AB4.80107@kievinfo.com>
Message-ID: <558b2f5c0803300059i2ba99f7ene2fa12d566e85416@mail.gmail.com>

On Sat, Mar 29, 2008 at 11:30 AM, Vitaliy Margolen
<wine-devel at kievinfo.com> wrote:
> This is a bit more involved then regular janitorial task, but pretty small
>  never the less. It is for some one who wants to get their feet wet in Wine.
>
>  Convert all console applications (net, regsvr32, eject, msiexec, etc) to
>  unicode (see cmd for example). This is to better support international
>  translations.
>
>  Use WriteConsoleW to output text to the console instead printf & co. Again
>  for better support of the international translations and to avoid bugs in
>  Wine's msvcrt which prints to the wrong terminal.
>

Sounds good. Please add it to the list:

http://wiki.winehq.org/JanitorialProjects


From mle+win at mega-nerd.com  Sun Mar 30 03:37:41 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 30 Mar 2008 19:37:41 +1100
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <78a7dad00803300038q654cb57buf87327ef7ab13a65@mail.gmail.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
	<20080330133113.a8a4a594.mle+win@mega-nerd.com>
	<78a7dad00803300038q654cb57buf87327ef7ab13a65@mail.gmail.com>
Message-ID: <20080330193741.cb5d53da.mle+win@mega-nerd.com>

John Klehm wrote:

> When an app needs a certain dll windows (and wine) search according to
> this:  directory of exe, current directory, system directory
> (windows/system32),  windows directory (windows), and PATH env var.
> 
> What I would do if I were you is make a copy of that other needed dll
> and put it in the applications exe directory.

Unfortunately, that is not a good option for my particular use
case.

My main interest in wine is for the case where I am cross
compiling from Linux to windows and want to run the cross
compiled windows executables (in particlular the test suite)
on Linux.

The particular project I want to compile like this are my
two projects libsndfile and libsamplerate, both of which have
top level source code layout of:

    src       - actual library source code
    tests     - the test suite programs
    examples  - some example programs

Since these libraries uses autoconf/automake/libtool, the generated
DLL ends up as:

    src/.libs/libwhatever-1.dll

and the test suite programs end up as say:

    tests/test_name.exe

When doing native Linux compiles, the libtool generated wrapper
scipt correctly points to the shared object file and the test
runs correctly. I'm looking for the same functionality when
running the tests under wine.

Your proposal of just copying the DLL is not a good solution in
this case because the copied executable could get out of sync
with the one in src/.libs, invalidating the tests.

> From what I've seen WINEDLLPATH is for internal dll.so parts of wine.

I've just re-read the wine man page and it seems does support
your statement.

However, my particular use case is a particluarly interesting one.
If I and other authors of cross platform code can easily compile
and test windows binaries on Linux, you will get more wine users
of the type that can hack on wine and write great bug reports.
I also means that windows becomes increasingly irrelevant.

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"C++ : Where friends have access to your private members."
-- Gavin Russell Baker


From xixsimplicityxix at gmail.com  Sun Mar 30 03:49:39 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Sun, 30 Mar 2008 03:49:39 -0500
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <20080330193741.cb5d53da.mle+win@mega-nerd.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
	<20080330133113.a8a4a594.mle+win@mega-nerd.com>
	<78a7dad00803300038q654cb57buf87327ef7ab13a65@mail.gmail.com>
	<20080330193741.cb5d53da.mle+win@mega-nerd.com>
Message-ID: <78a7dad00803300149m1fc44fb2pe71d1057b670c7a0@mail.gmail.com>

On Sun, Mar 30, 2008 at 3:37 AM, Erik de Castro Lopo
<mle+win at mega-nerd.com> wrote:
>
>  Your proposal of just copying the DLL is not a good solution in
>  this case because the copied executable could get out of sync
>  with the one in src/.libs, invalidating the tests.
>

Well you could have a script to recopy it there but there is one more
way I thought of that you could add the path (provided you dont remove
your .wine folder very often)

wine regedit

Then edit
\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session
Manager\Environment\Path

Add your additional path dirs at the start.

That will then permanently add those to your path (will get wiped if
you reinstall your .wine folder though).  Probably could get some kind
of .reg file to do this automatically.

--John


From mle+win at mega-nerd.com  Sun Mar 30 04:30:55 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 30 Mar 2008 20:30:55 +1100
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <78a7dad00803300149m1fc44fb2pe71d1057b670c7a0@mail.gmail.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
	<20080330133113.a8a4a594.mle+win@mega-nerd.com>
	<78a7dad00803300038q654cb57buf87327ef7ab13a65@mail.gmail.com>
	<20080330193741.cb5d53da.mle+win@mega-nerd.com>
	<78a7dad00803300149m1fc44fb2pe71d1057b670c7a0@mail.gmail.com>
Message-ID: <20080330203055.42c93e07.mle+win@mega-nerd.com>

John Klehm wrote:

> Well you could have a script to recopy it there but there is one more
> way I thought of that you could add the path (provided you dont remove
> your .wine folder very often)
> 
> wine regedit
> 
> Then edit
> \HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session
> Manager\Environment\Path

Thanks for your helpful suggestions, but this still isn't a good
solution. I hope to encourage others to do cross-compiled development
of libsndfile from Linux to windows and I would like to have all of
them hack their windows registry. It just seems too fragile.

However, I notice that if instead of copying the library I make a
symlink instead, the executable runs correctly. Of the solutions
I've seen so far, this is the least fragile and most easily 
implementable solution.

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"Testing can prove the presence of bugs, but never their absence."
  -- Edsger Dijkstra


From marcus at jet.franken.de  Sun Mar 30 04:53:22 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Sun, 30 Mar 2008 11:53:22 +0200
Subject: strange menu behaviour
Message-ID: <20080330095322.GB4585@galeere>

Hi,

I am observing a strange menu behaviour.

How to reproduce:

- start notepad
- move the mouse over "Search", do not click
- press alt-f to get the file menu

=> the file menu flickers open, but suddenly switches
   to the search menu.

It seems the menu code checks the mouse pointer even
though it is not used for the menu activation.

http://bugs.winehq.org/show_bug.cgi?id=12289

Ciao, Marcus


From erikd at mega-nerd.com  Sat Mar 29 20:50:33 2008
From: erikd at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 30 Mar 2008 12:50:33 +1100
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <20080330122403.02d947a3.mle+win@mega-nerd.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
Message-ID: <20080330125033.26889303.erikd@mega-nerd.com>

Erik de Castro Lopo wrote:

> It seems that this function makes no use of WINEDLLPATH. Shouldn't
> this function also search along the paths specified by the
> environment variable?

I've grepped the sources and the only place that looks at 
WINEDLLPATH is the funcion build_dll_path() in libs/wine/loader.c.

The function build_dll_path() fills in an array dll_paths with
is private to that file. Looking at other things in that file
it seems that stuff in that file is mostly related to loading
the native Linux versions of the windows DLLs. Is that right?
If so, it looks like some of the code in libs/wine/loader.c
needs to be cloned or shared with the code in
dlls/ntdll/loader.c.

I'm willing to hack up a fix for this if someone can point me
in the right direction.

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
Open Source and Free Software means that you never sacrifice quality
of the code for meeting deadlines set up by people not participating
directly in the software development process.


From dank at kegel.com  Sun Mar 30 09:34:35 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 30 Mar 2008 07:34:35 -0700
Subject: Two more janitorial tasks
Message-ID: <a71bd89a0803300734y23d02c86vbba9c1cb9673f735@mail.gmail.com>

> Use WriteConsoleW to output text to the console instead printf & co.

Unless output is redirected to a file, in which case you
have to jump through a couple hoops.  See
WCMD_output_asis_len().

If anybody breaks commandline usage again, I'm
gonna myrtlize 'em :-)
- Dan


From dank at kegel.com  Sun Mar 30 09:58:07 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 30 Mar 2008 07:58:07 -0700
Subject: Wine 1.0 status: T minus 68 days. 73 open bugs.
Message-ID: <a71bd89a0803300758i28654b00w17cc4ae5e0e6acfb@mail.gmail.com>

40 days to code freeze.

One bug fixed in last couple days:
9459   -unknown        8       FIFA 2007 crashes with the recent versions

One bug added:
12246  -unknown        0       "make test" gives different results
with and without warn+heap

One bug deferred:
4971 	-unknown 	3 	Corel Draw 12 demo install fails

History:
3/22: 87 bugs, 76 days to go
3/23: 82 bugs, 75 days to go
3/24: 78 bugs, 74 days to go
3/26: 74 bugs, 72 days to go
3/30: 73 bugs, 69 days to go

Here's the current list of open bugs:


5948 	-unknown 	1 	Star Trek: Armada does not install
5061 	-unknown 	6 	Copying from Windows Firefox in Wine and pasting to
Linux OpenOffice pastes metadata as data
7477 	-unknown 	1 	Uplink demo crashes
12097 	-unknown 	2 	Wine 1.0 should not ship out-of-sync resource translations
5055 	-unknown 	5 	Deleting files from a window in wine doesn't send
them to the Trash
5844 	-unknown 	11 	tray minimize
11281 	-unknown 	2 	CJK input many issues
10815 	-unknown 	2 	Cannot drag images into Adobe Photoshop 7 from the
web / desktop
5402 	-unknown 	0 	Trying to run PhotoStitch 3.1
7404 	-unknown 	2 	ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
9916 	-unknown 	6 	"make test" usually fails
9178 	-unknown 	7 	"hello world" dos program hangs
5024 	-unknown 	4 	Thief: Deadly Shadows crashes:page fault on read
access to 0x0000040c
12246 	-unknown 	0 	"make test" gives different results with and
without warn+heap
8125 	-unknown 	0 	Marratech 6.1 crashes on start
10147 	-unknown 	1 	Word Viewer 2003 - Tab behavior differs from Windows
9959 	-unknown 	8 	Make wine updates work even if the registry changed
556 	build-en 	1 	Reconcile the Windows and Wine spec files
1114 	comctl32 	2 	Winrar2.90/3.00: Comboex doesn't trigger a event
when you mouse-click in some value of it
2493 	comctl32 	2 	Multi-select listview: Shift-arrow up only selects
top two items
11681 	directx- 	14 	Add support for video overlay
5955 	directx- 	8 	DirectDrawCreate crash on non-OpenGL desktop
9030 	directx- 	0 	army men hangs on black screen
82 	document 	2 	Stabilize Winelib User Guide Table of Contents
638 	document 	9 	Document Wine debugging channels
9771 	gdi32 	38 	Steam Friends doesn't work (fails to render correctly
or refresh)
9926 	gdi32 	5 	gdi32.dll should not have exported function pointers
3270 	gdi32 	15 	Problem with minimized top-level windows
6519 	gdi32 	7 	Wine blacks out rotated font bitmap
7571 	gdi32 	1 	Accented character glyphs are mixed up with TrueType
fonts (affects e.g. Lotus Notes R5)
9484 	kernel32 	17 	Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
5351 	kernel32 	9 	Windows Installer 3.1 cannot install because of
non-standard drive labeling
5541 	kernel32 	0 	WriteConsole can't write to stdout; affects e.g.
wsh's cscript's usage message
9039 	kernel32 	0 	GS-Auftrag Professional SQL aborts on startup
4733 	kernel32 	5 	Get optimized/compressed/packed executables (non-upx) working
7098 	mscoree 	1 	RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
5163 	msi 	12 	Office XP 2002 crashes on installation
8783 	ntdll 	12 	USB serial ports do not work
9356 	ntdll 	6 	Serial communication not working since wine-0.9.33
6607 	ole 	9 	Drag and Drop not working
2539 	ole 	3 	XDND (Drag and drop for X Windows) doesn't copy text
8095 	ole 	0 	PQ Teaching toy crashes
4770 	ole 	3 	BlackBerry Device Manager fails to install under wine
9942 	ole 	2 	Powerpoint Viewer 2007 crashes opening .pptx files
5926 	programs 	0 	Wine does not provide an implementation of winhlp32.exe
6254 	richedit 	4 	Installer infinite loop from rich text error
8898 	shdocvw 	0 	Run Time Error "445": Object doesn't support this
action in Europa Knowledgebase
9304 	shdocvw 	3 	Temple of Elemental Evil demo doesn't start - gui irresponsive
3546 	shdocvw 	2 	CLSID_InternetShortcut not available...
6095 	shdocvw 	12 	MOTD in counter-strike 1.6 and counter-strike
source does not render
8439 	shell32 	8 	Visual Studio .NET (7) install fails
10905 	shell32 	0 	thinstall firefox demo requires native msvcrt
9809 	shell32 	4 	Autodesk Revit Architecture 2008 install fails
11742 	shlwapi 	8 	Small .net 1.1 app (FastMD5 1.3) fails to start up
12074 	testcase 	2 	The conformance tests fail on Windows
6604 	tools 	2 	Ship icons for the wine-tools that can be used in .desktop files
8246 	urlmon 	3 	invoking htmlhelp:HtmlHelpW crashes wine
664 	user32 	6 	The help menu functionality inside programs is broken
(messaging problem)
4523 	user32 	5 	Can't copy from Firefox 1.5 and paste into OpenOffice
2 under Wine
3023 	user32 	5 	Orcad - "Place Part" never tries to put down a part
124 	wineserv 	2 	Review of Wine Server Protocol
11019 	winex11. 	3 	matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
7372 	winex11. 	12 	can't copy and paste between gnome apps eg
openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
2368 	winex11. 	7 	Wine loses its X-Window when switching to another
virt. desktop in Fvwm
1990 	winex11. 	1 	modifier keys not released when switching desktop
10984 	winex11. 	5 	sun jre 5 update 10 installer hangs in 0.9.52
5623 	winex11. 	3 	GetAsyncKeyState wrong if querying process doesn't have focus
5828 	winex11. 	24 	Command and Conquer Generals (Zero Hour) doesn't
change the mouse cursor from the default X mouse
3297 	winex11. 	12 	UpdateWindow() doesn't call XFlush()
3711 	wininet 	1 	Musicmatch fails to install (missing registry key,
HTTP_HttpOpenRequest() problem)
5625 	wininet 	3 	Wine does not handle internet proxy settings conveniently
9787 	winsock 	47 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
12005 	wintab32 	0 	Regression in pressure sensitivity with wizardpen
tablet driver and Photoshop 7


From dank at kegel.com  Sun Mar 30 10:38:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 30 Mar 2008 08:38:30 -0700
Subject: Proposal: versioning .wine directory
Message-ID: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>

On the wine-users list, we're getting a lot of users who
have old or even ancient .wine directories, and
whose problems go away with a fresh .wine directory

Perhaps we should have wineprefixcreate stamp the version
of wine the .wine directory was created with,
make wine-1.0 refuse to run with pre-1.0 .wine
directories, and require that future versions
of wine run properly with .wine directories created
by any earlier stable release of wine.

It wouldn't be hard, at least at first, and it might save a lot of
support inquiries.  What say?


From truiken at gmail.com  Sun Mar 30 13:35:40 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 30 Mar 2008 13:35:40 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
Message-ID: <22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>

On Sun, Mar 30, 2008 at 10:38 AM, Dan Kegel <dank at kegel.com> wrote:
> On the wine-users list, we're getting a lot of users who
>  have old or even ancient .wine directories, and
>  whose problems go away with a fresh .wine directory
>
>  Perhaps we should have wineprefixcreate stamp the version
>  of wine the .wine directory was created with,
>  make wine-1.0 refuse to run with pre-1.0 .wine
>  directories, and require that future versions
>  of wine run properly with .wine directories created
>  by any earlier stable release of wine.
>
>  It wouldn't be hard, at least at first, and it might save a lot of
>  support inquiries.  What say?
>

I can't find a quote of it anywhere, but I believe that a stable
wineprefix was a requirement (or at least a wish) of 1.0.

-- 
James Hawkins


From austinenglish at gmail.com  Sun Mar 30 13:46:08 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 30 Mar 2008 13:46:08 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
Message-ID: <b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>

On Sun, Mar 30, 2008 at 1:35 PM, James Hawkins <truiken at gmail.com> wrote:
>
> On Sun, Mar 30, 2008 at 10:38 AM, Dan Kegel <dank at kegel.com> wrote:
>  > On the wine-users list, we're getting a lot of users who
>  >  have old or even ancient .wine directories, and
>  >  whose problems go away with a fresh .wine directory
>  >
>  >  Perhaps we should have wineprefixcreate stamp the version
>  >  of wine the .wine directory was created with,
>  >  make wine-1.0 refuse to run with pre-1.0 .wine
>  >  directories, and require that future versions
>  >  of wine run properly with .wine directories created
>  >  by any earlier stable release of wine.
>  >
>  >  It wouldn't be hard, at least at first, and it might save a lot of
>  >  support inquiries.  What say?
>  >
>
>  I can't find a quote of it anywhere, but I believe that a stable
>  wineprefix was a requirement (or at least a wish) of 1.0.
>
>  --
>  James Hawkins
>
>
>

http://bugs.winehq.org/show_bug.cgi?id=9959

My comment from the bug:
"How about a little file in .wine  or a registry key that is read upon running
wine, and should match the current wine version. If it doesn't, call
wineprefixcreate (or pop up an error saying that the registry is outdated),
which then updates that key to the current wine version. Shouldn't be too much
overhead and prevents quite a few problems."


From austinenglish at gmail.com  Sun Mar 30 13:46:08 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 30 Mar 2008 13:46:08 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
Message-ID: <b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>

On Sun, Mar 30, 2008 at 1:35 PM, James Hawkins <truiken at gmail.com> wrote:
>
> On Sun, Mar 30, 2008 at 10:38 AM, Dan Kegel <dank at kegel.com> wrote:
>  > On the wine-users list, we're getting a lot of users who
>  >  have old or even ancient .wine directories, and
>  >  whose problems go away with a fresh .wine directory
>  >
>  >  Perhaps we should have wineprefixcreate stamp the version
>  >  of wine the .wine directory was created with,
>  >  make wine-1.0 refuse to run with pre-1.0 .wine
>  >  directories, and require that future versions
>  >  of wine run properly with .wine directories created
>  >  by any earlier stable release of wine.
>  >
>  >  It wouldn't be hard, at least at first, and it might save a lot of
>  >  support inquiries.  What say?
>  >
>
>  I can't find a quote of it anywhere, but I believe that a stable
>  wineprefix was a requirement (or at least a wish) of 1.0.
>
>  --
>  James Hawkins
>
>
>

http://bugs.winehq.org/show_bug.cgi?id=9959

My comment from the bug:
"How about a little file in .wine  or a registry key that is read upon running
wine, and should match the current wine version. If it doesn't, call
wineprefixcreate (or pop up an error saying that the registry is outdated),
which then updates that key to the current wine version. Shouldn't be too much
overhead and prevents quite a few problems."


From mstefani at redhat.com  Sun Mar 30 14:04:51 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Sun, 30 Mar 2008 21:04:51 +0200
Subject: Wine 1.0 status: T minus 68 days. 73 open bugs.
In-Reply-To: <a71bd89a0803300758i28654b00w17cc4ae5e0e6acfb@mail.gmail.com>
References: <a71bd89a0803300758i28654b00w17cc4ae5e0e6acfb@mail.gmail.com>
Message-ID: <47EFE453.8030109@redhat.com>

Dan Kegel wrote:
> 40 days to code freeze.
> 
> One bug fixed in last couple days:
> 9459   -unknown        8       FIFA 2007 crashes with the recent versions
> 
> One bug added:
> 12246  -unknown        0       "make test" gives different results
> with and without warn+heap
> 
> One bug deferred:
> 4971 	-unknown 	3 	Corel Draw 12 demo install fails
> 
> History:
> 3/22: 87 bugs, 76 days to go
> 3/23: 82 bugs, 75 days to go
> 3/24: 78 bugs, 74 days to go
> 3/26: 74 bugs, 72 days to go
> 3/30: 73 bugs, 69 days to go
> 
> Here's the current list of open bugs:

> 12097 	-unknown 	2 	Wine 1.0 should not ship out-of-sync resource translations
This bug can be closed only after Wine 1.0 ships. There are a lot of
changes/cleanups at the moment that constantly break the translations.

bye
	michael


From stefan at codeweavers.com  Sun Mar 30 13:37:56 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 30 Mar 2008 20:37:56 +0200
Subject: Proposal: versioning .wine directory
In-Reply-To: <b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
Message-ID: <200803302037.56555.stefan@codeweavers.com>

Am Sonntag, 30. M?rz 2008 20:46:08 schrieb Austin English:
> My comment from the bug:
> "How about a little file in .wine  or a registry key that is read upon
> running wine, and should match the current wine version. If it doesn't,
> call wineprefixcreate (or pop up an error saying that the registry is
> outdated), which then updates that key to the current wine version.
> Shouldn't be too much overhead and prevents quite a few problems."
In the past I've had more problems with wineprefixcreate trashing my registry 
than I had with outdated registry entries. Especially if you have Internet 
Explorer or the DirectX SDK or runtime installed running wineprefixcreate has 
bad side effects.


From sbrown7 at umbc.edu  Sun Mar 30 15:01:09 2008
From: sbrown7 at umbc.edu (Steve Brown)
Date: Sun, 30 Mar 2008 16:01:09 -0400 (EDT)
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <20080330193741.cb5d53da.mle+win@mega-nerd.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
	<20080330133113.a8a4a594.mle+win@mega-nerd.com>
	<78a7dad00803300038q654cb57buf87327ef7ab13a65@mail.gmail.com>
	<20080330193741.cb5d53da.mle+win@mega-nerd.com>
Message-ID: <Pine.LNX.4.64.0803301559420.17962@cadence2.gl.umbc.edu>

On Sun, 30 Mar 2008, Erik de Castro Lopo wrote:

> Your proposal of just copying the DLL is not a good solution in
> this case because the copied executable could get out of sync
> with the one in src/.libs, invalidating the tests.

You could add the copy to your makefile, so every time your .dll gets 
rebuilt, it gets automagically copied as needed.

Steve Brown
sbrown7 at umbc.edu


From mstefani at redhat.com  Sun Mar 30 15:20:06 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Sun, 30 Mar 2008 22:20:06 +0200
Subject: Wine 1.0 status: T minus 68 days. 73 open bugs.
In-Reply-To: <3f4fd2640803301305p29cd0696i65c4f23254496cf@mail.gmail.com>
References: <a71bd89a0803300758i28654b00w17cc4ae5e0e6acfb@mail.gmail.com>	
	<47EFE453.8030109@redhat.com>
	<3f4fd2640803301305p29cd0696i65c4f23254496cf@mail.gmail.com>
Message-ID: <47EFF5F6.2090801@redhat.com>

Reece Dunn wrote:
> On 30/03/2008, Michael Stefaniuc <mstefani at redhat.com> wrote:
>> Dan Kegel wrote:
>>  > 40 days to code freeze.
>>  >
>>> 12097         -unknown        2       Wine 1.0 should not ship out-of-sync resource translations
>> This bug can be closed only after Wine 1.0 ships. There are a lot of
>>  changes/cleanups at the moment that constantly break the translations.
> 
> There should also be a resource freeze, during which only translators
> can modify the resources (i.e. no En.rc changes) to give them a chance
> to translate them.
> 
> Should this be done before the code freeze, or is the time during code
> freeze enough for the translations?
Code freeze should be enough. It's not so much about having everything
translated but more with having correct rc files. If somebody needs to
change an En.rc during code freeze he needs to update also the
translation rc files to keep them in sync (aka no missing menu or dialog
items, etc.).

See Mikolaj's page for broken rc files:
http://pf128.krakow.sdi.tpnet.pl/wine-transl/

bye
	michael


From m.b.lankhorst at gmail.com  Sun Mar 30 15:53:42 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 30 Mar 2008 13:53:42 -0700
Subject: user32: Implement BroadcastSystemMessage, try 5.1
In-Reply-To: <87zlsnnage.fsf@wine.dyndns.org>
References: <b130c85e0803240515y66991587x19c0cebb899d7461@mail.gmail.com>
	<87zlsnnage.fsf@wine.dyndns.org>
Message-ID: <b130c85e0803301353o5cfca3b0r7ac6247f5acee5af@mail.gmail.com>

Hello Alexandre,

2008/3/24, Alexandre Julliard <julliard at winehq.org>:
> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:
>
>  > +    TRACE("Flags: %08x, recipients: %p(0x%x), msg: %04x, wparam: %08lx, lparam: %08lx\n", flags, recipients,
>  > +         (recipients ? *recipients : recips), msg, wp, lp);
>  > +
>  > +    if (flags > BSF_LUID)
>
>  It doesn't make sense to compare flags with >. What are you trying to
>  check for?
>
>  > -}
>  > +    else
>  > +        FIXME("Recipients %08x not supported!\n", *recipients);
>  > +
>  > +    if (ret > 0 && !GetLastError())
>  > +        SetLastError(lasterror);
>
>  In general if you have to save and restore last error you are doing
>  something wrong.
Or wine is doing something wrong. After some more digging I found that
SetLastError() was set to 0 by TlsGetValue when called from X11DRV's
MsgWaitForMultipleObjectsEx. After I tried fixing this so that
SetLastError is only set when NULL is returned, one of the other tests
miraculously started working inside a todo block too (cursoricon).
I'll work on some testcases to verify that tlsgetvalue only calls
SetLastError(0) when succesfully returning null.

Cheers,
Maarten.


From julliard at winehq.org  Sun Mar 30 16:04:18 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sun, 30 Mar 2008 23:04:18 +0200
Subject: user32: Implement BroadcastSystemMessage, try 5.1
In-Reply-To: <b130c85e0803301353o5cfca3b0r7ac6247f5acee5af@mail.gmail.com>
	(Maarten Lankhorst's message of "Sun, 30 Mar 2008 13:53:42 -0700")
References: <b130c85e0803240515y66991587x19c0cebb899d7461@mail.gmail.com>
	<87zlsnnage.fsf@wine.dyndns.org>
	<b130c85e0803301353o5cfca3b0r7ac6247f5acee5af@mail.gmail.com>
Message-ID: <87y77zq5yl.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> Or wine is doing something wrong. After some more digging I found that
> SetLastError() was set to 0 by TlsGetValue when called from X11DRV's
> MsgWaitForMultipleObjectsEx. After I tried fixing this so that
> SetLastError is only set when NULL is returned, one of the other tests
> miraculously started working inside a todo block too (cursoricon).
> I'll work on some testcases to verify that tlsgetvalue only calls
> SetLastError(0) when succesfully returning null.

In most cases it's the test that is doing something wrong by being too
strict. We don't care whether last error is modified or not on success,
and there's no reason to test for it, unless it's one of the very few
functions that do something special on success, or unless there is a
real app that depends on it.

-- 
Alexandre Julliard
julliard at winehq.org


From austinenglish at gmail.com  Sun Mar 30 16:07:24 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 30 Mar 2008 16:07:24 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <200803302037.56555.stefan@codeweavers.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
Message-ID: <b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>

On Sun, Mar 30, 2008 at 1:37 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Sonntag, 30. M?rz 2008 20:46:08 schrieb Austin English:
>
> > My comment from the bug:
>  > "How about a little file in .wine  or a registry key that is read upon
>  > running wine, and should match the current wine version. If it doesn't,
>  > call wineprefixcreate (or pop up an error saying that the registry is
>  > outdated), which then updates that key to the current wine version.
>  > Shouldn't be too much overhead and prevents quite a few problems."
>  In the past I've had more problems with wineprefixcreate trashing my registry
>  than I had with outdated registry entries. Especially if you have Internet
>  Explorer or the DirectX SDK or runtime installed running wineprefixcreate has
>  bad side effects.
>

We could still store the version of wine last used and issue a (gui?)
warning if it's old/outdated telling the user to either run
wineprefixcreate, which may be bad in some cases, or to reinstall
their apps.

From truiken at gmail.com  Sun Mar 30 16:11:45 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 30 Mar 2008 16:11:45 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
	<b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>
Message-ID: <22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>

On Sun, Mar 30, 2008 at 4:07 PM, Austin English <austinenglish at gmail.com> wrote:
>
> On Sun, Mar 30, 2008 at 1:37 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
>  > Am Sonntag, 30. M?rz 2008 20:46:08 schrieb Austin English:
>  >
>  > > My comment from the bug:
>  >  > "How about a little file in .wine  or a registry key that is read upon
>  >  > running wine, and should match the current wine version. If it doesn't,
>  >  > call wineprefixcreate (or pop up an error saying that the registry is
>  >  > outdated), which then updates that key to the current wine version.
>  >  > Shouldn't be too much overhead and prevents quite a few problems."
>  >  In the past I've had more problems with wineprefixcreate trashing my registry
>  >  than I had with outdated registry entries. Especially if you have Internet
>  >  Explorer or the DirectX SDK or runtime installed running wineprefixcreate has
>  >  bad side effects.
>  >
>
>  We could still store the version of wine last used and issue a (gui?)
>  warning if it's old/outdated telling the user to either run
>  wineprefixcreate, which may be bad in some cases, or to reinstall
>  their apps.
>

You're missing the point of having a stable wine prefix.  After 1.0,
and assuming we can get a stable wine prefix, a user should never have
to reinstall their apps.

-- 
James Hawkins


From austinenglish at gmail.com  Sun Mar 30 16:14:20 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 30 Mar 2008 16:14:20 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
	<b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>
	<22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>
Message-ID: <b6bb06270803301414w7bdbc340s10e74cbaaa4beb5d@mail.gmail.com>

On Sun, Mar 30, 2008 at 4:11 PM, James Hawkins <truiken at gmail.com> wrote:
>
> On Sun, Mar 30, 2008 at 4:07 PM, Austin English <austinenglish at gmail.com> wrote:
>  >
>  > On Sun, Mar 30, 2008 at 1:37 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
>  >  > Am Sonntag, 30. M?rz 2008 20:46:08 schrieb Austin English:
>  >  >
>  >  > > My comment from the bug:
>  >  >  > "How about a little file in .wine  or a registry key that is read upon
>  >  >  > running wine, and should match the current wine version. If it doesn't,
>  >  >  > call wineprefixcreate (or pop up an error saying that the registry is
>  >  >  > outdated), which then updates that key to the current wine version.
>  >  >  > Shouldn't be too much overhead and prevents quite a few problems."
>  >  >  In the past I've had more problems with wineprefixcreate trashing my registry
>  >  >  than I had with outdated registry entries. Especially if you have Internet
>  >  >  Explorer or the DirectX SDK or runtime installed running wineprefixcreate has
>  >  >  bad side effects.
>  >  >
>  >
>  >  We could still store the version of wine last used and issue a (gui?)
>  >  warning if it's old/outdated telling the user to either run
>  >  wineprefixcreate, which may be bad in some cases, or to reinstall
>  >  their apps.
>  >
>
>  You're missing the point of having a stable wine prefix.  After 1.0,
>  and assuming we can get a stable wine prefix, a user should never have
>  to reinstall their apps.
>
>  --
>  James Hawkins
>

I was under the impression that we would still possibly require a
reinstall between major versions (1.0 -> 1.2, etc.). If not, then we
should focus on making sure wineprefixcreate doesn't trash the
registry.

From truiken at gmail.com  Sun Mar 30 16:17:17 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 30 Mar 2008 16:17:17 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <b6bb06270803301414w7bdbc340s10e74cbaaa4beb5d@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
	<b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>
	<22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>
	<b6bb06270803301414w7bdbc340s10e74cbaaa4beb5d@mail.gmail.com>
Message-ID: <22821af30803301417k3a0357ffxab5a93eca69ba5fc@mail.gmail.com>

On Sun, Mar 30, 2008 at 4:14 PM, Austin English <austinenglish at gmail.com> wrote:
>
> On Sun, Mar 30, 2008 at 4:11 PM, James Hawkins <truiken at gmail.com> wrote:
>  >
>  > On Sun, Mar 30, 2008 at 4:07 PM, Austin English <austinenglish at gmail.com> wrote:
>  >  >
>  >  > On Sun, Mar 30, 2008 at 1:37 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
>  >  >  > Am Sonntag, 30. M?rz 2008 20:46:08 schrieb Austin English:
>  >  >  >
>  >  >  > > My comment from the bug:
>  >  >  >  > "How about a little file in .wine  or a registry key that is read upon
>  >  >  >  > running wine, and should match the current wine version. If it doesn't,
>  >  >  >  > call wineprefixcreate (or pop up an error saying that the registry is
>  >  >  >  > outdated), which then updates that key to the current wine version.
>  >  >  >  > Shouldn't be too much overhead and prevents quite a few problems."
>  >  >  >  In the past I've had more problems with wineprefixcreate trashing my registry
>  >  >  >  than I had with outdated registry entries. Especially if you have Internet
>  >  >  >  Explorer or the DirectX SDK or runtime installed running wineprefixcreate has
>  >  >  >  bad side effects.
>  >  >  >
>  >  >
>  >  >  We could still store the version of wine last used and issue a (gui?)
>  >  >  warning if it's old/outdated telling the user to either run
>  >  >  wineprefixcreate, which may be bad in some cases, or to reinstall
>  >  >  their apps.
>  >  >
>  >
>  >  You're missing the point of having a stable wine prefix.  After 1.0,
>  >  and assuming we can get a stable wine prefix, a user should never have
>  >  to reinstall their apps.
>  >
>  >  --
>  >  James Hawkins
>  >
>
>  I was under the impression that we would still possibly require a
>  reinstall between major versions (1.0 -> 1.2, etc.). If not, then we
>  should focus on making sure wineprefixcreate doesn't trash the
>  registry.
>

If we have a stable wine prefix in 1.0, I don't see what could
possibly be added in 1.2 that would break that.  The idea is that,
even if you add a new dll that needs to be registered in, say, 1.0.5,
you still don't need to remove your wine prefix or reinstall any apps.

-- 
James Hawkins


From dank at kegel.com  Sun Mar 30 16:18:32 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 30 Mar 2008 14:18:32 -0700
Subject: Proposal: versioning .wine directory
In-Reply-To: <22821af30803301417k3a0357ffxab5a93eca69ba5fc@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
	<b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>
	<22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>
	<b6bb06270803301414w7bdbc340s10e74cbaaa4beb5d@mail.gmail.com>
	<22821af30803301417k3a0357ffxab5a93eca69ba5fc@mail.gmail.com>
Message-ID: <a71bd89a0803301418v143e5ef4v29288d1364bf03c8@mail.gmail.com>

On Sun, Mar 30, 2008 at 2:17 PM, James Hawkins <truiken at gmail.com> wrote:
>  If we have a stable wine prefix in 1.0, I don't see what could
>  possibly be added in 1.2 that would break that.  The idea is that,
>  even if you add a new dll that needs to be registered in, say, 1.0.5,
>  you still don't need to remove your wine prefix or reinstall any apps.

Can I bring the discussion back to my proposal,
which was to have wine-1.0 notice old, unsupported .wine
directories, and do something sensible?


From stefan at codeweavers.com  Sun Mar 30 17:04:25 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 31 Mar 2008 00:04:25 +0200
Subject: bugfix #12296
In-Reply-To: <47EFDCF2.5040206@online.de>
References: <47EFDCF2.5040206@online.de>
Message-ID: <200803310004.26228.stefan@codeweavers.com>

Am Sonntag, 30. M?rz 2008 20:33:22 schrieb Gregor M?nch:
> As discussed with stefand on irc:
> | feel free to send a patch adding that, it is needed

> - * Copyright 2006-2007 Stefan D?singer for CodeWeavers
> + * Copyright 2006-2007 Stefan D???singer for CodeWeavers
Watch out with the encoding... I think the general consent is to leave that 
character as it is until we have decided on a preferred Wine source file 
encoding.

The background story is that we throw away the sysmem copy of the surface, so 
we have to remove SFLAG_INSYSMEM. This might drop the last remaining 
location. Since we do not backup any contents of primaries and depth stencil, 
we can label the DRAWABLE as most up to date, this prevents needless loading 
attempts on the next draw.

So the patch is correct and should be applied, appart of the change to my 
name...



From scott at open-vote.org  Sun Mar 30 17:08:50 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Sun, 30 Mar 2008 15:08:50 -0700
Subject: Proposal: versioning .wine directory
In-Reply-To: <a71bd89a0803301418v143e5ef4v29288d1364bf03c8@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>	<200803302037.56555.stefan@codeweavers.com>	<b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>	<22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>	<b6bb06270803301414w7bdbc340s10e74cbaaa4beb5d@mail.gmail.com>	<22821af30803301417k3a0357ffxab5a93eca69ba5fc@mail.gmail.com>
	<a71bd89a0803301418v143e5ef4v29288d1364bf03c8@mail.gmail.com>
Message-ID: <47F00F72.2090905@open-vote.org>

Dan Kegel wrote:
> On Sun, Mar 30, 2008 at 2:17 PM, James Hawkins <truiken at gmail.com> wrote:
>>  If we have a stable wine prefix in 1.0, I don't see what could
>>  possibly be added in 1.2 that would break that.  The idea is that,
>>  even if you add a new dll that needs to be registered in, say, 1.0.5,
>>  you still don't need to remove your wine prefix or reinstall any apps.
> 
> Can I bring the discussion back to my proposal,
> which was to have wine-1.0 notice old, unsupported .wine
> directories, and do something sensible?
> 
> 

If we're going to force users to remake ~/.wine, it would be ideal if we
only did that once.  Then we could provide some sort of upgrade path if
wineprefix changed again for some reason.

I'm wondering if the case-insensitive FUSE project could be finished in
time - this would allow us to both get a stable wineprefix and a
case-insensitive .wine folder.  This would save us the hassle of having
to worry about converting case-sensitive but proper-prefixed .wine folders.

Thanks,
Scott Ritchie


From hintak_leung at yahoo.co.uk  Sun Mar 30 12:35:26 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Sun, 30 Mar 2008 17:35:26 +0000 (GMT)
Subject: Don't bother...
In-Reply-To: <200803291951.48094.pure_evil@mail.bg>
Message-ID: <792997.74082.qm@web23105.mail.ird.yahoo.com>

--- On Sat, 29/3/08, pure_evil at mail.bg <pure_evil at mail.bg> wrote:

> From: pure_evil at mail.bg <pure_evil at mail.bg>
> Subject: Don't bother...
> To: "Hin-Tak Leung" <hintak_leung at yahoo.co.uk>
> Date: Saturday, 29 March, 2008, 5:51 PM
> I tried compiling it against wine's source tree, it spat
> out a bunch of 
> warnings. When I wrote to him, that's what he replied:
> 
> >guess what, that's a different compiler.
> 'winegcc' != 'mingw32'. Did I say 
> something about crosscompiling? AFAIK you dont (cant?) use
> stuff compiled 
> with winegcc on windows because it depends on wine.
> 
> >I just thought you might want to look at a sample that
> builds and lives 
> outside so you could test you code on win too.
> 
> So, it's not what you think it is :( It's not
> usable as wine driver.

I am a bit lost about your comments. I have both winegcc and mingw32. 
I am quite familar with the latter and new to the former. 
I am using the appropriate ones (mingw32 for the printproxy, and winegcc for ddiwrapper). 

The printerproxy needs cross-compiling (and it works alright against current wine), ddiwrapper needs to be built with winegcc (and does not build against current wine).



      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Inbox http://uk.docs.yahoo.com/nowyoucan.html


From msclrhd at googlemail.com  Sun Mar 30 15:05:02 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 30 Mar 2008 21:05:02 +0100
Subject: Wine 1.0 status: T minus 68 days. 73 open bugs.
In-Reply-To: <47EFE453.8030109@redhat.com>
References: <a71bd89a0803300758i28654b00w17cc4ae5e0e6acfb@mail.gmail.com>
	<47EFE453.8030109@redhat.com>
Message-ID: <3f4fd2640803301305p29cd0696i65c4f23254496cf@mail.gmail.com>

On 30/03/2008, Michael Stefaniuc <mstefani at redhat.com> wrote:
> Dan Kegel wrote:
>  > 40 days to code freeze.
>  >
> > 12097         -unknown        2       Wine 1.0 should not ship out-of-sync resource translations
>
> This bug can be closed only after Wine 1.0 ships. There are a lot of
>  changes/cleanups at the moment that constantly break the translations.

There should also be a resource freeze, during which only translators
can modify the resources (i.e. no En.rc changes) to give them a chance
to translate them.

Should this be done before the code freeze, or is the time during code
freeze enough for the translations?

- Reece


From dank at kegel.com  Sun Mar 30 17:12:37 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 30 Mar 2008 15:12:37 -0700
Subject: Proposal: versioning .wine directory
In-Reply-To: <47F00F72.2090905@open-vote.org>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
	<b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>
	<22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>
	<b6bb06270803301414w7bdbc340s10e74cbaaa4beb5d@mail.gmail.com>
	<22821af30803301417k3a0357ffxab5a93eca69ba5fc@mail.gmail.com>
	<a71bd89a0803301418v143e5ef4v29288d1364bf03c8@mail.gmail.com>
	<47F00F72.2090905@open-vote.org>
Message-ID: <a71bd89a0803301512k7c484eb5wf3dbbdd98b7f93e4@mail.gmail.com>

On Sun, Mar 30, 2008 at 3:08 PM, Scott Ritchie <scott at open-vote.org> wrote:
>  > Can I bring the discussion back to my proposal,
>  > which was to have wine-1.0 notice old, unsupported .wine
>  > directories, and do something sensible?
>
>  If we're going to force users to remake ~/.wine, it would be ideal if we
>  only did that once.  Then we could provide some sort of upgrade path if
>  wineprefix changed again for some reason.

Agreed.

>  I'm wondering if the case-insensitive FUSE project could be finished in
>  time - this would allow us to both get a stable wineprefix and a
>  case-insensitive .wine folder.  This would save us the hassle of having
>  to worry about converting case-sensitive but proper-prefixed .wine folders.

Not likely.  I don't even think it's a very good idea.
- Dan


From wine-devel at kievinfo.com  Sun Mar 30 17:17:37 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 30 Mar 2008 16:17:37 -0600
Subject: Wine 1.0 status: T minus 68 days. 73 open bugs.
In-Reply-To: <3f4fd2640803301305p29cd0696i65c4f23254496cf@mail.gmail.com>
References: <a71bd89a0803300758i28654b00w17cc4ae5e0e6acfb@mail.gmail.com>	<47EFE453.8030109@redhat.com>
	<3f4fd2640803301305p29cd0696i65c4f23254496cf@mail.gmail.com>
Message-ID: <47F01181.6090407@kievinfo.com>

Reece Dunn wrote:
> On 30/03/2008, Michael Stefaniuc <mstefani at redhat.com> wrote:
>> Dan Kegel wrote:
>>  > 40 days to code freeze.
>>  >
>>> 12097         -unknown        2       Wine 1.0 should not ship out-of-sync resource translations
>> This bug can be closed only after Wine 1.0 ships. There are a lot of
>>  changes/cleanups at the moment that constantly break the translations.
> 
> There should also be a resource freeze, during which only translators
> can modify the resources (i.e. no En.rc changes) to give them a chance
> to translate them.
> 
> Should this be done before the code freeze, or is the time during code
> freeze enough for the translations?
> 
Code freeze should be enough. IMHO 1 week to sync translations will be 
enough. So imposing an extra freeze is totally unnecessary.

Vitaliy.


From wine-devel at kievinfo.com  Sun Mar 30 17:24:41 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 30 Mar 2008 16:24:41 -0600
Subject: user32: Implement BroadcastSystemMessage, try 5.1
In-Reply-To: <87y77zq5yl.fsf@wine.dyndns.org>
References: <b130c85e0803240515y66991587x19c0cebb899d7461@mail.gmail.com>	<87zlsnnage.fsf@wine.dyndns.org>	<b130c85e0803301353o5cfca3b0r7ac6247f5acee5af@mail.gmail.com>
	<87y77zq5yl.fsf@wine.dyndns.org>
Message-ID: <47F01329.4050801@kievinfo.com>

Alexandre Julliard wrote:
> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:
> 
>> Or wine is doing something wrong. After some more digging I found that
>> SetLastError() was set to 0 by TlsGetValue when called from X11DRV's
>> MsgWaitForMultipleObjectsEx. After I tried fixing this so that
>> SetLastError is only set when NULL is returned, one of the other tests
>> miraculously started working inside a todo block too (cursoricon).
>> I'll work on some testcases to verify that tlsgetvalue only calls
>> SetLastError(0) when succesfully returning null.
> 
> In most cases it's the test that is doing something wrong by being too
> strict. We don't care whether last error is modified or not on success,
> and there's no reason to test for it, unless it's one of the very few
> functions that do something special on success, or unless there is a
> real app that depends on it.
> 
I remember sending the patch for this exact thing a while back, which you of 
course refused under the same pretense - showing a real life app that 
depends on it. So if tests are not a real life app that shows a difference 
between Wine and windows - then why do we bother with Wine at all? At least 
should change the moto to "might run some apps with loads of problems and 
never be 100% compatible".

One for sure will find an app that in one way or another depends on 
undocumented windows behavior. So if a test can be written to show a 
difference between Wine and windows. Then this difference should be fixed in 
Wine.

Vitaliy.



From wine.dev at web.de  Sun Mar 30 17:22:39 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Mon, 31 Mar 2008 00:22:39 +0200
Subject: DLL exports... HELP?! (wine based win32 printer drivers for
	openprinting)
In-Reply-To: <15655.45446.qm@web23112.mail.ird.yahoo.com>
References: <15655.45446.qm@web23112.mail.ird.yahoo.com>
Message-ID: <1206915760.7820.93.camel@p4>

On Sa, 2008-03-29 at 15:51 +0000, Hin-Tak Leung wrote:
> > - The ddiwrapper-hack works only with a very small amount
> > of self-contained drivers
> 
> Yes, but say, a GSOC project for distinguishing which are
> self-contained and which are not?
Only Usermode Printer Drivers (w2k and above) can work
(NT4 use Kernelmode Printer Drivers, which depends on "win32k.sys")

- use cabextract or unzip to get all files from the driver-installer
- use "wine expand.exe", when needed
- use winedump to get the imports for the driver
- Find the needed exports from gdi32.dll:
  $ grep " Eng"
  $ grep " [A-Z]*OBJ_"

- use winedump to get the exports
- to find the main driver dll and the driverui dll for later use:
  $ grep " Drv" 
  => DrvQueryDriverInfo is required for usermode Printer Drivers

> I haven't got round to look at ddiwrapper yet, but it is in my hard
> disc now. 

> > - Most Drivers today are plugins for the unidrv or the
> > pscipt5 Driver
> >   (you can install pscript5 from Adobe since ~ 1/2 Year)
> > - Drivers expect dlls, that are not present in wine-2005*
> >   (They will not load)
> > - Rendering with full Drivers (Raster-Mode) need most Eng*
> > Functions
> >   and Friends (This is the DIB-Engine).
> > - Rendering with full Drivers (Postscript) need some Eng*
> > Functions
> >   and Friends.
> >   Nothing in this Area is implemented / exported in current
> > Wine:
> >   Driver will not load
> 
> The time frame - GSOC work being a little after wine 1.0 (and the
> merge of the other work) - should be interesting and useful?

The implementation must be acceptable by Julliard.
My suggested way for an implementation:
1 Support "winspool" as Drivername in gdi32
  (gdi32 must use winspool.drv and winspool.drv must load and use
  the correct DriverUI)
  (Manage DEVMODEW and DeviceCapabilities. Use Dialogs)
2 The Dialogs for native Drivers would be nice at this stage, but this
  needs compstui.dll and printui.dll. The amount of work here is enough
  for a seperate SoC Project
3 Load and Initialize the native driver dll (ask winspool.drv for the
  real name) and expand the DC_FUNCTIONS array to store the results of
  DrvEnableDriver
4 Prefer the DDI-Functions over the current used API in all related
  gdi32 - Functions.
5 Pick one or more Windows Portscript-Driver and implement the needed
  Engine-Functions in gdi32.dll
6 Pick stupid Windows Raster-Drivers and implement the needed
  Engine-Functions in gdi32.dll
7 Pick other Windows Raster-Drivers and implement the needed
  Engine-Functions in gdi32.dll

The SoC 2007 Project of Marcel did #6 for a Canon Driver. 
Code is available, but the correct location is gdi32.dll

What is "Engine-Functions in gdi32.dll" ?
The famous DIB-Engine

> > - Sending the rendered Data to the Printer need sometimes a
> > vendor-
> >   specific Portmonitor / Languagemonitor
> >   (Not supported in current Wine)
> 
> Yes, I think the epson epl windows driver does that...

- grep "Initialize.*Monitor" exports_extracted_with_winedump.txt
  : InitializePrintMonitor2
  : InitializePrintMonitor
  : InitializeMonitorEx
  : InitializeMonitor
  => A Driver with a Portmonitor / Langemonitor does not work yet

  : InitializePrintMonitorUI
  => The Portmonitor User Interface works with a native printui.dll
  ( rundll32.exe printui.dll,PrintUIEntry /s /t 1 )
  (I use redmon 1.7 for testing)


> A personal question: would be like to be involved if a student comes
> along, or in general in this area? (I looked it up, you were the
> mentor for the 2007 wine project for the printerproxy).

In general in this Area, Please.


-- 
 
By by ... Detlef




From m.b.lankhorst at gmail.com  Sun Mar 30 17:47:19 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 30 Mar 2008 15:47:19 -0700
Subject: user32: Implement BroadcastSystemMessage, try 5.1
In-Reply-To: <87y77zq5yl.fsf@wine.dyndns.org>
References: <b130c85e0803240515y66991587x19c0cebb899d7461@mail.gmail.com>
	<87zlsnnage.fsf@wine.dyndns.org>
	<b130c85e0803301353o5cfca3b0r7ac6247f5acee5af@mail.gmail.com>
	<87y77zq5yl.fsf@wine.dyndns.org>
Message-ID: <b130c85e0803301547n73177c8ft7ac83b7db569e373@mail.gmail.com>

Hello Alexandre,

2008/3/30, Alexandre Julliard <julliard at winehq.org>:
> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:
>
>
> > Or wine is doing something wrong. After some more digging I found that
>  > SetLastError() was set to 0 by TlsGetValue when called from X11DRV's
>  > MsgWaitForMultipleObjectsEx. After I tried fixing this so that
>  > SetLastError is only set when NULL is returned, one of the other tests
>  > miraculously started working inside a todo block too (cursoricon).
>  > I'll work on some testcases to verify that tlsgetvalue only calls
>  > SetLastError(0) when succesfully returning null.
>
>
> In most cases it's the test that is doing something wrong by being too
>  strict. We don't care whether last error is modified or not on success,
>  and there's no reason to test for it, unless it's one of the very few
>  functions that do something special on success, or unless there is a
>  real app that depends on it.
Well, EnumWindows encourages applications to use setlasterror to set
an error message to pass a return value. Suppose if I took this
approach, and then called SendMessageTimeout from my enumeration
function, the last error would be useless because it's overwritten.
Adding a few lines to SendMessageTimeout confirms this behavior:
Windows doesn't overwrite the last error by default. I tracked where
it does timeout to that tlsgetvalue call in
MsgWaitForMultipleObjectsEx, which doesn't currently have last error
tests. I assume it doesn't change last error unless it returns null
and has success. This would fix SendMessageTimeout to act more like
windows and my BroadcastSystemMessage implementation.

And regarding 'there is no real life app that depends on it', too
often I find obscure problems with applications because wine does
something slightly different then windows does...

Cheers,
Maarten.


From wine.dev at web.de  Sun Mar 30 18:12:15 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Mon, 31 Mar 2008 01:12:15 +0200
Subject: wine based win32 printer drivers
In-Reply-To: <47EF10FC.2060905@gmx.net>
References: <15655.45446.qm@web23112.mail.ird.yahoo.com>
	<47EF10FC.2060905@gmx.net>
Message-ID: <1206918736.7820.140.camel@p4>

On So, 2008-03-30 at 06:03 +0200, Marcel Partap wrote:
> Anyways, I am working on getting something merged.. 

Great!

> For now the target is to get the Adobe pscript5 driver working which
> has its own raster renderer and thus does not depend on the dib
> engine. 
A Postscript Driver has no raster renderer...
A Postscript Driver has a Postscript Engine.

> Just started by making AddPrinter correctly get 
> a default devmode out of the driver, patch is attached, 

> DRIVER_EVENT_INITIALIZE, 3,
"3" is wrong here. See: myAddPrinterDriverEx(DWORD level, ...

Since there are much more Events, we need the DriverUI in more Places
later. I suggest a simple struct, which can be extended later
(The struct must include the Results from GetProcAddress)


The changes for winspool.drv must go in a seperate Patch.
WINSPOOL_CallDrvDocumentProperties is the wrong name, when you 
call DrvDocumentPropertySheets.

You should collect all API in winspool.drv, that need the driverui
(some are not implemented) and design a simple struct
with helper functions (Use monitor_t as example).
Not all Drivers Export DrvDocumentPropertySheets.
You must prepare to use a Fallback to get the default devmode
(DrvConvertDevMode)
See winspool.drv/monitor_load as Example:
- InitializePrintMonitor2 is suggested my MSDN, but not needed yet
- InitializePrintMonitor implemented
- InitializeMonitorEx and InitializeMonitor as Fallback.

The current Code is a crosscall from DocumentPropertiesW to
DocumentPropertiesA.
The DDI-API is unicode and should be the prefered way.
When wineps.drv is updated, the old code with the crosscall can be
removed, since we do not support ANSI Drivers (Windows 9x).

You can even use the same struct and helper functions 
in localspl.dll and winspool.drv


-- 
 
By by ... Detlef




From wine-devel at kievinfo.com  Sun Mar 30 20:13:46 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 30 Mar 2008 19:13:46 -0600
Subject: setupapi: prevent page faults in
	SetupDiDeleteDeviceInterfaceRegKey
In-Reply-To: <47F029C9.1060500@procyongames.com>
References: <47F029C9.1060500@procyongames.com>
Message-ID: <47F03ACA.5010308@kievinfo.com>

Christopher wrote:
> Changelog:
> Check that the handle and pointer passed to 
> SetupDiDeleteDeviceInterfaceRegKey are valid to read from. This patch 
> continues to address bug #12242
> 
> -    if (!DeviceInterfaceData ||
> +    if (!DeviceInterfaceData || IsBadReadPtr(DeviceInterfaceData, sizeof(SP_DEVICE_INTERFACE_DATA)) ||

Don't ever use IsBadReadPtr and IsBadWritePtr functions. They are bad and
even MS stopped using them. You have to use TRY-EXCEPT block around an
access to the memory. For example see implementation of lstrcpyA
(kernel32/string.c: 359).

> +    ok(!ret && GetLastError() == ERROR_INVALID_HANDLE, "Expected SetupDiDeleteDeviceInterfaceRegKey to return FALSE, got %s, \
> +with error code: 6, got %d\n", ret ? "TRUE" : "FALSE", GetLastError());

This is bad way to split strings in c. Do something like this:

    ok(!ret && GetLastError() == ERROR_INVALID_HANDLE,
	"Expected SetupDiDeleteDeviceInterfaceRegKey to return FALSE, got %s, "
	"with error code: 6, got %d\n", ret ? "TRUE" : "FALSE", GetLastError());

Vitaliy.


From mpartap at gmx.net  Sun Mar 30 22:52:32 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Mon, 31 Mar 2008 05:52:32 +0200
Subject: wine based win32 printer drivers
In-Reply-To: <1206918736.7820.140.camel@p4>
References: <15655.45446.qm@web23112.mail.ird.yahoo.com>	
	<47EF10FC.2060905@gmx.net> <1206918736.7820.140.camel@p4>
Message-ID: <47F06000.7050401@gmx.net>

> A Postscript Driver has no raster renderer...
> A Postscript Driver has a Postscript Engine.
... ^ ^

>> DRIVER_EVENT_INITIALIZE, 3,
> "3" is wrong here. See: myAddPrinterDriverEx(DWORD level, ...
It seemed suspicious to me anyway.. How do those integer shifts creep into my retyped header files 
again and again? mmmmhhh ... *g

> Since there are much more Events, we need the DriverUI in more Places
> later. I suggest a simple struct, which can be extended later
> (The struct must include the Results from GetProcAddress)
a struct.. that contains what? the function pointers and results? i had thought about adding a 
macro.. for hooking driver exports..

> The changes for winspool.drv must go in a seperate Patch.
yeah it jsut was a quick and dirty preview patch ;)

> WINSPOOL_CallDrvDocumentProperties is the wrong name, when you 
> call DrvDocumentPropertySheets.
statement totally makes sense.

> You should collect all API in winspool.drv, that need the driverui
> (some are not implemented) and design a simple struct
> with helper functions (Use monitor_t as example).
I dont really grok it... like the DDI_FUNCS array in the patch i sent you or rather somethign
stuct {
     LPWSTR name;
     LPWSTR driverdll;
     HMODULE hdriver;
     LPWSTR interfacedll;
     HMODULE hinterface,
     DWORD refcount;
} printertriver_t;
?

> Not all Drivers Export DrvDocumentPropertySheets.
> You must prepare to use a Fallback to get the default devmode
> (DrvConvertDevMode)
ok just need to transplant my old code

> See winspool.drv/monitor_load as Example:
l8r :)

> The current Code is a crosscall from DocumentPropertiesW to
> DocumentPropertiesA.
> The DDI-API is unicode and should be the prefered way.
so shall i put the ddi call before that deprecated stuff? and does it need to be called from docpropsA?
oh and I reodne the EnumForms patch (now less monsterous ;). Now here's only the part that provides 
the builtin forms, but very easy to expand, once its ready to be &/ comimtted i'll do the addforms 
delforms stuff..
and oh sh1t gotta write my soc application today last day heh.. this time i'm opting for drupal/php 
code though C/win32api is just too hellish *g
n8

-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0002-winspool-implement-EnumFormsA-W-with-built-in-forms.patch
Type: text/x-patch
Size: 0 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080331/cbf62e0d/attachment.bin 

From mpartap at gmx.net  Sun Mar 30 22:29:09 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Mon, 31 Mar 2008 05:29:09 +0200
Subject: [PATCH] winspool: implement EnumFormsA/W with built-in forms
Message-ID: <mailman.311.1206935570.3731.wine-devel@winehq.org>

---
 dlls/winspool.drv/info.c |  145 ++++++++++++++++++++++++++++++++++++++++++---
 1 files changed, 135 insertions(+), 10 deletions(-)

diff --git a/dlls/winspool.drv/info.c b/dlls/winspool.drv/info.c
index 351aaba..0071ef4 100644
--- a/dlls/winspool.drv/info.c
+++ b/dlls/winspool.drv/info.c
@@ -123,6 +123,17 @@ typedef struct {
     WCHAR *document_title;
 } job_t;
 
+typedef struct {
+    SIZEL size;
+    RECTL area;
+    DWORD formorder;
+    DWORD flags;
+} form_regentry_t;
+
+typedef struct {
+    WCHAR           formname[CCHFORMNAME];
+    form_regentry_t formdata;
+} builtin_form_t;
 
 typedef struct {
     LPCWSTR  envname;
@@ -248,6 +259,12 @@ static const WCHAR LPR_Port[] = {'L','P','R',':',0};
 static const WCHAR default_doc_title[] = {'L','o','c','a','l',' ','D','o','w','n','l','e','v','e','l',' ',
                                           'D','o','c','u','m','e','n','t',0};
 
+static const builtin_form_t builtin_forms[] = {
+    {{'L','e','t','t','e','r',0}, {{216000,279000}, {0,0,216000,279000}, 0, FORM_BUILTIN}},
+    {{'A','3',0}, {{297000,420000}, {0,0,297000,420000}, 0, FORM_BUILTIN}},
+    {{'A','4',0}, {{210000,297000}, {0,0,210000,297000}, 0, FORM_BUILTIN}},
+    {{'A','5',0}, {{148000,210000}, {0,0,148000,210000}, 0, FORM_BUILTIN}} };
+
 static const DWORD di_sizeof[] = {0, sizeof(DRIVER_INFO_1W), sizeof(DRIVER_INFO_2W),
                                      sizeof(DRIVER_INFO_3W), sizeof(DRIVER_INFO_4W),
                                      sizeof(DRIVER_INFO_5W), sizeof(DRIVER_INFO_6W),
@@ -7181,23 +7198,131 @@ BOOL WINAPI DeletePrintProvidorW(LPWSTR pName, LPWSTR pEnvironment, LPWSTR pPrin
 /******************************************************************************
  *      EnumFormsA (WINSPOOL.@)
  */
-BOOL WINAPI EnumFormsA( HANDLE hPrinter, DWORD Level, LPBYTE pForm,
-    DWORD cbBuf, LPDWORD pcbNeeded, LPDWORD pcReturned )
+BOOL WINAPI EnumFormsA(HANDLE hPrinter, DWORD Level, LPBYTE pForm,
+                       DWORD cbBuf, LPDWORD pcbNeeded, LPDWORD pcReturned)
 {
-    FIXME("%p %x %p %x %p %p\n", hPrinter, Level, pForm, cbBuf, pcbNeeded, pcReturned);
-    SetLastError(ERROR_CALL_NOT_IMPLEMENTED);
-    return FALSE;
+    PFORM_INFO_1A fiA;
+    PFORM_INFO_1W fiW;
+    LPBYTE bufferW;
+    BOOL   res;
+    DWORD  i;
+    DWORD  needed = 0;
+    DWORD  num = 0;
+
+    TRACE("(%p %d %p %d %p %p)\n", hPrinter, Level, pForm, cbBuf, pcbNeeded, pcReturned);
+
+    if (!pcbNeeded || !pcReturned) {
+        SetLastError(RPC_X_NULL_REF_POINTER);
+        return FALSE;
+    }
+    EnumFormsW(hPrinter, Level, NULL, 0, &needed, &num);
+    if (!needed)
+        return FALSE;
+    *pcbNeeded = (needed - num*sizeof(FORM_INFO_1W))/sizeof(WCHAR) + num*sizeof(FORM_INFO_1W);
+    if (cbBuf < *pcbNeeded) {
+        SetLastError(ERROR_INSUFFICIENT_BUFFER);
+        return FALSE;
+    }
+    if (!pForm) {
+        SetLastError(ERROR_INVALID_USER_BUFFER);
+        return FALSE;
+    }
+    bufferW = HeapAlloc(GetProcessHeap(), 0, needed);
+    res = EnumFormsW(hPrinter, Level, bufferW, needed, &needed, pcReturned);
+    if (res) {
+        fiA = (PFORM_INFO_1A)pForm;
+        fiW = (PFORM_INFO_1W)bufferW;
+        for (i = 0; i < *pcReturned; i++) {
+            memcpy(fiA, fiW, sizeof(FORM_INFO_1W));
+            cbBuf -= sizeof(FORM_INFO_1A);
+            cbBuf -= WideCharToMultiByte(CP_ACP, 0, fiW->pName, -1, fiA->pName, cbBuf, NULL, NULL);
+            fiA++;
+            fiW++;
+        }
+    }
+    HeapFree(GetProcessHeap(), 0, bufferW);
+    TRACE("returning %d with %d (%d Bytes for %d entries)\n", res, GetLastError(), *pcbNeeded, *pcReturned);
+    return res;
 }
 
 /******************************************************************************
  *      EnumFormsW (WINSPOOL.@)
+ * enumerates available paper forms (not printer specific)
+ * 
+ * PARAMS
+ *  hPrinter   (I) handle to printer (must be valid)
+ *  Level      (I) type of returned form information data structure
+ *  pForm      (O) pointer to user supplied buffer
+ *  cbBuf      (I) size of output buffer
+ *  pcbNeeded  (O) required/ used buffer space
+ *  pcReturned (O) number of returned forms
+ *
+ * RETURNS
+ *  Success: TRUE (non-zero value)
+ *  Failure: FALSE (0)
+ *
+ * FIXME
+ *  level 2 not yet implemented
  */
-BOOL WINAPI EnumFormsW( HANDLE hPrinter, DWORD Level, LPBYTE pForm,
-    DWORD cbBuf, LPDWORD pcbNeeded, LPDWORD pcReturned )
+BOOL WINAPI EnumFormsW(HANDLE hPrinter, DWORD Level, LPBYTE pForm,
+                       DWORD cbBuf, LPDWORD pcbNeeded, LPDWORD pcReturned)
 {
-    FIXME("%p %x %p %x %p %p\n", hPrinter, Level, pForm, cbBuf, pcbNeeded, pcReturned);
-    SetLastError(ERROR_CALL_NOT_IMPLEMENTED);
-    return FALSE;
+    opened_printer_t *printer = NULL;
+    PFORM_INFO_1W fiW;
+    LPWSTR strptr;
+    BOOL   res = FALSE;
+    DWORD  i;
+    DWORD  num;
+    DWORD  needed = 0;
+
+    TRACE("(%p %d %p %d %p %p)\n", hPrinter, Level, pForm, cbBuf, pcbNeeded, pcReturned);
+
+    if (!(printer = get_opened_printer(hPrinter))) {
+        SetLastError(ERROR_INVALID_HANDLE);
+        return FALSE;
+    }
+    if (Level != 1) {
+        if (Level == 2)
+            FIXME("level 2 not yet supported\n");
+        SetLastError(ERROR_INVALID_LEVEL);
+        return FALSE;
+    }
+
+    num = sizeof(builtin_forms)/sizeof(builtin_form_t);
+    for (i = 0; i < num; i++) {
+        needed += sizeof(FORM_INFO_1W) + (strlenW(builtin_forms[i].formname)+1)*sizeof(WCHAR);
+    }
+
+    if (cbBuf < needed) {
+        SetLastError(ERROR_INSUFFICIENT_BUFFER);
+        goto efw_cleanup;
+    }
+    if (!pForm) {
+        SetLastError(ERROR_INVALID_USER_BUFFER);
+        goto efw_cleanup;
+    }
+    if (!pcbNeeded || !pcReturned) {
+        SetLastError(RPC_X_NULL_REF_POINTER);
+        goto efw_cleanup;
+    }
+    strptr = (LPWSTR)(pForm + num*sizeof(FORM_INFO_1W));
+    fiW = (PFORM_INFO_1W)pForm;
+    for (i = 0; i < num; i++) {
+        fiW->pName = lstrcpyW(strptr, builtin_forms[i].formname);
+        fiW->Size = builtin_forms[i].formdata.size;
+        fiW->ImageableArea = builtin_forms[i].formdata.area;
+        fiW->Flags = builtin_forms[i].formdata.flags;
+        fiW++;
+        strptr += lstrlenW(builtin_forms[i].formname)+1;
+    }
+    res = TRUE;
+
+efw_cleanup:
+    if (pcbNeeded) *pcbNeeded = needed;
+    if (pcReturned && res) *pcReturned = num;
+
+    TRACE("returning %d with %d (%d Bytes for %d entries)\n", res, GetLastError(), needed, num);
+    return res;
 }
 
 /*****************************************************************************
-- 
1.5.4.4


--------------060407040401010404000601--


From juan.lang at gmail.com  Sun Mar 30 23:08:13 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Sun, 30 Mar 2008 21:08:13 -0700
Subject: ws2_32 janitorial questions
In-Reply-To: <fsm9tm$msj$1@ger.gmane.org>
References: <fsm9tm$msj$1@ger.gmane.org>
Message-ID: <3a768c550803302108x5b980f6av1eda8c583146a07e@mail.gmail.com>

>  ws2_32/async.c has the following global declarations:
>
>  /* protoptypes of some functions in socket.c
>   */
>  UINT16 wsaErrno(void);
>  UINT16 wsaHerrno(int errnr);
>
>  ws2_32/socket.c has the following global declarations:
>
>  UINT wsaErrno(void);
>  UINT wsaHerrno(int errnr);
>
>  Where are these functions defined? And, assuming that the above are
>  conflicting declarations, what type does each of these functions actually
>  return?

socket.c:
http://source.winehq.org/source/dlls/ws2_32/socket.c#L4055

They return UINTs.  The return types don't conflict if compiled with a
32-bit compiler, but the one in async.c at least looks incorrect.
--Juan


From stefandoesinger at gmx.at  Sun Mar 30 18:08:09 2008
From: stefandoesinger at gmx.at (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Mon, 31 Mar 2008 01:08:09 +0200
Subject: Direct3D shader compiler infrastructure
Message-ID: <200803310108.09269.stefandoesinger@gmx.at>

Hello,

So, I am getting serious about a shader compiler and related things now, and 
I've made a design proposal.

First of all, let us collect a few things we want regarding shader handling:
-> D3DXCompileShader & Friends
-> D3DXAssembleShader & Friends
-> D3DXDisassembleShader & Friends
-> A way to deal with d3d9 and d3d10 shader language differences

All these items are related in some way, so I am proposing the following 
design of a shader library:

The core part of the library is a wine internal shader language representing 
D3D assembler shaders. Shaders in this language can be created from D3D 
Bytecode("SlDisassembleShader"), D3D ASM("SlAssembleShader") and from 
HLSL("SlCompileShader"). From the intermediate language, D3D bytecode can be 
generated in various versions(SlGenBytecode), as well as D3D Text 
asm(SlGenAsm). Unlike regular D3D asm languages, this language does not have 
a version token, it is a superset of all asm language versions. It does have 
a pixel / vertex / geometry shader flag though.

The motivation behind an intermediate language is to avoid writing many 
different code generators, which is a big part of the HLSL compiler. We also 
need a WineD3D intermediate language to share our shader generator between 
d3d9 and d3d10, and use it for both kinds of shaders. The requirements for 
both intermediate asm languages are the same. This motivates making the 
language the same to reuse code.

With those functions, the D3DX functions are pretty streightforward:
D3DXAssembleShader:
bytecode = SlGenBytecode(SlAssembleShader(char *asm_text));

D3DXCompileShader:
bytecode = SlGenBytecode(SlCompileShader(char *hlsl_text));

D3DXDisassembleShader
asm_text = SlGenAsm(SlDisassembleShader(DWORD *bytecode));

WineD3D can be changed to use this shader language as shader input. In this 
case, d3d8, d3d9 and d3d10 run their shader bytecode through 
SlDisassembleShader, and pass the returned pointer to WineD3D. This in turn 
calls SlCopyShader to make a copy it owns, and d3d8/9/10 free their copy 
using SlDestroyShader.

With WineD3D working on the same language, we have to share the language 
definition between the shader library and WineD3D, or put the shader compiler 
into WineD3D as well. I do not like the 2nd way, as it puts things together 
that don't have to be in one lib, and wastes runtime memory. A 3rd way I have 
to consider was a SlReadShader() function with callbacks which takes over the 
current role of shader_generate_main() in WineD3D. I am not quite convinced 
by this either.

Attached are a few files for reference:
shaderlib.gif: A diagram explaining the roles of the languages(No, it is not 
UML 2.0)
uses.gif: Illustrating various uses of the shader library
shader-lang: A very early pseudocode definition of the language

The intermediate asm language follows the same principles as D3D bytecode. A 
shader contains any number of instructions, each instruction has one 
destination register and any number of source registers. The instructions 
have an opcode, writemask, modifiers. A register has a type, an index, 
information about relative addressing, source modifiers, and a swizzle.

Appart of the instructions, the shader contains a header with informations 
about the shader. Declarations, input/output semantics, special registers 
used, etc. This replaces the shader_get_registers_used() pass in WineD3D. It 
is done by the shader library, and it also generates the declarations for 1.x 
pixel shaders. (We still have to find out which texture type to read from in 
wined3d).

Thanks,
Stefan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: shaderlib.gif
Type: image/gif
Size: 19677 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080331/241fe54b/attachment-0002.gif 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: shader-lang
Type: text/x-csrc
Size: 812 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080331/241fe54b/attachment-0001.c 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uses.gif
Type: image/gif
Size: 15819 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080331/241fe54b/attachment-0003.gif 

From hverbeet at gmail.com  Mon Mar 31 01:54:18 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 31 Mar 2008 08:54:18 +0200
Subject: Direct3D shader compiler infrastructure
In-Reply-To: <200803310108.09269.stefandoesinger@gmx.at>
References: <200803310108.09269.stefandoesinger@gmx.at>
Message-ID: <d658b69e0803302354v3b5f1dccufdc6a6c29a32fdc@mail.gmail.com>

On 31/03/2008, Stefan D?singer <stefandoesinger at gmx.at> wrote:
>  With WineD3D working on the same language, we have to share the language
>  definition between the shader library and WineD3D, or put the shader compiler
>  into WineD3D as well. I do not like the 2nd way, as it puts things together
>  that don't have to be in one lib, and wastes runtime memory. A 3rd way I have
>  to consider was a SlReadShader() function with callbacks which takes over the
>  current role of shader_generate_main() in WineD3D. I am not quite convinced
>  by this either.
>
Looks reasonable enough in general. I guess it would make sense to
create some kind of "shader utilities" library that can be used from
both wined3d and d3d9x. You could in principle even move GLSL/ARB code
generation in there, although that isn't required of course.


From leslie_alistair at hotmail.com  Mon Mar 31 03:14:51 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Mon, 31 Mar 2008 19:14:51 +1100
Subject: midl question
References: <fsg18l$7c2$1@ger.gmane.org> <47EB964E.7070101@codeweavers.com>
Message-ID: <fsq6h5$gia$1@ger.gmane.org>

Hi Rob,

What work would need to be done to get widl to support __stdcall?

Best Regards
 Alistair Leslie-Hughes



