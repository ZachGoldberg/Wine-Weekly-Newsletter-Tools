From dmitry at codeweavers.com  Tue Apr  1 00:11:14 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 1 Apr 2008 14:11:14 +0900
Subject: user32: Implement GetWindowModuleFileName with tests (try 2)
References: <b130c85e0802121730m16fd0baej12eb451172d2add@mail.gmail.com>
	<87r6feeboe.fsf@wine.dyndns.org>
Message-ID: <00da01c893b6$d1f73830$a600fea9@DMITRY>

"Alexandre Julliard" <julliard at winehq.org> wrote:

> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:
> 
>> @@ -3121,9 +3133,21 @@ UINT WINAPI GetWindowModuleFileNameA( HWND hwnd, LPSTR lpszFileName, UINT cchFil
>>   */
>>  UINT WINAPI GetWindowModuleFileNameW( HWND hwnd, LPWSTR lpszFileName, UINT cchFileNameMax)
>>  {
>> -    FIXME("GetWindowModuleFileNameW(hwnd %p, lpszFileName %p, cchFileNameMax %u) stub!\n",
>> -          hwnd, lpszFileName, cchFileNameMax);
>> -    return 0;
>> +    HINSTANCE hInst;
>> +    UINT ret;
>> +    TRACE("hwnd %p, lpszFileName %p, cchFileNameMax %u\n", hwnd, lpszFileName, cchFileNameMax);
>> +
>> +    hInst = (HINSTANCE)GetWindowLongPtrW(hwnd, GWLP_HINSTANCE);
>> +    if (!hInst)
>> +    {
>> +        if (hwnd == GetDesktopWindow() || !IsWindow(hwnd))
>> +            return 0;
>> +        hInst = GetModuleHandleW(0);
>> +    }
>> +
>> +    ret = GetModuleFileNameW(hInst, lpszFileName, cchFileNameMax);
>> +    TRACE("--> %d %s\n", ret, debugstr_wn(lpszFileName, ret));
>> +    return ret;
> 
> This won't work across processes.

Looks like GetWindowModuleFileName is not supposed to work for other
process windows, at least in the following snippet both GetWindowLongPtr
and GetWindowModuleFileName return 0 but don't change the last error value
under XP although FindWindow returns a valid window handle:

hwnd = FindWindow("Shell_TrayWnd", NULL);
SetLastError(0xdeadbeef);
ret = GetWindowModuleFileNameA(hwnd, buf, sizeof(buf));
printf("hwnd %p, ret %u, buf \"%s\", error %u\n", hwnd, ret, buf, GetLastError());

SetLastError(0xdeadbeef);
hinst = (HINSTANCE)GetWindowLongPtr(hwnd, GWLP_HINSTANCE);
printf("hwnd %p, hinst %u, error %u\n", hwnd, ret, GetLastError());

GetWindowLong(hwnd, GWL_STYLE) returns a valid style. Both APIs behave the same
way for the desktop window.

So the above implementation of GetWindowModuleFileName looks correct except
a special case for the desktop window (GetWindowLong() should be fixed instead).

-- 
Dmitry.


From dmitry at codeweavers.com  Tue Apr  1 00:31:45 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 1 Apr 2008 14:31:45 +0900
Subject: user32: Implement GetWindowModuleFileName with tests (try 2)
References: <b130c85e0802121730m16fd0baej12eb451172d2add@mail.gmail.com><87r6feeboe.fsf@wine.dyndns.org>
	<00da01c893b6$d1f73830$a600fea9@DMITRY>
Message-ID: <015301c893b9$aeeab7b0$a600fea9@DMITRY>

"Dmitry Timoshkov" <dmitry at codeweavers.com> wrote:

>> This won't work across processes.
> 
> Looks like GetWindowModuleFileName is not supposed to work for other
> process windows, at least in the following snippet both GetWindowLongPtr
> and GetWindowModuleFileName return 0 but don't change the last error value
> under XP although FindWindow returns a valid window handle:

AF in the bug 10002 pointed out to http://support.microsoft.com/kb/228469
which explains that.

-- 
Dmitry.


From truiken at gmail.com  Tue Apr  1 01:58:34 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 1 Apr 2008 01:58:34 -0500
Subject: Greek translation patch correction
In-Reply-To: <b432a8110803311521y1e606fa1wfcaa0e5e35bcf3a7@mail.gmail.com>
References: <b432a8110803311521y1e606fa1wfcaa0e5e35bcf3a7@mail.gmail.com>
Message-ID: <22821af30803312358o1fe1ca4bvf3a420bec18ce280@mail.gmail.com>

2008/3/31 Dj Apal [GR] <djapal at gmail.com>:
> Here are the separate patches as requested by James Hawkins
>

One patch per email.  I see that's not on the sending_patches
page...man our documentation is in such bad shape (and scattered all
over the place).

-- 
James Hawkins


From paul.vriens.wine at gmail.com  Tue Apr  1 02:37:48 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 01 Apr 2008 09:37:48 +0200
Subject: Wine Release Plan
Message-ID: <47F1E64C.4020909@gmail.com>

Hi,

Just noticed that the dates attached to the versions on 
http://wiki.winehq.org/WineReleasePlan are not correct.

0.9.58 came out on March 21st.

Does this mean we still stick to May 9th or do we stick to 0.9.61 as being 
1.0.0.rc1?

-- 
Cheers,

Paul.


From truiken at gmail.com  Tue Apr  1 03:31:49 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 1 Apr 2008 03:31:49 -0500
Subject: [Bug 3297] UpdateWindow() doesn't call XFlush()
In-Reply-To: <E1Jgbe6-0005ak-Mb@wine.codeweavers.com>
References: <bug-3297-3987@http.bugs.winehq.org/>
	<E1Jgbe6-0005ak-Mb@wine.codeweavers.com>
Message-ID: <22821af30804010131y538fa3cfocbe16f286d4a242@mail.gmail.com>

On Tue, Apr 1, 2008 at 3:15 AM,  <wine-bugs at winehq.org> wrote:
> http://bugs.winehq.org/show_bug.cgi?id=3297
>
>
>  Dmitry Timoshkov <dmitry at codeweavers.com> changed:
>
>            What    |Removed                     |Added
>  ----------------------------------------------------------------------------
>            Keywords|patch                       |
>
>
>
>
>  --- Comment #6 from Dmitry Timoshkov <dmitry at codeweavers.com>  2008-04-01 03:15:06 ---
>  The patch is obviously incorrect, so it doesn't count.
>

There are a lot of bugs with incorrect patches that have the patch
keyword.  The patch keyword is not to make sure that all bug reports
with correct patches attached get those patches submitted and
committed.  The point of the keyword is to alert developers to a
source of information.  A user attaches a patch and says, "this makes
the app work."  Even if the patch is wrong, a developer can see what
change makes the app work, and this can potentially help the developer
write a correct patch.

-- 
James Hawkins


From rob at codeweavers.com  Tue Apr  1 03:58:39 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Tue, 01 Apr 2008 09:58:39 +0100
Subject: Hey all, introducing myself and my GSoC idea...
In-Reply-To: <22821af30803311824v77095ec6o24f84772df50b447@mail.gmail.com>
References: <f20910b80803311630g22f40ed0re963b9faf0a360e@mail.gmail.com>	<19e31a080803311709u5cc90246te5682416796d5e37@mail.gmail.com>	<3a768c550803311811y338ca136s7c3d261599be08a1@mail.gmail.com>
	<22821af30803311824v77095ec6o24f84772df50b447@mail.gmail.com>
Message-ID: <47F1F93F.5050902@codeweavers.com>

James Hawkins wrote:
> On Mon, Mar 31, 2008 at 8:11 PM, Juan Lang <juan.lang at gmail.com> wrote:
>   
>>  Personally, I've thought that playing around with the
>>  native LPC API might be interesting.  I'm sure there are other areas
>>  of the native API that are sparsely documented, and for which some
>>  test cases might prove useful.
>>     
>
> But is the API in question useful for the Wine project as far as
> fixing apps?  I don't think we should devote SOC resources to a
> project that doesn't progress Wine beyond just implementing more APIs.

It is useful for getting native rpcrt4 to work, which in turn is useful 
for getting other COM DLLs to work, and so is potentially useful for bug 
triage and identifying the source of bugs in builtin COM DLLs.

-- 
Rob Shearman



From stefan at codeweavers.com  Tue Apr  1 04:45:19 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 1 Apr 2008 11:45:19 +0200
Subject: d3d9: Add some visual tests for Direct3DDevice9_StretchRect()
In-Reply-To: <df81031c0803312220o6066111bs40b101a12e9bad87@mail.gmail.com>
References: <df81031c0803312220o6066111bs40b101a12e9bad87@mail.gmail.com>
Message-ID: <200804011145.19925.stefan@codeweavers.com>

Am Dienstag, 1. April 2008 07:20:44 schrieb Jason Green:
Did you take a look at the various capability flags? I think the test as you 
submitted it is correct for dx9 level cards and drivers, but there are a few 
capability flags like D3DDEVCAPS2_CANSTRETCHRECTFROMTEXTURE or similar. Also 
some drivers seem to refuse StretchRecting between offscreenplain surfaces, 
even if no stretching is used.

Do you have any ideas what the scheme behind the allowed/forbidden blits is? 
So far I can see this:

-> Blitting to a rendertarget surface/texture is always OK
-> blitting between offscreen surfaces is ok as long as no stretching occurs
-> blitting to non-RT surfaces/textures faily, except the above

Did you test blitting from/to sysmem surfaces? The msdn says both must be 
D3DPOOL_DEFAULT as far as I remember


From lich at math.spbu.ru  Tue Apr  1 04:58:25 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Tue, 1 Apr 2008 13:58:25 +0400
Subject: kernel32: add stub for GetConsoleDisplayMode() et al
Message-ID: <200804011358.25879.lich@math.spbu.ru>

Hi,

  In the first patch of the series you really implement 
SetConsoleDisplayMode() instead of GetConsoleDisplayMode(), don't you?

  And it is dangerous to return success in pure stub functions, especially 
GetConsoleDisplayMode(). Returning FALSE and setting last error to 
ERROR_CALL_NOT_IMPLEMENTED will be much better.

--
Kirill


From julliard at winehq.org  Tue Apr  1 05:12:49 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 01 Apr 2008 12:12:49 +0200
Subject: Wine Release Plan
In-Reply-To: <47F1E64C.4020909@gmail.com> (Paul Vriens's message of "Tue, 01
	Apr 2008 09:37:48 +0200")
References: <47F1E64C.4020909@gmail.com>
Message-ID: <87tzilevdq.fsf@wine.dyndns.org>

Paul Vriens <paul.vriens.wine at gmail.com> writes:

> Just noticed that the dates attached to the versions on 
> http://wiki.winehq.org/WineReleasePlan are not correct.
>
> 0.9.58 came out on March 21st.
>
> Does this mean we still stick to May 9th or do we stick to 0.9.61 as being 
> 1.0.0.rc1?

We should stick to May 9th, we'll just have to wait for this date to
coincide with a release. If my calculations are right this should be
release 0.9.218 on May 9th, 2014. Hopefully we can clear the 1.0 bug
list by then.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Tue Apr  1 06:32:35 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 01 Apr 2008 13:32:35 +0200
Subject: imm: Keep track of context associations between HWND and HIMC
In-Reply-To: <47F1288D.8020801@codeweavers.com> (Aric Stewart's message of
	"Mon, 31 Mar 2008 13:08:13 -0500")
References: <47F1288D.8020801@codeweavers.com>
Message-ID: <87prt9eros.fsf@wine.dyndns.org>

Aric Stewart <aric at codeweavers.com> writes:

> @@ -93,12 +93,21 @@ typedef struct _tagTRANSMSG {
>      LPARAM lParam;
>  } TRANSMSG, *LPTRANSMSG;
>  
> +typedef struct _tagContextAssociation {
> +    struct list entry;
> +
> +    HWND    *hwnds;
> +    UINT    wndCount;
> +    HIMC    context;
> +} ContextAssociation;

Wouldn't it be a lot easier to store the HIMC in a window property?

-- 
Alexandre Julliard
julliard at winehq.org


From jeroen.janssen at gmail.com  Tue Apr  1 07:33:33 2008
From: jeroen.janssen at gmail.com (Jeroen Janssen)
Date: Tue, 1 Apr 2008 12:33:33 +0000 (UTC)
Subject: SOC Direct3D - Implement missing =?utf-8?b?RDNEOV94eA==?= DLLs?
Message-ID: <loom.20080401T122814-132@post.gmane.org>

Hi,

I was looking at the Wine SOC wiki ( http://wiki.winehq.org/SummerOfCode ) and
noticed an entry on "Direct3D - Implement missing D3D9_xx DLLs".

As far as I can see there are already lots of D3D9_xx dlls in the tree that seem
to forward stuf correctly.

Can someone confirm this to be already finished (and then remove this item from
the wiki?) If it isn't finished yet, what IS missing then?

D3D10_xx DLLs seem to be currently missing (I know we don't have any d3d 10
implementation yet in wine) and it probably isn't a SOC project, but would
completely stubbed D3D10_xx DLLs (patches) be accepted if I submit them to the
patch mailinglist or not?

Best regards,

Jeroen Janssen



From aric at codeweavers.com  Tue Apr  1 07:42:19 2008
From: aric at codeweavers.com (Aric Stewart)
Date: Tue, 01 Apr 2008 07:42:19 -0500
Subject: imm: Keep track of context associations between HWND and HIMC
In-Reply-To: <87prt9eros.fsf@wine.dyndns.org>
References: <47F1288D.8020801@codeweavers.com> <87prt9eros.fsf@wine.dyndns.org>
Message-ID: <47F22DAB.6090604@codeweavers.com>

It would be but I could not find evidence that such a property existed 
for all windows in Window. If you are proposing a wine internal property 
then it would work well.

-aric

Alexandre Julliard wrote:
> Aric Stewart <aric at codeweavers.com> writes:
> 
>> @@ -93,12 +93,21 @@ typedef struct _tagTRANSMSG {
>>      LPARAM lParam;
>>  } TRANSMSG, *LPTRANSMSG;
>>  
>> +typedef struct _tagContextAssociation {
>> +    struct list entry;
>> +
>> +    HWND    *hwnds;
>> +    UINT    wndCount;
>> +    HIMC    context;
>> +} ContextAssociation;
> 
> Wouldn't it be a lot easier to store the HIMC in a window property?
> 


From hverbeet at gmail.com  Tue Apr  1 08:06:37 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Tue, 1 Apr 2008 15:06:37 +0200
Subject: SOC Direct3D - Implement missing D3D9_xx DLLs?
In-Reply-To: <loom.20080401T122814-132@post.gmane.org>
References: <loom.20080401T122814-132@post.gmane.org>
Message-ID: <d658b69e0804010606n3b487ce7i6dd162e0408ca701@mail.gmail.com>

On 01/04/2008, Jeroen Janssen <jeroen.janssen at gmail.com> wrote:
> Hi,
>
>  I was looking at the Wine SOC wiki ( http://wiki.winehq.org/SummerOfCode ) and
>  noticed an entry on "Direct3D - Implement missing D3D9_xx DLLs".
>
>  As far as I can see there are already lots of D3D9_xx dlls in the tree that seem
>  to forward stuf correctly.
>
>  Can someone confirm this to be already finished (and then remove this item from
>  the wiki?) If it isn't finished yet, what IS missing then?
>
It isn't so much that the dlls themselves are missing, but rather that
a lot of the functions they're supposed to implement are still
unimplemented.

>  D3D10_xx DLLs seem to be currently missing (I know we don't have any d3d 10
>  implementation yet in wine) and it probably isn't a SOC project, but would
>  completely stubbed D3D10_xx DLLs (patches) be accepted if I submit them to the
>  patch mailinglist or not?
>
Personally, I don't think it makes sense to have stubbed d3d10x dlls
without at least a partial d3d10 implementation.


From lich at math.spbu.ru  Tue Apr  1 08:25:19 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Tue, 1 Apr 2008 16:25:19 +0300
Subject: net: Display a more specific error message when a service command
	fails.
Message-ID: <200804011725.19584.lich@math.spbu.ru>

  Hi,

>+    LPSTR pBuffer;
>+    if (FormatMessageA(FORMAT_MESSAGE_FROM_SYSTEM |
>+            FORMAT_MESSAGE_IGNORE_INSERTS | FORMAT_MESSAGE_ALLOCATE_BUFFER,
>+            NULL, error, 0, (LPSTR)&pBuffer, 0, NULL))
>+    {
>+        fputs(pBuffer, stdout);
>+        LocalFree(pBuffer);
>+        return TRUE;

This is a glibc version of fputs, it DOES NOT work with wineconsole.

--
Kirill

P.S. Current implementation of output_string suffers from the same issue too.


From stefan at codeweavers.com  Tue Apr  1 08:30:31 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 1 Apr 2008 15:30:31 +0200
Subject: SOC Direct3D - Implement missing D3D9_xx DLLs?
In-Reply-To: <d658b69e0804010606n3b487ce7i6dd162e0408ca701@mail.gmail.com>
References: <loom.20080401T122814-132@post.gmane.org>
	<d658b69e0804010606n3b487ce7i6dd162e0408ca701@mail.gmail.com>
Message-ID: <200804011530.31984.stefan@codeweavers.com>

Am Dienstag, 1. April 2008 15:06:37 schrieb H. Verbeet:
> Personally, I don't think it makes sense to have stubbed d3d10x dlls
> without at least a partial d3d10 implementation.
Yes, I agree. It would make more sense to take the unfinished stub from 
Andras' D3D10 project last year, finish it and write tests. For starting a 
D3D10 implementation we need some tests regarding pixel formats, the shader 
bytecode format and how the new buffer resource model works exactly.


From djapal at gmail.com  Tue Apr  1 07:11:28 2008
From: djapal at gmail.com (Dj Apal [GR])
Date: Tue, 1 Apr 2008 15:11:28 +0300
Subject: Greek translation patch correction
In-Reply-To: <22821af30803312358o1fe1ca4bvf3a420bec18ce280@mail.gmail.com>
References: <b432a8110803311521y1e606fa1wfcaa0e5e35bcf3a7@mail.gmail.com>
	<22821af30803312358o1fe1ca4bvf3a420bec18ce280@mail.gmail.com>
Message-ID: <b432a8110804010511o4e417579pcab0f151244a3539@mail.gmail.com>

So should I resend the patches in individual mails or it's ok for now and
for the next time I create new patches, I can send them as you wish?

2008/4/1, James Hawkins <truiken at gmail.com>:
>
> 2008/3/31 Dj Apal [GR] <djapal at gmail.com>:
>
> > Here are the separate patches as requested by James Hawkins
> >
>
>
> One patch per email.  I see that's not on the sending_patches
> page...man our documentation is in such bad shape (and scattered all
> over the place).
>
> --
>
> James Hawkins
>



-- 
Apostolos Alexiadis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080401/b2fb2d98/attachment-0001.htm 

From vincent.hardy.be at gmail.com  Tue Apr  1 07:59:47 2008
From: vincent.hardy.be at gmail.com (viny)
Date: Tue, 01 Apr 2008 14:59:47 +0200
Subject: msxml3 bug 10802
Message-ID: <fstbk4$9tl$1@ger.gmane.org>

Hi,

When creating an xml file, wine shouldn't create header automatically. 
Is that difficult to fix this bug 
(http://bugs.winehq.org/show_bug.cgi?id=10802) ? I've looked at domdoc.c 
     but I'm not an expert...



From jave27 at gmail.com  Tue Apr  1 08:32:49 2008
From: jave27 at gmail.com (Jason Green)
Date: Tue, 1 Apr 2008 09:32:49 -0400
Subject: d3d9: Add some visual tests for Direct3DDevice9_StretchRect()
In-Reply-To: <200804011145.19925.stefan@codeweavers.com>
References: <df81031c0803312220o6066111bs40b101a12e9bad87@mail.gmail.com>
	<200804011145.19925.stefan@codeweavers.com>
Message-ID: <df81031c0804010632y233e7666q428853eddc0f5d37@mail.gmail.com>

On Tue, Apr 1, 2008 at 5:45 AM, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Dienstag, 1. April 2008 07:20:44 schrieb Jason Green:
>  Did you take a look at the various capability flags? I think the test as you
>  submitted it is correct for dx9 level cards and drivers, but there are a few
>  capability flags like D3DDEVCAPS2_CANSTRETCHRECTFROMTEXTURE or similar. Also
>  some drivers seem to refuse StretchRecting between offscreenplain surfaces,
>  even if no stretching is used.

Yeah, I meant to make a comment about that as a TODO, but I didn't
have any cards lying around that didn't advertise that cap.  If anyone
does, it'd be interesting to see how Windows handles some of those
cases.  I'd guess it would be just like MSDN claims, but you never
know until you actually test it.

>  Do you have any ideas what the scheme behind the allowed/forbidden blits is?
>  So far I can see this:
>
>  -> Blitting to a rendertarget surface/texture is always OK
>  -> blitting between offscreen surfaces is ok as long as no stretching occurs
>  -> blitting to non-RT surfaces/textures faily, except the above
>

Yeah - turns out that MSDN was correct on this scheme:

http://msdn2.microsoft.com/en-us/library/bb174471(VS.85).aspx

These tests show that the results of the dx9 drivers are valid
according to that page.

>  Did you test blitting from/to sysmem surfaces? The msdn says both must be
>  D3DPOOL_DEFAULT as far as I remember

Yep - I probably should have left a few tests in there for that, but
the only surfaces that are valid to call StretchRect on must be in
D3DPOOL_DEFAULT (both source and destination).  Everything else fails.


From jeroen.janssen at gmail.com  Tue Apr  1 08:54:38 2008
From: jeroen.janssen at gmail.com (Jeroen Janssen)
Date: Tue, 1 Apr 2008 15:54:38 +0200
Subject: SOC Direct3D - Implement missing D3D9_xx DLLs?
In-Reply-To: <d658b69e0804010606n3b487ce7i6dd162e0408ca701@mail.gmail.com>
References: <loom.20080401T122814-132@post.gmane.org>
	<d658b69e0804010606n3b487ce7i6dd162e0408ca701@mail.gmail.com>
Message-ID: <e34e42440804010654y377085f8jfa1c72966ed0bd9f@mail.gmail.com>

On Tue, Apr 1, 2008 at 3:06 PM, H. Verbeet <hverbeet at gmail.com> wrote:
> >  As far as I can see there are already lots of D3D9_xx dlls in the tree that seem
> >  to forward stuf correctly.
> >
> >  Can someone confirm this to be already finished (and then remove this item from
> >  the wiki?) If it isn't finished yet, what IS missing then?
> >
> It isn't so much that the dlls themselves are missing, but rather that
> a lot of the functions they're supposed to implement are still
> unimplemented.

Ok, then the SOC text on the wiki for this item is slightly
"misleading" / outdated.


From jeroen.janssen at gmail.com  Tue Apr  1 09:01:34 2008
From: jeroen.janssen at gmail.com (Jeroen Janssen)
Date: Tue, 1 Apr 2008 16:01:34 +0200
Subject: SOC Direct3D - Implement missing D3D9_xx DLLs?
In-Reply-To: <200804011530.31984.stefan@codeweavers.com>
References: <loom.20080401T122814-132@post.gmane.org>
	<d658b69e0804010606n3b487ce7i6dd162e0408ca701@mail.gmail.com>
	<200804011530.31984.stefan@codeweavers.com>
Message-ID: <e34e42440804010701g4a3b7a10xe3f4199c77415ee@mail.gmail.com>

On Tue, Apr 1, 2008 at 3:30 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Dienstag, 1. April 2008 15:06:37 schrieb H. Verbeet:
> > Personally, I don't think it makes sense to have stubbed d3d10x dlls
> > without at least a partial d3d10 implementation.
> Yes, I agree. It would make more sense to take the unfinished stub from
> Andras' D3D10 project last year, finish it and write tests. For starting a
> D3D10 implementation we need some tests regarding pixel formats, the shader
> bytecode format and how the new buffer resource model works exactly.

Would it be worth mentioning this on the wine SOC 2008 page?

Also, is there some info on what is left to do?
( I found the code Andras wrote at
http://code.google.com/p/google-summer-of-code-2007-wine/downloads/list
)

Best regards,

Jeroen Janssen

p.s. I'm not a student, but just interested in something that I could
work on, so if someone else claims this for the SOC, that's ok with
me.


From stefan at codeweavers.com  Tue Apr  1 09:09:00 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 1 Apr 2008 16:09:00 +0200
Subject: SOC Direct3D - Implement missing D3D9_xx DLLs?
In-Reply-To: <e34e42440804010701g4a3b7a10xe3f4199c77415ee@mail.gmail.com>
References: <loom.20080401T122814-132@post.gmane.org>
	<200804011530.31984.stefan@codeweavers.com>
	<e34e42440804010701g4a3b7a10xe3f4199c77415ee@mail.gmail.com>
Message-ID: <200804011609.00726.stefan@codeweavers.com>

Am Dienstag, 1. April 2008 16:01:34 schrieb Jeroen Janssen:
> Would it be worth mentioning this on the wine SOC 2008 page?
>
> Also, is there some info on what is left to do?
> ( I found the code Andras wrote at
> http://code.google.com/p/google-summer-of-code-2007-wine/downloads/list
> )
Ya, might be worth mentioning. But since the last year's soc project didn't 
get too far I am a bit afraid of "infrastructure" projects. I think it is 
easier for a student to add something new if there is an existing framework 
where he can hook in. For one part because the coding is easier, and also 
from a motivation standpoint because you see early results.

Of course if someone steps up and says he wants to go and write D3D10 tests I 
am willing to mentor such a problem.


From thunderbird2k at gmx.net  Tue Apr  1 10:17:19 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 01 Apr 2008 17:17:19 +0200
Subject: SOC suggestion - Vista Game Explorer APIs (needed for d3d10)
Message-ID: <20080401151719.320740@gmx.net>

Hi,

As the SOC deadline has been extended here another SOC project which I added to the wiki close to the previous deadline namely the Vista Game Explorer dll.

Lots of users find Direct3D related projects cool. Part of the post-Wine-1.0 work will likely focus on D3D10. Just adding a full implementation of this dll won't get most games working as they use the Vista Game Explorer API for various purposes like storing game settings and profiles.

Since this API is bundled with Windows we can't legally use Microsoft their dlls (if possible at all) and we need to add these APIs to Wine. This project would work on adding this dll.

Regards,

Roderick Colenbrander
-- 
Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen! 
Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer


From austinenglish at gmail.com  Tue Apr  1 11:01:48 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 1 Apr 2008 11:01:48 -0500
Subject: Greek translation patch correction
In-Reply-To: <b432a8110804010511o4e417579pcab0f151244a3539@mail.gmail.com>
References: <b432a8110803311521y1e606fa1wfcaa0e5e35bcf3a7@mail.gmail.com>
	<22821af30803312358o1fe1ca4bvf3a420bec18ce280@mail.gmail.com>
	<b432a8110804010511o4e417579pcab0f151244a3539@mail.gmail.com>
Message-ID: <b6bb06270804010901w4c39ad73pd6a745b7363f28b@mail.gmail.com>

On Tue, Apr 1, 2008 at 7:11 AM, Dj Apal [GR] <djapal at gmail.com> wrote:
> So should I resend the patches in individual mails or it's ok for now and
> for the next time I create new patches, I can send them as you wish?
>
> 2008/4/1, James Hawkins <truiken at gmail.com>:
>
> > 2008/3/31 Dj Apal [GR] <djapal at gmail.com>:
> >
> > > Here are the separate patches as requested by James Hawkins
> > >
> >
> >
> > One patch per email.  I see that's not on the sending_patches
> > page...man our documentation is in such bad shape (and scattered all
> > over the place).
> >
> > --
> >
> > James Hawkins
> >
>
>
>
> --
> Apostolos Alexiadis
>
>
>
>
>

Please resend each individual patch in a separate e-mail.


From truiken at gmail.com  Tue Apr  1 11:11:29 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 1 Apr 2008 11:11:29 -0500
Subject: Hey all, introducing myself and my GSoC idea...
In-Reply-To: <47F1F93F.5050902@codeweavers.com>
References: <f20910b80803311630g22f40ed0re963b9faf0a360e@mail.gmail.com>
	<19e31a080803311709u5cc90246te5682416796d5e37@mail.gmail.com>
	<3a768c550803311811y338ca136s7c3d261599be08a1@mail.gmail.com>
	<22821af30803311824v77095ec6o24f84772df50b447@mail.gmail.com>
	<47F1F93F.5050902@codeweavers.com>
Message-ID: <22821af30804010911r1e4caa85hb330bdda0e1581eb@mail.gmail.com>

On Tue, Apr 1, 2008 at 3:58 AM, Robert Shearman <rob at codeweavers.com> wrote:
> James Hawkins wrote:
>  > On Mon, Mar 31, 2008 at 8:11 PM, Juan Lang <juan.lang at gmail.com> wrote:
>  >
>
> >>  Personally, I've thought that playing around with the
>  >>  native LPC API might be interesting.  I'm sure there are other areas
>  >>  of the native API that are sparsely documented, and for which some
>  >>  test cases might prove useful.
>  >>
>  >
>  > But is the API in question useful for the Wine project as far as
>  > fixing apps?  I don't think we should devote SOC resources to a
>  > project that doesn't progress Wine beyond just implementing more APIs.
>
>  It is useful for getting native rpcrt4 to work, which in turn is useful
>  for getting other COM DLLs to work, and so is potentially useful for bug
>  triage and identifying the source of bugs in builtin COM DLLs.
>

LPC, yes, but the student just said the Native API.

-- 
James Hawkins


From hintak_leung at yahoo.co.uk  Tue Apr  1 11:15:21 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Tue, 1 Apr 2008 16:15:21 +0000 (GMT)
Subject: ddiwrapper/Gsoc Re: DLL exports... HELP?! (wine based win32 printer
	drivers for openprinting)
In-Reply-To: <1206911806.7820.26.camel@p4>
Message-ID: <401063.58506.qm@web23115.mail.ird.yahoo.com>

So far only one person has signed up with gsoc to do the win32 print driver under
linux...

I found out why I couldn't build ddiwrapper earlier - it builds against latest wine 
now; the reason was that I was ripping from opensuse/suse src rpm, and I did not look 
at any of the bundled patch, and there is a bundled patch which does that. The authoritative site for ddiwrapper seems to be:
ftp://ftp.suse.com/people/uli/ddiwrapper/
Although it is quite difficult to find, since most search engine gives various publibc part of suse/novell. I think the src.rpm bundled patch needs to go in properly as a new release, really. (uli at suse.de is the author of ddiwrapper).

--- On Sun, 30/3/08, Detlef Riekenberg <wine.dev at web.de> wrote:

> From: Detlef Riekenberg <wine.dev at web.de>
> Subject: Re: DLL exports... HELP?! (wine based win32 printer drivers for openprinting)
> To: "Hin-Tak Leung" <hintak_leung at yahoo.co.uk>
> Cc: "Till Kamppeter" <till.kamppeter at gmail.com>
> Date: Sunday, 30 March, 2008, 10:16 PM
> On Sa, 2008-03-29 at 15:51 +0000, Hin-Tak Leung wrote:
> > A personal question: would be like to be involved if a
> student comes
> > along, or in general in this area? (I looked it up,
> you were the
> > mentor for the 2007 wine project for the
> printerproxy).
> 
> 
> In general in this Area, Please.
> 
> A applied as Mentor today to Help with the Applications
> (winspool #at# googlemail.com)
> 
> 
> You can reach me on irc (freenode.net) in #winehackers
> My nick is "winspool"
> 
> 
> -- 
>  
> By by ... Detlef


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Inbox http://uk.docs.yahoo.com/nowyoucan.html


From truiken at gmail.com  Tue Apr  1 12:04:25 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 1 Apr 2008 12:04:25 -0500
Subject: [1/2] cabinet.dll -> FDICopy: Test added [Try 2]
In-Reply-To: <200804012049.29107.vitperov@etersoft.ru>
References: <200804012049.29107.vitperov@etersoft.ru>
Message-ID: <22821af30804011004g4b09b4dfvb70490bd11c7b2c7@mail.gmail.com>

2008/4/1 Vitaly Perov <vitperov at etersoft.ru>:
> This test checks if function FDICopy() of cabinet.dll correctly works with an
>  empty cabinet file (It's correct cab-file, but it has no files and folders
>  inside).
>  In this case Windows return TRUE, but WINE return FALSE. So the installation
>  of certain software finishes with an error in WINE
>
>  Changelog:
>      - Test added for cabinet.dll FDICopy function. This test checks if it
>  works correctly with an empty cab-files
>

@@ -593,9 +594,67 @@ static void test_FDIIsCabinet(void)
     delete_test_files();
 }

+
+static void CreateEmptyCab(void)
+{
+    static const unsigned char file_array [] = { 0x4d, 0x53, 0x43, 0x46,
+        0x00, 0x00, 0x00, 0x00, 0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
+        0x00, 0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x01,
+        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
+    HANDLE hFile;
+    DWORD written;
+    BOOL result;
+
+    hFile = CreateFile("test1.cab", GENERIC_WRITE, 0, NULL,
CREATE_ALWAYS, FILE_ATTRIBUTE_TEMPORARY, NULL);
+    assert(hFile != INVALID_HANDLE_VALUE);
+    result=WriteFile(hFile, file_array, sizeof(file_array), &written, NULL);
+    CloseHandle( hFile );
+    assert(result); /*can't write to file*/
+}
+

You need to use the FCI api to create this cabinet.

+static void delEmptyCab(void)
+{
+    assert(DeleteFile("test1.cab"));
+}
+

This is a very pointless function, just call DeleteFile("test...") in
its place.  Also, this isn't something that needs an assert.

+INT_PTR __cdecl CopyProgress (FDINOTIFICATIONTYPE fdint,
PFDINOTIFICATION pfdin)
+{
+    return FALSE;
+}
+

Inconsistent style (space before opening parenthesis).

+static void test_FDICopy(void)
+{
+    HFDI hfdi;
+    ERF erf;
+    BOOL ret;
+    char name[] = "test1.cab";
+    char path[] = "";  /*native crashes if path=NULL*/
+

The pszCabPath parameter of FDICopy should be the current directory.
If you want to test using a relative cabinet path, do it in another
test.

+    /* native crashes if hfdi is NULL or invalid*/

These comments don't really apply to the test you've added.  You're
only testing one thing (thus, unit test): how FDICopy responds to an
empty cabinet.

+    hfdi = FDICreate(fdi_alloc, fdi_free, fdi_open, fdi_read,
+                     fdi_write, fdi_close, fdi_seek,
+                     cpuUNKNOWN, &erf);
+    ok(hfdi, "Expected non-NULL context\n");
+
+    /* TESTING FDICopy() */

Pointless comment, please remove it.

+    CreateEmptyCab();
+    ret=FDICopy(hfdi,name,path,0,CopyProgress,NULL,0);
+    delEmptyCab();

Please move this (actually, a call to DeleteFile, see above) to the
end of the function where cleanup happens.  It gets in the way of the
results of the test.

+    todo_wine
+    {
+        ok(ret, "Expected TRUE, got %d\n", ret);
+    }
+

If you're expecting TRUE, check for TRUE like the rest of the tests in
this file.

+    /* successfully destroy hfdi*/
+    ret = FDIDestroy(hfdi);
+    ok(ret, "Expected TRUE, got %d\n", ret);
+}


-- 
James Hawkins


From truiken at gmail.com  Tue Apr  1 12:08:49 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 1 Apr 2008 12:08:49 -0500
Subject: [2/2] cabinet.dll -> FDICopy: Bug fixed
In-Reply-To: <200804012049.39732.vitperov@etersoft.ru>
References: <200804012049.39732.vitperov@etersoft.ru>
Message-ID: <22821af30804011008y2640f89eh582fe5aa664af84a@mail.gmail.com>

2008/4/1 Vitaly Perov <vitperov at etersoft.ru>:
> This is a bug fix for the FDICopy() function of cabinet.dll.
>  When you pass an empty cabinet file (It's correct cab-file, but it has no
>  files and folders inside) as a parameter, Wine detects that the file is
>  invalid.
>  In this case Windows return TRUE, but WINE return FALSE. So the installation
>  of certain software finishes with an error in WINE.
>
>  Changelog:
>      - Added a bug fix for cabinet.dll FDICopy function. Now it works correctly
>  with an empty cab-files.
>

+  if (!num_folders)
+    WARN("weird cabinet detect failure: This is an empty cabinet file \n");
+  /* if num_folders is 0, it's correct cab, but empty */

If there's a test for this case, and it is a valid case, then why did
you leave the WARN?

-- 
James Hawkins


From dank at kegel.com  Tue Apr  1 12:45:59 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 1 Apr 2008 10:45:59 -0700
Subject: Wine Release Plan
Message-ID: <a71bd89a0804011045k486a2cb0h4962f6ccf31f27a0@mail.gmail.com>

Paul V. wrote:
>Just noticed that the dates attached to the versions on
>http://wiki.winehq.org/WineReleasePlan are not correct.
>0.9.58 came out on March 21st.
>Does this mean we still stick to May 9th or do we stick to 0.9.61 as
>being 1.0.0.rc1?

Whoops, sorry 'bout that.
Whatever Alexandre wants, as long as the release is in 2008 :-)

I've updated the page to show correct dates.
I inserted one more rc to keep the release in June,
but I'm certainly open to other options if folks object.
- Dan


From austinenglish at gmail.com  Tue Apr  1 12:56:59 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 1 Apr 2008 12:56:59 -0500
Subject: Wine broken in feisty/git
Message-ID: <b6bb06270804011056v33734f8dye6fb32e27ca8e711@mail.gmail.com>

Building today's git worked fine, until trying to run ~/wine-git/wine
notepad, which results in a segmentation fault. Wine 0.9.58 from the
reps works fine, as did rebuilding wine 0.9.58 in git. I'm starting
the bisect now, but am about to leave this machine and won't be able
to complete it until tomorrow. Anyone else seeing this?


From thestig at google.com  Tue Apr  1 13:12:09 2008
From: thestig at google.com (Lei Zhang)
Date: Tue, 1 Apr 2008 11:12:09 -0700
Subject: Wine broken in feisty/git
In-Reply-To: <b6bb06270804011056v33734f8dye6fb32e27ca8e711@mail.gmail.com>
References: <b6bb06270804011056v33734f8dye6fb32e27ca8e711@mail.gmail.com>
Message-ID: <558b2f5c0804011112m29eae4c0lfbfd664fd9b708b1@mail.gmail.com>

On Tue, Apr 1, 2008 at 10:56 AM, Austin English <austinenglish at gmail.com> wrote:
> Building today's git worked fine, until trying to run ~/wine-git/wine
>  notepad, which results in a segmentation fault. Wine 0.9.58 from the
>  reps works fine, as did rebuilding wine 0.9.58 in git. I'm starting
>  the bisect now, but am about to leave this machine and won't be able
>  to complete it until tomorrow. Anyone else seeing this?
>
>
>

No crashes here...


From tony.wasserka at freenet.de  Tue Apr  1 13:31:45 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Tue, 01 Apr 2008 20:31:45 +0200
Subject: SOC Direct3D - Implement missing D3D9_xx DLLs?
Message-ID: <E1JglGr-0000kz-BM@www20.emo.freenet-rz.de>

>  Can someone confirm this to be already finished (and then remove this item from
>  the wiki?) If it isn't finished yet, what IS missing then?
Nearly everything is missing. It's just the forwarding and some stubs that have been defined, yet,
and the D3DXRenderToSurface implementation I submitted recently was coded
with d3d9 traces, which was something AJ didn't like for reimplementing d3dx9.
That means someone other needs to take care of that interface, but that's OT for this discussion.

> D3D10_xx DLLs seem to be currently missing (I know we don't have any d3d 10
> implementation yet in wine) and it probably isn't a SOC project, but would
> completely stubbed D3D10_xx DLLs (patches) be accepted if I submit them to the
> patch mailinglist or not?
I personally don't think it makes very much sense to stub a big library like d3dx10 without
being able to really implement it (as we'd need d3d10 for this first). You could ask AJ
for this on #winehackers, but I guess he'll be the same opinion.
However, you can of course stub the d3dx10 dlls on your local tree and submit them when
our d3d10 implementation is ready.

> Ok, then the SOC text on the wiki for this item is slightly
> "misleading" / outdated.
I have updated the GSoC and D3DX wiki sites, so that one
gets a very quick overview of how "far" we are with implementing it, yet.

Best regards
   Tony











From paul.vriens.wine at gmail.com  Tue Apr  1 14:41:36 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 01 Apr 2008 21:41:36 +0200
Subject: user32: Implement BroadcastSystemMessage, try 6
In-Reply-To: <b130c85e0804011225j619575f9m56cf10142fb44e41@mail.gmail.com>
References: <b130c85e0804011225j619575f9m56cf10142fb44e41@mail.gmail.com>
Message-ID: <47F28FF0.3070602@gmail.com>

Maarten Lankhorst wrote:
> Removed most LastError tests except where they are useful.
> 
> 
> ------------------------------------------------------------------------
> 
> 

Hi Maarten,

+    if (!recipients)
+        recipients = &recips;
+

Will that work?

Cheers,

Paul


From dank at kegel.com  Tue Apr  1 14:46:04 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 1 Apr 2008 12:46:04 -0700
Subject: crash on exit in hardy on intel graphics?
In-Reply-To: <a71bd89a0803231753m7371015ah885830fbb777cc11@mail.gmail.com>
References: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
	<200803231300.38257.stefan@codeweavers.com>
	<a71bd89a0803230510t19525745id6cfa5b5a23fd329@mail.gmail.com>
	<a71bd89a0803231753m7371015ah885830fbb777cc11@mail.gmail.com>
Message-ID: <a71bd89a0804011246y6ab97d7cp9a8f0f67529d8c38@mail.gmail.com>

On Sun, Mar 23, 2008 at 5:53 PM, Dan Kegel <dank at kegel.com> wrote:
>  >  > >   10 0x7ddc39bc glIsRenderbufferEXT+0x16c() in libgl.so.1 (0x0034fc68)
>  >  >  >   11 0xb7efefdf in ld-linux.so.2 (+0xdfdf) (0x0034fe18)
>  >  >  >   12 0xb7c90f74 exit+0xd4() in libc.so.6 (0x0034fe38)
>  >  >  Why would exit call glIsRenderbuffer() ? That doesn't make sense to me
>  >
>  >  No idea... I guess I figured it was in an onexit handler installed
>  >  by opengl for some reason?
>
>  Now I'm getting that crash on exit from a game, American McGee's Alice demo.

aha.  glxgears also crashes on exit.
https://bugs.launchpad.net/ubuntu/+source/mesa/+bug/149260

Maybe it only affects systems with my graphics chip,
00:02.0 VGA compatible controller: Intel Corporation Mobile 945GM/GMS,
943/940GML Express Integrated Graphics Controller (rev 03)


From thestig at google.com  Tue Apr  1 14:53:09 2008
From: thestig at google.com (Lei Zhang)
Date: Tue, 1 Apr 2008 12:53:09 -0700
Subject: Wine broken in feisty/git
In-Reply-To: <b6bb06270804011056v33734f8dye6fb32e27ca8e711@mail.gmail.com>
References: <b6bb06270804011056v33734f8dye6fb32e27ca8e711@mail.gmail.com>
Message-ID: <558b2f5c0804011253nd4a7942sb0c41d0593becee7@mail.gmail.com>

On Tue, Apr 1, 2008 at 10:56 AM, Austin English <austinenglish at gmail.com> wrote:
> Building today's git worked fine, until trying to run ~/wine-git/wine
>  notepad, which results in a segmentation fault. Wine 0.9.58 from the
>  reps works fine, as did rebuilding wine 0.9.58 in git. I'm starting
>  the bisect now, but am about to leave this machine and won't be able
>  to complete it until tomorrow. Anyone else seeing this?
>
>
>

Hmm, I blew away my .wine directory. Now I'm seeing a segfault in
wineprefixcreate:

$ ~/wine/wine-git/tools/wineprefixcreate -w
ALSA lib seq_hw.c:456:(snd_seq_hw_open) open /dev/snd/seq failed: No
such file or directory
Could not load Mozilla. HTML rendering will be disabled.
/home/thestig/wine/wine-git/tools/wineprefixcreate: line 173:  6781
Segmentation fault      "${WINELOADER:-$bindir/wine}" rundll32.exe
setupapi.dll,InstallHinfSection DefaultInstall 128 wine.inf


From hans at it.vu.nl  Tue Apr  1 15:22:23 2008
From: hans at it.vu.nl (Hans Leidekker)
Date: Tue, 1 Apr 2008 22:22:23 +0200
Subject: wininet: InternetReadFileExA should check INTERNET_FLAG_ASYNC.
In-Reply-To: <20080327205224.GB4608@linux.ucla.edu>
References: <20080327205224.GB4608@linux.ucla.edu>
Message-ID: <200804012222.24647.hans@it.vu.nl>

On Thursday 27 March 2008 21:52:24 Dan Hipschman wrote:

> incorrect.  Here are a few Windows failures:
> 
> http.c:584: Test failed: expected status 10 (INTERNET_STATUS_RESOLVING_NAME) 0 times, received 1 times
> http.c:585: Test failed: expected status 11 (INTERNET_STATUS_NAME_RESOLVED) 0 times, received 1 times
> http.c:587: Test failed: expected status 30 (INTERNET_STATUS_SENDING_REQUEST) 2 times, received 1 times
> http.c:588: Test failed: expected status 31 (INTERNET_STATUS_REQUEST_SENT) 2 times, received 1 times
> http.c:589: Test failed: expected status 40 (INTERNET_STATUS_RECEIVING_RESPONSE) 2 times, received 1 times
> http.c:590: Test failed: expected status 41 (INTERNET_STATUS_RESPONSE_RECEIVED) 2 times, received 1 times
> http.c:591: Test failed: expected status 110 (INTERNET_STATUS_REDIRECT) 1 times, received 0 times

Some of these are also failing when you run them through a proxy server.
I put in some debug printing which confirmed that they only fail when the
async flag is set. So the test seems to be racy; the higher latency of the
proxy connection and your script with built in delays nicely explain that.

 -Hans


From m.b.lankhorst at gmail.com  Tue Apr  1 15:25:33 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 1 Apr 2008 13:25:33 -0700
Subject: user32: Implement BroadcastSystemMessage, try 6
In-Reply-To: <b130c85e0804011324q7caeb449yfdf93a2e3b9cf251@mail.gmail.com>
References: <b130c85e0804011225j619575f9m56cf10142fb44e41@mail.gmail.com>
	<47F28FF0.3070602@gmail.com>
	<b130c85e0804011324q7caeb449yfdf93a2e3b9cf251@mail.gmail.com>
Message-ID: <b130c85e0804011325s65c2a9fdqebf9e951d57c17d8@mail.gmail.com>

Hello Paul,

2008/4/1, Paul Vriens <paul.vriens.wine at gmail.com>:
>  Hi Maarten,
>
>  +    if (!recipients)
>  +        recipients = &recips;
>  +
>
>  Will that work?

Yes. recipients is a pointer.

Cheers,

Maarten.


From thestig at google.com  Tue Apr  1 15:41:20 2008
From: thestig at google.com (Lei Zhang)
Date: Tue, 1 Apr 2008 13:41:20 -0700
Subject: Wine broken in feisty/git
In-Reply-To: <558b2f5c0804011253nd4a7942sb0c41d0593becee7@mail.gmail.com>
References: <b6bb06270804011056v33734f8dye6fb32e27ca8e711@mail.gmail.com>
	<558b2f5c0804011253nd4a7942sb0c41d0593becee7@mail.gmail.com>
Message-ID: <558b2f5c0804011341p1a1aee3ct9c9258a1b9651128@mail.gmail.com>

On Tue, Apr 1, 2008 at 12:53 PM, Lei Zhang <thestig at google.com> wrote:
> On Tue, Apr 1, 2008 at 10:56 AM, Austin English <austinenglish at gmail.com> wrote:
>
>
> > Building today's git worked fine, until trying to run ~/wine-git/wine
>  >  notepad, which results in a segmentation fault. Wine 0.9.58 from the
>  >  reps works fine, as did rebuilding wine 0.9.58 in git. I'm starting
>  >  the bisect now, but am about to leave this machine and won't be able
>  >  to complete it until tomorrow. Anyone else seeing this?
>  >
>  >
>  >
>
>  Hmm, I blew away my .wine directory. Now I'm seeing a segfault in
>  wineprefixcreate:
>
>  $ ~/wine/wine-git/tools/wineprefixcreate -w
>  ALSA lib seq_hw.c:456:(snd_seq_hw_open) open /dev/snd/seq failed: No
>  such file or directory
>  Could not load Mozilla. HTML rendering will be disabled.
>  /home/thestig/wine/wine-git/tools/wineprefixcreate: line 173:  6781
>  Segmentation fault      "${WINELOADER:-$bindir/wine}" rundll32.exe
>  setupapi.dll,InstallHinfSection DefaultInstall 128 wine.inf
>

Git bisect says:

0a44a778f00c5283347646083f682333c11bccf3 is first bad commit
commit 0a44a778f00c5283347646083f682333c11bccf3
Author: Aric Stewart <aric at codeweavers.com>
Date:   Mon Mar 31 09:15:29 2008 -0500

    imm32: Begin to add basic framework for loading IMEs as dlls.


From austinenglish at gmail.com  Tue Apr  1 16:08:29 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 1 Apr 2008 16:08:29 -0500
Subject: Wine broken in feisty/git
In-Reply-To: <558b2f5c0804011341p1a1aee3ct9c9258a1b9651128@mail.gmail.com>
References: <b6bb06270804011056v33734f8dye6fb32e27ca8e711@mail.gmail.com>
	<558b2f5c0804011253nd4a7942sb0c41d0593becee7@mail.gmail.com>
	<558b2f5c0804011341p1a1aee3ct9c9258a1b9651128@mail.gmail.com>
Message-ID: <b6bb06270804011408i3c669ea7y2f790d05938b5525@mail.gmail.com>

On 4/1/08, Lei Zhang <thestig at google.com> wrote:
> On Tue, Apr 1, 2008 at 12:53 PM, Lei Zhang <thestig at google.com> wrote:
>  > On Tue, Apr 1, 2008 at 10:56 AM, Austin English <austinenglish at gmail.com> wrote:
>  >
>  >
>  > > Building today's git worked fine, until trying to run ~/wine-git/wine
>  >  >  notepad, which results in a segmentation fault. Wine 0.9.58 from the
>  >  >  reps works fine, as did rebuilding wine 0.9.58 in git. I'm starting
>  >  >  the bisect now, but am about to leave this machine and won't be able
>  >  >  to complete it until tomorrow. Anyone else seeing this?
>  >  >
>  >  >
>  >  >
>  >
>  >  Hmm, I blew away my .wine directory. Now I'm seeing a segfault in
>  >  wineprefixcreate:
>  >
>  >  $ ~/wine/wine-git/tools/wineprefixcreate -w
>  >  ALSA lib seq_hw.c:456:(snd_seq_hw_open) open /dev/snd/seq failed: No
>  >  such file or directory
>  >  Could not load Mozilla. HTML rendering will be disabled.
>  >  /home/thestig/wine/wine-git/tools/wineprefixcreate: line 173:  6781
>  >  Segmentation fault      "${WINELOADER:-$bindir/wine}" rundll32.exe
>  >  setupapi.dll,InstallHinfSection DefaultInstall 128 wine.inf
>  >
>
>
> Git bisect says:
>
>  0a44a778f00c5283347646083f682333c11bccf3 is first bad commit
>  commit 0a44a778f00c5283347646083f682333c11bccf3
>  Author: Aric Stewart <aric at codeweavers.com>
>  Date:   Mon Mar 31 09:15:29 2008 -0500
>
>     imm32: Begin to add basic framework for loading IMEs as dlls.
>

Yep, broken on Hardy as well, haven't tested gutsy. Reverting that
commit fixes it.

CC'ing Aric.


From julliard at winehq.org  Tue Apr  1 16:44:33 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 01 Apr 2008 23:44:33 +0200
Subject: Wine broken in feisty/git
In-Reply-To: <b6bb06270804011408i3c669ea7y2f790d05938b5525@mail.gmail.com>
	(Austin English's message of "Tue, 1 Apr 2008 16:08:29 -0500")
References: <b6bb06270804011056v33734f8dye6fb32e27ca8e711@mail.gmail.com>
	<558b2f5c0804011253nd4a7942sb0c41d0593becee7@mail.gmail.com>
	<558b2f5c0804011341p1a1aee3ct9c9258a1b9651128@mail.gmail.com>
	<b6bb06270804011408i3c669ea7y2f790d05938b5525@mail.gmail.com>
Message-ID: <87hceldzcu.fsf@wine.dyndns.org>

"Austin English" <austinenglish at gmail.com> writes:

> On 4/1/08, Lei Zhang <thestig at google.com> wrote:
>> Git bisect says:
>>
>>  0a44a778f00c5283347646083f682333c11bccf3 is first bad commit
>>  commit 0a44a778f00c5283347646083f682333c11bccf3
>>  Author: Aric Stewart <aric at codeweavers.com>
>>  Date:   Mon Mar 31 09:15:29 2008 -0500
>>
>>     imm32: Begin to add basic framework for loading IMEs as dlls.
>>
>
> Yep, broken on Hardy as well, haven't tested gutsy. Reverting that
> commit fixes it.

I committed a fix.

-- 
Alexandre Julliard
julliard at winehq.org


From leslie_alistair at hotmail.com  Tue Apr  1 16:48:59 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Wed, 2 Apr 2008 08:48:59 +1100
Subject: msxml3 bug 10802
References: <fstbk4$9tl$1@ger.gmane.org>
Message-ID: <fsuaji$8ie$1@ger.gmane.org>

"viny" <vincent.hardy.be at gmail.com> wrote in message 
news:fstbk4$9tl$1 at ger.gmane.org...
> Hi,
>
> When creating an xml file, wine shouldn't create header automatically.
> Is that difficult to fix this bug
> (http://bugs.winehq.org/show_bug.cgi?id=10802) ? I've looked at domdoc.c
>     but I'm not an expert...
>
Hi Viny,
   The main issue here is that PI nodes are not suppost to be called xml.
In MSXML3 this is a special case and isnt assigned as a PI node as
such, instead the string is parsed for encoding, version, etc. This 
information
is then used when saving.

So what need to be done
1. When we assign a PI node with a name xml, parse for encoding, etc and
store then in the domdoc structure for later
2. In the domdoc_save, change xmlDocDumpMempory to use xmlDocDumpMemoryEnc
with the parsed encoding above.

Best Regards
 Alistair Leslie-Hughes




From ns03ja at brocku.ca  Tue Apr  1 17:34:00 2008
From: ns03ja at brocku.ca (Neil Skrypuch)
Date: Tue, 1 Apr 2008 18:34:00 -0400
Subject: Wine broken in feisty/git
In-Reply-To: <87hceldzcu.fsf@wine.dyndns.org>
References: <b6bb06270804011056v33734f8dye6fb32e27ca8e711@mail.gmail.com>
	<b6bb06270804011408i3c669ea7y2f790d05938b5525@mail.gmail.com>
	<87hceldzcu.fsf@wine.dyndns.org>
Message-ID: <200804011834.00499.ns03ja@brocku.ca>

On Tuesday 01 April 2008, Alexandre Julliard wrote:
> "Austin English" <austinenglish at gmail.com> writes:
> > On 4/1/08, Lei Zhang <thestig at google.com> wrote:
> >> Git bisect says:
> >>
> >>  0a44a778f00c5283347646083f682333c11bccf3 is first bad commit
> >>  commit 0a44a778f00c5283347646083f682333c11bccf3
> >>  Author: Aric Stewart <aric at codeweavers.com>
> >>  Date:   Mon Mar 31 09:15:29 2008 -0500
> >>
> >>     imm32: Begin to add basic framework for loading IMEs as dlls.
> >
> > Yep, broken on Hardy as well, haven't tested gutsy. Reverting that
> > commit fixes it.
>
> I committed a fix.

This broke for me on Gentoo too, the fix also fixed things for me.

- Neil


From a_villacis at palosanto.com  Tue Apr  1 17:44:38 2008
From: a_villacis at palosanto.com (=?ISO-8859-1?Q?Alex_Villac=ED=ADs_Lasso?=)
Date: Tue, 01 Apr 2008 17:44:38 -0500
Subject: WINEX11.DRV: workaround for unstable window state while handling
	MapNotify (fixes bug 12196)
In-Reply-To: <47F11BE5.40107@palosanto.com>
References: <47F11BE5.40107@palosanto.com>
Message-ID: <47F2BAD6.5000702@palosanto.com>

Alex Villac??s Lasso escribi?:
>
> The attached patch seems to fix this issue for me. It issues 
> X11DRV_MapNotify
> when it detects that the window is still marked as iconic on a 
> transition from
> IconicState to NormalState. Please comment on this.
>
> See bug #12196 for full discussion.
>
> Changelog:
> * Workaround for unstable window state when handling MapNotify at 
> window restore after minimize.  Issue extra X11DRV_MapNotify call when 
> PropertyNotify detects still-iconic window on 
>  IconicState->NormalState transition.
>
Is this patch incorrect? Nobody has commented on it, and it has not been 
applied either.

-- 
perl -e '$x=2.4;print sprintf("%.0f + %.0f = %.0f\n",$x,$x,$x+$x);'



From mstefani at redhat.de  Tue Apr  1 18:23:55 2008
From: mstefani at redhat.de (Michael Stefaniuc)
Date: Wed, 2 Apr 2008 01:23:55 +0200
Subject: Bitrotting Translations
Message-ID: <20080401232355.GA5155@redhat.com>

Hello guys,

there are a couple resource file translations that are so way out of
sync that they are commented out of the main rc file of the relevant
module.

programs/progman/rsrc.rc:
-------------------------
- Da.rc - Danish
- Fi.rc - Finnish
- Sk.rc - Slovak
- Sw.rc - Swedish (correct filename: Sv.rc)
- Va.rc - Rumansh (Vallader) (correct filename: Rm.rc)
- Wa.rc - Wallon
This are so bitrotted that they don't even stink anymore but are nice
fertile compost. Means they aren't even .rc files but .c/.h files.
I have sent a patch to remove them. If somebody still wants to look at
them they can with git show e.g.:
  git show wine-0.9.58:programs/progman/Va.rc


programs/winecfg/winecfg.rc:
----------------------------
- Pt.rc - Portuguese (Brazil/Portugal)
- It.rc - Italian
- Si.rc - Slovenian
This are only a little bit more broken but should be able to be fixed.
If a native speaker could take care of them that would be really nice.
Else I'll try to fix them myself or remove them if I fail after
1.0.0-rc1 comes out.


programs/start/rsrc.rc:
-----------------------
- Si.rc - Slovenian
Looks like only a few characters (the non-7bit clean ones) are broken.
Should be fairly easy to fix for a native speaker. Else I'll try to fix
it myself after 1.0.0-rc1 comes out.


bye
	michael
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080402/15e66485/attachment.pgp 

From xixsimplicityxix at gmail.com  Tue Apr  1 18:24:36 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Tue, 1 Apr 2008 18:24:36 -0500
Subject: AppDB:Nice URLs Question on integration / Request for testing
Message-ID: <78a7dad00804011624x4b30ae61u7aaf4ef8dcc78408@mail.gmail.com>

Hello,

So I have a working "nice urls" implementatino here:
http://appdb.klehm.net/app/
Simply enter in anything after app/  (e.g.
http://appdb.klehm.net/app/visual-basic).  At this point its better to
enter in too little of the desired app name rather than too much.
(better to have visual-basic or visual than visual-basic-7)

So test away and let me know how to improve it or whatnot.

Also as you'll see if you try it out, relative urls are broken (lack
of css, so its ugly =P) because well the page we return is now
relative to the searched term. As I see it we can integrate this with
appdb in 2 ways.  Make all urls absolute or make functions of the main
viewing pages and pass a url base into them.  Any ideas or comments on
the best way to get around this problem would be great.

Regards,
John Klehm


From mstefani at redhat.com  Tue Apr  1 18:34:25 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 02 Apr 2008 01:34:25 +0200
Subject: Bitrotting Translations
In-Reply-To: <20080401232355.GA5155@redhat.com>
References: <20080401232355.GA5155@redhat.com>
Message-ID: <47F2C681.1010906@redhat.com>

Michael Stefaniuc wrote:
> there are a couple resource file translations that are so way out of
> sync that they are commented out of the main rc file of the relevant
> module.
> 

> programs/winecfg/winecfg.rc:
> ----------------------------
> - Pt.rc - Portuguese (Brazil/Portugal)
> - It.rc - Italian
> - Si.rc - Slovenian
> This are only a little bit more broken but should be able to be fixed.
I mean a little bit more broken than the "normal" breakage that is
caught on Mikolaj's page http://pf128.krakow.sdi.tpnet.pl/wine-transl/ .

> If a native speaker could take care of them that would be really nice.
> Else I'll try to fix them myself or remove them if I fail after
> 1.0.0-rc1 comes out.
> 
> 
> programs/start/rsrc.rc:
> -----------------------
> - Si.rc - Slovenian
> Looks like only a few characters (the non-7bit clean ones) are broken.
> Should be fairly easy to fix for a native speaker. Else I'll try to fix
> it myself after 1.0.0-rc1 comes out.

bye
	michael


From dank at kegel.com  Tue Apr  1 19:16:28 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 1 Apr 2008 17:16:28 -0700
Subject: Recent imm changes triggered widespread valgrind errors?
Message-ID: <a71bd89a0804011716pdb12e47je28d04f474c8106@mail.gmail.com>

Aric, can you have a look?

Any call to CreateWindow now spews lots of Valgrind errors.
For instance,
http://kegel.com/wine/valgrind/logs-2008-04-01/vg-advpack_install-diff.txt
contains:
+ Conditional jump or move depends on uninitialised value(s)
+    at  RtlInitUnicodeString (unicode.h:212)
+    by  LoadLibraryExW (module.c:924)
+    by  LoadLibraryW (module.c:968)
+    by  ImmCreateContext (imm.c:143)
+    by  X11DRV_SetupXIM (xim.c:510)
+    by  x11drv_init_thread_data (x11drv_main.c:654)
+    by  X11DRV_SetWindowPos (x11drv.h:517)
+    by  set_window_pos (winpos.c:1919)
+    by  WIN_CreateWindowEx (win.c:1121)
+    by  CreateWindowExW (win.c:1351)
+    by  manage_desktop (desktop.c:224)
+    by  WinMain (explorer.c:136)
+    by  main (exe_main.c:48)


From dank at kegel.com  Tue Apr  1 20:30:23 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 1 Apr 2008 18:30:23 -0700
Subject: Wine 1.0 status: T minus 73 days (!), 69 bugs left
Message-ID: <a71bd89a0804011830p2a88e0e7s65b54551981a7f4@mail.gmail.com>

Grumble.  I was off by a week when I wrote
http://wiki.winehq.org/WineReleasePlan
I've adjusted the release dates to match our two-week cycle correctly
this time (I hope).
That pushed our release out one week... which means we finally have
fewer bugs than days-to-release.

Bugs fixed since last summary:
3711   wininet         1       Musicmatch fails to install (missing
registry key, HTTP_HttpOpenRequest() problem)
8246   urlmon  3       invoking htmlhelp:HtmlHelpW crashes wine

Bugs new since last summary (!):
4372   comctl32        0       listview: cannot drag several items
5535   directx-        16      Planescape:Torment doesn't work
11509  crypt32         0       Wordviewer 2003 is unable to open
documents encrypted with AES

(The first is arguable, but listview is pretty central, so ok.
The second was closed by mistake earlier.
The third is in one of our release criterion apps.
Even though we only promise to fix *regressions* in
those apps, we might as well try to fix newly discovered
bugs, too.)

Bugs deferred since last summary:
638    document        9       Document Wine debugging channels
4733   kernel32        5       Get optimized/compressed/packed
executables (non-upx) working
4770   ole     3       BlackBerry Device Manager fails to install under wine
4971   -unknown        3       Corel Draw 12 demo install fails
9926   gdi32   5       gdi32.dll should not have exported function pointers
10905  shell32         0       thinstall firefox demo requires native msvcrt

Current list of open bugs:
ID  	 Comp  	 Votes  	 Summary
5948 	-unknown 	1 	Star Trek: Armada does not install
7404 	-unknown 	2 	ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
12246 	-unknown 	1 	"make test" gives different results with and
without warn+heap
5055 	-unknown 	5 	Deleting files from a window in wine doesn't send
them to the Trash
8125 	-unknown 	0 	Marratech 6.1 crashes on start
5402 	-unknown 	0 	Trying to run PhotoStitch 3.1
11281 	-unknown 	2 	CJK input many issues
9916 	-unknown 	6 	"make test" usually fails
7477 	-unknown 	1 	Uplink demo crashes
12097 	-unknown 	3 	Wine 1.0 should not ship out-of-sync resource translations
9178 	-unknown 	7 	"hello world" dos program hangs
5024 	-unknown 	4 	Thief: Deadly Shadows crashes:page fault on read
access to 0x0000040c
5061 	-unknown 	6 	Copying from Windows Firefox in Wine and pasting to
Linux OpenOffice pastes metadata as data
10815 	-unknown 	2 	Cannot drag images into Adobe Photoshop 7 from the
web / desktop
5844 	-unknown 	11 	tray minimize
10147 	-unknown 	1 	Word Viewer 2003 - Tab behavior differs from Windows
9959 	-unknown 	8 	Make wine updates work even if the registry changed
556 	build-en 	1 	Reconcile the Windows and Wine spec files
2493 	comctl32 	2 	Multi-select listview: Shift-arrow up only selects
top two items
1114 	comctl32 	2 	Winrar2.90/3.00: Comboex doesn't trigger a event
when you mouse-click in some value of it
4372 	comctl32 	0 	listview: cannot drag several items
11509 	crypt32 	0 	Wordviewer 2003 is unable to open documents
encrypted with AES
11681 	directx- 	14 	Add support for video overlay
5535 	directx- 	16 	Planescape:Torment doesn't work
5955 	directx- 	8 	DirectDrawCreate crash on non-OpenGL desktop
9030 	directx- 	0 	army men hangs on black screen
82 	document 	2 	Stabilize Winelib User Guide Table of Contents
6519 	gdi32 	7 	Wine blacks out rotated font bitmap
3270 	gdi32 	15 	Problem with minimized top-level windows
9771 	gdi32 	38 	Steam Friends doesn't work (fails to render correctly
or refresh)
7571 	gdi32 	1 	Accented character glyphs are mixed up with TrueType
fonts (affects e.g. Lotus Notes R5)
9484 	kernel32 	18 	Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
9039 	kernel32 	0 	GS-Auftrag Professional SQL aborts on startup
5541 	kernel32 	0 	WriteConsole can't write to stdout; affects e.g.
wsh's cscript's usage message
5351 	kernel32 	9 	Windows Installer 3.1 cannot install because of
non-standard drive labeling
7098 	mscoree 	1 	RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
5163 	msi 	12 	Office XP 2002 crashes on installation
8783 	ntdll 	12 	USB serial ports do not work
9356 	ntdll 	6 	Serial communication not working since wine-0.9.33
6607 	ole 	9 	Drag and Drop not working
9942 	ole 	2 	Powerpoint Viewer 2007 crashes opening .pptx files
8095 	ole 	0 	PQ Teaching toy crashes
2539 	ole 	3 	XDND (Drag and drop for X Windows) doesn't copy text
5926 	programs 	0 	Wine does not provide an implementation of winhlp32.exe
6254 	richedit 	4 	Installer infinite loop from rich text error
6095 	shdocvw 	12 	MOTD in counter-strike 1.6 and counter-strike
source does not render
9304 	shdocvw 	3 	Temple of Elemental Evil demo doesn't start - gui irresponsive
8898 	shdocvw 	0 	Run Time Error "445": Object doesn't support this
action in Europa Knowledgebase
3546 	shdocvw 	2 	CLSID_InternetShortcut not available...
9809 	shell32 	4 	Autodesk Revit Architecture 2008 install fails
8439 	shell32 	8 	Visual Studio .NET (7) install fails
11742 	shlwapi 	8 	Small .net 1.1 app (FastMD5 1.3) fails to start up
12074 	testcase 	2 	The conformance tests fail on Windows
6604 	tools 	2 	Ship icons for the wine-tools that can be used in .desktop files
664 	user32 	6 	The help menu functionality inside programs is broken
(messaging problem)
4523 	user32 	5 	Can't copy from Firefox 1.5 and paste into OpenOffice
2 under Wine
3023 	user32 	5 	Orcad - "Place Part" never tries to put down a part
124 	wineserv 	2 	Review of Wine Server Protocol
1990 	winex11. 	1 	modifier keys not released when switching desktop
5623 	winex11. 	3 	GetAsyncKeyState wrong if querying process doesn't have focus
5828 	winex11. 	24 	Command and Conquer Generals (Zero Hour) doesn't
change the mouse cursor from the default X mouse
10984 	winex11. 	5 	sun jre 5 update 10 installer hangs in 0.9.52
3297 	winex11. 	12 	UpdateWindow() doesn't call XFlush()
7372 	winex11. 	12 	can't copy and paste between gnome apps eg
openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
2368 	winex11. 	7 	Wine loses its X-Window when switching to another
virt. desktop in Fvwm
11019 	winex11. 	3 	matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
5625 	wininet 	4 	Wine does not handle internet proxy settings conveniently
9787 	winsock 	47 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
12005 	wintab32 	0 	Regression in pressure sensitivity with wizardpen
tablet driver and Photoshop 7


From paul.vriens.wine at gmail.com  Wed Apr  2 00:54:11 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 02 Apr 2008 07:54:11 +0200
Subject: user32: Implement BroadcastSystemMessage, try 6
In-Reply-To: <b130c85e0804011325s65c2a9fdqebf9e951d57c17d8@mail.gmail.com>
References: <b130c85e0804011225j619575f9m56cf10142fb44e41@mail.gmail.com>	<47F28FF0.3070602@gmail.com>	<b130c85e0804011324q7caeb449yfdf93a2e3b9cf251@mail.gmail.com>
	<b130c85e0804011325s65c2a9fdqebf9e951d57c17d8@mail.gmail.com>
Message-ID: <47F31F83.8010500@gmail.com>

Maarten Lankhorst wrote:
> Hello Paul,
> 
> 2008/4/1, Paul Vriens <paul.vriens.wine at gmail.com>:
>>  Hi Maarten,
>>
>>  +    if (!recipients)
>>  +        recipients = &recips;
>>  +
>>
>>  Will that work?
> 
> Yes. recipients is a pointer.
> 
> Cheers,
> 
> Maarten.
> 
> 
> 
Yes, sorry for the noise. (Shouldn't check code late in the day).

-- 
Cheers,

Paul.


From kai.blin at gmail.com  Wed Apr  2 03:11:11 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Wed, 2 Apr 2008 10:11:11 +0200
Subject: Some considerations about the Wine FUSE project for GSoC
In-Reply-To: <200803311608.09536.kai.blin@gmail.com>
References: <200803311415.18471.kai.blin@gmail.com>
	<47F0E769.5020908@brain-dump.org>
	<200803311608.09536.kai.blin@gmail.com>
Message-ID: <200804021011.25198.kai.blin@gmail.com>

On Monday 31 March 2008 16:08:00 Kai Blin wrote:
> On Monday 31 March 2008 15:30:17 Marc Andre Tanner wrote:
> > First, I haven't yet applied for the project mainly because i will
> > probably not be able to work full time on a GSoC project due to real
> > life issues (part time job, family related things etc). On the other
> > hand I doubt that it will require ~3 months to implement, I have done
> > my prototype over more or less a weekend.
>
> That's why there's more than one FUSE file systems on the list ;)
>
> > I miss the technical discussion on how the problem should be solved. I
> > think the idea of keeping the original filename in an extended attribute
> > and storing everything in lower case is a pretty good one. Andrew
> > Tridgell also listed it on one of his slides from  WineConf05 [1].
>
> The tricky part is convincing Alexandre Julliard, as always when working on
> Wine.
>
> > I
> > prototyped something and thought this way I would at least get some
> > feedback (after all "Talk is cheap. Show me the code." is common
> > practice in the open source world). But this wasn't really the
> > case, so i am still wondering what should be done differently?
>
> Whoops, I didn't see that url. Sorry, but things were a bit busy recently.
> I'll give that a whirl later today.

I'm seeing some funny behaviour in a directory containing the files foo.txt, 
Foo.txt and bAr.tXt

After mounting, I can only see a "foo.txt" in the directory, containing the 
Foo.txt contents.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080402/90b2f8e7/attachment.pgp 

From paul.vriens.wine at gmail.com  Wed Apr  2 03:18:07 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 02 Apr 2008 10:18:07 +0200
Subject: shell32: Handle a few cases in FO_COPY that arise from
	not	double-NULL terminating the input
In-Reply-To: <22821af30804020107r7f14a125qabab3f323d54574d@mail.gmail.com>
References: <22821af30804020107r7f14a125qabab3f323d54574d@mail.gmail.com>
Message-ID: <47F3413F.9080803@gmail.com>

James Hawkins wrote:
> Hi,
> 
> Fix for bug 9809.
> 
> Changelog:
> * Handle a few cases in FO_COPY that arise from not double-NULL
> terminating the input.
> 
>  dlls/shell32/shlfileop.c       |   11 +++-
>  dlls/shell32/tests/shlfileop.c |  122 ++++++++++++++++++++++++++++++++++++++++
>  2 files changed, 130 insertions(+), 3 deletions(-)
> 
> 
> 
> ------------------------------------------------------------------------
> 
> 
Hi James,

+    /* no double-NULL terminator for pTo */
+    memset(to, 'a', MAX_PATH);
+    lstrcpyA(to, "two.txt");
+    shfo.pFrom = "one.txt\0";
+    shfo.pTo = to;
+    shfo.fFlags = FOF_NOCONFIRMATION | FOF_SILENT | FOF_NOERRORUI;
+    retval = SHFileOperation(&shfo);
+    ok(retval == ERROR_SUCCESS, "Expected ERROR_SUCCESS, got %d\n", retval);
+    ok(DeleteFileA("one.txt"), "Expected file to exist\n");
+    ok(DeleteFileA("two.txt"), "Expected file to exist\n");
+
+    createTestFile("one.txt");
+
+    /* no FOF_MULTIDESTFILES, two files in pTo */
+    shfo.pFrom = "one.txt\0";
+    shfo.pTo = "two.txt\0three.txt\0";
+    shfo.fFlags = FOF_NOCONFIRMATION | FOF_SILENT | FOF_NOERRORUI;
+    retval = SHFileOperation(&shfo);
+    ok(retval == ERROR_SUCCESS, "Expected ERROR_SUCCESS, got %d\n", retval);
+    ok(DeleteFileA("one.txt"), "Expected file to exist\n");
+    ok(DeleteFileA("two.txt"), "Expected file to exist\n");
+
+    createTestFile("one.txt");
+
+    /* no double-NULL terminator for pTo */
+    memset(to, 'a', MAX_PATH);
+    lstrcpyA(to, "two.txt");
+    shfo.pFrom = "one.txt\0";
+    shfo.pTo = to;
+    shfo.fFlags = FOF_NOCONFIRMATION | FOF_SILENT | FOF_NOERRORUI;
+    retval = SHFileOperation(&shfo);
+    ok(retval == ERROR_SUCCESS, "Expected ERROR_SUCCESS, got %d\n", retval);
+    ok(DeleteFileA("one.txt"), "Expected file to exist\n");
+    ok(DeleteFileA("two.txt"), "Expected file to exist\n");

Isn't the last test the same as the first (in the above piece of code) ?

-- 
Cheers,

Paul.


From coolbeer1980 at yahoo.com  Wed Apr  2 03:18:51 2008
From: coolbeer1980 at yahoo.com (=?iso-8859-1?Q?Kolbj=F8rn_Fredheim?=)
Date: Wed, 2 Apr 2008 01:18:51 -0700 (PDT)
Subject: Minor regression introduced in user32
Message-ID: <270140.39077.qm@web44814.mail.sp1.yahoo.com>

There is a regression introduced into the git tree that is causing
some minor issues with Anarchy Online atleast(should be other 
applications affected aswell).
On login, if you press enter instead of pushing "Login" a box will come 
up stating "You must select a charactername before playing! [OK]", this 
is before checking if the password is correct, or actually logging 
in to the account. I have never seen this box in the 2.5 years I've 
been playing Anarchy, so I can only speculate it's trying to select 
a character without actually having one selected in the drop-down
box(ie. Sending the enter twice to the application).

I bisected down to the following commit:

# ~/tmp/wine-git $ git bisect good
41ea8f0e8a6fab93fa08da16ecc24260dbad327c is first bad commit
commit 41ea8f0e8a6fab93fa08da16ecc24260dbad327c
Author: Lei Zhang <thestig at google.com>
Date:   Tue Mar 25 19:09:38 2008 -0700

    user32: Tweak how the edit control handles WM_GETDLGCODE.

:040000 040000 5583dc91d4f658340fcab6169c5be12b18c5d862 114715be44f79ddf45a9c61a01b90ee624504c1a M      dlls


I didn't want to file a bug-report on it, due to it beeing in the 
current git, and 0.9.58 is ok, and my knowledge on this part of wine 
is rather limited.

-
Kolbj?rn Fredheim


      ____________________________________________________________________________________
You rock. That's why Blockbuster's offering you one month of Blockbuster Total Access, No Cost.  
http://tc.deals.yahoo.com/tc/blockbuster/text5.com



From dmitry at codeweavers.com  Wed Apr  2 03:24:57 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 2 Apr 2008 17:24:57 +0900
Subject: Minor regression introduced in user32
References: <270140.39077.qm@web44814.mail.sp1.yahoo.com>
Message-ID: <02c501c8949b$0e4b5980$a600fea9@DMITRY>

"Kolbj?rn Fredheim" <coolbeer1980 at yahoo.com> wrote:

> I didn't want to file a bug-report on it, due to it beeing in the
> current git, and 0.9.58 is ok, and my knowledge on this part of wine
> is rather limited.

This is not an appropriate place to report the bugs. Also please search
the bugzilla first: #12319

-- 
Dmitry. 



From julliard at winehq.org  Wed Apr  2 04:21:40 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 02 Apr 2008 11:21:40 +0200
Subject: mshtml: Added registry configuration to allow using Active Script
	engine for JavaScript scripts.
In-Reply-To: <47F220F9.2030308@codeweavers.com> (Jacek Caban's message of
	"Tue, 01 Apr 2008 11:48:09 +0000")
References: <47F220F9.2030308@codeweavers.com>
Message-ID: <87d4p8ehnf.fsf@wine.dyndns.org>

Jacek Caban <jacek at codeweavers.com> writes:

> +    static const WCHAR key_nameW[] =
> +        {'S','o','f','t','w','a','r','e',
> +         '\\','W','i','n','e',
> +         '\\','M','S','H','T','M','L',
> +         '\\','S','c','r','i','p','t','O','v','e','r','r','i','d','e','s',0};
> +
> +    /* @@ Wine registry key: HKCU\Software\Wine\MSHTML\ScriptOverrides */
> +    res = RegOpenKeyW(HKEY_CURRENT_USER, key_nameW, &hkey);
> +    if(res != ERROR_SUCCESS)
> +        return ret;

Why do we need a configuration option for this?  When would a user want
to change it?

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Wed Apr  2 04:22:26 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 02 Apr 2008 11:22:26 +0200
Subject: imm: Keep track of context associations between HWND and HIMC
In-Reply-To: <47F22DAB.6090604@codeweavers.com> (Aric Stewart's message of
	"Tue, 01 Apr 2008 07:42:19 -0500")
References: <47F1288D.8020801@codeweavers.com>
	<87prt9eros.fsf@wine.dyndns.org> <47F22DAB.6090604@codeweavers.com>
Message-ID: <878wzwehm5.fsf@wine.dyndns.org>

Aric Stewart <aric at codeweavers.com> writes:

> It would be but I could not find evidence that such a property existed
> for all windows in Window. If you are proposing a wine internal
> property then it would work well.

Sure, a Wine internal property would be fine.

-- 
Alexandre Julliard
julliard at winehq.org


From kwixbit at gmail.com  Wed Apr  2 04:45:12 2008
From: kwixbit at gmail.com (Warren Dumortier)
Date: Wed, 2 Apr 2008 11:45:12 +0200
Subject: Nice feature?
Message-ID: <f3a003030804020245k619eb8c7j9e690f5839b7ab6e@mail.gmail.com>

Hello!
I have a little proposition for Wine 1.0!
Why not creating an error dialog when a dll is missing, it would help a lot
of users!
For example there's a dialog to install geck, why not a dialog that simply
says you have to add a dll in the correct directory?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080402/34f34719/attachment.htm 

From kwixbit at gmail.com  Wed Apr  2 04:49:25 2008
From: kwixbit at gmail.com (Warren Dumortier)
Date: Wed, 2 Apr 2008 11:49:25 +0200
Subject: How can i bypass my bug?
Message-ID: <f3a003030804020249p65745271gf9a30c47be25de44@mail.gmail.com>

Hi!

Some time ago i fille din a bug report because a game (The Sims : Pet
Stories) couldn't lanch, after some mails the problem was that Wine doesn't
gave vertex shaders, is there anything i can do to have this game running on
my linux box?

The bug has been reported as duplicate, but her's the correct one:
http://bugs.winehq.org/show_bug.cgi?id=8051

Is there any way t have the game running (vertex sharders emulation
running?), by adding dlls maybe, installing DirectX and disable some dlls?
Anything? Thanks, kind regards!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080402/504dd556/attachment.htm 

From thunderbird2k at gmx.net  Wed Apr  2 06:12:58 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Wed, 02 Apr 2008 13:12:58 +0200
Subject: How can i bypass my bug?
In-Reply-To: <f3a003030804020249p65745271gf9a30c47be25de44@mail.gmail.com>
References: <f3a003030804020249p65745271gf9a30c47be25de44@mail.gmail.com>
Message-ID: <20080402111258.226330@gmx.net>

> Hi!
> 
> Some time ago i fille din a bug report because a game (The Sims : Pet
> Stories) couldn't lanch, after some mails the problem was that Wine
> doesn't
> gave vertex shaders, is there anything i can do to have this game running
> on
> my linux box?
> 
> The bug has been reported as duplicate, but her's the correct one:
> http://bugs.winehq.org/show_bug.cgi?id=8051
> 
> Is there any way t have the game running (vertex sharders emulation
> running?), by adding dlls maybe, installing DirectX and disable some dlls?
> Anything? Thanks, kind regards!

Easy buy a simple videocard with vertex shader support we offer it on any card equal or better to a geforcefx / radeon 9500.

Roderick


From julliard at winehq.org  Wed Apr  2 06:37:54 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 02 Apr 2008 13:37:54 +0200
Subject: winex11.drv: Connect to XIM server dynamically. [take 2]
In-Reply-To: <200803291252213981870006MA65@nm06mta.auone-net.jp> (Kusanagi
	Kouichi's message of "Sat, 29 Mar 2008 21:52:20 +0900")
References: <200803291252213981870006MA65@nm06mta.auone-net.jp>
Message-ID: <874pakebcd.fsf@wine.dyndns.org>

Kusanagi Kouichi <slash at ma.neweb.ne.jp> writes:

> +
> +    if (data->xic)
> +        return data->xic;
> +
> +    xim = x11drv_thread_data()->xim;
> +    if (!xim)
> +        return NULL;
> +
> +    return X11DRV_CreateIC(xim, data->whole_window, &data->xic);

You shouldn't store a pointer to an internal field of the win_data
structure, that makes things hard to follow. You should store win_data
or hwnd in the pointer field and dereference it in the callback.

> @@ -651,7 +651,10 @@ struct x11drv_thread_data *x11drv_init_thread_data(void)
>      if (TRACE_ON(synchronous)) XSynchronize( data->display, True );
>      wine_tsx11_unlock();
>  
> -    if (use_xim && !(data->xim = X11DRV_SetupXIM( data->display, input_style )))
> +    data->xim = NULL;
> +    if (use_xim &&
> +        !XRegisterIMInstantiateCallback(data->display, NULL, NULL, NULL,
> +                                        X11DRV_SetupXIM, (XPointer)&data->xim))

The XRegisterIMInstantiateCallback should go in xim.c, the
initialization code in x11drv_main.c shouldn't need to know about such
implementation details.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Wed Apr  2 06:42:39 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 02 Apr 2008 13:42:39 +0200
Subject: [2/5] setupapi: Changing pointers on SP_DEVINFO_DATA
In-Reply-To: <200804011524.20838.amorozov@etersoft.ru> (Alexander Morozov's
	message of "Tue, 1 Apr 2008 14:24:20 +0300")
References: <200804011524.20838.amorozov@etersoft.ru>
Message-ID: <87zlsccwk0.fsf@wine.dyndns.org>

Alexander Morozov <amorozov at etersoft.ru> writes:

> SETUPDI_AddDeviceToSet: changing pointers on SP_DEVINFO_DATA after 
> allocating new memory block for their array

We shouldn't have to do that sort of thing. The data structure should be
fixed to store pointers that don't have to be moved around.

-- 
Alexandre Julliard
julliard at winehq.org


From susancragin at earthlink.net  Wed Apr  2 07:11:04 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Wed, 2 Apr 2008 08:11:04 -0400 (GMT-04:00)
Subject: Pulse Audio -- Wine should have instructions on this web site
Message-ID: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>

This site purports to give instructions on how to run certain applications, including Skype (which is 32-bit). I think wine should have instructions here too. 

http://www.pulseaudio.org/wiki/PerfectSetup

It doesn't look like pulseaudio is going away from Ubuntu anytime soon.
https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453




From aric at codeweavers.com  Wed Apr  2 07:25:03 2008
From: aric at codeweavers.com (Aric Stewart)
Date: Wed, 02 Apr 2008 07:25:03 -0500
Subject: Recent imm changes triggered widespread valgrind errors?
In-Reply-To: <a71bd89a0804011716pdb12e47je28d04f474c8106@mail.gmail.com>
References: <a71bd89a0804011716pdb12e47je28d04f474c8106@mail.gmail.com>
Message-ID: <47F37B1F.40702@codeweavers.com>

Thanks for the heads up, With Alexandre's latest fix to the code do the 
valgrind errors persist?

-aric

Dan Kegel wrote:
> Aric, can you have a look?
> 
> Any call to CreateWindow now spews lots of Valgrind errors.
> For instance,
> http://kegel.com/wine/valgrind/logs-2008-04-01/vg-advpack_install-diff.txt
> contains:
> + Conditional jump or move depends on uninitialised value(s)
> +    at  RtlInitUnicodeString (unicode.h:212)
> +    by  LoadLibraryExW (module.c:924)
> +    by  LoadLibraryW (module.c:968)
> +    by  ImmCreateContext (imm.c:143)
> +    by  X11DRV_SetupXIM (xim.c:510)
> +    by  x11drv_init_thread_data (x11drv_main.c:654)
> +    by  X11DRV_SetWindowPos (x11drv.h:517)
> +    by  set_window_pos (winpos.c:1919)
> +    by  WIN_CreateWindowEx (win.c:1121)
> +    by  CreateWindowExW (win.c:1351)
> +    by  manage_desktop (desktop.c:224)
> +    by  WinMain (explorer.c:136)
> +    by  main (exe_main.c:48)
> 


From stefan at codeweavers.com  Wed Apr  2 07:56:21 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 2 Apr 2008 14:56:21 +0200
Subject: How can i bypass my bug?
In-Reply-To: <20080402111258.226330@gmx.net>
References: <f3a003030804020249p65745271gf9a30c47be25de44@mail.gmail.com>
	<20080402111258.226330@gmx.net>
Message-ID: <200804021456.21960.stefan@codeweavers.com>

Am Mittwoch, 2. April 2008 13:12:58 schrieb Roderick Colenbrander:
> Easy buy a simple videocard with vertex shader support we offer it on any
> card equal or better to a geforcefx / radeon 9500.
This game *needs* SW emulation - 2048 D3D vertex shader constants. A geforce 8 
might do the job though



From julliard at winehq.org  Wed Apr  2 07:20:22 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 02 Apr 2008 14:20:22 +0200
Subject: WINEX11.DRV: workaround for unstable window state while handling
	MapNotify (fixes bug 12196)
In-Reply-To: <47F2BAD6.5000702@palosanto.com> ("Alex =?utf-8?B?VmlsbGFj?=
	=?utf-8?B?w63CrXM=?= Lasso"'s message
	of "Tue, 01 Apr 2008 17:44:38 -0500")
References: <47F11BE5.40107@palosanto.com> <47F2BAD6.5000702@palosanto.com>
Message-ID: <87ve30cut5.fsf@wine.dyndns.org>

Alex Villac??s Lasso <a_villacis at palosanto.com> writes:

> Is this patch incorrect? Nobody has commented on it, and it has not been 
> applied either.

The concept is OK, but the implementation needs more work since
PropertyNotify is also triggered while waiting for the withdrawn state,
and you don't want to send messages to the window at that point. I'm
looking into it.

-- 
Alexandre Julliard
julliard at winehq.org


From paul.vriens.wine at gmail.com  Wed Apr  2 09:41:08 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 02 Apr 2008 16:41:08 +0200
Subject: Any particular reason we are using printf in the shlwapi/istream
	tests?
Message-ID: <47F39B04.8050307@gmail.com>

Hi,

Should these printf's be turned into trace/skip?

-- 
Cheers,

Paul.


From julliard at winehq.org  Wed Apr  2 09:45:05 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 02 Apr 2008 16:45:05 +0200
Subject: Any particular reason we are using printf in the shlwapi/istream
	tests?
In-Reply-To: <47F39B04.8050307@gmail.com> (Paul Vriens's message of "Wed, 02
	Apr 2008 16:41:08 +0200")
References: <47F39B04.8050307@gmail.com>
Message-ID: <87r6doco3y.fsf@wine.dyndns.org>

Paul Vriens <paul.vriens.wine at gmail.com> writes:

> Should these printf's be turned into trace/skip?

Yes.

-- 
Alexandre Julliard
julliard at winehq.org


From amorozov at etersoft.ru  Wed Apr  2 09:47:55 2008
From: amorozov at etersoft.ru (Alexander Morozov)
Date: Wed, 2 Apr 2008 18:47:55 +0400
Subject: [2/5] setupapi: Changing pointers on SP_DEVINFO_DATA
In-Reply-To: <87zlsccwk0.fsf@wine.dyndns.org>
References: <200804011524.20838.amorozov@etersoft.ru>
	<87zlsccwk0.fsf@wine.dyndns.org>
Message-ID: <200804021847.56378.amorozov@etersoft.ru>

> > SETUPDI_AddDeviceToSet: changing pointers on SP_DEVINFO_DATA after
> > allocating new memory block for their array
>
> We shouldn't have to do that sort of thing. The data structure should be
> fixed to store pointers that don't have to be moved around.

Should modify DeviceInfoSet and _SP_DEVINFO_DATA structures?
Without this patch so modified testRegisterAndGetDetail crashes:

--- a/dlls/setupapi/tests/devinst.c
+++ b/dlls/setupapi/tests/devinst.c
@@ -777,22 +777,26 @@ static void testRegisterAndGetDetail(voi
     SP_DEVINFO_DATA devInfo = { sizeof(SP_DEVINFO_DATA), { 0 } };
     SP_DEVICE_INTERFACE_DATA interfaceData = { sizeof(interfaceData), { 
0 } };
     DWORD dwSize = 0;
+    DWORD i;

     SetLastError(0xdeadbeef);
     set = pSetupDiGetClassDevsA(&guid, NULL, 0, DIGCF_ALLCLASSES);
     ok(set != INVALID_HANDLE_VALUE, "SetupDiGetClassDevsA failed: %08x\n",
      GetLastError());

-    SetLastError(0xdeadbeef);
-    ret = pSetupDiCreateDeviceInfoA(set, "LEGACY_BOGUS", &guid, NULL, 0,
-     DICD_GENERATE_ID, &devInfo);
-    ok(ret, "SetupDiCreateDeviceInfoA failed: %08x\n", GetLastError());
-    SetLastError(0xdeadbeef);
-    ret = pSetupDiCreateDeviceInterfaceA(set, &devInfo, &guid, NULL, 0, 
&interfaceData);
-    ok(ret, "SetupDiCreateDeviceInterfaceA failed: %08x\n", GetLastError());
-    SetLastError(0xdeadbeef);
-    ret = pSetupDiRegisterDeviceInfo(set, &devInfo, 0, NULL, NULL, NULL);
-    ok(ret, "SetupDiRegisterDeviceInfo failed: %08x\n", GetLastError());
+    for (i = 0; i < 10; ++i)
+    {
+        SetLastError(0xdeadbeef);
+        ret = pSetupDiCreateDeviceInfoA(set, "LEGACY_BOGUS", &guid, NULL, 0,
+         DICD_GENERATE_ID, &devInfo);
+        ok(ret, "SetupDiCreateDeviceInfoA failed: %08x\n", GetLastError());
+        SetLastError(0xdeadbeef);
+        ret = pSetupDiCreateDeviceInterfaceA(set, &devInfo, &guid, NULL, 0, 
&interfaceData);
+        ok(ret, "SetupDiCreateDeviceInterfaceA failed: %08x\n", 
GetLastError());
+        SetLastError(0xdeadbeef);
+        ret = pSetupDiRegisterDeviceInfo(set, &devInfo, 0, NULL, NULL, NULL);
+        ok(ret, "SetupDiRegisterDeviceInfo failed: %08x\n", GetLastError());
+    }

     pSetupDiDestroyDeviceInfoList(set);



From juan.lang at gmail.com  Wed Apr  2 09:53:07 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Wed, 2 Apr 2008 07:53:07 -0700
Subject: [2/5] setupapi: Changing pointers on SP_DEVINFO_DATA
In-Reply-To: <200804021847.56378.amorozov@etersoft.ru>
References: <200804011524.20838.amorozov@etersoft.ru>
	<87zlsccwk0.fsf@wine.dyndns.org>
	<200804021847.56378.amorozov@etersoft.ru>
Message-ID: <3a768c550804020753v2b697661p2c78520dc5e70b49@mail.gmail.com>

>  Should modify DeviceInfoSet and _SP_DEVINFO_DATA structures?

Yes.  A linked list would be more appropriate than an array.
Embarrassingly, this is the second time I've introduced such an error
into Wine.  Sorry for the mess.
--Juan


From susancragin at earthlink.net  Wed Apr  2 10:02:54 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Wed, 2 Apr 2008 11:02:54 -0400 (GMT-04:00)
Subject: re pulse issues
Message-ID: <14704625.1207148574344.JavaMail.root@elwamui-polski.atl.sa.earthlink.net>

wine-0.9.58-438-g997bea9

Just downloaded & compiled latest git and did winetricks fakeie6 gdiplus. 
Noticed the following, so I thought I'd pass it along FWIW.

Executing wine /home/susan/.winetrickscache/ppviewer.exe
ALSA lib pcm.c:2106:(snd_pcm_open_conf) Cannot open shared library /usr/lib/alsa-lib/libasound_module_pcm_pulse.so
ALSA lib pcm.c:2106:(snd_pcm_open_conf) Cannot open shared library /usr/lib/alsa-lib/libasound_module_pcm_pulse.so





From paul.vriens.wine at gmail.com  Wed Apr  2 10:15:36 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 02 Apr 2008 17:15:36 +0200
Subject: Any particular reason we are using printf in the shlwapi/istream
	tests?
In-Reply-To: <87r6doco3y.fsf@wine.dyndns.org>
References: <47F39B04.8050307@gmail.com> <87r6doco3y.fsf@wine.dyndns.org>
Message-ID: <47F3A318.6090806@gmail.com>

Alexandre Julliard wrote:
> Paul Vriens <paul.vriens.wine at gmail.com> writes:
> 
>> Should these printf's be turned into trace/skip?
> 
> Yes.
> 
Just sent in a patch for that.

Doing a quick (probably some false positives as well) gives:

comctl32/tests/imagelist.c
comctl32/tests/rebar.c
comctl32/tests/toolbar.c
crypt32/tests/encode.c
crypt32/tests/store.c
cryptnet/tests/cryptnet.c
gdi32/tests/dc.c
gdi32/tests/metafile.c
hlink/tests/hlink.c
imm32/tests/imm32.c
kernel32/tests/comm.c
kernel32/tests/file.c
kernel32/tests/format_msg.c
msi/tests/package.c
msvcrt/tests/printf.c
msvcrt/tests/string.c
msvcrt/tests/testlist.c
msvcrt/tests/time.c
ole32/tests/moniker.c
oleaut32/tests/typelib.c
rpcrt4/tests/rpc.c
rsaenh/tests/rsaenh.c
shell32/tests/shellpath.c
shell32/tests/shlexec.c
user32/tests/msg.c

that also have printf's in them. So another janitorial task?

-- 
Cheers,

Paul.


From mat at brain-dump.org  Wed Apr  2 10:18:27 2008
From: mat at brain-dump.org (Marc Andre Tanner)
Date: Wed, 02 Apr 2008 17:18:27 +0200
Subject: Some considerations about the Wine FUSE project for GSoC
In-Reply-To: <200804021011.25198.kai.blin@gmail.com>
References: <200803311415.18471.kai.blin@gmail.com>	<47F0E769.5020908@brain-dump.org>	<200803311608.09536.kai.blin@gmail.com>
	<200804021011.25198.kai.blin@gmail.com>
Message-ID: <47F3A3C3.3080902@brain-dump.org>

Kai Blin wrote:
> On Monday 31 March 2008 16:08:00 Kai Blin wrote:
>> On Monday 31 March 2008 15:30:17 Marc Andre Tanner wrote:
>>> I prototyped something and thought this way I would at least get some
>>> feedback (after all "Talk is cheap. Show me the code." is common
>>> practice in the open source world). But this wasn't really the
>>> case, so i am still wondering what should be done differently?
>> Whoops, I didn't see that url. Sorry, but things were a bit busy recently.
>> I'll give that a whirl later today.

Thanks for testing btw.

> I'm seeing some funny behaviour in a directory containing the files foo.txt, 
> Foo.txt and bAr.tXt
> 
> After mounting, I can only see a "foo.txt" in the directory,

That's intended, filenames which aren't all lower case are ignored.
This makes sure that there won't be conflicts. Ideally you should
start with an empty directory mount the fs and then untar your
actual content in mountpoint.

> containing the  Foo.txt contents.

This would be a bug, are you really sure you are getting the contents
of Foo.txt and not foo.txt? I ask because i can't reproduce it here.
If so could you please compile in debug support "make debug" and then
run ciopfs with option -d. This should print some debug information to
stderr.

Thanks,
Marc

-- 
  Marc Andre Tanner >< http://www.brain-dump.org/ >< GPG key: CF7D56C0


From dank at kegel.com  Wed Apr  2 10:52:53 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 2 Apr 2008 08:52:53 -0700
Subject: Recent imm changes triggered widespread valgrind errors?
In-Reply-To: <47F37B1F.40702@codeweavers.com>
References: <a71bd89a0804011716pdb12e47je28d04f474c8106@mail.gmail.com>
	<47F37B1F.40702@codeweavers.com>
Message-ID: <a71bd89a0804020852r676aad26h8ed95ba43d41fbbb@mail.gmail.com>

On Wed, Apr 2, 2008 at 5:25 AM, Aric Stewart <aric at codeweavers.com> wrote:
> Thanks for the heads up, With Alexandre's latest fix to the code do the
> valgrind errors persist?

Things look rather better today.


From jacek at codeweavers.com  Wed Apr  2 13:21:02 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Wed, 02 Apr 2008 18:21:02 +0000
Subject: mshtml: Added registry configuration to allow using Active Script
	engine for JavaScript scripts.
In-Reply-To: <87d4p8ehnf.fsf@wine.dyndns.org>
References: <47F220F9.2030308@codeweavers.com> <87d4p8ehnf.fsf@wine.dyndns.org>
Message-ID: <47F3CE8E.9060705@codeweavers.com>

Alexandre Julliard wrote:
> Jacek Caban <jacek at codeweavers.com> writes:
>
>   
>> +    static const WCHAR key_nameW[] =
>> +        {'S','o','f','t','w','a','r','e',
>> +         '\\','W','i','n','e',
>> +         '\\','M','S','H','T','M','L',
>> +         '\\','S','c','r','i','p','t','O','v','e','r','r','i','d','e','s',0};
>> +
>> +    /* @@ Wine registry key: HKCU\Software\Wine\MSHTML\ScriptOverrides */
>> +    res = RegOpenKeyW(HKEY_CURRENT_USER, key_nameW, &hkey);
>> +    if(res != ERROR_SUCCESS)
>> +        return ret;
>>     
>
> Why do we need a configuration option for this?  When would a user want
> to change it?
>   


This is for IE-specific scripts in HTMLs. We currently use Gecko for 
doing everything with scripts for us. It means that IE only pages won't 
work mainly due to incompatibilities in DOM API. Even worse case are 
apps that communicate with hosting apps via window.extern object. To 
make them work we need to run script in a real Active Script engine. 
What we can do is quite tricky, but it already works for other script 
languages in current Git (well, not much more than "Hello World" scripts 
work ATM, but I'm working on this). The problem is that in case of 
JavaScript we have to choose if we want Gecko or our JavaScript engine. 
There is no way to determine it automatically, so configurable option is 
needed. I've chosen to use per URL configuration as it seems to be the 
best way. Due to number of DOM API to be implemented and security issues 
I don't think we'll ever make Active Script mode default and it's not 
the goal, but when we'll have our own jscript.dll implementation 
(currently one needs to use native version for tests), we may consider 
some heuristics like using Active Script for c:/Program Files/Common 
Files/* HTMLs.


Jacek


From kai.blin at gmail.com  Wed Apr  2 11:52:59 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Wed, 2 Apr 2008 18:52:59 +0200
Subject: Some considerations about the Wine FUSE project for GSoC
In-Reply-To: <47F3A3C3.3080902@brain-dump.org>
References: <200803311415.18471.kai.blin@gmail.com>
	<200804021011.25198.kai.blin@gmail.com>
	<47F3A3C3.3080902@brain-dump.org>
Message-ID: <200804021852.59495.kai.blin@gmail.com>

On Wednesday 02 April 2008 17:18:27 Marc Andre Tanner wrote:

> > containing the  Foo.txt contents.
>
> This would be a bug, are you really sure you are getting the contents
> of Foo.txt and not foo.txt?

My bad, I must have misread. It's the contents of the lower case file.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080402/79ada5d0/attachment.pgp 

From ryuzaki90 at gmail.com  Wed Apr  2 10:08:06 2008
From: ryuzaki90 at gmail.com (Bryan Haskins)
Date: Wed, 2 Apr 2008 10:08:06 -0500
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
Message-ID: <7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>

I'm more interested in a direct pulseaudio gateway for Wine... since by
application sound control is the biggest thing here for most people.... wine
is treated as one big audio blob. Pulse sees it as one thing. In effect,
wine handles it's own audio (by talking with ALSA or OSS) then passes that
through to the outside sound server... which in most cases would simply be
ALSA or OSS itself, but in this case it gets passed to ALSA/OSS and through
this talks to pulse. I call that pretty messy when we could just directly
talk to pulse audio (easily, too) and have by applications control. Pulse is
going to be in pretty much every distro soon. For a 1.0 release, no one
wants to go out of their way to accomodate the shortcomings of our audio
control.

Even directly sending the blobof output to pulse directly at first would
simplify things. I know this means yet asnother audio output method to
maintain, and for various reasons many are against it. But this is similar
to us needing to improve ALSA support rather recently. Pulseaudio does
directly support ALSA, but it's a bit demanding on how it need to work to be
perfect.

ALSA, Pulseaudio, and OSS are probably the big three we need support for.
Pulse is a drop in replacement for things like Network Sound, and way easier
to configure and use.

Sorry for expanding the topic so much.

On 4/2/08, Susan Cragin <susancragin at earthlink.net> wrote:
>
> This site purports to give instructions on how to run certain
> applications, including Skype (which is 32-bit). I think wine should have
> instructions here too.
>
> http://www.pulseaudio.org/wiki/PerfectSetup
>
> It doesn't look like pulseaudio is going away from Ubuntu anytime soon.
> https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080402/0bd1ab9d/attachment.htm 

From austinenglish at gmail.com  Wed Apr  2 13:05:29 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 2 Apr 2008 13:05:29 -0500
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
Message-ID: <b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>

On Wed, Apr 2, 2008 at 10:08 AM, Bryan Haskins <ryuzaki90 at gmail.com> wrote:
> I'm more interested in a direct pulseaudio gateway for Wine... since by
> application sound control is the biggest thing here for most people.... wine
> is treated as one big audio blob. Pulse sees it as one thing. In effect,
> wine handles it's own audio (by talking with ALSA or OSS) then passes that
> through to the outside sound server... which in most cases would simply be
> ALSA or OSS itself, but in this case it gets passed to ALSA/OSS and through
> this talks to pulse. I call that pretty messy when we could just directly
> talk to pulse audio (easily, too) and have by applications control. Pulse is
> going to be in pretty much every distro soon. For a 1.0 release, no one
> wants to go out of their way to accomodate the shortcomings of our audio
> control.
>
>  Even directly sending the blobof output to pulse directly at first would
> simplify things. I know this means yet asnother audio output method to
> maintain, and for various reasons many are against it. But this is similar
> to us needing to improve ALSA support rather recently. Pulseaudio does
> directly support ALSA, but it's a bit demanding on how it need to work to be
> perfect.
>
>  ALSA, Pulseaudio, and OSS are probably the big three we need support for.
> Pulse is a drop in replacement for things like Network Sound, and way easier
> to configure and use.
>
>  Sorry for expanding the topic so much.
>
>
>
> On 4/2/08, Susan Cragin <susancragin at earthlink.net> wrote:
> > This site purports to give instructions on how to run certain
> applications, including Skype (which is 32-bit). I think wine should have
> instructions here too.
> >
> > http://www.pulseaudio.org/wiki/PerfectSetup
> >
> > It doesn't look like pulseaudio is going away from Ubuntu anytime soon.
> > https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
> >
> >
> >
> >
> >
>
>
>
>
>

This has been brought up before, and it's quite a bit of work. You
can't just simply forward everything to pulse call it a day, you'd
need to implement a full structure/drivers/etc., which would require
quite a bit of time/work and is likely outside of the scope of 1.0.


From truiken at gmail.com  Wed Apr  2 13:33:23 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 2 Apr 2008 13:33:23 -0500
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>
Message-ID: <22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>

On Wed, Apr 2, 2008 at 1:05 PM, Austin English <austinenglish at gmail.com> wrote:
>
> On Wed, Apr 2, 2008 at 10:08 AM, Bryan Haskins <ryuzaki90 at gmail.com> wrote:
>  > I'm more interested in a direct pulseaudio gateway for Wine... since by
>  > application sound control is the biggest thing here for most people.... wine
>  > is treated as one big audio blob. Pulse sees it as one thing. In effect,
>  > wine handles it's own audio (by talking with ALSA or OSS) then passes that
>  > through to the outside sound server... which in most cases would simply be
>  > ALSA or OSS itself, but in this case it gets passed to ALSA/OSS and through
>  > this talks to pulse. I call that pretty messy when we could just directly
>  > talk to pulse audio (easily, too) and have by applications control. Pulse is
>  > going to be in pretty much every distro soon. For a 1.0 release, no one
>  > wants to go out of their way to accomodate the shortcomings of our audio
>  > control.
>  >
>  >  Even directly sending the blobof output to pulse directly at first would
>  > simplify things. I know this means yet asnother audio output method to
>  > maintain, and for various reasons many are against it. But this is similar
>  > to us needing to improve ALSA support rather recently. Pulseaudio does
>  > directly support ALSA, but it's a bit demanding on how it need to work to be
>  > perfect.
>  >
>  >  ALSA, Pulseaudio, and OSS are probably the big three we need support for.
>  > Pulse is a drop in replacement for things like Network Sound, and way easier
>  > to configure and use.
>  >
>  >  Sorry for expanding the topic so much.
>  >
>  >
>  >
>  > On 4/2/08, Susan Cragin <susancragin at earthlink.net> wrote:
>  > > This site purports to give instructions on how to run certain
>  > applications, including Skype (which is 32-bit). I think wine should have
>  > instructions here too.
>  > >
>  > > http://www.pulseaudio.org/wiki/PerfectSetup
>  > >
>  > > It doesn't look like pulseaudio is going away from Ubuntu anytime soon.
>  > > https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
>  > >
>  > >
>  > >
>  > >
>  > >
>  >
>  >
>  >
>  >
>  >
>
>  This has been brought up before, and it's quite a bit of work. You
>  can't just simply forward everything to pulse call it a day, you'd
>  need to implement a full structure/drivers/etc., which would require
>  quite a bit of time/work and is likely outside of the scope of 1.0.
>

And I believe Julliard rejected the idea of adding a pulseaudio driver.

-- 
James Hawkins


From dsh at linux.ucla.edu  Wed Apr  2 13:46:27 2008
From: dsh at linux.ucla.edu (Dan Hipschman)
Date: Wed, 2 Apr 2008 11:46:27 -0700
Subject: [PATCH 4/7] widl: Support __fastcall and __pascal calling
	conventions.
In-Reply-To: <47F37465.3050105@codeweavers.com>
References: <47F37465.3050105@codeweavers.com>
Message-ID: <20080402184627.GE4608@linux.ucla.edu>

On Wed, Apr 02, 2008 at 12:56:21PM +0100, Robert Shearman wrote:
> @@ -186,13 +186,19 @@ static const struct keyword keywords[] = {
>  	{"FALSE",			tFALSE},
>  	{"TRUE",			tTRUE},
>  	{"__cdecl",			tCDECL},
> +	{"__fastcall",			tFASTCALL},
> +	{"__pascal",			tPASCAL},
>  	{"__int64",			tINT64},
>  	{"__stdcall",			tSTDCALL},

__pascal should come after __int64.


From thestig at google.com  Wed Apr  2 13:51:40 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 2 Apr 2008 11:51:40 -0700
Subject: testing 3d graphics with vmware workstation 6.5 beta?
Message-ID: <558b2f5c0804021151h50c4d5f9o8f6dbd63f961c4c1@mail.gmail.com>

I just got an email about the next vmware workstation beta:

"Improved 3D graphics Support ? Workstation 6.5 can now support
DirectX9.0 accelerated 3D with shaders so you can run more
applications inside your VM."

Maybe this will help with running the 3d graphics test suite in
virtual machines?

http://communities.vmware.com/community/beta/workstation6.5


From mstefani at redhat.com  Wed Apr  2 13:52:31 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 02 Apr 2008 20:52:31 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>
	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>
Message-ID: <47F3D5EF.2030001@redhat.com>

James Hawkins wrote:
> On Wed, Apr 2, 2008 at 1:05 PM, Austin English <austinenglish at gmail.com> wrote:
>> On Wed, Apr 2, 2008 at 10:08 AM, Bryan Haskins <ryuzaki90 at gmail.com> wrote:
>>  > I'm more interested in a direct pulseaudio gateway for Wine... since by
>>  > application sound control is the biggest thing here for most people.... wine
>>  > is treated as one big audio blob. Pulse sees it as one thing. In effect,
>>  > wine handles it's own audio (by talking with ALSA or OSS) then passes that
>>  > through to the outside sound server... which in most cases would simply be
>>  > ALSA or OSS itself, but in this case it gets passed to ALSA/OSS and through
>>  > this talks to pulse. I call that pretty messy when we could just directly
>>  > talk to pulse audio (easily, too) and have by applications control. Pulse is
>>  > going to be in pretty much every distro soon. For a 1.0 release, no one
>>  > wants to go out of their way to accomodate the shortcomings of our audio
>>  > control.
>>  >
>>  >  Even directly sending the blobof output to pulse directly at first would
>>  > simplify things. I know this means yet asnother audio output method to
>>  > maintain, and for various reasons many are against it. But this is similar
>>  > to us needing to improve ALSA support rather recently. Pulseaudio does
>>  > directly support ALSA, but it's a bit demanding on how it need to work to be
>>  > perfect.
>>  >
>>  >  ALSA, Pulseaudio, and OSS are probably the big three we need support for.
>>  > Pulse is a drop in replacement for things like Network Sound, and way easier
>>  > to configure and use.
>>  >
>>  >  Sorry for expanding the topic so much.
>>  >


>>
>>  This has been brought up before, and it's quite a bit of work. You
>>  can't just simply forward everything to pulse call it a day, you'd
>>  need to implement a full structure/drivers/etc., which would require
>>  quite a bit of time/work and is likely outside of the scope of 1.0.
>>
> 
> And I believe Julliard rejected the idea of adding a pulseaudio driver.
Nope! He isn't against a pulseaudio driver. He is against yet another
broken and half implemented driver for the desktop sound system that
happens to be en vogue at the moment.

I think he would love to see a clean, full implemented pulseaudio
driver; presented in a nice easy review-able patch series which cleans
up the wineaudio driver mess en passant.

bye
	michael


From kwixbit at gmail.com  Wed Apr  2 13:57:29 2008
From: kwixbit at gmail.com (Warren Dumortier)
Date: Wed, 2 Apr 2008 20:57:29 +0200
Subject: How can i bypass my bug?
In-Reply-To: <200804021456.21960.stefan@codeweavers.com>
References: <f3a003030804020249p65745271gf9a30c47be25de44@mail.gmail.com>
	<20080402111258.226330@gmx.net>
	<200804021456.21960.stefan@codeweavers.com>
Message-ID: <f3a003030804021157r70e2f422wcd263730897dc243@mail.gmail.com>

I don't understand, it is a wine bug, not a hardware problem?
I have a geforce 7600GT and knows it works, but don't have windows anymore...

2008/4/2, Stefan D?singer <stefan at codeweavers.com>:
> Am Mittwoch, 2. April 2008 13:12:58 schrieb Roderick Colenbrander:
>
> > Easy buy a simple videocard with vertex shader support we offer it on any
>  > card equal or better to a geforcefx / radeon 9500.
>
> This game *needs* SW emulation - 2048 D3D vertex shader constants. A geforce 8
>  might do the job though
>
>


From truiken at gmail.com  Wed Apr  2 13:59:58 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 2 Apr 2008 13:59:58 -0500
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <47F3D5EF.2030001@redhat.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>
	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>
	<47F3D5EF.2030001@redhat.com>
Message-ID: <22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>

On Wed, Apr 2, 2008 at 1:52 PM, Michael Stefaniuc <mstefani at redhat.com> wrote:
> James Hawkins wrote:
>  > On Wed, Apr 2, 2008 at 1:05 PM, Austin English <austinenglish at gmail.com> wrote:
>  >> On Wed, Apr 2, 2008 at 10:08 AM, Bryan Haskins <ryuzaki90 at gmail.com> wrote:
>  >>  > I'm more interested in a direct pulseaudio gateway for Wine... since by
>  >>  > application sound control is the biggest thing here for most people.... wine
>  >>  > is treated as one big audio blob. Pulse sees it as one thing. In effect,
>  >>  > wine handles it's own audio (by talking with ALSA or OSS) then passes that
>  >>  > through to the outside sound server... which in most cases would simply be
>  >>  > ALSA or OSS itself, but in this case it gets passed to ALSA/OSS and through
>  >>  > this talks to pulse. I call that pretty messy when we could just directly
>  >>  > talk to pulse audio (easily, too) and have by applications control. Pulse is
>  >>  > going to be in pretty much every distro soon. For a 1.0 release, no one
>  >>  > wants to go out of their way to accomodate the shortcomings of our audio
>  >>  > control.
>  >>  >
>  >>  >  Even directly sending the blobof output to pulse directly at first would
>  >>  > simplify things. I know this means yet asnother audio output method to
>  >>  > maintain, and for various reasons many are against it. But this is similar
>  >>  > to us needing to improve ALSA support rather recently. Pulseaudio does
>  >>  > directly support ALSA, but it's a bit demanding on how it need to work to be
>  >>  > perfect.
>  >>  >
>  >>  >  ALSA, Pulseaudio, and OSS are probably the big three we need support for.
>  >>  > Pulse is a drop in replacement for things like Network Sound, and way easier
>  >>  > to configure and use.
>  >>  >
>  >>  >  Sorry for expanding the topic so much.
>  >>  >
>
>
>  >>
>
> >>  This has been brought up before, and it's quite a bit of work. You
>  >>  can't just simply forward everything to pulse call it a day, you'd
>  >>  need to implement a full structure/drivers/etc., which would require
>  >>  quite a bit of time/work and is likely outside of the scope of 1.0.
>  >>
>  >
>  > And I believe Julliard rejected the idea of adding a pulseaudio driver.
>  Nope! He isn't against a pulseaudio driver. He is against yet another
>  broken and half implemented driver for the desktop sound system that
>  happens to be en vogue at the moment.
>
>  I think he would love to see a clean, full implemented pulseaudio
>  driver; presented in a nice easy review-able patch series which cleans
>  up the wineaudio driver mess en passant.
>

"No, the right answer is to make the Alsa driver work right. We need to
stop rushing out to write a new driver every time there's a problem with
an existing one, all it leads to is more broken drivers."
-Julliard

http://winehq.org/pipermail/wine-devel/2008-March/063755.html

-- 
James Hawkins


From marcus at jet.franken.de  Wed Apr  2 14:12:54 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Wed, 2 Apr 2008 21:12:54 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>
	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>
	<47F3D5EF.2030001@redhat.com>
	<22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
Message-ID: <20080402191254.GA4822@galeere>

> > >>  This has been brought up before, and it's quite a bit of work. You
> >  >>  can't just simply forward everything to pulse call it a day, you'd
> >  >>  need to implement a full structure/drivers/etc., which would require
> >  >>  quite a bit of time/work and is likely outside of the scope of 1.0.
> >  >>
> >  >
> >  > And I believe Julliard rejected the idea of adding a pulseaudio driver.
> >  Nope! He isn't against a pulseaudio driver. He is against yet another
> >  broken and half implemented driver for the desktop sound system that
> >  happens to be en vogue at the moment.
> >
> >  I think he would love to see a clean, full implemented pulseaudio
> >  driver; presented in a nice easy review-able patch series which cleans
> >  up the wineaudio driver mess en passant.
> >
> 
> "No, the right answer is to make the Alsa driver work right. We need to
> stop rushing out to write a new driver every time there's a problem with
> an existing one, all it leads to is more broken drivers."
> -Julliard
> 
> http://winehq.org/pipermail/wine-devel/2008-March/063755.html

... I also guess no one is stopping people from writing a pulseaudio driver.

Its just that it needs to make certain criteria before inclusion, after we
got burned with esound, arts, nas, etc etc etc etc.

Ciao, Marcus


From tehblunderbuss at gmail.com  Wed Apr  2 14:23:55 2008
From: tehblunderbuss at gmail.com (TheBlunderbuss)
Date: Wed, 02 Apr 2008 14:23:55 -0500
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <20080402191254.GA4822@galeere>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>	<47F3D5EF.2030001@redhat.com>	<22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
	<20080402191254.GA4822@galeere>
Message-ID: <47F3DD4B.60604@gmail.com>

Marcus Meissner wrote:
> ... I also guess no one is stopping people from writing a pulseaudio driver.
>
> Its just that it needs to make certain criteria before inclusion, after we
> got burned with esound, arts, nas, etc etc etc etc.
>
> Ciao, Marcus
Correct. There is a pulse driver for Wine being worked on, but outside 
the Wine project (ie "not us").


From mstefani at redhat.com  Wed Apr  2 14:28:23 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 02 Apr 2008 21:28:23 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>	<47F3D5EF.2030001@redhat.com>
	<22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
Message-ID: <47F3DE57.7050508@redhat.com>

James Hawkins wrote:
> On Wed, Apr 2, 2008 at 1:52 PM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>> James Hawkins wrote:

>>  > And I believe Julliard rejected the idea of adding a pulseaudio driver.
>>  Nope! He isn't against a pulseaudio driver. He is against yet another
>>  broken and half implemented driver for the desktop sound system that
>>  happens to be en vogue at the moment.
>>
>>  I think he would love to see a clean, full implemented pulseaudio
>>  driver; presented in a nice easy review-able patch series which cleans
>>  up the wineaudio driver mess en passant.
>>
> 
> "No, the right answer is to make the Alsa driver work right. We need to
> stop rushing out to write a new driver every time there's a problem with
> an existing one, all it leads to is more broken drivers."
> -Julliard
> 
> http://winehq.org/pipermail/wine-devel/2008-March/063755.html
Right, forgot about that one. But I am still sure he would accept a
"perfect" full featured and beautiful written pulseaudio driver. What he
doesn't wants at all is wasting precious Wine developer time on creating
one in his Wine git repository. And having it rot there because in 1-2
years all of todays pulseaudio proponents will complain how broken
pulseaudio is and how much better this "yet another audio system 2.0" is
and why Wine _needs_ to implement that one.

So if one of the proponents of pulseaudio for Wine would just go ahead
and start writing one, for example on git.or.cz Alexandre wouldn't mind
at all. Convincing the distributions to include the pulseaudio driver
should be an easy selling especially for Fedora and Ubuntu who seem to
move to "pulseaudio will fix everything".


bye
   michael "who fixed the sound on his desktop by removing pulseaudio"


From stefan at codeweavers.com  Wed Apr  2 14:44:41 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 2 Apr 2008 21:44:41 +0200
Subject: How can i bypass my bug?
In-Reply-To: <f3a003030804021157r70e2f422wcd263730897dc243@mail.gmail.com>
References: <f3a003030804020249p65745271gf9a30c47be25de44@mail.gmail.com>
	<200804021456.21960.stefan@codeweavers.com>
	<f3a003030804021157r70e2f422wcd263730897dc243@mail.gmail.com>
Message-ID: <200804022144.42148.stefan@codeweavers.com>

Am Mittwoch, 2. April 2008 20:57:29 schrieb Warren Dumortier:
> I don't understand, it is a wine bug, not a hardware problem?
> I have a geforce 7600GT and knows it works, but don't have windows
> anymore...
Correct, it is a Wine bug. A Geforce 8 might work around it though


From xixsimplicityxix at gmail.com  Wed Apr  2 14:51:34 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 2 Apr 2008 14:51:34 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <78a7dad00803280405w3da1fd8dv383a1c7dc6688bfa@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com> <20080325093948.145810@gmx.net>
	<78a7dad00803280405w3da1fd8dv383a1c7dc6688bfa@mail.gmail.com>
Message-ID: <78a7dad00804021251o444fc651y4bd64648f0b2b0bd@mail.gmail.com>

On Fri, Mar 28, 2008 at 6:05 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>
>  Well let me know how this works for you.  I'll refactor my script a
>  bit later today but for right now you have to run this one after the
>  winetest script, as this one counts on the environment that the

Here's the refactored script [1].  With some inspiration from winetricks ;)

Example uses:
$crossbuild_tricks winetest

$crossbuild_tricks d3d
=> builds d3d8,d3d9,wined3d, libwine

$crossbuild_tricks test cabinet
=> use test verb for individual tests

$crossbuild_tricks dll wintrust
=> use dll verb for individual dlls


First release and I've tested it some, seems to work but let me know
if it breaks for you.


Regards,
John

[1] http://klehm.net/wine/crossbuild_tricks.sh


From austinenglish at gmail.com  Wed Apr  2 15:01:54 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 2 Apr 2008 15:01:54 -0500
Subject: Nice feature?
In-Reply-To: <f3a003030804020245k619eb8c7j9e690f5839b7ab6e@mail.gmail.com>
References: <f3a003030804020245k619eb8c7j9e690f5839b7ab6e@mail.gmail.com>
Message-ID: <b6bb06270804021301o62254e6bie18023a868ea1655@mail.gmail.com>

On Wed, Apr 2, 2008 at 4:45 AM, Warren Dumortier <kwixbit at gmail.com> wrote:
> Hello!
> I have a little proposition for Wine 1.0!
> Why not creating an error dialog when a dll is missing, it would help a lot
> of users!
> For example there's a dialog to install geck, why not a dialog that simply
> says you have to add a dll in the correct directory?
>
>
>
>

When you say a missing dll, that could mean a few things. I'm assuming
you mean the typical case of a dll that should have been redistributed
with an app, but was not, and the application expects it to already be
present. Or the case of a failing installer failing to copy all files?
If so, these errors are already put out to stderr, like most other
warnings.


From julliard at winehq.org  Wed Apr  2 16:24:48 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 02 Apr 2008 23:24:48 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <47F3DE57.7050508@redhat.com> (Michael Stefaniuc's message of
	"Wed, 02 Apr 2008 21:28:23 +0200")
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>
	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>
	<47F3D5EF.2030001@redhat.com>
	<22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
	<47F3DE57.7050508@redhat.com>
Message-ID: <87k5jgc5lr.fsf@wine.dyndns.org>

Michael Stefaniuc <mstefani at redhat.com> writes:

> Right, forgot about that one. But I am still sure he would accept a
> "perfect" full featured and beautiful written pulseaudio driver. What he
> doesn't wants at all is wasting precious Wine developer time on creating
> one in his Wine git repository. And having it rot there because in 1-2
> years all of todays pulseaudio proponents will complain how broken
> pulseaudio is and how much better this "yet another audio system 2.0" is
> and why Wine _needs_ to implement that one.

What I really want is for all the people who are clamoring for yet
another driver to pitch in and start fixing the alsa driver instead.

Once this is done and we have demonstrated that we can actually make one
driver work 100% correctly, then we can consider adding another one.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Wed Apr  2 16:29:19 2008
From: stefan at codeweavers.com (Stefan =?windows-1252?q?D=F6singer?=)
Date: Wed, 2 Apr 2008 23:29:19 +0200
Subject: testing 3d graphics with vmware workstation 6.5 beta?
In-Reply-To: <558b2f5c0804021151h50c4d5f9o8f6dbd63f961c4c1@mail.gmail.com>
References: <558b2f5c0804021151h50c4d5f9o8f6dbd63f961c4c1@mail.gmail.com>
Message-ID: <200804022329.19575.stefan@codeweavers.com>

Am Mittwoch, 2. April 2008 20:51:40 schrieb Lei Zhang:
> I just got an email about the next vmware workstation beta:
>
> "Improved 3D graphics Support ? Workstation 6.5 can now support
> DirectX9.0 accelerated 3D with shaders so you can run more
> applications inside your VM."
>
> Maybe this will help with running the 3d graphics test suite in
> virtual machines?
Just give it a try I'd say. I doubt they got the shader stuff right on the 
first try, even if they tested with DCT(which is not available any more)





From dank at kegel.com  Wed Apr  2 16:31:15 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 2 Apr 2008 14:31:15 -0700
Subject: New winetricks 20080402: new verbs dotnet20, win2k, flash, msls31;
	updated mono, liberation
Message-ID: <a71bd89a0804021431w79515034i84ff0e4c57af3353@mail.gmail.com>

Big news: as of today or so, wine doesn't need any patches
to install the .net 2.0 runtime or run trivial .net 2.0 apps,
so I've added a dotnet20 verb.  No more futzing with recipes
to try out simple .net 2 apps, huzzah!

There are lots of other little changes, too:

20080402
r21  	Added dotnet20, removed one kludge from dotnet11, added win2k
verb, plus shorthand for winver=foo
r20 	Updated liberation fonts.

20080328
r19 	Added flash.

20080326
r18 	Fix i18n problem reported by Ricardo Cabral

20080321
r17 	Added msls31 (seems to be needed by e-Sword)

20080317
r16 	update mono12 to 1.2.9

...

As always, winetricks is downloadable from
http://kegel.com/wine/winetricks
and change history is at
http://code.google.com/p/winezeug

Thanks to the folks who keep feeding me improvements and suggestions!
- Dan


From austinenglish at gmail.com  Wed Apr  2 17:05:37 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 2 Apr 2008 17:05:37 -0500
Subject: Make test - opengl regression
Message-ID: <b6bb06270804021505r6b25a45au8912e625f59abbb0@mail.gmail.com>

Running on my virtualbox feisty vm, seems make test is making some progress:

austin at austin-desktop:~/wine-git$ cat wine-0.9.58-439-g73bd68c.txt |
grep 'make.*Error'
make[2]: *** [exception.ok] Error 1
make[1]: *** [ntdll/tests/__test__] Error 2
make[2]: *** [opengl.ok] Error 1
make[1]: *** [opengl32/tests/__test__] Error 2
make[2]: *** [msg.ok] Error 24
make[1]: *** [user32/tests/__test__] Error 2
make: *** [dlls/__test__] Error 2

The visual.c's are skipping properly now for me, but there's a
regression in opengl/opengl.c.

../../../tools/runtest -q -P wine -M opengl32.dll -T ../../.. -p
opengl32_test.exe.so opengl.c && touch opengl.ok
err:wgl:X11DRV_wglCreateContext Cannot get FB Config for iPixelFormat
0, expect problems!
opengl.c:248: Test failed: Unable to confirm DONTCARE behavior of
unset pixelformatdescriptor flags
err:wgl:X11DRV_SetPixelFormat Invalid operation on root_window
opengl.c:323: Tests skipped: No suitable pixel formats found
make: *** [opengl.ok] Error 1

I haven't ran a regression test yet, but if you want more logs or a
regression test, let me know.


From Andrew.Talbot at talbotville.com  Wed Apr  2 17:12:44 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Wed, 02 Apr 2008 23:12:44 +0100
Subject: msi: Remove tentative definition of static array with no size
	specifier
References: <200804022307.55734.andrew.talbot@talbotville.com>
Message-ID: <ft10cs$6id$1@ger.gmane.org>

Andrew Talbot wrote:

> strictly, when the static storage specifier is applied, the size must be
> specified:
> 
>     static char ar[5];           /* tentative definition */
> 
>     static char ar[5] = "hello"; /* actual definition */
> 

Of course, the size need not be specified in the case of the actual
definition, so the following is what I should have typed.

    static char a[] = "hello"; /* actual definition */

-- 
Andy.




From truiken at gmail.com  Wed Apr  2 17:14:02 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 2 Apr 2008 17:14:02 -0500
Subject: msi: Remove tentative definition of static array with no size
	specifier
In-Reply-To: <200804022307.55734.andrew.talbot@talbotville.com>
References: <200804022307.55734.andrew.talbot@talbotville.com>
Message-ID: <22821af30804021514y2fc5134eg3bd996a7db7e53e2@mail.gmail.com>

On Wed, Apr 2, 2008 at 5:07 PM, Andrew Talbot
<andrew.talbot at talbotville.com> wrote:
> Whereas for a non-static array a tentative definition does not require a
>  size to be specified, for example:
>
>     char ar[];            /* tentative definition */
>
>     char ar[] = "hello";  /* actual definition */
>
>  strictly, when the static storage specifier is applied, the size must be
>  specified:
>
>     static char ar[5];           /* tentative definition */
>
>     static char ar[5] = "hello"; /* actual definition */
>
>  This patch avoids using a magic number by moving the definition of an array
>  and adding forward declarations for the functions affected, instead.
>
>  -- Andy.
>  ---
>  Changelog:
>     msi: Remove tentative declaration of static array with no size specifier.
>
>  diff --git a/dlls/msi/action.c b/dlls/msi/action.c
>  index 982c9f0..8cc36a0 100644
>  --- a/dlls/msi/action.c
>  +++ b/dlls/msi/action.c
>  @@ -47,6 +47,64 @@ WINE_DEFAULT_DEBUG_CHANNEL(msi);
>   static UINT ACTION_ProcessExecSequence(MSIPACKAGE *package, BOOL UIran);
>   static UINT ACTION_ProcessUISequence(MSIPACKAGE *package);
>   static UINT ACTION_PerformActionSequence(MSIPACKAGE *package, UINT seq, BOOL UI);
>  +static UINT ACTION_AllocateRegistrySpace( MSIPACKAGE *package );
>  +static UINT ACTION_BindImage( MSIPACKAGE *package );
>  +static UINT ACTION_CostFinalize(MSIPACKAGE *package);
>  +static UINT ACTION_CostInitialize(MSIPACKAGE *package);
>  +static UINT ACTION_CreateFolders(MSIPACKAGE *package);
>  +static UINT ACTION_CreateShortcuts(MSIPACKAGE *package);
>  +static UINT ACTION_DeleteServices( MSIPACKAGE *package );
>  +static UINT ACTION_ExecuteAction(MSIPACKAGE *package);
>  +static UINT ACTION_FileCost(MSIPACKAGE *package);
>  +static UINT ACTION_InstallExecute(MSIPACKAGE *package);
>  +static UINT ACTION_InstallFinalize(MSIPACKAGE *package);
>  +static UINT ACTION_InstallInitialize(MSIPACKAGE *package);
>  +static UINT ACTION_InstallSFPCatalogFile( MSIPACKAGE *package );
>  +static UINT ACTION_InstallValidate(MSIPACKAGE *package);
>  +static UINT ACTION_IsolateComponents( MSIPACKAGE *package );
>  +static UINT ACTION_LaunchConditions(MSIPACKAGE *package);
>  +static UINT ACTION_MigrateFeatureStates( MSIPACKAGE *package );
>  +static UINT ACTION_MoveFiles( MSIPACKAGE *package );
>  +static UINT ACTION_MsiPublishAssemblies( MSIPACKAGE *package );
>  +static UINT ACTION_MsiUnpublishAssemblies( MSIPACKAGE *package );
>  +static UINT ACTION_InstallODBC( MSIPACKAGE *package );
>  +static UINT ACTION_InstallServices( MSIPACKAGE *package );
>  +static UINT ACTION_PatchFiles( MSIPACKAGE *package );
>  +static UINT ACTION_ProcessComponents(MSIPACKAGE *package);
>  +static UINT ACTION_PublishComponents(MSIPACKAGE *package);
>  +static UINT ACTION_PublishFeatures(MSIPACKAGE *package);
>  +static UINT ACTION_PublishProduct(MSIPACKAGE *package);
>  +static UINT ACTION_RegisterComPlus( MSIPACKAGE *package );
>  +static UINT ACTION_RegisterProduct(MSIPACKAGE *package);
>  +static UINT ACTION_RegisterTypeLibraries(MSIPACKAGE *package);
>  +static UINT ACTION_RegisterUser(MSIPACKAGE *package);
>  +static UINT ACTION_RemoveDuplicateFiles( MSIPACKAGE *package );
>  +static UINT ACTION_RemoveEnvironmentStrings( MSIPACKAGE *package );
>  +static UINT ACTION_RemoveExistingProducts( MSIPACKAGE *package );
>  +static UINT ACTION_RemoveFolders( MSIPACKAGE *package );
>  +static UINT ACTION_RemoveIniValues( MSIPACKAGE *package );
>  +static UINT ACTION_RemoveODBC( MSIPACKAGE *package );
>  +static UINT ACTION_RemoveRegistryValues( MSIPACKAGE *package );
>  +static UINT ACTION_RemoveShortcuts( MSIPACKAGE *package );
>  +static UINT ACTION_ResolveSource(MSIPACKAGE* package);
>  +static UINT ACTION_RMCCPSearch( MSIPACKAGE *package );
>  +static UINT ACTION_SelfRegModules(MSIPACKAGE *package);
>  +static UINT ACTION_SelfUnregModules( MSIPACKAGE *package );
>  +static UINT ACTION_StartServices( MSIPACKAGE *package );
>  +static UINT ACTION_StopServices( MSIPACKAGE *package );
>  +static UINT ACTION_UnpublishComponents( MSIPACKAGE *package );
>  +static UINT ACTION_UnpublishFeatures(MSIPACKAGE *package);
>  +static UINT ACTION_UnregisterClassInfo( MSIPACKAGE *package );
>  +static UINT ACTION_UnregisterComPlus( MSIPACKAGE *package );
>  +static UINT ACTION_UnregisterExtensionInfo( MSIPACKAGE *package );
>  +static UINT ACTION_UnregisterFonts( MSIPACKAGE *package );
>  +static UINT ACTION_UnregisterMIMEInfo( MSIPACKAGE *package );
>  +static UINT ACTION_UnregisterProgIdInfo( MSIPACKAGE *package );
>  +static UINT ACTION_UnregisterTypeLibraries( MSIPACKAGE *package );
>  +static UINT ACTION_ValidateProductID( MSIPACKAGE *package );
>  +static UINT ACTION_WriteEnvironmentStrings( MSIPACKAGE *package );
>  +static UINT ACTION_WriteIniValues(MSIPACKAGE *package);
>  +static UINT ACTION_WriteRegistryValues(MSIPACKAGE *package);
>

I object.  Also, RFCs should be sent to wine-devel, not wine-patches.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Wed Apr  2 17:17:05 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 2 Apr 2008 15:17:05 -0700
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <87k5jgc5lr.fsf@wine.dyndns.org>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>
	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>
	<47F3D5EF.2030001@redhat.com>
	<22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
	<47F3DE57.7050508@redhat.com> <87k5jgc5lr.fsf@wine.dyndns.org>
Message-ID: <b130c85e0804021517i723ea94kd67b3d129b84d838@mail.gmail.com>

Hi Alexandre,

2008/4/2, Alexandre Julliard <julliard at winehq.org>:
> Michael Stefaniuc <mstefani at redhat.com> writes:
>
>  > Right, forgot about that one. But I am still sure he would accept a
>  > "perfect" full featured and beautiful written pulseaudio driver. What he
>  > doesn't wants at all is wasting precious Wine developer time on creating
>  > one in his Wine git repository. And having it rot there because in 1-2
>  > years all of todays pulseaudio proponents will complain how broken
>  > pulseaudio is and how much better this "yet another audio system 2.0" is
>  > and why Wine _needs_ to implement that one.
>
>
> What I really want is for all the people who are clamoring for yet
>  another driver to pitch in and start fixing the alsa driver instead.
>
>  Once this is done and we have demonstrated that we can actually make one
>  driver work 100% correctly, then we can consider adding another one.
Apart from the horrible waveout playback code that was directly copied
from wineoss, and to a lighter degree the wavein code is there
anything seriously broken in winealsa? Nothing comes to mind at the
moment.

Cheers,
Maarten.


From Andrew.Talbot at talbotville.com  Wed Apr  2 17:19:44 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Wed, 02 Apr 2008 23:19:44 +0100
Subject: msi: Remove tentative definition of static array with no size
	specifier
References: <200804022307.55734.andrew.talbot@talbotville.com>
	<22821af30804021514y2fc5134eg3bd996a7db7e53e2@mail.gmail.com>
Message-ID: <ft10q0$7jc$1@ger.gmane.org>

James Hawkins wrote:

> 
> I object.  Also, RFCs should be sent to wine-devel, not wine-patches.
> 

I was submitting a patch with a prelude explaining why, not making a request
for comment. But on what grounds are you objecting?

-- 
Andy.




From truiken at gmail.com  Wed Apr  2 17:25:25 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 2 Apr 2008 17:25:25 -0500
Subject: msi: Remove tentative definition of static array with no size
	specifier
In-Reply-To: <ft10q0$7jc$1@ger.gmane.org>
References: <200804022307.55734.andrew.talbot@talbotville.com>
	<22821af30804021514y2fc5134eg3bd996a7db7e53e2@mail.gmail.com>
	<ft10q0$7jc$1@ger.gmane.org>
Message-ID: <22821af30804021525w3f0982e9m69df93ecf30bead9@mail.gmail.com>

On Wed, Apr 2, 2008 at 5:19 PM, Andrew Talbot
<Andrew.Talbot at talbotville.com> wrote:
> James Hawkins wrote:
>
>  >
>  > I object.  Also, RFCs should be sent to wine-devel, not wine-patches.
>  >
>
>  I was submitting a patch with a prelude explaining why, not making a request
>  for comment. But on what grounds are you objecting?
>

It's ugly.  What warning are you trying to fix?

-- 
James Hawkins


From mstefani at redhat.com  Wed Apr  2 17:26:40 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 03 Apr 2008 00:26:40 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <87k5jgc5lr.fsf@wine.dyndns.org>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>	<47F3D5EF.2030001@redhat.com>	<22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>	<47F3DE57.7050508@redhat.com>
	<87k5jgc5lr.fsf@wine.dyndns.org>
Message-ID: <47F40820.8040506@redhat.com>

Alexandre Julliard wrote:
> Michael Stefaniuc <mstefani at redhat.com> writes:
> 
>> Right, forgot about that one. But I am still sure he would accept a
>> "perfect" full featured and beautiful written pulseaudio driver. What he
>> doesn't wants at all is wasting precious Wine developer time on creating
>> one in his Wine git repository. And having it rot there because in 1-2
>> years all of todays pulseaudio proponents will complain how broken
>> pulseaudio is and how much better this "yet another audio system 2.0" is
>> and why Wine _needs_ to implement that one.
> 
> What I really want is for all the people who are clamoring for yet
> another driver to pitch in and start fixing the alsa driver instead.
Right but you _cannot_ force people to do that. If they just go ahead
and setup a separate Wine repo they can work on pulseaudio all the day
and nobody can stop them. That's the OSS reality and git makes that very
easy to do.

> Once this is done and we have demonstrated that we can actually make one
> driver work 100% correctly, then we can consider adding another one.
It is your tree and given the history the only sane approach for your
("The Wine") git tree. But that's the centralized approach and I would
love if people would start moving away from that.

Compare
"Hey guys, pulseaudio is the uber cool must have audio system of the
future. I went ahead and added a pulseaudio driver to Wine. Here is the
link to my git tree."
to
"Bitch bitch moan everything else sucks but pulseaudio bitch bitch so
you guys go ahead and implement it in Wine."

I prefer the first version but i probably listened to often to Linus
about the advantages of git and the distributed development model.

bye
	michael


From Andrew.Talbot at talbotville.com  Wed Apr  2 17:40:16 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Wed, 02 Apr 2008 23:40:16 +0100
Subject: msi: Remove tentative definition of static array with no size
	specifier
References: <200804022307.55734.andrew.talbot@talbotville.com>
	<22821af30804021514y2fc5134eg3bd996a7db7e53e2@mail.gmail.com>
	<ft10q0$7jc$1@ger.gmane.org>
	<22821af30804021525w3f0982e9m69df93ecf30bead9@mail.gmail.com>
Message-ID: <ft120h$c0u$1@ger.gmane.org>

James Hawkins wrote:

> 
> It's ugly.  What warning are you trying to fix?
> 

Although I imagine that gcc doesn't do anything particularly adverse as a
result of the existing code, if the pedantic switch were applied it would
cause a message of the following type to be generated.

    action.c:236: error: array size missing in ?StandardActions?

I believe it is also likely to show up under lint-like tools and I believe
it is actually an error, though compilers are not required to generate any
message, apparently. I couldn't say whether the resultant behaviour is
undefined, implemenation defined, or what. And I don't know whether gcc
places any surplus baggage in any segment as a result. The fix was just to
make the code correct and hence more portable.

-- 
Andy.




From truiken at gmail.com  Wed Apr  2 17:43:58 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 2 Apr 2008 17:43:58 -0500
Subject: msi: Remove tentative definition of static array with no size
	specifier
In-Reply-To: <ft120h$c0u$1@ger.gmane.org>
References: <200804022307.55734.andrew.talbot@talbotville.com>
	<22821af30804021514y2fc5134eg3bd996a7db7e53e2@mail.gmail.com>
	<ft10q0$7jc$1@ger.gmane.org>
	<22821af30804021525w3f0982e9m69df93ecf30bead9@mail.gmail.com>
	<ft120h$c0u$1@ger.gmane.org>
Message-ID: <22821af30804021543n5db8cd7an39276fea271370d8@mail.gmail.com>

On Wed, Apr 2, 2008 at 5:40 PM, Andrew Talbot
<Andrew.Talbot at talbotville.com> wrote:
> James Hawkins wrote:
>
>  >
>  > It's ugly.  What warning are you trying to fix?
>  >
>
>  Although I imagine that gcc doesn't do anything particularly adverse as a
>  result of the existing code, if the pedantic switch were applied it would
>  cause a message of the following type to be generated.
>
>     action.c:236: error: array size missing in ?StandardActions?
>
>  I believe it is also likely to show up under lint-like tools and I believe
>  it is actually an error, though compilers are not required to generate any
>  message, apparently. I couldn't say whether the resultant behaviour is
>  undefined, implemenation defined, or what. And I don't know whether gcc
>  places any surplus baggage in any segment as a result. The fix was just to
>  make the code correct and hence more portable.
>

That's fine, but it's not worth it to me, and I'm pretty sure Julliard
won't accept it either.

-- 
James Hawkins


From Andrew.Talbot at talbotville.com  Wed Apr  2 17:52:24 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Wed, 02 Apr 2008 23:52:24 +0100
Subject: msi: Remove tentative definition of static array with no size
	specifier
References: <200804022307.55734.andrew.talbot@talbotville.com>
	<22821af30804021514y2fc5134eg3bd996a7db7e53e2@mail.gmail.com>
	<ft10q0$7jc$1@ger.gmane.org>
	<22821af30804021525w3f0982e9m69df93ecf30bead9@mail.gmail.com>
	<ft120h$c0u$1@ger.gmane.org>
	<22821af30804021543n5db8cd7an39276fea271370d8@mail.gmail.com>
Message-ID: <ft12n8$drd$1@ger.gmane.org>

James Hawkins wrote:

> That's fine, but it's not worth it to me, and I'm pretty sure Julliard
> won't accept it either.
> 

I understand and suspect you are right. Maybe I should have made an RFC
rather than opting for trial by patch. :)

Thanks for your comments.

-- 
Andy.




From chris.kcat at gmail.com  Wed Apr  2 18:15:24 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Wed, 2 Apr 2008 16:15:24 -0700
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <47F40820.8040506@redhat.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<87k5jgc5lr.fsf@wine.dyndns.org> <47F40820.8040506@redhat.com>
Message-ID: <200804021615.24769.chris.kcat@gmail.com>

On Wednesday 02 April 2008 03:26:40 pm Michael Stefaniuc wrote:
> Alexandre Julliard wrote:
> > What I really want is for all the people who are clamoring for yet
> > another driver to pitch in and start fixing the alsa driver instead.
>
> Right but you _cannot_ force people to do that. If they just go ahead
> and setup a separate Wine repo they can work on pulseaudio all the day
> and nobody can stop them. That's the OSS reality and git makes that very
> easy to do.

But that still doesn't make it The Right Thing to do. Who's to say PulseAudio 
will really stick around and continue to be useful? Phonon has a good chance 
of that, too (as it's backed by Trolltech/Qt, and is useable on several OSs). 
And I'm sure people said some of the same thing about aRts. But we know how 
that ended up.

And it's not even like PA's main feature (software mixing) isn't available 
through ALSA (dmix). Sure it has some other features, but they're hardly 
something that Wine needs to make such a shift for (most apps have their own 
volume control, and people that need device hot-plugging can still get it 
through the ALSA-PulseAudio plugin; or even the OSS-PulseAudio plugin).

I'm sure I'm not alone in feeling like we're getting jerked around with audio 
APIs in Linux (use OSS! no, use ESD! no, use ALSA! no, use PulseAudio!). IMO, 
we have to set down and just pick something.


From stefan at codeweavers.com  Wed Apr  2 18:46:18 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 3 Apr 2008 01:46:18 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
Message-ID: <200804030146.18372.stefan@codeweavers.com>

Am Mittwoch, 2. April 2008 17:08:06 schrieb Bryan Haskins:
> I'm more interested in a direct pulseaudio gateway for Wine... since by
> application sound control is the biggest thing here for most people....
> wine is treated as one big audio blob. Pulse sees it as one thing.
Isn't that a PulseAudio limitation? I am sure that Wine opens a new Alsa 
connection for each Windows application that uses sound. I don't know how PA 
groups the input, but it can surely find different Wine inputs from Alsa.


From dsh at linux.ucla.edu  Wed Apr  2 19:18:47 2008
From: dsh at linux.ucla.edu (Dan Hipschman)
Date: Wed, 2 Apr 2008 17:18:47 -0700
Subject: [PATCH 4/7] widl: Support __fastcall and __pascal calling
	conventions.
In-Reply-To: <20080402184627.GE4608@linux.ucla.edu>
References: <47F37465.3050105@codeweavers.com>
	<20080402184627.GE4608@linux.ucla.edu>
Message-ID: <20080403001847.GG4608@linux.ucla.edu>

On Wed, Apr 02, 2008 at 11:46:27AM -0700, Dan Hipschman wrote:
> On Wed, Apr 02, 2008 at 12:56:21PM +0100, Robert Shearman wrote:
> > @@ -186,13 +186,19 @@ static const struct keyword keywords[] = {
> >  	{"FALSE",			tFALSE},
> >  	{"TRUE",			tTRUE},
> >  	{"__cdecl",			tCDECL},
> > +	{"__fastcall",			tFASTCALL},
> > +	{"__pascal",			tPASCAL},
> >  	{"__int64",			tINT64},
> >  	{"__stdcall",			tSTDCALL},
> 
> __pascal should come after __int64.
> 

I sent a patch.


From actong88 at gmail.com  Wed Apr  2 20:51:52 2008
From: actong88 at gmail.com (Allan Tong)
Date: Wed, 2 Apr 2008 21:51:52 -0400
Subject: [PATCH 04/10] wined3d: Add ENTER_GL/LEAVE_GL in
	IWineD3DSurfaceImpl_Release.
In-Reply-To: <47F3F69D.8040709@inbox.lv>
References: <47F3F69D.8040709@inbox.lv>
Message-ID: <d75158870804021851j2344841fm229b15a442c076ba@mail.gmail.com>

Perhaps the call to ActivateContext should be moved outside of the if
block since there are other gl calls in the function.  Then you could
move the glDeleteRenderbuffers block before the gdi section and
combine the ENTER_GL/LEAVE_GL blocks into one.

 - Allan


From talk2cod at hotmail.com  Wed Apr  2 23:28:24 2008
From: talk2cod at hotmail.com (andre furtado)
Date: Thu, 3 Apr 2008 04:28:24 +0000
Subject: batmeter exported functions
Message-ID: <BAY109-W369795340707D09F00440887F70@phx.gbl>


Andr? Renato Furtado, talk2cod at hotmail.com  add documentation for exported functions of the win32 batmeter library...
 
BOOL BatMeterCapabilities(    PUINT   *ppuiBatCount)
*\ description:    is used to determine if the batmeter lib can run on the host machine. return true on success 
(battery meter can run).    params:    out -> ppuiBatCount - points to a pointer which will be filled in with a pointer to the global battery count.*\
 
HWND CreateBatMeter(    HWND            hWndParent,    HWND            hWndFrame,    BOOL            bShowMulti,    PBATTERY_STATE  pbsComposite)
*\  description:    create, fetch data for and draw the batmeter window. returns a handle to the newly created battery meter window on success, null on failure.    param:    hWndParent      - parent of the battery meter dialog.    hWndFrame        - frame to locate the battery meter dialog.    bShowMulti      -  display mode (true -> multiple battery).    opt -> pbsComposite    - pointer to composite battery state.*\
 
HWND DestroyBatMeter(HWND hWnd)
*\ description:   destroy the batmeter window created with CreateBatMeter function. returns the handle of the 
batmeter parent window.   params:   hWnd   - handle to the window to be destroyed. *\
 
BOOL PowerCapabilities()
*\  description:    is used to determine if the system has any power    management capabilities which require ui support. return true if power management ui should be displayed. *\
 
BOOL UpdateBatMeter(    HWND            hWnd,    BOOL            bShowMulti,    BOOL            bForceUpdate,    PBATTERY_STATE  pbsComposite)
*\  description:    this function should be called when the battery meter parent window    receives a WM_POWERBROADCAST, PBT_APMPOWERSTATUSCHANGE message, it will    update the data in the global battery state list. if needed the display    will also be updated.  PARAMETERS:    hWndBatMeter,          hwnd of the battery meter dialog    bShowMulti,            display mode    bForceUpdate,          forces a ui update    opt -> pbsComposite,    pointer to composite battery state.  *\
 
WM_POWERBROADCAST == 0x218
PBT_APMPOWERSTATUSCHANGE == 0xa
_________________________________________________________________
Instale a Barra de Ferramentas com Desktop Search e ganhe EMOTICONS para o Messenger! ? GR?TIS!
http://www.msn.com.br/emoticonpack
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080403/20c53144/attachment-0001.htm 

From stephan at kochen.nl  Thu Apr  3 02:33:07 2008
From: stephan at kochen.nl (=?UTF-8?B?U3TDqXBoYW4gS29jaGVu?=)
Date: Thu, 03 Apr 2008 09:33:07 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <200804021615.24769.chris.kcat@gmail.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>	<87k5jgc5lr.fsf@wine.dyndns.org>
	<47F40820.8040506@redhat.com>
	<200804021615.24769.chris.kcat@gmail.com>
Message-ID: <47F48833.60102@kochen.nl>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

A lot of the posts I see about PulseAudio seem to complain about the
Linux audio situation in general. PulseAudio just gets dragged along in
all the negativity.

Chris Robinson wrote:
> On Wednesday 02 April 2008 03:26:40 pm Michael Stefaniuc wrote:
>> Alexandre Julliard wrote:
>>> What I really want is for all the people who are clamoring for yet
>>> another driver to pitch in and start fixing the alsa driver instead.
>> Right but you _cannot_ force people to do that. If they just go ahead
>> and setup a separate Wine repo they can work on pulseaudio all the day
>> and nobody can stop them. That's the OSS reality and git makes that very
>> easy to do.
> 
> But that still doesn't make it The Right Thing to do. Who's to say PulseAudio 
> will really stick around and continue to be useful? Phonon has a good chance 
> of that, too (as it's backed by Trolltech/Qt, and is useable on several OSs). 
> And I'm sure people said some of the same thing about aRts. But we know how 
> that ended up.

Phonon is high level multimedia framework. PulseAudio is a sound server.
Those are two very different areas.

aRts and ESounD were both abandoned because of inactivity, I believe.
Your doubts about the same happening to PulseAudio in light of that are
understandable.

But PulseAudio is the most actively maintained and most desktop
integrated audio solution we have now, and pretty much has been since
it's inception. This looks like one of the widest and most enthusiastic
adoptions of an audio standard I've ever seen on Linux, so I think the
risk is small.

> And it's not even like PA's main feature (software mixing) isn't available 
> through ALSA (dmix). Sure it has some other features, but they're hardly 
> something that Wine needs to make such a shift for (most apps have their own 
> volume control, and people that need device hot-plugging can still get it 
> through the ALSA-PulseAudio plugin; or even the OSS-PulseAudio plugin).

DMix is also a sound server. PulseAudio is a replacement in that sense.
Some will argue it is even a better replacement. ;)

Wine already goes to great lengths to integrate with the existing
desktop environments and distributions. (All the tiny things work: I can
double click on .exes, applications appear in desktop menu, I can copy
and paste naturally, even drag and drop.) Why not go the extra length
and have full integration when it comes to audio as well? Many large
distributions have already accepted PulseAudio as the standard.

Device hot-plugging should be nothing special, especially with Bluetooth
headsets and similar. I admit that I too do not know the exact
advantages in this area when talking directly to PulseAudio instead of
through the ALSA plug-in, but right now Wine does not even work with the
ALSA plug-in for me.

> I'm sure I'm not alone in feeling like we're getting jerked around with audio 
> APIs in Linux (use OSS! no, use ESD! no, use ALSA! no, use PulseAudio!). IMO, 
> we have to set down and just pick something.

You're damn right! So let's pick PulseAudio! :)

Regards,
- -- St?phan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD4DBQFH9IgzcFUq0gzqDwQRAl2GAJjwe9zLoos+0K8g4/nwmLaDvv4cAJwIKWVe
53m/n13wxXqKtOSbIb8SxA==
=RSWg
-----END PGP SIGNATURE-----


From julliard at winehq.org  Thu Apr  3 02:41:10 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 03 Apr 2008 09:41:10 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <b130c85e0804021517i723ea94kd67b3d129b84d838@mail.gmail.com>
	(Maarten Lankhorst's message of "Wed, 2 Apr 2008 15:17:05 -0700")
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>
	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>
	<47F3D5EF.2030001@redhat.com>
	<22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
	<47F3DE57.7050508@redhat.com> <87k5jgc5lr.fsf@wine.dyndns.org>
	<b130c85e0804021517i723ea94kd67b3d129b84d838@mail.gmail.com>
Message-ID: <87d4p7crmx.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> Apart from the horrible waveout playback code that was directly copied
> from wineoss, and to a lighter degree the wavein code is there
> anything seriously broken in winealsa? Nothing comes to mind at the
> moment.

Well, people are saying we need a pulseaudio driver because alsa doesn't
work right on top of pulseaudio; now it may well be that the fault is
entirely on the pulseaudio side, but either way it needs to be
investigated and fixed.

One other (minor) problem I know about is that building the alsa driver
spews out several warnings about using deprecated functions.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Apr  3 03:00:10 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 03 Apr 2008 10:00:10 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <47F40820.8040506@redhat.com> (Michael Stefaniuc's message of
	"Thu, 03 Apr 2008 00:26:40 +0200")
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>
	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>
	<47F3D5EF.2030001@redhat.com>
	<22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
	<47F3DE57.7050508@redhat.com> <87k5jgc5lr.fsf@wine.dyndns.org>
	<47F40820.8040506@redhat.com>
Message-ID: <878wzvcqr9.fsf@wine.dyndns.org>

Michael Stefaniuc <mstefani at redhat.com> writes:

> Alexandre Julliard wrote:
>> What I really want is for all the people who are clamoring for yet
>> another driver to pitch in and start fixing the alsa driver instead.
> Right but you _cannot_ force people to do that. If they just go ahead
> and setup a separate Wine repo they can work on pulseaudio all the day
> and nobody can stop them. That's the OSS reality and git makes that very
> easy to do.

Obviously I'm not trying to prevent anybody from working on it, just
trying to encourage at least a few people to follow the correct approach.

But yes, with git it's very easy to maintain a separate tree, and that
was a large part of the reason for making the switch from cvs. This way
I can keep being an asshole about the main tree, and people can route
around me and still get work done. Everybody wins...

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Apr  3 03:07:41 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 03 Apr 2008 10:07:41 +0200
Subject: msi: Remove tentative definition of static array with no size
	specifier
In-Reply-To: <ft12n8$drd$1@ger.gmane.org> (Andrew Talbot's message of "Wed, 02
	Apr 2008 23:52:24 +0100")
References: <200804022307.55734.andrew.talbot@talbotville.com>
	<22821af30804021514y2fc5134eg3bd996a7db7e53e2@mail.gmail.com>
	<ft10q0$7jc$1@ger.gmane.org>
	<22821af30804021525w3f0982e9m69df93ecf30bead9@mail.gmail.com>
	<ft120h$c0u$1@ger.gmane.org>
	<22821af30804021543n5db8cd7an39276fea271370d8@mail.gmail.com>
	<ft12n8$drd$1@ger.gmane.org>
Message-ID: <874pajcqeq.fsf@wine.dyndns.org>

Andrew Talbot <Andrew.Talbot at talbotville.com> writes:

> James Hawkins wrote:
>
>> That's fine, but it's not worth it to me, and I'm pretty sure Julliard
>> won't accept it either.
>
> I understand and suspect you are right. Maybe I should have made an RFC
> rather than opting for trial by patch. :)

I think it's worth fixing, but it's easier to do by avoiding the need
for the forward declaration, there's only one place that uses it.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Thu Apr  3 03:14:59 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 03 Apr 2008 09:14:59 +0100
Subject: msi: Remove tentative definition of static array with no size
	specifier
In-Reply-To: <ft120h$c0u$1@ger.gmane.org>
References: <200804022307.55734.andrew.talbot@talbotville.com>	<22821af30804021514y2fc5134eg3bd996a7db7e53e2@mail.gmail.com>	<ft10q0$7jc$1@ger.gmane.org>	<22821af30804021525w3f0982e9m69df93ecf30bead9@mail.gmail.com>
	<ft120h$c0u$1@ger.gmane.org>
Message-ID: <47F49203.6030205@codeweavers.com>

Andrew Talbot wrote:
> James Hawkins wrote:
>
>   
>> It's ugly.  What warning are you trying to fix?
>>
>>     
>
> Although I imagine that gcc doesn't do anything particularly adverse as a
> result of the existing code, if the pedantic switch were applied it would
> cause a message of the following type to be generated.
>
>     action.c:236: error: array size missing in ?StandardActions?
>
> I believe it is also likely to show up under lint-like tools and I believe
> it is actually an error, though compilers are not required to generate any
> message, apparently. I couldn't say whether the resultant behaviour is
> undefined, implemenation defined, or what. And I don't know whether gcc
> places any surplus baggage in any segment as a result. The fix was just to
> make the code correct and hence more portable.

This also causes problems when compiling with msvc:
> make[1]: Entering directory `/home/rob/wine-msvc/dlls/msi'
> CC action.o
> action.c
> action.c(236) : error C2133: 'StandardActions' : unknown size

It also might affect compilers on other platforms that Wine might be 
ported to. As Andy says, it's non-standard behaviour and so could break 
even in future versions of gcc.

I think the patch could be changed so that very few, if any, forward 
declarations would need to be made simply by moving 
ACTION_HandleStandardAction to after StandardActions is initialised.

-- 
Rob Shearman



From scott at open-vote.org  Thu Apr  3 03:58:04 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Thu, 03 Apr 2008 01:58:04 -0700
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <200804021615.24769.chris.kcat@gmail.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>	<87k5jgc5lr.fsf@wine.dyndns.org>
	<47F40820.8040506@redhat.com>
	<200804021615.24769.chris.kcat@gmail.com>
Message-ID: <47F49C1C.8090507@open-vote.org>

Chris Robinson wrote:
> On Wednesday 02 April 2008 03:26:40 pm Michael Stefaniuc wrote:
>> Alexandre Julliard wrote:
>>> What I really want is for all the people who are clamoring for yet
>>> another driver to pitch in and start fixing the alsa driver instead.
>> Right but you _cannot_ force people to do that. If they just go ahead
>> and setup a separate Wine repo they can work on pulseaudio all the day
>> and nobody can stop them. That's the OSS reality and git makes that very
>> easy to do.
> 
> But that still doesn't make it The Right Thing to do. Who's to say PulseAudio 
> will really stick around and continue to be useful? Phonon has a good chance 
> of that, too (as it's backed by Trolltech/Qt, and is useable on several OSs). 
> And I'm sure people said some of the same thing about aRts. But we know how 
> that ended up.
> 
> And it's not even like PA's main feature (software mixing) isn't available 
> through ALSA (dmix). Sure it has some other features, but they're hardly 
> something that Wine needs to make such a shift for (most apps have their own 
> volume control, and people that need device hot-plugging can still get it 
> through the ALSA-PulseAudio plugin; or even the OSS-PulseAudio plugin).
> 

PulseAudio will take off exactly because Ubuntu is using it.


> I'm sure I'm not alone in feeling like we're getting jerked around with audio 
> APIs in Linux (use OSS! no, use ESD! no, use ALSA! no, use PulseAudio!). IMO, 
> we have to set down and just pick something.
> 

Right, and very understandably it looks like we've picked ALSA, while
the distributions seemed to have picked PulseAudio.


Thanks,
Scott Ritchie


From julliard at winehq.org  Thu Apr  3 05:07:10 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 03 Apr 2008 12:07:10 +0200
Subject: [4/7] WineD3D: Macroize CheckDeviceFormat to reduce code
	duplication
In-Reply-To: <200804031149.56729.stefan@codeweavers.com> ("Stefan
	=?utf-8?Q?D=C3=B6singer=22's?=
	message of "Thu, 3 Apr 2008 11:49:56 +0200")
References: <200804031149.56729.stefan@codeweavers.com>
Message-ID: <87zlsbb6b5.fsf@wine.dyndns.org>

Stefan D?singer <stefan at codeweavers.com> writes:

> The main idea is to avoid that we have screen-sized code sections in this 
> function that look exactly the same. This should make navigation in the code 
> easier

It would be even better with an array of flag->function mappings and a
simple loop over the flags to check.

-- 
Alexandre Julliard
julliard at winehq.org


From paul.vriens.wine at gmail.com  Thu Apr  3 06:52:34 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 03 Apr 2008 13:52:34 +0200
Subject: Can we remove the rsabase tests?
Message-ID: <47F4C502.4040603@gmail.com>

Hi,

We have only a few (3) tests in the rsabase tests. The same tests are also 
available in the rsaenh tests.

The reason I think they can be removed:

- rsaenh seems to be available most platforms. If not then also rsabase is not 
available (by checking test.winehq.org)
- rsabase is not available on XP and above
- we forward all rsabase calls to rsaenh anyway

-- 
Cheers,

Paul.


From andreas.bierfert at lowlatency.de  Thu Apr  3 07:00:52 2008
From: andreas.bierfert at lowlatency.de (Andreas Bierfert)
Date: Thu, 3 Apr 2008 14:00:52 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <47F49C1C.8090507@open-vote.org>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<87k5jgc5lr.fsf@wine.dyndns.org> <47F40820.8040506@redhat.com>
	<200804021615.24769.chris.kcat@gmail.com>
	<47F49C1C.8090507@open-vote.org>
Message-ID: <20080403140052.1211763c@alkaid.a.lan>

On Thu, 03 Apr 2008 01:58:04 -0700
Scott Ritchie <scott at open-vote.org> wrote:

> PulseAudio will take off exactly because Ubuntu is using it.

Just to remind you that Fedora has been using it before :P

Anyway, I had to deal with a lot of people when F8 hit because wine was not
working with the default fedora install. Not everything was perfect in the
fedora setup of pa then and it probably is not now, but for the near future
that is where sound in fedora is going.

I would really prefer a native pa backend in wine, but something I do not
understand is why people complain about pa <-> alsa <-> wine when pa <->
pa-esd-compat <-> wine works perfectly...

Regards,
Andreas Bierfert
-- 
Andreas Bierfert, M.Sc.        | http://awbsworld.de      | GPG: C58CF1CB
andreas.bierfert at lowlatency.de | http://lowlatency.de     | signed/encrypted
phone: +49 2402 102373         | cell: +49 173 5803043    | mail preferred
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080403/1c5800f5/attachment.pgp 

From mstefani at redhat.com  Thu Apr  3 07:49:36 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 03 Apr 2008 14:49:36 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <20080403140052.1211763c@alkaid.a.lan>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>	<87k5jgc5lr.fsf@wine.dyndns.org>
	<47F40820.8040506@redhat.com>	<200804021615.24769.chris.kcat@gmail.com>	<47F49C1C.8090507@open-vote.org>
	<20080403140052.1211763c@alkaid.a.lan>
Message-ID: <47F4D260.6080906@redhat.com>

Andreas Bierfert wrote:
> On Thu, 03 Apr 2008 01:58:04 -0700
> Scott Ritchie <scott at open-vote.org> wrote:
> 
>> PulseAudio will take off exactly because Ubuntu is using it.
> 
> Just to remind you that Fedora has been using it before :P
> 
> Anyway, I had to deal with a lot of people when F8 hit because wine was not
> working with the default fedora install. Not everything was perfect in the
> fedora setup of pa then and it probably is not now, but for the near future
> that is where sound in fedora is going.
Until the easy stuff that everybody implements (mixer, interface to the 
ton of other sound systems) is finished. Fixing the bugs and the odd 
cases will not be sexy. Interest in PA will fade away, the fan boys will 
move to the next cool thing for which they can go out preaching and 
trying to convince the people of The Right Way. PA will start to rot and 
count as broken by design. Then the next sound system will emerge "to 
fix" all the PA breakages. Fedora and Ubuntu will move to this next uber 
cool sound system. Rinse repeat.

I would love to have a sound system that sticks around for a while. But 
I really doubt that that will be named PulseAudio.

bye
	michael


From jeroen.janssen at gmail.com  Thu Apr  3 08:02:30 2008
From: jeroen.janssen at gmail.com (Jeroen Janssen)
Date: Thu, 3 Apr 2008 13:02:30 +0000 (UTC)
Subject: cygwin and -luuid build error?
Message-ID: <loom.20080403T112224-706@post.gmane.org>

Hi,

I don't know if building wine with cygwin is/should be supported.
However, I get a linker error in dlls/atl with IID_IOleInPlaceSiteWindowless.

It seems this symbol is in the uuid library. The "problem" it seems is that this
library is linked with EXTRALIBS in Makefile.in and this doesn't result in the
correct -L path to be set (essentially the libuuid.a can not be found by the
linker).

When I move -luuid from EXTRALIBS to IMPORTS, -L../../dlls/uuid is added to the
linker and the library is correctly linked.

Since it works ok on Linux, moving the -luuid option around is probably not a
good solution, but I was wondering if anyone has looked into this before and if
so what a good solution would be.

Any thoughts on this?

Best regards,

Jeroen Janssen



From dmitry at codeweavers.com  Thu Apr  3 08:08:14 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 3 Apr 2008 22:08:14 +0900
Subject: cygwin and -luuid build error?
References: <loom.20080403T112224-706@post.gmane.org>
Message-ID: <012c01c8958b$c8d23030$a600fea9@DMITRY>

"Jeroen Janssen" <jeroen.janssen at gmail.com> wrote:

> I don't know if building wine with cygwin is/should be supported.

It is not, cygwin is not in the supported platforms list.

-- 
Dmitry.


From piotr.caban at gmail.com  Thu Apr  3 08:26:29 2008
From: piotr.caban at gmail.com (Piotr Caban)
Date: Thu, 3 Apr 2008 15:26:29 +0200
Subject: Improving msxml3.dll as GSoC project
Message-ID: <200804031526.29551.piotr.caban@gmail.com>

Hi,
I thought about improving msxml3.dll as GSoC project. There are some 
interfaces not implemented at all, some are not fully implemented. I found 
that there's quite a lot of bugs related to this dll in bugzilla.

I have already sent an application. I thought about implementing SAXReader 
first (there are some applications that fails to install because of it, bugs 
9682 and 6303). Afterwards I thought about implementing functions that are 
used by Photoshop installer (bug 8945, part related to msxml3.dll). I'm not 
really sure how long it will take but if there's enough time I'm going to fix 
more bugs (there are 33 bugs in bugzilla related with the dll). Afterwards  I 
can implement more interfaces that are missing.

More details can be found in the GSoC application.

What do you think about the project idea? Do you have any suggestions?

Regards,
Piotr Caban


From thunderbird2k at gmx.net  Thu Apr  3 08:50:43 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Thu, 03 Apr 2008 15:50:43 +0200
Subject: [4/7] WineD3D: Macroize CheckDeviceFormat to reduce code
	duplication
In-Reply-To: <200804031149.56729.stefan@codeweavers.com>
References: <200804031149.56729.stefan@codeweavers.com>
Message-ID: <20080403135043.203080@gmx.net>

In the end I think something like this is nice to do but not right now. CheckDeviceFormat has changed a lot and it is in good shape now but CreateTexture and friends don't do anything with the capabilities we report. In other words the next step should be to move flags (where possible) over to the pixel format table. E.g. in case of render targets and post pixel shader blending this has been done already. It can be done for a few more.

Basically the Check*Capability functions somehow be placed in utils.c and the result would be cached in the pixel format table. Both CheckDeviceFormat and CreateTexture (and friends) would be able to use the information then.

The Check*Capability calls in CheckDeviceFormat would then become AND-mask checks on the Flags field of a pixel format. This can all be done in small patches.

Roderick


> The main idea is to avoid that we have screen-sized code sections in this 
> function that look exactly the same. This should make navigation in the
> code 
> easier
> 
> Roderick: If you do not like that, just drop a note

-- 
Ist Ihr Browser Vista-kompatibel? Jetzt die neuesten 
Browser-Versionen downloaden: http://www.gmx.net/de/go/browser


From smoki00790 at gmail.com  Thu Apr  3 09:59:21 2008
From: smoki00790 at gmail.com (=?ISO-8859-2?Q?Milan_Kosti=E6?=)
Date: Thu, 3 Apr 2008 16:59:21 +0200
Subject: Deactivate GL_FRAGMENT_SHADER_ATI before deactivating a context
Message-ID: <e1d9e62c0804030759q25f4cd0ao753c5e029a18354a@mail.gmail.com>

 I'm use Mesa 7.01 because that version not have this problem (I try
fragshader.c test from bug #15269). Bug is introduced earler with this
commit, i'm warn about it but nobody listen because i'm not offering
good solution:
 http://gitweb.freedesktop.org/?p=mesa/mesa.git;a=commit;h=e279a0a076b7a3c8d60138c19870784c260c9d67

 Also with that commit several other regressions was introduced with
r200 DRI driver. Maybe they will listen someone (Stefan:)) from here.


From alexd4 at inbox.lv  Thu Apr  3 10:40:23 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Thu, 03 Apr 2008 18:40:23 +0300
Subject: [PATCH 04/10] wined3d: Add ENTER_GL/LEAVE_GL
	in	IWineD3DSurfaceImpl_Release.
In-Reply-To: <d75158870804021851j2344841fm229b15a442c076ba@mail.gmail.com>
References: <47F3F69D.8040709@inbox.lv>
	<d75158870804021851j2344841fm229b15a442c076ba@mail.gmail.com>
Message-ID: <47F4FA67.9010907@inbox.lv>

Hi.

Sounds like a good idea. Unfortunately, it's too late to rework that patch as it 
seems to be in git by now. I suggest you send this improvement as a patch under 
your name.

Allan Tong wrote:
> Perhaps the call to ActivateContext should be moved outside of the if
> block since there are other gl calls in the function.  Then you could
> move the glDeleteRenderbuffers block before the gdi section and
> combine the ENTER_GL/LEAVE_GL blocks into one.
> 
>  - Allan


From susancragin at earthlink.net  Thu Apr  3 11:49:55 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Thu, 3 Apr 2008 12:49:55 -0400 (EDT)
Subject: Pulse Audio -- Wine should have instructions on this web site
Message-ID: <23410889.1207241395827.JavaMail.root@elwamui-darkeyed.atl.sa.earthlink.net>

Back to the initial question:

Given what we have existing, right now, is there any set of instructions or workarounds that makes WINE apps work best?
even
killall pulseaudio ??
I would like to post them on the pulse web site if appropriate.
I would also like to post them on the web site regarding installing Dragon NaturallySpeaking. 

Thanks. 




From tokul at users.sourceforge.net  Thu Apr  3 11:48:13 2008
From: tokul at users.sourceforge.net (Tomas Kuliavas)
Date: Thu, 3 Apr 2008 19:48:13 +0300 (EEST)
Subject: broken mails from forum
Message-ID: <52937.78.61.224.253.1207241293.nsm@avilys.eik.lt>

Hi,

Could somebody make sure that broken MIME messages are not send to mailing
list. 8bit headers are not allowed. 8bit message body needs RFC2045
headers. By default courier-mta corrupts plain rfc822 messages with 8bit
message body.

-- 
Tomas



From austinenglish at gmail.com  Thu Apr  3 12:18:45 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 3 Apr 2008 12:18:45 -0500
Subject: Make test - opengl regression
In-Reply-To: <b6bb06270804021505r6b25a45au8912e625f59abbb0@mail.gmail.com>
References: <b6bb06270804021505r6b25a45au8912e625f59abbb0@mail.gmail.com>
Message-ID: <b6bb06270804031018v79216ab3keeface5b7444927c@mail.gmail.com>

On Wed, Apr 2, 2008 at 5:05 PM, Austin English <austinenglish at gmail.com> wrote:
> Running on my virtualbox feisty vm, seems make test is making some progress:
>
>  austin at austin-desktop:~/wine-git$ cat wine-0.9.58-439-g73bd68c.txt |
>  grep 'make.*Error'
>  make[2]: *** [exception.ok] Error 1
>  make[1]: *** [ntdll/tests/__test__] Error 2
>  make[2]: *** [opengl.ok] Error 1
>  make[1]: *** [opengl32/tests/__test__] Error 2
>  make[2]: *** [msg.ok] Error 24
>  make[1]: *** [user32/tests/__test__] Error 2
>  make: *** [dlls/__test__] Error 2
>
>  The visual.c's are skipping properly now for me, but there's a
>  regression in opengl/opengl.c.
>
>  ../../../tools/runtest -q -P wine -M opengl32.dll -T ../../.. -p
>  opengl32_test.exe.so opengl.c && touch opengl.ok
>  err:wgl:X11DRV_wglCreateContext Cannot get FB Config for iPixelFormat
>  0, expect problems!
>  opengl.c:248: Test failed: Unable to confirm DONTCARE behavior of
>  unset pixelformatdescriptor flags
>  err:wgl:X11DRV_SetPixelFormat Invalid operation on root_window
>  opengl.c:323: Tests skipped: No suitable pixel formats found
>  make: *** [opengl.ok] Error 1
>
>  I haven't ran a regression test yet, but if you want more logs or a
>  regression test, let me know.
>

Seems Roderick's recent  wgl: Fix ChoosePixelFormat behavior patch is
to blame. Before, it would simply skip on failure, now I get a make
error. Is a skip() possible for this case?

http://source.winehq.org/git/wine.git/?a=commit;h=616ac380f9a1ed4e83f0159f4cc9768bad8b4a68


From thestig at google.com  Thu Apr  3 12:37:54 2008
From: thestig at google.com (Lei Zhang)
Date: Thu, 3 Apr 2008 10:37:54 -0700
Subject: Documentation is still in CVS?
Message-ID: <558b2f5c0804031037i427a04fbo1262e3f6c1a735d2@mail.gmail.com>

Hi,

Is there a reason why the Wine documentation is still in CVS, and not in GIT?

- Lei


From dimi at lattica.com  Thu Apr  3 12:50:22 2008
From: dimi at lattica.com (Dimi Paun)
Date: Thu, 03 Apr 2008 13:50:22 -0400
Subject: Documentation is still in CVS?
In-Reply-To: <558b2f5c0804031037i427a04fbo1262e3f6c1a735d2@mail.gmail.com>
References: <558b2f5c0804031037i427a04fbo1262e3f6c1a735d2@mail.gmail.com>
Message-ID: <1207245023.5399.43.camel@dimi.lattica.com>


On Thu, 2008-04-03 at 10:37 -0700, Lei Zhang wrote:
> Is there a reason why the Wine documentation is still in CVS, and not
> in GIT?

Yes. The docs are now maintained at SourceForge, and given the glacial
pace of updates, there is little reason to move them to git. Moreover,
git presents a much higher barrier to entry, and there's no reason to
raise it for (potentially non-technical) documentation contributors.

-- 
Dimi Paun <dimi at lattica.com>
Lattica, Inc.



From jnewman at codeweavers.com  Thu Apr  3 13:22:10 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Thu, 03 Apr 2008 13:22:10 -0500
Subject: broken mails from forum
In-Reply-To: <52937.78.61.224.253.1207241293.nsm@avilys.eik.lt>
References: <52937.78.61.224.253.1207241293.nsm@avilys.eik.lt>
Message-ID: <47F52052.1080203@codeweavers.com>

The source is here:
http://www.mail2forum.com/wiki/Download

If someone wants to patch it.

Tomas Kuliavas wrote:
> Hi,
> 
> Could somebody make sure that broken MIME messages are not send to mailing
> list. 8bit headers are not allowed. 8bit message body needs RFC2045
> headers. By default courier-mta corrupts plain rfc822 messages with 8bit
> message body.
> 


From chris.kcat at gmail.com  Thu Apr  3 15:33:49 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Thu, 3 Apr 2008 13:33:49 -0700
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <47F49C1C.8090507@open-vote.org>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<200804021615.24769.chris.kcat@gmail.com>
	<47F49C1C.8090507@open-vote.org>
Message-ID: <200804031333.49363.chris.kcat@gmail.com>

On Thursday 03 April 2008 01:58:04 am Scott Ritchie wrote:
> PulseAudio will take off exactly because Ubuntu is using it.

I don't see ALSA going anywhere anytime soon, seeing as it's in the Linux 
kernel itself.

There's also the issue of PulseAudio being designed to further abstract away 
the audio hardware, which is, IMO, the wrong way Wine needs to be going for 
its DirectSound implementation. The closer we can get to hardware capbilities 
and features, the better.. and AFAIK, ALSA can provide that (assuming its 
drivers know about it).

> > I'm sure I'm not alone in feeling like we're getting jerked around with
> > audio APIs in Linux (use OSS! no, use ESD! no, use ALSA! no, use
> > PulseAudio!). IMO, we have to set down and just pick something.
>
> Right, and very understandably it looks like we've picked ALSA, while
> the distributions seemed to have picked PulseAudio.

Just as distributions picked ESD (via Gnome) and aRts (via KDE) before.

AFAICS, the big issue with the sound landscape in Linux is the lack of ability 
to play multiple sounds at one time, brought on by the lack of proper 
hardware (that doesn't provide multiple output voices) combined with an API 
that can't smartly do software mixing given the lack of hardware voices. ALSA 
can do software mixing, but it needs to be told explicitly by using dmix.

Adding Yet Another Sound API will not fix this. In fact it'll make it worse, 
as each API will want to take exclusive control and we're left with a handful 
of APIs that need to be supported, because a user will be using one and can't 
(easilly) use another. As well, the more you layer one new API on another, 
you'll add more latency and room for bugs, and just enhance the impression 
that Linux audio sucks. Plus, it'll punish those that *do* have good hardware 
by abstracting it away to the lowest common denominator.

IMO, this is why Wine needs to use something lower-level like OSS and ALSA, so 
it can get the capabilities of hardware and offer them through its 
DirectSound implementation, and expose features of the same hardware, not a 
generalized sound server. With Direct3D, we go through OpenGL to expose the 
hardware capabilities. With DirectSound, ALSA seems to be the closest we have 
that provides hardware capabilities.


From saulius2 at ar.fi.lt  Thu Apr  3 16:16:15 2008
From: saulius2 at ar.fi.lt (Saulius Krasuckas)
Date: Fri, 4 Apr 2008 00:16:15 +0300 (EEST)
Subject: LoadStringW [1/2]
In-Reply-To: <47950AEF.9060409@procyongames.com>
References: <4794545B.4000909@procyongames.com>
	<005101c85c07$b280a180$a600fea9@DMITRY>
	<000601c85c08$f006a440$a600fea9@DMITRY>
	<4794FD3E.2080204@procyongames.com>
	<22821af30801211217g22c09c8bu597659ab11aafff0@mail.gmail.com> 
	<479504E4.4080401@procyongames.com>
	<22821af30801211252l30be545cqc9cf37bb4b89451c@mail.gmail.com>
	<47950AEF.9060409@procyongames.com>
Message-ID: <Pine.LNX.4.62.0804032333300.6745@tvarka.ar.fi.lt>

* James Hawkins wrote:
>* On Jan 21, 2008 2:14 PM, Christopher wrote:
>>* Dmitry Timoshkov wrote:
>>>
>>> Also, you need to test LoadStringA, to see if it behaves 
>>> similarly. It would be also interesting to test LoadStringA/W with 
>>> both buffer and buffer length set to 0.
>> 
>> I tested LoadStringA under Windows XP, and calling it with buflen 
>> == 0 does not return a pointer to the resource. In fact LoadStringA 
>> seems to behave fairly differently from LoadStringW: in that 
>> calling with buffer == NULL causes an access violation instead of 
>> just returning 0.
>
> That's why you need to add tests for LoadStringA to Wine's test 
> suite.

No, he did not.  The word "need" wasn't appropriate here.  Christopher 
wasn't going to change LoadStringA.  If changes of LoadStringW breaks 
LoadStringA then tests would show regression.  If tests are too weak, then 
only patch commiter or previous patchers of the LoadStringA are to blame, 
not the casual contributor who enhances B.

And if this is some new official rule for code, then I don't find it on 
the site:www.winehq.org .  Of course, I don't protest at the idea (as I 
would do the same as Dmitry wrote), but I protest against usage of this 
particular word -- it's too strong here.  Please, be more accurate with it.

P.S.: James, you probably should start learning to cut unnecessary blocks 
of quoted text (esp. empty lines) and doing some block justifying in your 
replies using your MUA some day.  Otherwise it gets too hard to read a 
discussion.


From julliard at winehq.org  Thu Apr  3 16:45:45 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 03 Apr 2008 23:45:45 +0200
Subject: Can we remove the rsabase tests?
In-Reply-To: <47F4C502.4040603@gmail.com> (Paul Vriens's message of "Thu, 03
	Apr 2008 13:52:34 +0200")
References: <47F4C502.4040603@gmail.com>
Message-ID: <87r6dmboja.fsf@wine.dyndns.org>

Paul Vriens <paul.vriens.wine at gmail.com> writes:

> The reason I think they can be removed:
>
> - rsaenh seems to be available most platforms. If not then also rsabase is not 
> available (by checking test.winehq.org)
> - rsabase is not available on XP and above
> - we forward all rsabase calls to rsaenh anyway

Sure, it's just a forwarding dll, it doesn't need tests.

-- 
Alexandre Julliard
julliard at winehq.org


From ryuzaki90 at gmail.com  Wed Apr  2 16:20:57 2008
From: ryuzaki90 at gmail.com (Bryan Haskins)
Date: Wed, 2 Apr 2008 17:20:57 -0400
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>
	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>
	<47F3D5EF.2030001@redhat.com>
	<22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
Message-ID: <7e33d29b0804021420j19d12047ma386a60d66f2c091@mail.gmail.com>

I would totally agree with that, James. If ALSA worked perfectly, it's
really no problem getting it working "OOB" with Pulse, no specific sound
system needed.

On Wed, Apr 2, 2008 at 2:59 PM, James Hawkins <truiken at gmail.com> wrote:

> On Wed, Apr 2, 2008 at 1:52 PM, Michael Stefaniuc <mstefani at redhat.com>
> wrote:
> > James Hawkins wrote:
> >  > On Wed, Apr 2, 2008 at 1:05 PM, Austin English <
> austinenglish at gmail.com> wrote:
> >  >> On Wed, Apr 2, 2008 at 10:08 AM, Bryan Haskins <ryuzaki90 at gmail.com>
> wrote:
> >  >>  > I'm more interested in a direct pulseaudio gateway for Wine...
> since by
> >  >>  > application sound control is the biggest thing here for most
> people.... wine
> >  >>  > is treated as one big audio blob. Pulse sees it as one thing. In
> effect,
> >  >>  > wine handles it's own audio (by talking with ALSA or OSS) then
> passes that
> >  >>  > through to the outside sound server... which in most cases would
> simply be
> >  >>  > ALSA or OSS itself, but in this case it gets passed to ALSA/OSS
> and through
> >  >>  > this talks to pulse. I call that pretty messy when we could just
> directly
> >  >>  > talk to pulse audio (easily, too) and have by applications
> control. Pulse is
> >  >>  > going to be in pretty much every distro soon. For a 1.0 release,
> no one
> >  >>  > wants to go out of their way to accomodate the shortcomings of
> our audio
> >  >>  > control.
> >  >>  >
> >  >>  >  Even directly sending the blobof output to pulse directly at
> first would
> >  >>  > simplify things. I know this means yet asnother audio output
> method to
> >  >>  > maintain, and for various reasons many are against it. But this
> is similar
> >  >>  > to us needing to improve ALSA support rather recently. Pulseaudio
> does
> >  >>  > directly support ALSA, but it's a bit demanding on how it need to
> work to be
> >  >>  > perfect.
> >  >>  >
> >  >>  >  ALSA, Pulseaudio, and OSS are probably the big three we need
> support for.
> >  >>  > Pulse is a drop in replacement for things like Network Sound, and
> way easier
> >  >>  > to configure and use.
> >  >>  >
> >  >>  >  Sorry for expanding the topic so much.
> >  >>  >
> >
> >
> >  >>
> >
> > >>  This has been brought up before, and it's quite a bit of work. You
> >  >>  can't just simply forward everything to pulse call it a day, you'd
> >  >>  need to implement a full structure/drivers/etc., which would
> require
> >  >>  quite a bit of time/work and is likely outside of the scope of 1.0.
> >  >>
> >  >
> >  > And I believe Julliard rejected the idea of adding a pulseaudio
> driver.
> >  Nope! He isn't against a pulseaudio driver. He is against yet another
> >  broken and half implemented driver for the desktop sound system that
> >  happens to be en vogue at the moment.
> >
> >  I think he would love to see a clean, full implemented pulseaudio
> >  driver; presented in a nice easy review-able patch series which cleans
> >  up the wineaudio driver mess en passant.
> >
>
> "No, the right answer is to make the Alsa driver work right. We need to
> stop rushing out to write a new driver every time there's a problem with
> an existing one, all it leads to is more broken drivers."
> -Julliard
>
> http://winehq.org/pipermail/wine-devel/2008-March/063755.html
>
> --
> James Hawkins
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080402/fe15ad9f/attachment-0001.htm 

From ryuzaki90 at gmail.com  Wed Apr  2 16:23:50 2008
From: ryuzaki90 at gmail.com (Bryan Haskins)
Date: Wed, 2 Apr 2008 17:23:50 -0400
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <7e33d29b0804021420j19d12047ma386a60d66f2c091@mail.gmail.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>
	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>
	<47F3D5EF.2030001@redhat.com>
	<22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
	<7e33d29b0804021420j19d12047ma386a60d66f2c091@mail.gmail.com>
Message-ID: <7e33d29b0804021423p5a3ec275l9d5b96234de28a8c@mail.gmail.com>

Sorry for the double post. But further on that point, at the sound system
neutral level, naming eahc app individually as a sound item would rock. In
such a way that each app perhaps talks to ALSA directly, which results in
self identification, and further Pulse via ALSA recognizing things
individually.

For me, the only way to get it working properly with pulse is padsp, meaning
using oss and prefixing all wine commands with padsp.

On Wed, Apr 2, 2008 at 5:20 PM, Bryan Haskins <ryuzaki90 at gmail.com> wrote:

> I would totally agree with that, James. If ALSA worked perfectly, it's
> really no problem getting it working "OOB" with Pulse, no specific sound
> system needed.
>
>
> On Wed, Apr 2, 2008 at 2:59 PM, James Hawkins <truiken at gmail.com> wrote:
>
> > On Wed, Apr 2, 2008 at 1:52 PM, Michael Stefaniuc <mstefani at redhat.com>
> > wrote:
> > > James Hawkins wrote:
> > >  > On Wed, Apr 2, 2008 at 1:05 PM, Austin English <
> > austinenglish at gmail.com> wrote:
> > >  >> On Wed, Apr 2, 2008 at 10:08 AM, Bryan Haskins <
> > ryuzaki90 at gmail.com> wrote:
> > >  >>  > I'm more interested in a direct pulseaudio gateway for Wine...
> > since by
> > >  >>  > application sound control is the biggest thing here for most
> > people.... wine
> > >  >>  > is treated as one big audio blob. Pulse sees it as one thing.
> > In effect,
> > >  >>  > wine handles it's own audio (by talking with ALSA or OSS) then
> > passes that
> > >  >>  > through to the outside sound server... which in most cases
> > would simply be
> > >  >>  > ALSA or OSS itself, but in this case it gets passed to ALSA/OSS
> > and through
> > >  >>  > this talks to pulse. I call that pretty messy when we could
> > just directly
> > >  >>  > talk to pulse audio (easily, too) and have by applications
> > control. Pulse is
> > >  >>  > going to be in pretty much every distro soon. For a 1.0
> > release, no one
> > >  >>  > wants to go out of their way to accomodate the shortcomings of
> > our audio
> > >  >>  > control.
> > >  >>  >
> > >  >>  >  Even directly sending the blobof output to pulse directly at
> > first would
> > >  >>  > simplify things. I know this means yet asnother audio output
> > method to
> > >  >>  > maintain, and for various reasons many are against it. But this
> > is similar
> > >  >>  > to us needing to improve ALSA support rather recently.
> > Pulseaudio does
> > >  >>  > directly support ALSA, but it's a bit demanding on how it need
> > to work to be
> > >  >>  > perfect.
> > >  >>  >
> > >  >>  >  ALSA, Pulseaudio, and OSS are probably the big three we need
> > support for.
> > >  >>  > Pulse is a drop in replacement for things like Network Sound,
> > and way easier
> > >  >>  > to configure and use.
> > >  >>  >
> > >  >>  >  Sorry for expanding the topic so much.
> > >  >>  >
> > >
> > >
> > >  >>
> > >
> > > >>  This has been brought up before, and it's quite a bit of work. You
> > >  >>  can't just simply forward everything to pulse call it a day,
> > you'd
> > >  >>  need to implement a full structure/drivers/etc., which would
> > require
> > >  >>  quite a bit of time/work and is likely outside of the scope of
> > 1.0.
> > >  >>
> > >  >
> > >  > And I believe Julliard rejected the idea of adding a pulseaudio
> > driver.
> > >  Nope! He isn't against a pulseaudio driver. He is against yet another
> > >  broken and half implemented driver for the desktop sound system that
> > >  happens to be en vogue at the moment.
> > >
> > >  I think he would love to see a clean, full implemented pulseaudio
> > >  driver; presented in a nice easy review-able patch series which
> > cleans
> > >  up the wineaudio driver mess en passant.
> > >
> >
> > "No, the right answer is to make the Alsa driver work right. We need to
> > stop rushing out to write a new driver every time there's a problem with
> > an existing one, all it leads to is more broken drivers."
> > -Julliard
> >
> > http://winehq.org/pipermail/wine-devel/2008-March/063755.html
> >
> > --
> > James Hawkins
> >
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080402/98bf1040/attachment-0001.htm 

From m.b.lankhorst at gmail.com  Thu Apr  3 12:47:58 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 3 Apr 2008 10:47:58 -0700
Subject: iTunes ipod support
Message-ID: <b130c85e0804031047q2c02954ay79c1a26e4495e6e5@mail.gmail.com>

Hi all,

I submitted the ipod patches to wine-patches. This won't add support
for ipod touch or iphones. I expect that all patches will be merged
soon. If anyone feels adventurous they can try it. With the amount of
people interested in it I decided to post an update on the mailing
list so that everyone who picked up on the earlier threads can find
it.

Instructions:
- Apply attached patch
- Get a clean wineprefix
- Set wine version to vista
- Download the installer from itunes.com, and install.
- wine net start ipod\ service
- run itunes
- Hopefully the ipod is detected now. Dapper might have a bug in hald
which case it won't detect any usb hard drive that's plugged in. sudo
killall hald; sudo hald; wineserver -k; wine net start ipod\ service
seems to work as workaround.

So far there seems to be some confusion, so for the sake of clarity:
This won't add support for ipod touch or iphones.

Cheers,
Maarten.
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ipod_big.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080403/0799c8e5/attachment-0001.txt 

From hintak_leung at yahoo.co.uk  Thu Apr  3 13:29:10 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Thu, 3 Apr 2008 18:29:10 +0000 (GMT)
Subject: Documentation is still in CVS?
In-Reply-To: <1207245023.5399.43.camel@dimi.lattica.com>
Message-ID: <906835.3460.qm@web23111.mail.ird.yahoo.com>

--- On Thu, 3/4/08, Dimi Paun <dimi at lattica.com> wrote:

> From: Dimi Paun <dimi at lattica.com>
> Subject: Re: Documentation is still in CVS?
> To: "Wine Devel" <wine-devel at winehq.org>
> Date: Thursday, 3 April, 2008, 6:50 PM
> On Thu, 2008-04-03 at 10:37 -0700, Lei Zhang wrote:
> > Is there a reason why the Wine documentation is still
> in CVS, and not
> > in GIT?
> 
> Yes. The docs are now maintained at SourceForge, and given
> the glacial
> pace of updates, there is little reason to move them to
> git. Moreover,
> git presents a much higher barrier to entry, and
> there's no reason to
> raise it for (potentially non-technical) documentation
> contributors.
>

Actually I tried to follow the wiki instructions to do a git-cvsimport and it didn't work a week or two ago; and plain "cvs co" did not work either.
I have a few other stuff on sourceforge, so the problem seems to be specific to wine. Does anonymous check out work for anybody else? 






      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Inbox http://uk.docs.yahoo.com/nowyoucan.html


From thestig at google.com  Thu Apr  3 17:14:03 2008
From: thestig at google.com (Lei Zhang)
Date: Thu, 3 Apr 2008 15:14:03 -0700
Subject: Documentation is still in CVS?
In-Reply-To: <906835.3460.qm@web23111.mail.ird.yahoo.com>
References: <1207245023.5399.43.camel@dimi.lattica.com>
	<906835.3460.qm@web23111.mail.ird.yahoo.com>
Message-ID: <558b2f5c0804031514u3f093c85u3ed8ca9a5ecfe5ac@mail.gmail.com>

On Thu, Apr 3, 2008 at 11:29 AM, Hin-Tak Leung <hintak_leung at yahoo.co.uk> wrote:
>  Actually I tried to follow the wiki instructions to do a git-cvsimport and it didn't work a week or two ago; and plain "cvs co" did not work either.
>  I have a few other stuff on sourceforge, so the problem seems to be specific to wine. Does anonymous check out work for anybody else?
>

The instructions on http://www.winehq.org/site/cvs works for me.


From dank at kegel.com  Thu Apr  3 20:14:03 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 3 Apr 2008 18:14:03 -0700
Subject: [1/6] qedit: Add test framework and test for
	IMediaDet_put_Filename.
Message-ID: <a71bd89a0804031814g6781be2dt95f27a2ab0b3da67@mail.gmail.com>

I think you can't depend on files existing in the source
directory; you have to create them yourself
(e.g. from a hex array in your source).
Otherwise the unified winetest app that we
use for semiautomated remote windows testing
by users won't work.

But if, say, WINETEST_INTERACTIVE is set, you
can still use test.avi in the local directory instead
of creating one.


From dmitry at codeweavers.com  Thu Apr  3 21:10:15 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 4 Apr 2008 11:10:15 +0900
Subject: LoadStringW [1/2]
References: <4794545B.4000909@procyongames.com><005101c85c07$b280a180$a600fea9@DMITRY><000601c85c08$f006a440$a600fea9@DMITRY><4794FD3E.2080204@procyongames.com><22821af30801211217g22c09c8bu597659ab11aafff0@mail.gmail.com>
	<479504E4.4080401@procyongames.com><22821af30801211252l30be545cqc9cf37bb4b89451c@mail.gmail.com><47950AEF.9060409@procyongames.com>
	<Pine.LNX.4.62.0804032333300.6745@tvarka.ar.fi.lt>
Message-ID: <006401c895f9$07c167d0$a600fea9@DMITRY>

"Saulius Krasuckas" <saulius2 at ar.fi.lt> wrote:

> No, he did not.  The word "need" wasn't appropriate here.  Christopher 
> wasn't going to change LoadStringA.  If changes of LoadStringW breaks 
> LoadStringA then tests would show regression.  If tests are too weak, then 
> only patch commiter or previous patchers of the LoadStringA are to blame, 
> not the casual contributor who enhances B.

It should be obvious that if a patch introduces a regression (which is the case)
then this patch can't be aplied. If the regression can be identified by someone
able to read the code and not by a regression test that doesn't matter.

> P.S.: James, you probably should start learning to cut unnecessary blocks 
> of quoted text (esp. empty lines) and doing some block justifying in your 
> replies using your MUA some day.  Otherwise it gets too hard to read a 
> discussion.

James left the useful context which is especially helpful for you to reply
in 2 weeks without need to reread the whole thread.

-- 
Dmitry.


From dsh at linux.ucla.edu  Thu Apr  3 21:17:06 2008
From: dsh at linux.ucla.edu (Dan Hipschman)
Date: Thu, 3 Apr 2008 19:17:06 -0700
Subject: [1/6] qedit: Add test framework and test for
	IMediaDet_put_Filename.
In-Reply-To: <a71bd89a0804031814g6781be2dt95f27a2ab0b3da67@mail.gmail.com>
References: <a71bd89a0804031814g6781be2dt95f27a2ab0b3da67@mail.gmail.com>
Message-ID: <20080404021706.GN4608@linux.ucla.edu>

On Thu, Apr 03, 2008 at 06:14:03PM -0700, Dan Kegel wrote:
> I think you can't depend on files existing in the source
> directory; you have to create them yourself
> (e.g. from a hex array in your source).
> Otherwise the unified winetest app that we
> use for semiautomated remote windows testing
> by users won't work.
> 
> But if, say, WINETEST_INTERACTIVE is set, you
> can still use test.avi in the local directory instead
> of creating one.

It doesn't depend on any files anywhere at runtime.  The file is
compiled into the executable as a resource and the resource is extracted
to a temp file at runtime, so the executable is all you need to run the
test.


From dank at kegel.com  Thu Apr  3 22:18:21 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 3 Apr 2008 20:18:21 -0700
Subject: [1/6] qedit: Add test framework and test for
	IMediaDet_put_Filename.
In-Reply-To: <20080404021706.GN4608@linux.ucla.edu>
References: <a71bd89a0804031814g6781be2dt95f27a2ab0b3da67@mail.gmail.com>
	<20080404021706.GN4608@linux.ucla.edu>
Message-ID: <a71bd89a0804032018p4ade49c5rb306cb72b03dfed0@mail.gmail.com>

On Thu, Apr 3, 2008 at 7:17 PM, Dan Hipschman <dsh at linux.ucla.edu> wrote:
>  It doesn't depend on any files anywhere at runtime.  The file is
>  compiled into the executable as a resource and the resource is extracted
>  to a temp file at runtime, so the executable is all you need to run the
>  test.

Well, foo.  I stand corrected.  Sorry for the noise!


From dank at kegel.com  Thu Apr  3 22:26:42 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 3 Apr 2008 20:26:42 -0700
Subject: Lug Radio Live 2008 wine talk. Slides online, comments welcome.
Message-ID: <a71bd89a0804032026s2f87faa7v27641421c4e07ac1@mail.gmail.com>

I'm going to be giving a Wine talk at LugRadio Live 2008,
April 12-13, in San Francisco.
My talk is Saturday at 2:30; see
http://lugradio.org/live/USA2008/schedule

In a mixup at my favorite coffeehouse today
(Stir Crazy), I was accidentally overcaffeinated,
and wrote my entire presentation in about one sitting.
It's online at
  http://kegel.com/wine/lugradiolive2008/
The slides are pretty basic; I'll talk a lot around them.
If anybody feels like reviewing the slides
and giving feedback, I'd appreciate it.

If anybody's planning on attending the event, let's
get together for lunch or coffee or something.
- Dan


From talk2cod at hotmail.com  Thu Apr  3 23:15:24 2008
From: talk2cod at hotmail.com (andre furtado)
Date: Fri, 4 Apr 2008 04:15:24 +0000
Subject: hypertrm exported functions
Message-ID: <BAY109-W118E3C4B4EFACACD38FA6E87F60@phx.gbl>


add documentation for exported functions of the win32 hypertrm library...
BOOL InitInstance(const HINSTANCE hInstance, const LPTSTR lpCmdLine, const int nCmdShow)/* creates the hypertrm session window.   args:   hInstance - apps instance handle.   lpCmdLine - command line.   nCmdShow - passed from winmain overhead function arglist. */
int MessageLoop(void)
/* window message loop. return a wparam int value, that contains the additional information of the 
processed message. */
SF_HANDLE sessQuerySysFileHdl(const HSESSION hSession)
/* returns the sysfile handle based on hypertrm session.   args:   hSession -> hypertrm session. */
HTRANSLATE sessQueryTranslateHdl(const HSESSION hSession)
/* returns the translate handle associated with specific hypertrm session. translate handle is used 
for manager character translation.   args:   hSession -> hypertrm session. */
int sfGetSessionItem(const SF_HANDLE hSF,     const UINT uID,     unsigned long *pIDSize,     void *pvData)
/* is used to get data and item size from the session file handle.   args:   hSF -> session file handle.   uID -> item id.   [out] pIDSize -> size returned.   [out] pvData -> a pointer to an buffer that receives the data. */
int sfPutSessionItem(const SF_HANDLE hSF,     const unsigned int uID,     const unsigned long uIDSize,     const void *pvData)
/* is used to add or modify an entry in the session file data associated with the current session file 
handle.   args:   hSF -> session file handle.   uID -> item id.   pIDSize -> size.   pvData -> a pointer to an buffer of data. */
talk2cod at hotmail.com
_________________________________________________________________
Cansado de espa?o para s? 50 fotos? Conhe?a o Spaces, o site de relacionamentos com at? 6,000 fotos!
http://www.amigosdomessenger.com.br
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080404/3899d1a1/attachment.htm 

From wine-devel at kievinfo.com  Thu Apr  3 23:42:42 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Thu, 03 Apr 2008 22:42:42 -0600
Subject: hypertrm exported functions
In-Reply-To: <BAY109-W118E3C4B4EFACACD38FA6E87F60@phx.gbl>
References: <BAY109-W118E3C4B4EFACACD38FA6E87F60@phx.gbl>
Message-ID: <47F5B1C2.9020101@kievinfo.com>

andre furtado wrote:
> add documentation for exported functions of the win32 hypertrm library...
Send all patches in unified diff format from the top of the source tree. 
Drop all html content - plain text only please.

For more information read http://wiki.winehq.org/SubmittingPatches

Vitaliy.


From dmitry at codeweavers.com  Fri Apr  4 00:51:51 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 4 Apr 2008 14:51:51 +0900
Subject: hypertrm exported functions
References: <BAY109-W118E3C4B4EFACACD38FA6E87F60@phx.gbl>
	<47F5B1C2.9020101@kievinfo.com>
Message-ID: <000601c89617$fcc544e0$a600fea9@DMITRY>

"Vitaliy Margolen" <wine-devel at kievinfo.com> wrote:

> andre furtado wrote:
>> add documentation for exported functions of the win32 hypertrm library...
> Send all patches in unified diff format from the top of the source tree. 
> Drop all html content - plain text only please.
> 
> For more information read http://wiki.winehq.org/SubmittingPatches

The only problem left is that there is no hypertrm in the Wine tree...

-- 
Dmitry.


From xerox_xerox2000 at yahoo.co.uk  Fri Apr  4 01:06:48 2008
From: xerox_xerox2000 at yahoo.co.uk (Louis. Lenders)
Date: Fri, 4 Apr 2008 06:06:48 +0000 (GMT)
Subject: Question about LoadImageW and gifs (affects all new Autodesk
	installers)
Message-ID: <958661.76297.qm@web23206.mail.ird.yahoo.com>

Hi, does anyone know if LoadImageW is supposed to work with *.gif files? I'm asking because Autodesk installers seem to so something like 
LoadImageW(0,"c:\\foo.gif",IMAGE_BITMAP, 0, 0, LR_LOADFROMFILE)
and then wine just crashes later on, as it tries to get the bitmapinfo header , and ends up with wrong info for size of bitmapinfoheader, width, height etc. Anyone an idea why the installer would do such weird thing? See also http://bugs.winehq.org/show_bug.cgi?id=11784




      ___________________________________________________________ 
Yahoo! For Good helps you make a difference  

http://uk.promotions.yahoo.com/forgood/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080404/1b51f999/attachment-0001.htm 

From wine-devel at kievinfo.com  Fri Apr  4 01:13:02 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Fri, 04 Apr 2008 00:13:02 -0600
Subject: hypertrm exported functions
In-Reply-To: <000601c89617$fcc544e0$a600fea9@DMITRY>
References: <BAY109-W118E3C4B4EFACACD38FA6E87F60@phx.gbl>
	<47F5B1C2.9020101@kievinfo.com>
	<000601c89617$fcc544e0$a600fea9@DMITRY>
Message-ID: <47F5C6EE.7040207@kievinfo.com>

Dmitry Timoshkov wrote:
> "Vitaliy Margolen" <wine-devel at kievinfo.com> wrote:
> 
>> andre furtado wrote:
>>> add documentation for exported functions of the win32 hypertrm 
>>> library...
>> Send all patches in unified diff format from the top of the source 
>> tree. Drop all html content - plain text only please.
>>
>> For more information read http://wiki.winehq.org/SubmittingPatches
> 
> The only problem left is that there is no hypertrm in the Wine tree...
> 
Maybe he wants to write one? <g>

Vitaliy.


From pure_evil at mail.bg  Fri Apr  4 02:46:01 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Fri, 4 Apr 2008 10:46:01 +0300
Subject: Lug Radio Live 2008 wine talk. Slides online, comments welcome.
Message-ID: <200804041046.01798.pure_evil@mail.bg>

Woah, that's ubercool.
The presentation is excellent! However, you could add five collosal IMHO 
advantages of wine:

1. NO 1000 DISCONTINUED WIN VERSIONS

That's what largely made me dump 'doze and go for Linux - got 6 W98 licenses, 
and at some point, upgraded the hardware to discover that 98 doesn't support 
the new Mainboards. 
So I spent two days trying to get all the MBs replaced, managed to get '98 
running... And trust me, last thing you wanna do when you're in an empty new 
office is to extend a phone wire with a UTP wire to use the only connected 
atm phone socket to get dial-up working and with the collosal 5KBITS(!) per 
second to google out the only remaining in the PC store's warehouse mainboard 
to see if that supports '98, so you can call 'em and tell 'em "I'll 
take 'em". 
Oh, and you have to bring in your OWN PERSONAL machine to do that. The rest 
are basically a pile of mainboards which can't run '98 so they can't use the 
modem and so forth.

And then enter my favorite software provider, sees the new machines, claps his 
hands and says: 
"Cool, new machines! Now you get the new windows version of the soft, and, it 
requires XP! And since you are the only ones to use the DOS version, it's 
discontinued from now on.
Oh, and BTW? Your friendly local Samba server? 
Guess what, we're going MSSQL from now on, you need 1G of RAM on an XP 
machine... for 40 megs of databases."
So with a thousand pains me gets the damn thing working on 98 and sacrifices 
TWO NEW MACHINES for the SQL server(s)  and purchases TWO UNNECESSARY XP 
LICENSES - cuz two sets of databases, and, well, the express version doesn't 
support that.
And things get better: "Yeah, you got it running under '98. Guess what, we'll 
be using cutting-edge stuff from now on; Now it's MSShitQL 2005, when 
something new comes out, you'll be upgrading; And once my soft becomes 
fully '98 incompatible, THEN you scrap the 98 licenses and by new, XP ones."
"- But no money for licenses?" (1 XP = 1 new machine without monitor 
basically. Oh, and it has to be Professional)
"- Bah, go pirate. Everybody's doing it." 
(What does he mean by  on "cutting-edge stuff" BTW?! VISTA?! For an accounting 
database?!)

And every once in a while when there's a bug in his soft, he attributes it to 
98. Program closes but press ctrl-alt-del and you get a bunch of instances 
remaining? 98's fault. Slow? 98's fault. Crash due to an empty piece of 
database? "'98s fault". And of course, after 98s fault follows the 
natural "install XP".

Enter wine. Select windows version = XP. Work.

2.) No Premium Basic Home Server Client whatever. 

Enter wine. Work.

3.) Easy reinstall.
Delete "drive_c" and the reg files. "wineprefixcreate". Work.

4.) A 1000 windows on one machine.
~3 Megs per "drive_c". Work.

5.) Forget that "viruses under wine" stuff from days past, no, really. 
 - No startup! Hide all you like in the registry you piece of cr... spyware, I 
won't even know you got there, nor will you ever get started!
- No IE5678910! Yeah! Come and get me.
- What, no normally inaccessible (even to NOD32 at some point) "System Volume 
Information"? Where are you gonna hide (or rather, stay exposed frustrating 
me)?
- And where's the MBR of "drive_c"? in ".wine"?

All that combined is what makes me want to develop for wine.


From jonathan at ernstfamily.ch  Fri Apr  4 04:05:33 2008
From: jonathan at ernstfamily.ch (Jonathan Ernst)
Date: Fri, 04 Apr 2008 11:05:33 +0200
Subject: Lug Radio Live 2008 wine talk. Slides online, comments welcome.
In-Reply-To: <a71bd89a0804032026s2f87faa7v27641421c4e07ac1@mail.gmail.com>
References: <a71bd89a0804032026s2f87faa7v27641421c4e07ac1@mail.gmail.com>
Message-ID: <1207299933.6522.112.camel@jernst-desktop>

??Hello,

Le jeudi 03 avril 2008 ? 20:26 -0700, Dan Kegel a ?crit :
> [...]

> The slides are pretty basic; I'll talk a lot around them.
> If anybody feels like reviewing the slides
> and giving feedback, I'd appreciate it.


Slide 4 :

You might be interested to add some, government related, recent
migrations in Europe to this slide :

French Police ~70'000 seats
http://www.cnet.com/8301-13505_1-9861472-16.html

Geneva, Switzerland schools 9'000 seats
http://www.tdg.ch/pages/home/tribune_de_geneve/recherche/recherche_3_2_1/(contenu)/211880

http://www.google.com/translate?u=http%3A%2F%2Fwww.tdg.ch%2Fpages%2Fhome
%2Ftribune_de_geneve%2Frecherche%2Frecherche_3_2_1%2F(contenu)%
2F211880&langpair=fr|en&hl=fr&ie=UTF8

Slide 13 :

Maybe add "2008: Codeweavers releases Crossover Games"

I'm looking forward to hearing this second Wine related LugRadio.

Best regards.

Jonathan





From julliard at winehq.org  Fri Apr  4 04:50:51 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 04 Apr 2008 11:50:51 +0200
Subject: [1/6] qedit: Add test framework and test for
	IMediaDet_put_Filename.
In-Reply-To: <20080404005341.GH4608@linux.ucla.edu> (Dan Hipschman's message
	of "Thu, 3 Apr 2008 17:53:41 -0700")
References: <20080404005341.GH4608@linux.ucla.edu>
Message-ID: <87ve2yaqys.fsf@wine.dyndns.org>

Dan Hipschman <dsh at linux.ucla.edu> writes:

> This sets up some real tests for qedit using an actual AVI file to test
> with.  The resource is constructed from the AVI file by prepending the
> size so we know how big it is in the code.

That's ugly, you should use SizeofResource instead.

-- 
Alexandre Julliard
julliard at winehq.org


From xixsimplicityxix at gmail.com  Fri Apr  4 04:56:25 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 4 Apr 2008 04:56:25 -0500
Subject: Crossbuild patch, appropriate for wine?
Message-ID: <78a7dad00804040256q35948105gb5d52d9b975c8830@mail.gmail.com>

Hey the following patch eases cross compiling of the dlls that use
exceptions, its possible to work around this with scripts of course
but this makes it much cleaner to do so.  I wasnt sure if it was
appropriate to include such a modification in wine though.

This is based on what mingw does in its windef.h but I thought that
excpt.h was more appropriate.  See here for reference:
http://cygwin.com/cgi-bin/cvsweb.cgi/src/winsup/w32api/include/windef.h?rev=1.22&content-type=text/x-cvsweb-markup&cvsroot=src

With this patch the dlls that dont cross compile with wines headers are:
dbghelp
dnsapi
gdi32
glu32
icmp
iphlpapi
kernel32
msvcrt
ntdll
opengl32
rpcrt4
secur32
shell32
winex11.drv
wininet
winmm
ws2_32

Regards,

John Klehm


---
 include/excpt.h |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/include/excpt.h b/include/excpt.h
index 3369f3b..081fb06 100644
--- a/include/excpt.h
+++ b/include/excpt.h
@@ -46,6 +46,10 @@ typedef enum _EXCEPTION_DISPOSITION
 unsigned long __cdecl _exception_code(void);
 void * __cdecl _exception_info(void);
 int __cdecl _abnormal_termination(void);
+#elif defined(__GNUC__) && defined(USE_COMPILER_EXCEPTIONS)
+#define __try
+#define __except(x) while(0)
+#define __finally
 #endif /* defined(_MSC_VER) && defined(USE_COMPILER_EXCEPTIONS) */

 #endif /* __WINE_EXCPT_H */
--
1.5.4.5


From xixsimplicityxix at gmail.com  Fri Apr  4 05:06:43 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 4 Apr 2008 05:06:43 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <78a7dad00804021251o444fc651y4bd64648f0b2b0bd@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com> <20080325093948.145810@gmx.net>
	<78a7dad00803280405w3da1fd8dv383a1c7dc6688bfa@mail.gmail.com>
	<78a7dad00804021251o444fc651y4bd64648f0b2b0bd@mail.gmail.com>
Message-ID: <78a7dad00804040306t38ddd698i46b2423c7138888a@mail.gmail.com>

On Wed, Apr 2, 2008 at 2:51 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> On Fri, Mar 28, 2008 at 6:05 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  >
>  >  Well let me know how this works for you.  I'll refactor my script a
>  >  bit later today but for right now you have to run this one after the
>  >  winetest script, as this one counts on the environment that the
>
>  Here's the refactored script [1].  With some inspiration from winetricks ;)
>
>  Example uses:
>  $crossbuild_tricks winetest
>
>  $crossbuild_tricks d3d
>  => builds d3d8,d3d9,wined3d, libwine
>
>  $crossbuild_tricks test cabinet
>  => use test verb for individual tests
>
>  $crossbuild_tricks dll wintrust
>  => use dll verb for individual dlls
>
>
>  First release and I've tested it some, seems to work but let me know
>  if it breaks for you.
>
>
>  Regards,
>  John
>
>  [1] http://klehm.net/wine/crossbuild_tricks.sh
>

Updated version of crossbuild_tricks:
http://klehm.net/wine/crossbuild_tricks.sh

Changes:

-improved build time: builds only the minimum required targets now.

New verbs:
libs   => build just the import libs (*.a).  Puts them in
wine-pe/libs/wine as usual.
alldlls => build all possible dlls.  Copies them to wine-pe/binaries
for easy downloading.

Dlls known not to cross build:
dbghelp
dnsapi
gdi32
glu32
icmp
iphlpapi
kernel32
msvcrt
ntdll
opengl32
rpcrt4
secur32
shell32
winex11.drv
wininet
winmm
ws2_32

distclean =>  clean up the wine-native and wine-pe dirs and run
distclean in wine-src (a "wash me clean of this dirty script" verb ;)


Use the patch I sent in the other mail that adds mingw like no op
exception stuff if you really need to cross build crypt32 (maybe
others) that complain about missing __try etc.

Any problems let me know.

Enjoy,
John


From mle+win at mega-nerd.com  Fri Apr  4 06:03:35 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Fri, 4 Apr 2008 22:03:35 +1100
Subject: Bug in MSVCRT_fseek (with patch)
Message-ID: <20080404220335.ca47d856.mle+win@mega-nerd.com>

Hi all,

I think I have found a bug in MSVCRT_fseek. If I fread() to the end
of a file, then do fseek (file, 0, SEEK_SET), the feof() function
still returns true.

According to the ISO standard

  A successful call to fseek() shall clear the end-of-file indicator
  for the stream and undo any effects of ungetc() and ungetwc() on
  the same stream. After an fseek() call, the next operation on an
  update stream may be either input or output.

The following patch to dlls/msvcrt/file.c fixes the issue. I also
have a small standalone test program below that fails before the
patch and passes after.

Cheers,
Erik

The patch:
-------------8<-------------8<-------------8<-------------8<-------------
--- a/dlls/msvcrt/file.c
+++ b/dlls/msvcrt/file.c
@@ -918,6 +918,8 @@ int CDECL MSVCRT_fseek(MSVCRT_FILE* file, long offset, int whence)
   if(file->_flag & MSVCRT__IORW) {
         file->_flag &= ~(MSVCRT__IOREAD|MSVCRT__IOWRT);
   }
+  /* Clear end of file */
+  file->_flag &= ~MSVCRT__IOEOF;
   return (_lseek(file->_file,offset,whence) == -1)?-1:0;
 }
 
-------------8<-------------8<-------------8<-------------8<-------------

The test program:
-------------8<-------------8<-------------8<-------------8<-------------
#include <stdio.h>
#include <stdlib.h>
#include <stdarg.h>

static void
error_exit (const char * fmt, ...)
{
	va_list ap ;
	va_start (ap,  fmt) ;
	vprintf (fmt, ap) ;
	va_end (ap) ;

	exit (1) ;
} /* error_exit */

int
main (void)
{	const char * filename = "test.dat" ;
	char buffer [12] ;
	FILE * file ;

	/* Create a short data file. */
	if ((file = fopen (filename, "w")) == NULL)
		error_exit ("Error on line %d : fopen\n", __LINE__) ;
	fputs("abcdefghaiklmnopqrstuvwxyz\n", file) ;
	fclose (file) ;

	/* Now read the file. */
	if ((file = fopen (filename, "r")) == NULL)
		error_exit ("Line %d : fopen\n", __LINE__) ;

	while (fread (buffer, sizeof (buffer), 1, file) > 0)
		(void) 0 ;

	if (! feof (file))
		error_exit ("Error on line %d : feof should return true.\n", __LINE__) ;

	fseek (file, 0, SEEK_SET) ;

	if (feof (file))
		error_exit ("Error on line %d : feof should return false.\n", __LINE__) ;

	fclose (file) ;

	remove (filename) ;

	return 0 ;
} /* main */
-------------8<-------------8<-------------8<-------------8<-------------

-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"C++ has its place in the history of programming languages. Just
as Caligula has his place in the history of the Roman Empire."
-- Robert Firth


From dank at kegel.com  Fri Apr  4 06:06:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 4 Apr 2008 04:06:30 -0700
Subject: Bug in MSVCRT_fseek (with patch)
Message-ID: <a71bd89a0804040406r610fe4d6q25e217b9a456505@mail.gmail.com>

Does your test also pass on Windows?

How did you run into this -- does the bug keep a real Windows
app from running on Wine?  Which one?

To get your change and test accepted, please send a patch,
and make the test a real wine conformance test.
- Dan


From julliard at winehq.org  Fri Apr  4 06:19:59 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 04 Apr 2008 13:19:59 +0200
Subject: [PATCH 4/4] configure.ac: Add support for MSVC.
In-Reply-To: <47F60D0C.20209@codeweavers.com> (Robert Shearman's message of
	"Fri, 04 Apr 2008 12:12:12 +0100")
References: <47F60D0C.20209@codeweavers.com>
Message-ID: <87r6dlc1eo.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> MSVC needs a lot more in the way of rule changes and/or helper scripts
> for it to work properly, but this is a good start.

I'm not sure I see the point. You can't really run configure or make on
an MSVC setup anyway. It seems to me that something like msvcmaker is a
better solution.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Fri Apr  4 06:36:57 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 04 Apr 2008 12:36:57 +0100
Subject: [PATCH 4/4] configure.ac: Add support for MSVC.
In-Reply-To: <87r6dlc1eo.fsf@wine.dyndns.org>
References: <47F60D0C.20209@codeweavers.com> <87r6dlc1eo.fsf@wine.dyndns.org>
Message-ID: <47F612D9.4060000@codeweavers.com>

Alexandre Julliard wrote:
> Robert Shearman <rob at codeweavers.com> writes:
>   
>> MSVC needs a lot more in the way of rule changes and/or helper scripts
>> for it to work properly, but this is a good start.
>>     
>
> I'm not sure I see the point. You can't really run configure or make on
> an MSVC setup anyway.

Well, you can. MSVC can be run in wine and you can install a Win32 port 
of sh to run configure on Windows and all of our configure tests work.

> It seems to me that something like msvcmaker is a
> better solution.

Yes, you're right. I wish I'd known about the purpose of this tool 
before I went down the route that I did...

-- 
Rob Shearman



From rob at codeweavers.com  Fri Apr  4 06:47:17 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 04 Apr 2008 12:47:17 +0100
Subject: Crossbuild patch, appropriate for wine?
In-Reply-To: <78a7dad00804040256q35948105gb5d52d9b975c8830@mail.gmail.com>
References: <78a7dad00804040256q35948105gb5d52d9b975c8830@mail.gmail.com>
Message-ID: <47F61545.4040709@codeweavers.com>

John Klehm wrote:
> diff --git a/include/excpt.h b/include/excpt.h
> index 3369f3b..081fb06 100644
> --- a/include/excpt.h
> +++ b/include/excpt.h
> @@ -46,6 +46,10 @@ typedef enum _EXCEPTION_DISPOSITION
>  unsigned long __cdecl _exception_code(void);
>  void * __cdecl _exception_info(void);
>  int __cdecl _abnormal_termination(void);
> +#elif defined(__GNUC__) && defined(USE_COMPILER_EXCEPTIONS)
> +#define __try
> +#define __except(x) while(0)
> +#define __finally
>  #endif /* defined(_MSC_VER) && defined(USE_COMPILER_EXCEPTIONS) */
>
>  #endif /* __WINE_EXCPT_H */
>   

Actually, I think the best place to fix this is in 
include/wine/exception.h. I also think it would be better to use 
"defined(__MINGW32__) && !defined(USE_COMPILER_EXCEPTIONS)." This is 
because that is the platform that can't use the exception macros 
implemented on top of sigsetjmp, and if the developer defines 
"USE_COMPILER_EXCEPTIONS" then it is telling us that their compiler 
supports __try, __except and __finally (there have been custom builds of 
MinGW that include support for native exception handling).

-- 
Rob Shearman



From mle+win at mega-nerd.com  Fri Apr  4 06:56:33 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Fri, 4 Apr 2008 22:56:33 +1100
Subject: Bug in MSVCRT_fseek (with patch)
In-Reply-To: <200804041536.54810.lich@math.spbu.ru>
References: <200804041536.54810.lich@math.spbu.ru>
Message-ID: <20080404225633.f64fddd8.mle+win@mega-nerd.com>

Kirill K. Smirnov wrote:

> What if you try to fseek to the end of file (SEEK_END)? Should IOEOF flag be 
> cleared in this case?

I believe that for a standards conforming fseek it should be. See:

    http://www.opengroup.org/onlinepubs/000095399/functions/fseek.html

For standards conforming behaviour fseek(f,0,SEEK_END) clears the
flag, and the next fread will return 0 and set it again.

However, I realize that for wine, the standards are pretty much
moot as wine attempts to be bug compatible with windows. Obviously
some more testing (on windows and wine) is required.

> And may _lseek() function be better place for this?

I don't think so. _lseek keeps its own flags.

Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"C++ is like jamming a helicopter inside a Miata and expecting
some sort of improvement." -- Drew Olbrich


From mle+win at mega-nerd.com  Fri Apr  4 06:23:02 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Fri, 4 Apr 2008 22:23:02 +1100
Subject: Bug in MSVCRT_fseek (with patch)
In-Reply-To: <a71bd89a0804040406r610fe4d6q25e217b9a456505@mail.gmail.com>
References: <a71bd89a0804040406r610fe4d6q25e217b9a456505@mail.gmail.com>
Message-ID: <20080404222302.b6494332.mle+win@mega-nerd.com>

Dan Kegel wrote:

> Does your test also pass on Windows?

I didn't try this actual test on windows because I don't have
easy access to windows. However ....

> How did you run into this -- does the bug keep a real Windows
> app from running on Wine?  Which one?

That gets complicated. I'm on Linux, cross compiling to windows
using the mingw cross compiler and running the test suite on
wine. One of the test programs was failing under wine but it did
pass on windows xp. I tracked it down to this incorrect behaviour
of the feof function.

> To get your change and test accepted, please send a patch,
> and make the test a real wine conformance test.

Sure. I'll bang on this some more.

Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
Being really good at C++ is like being really good at using rocks to
sharpen sticks." -- Thant Tessman


From julliard at winehq.org  Fri Apr  4 07:21:42 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 04 Apr 2008 14:21:42 +0200
Subject: Crossbuild patch, appropriate for wine?
In-Reply-To: <47F61545.4040709@codeweavers.com> (Robert Shearman's message of
	"Fri, 04 Apr 2008 12:47:17 +0100")
References: <78a7dad00804040256q35948105gb5d52d9b975c8830@mail.gmail.com>
	<47F61545.4040709@codeweavers.com>
Message-ID: <87myo9byjt.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> Actually, I think the best place to fix this is in 
> include/wine/exception.h. I also think it would be better to use 
> "defined(__MINGW32__) && !defined(USE_COMPILER_EXCEPTIONS)." This is 
> because that is the platform that can't use the exception macros 
> implemented on top of sigsetjmp, and if the developer defines 
> "USE_COMPILER_EXCEPTIONS" then it is telling us that their compiler 
> supports __try, __except and __finally (there have been custom builds of 
> MinGW that include support for native exception handling).

I don't think we want to disable exceptions, that will just lead to
broken builds. It should be possible to make the sigsetjmp variant work
for MinGW.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Fri Apr  4 07:52:50 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 04 Apr 2008 13:52:50 +0100
Subject: Crossbuild patch, appropriate for wine?
In-Reply-To: <87myo9byjt.fsf@wine.dyndns.org>
References: <78a7dad00804040256q35948105gb5d52d9b975c8830@mail.gmail.com>	<47F61545.4040709@codeweavers.com>
	<87myo9byjt.fsf@wine.dyndns.org>
Message-ID: <47F624A2.6070401@codeweavers.com>

Alexandre Julliard wrote:
> Robert Shearman <rob at codeweavers.com> writes:
>   
>> Actually, I think the best place to fix this is in 
>> include/wine/exception.h. I also think it would be better to use 
>> "defined(__MINGW32__) && !defined(USE_COMPILER_EXCEPTIONS)." This is 
>> because that is the platform that can't use the exception macros 
>> implemented on top of sigsetjmp
>>     
>
> I don't think we want to disable exceptions, that will just lead to
> broken builds. It should be possible to make the sigsetjmp variant work
> for MinGW.

You can make it compile by using sigjmp instead of sigsetjmp, but 
there's not much point because the code depends on Wine-only functions 
in ntdll that aren't available on Windows and so would cause the DLLs 
not to load.

-- 
Rob Shearman



From lich at math.spbu.ru  Fri Apr  4 06:36:54 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Fri, 4 Apr 2008 14:36:54 +0300
Subject: Bug in MSVCRT_fseek (with patch)
Message-ID: <200804041536.54810.lich@math.spbu.ru>

Hi,

>  A successful call to fseek() shall clear the end-of-file indicator
>  for the stream and undo any effects of ungetc() and ungetwc() on
>  the same stream. After an fseek() call, the next operation on an
>  update stream may be either input or output.

>   }
>+  /* Clear end of file */
>+  file->_flag &= ~MSVCRT__IOEOF;
>   return (_lseek(file->_file,offset,whence) == -1)?-1:0;

What if you try to fseek to the end of file (SEEK_END)? Should IOEOF flag be 
cleared in this case? And may _lseek() function be better place for this?

Current _lseeki64() implementation contains FIXME concerning the same issue:
    MSVCRT_fdesc[fd].wxflag &= ~(WX_ATEOF|WX_READEOF);
    /* FIXME: What if we seek _to_ EOF - is EOF set? */

--
Kirill


From julliard at winehq.org  Fri Apr  4 08:13:52 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 04 Apr 2008 15:13:52 +0200
Subject: Crossbuild patch, appropriate for wine?
In-Reply-To: <47F624A2.6070401@codeweavers.com> (Robert Shearman's message of
	"Fri, 04 Apr 2008 13:52:50 +0100")
References: <78a7dad00804040256q35948105gb5d52d9b975c8830@mail.gmail.com>
	<47F61545.4040709@codeweavers.com> <87myo9byjt.fsf@wine.dyndns.org>
	<47F624A2.6070401@codeweavers.com>
Message-ID: <87iqyxbw4v.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> Alexandre Julliard wrote:
>> I don't think we want to disable exceptions, that will just lead to
>> broken builds. It should be possible to make the sigsetjmp variant work
>> for MinGW.
>
> You can make it compile by using sigjmp instead of sigsetjmp, but
> there's not much point because the code depends on Wine-only functions
> in ntdll that aren't available on Windows and so would cause the DLLs
> not to load.

Yes, but the functions could be moved to winecrt0 or something like that
and get statically linked into the dll.

-- 
Alexandre Julliard
julliard at winehq.org


From dmitry at codeweavers.com  Fri Apr  4 08:24:33 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 4 Apr 2008 22:24:33 +0900
Subject: [PATCH] user32: on VK_RETURN, send WM_COMMAND to ancestor,
	not parent.
References: <558b2f5c0804040020w77698ed0v324e7dbae792098b@mail.gmail.com>
Message-ID: <00a901c89657$3abcc4f0$a600fea9@DMITRY>

"Lei Zhang" <thestig at google.com> wrote:

> I noticed I can no longer install an application which uses the NSIS
> installer by repeatedly hitting enter until it finished. I did some
> testing and it looks like for VK_RETURN, we should be sending
> WM_COMMAND to the ancestor, and not the parent.

Was edit control reparented at some point? Perhaps WM_COMMAND should be
sent to an original parent?

-- 
Dmitry.


From rob at codeweavers.com  Fri Apr  4 08:35:34 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 04 Apr 2008 14:35:34 +0100
Subject: Crossbuild patch, appropriate for wine?
In-Reply-To: <87iqyxbw4v.fsf@wine.dyndns.org>
References: <78a7dad00804040256q35948105gb5d52d9b975c8830@mail.gmail.com>	<47F61545.4040709@codeweavers.com>
	<87myo9byjt.fsf@wine.dyndns.org>	<47F624A2.6070401@codeweavers.com>
	<87iqyxbw4v.fsf@wine.dyndns.org>
Message-ID: <47F62EA6.4030204@codeweavers.com>

Alexandre Julliard wrote:
> Robert Shearman <rob at codeweavers.com> writes:
>   
>> Alexandre Julliard wrote:
>>     
>>> I don't think we want to disable exceptions, that will just lead to
>>> broken builds. It should be possible to make the sigsetjmp variant work
>>> for MinGW.
>>>       
>> You can make it compile by using sigjmp instead of sigsetjmp, but
>> there's not much point because the code depends on Wine-only functions
>> in ntdll that aren't available on Windows and so would cause the DLLs
>> not to load.
>>     
>
> Yes, but the functions could be moved to winecrt0 or something like that
> and get statically linked into the dll.

In the past, I tried using our implementation of 
__wine_exception_handler on Windows, but it crashes in these three lines:
>     RtlUnwind( frame, 0, record, 0 );
>     __wine_pop_frame( frame );
>     siglongjmp( wine_frame->jmp, 1 );

The reason is that RtlUnwind clears all general purpose registers (and 
maybe changes esp/ebp) so that frame is no longer valid. There may be a 
way to work around this, but I'm not sure.

-- 
Rob Shearman



From talk2cod at hotmail.com  Fri Apr  4 09:31:23 2008
From: talk2cod at hotmail.com (andre furtado)
Date: Fri, 4 Apr 2008 14:31:23 +0000
Subject: xenroll exported functions
Message-ID: <BAY109-W304CEA8B4A519C11C8A81D87F60@phx.gbl>


add documentation for exported functions of the xenroll library...
IEnroll * WINAPI PIEnrollGetNoCOM(void)*/ returns a pointer to an IEnroll interface. */IEnroll2 * WINAPI PIEnroll2GetNoCOM(void)*/ returns a pointer to an IEnroll2 interface. */IEnroll4 * WINAPI PIEnroll4GetNoCOM(void)*/ returns a pointer to an IEnroll4 interface. */
                           Andr? Renato Furtado                                              talk2cod at hotmail.com
_________________________________________________________________
Receba GR?TIS as mensagens do Messenger no seu celular quando voc? estiver offline. Conhe?a  o MSN Mobile!
http://mobile.live.com/signup/signup2.aspx?lc=pt-br
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080404/30b87c59/attachment.htm 

From thestig at google.com  Fri Apr  4 09:47:05 2008
From: thestig at google.com (Lei Zhang)
Date: Fri, 4 Apr 2008 07:47:05 -0700
Subject: [PATCH] user32: on VK_RETURN, send WM_COMMAND to ancestor,
	not parent.
In-Reply-To: <00a901c89657$3abcc4f0$a600fea9@DMITRY>
References: <558b2f5c0804040020w77698ed0v324e7dbae792098b@mail.gmail.com>
	<00a901c89657$3abcc4f0$a600fea9@DMITRY>
Message-ID: <558b2f5c0804040747s3eb841cfma07c0b6ca236e8c1@mail.gmail.com>

On Fri, Apr 4, 2008 at 6:24 AM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
>
> "Lei Zhang" <thestig at google.com> wrote:
>
>
> > I noticed I can no longer install an application which uses the NSIS
> > installer by repeatedly hitting enter until it finished. I did some
> > testing and it looks like for VK_RETURN, we should be sending
> > WM_COMMAND to the ancestor, and not the parent.
> >
>
>  Was edit control reparented at some point? Perhaps WM_COMMAND should be
>  sent to an original parent?
>
>  --
>  Dmitry.
>

The edit control is the child of a dialog box bar, which is in turn
the child of another dialog box foo. SetParent() is not involved, if
that's what you mean.

- Lei


From stefandoesinger at gmx.at  Fri Apr  4 10:16:58 2008
From: stefandoesinger at gmx.at (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Fri, 4 Apr 2008 17:16:58 +0200
Subject: XDC 2008 wishlist
Message-ID: <200804041716.58458.stefandoesinger@gmx.at>

Hi,

My travel to XDC 2008 is finalized now, I am collecting the topics I should 
bring up there. I already have these:

*) Mouse input handling. I've CC'ed Vitaliy. All I know so far is that Vitaliy 
said opening the core pointer as XInput device would be good. Vitaliy, do you 
have any proof of concept code / test apps? Do you have time to discuss the 
details? I think this is the most important topic, and I don't know anything 
about it, so I should be well-prepared.

*) Tablet support. Dan mentioned something about it, but I have no details.

*) Graphics support: I'll talk to the X11 devs about including the wine d3d 
tests in their driver QA. Lobby for widespread support of some rare 
extensions(GL_NV_half_float) and help on adding some others, like for the 
flat shading issue. Others?

*) Discuss the opportunities we have with DRI2

Does anyone have other items?


From dmitry at codeweavers.com  Fri Apr  4 11:14:27 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 5 Apr 2008 01:14:27 +0900
Subject: [PATCH] user32: on VK_RETURN, send WM_COMMAND to ancestor,
	not parent.
References: <558b2f5c0804040020w77698ed0v324e7dbae792098b@mail.gmail.com><00a901c89657$3abcc4f0$a600fea9@DMITRY>
	<558b2f5c0804040747s3eb841cfma07c0b6ca236e8c1@mail.gmail.com>
Message-ID: <018501c8966e$f65e4000$a600fea9@DMITRY>

"Lei Zhang" <thestig at google.com> wrote:

> The edit control is the child of a dialog box bar, which is in turn
> the child of another dialog box foo. SetParent() is not involved, if
> that's what you mean.

Seems that's not the case then, from your test it looks more like
a WM_COMMAND forwarding from a child dialog to the parent one.

-- 
Dmitry.


From tony.wasserka at freenet.de  Fri Apr  4 11:14:57 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Fri, 04 Apr 2008 18:14:57 +0200
Subject: Windows 7
Message-ID: <E1JhoZ7-0002Vl-HB@www19.emo.freenet-rz.de>

I read an interesting article on slashdot today:
http://tech.slashdot.org/tech/08/04/04/1437258.shtml
> Windows 7 will be a from-the-ground-up packaging of the Windows codebase; partially source,
> but not binary compatible with previous versions of Windows."

Sounds like they  format, i.e. maybe they use sth. other than PE then.
But even if they don't, I guess this could be a problem for the existing wine codebase
and require some infrastructural changes to it.
However, I don't know much about these things though and it's possible that I'm completely wrong, but
I though I'd just post this to wine-devel in case anybody is interested.
Feel free to discuss, or not to discuss, do whatever you want with this information ;-)

Maybe we're lucky and people turn away from windows completely this time and we don't even need to care
about Windows 7 xD
(though this is unlikely to happen, but dreams never die...)


Best regards,
    Tony



Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain inkl.
http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/index.html



From brianmarete at gmail.com  Fri Apr  4 11:36:26 2008
From: brianmarete at gmail.com (Brian Gitonga Marete)
Date: Fri, 4 Apr 2008 19:36:26 +0300
Subject: Making Yahoo Messenger Work
Message-ID: <6dd519ae0804040936h3f66c030sbc4c678fb2dd1311@mail.gmail.com>

Hello,

I am interested in making the latest versions of Yahoo Messenger work
under Wine.

Currently, an attempt to log in results in some errors about the RAS
API, and Log in never succeeds.

If someone (after attempting a run of the application under the latest
version of Wine) could point me (even generally) to those parts of the
Windows API Wine needs to allow Yahoo Messenger to work, I would be
willing to do the work of implementing the necessary parts of the
Win32 API myself.

In this regard, I am especially interested that the Audio/Video chat
aspects of Yahoo Messenger should work under Wine.

Thanks,
-- 
B. Gitonga Marete
Tel: +254-722-151-590


From thunderbird2k at gmx.net  Fri Apr  4 11:55:03 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Fri, 04 Apr 2008 18:55:03 +0200
Subject: XDC 2008 wishlist
In-Reply-To: <200804041716.58458.stefandoesinger@gmx.at>
References: <200804041716.58458.stefandoesinger@gmx.at>
Message-ID: <20080404165503.107670@gmx.net>

> Hi,
> 
> My travel to XDC 2008 is finalized now, I am collecting the topics I
> should 
> bring up there. I already have these:
> 
> *) Mouse input handling. I've CC'ed Vitaliy. All I know so far is that
> Vitaliy 
> said opening the core pointer as XInput device would be good. Vitaliy, do
> you 
> have any proof of concept code / test apps? Do you have time to discuss
> the 
> details? I think this is the most important topic, and I don't know
> anything 
> about it, so I should be well-prepared.
> 
> *) Tablet support. Dan mentioned something about it, but I have no
> details.
> 
> *) Graphics support: I'll talk to the X11 devs about including the wine
> d3d 
> tests in their driver QA. Lobby for widespread support of some rare 
> extensions(GL_NV_half_float) and help on adding some others, like for the 
> flat shading issue. Others?
> 
> *) Discuss the opportunities we have with DRI2
> 
> Does anyone have other items?
> 

Most xorg devs aren't a big fan of pbuffers but they are part of the GLX 1.3 spec which drivers want to support these days. Some drivers are considering to just fail on pbuffer creation. Encourage them to offer pbuffer support on some visuals/fbconfigs. A lot of windows apps rely on their presence including Wow in opengl32 mode and lots of other (older) programs.

Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.gmx.net/de/entertainment/games/free


From dank at kegel.com  Fri Apr  4 12:32:35 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 4 Apr 2008 10:32:35 -0700
Subject: XDC 2008 wishlist
Message-ID: <a71bd89a0804041032r65e6bcd3w4d9b61b566c10364@mail.gmail.com>

On tablet support:

1) users should never, ever have to edit xorg.conf, but
this is still needed when adding some graphics tablets.

2) users should never, ever have to compile their own
drivers, but this is still required when using some graphics
tablets.   See e.g.
https://help.ubuntu.com/community/TabletSetupWizardpen

This is something that Photoshop-on-Wine users are
actually running into.  I don't know how common it is, but
if I've already heard about it once, it's probably not rare.
- Dan


From dank at kegel.com  Fri Apr  4 12:47:40 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 4 Apr 2008 10:47:40 -0700
Subject: Lots of valgrind errors in gdi32/tests/font.c
Message-ID: <a71bd89a0804041047p3aad3c03m1e508c4e8d617d4@mail.gmail.com>

Today's valgrind run shows a bunch more valgrind warnings in gdi32/tests/font.c:
http://kegel.com/wine/valgrind/logs-2008-04-04/vg-gdi32_font-diff.txt
e.g.

+ Use of uninitialised value of size 4
+    at  HEAP_CreateFreeBlock (heap.c:502)
+    by  HEAP_MakeInUseBlockFree (heap.c:538)
+    by  RtlFreeHeap (heap.c:1294)
+    by  GDI_FreeObject (gdiobj.c:731)
+    by  FONT_DeleteObject (font.c:554)
+    by  DeleteObject (gdiobj.c:854)
+    by  enum_truetype_font_proc (font.c:1602)
+    by  FONT_EnumInstance (font.c:589)
+    by  WineEngEnumFonts (freetype.c:3761)
+    by  FONT_EnumFontFamiliesEx (font.c:626)
+    by  EnumFontFamiliesExA (font.c:664)
+    by  func_font (font.c:1744)
+    by  run_test (test.h:406)
+    by  main (test.h:455)
...
+ Conditional jump or move depends on uninitialised value(s)
+    at  RtlAllocateHeap (heap.c:1204)
+    by  WineEngGetOutlineTextMetrics (freetype.c:4831)
+    by  WineEngGetTextMetrics (freetype.c:4720)
+    by  GetTextMetricsW (font.c:1158)
+    by  X11DRV_XRender_SelectFont (xrender.c:433)
+    by  X11DRV_SelectFont (xfont.c:3216)
+    by  FONT_SelectObject (font.c:497)
+    by  SelectObject (gdiobj.c:1129)
+    by  enum_truetype_font_proc (font.c:1579)
+    by  FONT_EnumInstance (font.c:589)
+    by  WineEngEnumFonts (freetype.c:3761)
+    by  FONT_EnumFontFamiliesEx (font.c:626)
+    by  EnumFontFamiliesExA (font.c:664)
+    by  func_font (font.c:1744)
+    by  run_test (test.h:406)
+    by  main (test.h:455)

I don't think these are actually new; errors like them have
been around, they just got triggered more with a new test
that was added.   It always worries me when heap
routines start showing up in valgrind dumps, though;
it'd be nice if somebody could take a look at this.
- Dan


From thestig at google.com  Fri Apr  4 12:50:35 2008
From: thestig at google.com (Lei Zhang)
Date: Fri, 4 Apr 2008 10:50:35 -0700
Subject: Documentation is still in CVS?
In-Reply-To: <658075.98811.qm@web23105.mail.ird.yahoo.com>
References: <558b2f5c0804031514u3f093c85u3ed8ca9a5ecfe5ac@mail.gmail.com>
	<658075.98811.qm@web23105.mail.ird.yahoo.com>
Message-ID: <558b2f5c0804041050n26a669b4ude698d41db65e31c@mail.gmail.com>

On Fri, Apr 4, 2008 at 8:35 AM, Hin-Tak Leung <hintak_leung at yahoo.co.uk> wrote:
>  Doesn't work for me:
>
>  $ cvs -z3 -d:pserver:anonymous at wine.cvs.sourceforge.net:/cvsroot/wine co -P docs
>  cvs [checkout aborted]: connect to [wine.cvs.sourceforge.net]:2401 failed: Connection timed out
>
>  $ git cvsimport -C wine-doc -v -k -d :pserver:anonymous at wine.cvs.sourceforge.net:/cvsroot/wine docs
>  Socket to wine.cvs.sourceforge.net: Connection timed out
>
>  I'll need to try stunnel and see if it improves things. (but I can still check out stuff from other sourceforge projects...)
>

Firewall issue on your side? Can you ping wine.cvs.sourceforge.net?
Connect to it on port 80? or port 2401?


From talk2cod at hotmail.com  Fri Apr  4 12:50:55 2008
From: talk2cod at hotmail.com (andre furtado)
Date: Fri, 4 Apr 2008 17:50:55 +0000
Subject: softpub exported functions prototypes
Message-ID: <BAY109-W528BB638B6A34A628701B787F60@phx.gbl>


add softpub exported functions prototypes... HRESULT  WINAPI GenericChainCertificateTrust(IN OUT PCRYPT_PROVIDER_DATA pProvData)HRESULT WINAPI GenericChainFinalProv(IN OUT PCRYPT_PROVIDER_DATA pProvData)HRESULT WINAPI HTTPSCertificateTrust(CRYPT_PROVIDER_DATA *pProvData)HRESULT WINAPI SoftpubDefCertInit(CRYPT_PROVIDER_DATA *pProvData)BOOL WINAPI SoftpubFreeDefUsageCallData(const char *pszUsageOID, CRYPT_PROVIDER_DEFUSAGE *psDefUsage)BOOL WINAPI SoftpubLoadDefUsageCallData(const char *pszUsageOID, CRYPT_PROVIDER_DEFUSAGE *psDefUsage)BOOL CALLBACK AddPersonalTrustDBPages(LPVOID lpv, LPFNADDPROPSHEETPAGE lpfnAddPage, LPARAM lParam) HRESULT WINAPI DriverCleanupPolicy(CRYPT_PROVIDER_DATA *pProvData)HRESULT WINAPI DriverFinalPolicy(CRYPT_PROVIDER_DATA *pProvData)HRESULT WINAPI DriverInitializePolicy(CRYPT_PROVIDER_DATA *pProvData)HRESULT WINAPI HTTPSFinalProv(CRYPT_PROVIDER_DATA *pProvData)HRESULT WINAPI OfficeCleanupPolicy(CRYPT_PROVIDER_DATA *pProvData)HRESULT WINAPI OfficeInitializePolicy(CRYPT_PROVIDER_DATA *pProvData)BOOL WINAPI OpenPersonalTrustDBDialog(HWND hWnd)HRESULT WINAPI OfficeInitializePolicy(CRYPT_PROVIDER_DATA *pProvData)HRESULT WINAPI SoftpubAuthenticode(CRYPT_PROVIDER_DATA *pProvData)BOOL WINAPI SoftpubCheckCert(CRYPT_PROVIDER_DATA *pProvData, DWORD idxSigner, BOOL fCounterSignerChain, DWORD idxCounterSigner)HRESULT WINAPI SoftpubCleanup(CRYPT_PROVIDER_DATA *pProvData)HRESULT WINAPI SoftpubDumpStructure(CRYPT_PROVIDER_DATA *pProvData)HRESULT WINAPI SoftpubInitialize(CRYPT_PROVIDER_DATA *pProvData)HRESULT WINAPI SoftpubLoadMessage(CRYPT_PROVIDER_DATA *pProvData)HRESULT SoftpubLoadSignature(CRYPT_PROVIDER_DATA *pProvData)HRESULT WINAPI FindCertsByIssuer(OUT PCERT_CHAIN pCertChains, IN OUT DWORD *pcbCertChains, OUT DWORD *pcCertChains, IN BYTE* pbEncodedIssuerName, IN DWORD cbEncodedIssuerName, IN LPCWSTR pwszPurpose, IN DWORD dwKeySpec)     Andr? Renato Furtado       talk2cod at hotmail.com
_________________________________________________________________
Conhe?a o Windows Live Spaces, a rede de relacionamentos do Messenger!
http://www.amigosdomessenger.com.br/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080404/8d107b0c/attachment.htm 

From thestig at google.com  Fri Apr  4 13:11:15 2008
From: thestig at google.com (Lei Zhang)
Date: Fri, 4 Apr 2008 11:11:15 -0700
Subject: [PATCH] user32: on VK_RETURN, send WM_COMMAND to ancestor,
	not parent.
In-Reply-To: <018501c8966e$f65e4000$a600fea9@DMITRY>
References: <558b2f5c0804040020w77698ed0v324e7dbae792098b@mail.gmail.com>
	<00a901c89657$3abcc4f0$a600fea9@DMITRY>
	<558b2f5c0804040747s3eb841cfma07c0b6ca236e8c1@mail.gmail.com>
	<018501c8966e$f65e4000$a600fea9@DMITRY>
Message-ID: <558b2f5c0804041111v2daf31e4sbbf874e4424c1be4@mail.gmail.com>

On Fri, Apr 4, 2008 at 9:14 AM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> "Lei Zhang" <thestig at google.com> wrote:
>
>
> > The edit control is the child of a dialog box bar, which is in turn
> > the child of another dialog box foo. SetParent() is not involved, if
> > that's what you mean.
> >
>
>  Seems that's not the case then, from your test it looks more like
>  a WM_COMMAND forwarding from a child dialog to the parent one.
>
>  --
>  Dmitry.
>

I'm pretty sure the parent dialog is getting the WM_COMMAND directly.
It is not the case where the child dialog gets a WM_COMMAND, and
forwards it to its parent.

Running the test on Windows, the child dialog gets two WM_COMMANDS -
EN_SETFOCUS and EN_KILLFOCUS. Then the parent dialog gets WM_COMMAND
with IDOK.

- Lei


From wine-devel at kievinfo.com  Fri Apr  4 13:16:12 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Fri, 04 Apr 2008 12:16:12 -0600
Subject: XDC 2008 wishlist
In-Reply-To: <20080404165503.107670@gmx.net>
References: <200804041716.58458.stefandoesinger@gmx.at>
	<20080404165503.107670@gmx.net>
Message-ID: <47F6706C.3070205@kievinfo.com>

Roderick Colenbrander wrote:
>> Hi,
>>
>> My travel to XDC 2008 is finalized now, I am collecting the topics I
>> should 
>> bring up there. I already have these:
>>
>> *) Mouse input handling. I've CC'ed Vitaliy. All I know so far is that
>> Vitaliy 
>> said opening the core pointer as XInput device would be good. Vitaliy, do
>> you 
>> have any proof of concept code / test apps? Do you have time to discuss
>> the 
>> details? I think this is the most important topic, and I don't know
>> anything 
>> about it, so I should be well-prepared.

I don't have any code for this unfortunately.

What Wine needs is the physical mouse movement events, that work even when 
pointer itself "stuck" on the window/screen border. This should also work 
for the entire desktop not just one window. Absolute/relative events - 
doesn't matter, it's easy to convert from one to another.

In short - in the current xorg code there are checks to explicitly prohibit 
opening of the primary pointer and keyboard device as XInput device.

There is some capturing extension don't remember the name of it. It requires 
two server connections and works for the specified window only. This won't 
work for us.

Vitaliy.


From wine-devel at kievinfo.com  Fri Apr  4 13:19:46 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Fri, 04 Apr 2008 12:19:46 -0600
Subject: xenroll exported functions
In-Reply-To: <BAY109-W328625DAF59377E89A08C187F60@phx.gbl>
References: <BAY109-W328625DAF59377E89A08C187F60@phx.gbl>
Message-ID: <47F67142.9030409@kievinfo.com>

andre furtado wrote:
> add documentation for exported functions of the xenroll library...
> IEnroll * WINAPI PIEnrollGetNoCOM(void)
> */ returns a pointer to an IEnroll interface. */
> IEnroll2 * WINAPI PIEnroll2GetNoCOM(void)
> */ returns a pointer to an IEnroll2 interface. */
> IEnroll4 * WINAPI PIEnroll4GetNoCOM(void)
> */ returns a pointer to an IEnroll4 interface. */
>                            Andr? Renato Furtado
>                                               talk2cod at hotmail.com 
> <mailto:talk2cod at hotmail.com>
> 
> ------------------------------------------------------------------------
> Instale a Barra de Ferramentas com Desktop Search e ganhe EMOTICONS para 
> o Messenger! ? GR?TIS! <http://www.msn.com.br/emoticonpack>
> 
> 
> ------------------------------------------------------------------------
> 
> 
This does not look like a patch to me. Generate something that can be used 
with program 'patch'. For best results use git and 'git format-patch' as 
described in the wiki page you were pointed to in another reply.

Vitaliy.


From truiken at gmail.com  Fri Apr  4 13:56:59 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 4 Apr 2008 13:56:59 -0500
Subject: fusion: Test and implement CreateAssemblyNameObject
In-Reply-To: <22821af30804041058x39344346m3a19d631b2417ac5@mail.gmail.com>
References: <22821af30804041058x39344346m3a19d631b2417ac5@mail.gmail.com>
Message-ID: <22821af30804041156r4a741e10g6fba3377707dd0e@mail.gmail.com>

2008/4/4 James Hawkins <jhawkins at codeweavers.com>:
> Hi,
>
>  Changelog:
>  * Test and implement CreateAssemblyNameObject.
>

Please ignore this patch.

-- 
James Hawkins


From thestig at google.com  Fri Apr  4 14:11:41 2008
From: thestig at google.com (Lei Zhang)
Date: Fri, 4 Apr 2008 12:11:41 -0700
Subject: softpub exported functions prototypes
In-Reply-To: <BAY109-W528BB638B6A34A628701B787F60@phx.gbl>
References: <BAY109-W528BB638B6A34A628701B787F60@phx.gbl>
Message-ID: <558b2f5c0804041211x188fffddm3f0afe4365da6043@mail.gmail.com>

On Fri, Apr 4, 2008 at 10:50 AM, andre furtado <talk2cod at hotmail.com> wrote:
>
>
>  add softpub exported functions prototypes...
>
> HRESULT  WINAPI GenericChainCertificateTrust(IN OUT PCRYPT_PROVIDER_DATA
> pProvData)
> HRESULT WINAPI GenericChainFinalProv(IN OUT PCRYPT_PROVIDER_DATA pProvData)
> HRESULT WINAPI HTTPSCertificateTrust(CRYPT_PROVIDER_DATA *pProvData)
> HRESULT WINAPI SoftpubDefCertInit(CRYPT_PROVIDER_DATA *pProvData)
> BOOL WINAPI SoftpubFreeDefUsageCallData(const char *pszUsageOID,
> CRYPT_PROVIDER_DEFUSAGE *psDefUsage)
> BOOL WINAPI SoftpubLoadDefUsageCallData(const char *pszUsageOID,
> CRYPT_PROVIDER_DEFUSAGE *psDefUsage)
> BOOL CALLBACK AddPersonalTrustDBPages(LPVOID lpv, LPFNADDPROPSHEETPAGE
> lpfnAddPage, LPARAM lParam)
> HRESULT WINAPI DriverCleanupPolicy(CRYPT_PROVIDER_DATA *pProvData)
> HRESULT WINAPI DriverFinalPolicy(CRYPT_PROVIDER_DATA *pProvData)
> HRESULT WINAPI DriverInitializePolicy(CRYPT_PROVIDER_DATA *pProvData)
> HRESULT WINAPI HTTPSFinalProv(CRYPT_PROVIDER_DATA *pProvData)
> HRESULT WINAPI OfficeCleanupPolicy(CRYPT_PROVIDER_DATA *pProvData)
> HRESULT WINAPI OfficeInitializePolicy(CRYPT_PROVIDER_DATA *pProvData)
> BOOL WINAPI OpenPersonalTrustDBDialog(HWND hWnd)
> HRESULT WINAPI OfficeInitializePolicy(CRYPT_PROVIDER_DATA *pProvData)
> HRESULT WINAPI SoftpubAuthenticode(CRYPT_PROVIDER_DATA *pProvData)
> BOOL WINAPI SoftpubCheckCert(CRYPT_PROVIDER_DATA *pProvData, DWORD
> idxSigner,
> BOOL fCounterSignerChain, DWORD idxCounterSigner)
> HRESULT WINAPI SoftpubCleanup(CRYPT_PROVIDER_DATA *pProvData)
> HRESULT WINAPI SoftpubDumpStructure(CRYPT_PROVIDER_DATA *pProvData)
> HRESULT WINAPI SoftpubInitialize(CRYPT_PROVIDER_DATA *pProvData)
> HRESULT WINAPI SoftpubLoadMessage(CRYPT_PROVIDER_DATA *pProvData)
> HRESULT SoftpubLoadSignature(CRYPT_PROVIDER_DATA *pProvData)
> HRESULT WINAPI FindCertsByIssuer(OUT PCERT_CHAIN pCertChains, IN OUT DWORD
> *pcbCertChains, OUT DWORD *pcCertChains, IN BYTE* pbEncodedIssuerName, IN
> DWORD
> cbEncodedIssuerName, IN LPCWSTR pwszPurpose, IN DWORD dwKeySpec)
>
>     Andr? Renato Furtado
>        talk2cod at hotmail.com
>
> ________________________________
> Conhe?a j? o Windows Live Spaces, o site de relacionamentos do Messenger!
> Crie j? o seu!
>
>
>

- Stop, you're not doing it correctly. Please read:

http://www.winehq.org/site/sending_patches

- What you're sending is not a patch. Here is what a patch looks like:

http://www.winehq.org/pipermail/wine-patches/attachments/20080402/f22a7fe4/attachment.txt

- Please stop sending the same email to wine-patches and wine-devel.
Patches go only to wine-patches.


From hintak_leung at yahoo.co.uk  Fri Apr  4 10:35:20 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Fri, 4 Apr 2008 15:35:20 +0000 (GMT)
Subject: Documentation is still in CVS?
In-Reply-To: <558b2f5c0804031514u3f093c85u3ed8ca9a5ecfe5ac@mail.gmail.com>
Message-ID: <658075.98811.qm@web23105.mail.ird.yahoo.com>

--- On Thu, 3/4/08, Lei Zhang <thestig at google.com> wrote:

<snipped>
> The instructions on http://www.winehq.org/site/cvs works
> for me.

Doesn't work for me:

$ cvs -z3 -d:pserver:anonymous at wine.cvs.sourceforge.net:/cvsroot/wine co -P docs
cvs [checkout aborted]: connect to [wine.cvs.sourceforge.net]:2401 failed: Connection timed out

$ git cvsimport -C wine-doc -v -k -d :pserver:anonymous at wine.cvs.sourceforge.net:/cvsroot/wine docs 
Socket to wine.cvs.sourceforge.net: Connection timed out

I'll need to try stunnel and see if it improves things. (but I can still check out stuff from other sourceforge projects...)


      ___________________________________________________________ 
Yahoo! For Good helps you make a difference  

http://uk.promotions.yahoo.com/forgood/


From hintak_leung at yahoo.co.uk  Fri Apr  4 11:04:38 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Fri, 4 Apr 2008 16:04:38 +0000 (GMT)
Subject: wget usage in winetricks 
In-Reply-To: <a71bd89a0804021431w79515034i84ff0e4c57af3353@mail.gmail.com>
Message-ID: <89592.13651.qm@web23103.mail.ird.yahoo.com>

I'll say upfront that, *thank you* for wine tricks!

Recently I encounted an interesting issue - I have a .wgetrc which sets always construct directory, and always time stamps, etc. It is equivalent to the command line option:
"-x,  --force-directories        force creation of directories" - while it is my personal preference to always know where I have downloaded stuff from, the usage of wget in winestricks probably should explicitly specify 
"-nd, --no-directories           don't create directories" and maybe other options
to make sure that wget is downloading stuff to where you want it to. 

I thought of unsetting WGETRC, or setting WGETRC to some unknown place so that user/site-admin preferences are not loaded, but that's dangerous, because proxies, etc
are also set in wgetrc and if winetricks unset wgetrc, connectivity can break. So explicitly do -nd or even -O seems more sensible...





      ___________________________________________________________ 
Yahoo! For Good helps you make a difference  

http://uk.promotions.yahoo.com/forgood/


From hintak_leung at yahoo.co.uk  Fri Apr  4 12:55:20 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Fri, 4 Apr 2008 17:55:20 +0000 (GMT)
Subject: Documentation is still in CVS?
In-Reply-To: <558b2f5c0804041050n26a669b4ude698d41db65e31c@mail.gmail.com>
Message-ID: <134335.55841.qm@web23107.mail.ird.yahoo.com>

--- On Fri, 4/4/08, Lei Zhang <thestig at google.com> wrote:

> From: Lei Zhang <thestig at google.com>
> Subject: Re: Documentation is still in CVS?
> To: "Hin-Tak Leung" <hintak_leung at yahoo.co.uk>
> Cc: "Wine Devel" <wine-devel at winehq.org>
> Date: Friday, 4 April, 2008, 6:50 PM
> On Fri, Apr 4, 2008 at 8:35 AM, Hin-Tak Leung
> <hintak_leung at yahoo.co.uk> wrote:
> >  Doesn't work for me:
> >
> >  $ cvs -z3
> -d:pserver:anonymous at wine.cvs.sourceforge.net:/cvsroot/wine
> co -P docs
> >  cvs [checkout aborted]: connect to
> [wine.cvs.sourceforge.net]:2401 failed: Connection timed
> out
> >
> >  $ git cvsimport -C wine-doc -v -k -d
> :pserver:anonymous at wine.cvs.sourceforge.net:/cvsroot/wine
> docs
> >  Socket to wine.cvs.sourceforge.net: Connection timed
> out
> >
> >  I'll need to try stunnel and see if it improves
> things. (but I can still check out stuff from other
> sourceforge projects...)
> >
> 
> Firewall issue on your side? Can you ping
> wine.cvs.sourceforge.net?
> Connect to it on port 80? or port 2401?

Can do port 80, can't do port 2401. Wierd. It is probably problem in my end.



      ___________________________________________________________ 
Yahoo! For Good helps you make a difference  

http://uk.promotions.yahoo.com/forgood/


From hintak_leung at yahoo.co.uk  Fri Apr  4 13:34:30 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Fri, 4 Apr 2008 18:34:30 +0000 (GMT)
Subject: wine based win32 printer drivers
In-Reply-To: <1206918736.7820.140.camel@p4>
Message-ID: <511483.3837.qm@web23102.mail.ird.yahoo.com>

I am looking at ddiwrapper lately and having a lot of fun with it. Is Marcel's on-going 
not-merged work anywhere on line that I can have a peek before its merge into wine?

Hin-Tak

--- On Mon, 31/3/08, Detlef Riekenberg <wine.dev at web.de> wrote:

> From: Detlef Riekenberg <wine.dev at web.de>
> Subject: wine based win32 printer drivers
> To: "Marcel Partap" <mpartap at gmx.net>
> Cc: wine-devel at winehq.org
> Date: Monday, 31 March, 2008, 12:12 AM
> On So, 2008-03-30 at 06:03 +0200, Marcel Partap wrote:
> > Anyways, I am working on getting something merged.. 
> 
> Great!
> 
> > For now the target is to get the Adobe pscript5 driver
> working which
> > has its own raster renderer and thus does not depend
> on the dib
> > engine. 
> A Postscript Driver has no raster renderer...
> A Postscript Driver has a Postscript Engine.
> 
> > Just started by making AddPrinter correctly get 
> > a default devmode out of the driver, patch is
> attached, 
> 
> > DRIVER_EVENT_INITIALIZE, 3,
> "3" is wrong here. See:
> myAddPrinterDriverEx(DWORD level, ...
> 
> Since there are much more Events, we need the DriverUI in
> more Places
> later. I suggest a simple struct, which can be extended
> later
> (The struct must include the Results from GetProcAddress)
> 
> 
> The changes for winspool.drv must go in a seperate Patch.
> WINSPOOL_CallDrvDocumentProperties is the wrong name, when
> you 
> call DrvDocumentPropertySheets.
> 
> You should collect all API in winspool.drv, that need the
> driverui
> (some are not implemented) and design a simple struct
> with helper functions (Use monitor_t as example).
> Not all Drivers Export DrvDocumentPropertySheets.
> You must prepare to use a Fallback to get the default
> devmode
> (DrvConvertDevMode)
> See winspool.drv/monitor_load as Example:
> - InitializePrintMonitor2 is suggested my MSDN, but not
> needed yet
> - InitializePrintMonitor implemented
> - InitializeMonitorEx and InitializeMonitor as Fallback.
> 
> The current Code is a crosscall from DocumentPropertiesW to
> DocumentPropertiesA.
> The DDI-API is unicode and should be the prefered way.
> When wineps.drv is updated, the old code with the crosscall
> can be
> removed, since we do not support ANSI Drivers (Windows 9x).
> 
> You can even use the same struct and helper functions 
> in localspl.dll and winspool.drv
> 
> 
> -- 
>  
> By by ... Detlef


      ___________________________________________________________ 
Yahoo! For Good helps you make a difference  

http://uk.promotions.yahoo.com/forgood/


From mle+win at mega-nerd.com  Fri Apr  4 17:23:10 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sat, 5 Apr 2008 09:23:10 +1100
Subject: Bug in MSVCRT_fseek (with patch)
In-Reply-To: <a71bd89a0804040406r610fe4d6q25e217b9a456505@mail.gmail.com>
References: <a71bd89a0804040406r610fe4d6q25e217b9a456505@mail.gmail.com>
Message-ID: <20080405092310.5cc2fe78.mle+win@mega-nerd.com>

Dan Kegel wrote:

> To get your change and test accepted, please send a patch,
> and make the test a real wine conformance test.

I found a test in dlls/msvcrt/tests/file.c that seems to have been
mad inactive by use of a "todo_wine". Activating the test without
my patch results in two failures:

    file.c:244: Test failed: feof failure in binary mode
    file.c:244: Test failed: feof failure in ascii mode

Rerunning the test after my patch an these two failures disappeared.

Below is my new patch, which activates the test and fixes the bug.

Cheers,
Erik

-------------8<-------------8<-------------8<-------------8<-------------
diff --git a/dlls/msvcrt/file.c b/dlls/msvcrt/file.c
index 0c1e84b..866d28d 100644
--- a/dlls/msvcrt/file.c
+++ b/dlls/msvcrt/file.c
@@ -918,6 +918,8 @@ int CDECL MSVCRT_fseek(MSVCRT_FILE* file, long offset, int whence)
   if(file->_flag & MSVCRT__IORW) {
         file->_flag &= ~(MSVCRT__IOREAD|MSVCRT__IOWRT);
   }
+  /* Clear end of file flag */
+  file->_flag &= ~MSVCRT__IOEOF;
   return (_lseek(file->_file,offset,whence) == -1)?-1:0;
 }
 
diff --git a/dlls/msvcrt/tests/file.c b/dlls/msvcrt/tests/file.c
index d406ae5..aa58a32 100644
--- a/dlls/msvcrt/tests/file.c
+++ b/dlls/msvcrt/tests/file.c
@@ -241,7 +241,7 @@ static void test_readmode( BOOL ascii_mode )
     ok(fread(buffer,1,1,file)==0,"fread failure in %s\n", IOMODE);
     ok(feof(file)!=0,"feof failure in %s\n", IOMODE);
     ok(fseek(file,-3,SEEK_CUR)==0,"seek failure in %s\n", IOMODE);
-    todo_wine ok(feof(file)==0,"feof failure in %s\n", IOMODE);
+    ok(feof(file)==0,"feof failure in %s\n", IOMODE);
     ok(fread(buffer,2,1,file)==1,"fread failed in %s\n", IOMODE);
     ok(feof(file)==0,"feof failure in %s\n", IOMODE);
     ok(fread(buffer,2,1,file)==0,"fread failure in %s\n",IOMODE);

-------------8<-------------8<-------------8<-------------8<-------------


-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
Only people who suck have a problem with elitism.


From dank at kegel.com  Fri Apr  4 18:39:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 4 Apr 2008 16:39:30 -0700
Subject: Wine 1.0 status: 70 days to release,
	68 bugs to fix. 28 days to code freeze!
Message-ID: <a71bd89a0804041639r75e8d888qc61669caf6756cb6@mail.gmail.com>

Here are the 1.0 bug list changes since April 1:

Fixed (by Stefan D. and Lei):
5955   directx-        8       DirectDrawCreate crash on non-OpenGL desktop

New (by A.F. and Austin):
11420  advapi32        0       service control manager API problem:
name of named objects might differ (client vs. service process)

Deferred:
82    	document  	2  	Stabilize Winelib User Guide Table of Contents

We really shouldn't be adding any more 1.0 bugs at this point, but
the new one is well-analyzed, and is said to affect Visual Studio, 3dsmax,
and the copy protection scheme used by Autocad 2000, so what the heck.
That's probably the last of its ilk, though.

We're going to get a lot more cruel about deferring bugs
as we get closer to release.  For instance, issue 82.
Winelib is kind of a secondary issue... not a whole lot of
people should be using it, so it's probably ok to defer.
And 'probably ok' is getting to be a good enough reason.

Here's the full list of the 68 remaining bugs:

11420     advapi32  0         service control manager API problem:
name of named objects might differ
556       build-en  1         Reconcile the Windows and Wine spec files
1114      comctl32  3         Winrar2.90/3.00: Comboex doesn't trigger
a event when you mouse-click in
2493      comctl32  2         Multi-select listview: Shift-arrow up
only selects top two items
4372      comctl32  1         listview: cannot drag several items
11509     crypt32   0         Wordviewer 2003 is unable to open
documents encrypted with AES
11681     directx-  15        Add support for video overlay
5535      directx-  16        Planescape:Torment doesn't work
9030      directx-  0         army men hangs on black screen
3270      gdi32     15        Problem with minimized top-level windows
6519      gdi32     7         Wine blacks out rotated font bitmap
7571      gdi32     1         Accented character glyphs are mixed up
with TrueType fonts (affects e.g. Lotus Notes R5)
9771      gdi32     38        Steam Friends doesn't work (fails to
render correctly or refresh)
5024      kernel32  4         Thief: Deadly Shadows crashes:page fault
on read access to 0x0000040c
5351      kernel32  9         Windows Installer 3.1 cannot install
because of non-standard drive labeling
5541      kernel32  0         WriteConsole can't write to stdout;
affects e.g. wsh's cscript's usage message
9039      kernel32  0         GS-Auftrag Professional SQL aborts on startup
9484      kernel32  19        Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
7098      mscoree   1         RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
5163      msi       12        Office XP 2002 crashes on installation
8783      ntdll     13        USB serial ports do not work
9356      ntdll     7         Serial communication not working since wine-0.9.33
2539      ole       3         XDND (Drag and drop for X Windows)
doesn't copy text
6607      ole       10        Drag and Drop not working
8095      ole       0         PQ Teaching toy crashes
9942      ole       2         Powerpoint Viewer 2007 crashes opening .pptx files
5926      programs  1         Wine does not provide an implementation
of winhlp32.exe
6254      richedit  4         Installer infinite loop from rich text error
3546      shdocvw   2         CLSID_InternetShortcut not available...
6095      shdocvw   12        MOTD in counter-strike 1.6 and
counter-strike source does not render
8898      shdocvw   0         Run Time Error "445": Object doesn't
support this action in Europa Knowledgebase
9304      shdocvw   4         Temple of Elemental Evil demo doesn't
start - gui irresponsive
8439      shell32   8         Visual Studio .NET (7) install fails
9809      shell32   4         Autodesk Revit Architecture 2008 install fails
11742     shlwapi   8         Small .net 1.1 app (FastMD5 1.3) fails to start up
12074     testcase  2         The conformance tests fail on Windows
6604      tools     2         Ship icons for the wine-tools that can
be used in .desktop files
5055      -unknown  5         Deleting files from a window in wine
doesn't send them to the Trash
5061      -unknown  6         Copying from Windows Firefox in Wine and
pasting to Linux OpenOffice pastes metadata
5402      -unknown  0         Trying to run PhotoStitch 3.1
5844      -unknown  12        tray minimize
5948      -unknown  1         Star Trek: Armada does not install
7404      -unknown  3         ShowWindow(SW_MINIMIZE) should not
generate a WM_PAINT message
7477      -unknown  1         Uplink demo crashes
8125      -unknown  0         Marratech 6.1 crashes on start
9178      -unknown  7         "hello world" dos program hangs
9916      -unknown  6         "make test" usually fails
9959      -unknown  8         Make wine updates work even if the
registry changed
10147     -unknown  1         Word Viewer 2003 - Tab behavior differs
from Windows
10815     -unknown  2         Cannot drag images into Adobe Photoshop
7 from the web / desktop
11281     -unknown  3         CJK input many issues
12097     -unknown  3         Wine 1.0 should not ship out-of-sync
resource translations
12246     -unknown  2         "make test" gives different results with
and without warn+heap
664       user32    6         The help menu functionality inside
programs is broken (messaging problem)
3023      user32    5         Orcad - "Place Part" never tries to put
down a part
4523      user32    5         Can't copy from Firefox 1.5 and paste
into OpenOffice 2 under Wine
124       wineserv  2         Review of Wine Server Protocol
1990      winex11.  1         modifier keys not released when switching desktop
2368      winex11.  7         Wine loses its X-Window when switching
to another virt. desktop in Fvwm
3297      winex11.  12        UpdateWindow() doesn't call XFlush()
5623      winex11.  4         GetAsyncKeyState wrong if querying
process doesn't have focus
5828      winex11.  24        Command and Conquer Generals (Zero Hour)
doesn't change the mouse cursor
7372      winex11.  12        can't copy and paste between gnome apps
eg openoffice or gimp and wine apps
10984     winex11.  5         sun jre 5 update 10 installer hangs in 0.9.52
11019     winex11.  3         matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
5625      wininet   4         Wine does not handle internet proxy
settings conveniently
9787      winsock   47        Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
12005     wintab32  1         Regression in pressure sensitivity with
wizardpen tablet driver and Photoshop 7


From austinenglish at gmail.com  Fri Apr  4 19:35:55 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 4 Apr 2008 19:35:55 -0500
Subject: Wine 1.0 status: 70 days to release,
	68 bugs to fix. 28 days to code freeze!
In-Reply-To: <a71bd89a0804041639r75e8d888qc61669caf6756cb6@mail.gmail.com>
References: <a71bd89a0804041639r75e8d888qc61669caf6756cb6@mail.gmail.com>
Message-ID: <b6bb06270804041735o7a03b7ffu667494c7b42bdd84@mail.gmail.com>

On 4/4/08, Dan Kegel <dank at kegel.com> wrote:
>  New (by A.F. and Austin):
>  11420  advapi32        0       service control manager API problem:
>  name of named objects might differ (client vs. service process)
I  didn't add that one, I think you mean:
4372      comctl32  1         listview: cannot drag several items
Which I did add. Even though adding bugs at this point is obviously a
bad idea, if something as basic (and somewhat easy to fix) as dragging
multiple items doesn't work, it will reflect poorly on the project.
Things as basic as that should 'just work'.


From dank at kegel.com  Fri Apr  4 20:08:14 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 4 Apr 2008 18:08:14 -0700
Subject: Wine 1.0 status: 70 days to release,
	68 bugs to fix. 28 days to code freeze!
In-Reply-To: <b6bb06270804041735o7a03b7ffu667494c7b42bdd84@mail.gmail.com>
References: <a71bd89a0804041639r75e8d888qc61669caf6756cb6@mail.gmail.com>
	<b6bb06270804041735o7a03b7ffu667494c7b42bdd84@mail.gmail.com>
Message-ID: <a71bd89a0804041808y264460e3r4d1ff6ea752f34c7@mail.gmail.com>

On Fri, Apr 4, 2008 at 5:35 PM, Austin English <austinenglish at gmail.com> wrote:
> On 4/4/08, Dan Kegel <dank at kegel.com> wrote:
>  >  New (by A.F. and Austin):
>  >  11420  advapi32        0       service control manager API problem:
>  >  name of named objects might differ (client vs. service process)
>
>  I  didn't add that one

http://bugs.winehq.org/show_bug.cgi?id=11420#c4 says you did, but
somehow it escaped being listed until now.
- Dan


From thestig at google.com  Fri Apr  4 23:55:06 2008
From: thestig at google.com (Lei Zhang)
Date: Fri, 4 Apr 2008 21:55:06 -0700
Subject: [PATCH] user32: on VK_RETURN, send WM_COMMAND to ancestor,
	not parent.
In-Reply-To: <558b2f5c0804041111v2daf31e4sbbf874e4424c1be4@mail.gmail.com>
References: <558b2f5c0804040020w77698ed0v324e7dbae792098b@mail.gmail.com>
	<00a901c89657$3abcc4f0$a600fea9@DMITRY>
	<558b2f5c0804040747s3eb841cfma07c0b6ca236e8c1@mail.gmail.com>
	<018501c8966e$f65e4000$a600fea9@DMITRY>
	<558b2f5c0804041111v2daf31e4sbbf874e4424c1be4@mail.gmail.com>
Message-ID: <558b2f5c0804042155h783268f0m2419aa2f65cf2a19@mail.gmail.com>

On Fri, Apr 4, 2008 at 11:11 AM, Lei Zhang <thestig at google.com> wrote:
>
> On Fri, Apr 4, 2008 at 9:14 AM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
>  > "Lei Zhang" <thestig at google.com> wrote:
>  >
>  >
>  > > The edit control is the child of a dialog box bar, which is in turn
>  > > the child of another dialog box foo. SetParent() is not involved, if
>  > > that's what you mean.
>  > >
>  >
>  >  Seems that's not the case then, from your test it looks more like
>  >  a WM_COMMAND forwarding from a child dialog to the parent one.
>  >
>  >  --
>  >  Dmitry.
>  >
>
>  I'm pretty sure the parent dialog is getting the WM_COMMAND directly.
>  It is not the case where the child dialog gets a WM_COMMAND, and
>  forwards it to its parent.
>
>  Running the test on Windows, the child dialog gets two WM_COMMANDS -
>  EN_SETFOCUS and EN_KILLFOCUS. Then the parent dialog gets WM_COMMAND
>  with IDOK.
>
>  - Lei
>

Ah, this is because the child dialog has the DS_CONTROL style. I
should test for that and handle it appropriately.

- Lei


From mle+win at mega-nerd.com  Sat Apr  5 02:50:05 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sat, 5 Apr 2008 18:50:05 +1100
Subject: Time zone info
Message-ID: <20080405185005.91bcec65.mle+win@mega-nerd.com>

Hi all,

My Linux TZ variable is set to Australia/NSW and I'm getting a
bunch of fixmes like this:

    fixme:ntdll:find_reg_tz_info Can't find matching timezone
    information in the registry for bias -600, std (d/m/y):
    6/04/2008, dlt (d/m/y): 5/10/2008

I've seen this post to this mailing list:

    http://winehq.org/pipermail/wine-patches/2008-March/052474.html

so I understand that this timezone info is in the file tools/wine.inf.

Whats the policy on adding things to this file and how does one go
about it?

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"The growing and dangerous intrusion of this new technology,
threatens an entire industry's economic vitality and future
security." -- Jack Valenti (MPAA president) on the video
cassette recorder, 1982.


From dmitry at codeweavers.com  Sat Apr  5 03:12:14 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 5 Apr 2008 17:12:14 +0900
Subject: Time zone info
References: <20080405185005.91bcec65.mle+win@mega-nerd.com>
Message-ID: <00ad01c896f4$c37aa300$a600fea9@DMITRY>

"Erik de Castro Lopo" <mle+win at mega-nerd.com> wrote:

> My Linux TZ variable is set to Australia/NSW and I'm getting a
> bunch of fixmes like this:
> 
>    fixme:ntdll:find_reg_tz_info Can't find matching timezone
>    information in the registry for bias -600, std (d/m/y):
>    6/04/2008, dlt (d/m/y): 5/10/2008
> 
> I've seen this post to this mailing list:
> 
>    http://winehq.org/pipermail/wine-patches/2008-March/052474.html
> 
> so I understand that this timezone info is in the file tools/wine.inf.
> 
> Whats the policy on adding things to this file and how does one go
> about it?

Looks like timezone info in your Linux system is not up to date.

P.S.
Please do not use "Reply-To:" header when posting wine-devel.

-- 
Dmitry.


From dmitry at codeweavers.com  Sat Apr  5 03:21:32 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 5 Apr 2008 17:21:32 +0900
Subject: Time zone info
References: <20080405185005.91bcec65.mle+win@mega-nerd.com>
	<00ad01c896f4$c37aa300$a600fea9@DMITRY>
Message-ID: <00ca01c896f6$115b81b0$a600fea9@DMITRY>

"Dmitry Timoshkov" <dmitry at codeweavers.com> wrote:

>> My Linux TZ variable is set to Australia/NSW and I'm getting a
>> bunch of fixmes like this:
>> 
>>    fixme:ntdll:find_reg_tz_info Can't find matching timezone
>>    information in the registry for bias -600, std (d/m/y):
>>    6/04/2008, dlt (d/m/y): 5/10/2008

> Looks like timezone info in your Linux system is not up to date.

Another possibility is that you need to re-run wineprefixcreate to update
time zone information in the registry.

-- 
Dmitry.


From mle+win at mega-nerd.com  Sat Apr  5 03:23:44 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sat, 5 Apr 2008 19:23:44 +1100
Subject: Time zone info
In-Reply-To: <00ad01c896f4$c37aa300$a600fea9@DMITRY>
References: <20080405185005.91bcec65.mle+win@mega-nerd.com>
	<00ad01c896f4$c37aa300$a600fea9@DMITRY>
Message-ID: <20080405192344.4960570f.mle+win@mega-nerd.com>

Dmitry Timoshkov wrote:

> Looks like timezone info in your Linux system is not up to date.

Sorry, I have every reason to believe it is correct. On what basis
do you suggest that it is not?
 
> Please do not use "Reply-To:" header when posting wine-devel.

I'm sorry, but why not? Isn't that the bext way to indicate
that I would prefer to have replies sent to the list rather
than directly to me?

Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
C++ : an octopus made by nailing extra legs onto a dog.


From ben at atomnet.co.uk  Sat Apr  5 08:39:07 2008
From: ben at atomnet.co.uk (Ben Hodgetts)
Date: Sat, 05 Apr 2008 14:39:07 +0100
Subject: Time zone info
In-Reply-To: <20080405192344.4960570f.mle+win@mega-nerd.com>
References: <20080405185005.91bcec65.mle+win@mega-nerd.com>	<00ad01c896f4$c37aa300$a600fea9@DMITRY>
	<20080405192344.4960570f.mle+win@mega-nerd.com>
Message-ID: <47F780FB.5090109@atomnet.co.uk>



Erik de Castro Lopo wrote:
> Dmitry Timoshkov wrote:
>
>   
>> Looks like timezone info in your Linux system is not up to date.
>>     
>
> Sorry, I have every reason to believe it is correct. On what basis
> do you suggest that it is not?
>  
>   
>> Please do not use "Reply-To:" header when posting wine-devel.
>>     
>
> I'm sorry, but why not? Isn't that the bext way to indicate
> that I would prefer to have replies sent to the list rather
> than directly to me?
>
> Erik
>   

Because replies are always supposed to go to the list anyway, it's 
rather redundant.

Ben H.


From rob at codeweavers.com  Sat Apr  5 09:22:47 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Sat, 05 Apr 2008 15:22:47 +0100
Subject: Wine 1.0 status: 70 days to release,	68 bugs to fix. 28 days
	to code freeze!
In-Reply-To: <a71bd89a0804041639r75e8d888qc61669caf6756cb6@mail.gmail.com>
References: <a71bd89a0804041639r75e8d888qc61669caf6756cb6@mail.gmail.com>
Message-ID: <47F78B37.6080800@codeweavers.com>

Dan Kegel wrote:
> New (by A.F. and Austin):
> 11420  advapi32        0       service control manager API problem:
> name of named objects might differ (client vs. service process)
>   

This should be fixed as a result of the services work that was done in 
the last couple of weeks and the last comment in the bug confirms this.

-- 
Rob Shearman



From dank at kegel.com  Sat Apr  5 10:06:59 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 5 Apr 2008 08:06:59 -0700
Subject: Wine 1.0 status: 70 days to release,
	68 bugs to fix. 28 days to code freeze!
In-Reply-To: <47F78B37.6080800@codeweavers.com>
References: <a71bd89a0804041639r75e8d888qc61669caf6756cb6@mail.gmail.com>
	<47F78B37.6080800@codeweavers.com>
Message-ID: <a71bd89a0804050806v1fbf4a90m4aafebda27067719@mail.gmail.com>

On Sat, Apr 5, 2008 at 7:22 AM, Robert Shearman <rob at codeweavers.com> wrote:
> > New (by A.F. and Austin):
> > 11420  advapi32        0       service control manager API problem:
> > name of named objects might differ (client vs. service process)
>
>  This should be fixed as a result of the services work that was done in the
> last couple of weeks

I wondered about that...

> and the last comment in the bug confirms this.

Seems to say the opposite to me... I left a question in the bug, let's
see what Louis says.


From truiken at gmail.com  Sat Apr  5 11:28:47 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 5 Apr 2008 11:28:47 -0500
Subject: [Try 3] [1/2] cabinet.dll -> FDICopy: Test added
In-Reply-To: <200804051937.33251.vitperov@etersoft.ru>
References: <200804051937.33251.vitperov@etersoft.ru>
Message-ID: <22821af30804050928s48a26486k311c3d6d6d5a4ce0@mail.gmail.com>

2008/4/5 Vitaly Perov <vitperov at etersoft.ru>:
> This test checks if function FDICopy() of cabinet.dll correctly works with an
>  empty cabinet file (It's correct cab-file, but it has no files and folders
>  inside).
>  In this case Windows return TRUE, but WINE return FALSE. So the installation
>  of certain software finishes with an error in WINE
>
>  Changelog:
>      - Added a test for cabinet.dll FDICopy function. This test checks if it
>  works correctly with an empty cab-files
>

--- dlls/cabinet/tests/fdi.c	6 Feb 2008 13:29:17 -0000	1.3
+++ dlls/cabinet/tests/fdi.c	5 Apr 2008 15:16:55 -0000
@@ -20,6 +20,7 @@

 #include <stdio.h>
 #include <windows.h>
+#include <assert.h>
 #include "fci.h"
 #include "fdi.h"
 #include "wine/test.h"

You forgot to remove this.


-- 
James Hawkins


From mpartap at gmx.net  Sat Apr  5 02:03:38 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Sat, 05 Apr 2008 09:03:38 +0200
Subject: wine based win32 printer drivers
In-Reply-To: <511483.3837.qm@web23102.mail.ird.yahoo.com>
References: <511483.3837.qm@web23102.mail.ird.yahoo.com>
Message-ID: <47F7244A.6010706@gmx.net>

> I am looking at ddiwrapper lately and having a lot of fun with it.
Well I didn't have much fun with it because for me first it did not build properly, then segfaulted. 
Anyways.
> Is Marcel's on-going not-merged work anywhere on line that I can have
 > a peek before its merge into wine?
ot online but attached is the work done last year. This year's work is still in the pipeline, not 
much time for it lately but its on the agenda.
regards.

> 
> Hin-Tak
> 
> --- On Mon, 31/3/08, Detlef Riekenberg <wine.dev at web.de> wrote:
> 
>> From: Detlef Riekenberg <wine.dev at web.de> Subject: wine based win32 printer drivers To: "Marcel
>> Partap" <mpartap at gmx.net> Cc: wine-devel at winehq.org Date: Monday, 31 March, 2008, 12:12 AM On
>> So, 2008-03-30 at 06:03 +0200, Marcel Partap wrote:
>>> Anyways, I am working on getting something merged..
>> Great!
>> 
>>> For now the target is to get the Adobe pscript5 driver
>> working which
>>> has its own raster renderer and thus does not depend
>> on the dib
>>> engine.
>> A Postscript Driver has no raster renderer... A Postscript Driver has a Postscript Engine.
>> 
>>> Just started by making AddPrinter correctly get a default devmode out of the driver, patch is
>>> 
>> attached,
>> 
>>> DRIVER_EVENT_INITIALIZE, 3,
>> "3" is wrong here. See: myAddPrinterDriverEx(DWORD level, ...
>> 
>> Since there are much more Events, we need the DriverUI in more Places later. I suggest a simple
>> struct, which can be extended later (The struct must include the Results from GetProcAddress)
>> 
>> 
>> The changes for winspool.drv must go in a seperate Patch. WINSPOOL_CallDrvDocumentProperties is
>> the wrong name, when you call DrvDocumentPropertySheets.
>> 
>> You should collect all API in winspool.drv, that need the driverui (some are not implemented)
>> and design a simple struct with helper functions (Use monitor_t as example). Not all Drivers
>> Export DrvDocumentPropertySheets. You must prepare to use a Fallback to get the default devmode
>>  (DrvConvertDevMode) See winspool.drv/monitor_load as Example: - InitializePrintMonitor2 is
>> suggested my MSDN, but not needed yet - InitializePrintMonitor implemented -
>> InitializeMonitorEx and InitializeMonitor as Fallback.
>> 
>> The current Code is a crosscall from DocumentPropertiesW to DocumentPropertiesA. The DDI-API is
>> unicode and should be the prefered way. When wineps.drv is updated, the old code with the
>> crosscall can be removed, since we do not support ANSI Drivers (Windows 9x).
>> 
>> You can even use the same struct and helper functions in localspl.dll and winspool.drv
>> 
>> 
>> --
>> 
>> By by ... Detlef
> 
> 
> ___________________________________________________________ Yahoo! For Good helps you make a
> difference
> 
> http://uk.promotions.yahoo.com/forgood/
> 


-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: enddeadlinestatus_2007-08-31_07-44.rar
Type: application/rar
Size: 99224 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080405/0409cccc/attachment-0001.rar 

From till.kamppeter at gmail.com  Sat Apr  5 09:43:41 2008
From: till.kamppeter at gmail.com (Till Kamppeter)
Date: Sat, 05 Apr 2008 16:43:41 +0200
Subject: WINEDLLPATH, ddiwrapper, msvcrt40 (Re: wine based win32 printer
	drivers)
In-Reply-To: <780857.19559.qm@web23108.mail.ird.yahoo.com>
References: <780857.19559.qm@web23108.mail.ird.yahoo.com>
Message-ID: <47F7901D.70309@gmail.com>

Hin-Tak Leung wrote:
> 2) (to uli and Till) - do you mind if I put a mod/update of ddiwrapper out
> publicly, or uli can release a new one that works with current wine? 
> 
> I have a third question - while looking at another XP driver for a paper-weight printer (konica-minolta magic color 2500W), it depends on msvcrt40.dll. 
>

I am not of much help here. I have never really used wine (once for 
running a self-extracting .exe with a firmware for a didgital camera in 
it) and I also never packaged it for a distro.

    Till



From xixsimplicityxix at gmail.com  Sat Apr  5 13:10:17 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Sat, 5 Apr 2008 13:10:17 -0500
Subject: Crossbuild patch, appropriate for wine?
In-Reply-To: <47F62EA6.4030204@codeweavers.com>
References: <78a7dad00804040256q35948105gb5d52d9b975c8830@mail.gmail.com>
	<47F61545.4040709@codeweavers.com> <87myo9byjt.fsf@wine.dyndns.org>
	<47F624A2.6070401@codeweavers.com> <87iqyxbw4v.fsf@wine.dyndns.org>
	<47F62EA6.4030204@codeweavers.com>
Message-ID: <78a7dad00804051110s685de46auc9f4616108805bff@mail.gmail.com>

On Fri, Apr 4, 2008 at 8:35 AM, Robert Shearman <rob at codeweavers.com> wrote:
> > > Alexandre Julliard wrote:
> > >
> > >
> > > > I don't think we want to disable exceptions, that will just lead to
> > > > broken builds. It should be possible to make the sigsetjmp variant
> work
>
>  The reason is that RtlUnwind clears all general purpose registers (and
> maybe changes esp/ebp) so that frame is no longer valid. There may be a way
> to work around this, but I'm not sure.
>

Well how about for the interim a no op patch.  No op exceptions can be
handled in the case:
defined(__MINGW32__) && ! defined(USE_COMPILER_EXCEPTIONS).

The eventual support for compiler exceptions can then go in separate
case: defined(__MINGW32__) && defined(USE_COMPILER_EXCEPTIONS)

Patch attached implementing Rob S suggestions.

--John
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 0001-exception.h-Add-no-op-exception-definitions-for.patch.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080405/5b0b2b21/attachment.txt 

From mle+win at mega-nerd.com  Sat Apr  5 16:19:06 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 6 Apr 2008 07:19:06 +1000
Subject: Time zone info
In-Reply-To: <00ca01c896f6$115b81b0$a600fea9@DMITRY>
References: <20080405185005.91bcec65.mle+win@mega-nerd.com>
	<00ad01c896f4$c37aa300$a600fea9@DMITRY>
	<00ca01c896f6$115b81b0$a600fea9@DMITRY>
Message-ID: <20080406071906.e03e4cd0.mle+win@mega-nerd.com>

Dmitry Timoshkov wrote:

> Another possibility is that you need to re-run wineprefixcreate to update
> time zone information in the registry.

That fixed it. Thanks.

Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
Rule 1: Spammers lie.
Rule 2: If a spammer seems to be telling the truth, see Rule #1.


From hans at it.vu.nl  Sun Apr  6 03:41:11 2008
From: hans at it.vu.nl (Hans Leidekker)
Date: Sun, 6 Apr 2008 10:41:11 +0200
Subject: [PATCH 1 of 2] start.exe: add /Unix switch for starting files
	from unix file managers
In-Reply-To: <ced95fe0804052046v425e4ec4reee5e0773ec135@mail.gmail.com>
References: <ced95fe0804052046v425e4ec4reee5e0773ec135@mail.gmail.com>
Message-ID: <200804061041.12274.hans@it.vu.nl>

On Sunday 06 April 2008 05:46:49 Vincent Povirk wrote:

> -IMPORTS   = shell32 user32 kernel32
> +IMPORTS   = shell32 user32 kernel32 shlwapi

If it's just StrCpyNW you need from shlwapi you might as well use
an alternative like memcpy and avoid importing this dll.

> +               char multibyte_dospath[MAX_PATH];

That's a misnomer, you're storing a Unix path in the buffer.
Dynamic allocation would make the code a bit more robust.

> +               WideCharToMultiByte(CP_ACP, 0, sei.lpFile, -1, multibyte_dospath, sizeof(multibyte_dospath)/sizeof(char), NULL, NULL);

Should be CP_UNIXCP.

 -Hans


From stefan at codeweavers.com  Sun Apr  6 04:51:12 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 6 Apr 2008 11:51:12 +0200
Subject: d3d9-Make-the-shader-test-more-precision-tolerant
In-Reply-To: <47F88DFF.8050405@web.de>
References: <47F88DFF.8050405@web.de>
Message-ID: <200804061151.12732.stefan@codeweavers.com>

Am Sonntag, 6. April 2008 10:46:55 schrieb Rico Sch?ller:
> Hi,
>
> this patch makes the cnd_test on windows happy.
>
> Cheers
> Rico

The patches look ok to me



From jan.wine at zerebecki.de  Sun Apr  6 05:13:31 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sun, 6 Apr 2008 12:13:31 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <7e33d29b0804021423p5a3ec275l9d5b96234de28a8c@mail.gmail.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
	<b6bb06270804021105v63c03b37nd9e47e72a2a338c6@mail.gmail.com>
	<22821af30804021133m46c0c78dy76debaec3d48bc9a@mail.gmail.com>
	<47F3D5EF.2030001@redhat.com>
	<22821af30804021159w70ab3327m26ebb9b325c82b1b@mail.gmail.com>
	<7e33d29b0804021420j19d12047ma386a60d66f2c091@mail.gmail.com>
	<7e33d29b0804021423p5a3ec275l9d5b96234de28a8c@mail.gmail.com>
Message-ID: <20080406101331.GP3557@crissy.swd.zerebecki.de>

On Wed, Apr 02, 2008 at 05:23:50PM -0400, Bryan Haskins wrote:
> Sorry for the double post. But further on that point, at the sound system
> neutral level, naming eahc app individually as a sound item would rock. In
> such a way that each app perhaps talks to ALSA directly, which results in
> self identification, and further Pulse via ALSA recognizing things
> individually.

That this doesn't work with the alsa->pulse plugin is a missing feature of
that plugin which could be fixed.


Jan



From jan.wine at zerebecki.de  Sun Apr  6 05:21:34 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sun, 6 Apr 2008 12:21:34 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <23410889.1207241395827.JavaMail.root@elwamui-darkeyed.atl.sa.earthlink.net>
References: <23410889.1207241395827.JavaMail.root@elwamui-darkeyed.atl.sa.earthlink.net>
Message-ID: <20080406102134.GQ3557@crissy.swd.zerebecki.de>

On Thu, Apr 03, 2008 at 12:49:55PM -0400, Susan Cragin wrote:
> Back to the initial question:
> 
> Given what we have existing, right now, is there any set of instructions or workarounds that makes WINE apps work best?
> even
> killall pulseaudio ??

Yes, stopping PA and using alsa directly probably works best.

The other options are either using the alsa->pulse plugin or the oss
wrapper of pulse. When I tested it the alsa->pulse plugin worked fine
with the applications running under wine I tested, but you need to
configure alsa correctly and there are still a few known problems (so it
doesn't work as good for everything as directly using alsa). I didn't
test the oss wrapper and I don't think it's usefull to invest time in
that, the alsa->pulse plugin is the way to go.


Jan



From jan.wine at zerebecki.de  Sun Apr  6 05:27:51 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sun, 6 Apr 2008 12:27:51 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <200804030146.18372.stefan@codeweavers.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<7e33d29b0804020808m558534f8q1d7430c219cfbc26@mail.gmail.com>
	<200804030146.18372.stefan@codeweavers.com>
Message-ID: <20080406102751.GR3557@crissy.swd.zerebecki.de>

On Thu, Apr 03, 2008 at 01:46:18AM +0200, Stefan D?singer wrote:
> Am Mittwoch, 2. April 2008 17:08:06 schrieb Bryan Haskins:
> > I'm more interested in a direct pulseaudio gateway for Wine... since by
> > application sound control is the biggest thing here for most people....
> > wine is treated as one big audio blob. Pulse sees it as one thing.
> Isn't that a PulseAudio limitation? I am sure that Wine opens a new Alsa 
> connection for each Windows application that uses sound. I don't know how PA 
> groups the input, but it can surely find different Wine inputs from Alsa.

Yes, more precicely it's about how the alsa->pulse plugin tries to
identify different applications. It gets the real process name (the
loader), not the one wine changed to. The plugin could use that, but it
would also be nice if the plugin would take an optional argument to set
the name explicitly like on can with the pulse api.


Jan



From jan.wine at zerebecki.de  Sun Apr  6 05:32:40 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sun, 6 Apr 2008 12:32:40 +0200
Subject: re pulse issues
In-Reply-To: <14704625.1207148574344.JavaMail.root@elwamui-polski.atl.sa.earthlink.net>
References: <14704625.1207148574344.JavaMail.root@elwamui-polski.atl.sa.earthlink.net>
Message-ID: <20080406103240.GS3557@crissy.swd.zerebecki.de>

On Wed, Apr 02, 2008 at 11:02:54AM -0400, Susan Cragin wrote:
> ALSA lib pcm.c:2106:(snd_pcm_open_conf) Cannot open shared library /usr/lib/alsa-lib/libasound_module_pcm_pulse.so
> ALSA lib pcm.c:2106:(snd_pcm_open_conf) Cannot open shared library /usr/lib/alsa-lib/libasound_module_pcm_pulse.so

I guess this is a missconfiguration of your system. (Perhaps you don't
have the alsa->pluse plugin installed?) You can try with aplay if you
get sound out of pulse to make sure it's not Wines fault.


Jan



From jan.wine at zerebecki.de  Sun Apr  6 06:23:54 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sun, 6 Apr 2008 13:23:54 +0200
Subject: Time zone info
In-Reply-To: <47F780FB.5090109@atomnet.co.uk>
References: <20080405185005.91bcec65.mle+win@mega-nerd.com>
	<00ad01c896f4$c37aa300$a600fea9@DMITRY>
	<20080405192344.4960570f.mle+win@mega-nerd.com>
	<47F780FB.5090109@atomnet.co.uk>
Message-ID: <20080406112354.GT3557@crissy.swd.zerebecki.de>

On Sat, Apr 05, 2008 at 02:39:07PM +0100, Ben Hodgetts wrote:
> Erik de Castro Lopo wrote:
> > Dmitry Timoshkov wrote:

> >> Please do not use "Reply-To:" header when posting wine-devel.

> > I'm sorry, but why not? Isn't that the bext way to indicate
> > that I would prefer to have replies sent to the list rather
> > than directly to me?

> Because replies are always supposed to go to the list anyway, it's 
> rather redundant.

Then where's the harm? Besides that it perhaps doesn't do what you want,
see http://cr.yp.to/proto/replyto.html for a good explanation.


Jan



From hverbeet at gmail.com  Sun Apr  6 07:50:20 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Sun, 6 Apr 2008 14:50:20 +0200
Subject: d3dx9: Implementation of D3DXGetShaderSize
In-Reply-To: <47F8036A.5030408@ilidium.com>
References: <47F8036A.5030408@ilidium.com>
Message-ID: <d658b69e0804060550n1a31505p695b6280332177e6@mail.gmail.com>

On 06/04/2008, Luis Busquets <luis.busquets at ilidium.com> wrote:
> This function obtains the size of a shader bytestream. It does so looking
> for the End token.
>

>+UINT D3DXGetShaderSize(DWORD * pFunction)
I would expect this to take a const pointer. Also, there's no reason
to use Microsoft's (broken) naming conventions for function arguments.

> + while (*address!=0x0000ffff) {
> +   /*Let's check if the next DWORD is a comment*/
> +   if ((*address&0x0000ffff)==0x0000fffe) {
> +                address=address+((*address >> 0x10) & 0x00007fff);
> +                }
> +   address=address+0x1;
> +  }
It would help readability quite a bit to use the proper constants
here. Also, please try to use an indentation style consistent with the
rest of the dll and wine (this goes for the other patches as well).

> + size=(address-pFunction+0x1)*sizeof(DWORD);
Why the +1 here? Does it return the size without the end token itself?
Tests and comments are always helpful there.


The following (untested!) implementation looks more reasonable to me:

UINT D3DXGetShaderSize(const DWORD *byte_code)
{
    const DWORD *ptr = byte_code;

    if (!ptr) return 0;

    /* Look for the END token, skipping the VERSION token */
    while (*++ptr != D3DSIO_END) {
        /* Skip comments */
        if ((*ptr & D3DSI_OPCODE_MASK) == D3DSIO_COMMENT) {
            ptr += ((*ptr & D3DSI_COMMENTSIZE_MASK) >> D3DSI_COMMENTSIZE_SHIFT);
        }
    }

    /* Return the shader size in bytes, excluding the END token. */
    return (ptr - (byte_code + 1)) * sizeof(*ptr);
}


From hverbeet at gmail.com  Sun Apr  6 08:12:40 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Sun, 6 Apr 2008 15:12:40 +0200
Subject: d3dx9: Implementation of D3DXGetFVFVertexSize
In-Reply-To: <47F803E9.2060605@ilidium.com>
References: <47F803E9.2060605@ilidium.com>
Message-ID: <d658b69e0804060612o97649cn12255061c8d3d5dc@mail.gmail.com>

On 06/04/2008, Luis Busquets <luis.busquets at ilidium.com> wrote:
> Implementation of D3DXGetFVFVertexSize. It does so by calculating all the
> different publicly available posible vertex configuration types.
>

>+  switch (FVF & D3DFVF_XYZB5) {
You should probably use D3DFVF_POSITION_MASK instead here.

>+  for (i=0;i<((FVF&0x0f00) >> 16);i++) {
This doesn't look right. Right shifting (FVF & 0x0f00) by 16 will
always produce 0. Tests should have caught that.


From hverbeet at gmail.com  Sun Apr  6 08:14:04 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Sun, 6 Apr 2008 15:14:04 +0200
Subject: d3dx8: Implementation of D3DXGetFVFVertexSize
In-Reply-To: <47F80450.4060102@ilidium.com>
References: <47F80450.4060102@ilidium.com>
Message-ID: <d658b69e0804060614p2684b47eg1dcc934a6eb476a6@mail.gmail.com>

On 06/04/2008, Luis Busquets <luis.busquets at ilidium.com> wrote:
> Implementation of D3DXGetFVFVertexSize. It does so by calculating all the
> different publicly available posible vertex configuration types.
>
Same comments as for the d3dx9 version apply. (Why isn't the d3dx9
version a forward to d3dx8?)


From saulius2 at ar.fi.lt  Sun Apr  6 08:25:08 2008
From: saulius2 at ar.fi.lt (Saulius Krasuckas)
Date: Sun, 6 Apr 2008 16:25:08 +0300 (EEST)
Subject: LoadStringW [1/2]
In-Reply-To: <006401c895f9$07c167d0$a600fea9@DMITRY>
References: <4794545B.4000909@procyongames.com><005101c85c07$b280a180$a600fea9@DMITRY><000601c85c08$f006a440$a600fea9@DMITRY><4794FD3E.2080204@procyongames.com><22821af30801211217g22c09c8bu597659ab11aafff0@mail.gmail.com>
	<479504E4.4080401@procyongames.com><22821af30801211252l30be545cqc9cf37bb4b89451c@mail.gmail.com><47950AEF.9060409@procyongames.com>
	<Pine.LNX.4.62.0804032333300.6745@tvarka.ar.fi.lt>
	<006401c895f9$07c167d0$a600fea9@DMITRY>
Message-ID: <Pine.LNX.4.62.0804061603190.17765@tvarka.ar.fi.lt>

* On Fri, 4 Apr 2008, Dmitry Timoshkov wrote:
> 
> If the regression can be identified by someone able to read the code and 
> not by a regression test that doesn't matter.

Could you show me appropriate code lines of LoadStringA and a logic to 
follow, please?  I am schocked.

Dmitry, for me your statement is true only in the case of reading original 
code of appropriate DLL from MS :(


From stefan at codeweavers.com  Sun Apr  6 10:41:05 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 6 Apr 2008 17:41:05 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <20080406102751.GR3557@crissy.swd.zerebecki.de>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<200804030146.18372.stefan@codeweavers.com>
	<20080406102751.GR3557@crissy.swd.zerebecki.de>
Message-ID: <200804061741.05956.stefan@codeweavers.com>

Am Sonntag, 6. April 2008 12:27:51 schrieb Jan Zerebecki:
> Yes, more precicely it's about how the alsa->pulse plugin tries to
> identify different applications. It gets the real process name (the
> loader), not the one wine changed to. The plugin could use that, but it
> would also be nice if the plugin would take an optional argument to set
> the name explicitly like on can with the pulse api.
I don't see how the process name or a process identification is a proper 
primary key for sound clients. They should rather use the alsa primary 
buffers requested by the apps rather than the process identification. They 
could still use the process name as a description for the user interface, 
using anything not directly sound API related like PID, process name, ..., as 
the identifier for a sound client is broken IMHO.


From stefan at codeweavers.com  Sun Apr  6 10:46:00 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 6 Apr 2008 17:46:00 +0200
Subject: 0003-wined3d-Filter-invalid-stuff-in-SetStreamSourceFreq
In-Reply-To: <47F8E64D.3080205@web.de>
References: <47F8E64D.3080205@web.de>
Message-ID: <200804061746.00346.stefan@codeweavers.com>

Am Sonntag, 6. April 2008 17:03:41 schrieb Rico Sch?ller:
> Hi,
>
> this patch filters out invalid parameter in SetStreamSourceFreq(). The
> test for that is 0005-d3d9-add-stream_test-with-instancing. So apply
> this first, otherwise the tests will fail on wine.
You should write some message that the function returns an error, e.g. 
WARN("INSTANCEDATA used on stream 0, returning D3DERR_INVALIDCALL\n"); This 
eases debugging. I prefer a WARN for such cases. It won't be printed with the 
default FIXME loglevel, as it could be caused by an app bug, but it is more 
significant than a TRACE, since an invalid function call could be caused by 
incorrect behavior of Wine earlier on.


From stefan at codeweavers.com  Sun Apr  6 10:48:11 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 6 Apr 2008 17:48:11 +0200
Subject: 0004-wined3d-improve-drawStridedInstanced
In-Reply-To: <47F8E741.7000501@web.de>
References: <47F8E741.7000501@web.de>
Message-ID: <200804061748.12082.stefan@codeweavers.com>

Am Sonntag, 6. April 2008 17:07:45 schrieb Rico Sch?ller:
> Hi,
>
> this patch solves a rendering problem with instances. Affected games are
> Crysis and Gothic3. The test for this is in
> 0005-d3d9-add-stream_test-with-instancing. So apply this first,
> otherwise the tests will fail on wine.
I think a comment why you're breaking out of the loop here would be helpful, 
perhaps mentioning the testcase in d3d9/tests. The same applies to the 0 
instances -> 1 instance override


From stefan at codeweavers.com  Sun Apr  6 10:49:41 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 6 Apr 2008 17:49:41 +0200
Subject: 0005-d3d9-add-stream_test-with-instancing
In-Reply-To: <47F8E80E.5090403@web.de>
References: <47F8E80E.5090403@web.de>
Message-ID: <200804061749.42059.stefan@codeweavers.com>

Am Sonntag, 6. April 2008 17:11:10 schrieb Rico Sch?ller:
> Hi,
>
> this is a patch, which contains a test for instancing. It proves the
> behavior from these two patches:
Alexandre: Note that this test needs my 
D3DCREATE_SOFTWARE_VERTEXPROCESSING->D3DCREATE_HARDWARE_VERTEXPROCESSING to 
work on Windows


From actong88 at gmail.com  Sun Apr  6 11:29:06 2008
From: actong88 at gmail.com (Allan Tong)
Date: Sun, 6 Apr 2008 12:29:06 -0400
Subject: [2/6] d3d9: Remove some test trace lines
In-Reply-To: <200804052318.25518.stefan@codeweavers.com>
References: <200804052318.25518.stefan@codeweavers.com>
Message-ID: <d75158870804060929m6d147aa1ucc2850143e399c50@mail.gmail.com>

On Sat, Apr 5, 2008 at 5:18 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
>
>  I think they're not needed any more now that the test works

For what it's worth, this test fails for me with fbos.

 - Allan

From jan.wine at zerebecki.de  Sun Apr  6 12:04:48 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sun, 6 Apr 2008 19:04:48 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <200804061741.05956.stefan@codeweavers.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<200804030146.18372.stefan@codeweavers.com>
	<20080406102751.GR3557@crissy.swd.zerebecki.de>
	<200804061741.05956.stefan@codeweavers.com>
Message-ID: <20080406170448.GU3557@crissy.swd.zerebecki.de>

On Sun, Apr 06, 2008 at 05:41:05PM +0200, Stefan D?singer wrote:
> Am Sonntag, 6. April 2008 12:27:51 schrieb Jan Zerebecki:
> > Yes, more precicely it's about how the alsa->pulse plugin tries to
> > identify different applications. It gets the real process name (the
> > loader), not the one wine changed to. The plugin could use that, but it
> > would also be nice if the plugin would take an optional argument to set
> > the name explicitly like on can with the pulse api.
> I don't see how the process name or a process identification is a proper 
> primary key for sound clients. They should rather use the alsa primary 
> buffers requested by the apps rather than the process identification. They 
> could still use the process name as a description for the user interface, 
> using anything not directly sound API related like PID, process name, ..., as 
> the identifier for a sound client is broken IMHO.

It results in the behaviour that the user would expect. E.g. that one
game you start retains the same settings everytime it creates a primary
buffer (thus that it retains the settings on the next start) and the
voice chat client also always retains it's separate setting.

I'd expect most pulse using applications use one identifier for their
whole application (and the same one on each start).

There is nothing like that identifier in alsa and AFAIK neither in
dsound/winmm.


Jan



From xixsimplicityxix at gmail.com  Sun Apr  6 12:49:53 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Sun, 6 Apr 2008 12:49:53 -0500
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <20080406170448.GU3557@crissy.swd.zerebecki.de>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<200804030146.18372.stefan@codeweavers.com>
	<20080406102751.GR3557@crissy.swd.zerebecki.de>
	<200804061741.05956.stefan@codeweavers.com>
	<20080406170448.GU3557@crissy.swd.zerebecki.de>
Message-ID: <78a7dad00804061049q75188e23p6b6882140ac12ef1@mail.gmail.com>

On Sun, Apr 6, 2008 at 12:04 PM, Jan Zerebecki <jan.wine at zerebecki.de> wrote:
>  It results in the behaviour that the user would expect. E.g. that one
>  game you start retains the same settings everytime it creates a primary
>  buffer (thus that it retains the settings on the next start) and the
>  voice chat client also always retains it's separate setting.
>
>  I'd expect most pulse using applications use one identifier for their
>  whole application (and the same one on each start).
>

I guess this whole system provided per app sound preference thing
seems weird to me.  From a  design stand point, does it not make sense
for apps that use sound to expect they should maintain their own sound
settings and reuse them on startup.

To design this into the system seems like a workaround for apps that
fail to properly maintain their own sound preferences. Wouldn't it be
better to patch those apps?

Just my .005 cent,
John


From stefan at codeweavers.com  Sun Apr  6 13:00:23 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Sun, 6 Apr 2008 20:00:23 +0200
Subject: [2/6] d3d9: Remove some test trace lines
In-Reply-To: <d75158870804060929m6d147aa1ucc2850143e399c50@mail.gmail.com>
References: <200804052318.25518.stefan@codeweavers.com>
	<d75158870804060929m6d147aa1ucc2850143e399c50@mail.gmail.com>
Message-ID: <200804062000.23756.stefan@codeweavers.com>

Am Sonntag, 6. April 2008 18:29:06 schrieb Allan Tong:
> On Sat, Apr 5, 2008 at 5:18 PM, Stefan D?singer <stefan at codeweavers.com> 
wrote:
> >  I think they're not needed any more now that the test works
>
> For what it's worth, this test fails for me with fbos.
Ya, quite sure since part of the behavior is not implemented yet, most 
importantly clearing the green and blue channels of R32F. What I meant is 
that it works on Windows, so we know what we can expect and should return 
from Wine. However, when I see the lines in a Windows test output it always 
takes me two looks to figure out that they are not failures



From jan.wine at zerebecki.de  Sun Apr  6 13:38:14 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sun, 6 Apr 2008 20:38:14 +0200
Subject: Pulse Audio -- Wine should have instructions on this web site
In-Reply-To: <78a7dad00804061049q75188e23p6b6882140ac12ef1@mail.gmail.com>
References: <11523290.1207138264468.JavaMail.root@elwamui-little.atl.sa.earthlink.net>
	<200804030146.18372.stefan@codeweavers.com>
	<20080406102751.GR3557@crissy.swd.zerebecki.de>
	<200804061741.05956.stefan@codeweavers.com>
	<20080406170448.GU3557@crissy.swd.zerebecki.de>
	<78a7dad00804061049q75188e23p6b6882140ac12ef1@mail.gmail.com>
Message-ID: <20080406183814.GV3557@crissy.swd.zerebecki.de>

On Sun, Apr 06, 2008 at 12:49:53PM -0500, John Klehm wrote:
> On Sun, Apr 6, 2008 at 12:04 PM, Jan Zerebecki <jan.wine at zerebecki.de> wrote:
> >  It results in the behaviour that the user would expect. E.g. that one
> >  game you start retains the same settings everytime it creates a primary
> >  buffer (thus that it retains the settings on the next start) and the
> >  voice chat client also always retains it's separate setting.
> >
> >  I'd expect most pulse using applications use one identifier for their
> >  whole application (and the same one on each start).
> >
> 
> I guess this whole system provided per app sound preference thing
> seems weird to me.  From a  design stand point, does it not make sense
> for apps that use sound to expect they should maintain their own sound
> settings and reuse them on startup.

That would mean duplicate code for every application... With that
logic defined in a central place you can change it, like group
configurations together, e.g. all your games use the same volume setting
but your voice chat uses another.

> To design this into the system seems like a workaround for apps that
> fail to properly maintain their own sound preferences. Wouldn't it be
> better to patch those apps?

Besides the application doesn't even know about such things as on which
physical output it's sound plays...


Jan



From dank at kegel.com  Sun Apr  6 13:43:40 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 6 Apr 2008 11:43:40 -0700
Subject: Free apps bundled with msvcr70?
Message-ID: <a71bd89a0804061143v1352e387mbf1ff57264eefe27@mail.gmail.com>

(This may sound like a repeat question, but last time I
was asking about msvcr71, and thanks to the answers,
that's now in winetricks.)

Anybody have a good download link for an app that
comes bundled with msvcr70 and msvcp70,
i.e. one that was compiled with visual studio 2002?


From luis.busquets at ilidium.com  Sun Apr  6 13:47:03 2008
From: luis.busquets at ilidium.com (Luis Busquets)
Date: Sun, 06 Apr 2008 20:47:03 +0200
Subject: d3dx8: Implementation of D3DXGetFVFVertexSize
In-Reply-To: <d658b69e0804060614p2684b47eg1dcc934a6eb476a6@mail.gmail.com>
References: <47F80450.4060102@ilidium.com>
	<d658b69e0804060614p2684b47eg1dcc934a6eb476a6@mail.gmail.com>
Message-ID: <47F91AA7.301@ilidium.com>

Sorry, actually, the title of d3dx9 was d3dx8. Both patches patch the 
same file.
H. Verbeet escribi?:
> On 06/04/2008, Luis Busquets <luis.busquets at ilidium.com> wrote:
>   
>> Implementation of D3DXGetFVFVertexSize. It does so by calculating all the
>> different publicly available posible vertex configuration types.
>>
>>     
> Same comments as for the d3dx9 version apply. (Why isn't the d3dx9
> version a forward to d3dx8?)
>
>
>   



From dank at kegel.com  Sun Apr  6 13:47:12 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 6 Apr 2008 11:47:12 -0700
Subject: appdb needs to list 0.9.47 in the pulldown, please
Message-ID: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>

Can somebody change the appdb to allow submitting
results against 0.9.47?  I think that's what Gutsy's
bundled version of wine is.
Somebody just submitted bogus results (with the wrong wine
version) because we lack that option.


From chmorgan at gmail.com  Sun Apr  6 13:56:43 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Sun, 6 Apr 2008 14:56:43 -0400
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>
Message-ID: <f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>

The appdb code currently prunes the list to several of the most recent
versions so people don't submit entries against older or obsolete
versions.

Is it really useful to have test results submitted such an old version
when we almost always ask users to upgrade to the latest version in
the #winehq channel or in bugzilla?

We do mention that if their version is older than the listed version
the user should upgrade. Users that submit results with the wrong or
old version may mean well but may not be the kind of test results we
want to rely on.

Chris



On Sun, Apr 6, 2008 at 2:47 PM, Dan Kegel <dank at kegel.com> wrote:
> Can somebody change the appdb to allow submitting
>  results against 0.9.47?  I think that's what Gutsy's
>  bundled version of wine is.
>  Somebody just submitted bogus results (with the wrong wine
>  version) because we lack that option.
>
>
>


From dank at kegel.com  Sun Apr  6 14:02:07 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 6 Apr 2008 12:02:07 -0700
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>
	<f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>
Message-ID: <a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>

On Sun, Apr 6, 2008 at 11:56 AM, Chris Morgan <chmorgan at gmail.com> wrote:
> The appdb code currently prunes the list to several of the most recent
>  versions so people don't submit entries against older or obsolete
>  versions.

Of course.  It's just a question of the right cutoff.
It seems reasonable to me to include the version bundled with gutsy,
even if it's getting old, because gutsy is so popular.

>  Is it really useful to have test results submitted such an old version
>  when we almost always ask users to upgrade to the latest version in
>  the #winehq channel or in bugzilla?

Perhaps.  Some things did run ok with it, and we have had some
regressions since then.

>  We do mention that if their version is older than the listed version
>  the user should upgrade. Users that submit results with the wrong or
>  old version may mean well but may not be the kind of test results we
>  want to rely on.

Sure, but one goes to market with the users one has, not with the
users one wishes one had :-)
- Dan


From wine-devel at kievinfo.com  Sun Apr  6 14:42:48 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 06 Apr 2008 13:42:48 -0600
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>	<f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>
	<a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>
Message-ID: <47F927B8.4030402@kievinfo.com>

Dan Kegel wrote:
> On Sun, Apr 6, 2008 at 11:56 AM, Chris Morgan <chmorgan at gmail.com> wrote:
>> The appdb code currently prunes the list to several of the most recent
>>  versions so people don't submit entries against older or obsolete
>>  versions.
> 
> Of course.  It's just a question of the right cutoff.
> It seems reasonable to me to include the version bundled with gutsy,
> even if it's getting old, because gutsy is so popular.

That's the whole point of requiring upgrades. And ubuntu can package a newer 
version to their distro as well. I don't see not point in supporting this. 
All Wine versions can and should be considered as bug fixes.

So I really against this. For now we have to force users upgrade if distro 
doesn't.

Vitaliy.


From luis.busquets at ilidium.com  Sun Apr  6 14:59:11 2008
From: luis.busquets at ilidium.com (Luis Busquets)
Date: Sun, 06 Apr 2008 21:59:11 +0200
Subject: d3dx9: Implementation of D3DXGetShaderSize 2/3
In-Reply-To: <d658b69e0804060550n1a31505p695b6280332177e6@mail.gmail.com>
References: <47F8036A.5030408@ilidium.com>
	<d658b69e0804060550n1a31505p695b6280332177e6@mail.gmail.com>
Message-ID: <47F92B8F.5040002@ilidium.com>

The +1 of the end is because finally address points to the end token. So 
+1 is the end token. This function has been tested with all shaders of 
Civilization 4 and has responded successfully.

The attached patch has included the suggestions.


H. Verbeet escribi?:
> On 06/04/2008, Luis Busquets <luis.busquets at ilidium.com> wrote:
>   
>> This function obtains the size of a shader bytestream. It does so looking
>> for the End token.
>>
>>     
>
>   
>> +UINT D3DXGetShaderSize(DWORD * pFunction)
>>     
> I would expect this to take a const pointer. Also, there's no reason
> to use Microsoft's (broken) naming conventions for function arguments.
>
>   
>> + while (*address!=0x0000ffff) {
>> +   /*Let's check if the next DWORD is a comment*/
>> +   if ((*address&0x0000ffff)==0x0000fffe) {
>> +                address=address+((*address >> 0x10) & 0x00007fff);
>> +                }
>> +   address=address+0x1;
>> +  }
>>     
> It would help readability quite a bit to use the proper constants
> here. Also, please try to use an indentation style consistent with the
> rest of the dll and wine (this goes for the other patches as well).
>
>   
>> + size=(address-pFunction+0x1)*sizeof(DWORD);
>>     
> Why the +1 here? Does it return the size without the end token itself?
> Tests and comments are always helpful there.
>
>
> The following (untested!) implementation looks more reasonable to me:
>
> UINT D3DXGetShaderSize(const DWORD *byte_code)
> {
>     const DWORD *ptr = byte_code;
>
>     if (!ptr) return 0;
>
>     /* Look for the END token, skipping the VERSION token */
>     while (*++ptr != D3DSIO_END) {
>         /* Skip comments */
>         if ((*ptr & D3DSI_OPCODE_MASK) == D3DSIO_COMMENT) {
>             ptr += ((*ptr & D3DSI_COMMENTSIZE_MASK) >> D3DSI_COMMENTSIZE_SHIFT);
>         }
>     }
>
>     /* Return the shader size in bytes, excluding the END token. */
>     return (ptr - (byte_code + 1)) * sizeof(*ptr);
> }
>
>
>   

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 1f829dfdd01058915e0ef05d63579a11129ae0bc.diff
Type: text/x-patch
Size: 1717 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080406/834867d9/attachment-0001.bin 

From hverbeet at gmail.com  Sun Apr  6 15:40:53 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Sun, 6 Apr 2008 22:40:53 +0200
Subject: d3dx9: Implementation of D3DXGetShaderSize 2/3
In-Reply-To: <47F92B8F.5040002@ilidium.com>
References: <47F8036A.5030408@ilidium.com>
	<d658b69e0804060550n1a31505p695b6280332177e6@mail.gmail.com>
	<47F92B8F.5040002@ilidium.com>
Message-ID: <d658b69e0804061340l10d9d20aj6ff56a84a404c712@mail.gmail.com>

On 06/04/2008, Luis Busquets <luis.busquets at ilidium.com> wrote:
> The +1 of the end is because finally address points to the end token. So +1
> is the end token. This function has been tested with all shaders of
> Civilization 4 and has responded successfully.
>
My bad, I misread that as (address-(pFunction+0x1)) instead of
((address-pFunction)+0x1)

> +    while (*address!=D3DVS_END()) {
I do think D3DSIO_END would be more appropriate here.


From chmorgan at gmail.com  Sun Apr  6 15:49:41 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Sun, 6 Apr 2008 16:49:41 -0400
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>
	<f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>
	<a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>
Message-ID: <f3f1b91a0804061349k498913c8jcd227a94e14a8de3@mail.gmail.com>

On Sun, Apr 6, 2008 at 3:02 PM, Dan Kegel <dank at kegel.com> wrote:
> On Sun, Apr 6, 2008 at 11:56 AM, Chris Morgan <chmorgan at gmail.com> wrote:
>  > The appdb code currently prunes the list to several of the most recent
>  >  versions so people don't submit entries against older or obsolete
>  >  versions.
>
>  Of course.  It's just a question of the right cutoff.
>  It seems reasonable to me to include the version bundled with gutsy,
>  even if it's getting old, because gutsy is so popular.
>

If we wait another 18 days can we ask users of gutsy to upgrade to hardy? ;-)

 If we ask users to put the wine ubuntu repository in their
sources.list file won't that let them continue to keep up with newer
releases without much difficulty?


>
>  >  Is it really useful to have test results submitted such an old version
>  >  when we almost always ask users to upgrade to the latest version in
>  >  the #winehq channel or in bugzilla?
>
>  Perhaps.  Some things did run ok with it, and we have had some
>  regressions since then.
>

If we don't plan on releasing new versions based on the release in
gutsy, 0.9.47, then I think we've got to consider that version to be
obsolete and unsupported. It also doesn't make much sense for us to be
storing test results for older versions except so we can perform
analysis of the results. We can change the wording to be more explicit
about not submitting results from older versions.


>
>  >  We do mention that if their version is older than the listed version
>  >  the user should upgrade. Users that submit results with the wrong or
>  >  old version may mean well but may not be the kind of test results we
>  >  want to rely on.
>
>  Sure, but one goes to market with the users one has, not with the
>  users one wishes one had :-)
>  - Dan
>

I agree, we can't always choose the kind of data we get. It's up to us
to decide which test results to keep and which ones to discard.

Chris


From dank at kegel.com  Sun Apr  6 16:05:10 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 6 Apr 2008 14:05:10 -0700
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <f3f1b91a0804061349k498913c8jcd227a94e14a8de3@mail.gmail.com>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>
	<f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>
	<a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>
	<f3f1b91a0804061349k498913c8jcd227a94e14a8de3@mail.gmail.com>
Message-ID: <a71bd89a0804061405o7dc65871v94df2bea12329507@mail.gmail.com>

On Sun, Apr 6, 2008 at 1:49 PM, Chris Morgan <chmorgan at gmail.com> wrote:
>  >  It seems reasonable to me to include the version bundled with gutsy,
>  >  even if it's getting old, because gutsy is so popular.
>
>  If we wait another 18 days can we ask users of gutsy to upgrade to hardy? ;-)

Of course.

>   If we ask users to put the wine ubuntu repository in their
>  sources.list file won't that let them continue to keep up with newer
>  releases without much difficulty?

All of your suggestions are along the lines "change the user's behavior"
rather than "adapt winehq to the user's behavior".  While all your
suggestions are fine, they don't change the fact that users are
misbehaving because the appdb doesn't allow reports with Gutsy's
version of wine.
This problem will keep happening with future releases of Ubuntu
if we cut off the version of wine too early, as we do now.

>  If we don't plan on releasing new versions based on the release in
>  gutsy, 0.9.47, then I think we've got to consider that version to be
>  obsolete and unsupported.

By your logic, we should not allow any reports against anything
but the latest version of wine.

>  I agree, we can't always choose the kind of data we get. It's up to us
>  to decide which test results to keep and which ones to discard.

Whatever.  I'm tired of discussing this with you.  If the appdb maintainers
agree with me, they'll make the change.  I don't enough to keep arguing.
- Dan


From stefan at codeweavers.com  Sun Apr  6 16:48:45 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 6 Apr 2008 23:48:45 +0200
Subject: [PATCH 03/15] wined3d: In palette9_changed skip check if
	dxVersion <= 7.
In-Reply-To: <47F93B30.2000405@inbox.lv>
References: <47F93B30.2000405@inbox.lv>
Message-ID: <200804062348.45756.stefan@codeweavers.com>

Am Sonntag, 6. April 2008 23:05:52 schrieb Alexander Dorofeyev:
> Stops it from producing misleading messages in apps that don't use d3d8/9
> style palettes.
Is there no other way to do this? In my opinion dxVersion checks are ugly and 
dxVersion should go away


From chmorgan at gmail.com  Sun Apr  6 16:55:56 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Sun, 6 Apr 2008 17:55:56 -0400
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <a71bd89a0804061405o7dc65871v94df2bea12329507@mail.gmail.com>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>
	<f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>
	<a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>
	<f3f1b91a0804061349k498913c8jcd227a94e14a8de3@mail.gmail.com>
	<a71bd89a0804061405o7dc65871v94df2bea12329507@mail.gmail.com>
Message-ID: <f3f1b91a0804061455u649eca21v7ccaec9efcc702d4@mail.gmail.com>

On Sun, Apr 6, 2008 at 5:05 PM, Dan Kegel <dank at kegel.com> wrote:
> On Sun, Apr 6, 2008 at 1:49 PM, Chris Morgan <chmorgan at gmail.com> wrote:
>  >  >  It seems reasonable to me to include the version bundled with gutsy,
>  >  >  even if it's getting old, because gutsy is so popular.
>  >
>  >  If we wait another 18 days can we ask users of gutsy to upgrade to hardy? ;-)
>
>  Of course.
>
>
>  >   If we ask users to put the wine ubuntu repository in their
>  >  sources.list file won't that let them continue to keep up with newer
>  >  releases without much difficulty?
>
>  All of your suggestions are along the lines "change the user's behavior"
>  rather than "adapt winehq to the user's behavior".  While all your
>  suggestions are fine, they don't change the fact that users are
>  misbehaving because the appdb doesn't allow reports with Gutsy's
>  version of wine.

I'm all for adapting our behavior to better fit with the behavior of
our users. I've spent hundreds of hours working on improving the
appdb.

If there was a good reason stated to accept results for obsoleted
versions then I'd agree with you. In the future I can see a need to
pin certain versions to the available versions list, certainly 1.0
seems like a pretty obvious version to pin to the list for a period of
time.

There are several issues with keeping older test results. We run the
risk of confusing users by showing ratings for Wine releases so old
that the current behavior doesn't match. We can hide these older
versions but why accept them for submission then? If we show them then
we need to consider how to present the ratings so users of newer
versions don't get confused with older versions that come with some
distributions.

By accepting results for older versions we may not be making the user
fully aware that their version is considered to be old.

It's a complex issue that deserves more discussion and may require
more php and ui work to present properly to the user.


>  This problem will keep happening with future releases of Ubuntu
>  if we cut off the version of wine too early, as we do now.
>

I'm a fan of ubuntu, run it on all of my machines etc but that doesn't
automatically mean that test results for older versions are useful. We
are rapidly approaching a 1.0 release and each incremental release has
a wide range of improvements. A user of Gutsy may find it useful to
see test results for 0.9.47 but its likely even more useful for us to
help them upgrade to a version we support, currently the latest
incremental release.


>
>  >  If we don't plan on releasing new versions based on the release in
>  >  gutsy, 0.9.47, then I think we've got to consider that version to be
>  >  obsolete and unsupported.
>
>  By your logic, we should not allow any reports against anything
>  but the latest version of wine.
>

The reason I kept the last several entries on the list was because
some people tend to lag behind in their wine versions. Its
understandable for us to have a window of versions so we can get
reasonably current test results, even if not the most recent test
results. Already the list contains a handful of previous releases,
several months of obsolete versions.


>
>  >  I agree, we can't always choose the kind of data we get. It's up to us
>  >  to decide which test results to keep and which ones to discard.
>
>  Whatever.  I'm tired of discussing this with you.  If the appdb maintainers
>  agree with me, they'll make the change.  I don't enough to keep arguing.
>  - Dan
>

I'm not opposed to a patch that re-adds 0.9.47 version to the list but
I'd like to see a patch that adds a table to keep pinned versions and
php code to manage this list.

Chris


From jerome.gardou at gmail.com  Sun Apr  6 08:37:40 2008
From: jerome.gardou at gmail.com (=?utf-8?q?J=C3=A9r=C3=B4me_Gardou?=)
Date: Sun, 6 Apr 2008 15:37:40 +0200
Subject: ntdll:Add a semi-stub for SystemExecutionState in
	NtPowerInformation
In-Reply-To: <200804052308.59896.jerome.gardou@gmail.com>
References: <200804052308.59896.jerome.gardou@gmail.com>
Message-ID: <200804061537.40814.jerome.gardou@gmail.com>

Le Saturday 05 April 2008 23:08:59, vous avez ?crit?:
> This adds a semi-stub for SystemExecutionState in NtPowerInformation,
> always considering that the user is acting with the computer.

Please ignore this one, I sent the wrong file.


From alexd4 at inbox.lv  Sun Apr  6 17:46:06 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Mon, 07 Apr 2008 01:46:06 +0300
Subject: [PATCH 03/15] wined3d: In palette9_changed skip check if	dxVersion
	<= 7.
In-Reply-To: <200804062348.45756.stefan@codeweavers.com>
References: <47F93B30.2000405@inbox.lv>
	<200804062348.45756.stefan@codeweavers.com>
Message-ID: <47F952AE.1060001@inbox.lv>

Stefan D?singer wrote:
> Am Sonntag, 6. April 2008 23:05:52 schrieb Alexander Dorofeyev:
>> Stops it from producing misleading messages in apps that don't use d3d8/9
>> style palettes.
> Is there no other way to do this? In my opinion dxVersion checks are ugly and 
> dxVersion should go away

Not that I'm aware of. Of course, callers of palette9_changed could do that 
check, but that isn't a meaningful difference. But somewhere it got to be 
determined whether device palettes or per-surface palettes are used, and the one 
and only thing that decides it is the version of directx used.


From actong88 at gmail.com  Sun Apr  6 20:21:27 2008
From: actong88 at gmail.com (Allan Tong)
Date: Sun, 6 Apr 2008 21:21:27 -0400
Subject: [PATCH 14/15] wined3d: Add device->isInDraw checks in
	LoadLocation.
In-Reply-To: <47F93B51.1050508@inbox.lv>
References: <47F93B51.1050508@inbox.lv>
Message-ID: <d75158870804061821k44bfa3aavbe17806d2e5ffea2@mail.gmail.com>

On Sun, Apr 6, 2008 at 5:06 PM, Alexander Dorofeyev <alexd4 at inbox.lv> wrote:
>
>  Prevents calling ActivateContext while holding gl lock, e.g. when
> preloading texture in sampler().

There may be a problem here with drawPrimitive, which calls
LoadLocation before ActivateContext while having isInDraw=TRUE.  If
the primary render target is an offscreen FBO surface, LoadLocation
will follow the SFLAG_INTEXTURE path and it may end up making gl calls
without a context in place.

 - Allan


From austinenglish at gmail.com  Sun Apr  6 21:14:59 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 6 Apr 2008 21:14:59 -0500
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <f3f1b91a0804061455u649eca21v7ccaec9efcc702d4@mail.gmail.com>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>
	<f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>
	<a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>
	<f3f1b91a0804061349k498913c8jcd227a94e14a8de3@mail.gmail.com>
	<a71bd89a0804061405o7dc65871v94df2bea12329507@mail.gmail.com>
	<f3f1b91a0804061455u649eca21v7ccaec9efcc702d4@mail.gmail.com>
Message-ID: <b6bb06270804061914w18debe8cqa8d4201064f2958a@mail.gmail.com>

On Sun, Apr 6, 2008 at 4:55 PM, Chris Morgan <chmorgan at gmail.com> wrote:
> On Sun, Apr 6, 2008 at 5:05 PM, Dan Kegel <dank at kegel.com> wrote:
>  > On Sun, Apr 6, 2008 at 1:49 PM, Chris Morgan <chmorgan at gmail.com> wrote:
>  >  >  >  It seems reasonable to me to include the version bundled with gutsy,
>  >  >  >  even if it's getting old, because gutsy is so popular.
>  >

Has anyone considering talking to Canonical about getting a more
recent wine version included in wine? While they understandably don't
want to introduce too new of versions, they also need to take into
account that we release every two weeks, much faster than most other
projects.


From dmitry at codeweavers.com  Sun Apr  6 22:25:47 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 7 Apr 2008 12:25:47 +0900
Subject: LoadStringW [1/2]
References: <4794545B.4000909@procyongames.com><005101c85c07$b280a180$a600fea9@DMITRY><000601c85c08$f006a440$a600fea9@DMITRY><4794FD3E.2080204@procyongames.com><22821af30801211217g22c09c8bu597659ab11aafff0@mail.gmail.com><479504E4.4080401@procyongames.com><22821af30801211252l30be545cqc9cf37bb4b89451c@mail.gmail.com><47950AEF.9060409@procyongames.com><Pine.LNX.4.62.0804032333300.6745@tvarka.ar.fi.lt><006401c895f9$07c167d0$a600fea9@DMITRY>
	<Pine.LNX.4.62.0804061603190.17765@tvarka.ar.fi.lt>
Message-ID: <001e01c8985f$1449e000$a600fea9@DMITRY>

"Saulius Krasuckas" <saulius2 at ar.fi.lt> wrote:

>> If the regression can be identified by someone able to read the code and 
>> not by a regression test that doesn't matter.
> 
> Could you show me appropriate code lines of LoadStringA and a logic to 
> follow, please?  I am schocked.
> 
> Dmitry, for me your statement is true only in the case of reading original 
> code of appropriate DLL from MS :(

I suspect that you will be shocked even more if someone would say that
something is really wrong out there if there is a need to explain what
this list is about, how the patch review process is going, and which code
is reviewed in the process.

-- 
Dmitry.


From dmitry at codeweavers.com  Sun Apr  6 23:06:13 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 7 Apr 2008 13:06:13 +0900
Subject: ntoskrnl.exe: [1/2] Implement KeQueryActiveProcessors
References: <1207509909.7210.8.camel@p4>
Message-ID: <010001c89865$03c7e550$a600fea9@DMITRY>

"Detlef Riekenberg" <wine.dev at web.de> wrote:

> +KAFFINITY WINAPI KeQueryActiveProcessors( void )
> +{
> +    DWORD_PTR   AffinityMask;
> +
> +    if (GetProcessAffinityMask( GetCurrentProcess(), &AffinityMask, NULL)) {
> +        return AffinityMask;
> +    }
> +
> +    /* No Idea, what to do, when GetProcessAffinityMask fail.
> +       We use the first Processor */
> +    return 1;
> +}

GetProcessAffinityMask() should never fail for the current process, so there is
no need to add bogus code for that case.

-- 
Dmitry.


From dmitry at codeweavers.com  Sun Apr  6 23:08:17 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 7 Apr 2008 13:08:17 +0900
Subject: ntoskrnl.exe: [2/2] Implement KeQueryInterruptTime
References: <1207509947.7210.11.camel@p4>
Message-ID: <010101c89865$083a5aa0$a600fea9@DMITRY>

"Detlef Riekenberg" <wine.dev at web.de> wrote:

> +ULONGLONG WINAPI KeQueryInterruptTime( void )
> +{
> +    ULONGLONG   totaltime;
> +
> +    KeQueryTickCount( (LARGE_INTEGER *) &totaltime);
> +    return totaltime;
> +}

Why not have a local variable of type LARGE_INTEGER and return
li.QuadPart ?

-- 
Dmitry.


From alexd4 at inbox.lv  Mon Apr  7 01:30:20 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Mon, 07 Apr 2008 09:30:20 +0300
Subject: [PATCH 14/15] wined3d: Add device->isInDraw checks
	in	LoadLocation.
In-Reply-To: <d75158870804061821k44bfa3aavbe17806d2e5ffea2@mail.gmail.com>
References: <47F93B51.1050508@inbox.lv>
	<d75158870804061821k44bfa3aavbe17806d2e5ffea2@mail.gmail.com>
Message-ID: <47F9BF7C.9020009@inbox.lv>

Oh, you are right. Must be fixed some other way then, I guess, maybe moving 
assignment to isInDraw lower or moving ActivateContext higher. From what I 
understood from Bioshock bug (http://bugs.winehq.org/show_bug.cgi?id=9973), 
moving ActivateContext in drawPrimitive produces bugs in other programs, right? 
Could you add to that bug a short description of what games etc needed to 
reproduce these problems?

Allan Tong wrote:
> On Sun, Apr 6, 2008 at 5:06 PM, Alexander Dorofeyev <alexd4 at inbox.lv> wrote:
>>  Prevents calling ActivateContext while holding gl lock, e.g. when
>> preloading texture in sampler().
> 
> There may be a problem here with drawPrimitive, which calls
> LoadLocation before ActivateContext while having isInDraw=TRUE.  If
> the primary render target is an offscreen FBO surface, LoadLocation
> will follow the SFLAG_INTEXTURE path and it may end up making gl calls
> without a context in place.
> 
>  - Allan



From kai.blin at gmail.com  Mon Apr  7 02:07:25 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 7 Apr 2008 09:07:25 +0200
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <b6bb06270804061914w18debe8cqa8d4201064f2958a@mail.gmail.com>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>
	<f3f1b91a0804061455u649eca21v7ccaec9efcc702d4@mail.gmail.com>
	<b6bb06270804061914w18debe8cqa8d4201064f2958a@mail.gmail.com>
Message-ID: <200804070907.29375.kai.blin@gmail.com>

On Monday 07 April 2008 04:14:59 Austin English wrote:

> Has anyone considering talking to Canonical about getting a more
> recent wine version included in wine? While they understandably don't
> want to introduce too new of versions, they also need to take into
> account that we release every two weeks, much faster than most other
> projects.

Not going to work. The whole point of a distribution release is to keep the 
versions of the programs stable and just do security fixes. That way, you're 
safe from any potential regression in the programs you're using. I agree that 
Wine tends to release too often for the usual distro release cycle, but I'd 
argue that so far we've not done a too good job about _not_ having 
regressions. So I doubt the distros will upgrade the Wine versions 
post-release.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080407/468f7fe5/attachment.pgp 

From fgouget at free.fr  Mon Apr  7 02:53:11 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 7 Apr 2008 09:53:11 +0200 (CEST)
Subject: Proposal: versioning .wine directory
In-Reply-To: <200803302037.56555.stefan@codeweavers.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
Message-ID: <alpine.DEB.1.00.0804070951420.31312@amboise.dolphin>

On Sun, 30 Mar 2008, Stefan D?singer wrote:

> Am Sonntag, 30. M?rz 2008 20:46:08 schrieb Austin English:
> > My comment from the bug:
> > "How about a little file in .wine  or a registry key that is read upon
> > running wine, and should match the current wine version. If it doesn't,
> > call wineprefixcreate (or pop up an error saying that the registry is
> > outdated), which then updates that key to the current wine version.
> > Shouldn't be too much overhead and prevents quite a few problems."
> In the past I've had more problems with wineprefixcreate trashing my registry 
> than I had with outdated registry entries. Especially if you have Internet 
> Explorer or the DirectX SDK or runtime installed running wineprefixcreate has 
> bad side effects.

If that's still the case it's probably because wine.inf overwrites 
registry keys that it shouldn't and then this needs fixing. Otherwise it 
means we cannot do upgrades at all.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
            "Lotto: A tax on people who are bad at math." -- unknown
          "Windows: Microsoft's tax on computer illiterates." -- WE7U

From fgouget at free.fr  Mon Apr  7 03:02:28 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 7 Apr 2008 10:02:28 +0200 (CEST)
Subject: Proposal: versioning .wine directory
In-Reply-To: <19e31a080803312157g5fbf318gb8d41edc44b5afe@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<47F1AE9D.6020500@gmail.com>
	<19e31a080803312157g5fbf318gb8d41edc44b5afe@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0804070955280.31312@amboise.dolphin>

On Tue, 1 Apr 2008, Steven Edwards wrote:

> On Mon, Mar 31, 2008 at 11:40 PM, TheBlunderbuss
> <tehblunderbuss at gmail.com> wrote:
> >  I like it, since I already do something like this!
> >  How about a more surreptitious way of marking versions? Maybe a reg key
> >  or other file.
> >  This way, users might not be tempted to rename their ~/.wine and also
> >  keep the 1.0 transition smoother for scripts, say.
> 
> Embedding the full version number maybe including the git ID of the
> source used as a string value in the Wine key should be enough.

Git commitids cannot be used for this purpose because they are not 
ordered. This means you'd have no idea if 
f294dda7498052dd7d3fa69d87cc539fa633217f is a pre-1.0 or not, 5 years 
old or a few minutes old. So you'd never know what to do / tell the user 
just based on the Git commitid.

So including the Git commitid is feasible and maybe even a good idea, 
but its only use would be for developers. Even then it would be better 
if it was embedded in the individual dll's version information as they 
may not all come from the same codebase.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
             Research is the transformation of money to knowledge.
            Innovation is the transformation of knowledge to money.
                              -- Dr. Hans Meixner


From stefan at codeweavers.com  Mon Apr  7 03:05:05 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 7 Apr 2008 10:05:05 +0200
Subject: [PATCH 14/15] wined3d: Add device->isInDraw checks
	=?iso-8859-1?q?in=09LoadLocation=2E?=
In-Reply-To: <47F9BF7C.9020009@inbox.lv>
References: <47F93B51.1050508@inbox.lv>
	<d75158870804061821k44bfa3aavbe17806d2e5ffea2@mail.gmail.com>
	<47F9BF7C.9020009@inbox.lv>
Message-ID: <200804071005.05714.stefan@codeweavers.com>

Am Montag, 7. April 2008 08:30:20 schrieb Alexander Dorofeyev:
> Oh, you are right. Must be fixed some other way then, I guess, maybe moving
> assignment to isInDraw lower or moving ActivateContext higher. From what I
> understood from Bioshock bug (http://bugs.winehq.org/show_bug.cgi?id=9973),
> moving ActivateContext in drawPrimitive produces bugs in other programs,
> right? Could you add to that bug a short description of what games etc
> needed to reproduce these problems?
There are two design issues here:

One is that FindContext, which executes before the wglMakeCurrent call does 
OpenGL calls. In some situations it has to do, e.g. reading the texture from 
a Pbuffer before switching to some other buffer, in some cases it can't, e.g. 
on a thread switch. I am not sure about the solution yet, but maybe we have 
to ActivateContext the old render target in FindContext before reading back 
textures if we find a thread switch and target switch at the same time.

The other issue, and that's the problem with Bioshock, is that ActivateContext 
isn't really aware of the FBO stuff. I've been discussing this with Henri 
some time ago, but we didn't find a solution. The nicest way would be to make 
ActivateContext select tge fbo, color buffer 0 and the depth stencil, and to 
make color buffers 1+ regular states handled in the state table. 
Unfortunately that doesn't work because drivers don't like it if we activate 
an incomplete fbo.



From fgouget at free.fr  Mon Apr  7 03:40:41 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 7 Apr 2008 10:40:41 +0200 (CEST)
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
	<19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>
	<22821af30803281201m61f97a09g50ab810d0d73b60e@mail.gmail.com>
	<19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0804071039060.31312@amboise.dolphin>

On Fri, 28 Mar 2008, Steven Edwards wrote:

> On Fri, Mar 28, 2008 at 3:01 PM, James Hawkins <truiken at gmail.com> wrote:
> >  What is the process for making this switch?  Do we need to contact
> >  Paul Millar?  The lack of a new winetest is putting a hamper on our
> >  efforts to fix up the tests in Windows.
> 
> There should just be a few rules that need to be changed as far as I
> know. Thats all that was needed for the programs case, I cannot Imagen
> why the tests would be any more complex. If Alexandre has not already
> done so, I'll look at it and submit patches tonight.

Maybe we can have separate targets:
make crosstest    would build PE tests using Wine's headers and libraries
make mingwtest    would build PE tests using MinGW's headers and libraries

This would let us test either configuration.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                         Stolen from an Internet user:
              "f u cn rd ths, u cn gt a gd jb n cmptr prgrmmng !"


From fgouget at free.fr  Mon Apr  7 04:30:56 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 7 Apr 2008 11:30:56 +0200 (CEST)
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <f3f1b91a0804061455u649eca21v7ccaec9efcc702d4@mail.gmail.com>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>
	<f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>
	<a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>
	<f3f1b91a0804061349k498913c8jcd227a94e14a8de3@mail.gmail.com>
	<a71bd89a0804061405o7dc65871v94df2bea12329507@mail.gmail.com>
	<f3f1b91a0804061455u649eca21v7ccaec9efcc702d4@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0804071124550.31312@amboise.dolphin>

On Sun, 6 Apr 2008, Chris Morgan wrote:
[...]
> I'm all for adapting our behavior to better fit with the behavior of
> our users. I've spent hundreds of hours working on improving the
> appdb.
> 
> If there was a good reason stated to accept results for obsoleted
> versions then I'd agree with you. In the future I can see a need to
> pin certain versions to the available versions list, certainly 1.0
> seems like a pretty obvious version to pin to the list for a period of
> time.

If the cutoff is '0.9.48' (for instance), then maybe we could add a 
'pre-0.9.48' version. That way users looking for '0.9.47' would know 
what to use. This would also let bugzilla maintainers easily spot bugs 
against obsolete versions.

Then when the cutoff evolves to 0.9.53 or whatever we would rename the 
'pre-0.9.48' version to 'pre-0.9.53', etc. If renaming versions is not 
allowed in Bugzilla, then we'd need a more stable name for the catch all 
version, maybe something like 'older versions' or ome such.

The one remaining problem may be to get the version order-right but that 
can probably be solved by getting creative with the version name, e.g. 
'0.9.47.or.older'.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
     We are Pentium of Borg. You will be approximated. Division is futile.


From hverbeet at gmail.com  Mon Apr  7 04:34:33 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 7 Apr 2008 11:34:33 +0200
Subject: wined3d: Check for NULL vertex declarations
In-Reply-To: <200804070203.25962.chris.kcat@gmail.com>
References: <200804070203.25962.chris.kcat@gmail.com>
Message-ID: <d658b69e0804070234r33bf7d53m7e3b98514db2f174@mail.gmail.com>

On 07/04/2008, Chris Robinson <chris.kcat at gmail.com> wrote:
> +    if(!This->stateBlock->vertexDecl) {
> +        WARN("(%p) : Called without a valid vertex buffer set\n", This);
That WARN is misleading.


From stefan at codeweavers.com  Mon Apr  7 04:43:50 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 7 Apr 2008 11:43:50 +0200
Subject: wined3d: Check for NULL vertex declarations
In-Reply-To: <d658b69e0804070234r33bf7d53m7e3b98514db2f174@mail.gmail.com>
References: <200804070203.25962.chris.kcat@gmail.com>
	<d658b69e0804070234r33bf7d53m7e3b98514db2f174@mail.gmail.com>
Message-ID: <200804071143.51170.stefan@codeweavers.com>

Am Montag, 7. April 2008 11:34:33 schrieb H. Verbeet:
> On 07/04/2008, Chris Robinson <chris.kcat at gmail.com> wrote:
> > +    if(!This->stateBlock->vertexDecl) {
> > +        WARN("(%p) : Called without a valid vertex buffer set\n", This);
>
> That WARN is misleading.
This problem also affects the other draw calls, DrawIndexedPrimitiveUP, 
DrawPrimitive and drawPrimitiveUP. In a certain way it even affects 
DrawRectPatch and DrawTriPatch(when tesselating a new patch)


From stefan at codeweavers.com  Mon Apr  7 04:43:50 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 7 Apr 2008 11:43:50 +0200
Subject: wined3d: Check for NULL vertex declarations
In-Reply-To: <d658b69e0804070234r33bf7d53m7e3b98514db2f174@mail.gmail.com>
References: <200804070203.25962.chris.kcat@gmail.com>
	<d658b69e0804070234r33bf7d53m7e3b98514db2f174@mail.gmail.com>
Message-ID: <200804071143.51170.stefan@codeweavers.com>

Am Montag, 7. April 2008 11:34:33 schrieb H. Verbeet:
> On 07/04/2008, Chris Robinson <chris.kcat at gmail.com> wrote:
> > +    if(!This->stateBlock->vertexDecl) {
> > +        WARN("(%p) : Called without a valid vertex buffer set\n", This);
>
> That WARN is misleading.
This problem also affects the other draw calls, DrawIndexedPrimitiveUP, 
DrawPrimitive and drawPrimitiveUP. In a certain way it even affects 
DrawRectPatch and DrawTriPatch(when tesselating a new patch)


From stefan at codeweavers.com  Mon Apr  7 04:43:50 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 7 Apr 2008 11:43:50 +0200
Subject: wined3d: Check for NULL vertex declarations
In-Reply-To: <d658b69e0804070234r33bf7d53m7e3b98514db2f174@mail.gmail.com>
References: <200804070203.25962.chris.kcat@gmail.com>
	<d658b69e0804070234r33bf7d53m7e3b98514db2f174@mail.gmail.com>
Message-ID: <200804071143.51170.stefan@codeweavers.com>

Am Montag, 7. April 2008 11:34:33 schrieb H. Verbeet:
> On 07/04/2008, Chris Robinson <chris.kcat at gmail.com> wrote:
> > +    if(!This->stateBlock->vertexDecl) {
> > +        WARN("(%p) : Called without a valid vertex buffer set\n", This);
>
> That WARN is misleading.
This problem also affects the other draw calls, DrawIndexedPrimitiveUP, 
DrawPrimitive and drawPrimitiveUP. In a certain way it even affects 
DrawRectPatch and DrawTriPatch(when tesselating a new patch)


From dank at kegel.com  Mon Apr  7 06:31:48 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 7 Apr 2008 04:31:48 -0700
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <alpine.DEB.1.00.0804071124550.31312@amboise.dolphin>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>
	<f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>
	<a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>
	<f3f1b91a0804061349k498913c8jcd227a94e14a8de3@mail.gmail.com>
	<a71bd89a0804061405o7dc65871v94df2bea12329507@mail.gmail.com>
	<f3f1b91a0804061455u649eca21v7ccaec9efcc702d4@mail.gmail.com>
	<alpine.DEB.1.00.0804071124550.31312@amboise.dolphin>
Message-ID: <a71bd89a0804070431i2c50896dr764445ff4acfe4d7@mail.gmail.com>

On Mon, Apr 7, 2008 at 2:30 AM, Francois Gouget <fgouget at free.fr> wrote:
>  If the cutoff is '0.9.48' (for instance), then maybe we could add a
>  'pre-0.9.48' version.

Sounds too confusing to me, offhand.  I'd rather stick with the current
situation of having a too-early cutoff.

>  That way users looking for '0.9.47' would know
>  what to use. This would also let bugzilla maintainers easily spot bugs
>  against obsolete versions.

You mean appdb...
- Dan


From dank at kegel.com  Mon Apr  7 07:40:14 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 7 Apr 2008 05:40:14 -0700
Subject: Fwd: [ubuntu-x] Future of digitizing tablet support in xorg?
In-Reply-To: <20080407044655.GC15327@bryceharrington.org>
References: <a71bd89a0804061105m4156aeb9oba00328186fb31e1@mail.gmail.com>
	<20080407044655.GC15327@bryceharrington.org>
Message-ID: <a71bd89a0804070540s1ad86ebat1ac6cb088a1a49a0@mail.gmail.com>

I ran one of our X issues by Bryce Harrington.  Here's his reply:


---------- Forwarded message ----------
From: Bryce Harrington <bryce at canonical.com>
Date: Sun, Apr 6, 2008 at 9:46 PM
Subject: Re: [ubuntu-x] Future of digitizing tablet support in xorg?
To: Dan Kegel <dank at kegel.com>
Cc: ubuntu-x at lists.ubuntu.com



On Sun, Apr 06, 2008 at 11:05:30AM -0700, Dan Kegel wrote:
 > At the moment, users of digitizing tablet
 > often have to compile x drivers themselves (!), e.g.
 > https://help.ubuntu.com/community/Wacom
 > https://help.ubuntu.com/community/TabletSetupWizardpen
 > which seems rather a throwback to the 90's.
 > And even if they don't have to compile the drivers
 > themselves, it seems users still have to edit xorg.conf.
 >
 > What are the prospects for moving from the current
 > situation to plug'n'play nirvana?
 >
 > I ask because Wine is getting good enough that
 > tablet issues like this are starting to become limiting
 > factors for Photoshop use in Ubuntu.

 For hardy we experimented with the new input hotplugging in xserver 1.4
 (Timo in particular did extensive testing of it).  Unfortunately, the
 new HAL approach with fdi files was proving to be even more complicated
 to configure than editing xorg.conf.  Timo's testing also was turning up
 bugs a bit too readily.  So we decided to hold off on it for now, and
 stick with the devil we know.

 The main deficiency that needs to be addressed is input configuration.
 The input hotplugging seems to work fine with default parameters, but as
 soon as a user wishes to set things to non-default values things get
 complicated.  I think before we can really seriously consider moving to
 it, we need to have some configuration tools.

 So, I would like to see as a start, at least some sort of command line
 tool - the input device equivalent of 'xrandr'.  GUI tools would be nice
 but can come in time.

 In addition, as I understand it, each of the input devices need to be
 updated to take advantage of input hotplug - much as each video driver
 has had to be updated to use Xrandr.  So even though some drivers have
 transitioned, it may behoove us to wait until a larger proportion are
 updated.

 Bryce


From uli at suse.de  Mon Apr  7 04:59:06 2008
From: uli at suse.de (Ulrich Hecht)
Date: Mon, 7 Apr 2008 11:59:06 +0200
Subject: WINEDLLPATH, ddiwrapper,
	msvcrt40 (Re: wine based win32 printer drivers)
In-Reply-To: <780857.19559.qm@web23108.mail.ird.yahoo.com>
References: <780857.19559.qm@web23108.mail.ird.yahoo.com>
Message-ID: <200804071159.06739.uli@suse.de>

Hi!

On Saturday 05 April 2008, Hin-Tak Leung wrote:
> 2) (to uli and Till) - do you mind if I put a mod/update of ddiwrapper
> out publicly, or uli can release a new one that works with current
> wine?

Hand it over, and I'll put it on the FTP server and update our package. 

CU
Uli

-- 
SUSE LINUX Products GmbH, GF: Markus Rex, HRB 16746 (AG N?rnberg)


From hverbeet at gmail.com  Mon Apr  7 08:44:14 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 7 Apr 2008 15:44:14 +0200
Subject: d3dx8 :Fix D3DXCreateMatrixStack
In-Reply-To: <5f9140a20804070031g3198085ewf2f70bc194a2a1ab@mail.gmail.com>
References: <5f9140a20804070031g3198085ewf2f70bc194a2a1ab@mail.gmail.com>
Message-ID: <d658b69e0804070644i56884aeap3762023ffba7df8a@mail.gmail.com>

On 07/04/2008, David Adam <david.adam.cnrs at gmail.com> wrote:
>
The commit comment for this patch is rather non-descriptive... what is
this supposed to fix?
An array based stack seems more appropriate than a list based one for
ID3DXMATRIXStack, why change that?


From tony.wasserka at freenet.de  Mon Apr  7 10:22:38 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Mon, 07 Apr 2008 17:22:38 +0200
Subject: d3dx8 :Fix D3DXCreateMatrixStack
Message-ID: <E1JitB8-0006fE-OI@www13.emo.freenet-rz.de>

> The commit comment for this patch is rather non-descriptive... what is
> this supposed to fix?
> An array based stack seems more appropriate than a list based one for
> ID3DXMATRIXStack, why change that?

I think so, too (after taking a closer look at the interface documentation at msdn).
Though it ain't really a good argument, but msdn gives a code example
where they show that they use arrays internally:

http://msdn2.microsoft.com/en-us/library/bb174057(VS.85).aspx
m_pstack[m_currentPos] = m_pstack[m_currentPos] * (*pMat);





Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain inkl.
http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/index.html



From hverbeet at gmail.com  Mon Apr  7 11:08:35 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 7 Apr 2008 18:08:35 +0200
Subject: d3dx8: D3DXCreateMatrix
In-Reply-To: <5f9140a20804070857x66fcb39dnd61ae52d8f41210c@mail.gmail.com>
References: <5f9140a20804070857x66fcb39dnd61ae52d8f41210c@mail.gmail.com>
Message-ID: <d658b69e0804070908r4ebc59f1s4fe8d7df4b3c4770@mail.gmail.com>

On 07/04/2008, David Adam <david.adam.cnrs at gmail.com> wrote:
> I agree that the good implementation is with array.
>
> The bad thing is that we must bound the size of the array ourself. I think
> that a size of 64 or 128 for the array is enough, right?
>
Well no, you keep track of the array size and grow it when it's too
small when doing a push.


From tony.wasserka at freenet.de  Mon Apr  7 11:46:25 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Mon, 07 Apr 2008 18:46:25 +0200
Subject: d3dx8: D3DXCreateMatrixStack
Message-ID: <E1JiuUD-0002aL-US@www15.emo.freenet-rz.de>

> Well no, you keep track of the array size and grow it when it's too
> small when doing a push.

i.e. HeapReAlloc
http://msdn2.microsoft.com/en-us/library/aa366704(VS.85).aspx

You may optimize that if you allocate space for 2 or so matrices at once,
as it decreases the number of HeapReAlloc calls. However, for a basic
implementation this isn't relevant, yet.











From david.adam.cnrs at gmail.com  Mon Apr  7 10:57:18 2008
From: david.adam.cnrs at gmail.com (David Adam)
Date: Mon, 7 Apr 2008 17:57:18 +0200
Subject: d3dx8: D3DXCreateMatrix
Message-ID: <5f9140a20804070857x66fcb39dnd61ae52d8f41210c@mail.gmail.com>

I agree that the good implementation is with array.

The bad thing is that we must bound the size of the array ourself. I think
that a size of 64 or 128 for the array is enough, right?

The advantage of a list is that we do not need to take care about the size.

David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080407/66374a19/attachment.htm 

From htl10 at users.sourceforge.net  Mon Apr  7 13:02:02 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Mon, 7 Apr 2008 18:02:02 +0000 (GMT)
Subject: a proposed fix for bug 11690 concerning hhctrl.ocx
Message-ID: <421448.94978.qm@web23114.mail.ird.yahoo.com>

Hi Jacek and James - according to git, you two are the ones last working on the part 
of code which I have a possible fix for bug 11690 (see the bug report for somebody 
tested okay something like this), so I'd like to see what you think of this patch, specially (and others can chip in as well...) Here is what I think:

NavigateToUrl() in hhctrl.ocx/help.c is only used by the HH_HELP_CONTEXT case in HtmpHelpW() in hhctrl.ocx/hhctrl.c - I think in some circumstances, it may return a full url, but in the case of bug 11690, it returns a "relative" one inside the same CHM,
so the code in NavigateToUrl() should drop through to look up in chm. The top part of
NavigateToUrl() is really wrong because it assumes a IWebbrowser_navigate would fail
on a relative url and drop through, but the way I see it, Iwebbrower_navigate should return the status of whether talking to IE/gecko is successful, not whether they gets "404 not found".

I have a few questions for you two:
1) is there any known case where HH_HELP_CONTEXT returns a fully formed URL? (i.e. if 
this change is committed, it is going to break something else?)

2) Since NavigateToUrl is only used once (and it needs to drop through to NavigateToChm() in most cases, pending your answer question 1), wouldn't it make sense
to just remove it?

Thanks,
Hin-Tak 


      ___________________________________________________________ 
Yahoo! For Good helps you make a difference  

http://uk.promotions.yahoo.com/forgood/


From htl10 at users.sourceforge.net  Mon Apr  7 13:41:47 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Mon, 7 Apr 2008 18:41:47 +0000 (GMT)
Subject: a proposed fix for bug 11690 concerning hhctrl.ocx
Message-ID: <75057.76372.qm@web23109.mail.ird.yahoo.com>

apologies - there was a typo in that patch - should be looking for "://"
rather than "::/" . Otherwise my questions are the same.


--- On Mon, 7/4/08, Hin-Tak Leung <htl10 at users.sourceforge.net> wrote:

> From: Hin-Tak Leung <htl10 at users.sourceforge.net>
> Subject: a proposed fix for bug 11690 concerning hhctrl.ocx
> To: jacek at codeweavers.com, truiken at gmail.com
> Cc: wine-devel at winehq.org
> Date: Monday, 7 April, 2008, 7:02 PM
> Hi Jacek and James - according to git, you two are the ones
> last working on the part 
> of code which I have a possible fix for bug 11690 (see the
> bug report for somebody 
> tested okay something like this), so I'd like to see
> what you think of this patch, specially (and others can
> chip in as well...) Here is what I think:
> 
> NavigateToUrl() in hhctrl.ocx/help.c is only used by the
> HH_HELP_CONTEXT case in HtmpHelpW() in hhctrl.ocx/hhctrl.c
> - I think in some circumstances, it may return a full url,
> but in the case of bug 11690, it returns a
> "relative" one inside the same CHM,
> so the code in NavigateToUrl() should drop through to look
> up in chm. The top part of
> NavigateToUrl() is really wrong because it assumes a
> IWebbrowser_navigate would fail
> on a relative url and drop through, but the way I see it,
> Iwebbrower_navigate should return the status of whether
> talking to IE/gecko is successful, not whether they gets
> "404 not found".
> 
> I have a few questions for you two:
> 1) is there any known case where HH_HELP_CONTEXT returns a
> fully formed URL? (i.e. if 
> this change is committed, it is going to break something
> else?)
> 
> 2) Since NavigateToUrl is only used once (and it needs to
> drop through to NavigateToChm() in most cases, pending your
> answer question 1), wouldn't it make sense
> to just remove it?
> 
> Thanks,
> Hin-Tak 
> 
> 
>      
> ___________________________________________________________
> 
> Yahoo! For Good helps you make a difference  
> 
> http://uk.promotions.yahoo.com/forgood/


      ___________________________________________________________ 
Yahoo! For Good helps you make a difference  

http://uk.promotions.yahoo.com/forgood/


From wine.dev at web.de  Mon Apr  7 14:18:41 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Mon, 07 Apr 2008 21:18:41 +0200
Subject: ntoskrnl.exe: [2/2][try 2] Implement KeQueryInterruptTime
In-Reply-To: <010101c89865$083a5aa0$a600fea9@DMITRY>
References: <1207509947.7210.11.camel@p4>
	<010101c89865$083a5aa0$a600fea9@DMITRY>
Message-ID: <1207595921.7208.17.camel@p4>

Updated with the hints from Dmitry:

On Mo, 2008-04-07 at 13:08 +0900, Dmitry Timoshkov wrote:
> Why not have a local variable of type LARGE_INTEGER and return
> li.QuadPart ? 

Thanks.


Changelog:
ntoskrnl.exe: Implement KeQueryInterruptTime



-- 
 
By by ... Detlef

-------------- next part --------------


From wine.dev at web.de  Mon Apr  7 14:15:46 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Mon, 7 Apr 2008 21:15:46 +0200
Subject: [PATCH] ntoskrnl.exe: Implement KeQueryInterruptTime
Message-ID: <mailman.343.1207595943.3731.wine-devel@winehq.org>

---
 dlls/ntoskrnl.exe/ntoskrnl.c        |   15 +++++++++++++++
 dlls/ntoskrnl.exe/ntoskrnl.exe.spec |    2 +-
 2 files changed, 16 insertions(+), 1 deletions(-)

diff --git a/dlls/ntoskrnl.exe/ntoskrnl.c b/dlls/ntoskrnl.exe/ntoskrnl.c
index cd155f7..cf1603a 100644
--- a/dlls/ntoskrnl.exe/ntoskrnl.c
+++ b/dlls/ntoskrnl.exe/ntoskrnl.c
@@ -529,6 +529,21 @@ KAFFINITY WINAPI KeQueryActiveProcessors( void )
 }
 
 
+/**********************************************************************
+ *           KeQueryInterruptTime   (NTOSKRNL.EXE.@)
+ *
+ * Return the interrupt time count
+ *
+ */
+ULONGLONG WINAPI KeQueryInterruptTime( void )
+{
+    LARGE_INTEGER totaltime;
+
+    KeQueryTickCount(&totaltime);
+    return totaltime.QuadPart;
+}
+
+
 /***********************************************************************
  *           KeQuerySystemTime   (NTOSKRNL.EXE.@)
  */
diff --git a/dlls/ntoskrnl.exe/ntoskrnl.exe.spec b/dlls/ntoskrnl.exe/ntoskrnl.exe.spec
index dbab0fa..3aef928 100644
--- a/dlls/ntoskrnl.exe/ntoskrnl.exe.spec
+++ b/dlls/ntoskrnl.exe/ntoskrnl.exe.spec
@@ -570,7 +570,7 @@
 @ stub KeProfileInterruptWithSource
 @ stub KePulseEvent
 @ stdcall KeQueryActiveProcessors()
-@ stub KeQueryInterruptTime
+@ stdcall KeQueryInterruptTime()
 @ stub KeQueryPriorityThread
 @ stub KeQueryRuntimeThread
 @ stdcall KeQuerySystemTime(ptr)
-- 
1.5.3.6


--=-oFvDd6DcI7KSHqULwGWS--



From xixsimplicityxix at gmail.com  Mon Apr  7 16:05:02 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Mon, 7 Apr 2008 16:05:02 -0500
Subject: appDB: Nice URLs live demo and code review
Message-ID: <78a7dad00804071405u1e227840r37c45d7f839b9c85@mail.gmail.com>

Give nice urls a whirl at:
http://appdb.klehm.net/app/"yoursearchtermhere"

Search Examples:
http://appdb.klehm.net/app/adobe
http://appdb.klehm.net/app/visual

Direct Link Examples:
http://appdb.klehm.net/app/photoshop
http://appdb.klehm.net/app/command-conquer-red-alert-2

See the nice urls being used internally:
http://appdb.klehm.net/appbrowse.php?iCatId=5


Right now as it is I have it indexing only the app family names; no
versions or vendors get any love.

There is one piece of functionality missing before this can go in and
that is to do an index of a new record upon creation.

If anyone wants to test just apply the patch set and then flip
APPDB_ENABLE_NICE_URLS_INDEXER to true and then run: runIndexer.php.
Be sure to flip enable indexer back to false before doing anything
else =P.

You also need to set allow_url_fopen = On in your php.ini.
If this is deemed to be unacceptable then we have to functionalize the
objectManager.php file so matchByVerbAndTerm can generate similar
output.  Using url fopen allows easiest integration.


After that you should be good to go to test.

Essentially less terms will work better and the matching "nice" name
depends entirely upon whatever the maintainer entered for the app
family name.

Let me know if any changes need be made otherwise ill send it in later
this week.

Regards,
John Klehm
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 0001-htaccess-enable-rewrite-engine-and-provide-rule.patch.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080407/a7c6e2da/attachment-0007.txt 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 0002-config.php-Add-global-switches-for-nice-urls-fu.patch.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080407/a7c6e2da/attachment-0008.txt 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 0003-include-nice_urls.php-Util-functions-for-nice-u.patch.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080407/a7c6e2da/attachment-0009.txt 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 0004-runIndexer.php-Script-that-indexes-existing-dat.patch.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080407/a7c6e2da/attachment-0010.txt 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 0005-matchByVerbAndTerm.php-view-that-calls-into-the.patch.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080407/a7c6e2da/attachment-0011.txt 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 0006-apidb.sql-Add-search-index-table.patch.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080407/a7c6e2da/attachment-0012.txt 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 0007-include-application.php-if-nice-urls-are-on-the.patch.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080407/a7c6e2da/attachment-0013.txt 

From hintak_leung at yahoo.co.uk  Mon Apr  7 13:09:09 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Mon, 7 Apr 2008 18:09:09 +0000 (GMT)
Subject: a proposed fix for bug 11690 concerning hhctrl.ocx
Message-ID: <909850.98444.qm@web23112.mail.ird.yahoo.com>

apologies - there was a typo in that patch - should be looking for "://"
rather than "::/" . Otherwise my questions are the same.

--- On Mon, 7/4/08, Hin-Tak Leung <htl10 at users.sourceforge.net> wrote:

> From: Hin-Tak Leung <htl10 at users.sourceforge.net>
> Subject: a proposed fix for bug 11690 concerning hhctrl.ocx
> To: jacek at codeweavers.com, truiken at gmail.com
> Cc: wine-devel at winehq.org
> Date: Monday, 7 April, 2008, 7:02 PM
> Hi Jacek and James - according to git, you two are the ones
> last working on the part 
> of code which I have a possible fix for bug 11690 (see the
> bug report for somebody 
> tested okay something like this), so I'd like to see
> what you think of this patch, specially (and others can
> chip in as well...) Here is what I think:
> 
> NavigateToUrl() in hhctrl.ocx/help.c is only used by the
> HH_HELP_CONTEXT case in HtmpHelpW() in hhctrl.ocx/hhctrl.c
> - I think in some circumstances, it may return a full url,
> but in the case of bug 11690, it returns a
> "relative" one inside the same CHM,
> so the code in NavigateToUrl() should drop through to look
> up in chm. The top part of
> NavigateToUrl() is really wrong because it assumes a
> IWebbrowser_navigate would fail
> on a relative url and drop through, but the way I see it,
> Iwebbrower_navigate should return the status of whether
> talking to IE/gecko is successful, not whether they gets
> "404 not found".
> 
> I have a few questions for you two:
> 1) is there any known case where HH_HELP_CONTEXT returns a
> fully formed URL? (i.e. if 
> this change is committed, it is going to break something
> else?)
> 
> 2) Since NavigateToUrl is only used once (and it needs to
> drop through to NavigateToChm() in most cases, pending your
> answer question 1), wouldn't it make sense
> to just remove it?
> 
> Thanks,
> Hin-Tak 
> 
> 
>      
> ___________________________________________________________
> 
> Yahoo! For Good helps you make a difference  
> 
> http://uk.promotions.yahoo.com/forgood/


      ___________________________________________________________ 
Yahoo! For Good helps you make a difference  

http://uk.promotions.yahoo.com/forgood/


From chmorgan at gmail.com  Mon Apr  7 16:41:01 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Mon, 7 Apr 2008 17:41:01 -0400
Subject: appDB: Nice URLs live demo and code review
In-Reply-To: <78a7dad00804071405u1e227840r37c45d7f839b9c85@mail.gmail.com>
References: <78a7dad00804071405u1e227840r37c45d7f839b9c85@mail.gmail.com>
Message-ID: <f3f1b91a0804071441p22999575j70c27ae3303671a1@mail.gmail.com>

Hey John.

Looks like you've gotten the nice urls working, great job man. It will
be great to have this before 1.0 is shipped since it will make our
urls a lot nicer looking.

I had a few comments about the code changes. You don't follow the
variable naming convention of the appdb. We have some prefixes for
variables that we use to keep the types of variables straight, you can
find these in the coding standards file in the root of the appdb tree.

The code in 0005-matchByVerbAndTerm.php-view-that-calls-into-the.patch.txt
looks like it is using query_appdb() to perform a direct query. The
indexing code also appears to do this. We prefer using the query
wrapper function query_parameters() as this performs escaping of input
parameters and helps to reduce the possibility of sql injection
vulnerabilities.

I noticed the code to perform the grouped inserts. What is the
performance difference between perform the inserts individually vs.
grouped together? If we run the indexer daily and its relatively quick
we may be able to drop the complexity of worrying about how many
inserts we can group together.

0005-matchByVerbAndTerm.php-view-that-calls-into-the.patch.txt appears
to be generating output for display. It would be useful to have some
comments at the head of the file to describe what the file is used for
and why it would need to conditionally output lists when don't find a
object page match.

Thanks,
Chris




On Mon, Apr 7, 2008 at 5:05 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> Give nice urls a whirl at:
>  http://appdb.klehm.net/app/"yoursearchtermhere"
>
>  Search Examples:
>  http://appdb.klehm.net/app/adobe
>  http://appdb.klehm.net/app/visual
>
>  Direct Link Examples:
>  http://appdb.klehm.net/app/photoshop
>  http://appdb.klehm.net/app/command-conquer-red-alert-2
>
>  See the nice urls being used internally:
>  http://appdb.klehm.net/appbrowse.php?iCatId=5
>
>
>  Right now as it is I have it indexing only the app family names; no
>  versions or vendors get any love.
>
>  There is one piece of functionality missing before this can go in and
>  that is to do an index of a new record upon creation.
>
>  If anyone wants to test just apply the patch set and then flip
>  APPDB_ENABLE_NICE_URLS_INDEXER to true and then run: runIndexer.php.
>  Be sure to flip enable indexer back to false before doing anything
>  else =P.
>
>  You also need to set allow_url_fopen = On in your php.ini.
>  If this is deemed to be unacceptable then we have to functionalize the
>  objectManager.php file so matchByVerbAndTerm can generate similar
>  output.  Using url fopen allows easiest integration.
>
>
>  After that you should be good to go to test.
>
>  Essentially less terms will work better and the matching "nice" name
>  depends entirely upon whatever the maintainer entered for the app
>  family name.
>
>  Let me know if any changes need be made otherwise ill send it in later
>  this week.
>
>  Regards,
>  John Klehm
>
>
>
>


From actong88 at gmail.com  Mon Apr  7 16:54:03 2008
From: actong88 at gmail.com (Allan Tong)
Date: Mon, 7 Apr 2008 17:54:03 -0400
Subject: [PATCH 14/15] wined3d: Add device->isInDraw checks in
	LoadLocation.
In-Reply-To: <47F9BF7C.9020009@inbox.lv>
References: <47F93B51.1050508@inbox.lv>
	<d75158870804061821k44bfa3aavbe17806d2e5ffea2@mail.gmail.com>
	<47F9BF7C.9020009@inbox.lv>
Message-ID: <d75158870804071454p4e9cd5c8u44c0dc719ff6f2e5@mail.gmail.com>

On Mon, Apr 7, 2008 at 2:30 AM, Alexander Dorofeyev <alexd4 at inbox.lv> wrote:
> Oh, you are right. Must be fixed some other way then, I guess, maybe moving
> assignment to isInDraw lower or moving ActivateContext higher. From what I
> understood from Bioshock bug (http://bugs.winehq.org/show_bug.cgi?id=9973),
> moving ActivateContext in drawPrimitive produces bugs in other programs,
> right? Could you add to that bug a short description of what games etc
> needed to reproduce these problems?

I added a comment to the bug, but I'm afraid I don't really know the
details about how to reproduce the problem as I never experienced it.
I think Stefan was the one who mentioned the rendering problems in HL2
Lost Coast, so maybe he can give you more details?

On another note, what are the thoughts about leaving these
ActivateContext calls the way they are now?  As things currently
stand, a lot of these calls are only interested in making sure there
is an active gl context by doing ActivateContext(device,
device->lastActiveRenderTarget, CTXUSAGE_RESOURCELOAD).  This is
essentially a NOP if there was a previous call to ActivateContext, so
if you have something like:

ActivateContext(device, target, usage);
...
ENTER_GL();
...
ActivateContext(device, lastActiveRenderTarget, CTXUSAGE_RESOURCELOAD);
...
LEAVE_GL();


the second ActivateContext should be harmless, even if it's not ideal
from a design standpoint.

 - Allan


From ken at codeweavers.com  Mon Apr  7 17:18:30 2008
From: ken at codeweavers.com (Ken Thomases)
Date: Mon, 7 Apr 2008 17:18:30 -0500
Subject: Alexandre Julliard : winex11: Fix handling of property sizes for
	64-bit platforms.
In-Reply-To: <E1Jipry-0000po-OY@wine.codeweavers.com>
References: <E1Jipry-0000po-OY@wine.codeweavers.com>
Message-ID: <4E48F8CB-620B-4BAB-9461-FB1374FC368D@codeweavers.com>

On Apr 7, 2008, at 6:50 AM, Alexandre Julliard wrote:
> Module: wine
> Branch: master
> Commit: 3bfa90eedafc9bd2faf9bc421caa172547e8ddd6
> URL:    http://source.winehq.org/git/wine.git/? 
> a=commit;h=3bfa90eedafc9bd2faf9bc421caa172547e8ddd6
>
> Author: Alexandre Julliard <julliard at winehq.org>
> Date:   Mon Apr  7 11:41:54 2008 +0200
>
> winex11: Fix handling of property sizes for 64-bit platforms.
>
> diff --git a/dlls/winex11.drv/clipboard.c b/dlls/winex11.drv/ 
> clipboard.c
> index 2996857..2404a71 100644
> --- a/dlls/winex11.drv/clipboard.c
> +++ b/dlls/winex11.drv/clipboard.c
> @@ -1902,8 +1902,8 @@ static int X11DRV_CLIPBOARD_QueryAvailableData 
> (LPCLIPBOARDINFO lpcbinfo)
>          * The TARGETS property should have returned us a list of  
> atoms
>          * corresponding to each selection target format supported.
>          */
> -       if (atype == XA_ATOM || atype == x11drv_atom(TARGETS))
> -           X11DRV_CLIPBOARD_InsertSelectionProperties(display,  
> targetList, (cSelectionTargets * aformat / (8 * sizeof(Atom))));
> +       if (aformat == 32 && (atype == XA_ATOM || atype ==  
> x11drv_atom(TARGETS)))
> +           X11DRV_CLIPBOARD_InsertSelectionProperties(display,  
> targetList, cSelectionTargets);
>
>         /* Free the list of targets */
>         wine_tsx11_lock();

This appears to revert a30327afef7b08d1aac1943ded64ee363a61c537.   
That commit worked around a quartz-wm bug where it responds to the  
TARGETS query with a format of 8.

-Ken


From xixsimplicityxix at gmail.com  Mon Apr  7 17:35:45 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Mon, 7 Apr 2008 17:35:45 -0500
Subject: appDB: Nice URLs live demo and code review
In-Reply-To: <f3f1b91a0804071441p22999575j70c27ae3303671a1@mail.gmail.com>
References: <78a7dad00804071405u1e227840r37c45d7f839b9c85@mail.gmail.com>
	<f3f1b91a0804071441p22999575j70c27ae3303671a1@mail.gmail.com>
Message-ID: <78a7dad00804071535r75c3bc5fxc97513666be3419c@mail.gmail.com>

On Mon, Apr 7, 2008 at 4:41 PM, Chris Morgan <chmorgan at gmail.com> wrote:
> Hey John.
>
>  Looks like you've gotten the nice urls working, great job man. It will
>  be great to have this before 1.0 is shipped since it will make our
>  urls a lot nicer looking.
>
>  I had a few comments about the code changes. You don't follow the
>  variable naming convention of the appdb. We have some prefixes for
>  variables that we use to keep the types of variables straight, you can
>  find these in the coding standards file in the root of the appdb tree.
>

Right, oops.

>  The code in 0005-matchByVerbAndTerm.php-view-that-calls-into-the.patch.txt
>  looks like it is using query_appdb() to perform a direct query. The
>  indexing code also appears to do this. We prefer using the query
>  wrapper function query_parameters() as this performs escaping of input
>  parameters and helps to reduce the possibility of sql injection
>  vulnerabilities.
>

Well I can certainly use that.  For the params I do call
appdb_escape_query => calls mysql_real_escape_string which I had
thought was the "your injects stop here" escaping func =P

>  I noticed the code to perform the grouped inserts. What is the
>  performance difference between perform the inserts individually vs.
>  grouped together? If we run the indexer daily and its relatively quick
>  we may be able to drop the complexity of worrying about how many
>  inserts we can group together.
>
Well the runIndexer.php is just a one time thing to create the intial
index. If it were run twice there would be doubles of every previous
entry.  Once we have it for the existing data any new data can be
indexed when its state becomes 'accepted' or however the add new app
flow goes.  I have not implemented the "add index values on data
creation" functionality yet though.

Regarding multiple inserts I think this is what was in my head when I
wrote that:

http://dev.mysql.com/doc/refman/5.0/en/insert-speed.html
Right where it reads "You can use the following methods to speed up inserts"

If the multiple inserts are a concern its easy to run them one at a
time just set the config switch APPDB_MYSQL_MAX_INSERTS_PER_QUERY to 1
in the config.php file.

>  0005-matchByVerbAndTerm.php-view-that-calls-into-the.patch.txt appears
>  to be generating output for display. It would be useful to have some
>  comments at the head of the file to describe what the file is used for
>  and why it would need to conditionally output lists when don't find a
>  object page match.
>

Sure Ill write out the code paths in comments at the top, that file
does do a bit.

Thanks for the feedback! =))

John


From alexd4 at inbox.lv  Mon Apr  7 17:35:14 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Tue, 08 Apr 2008 01:35:14 +0300
Subject: [PATCH 14/15] wined3d: Add device->isInDraw checks
	in	LoadLocation.
In-Reply-To: <d75158870804071454p4e9cd5c8u44c0dc719ff6f2e5@mail.gmail.com>
References: <47F93B51.1050508@inbox.lv>	<d75158870804061821k44bfa3aavbe17806d2e5ffea2@mail.gmail.com>	<47F9BF7C.9020009@inbox.lv>
	<d75158870804071454p4e9cd5c8u44c0dc719ff6f2e5@mail.gmail.com>
Message-ID: <47FAA1A2.1030704@inbox.lv>

There's a little problem with consistency about these things. In various related 
routines and paths, there were (and still are) both places that check isInDraw 
and places that don't check it. read_from_framebuffer and 
IWineD3DSurfaceImpl_BindTexture that can be called from LoadLocation are 
examples of each kind. Some kind of single scheme would make it easier to 
follow. Also even NOP ActivateContext(device, lastActiveRenderTarget, 
CTXUSAGE_RESOURCELOAD) create some false positives when using debug traces to 
identify potential problem places where ActivateContext is used inside 
ENTER_GL/LEAVE_GL.

On the other hand, it is pretty tricky. Also Stefan believes adding isInDraw 
checks everywhere isn't especially nice, but ultimately to prevent all 
situations of ActivateContext inside ENTER_GL/LEAVE_GL  with isInDraw approach 
this would've to be added in more places. I'm not sure about this myself, 
perhaps I'll better not hurry with it and some better ideas may come.

Allan Tong wrote:
> I added a comment to the bug, but I'm afraid I don't really know the
> details about how to reproduce the problem as I never experienced it.
> I think Stefan was the one who mentioned the rendering problems in HL2
> Lost Coast, so maybe he can give you more details?
> 
> On another note, what are the thoughts about leaving these
> ActivateContext calls the way they are now?  As things currently
> stand, a lot of these calls are only interested in making sure there
> is an active gl context by doing ActivateContext(device,
> device->lastActiveRenderTarget, CTXUSAGE_RESOURCELOAD).  This is
> essentially a NOP if there was a previous call to ActivateContext, so
> if you have something like:
> 
> ActivateContext(device, target, usage);
> ...
> ENTER_GL();
> ...
> ActivateContext(device, lastActiveRenderTarget, CTXUSAGE_RESOURCELOAD);
> ...
> LEAVE_GL();
> 
> 
> the second ActivateContext should be harmless, even if it's not ideal
> from a design standpoint.
> 
>  - Allan



From smoki00790 at gmail.com  Mon Apr  7 18:37:36 2008
From: smoki00790 at gmail.com (=?ISO-8859-2?Q?Milan_Kosti=E6?=)
Date: Tue, 8 Apr 2008 01:37:36 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
Message-ID: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>

 Ok i'm tested wine and his new GL_ATI_fragment_shader support with
9250 card nad Mesa/DRI driver. Now env bumpmaping and dot3 tests in
3DMark2001 seems to work good, but in car test high ground texture is
black. In DungeonSiege2 i disabled ps in winecfg, because it has same
problem (and more) flickering and black textureon the ground (river
water not show, but on sea it has...). With Painkiller, nothing helps
to start game (disabled ps in winecfg not help), only solution is to
change textured units in driconf from 6 to 5 (this disable
GL_ATI_fragment_shader in driver). I check also NFS: Hot Pursuit2, in
wine-0.58> (this is from some earlier versions, but problem is same)
it has these fixmes:

 fixme:d3d_texture:IWineD3DBaseTextureImpl_ApplyStateChanges
>>>>>>>>>>>>>>>>> GL_INVALID_VALUE (0x501) from glTexParameteri
GL_TEXTURE_MAX_ANISOTROPY_EXT ... @ basetexture.c / 463
 fixme:d3d:get_src_and_opr Unhandled texture argWINED3DTA_SPECULAR

 and now:

 fixme:d3d_texture:IWineD3DBaseTextureImpl_ApplyStateChanges
>>>>>>>>>>>>>>>>> GL_INVALID_VALUE (0x501) from glTexParameteri
GL_TEXTURE_MAX_ANISOTROPY_EXT ... @ basetexture.c / 488
 fixme:d3d_shader:shader_arb_generate_vshader HW VertexShader Error at
position 499: "1046: '.' expected but ';' found"
 fixme:d3d_shader:gen_ati_shader >>>>>>>>>>>>>>>>>
GL_INVALID_OPERATION (0x502) from GL_EXTCALL(glEndFragmentShaderATI())
@ ati_fragment_shader.c / 774

 this fixmes is shifted many times, when i stop/start the some race,
leave the menu, etc. This is first game in which i see gen_ati_shader
in exchange of unhandle texture (NV_combiner thing).

 I wish to ask what is that GL_INVALID_VALUE (0x501) and
GL_INVALID_OPERATION (0x502)??? This 0x501 i can see in many games.


From twickline at gmail.com  Mon Apr  7 19:20:35 2008
From: twickline at gmail.com (Tom Wickline)
Date: Mon, 7 Apr 2008 20:20:35 -0400
Subject: Free apps bundled with msvcr70?
In-Reply-To: <a71bd89a0804061143v1352e387mbf1ff57264eefe27@mail.gmail.com>
References: <a71bd89a0804061143v1352e387mbf1ff57264eefe27@mail.gmail.com>
Message-ID: <53e3a9930804071720m3ce002aby809783c1a5dfb556@mail.gmail.com>

On Sun, Apr 6, 2008 at 2:43 PM, Dan Kegel <dank at kegel.com> wrote:
> (This may sound like a repeat question, but last time I
>  was asking about msvcr71, and thanks to the answers,
>  that's now in winetricks.)
>
>  Anybody have a good download link for an app that
>  comes bundled with msvcr70 and msvcp70,
>  i.e. one that was compiled with visual studio 2002?
>
>
>

Looks as if both of them come with Microsoft .NET Framework 1.0

http://support.microsoft.com/dllhelp/?fid=96502&l=55&det=1

http://support.microsoft.com/dllhelp/

Tom


From twickline at gmail.com  Mon Apr  7 19:26:58 2008
From: twickline at gmail.com (Tom Wickline)
Date: Mon, 7 Apr 2008 20:26:58 -0400
Subject: Free apps bundled with msvcr70?
In-Reply-To: <53e3a9930804071720m3ce002aby809783c1a5dfb556@mail.gmail.com>
References: <a71bd89a0804061143v1352e387mbf1ff57264eefe27@mail.gmail.com>
	<53e3a9930804071720m3ce002aby809783c1a5dfb556@mail.gmail.com>
Message-ID: <53e3a9930804071726s4847648fq95cce01b829ba6e6@mail.gmail.com>

>
>  Looks as if both of them come with Microsoft .NET Framework 1.0
>
>  http://support.microsoft.com/dllhelp/?fid=96502&l=55&det=1
>
>  http://support.microsoft.com/dllhelp/
>
>  Tom
>

Info:
http://web.mit.edu/Kerberos/kfw-2.6/kfw-2.6.5/relnotes.html#requirements

Links:
http://web.mit.edu/kerberos/dist/index.html

http://www.microsoft.com/downloads/details.aspx?FamilyID=9F10CA3B-44DA-4EDF-A5DA-1AEAF5C88165&displaylang=en


From dank at kegel.com  Mon Apr  7 19:52:05 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 7 Apr 2008 17:52:05 -0700
Subject: Free apps bundled with msvcr70?
In-Reply-To: <53e3a9930804071726s4847648fq95cce01b829ba6e6@mail.gmail.com>
References: <a71bd89a0804061143v1352e387mbf1ff57264eefe27@mail.gmail.com>
	<53e3a9930804071720m3ce002aby809783c1a5dfb556@mail.gmail.com>
	<53e3a9930804071726s4847648fq95cce01b829ba6e6@mail.gmail.com>
Message-ID: <a71bd89a0804071752y759bc94cx3b18eb604cdd6602@mail.gmail.com>

On Mon, Apr 7, 2008 at 5:26 PM, Tom Wickline <twickline at gmail.com> wrote:
>  http://web.mit.edu/kerberos/dist/index.html

That's a fine tip, thanks.  (The .net installer doesn't count,
it's not free.)
- Dan


From raccoonone at procyongames.com  Mon Apr  7 22:12:45 2008
From: raccoonone at procyongames.com (Christopher)
Date: Mon, 07 Apr 2008 20:12:45 -0700
Subject: USB Human Interface Device support
In-Reply-To: <b130c85e0803252322s168b9ad3i90b4a93ceca92b51@mail.gmail.com>
References: <47E88B3A.3060003@procyongames.com>	
	<3a768c550803250737n28f9a235ga84d52bc817c3502@mail.gmail.com>	
	<b130c85e0803251348k554ca9b4g1c387b6acc533413@mail.gmail.com>	
	<47E9E70E.6030509@procyongames.com>
	<b130c85e0803252322s168b9ad3i90b4a93ceca92b51@mail.gmail.com>
Message-ID: <47FAE2AD.3040506@procyongames.com>

Maarten Lankhorst wrote:
>   
> It probably asks for the specific keys in
> \ENUM\category\devicename\idname so if you copy these over it will
> probably work. WINEDEBUG=+setupapi is your friend.
>
> Cheers,
> Maarten.
>
>
>   
Thanks for the suggestion. I tried that, and now that some page fault 
bugs are fixed it gets a little further. However looking at the 
+setupapi,+hid traces there are a whole bunch of calls to 
SetupDiEnumDeviceInterfaces and SetupDiGetDeviceInterfaceDetailA, but 
after that nothing and the controller still isn't detected by PhoenixRC. 
Anyone have a suggest as to what I should look into next? I've tried 
transferring both the deviceclasses regkey for HID, and the enum regkeys 
for HID.

Thanks,
Christopher


From stefan at codeweavers.com  Tue Apr  8 00:57:21 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 8 Apr 2008 07:57:21 +0200
Subject: [PATCH 14/15] wined3d: Add device->isInDraw checks
	=?iso-8859-1?q?in=09LoadLocation=2E?=
In-Reply-To: <47FAA1A2.1030704@inbox.lv>
References: <47F93B51.1050508@inbox.lv>
	<d75158870804071454p4e9cd5c8u44c0dc719ff6f2e5@mail.gmail.com>
	<47FAA1A2.1030704@inbox.lv>
Message-ID: <200804080757.22033.stefan@codeweavers.com>

Am Dienstag, 8. April 2008 00:35:14 schrieb Alexander Dorofeyev:
> On the other hand, it is pretty tricky. Also Stefan believes adding
> isInDraw checks everywhere isn't especially nice, but ultimately to prevent
> all situations of ActivateContext inside ENTER_GL/LEAVE_GL  with isInDraw
> approach this would've to be added in more places. I'm not sure about this
> myself, perhaps I'll better not hurry with it and some better ideas may
> come.
The original idea of this flag was to mark that the stateblock is finalized. 
It was never intended to give information about the opengl state(which this 
patches are doing), so if we're doing that we have to work out some ruleset 
about it.


From stefan at codeweavers.com  Tue Apr  8 01:08:13 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Tue, 8 Apr 2008 08:08:13 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
In-Reply-To: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
References: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
Message-ID: <200804080808.14011.stefan@codeweavers.com>

Am Dienstag, 8. April 2008 01:37:36 schrieb Milan Kosti?:
>  I wish to ask what is that GL_INVALID_VALUE (0x501) and
> GL_INVALID_OPERATION (0x502)??? This 0x501 i can see in many games.
GL_INVALID_OPERATION and _VALUE opengl errors. That they show up doesn't give 
more information beyond "meh, this doesn't work", it depends on the other 
details.
 
First of all, which mesa version do you have? Please consider updating to 
7.0.x if you have something older.

>  Ok i'm tested wine and his new GL_ATI_fragment_shader support with
> 9250 card nad Mesa/DRI driver. Now env bumpmaping and dot3 tests in
> 3DMark2001 seems to work good, but in car test high ground texture is
> black. 
I tested 3dmark2001, and I am pretty sure that the texture in the high car 
test worked. I have a radeon 9000 card though, and I talked to a Mesa dev who 
said that there are differences between various card revisions.

> In DungeonSiege2 i disabled ps in winecfg, because it has same 
> problem (and more) flickering and black textureon the ground (river
> water not show, but on sea it has...). With Painkiller, nothing helps
> to start game (disabled ps in winecfg not help), only solution is to
> change textured units in driconf from 6 to 5 (this disable
> GL_ATI_fragment_shader in driver).
Can you file bug reports for those issues if they persist with newer mesa 
versions? Please CC me on those reports.

> I check also NFS: Hot Pursuit2, in 

>  fixme:d3d_texture:IWineD3DBaseTextureImpl_ApplyStateChanges
>
> >>>>>>>>>>>>>>>>> GL_INVALID_VALUE (0x501) from glTexParameteri
>
> GL_TEXTURE_MAX_ANISOTROPY_EXT ... @ basetexture.c / 488
>  fixme:d3d_shader:shader_arb_generate_vshader HW VertexShader Error at
> position 499: "1046: '.' expected but ';' found"
That's a vertex shader issue. I guess the "problem" here is that with the 
availability of more texture rendering features the game switched into a 
different rendering mode which Wine or Mesa do not like too much.

>  fixme:d3d_shader:gen_ati_shader >>>>>>>>>>>>>>>>>
> GL_INVALID_OPERATION (0x502) from GL_EXTCALL(glEndFragmentShaderATI())
> @ ati_fragment_shader.c / 774
I didn't put checkGLcall statements to each fragment operation during shader 
creation to prevent the code from being even more convoluted, but you can add 
them for testing and see which part exactly fails.



From ryuzaki90 at gmail.com  Mon Apr  7 18:27:12 2008
From: ryuzaki90 at gmail.com (Bryan Haskins)
Date: Mon, 7 Apr 2008 19:27:12 -0400
Subject: AppDB Error, must enter to the "what didn't work" section?
Message-ID: <7e33d29b0804071627i68fa18fdkb250115b88331863@mail.gmail.com>

" The following errors were found* Please enter what did not work."
I understand the mechanics of why it says that, but realistically, should it
for this field, be required to have data? For example, with me running WoW,
it's flawless for me. Absolutely no problems, and I'm rating it platinum. If
we're rating it platinum should this at least not be required then?
Conversely, it should be required as a field, when it is rated anything but
platinum, by definition.

Just something I noticed.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080407/3b14d70e/attachment.htm 

From scott at open-vote.org  Tue Apr  8 01:40:29 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Mon, 07 Apr 2008 23:40:29 -0700
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <f3f1b91a0804061455u649eca21v7ccaec9efcc702d4@mail.gmail.com>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>	<f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>	<a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>	<f3f1b91a0804061349k498913c8jcd227a94e14a8de3@mail.gmail.com>	<a71bd89a0804061405o7dc65871v94df2bea12329507@mail.gmail.com>
	<f3f1b91a0804061455u649eca21v7ccaec9efcc702d4@mail.gmail.com>
Message-ID: <47FB135D.3030004@open-vote.org>

Chris Morgan wrote:
> On Sun, Apr 6, 2008 at 5:05 PM, Dan Kegel <dank at kegel.com> wrote:
>> On Sun, Apr 6, 2008 at 1:49 PM, Chris Morgan <chmorgan at gmail.com> wrote:
>>  >  >  It seems reasonable to me to include the version bundled with gutsy,
>>  >  >  even if it's getting old, because gutsy is so popular.
>>  >
>>  >  If we wait another 18 days can we ask users of gutsy to upgrade to hardy? ;-)
>>
>>  Of course.
>>
>>
>>  >   If we ask users to put the wine ubuntu repository in their
>>  >  sources.list file won't that let them continue to keep up with newer
>>  >  releases without much difficulty?
>>
>>  All of your suggestions are along the lines "change the user's behavior"
>>  rather than "adapt winehq to the user's behavior".  While all your
>>  suggestions are fine, they don't change the fact that users are
>>  misbehaving because the appdb doesn't allow reports with Gutsy's
>>  version of wine.
> 
> I'm all for adapting our behavior to better fit with the behavior of
> our users. I've spent hundreds of hours working on improving the
> appdb.
> 
> If there was a good reason stated to accept results for obsoleted
> versions then I'd agree with you. In the future I can see a need to
> pin certain versions to the available versions list, certainly 1.0
> seems like a pretty obvious version to pin to the list for a period of
> time.
> 
> There are several issues with keeping older test results. We run the
> risk of confusing users by showing ratings for Wine releases so old
> that the current behavior doesn't match. We can hide these older
> versions but why accept them for submission then? If we show them then
> we need to consider how to present the ratings so users of newer
> versions don't get confused with older versions that come with some
> distributions.
> 

My policy for Ubuntu is this: there should be no regressions from the
Wine included in one Ubuntu release to the next.  That means, for Hardy,
no regressions from 0.9.47 to whatever I put in Hardy (which will
probably be 0.9.59 after a patch or two).

It's a lot easier for me to do this if we don't prohibit test data for
that version.

> 
> I'm a fan of ubuntu, run it on all of my machines etc but that doesn't
> automatically mean that test results for older versions are useful. We
> are rapidly approaching a 1.0 release and each incremental release has
> a wide range of improvements. A user of Gutsy may find it useful to
> see test results for 0.9.47 but its likely even more useful for us to
> help them upgrade to a version we support, currently the latest
> incremental release.
> 

If their applications are working, then users shouldn't be using the apt
repository and latest Wine version because it might introduce a
regression.  We are, in a very real sense, making AppDB less useful for
them by not including the results.

> I'm not opposed to a patch that re-adds 0.9.47 version to the list but
> I'd like to see a patch that adds a table to keep pinned versions and
> php code to manage this list.
> 

It's not that big a deal now, so long as the Hardy version (0.9.59
likely) stays around for a while ;)

Thanks,
Scott Ritchie


From kai.blin at gmail.com  Tue Apr  8 02:49:27 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Tue, 8 Apr 2008 09:49:27 +0200
Subject: Debian repository down
Message-ID: <200804080949.37628.kai.blin@gmail.com>

Hi folks,

some user just reported on IRC that the wine.budgetdedicated.com repo is down. 
Seems like it's dead for over a day already. Do we know what's up with that 
and do we have an ETA for when it'll be back?

Cheers,
Kai
-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080408/6a13a166/attachment.pgp 

From scott at open-vote.org  Tue Apr  8 03:26:28 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Tue, 08 Apr 2008 01:26:28 -0700
Subject: Debian repository down
In-Reply-To: <200804080949.37628.kai.blin@gmail.com>
References: <200804080949.37628.kai.blin@gmail.com>
Message-ID: <47FB2C34.9030706@open-vote.org>

Kai Blin wrote:
> Hi folks,
> 
> some user just reported on IRC that the wine.budgetdedicated.com repo is down. 
> Seems like it's dead for over a day already. Do we know what's up with that 
> and do we have an ETA for when it'll be back?
> 
> Cheers,
> Kai
> 
> 
> ------------------------------------------------------------------------
> 
> 
No, I don't.

I can still ssh into the server, occasionally, but I don't know why it's
 basically unreachable over http.

Thanks,
Scott Ritchie


From tokul at users.sourceforge.net  Tue Apr  8 03:26:34 2008
From: tokul at users.sourceforge.net (Tomas Kuliavas)
Date: Tue, 8 Apr 2008 11:26:34 +0300 (EEST)
Subject: Debian repository down
In-Reply-To: <47FB2C34.9030706@open-vote.org>
References: <200804080949.37628.kai.blin@gmail.com>
	<47FB2C34.9030706@open-vote.org>
Message-ID: <50967.195.22.180.233.1207643194.nsm@avilys.eik.lt>

>> some user just reported on IRC that the wine.budgetdedicated.com repo is
>> down.
>> Seems like it's dead for over a day already. Do we know what's up with
>> that
>> and do we have an ETA for when it'll be back?
>>
>>
> No, I don't.
>
> I can still ssh into the server, occasionally, but I don't know why it's
>  basically unreachable over http.

Maybe firewall drops packets or some QoS/throttling services or DOS. If
service is not available, connections don't timeout.

-- 
Tomas



From julliard at winehq.org  Tue Apr  8 04:42:41 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 08 Apr 2008 11:42:41 +0200
Subject: Alexandre Julliard : winex11: Fix handling of property sizes for
	64-bit platforms.
In-Reply-To: <4E48F8CB-620B-4BAB-9461-FB1374FC368D@codeweavers.com> (Ken
	Thomases's message of "Mon, 7 Apr 2008 17:18:30 -0500")
References: <E1Jipry-0000po-OY@wine.codeweavers.com>
	<4E48F8CB-620B-4BAB-9461-FB1374FC368D@codeweavers.com>
Message-ID: <87iqyslm26.fsf@wine.dyndns.org>

Ken Thomases <ken at codeweavers.com> writes:

> This appears to revert a30327afef7b08d1aac1943ded64ee363a61c537.   
> That commit worked around a quartz-wm bug where it responds to the  
> TARGETS query with a format of 8.

Yes, that commit is incorrect. I'll put in a better fix.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Tue Apr  8 06:22:12 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 08 Apr 2008 13:22:12 +0200
Subject: [1/2] qedit: Implement IMediaDet_put_Filename.
In-Reply-To: <20080408001014.GA11580@linux.ucla.edu> (Dan Hipschman's message
	of "Mon, 7 Apr 2008 17:10:14 -0700")
References: <20080408001014.GA11580@linux.ucla.edu>
Message-ID: <87ej9glhgb.fsf@wine.dyndns.org>

Dan Hipschman <dsh at linux.ucla.edu> writes:

> +#define RELEASE(iface)                              \
> +    do                                              \
> +        if (iface)                                  \
> +        {                                           \
> +            IUnknown_Release((IUnknown *) iface);   \
> +            iface = NULL;                           \
> +        }                                           \
> +    while (0)

Please avoid that sort of thing, it's ugly to modify what looks like an
input argument inside a macro. Besides, you really don't need a macro
for two lines of code.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Tue Apr  8 08:30:37 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 8 Apr 2008 06:30:37 -0700
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <47FB135D.3030004@open-vote.org>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>
	<f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>
	<a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>
	<f3f1b91a0804061349k498913c8jcd227a94e14a8de3@mail.gmail.com>
	<a71bd89a0804061405o7dc65871v94df2bea12329507@mail.gmail.com>
	<f3f1b91a0804061455u649eca21v7ccaec9efcc702d4@mail.gmail.com>
	<47FB135D.3030004@open-vote.org>
Message-ID: <a71bd89a0804080630v6ca06862gfed1549c74092e4e@mail.gmail.com>

On Mon, Apr 7, 2008 at 11:40 PM, Scott Ritchie <scott at open-vote.org> wrote:
>  It's not that big a deal now, so long as the Hardy version (0.9.59
>  likely) stays around for a while ;)

I think Chris was planning on removing 0.9.59 from
the list way before Hardy is unsupported.  Chris?


From alex at thehandofagony.com  Tue Apr  8 08:42:52 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?utf-8?q?S=C3=B8rnes?=)
Date: Tue, 8 Apr 2008 15:42:52 +0200
Subject: AppDB Error, must enter to the "what didn't work" section?
In-Reply-To: <7e33d29b0804071627i68fa18fdkb250115b88331863@mail.gmail.com>
References: <7e33d29b0804071627i68fa18fdkb250115b88331863@mail.gmail.com>
Message-ID: <200804081542.52425.alex@thehandofagony.com>

> " The following errors were found* Please enter what did not work."
> I understand the mechanics of why it says that, but realistically, should
> it for this field, be required to have data? For example, with me running
> WoW, it's flawless for me. Absolutely no problems, and I'm rating it
> platinum. If we're rating it platinum should this at least not be required
> then? Conversely, it should be required as a field, when it is rated
> anything but platinum, by definition.
>
> Just something I noticed.

Nice catch!  I've sent a patch for it


Alexander N. S?rnes


From hverbeet at gmail.com  Tue Apr  8 08:55:55 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Tue, 8 Apr 2008 15:55:55 +0200
Subject: [3/10] WineD3D: Make the min mip lookup type a texture property
In-Reply-To: <200804081539.20152.stefan@codeweavers.com>
References: <200804081539.20152.stefan@codeweavers.com>
Message-ID: <d658b69e0804080655r20486262ta763a2df7361228f@mail.gmail.com>

Shouldn't this be a property of the format rather than the texture?


From stefan at codeweavers.com  Tue Apr  8 09:03:08 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 8 Apr 2008 16:03:08 +0200
Subject: [3/10] WineD3D: Make the min mip lookup type a texture property
In-Reply-To: <d658b69e0804080655r20486262ta763a2df7361228f@mail.gmail.com>
References: <200804081539.20152.stefan@codeweavers.com>
	<d658b69e0804080655r20486262ta763a2df7361228f@mail.gmail.com>
Message-ID: <200804081603.08629.stefan@codeweavers.com>

Am Dienstag, 8. April 2008 15:55:55 schrieb H. Verbeet:
> Shouldn't this be a property of the format rather than the texture?
I thought so as well, but the format already has the property in the form of 
the flag, so it would be duplicated there. I also want to use a custom 
filtering table for texture_rectangle textures, in which case I have to make 
this a per-texture property anyway.


From thunderbird2k at gmx.net  Tue Apr  8 10:40:19 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 08 Apr 2008 17:40:19 +0200
Subject: [1/10] WineD3D: Store the number of aux buffers in the context
In-Reply-To: <200804081538.44277.stefan@codeweavers.com>
References: <200804081538.44277.stefan@codeweavers.com>
Message-ID: <20080408154019.232540@gmx.net>

Detecting the number of aux buffers is trivial and can be done using the fake GL context as it is a WGL pixel format property.

Roderick
-- 
Ist Ihr Browser Vista-kompatibel? Jetzt die neuesten 
Browser-Versionen downloaden: http://www.gmx.net/de/go/browser


From stefan at codeweavers.com  Tue Apr  8 11:38:53 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 8 Apr 2008 18:38:53 +0200
Subject: [1/10] WineD3D: Store the number of aux buffers in the context
In-Reply-To: <20080408154019.232540@gmx.net>
References: <200804081538.44277.stefan@codeweavers.com>
	<20080408154019.232540@gmx.net>
Message-ID: <200804081838.53609.stefan@codeweavers.com>

Am Dienstag, 8. April 2008 17:40:19 schrieb Roderick Colenbrander:
> Detecting the number of aux buffers is trivial and can be done using the
> fake GL context as it is a WGL pixel format property.
Not quite: What if a card supports AUX buffers with the R5G6B5 equivalent, but 
not with A8R8G8B8? Of course I could try to create the fake format with aux 
buffers enabled, but who tells me if the number of aux buffers is going to 
work with the format the application wants later?


From winehacker at gmail.com  Tue Apr  8 12:59:54 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 8 Apr 2008 13:59:54 -0400
Subject: optimizations for 1.0
Message-ID: <19e31a080804081059y57be05c2k3a2f9c51646b8b8c@mail.gmail.com>

Hi,
Given we are coming up close to the freeze, I think this may be a good
time to look in to optimizations. I propose we spend some time trying
different compilers and profiling Wine under different usage patterns
to see what type of speedup we can get. I'm going to see if its
possible to compile Wine with LLVM and I think it would be a good idea
if someone with an ICC license gave it another shot. Also any gentoo
users lurking, now would be a good time to go crazy with your compiler
flags, run some benchmarks and file bug reports.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From thunderbird2k at gmx.net  Tue Apr  8 13:04:30 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 08 Apr 2008 20:04:30 +0200
Subject: [1/10] WineD3D: Store the number of aux buffers in the context
In-Reply-To: <200804081838.53609.stefan@codeweavers.com>
References: <200804081538.44277.stefan@codeweavers.com>
	<20080408154019.232540@gmx.net>
	<200804081838.53609.stefan@codeweavers.com>
Message-ID: <20080408180430.71850@gmx.net>

> > Detecting the number of aux buffers is trivial and can be done using the
> > fake GL context as it is a WGL pixel format property.
> Not quite: What if a card supports AUX buffers with the R5G6B5 equivalent,
> but 
> not with A8R8G8B8? Of course I could try to create the fake format with
> aux 
> buffers enabled, but who tells me if the number of aux buffers is going to
> work with the format the application wants later?

As I said before aux buffers are a WGL pixel format property. The pixel format selection code needs to take care of it. Right now it already tries to locate a format with aux buffers but it isn't failproof yet (wglChoosePixelFormatARB searches for an exact match or else for something with better capabilities; this is a little too strict for us) I'm working on better pixel format selection code but my time is very limited right now.

Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.gmx.net/de/entertainment/games/free


From pure_evil at mail.bg  Tue Apr  8 12:51:43 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Tue, 8 Apr 2008 20:51:43 +0300
Subject: winecfg turned into control-panel-applets. see patch.
Message-ID: <200804082051.43074.pure_evil@mail.bg>

Well, this is my first patch. Here goes.

It *enhances* winecfg's source and creates a winecfgcpl.cpl, which, when 
placed into ~/.wine/drive_c/windows/system32 shows the different "tabs" as 
different applets (six of them), visible via "wine control".

1.) Enhancements to winecfg - now the winecfg accepts new kind of console 
parameters which determine what tab(s) to show you. 

For all of you console junkies out there /like me!/ - this means that 
typing "winecfg audio" shows only the audio tab, "winecfg desktop" - the 
desktop integration tab and so forth for all six tabs. What "winecfg 
applications" does I leave to you ;)

2.) Based on the enhancements in winecfg, the .CPL itself. Each *applet* that 
appears in the control panel, calls winecfg with the appropriate parameter to 
get the job done.

CPL features:
-> six icons (drawn by me :D )
-> six control panel applets -> no longer an empty control panel
-> translation capability for the Title/Description. Control Panel does not 
support Unicode atm, so the Bulgarian translation is the same as the English 
one; but the capability is there.

This is what I have produced so far on the winecfg->wine control migration 
idea. 
Feedback?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: winecfg2cpl.patch.tar.gz
Type: application/x-tgz
Size: 15719 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080408/bdcdd212/attachment.bin 

From chmorgan at gmail.com  Tue Apr  8 13:15:04 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Tue, 8 Apr 2008 14:15:04 -0400
Subject: appdb needs to list 0.9.47 in the pulldown, please
In-Reply-To: <a71bd89a0804080630v6ca06862gfed1549c74092e4e@mail.gmail.com>
References: <a71bd89a0804061147v71eefcd5lfc39d600b4669fc2@mail.gmail.com>
	<f3f1b91a0804061156q529d417bn304bbc8883d0eacf@mail.gmail.com>
	<a71bd89a0804061202u69df1d1co87edc8f8506a2114@mail.gmail.com>
	<f3f1b91a0804061349k498913c8jcd227a94e14a8de3@mail.gmail.com>
	<a71bd89a0804061405o7dc65871v94df2bea12329507@mail.gmail.com>
	<f3f1b91a0804061455u649eca21v7ccaec9efcc702d4@mail.gmail.com>
	<47FB135D.3030004@open-vote.org>
	<a71bd89a0804080630v6ca06862gfed1549c74092e4e@mail.gmail.com>
Message-ID: <f3f1b91a0804081115y3d55e918ubc5a8a1f3bbfc738@mail.gmail.com>

On Tue, Apr 8, 2008 at 9:30 AM, Dan Kegel <dank at kegel.com> wrote:
> On Mon, Apr 7, 2008 at 11:40 PM, Scott Ritchie <scott at open-vote.org> wrote:
>  >  It's not that big a deal now, so long as the Hardy version (0.9.59
>  >  likely) stays around for a while ;)
>
>  I think Chris was planning on removing 0.9.59 from
>  the list way before Hardy is unsupported.  Chris?
>

Will Hardy upgrade to Wine 1.0 when it is released? I don't believe
anyone is opposed to keeping particular important releases on the list
but do we do that for distributions upon request? Only ones with lots
of users of wine? The question I had was what results from an older
version buy us or other users. If users can easily upgrade via using
the winehq source in Ubuntu's then maybe it isn't as big of a deal.
The reason for pruning the list was to avoid results from old versions
and to simplify the test submission process by reducing the number of
entries in that dropdown.

It seems like we need to come up with a criteria to pin versions.

I'll submit a bug for it on bugzilla today so we don't forget that we
need to add that feature with the goal of having it before 1.0 is
shipped but maybe we'll have it sooner.

Chris


From stefan at codeweavers.com  Tue Apr  8 13:20:58 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 8 Apr 2008 20:20:58 +0200
Subject: [1/10] WineD3D: Store the number of aux buffers in the context
In-Reply-To: <20080408180430.71850@gmx.net>
References: <200804081538.44277.stefan@codeweavers.com>
	<200804081838.53609.stefan@codeweavers.com>
	<20080408180430.71850@gmx.net>
Message-ID: <200804082020.58185.stefan@codeweavers.com>

Am Dienstag, 8. April 2008 20:04:30 schrieb Roderick Colenbrander:
> > > Detecting the number of aux buffers is trivial and can be done using
> > > the fake GL context as it is a WGL pixel format property.
> >
> > Not quite: What if a card supports AUX buffers with the R5G6B5
> > equivalent, but
> > not with A8R8G8B8? Of course I could try to create the fake format with
> > aux
> > buffers enabled, but who tells me if the number of aux buffers is going
> > to work with the format the application wants later?
>
> As I said before aux buffers are a WGL pixel format property. The pixel
> format selection code needs to take care of it. Right now it already tries
> to locate a format with aux buffers but it isn't failproof yet
Sure. The fact that it *may* depend on the other settings of the pixel format 
means I can't generally say "this GL implementation supports aux buffers" - I 
have to decide on that per created GL context and drawable. That's why I have 
the flag in the context and not the GL info structure



From scott at open-vote.org  Tue Apr  8 14:22:09 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Tue, 08 Apr 2008 12:22:09 -0700
Subject: Debian repository down
In-Reply-To: <50967.195.22.180.233.1207643194.nsm@avilys.eik.lt>
References: <200804080949.37628.kai.blin@gmail.com>	<47FB2C34.9030706@open-vote.org>
	<50967.195.22.180.233.1207643194.nsm@avilys.eik.lt>
Message-ID: <47FBC5E1.6070702@open-vote.org>

Tomas Kuliavas wrote:
>>> some user just reported on IRC that the wine.budgetdedicated.com repo is
>>> down.
>>> Seems like it's dead for over a day already. Do we know what's up with
>>> that
>>> and do we have an ETA for when it'll be back?
>>>
>>>
>> No, I don't.
>>
>> I can still ssh into the server, occasionally, but I don't know why it's
>>  basically unreachable over http.
> 
> Maybe firewall drops packets or some QoS/throttling services or DOS. If
> service is not available, connections don't timeout.
> 

Everything is fixed now.  Budgetdedicated have awesome support :)

Thanks,
Scott Ritchie


From tokul at users.sourceforge.net  Tue Apr  8 14:36:06 2008
From: tokul at users.sourceforge.net (Tomas Kuliavas)
Date: Tue, 8 Apr 2008 22:36:06 +0300 (EEST)
Subject: Debian repository down
In-Reply-To: <47FBC5E1.6070702@open-vote.org>
References: <200804080949.37628.kai.blin@gmail.com>
	<47FB2C34.9030706@open-vote.org>
	<50967.195.22.180.233.1207643194.nsm@avilys.eik.lt>
	<47FBC5E1.6070702@open-vote.org>
Message-ID: <56771.78.61.224.253.1207683366.nsm@avilys.eik.lt>

> Tomas Kuliavas wrote:
>>>> some user just reported on IRC that the wine.budgetdedicated.com repo
>>>> is
>>>> down.
>>>> Seems like it's dead for over a day already. Do we know what's up with
>>>> that
>>>> and do we have an ETA for when it'll be back?
>>>>
>>>>
>>> No, I don't.
>>>
>>> I can still ssh into the server, occasionally, but I don't know why
>>> it's
>>>  basically unreachable over http.
>>
>> Maybe firewall drops packets or some QoS/throttling services or DOS. If
>> service is not available, connections don't timeout.
>>
>
> Everything is fixed now.  Budgetdedicated have awesome support :)

tomas at kirke:~$ LANG=en_US date
Tue Apr  8 22:43:27 EEST 2008
tomas at kirke:~$ sudo wget
http://wine.budgetdedicated.com/apt/sources.list.d/etch.list -O
/etc/apt/sources.list.d/winehq.list
--22:43:29--  http://wine.budgetdedicated.com/apt/sources.list.d/etch.list
           => `/etc/apt/sources.list.d/winehq.list'
Resolving wine.budgetdedicated.com... 81.171.111.184,
2001:4de0:aaac:0:2456::2
Connecting to wine.budgetdedicated.com|81.171.111.184|:80... failed:
Connection refused.
Connecting to wine.budgetdedicated.com|2001:4de0:aaac:0:2456::2|:80...
failed: Network is unreachable.
tomas at kirke:~$


How about usable IPV4 address?

-- 
Tomas



From david.adam.cnrs at gmail.com  Tue Apr  8 02:00:51 2008
From: david.adam.cnrs at gmail.com (David Adam)
Date: Tue, 8 Apr 2008 09:00:51 +0200
Subject: Implementation of D3DXGetFVFVertexSize with tests
Message-ID: <5f9140a20804080000y28d69660wae0007b0aab4736e@mail.gmail.com>

Hello,

to keep the code readable, you should put your function in a new file. For
instance,
d3dx8/mesh.c would be fine  (msdn put this functio in the mesh category).
Otherwise, the whole code is going to implemented in the file
d3dx8/d3dx8_main.c.

What is the purpose of the line

+    ok(TRUE,"prueba");
?

Moreover, I think that this test should be implemented in d3dx8 too. If you
want to test the difference between d3d8 and d3dx9, you should duplicate the
test in d3dx9 then.

David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080408/b5f0362a/attachment.htm 

From gmane at drealm.info  Tue Apr  8 11:30:39 2008
From: gmane at drealm.info (Peter L Jones)
Date: Tue, 08 Apr 2008 17:30:39 +0100
Subject: wineasio 0.7.4
Message-ID: <ftg6jf$bph$1@ger.gmane.org>

Hi all,

The on-going development of wineasio continues with the release of 0.7.4.  This
release is primarily aimed at fixing a couple of bugs and addressing some JACK
xrun issues.

I'm most interested in hearing from people who are having xruns with the 0.7.x
series but for whom 0.5 (or 0.6a) works.

Regards,

-- Peter
http://sourceforge.net/projects/wineasio



From scott at open-vote.org  Tue Apr  8 15:19:27 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Tue, 08 Apr 2008 13:19:27 -0700
Subject: optimizations for 1.0
In-Reply-To: <19e31a080804081059y57be05c2k3a2f9c51646b8b8c@mail.gmail.com>
References: <19e31a080804081059y57be05c2k3a2f9c51646b8b8c@mail.gmail.com>
Message-ID: <47FBD34F.4030609@open-vote.org>

Steven Edwards wrote:
> Hi,
> Given we are coming up close to the freeze, I think this may be a good
> time to look in to optimizations. I propose we spend some time trying
> different compilers and profiling Wine under different usage patterns
> to see what type of speedup we can get. I'm going to see if its
> possible to compile Wine with LLVM and I think it would be a good idea
> if someone with an ICC license gave it another shot. Also any gentoo
> users lurking, now would be a good time to go crazy with your compiler
> flags, run some benchmarks and file bug reports.
> 

I'd settle for someone telling me which GCC version to use.  If you are
doing optimization testing, please make sure to test that copy
protection hasn't broken as well :)

Thanks,
Scott Ritchie


From stefan at codeweavers.com  Tue Apr  8 15:46:58 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 8 Apr 2008 22:46:58 +0200
Subject: dlls/d3d9/tests/visual.c cleanup
In-Reply-To: <alpine.LSU.1.00.0804081709300.22304@acrux.dbai.tuwien.ac.at>
References: <Pine.LNX.4.64.0801121848470.4453@acrux.dbai.tuwien.ac.at>
	<87bq7oiiye.fsf@wine.dyndns.org>
	<alpine.LSU.1.00.0804081709300.22304@acrux.dbai.tuwien.ac.at>
Message-ID: <200804082246.58195.stefan@codeweavers.com>

Am Dienstag, 8. April 2008 18:08:15 schrieb Gerald Pfeifer:
> On Mon, 14 Jan 2008, Alexandre Julliard wrote:
> > These tests don't make much sense, with or without your fix, plus the
> > error messages don't match the tests. This needs more work.
>
> It seems this was added with 2007-11-07 with the following log entry:
>
>   Stefan D?singer <stefan at codeweavers.com>
>   wined3d: Shader Model 3.0 varying tests.
>
> I've seen patches in this area cleaning up some stuff.  Does this
> address the issues you were seeing?  Otherwise, I'd hope Stefan can
> have a look.
>
> Here is an updated patch of mine.
The patch should be OK as it is a NOP functionally. I wonder why it is needed 
though, since I think that if all 3 lines look the same they're easier to 
read, but beauty is arguable. Does the patch fix some compiler warnings with 
some extra warnings enabled?





From dank at kegel.com  Tue Apr  8 16:15:48 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 8 Apr 2008 14:15:48 -0700
Subject: New winetricks 20080408: fixed dcom98
Message-ID: <a71bd89a0804081415k62bc134aoe17a1c2426520c09@mail.gmail.com>

Another day, another winetricks release.  James Hawkins
noticed that installing native dcom98 breaks everything
now because it breaks three of the .exe's that wine starts
internally.   So I've updated winetricks to avoid overriding
rpcrt4, ole32, and oleaut32 for those three exe.  Once
again, dcom98 is your friend.

As always, the latest winetricks is online at
  http://kegel.com/wine/winetricks
and the change history is online at
  http://winezeug.googlecode.com/
- Dan


From m.b.lankhorst at gmail.com  Tue Apr  8 16:22:55 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 8 Apr 2008 14:22:55 -0700
Subject: quartz: Add missing lock releases on some code paths (Smatch).
In-Reply-To: <20080408211319.GA1868@redhat.com>
References: <20080408211319.GA1868@redhat.com>
Message-ID: <b130c85e0804081422i13a108f2m38321f5ce4168e5e@mail.gmail.com>

Hello,

2008/4/8, Michael Stefaniuc <mstefani at redhat.de>:
>  not sure if it's supposed to not release the thread_lock in that case
>  or if that's an omission that got copied around.
+1, thanks for catching.

Cheers,
Maarten.


From scott at open-vote.org  Tue Apr  8 16:23:23 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Tue, 08 Apr 2008 14:23:23 -0700
Subject: Debian repository down
In-Reply-To: <56771.78.61.224.253.1207683366.nsm@avilys.eik.lt>
References: <200804080949.37628.kai.blin@gmail.com>
	<47FB2C34.9030706@open-vote.org>
	<50967.195.22.180.233.1207643194.nsm@avilys.eik.lt>
	<47FBC5E1.6070702@open-vote.org>
	<56771.78.61.224.253.1207683366.nsm@avilys.eik.lt>
Message-ID: <47FBE24B.2030205@open-vote.org>

Tomas Kuliavas wrote:
>> Tomas Kuliavas wrote:
>>>>> some user just reported on IRC that the wine.budgetdedicated.com repo
>>>>> is
>>>>> down.
>>>>> Seems like it's dead for over a day already. Do we know what's up with
>>>>> that
>>>>> and do we have an ETA for when it'll be back?
>>>>>
>>>>>
>>>> No, I don't.
>>>>
>>>> I can still ssh into the server, occasionally, but I don't know why
>>>> it's
>>>>  basically unreachable over http.
>>> Maybe firewall drops packets or some QoS/throttling services or DOS. If
>>> service is not available, connections don't timeout.
>>>
>> Everything is fixed now.  Budgetdedicated have awesome support :)
> 
> tomas at kirke:~$ LANG=en_US date
> Tue Apr  8 22:43:27 EEST 2008
> tomas at kirke:~$ sudo wget
> http://wine.budgetdedicated.com/apt/sources.list.d/etch.list -O
> /etc/apt/sources.list.d/winehq.list
> --22:43:29--  http://wine.budgetdedicated.com/apt/sources.list.d/etch.list
>            => `/etc/apt/sources.list.d/winehq.list'
> Resolving wine.budgetdedicated.com... 81.171.111.184,
> 2001:4de0:aaac:0:2456::2
> Connecting to wine.budgetdedicated.com|81.171.111.184|:80... failed:
> Connection refused.
> Connecting to wine.budgetdedicated.com|2001:4de0:aaac:0:2456::2|:80...
> failed: Network is unreachable.
> tomas at kirke:~$
> 
> 
> How about usable IPV4 address?
> 

Sorry I had to restart apache again on it.  My mistake ;)

Thanks,
Scott Ritchie


From bon at elektron.ikp.physik.tu-darmstadt.de  Tue Apr  8 17:16:01 2008
From: bon at elektron.ikp.physik.tu-darmstadt.de (Uwe Bonnes)
Date: Wed, 9 Apr 2008 00:16:01 +0200
Subject: Implementation of D3DXGetFVFVertexSize with tests
In-Reply-To: <5f9140a20804080000y28d69660wae0007b0aab4736e@mail.gmail.com>
References: <5f9140a20804080000y28d69660wae0007b0aab4736e@mail.gmail.com>
Message-ID: <18427.61089.952796.412252@hertz.ikp.physik.tu-darmstadt.de>

>>>>> "David" == David Adam <david.adam.cnrs at gmail.com> writes:

...

    David> What is the purpose of the line

    David> + ok(TRUE,"prueba"); ?

"prueba" could be spanish for test.

    David> David Hello,<br><br>to keep the code readable, you should put

Please, no HTML in mails
-- 
Uwe Bonnes                bon at elektron.ikp.physik.tu-darmstadt.de

Institut fuer Kernphysik  Schlossgartenstrasse 9  64289 Darmstadt
--------- Tel. 06151 162516 -------- Fax. 06151 164321 ----------


From winehacker at gmail.com  Tue Apr  8 17:21:59 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 8 Apr 2008 18:21:59 -0400
Subject: optimizations for 1.0
In-Reply-To: <47FBD34F.4030609@open-vote.org>
References: <19e31a080804081059y57be05c2k3a2f9c51646b8b8c@mail.gmail.com>
	<47FBD34F.4030609@open-vote.org>
Message-ID: <19e31a080804081521p4106c3b6x45765c683a60f133@mail.gmail.com>

On Tue, Apr 8, 2008 at 4:19 PM, Scott Ritchie <scott at open-vote.org> wrote:
>  I'd settle for someone telling me which GCC version to use.  If you are
>  doing optimization testing, please make sure to test that copy
>  protection hasn't broken as well :)

Good point. I just tested LLVM 2.2 on OS X and it produces a totally
broken Wine so thats out. I see ICC has an eval version for OS X so I
am going to give it a shot next.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From stefandoesinger at gmx.at  Tue Apr  8 17:25:35 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 9 Apr 2008 00:25:35 +0200
Subject: XDC 2008 wishlist
In-Reply-To: <20080404165503.107670@gmx.net>
References: <200804041716.58458.stefandoesinger@gmx.at>
	<20080404165503.107670@gmx.net>
Message-ID: <200804090025.35434.stefandoesinger@gmx.at>

Am Freitag, 4. April 2008 18:55:03 schrieb Roderick Colenbrander:
> Most xorg devs aren't a big fan of pbuffers but they are part of the GLX
> 1.3 spec which drivers want to support these days. Some drivers are
> considering to just fail on pbuffer creation. Encourage them to offer
> pbuffer support on some visuals/fbconfigs. A lot of windows apps rely on
> their presence including Wow in opengl32 mode and lots of other (older)
> programs.
Can we emulate pbuffers via FBOs, or are there some problems? Pbuffer support 
is troublesome on MacOS and the ATI binary driver as well, so even if the 
xorg devs implement it we'll be stuck with a partial fix only


From fgouget at free.fr  Tue Apr  8 18:06:20 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 9 Apr 2008 01:06:20 +0200 (CEST)
Subject: Reece Dunn : comdlg32: Fix building the tests with MSVC headers.
In-Reply-To: <E1JdtAy-0002EV-Jx@wine.codeweavers.com>
References: <E1JdtAy-0002EV-Jx@wine.codeweavers.com>
Message-ID: <alpine.DEB.1.10.0804090104490.20134@amboise.dolphin>

On Mon, 24 Mar 2008, Alexandre Julliard wrote:
[...]
> Commit: ae32a7fe0473aebb875b26083c1567ff046c3b80
> URL:    http://source.winehq.org/git/wine.git/?a=commit;h=ae32a7fe0473aebb875b26083c1567ff046c3b80
> 
> Author: Reece Dunn <msclrhd at googlemail.com>
> Date:   Sat Mar 22 22:50:43 2008 +0000
> 
> comdlg32: Fix building the tests with MSVC headers.
[...]
> +++ b/dlls/comdlg32/tests/printdlg.c
> @@ -26,6 +26,7 @@
>  #include "winerror.h"
>  #include "wingdi.h"
>  #include "winuser.h"
> +#include "objbase.h"

The question is why didn't this fail in Wine in the first place? The 
Wine headers must be different in some way which causes the compile to 
succeed when it should have failed. Thus they should be fixed.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                            $live{free} || die "";


From smoki00790 at gmail.com  Tue Apr  8 19:11:36 2008
From: smoki00790 at gmail.com (=?ISO-8859-2?Q?Milan_Kosti=E6?=)
Date: Wed, 9 Apr 2008 02:11:36 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
In-Reply-To: <200804080808.14011.stefan@codeweavers.com>
References: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
	<200804080808.14011.stefan@codeweavers.com>
Message-ID: <e1d9e62c0804081711s23046a9aq7991a85522cee457@mail.gmail.com>

 I'm use Mesa 7.0.1 mainly because performance is the best and not
have glitches in some cases like newer, but tried wine-0.9.59 with
7.02 and 7.0.3 also. My card is HIS 9250 128MB/128bit (1002:5960
17af:2020). This r200 performance issues started with this patch:

 http://gitweb.freedesktop.org/?p=mesa/mesa.git;a=commit;h=e279a0a076b7a3c8d60138c19870784c260c9d67

 I'm atached some screenshots with or w/o ps enabled using Mesa 7.0.3
for this to show, clean .wine directory (just winecfg and then install
3DMark) default driver setup and default 3DMark2001 setup (just used
800x600 for windowed screenshoots, checked 'emulate a virtual desktop'
in winecfg).
 All these primers work good in previous versions of wine (except with
properly moving water (river and sea) and portals showing in DS2 (that
work good when i add once again 'mat[12] = mat[8]; mat[13] = mat[9];'
in utils.c) i know that is another thing, but helps), but not working
good with wine-0.9.59 with ps enabled. Exeption from this is
Painkiller which starting only with disabled ps, registy key
DisabledExtensions GL_ATI_fragment_shaders also not help and that
disabled one textured unit in driver is needed from time to time (not
always), also this
happens in all 7.0.x Mesas.

 http://rapidshare.com/files/105988005/wine-0.9.59_tests.tar.gz.html

 NOTE: i mainly use extern libtxc_dxtn.so (for this tests w or w/o -
same results), because some native games Regnum Online, Quake4...
needs it to working properly, also Indiana Jones: Emperors Tomb with
wine even refuses to start without it.

 I'm registered to bugzilla, but everytime it says that my password is
not good (maybe my firewall issues?), because of that i use mailists
to inform devs about bugs (i have many to fill like SeriousSam FE/SE
resolution regression, same game engine: SE starts(but crash on exit),
FE not even start, SE crash when resolution changes and in both games
this work good with 0.9.45 and older like .39, .29... Icculus
installers for these games work good, but have other issues. All this
is tested on: same card, same X server, same distro, same driver, same
Mesa, etc:).


From thestig at google.com  Tue Apr  8 19:26:31 2008
From: thestig at google.com (Lei Zhang)
Date: Tue, 8 Apr 2008 17:26:31 -0700
Subject: Add GdipCreateFontFamilyFromName stub try2
In-Reply-To: <1206500308.7076.1.camel@mighmos>
References: <1206500308.7076.1.camel@mighmos>
Message-ID: <558b2f5c0804081726u2c77aea6s2bde534b95aa66c0@mail.gmail.com>

On Tue, Mar 25, 2008 at 7:58 PM, Adam Petaccia <adam at tpetaccia.com> wrote:
> This is needed, along with some other patches I'll be sending later to
>  make Richard Gariott's Tabula Rasa updater not crash at startup.
>

gcc says:

font.c:126: warning: ISO C90 forbids mixed declarations and code
font.c:131: warning: assignment discards qualifiers from pointer target type

This doesn't work:

ffamily->FamilyName = name;

What happens is FontFamily is NULL?

*FontFamily = ffamily;


From dmitry at codeweavers.com  Tue Apr  8 20:26:20 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 9 Apr 2008 10:26:20 +0900
Subject: optimizations for 1.0
References: <19e31a080804081059y57be05c2k3a2f9c51646b8b8c@mail.gmail.com><47FBD34F.4030609@open-vote.org>
	<19e31a080804081521p4106c3b6x45765c683a60f133@mail.gmail.com>
Message-ID: <000a01c899e0$bab50a50$a600fea9@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> Good point. I just tested LLVM 2.2 on OS X and it produces a totally
> broken Wine so thats out. I see ICC has an eval version for OS X so I
> am going to give it a shot next.

Why not start with Linux first? In that case you have much more helping
hands if you are in trouble, you avoid Mac specific code paths that may
distort the picture, and Linux has oprofile - unbeatable choice.

-- 
Dmitry.


From smoki00790 at gmail.com  Tue Apr  8 20:49:07 2008
From: smoki00790 at gmail.com (=?ISO-8859-2?Q?Milan_Kosti=E6?=)
Date: Wed, 9 Apr 2008 03:49:07 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
In-Reply-To: <e1d9e62c0804081711s23046a9aq7991a85522cee457@mail.gmail.com>
References: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
	<200804080808.14011.stefan@codeweavers.com>
	<e1d9e62c0804081711s23046a9aq7991a85522cee457@mail.gmail.com>
Message-ID: <e1d9e62c0804081849h3310a6e1md373d28ece59674b@mail.gmail.com>

 Forgot to say that Indiana Jones: Emperors Tomb start and load level
with or without enabled ps in winecfg, but if GL_ATI_fragment_shader
is enabled in driver (ie 6 units in driconf), when it load level then
i got hard freeze and must reboot computer on button
(CTRL+ALT+Backspace and CTRL+ALT+D not help, it's only possibly to
move mouse (no click) and nothing else).
 When 5 units is used then everything goes fine, but that is without
this shader:(.


From smoki00790 at gmail.com  Tue Apr  8 21:48:18 2008
From: smoki00790 at gmail.com (=?ISO-8859-2?Q?Milan_Kosti=E6?=)
Date: Wed, 9 Apr 2008 04:48:18 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
In-Reply-To: <e1d9e62c0804081849h3310a6e1md373d28ece59674b@mail.gmail.com>
References: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
	<200804080808.14011.stefan@codeweavers.com>
	<e1d9e62c0804081711s23046a9aq7991a85522cee457@mail.gmail.com>
	<e1d9e62c0804081849h3310a6e1md373d28ece59674b@mail.gmail.com>
Message-ID: <e1d9e62c0804081948o62484fdbqe8259da8a94059b1@mail.gmail.com>

 Btw Stefan, many thanks to you for implement and support this old and
forgotten but powerful extension, it's nice to see that
"metal-blending" shading again in action and all that working in wine,
an example like in this demo (http://www.humus.ca/3D/GameEngine.zip).
Thanks again:).


From winehacker at gmail.com  Tue Apr  8 21:54:05 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 8 Apr 2008 22:54:05 -0400
Subject: optimizations for 1.0
In-Reply-To: <000a01c899e0$bab50a50$a600fea9@DMITRY>
References: <19e31a080804081059y57be05c2k3a2f9c51646b8b8c@mail.gmail.com>
	<47FBD34F.4030609@open-vote.org>
	<19e31a080804081521p4106c3b6x45765c683a60f133@mail.gmail.com>
	<000a01c899e0$bab50a50$a600fea9@DMITRY>
Message-ID: <19e31a080804081954x63dd863by7847d7a48c8477a0@mail.gmail.com>

On Tue, Apr 8, 2008 at 9:26 PM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
>  Why not start with Linux first? In that case you have much more helping
>  hands if you are in trouble, you avoid Mac specific code paths that may
>  distort the picture, and Linux has oprofile - unbeatable choice.

 I have a 64bit linux host and using -m32 with llvmgcc does not seem
to be very well documented. I expect to have problems with icc on
x86-64 also. Preconfigured LLVM packages for 2.2 work out of the box
on OS X where the current Ubuntu binary is at like 1.7 which does not
support inline asm. Don't worry, I'll try it in a 32bit linux vm with
my own build of llvm trunk and icc when I have more time.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From thestig at google.com  Wed Apr  9 01:01:59 2008
From: thestig at google.com (Lei Zhang)
Date: Tue, 8 Apr 2008 23:01:59 -0700
Subject: [PATCH] user32: on VK_RETURN, send WM_COMMAND to ancestor,
	not parent.
In-Reply-To: <558b2f5c0804042155h783268f0m2419aa2f65cf2a19@mail.gmail.com>
References: <558b2f5c0804040020w77698ed0v324e7dbae792098b@mail.gmail.com>
	<00a901c89657$3abcc4f0$a600fea9@DMITRY>
	<558b2f5c0804040747s3eb841cfma07c0b6ca236e8c1@mail.gmail.com>
	<018501c8966e$f65e4000$a600fea9@DMITRY>
	<558b2f5c0804041111v2daf31e4sbbf874e4424c1be4@mail.gmail.com>
	<558b2f5c0804042155h783268f0m2419aa2f65cf2a19@mail.gmail.com>
Message-ID: <558b2f5c0804082301j31820986v72b2cd1baf6a2867@mail.gmail.com>

On Fri, Apr 4, 2008 at 9:55 PM, Lei Zhang <thestig at google.com> wrote:
>
> On Fri, Apr 4, 2008 at 11:11 AM, Lei Zhang <thestig at google.com> wrote:
>  >
>  > On Fri, Apr 4, 2008 at 9:14 AM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
>  >  > "Lei Zhang" <thestig at google.com> wrote:
>  >  >
>  >  >
>  >  > > The edit control is the child of a dialog box bar, which is in turn
>  >  > > the child of another dialog box foo. SetParent() is not involved, if
>  >  > > that's what you mean.
>  >  > >
>  >  >
>  >  >  Seems that's not the case then, from your test it looks more like
>  >  >  a WM_COMMAND forwarding from a child dialog to the parent one.
>  >  >
>  >  >  --
>  >  >  Dmitry.
>  >  >
>  >
>  >  I'm pretty sure the parent dialog is getting the WM_COMMAND directly.
>  >  It is not the case where the child dialog gets a WM_COMMAND, and
>  >  forwards it to its parent.
>  >
>  >  Running the test on Windows, the child dialog gets two WM_COMMANDS -
>  >  EN_SETFOCUS and EN_KILLFOCUS. Then the parent dialog gets WM_COMMAND
>  >  with IDOK.
>  >
>  >  - Lei
>  >
>
>  Ah, this is because the child dialog has the DS_CONTROL style. I
>  should test for that and handle it appropriately.
>
>  - Lei
>

I thought maybe the DS_CONTROL style caused the message to get
propagated up, like in DIALOG_FindMsgDestination(). So I did more
tests.

I removed the DS_CONTROL style, but that didn't change the result of
the test. I also tried something more elaborate, where we have a
series of dialog windows, each of which contains another dialog
window... until the last one which contains the edit control. When I
send the edit control the VK_RETURN, the top most dialog window gets
the WM_COMMAND with wparam=IDOK. None of the dialog boxes between the
edit control and its ancestor gets the WM_COMMAND msg.


From thunderbird2k at gmx.net  Wed Apr  9 01:06:13 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Wed, 09 Apr 2008 08:06:13 +0200
Subject: XDC 2008 wishlist
In-Reply-To: <200804090025.35434.stefandoesinger@gmx.at>
References: <200804041716.58458.stefandoesinger@gmx.at>
	<20080404165503.107670@gmx.net>
	<200804090025.35434.stefandoesinger@gmx.at>
Message-ID: <20080409060613.327140@gmx.net>

> > Most xorg devs aren't a big fan of pbuffers but they are part of the GLX
> > 1.3 spec which drivers want to support these days. Some drivers are
> > considering to just fail on pbuffer creation. Encourage them to offer
> > pbuffer support on some visuals/fbconfigs. A lot of windows apps rely on
> > their presence including Wow in opengl32 mode and lots of other (older)
> > programs.
> Can we emulate pbuffers via FBOs, or are there some problems? Pbuffer
> support 
> is troublesome on MacOS and the ATI binary driver as well, so even if the 
> xorg devs implement it we'll be stuck with a partial fix only

In theory you might be able to offer this emulation but I think it will be very tricky and it might not work well at all. Remember pbuffers are WGL things while FBOs require a GLX/WGL context. You would have to override a bunch of GL calls, states .. I don't think this works well. Second WGL allows you to query the capabilities of a pbuffer, we would have to fake most settings which might not result in optimal performance (e.g. color bits, stencil ..).

Mainly overriding stuff and the requirement of a GLX/WGL context is problematic I think. I fear a half baked implementation which works for some of the easier apps. The drivers could also emulate pbuffers using FBOs and they might have less issues.

Roderick
-- 
GMX startet ShortView.de. Hier findest Du Leute mit Deinen Interessen!
Jetzt dabei sein: http://www.shortview.de/?mc=sv_ext_mf at gmx


From dmitry at codeweavers.com  Wed Apr  9 01:24:31 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 9 Apr 2008 15:24:31 +0900
Subject: Updated three Power Profile functions to match MSDN
References: <ed7be3850804081928i666ced0ch51e8d8ede8a9a2cc@mail.gmail.com>
Message-ID: <00a801c89a0a$607c52d0$a600fea9@DMITRY>

"Black Dragon" <blackdragon1157 at gmail.com> wrote:

First of all Wine doesn't accept patches from an anonymous person,
please use your real name.

> +   if(PowerCaps.SystemS4==TRUE && PowerCaps.HiberFilePresent==TRUE) { return TRUE; }
> +   else return FALSE;

You should never compare against TRUE, and add braces only when necessary:

return PowerCaps.SystemS4 && PowerCaps.HiberFilePresent;

is much shorter and clearer.
 
> +   if(PowerCaps.SystemS5==TRUE) { return TRUE; }
> +   else return FALSE;

Same here:

return PowerCaps.SystemS5;

or

return PowerCaps.SystemS5 != 0;
 
> +   if(PowerCaps.SystemS1==TRUE && PowerCaps.SystemS2==TRUE && PowerCaps.SystemS3==TRUE) { return true; }
> +   else return FALSE;

Same here, also don't use 'true', it's not portable.


-- 
Dmitry.


From dmitry at codeweavers.com  Wed Apr  9 01:27:36 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 9 Apr 2008 15:27:36 +0900
Subject: [PATCH] user32: on VK_RETURN, send WM_COMMAND to ancestor,
	not parent.
References: <558b2f5c0804040020w77698ed0v324e7dbae792098b@mail.gmail.com><00a901c89657$3abcc4f0$a600fea9@DMITRY><558b2f5c0804040747s3eb841cfma07c0b6ca236e8c1@mail.gmail.com><018501c8966e$f65e4000$a600fea9@DMITRY><558b2f5c0804041111v2daf31e4sbbf874e4424c1be4@mail.gmail.com><558b2f5c0804042155h783268f0m2419aa2f65cf2a19@mail.gmail.com>
	<558b2f5c0804082301j31820986v72b2cd1baf6a2867@mail.gmail.com>
Message-ID: <00b701c89a0a$cf37a4e0$a600fea9@DMITRY>

"Lei Zhang" <thestig at google.com> wrote:

> I thought maybe the DS_CONTROL style caused the message to get
> propagated up, like in DIALOG_FindMsgDestination(). So I did more
> tests.
> 
> I removed the DS_CONTROL style, but that didn't change the result of
> the test. I also tried something more elaborate, where we have a
> series of dialog windows, each of which contains another dialog
> window... until the last one which contains the edit control. When I
> send the edit control the VK_RETURN, the top most dialog window gets
> the WM_COMMAND with wparam=IDOK. None of the dialog boxes between the
> edit control and its ancestor gets the WM_COMMAND msg.

I'd like to see a fully fledged message test for this, with all 'parent'
messages logged, and full window tree parent->child1->child2 checked.

-- 
Dmitry.


From hverbeet at gmail.com  Wed Apr  9 01:39:40 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Wed, 9 Apr 2008 08:39:40 +0200
Subject: d3dx8 [6/7] Implement D3DXMatrixStack_Push
In-Reply-To: <5f9140a20804080119t63829fdn4e654d16d182e676@mail.gmail.com>
References: <5f9140a20804080119t63829fdn4e654d16d182e676@mail.gmail.com>
Message-ID: <d658b69e0804082339j25986923g844a8f6b7282b7b3@mail.gmail.com>

On 08/04/2008, David Adam <david.adam.cnrs at gmail.com> wrote:
> +    This->current = This->current +1;
> +    HeapReAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, This->matrix, (This->current +1) * sizeof(D3DXMATRIX) );
> +    if ( This->matrix == NULL ) return E_OUTOFMEMORY;

Aside from being a bit suboptimal (doing a realloc on every push),
this probably doesn't do what you want. Consider what happens to the
size of the array when you do something like push/pop/push/pop/...etc.

It would be better to keep track of the current stack size, and then
grow it by a factor (eg. 2 or 1.5) if a push would overflow the
current stack. You could also consider shrinking the array again if a
pop would make it use less than a certain percentage of the current
size (eg. a third).

You should also assign the result of HeapReAlloc() to This->matrix
again. Although it's quite possible for HeapReAlloc to just grow the
current block without changing its location, there's no guarantee it
will. The NULL check is useless this way.


From msclrhd at googlemail.com  Wed Apr  9 01:14:54 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 9 Apr 2008 07:14:54 +0100
Subject: Reece Dunn : comdlg32: Fix building the tests with MSVC headers.
In-Reply-To: <alpine.DEB.1.10.0804090104490.20134@amboise.dolphin>
References: <E1JdtAy-0002EV-Jx@wine.codeweavers.com>
	<alpine.DEB.1.10.0804090104490.20134@amboise.dolphin>
Message-ID: <3f4fd2640804082314y32a2e333h1d1b31dabc64ee04@mail.gmail.com>

On 09/04/2008, Francois Gouget <fgouget at free.fr> wrote:
> On Mon, 24 Mar 2008, Alexandre Julliard wrote:
>  [...]
>  > Commit: ae32a7fe0473aebb875b26083c1567ff046c3b80
>  > URL:    http://source.winehq.org/git/wine.git/?a=commit;h=ae32a7fe0473aebb875b26083c1567ff046c3b80
>  >
>  > Author: Reece Dunn <msclrhd at googlemail.com>
>  > Date:   Sat Mar 22 22:50:43 2008 +0000
>  >
>  > comdlg32: Fix building the tests with MSVC headers.
>  [...]
>  > +++ b/dlls/comdlg32/tests/printdlg.c
>  > @@ -26,6 +26,7 @@
>  >  #include "winerror.h"
>  >  #include "wingdi.h"
>  >  #include "winuser.h"
>  > +#include "objbase.h"
>
>  The question is why didn't this fail in Wine in the first place? The
>  Wine headers must be different in some way which causes the compile to
>  succeed when it should have failed. Thus they should be fixed.

With the current Vista SDK headers (not sure about older ones), in
commdlg.h PRINTDLGEXA/W is wrapped in a #ifdef STDMETHOD guard along
with the definition of IPrintDialogCallback, IPrintDialogServices and
PRINTPAGERANGE. Thus, using the SDK headers it does not find
LPPRINTDLGEXW without objbase.h to get the definition of STDMETHOD.

Looking at the Wine headers, the PRINTDLGEXA/W datastructure is not
guarded in this way and the lpCallback member is void* not LPUNKNOWN
as it is in the SDK headers.

- Reece


From hverbeet at gmail.com  Wed Apr  9 01:47:55 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Wed, 9 Apr 2008 08:47:55 +0200
Subject: d3dx8 {5/7] Implement D3DXMatrixStack_Pop
In-Reply-To: <5f9140a20804080118h3378f9deta9f8aed058911862@mail.gmail.com>
References: <5f9140a20804080118h3378f9deta9f8aed058911862@mail.gmail.com>
Message-ID: <d658b69e0804082347g5a21562ehcd87a7d1c2049f68@mail.gmail.com>

On 08/04/2008, David Adam <david.adam.cnrs at gmail.com> wrote:
> +    if ( This->current == 0 )
> +    {
> +     HeapFree(GetProcessHeap(), 0, This->matrix);
> +     return D3DERR_INVALIDCALL;
> +    }
> +    This->current = This->current -1;
If This->current was 0 when calling Pop, it now points at a
non-existing item. This would probably break things like LoadMatrix,
GetTop, etc. Also, calling Pop again would result in a double free of
This->matrix.


From hverbeet at gmail.com  Wed Apr  9 01:51:38 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Wed, 9 Apr 2008 08:51:38 +0200
Subject: d3dx8: [7/7] Add tests for MatrixStack
In-Reply-To: <5f9140a20804080120t3f39e703xb5d6a588982538cc@mail.gmail.com>
References: <5f9140a20804080120t3f39e703xb5d6a588982538cc@mail.gmail.com>
Message-ID: <d658b69e0804082351t609cac28sb12f754fbb50699a@mail.gmail.com>

On 08/04/2008, David Adam <david.adam.cnrs at gmail.com> wrote:
>
While it's certainly good to test the normal usage of the API, it's
also useful to test the behaviour of error conditions
(Pop/LoadMatrix/GetTop on an empty stack, etc).


From dank at kegel.com  Wed Apr  9 01:56:59 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 8 Apr 2008 23:56:59 -0700
Subject: .net 2 first light on nontrivial apps
Message-ID: <a71bd89a0804082356w7414de5fufe9e2792e824c88f@mail.gmail.com>

It looks like 'winetricks dotnet20' and current wine
is good enough that .net support isn't quite the
limiting factor anymore!  See
http://bugs.winehq.org/show_bug.cgi?id=8499
http://bugs.winehq.org/show_bug.cgi?id=12457
http://bugs.winehq.org/show_bug.cgi?id=12458
for three sizeable apps that actually put up
their GUIs, at least briefly.  MySQL Workbench
actually runs well enough to explore the GUI.


From hverbeet at gmail.com  Wed Apr  9 02:03:39 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Wed, 9 Apr 2008 09:03:39 +0200
Subject: d3dx9: Implement D3DXGetShaderSize with tests 3/4
In-Reply-To: <47FBBDB6.60706@ilidium.com>
References: <47FBBDB6.60706@ilidium.com>
Message-ID: <d658b69e0804090003l39d928e7w2c4234499486a1b0@mail.gmail.com>

On 08/04/2008, Luis Busquets <luis.busquets at ilidium.com> wrote:
> This patch implements the function D3DXGetShaderSize and adds tests to two
> simple shader which have been extrated from d3d9/tests/shader.c
>
> +    /* We have to look for the end token 0x0000ffff which is D3DVS_END or D3DPS_END as both values are the same*/
> +    while (*address!=D3DVS_END()) {
The comment about D3DSIO_END still stands.

> +#define compare_shader_sizes(shader, exp) \
> +    shade=(DWORD *)shader; \
> +    got=D3DXGetShaderSize(shader); \
> +    ok(got==exp, "Expected: %d, Got: %d\n", exp, got);
This is pretty ugly, but I guess it works.

> +    compare_shader_sizes (simple_vs, 84);
> +    compare_shader_sizes (simple_ps, 88);
Please also test passing a NULL shader.
(FWIW, sizeof(simple_vs) should also work instead of hardcoding 84
here, same for simple_ps)


From hverbeet at gmail.com  Wed Apr  9 02:07:39 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Wed, 9 Apr 2008 09:07:39 +0200
Subject: d3dx8: D3DXGetFVFVertexSize 2/4
In-Reply-To: <47FBBDB0.6010708@ilidium.com>
References: <47FBBDB0.6010708@ilidium.com>
Message-ID: <d658b69e0804090007t619c4647gcb608d8c044f8ab9@mail.gmail.com>

On 08/04/2008, Luis Busquets <luis.busquets at ilidium.com> wrote:
> Implementation of D3DXGetFVFVertexSize. With this patch WINE responds
> correctly to the tests of D3DXGetFVFVertexSize sent in patch 1/4 of today.
>
You have to either send the implementation first and the test
afterwards, or wrap the test in a todo_wine block, and remove it when
you send the implementation.


From hverbeet at gmail.com  Wed Apr  9 02:11:54 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Wed, 9 Apr 2008 09:11:54 +0200
Subject: d3dx9: Implement D3DXGetShaderVersion with tests 4/4
In-Reply-To: <47FBBDBB.4000506@ilidium.com>
References: <47FBBDBB.4000506@ilidium.com>
Message-ID: <d658b69e0804090011s62bd60f3n54faa5ab6b4a2e2@mail.gmail.com>

On 08/04/2008, Luis Busquets <luis.busquets at ilidium.com> wrote:
> This patch implements D3DXGetShaderVersion and adds tests to two simple
> shader which have been extrated from d3d9/tests/shader.c
>
> +    compare_shader_versions (simple_vs, 0xFFFE0101);
> +    compare_shader_versions (simple_ps, 0xFFFF0101);
D3DVS_VERSION(1, 1) and D3DPS_VERSION(1, 1) would be more appropriate
than 0xFFFE0101 and 0xFFFF0101 here.


From stefan at codeweavers.com  Wed Apr  9 02:18:12 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Wed, 9 Apr 2008 09:18:12 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
In-Reply-To: <e1d9e62c0804081849h3310a6e1md373d28ece59674b@mail.gmail.com>
References: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
	<e1d9e62c0804081711s23046a9aq7991a85522cee457@mail.gmail.com>
	<e1d9e62c0804081849h3310a6e1md373d28ece59674b@mail.gmail.com>
Message-ID: <200804090918.12309.stefan@codeweavers.com>

Am Mittwoch, 9. April 2008 03:49:07 schrieb Milan Kosti?:
>  Forgot to say that Indiana Jones: Emperors Tomb start and load level
> with or without enabled ps in winecfg, but if GL_ATI_fragment_shader
> is enabled in driver (ie 6 units in driconf), when it load level then
> i got hard freeze and must reboot computer on button
> (CTRL+ALT+Backspace and CTRL+ALT+D not help, it's only possibly to
> move mouse (no click) and nothing else).
>  When 5 units is used then everything goes fine, but that is without
> this shader:(.
In that case you should file a Mesa bug report. If your computer crashes it's 
by definition a driver bug, not a Wine bug. With a few bug reports the Mesa 
devs will see that the r200 isn't dead yet.


From hverbeet at gmail.com  Wed Apr  9 02:20:32 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Wed, 9 Apr 2008 09:20:32 +0200
Subject: [10/10] d3d9: Some Windows drivers set undefined attributes to 0.0
In-Reply-To: <200804081541.39186.stefan@codeweavers.com>
References: <200804081541.39186.stefan@codeweavers.com>
Message-ID: <d658b69e0804090020k2dcf61d7l85d4d46977ed3380@mail.gmail.com>

On 08/04/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
>  +    Sleep(100000);
Is that Sleep() really needed?


From saulius2 at ar.fi.lt  Wed Apr  9 04:20:58 2008
From: saulius2 at ar.fi.lt (Saulius Krasuckas)
Date: Wed, 9 Apr 2008 12:20:58 +0300 (EEST)
Subject: LoadStringW [1/2]
In-Reply-To: <001e01c8985f$1449e000$a600fea9@DMITRY>
References: <4794545B.4000909@procyongames.com><005101c85c07$b280a180$a600fea9@DMITRY><000601c85c08$f006a440$a600fea9@DMITRY><4794FD3E.2080204@procyongames.com><22821af30801211217g22c09c8bu597659ab11aafff0@mail.gmail.com><479504E4.4080401@procyongames.com><22821af30801211252l30be545cqc9cf37bb4b89451c@mail.gmail.com><47950AEF.9060409@procyongames.com><Pine.LNX.4.62.0804032333300.6745@tvarka.ar.fi.lt><006401c895f9$07c167d0$a600fea9@DMITRY>
	<Pine.LNX.4.62.0804061603190.17765@tvarka.ar.fi.lt>
	<001e01c8985f$1449e000$a600fea9@DMITRY>
Message-ID: <Pine.LNX.4.62.0804091213280.6351@tvarka.ar.fi.lt>

* On Mon, 7 Apr 2008, Dmitry Timoshkov wrote:
> * "Saulius Krasuckas" <saulius2 at ar.fi.lt> wrote:
> > 
> > > If the regression can be identified by someone able to read the code 
> > > and not by a regression test that doesn't matter.
> > 
> > Could you show me appropriate code lines of LoadStringA and a logic to 
> > follow, please?  I am schocked.
> > 
> > Dmitry, for me your statement is true only in the case of reading 
> > original code of appropriate DLL from MS :(
> 
> I suspect that you will be shocked even more if someone would say that
> something is really wrong out there if there is a need to explain what
> this list is about, 

And I am not asking for this.  Plus, You still have not answered my 
question: how regression in question can be identified only by reading 
Wine code (at least in case of LoadStringA).

> how the patch review process is going, and which code is reviewed in the 
> process.

So do you say Wine HQs aren't willing to attract more casual contributors 
to Wine code via wine-devel@ anymore? :(


From julliard at winehq.org  Wed Apr  9 04:13:22 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 09 Apr 2008 11:13:22 +0200
Subject: [PATCH 1/2] user32: add edit control check to see if its in a
	dialog on WM_CHAR/VK_RETURN.
In-Reply-To: <558b2f5c0804081604p514ef000oc0f6dba892e286af@mail.gmail.com>
	(Lei Zhang's message of "Tue, 8 Apr 2008 16:04:50 -0700")
References: <558b2f5c0804081604p514ef000oc0f6dba892e286af@mail.gmail.com>
Message-ID: <87k5j7jsr1.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> +static BOOL EDIT_IsInsideDialog(EDITSTATE *es)
> +{
> +    static WCHAR dialog_class[] = {'#','3','2','7','7','0',0};
> +    WCHAR name[8];
> +    int r;
> +
> +    r = GetClassNameW(es->hwndParent, name, 8);
> +    if (r > 0)
> +        if (!lstrcmpW(name, dialog_class))
> +            return TRUE;
> +    return FALSE;
> +}

You should test the WIN_ISDIALOG flag instead.

-- 
Alexandre Julliard
julliard at winehq.org


From dmitry at codeweavers.com  Wed Apr  9 04:28:34 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 9 Apr 2008 18:28:34 +0900
Subject: LoadStringW [1/2]
References: <4794545B.4000909@procyongames.com><005101c85c07$b280a180$a600fea9@DMITRY><000601c85c08$f006a440$a600fea9@DMITRY><4794FD3E.2080204@procyongames.com><22821af30801211217g22c09c8bu597659ab11aafff0@mail.gmail.com><479504E4.4080401@procyongames.com><22821af30801211252l30be545cqc9cf37bb4b89451c@mail.gmail.com><47950AEF.9060409@procyongames.com><Pine.LNX.4.62.0804032333300.6745@tvarka.ar.fi.lt><006401c895f9$07c167d0$a600fea9@DMITRY><Pine.LNX.4.62.0804061603190.17765@tvarka.ar.fi.lt><001e01c8985f$1449e000$a600fea9@DMITRY>
	<Pine.LNX.4.62.0804091213280.6351@tvarka.ar.fi.lt>
Message-ID: <027701c89a24$1752ed70$a600fea9@DMITRY>

"Saulius Krasuckas" <saulius2 at ar.fi.lt> wrote:

> And I am not asking for this.  Plus, You still have not answered my 
> question: how regression in question can be identified only by reading 
> Wine code (at least in case of LoadStringA).

I have no idea how the word 'only' has appeared in the sentence above,
and why it's not clear to you that reading Wine code is one of possible
ways to understand what the patchs does, and see possible improvements or
regressions caused by a patch. Or you know development methods which don't
require reading and understanding the code you are going to modify?

>> how the patch review process is going, and which code is reviewed in the 
>> process.
> 
> So do you say Wine HQs aren't willing to attract more casual contributors 
> to Wine code via wine-devel@ anymore? :(

I don't follow your logic here.

-- 
Dmitry.


From hverbeet at gmail.com  Wed Apr  9 04:34:16 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Wed, 9 Apr 2008 11:34:16 +0200
Subject: Implement D3DXMatrixStack_Push
In-Reply-To: <5f9140a20804090154q53cdf45bn1ffb68c18a7f21ca@mail.gmail.com>
References: <5f9140a20804090154q53cdf45bn1ffb68c18a7f21ca@mail.gmail.com>
Message-ID: <d658b69e0804090234j317eed10yd7e337f1cb01ac00@mail.gmail.com>

On 09/04/2008, David Adam <david.adam.cnrs at gmail.com> wrote:
> This would increase the size of the stack exponentially. Would it be better
> to do this:
>
> Take a stack_size_reference (for instance 32 items)
> When This->current =32, then increase the size of the stack of
> stack_size_reference (that is 64 items now)
> Then when This->current is =64, again increase the size of the stack of
> stack_size_reference (that is 98 items now), and so on....
>
>
> This would increase the size of the stack linearly instead of exponentially.
>
Growing exponentially is intended. If HeapReAlloc can't simply grow
the current block, it has to copy the contents over to a new memory
location. If the stack becomes larger, the relative time it costs to
do the copy becomes more and more expensive compared to the actual
push. Growing by a factor instead of by a constant size keeps the
amortized running time for a series of pushes constant independent of
the the array size. (Not that I expect a matrix stack to become large
enough for this to matter a whole lot, but that's the reasoning.)

> > You should also assign the result of HeapReAlloc() to This->matrix
> > again.
>
> I thought that
>
>  HeapReAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, This->matrix, ..........);
>
>
> do exactly what you say
It can't do that. HeapReAlloc takes a pointer to a memory location, so
it can change the memory at that location, but it can't change the
pointer itself.


From smoki00790 at gmail.com  Wed Apr  9 05:12:20 2008
From: smoki00790 at gmail.com (=?ISO-8859-2?Q?Milan_Kosti=E6?=)
Date: Wed, 9 Apr 2008 12:12:20 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
In-Reply-To: <200804090918.12309.stefan@codeweavers.com>
References: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
	<e1d9e62c0804081711s23046a9aq7991a85522cee457@mail.gmail.com>
	<e1d9e62c0804081849h3310a6e1md373d28ece59674b@mail.gmail.com>
	<200804090918.12309.stefan@codeweavers.com>
Message-ID: <e1d9e62c0804090312m41dbf12bta045b2c5272106bf@mail.gmail.com>

 Eh yes, i just checked what is difference between 9000 and 9250 and
find that 9000 has 4/2 units, but 9250 has 4/1. One physical unit
left! And this is likely problem because ati_fs is linked to max units
which is 6 in driver, but this card has only 5;). Seems to one is
emulated:D. I don't know, i think that my neighbour have 9100 (which
also has 4/2) in his vault and i'm must wine:) with that card first
(which is very possibly not working?:D) and if that is bug, i will
fill one massive bug for that thing on Mesa side:) and just hope that
someone of retired r200 devs will go back to business and improve
driver... Thanks for reading all this posts anyway.


From bunglehead at gmail.com  Wed Apr  9 05:37:38 2008
From: bunglehead at gmail.com (Nikolay Sivov)
Date: Wed, 9 Apr 2008 14:37:38 +0400
Subject: gdiplus: GdipAddPathArcI, GdipAddPathBezier implementation
Message-ID: <db9c62d60804090337h16932fc4wc176663d33e3d1af@mail.gmail.com>

Is it something wrong  with this patch?

Changelog:
  - GdipAddPathArcI, GdipAddPathBezier implemented using existing calls

Index: dlls/gdiplus/gdiplus.spec
===================================================================
RCS file: /home/wine/wine/dlls/gdiplus/gdiplus.spec,v
retrieving revision 1.170
diff -u -r1.170 gdiplus.spec
--- dlls/gdiplus/gdiplus.spec    24 Mar 2008 12:57:16 -0000    1.170
+++ dlls/gdiplus/gdiplus.spec    7 Apr 2008 18:57:29 -0000
@@ -1,6 +1,6 @@
@ stdcall GdipAddPathArc(ptr long long long long long long)
-@ stub GdipAddPathArcI
-@ stub GdipAddPathBezier
+@ stdcall GdipAddPathArcI(ptr long long long long long long)
+@ stdcall GdipAddPathBezier(ptr long long long long long long long long)
@ stdcall GdipAddPathBezierI(ptr long long long long long long long long)
@ stdcall GdipAddPathBeziers(ptr ptr long)
@ stub GdipAddPathBeziersI
Index: dlls/gdiplus/graphicspath.c
===================================================================
RCS file: /home/wine/wine/dlls/gdiplus/graphicspath.c,v
retrieving revision 1.33
diff -u -r1.33 graphicspath.c
--- dlls/gdiplus/graphicspath.c    4 Apr 2008 11:24:06 -0000    1.33
+++ dlls/gdiplus/graphicspath.c    7 Apr 2008 18:56:45 -0000
@@ -97,6 +97,13 @@
   return Ok;
}

+GpStatus WINGDIPAPI GdipAddPathArcI(GpPath *path, INT x1, INT y1, INT x2,
+    INT y2, REAL startAngle, REAL sweepAngle)
+{
+    TRACE("%p %d %d %d %d %f %f\n",path,x1,y1,x2,y2,startAngle,sweepAngle);
+    return GdipAddPathArc(path, (REAL)x1, (REAL)y1, (REAL)x2, {REAL)y2,
startAngle, sweepAngle);
+}
+
GpStatus WINGDIPAPI GdipAddPathBezierI(GpPath *path, INT x1, INT y1, INT x2,
   INT y2, INT x3, INT y3, INT x4, INT y4)
{
@@ -158,6 +165,23 @@
   return Ok;
}

+GpStatus WINGDIPAPI GdipAddPathBezier(GpPath *path, REAL x1, REAL y1, REAL
x2, REAL y2, REAL x3, REAL y3, REAL x4, REAL y4)
+{
+    GpPointF points[3];
+
+    points[0].X = x1;
+    points[0].Y = y1;
+    points[1].X = x2;
+    points[1].Y = y2;
+    points[2].X = x3;
+    points[2].Y = y3;
+    points[3].X = x4;
+    points[3].Y = y4;
+
+    TRACE("%p %f %f %f %f %f %f\n",path,x1,y1,x2,y2,x3,y3,x4,y4);
+    return GdipAddPathBeziers(path, points, 4);
+}
+
GpStatus WINGDIPAPI GdipAddPathEllipse(GpPath *path, REAL x, REAL y, REAL
width,
   REAL height)
{

Index: include/gdiplusflat.h
===================================================================
RCS file: /home/wine/wine/include/gdiplusflat.h,v
retrieving revision 1.155
diff -u -r1.155 gdiplusflat.h
--- include/gdiplusflat.h    24 Mar 2008 12:57:16 -0000    1.155
+++ include/gdiplusflat.h    7 Apr 2008 18:55:25 -0000
@@ -182,6 +182,8 @@
GpStatus WINGDIPAPI GdipSetTextureTransform(GpTexture *,GDIPCONST
GpMatrix*);

GpStatus WINGDIPAPI GdipAddPathArc(GpPath*,REAL,REAL,REAL,REAL,REAL,REAL);
+GpStatus WINGDIPAPI GdipAddPathArcI(GpPath*,INT,INT,INT,INT,REAL,REAL);
+GpStatus WINGDIPAPI
GdipAddPathBezier(GpPath*,REAL,REAL,REAL,REAL,REAL,REAL,REAL,REAL);
GpStatus WINGDIPAPI
GdipAddPathBezierI(GpPath*,INT,INT,INT,INT,INT,INT,INT,INT);
GpStatus WINGDIPAPI GdipAddPathBeziers(GpPath*,GDIPCONST GpPointF*,INT);
GpStatus WINGDIPAPI GdipAddPathEllipse(GpPath*,REAL,REAL,REAL,REAL);
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080409/0d615f75/attachment.htm 

From luis.busquets at ilidium.com  Wed Apr  9 05:52:34 2008
From: luis.busquets at ilidium.com (Luis Busquets)
Date: Wed, 09 Apr 2008 12:52:34 +0200
Subject: d3dx8: D3DXGetFVFVertexSize 2/4
In-Reply-To: <d658b69e0804090007t619c4647gcb608d8c044f8ab9@mail.gmail.com>
References: <47FBBDB0.6010708@ilidium.com>
	<d658b69e0804090007t619c4647gcb608d8c044f8ab9@mail.gmail.com>
Message-ID: <47FC9FF2.8050604@ilidium.com>

I do not understand what you mean. I have added the test in patch 1/4 
and the implementation in 2/4. I have done so as D3DXGetFVFVertexSize 
was already implemented as a stub and test 1/4 obviously shows that 
until you apply implmentation 2/4. Is this not correct?

How should I proceed? Do I merge both patches (1 and) in just one?

H. Verbeet escribio':
> On 08/04/2008, Luis Busquets <luis.busquets at ilidium.com> wrote:
>   
>> Implementation of D3DXGetFVFVertexSize. With this patch WINE responds
>> correctly to the tests of D3DXGetFVFVertexSize sent in patch 1/4 of today.
>>
>>     
> You have to either send the implementation first and the test
> afterwards, or wrap the test in a todo_wine block, and remove it when
> you send the implementation.
>
>
>   

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080409/e110c398/attachment.htm 

From tony.wasserka at freenet.de  Wed Apr  9 06:27:41 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Wed, 09 Apr 2008 13:27:41 +0200
Subject: d3dx8 [6/7] Implement D3DXMatrixStack_Push
Message-ID: <E1JjYSr-0001tH-DU@www9.emo.freenet-rz.de>

> > +    This->current = This->current +1;
> > +    HeapReAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, This->matrix, (This->current +1) * sizeof(D3DXMATRIX) );
> > +    if ( This->matrix == NULL ) return E_OUTOFMEMORY;

> Aside from being a bit suboptimal (doing a realloc on every push),
> this probably doesn't do what you want. Consider what happens to the
> size of the array when you do something like push/pop/push/pop/...etc.
> 
> It would be better to keep track of the current stack size, and then
> grow it by a factor (eg. 2 or 1.5) if a push would overflow the
> current stack. You could also consider shrinking the array again if a
> pop would make it use less than a certain percentage of the current
> size (eg. a third).
> 
> You should also assign the result of HeapReAlloc() to This->matrix
> again. Although it's quite possible for HeapReAlloc to just grow the
> current block without changing its location, there's no guarantee it
> will. The NULL check is useless this way.

Just a little addition, I think we should resize the stack differently at different situations, i.e.:
- resize it to (This->current+3) if This->currect<5 (something around that is the minimum number of matrices for which anyone would even bother using a MatrixStack)
- resize it to (This->current*2) if This->current<12 (when it seems like the application's gonna push many matrices on the stack)
- resize it to (This->current+16) if This->current>=12 (when *2 could waste memory)
However, I don't know if these numbers are optimal, it's just a suggestion.

For the Pop function, I agree that you should free some memory when it's unused, but my suggestion from above fits here, too. However, one third is okay, too, as it isn't that relevant here.











From stefan at codeweavers.com  Wed Apr  9 07:16:44 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Wed, 9 Apr 2008 14:16:44 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
In-Reply-To: <e1d9e62c0804090312m41dbf12bta045b2c5272106bf@mail.gmail.com>
References: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
	<200804090918.12309.stefan@codeweavers.com>
	<e1d9e62c0804090312m41dbf12bta045b2c5272106bf@mail.gmail.com>
Message-ID: <200804091416.44718.stefan@codeweavers.com>

Am Mittwoch, 9. April 2008 12:12:20 schrieb Milan Kosti?:
>  Eh yes, i just checked what is difference between 9000 and 9250 and
> find that 9000 has 4/2 units, but 9250 has 4/1. One physical unit
> left! And this is likely problem because ati_fs is linked to max units
> which is 6 in driver, but this card has only 5;). Seems to one is
> emulated:D. I don't know, i think that my neighbour have 9100 (which
> also has 4/2) in his vault and i'm must wine:) with that card first
> (which is very possibly not working?:D) and if that is bug, i will
> fill one massive bug for that thing on Mesa side:) and just hope that
> someone of retired r200 devs will go back to business and improve
> driver... Thanks for reading all this posts anyway.
I doubt 3DMark2001 uses all 6 texture units even in the high shader test 
because it works on Nvidia cards which only support 4 simultaneous textures. 
If it uses 4 textures and 6 or more texture stages(ie, texture stage settings 
that do not sample from a texture), it might be worth looking into the 
texture map stuff we're using with the nvidia register combiner code. With 
atifs we can support 6 simultaneous textures and 8 texture stages.


From saulius2 at ar.fi.lt  Wed Apr  9 07:09:46 2008
From: saulius2 at ar.fi.lt (Saulius Krasuckas)
Date: Wed, 9 Apr 2008 15:09:46 +0300 (EEST)
Subject: LoadStringW [1/2]
In-Reply-To: <027701c89a24$1752ed70$a600fea9@DMITRY>
References: <4794545B.4000909@procyongames.com><005101c85c07$b280a180$a600fea9@DMITRY><000601c85c08$f006a440$a600fea9@DMITRY><4794FD3E.2080204@procyongames.com><22821af30801211217g22c09c8bu597659ab11aafff0@mail.gmail.com><479504E4.4080401@procyongames.com><22821af30801211252l30be545cqc9cf37bb4b89451c@mail.gmail.com><47950AEF.9060409@procyongames.com><Pine.LNX.4.62.0804032333300.6745@tvarka.ar.fi.lt><006401c895f9$07c167d0$a600fea9@DMITRY><Pine.LNX.4.62.0804061603190.17765@tvarka.ar.fi.lt><001e01c8985f$1449e000$a600fea9@DMITRY>
	<Pine.LNX.4.62.0804091213280.6351@tvarka.ar.fi.lt>
	<027701c89a24$1752ed70$a600fea9@DMITRY>
Message-ID: <Pine.LNX.4.62.0804091444050.6351@tvarka.ar.fi.lt>

* On Wed, 9 Apr 2008, Dmitry Timoshkov wrote:
> * "Saulius Krasuckas" <saulius2 at ar.fi.lt> wrote:
> > 
> > You still have not answered my question: how regression in question 
> > can be identified only by reading Wine code (at least in case of 
> > LoadStringA).
> 
> I have no idea how the word 'only' has appeared in the sentence above,

I am sorry for my hurry, it's really unnecessary here.

> and why it's not clear to you that reading Wine code is one of possible
> ways to understand what the patchs does, and see possible improvements or
> regressions caused by a patch. Or you know development methods which don't
> require reading and understanding the code you are going to modify?

Well, what I meant was if you haven't tested LoadStringA in Windows, then 
reading code won't help you to see a bug in it.  Excuse me my English, if 
earlier msgs of mine didn't sound like that.

Such is specifity (peculiarity) of any API translator, no?

> I don't follow your logic here.

Well, switching to private comm.


From smoki00790 at gmail.com  Wed Apr  9 07:33:26 2008
From: smoki00790 at gmail.com (=?ISO-8859-2?Q?Milan_Kosti=E6?=)
Date: Wed, 9 Apr 2008 14:33:26 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
In-Reply-To: <200804091416.44718.stefan@codeweavers.com>
References: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
	<200804090918.12309.stefan@codeweavers.com>
	<e1d9e62c0804090312m41dbf12bta045b2c5272106bf@mail.gmail.com>
	<200804091416.44718.stefan@codeweavers.com>
Message-ID: <e1d9e62c0804090533g5b505f43od13e67b41c322024@mail.gmail.com>

 Yes that's sounds good! And to say that i'm checkedout more about
diffs with our cards and found something in wikipedia article. 9000
and 9250 both has 4/1 units, cards are with the same units setup, only
rv280 has 8x AGP bus. And 9000 pro version is same, but with higher
core and memory clocks and better bandwidth.

 http://en.wikipedia.org/wiki/Comparison_of_ATI_graphics_processing_units

 And then that's not a problem:(. I don't know what to say to the Mesa
developers: I'm have hard freeze with current wine, with just one game
when units are on default? Huh, I don't think thats will remove all
this bugs.


From wine-devel at kievinfo.com  Wed Apr  9 08:22:17 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 09 Apr 2008 07:22:17 -0600
Subject: d3dx8: D3DXGetFVFVertexSize 2/4
In-Reply-To: <47FC9FF2.8050604@ilidium.com>
References: <47FBBDB0.6010708@ilidium.com>	<d658b69e0804090007t619c4647gcb608d8c044f8ab9@mail.gmail.com>
	<47FC9FF2.8050604@ilidium.com>
Message-ID: <47FCC309.9020202@kievinfo.com>

Luis Busquets wrote:
> H. Verbeet escribi?:
>> On 08/04/2008, Luis Busquets <luis.busquets at ilidium.com> wrote:
>>   
>>> Implementation of D3DXGetFVFVertexSize. With this patch WINE responds
>>> correctly to the tests of D3DXGetFVFVertexSize sent in patch 1/4 of today.
>>>
>>>     
>> You have to either send the implementation first and the test
>> afterwards, or wrap the test in a todo_wine block, and remove it when
>> you send the implementation.
>>
 > I do not understand what you mean. I have added the test in patch 1/4
 > and the implementation in 2/4. I have done so as D3DXGetFVFVertexSize
 > was already implemented as a stub and test 1/4 obviously shows that
 > until you apply implmentation 2/4. Is this not correct?
 >
 > How should I proceed? Do I merge both patches (1 and) in just one?
 >
Regardless of what you adding and when tests should never fail or your patch 
will be rejected.

If you adding tests first that don't pass on current Wine mark each test 
with todo_wine. This is special wrapper around the test that indicates it's 
ok for this test to fail.

When you running tests manually it will still appear they fail. But when you 
run 'make test' those tests will pass.


Vitaliy.


From rob at codeweavers.com  Wed Apr  9 08:39:50 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 09 Apr 2008 14:39:50 +0100
Subject: msdmo: Array parameter is passed to function as pointer so loses
	size	information
In-Reply-To: <200804072239.34412.andrew.talbot@talbotville.com>
References: <200804072239.34412.andrew.talbot@talbotville.com>
Message-ID: <47FCC726.60406@codeweavers.com>

Andrew Talbot wrote:
> @@ -291,8 +291,9 @@ lend:
>   *
>   * Get DMP Name from the registry
>   */
> -HRESULT WINAPI DMOGetName(REFCLSID clsidDMO, WCHAR szName[80])
> +HRESULT WINAPI DMOGetName(REFCLSID clsidDMO, WCHAR szName[])
>  {
> +#define NAME_SIZE   80  /* Size of szName[] */
>      WCHAR szguid[64];
>      HRESULT hres;
>      HKEY hrkey = 0;
> @@ -311,7 +312,7 @@ HRESULT WINAPI DMOGetName(REFCLSID clsidDMO, WCHAR szName[80])
>      if (ERROR_SUCCESS != hres)
>          goto lend;
>  
> -    count = sizeof(szName);
> +    count = NAME_SIZE;
>      hres = RegQueryValueExW(hkey, NULL, NULL, NULL, 
>          (LPBYTE) szName, &count); 
>   

This is incorrect. count is the size in bytes of the buffer passed in 
(szName) and so should be sizeof(szName) not 
sizeof(szName)/sizeof(szName[0]) (i.e. 80).

I see this patch has already been committed, so 
a9200b24014607c4c82fb052b97de88daa804a81 should be reverted.

If you want to pick up errors like passing the wrong size into functions 
then I would suggest using an automatic checker that is able to use 
semantic information, like Microsoft's PREfast.

-- 
Rob Shearman



From dank at kegel.com  Wed Apr  9 09:03:47 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 9 Apr 2008 07:03:47 -0700
Subject: New winetricks-20080409: new verb vista, don't get confused by WGETRC,
	use curl and openssl if needed
Message-ID: <a71bd89a0804090703t2c61214y9d8b35a3ee7c9484@mail.gmail.com>

Another day, another winetricks.

Version 20080409 has the following changes:

Added winver=vista, since I found an app that refuses to install
if winnt <= 502.

Use curl and openssl instead of wget and sha1sum if needed (e.g. on
mac), as suggested by Ryan Schmidt

Use -nd option with wget, as suggested by Hin-Tak Leung

As always, winetricks is available at
   http://kegel.com/wine/winetricks


From thestig at google.com  Wed Apr  9 11:13:01 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 9 Apr 2008 09:13:01 -0700
Subject: Updated three Power Profile functions to match MSDN
In-Reply-To: <00a801c89a0a$607c52d0$a600fea9@DMITRY>
References: <ed7be3850804081928i666ced0ch51e8d8ede8a9a2cc@mail.gmail.com>
	<00a801c89a0a$607c52d0$a600fea9@DMITRY>
Message-ID: <558b2f5c0804090913y33f85d7ag30c9ecbcff1de6e9@mail.gmail.com>

On Tue, Apr 8, 2008 at 11:24 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> "Black Dragon" <blackdragon1157 at gmail.com> wrote:
>
>  First of all Wine doesn't accept patches from an anonymous person,
>  please use your real name.
>

He did use his real name in the attachment. Probably just need to
configure his email client properly.


From zgs at seas.upenn.edu  Wed Apr  9 11:25:20 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Wed, 9 Apr 2008 12:25:20 -0400
Subject: .net 2 first light on nontrivial apps
In-Reply-To: <a71bd89a0804082356w7414de5fufe9e2792e824c88f@mail.gmail.com>
References: <a71bd89a0804082356w7414de5fufe9e2792e824c88f@mail.gmail.com>
Message-ID: <b050a5e70804090925j4680f52ah8f65010b8e7482e2@mail.gmail.com>

On Wed, Apr 9, 2008 at 2:56 AM, Dan Kegel <dank at kegel.com> wrote:
> It looks like 'winetricks dotnet20' and current wine
>  is good enough that .net support isn't quite the
>  limiting factor anymore!  See
>  http://bugs.winehq.org/show_bug.cgi?id=8499
>  http://bugs.winehq.org/show_bug.cgi?id=12457
>  http://bugs.winehq.org/show_bug.cgi?id=12458
>  for three sizeable apps that actually put up
>  their GUIs, at least briefly.  MySQL Workbench
>  actually runs well enough to explore the GUI.
>
>
>

Hm, looks like we'll have to begin to get used to
"System.NotImplementedException"s :).  Do crashing .net apps still
print the full wine stack trace as well?



-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From Andrew.Talbot at talbotville.com  Wed Apr  9 11:54:53 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Wed, 09 Apr 2008 17:54:53 +0100
Subject: msdmo: Array parameter is passed to function as pointer so loses
	size	information
References: <200804072239.34412.andrew.talbot@talbotville.com>
	<47FCC726.60406@codeweavers.com>
Message-ID: <ftisct$ha8$1@ger.gmane.org>

Robert Shearman wrote:
> This is incorrect. count is the size in bytes of the buffer passed in
> (szName) and so should be sizeof(szName) not
> sizeof(szName)/sizeof(szName[0]) (i.e. 80).
> 

Are you sure? MSDN says "szName: Array of 80 Unicode characters that
receives the name of the DMO".

> If you want to pick up errors like passing the wrong size into functions
> then I would suggest using an automatic checker that is able to use
> semantic information, like Microsoft's PREfast.
> 

Your implied presumption may not be correct. But, in any case, when arrays
are passed as arguments to functions they are converted to pointers, so
sizeof(szName) would represent the size of a pointer to the array, not the
size of the array itself.

-- 
Andy.




From dank at kegel.com  Wed Apr  9 11:56:44 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 9 Apr 2008 09:56:44 -0700
Subject: .net 2 first light on nontrivial apps
In-Reply-To: <b050a5e70804090925j4680f52ah8f65010b8e7482e2@mail.gmail.com>
References: <a71bd89a0804082356w7414de5fufe9e2792e824c88f@mail.gmail.com>
	<b050a5e70804090925j4680f52ah8f65010b8e7482e2@mail.gmail.com>
Message-ID: <a71bd89a0804090956i10e26ddem6b239b5add853e54@mail.gmail.com>

On Wed, Apr 9, 2008 at 9:25 AM, Zachary Goldberg <zgs at seas.upenn.edu> wrote:
>  Hm, looks like we'll have to begin to get used to
>  "System.NotImplementedException"s :).  Do crashing .net apps still
>  print the full wine stack trace as well?

Not usefully, that I could see, anyway.  Maybe if run inside winedbg.


From austinenglish at gmail.com  Wed Apr  9 12:08:40 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 9 Apr 2008 12:08:40 -0500
Subject: Compile broken on Ubuntu Hardy/gutsy/feisty
Message-ID: <b6bb06270804091008t7b558a3cu84807ca16405f7f7@mail.gmail.com>

In today's git, I can't compile in either my Kubuntu Hardy or Ubuntu
feisty machines. A user also reported this on wine-user (1), using
Ubuntu Gutsy (64bit). Compile is failing in make depend on:

make[2]: Entering directory `/home/austin/wine-git/dlls/qedit/tests'
../../../tools/makedep -C. -S../../.. -T../../..  mediadet.c  qedit.rc
sound_test.avi: No such file or directory
  sound_test.avi was first included from qedit.rc:25
make[2]: *** [depend] Error 1
make[2]: Leaving directory `/home/austin/wine-git/dlls/qedit/tests'
make[1]: *** [qedit/tests/__depend__] Error 2
make[1]: Leaving directory `/home/austin/wine-git/dlls'
make: *** [dlls/__depend__] Error 2

Regression test points to:

austin at austin-desktop:~/wine-git$ git bisect good
d3061d48e1c78c331b93be7a880876ebff2730dd is first bad commit
commit d3061d48e1c78c331b93be7a880876ebff2730dd
Author: Dan Hipschman <dsh at linux.ucla.edu>
Date:   Tue Apr 8 16:53:52 2008 -0700

    qedit: Implement IMediaDet_get_OutputStreams.

:040000 040000 a897c878bae291a217075d8a2db3c6d04de1ad2a
6d6e883a2629e004b361ceb844a0ca0680a1fa75 M      dlls

The patch below fixes it:
diff --git a/dlls/qedit/tests/qedit.rc b/dlls/qedit/tests/qedit.rc
index a0b8b80..733beac 100644
--- a/dlls/qedit/tests/qedit.rc
+++ b/dlls/qedit/tests/qedit.rc
@@ -22,5 +22,5 @@

 /* @makedep: test.avi */
 TEST_AVI_RES       AVI_RES_TYPE test.avi
-/* @makedep: sound_test.avi */
+/* @makedep: test_sound.avi */
 TEST_SOUND_AVI_RES AVI_RES_TYPE test_sound.avi

I'll submit it to wine-patches.
(1) http://forum.winehq.org/viewtopic.php?t=498


From david.adam.cnrs at gmail.com  Wed Apr  9 03:54:37 2008
From: david.adam.cnrs at gmail.com (David Adam)
Date: Wed, 9 Apr 2008 10:54:37 +0200
Subject: Implement D3DXMatrixStack_Push
Message-ID: <5f9140a20804090154q53cdf45bn1ffb68c18a7f21ca@mail.gmail.com>

On 08/04/2008, David Adam <david.adam.cnrs at gmail.com
<http://www.winehq.org/mailman/listinfo/wine-patches>> wrote:
>* +    This->current = This->current +1;
*>* +    HeapReAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, This->matrix,
(This->current +1) * sizeof(D3DXMATRIX) );
*>* +    if ( This->matrix == NULL ) return E_OUTOFMEMORY;
*
> Aside from being a bit suboptimal (doing a realloc on every push),
> this probably doesn't do what you want. Consider what happens to the
> size of the array when you do something like push/pop/push/pop/...etc.
>
> It would be better to keep track of the current stack size, and then
> grow it by a factor (eg. 2 or 1.5) if a push would overflow the
> current stack.
> You could also consider shrinking the array again if a
> pop would make it use less than a certain percentage of the current
> size (eg. a third).

This would increase the size of the stack exponentially. Would it be
better to do this:
Take a stack_size_reference (for instance 32 items)
When This->current =32, then increase the size of the stack of
stack_size_reference (that is 64 items now)
Then when This->current is =64, again increase the size of the stack
of stack_size_reference (that is 98 items now), and so on....

This would increase the size of the stack linearly instead of exponentially.

In the opposite, for MatrixStack_Pop, assume that the size of the
stack is 98 and This->current is 64.
Then one could shrink the size of the stack from 98 to
98-size_stack_reference that is 64.


> You should also assign the result of HeapReAlloc() to This->matrix
> again.

*I thought that

 HeapReAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, This->matrix, ..........);**
*
do exactly what you say


Although it's quite possible for HeapReAlloc to just grow the
> current block without changing its location, there's no guarantee it
> will. The NULL check is useless this way.

Thanks for your very useful feedback.

David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080409/b9f859ed/attachment.htm 

From dsh at linux.ucla.edu  Wed Apr  9 12:59:26 2008
From: dsh at linux.ucla.edu (Dan Hipschman)
Date: Wed, 9 Apr 2008 10:59:26 -0700
Subject: qedit: fix compile error in qedit.rc
In-Reply-To: <b6bb06270804091010t1cf55a99xed92e5fa49bd495b@mail.gmail.com>
References: <b6bb06270804091010t1cf55a99xed92e5fa49bd495b@mail.gmail.com>
Message-ID: <20080409175926.GH11580@linux.ucla.edu>

On Wed, Apr 09, 2008 at 12:10:55PM -0500, Austin English wrote:
>  /* @makedep: test.avi */
>  TEST_AVI_RES       AVI_RES_TYPE test.avi
> -/* @makedep: sound_test.avi */
> +/* @makedep: test_sound.avi */
>  TEST_SOUND_AVI_RES AVI_RES_TYPE test_sound.avi

Oops, sorry, and thanks for fixing it.


From wine.dev at web.de  Wed Apr  9 13:13:44 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Wed, 09 Apr 2008 20:13:44 +0200
Subject: [2/2] winspool.drv: GetDefaultPrinterW reads the value from
	data in registry
In-Reply-To: <200804081539.16315.kondratyuk@etersoft.ru>
References: <200804081539.16315.kondratyuk@etersoft.ru>
Message-ID: <1207764825.15786.13.camel@p4>

On Di, 2008-04-08 at 15:39 +0400, Konstantin Kondratyuk wrote:
> -    if (!GetProfileStringW(windowsW, deviceW, emptyStringW, buffer,
> len))
> +    if(!RegOpenKeyW(HKEY_CURRENT_USER, user_default_reg_key, &hKey) 
> +            && !RegQueryValueExW(hKey, keyname, NULL, &type,
> (LPBYTE)buffer, &bufsize))
> +    {
> +        TRACE("Get value from registry\n");
> +        RegCloseKey( hKey );
> +    }

win3.x and win9.x use only "win.ini".
We need to fix bug #4096, before we can switch to the Registry.

> +    else if (!GetProfileStringW(windowsW, deviceW, emptyStringW,
> buffer, len))

There is no need for a Fallback, when bug #4096 is fixed.


-- 
 
By by ... Detlef




From stefan at codeweavers.com  Wed Apr  9 13:37:07 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 9 Apr 2008 20:37:07 +0200
Subject: Implement D3DXMatrixStack_Push
In-Reply-To: <5f9140a20804090154q53cdf45bn1ffb68c18a7f21ca@mail.gmail.com>
References: <5f9140a20804090154q53cdf45bn1ffb68c18a7f21ca@mail.gmail.com>
Message-ID: <200804092037.07459.stefan@codeweavers.com>

Am Mittwoch, 9. April 2008 10:54:37 schrieb David Adam:
> On 08/04/2008, David Adam <david.adam.cnrs at gmail.com
>
> <http://www.winehq.org/mailman/listinfo/wine-patches>> wrote:
> >* +    This->current = This->current +1;
>
> *>* +    HeapReAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, This->matrix,
> (This->current +1) * sizeof(D3DXMATRIX) );
> *>* +    if ( This->matrix == NULL ) return E_OUTOFMEMORY;
> *
>
> > Aside from being a bit suboptimal (doing a realloc on every push),
> > this probably doesn't do what you want. Consider what happens to the
> > size of the array when you do something like push/pop/push/pop/...etc.
> >
> > It would be better to keep track of the current stack size, and then
> > grow it by a factor (eg. 2 or 1.5) if a push would overflow the
> > current stack.
> > You could also consider shrinking the array again if a
> > pop would make it use less than a certain percentage of the current
> > size (eg. a third).
>
> This would increase the size of the stack exponentially. Would it be
> better to do this:
> Take a stack_size_reference (for instance 32 items)
> When This->current =32, then increase the size of the stack of
> stack_size_reference (that is 64 items now)
> Then when This->current is =64, again increase the size of the stack
> of stack_size_reference (that is 98 items now), and so on....
>
> This would increase the size of the stack linearly instead of
> exponentially.
You usually grow the memory by a factor of the old size because this reduces 
the number of needed grows. So growing the stack is an O(log(n)) instead of 
O(n), which is a huge difference.

The drawback is that you have potentially more wasted memory. I don't know 
what the theory says to that though. The amount of wasted memory is always 
smaller than the amount of used memory at least if you double the size and 
smaller if you grow it by 1/2 of the existing size, ...


From xixsimplicityxix at gmail.com  Wed Apr  9 13:38:01 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 9 Apr 2008 13:38:01 -0500
Subject: msdmo: Array parameter is passed to function as pointer so loses
	size information
In-Reply-To: <ftisct$ha8$1@ger.gmane.org>
References: <200804072239.34412.andrew.talbot@talbotville.com>
	<47FCC726.60406@codeweavers.com> <ftisct$ha8$1@ger.gmane.org>
Message-ID: <78a7dad00804091138o50a3d2ejb90c6dfaca771505@mail.gmail.com>

On Wed, Apr 9, 2008 at 11:54 AM, Andrew Talbot
<Andrew.Talbot at talbotville.com> wrote:
> Robert Shearman wrote:
>  > This is incorrect. count is the size in bytes of the buffer passed in
>  > (szName) and so should be sizeof(szName) not
>  > sizeof(szName)/sizeof(szName[0]) (i.e. 80).
>  >
>
Andrew T is right about arrays being decayed to pointers when passed
into functions, so sizeof(szName) is going to reuturn 4 or 8 or
whatever.  If count needs to be the size of the buffer shouldn't it
be:

count = NAME_SIZE * sizeof(WCHAR);

but probably better would be DMO_MAX_NAME_SIZE and be in a header
somewhere (dmo.h?)?

Regards,
John


From thestig at google.com  Wed Apr  9 13:38:29 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 9 Apr 2008 11:38:29 -0700
Subject: [PATCH 3/3] user32: fix a typo. (resend)
Message-ID: <558b2f5c0804091138q32a7aac4pb91993c34189667a@mail.gmail.com>

Resending...
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 0003-user32-fix-a-typo.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080409/adfdcdce/attachment.txt 

From Andrew.Talbot at talbotville.com  Wed Apr  9 14:18:19 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Wed, 09 Apr 2008 20:18:19 +0100
Subject: msdmo: Array parameter is passed to function as pointer so loses
	size information
References: <200804072239.34412.andrew.talbot@talbotville.com>
	<47FCC726.60406@codeweavers.com> <ftisct$ha8$1@ger.gmane.org>
	<78a7dad00804091138o50a3d2ejb90c6dfaca771505@mail.gmail.com>
Message-ID: <ftj4pr$i1a$1@ger.gmane.org>

John Klehm wrote:

If count needs to be the size of the buffer shouldn't it
> be:
> 
> count = NAME_SIZE * sizeof(WCHAR);
> 
> but probably better would be DMO_MAX_NAME_SIZE and be in a header
> somewhere (dmo.h?)?
> 
> Regards,
> John

Ah yes, whoops. I'm pretty sure I had just that lined up, but I reckon I
must have done an 'undo' or something and taken off the multiplier. I'm
hesitant to create a header just for one constant, so I shall send a patch
to bring in the multiplier and with the more descriptive name, since
Alexandre rightly dropped my descriptive comment.

Thanks for catching that!

-- 
Andy.




From hverbeet at gmail.com  Wed Apr  9 15:41:25 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Wed, 9 Apr 2008 22:41:25 +0200
Subject: Implement D3DXMatrixStack_Push
In-Reply-To: <200804092037.07459.stefan@codeweavers.com>
References: <5f9140a20804090154q53cdf45bn1ffb68c18a7f21ca@mail.gmail.com>
	<200804092037.07459.stefan@codeweavers.com>
Message-ID: <d658b69e0804091341m2a745e50w740ca0ce1b91c6a1@mail.gmail.com>

On 09/04/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> You usually grow the memory by a factor of the old size because this reduces
>  the number of needed grows. So growing the stack is an O(log(n)) instead of
>  O(n), which is a huge difference.
>
No, the amortized time per push is O(1). The realloc becomes more
expensive as the array gets larger.

>  The drawback is that you have potentially more wasted memory. I don't know
>  what the theory says to that though. The amount of wasted memory is always
>  smaller than the amount of used memory at least if you double the size and
>  smaller if you grow it by 1/2 of the existing size, ...
>
On average the percentage of wasted memory is (factor - 1) / 2. You
make a trade of between memory usage and run time when picking the
factor.


From wine.dev at web.de  Wed Apr  9 15:42:32 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Wed, 09 Apr 2008 22:42:32 +0200
Subject: Compile broken on Ubuntu Hardy/gutsy/feisty
In-Reply-To: <b6bb06270804091008t7b558a3cu84807ca16405f7f7@mail.gmail.com>
References: <b6bb06270804091008t7b558a3cu84807ca16405f7f7@mail.gmail.com>
Message-ID: <1207773752.15786.15.camel@p4>

On Mi, 2008-04-09 at 12:08 -0500, Austin English wrote:
> In today's git, I can't compile in either my Kubuntu Hardy or Ubuntu
> feisty machines. A user also reported this on wine-user (1), using
> Ubuntu Gutsy (64bit). Compile is failing in make depend on:

It's fixed in git. Mikolaj did a Patch hours ago.


-- 
 
By by ... Detlef




From stefan at codeweavers.com  Wed Apr  9 15:58:41 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 9 Apr 2008 22:58:41 +0200
Subject: Implement D3DXMatrixStack_Push
In-Reply-To: <d658b69e0804091341m2a745e50w740ca0ce1b91c6a1@mail.gmail.com>
References: <5f9140a20804090154q53cdf45bn1ffb68c18a7f21ca@mail.gmail.com>
	<200804092037.07459.stefan@codeweavers.com>
	<d658b69e0804091341m2a745e50w740ca0ce1b91c6a1@mail.gmail.com>
Message-ID: <200804092258.41769.stefan@codeweavers.com>

Am Mittwoch, 9. April 2008 22:41:25 schrieb H. Verbeet:
> On 09/04/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> > You usually grow the memory by a factor of the old size because this
> > reduces the number of needed grows. So growing the stack is an O(log(n))
> > instead of O(n), which is a huge difference.
>
> No, the amortized time per push is O(1). The realloc becomes more
> expensive as the array gets larger.
Good point



From truiken at gmail.com  Wed Apr  9 16:22:29 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 9 Apr 2008 16:22:29 -0500
Subject: msdmo: Fix calculation of array size in bytes
In-Reply-To: <200804092216.37221.andrew.talbot@talbotville.com>
References: <200804092216.37221.andrew.talbot@talbotville.com>
Message-ID: <22821af30804091422i30d02be6k585100de1304a7d1@mail.gmail.com>

On Wed, Apr 9, 2008 at 4:16 PM, Andrew Talbot
<andrew.talbot at talbotville.com> wrote:
> Changelog:
>     msdmo: Fix calculation of array size in bytes.
>
>  diff --git a/dlls/msdmo/dmoreg.c b/dlls/msdmo/dmoreg.c
>  index f6d71bd..c6eb1b6 100644
>  --- a/dlls/msdmo/dmoreg.c
>  +++ b/dlls/msdmo/dmoreg.c
>  @@ -293,11 +293,11 @@ lend:
>   */
>   HRESULT WINAPI DMOGetName(REFCLSID clsidDMO, WCHAR szName[])
>   {
>  -#define NAME_SIZE   80  /* Size of szName[] */
>      WCHAR szguid[64];
>      HRESULT hres;
>      HKEY hrkey = 0;
>      HKEY hkey = 0;
>  +    enum {max_name_len = 80};
>      DWORD count;
>
>      TRACE("%s\n", debugstr_guid(clsidDMO));
>

Don't you think a static const int would be even better?

-- 
James Hawkins


From winehacker at gmail.com  Wed Apr  9 16:24:29 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Wed, 9 Apr 2008 17:24:29 -0400
Subject: optimizations for 1.0
In-Reply-To: <19e31a080804081954x63dd863by7847d7a48c8477a0@mail.gmail.com>
References: <19e31a080804081059y57be05c2k3a2f9c51646b8b8c@mail.gmail.com>
	<47FBD34F.4030609@open-vote.org>
	<19e31a080804081521p4106c3b6x45765c683a60f133@mail.gmail.com>
	<000a01c899e0$bab50a50$a600fea9@DMITRY>
	<19e31a080804081954x63dd863by7847d7a48c8477a0@mail.gmail.com>
Message-ID: <19e31a080804091424l19d5824fx3af46dd24d3b834f@mail.gmail.com>

On Tue, Apr 8, 2008 at 10:54 PM, Steven Edwards <winehacker at gmail.com> wrote:
>   I have a 64bit linux host and using -m32 with llvmgcc does not seem
>  to be very well documented. I expect to have problems with icc on
>  x86-64 also. Preconfigured LLVM packages for 2.2 work out of the box
>  on OS X where the current Ubuntu binary is at like 1.7 which does not
>  support inline asm. Don't worry, I'll try it in a 32bit linux vm with
>  my own build of llvm trunk and icc when I have more time.

I wasted a bit more time on this than I should have but I was able to
get the 32bit icc to work on my 64bit host to compile Wine with a few
hacks. I've documented the process on the wiki and submitted Wine test
results. If anyone else has time, please try icc on a 32bit host and
let me know if you get a crash when compiling oleaut32. Later when I
have more time I am going to run some benchmarks comparing a directx
game under wine compiled with gcc and icc.

http://wiki.winehq.org/icc
-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0003-icc-hacks.patch
Type: text/x-patch
Size: 5474 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080409/44363ca6/attachment.bin 

From Andrew.Talbot at talbotville.com  Wed Apr  9 16:58:31 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Wed, 09 Apr 2008 22:58:31 +0100
Subject: msdmo: Fix calculation of array size in bytes
References: <200804092216.37221.andrew.talbot@talbotville.com>
	<22821af30804091422i30d02be6k585100de1304a7d1@mail.gmail.com>
Message-ID: <ftje67$m53$1@ger.gmane.org>

James Hawkins wrote:

> 
> Don't you think a static const int would be even better?
> 

Indeed. Re-submission imminent.

Thanks,

-- 
Andy.




From stefan at codeweavers.com  Wed Apr  9 18:05:11 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 10 Apr 2008 01:05:11 +0200
Subject: [1/2] WineD3D: Do not activate CTXUSAGE_BLIT for fb -> texture
	reading
In-Reply-To: <200804100042.04689.stefan@codeweavers.com>
References: <200804100042.04689.stefan@codeweavers.com>
Message-ID: <200804100105.11201.stefan@codeweavers.com>

Am Donnerstag, 10. April 2008 00:42:04 schrieb Stefan D?singer:
> This ActivateContext call slipped in with patch
> ba90a740beb9ce9a839cc843db8d87f5a37becdd. Roderick, was there a particular
> reason why you activate CTXUSAGE_BLIT here, or was it just a copypaste
> mistake from the glReadPixels codepath?
I see now why the ActivateContext call is there. If the LoadLocation is not 
called from the PreLoad readback then a different surface might be active. 
Also CTXUSAGE_BLIT seems to be necessary in some situations, but I don't know 
which yet. I guess more investigation is needed here

So please do not apply the patches yet


From leslie_alistair at hotmail.com  Wed Apr  9 19:05:22 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Thu, 10 Apr 2008 10:05:22 +1000
Subject: New winetricks-20080409: new verb vista,
	don't get confused by WGETRC, use curl and openssl if needed
References: <a71bd89a0804090703t2c61214y9d8b35a3ee7c9484@mail.gmail.com>
Message-ID: <ftjlf0$ata$1@ger.gmane.org>

"Dan Kegel" <dank at kegel.com> wrote in message 
news:a71bd89a0804090703t2c61214y9d8b35a3ee7c9484 at mail.gmail.com...
> Another day, another winetricks.
>
> Version 20080409 has the following changes:
>
> Added winver=vista, since I found an app that refuses to install
> if winnt <= 502.
>
> Use curl and openssl instead of wget and sha1sum if needed (e.g. on
> mac), as suggested by Ryan Schmidt
>
> Use -nd option with wget, as suggested by Hin-Tak Leung
>
> As always, winetricks is available at
>   http://kegel.com/wine/winetricks
Hi Dan,
  MDAC 2.7 needs to run under w2k or less or nothing will be installed.

Best Regards
 Alistair Leslie-Hughes 




From austinenglish at gmail.com  Wed Apr  9 20:04:42 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 9 Apr 2008 20:04:42 -0500
Subject: %ALLUSERSPROFILE%
Message-ID: <b6bb06270804091804v362a2db6pdc8a1ad9d0886029@mail.gmail.com>

Wanted to get clarification before going through the trouble of
writing this patch.

Where would you prefer this variable Alexandre? I've seen two responses:

http://www.winehq.org/pipermail/wine-devel/2007-May/056555.html

http://www.winehq.org/pipermail/wine-devel/2005-March/035004.html

Trying to fix 7292 as well as a few others with this, but didn't want
to waste time on the wrong approach.

- Austin


From thestig at google.com  Wed Apr  9 20:15:14 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 9 Apr 2008 18:15:14 -0700
Subject: %ALLUSERSPROFILE%
In-Reply-To: <b6bb06270804091804v362a2db6pdc8a1ad9d0886029@mail.gmail.com>
References: <b6bb06270804091804v362a2db6pdc8a1ad9d0886029@mail.gmail.com>
Message-ID: <558b2f5c0804091815m193b6877pc385d843dbeabedf@mail.gmail.com>

On Wed, Apr 9, 2008 at 6:04 PM, Austin English <austinenglish at gmail.com> wrote:
> Wanted to get clarification before going through the trouble of
>  writing this patch.
>
>  Where would you prefer this variable Alexandre? I've seen two responses:
>
>  http://www.winehq.org/pipermail/wine-devel/2007-May/056555.html
>
>  http://www.winehq.org/pipermail/wine-devel/2005-March/035004.html
>
>  Trying to fix 7292 as well as a few others with this, but didn't want
>  to waste time on the wrong approach.
>
>  - Austin

From: http://bugs.winehq.org/show_bug.cgi?id=11058#c11

"It probably needs to be in shell32 since there is apparently no
exported dirid for it. The important thing is that it must be
localizable, that's why it can't be hardcoded to "All Users" in
wine.inf. Currently it's not handled quite right in shell32 either, so
that would probably have to be fixed first.


From thestig at google.com  Wed Apr  9 22:50:23 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 9 Apr 2008 20:50:23 -0700
Subject: [PATCH] user32: on VK_RETURN, send WM_COMMAND to ancestor,
	not parent.
In-Reply-To: <00b701c89a0a$cf37a4e0$a600fea9@DMITRY>
References: <558b2f5c0804040020w77698ed0v324e7dbae792098b@mail.gmail.com>
	<00a901c89657$3abcc4f0$a600fea9@DMITRY>
	<558b2f5c0804040747s3eb841cfma07c0b6ca236e8c1@mail.gmail.com>
	<018501c8966e$f65e4000$a600fea9@DMITRY>
	<558b2f5c0804041111v2daf31e4sbbf874e4424c1be4@mail.gmail.com>
	<558b2f5c0804042155h783268f0m2419aa2f65cf2a19@mail.gmail.com>
	<558b2f5c0804082301j31820986v72b2cd1baf6a2867@mail.gmail.com>
	<00b701c89a0a$cf37a4e0$a600fea9@DMITRY>
Message-ID: <558b2f5c0804092050h705eafd8g1880cc8c6796e62c@mail.gmail.com>

On Tue, Apr 8, 2008 at 11:27 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> "Lei Zhang" <thestig at google.com> wrote:
>
>
> > I thought maybe the DS_CONTROL style caused the message to get
> > propagated up, like in DIALOG_FindMsgDestination(). So I did more
> > tests.
> >
> > I removed the DS_CONTROL style, but that didn't change the result of
> > the test. I also tried something more elaborate, where we have a
> > series of dialog windows, each of which contains another dialog
> > window... until the last one which contains the edit control. When I
> > send the edit control the VK_RETURN, the top most dialog window gets
> > the WM_COMMAND with wparam=IDOK. None of the dialog boxes between the
> > edit control and its ancestor gets the WM_COMMAND msg.
> >
>
>  I'd like to see a fully fledged message test for this, with all 'parent'
>  messages logged, and full window tree parent->child1->child2 checked.
>
>  --
>  Dmitry.
>

Nevermind, this patch is wrong. I already sent a patch to unbreak all
the dialog problems I caused.


From dmitry at codeweavers.com  Wed Apr  9 23:02:59 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 10 Apr 2008 13:02:59 +0900
Subject: kernel32: Fix for WritePrivateProfileString Sharing Problem
	[1/2](ATTEMPT 2)
References: <4c1ac96d0804092040m7e75f77ayce1a1274ddc9f404@mail.gmail.com>
Message-ID: <017b01c89abf$c56f35d0$a600fea9@DMITRY>

"Erich Hoover" <ehoover at mines.edu> wrote:

> +    oldError = GetLastError();
> +    /* Read and Write sharing are necessary if a flush is performed on an open file */
> +    hFile = CreateFileW(CurProfile->filename, GENERIC_WRITE, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, CREATE_ALWAYS, 
> FILE_ATTRIBUTE_NORMAL, NULL);
>      if (hFile == INVALID_HANDLE_VALUE)
>      {
>          WARN("could not save profile file %s (error was %d)\n", debugstr_w(CurProfile->filename), GetLastError());
>          return FALSE;
>      }
> +    /* The operation has succeed, do not over-write the error code */
> +    SetLastError(oldError);

It's been said many times that if you need to save/restore last error value
you are doing something wrong.

> +    /* Get* routines set S_OK on success, Write* routines return last error */
> +    SetLastError(S_OK);

There is no point in setting or checking last error value on success in vast
majority of cases, do you have an app that depends on this? Besides, S_OK is
an OLE error code and can not be used in kernel.

-- 
Dmitry. 



From jwhite at codeweavers.com  Wed Apr  9 23:04:06 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Wed, 09 Apr 2008 23:04:06 -0500
Subject: Reference information on CreateScalableFontResource
Message-ID: <47FD91B6.3010902@codeweavers.com>

I'm doing a brain dump for posterity on this task; you can tune out
of this email; it's mostly meant for Google archiving purposes.

I've spent far more time than I should on this implementation;
I originally did a quick + dirty version that was not binary
compatible with Windows .fot files.  Worked like a charm; I could
run Civ III (yay!).

But Alexandre said, gee, it should be easy to make it create a binary
compatible .fot file, take an afternoon and do that, why don't you, Jer?
Several weeks and a lot of swearing later, I now know far more about the
format of .fot files and fontdir resource structures than I care to.

I'm attaching a program that was useful to me; it dumped many chunks
of info about a .ttf file from FreeType.  Comparing that to a .fot file
generated on Windows was helpful.  I'm also attaching a hex dump of a .fot
file with my annotation on the basic structure.

The hard parts were that the .fot format seems to be an NE image, but
it seems to have subtle bugs in it and that the FONTDIR resource structure
is not well documented.  I've mostly sussed out how to use Freetype
to replicate most of the members; there are still a few I don't have
quite right.  (And I probably get this all wrong in non US or double
byte locales.  :-/)

The previous patches contain essentially all of my hard won knowledge
of the FONTDIR structure.

Cheers,

Jeremy
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dumpttf.c
Type: text/x-csrc
Size: 6680 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080409/8bc8eeaa/attachment.c 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: lucon.hexdump
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080409/8bc8eeaa/attachment.txt 

From dmitry at codeweavers.com  Wed Apr  9 23:24:34 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 10 Apr 2008 13:24:34 +0900
Subject: Reference information on CreateScalableFontResource
References: <47FD91B6.3010902@codeweavers.com>
Message-ID: <019e01c89ac2$c98971a0$a600fea9@DMITRY>

"Jeremy White" <jwhite at codeweavers.com> wrote:

> The hard parts were that the .fot format seems to be an NE image, but
> it seems to have subtle bugs in it and that the FONTDIR resource structure
> is not well documented.  I've mostly sussed out how to use Freetype
> to replicate most of the members; there are still a few I don't have
> quite right.  (And I probably get this all wrong in non US or double
> byte locales.  :-/)
> 
> The previous patches contain essentially all of my hard won knowledge
> of the FONTDIR structure.

FONTDIR and all related font structures are well described in Windows 3.1
DDK I used to have (and use) 15 years ago. I put some knowledge about it
when I was fixing after Huw tools/fnt2fon.c, that's a good piece of knowledge
about Windows .fon files.

-- 
Dmitry.


From ehoover at mines.edu  Wed Apr  9 23:25:58 2008
From: ehoover at mines.edu (Erich Hoover)
Date: Wed, 9 Apr 2008 22:25:58 -0600
Subject: kernel32: Fix for WritePrivateProfileString Sharing Problem
	[1/2](ATTEMPT 2)
In-Reply-To: <017b01c89abf$c56f35d0$a600fea9@DMITRY>
References: <4c1ac96d0804092040m7e75f77ayce1a1274ddc9f404@mail.gmail.com>
	<017b01c89abf$c56f35d0$a600fea9@DMITRY>
Message-ID: <4c1ac96d0804092125n5a73dd43v4a37e3297f451fea@mail.gmail.com>

On Wed, Apr 9, 2008 at 10:02 PM, Dmitry Timoshkov <dmitry at codeweavers.com>
wrote:

> "Erich Hoover" <ehoover at mines.edu> wrote:
>
>  +    oldError = GetLastError();
> > +    /* Read and Write sharing are necessary if a flush is performed on
> > an open file */
> > +    hFile = CreateFileW(CurProfile->filename, GENERIC_WRITE,
> > FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, CREATE_ALWAYS,
> > FILE_ATTRIBUTE_NORMAL, NULL);
> >     if (hFile == INVALID_HANDLE_VALUE)
> >     {
> >         WARN("could not save profile file %s (error was %d)\n",
> > debugstr_w(CurProfile->filename), GetLastError());
> >         return FALSE;
> >     }
> > +    /* The operation has succeed, do not over-write the error code */
> > +    SetLastError(oldError);
> >
>
> It's been said many times that if you need to save/restore last error
> value
> you are doing something wrong.


Well, I could call NtCreateFile directly so that the error code never gets
set in the first place...


>
>  +    /* Get* routines set S_OK on success, Write* routines return last
> > error */
> > +    SetLastError(S_OK);
> >
>
> There is no point in setting or checking last error value on success in
> vast
> majority of cases, do you have an app that depends on this? Besides, S_OK
> is
> an OLE error code and can not be used in kernel.
>

This was done to satisfy a problem pointed out in the previous attempt, that
patch broke a test in test_profile_sections where it checks that
GetPrivateProfileSectionA()'s GetLastError() is S_OK.  I figured that the
code should be consistent with the (existing) test, if you think it's more
appropriate then both could be changed to ERROR_SUCCESS.


> --
> Dmitry.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080409/57163703/attachment.htm 

From Stefan.Leichter at camline.com  Thu Apr 10 00:54:55 2008
From: Stefan.Leichter at camline.com (Stefan Leichter)
Date: Thu, 10 Apr 2008 07:54:55 +0200
Subject: make install broken
Message-ID: <200804100754.55966.Stefan.Leichter@camline.com>

Hello,

installing wine does not longer work for me. It fails with:

make[2]: Entering directory `/usr/src/wine/wine-build/programs/xcopy'
/usr/bin/install -c   xcopy.exe.so /usr/local/lib/wine/xcopy.exe.so
make[2]: Leaving directory `/usr/src/wine/wine-build/programs/xcopy'
make[1]: *** Keine Regel vorhanden, um das Target ?winelauncher?,
  ben?tigt von ?install?, zu erstellen.  Schluss.
make[1]: Leaving directory `/usr/src/wine/wine-build/programs'
make: *** [programs/__install__] Fehler 2

The difference from my build system to the most others is, that i do out of 
tree builds.

Bye Stefan


From kondratyuk at etersoft.ru  Thu Apr 10 01:02:31 2008
From: kondratyuk at etersoft.ru (Konstantin Kondratyuk)
Date: Thu, 10 Apr 2008 10:02:31 +0400
Subject: [2/2] winspool.drv: GetDefaultPrinterW reads the value from data
	in registry
In-Reply-To: <1207764825.15786.13.camel@p4>
References: <200804081539.16315.kondratyuk@etersoft.ru>
	<1207764825.15786.13.camel@p4>
Message-ID: <200804101002.31921.kondratyuk@etersoft.ru>

On Wednesday 09 April 2008 22:13:44 Detlef Riekenberg wrote:
> win3.x and win9.x use only "win.ini".
> We need to fix bug #4096, before we can switch to the Registry.

Thanks for advice! I will try to fix it.

-- 
Best regards,
Konstantin Kondratyuk.


From thestig at google.com  Thu Apr 10 01:25:45 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 9 Apr 2008 23:25:45 -0700
Subject: make install broken
In-Reply-To: <200804100754.55966.Stefan.Leichter@camline.com>
References: <200804100754.55966.Stefan.Leichter@camline.com>
Message-ID: <558b2f5c0804092325v64970393y31ea59516a8c5112@mail.gmail.com>

On Wed, Apr 9, 2008 at 10:54 PM, Stefan Leichter
<Stefan.Leichter at camline.com> wrote:
> Hello,
>
>  installing wine does not longer work for me. It fails with:
>
>  make[2]: Entering directory `/usr/src/wine/wine-build/programs/xcopy'
>  /usr/bin/install -c   xcopy.exe.so /usr/local/lib/wine/xcopy.exe.so
>  make[2]: Leaving directory `/usr/src/wine/wine-build/programs/xcopy'
>  make[1]: *** Keine Regel vorhanden, um das Target ?winelauncher?,
>   ben?tigt von ?install?, zu erstellen.  Schluss.
>  make[1]: Leaving directory `/usr/src/wine/wine-build/programs'
>  make: *** [programs/__install__] Fehler 2
>
>  The difference from my build system to the most others is, that i do out of
>  tree builds.
>
>  Bye Stefan
>
>
>

Ditto, in English:

/usr/bin/ginstall -c   xcopy.exe.so /tmp/winefoo/lib/wine/xcopy.exe.so
make[2]: Leaving directory `/home/leiz/wine-git/programs/xcopy'
make[1]: *** No rule to make target `winelauncher', needed by `install'.  Stop.
make[1]: Leaving directory `/home/leiz/wine-git/programs'
make: *** [programs/__install__] Error 2


From julliard at winehq.org  Thu Apr 10 03:36:40 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 10 Apr 2008 10:36:40 +0200
Subject: [PATCH 14/22] gdiplus: add a stub for
	GdipSetImageAttributesRemapTable.
In-Reply-To: <558b2f5c0804091409w622674e3v7578e76df2e027ee@mail.gmail.com>
	(Lei Zhang's message of "Wed, 9 Apr 2008 14:09:21 -0700")
References: <558b2f5c0804091409w622674e3v7578e76df2e027ee@mail.gmail.com>
Message-ID: <87y77mhzs7.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> @@ -62,6 +64,13 @@ typedef ImageAbort GetThumbnailImageAbort;
>  
>  #ifdef __cplusplus
>  
> +/* FIXME: missing the methods. */
> +class Color
> +{
> +public:
> +    ARGB color;
> +};
> +

I think this belong in gdipluscolor.h.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Apr 10 04:15:56 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 10 Apr 2008 11:15:56 +0200
Subject: msvcrtd: add DllMain
In-Reply-To: <461528.38620.qm@web23212.mail.ird.yahoo.com> (Louis. Lenders's
	message of "Thu, 10 Apr 2008 07:51:09 +0000 (GMT)")
References: <461528.38620.qm@web23212.mail.ird.yahoo.com>
Message-ID: <87tziahxyr.fsf@wine.dyndns.org>

"Louis. Lenders" <xerox_xerox2000 at yahoo.co.uk> writes:

> Hi, this is for  bug http://bugs.winehq.org/show_bug.cgi?id=5133
>
> It looks like several apps (like Rubies, and Resolume and i guess
> several others) are shipped with a copy of this dll (along with
> msvcr71 and others). So i think it's ok to use this native dll then,
> and that is what this patch does. In this way this patch fixes bug
> #5133

It doesn't fix anything, it just hides the bug.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Thu Apr 10 06:08:48 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 10 Apr 2008 12:08:48 +0100
Subject: msdmo: Array parameter is passed to function as pointer so loses
	size	information
In-Reply-To: <ftisct$ha8$1@ger.gmane.org>
References: <200804072239.34412.andrew.talbot@talbotville.com>	<47FCC726.60406@codeweavers.com>
	<ftisct$ha8$1@ger.gmane.org>
Message-ID: <47FDF540.5000705@codeweavers.com>

Andrew Talbot wrote:
> Robert Shearman wrote:
>   
>> This is incorrect. count is the size in bytes of the buffer passed in
>> (szName) and so should be sizeof(szName) not
>> sizeof(szName)/sizeof(szName[0]) (i.e. 80).
>>
>>     
>
> Are you sure? MSDN says "szName: Array of 80 Unicode characters that
> receives the name of the DMO".
>   

It doesn't matter what MSDN says about szName, RegQueryValueExW still 
takes the size in bytes, not characters. I.e. count should be set to 
NAME_SIZE * sizeof(WCHAR), not NAME_SIZE.

> But, in any case, when arrays
> are passed as arguments to functions they are converted to pointers, so
> sizeof(szName) would represent the size of a pointer to the array, not the
> size of the array itself.

I didn't realise this before but the attached test program prints:
$ ./atest
sizeof(array) = 4
So you are right. Still, my point stands that the code is still passing 
in a smaller size than the size of the buffer and so is not correct.

-- 
Rob Shearman

-------------- next part --------------
A non-text attachment was scrubbed...
Name: atest.c
Type: text/x-csrc
Size: 166 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080410/eaf8d2ee/attachment.c 

From xerox_xerox2000 at yahoo.co.uk  Thu Apr 10 05:23:23 2008
From: xerox_xerox2000 at yahoo.co.uk (Louis. Lenders)
Date: Thu, 10 Apr 2008 10:23:23 +0000 (GMT)
Subject: msvcrtd: add DllMain
Message-ID: <587403.98763.qm@web23214.mail.ird.yahoo.com>



----- Original Message ----
From: Alexandre Julliard <julliard at winehq.org>
To: Louis. Lenders <xerox_xerox2000 at yahoo.co.uk>
Cc: wine-devel at winehq.org
Sent: Thursday, 10 April, 2008 5:15:56 AM
Subject: Re: msvcrtd: add DllMain

"Louis. Lenders" <xerox_xerox2000 at yahoo.co.uk> writes:

> Hi, this is for  bug http://bugs.winehq.org/show_bug.cgi?id=5133
>
> It looks like several apps (like Rubies, and Resolume and i guess
> several others) are shipped with a copy of this dll (along with
> msvcr71 and others). So i think it's ok to use this native dll then,
> and that is what this patch does. In this way this patch fixes bug
> #5133

It doesn't fix anything, it just hides the bug.

-- 
Alexandre Julliard
julliard at winehq.org


Maybe "fix" wasn't the right word; on the other hand, if you call it hiding a bug, then we're hiding tons of bugs, like in gdiplus, that also loads the native gdiplus, if that is shipped with the application. Anyway, if you don't like it that  way, just  leave it 




      ___________________________________________________________ 
Yahoo! For Good helps you make a difference  

http://uk.promotions.yahoo.com/forgood/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080410/67094cf2/attachment.htm 

From scott at open-vote.org  Thu Apr 10 06:00:47 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Thu, 10 Apr 2008 04:00:47 -0700
Subject: Including Mono within a Wine package - should Wine expect this?
Message-ID: <47FDF35F.9030203@open-vote.org>

I'm trying to decide if it's a good idea to create wine-mono and
wine-gecko packages depended on by the wine package.

wine-gecko seems easy enough: we just install a local copy of the gecko
engine, and then Wine grabs it as soon as it's needed.  I'm even
thinking of modifying wineprefixcreate to essentially do winetricks
gecko at the end, unless someone can point out how that would have bad
consequences.

wine-mono would function similarly.  Is there any reason not to install
it around wineprefixcreate time?  I'm assuming Microsoft .net or a later
mono can be installed to replace mono afterwards (if not this is
probably a bug). Even so, does this seem like a good idea?

Have any other packagers thought of something like this?  The biggest
issue at this point seems to be dealing with the fact that gecko can
only be built on Windows.  I'm not sure how to build the Windows version
of Mono either.

Thanks,
Scott Ritchie


From julliard at winehq.org  Thu Apr 10 08:06:27 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 10 Apr 2008 15:06:27 +0200
Subject: conflict between Wine and Solaris list.h fixed by AlekZ's
	workaround (Bug 11463)
In-Reply-To: <47FE0528.5030105@sun.com> (Petr Sumbera's message of "Thu, 10
	Apr 2008 14:16:40 +0200")
References: <47FE0528.5030105@sun.com>
Message-ID: <87lk3lj1v0.fsf@wine.dyndns.org>

Petr Sumbera <Petr.Sumbera at Sun.COM> writes:

> diff --git a/server/fd.c b/server/fd.c
> index 41e404c..0010bab 100644
> --- a/server/fd.c
> +++ b/server/fd.c
> @@ -71,6 +71,18 @@
>  #include <sys/types.h>
>  #include <unistd.h>
>  
> +/*
> + struct list is defined at sys/list_impl.h on solaris
> + this patches work around it.
> +*/
> +#define list WINELIST
> +#define list_remove WINELIST_REMOVE
> +#define list_next WINELIST_NEXT
> +#define list_prev WINELIST_PREV
> +#define list_head WINELIST_HEAD
> +#define list_tail WINELIST_TAIL
> +#define list_move_tail WINELIST_MOVE_TAIL
> +

You should do this the other way around, by defining list to
solaris_list before including the offending header, and undefining
it afterwards. This way the Wine code itself isn't impacted by
redefinitions.

-- 
Alexandre Julliard
julliard at winehq.org


From juan.lang at gmail.com  Thu Apr 10 08:17:55 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 10 Apr 2008 06:17:55 -0700
Subject: shell32: Implement ParseDisplayName for EntireNetwork in the
	Network Places shell folder.
Message-ID: <3a768c550804100617i1dbf9c4dsd7910c817b01ca34@mail.gmail.com>

Hi Rob,

+        strcpy(pData->u.network.szNames, "Entire Network");

Is this not locale-dependent?
--Juan


From rob at codeweavers.com  Thu Apr 10 09:24:09 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 10 Apr 2008 15:24:09 +0100
Subject: shell32: Implement ParseDisplayName for EntireNetwork in the
	Network Places shell folder.
In-Reply-To: <3a768c550804100617i1dbf9c4dsd7910c817b01ca34@mail.gmail.com>
References: <3a768c550804100617i1dbf9c4dsd7910c817b01ca34@mail.gmail.com>
Message-ID: <47FE2309.7090602@codeweavers.com>

Juan Lang wrote:
> Hi Rob,
>
> +        strcpy(pData->u.network.szNames, "Entire Network");
>
> Is this not locale-dependent?

I don't believe so. ParseDisplayName (which isn't implemented yet) will 
do the mapping between the PIDL and the name the user sees, which 
doesn't have to depend on pData->u.network.szNames.

-- 
Rob Shearman



From austinenglish at gmail.com  Thu Apr 10 08:31:51 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 10 Apr 2008 08:31:51 -0500
Subject: make install broken
In-Reply-To: <558b2f5c0804092325v64970393y31ea59516a8c5112@mail.gmail.com>
References: <200804100754.55966.Stefan.Leichter@camline.com>
	<558b2f5c0804092325v64970393y31ea59516a8c5112@mail.gmail.com>
Message-ID: <b6bb06270804100631i45100eaeva2946060f8642372@mail.gmail.com>

On Thu, Apr 10, 2008 at 1:25 AM, Lei Zhang <thestig at google.com> wrote:
>
> On Wed, Apr 9, 2008 at 10:54 PM, Stefan Leichter
>  <Stefan.Leichter at camline.com> wrote:
>  > Hello,
>  >
>  >  installing wine does not longer work for me. It fails with:
>  >
>  >  make[2]: Entering directory `/usr/src/wine/wine-build/programs/xcopy'
>  >  /usr/bin/install -c   xcopy.exe.so /usr/local/lib/wine/xcopy.exe.so
>  >  make[2]: Leaving directory `/usr/src/wine/wine-build/programs/xcopy'
>  >  make[1]: *** Keine Regel vorhanden, um das Target ?winelauncher?,
>  >   ben?tigt von ?install?, zu erstellen.  Schluss.
>  >  make[1]: Leaving directory `/usr/src/wine/wine-build/programs'
>  >  make: *** [programs/__install__] Fehler 2
>  >
>  >  The difference from my build system to the most others is, that i do out of
>  >  tree builds.
>  >
>  >  Bye Stefan
>  >
>  >
>  >
>
>  Ditto, in English:
>
>  /usr/bin/ginstall -c   xcopy.exe.so /tmp/winefoo/lib/wine/xcopy.exe.so
>  make[2]: Leaving directory `/home/leiz/wine-git/programs/xcopy'
>  make[1]: *** No rule to make target `winelauncher', needed by `install'.  Stop.
>  make[1]: Leaving directory `/home/leiz/wine-git/programs'
>  make: *** [programs/__install__] Error 2
>
>
>

http://source.winehq.org/git/wine.git/?a=commitdiff;h=d270a9603261d7d3693b375e3e6f7809501d821a

Alexandre removed the winelauncher script, which is probably the
source of your problem. Might have to manually remove it from
/usr/bin?

From juan.lang at gmail.com  Thu Apr 10 08:33:20 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 10 Apr 2008 06:33:20 -0700
Subject: shell32: Implement ParseDisplayName for EntireNetwork in the
	Network Places shell folder.
In-Reply-To: <47FE2309.7090602@codeweavers.com>
References: <3a768c550804100617i1dbf9c4dsd7910c817b01ca34@mail.gmail.com>
	<47FE2309.7090602@codeweavers.com>
Message-ID: <3a768c550804100633vc442cb7j3d35056cb79c89c1@mail.gmail.com>

> I don't believe so. ParseDisplayName (which isn't implemented yet) will do
> the mapping between the PIDL and the name the user sees, which doesn't have
> to depend on pData->u.network.szNames.

Right.  I was expecting that the Network Places shell folder would
have to be hooked up to MPR, in which case pData->u.network.szNames
would most logically match what it uses.  But since it isn't yet, I'll
defer comment.
--Juan


From dank at kegel.com  Thu Apr 10 08:45:32 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 10 Apr 2008 06:45:32 -0700
Subject: Including Mono within a Wine package - should Wine expect this?
Message-ID: <a71bd89a0804100645y2b7f9c94n719ab5f19374db04@mail.gmail.com>

A wine-gecko package would be very useful.

Wine-mono on the other hand is probably premature.
How many apps are helped at the moment by
  winetricks mono12
?  I don't think it's a large number.

The wine-gecko package should just be a repackaging
of the same blob that is normally downloaded,
at least until we figure out how to do a proper cross-build.


From infyquest at gmail.com  Thu Apr 10 09:30:00 2008
From: infyquest at gmail.com (Vijay Kiran Kamuju)
Date: Thu, 10 Apr 2008 10:30:00 -0400
Subject: [PATCH] winecfg => control panel applets patch
Message-ID: <36bf289b0804100730p3642f426vdb7439ea09b238a2@mail.gmail.com>

Hi,

This is regarding the control panel applet patch you have submitted to
wine-patches.
I would like to have the applets should be part of wine's control program.
They would be better be as files in the /programs/control/
And you should extend the existing control.exe  and winecfg in wine to
open these applets.

Please correct me if I am wrong.
Just my 2 cents.

----
VJ


From wine-devel at kievinfo.com  Thu Apr 10 09:42:41 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Thu, 10 Apr 2008 08:42:41 -0600
Subject: [PATCH] winecfg => control panel applets patch
In-Reply-To: <200804101047.28206.pure_evil@mail.bg>
References: <200804101047.28206.pure_evil@mail.bg>
Message-ID: <47FE2761.3050502@kievinfo.com>

pure_evil at mail.bg wrote:
> Allows access to different winecfg tabs via control-panel applets (without 
> showing all of the cfg's tabs when accessed thusly)
>    
> +LONG APIENTRY EXECUTE_APPLET(HWND hwndCpl, UINT message, LPARAM lParam1, 
> LPARAM lParam2)
> +{
> +
> + int NumOfApplet = (int)lParam1;
> +
> + switch (NumOfApplet)
> + {
> +
> +  case 0:

You patch is wrapped. Also please for new files follow standard Wine codding 
style - 4 spaces indentation, no tabs.

> +    /*It would get messier with an or statement everywhere, so...*/
> +    BOOL Do_App = FALSE;
> +    BOOL Do_Lib = FALSE;
> +    BOOL Do_Graph = FALSE;
> +    BOOL Do_Desktop = FALSE;
> +    BOOL Do_Drives = FALSE;
> +    BOOL Do_Audio = FALSE;

> +    if (display_what_tabs == 2) { Do_Lib = TRUE; }
> +    if (display_what_tabs == 3) { Do_Graph = TRUE; }
> +    if (display_what_tabs == 4) { Do_Desktop = TRUE; }
> +    if (display_what_tabs == 5) { Do_Drives = TRUE; }
> +    if (display_what_tabs == 6) { Do_Audio = TRUE; }

> +   if ( lstrcmpi(CommandLine,"applications") == 0 ) display_what_tabs = 1;
> +   if ( lstrcmpi(CommandLine,"libraries") == 0 ) display_what_tabs = 2;
> +   if ( lstrcmpi(CommandLine,"graphics") == 0 ) display_what_tabs = 3;
> +   if ( lstrcmpi(CommandLine,"desktop") == 0 ) display_what_tabs = 4;
> +   if ( lstrcmpi(CommandLine,"drives") == 0 ) display_what_tabs = 5;
> +   if ( lstrcmpi(CommandLine,"audio") == 0 ) display_what_tabs = 6;


This is ugly and redundant. You should make it a bit-mask instead. However 
with all this you removing really big functionality from the winecfg - 
ability to set this on per application basis.

Vitaliy.


From jwhite at codeweavers.com  Thu Apr 10 10:54:10 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Thu, 10 Apr 2008 10:54:10 -0500
Subject: Reference information on CreateScalableFontResource
In-Reply-To: <019e01c89ac2$c98971a0$a600fea9@DMITRY>
References: <47FD91B6.3010902@codeweavers.com>
	<019e01c89ac2$c98971a0$a600fea9@DMITRY>
Message-ID: <47FE3822.6040806@codeweavers.com>

> FONTDIR and all related font structures are well described in Windows 3.1
> DDK I used to have (and use) 15 years ago. I put some knowledge about it
> when I was fixing after Huw tools/fnt2fon.c, that's a good piece of 
> knowledge
> about Windows .fon files.
> 

Where in the DDK?  I can't find any place that clearly defines the
FONTDIR structure in the 3.11 DDK I am looking at.

For example, by inspection, I see that the value placed by Windows
mostly lines up with the structure we have defined in
wine/wingdi16.h.   (And you can find that definition of FONTDIR
if you google around on the web).

But in the DDK, I find only FONTINFO and other structures; not FONTDIR.

What I really wanted to know was how the tail end of that structure
was really mapped out.

That is, if I compare it to the FONTDIR16 structure we have, it
seems as though the data written by windows matches pretty well
up until dfDefaultChar.  At that point, the order is:

   BYTE   always 0x1    (might be dfDefaultChar, but not clear)
   BYTE   always 0x2    (might be dfBreakChar, but not clear)
   WORD   always 0x0    (might be WidthBytes, but not clear)
   DWORD  always 0x0    (might be dfDevice, but not clear)
   DWORD  always 0x76, which is the location
          in the struct of the Family name, suggests dfFace is
          a reasonable name for this field
   BYTE   mystery1      (mostly 0x9, sometimes 0xa, 0xb, or 0x6)
   BYTE   mystery2      always 0
   BYTE   mystery3      always 0
   BYTE   mystery4      is sometimes 0xf0, appears to be linked
                        to cases where the firstchar and last char
                        both are in the 0xf0XX range
                        [named dfReserved in the FONTDIR16 struct]
   BYTE   mystery5      always 0xff
   ZSTRING family name
   ZSTRING family name  (again)
   ZSTRING style name
       I'm pretty sure the latter 3 are in a constrained buffer
       of about 40 bytes; haven't nailed that down just yet.


And the sad truth is that what I mostly need is the ability to
turn information I can get from Freetype into matching FONTDIR
information, and that's just not likely to be documented anywhere.

Cheers,

Jeremy


From Andrew.Talbot at talbotville.com  Thu Apr 10 11:57:42 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Thu, 10 Apr 2008 17:57:42 +0100
Subject: msdmo: Array parameter is passed to function as pointer so loses
	size	information
References: <200804072239.34412.andrew.talbot@talbotville.com>	<47FCC726.60406@codeweavers.com>
	<ftisct$ha8$1@ger.gmane.org> <47FDF540.5000705@codeweavers.com>
Message-ID: <ftlgu6$k2m$1@ger.gmane.org>

Robert Shearman wrote:

> It doesn't matter what MSDN says about szName, RegQueryValueExW still
> takes the size in bytes, not characters. I.e. count should be set to
> NAME_SIZE * sizeof(WCHAR), not NAME_SIZE.
> 

Hi Robert,

Yes, indeed. I believe I may have had an editing accident with that one.

> [...] [M]y point stands that the code is still passing
> in a smaller size than the size of the buffer and so is not correct.
> 

You were indeed right on that and I was wrong. I only looked at what was
coming in and not at what was being done to it subsequently. Thanks for the
feedback.

-- 
Andy.




From pure_evil at mail.bg  Thu Apr 10 13:12:05 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Thu, 10 Apr 2008 21:12:05 +0300
Subject: [PATCH] winecfg => control panel applets patch
In-Reply-To: <36bf289b0804100730p3642f426vdb7439ea09b238a2@mail.gmail.com>
References: <36bf289b0804100730p3642f426vdb7439ea09b238a2@mail.gmail.com>
Message-ID: <200804102112.05883.pure_evil@mail.bg>

> I would like to have the applets should be part of wine's control program.
Hmmm, I followed usual windows proceedings, e.g. the applet is not actually a 
part of the control panel program itself, it's a .CPL.

> They would be better be as files in the /programs/control/
Well, cpls are basically DLLs that export a function -> CPlApplet -> so (based 
on Dan Kegel's advice) i put them in dlls. 
They're not *programs* strictly speaking.

Hmm, I could use more feedback on that one.
> And you should extend the existing control.exe  and winecfg in wine to
> open these applets.
control.exe opens cpls just fine; I only extended winecfg to make it suitable 
for being launched from within a cpl to perform only the particular task.




From pure_evil at mail.bg  Thu Apr 10 13:33:48 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Thu, 10 Apr 2008 21:33:48 +0300
Subject: [PATCH] winecfg => control panel applets patch
Message-ID: <200804102133.48658.pure_evil@mail.bg>

> You patch is wrapped. Also please for new files follow standard Wine codding 
> style - 4 spaces indentation, no tabs.
Sorry about that, I'll fix it in the morning. (I should've attached it as a 
text file :( )

> This is ugly and redundant.
yes, but at least it's easily readable - same local variable name within one 
function serves to store the temporal result, and an *input* variable by the 
same name is used in the other function (to catch that same result). 

> However   with all this you removing really big functionality from the 
winecfg - ability to set this on per application basis.

+    if (display_what_tabs == 1) 
+    { Do_App = TRUE;  /*well, application settings do require more tabs.*/
+      Do_Lib = TRUE;
+      NUM_PROPERTY_PAGES = 3;
+    }
^^This (a few lines below) took care of that.^^

This piece of code explains why I went for bools in the first place - for 
example, you draw the library tab A.) when you want to draw only them 
(general library settings), B.) when you want application-specific settings 
("winecfg applications") and C.) when you want the entire winecfg. That 
would've been a lot messier with a triple "or" rather than a simple 
IF (Do_Lib) { }.


From dank at kegel.com  Thu Apr 10 13:22:41 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 10 Apr 2008 11:22:41 -0700
Subject: Microsoft Tax Day Wine Tasting & Networking Event
Message-ID: <a71bd89a0804101122o71eee258va31554e7c2e07138@mail.gmail.com>

It's an April 15th event sponsored by Microsoft, but
it sure sounds like something we should be holding on our own terms :-)

http://www.microsoft.com/events/EventDetails.aspx?CMTYSvcSource=MSCOMMedia&Params=~CMTYDataSvcParams%5E~arg+Name%3D%22ID%22+Value%3D%221032374035%22%2F%5E~arg+Name%3D%22ProviderID%22+Value%3D%22A6B43178-497C-4225-BA42-DF595171F04C%22%2F%5E~arg+Name%3D%22lang%22+Value%3D%22en%22%2F%5E~arg+Name%3D%22cr%22+Value%3D%22US%22%2F%5E~sParams%5E~%2FsParams%5E~%2FCMTYDataSvcParams%5E


From dank at kegel.com  Thu Apr 10 13:42:16 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 10 Apr 2008 11:42:16 -0700
Subject: AVI file format documentation
Message-ID: <a71bd89a0804101142g699fdc9k7ebd4ce3f44e208a@mail.gmail.com>

Maarten stumbled across what he said was very useful
documentation about the AVI file format.  For future reference,
here it is:
http://sunsson.iptime.org/projects/juliet/wiki/MediaFileFormat


From dsh at linux.ucla.edu  Thu Apr 10 13:55:32 2008
From: dsh at linux.ucla.edu (Dan Hipschman)
Date: Thu, 10 Apr 2008 11:55:32 -0700
Subject: Microsoft Tax Day Wine Tasting & Networking Event
In-Reply-To: <a71bd89a0804101122o71eee258va31554e7c2e07138@mail.gmail.com>
References: <a71bd89a0804101122o71eee258va31554e7c2e07138@mail.gmail.com>
Message-ID: <20080410185531.GL11580@linux.ucla.edu>

On Thu, Apr 10, 2008 at 11:22:41AM -0700, Dan Kegel wrote:
> It's an April 15th event sponsored by Microsoft, but
> it sure sounds like something we should be holding on our own terms :-)
> 
>
http://www.microsoft.com/events/EventDetails.aspx?CMTYSvcSource=MSCOMMedia... (snip)

That's a long URL (and hard to capture in Mutt).  Here's a shorter one:
http://tinyurl.com/6cvlz8  :)


From jwhite at codeweavers.com  Thu Apr 10 14:05:10 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Thu, 10 Apr 2008 14:05:10 -0500
Subject: WineConf 2008
Message-ID: <47FE64E6.3050303@codeweavers.com>

Hi Folks,

I'd like to start the planning for WineConf 2008.

My sense is that 3 years in Europe and 1 year in the US
is a reasonable balance, so I feel it makes sense to
try to have it over here this year.

Further, I would like to host WineConf this year in St. Paul, Minnesota,
for a variety of reasons.  First, it's a lot easier for me to help
plan if it's here.  Second, it's nice for CodeWeavers; it means we
can have everyone, not just the developers, all together.  Having Mandi
able to physically intimidate people is very helpful for us, after all <grin>.

My thought was to do it in late September, early October, so
that the weather would not be so extreme.  I realize that veterans
of our last Minnesota meeting will be disappointed at the lack
of the Ice Palace, but we'll try to find a way to make it up to you.

Also, I know the travel costs will be hard for many people, given current
travel costs, so I'm hoping to contribute funds (and perhaps
do some fund raising) to help cover travel costs for Wine
contributors.

At any rate, that's my idea.  I'm willing to be swayed if people
object violently, or if a clear consensus for an alternate emerges.

Thoughts?  Comments?

Cheers,

Jeremy


From winehacker at gmail.com  Thu Apr 10 14:26:11 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 10 Apr 2008 15:26:11 -0400
Subject: WineConf 2008
In-Reply-To: <47FE64E6.3050303@codeweavers.com>
References: <47FE64E6.3050303@codeweavers.com>
Message-ID: <19e31a080804101226h6732d82cx29d029c8a24340a6@mail.gmail.com>

On Thu, Apr 10, 2008 at 3:05 PM, Jeremy White <jwhite at codeweavers.com> wrote:
>  At any rate, that's my idea.  I'm willing to be swayed if people
>  object violently, or if a clear consensus for an alternate emerges.
>
>  Thoughts?  Comments?

It may be nothing more than hot air from our European brethren but the
consensus I've felt is that most of the discussions I've had with some
members at the last few conferences is that they don't want to deal
with the hassle of US security and privacy issues. I don't really
blame them if this is true and they decide to boycott wineconf as a
form of economic protest.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From jwhite at winehq.org  Thu Apr 10 14:29:02 2008
From: jwhite at winehq.org (Jeremy White)
Date: Thu, 10 Apr 2008 14:29:02 -0500
Subject: Wine booth/BOF and Linuxworld San Francisco, Aug 2008?
In-Reply-To: <47D64A2C.7070807@open-vote.org>
References: <a71bd89a0803101914v628d0bc9l65880a6458b97633@mail.gmail.com>	<200803110838.07439.kai.blin@gmail.com>
	<47D64A2C.7070807@open-vote.org>
Message-ID: <47FE6A7E.7090808@winehq.org>

Hi folks,

I'm on the IDG mailing list, and just got a deadline notice,
and thought I'd relay it in case someone still wanted to apply
for a booth and hadn't done so yet:

----

The deadline for submitting for a .org Pavilion application is
Friday, April 11, 2008

Submit proposal(s) here:
http://emessaging.vertexcommunication.com/ct/3352956:1363855011:m:3:22215624:DEAF60A80A7E2685C96822942C620253

All accepted and rejected proposals will be notified in late
May.

----

Cheers,

Jeremy


From juan.lang at gmail.com  Thu Apr 10 14:42:51 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 10 Apr 2008 12:42:51 -0700
Subject: WineConf 2008
In-Reply-To: <47FE64E6.3050303@codeweavers.com>
References: <47FE64E6.3050303@codeweavers.com>
Message-ID: <3a768c550804101242u113fce7dg88c5cd789dfbb894@mail.gmail.com>

>  Thoughts?

+1 to a US conference.
--Juan


From tehblunderbuss at gmail.com  Thu Apr 10 14:50:01 2008
From: tehblunderbuss at gmail.com (TheBlunderbuss)
Date: Thu, 10 Apr 2008 14:50:01 -0500
Subject: WineConf 2008
In-Reply-To: <19e31a080804101226h6732d82cx29d029c8a24340a6@mail.gmail.com>
References: <47FE64E6.3050303@codeweavers.com>
	<19e31a080804101226h6732d82cx29d029c8a24340a6@mail.gmail.com>
Message-ID: <47FE6F69.4020709@gmail.com>

An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080410/790bb7a4/attachment.htm 

From wine-devel at kievinfo.com  Thu Apr 10 14:52:17 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Thu, 10 Apr 2008 13:52:17 -0600
Subject: Please add wine-0.9.59 to bugzilla
Message-ID: <47FE6FF1.30002@kievinfo.com>

Could someone add the newest Wine version to buzilla?

Vitaliy.


From austinenglish at gmail.com  Thu Apr 10 14:57:21 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 10 Apr 2008 14:57:21 -0500
Subject: cachedmetrics - still used?
Message-ID: <b6bb06270804101257j60cf6e40n3042b57532648a12@mail.gmail.com>

Looking at documentation/PACKAGING, it seems there's quite a bit of
outdated info (hasn't been updated in 2-3 years...). Anywho, I'm
preparing a few updates for it, but wanted to verify that
cachedmetrics is no longer used. There's a few references to it on
AppDB, but only one reference in the code, and a few on wine-devel
(all of which are pretty old). Is it safe to remove this info?

-Austin


From stefan at codeweavers.com  Thu Apr 10 18:06:54 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 11 Apr 2008 01:06:54 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
In-Reply-To: <e1d9e62c0804090533g5b505f43od13e67b41c322024@mail.gmail.com>
References: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
	<200804091416.44718.stefan@codeweavers.com>
	<e1d9e62c0804090533g5b505f43od13e67b41c322024@mail.gmail.com>
Message-ID: <200804110106.54219.stefan@codeweavers.com>

Hi,
I just tried 3DMark2001, and I can confirm the black textures in the high car 
test, so it is not your different card. I am pretty sure this used to work 
though...




From dank at kegel.com  Thu Apr 10 20:00:29 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 10 Apr 2008 18:00:29 -0700
Subject: New Valgrind errors in user32
Message-ID: <a71bd89a0804101800k6b1a306ay45b285875de07fd4@mail.gmail.com>

Hey Lei,
this morning's git brought one new valgrind error, and it happens to
be in a file you touched in the last day or so:
+ Conditional jump or move depends on uninitialised value(s)
+    at  EDIT_BuildLineDefs_ML (edit.c:1280)
+    by  EDIT_EM_ReplaceSel (edit.c:3260)
+    by  EDIT_WM_Char (edit.c:4035)
+    by  EditWndProc_common (edit.c:859)
+    by  EditWndProcA (edit.c:1103)
+    by  (within /home/dank/wine-git/dlls/user32/user32.dll.so)
+    by  call_window_proc (winproc.c:457)
+    by  WINPROC_call_window (winproc.c:2207)
+    by  call_window_proc (message.c:1616)
+    by  send_message (message.c:2438)
+    by  SendMessageA (message.c:2583)
+    by  test_enter (edit.c:1654)
+    by  func_edit (edit.c:1977)
+    by  run_test (test.h:406)
+    by  main (test.h:455)

Could you have a look?

See
http://kegel.com/wine/valgrind/logs-2008-04-10/vg-user32_edit-diff.txt
http://kegel.com/wine/valgrind/logs-2008-04-10/vg-user32_edit.txt

Thanks,
Dan


From kai.blin at gmail.com  Thu Apr 10 20:01:25 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Fri, 11 Apr 2008 03:01:25 +0200
Subject: WineConf 2008
In-Reply-To: <47FE64E6.3050303@codeweavers.com>
References: <47FE64E6.3050303@codeweavers.com>
Message-ID: <200804110301.37702.kai.blin@gmail.com>

On Thursday 10 April 2008 21:05:10 Jeremy White wrote:

> My sense is that 3 years in Europe and 1 year in the US
> is a reasonable balance, so I feel it makes sense to
> try to have it over here this year.

Fine with me. I'm hoping to fit it into my US trip schedule for this year.

>
> My thought was to do it in late September, early October, so
> that the weather would not be so extreme.

I'm probably going to travel to the US twice this year, once for the GSoC 
mentor summit and maybe to the CIFS workshop if we can talk JRA into 
organizing another one. If WineConf is close to one of those trips, I'll be 
glad to stop by in MN. I'm probably not going to fly to the US three times, 
as being a tall guy in economy class really sucks.

Unfortunately, I don't have exact dates for the two scheduled trips yet.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080411/ed52aae4/attachment.pgp 

From scott at open-vote.org  Thu Apr 10 21:40:30 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Thu, 10 Apr 2008 19:40:30 -0700
Subject: Including Mono within a Wine package - should Wine expect this?
In-Reply-To: <a71bd89a0804100645y2b7f9c94n719ab5f19374db04@mail.gmail.com>
References: <a71bd89a0804100645y2b7f9c94n719ab5f19374db04@mail.gmail.com>
Message-ID: <47FECF9E.1030309@open-vote.org>

Dan Kegel wrote:
> A wine-gecko package would be very useful.
> 
> Wine-mono on the other hand is probably premature.
> How many apps are helped at the moment by
>   winetricks mono12
> ?  I don't think it's a large number.

Honestly I don't know.  Is this due to inadequacies in the current mono,
or inadequacies in Wine?

Either way, Mono 2.0 will finally come out around the same time as Wine
1.0 (quarter 2 of 2008), and I suspect the number of applications Mono
helps will greatly improve by then.

> 
> The wine-gecko package should just be a repackaging
> of the same blob that is normally downloaded,
> at least until we figure out how to do a proper cross-build.
> 
> 

Agreed.  The one tricky thing here is making a proper "source" package.
 There is some precedent for source packages that don't actually build
on the architecture they're for.  The ia32-libs package, for instance,
contains both binary and source versions of the 32 bit libraries since
it's solely for 64 bit arches, however to build those binaries requires
use of a 32 bit system.

Similarly, we can ship a wine-gecko "source" package which includes
binary and source, with the readme detailing how to actually build the
binary from the source (ie, use Windows).  Meanwhile the source package
"builds" by just copying the binary into the right place (much like how
ia32-libs builds).

Thanks,
Scott Ritchie


From dank at kegel.com  Thu Apr 10 21:54:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 10 Apr 2008 19:54:30 -0700
Subject: Including Mono within a Wine package - should Wine expect this?
In-Reply-To: <47FECF9E.1030309@open-vote.org>
References: <a71bd89a0804100645y2b7f9c94n719ab5f19374db04@mail.gmail.com>
	<47FECF9E.1030309@open-vote.org>
Message-ID: <a71bd89a0804101954w31a24e2fn72c027796b771a6e@mail.gmail.com>

On Thu, Apr 10, 2008 at 7:40 PM, Scott Ritchie <scott at open-vote.org> wrote:
>  > Wine-mono on the other hand is probably premature.
>  > How many apps are helped at the moment by
>  >   winetricks mono12
>  > ?  I don't think it's a large number.
>
>  Honestly I don't know.  Is this due to inadequacies in the current mono,
>  or inadequacies in Wine?

Mono doesn't even try to handle mixed-mode assemblies (i.e. ones
that contain some native code).  And by gum, every .net app built
by Microsoft tools seems to include some native code for some odd
reason.  Go figure!

>  Either way, Mono 2.0 will finally come out around the same time as Wine
>  1.0 (quarter 2 of 2008), and I suspect the number of applications Mono
>  helps will greatly improve by then.

Maybe, but only apps that have been properly cleaned of native code.
- Dan


From ivg231 at gmail.com  Thu Apr 10 11:13:51 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Thu, 10 Apr 2008 12:13:51 -0400
Subject: tools: Add Spanish Translation to wine.desktop
In-Reply-To: <47FE618B.1070403@ilidium.com>
References: <47FE618B.1070403@ilidium.com>
Message-ID: <47FE3CBF.8020409@gmail.com>

 > Name=Wine Windows Emulator

I like the expanded version better:
    "Wine is not an emulator windows emulator".

Should help clear up any questions people might have :)





From wine-devel at kievinfo.com  Thu Apr 10 23:48:23 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Thu, 10 Apr 2008 22:48:23 -0600
Subject: Valgrind false positive or?
Message-ID: <47FEED97.1000205@kievinfo.com>

Trying to understand what is that valgrind doesn't like?

==22938== Invalid write of size 1
==22938==    at 0x4024D55: memcpy (mc_replace_strmem.c:402)
==22938==    by 0x7BC64405: setup_exception_record (signal_i386.c:795)
==22938==    by 0x7BC65793: segv_handler (signal_i386.c:1310)
==22938==    by 0x419160F: (within /lib/libpthread-2.6.1.so)
==22938==  Address 0x7f22c7de is not stack'd, malloc'd or (recently) free'd

http://source.winehq.org/source/dlls/ntdll/signal_i386.c#L756
http://source.winehq.org/source/dlls/ntdll/signal_i386.c#L1093
http://source.winehq.org/source/dlls/ntdll/signal_i386.c#L1310

Everything seems to be correct. Any ideas?

Vitaliy.


From dank at kegel.com  Fri Apr 11 00:04:38 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 10 Apr 2008 22:04:38 -0700
Subject: Valgrind false positive or?
Message-ID: <a71bd89a0804102204jca7410ftf32996c6123bdf5c@mail.gmail.com>

Vitaliy wrote:

>==22938== Invalid write of size 1
>==22938==    at 0x4024D55: memcpy (mc_replace_strmem.c:402)
>==22938==    by 0x7BC64405: setup_exception_record (signal_i386.c:795)
>==22938==    by 0x7BC65793: segv_handler (signal_i386.c:1310)

What test was this?  Sometimes a little more context helps.


From dank at kegel.com  Fri Apr 11 00:06:09 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 10 Apr 2008 22:06:09 -0700
Subject: AVI file format documentation
In-Reply-To: <a71bd89a0804101142g699fdc9k7ebd4ce3f44e208a@mail.gmail.com>
References: <a71bd89a0804101142g699fdc9k7ebd4ce3f44e208a@mail.gmail.com>
Message-ID: <a71bd89a0804102206m6b5fe0d2g6d564c5826b17476@mail.gmail.com>

On Thu, Apr 10, 2008 at 11:42 AM, Dan Kegel <dank at kegel.com> wrote:
> Maarten stumbled across what he said was very useful
>  documentation about the AVI file format.  For future reference,
>  here it is:
>  http://sunsson.iptime.org/projects/juliet/wiki/MediaFileFormat

Sorry for the spam, but here's one more document he found
that deals with really big avi files:
http://the-labs.com/Video/odmlff2-avidef.pdf
- Dan


From wine-devel at kievinfo.com  Fri Apr 11 00:06:30 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Thu, 10 Apr 2008 23:06:30 -0600
Subject: Valgrind false positive or?
In-Reply-To: <a71bd89a0804102204jca7410ftf32996c6123bdf5c@mail.gmail.com>
References: <a71bd89a0804102204jca7410ftf32996c6123bdf5c@mail.gmail.com>
Message-ID: <47FEF1D6.9040002@kievinfo.com>

Dan Kegel wrote:
> Vitaliy wrote:
> 
>> ==22938== Invalid write of size 1
>> ==22938==    at 0x4024D55: memcpy (mc_replace_strmem.c:402)
>> ==22938==    by 0x7BC64405: setup_exception_record (signal_i386.c:795)
>> ==22938==    by 0x7BC65793: segv_handler (signal_i386.c:1310)
> 
> What test was this?  Sometimes a little more context helps.
Well that was Steam not a test.


From dank at kegel.com  Fri Apr 11 00:55:39 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 10 Apr 2008 22:55:39 -0700
Subject: Valgrind false positive or?
In-Reply-To: <a71bd89a0804102204jca7410ftf32996c6123bdf5c@mail.gmail.com>
References: <a71bd89a0804102204jca7410ftf32996c6123bdf5c@mail.gmail.com>
Message-ID: <a71bd89a0804102255u5e859085gce928918d879268e@mail.gmail.com>

Sounds like one you'll probably just have to ignore.


From stefan at codeweavers.com  Fri Apr 11 01:21:24 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 11 Apr 2008 08:21:24 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804110031.13345.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
Message-ID: <200804110821.25111.stefan@codeweavers.com>

Am Freitag, 11. April 2008 00:31:13 schrieb Stefan D?singer:
> The drawback of this is that now the workaround for the mesa atifs bug
> minimally affects nvidia cards too. It's a bit tricky to design around
> driver bugs :-/
Use this patch instead, the last one had a small but pretty bad bug that 
broken GLSL
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-WineD3D-Use-the-shader-backend-to-enable-disable.patch
Type: text/x-diff
Size: 10157 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080411/b7b37638/attachment-0001.patch 

From hverbeet at gmail.com  Fri Apr 11 01:58:05 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Fri, 11 Apr 2008 08:58:05 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804110821.25111.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804110821.25111.stefan@codeweavers.com>
Message-ID: <d658b69e0804102358w6d8241c0l4592e1be20f9dc6c@mail.gmail.com>

On 11/04/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Freitag, 11. April 2008 00:31:13 schrieb Stefan D?singer:
>
> > The drawback of this is that now the workaround for the mesa atifs bug
>  > minimally affects nvidia cards too. It's a bit tricky to design around
>  > driver bugs :-/
>
> Use this patch instead, the last one had a small but pretty bad bug that
>  broken GLSL
>
This patch doesn't make sense at all. Wasn't ATIFS supposed to be an
implementation of fixed function fragment processing for ATI cards? In
that case it doesn't make sense to only use it on cards that don't
support ARB or GLSL. That will only make newer ATI cards have worse
fixed function fragment processing (assuming ATIFS works as
advertised). Of course what it comes down to again is that the shader
backend isn't the right place to implement this. (Not to mention the
issue of making a workaround for a Mesa bug part of the shader
infrastructure... that bug should be fixed in Mesa.)

> +    void (*shader_fragment_enable)(IWineD3DDevice *iface, BOOL enable);
The name "shader_fragment_enable" is ambiguous at best within the
context of a shader backend.


From dmitry at codeweavers.com  Fri Apr 11 02:38:22 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 11 Apr 2008 16:38:22 +0900
Subject: Reference information on CreateScalableFontResource
References: <47FD91B6.3010902@codeweavers.com><019e01c89ac2$c98971a0$a600fea9@DMITRY>
	<47FE3822.6040806@codeweavers.com>
Message-ID: <004a01c89ba7$0846f1d0$a600fea9@DMITRY>

"Jeremy White" <jwhite at codeweavers.com> wrote:

>> FONTDIR and all related font structures are well described in Windows 3.1
>> DDK I used to have (and use) 15 years ago. I put some knowledge about it
>> when I was fixing after Huw tools/fnt2fon.c, that's a good piece of 
>> knowledge
>> about Windows .fon files.
>> 
> 
> Where in the DDK?  I can't find any place that clearly defines the
> FONTDIR structure in the 3.11 DDK I am looking at.

If I recall correctly it was in the book devoted to developing printer drivers,
around PFM file structure and device font description.

> For example, by inspection, I see that the value placed by Windows
> mostly lines up with the structure we have defined in
> wine/wingdi16.h.   (And you can find that definition of FONTDIR
> if you google around on the web).
> 
> But in the DDK, I find only FONTINFO and other structures; not FONTDIR.
> 
> What I really wanted to know was how the tail end of that structure
> was really mapped out.
> 
> That is, if I compare it to the FONTDIR16 structure we have, it
> seems as though the data written by windows matches pretty well
> up until dfDefaultChar.  At that point, the order is:
> 
>   BYTE   always 0x1    (might be dfDefaultChar, but not clear)
>   BYTE   always 0x2    (might be dfBreakChar, but not clear)
>   WORD   always 0x0    (might be WidthBytes, but not clear)
>   DWORD  always 0x0    (might be dfDevice, but not clear)
>   DWORD  always 0x76, which is the location
>          in the struct of the Family name, suggests dfFace is
>          a reasonable name for this field
>   BYTE   mystery1      (mostly 0x9, sometimes 0xa, 0xb, or 0x6)
>   BYTE   mystery2      always 0
>   BYTE   mystery3      always 0
>   BYTE   mystery4      is sometimes 0xf0, appears to be linked
>                        to cases where the firstchar and last char
>                        both are in the 0xf0XX range
>                        [named dfReserved in the FONTDIR16 struct]
>   BYTE   mystery5      always 0xff
>   ZSTRING family name
>   ZSTRING family name  (again)
>   ZSTRING style name
>       I'm pretty sure the latter 3 are in a constrained buffer
>       of about 40 bytes; haven't nailed that down just yet.

Last field in the FONDIR structure should be dfBitsOffset, followed
by font name. As you can see from fnt2fon.c not the whole FONTINFO16
structure is used, but only 0x72 bytes including dfVersion, dfSize,
dfCopyright.

Also, I'd avoid using FreeType directly altogether, and used Win32
APIs instead to load a TTF file and get all required font info from it.

-- 
Dmitry.


From dmitry at codeweavers.com  Fri Apr 11 02:46:18 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 11 Apr 2008 16:46:18 +0900
Subject: AVI file format documentation
References: <a71bd89a0804101142g699fdc9k7ebd4ce3f44e208a@mail.gmail.com>
Message-ID: <005501c89ba8$22d255c0$a600fea9@DMITRY>

"Dan Kegel" <dank at kegel.com> wrote:

> Maarten stumbled across what he said was very useful
> documentation about the AVI file format.  For future reference,
> here it is:
> http://sunsson.iptime.org/projects/juliet/wiki/MediaFileFormat

AVI files are just RIFF files, and RIFF file format is very well documented,
and should be well supported in Wine: mmioOpen, mmioDescend, etc.

Both dlls/mciavi32 and dlls/avifil32 are able to parse and play AVI files.

-- 
Dmitry.


From m.b.lankhorst at gmail.com  Fri Apr 11 02:55:29 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 11 Apr 2008 00:55:29 -0700
Subject: AVI file format documentation
In-Reply-To: <005501c89ba8$22d255c0$a600fea9@DMITRY>
References: <a71bd89a0804101142g699fdc9k7ebd4ce3f44e208a@mail.gmail.com>
	<005501c89ba8$22d255c0$a600fea9@DMITRY>
Message-ID: <b130c85e0804110055q4247a5e2rc7312b19c5992ee0@mail.gmail.com>

Hello Dmitry,

2008/4/11, Dmitry Timoshkov <dmitry at codeweavers.com>:
> "Dan Kegel" <dank at kegel.com> wrote:
> > Maarten stumbled across what he said was very useful
>  > documentation about the AVI file format.  For future reference,
>  > here it is:
>  > http://sunsson.iptime.org/projects/juliet/wiki/MediaFileFormat
> AVI files are just RIFF files, and RIFF file format is very well documented,
>  and should be well supported in Wine: mmioOpen, mmioDescend, etc.
>
>  Both dlls/mciavi32 and dlls/avifil32 are able to parse and play AVI files.
I don't think I can use that from quartz though. It uses the
asyncreader primitives and I don't believe there is such thing as a
IRiffReader interface. ;-)

Also, I don't think avifill and mciavi currently support seeking, that
is very important as well.

Cheers,
Maarten.


From stefan at codeweavers.com  Fri Apr 11 02:59:56 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 11 Apr 2008 09:59:56 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <d658b69e0804102358w6d8241c0l4592e1be20f9dc6c@mail.gmail.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804110821.25111.stefan@codeweavers.com>
	<d658b69e0804102358w6d8241c0l4592e1be20f9dc6c@mail.gmail.com>
Message-ID: <200804110959.56731.stefan@codeweavers.com>

Am Freitag, 11. April 2008 08:58:05 schrieb H. Verbeet:

First of all: We really want that patch to go in, Wine is currently badly 
broken on fglrx.

> This patch doesn't make sense at all. Wasn't ATIFS supposed to be an
> implementation of fixed function fragment processing for ATI cards? In
> that case it doesn't make sense to only use it on cards that don't
> support ARB or GLSL. That will only make newer ATI cards have worse
> fixed function fragment processing (assuming ATIFS works as
> advertised). Of course what it comes down to again is that the shader
> backend isn't the right place to implement this.
We need that in a shader backend if we are ever going to implement pixel 
shaders using atifs. We also have to make nvts/nvrc a shader backend if we 
ever implement pixel shaders using that extension.

As for the worse fragment processing on newer ATI cards: We do not want to use 
ATIFS on those cards anyway, because ATIFS has a hardcoded limitation of 6 
simultanous textures, whereas radeon 9500+ cards support 8 textures with 
regular OpenGL fixed function processing. Also fglrx supports 
GL_ATI_envmap_bumpmap on those cards, so we have bump mapping without ATIFS 
as well(Still missing stuff like specular color input and rare blending 
parameters though). For newer ATI cards we need an ARBFP / GLSL pipeline 
replacement, no matter what we do with ATIFS.

Remember, my original patchset used ATIFS with newer cards as well. Ivan did 
not like the 3 inherited atifs backends, so I've limited ATIFS to its final 
use in a 'perfect' wine that has an ARBFP and GLSL replacement.


> (Not to mention the 
> issue of making a workaround for a Mesa bug part of the shader
> infrastructure... that bug should be fixed in Mesa.)
It is fixed there already, but we're using the workaround to allow users of 
older Mesa versions to run the tests without crashing. If it's just about me 
we can take the workaround out again, I have the newest Mesa code...


From hverbeet at gmail.com  Fri Apr 11 03:39:13 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Fri, 11 Apr 2008 10:39:13 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804110959.56731.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804110821.25111.stefan@codeweavers.com>
	<d658b69e0804102358w6d8241c0l4592e1be20f9dc6c@mail.gmail.com>
	<200804110959.56731.stefan@codeweavers.com>
Message-ID: <d658b69e0804110139n5182168bk54498b4e2ba02a7e@mail.gmail.com>

On 11/04/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
>  > This patch doesn't make sense at all. Wasn't ATIFS supposed to be an
>  > implementation of fixed function fragment processing for ATI cards? In
>  > that case it doesn't make sense to only use it on cards that don't
>  > support ARB or GLSL. That will only make newer ATI cards have worse
>  > fixed function fragment processing (assuming ATIFS works as
>  > advertised). Of course what it comes down to again is that the shader
>  > backend isn't the right place to implement this.
>
> We need that in a shader backend if we are ever going to implement pixel
>  shaders using atifs. We also have to make nvts/nvrc a shader backend if we
>  ever implement pixel shaders using that extension.
I'm not convinced we should lump that together in the shader backend
just because it uses the same GL extension, but I guess we've been
through that discussion. Fact is that we don't currently implement
pixel shaders using atifs, and nobody knows how long it may take
before we will, if ever.

>  As for the worse fragment processing on newer ATI cards: We do not want to use
>  ATIFS on those cards anyway, because ATIFS has a hardcoded limitation of 6
>  simultanous textures, whereas radeon 9500+ cards support 8 textures with
>  regular OpenGL fixed function processing. Also fglrx supports
>  GL_ATI_envmap_bumpmap on those cards, so we have bump mapping without ATIFS
>  as well(Still missing stuff like specular color input and rare blending
>  parameters though). For newer ATI cards we need an ARBFP / GLSL pipeline
>  replacement, no matter what we do with ATIFS.
>
I think in practice the specular color input is probably more
important than the two extra textures. It's pretty rare for programs
to hit the nvrc limit of 4, and if they do they don't usually break as
bad as when they try to use the missing specular input.

>  First of all: We really want that patch to go in, Wine is currently badly
>  broken on fglrx.
Yes it's broken, but I'm not convinced this is the right way to fix
it. (I'd be fine with committing this just to fix the breakage, but I
do think this is simply more evidence that the atifs stuff is in the
wrong place.) Ultimately I'm just giving my opinion of course, it's up
to you and Alexandre to decide what to do with that.


From mstefani at redhat.com  Fri Apr 11 04:15:07 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Fri, 11 Apr 2008 11:15:07 +0200
Subject: WineConf 2008
In-Reply-To: <47FE64E6.3050303@codeweavers.com>
References: <47FE64E6.3050303@codeweavers.com>
Message-ID: <47FF2C1B.2040004@redhat.com>

Jeremy White wrote:
> I'd like to start the planning for WineConf 2008.
> 
> My sense is that 3 years in Europe and 1 year in the US
> is a reasonable balance, so I feel it makes sense to
> try to have it over here this year.
> 
> Further, I would like to host WineConf this year in St. Paul, Minnesota,
> for a variety of reasons.  First, it's a lot easier for me to help
> plan if it's here.  Second, it's nice for CodeWeavers; it means we
> can have everyone, not just the developers, all together.  Having Mandi
> able to physically intimidate people is very helpful for us, after all <grin>.
> 
> My thought was to do it in late September, early October, so
That's the worst possible date for me. Anyw way to move it to beginning 
of September or end of October?

> that the weather would not be so extreme.  I realize that veterans
> of our last Minnesota meeting will be disappointed at the lack
> of the Ice Palace, but we'll try to find a way to make it up to you.
> 
> Also, I know the travel costs will be hard for many people, given current
> travel costs, so I'm hoping to contribute funds (and perhaps
> do some fund raising) to help cover travel costs for Wine
> contributors.
> 
> At any rate, that's my idea.  I'm willing to be swayed if people
> object violently, or if a clear consensus for an alternate emerges.

bye
	michael


From julliard at winehq.org  Fri Apr 11 04:22:12 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 11 Apr 2008 11:22:12 +0200
Subject: ntdll: Fix a test that fails on both win2k and winxp
In-Reply-To: <22821af30804101608o1e3a7f58p928efcee4a4d09b8@mail.gmail.com>
	(James Hawkins's message of "Thu, 10 Apr 2008 18:08:40 -0500")
References: <22821af30804101608o1e3a7f58p928efcee4a4d09b8@mail.gmail.com>
Message-ID: <87od8ghhkr.fsf@wine.dyndns.org>

"James Hawkins" <jhawkins at codeweavers.com> writes:

> Changelog:
> * Fix a test that fails on both win2k and winxp.

This will break the test for win9x.

-- 
Alexandre Julliard
julliard at winehq.org


From dmitry at codeweavers.com  Fri Apr 11 04:52:50 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 11 Apr 2008 18:52:50 +0900
Subject: tools: Fix font structure layout for 64-bit mode
References: <E1JkE7U-0006vH-7H@mail.codeweavers.com>
	<20080411194617.9b6870ba.mle+win@mega-nerd.com>
Message-ID: <003301c89bb9$cfc0e740$a600fea9@DMITRY>

"Erik de Castro Lopo" <mle+win at mega-nerd.com> wrote:

> I quick question from someone relatively new to wine development.
> 
> Are these 64-bit fixes aimed at compiling wine for 64 bit CPUs
> but running win32 apps or for running win64 apps?

Both.

-- 
Dmitry.


From dmitry at codeweavers.com  Fri Apr 11 05:01:20 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 11 Apr 2008 19:01:20 +0900
Subject: AVI file format documentation
References: <a71bd89a0804101142g699fdc9k7ebd4ce3f44e208a@mail.gmail.com><005501c89ba8$22d255c0$a600fea9@DMITRY>
	<b130c85e0804110055q4247a5e2rc7312b19c5992ee0@mail.gmail.com>
Message-ID: <004001c89bbb$0108e950$a600fea9@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

>>  Both dlls/mciavi32 and dlls/avifil32 are able to parse and play AVI files.
> I don't think I can use that from quartz though. It uses the
> asyncreader primitives and I don't believe there is such thing as a
> IRiffReader interface. ;-)

There is no such a thing as IRiffReader interface at all.

> Also, I don't think avifill and mciavi currently support seeking, that
> is very important as well.

That depends on what you mean by "seeking". If that's what commonly used
for moving from one frame to another, or from one position in stream to
another there is nothing magic to implement.

-- 
Dmitry.


From julliard at winehq.org  Fri Apr 11 05:02:44 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 11 Apr 2008 12:02:44 +0200
Subject: kernel32: Fix for WritePrivateProfileString Sharing Problem [1/2]
	(ATTEMPT 3)
In-Reply-To: <4c1ac96d0804101824t55851a07k1cecbde8399af6a6@mail.gmail.com>
	(Erich Hoover's message of "Thu, 10 Apr 2008 19:24:15 -0600")
References: <4c1ac96d0804101758r6f7d58beve93f1a1cc164486f@mail.gmail.com>
	<4c1ac96d0804101824t55851a07k1cecbde8399af6a6@mail.gmail.com>
Message-ID: <87d4owhfp7.fsf@wine.dyndns.org>

"Erich Hoover" <ehoover at mines.edu> writes:

> Description:
>     Fixes incorrect file sharing mode in PROFILE_FlushFile and PROFILE_Open
> that result in WritePrivateProfileString failing under certain
> circumstances.  This problem is specifically evident in the "Thief: Deadly
> Shadows" installer (demo and full), which writes an empty config file that
> later causes the game to crash (Bug #5024). This version is functionally
> equivalent to Attempt 2; however, it uses NtCreateFile so there is no need
> to push and pop the error code.  This version also sets ERROR_SUCCESS, as
> opposed to S_OK, for Get* functions.  Conformance test included in part 2.

There's no need to use ntdll functions, last error doesn't matter on
success, and if it does it should be set at the end of the function
anyway (with test cases showing that it's really supposed to).

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Apr 11 06:02:27 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 11 Apr 2008 13:02:27 +0200
Subject: [1/3] setupapi: Add a test for SetupDiGetDeviceRegistryProperty
	and SetupDiSetDeviceRegistryProperty
In-Reply-To: <200804111336.57900.amorozov@etersoft.ru> (Alexander Morozov's
	message of "Fri, 11 Apr 2008 13:36:57 +0400")
References: <200804111336.57900.amorozov@etersoft.ru>
Message-ID: <8763uohcxo.fsf@wine.dyndns.org>

Alexander Morozov <amorozov at etersoft.ru> writes:

> +    if (wide)
> +    {
> +        pSetupDiGetClassDevs = (void *)pSetupDiGetClassDevsW;
> +        pSetupDiSetDeviceRegistryProperty = (void *)pSetupDiSetDeviceRegistryPropertyW;
> +        pSetupDiGetDeviceRegistryProperty = (void *)pSetupDiGetDeviceRegistryPropertyW;
> +        pSetupDiCreateDeviceInfo = (void *)pSetupDiCreateDeviceInfoW;
> +        devName = (void *)devNameW;
> +        friendlyName = (void *)friendlyNameW;
> +        buflen = 6 * sizeof(WCHAR);
> +        buf = (void *)bufW;
> +    }
> +    else
> +    {
> +        pSetupDiGetClassDevs = (void *)pSetupDiGetClassDevsA;
> +        pSetupDiSetDeviceRegistryProperty = (void *)pSetupDiSetDeviceRegistryPropertyA;
> +        pSetupDiGetDeviceRegistryProperty = (void *)pSetupDiGetDeviceRegistryPropertyA;
> +        pSetupDiCreateDeviceInfo = (void *)pSetupDiCreateDeviceInfoA;
> +        devName = (void *)devNameA;
> +        friendlyName = (void *)friendlyNameA;
> +        buflen = 6;
> +        buf = (void *)bufA;
> +    }

That's ugly, it's bypassing all type checking. There's no reason to test
everything twice, in most cases the A function calls the W one, so
testing the A one automatically tests both. If there are differences you
really need to test, please do that explicitly by duplicating the test.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Apr 11 06:18:58 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 11 Apr 2008 13:18:58 +0200
Subject: [PATCH 1/2] winecfg: Add option to let wine decorate windows
In-Reply-To: <47FE7555.1090100@comcast.net> (Matthew D'Asaro's message of
	"Thu, 10 Apr 2008 13:15:17 -0700")
References: <47FE7555.1090100@comcast.net>
Message-ID: <871w5chc65.fsf@wine.dyndns.org>

Matthew D'Asaro <medasaro at comcast.net> writes:

> Some applications such as iTunes, Winamp, Windows Media Player, Office
> 2007, etc. look best without the Linux windows manager decorations on
> them. This patch adds an option to winecfg which
> allows an application's windows to be managed by the Linux window
> manager, but to be decorated by wine. This can also be useful for
> debugging some window management problems. The modification to the
> winecfg dialog is only in English as I don't know any of the other
> languages.

I put the patch in, but this winecfg page really needs to be redesigned,
the decorated/managed/desktop options are mutually exclusive, so it
should use radio buttons. Also the explanations should be moved out to a
tooltip or some sort of help option. Any volunteer?

-- 
Alexandre Julliard
julliard at winehq.org


From scott at open-vote.org  Fri Apr 11 06:50:05 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Fri, 11 Apr 2008 04:50:05 -0700
Subject: Including Mono within a Wine package - should Wine expect this?
In-Reply-To: <a71bd89a0804101954w31a24e2fn72c027796b771a6e@mail.gmail.com>
References: <a71bd89a0804100645y2b7f9c94n719ab5f19374db04@mail.gmail.com>	
	<47FECF9E.1030309@open-vote.org>
	<a71bd89a0804101954w31a24e2fn72c027796b771a6e@mail.gmail.com>
Message-ID: <47FF506D.4010102@open-vote.org>

Dan Kegel wrote:
> On Thu, Apr 10, 2008 at 7:40 PM, Scott Ritchie <scott at open-vote.org> wrote:
>>  > Wine-mono on the other hand is probably premature.
>>  > How many apps are helped at the moment by
>>  >   winetricks mono12
>>  > ?  I don't think it's a large number.
>>
>>  Honestly I don't know.  Is this due to inadequacies in the current mono,
>>  or inadequacies in Wine?
> 
> Mono doesn't even try to handle mixed-mode assemblies (i.e. ones
> that contain some native code).  And by gum, every .net app built
> by Microsoft tools seems to include some native code for some odd
> reason.  Go figure!

Is this true even for the Windows version of Mono?  If Mono is supposed
to be a replacement for what the .net framework provides, then it seems
like duplicating this functionality on Windows (and therefore Wine)
would be part of it.

I did some searching as for why this is the case.  This link:
http://www.jprl.com/Blog/archive/development/mono/2008/Jan-27.html
indicates that the main issue is the loader supporting PE files, which
is what Wine already does.

> 
>>  Either way, Mono 2.0 will finally come out around the same time as Wine
>>  1.0 (quarter 2 of 2008), and I suspect the number of applications Mono
>>  helps will greatly improve by then.
> 
> Maybe, but only apps that have been properly cleaned of native code.
> - Dan

Hmm...it seems like gluing Mono and Wine together would require a bit
more collaboration than the two projects have.

Thanks,
Scott Ritchie


From thunderbird2k at gmx.net  Fri Apr 11 07:50:59 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Fri, 11 Apr 2008 14:50:59 +0200
Subject: Including Mono within a Wine package - should Wine expect this?
In-Reply-To: <47FF506D.4010102@open-vote.org>
References: <a71bd89a0804100645y2b7f9c94n719ab5f19374db04@mail.gmail.com>	
	<47FECF9E.1030309@open-vote.org>
	<a71bd89a0804101954w31a24e2fn72c027796b771a6e@mail.gmail.com>
	<47FF506D.4010102@open-vote.org>
Message-ID: <20080411125059.293230@gmx.net>

> Dan Kegel wrote:
> > On Thu, Apr 10, 2008 at 7:40 PM, Scott Ritchie <scott at open-vote.org>
> wrote:
> >>  > Wine-mono on the other hand is probably premature.
> >>  > How many apps are helped at the moment by
> >>  >   winetricks mono12
> >>  > ?  I don't think it's a large number.
> >>
> >>  Honestly I don't know.  Is this due to inadequacies in the current
> mono,
> >>  or inadequacies in Wine?
> > 
> > Mono doesn't even try to handle mixed-mode assemblies (i.e. ones
> > that contain some native code).  And by gum, every .net app built
> > by Microsoft tools seems to include some native code for some odd
> > reason.  Go figure!
> 
> Is this true even for the Windows version of Mono?  If Mono is supposed
> to be a replacement for what the .net framework provides, then it seems
> like duplicating this functionality on Windows (and therefore Wine)
> would be part of it.
> 
> I did some searching as for why this is the case.  This link:
> http://www.jprl.com/Blog/archive/development/mono/2008/Jan-27.html
> indicates that the main issue is the loader supporting PE files, which
> is what Wine already does.
> 
> > 
> >>  Either way, Mono 2.0 will finally come out around the same time as
> Wine
> >>  1.0 (quarter 2 of 2008), and I suspect the number of applications Mono
> >>  helps will greatly improve by then.
> > 
> > Maybe, but only apps that have been properly cleaned of native code.
> > - Dan
> 
> Hmm...it seems like gluing Mono and Wine together would require a bit
> more collaboration than the two projects have.
> 
> Thanks,
> Scott Ritchie
> 

For a part the issue is that lots of programs are hybrid ones. Some of them behave 'nicely' in the way they just call a few functions from a native win32 dll. I think apps that embed COM objects (like a Word viewer, ..) are worse as mono doesn't offer this at all. The most problematic thing is that mono's windows.forms is fully managed while microsoft just layered it on top of gdi32/gdiplus/user32. This allows you to use standard win32 apis on most windows.forms controls to override behavior. A lot of apps do this, so even if you could access native win32 dlls, magic like this won't work at all. Second COM objects might also rely on evil win32 magic.

All in all mono only works on a few well behaved apps and most don't behave well. PersonallY I think a win32 mono package for wine is nearly useless.

Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.gmx.net/de/entertainment/games/free


From stefan at codeweavers.com  Fri Apr 11 07:50:39 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 11 Apr 2008 14:50:39 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
In-Reply-To: <200804110106.54219.stefan@codeweavers.com>
References: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
	<e1d9e62c0804090533g5b505f43od13e67b41c322024@mail.gmail.com>
	<200804110106.54219.stefan@codeweavers.com>
Message-ID: <200804111450.40053.stefan@codeweavers.com>

Am Freitag, 11. April 2008 01:06:54 schrieb Stefan D?singer:
> Hi,
> I just tried 3DMark2001, and I can confirm the black textures in the high
> car test, so it is not your different card. I am pretty sure this used to
> work though...
Can you try the attached hack? If fixes the black textures in 3DMark 2001 for 
me.


-------------- next part --------------
A non-text attachment was scrubbed...
Name: atifs-hack
Type: text/x-diff
Size: 1853 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080411/742618b8/attachment.diff 

From dmitry at codeweavers.com  Fri Apr 11 08:03:56 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 11 Apr 2008 22:03:56 +0900
Subject: gdi32: Add a test to highlight the CreateCompatibleDC
	problemdescribed in bug #12493
References: <003701c89bd3$a7144f70$652ad40a@colinhome>
Message-ID: <034101c89bd4$8274e4d0$a600fea9@DMITRY>

"Colin Finck" <mail at colinfinck.de> wrote:

> Changelog:
>  Add a gdi32 test to highlight the CreateCompatibleDC problem described in
> bug #12493

If the test fails in current Wine code you need to use todo_wine
so that 'make test' still passes.

-- 
Dmitry.


From ehoover at mines.edu  Fri Apr 11 08:44:03 2008
From: ehoover at mines.edu (Erich Hoover)
Date: Fri, 11 Apr 2008 07:44:03 -0600
Subject: kernel32: Fix for WritePrivateProfileString Sharing Problem [1/2]
	(ATTEMPT 3)
In-Reply-To: <87d4owhfp7.fsf@wine.dyndns.org>
References: <4c1ac96d0804101758r6f7d58beve93f1a1cc164486f@mail.gmail.com>
	<4c1ac96d0804101824t55851a07k1cecbde8399af6a6@mail.gmail.com>
	<87d4owhfp7.fsf@wine.dyndns.org>
Message-ID: <4c1ac96d0804110644g7deae904k4d9cf0947bcd4622@mail.gmail.com>

> There's no need to use ntdll functions,

I submitted prior patches that did not use ntdll, there was a complaint
about that approach since it had to push and pop the last error:
http://www.winehq.org/pipermail/wine-devel/2008-April/064657.html

> last error doesn't matter on success, and if it does it should be set at
the end of the function
anyway (with test cases showing that it's really supposed to).

The very last test in "test_profile_sections" (an existing test) requires
GetPrivateProfileSectionA to return S_OK (ERROR_SUCCESS).  I originally
submitted a patch that broke this test (plus exposed another problem, but
we'll take one step at a time).  There was a complaint about this, but it
was a really long time ago so it'd take me a while to find that email.
Essentially, the write functions need to return the last error from before
they were called (part 2/2 is a conformance test for this) and the get
functions need to set the last error to ERROR_SUCCESS (as shown by an
existing test, though it actually tests against the value-equivalent S_OK).

Erich Hoover
ehoover at mines.edu

On Fri, Apr 11, 2008 at 4:02 AM, Alexandre Julliard <julliard at winehq.org>
wrote:

> "Erich Hoover" <ehoover at mines.edu> writes:
>
> > Description:
> >     Fixes incorrect file sharing mode in PROFILE_FlushFile and
> PROFILE_Open
> > that result in WritePrivateProfileString failing under certain
> > circumstances.  This problem is specifically evident in the "Thief:
> Deadly
> > Shadows" installer (demo and full), which writes an empty config file
> that
> > later causes the game to crash (Bug #5024). This version is functionally
> > equivalent to Attempt 2; however, it uses NtCreateFile so there is no
> need
> > to push and pop the error code.  This version also sets ERROR_SUCCESS,
> as
> > opposed to S_OK, for Get* functions.  Conformance test included in part
> 2.
>
> There's no need to use ntdll functions, last error doesn't matter on
> success, and if it does it should be set at the end of the function
> anyway (with test cases showing that it's really supposed to).
>
> --
> Alexandre Julliard
> julliard at winehq.org
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080411/71276b9a/attachment.htm 

From stefan at codeweavers.com  Fri Apr 11 08:56:12 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 11 Apr 2008 15:56:12 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <d658b69e0804110139n5182168bk54498b4e2ba02a7e@mail.gmail.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804110959.56731.stefan@codeweavers.com>
	<d658b69e0804110139n5182168bk54498b4e2ba02a7e@mail.gmail.com>
Message-ID: <200804111556.12566.stefan@codeweavers.com>

Am Freitag, 11. April 2008 10:39:13 schrieb H. Verbeet:
> I think in practice the specular color input is probably more
> important than the two extra textures. It's pretty rare for programs
> to hit the nvrc limit of 4, and if they do they don't usually break as
> bad as when they try to use the missing specular input.
Not really, many games check the MaxSimultaneousTextures cap and use that 
value even if they are using pixel shaders. E.g. HL2 fails in dxlevel 81 with 
that with ARB shaders because it checks that cap if it finds SM 1.x, and Age 
of Empires 3 fails as well. Call of duty 4 is another popular example, it 
requires 8 fixed function textures. (COD4 wants TSSARGTEMP as well, so that 
point is moot)



From hverbeet at gmail.com  Fri Apr 11 09:10:49 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Fri, 11 Apr 2008 16:10:49 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804111556.12566.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804110959.56731.stefan@codeweavers.com>
	<d658b69e0804110139n5182168bk54498b4e2ba02a7e@mail.gmail.com>
	<200804111556.12566.stefan@codeweavers.com>
Message-ID: <d658b69e0804110710x284c217l84fd271aa01cc7da@mail.gmail.com>

On 11/04/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Not really, many games check the MaxSimultaneousTextures cap and use that
>  value even if they are using pixel shaders. E.g. HL2 fails in dxlevel 81 with
>  that with ARB shaders because it checks that cap if it finds SM 1.x, and Age
>  of Empires 3 fails as well. Call of duty 4 is another popular example, it
>  requires 8 fixed function textures. (COD4 wants TSSARGTEMP as well, so that
>  point is moot)
>
Sure, but they don't generally break if you just return 8 there.
(Compared to eg. HL2/CSS in dxlevel70 without D3DTA_SPECULAR). Of
course the proper way to get around all of the issues at the same time
would be to write a real GLSL fixed function fragment processing
implementation, but that doesn't change the fact that the current
situation is pretty ugly.


From stefan at codeweavers.com  Fri Apr 11 09:18:49 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 11 Apr 2008 16:18:49 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <d658b69e0804110139n5182168bk54498b4e2ba02a7e@mail.gmail.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804110959.56731.stefan@codeweavers.com>
	<d658b69e0804110139n5182168bk54498b4e2ba02a7e@mail.gmail.com>
Message-ID: <200804111618.49900.stefan@codeweavers.com>

Alexandre didn't commit the patch, I think we should come to an agreement on 
this issue, otherwise it is going to come up again and again.

The requirements I have in mind are these:

1) The state table should be selectable based on the available opengl features 
and possibly registry settings. I think we all agree on that

2) We want a fixed function vertex and fragment pipeline replacement with ARB 
and GLSL

3) We want to be able to support pixel shaders with atifs and nvts. I don't 
know if that will ever be implemented, but if we choose a design that makes 
this hard or impossible that's not going to help

4) Even if we have an ARB/GLSL replacement, it should be possible to use D3D 
shaders but still use the opengl fixed function pipeline

5) A nice to have is to be able to use the replacement pipelines together with 
shaders, but that is not a hard requirement for me. We need an ARB and GLSL 
replacement anyway.

---

I understand Henri's suggestion this way: Don't put the state table into the 
shader backend(*), but select it separately. This way the ATIFS pipeline 
replacement doesn't have to be a shader model. That way we can choose the ARB 
shader backend and ATIFS state table on r200 cards, and use GLSL and ATIFS on 
newer cards.

That way we get full shader support and still the advantages of the pipeline 
replacement without using 3 inherited shader backends. Then the state table 
could have some backend to enable / disable ATIFS like in this patch. (The 
bottom line of the patch here is that we should enable the extension we 
*use*, and not what happens to be available).

The state table would report the fixed function caps it has, and the shader 
backend reports the programmable pipeline caps. GetDeviceCaps has to collect 
the caps from multiple places, but that isn't an issue IMO.

Is that correct, or did I missunderstand something?

However, I see two issues with that:

*) In which place do we decide which program/shader to use in the end? If we 
have an ARB fixed function replacement program and an ARB program generated 
from a D3D shader? Currently this happens to work because ARB/GLSL override 
NVTS and NVRC, but this fails if we have a shader and ffp implementation 
using the same extension

*) What do we do if a shader implementation wants to overwrite some states for 
its programmable pipeline work? For example take my GLSL clipplane patch: The 
ARB shader backend disables clipplanes when a shader is used. This example is 
about a driver bug, but there are others as well: ATIFS and NVTS with a pixel 
shader implementation will have to override a part of the sampler setting(the 
stuff that is currently done in activate_dimensions)

How would you deal with this?

Stefan

(*): Ivan and I agreed on a discussion on IRC that "shader backend" is not a 
good name. The shader backends today are more a pipeline implementation 
rather than a shader implemenation, and should be renamed accordingly. I did 
not rename them yet because I am not 100% happy with the name "pipeline" yet.


From Petr.Sumbera at Sun.COM  Fri Apr 11 09:26:05 2008
From: Petr.Sumbera at Sun.COM (Petr Sumbera)
Date: Fri, 11 Apr 2008 16:26:05 +0200
Subject: Trouble in compiling Wine 0.9.57 and 0.9.58 on Solaris 10 08/07
Message-ID: <47FF74FD.4060307@sun.com>

 >isinf is a function / macro which returns wether or not a float is 
positive
 >infinite or negative infinite. I think it is a standard C function. Maybe
 >solaris declares it in some header that needs to be included, like math.h?

I have logged for this bug: http://bugs.winehq.org/show_bug.cgi?id=12008

Not sure where to find it exactly. But isinf seems to be defined by ISO 
99 (not by standard C).

Regards,

Petr


From dank at kegel.com  Fri Apr 11 09:27:46 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 11 Apr 2008 07:27:46 -0700
Subject: Wine malware story
Message-ID: <a71bd89a0804110727q4c51f129y741c60bbed240e19@mail.gmail.com>

http://www.thaibrother.com/blog/?p=1047
is a fairly thin article about malware in wine;
it's worth mentioning only because it shows
the issue is getting discussed more.


From stefan at codeweavers.com  Fri Apr 11 09:32:54 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 11 Apr 2008 16:32:54 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <d658b69e0804110710x284c217l84fd271aa01cc7da@mail.gmail.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804111556.12566.stefan@codeweavers.com>
	<d658b69e0804110710x284c217l84fd271aa01cc7da@mail.gmail.com>
Message-ID: <200804111632.54903.stefan@codeweavers.com>

Am Freitag, 11. April 2008 16:10:49 schrieb H. Verbeet:
> Sure, but they don't generally break if you just return 8 there.
> (Compared to eg. HL2/CSS in dxlevel70 without D3DTA_SPECULAR). Of
> course the proper way to get around all of the issues at the same time
> would be to write a real GLSL fixed function fragment processing
> implementation, but that doesn't change the fact that the current
> situation is pretty ugly.
I don't think it's the D3DTA_SPECULAR that breaks things. HL2 doesn't use it. 
If it finds pixel shader support advertised it suddenly works without 
D3DTA_SPECULAR support and does not use pixel shaders either, so I think 
there's a different capability flag issue there(or HL2 is just broken on 
cards without pixel shader support nowadays).


From frank.richter at gmail.com  Fri Apr 11 09:39:11 2008
From: frank.richter at gmail.com (Frank Richter)
Date: Fri, 11 Apr 2008 16:39:11 +0200
Subject: [PATCH] winecfg => control panel applets patch
In-Reply-To: <200804101047.28206.pure_evil@mail.bg>
References: <200804101047.28206.pure_evil@mail.bg>
Message-ID: <ftnt6f$nrm$1@ger.gmane.org>

On 10.04.2008 09:47, pure_evil at mail.bg wrote:
> However, since control panel does not utilize Unicode yet, the additionalb 
> Bulgarian translation matches the English one.

So what's the point of that "translation" then? Right now it doesn't add 
anything worthwhile but increases the patch size - not good.

You probably increase the chance of your patch being accepted by leaving 
out that not-really-a-translation. I'd recommend you submit that as a 
patch at a later point of time. It probably also makes sense to properly 
"unicodify" the control panel before supplying a language that needs it.

-f.r.



From chris.kcat at gmail.com  Fri Apr 11 10:22:20 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Fri, 11 Apr 2008 08:22:20 -0700
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804111618.49900.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<d658b69e0804110139n5182168bk54498b4e2ba02a7e@mail.gmail.com>
	<200804111618.49900.stefan@codeweavers.com>
Message-ID: <200804110822.21012.chris.kcat@gmail.com>

On Friday 11 April 2008 07:18:49 am Stefan D?singer wrote:
> Alexandre didn't commit the patch, I think we should come to an agreement
> on this issue, otherwise it is going to come up again and again.

For my own 2 cents on the issue, I think the fixed-function replacements 
should work through the selected shader backend. For example, if someone has 
GLSL enabled, the fixed-function replacement should be done through GLSL, and 
if ARB is used, it should done through ARB shaders. In this way, the atifs 
fixed-function replacement should never be used when the ARB or GLSL shader 
backend is used (one shader mode shouldn't supercede another while the 
program is running).

This would ensure compatibility on the OpenGL side when D3D's fixed-function 
pipeline is mixed with D3D shaders, still leave room for a proper atifs/nvts 
shader backend, and not introduce problems related to how one shader backend 
might interact with another. It honestly doesn't make sense to me why wined3d 
should just jump in and start using atifs/nvts shaders for fixed-function 
replacements, when the selected shader mode is ARB or GLSL. And really, 
atifs/nvts should be last-ditch resorts because they are only available on 
selected vendors, while ARB and GLSL are more widespread (eg. on Intel, 
MESA).

Ideally, in my mind, wined3d should autoselect one shader mode (unless a 
registry option is present to force one). It would be selected based on 
availability:

* if nv vertex/fragment programs are available, they should be used as a 
suppliment to the ARB shader backend (giving up to SM3.0 (4.0, actually), 
with functionality that most closely follows D3D)
* else if GLSL is available, that should be used (giving SM2.0/3.0)
* else if ARB shaders are available, then they should be used (giving PS1.1 
and VS1.4)
* else if atifs/nvts are available, use them (giving SM1.x)
* else disable D3D shaders

In all cases, it should pick one and stick with it through the life of the 
process, for both D3D shaders and D3D fixed-function. Don't use atifs if ARB 
is available, don't use GLSL if nv-supplimented ARB is available, etc.

Though, perhaps I'm misunderstanding the whole issue, and I'm spouting 
non-sense..


From mikolaj at zalewski.pl  Fri Apr 11 10:24:48 2008
From: mikolaj at zalewski.pl (=?UTF-8?B?TWlrb8WCYWogWmFsZXdza2k=?=)
Date: Fri, 11 Apr 2008 17:24:48 +0200
Subject: [PATCH] winecfg => control panel applets patch
In-Reply-To: <ftnt6f$nrm$1@ger.gmane.org>
References: <200804101047.28206.pure_evil@mail.bg> <ftnt6f$nrm$1@ger.gmane.org>
Message-ID: <47FF82C0.4030306@zalewski.pl>

Frank Richter wrote:

>On 10.04.2008 09:47, pure_evil at mail.bg wrote:
>  
>
>>However, since control panel does not utilize Unicode yet, the additionalb 
>>Bulgarian translation matches the English one.
>>    
>>
  Even for non-Unicode apps you should have no problems with adding a 
Bulgarian translation to a GUI app (when Bulgarian is selected as your 
preferred language the active codepage will be chosen accordingly). 
Maybe you used a wrong charset? You should use the Windows charset or 
use #pragma (see 
http://wiki.winehq.org/Developers-Hints?highlight=%28Developers%29#head-ef42a958e4f633dbd4a0ae42649fa02a4d1827fd 
)

Miko?aj Zalewski


From most at museresearch.com  Fri Apr 11 12:12:26 2008
From: most at museresearch.com (Michael Ost)
Date: Fri, 11 Apr 2008 10:12:26 -0700
Subject: Wine malware story
In-Reply-To: <mailman.5.1207933202.27994.wine-devel@winehq.org>
References: <mailman.5.1207933202.27994.wine-devel@winehq.org>
Message-ID: <47FF9BFA.9070900@museresearch.com>

"Dan Kegel" <dank at kegel.com> wrote:
> http://www.thaibrother.com/blog/?p=1047
> is a fairly thin article about malware in wine;
> it's worth mentioning only because it shows
> the issue is getting discussed more.

As Wine gains functionality --- supporting Windows services, binary 
drivers, registry startup programs, etc --- it seems like it will be 
more vulnerable on this score.

 From my somewhat naive point of view regarding Windows malware, I would 
like to see Wine have the option of only running the app that I asked it 
to and not a bunch of other stuff that gets auto-loaded and run.

An option like that could be billed as making Wine "safer" than Windows.

I'm also really glad that my Wine-based product is moving away from 
running Wine as root!

Cheers... mo


From zgs at seas.upenn.edu  Fri Apr 11 12:41:14 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Fri, 11 Apr 2008 13:41:14 -0400
Subject: [Wine] Uninstallation of Programs
In-Reply-To: <b6bb06270804111009x43dff92bh472e2f1b9d6c8130@mail.gmail.com>
References: <1207933293.m2f.3286@forum.winehq.org>
	<b6bb06270804111009x43dff92bh472e2f1b9d6c8130@mail.gmail.com>
Message-ID: <b050a5e70804111041k48e3d7bepeb55b83bdcd4b488@mail.gmail.com>

On Fri, Apr 11, 2008 at 1:09 PM, Austin English <austinenglish at gmail.com> wrote:
> On Fri, Apr 11, 2008 at 12:01 PM, pdsmith <wineforum-user at winehq.org> wrote:

<snip>

>
>  $ wine uninstaller
>
>  Will launch the uninstaller, but it doesn't always work too well, and
>  it's not a high priority to fix.

Should we perhaps reconsider that for 1.0?  Perhaps something worth
fixing during the freeze?

> If you want to remove all programs
>  and settings, you can do
>  $ rm -rf ~/.wine
>
>  To start fresh. It will be recreated whenever you run any wine program.
>
>



-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From austinenglish at gmail.com  Fri Apr 11 13:06:00 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 11 Apr 2008 13:06:00 -0500
Subject: [Wine] Uninstallation of Programs
In-Reply-To: <b050a5e70804111041k48e3d7bepeb55b83bdcd4b488@mail.gmail.com>
References: <1207933293.m2f.3286@forum.winehq.org>
	<b6bb06270804111009x43dff92bh472e2f1b9d6c8130@mail.gmail.com>
	<b050a5e70804111041k48e3d7bepeb55b83bdcd4b488@mail.gmail.com>
Message-ID: <b6bb06270804111106g585d3961m81bbfc76879fe60a@mail.gmail.com>

On Fri, Apr 11, 2008 at 12:41 PM, Zachary Goldberg <zgs at seas.upenn.edu> wrote:
> On Fri, Apr 11, 2008 at 1:09 PM, Austin English <austinenglish at gmail.com> wrote:
>  > On Fri, Apr 11, 2008 at 12:01 PM, pdsmith <wineforum-user at winehq.org> wrote:
>
>  <snip>
>
>
>  >
>  >  $ wine uninstaller
>  >
>  >  Will launch the uninstaller, but it doesn't always work too well, and
>  >  it's not a high priority to fix.
>
>  Should we perhaps reconsider that for 1.0?  Perhaps something worth
>  fixing during the freeze?
>
>
>
>  > If you want to remove all programs
>  >  and settings, you can do
>  >  $ rm -rf ~/.wine
>  >
>  >  To start fresh. It will be recreated whenever you run any wine program.
>  >
>  >
>
>
>
>  --
>  Zachary Goldberg
>  Computer Science & Engineering
>  Electrical Captain of Penn Electric Race Team
>  School of Engineering at the University of Pennsylvania
>

A) It's a bit late to add bugs to 1.0.0. Maybe 1.2.0
B) Uninstalling apps in wine isn't that important. A simple rm -rf
~/.wine does the same. I grant that it's difficult if you have a lot
of apps installed, but you could avoid this with using differing
wineprefixes.
C) There are many more important bugs to fix.


From juan.lang at gmail.com  Fri Apr 11 13:08:49 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 11 Apr 2008 11:08:49 -0700
Subject: [Wine] Uninstallation of Programs
In-Reply-To: <b6bb06270804111106g585d3961m81bbfc76879fe60a@mail.gmail.com>
References: <1207933293.m2f.3286@forum.winehq.org>
	<b6bb06270804111009x43dff92bh472e2f1b9d6c8130@mail.gmail.com>
	<b050a5e70804111041k48e3d7bepeb55b83bdcd4b488@mail.gmail.com>
	<b6bb06270804111106g585d3961m81bbfc76879fe60a@mail.gmail.com>
Message-ID: <3a768c550804111108r695b8673h19d13a4c840f2229@mail.gmail.com>

>  B) Uninstalling apps in wine isn't that important. A simple rm -rf
>  ~/.wine does the same.

Not entirely.  It doesn't remove desktop icons, menu entries, etc.
--Juan


From zgs at seas.upenn.edu  Fri Apr 11 13:11:05 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Fri, 11 Apr 2008 14:11:05 -0400
Subject: [Wine] Uninstallation of Programs
In-Reply-To: <3a768c550804111108r695b8673h19d13a4c840f2229@mail.gmail.com>
References: <1207933293.m2f.3286@forum.winehq.org>
	<b6bb06270804111009x43dff92bh472e2f1b9d6c8130@mail.gmail.com>
	<b050a5e70804111041k48e3d7bepeb55b83bdcd4b488@mail.gmail.com>
	<b6bb06270804111106g585d3961m81bbfc76879fe60a@mail.gmail.com>
	<3a768c550804111108r695b8673h19d13a4c840f2229@mail.gmail.com>
Message-ID: <b050a5e70804111111q5fa7443an55ed6cf11ea0c4b4@mail.gmail.com>

On Fri, Apr 11, 2008 at 2:08 PM, Juan Lang <juan.lang at gmail.com> wrote:
> >  B) Uninstalling apps in wine isn't that important. A simple rm -rf
>  >  ~/.wine does the same.
>
>  Not entirely.  It doesn't remove desktop icons, menu entries, etc.
>  --Juan
>

I agree that its certainly not necessary functionality wise, but to
what extend are we going for polish and shine for 1.0 as a whole
package, including bundled apps?  I feel like 1.0 is as good a time as
ever to try and make some of these things work.

-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From kacper.pluta at gmail.com  Fri Apr 11 13:11:05 2008
From: kacper.pluta at gmail.com (Kacper Pluta)
Date: Fri, 11 Apr 2008 20:11:05 +0200
Subject: Better sound support
Message-ID: <47FFA9B9.1010703@gmail.com>

Hey, do you plan on enabling handling of 24bit sound and sampling
frequencies 96000 or 192000? Lots of musicians using Linux need to use
VST and VSTi plugins (through FST and other methods). Unfortunately
quality of music you can acquire isn't realy high if you wish to use it
professionally. I'd also suggest correcting MIDI handling and
integrating wine with wineasio, which would enable using VST and VSTi on
a quite high level, as well as use other programmes.



From stefan at codeweavers.com  Fri Apr 11 10:35:21 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 11 Apr 2008 17:35:21 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804110822.21012.chris.kcat@gmail.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804111618.49900.stefan@codeweavers.com>
	<200804110822.21012.chris.kcat@gmail.com>
Message-ID: <200804111735.21536.stefan@codeweavers.com>

Am Freitag, 11. April 2008 17:22:20 schrieb Chris Robinson:
> In all cases, it should pick one and stick with it through the life of the
> process, for both D3D shaders and D3D fixed-function. Don't use atifs if
> ARB is available, don't use GLSL if nv-supplimented ARB is available, etc.
There are three issues that lead to this discussion:

*) We may want to mix shader backends. GLSL is a pain on MacOS at least on the 
vertex side, but it works okish on the fragment shader side. It may be 
helpful to compile a ARB vertex shader and a GLSL pixel shader. Also an ARB 
replacement may be faster there because the GLSL compiler on MacOS often 
creates slow code.

*) We have an NVTS and ATIFS replacement now, but no ARB or GLSL fragment 
processing code, and it would be cool if we can make use of the ATIFS code on 
newer cards as well. NVTS currently works because it is included in the 
baseshader/fixed function backend.

*) It's also about getting the design right in principle, and finding a design 
that doesn't need an entire rework when dx10 and geometry shaders are 
introduced.


From zgs at seas.upenn.edu  Fri Apr 11 13:15:50 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Fri, 11 Apr 2008 14:15:50 -0400
Subject: [Wine] Uninstallation of Programs
In-Reply-To: <3a768c550804111112w6aeee430h560765c07ab05b33@mail.gmail.com>
References: <1207933293.m2f.3286@forum.winehq.org>
	<b6bb06270804111009x43dff92bh472e2f1b9d6c8130@mail.gmail.com>
	<b050a5e70804111041k48e3d7bepeb55b83bdcd4b488@mail.gmail.com>
	<b6bb06270804111106g585d3961m81bbfc76879fe60a@mail.gmail.com>
	<3a768c550804111108r695b8673h19d13a4c840f2229@mail.gmail.com>
	<b050a5e70804111111q5fa7443an55ed6cf11ea0c4b4@mail.gmail.com>
	<3a768c550804111112w6aeee430h560765c07ab05b33@mail.gmail.com>
Message-ID: <b050a5e70804111115k26ddc247l2a742f43817709e1@mail.gmail.com>

On Fri, Apr 11, 2008 at 2:12 PM, Juan Lang <juan.lang at gmail.com> wrote:
> >  I agree that its certainly not necessary functionality wise, but to
>  >  what extend are we going for polish and shine for 1.0 as a whole
>  >  package, including bundled apps?  I feel like 1.0 is as good a time as
>  >  ever to try and make some of these things work.
>
>  I don't think patches will ever be refused outside the code freeze ;-)
>  --Juan
>

My current semester ends during the code freeze :/.  Perhaps post 1.0 though.

-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From pure_evil at mail.bg  Fri Apr 11 13:29:45 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Fri, 11 Apr 2008 21:29:45 +0300
Subject: [PATCH] winecfg => control panel applets patch
Message-ID: <200804112129.45779.pure_evil@mail.bg>

> However, since control panel does not utilize Unicode yet, the additionalb 
> Bulgarian translation matches the English one.

> So what's the point of that "translation" then? Right now it doesn't add 
> anything worthwhile but increases the patch size - not good.
Well, it was intended as a template and as a "forward compatibility" thing. 
(I know, it's REALLY annoying to have a stub mark the beginning of a 400 
lines+ of patch. ugh. don't know why that one came to be the first file... 
It's place is somewhere in-between the icons IMHO.)

> You probably increase the chance of your patch being accepted by leaving 
> out that not-really-a-translation. I'd recommend you submit that as a 
> patch at a later point of time. It probably also makes sense to properly 
> "unicodify" the control panel before supplying a language that needs it.

Control panel doesn't support Unicode, so I could've dropped all that language 
mumbo-jumbo alltogether - it indeed adds a lot of overhead and complexity to 
the entire thing. However, I wanted to provide a forward-compatible solution 
(and, Dan Kegel said straight: go for Unicode!), rather than coding 
for-the-moment. 
(which also explains the *not-so-optimal* way I handled the winecfg mod 
itself. Now I understand a new tab is to be added... and with a slight 
modification, a seventh applet will appear. (and it'll require less time to 
do than to draw the icon)

And really, introducing a new capability (home-grown applets), modifying 
winecfg -and- unicodifying control panel at the same time would've been a tad 
overkill. I was thinking of (should the control panel be accepted at all) 
unicodifying the control and providing the right translation for the applets 
in the next patch, in which case I'd be modifying only the pre-existing .rc 
rather than poking in the applet source.

/Then again, a few languages might not actually require Unicode for those 
texts, so, someone seeing that it's capable of being translated speaking the 
right language.../


From austinenglish at gmail.com  Fri Apr 11 13:16:40 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 11 Apr 2008 13:16:40 -0500
Subject: [Wine] Uninstallation of Programs
In-Reply-To: <3a768c550804111112w6aeee430h560765c07ab05b33@mail.gmail.com>
References: <1207933293.m2f.3286@forum.winehq.org>
	<b6bb06270804111009x43dff92bh472e2f1b9d6c8130@mail.gmail.com>
	<b050a5e70804111041k48e3d7bepeb55b83bdcd4b488@mail.gmail.com>
	<b6bb06270804111106g585d3961m81bbfc76879fe60a@mail.gmail.com>
	<3a768c550804111108r695b8673h19d13a4c840f2229@mail.gmail.com>
	<b050a5e70804111111q5fa7443an55ed6cf11ea0c4b4@mail.gmail.com>
	<3a768c550804111112w6aeee430h560765c07ab05b33@mail.gmail.com>
Message-ID: <b6bb06270804111116k29aaaa07j836394f915098d30@mail.gmail.com>

On Fri, Apr 11, 2008 at 1:12 PM, Juan Lang <juan.lang at gmail.com> wrote:
> >  I agree that its certainly not necessary functionality wise, but to
>  >  what extend are we going for polish and shine for 1.0 as a whole
>  >  package, including bundled apps?  I feel like 1.0 is as good a time as
>  >  ever to try and make some of these things work.
>
>  I don't think patches will ever be refused outside the code freeze ;-)
>  --Juan
>

Doesn't seem to be any uninstaller metabug/general bug, so I nominated
steam uninstall for 1.2:
http://bugs.winehq.org/show_bug.cgi?id=9114

That way at least one uninstaller is on the list, we can add more
later when/if needed.

Removing icons is already nominated ,see:
http://bugs.winehq.org/show_bug.cgi?id=10277


From mail at colinfinck.de  Fri Apr 11 08:25:48 2008
From: mail at colinfinck.de (Colin Finck)
Date: Fri, 11 Apr 2008 15:25:48 +0200
Subject: gdi32: Add a test to highlight the CreateCompatibleDC
	problemdescribed in bug #12493
In-Reply-To: <034101c89bd4$8274e4d0$a600fea9@DMITRY>
References: <003701c89bd3$a7144f70$652ad40a@colinhome>
	<034101c89bd4$8274e4d0$a600fea9@DMITRY>
Message-ID: <004201c89bd7$8e5ea3a0$652ad40a@colinhome>

Dmitry Timoshkov wrote:
> If the test fails in current Wine code you need to use todo_wine
> so that 'make test' still passes.

Ok, I submitted an updated patch:
http://www.winehq.org/pipermail/wine-patches/2008-April/053202.html

Best regards,

Colin Finck



From kacper.pluta at gmail.com  Fri Apr 11 12:07:56 2008
From: kacper.pluta at gmail.com (Kacper Pluta)
Date: Fri, 11 Apr 2008 19:07:56 +0200
Subject: Better sound support
Message-ID: <47FF9AEC.6060700@gmail.com>

Hey, do you plan on enabling handling of 24bit sound and sampling 
frequencies 96000 or 192000? Lots of musicians using Linux need to use 
VST and VSTi plugins (through FST and other methods). Unfortunately 
quality of music you can acquire isn't realy high if you wish to use it 
professionally. I'd also suggest correcting MIDI handling and 
integrating wine with wineasio, which would enable using VST and VSTi on 
a quite high level, as well as use other programmes.


From pure_evil at mail.bg  Fri Apr 11 13:50:01 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Fri, 11 Apr 2008 21:50:01 +0300
Subject: [PATCH] winecfg => control panel applets patch
Message-ID: <200804112150.01559.pure_evil@mail.bg>

Frank Richter wrote:

>On 10.04.2008 09:47, pure_evil at mail.bg wrote:
>  
>
>>However, since control panel does not utilize Unicode yet, the additionalb 
>>Bulgarian translation matches the English one.
>>    
>>
>  Even for non-Unicode apps you should have no problems with adding a 
> Bulgarian translation to a GUI app (when Bulgarian is selected as your 
> preferred language the active codepage will be chosen accordingly). 
> Maybe you used a wrong charset? You should use the Windows charset or 
> use #pragma (see 
>http://wiki.winehq.org/Developers-Hints?highlight=%28Developers%29#head-ef42a958e4f633dbd4a0ae42649fa02a4d1827fd 
>)

>Miko?aj Zalewski
Hmmm, I'll have to check up on that. The translations themselves are for the 
description/title that appears under the applet in the control panel. 
Once launched,(LANG=bg_BG) the winecfg translations take over and no problem 
there, just the unicode thing looks like rubbish under the icon. And, has 
twice as many characters as the text itself, which points to a problem within 
the control, rather than the codepage (?) - most probably, usage of ASCII 
rather than Unicode in control itself.

-ugh if this message also ends up as a new thread I'm gonna shoot KMail and 
try to get a decent program that doesn't f* up mail lists... suggestions?-


From chris.kcat at gmail.com  Fri Apr 11 13:41:57 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Fri, 11 Apr 2008 11:41:57 -0700
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804111735.21536.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804110822.21012.chris.kcat@gmail.com>
	<200804111735.21536.stefan@codeweavers.com>
Message-ID: <200804111141.58596.chris.kcat@gmail.com>

On Friday 11 April 2008 08:35:21 am Stefan D?singer wrote:
> *) We may want to mix shader backends. GLSL is a pain on MacOS at least on
> the vertex side, but it works okish on the fragment shader side. It may be
> helpful to compile a ARB vertex shader and a GLSL pixel shader. Also an ARB
> replacement may be faster there because the GLSL compiler on MacOS often
> creates slow code.

As far as I can see, OSX's broken drivers are the only reason you'd not want 
to use GLSL when nothing else of better capability is available. For that 
case, there's two options: for nVidia users, extend ARB shaders with nv 
programs and use them (likely suprassing GLSL performance), and for other 
cards, bug Apple for proper drivers. IMHO, I don't think WineD3D should be 
that hindered and cause WineD3D issues with other vendors because Apple 
insists on making drivers themselves, and doing a poor job at it.

> *) We have an NVTS and ATIFS replacement now, but no ARB or GLSL fragment
> processing code, and it would be cool if we can make use of the ATIFS code
> on newer cards as well. NVTS currently works because it is included in the
> baseshader/fixed function backend.

Why would it be cool to use ATIFS on newer cards? It'd be cool if we had 
something lean, sleek, and working. Mixing output shader modes is just asking 
for problems, IMO.

> *) It's also about getting the design right in principle, and finding a
> design that doesn't need an entire rework when dx10 and geometry shaders
> are introduced.

As it is, I imagine WineD3D will need to be reworked for D3D10 no matter what 
we do here. Unless someone has a working design plan for what changes are 
needed by D3D10 for WineD3D, we're ultimately just guessing about what may 
work best (not to mention it'll be using GL3 instead of the current stuff, so 
whatever's picked may not even be efficient API-wise for it).


From mikolaj at zalewski.pl  Fri Apr 11 13:43:27 2008
From: mikolaj at zalewski.pl (=?UTF-8?B?TWlrb8WCYWogWmFsZXdza2k=?=)
Date: Fri, 11 Apr 2008 20:43:27 +0200
Subject: [PATCH] winecfg => control panel applets patch
In-Reply-To: <200804112150.01559.pure_evil@mail.bg>
References: <200804112150.01559.pure_evil@mail.bg>
Message-ID: <47FFB14F.7010208@zalewski.pl>


>Hmmm, I'll have to check up on that. The translations themselves are for the 
>description/title that appears under the applet in the control panel. 
>Once launched,(LANG=bg_BG) the winecfg translations take over and no problem 
>there, just the unicode thing looks like rubbish under the icon. And, has 
>twice as many characters as the text itself, which points to a problem within 
>the control, rather than the codepage (?) - most probably, usage of ASCII 
>rather than Unicode in control itself.
>  
>
  If there are twice as many characters in the text as there should be 
then you have probably encoded the file in UTF-8. Try to add '#pragma 
code_page(65001)' at the top and '#pragma code_page(default)' at the 
bottom of Bg.rc. By default wrc expects the string to be in the Windows 
codepage for the specified language.

Miko?aj Zalewski


From juan.lang at gmail.com  Fri Apr 11 13:12:33 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 11 Apr 2008 11:12:33 -0700
Subject: [Wine] Uninstallation of Programs
In-Reply-To: <b050a5e70804111111q5fa7443an55ed6cf11ea0c4b4@mail.gmail.com>
References: <1207933293.m2f.3286@forum.winehq.org>
	<b6bb06270804111009x43dff92bh472e2f1b9d6c8130@mail.gmail.com>
	<b050a5e70804111041k48e3d7bepeb55b83bdcd4b488@mail.gmail.com>
	<b6bb06270804111106g585d3961m81bbfc76879fe60a@mail.gmail.com>
	<3a768c550804111108r695b8673h19d13a4c840f2229@mail.gmail.com>
	<b050a5e70804111111q5fa7443an55ed6cf11ea0c4b4@mail.gmail.com>
Message-ID: <3a768c550804111112w6aeee430h560765c07ab05b33@mail.gmail.com>

>  I agree that its certainly not necessary functionality wise, but to
>  what extend are we going for polish and shine for 1.0 as a whole
>  package, including bundled apps?  I feel like 1.0 is as good a time as
>  ever to try and make some of these things work.

I don't think patches will ever be refused outside the code freeze ;-)
--Juan


From hverbeet at gmail.com  Fri Apr 11 15:42:17 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Fri, 11 Apr 2008 22:42:17 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804111618.49900.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804110959.56731.stefan@codeweavers.com>
	<d658b69e0804110139n5182168bk54498b4e2ba02a7e@mail.gmail.com>
	<200804111618.49900.stefan@codeweavers.com>
Message-ID: <d658b69e0804111342t214f49b1t5faea9081e8b70b8@mail.gmail.com>

On 11/04/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
>  1) The state table should be selectable based on the available opengl features
>  and possibly registry settings. I think we all agree on that
>
Up to the level of being able to use different state handlers in
different situations. I don't necessarily agree with copying and
swapping the entire table in one piece.

>  2) We want a fixed function vertex and fragment pipeline replacement with ARB
>  and GLSL
>
Only GLSL is a requirement for me. ARB could be nice, but is probably redundant.

>  3) We want to be able to support pixel shaders with atifs and nvts. I don't
>  know if that will ever be implemented, but if we choose a design that makes
>  this hard or impossible that's not going to help
>
This is not a hard requirement for me, although I certainly think we
should be able to create a design that allows for this.

>  4) Even if we have an ARB/GLSL replacement, it should be possible to use D3D
>  shaders but still use the opengl fixed function pipeline
>
Agreed.

>  5) A nice to have is to be able to use the replacement pipelines together with
>  shaders, but that is not a hard requirement for me. We need an ARB and GLSL
>  replacement anyway.
>
I assume you mean atifs & nvrc specifically here, in which case this
is probably a bit more important than "nice to have". The most tricky
situation to support here will be cards that support vertex shaders,
but not fragment shaders. If we want to support pixel shaders using
atifs / nvrc we have to allow mixing GLSL / ARB with nvrc / atifs for
it to be of any use.


>  I understand Henri's suggestion this way: Don't put the state table into the
>  shader backend(*), but select it separately. This way the ATIFS pipeline
>  replacement doesn't have to be a shader model. That way we can choose the ARB
>  shader backend and ATIFS state table on r200 cards, and use GLSL and ATIFS on
>  newer cards.
>
>  That way we get full shader support and still the advantages of the pipeline
>  replacement without using 3 inherited shader backends. Then the state table
>  could have some backend to enable / disable ATIFS like in this patch. (The
>  bottom line of the patch here is that we should enable the extension we
>  *use*, and not what happens to be available).
>
>  The state table would report the fixed function caps it has, and the shader
>  backend reports the programmable pipeline caps. GetDeviceCaps has to collect
>  the caps from multiple places, but that isn't an issue IMO.
>
>  Is that correct, or did I missunderstand something?
>
My main point is that a fixed function replacement and the shader
backend should be two different things, at least interface wise. My
suggestion for an implementation would be somethingg like this:

  - Split the state table in three pieces: vertex processing states
(eg. lighting, materials, etc), fragment processing states (eg.
texture stage stuff) and other states (eg. blending states). Aside
from being clearer this allows you to swap these parts out
independently from each other and possibly skip applying them as a
whole in case a shader is active for that part of the pipeline (I
imagine this could have some performance advantages as well, although
I'm not sure how much).
  - Allow the state table more explicitly to have some state of its
own. It currently has the list of dirty states of course, but it's
more managed by the device than by the statetable as such. In effect
this would introduce a state management object.

The basic setup would be something like this:

struct shader_backend_t
{
    void (*shader_select)(void *data, BOOL usePS, BOOL useVS);
    void (*shader_load_constants)(void *data, char usePS, char useVS);
    ...
};

struct state_management_t
{
    void (*mark_state_dirty)(void *data, DWORD state);
    void (*apply_states)(void *data);
    ...
};

struct IWineD3DDeviceImpl {
    ...
    struct state_management_t vertex_state_manager;
    struct state_management_t fragment_state_manager;
    struct state_management_t other_state_manager;
    struct shader_backend_t shader_backend;

    void *vertex_private_data;
    void *fragment_private_data;
    void *other_private_data;
    void *shader_private_data;
    ...
};

/* Usage */
device->vertex_state_manager->mark_state_dirty(device->vertex_private_data,
state);
device->fragment_state_manager->mark_state_dirty(device->fragment_private_data,
state);
etc.
...
if (!use_vs) {
	device->vertex_state_manager->apply_states(device->vertex_private_data);
}
if (!use_ps) {
	device->fragment_state_manager->apply_states(device->fragment_private_data);
}
device->shader_backend->select_shader(device->shader_private_date,
use_vs, use_ps);


Some example configurations:

GLSL FFP, GLSL shaders
	device = {glsl_vsm, glsl_fsm, ff_osm, glsl_shader_backend,
glsl_private_data, glsl_private_data, ff_private_data,
glsl_private_data};

Fixed function vertex, ATIFS fragment processing, GLSL shader backend
	device = {ff_vsm, atifs_fsm, ff_osm, glsl_shader_backend,
ff_private_data, atifs_private_data, ff_private_data,
glsl_private_data};

ARB vertex FFP, Fixed function fragment, ARB shaders
	device = arb_vsm, ff_fsm, ff_osm, arb_shader_backend,
arb_ffp_private_data, ff_private_data, ff_private_data,
arb_shader_private_data};

This doesn't support mixing eg. ARB vertex shaders with NVRC pixel
shaders, but it would "simply" be a matter of splitting up the shader
backend in a similar way to the state table. Important to note here is
that the private data could be shared between fixed function
replacements and the shader backend, like in the case of GLSL. I could
imagine using a structure more similar to state_management_t for the
shader backend as well.

Of course there are a number of variations you can make on this
(perhaps most notably storing the call tables and private data in the
same struct), but I think the important parts are the split between
vertex/fragment/other/shader, and the state management having private
data.

>  However, I see two issues with that:
>
>  *) In which place do we decide which program/shader to use in the end? If we
>  have an ARB fixed function replacement program and an ARB program generated
>  from a D3D shader? Currently this happens to work because ARB/GLSL override
>  NVTS and NVRC, but this fails if we have a shader and ffp implementation
>  using the same extension
>
The private data between the FFP replacement and the shader backend
can be shared. That means our general GLSL management stuff can see
you've got eg. a FFP vertex shader and a pixel shader and link them
together.

>  *) What do we do if a shader implementation wants to overwrite some states for
>  its programmable pipeline work? For example take my GLSL clipplane patch: The
>  ARB shader backend disables clipplanes when a shader is used. This example is
>  about a driver bug, but there are others as well: ATIFS and NVTS with a pixel
>  shader implementation will have to override a part of the sampler setting(the
>  stuff that is currently done in activate_dimensions)
>
>  How would you deal with this?
>
I guess this will mostly be an issue for states that end up being in
the "other" category. In general I think that as long as it's only for
a couple of states we can just keep doing more or less what we
currently do and check if the relevant state management backend is
used.


From spedrosa at gmail.com  Fri Apr 11 15:44:32 2008
From: spedrosa at gmail.com (Stephen Eilert)
Date: Fri, 11 Apr 2008 17:44:32 -0300
Subject: Better sound support
In-Reply-To: <47FFA9B9.1010703@gmail.com>
References: <47FFA9B9.1010703@gmail.com>
Message-ID: <47FFCDB0.5050209@gmail.com>

Kacper Pluta wrote:
> Hey, do you plan on enabling handling of 24bit sound and sampling
> frequencies 96000 or 192000? Lots of musicians using Linux need to use
> VST and VSTi plugins (through FST and other methods). Unfortunately
> quality of music you can acquire isn't realy high if you wish to use it
> professionally. I'd also suggest correcting MIDI handling and
> integrating wine with wineasio, which would enable using VST and VSTi on
> a quite high level, as well as use other programmes.
>
>
>
>   
I'd suggest creating a bug report in bugs.winehq.org, detailing the 
broken applications and/or plugins while you wait for a developer answer.


Stephen


From msclrhd at googlemail.com  Fri Apr 11 17:22:36 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Fri, 11 Apr 2008 23:22:36 +0100
Subject: Wine running (not so) random applications (with a few bugs)...
Message-ID: <3f4fd2640804111522hd90189nff24318252b2f59@mail.gmail.com>

Several releases back, I tried getting the Cepstral SwiftTalker
Text-To-Speech program working, but to no avail. I tried again last
night and was surprised that it worked! So I decided to throw several
applications at Wine out of the box, with no modifications and see how
well it did.

These are my findings:


== Firefox 3 (Beta 4)

I have basically reproduced Dan Kegel's findings (including bugs 12305
and 1237). I also successfully upgraded from beta 4 to 5 and ran in
both XP and Vista modes. Other things I noticed:

  * firefox dialogs (e.g. the "Default Browser" dialog) are cropped at
the bottom, cutting off the buttons (bug 12511).

Verdict: Very close to perfect. Usable for most things with a few
minor annoyances.


== Cepstral SwiftTalker (http://downloads.cepstral.com/downloads/)

This is a text-to-speech program that I use constantly. It now works
under Wine - yay! Using an unregistered voice, voice rendering is
smooth and sentence reading highlighting is synchronised perfectly,
even at 374 words per minute!

Issues:

  * Ctrl+Home and Ctrl+End don't work as on Windows (go to the
start/end of the document). This is the same in notepad (bug 12512).

  * Changing the voice speed also changes the font to Courier New
Italic. It looks like the SwiftTalker application is using Courier New
initially (and rendering correctly on startup), but when you edit the
Tools->Options, it does not find Courier New in the available fonts
(bug 12513).

  * There is a slight audio glitch when using a registered voice that
is noticeable either as a pop or as an overlapped playback with the
previous word whenever there is a sentence changeover. This is hardly
noticable on the default 170 WPM, but is more pronounced on my default
247 WPM setting.

Verdict: Near perfect. The audio glitch can get irritating at times
and is the only thing preventing me giving this a Perfect verdict.


== Popcap Games

There can't be an application test list without mentioning games, so
here we are. The games tested were:
  * Peggle (http://popcap.com/games/peggle)
  * Bejeweled 2 (http://popcap.com/games/bejeweled2)

The games run smoothly, including sound, full screen graphics and
custom cursors.

Issues:

  * The installer fails to create Uhttp://mail.google.com/mail/RL
links (e.g. http://www.popcap.com)

  * Selecting hardware acceleration from within Peggle causes the game
to render a black screen.

Verdict: Perfect.


== Yahoo Games (http://games.yahoo.com/downloads)

Even more games, e.g. Aveyond.

Issues:

  * Could not get past the initial page as the gecko HTML engine
failed to install resulting in the "HTML rendering is currently
disabled" text appearing. This is a regression, as it worked in older
versions of Wine. NOTE: I haven't done a bisect yet.

Verdict: Non-starter.


Thanks for all the great work. Wine keeps on improving release on
release and continues to amaze me. Special thanks to the CodeWeavers
team and the DirectX developers for all the hard work gone into making
Wine what it is today.

- Reece


From stefan at codeweavers.com  Fri Apr 11 17:57:57 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 12 Apr 2008 00:57:57 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <d658b69e0804111342t214f49b1t5faea9081e8b70b8@mail.gmail.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804111618.49900.stefan@codeweavers.com>
	<d658b69e0804111342t214f49b1t5faea9081e8b70b8@mail.gmail.com>
Message-ID: <200804120057.57495.stefan@codeweavers.com>

Am Freitag, 11. April 2008 22:42:17 schrieb H. Verbeet:

I did not yet read it in depth, so I am just replying to a few concerns I 
spotted. I'll look at it more in-depth tomorrow.

> >  1) The state table should be selectable based on the available opengl
> > features and possibly registry settings. I think we all agree on that
>
> Up to the level of being able to use different state handlers in
> different situations. I don't necessarily agree with copying and
> swapping the entire table in one piece.
Agreed, we just want to be able to swap states, in which way is open.

> >  2) We want a fixed function vertex and fragment pipeline replacement
> > with ARB and GLSL
>
> Only GLSL is a requirement for me. ARB could be nice, but is probably
> redundant.
Intel cards? Also GLSL has the problem with the link times.

> >  5) A nice to have is to be able to use the replacement pipelines
> > together with shaders, but that is not a hard requirement for me. We need
> > an ARB and GLSL replacement anyway.
>
> I assume you mean atifs & nvrc specifically here, in which case this
> is probably a bit more important than "nice to have". The most tricky
> situation to support here will be cards that support vertex shaders,
> but not fragment shaders. If we want to support pixel shaders using
> atifs / nvrc we have to allow mixing GLSL / ARB with nvrc / atifs for
> it to be of any use.
The current implementation allows that, we're using ATIFS+ARBVP

>  Aside
> from being clearer this allows you to swap these parts out
> independently from each other and possibly skip applying them as a
> whole in case a shader is active for that part of the pipeline (I
> imagine this could have some performance advantages as well, although
> I'm not sure how much).
For the performance, it depends on the app. If we skip applying (redundant) 
fixed function settings when a shader is used, we have to reapply all of them 
the shader use might have changed when the shader is deactivated. It's a 
decision between making shader on-off switches cheap vs filtering out 
redundant state changes done by the app. Currently there is no additional 
fixed function pipeline cost involved when using shaders as long as the app 
doesn't touch the ffp states.

> struct IWineD3DDeviceImpl {
>     ...
>     struct state_management_t vertex_state_manager;
>     struct state_management_t fragment_state_manager;
>     struct state_management_t other_state_manager;
>     struct shader_backend_t shader_backend;
>
>     void *vertex_private_data;
>     void *fragment_private_data;
>     void *other_private_data;
>     void *shader_private_data;
>     ...
> };
One of the reasons for using a single state table was that we have 
interconnections between the vertex states, fragment states and other states. 
For example, where would you put the vertex buffer loading? Is that 
an "other" state, or a vertex state? The FVF and the vertex shader influence 
if we're entering the FF or shader vertex processing codepaths. The FVF 
affects fogging, which is a vertex state in some shader implementations(nvts, 
atifs), but implemented in pixel shaders in GLSL and ARB. The texture 
transform flags are a fixed function vertex state on paper, but we have to 
compile the D3DTTFF_PROJECTED flag into the fragment shader. (we already do 
so, that's documented on the msdn, so clearly a missdesign on Microsoft's 
side). There are many more examples of vertex-fragment-other state 
interconnections.

> This doesn't support mixing eg. ARB vertex shaders with NVRC pixel
> shaders, but it would "simply" be a matter of splitting up the shader
> backend in a similar way to the state table. Important to note here is
> that the private data could be shared between fixed function
> replacements and the shader backend, like in the case of GLSL. I could
> imagine using a structure more similar to state_management_t for the
> shader backend as well.
The unsplit shader backend is the current d3d shader implementation + Ivan's 
pipeline linker object. If you split them up, where do you set GLSL shader 
constants?

Also note that the GLSL pixel shaders depend on the type of vertex 
processing(non-GLSL or GLSL) to load the 3.0 varyings correctly. We could get 
rid of that by requiring GLSL vp, but that would break requirement 4, using 
the GL fixed function pipeline.

My concern is that if you split vertex processing and fragment processing up, 
you need a linker object that deals with linking. This linker object has know 
about the vertex and fragment processing state handlers and tables, thus 
creating a special linker for each vs-ps-vff-ffp-other combination. I don't 
have any objections against that in principle, but I am afraid that due to 
the high interconnection between vertex, fragment and other states we would 
end up with implementing most things in the linker.


From bmschwar at fas.harvard.edu  Fri Apr 11 17:59:29 2008
From: bmschwar at fas.harvard.edu (Benjamin M. Schwartz)
Date: Fri, 11 Apr 2008 18:59:29 -0400
Subject: Wine on OLPC
Message-ID: <47FFED51.30608@fas.harvard.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dear Wine developers,
I am attempting to package Wine for OLPC.  My goal is to enable packaging
individual windows programs into OLPC "Activity bundles" with wine.  I
have encountered a handful of problems along the way.  One of them is bug
#12507, for which I have sent a patch.  A few others are:

1. Decorations on the Desktop window.
I am running in Desktop mode, because this provides the best integration
with the OLPC operating system.  However, the desktop window has
decorations on it, which I do not want.  I want the desktop to be a
fullscreen window.  It seems that recent patches to x11drv may make this
possible, but I could find no way in 0.9.59.

What should I do to run the Desktop as a full-screen window, or as a
normal window without decorations?

2. Non-ownership of .wine/
The OLPC security system is designed to run each program under a different
unix uid, as a form of lightweight sandboxing.  My system is set up to
create a .wine/ directory the first time the program is run.  The second
time the application is run, it doesn't work because the .wine directory
is owned b a different user, so I get "path/.wine is not owned by you".  I
have tried doing "chmod a+rwx" to .wine/ on the first run, but Wine still
refuses to run, even though it has full access, because it's not the owner.

Would you consider patches to exchange the uid check for a rwx access check?

Thank you,
Ben
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.7 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFH/+1RUJT6e6HFtqQRAs0RAJ9o1HzIsoCMLUPCC1GJKnOJikIBtACgiLBH
uy8KO8KlGm4/ZD+7jXcQrrg=
=mi64
-----END PGP SIGNATURE-----


From truiken at gmail.com  Fri Apr 11 18:07:23 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 11 Apr 2008 18:07:23 -0500
Subject: Wine on OLPC
In-Reply-To: <47FFED51.30608@fas.harvard.edu>
References: <47FFED51.30608@fas.harvard.edu>
Message-ID: <22821af30804111607g283f398cg914e4461ba06c70d@mail.gmail.com>

On Fri, Apr 11, 2008 at 5:59 PM, Benjamin M. Schwartz
<bmschwar at fas.harvard.edu> wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
>  Hash: SHA1
>
>  Dear Wine developers,
>  I am attempting to package Wine for OLPC.  My goal is to enable packaging
>  individual windows programs into OLPC "Activity bundles" with wine.  I
>  have encountered a handful of problems along the way.  One of them is bug
>  #12507, for which I have sent a patch.  A few others are:
>
>  1. Decorations on the Desktop window.
>  I am running in Desktop mode, because this provides the best integration
>  with the OLPC operating system.  However, the desktop window has
>  decorations on it, which I do not want.  I want the desktop to be a
>  fullscreen window.  It seems that recent patches to x11drv may make this
>  possible, but I could find no way in 0.9.59.
>
>  What should I do to run the Desktop as a full-screen window, or as a
>  normal window without decorations?
>
>  2. Non-ownership of .wine/
>  The OLPC security system is designed to run each program under a different
>  unix uid, as a form of lightweight sandboxing.  My system is set up to
>  create a .wine/ directory the first time the program is run.  The second
>  time the application is run, it doesn't work because the .wine directory
>  is owned b a different user, so I get "path/.wine is not owned by you".  I
>  have tried doing "chmod a+rwx" to .wine/ on the first run, but Wine still
>  refuses to run, even though it has full access, because it's not the owner.
>
>  Would you consider patches to exchange the uid check for a rwx access check?
>

No, that check was added to keep users from running Wine as root.

-- 
James Hawkins


From bmschwar at fas.harvard.edu  Fri Apr 11 18:11:33 2008
From: bmschwar at fas.harvard.edu (Benjamin M. Schwartz)
Date: Fri, 11 Apr 2008 19:11:33 -0400
Subject: Wine on OLPC
In-Reply-To: <22821af30804111607g283f398cg914e4461ba06c70d@mail.gmail.com>
References: <47FFED51.30608@fas.harvard.edu>
	<22821af30804111607g283f398cg914e4461ba06c70d@mail.gmail.com>
Message-ID: <47FFF025.1070405@fas.harvard.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

James Hawkins wrote:
| On Fri, Apr 11, 2008 at 5:59 PM, Benjamin M. Schwartz
|>  Would you consider patches to exchange the uid check for a rwx access
check?
| No, that check was added to keep users from running Wine as root.

Then why not prevent users from running Wine as root?  This does not
prevent that.

- --Ben

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.7 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFH//AlUJT6e6HFtqQRAnGPAKCAwosTbtenZNqiufqhirJ55D6s2wCghD2P
wQSesLf3GT8XO6M/s+Qb/+k=
=9RI/
-----END PGP SIGNATURE-----


From thestig at google.com  Fri Apr 11 18:13:06 2008
From: thestig at google.com (Lei Zhang)
Date: Fri, 11 Apr 2008 16:13:06 -0700
Subject: New Valgrind errors in user32
In-Reply-To: <a71bd89a0804101800k6b1a306ay45b285875de07fd4@mail.gmail.com>
References: <a71bd89a0804101800k6b1a306ay45b285875de07fd4@mail.gmail.com>
Message-ID: <558b2f5c0804111613j4cfb9e3aic72658463b78feee@mail.gmail.com>

On Thu, Apr 10, 2008 at 6:00 PM, Dan Kegel <dank at kegel.com> wrote:
> Hey Lei,
>  this morning's git brought one new valgrind error, and it happens to
>  be in a file you touched in the last day or so:
>  + Conditional jump or move depends on uninitialised value(s)
>  +    at  EDIT_BuildLineDefs_ML (edit.c:1280)
>  +    by  EDIT_EM_ReplaceSel (edit.c:3260)
>  +    by  EDIT_WM_Char (edit.c:4035)
>  +    by  EditWndProc_common (edit.c:859)
>  +    by  EditWndProcA (edit.c:1103)
>  +    by  (within /home/dank/wine-git/dlls/user32/user32.dll.so)
>  +    by  call_window_proc (winproc.c:457)
>  +    by  WINPROC_call_window (winproc.c:2207)
>  +    by  call_window_proc (message.c:1616)
>  +    by  send_message (message.c:2438)
>  +    by  SendMessageA (message.c:2583)
>  +    by  test_enter (edit.c:1654)
>  +    by  func_edit (edit.c:1977)
>  +    by  run_test (test.h:406)
>  +    by  main (test.h:455)
>
>  Could you have a look?
>
>  See
>  http://kegel.com/wine/valgrind/logs-2008-04-10/vg-user32_edit-diff.txt
>  http://kegel.com/wine/valgrind/logs-2008-04-10/vg-user32_edit.txt
>
>  Thanks,
>  Dan
>

Sure, I can take a look. I think it occurred mainly because our tests
exercise more of the code base now.


From stefandoesinger at gmx.at  Fri Apr 11 18:18:56 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 12 Apr 2008 01:18:56 +0200
Subject: Better sound support
In-Reply-To: <47FFCDB0.5050209@gmail.com>
References: <47FFA9B9.1010703@gmail.com> <47FFCDB0.5050209@gmail.com>
Message-ID: <200804120118.57042.stefandoesinger@gmx.at>

Am Freitag, 11. April 2008 22:44:32 schrieb Stephen Eilert:
> Kacper Pluta wrote:
> > Hey, do you plan on enabling handling of 24bit sound and sampling
> > frequencies 96000 or 192000? Lots of musicians using Linux need to use
> > VST and VSTi plugins (through FST and other methods). Unfortunately
> > quality of music you can acquire isn't realy high if you wish to use it
> > professionally. I'd also suggest correcting MIDI handling and
> > integrating wine with wineasio, which would enable using VST and VSTi on
> > a quite high level, as well as use other programmes.
>
> I'd suggest creating a bug report in bugs.winehq.org, detailing the
> broken applications and/or plugins while you wait for a developer answer.
My alternative suggestion is to look at that himself ;-) . Posting wishlists 
usually doesn't help with open source projects, but filing *good* bug reports 
or personally working on the issue or funding someone to work on it does.


From luis.busquets at ilidium.com  Fri Apr 11 18:20:38 2008
From: luis.busquets at ilidium.com (Luis Busquets)
Date: Sat, 12 Apr 2008 01:20:38 +0200
Subject: Several patches for D3DX
Message-ID: <47FFF246.4090003@ilidium.com>

Is there still any problem with each of the attached patches or are they 
going to be committed?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 3f4ea1b791c5792f4225493d7e3ff2d8c25f385d.diff
Type: text/x-patch
Size: 2591 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080412/505d157d/attachment-0003.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 25ffebe8877fd886c61ce3ebc8534255f0627bc4.diff
Type: text/x-patch
Size: 6951 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080412/505d157d/attachment-0004.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: f715cf4f1241acf214d1098ca295833c9af4276e.diff
Type: text/x-patch
Size: 6200 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080412/505d157d/attachment-0005.bin 

From truiken at gmail.com  Fri Apr 11 18:22:02 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 11 Apr 2008 18:22:02 -0500
Subject: Wine on OLPC
In-Reply-To: <47FFF025.1070405@fas.harvard.edu>
References: <47FFED51.30608@fas.harvard.edu>
	<22821af30804111607g283f398cg914e4461ba06c70d@mail.gmail.com>
	<47FFF025.1070405@fas.harvard.edu>
Message-ID: <22821af30804111622o5313a0adu74f68daa564597a8@mail.gmail.com>

On Fri, Apr 11, 2008 at 6:11 PM, Benjamin M. Schwartz
<bmschwar at fas.harvard.edu> wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
>  Hash: SHA1
>
>  James Hawkins wrote:
>  | On Fri, Apr 11, 2008 at 5:59 PM, Benjamin M. Schwartz
>  |>  Would you consider patches to exchange the uid check for a rwx access
>  check?
>  | No, that check was added to keep users from running Wine as root.
>
>  Then why not prevent users from running Wine as root?  This does not
>  prevent that.
>

It prevents this case:

$ sudo wine app.exe

and we've already decided that we're not going to outright prevent
users from running wine as root.  There are certain circumstances
where it's required.

-- 
James Hawkins


From truiken at gmail.com  Fri Apr 11 18:27:53 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 11 Apr 2008 18:27:53 -0500
Subject: Several patches for D3DX
In-Reply-To: <47FFF246.4090003@ilidium.com>
References: <47FFF246.4090003@ilidium.com>
Message-ID: <22821af30804111627ha04dbdfqac2c115e9f473c01@mail.gmail.com>

On Fri, Apr 11, 2008 at 6:20 PM, Luis Busquets
<luis.busquets at ilidium.com> wrote:
> Is there still any problem with each of the attached patches or are they
> going to be committed?
>

+WINAPI DWORD D3DXGetShaderVersion(CONST DWORD *pFunction)
+{
+    DWORD ver;
+    if (!pFunction)
+     {
+      return 0;
+      }
+    /* The first DWORD of the stream is the version Token */
+   ver=*pFunction;
+   return ver;
+}

I can't attest to any of the rest, but the style in this function is
horrendous.  Your spacing is all over the place.  Also, correctness of
this function aside, the function can be written so much simpler as:

WINAPI DWORD D3DXGetShaderVersion(CONST DWORD *pFunction)
{
    return (pFunction) ? *pFunction : 0;
}

-- 
James Hawkins


From stefan at codeweavers.com  Fri Apr 11 18:41:06 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 12 Apr 2008 01:41:06 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804111141.58596.chris.kcat@gmail.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804111735.21536.stefan@codeweavers.com>
	<200804111141.58596.chris.kcat@gmail.com>
Message-ID: <200804120141.06956.stefan@codeweavers.com>

Am Freitag, 11. April 2008 20:41:57 schrieb Chris Robinson:
> As far as I can see, OSX's broken drivers are the only reason you'd not
> want to use GLSL when nothing else of better capability is available. For
> that case, there's two options: for nVidia users, extend ARB shaders with
> nv programs and use them (likely suprassing GLSL performance), and for
> other cards, bug Apple for proper drivers. IMHO, I don't think WineD3D
> should be that hindered and cause WineD3D issues with other vendors because
> Apple insists on making drivers themselves, and doing a poor job at it.
I don't know who exactly writes the Apple drivers, but the Mac drivers have a 
few identical issues as the Linux ATI driver.

We have to face that driver bugs are reality. I think we are having more 
issues in form of user complaints due to the driver<->wined3d connection than 
the wined3d<->application one. I doubt Apple is going to fix their vertex 
shader bugs anytime soon. They come up weekly or monthly on their development 
lists, no official statement yet.

> Why would it be cool to use ATIFS on newer cards? It'd be cool if we had
> something lean, sleek, and working. Mixing output shader modes is just
> asking for problems, IMO.
For one part it is helpful for testing, and it is a temporary solution until 
we have an ARB and GLSL pipeline replacement(post 1.0 most likely)

> As it is, I imagine WineD3D will need to be reworked for D3D10 no matter
> what we do here. Unless someone has a working design plan for what changes
> are needed by D3D10 for WineD3D, we're ultimately just guessing about what
> may work best (not to mention it'll be using GL3 instead of the current
> stuff, so whatever's picked may not even be efficient API-wise for it).
I have a rough design plan

-> Replace the current d3d9 shader language with an intermediate language 
generated by the shader compiler and assembler library I am working on(see 
the other thread). d3d9 will feed a d3d9 shader into that lib and get a 
parsed shader back that it passes to wined3d, d3d10 works similarly.

-> Extending pixel shader and vertex shader support to 4.0 is fairly easy with 
whatever design we choose. Just extend the existing code.

-> Adding geometry shaders should work with the one-in-all shader backend. Add 
geometry shaders next to pixel and vertex and link all 3 together. I don't 
know the details with Henri's suggestion, but I think we'd just add an extra 
geometry state handler and extend the shader backend(or add a new shader 
backend if we split things up)

-> OpenGL 3.0 needs the finalized GL 3 spec. If GLSL is unmodified(I think 
so), we can just reuse the existing GLSL shader backend. Otherwise we have to 
create a new one, and depending on how similar they are maintain it as a 
separate backend or overwrite a few parts via inheritance.

-> The non-shader parts of GL3 need a separation of the management code and GL 
specific code. For the state setters, we either need an entirely different 
set of state setters, or we can reuse a fully-GLSLed pipeline implementation. 
For textures, surfaces, buffers, devices we can move the management code into 
a base class and inherit a GL2 and GL3 class, similarly to 
BaseSurface-D3DSurface-GDISurface

-> A major API rewrite in D3D10 is the new resource model. Basically we have 
to make IndexBuffers, VertexBuffers and Surfaces general "Buffers". IB and VB 
can be just replaced by the buffer d3d <= 9 wise, for surfaces we have to 
create a derived class where we add D3D <= 9 surface specific methods like 
Blt, the Container texture, Palettes, etc. Textures should be replaced with 
the more flexible ShaderResourceView objects. (I don't know if one buffer can 
be used in more than one resource view object. If yes than that might be an 
issue, as it means that a surface can be part of many textures e.g. as a mip 
level)

-> Vertex declarations? They are some shader resource view as well now, I have 
to look at them more in detail. Maybe we can just reuse them unmodified.

-> Pixel formats: We need tests to find out what the d3d10 formats need, but 
basically replace the WINED3DFORMAT enum with a d3d10-like one and add 
private values for d3d <= 9 formats missing in d3d10 like P8, X4R4G4B4. The 
DXGI_FORMATs are nicer than the D3D9 ones IMO.

-> One open issue: Where do we implement srgb reading switching? In WineD3D or 
D3D9?

There will surely be more open issues, this is just a rough plan.


From wine-devel at kievinfo.com  Fri Apr 11 18:53:51 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Fri, 11 Apr 2008 17:53:51 -0600
Subject: Please add wine-0.9.59 to bugzilla
In-Reply-To: <47FE6FF1.30002@kievinfo.com>
References: <47FE6FF1.30002@kievinfo.com>
Message-ID: <47FFFA0F.70604@kievinfo.com>

Vitaliy Margolen wrote:
> Could someone add the newest Wine version to buzilla?
> 
> Vitaliy.
> 
> 
Any one alive from bugzilla admins?

Vitaliy.


From bmschwar at fas.harvard.edu  Fri Apr 11 19:45:20 2008
From: bmschwar at fas.harvard.edu (Benjamin M. Schwartz)
Date: Fri, 11 Apr 2008 20:45:20 -0400
Subject: Wine on OLPC
In-Reply-To: <22821af30804111622o5313a0adu74f68daa564597a8@mail.gmail.com>
References: <47FFED51.30608@fas.harvard.edu>	<22821af30804111607g283f398cg914e4461ba06c70d@mail.gmail.com>	<47FFF025.1070405@fas.harvard.edu>
	<22821af30804111622o5313a0adu74f68daa564597a8@mail.gmail.com>
Message-ID: <48000620.6020902@fas.harvard.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

James Hawkins wrote:
| On Fri, Apr 11, 2008 at 6:11 PM, Benjamin M. Schwartz
| <bmschwar at fas.harvard.edu> wrote:
|> -----BEGIN PGP SIGNED MESSAGE-----
|>  Hash: SHA1
|>
|>  James Hawkins wrote:
|>  | On Fri, Apr 11, 2008 at 5:59 PM, Benjamin M. Schwartz
|>  |>  Would you consider patches to exchange the uid check for a rwx access
|>  check?
|>  | No, that check was added to keep users from running Wine as root.
|>
|>  Then why not prevent users from running Wine as root?  This does not
|>  prevent that.
|>
|
| It prevents this case:
|
| $ sudo wine app.exe
|
| and we've already decided that we're not going to outright prevent
| users from running wine as root.  There are certain circumstances
| where it's required.

Then how about a patch that specifically prevents users from running wine
as root over a profile that is not owned by root? I am trying to run wine
as a non-root user over a profile owned by another non-root user that has
been chmod'ed appropriately.

- --Ben

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.7 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFIAAYgUJT6e6HFtqQRAq+UAJ9tyF1GeAKaM10mRLfU0EOJI/nySwCfZi9Y
1zqdhyT1XzY+nfmCUkHLYqo=
=6bQm
-----END PGP SIGNATURE-----


From truiken at gmail.com  Fri Apr 11 19:53:46 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 11 Apr 2008 19:53:46 -0500
Subject: Wine on OLPC
In-Reply-To: <48000620.6020902@fas.harvard.edu>
References: <47FFED51.30608@fas.harvard.edu>
	<22821af30804111607g283f398cg914e4461ba06c70d@mail.gmail.com>
	<47FFF025.1070405@fas.harvard.edu>
	<22821af30804111622o5313a0adu74f68daa564597a8@mail.gmail.com>
	<48000620.6020902@fas.harvard.edu>
Message-ID: <22821af30804111753h40f9219fq783d57847534f9d3@mail.gmail.com>

On Fri, Apr 11, 2008 at 7:45 PM, Benjamin M. Schwartz
<bmschwar at fas.harvard.edu> wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
>  Hash: SHA1
>
>  James Hawkins wrote:
>  | On Fri, Apr 11, 2008 at 6:11 PM, Benjamin M. Schwartz
>  | <bmschwar at fas.harvard.edu> wrote:
>  |> -----BEGIN PGP SIGNED MESSAGE-----
>  |>  Hash: SHA1
>  |>
>  |>  James Hawkins wrote:
>  |>  | On Fri, Apr 11, 2008 at 5:59 PM, Benjamin M. Schwartz
>  |>  |>  Would you consider patches to exchange the uid check for a rwx
> access
>  |>  check?
>  |>  | No, that check was added to keep users from running Wine as root.
>  |>
>  |>  Then why not prevent users from running Wine as root?  This does not
>  |>  prevent that.
>  |>
>  |
>  | It prevents this case:
>  |
>  | $ sudo wine app.exe
>  |
>  | and we've already decided that we're not going to outright prevent
>  | users from running wine as root.  There are certain circumstances
>  | where it's required.
>
>  Then how about a patch that specifically prevents users from running wine
>  as root over a profile that is not owned by root? I am trying to run wine
>  as a non-root user over a profile owned by another non-root user that has
>  been chmod'ed appropriately.
>

Running as root was just a specific example.  The second case isn't
allowed either.

-- 
James Hawkins


From thestig at google.com  Fri Apr 11 20:21:40 2008
From: thestig at google.com (Lei Zhang)
Date: Fri, 11 Apr 2008 18:21:40 -0700
Subject: Please add wine-0.9.59 to bugzilla
In-Reply-To: <47FFFA0F.70604@kievinfo.com>
References: <47FE6FF1.30002@kievinfo.com> <47FFFA0F.70604@kievinfo.com>
Message-ID: <558b2f5c0804111821k1443f1d9t4eaed825440d5f6a@mail.gmail.com>

On Fri, Apr 11, 2008 at 4:53 PM, Vitaliy Margolen
<wine-devel at kievinfo.com> wrote:
> Vitaliy Margolen wrote:
>  > Could someone add the newest Wine version to buzilla?
>  >
>  > Vitaliy.
>  >
>  >
>  Any one alive from bugzilla admins?
>
>  Vitaliy.
>
>
>

Maybe Dan K. can do this. I'll bug him tomorrow at Lug Radio Live.


From hverbeet at gmail.com  Fri Apr 11 21:27:07 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Sat, 12 Apr 2008 04:27:07 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804120057.57495.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804111618.49900.stefan@codeweavers.com>
	<d658b69e0804111342t214f49b1t5faea9081e8b70b8@mail.gmail.com>
	<200804120057.57495.stefan@codeweavers.com>
Message-ID: <d658b69e0804111927p2e3d7e36q98bba32d724f5a4f@mail.gmail.com>

On 12/04/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
>  > >  2) We want a fixed function vertex and fragment pipeline replacement
>  > > with ARB and GLSL
>  >
>  > Only GLSL is a requirement for me. ARB could be nice, but is probably
>  > redundant.
>
> Intel cards? Also GLSL has the problem with the link times.
>
I'm currently not too bothered about Intel cards, although that might
change in the future. Either way, it's certainly possible to create an
ARB implementation, it's more a matter of priority.

>  >  Aside
>  > from being clearer this allows you to swap these parts out
>  > independently from each other and possibly skip applying them as a
>  > whole in case a shader is active for that part of the pipeline (I
>  > imagine this could have some performance advantages as well, although
>  > I'm not sure how much).
>
> For the performance, it depends on the app. If we skip applying (redundant)
>  fixed function settings when a shader is used, we have to reapply all of them
>  the shader use might have changed when the shader is deactivated. It's a
>  decision between making shader on-off switches cheap vs filtering out
>  redundant state changes done by the app. Currently there is no additional
>  fixed function pipeline cost involved when using shaders as long as the app
>  doesn't touch the ffp states.
>
I'm not sure I follow your reasoning here. Just to be clear, I'm only
talking about applying states, not marking them dirty. In the worst
case it simply means you apply them when switching back to fixed
function instead of in the current draw call, but you could
potentially save some redundant state applications while the shader is
active. However, what I was actually wondering about is if it might be
more expensive on some drivers to do fixed function state changes
while a shader is active.

> One of the reasons for using a single state table was that we have
>  interconnections between the vertex states, fragment states and other states.
>  For example, where would you put the vertex buffer loading? Is that
>  an "other" state, or a vertex state? The FVF and the vertex shader influence
>  if we're entering the FF or shader vertex processing codepaths. The FVF
>  affects fogging, which is a vertex state in some shader implementations(nvts,
>  atifs), but implemented in pixel shaders in GLSL and ARB. The texture
>  transform flags are a fixed function vertex state on paper, but we have to
>  compile the D3DTTFF_PROJECTED flag into the fragment shader. (we already do
>  so, that's documented on the msdn, so clearly a missdesign on Microsoft's
>  side). There are many more examples of vertex-fragment-other state
>  interconnections.
>
Anything that gets ignored when a vertex shader is active gets put in
the vertex states, anything that gets ignored when a fragment shader
is active should be part of the fragment states. Resource loading
would be part of the "other" states. Most of the connections you
mention appear to be connections on the D3D side, these would have no
consequences for a separation on the GL side of things. Iow, it's
perfectly valid for a state in the vertex block and a state in the
fragment block to read from the same D3D state.

>  > This doesn't support mixing eg. ARB vertex shaders with NVRC pixel
>  > shaders, but it would "simply" be a matter of splitting up the shader
>  > backend in a similar way to the state table. Important to note here is
>  > that the private data could be shared between fixed function
>  > replacements and the shader backend, like in the case of GLSL. I could
>  > imagine using a structure more similar to state_management_t for the
>  > shader backend as well.
>
> The unsplit shader backend is the current d3d shader implementation + Ivan's
>  pipeline linker object. If you split them up, where do you set GLSL shader
>  constants?
>
In the shader backend. Splitting things up doesn't change much there.
You could decide to not even expose constant loading though, and
instead just mark the state dirty on the shader backend. Deciding when
to load constants then becomes the responsibility of the shader
backend.

>  Also note that the GLSL pixel shaders depend on the type of vertex
>  processing(non-GLSL or GLSL) to load the 3.0 varyings correctly. We could get
>  rid of that by requiring GLSL vp, but that would break requirement 4, using
>  the GL fixed function pipeline.
>

From hverbeet at gmail.com  Fri Apr 11 22:07:49 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Sat, 12 Apr 2008 05:07:49 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804120141.06956.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804111735.21536.stefan@codeweavers.com>
	<200804111141.58596.chris.kcat@gmail.com>
	<200804120141.06956.stefan@codeweavers.com>
Message-ID: <d658b69e0804112007q21370d34hb543fd2af65a674b@mail.gmail.com>

On 12/04/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
>  We have to face that driver bugs are reality. I think we are having more
>  issues in form of user complaints due to the driver<->wined3d connection than
>  the wined3d<->application one. I doubt Apple is going to fix their vertex
>  shader bugs anytime soon. They come up weekly or monthly on their development
>  lists, no official statement yet.
>
This is probably more of a concern to CW than Wine in general, but I
guess it's a somewhat valid issue. The issue then becomes more one of
how much ugliness we're willing to accept in the Wine tree in order to
work around obviously broken drivers.

>  > As it is, I imagine WineD3D will need to be reworked for D3D10 no matter
>  > what we do here. Unless someone has a working design plan for what changes
>  > are needed by D3D10 for WineD3D, we're ultimately just guessing about what
>  > may work best (not to mention it'll be using GL3 instead of the current
>  > stuff, so whatever's picked may not even be efficient API-wise for it).
>
> I have a rough design plan
>
>  -> Replace the current d3d9 shader language with an intermediate language
>  generated by the shader compiler and assembler library I am working on(see
>  the other thread). d3d9 will feed a d3d9 shader into that lib and get a
>  parsed shader back that it passes to wined3d, d3d10 works similarly.
>
I thought we decided on IRC that it would make more sense to call the
shader library from wined3d rather than d3d8, d3d9 and d3d10.

>  -> Adding geometry shaders should work with the one-in-all shader backend. Add
>  geometry shaders next to pixel and vertex and link all 3 together. I don't
>  know the details with Henri's suggestion, but I think we'd just add an extra
>  geometry state handler and extend the shader backend(or add a new shader
>  backend if we split things up)
>
A geometry state handler would only make sense if you would want to
add a "fixed function geometry processing replacement". Just
supporting the shaders only requires adding them to the shader backend
(split up or not).

>  -> OpenGL 3.0 needs the finalized GL 3 spec. If GLSL is unmodified(I think
>  so), we can just reuse the existing GLSL shader backend. Otherwise we have to
>  create a new one, and depending on how similar they are maintain it as a
>  separate backend or overwrite a few parts via inheritance.
>
AFAIK GLSL will be mostly unchanged, although supposedly it will also
allow things like bindable uniforms and binding separate programs for
vertex/fragment/geometry stages. This would allow us to get rid of our
main use of GLSL linking.

>  -> The non-shader parts of GL3 need a separation of the management code and GL
>  specific code. For the state setters, we either need an entirely different
>  set of state setters, or we can reuse a fully-GLSLed pipeline implementation.
>  For textures, surfaces, buffers, devices we can move the management code into
>  a base class and inherit a GL2 and GL3 class, similarly to
>  BaseSurface-D3DSurface-GDISurface
>
I think going the GLSL way makes sense there. Anything supporting GL3
should fully support GLSL already, and I'm not even sure GL3 will
support a traditional fixed function pipeline.


From ead1234 at hotmail.com  Fri Apr 11 22:27:03 2008
From: ead1234 at hotmail.com (EA Durbin)
Date: Fri, 11 Apr 2008 22:27:03 -0500
Subject: [Wine] Uninstallation of Programs
In-Reply-To: <b6bb06270804111116k29aaaa07j836394f915098d30@mail.gmail.com>
References: <1207933293.m2f.3286@forum.winehq.org>
	<b6bb06270804111009x43dff92bh472e2f1b9d6c8130@mail.gmail.com>
	<b050a5e70804111041k48e3d7bepeb55b83bdcd4b488@mail.gmail.com>
	<b6bb06270804111106g585d3961m81bbfc76879fe60a@mail.gmail.com>
	<3a768c550804111108r695b8673h19d13a4c840f2229@mail.gmail.com>
	<b050a5e70804111111q5fa7443an55ed6cf11ea0c4b4@mail.gmail.com>
	<3a768c550804111112w6aeee430h560765c07ab05b33@mail.gmail.com> 
	<b6bb06270804111116k29aaaa07j836394f915098d30@mail.gmail.com>
Message-ID: <BAY101-W51671DEB2A74DC1490BD05ABEE0@phx.gbl>



> On Fri, Apr 11, 2008 at 1:12 PM, Juan Lang  wrote:
>>>  I agree that its certainly not necessary functionality wise, but to
>> >  what extend are we going for polish and shine for 1.0 as a whole
>> >  package, including bundled apps?  I feel like 1.0 is as good a time as
>> >  ever to try and make some of these things work.


 It would at least be nice to have an easy to way to get rid of some of the clutter under the wine gnome menu from installed applications when 1.0 comes out.

_________________________________________________________________
Going green? See the top 12 foods to eat organic.
http://green.msn.com/galleries/photos/photos.aspx?gid=164&ocid=T003MSN51N1653A

From m.b.lankhorst at gmail.com  Fri Apr 11 22:48:58 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 11 Apr 2008 20:48:58 -0700
Subject: Better sound support
In-Reply-To: <47FF9AEC.6060700@gmail.com>
References: <47FF9AEC.6060700@gmail.com>
Message-ID: <b130c85e0804112048h1d856acamcb95c9556d79b013@mail.gmail.com>

Hello,

2008/4/11, Kacper Pluta <kacper.pluta at gmail.com>:
> Hey, do you plan on enabling handling of 24bit sound and sampling
>  frequencies 96000 or 192000? Lots of musicians using Linux need to use
>  VST and VSTi plugins (through FST and other methods). Unfortunately
>  quality of music you can acquire isn't realy high if you wish to use it
>  professionally. I'd also suggest correcting MIDI handling and
>  integrating wine with wineasio, which would enable using VST and VSTi on
>  a quite high level, as well as use other programmes.

As far as I can tell, 96k and 192k works in wine without problem, 24
bits doesn't entirely work, as I didn't implement volume changing. If
you do that it can be enabled in winecfg. Just tweak the registry to
set sound to 24 bits and fix the volume error that pops up, it
shouldn't be that hard. Bonus if you can do it for 32 bits as well.

More work would be implementing >2 speakers in directsound, that
doesn't work yet and since I don't have such a speaker setup I can't
test it. Direct routing to the jack api might work, but I never tried
jack.

Cheers,
Maarten.


From bmschwar at fas.harvard.edu  Fri Apr 11 23:54:44 2008
From: bmschwar at fas.harvard.edu (Benjamin M. Schwartz)
Date: Sat, 12 Apr 2008 00:54:44 -0400
Subject: Wine on OLPC
In-Reply-To: <22821af30804111753h40f9219fq783d57847534f9d3@mail.gmail.com>
References: <47FFED51.30608@fas.harvard.edu>	<22821af30804111607g283f398cg914e4461ba06c70d@mail.gmail.com>	<47FFF025.1070405@fas.harvard.edu>	<22821af30804111622o5313a0adu74f68daa564597a8@mail.gmail.com>	<48000620.6020902@fas.harvard.edu>
	<22821af30804111753h40f9219fq783d57847534f9d3@mail.gmail.com>
Message-ID: <48004094.6010602@fas.harvard.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

James Hawkins wrote:
| On Fri, Apr 11, 2008 at 7:45 PM, Benjamin M. Schwartz
|>  Then how about a patch that specifically prevents users from running wine
|>  as root over a profile that is not owned by root? I am trying to run wine
|>  as a non-root user over a profile owned by another non-root user that has
|>  been chmod'ed appropriately.
|>
|
| Running as root was just a specific example.  The second case isn't
| allowed either.
|
I appear to have hit a nerve here; "isn't allowed" is surprisingly strong
language for an open source software project.

I'm particularly surprised because I cannot imagine any reasonable
scenario in which allowing non-root users to run in .wine/ directories
that they do not own is a security risk.  There is no privilege escalation
here; the non-root user is still required by the kernel to operate within
the bounds of posix permissions.

I need the ability to run in profiles as a user who is not the "owner" of
the files on disk.  I am doing this quite specifically because, in my
case, this greatly _increases_ the security of the system.  In fact, it
allows complete sandboxing of each Wine instance, isolating it from the
rest of the system by kernel-level mechanisms.

I would prefer not to maintain a patched fork of Wine just to get this
trivial feature.  That doesn't benefit anyone.  I'm sure we can find a way
to provide this ability without compromising the security of users in the
general case.

- --Ben
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.7 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFIAECTUJT6e6HFtqQRAhwNAJ0eFd/fPB6BcNh5jTt+qU4xqhzaAQCfU2DJ
sYTFIFQaXVn0jyWkJGsi9Fo=
=lF7k
-----END PGP SIGNATURE-----


From research at science.su  Sat Apr 12 00:34:02 2008
From: research at science.su (L. Rahyen)
Date: Sat, 12 Apr 2008 05:34:02 +0000
Subject: Wine on OLPC
In-Reply-To: <48004094.6010602@fas.harvard.edu>
References: <47FFED51.30608@fas.harvard.edu>
	<22821af30804111753h40f9219fq783d57847534f9d3@mail.gmail.com>
	<48004094.6010602@fas.harvard.edu>
Message-ID: <200804120534.02815.research@science.su>

On Saturday April 12 2008 04:54:44 Benjamin M. Schwartz wrote:
> I need the ability to run in profiles as a user who is not the "owner" of
> the files on disk.
> ...
> I would prefer not to maintain a patched fork of Wine just to get this
> trivial feature.  That doesn't benefit anyone.  I'm sure we can find a way
> to provide this ability without compromising the security of users in the
> general case.

	Well, you probably want to see http://bugs.winehq.org/show_bug.cgi?id=11112 - 
there you find a discussion about this issue.
	Personally, I use attached hack for now until above bug will be FIXED.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: remove-owner-check.diff
Type: text/x-diff
Size: 549 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080412/e68fa24d/attachment.diff 

From smoki00790 at gmail.com  Sat Apr 12 02:02:02 2008
From: smoki00790 at gmail.com (=?ISO-8859-2?Q?Milan_Kosti=E6?=)
Date: Sat, 12 Apr 2008 09:02:02 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
In-Reply-To: <200804111450.40053.stefan@codeweavers.com>
References: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
	<e1d9e62c0804090533g5b505f43od13e67b41c322024@mail.gmail.com>
	<200804110106.54219.stefan@codeweavers.com>
	<200804111450.40053.stefan@codeweavers.com>
Message-ID: <e1d9e62c0804120002p7b5548f5s42aa5154d2e4bcaf@mail.gmail.com>

 Checked and works, that seems to did a trick on everything:). In car
chase (high) and in demo with statue. Now river is showing in DS2,
there is no more flickering textures and menu also not show black
texture. Thanks:).

 Textures is good in DS2, on start perform good, but now if i played
for a while (10-15 minutes), performance is getting been worst and
worst... I will test more times just to be sure of this, because i
think that's also case without this hack.

 Painkiller now start when i disabled ps (not need 5 units in driconf
anymore to start), but thats just start. Now when it load level it
slowing down things and sometimes hang there, sometimes not, but in
both cases start to quickly use HD swap:). This is happen because this
game needs s3tc to be enabled in driconf and if it is then just works,
but now that is ati_fs there, seems to work only when ps is disabled
in winecfg, with enabled not even start. There is a log from console,
maybe it's usefull to you.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pk_log.tar.gz
Type: application/x-gzip
Size: 2955 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080412/104d0475/attachment.bin 

From austinenglish at gmail.com  Sat Apr 12 04:33:51 2008
From: austinenglish at gmail.com (Austin English)
Date: Sat, 12 Apr 2008 04:33:51 -0500
Subject: Testcases: Call for volunteers
Message-ID: <b6bb06270804120233v5dae75fap57915dec23e2b9a0@mail.gmail.com>

Over the past few days I've had a bit of time to kill, and spent quite
a bit of it triaging bugs in bugzilla (mostly checking up on
old/abandoned bugs, but also,  tagging quite a few patches/test
cases).

In the process, I've tagged quite a few bugs (currently, 66 open, 9
closed) that have test cases attached. While not all are in C, or
easily portable to the wine test suite, I'd appreciate it if those of
you with time to spare could take a look at any test cases in your
area of expertise and port those tests to the wine test suite.

Here is the current  list:
http://bugs.winehq.org/buglist.cgi?keywords=testcase

The more conformance tests we can add, the fewer regressions post 1.0,
so in the end, less  work :-).

- Austin


From stefan at codeweavers.com  Sat Apr 12 06:34:12 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 12 Apr 2008 13:34:12 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <d658b69e0804111927p2e3d7e36q98bba32d724f5a4f@mail.gmail.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804120057.57495.stefan@codeweavers.com>
	<d658b69e0804111927p2e3d7e36q98bba32d724f5a4f@mail.gmail.com>
Message-ID: <200804121334.12321.stefan@codeweavers.com>

Am Samstag, 12. April 2008 04:27:07 schrieb H. Verbeet:

> Anything that gets ignored when a vertex shader is active gets put in
> the vertex states, anything that gets ignored when a fragment shader
> is active should be part of the fragment states. Resource loading
> would be part of the "other" states.
GL named arrays get ignored when a vertex shader is in use, unless the shader 
explicitly uses them...

> Most of the connections you 
> mention appear to be connections on the D3D side, these would have no
> consequences for a separation on the GL side of things. Iow, it's
> perfectly valid for a state in the vertex block and a state in the
> fragment block to read from the same D3D state.
So if e.g. the vertex declaration is changed you would dirtify many states:
-> misc stream sources
-> vertex shader(use it or not?)
-> Fog
-> Fixed function vertex processing matrices(rhw vertices or not)
-> texture transforms
-> (a few others as well)
I have no problem with doing that, changing the vdecl is an expensive business 
no matter what we do, just asking to make sure I understand what you mean. 
How do you control which gl states are dirtified by which d3d state? This 
will depend on the combination of backends you use.

There are quite a few opengl connections as well, although they work 
differently.It's more the various interactions between shader extensions. In 
quite a few cases the fragment processing implementation has to configure the 
vertex processing correctly to feed it in the right way, and also the other 
way round.

For example, to stick to the texture transform flags. Let's consider we're 
using fixed function D3D vertex processing in whatever GL extension. Now 
enter fragment processing and D3DTTFF_PROJECTED:

-> With fixed function GL or a NVTS fixed function replacement we have to make 
sure that the 4th coordinate is 1.0 to disabe the GL division if 
TTFF_PROJECTED is not set, and if it is set with TTFF_COUNT3 make sure that 
the 3rd coord is copied to the 4th
-> With GLSL or ARB fixed function replacement we can handle the lack of 
TTFF_PROJECTED properly, but not COUNT3
-> With ATIFS we can handle everything properly in the replacement shader
-> With an ARB, GLSL or ATIFS D3D shader we don't need any special texture 
transform fixups
-> With an NVTS D3D shader we have to take care about disabling projected 
textures in vertex processing again

That means different fragment processing implementations have different vertex 
processing requirements. Now you could make that a flag in the fragment 
processing and pixel shader implementation. You'd need 4 
flags(nonshader_unprojected, shader_unprojected, nonshader_count3, 
shader_count3). Are you sure the flags won't grow out of control?

Another example is fogging. Fog is overwritten by ARB and GLSL, but not ATIFS 
and NVTS(as far as I can see). Is fog a vertex or fragment state? How do you 
share the quite complex fog applying code between the ATIFS, NVTS and GL 
fixed function implementation if you make it a fragment state?

> >  Also note that the GLSL pixel shaders depend on the type of vertex
> >  processing(non-GLSL or GLSL) to load the 3.0 varyings correctly. We
> > could get rid of that by requiring GLSL vp, but that would break
> > requirement 4, using the GL fixed function pipeline.
>
> From the shader's point of view a pipeline replacement should be
> indistinguishable from real fixed function processing, other than that
> in case of GLSL you have to link it together into a single program.
PS 3.0 shaders read texcoords and colors from custom varyings, and D3DCOLOR0, 
1, TEXCOORD0-7 are linked to their predecessors. That way a 3.0 pshader can 
interact with fixed function vertex processing and rhw drawing.(fixed 
function vertex processing is broken on ATI on Windows, but I don't want to 
justify the design with an ATI driver bug. RHW+3.0 is used by e.g. Age of 
Empires 3).

Where would you write the TEXCOORD0-7 and D3DCOLOR0 and 1 varyings from a GLSL 
vertex shader, and where do you read them from in the pixel shader? Keep 
indirect varying addressing in the pshader in mind.

> It's a concern when mixing different shader backends, but I'm not sure
> there's a lot we can do about it there. For fixed function
> replacements it shouldn't matter though, because you always write to
> the predefined fixed function outputs. In that case linking is only an
> issue for GLSL FFP + GLSL shader, which is trivial to implement.
When you're not able to link ARBVP+ATIFS pixel shaders or ATIVP+NVTS then that 
defeats the point of implementing pixel shaders with them, so we have to do 
something about them.

From the mail from yesterday:
> The private data between the FFP replacement and the shader backend
> can be shared. That means our general GLSL management stuff can see
> you've got eg. a FFP vertex shader and a pixel shader and link them
> together.
I am using GLSL for pixel shaders. Can I share my private data with a GLSL 
fragment replacement, or do I have to bother that the fixed function fragment 
processing might be done using ATIFS? Not using GLSL pshaders + ATIFS was one 
of the symtoms for you that "the shader backend isn't the right place to 
implement this".

---

> I'm currently not too bothered about Intel cards, although that might
> change in the future. Either way, it's certainly possible to create an
> ARB implementation, it's more a matter of priority.
They are pretty widespread and are even used in the EEEPC, so I think dealing 
with these cards will become a priority soon, at least for me. Unfortunately 
the driver sucks in terms of stability and performance.


From stefan at codeweavers.com  Sat Apr 12 06:41:15 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Sat, 12 Apr 2008 13:41:15 +0200
Subject: GL_ATI_fragment_shader and GL_INVALID 0x501, 0x502
In-Reply-To: <e1d9e62c0804120002p7b5548f5s42aa5154d2e4bcaf@mail.gmail.com>
References: <e1d9e62c0804071637n76680520ge942d21e4bf8f81f@mail.gmail.com>
	<200804111450.40053.stefan@codeweavers.com>
	<e1d9e62c0804120002p7b5548f5s42aa5154d2e4bcaf@mail.gmail.com>
Message-ID: <200804121341.15300.stefan@codeweavers.com>

Am Samstag, 12. April 2008 09:02:02 schrieb Milan Kosti?:
>  Textures is good in DS2, on start perform good, but now if i played
> for a while (10-15 minutes), performance is getting been worst and
> worst... I will test more times just to be sure of this, because i
> think that's also case without this hack.
There's at least one "bug" in our fragment shader management code, and most 
likely a 2nd one. The first issue is that the searching for fragment shaders 
is rather simple and expensive. We'll have to replace the linear search at 
least with a sorted array, or possibly a hashmap.

The other problem, I noticed that during the 3DMark debugging, is that for 
some reason fragment shaders with identical settings are duplicated. That 
leads to more shaders to manage, and triggers the above issue.


From stefan at codeweavers.com  Sat Apr 12 07:25:12 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 12 Apr 2008 14:25:12 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <d658b69e0804112007q21370d34hb543fd2af65a674b@mail.gmail.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804120141.06956.stefan@codeweavers.com>
	<d658b69e0804112007q21370d34hb543fd2af65a674b@mail.gmail.com>
Message-ID: <200804121425.12910.stefan@codeweavers.com>

Am Samstag, 12. April 2008 05:07:49 schrieb H. Verbeet:
> I thought we decided on IRC that it would make more sense to call the
> shader library from wined3d rather than d3d8, d3d9 and d3d10.
From where we call the shader library isn't all that important to me. For me 
it's mainly important that the shader library parses the d3d9 and d3d10 
shader and the wined3d GL shader generator works on Wine's internal shader 
representation

> I think going the GLSL way makes sense there. Anything supporting GL3
> should fully support GLSL already, and I'm not even sure GL3 will
> support a traditional fixed function pipeline.
What I meant is that it depends on how shaders will look in GL 3.0. If it is 
GLSL as it is now, we can just use the GLSL shader backend. If it is vastly 
different we'll need a new one.


From hverbeet at gmail.com  Sat Apr 12 08:06:38 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Sat, 12 Apr 2008 15:06:38 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804121334.12321.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804120057.57495.stefan@codeweavers.com>
	<d658b69e0804111927p2e3d7e36q98bba32d724f5a4f@mail.gmail.com>
	<200804121334.12321.stefan@codeweavers.com>
Message-ID: <d658b69e0804120606k747928b2qd079aef9ce179289@mail.gmail.com>

On 12/04/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Samstag, 12. April 2008 04:27:07 schrieb H. Verbeet:
>  > Anything that gets ignored when a vertex shader is active gets put in
>  > the vertex states, anything that gets ignored when a fragment shader
>  > is active should be part of the fragment states. Resource loading
>  > would be part of the "other" states.
>
> GL named arrays get ignored when a vertex shader is in use, unless the shader
>  explicitly uses them...
>
It doesn't get ignored, you still do the upload and the data is still
available should the shader choose to use it. Still, I probably
should've phrased it as "functionality that gets replaced by a vertex
/ fragment shader".

>  > Most of the connections you
>  > mention appear to be connections on the D3D side, these would have no
>  > consequences for a separation on the GL side of things. Iow, it's
>  > perfectly valid for a state in the vertex block and a state in the
>  > fragment block to read from the same D3D state.
>
> So if e.g. the vertex declaration is changed you would dirtify many states:
>  -> misc stream sources
>  -> vertex shader(use it or not?)
>  -> Fog
>  -> Fixed function vertex processing matrices(rhw vertices or not)
>  -> texture transforms
>  -> (a few others as well)
>  I have no problem with doing that, changing the vdecl is an expensive business
>  no matter what we do, just asking to make sure I understand what you mean.
>  How do you control which gl states are dirtified by which d3d state? This
>  will depend on the combination of backends you use.
>
I'm not sure about the exact splitup you're using here, but it would
mean potentially dirtifying multiple states, yes. I could imagine it
as simply dirtifying the vertexdeclaration state on both the vertex
and fragment state tables.

>  There are quite a few opengl connections as well, although they work
>  differently.It's more the various interactions between shader extensions. In
>  quite a few cases the fragment processing implementation has to configure the
>  vertex processing correctly to feed it in the right way, and also the other
>  way round.
>
>  For example, to stick to the texture transform flags. Let's consider we're
>  using fixed function D3D vertex processing in whatever GL extension. Now
>  enter fragment processing and D3DTTFF_PROJECTED:
>
>  -> With fixed function GL or a NVTS fixed function replacement we have to make
>  sure that the 4th coordinate is 1.0 to disabe the GL division if
>  TTFF_PROJECTED is not set, and if it is set with TTFF_COUNT3 make sure that
>  the 3rd coord is copied to the 4th
>  -> With GLSL or ARB fixed function replacement we can handle the lack of
>  TTFF_PROJECTED properly, but not COUNT3
>  -> With ATIFS we can handle everything properly in the replacement shader
>  -> With an ARB, GLSL or ATIFS D3D shader we don't need any special texture
>  transform fixups
>  -> With an NVTS D3D shader we have to take care about disabling projected
>  textures in vertex processing again
>
>  That means different fragment processing implementations have different vertex
>  processing requirements. Now you could make that a flag in the fragment
>  processing and pixel shader implementation. You'd need 4
>  flags(nonshader_unprojected, shader_unprojected, nonshader_count3,
>  shader_count3). Are you sure the flags won't grow out of control?
>
You only need two. One to toggle writing 1.0 to the 4th coordinate
when needed, and one to toggle copying the 3th coordinate to the 4th
when needed. It would certainly beat doing an extension check for
every possible backend. Right now we always do the fixup, so in that
respect it would be an improvement as well.

>  Another example is fogging. Fog is overwritten by ARB and GLSL, but not ATIFS
>  and NVTS(as far as I can see). Is fog a vertex or fragment state? How do you
>  share the quite complex fog applying code between the ATIFS, NVTS and GL
>  fixed function implementation if you make it a fragment state?
>
That depends on the fog type. Vertex fog is a vertex state, fragment
fog is a fragment state. Changing the type would obviously have
interactions with both parts of the pipeline. As for applying the
state, there's no reason different implementations can call a common
function in eg. utils.c to calculate things like the fog mode, type,
start, end, etc. One could argue it doesn't belong in state_fog() in
the first place.

>  > From the shader's point of view a pipeline replacement should be
>  > indistinguishable from real fixed function processing, other than that
>  > in case of GLSL you have to link it together into a single program.
>
> PS 3.0 shaders read texcoords and colors from custom varyings, and D3DCOLOR0,
>  1, TEXCOORD0-7 are linked to their predecessors. That way a 3.0 pshader can
>  interact with fixed function vertex processing and rhw drawing.(fixed
>  function vertex processing is broken on ATI on Windows, but I don't want to
>  justify the design with an ATI driver bug. RHW+3.0 is used by e.g. Age of
>  Empires 3).
>
>  Where would you write the TEXCOORD0-7 and D3DCOLOR0 and 1 varyings from a GLSL
>  vertex shader, and where do you read them from in the pixel shader? Keep
>  indirect varying addressing in the pshader in mind.
>
Just to be clear, with "GLSL vertex shader" you mean "GLSL vertex
processing replacement", right? A vertex processing replacement shader
would write to the regular fixed function output, ie gl_FrontColor,
gl_FrontSecondaryColor, gl_TexCoord[], etc. The fragment shader would
read them the same way as it does when paired with fixed function or
pre-3.0 vertex shaders.

>  > It's a concern when mixing different shader backends, but I'm not sure
>  > there's a lot we can do about it there. For fixed function
>  > replacements it shouldn't matter though, because you always write to
>  > the predefined fixed function outputs. In that case linking is only an
>  > issue for GLSL FFP + GLSL shader, which is trivial to implement.
>
> When you're not able to link ARBVP+ATIFS pixel shaders or ATIVP+NVTS then that
>  defeats the point of implementing pixel shaders with them, so we have to do
>  something about them.
>
Actually, I'm not sure what I was thinking here. It should only be a
concern when mixing two SM3.0+ shaders between different backends,
which atifs and nvts are never going to support. The only combination
that would need some kind of linking would be GLSL SM3.0 vertex
shaders with GLSL SM3.0 fragment shaders, but we currently handle that
and it could pretty much continue to keep working the same way. ARBVP
+ ATIFS PS or ATIVP + NVTS PS should work without problem, if you
split up the shader backend. I still think it's premature to worry too
much about that at the moment, since it's a separate issue from how
you split up the state management.

>  From the mail from yesterday:
>
> > The private data between the FFP replacement and the shader backend
>  > can be shared. That means our general GLSL management stuff can see
>  > you've got eg. a FFP vertex shader and a pixel shader and link them
>  > together.
>
> I am using GLSL for pixel shaders. Can I share my private data with a GLSL
>  fragment replacement, or do I have to bother that the fixed function fragment
>  processing might be done using ATIFS? Not using GLSL pshaders + ATIFS was one
>  of the symtoms for you that "the shader backend isn't the right place to
>  implement this".
>
Pixel shaders + fragment processing replacement doesn't make sense.
Either a GLSL vertex processing replacement + GLSL pixel shader or a
GLSL vertex shader + GLSL fragment processing replacement would work
though. The "GLSL pipeline object" would know if it's being used as
vertex and/or fragment replacement and link everything together. In
case atifs is used no linking is required.

Basically you should think of the GLSL private data + vertex
processing replacement + fragment processing replacement + shader
backend as a single object exposing three different interfaces. Call
it a "pipeline object" if you like.

>  > I'm currently not too bothered about Intel cards, although that might
>  > change in the future. Either way, it's certainly possible to create an
>  > ARB implementation, it's more a matter of priority.
>
> They are pretty widespread and are even used in the EEEPC, so I think dealing
>  with these cards will become a priority soon, at least for me. Unfortunately
>  the driver sucks in terms of stability and performance.
>
Are those cards powerful enough to support a fixed function replacement?


From ovek at arcticnet.no  Sat Apr 12 10:19:37 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Sat, 12 Apr 2008 17:19:37 +0200
Subject: Wine on OLPC
In-Reply-To: <48004094.6010602@fas.harvard.edu>
References: <47FFED51.30608@fas.harvard.edu>	<22821af30804111607g283f398cg914e4461ba06c70d@mail.gmail.com>	<47FFF025.1070405@fas.harvard.edu>	<22821af30804111622o5313a0adu74f68daa564597a8@mail.gmail.com>	<48000620.6020902@fas.harvard.edu>	<22821af30804111753h40f9219fq783d57847534f9d3@mail.gmail.com>
	<48004094.6010602@fas.harvard.edu>
Message-ID: <4800D309.4090406@arcticnet.no>

Benjamin M. Schwartz skrev:
> I'm particularly surprised because I cannot imagine any reasonable
> scenario in which allowing non-root users to run in .wine/ directories
> that they do not own is a security risk.  There is no privilege escalation
> here; the non-root user is still required by the kernel to operate within
> the bounds of posix permissions.

That's not quite correct. If user B can run user A's installation of 
Wine, then user B can easily install some script or program that gets 
executed automatically (wineboot) the next time user A runs Wine; from 
there, user B can gain unlimited access to user A's account. (Or, 
perhaps, vice versa.)

I think that's not really the point of the check, though. Perhaps more 
problematic is probably that if user B runs user A's Wine, then files 
written (registry included) might become owned by B, with the result 
that next time user A wants to start Wine, it can't access them. (The 
most frequent problem here is the one when user B called "root", but not 
necessarily.)

And of course, if user A and user B happens to run Wine 
*simultaneously*, they're going to overwrite each other's files and end 
up with a broken Wine installation.

> I need the ability to run in profiles as a user who is not the "owner" of
> the files on disk.  I am doing this quite specifically because, in my
> case, this greatly _increases_ the security of the system.

You have a poor understanding of Unix security if you think it's good 
that files and whatever uses them are on different accounts, and if you 
think making a (fake) Windows installation publicly accessible (and 
modifiable) by every other user on the system can possibly be called secure.

I'm not sure why you even need to. If you're running Wine as a different 
user, why shouldn't that different user own its own .wine/ directory?




From stefan at codeweavers.com  Sat Apr 12 10:05:26 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 12 Apr 2008 17:05:26 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <d658b69e0804120606k747928b2qd079aef9ce179289@mail.gmail.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804121334.12321.stefan@codeweavers.com>
	<d658b69e0804120606k747928b2qd079aef9ce179289@mail.gmail.com>
Message-ID: <200804121705.26521.stefan@codeweavers.com>

Am Samstag, 12. April 2008 15:06:38 schrieb H. Verbeet:
> It doesn't get ignored, you still do the upload and the data is still
> available should the shader choose to use it. Still, I probably
> should've phrased it as "functionality that gets replaced by a vertex
> / fragment shader".
But since D3D vertex shaders always read the numbered arrays and fixed 
function always reads the named arrays the named arrays get de-facto replaced 
as far as we're concerned.

> >  That means different fragment processing implementations have different
> > vertex processing requirements. Now you could make that a flag in the
> > fragment processing and pixel shader implementation. You'd need 4
> >  flags(nonshader_unprojected, shader_unprojected, nonshader_count3,
> >  shader_count3). Are you sure the flags won't grow out of control?
>
> You only need two. One to toggle writing 1.0 to the 4th coordinate
> when needed, and one to toggle copying the 3th coordinate to the 4th
> when needed. It would certainly beat doing an extension check for
> every possible backend. Right now we always do the fixup, so in that
> respect it would be an improvement as well.
I'm working on a patch that makes the atifs shader code take care of applying 
the texture transform matrix. That works naturally without any flags or 
backend check if you don't try to split vertex and fragment processing by 
force.

> That depends on the fog type. Vertex fog is a vertex state, fragment
> fog is a fragment state. Changing the type would obviously have
> interactions with both parts of the pipeline.
On the GL side both vertex and fragment fog are applied to the same GL state. 
Using a ARBFP or GLSL fragment shader replaces vertex fog as well, so you'll 
have to implement both types in the fragment processing replacement.

The fog settings depend on the vertex decl(XYZ vs XYZRHW) and the shader 
properties("foggy shader"). That means the fragment processing code(pixel 
shader and ffp replacement) would look at the core of the vertex processing 
settings. Doesn't that defeat separating them in the first place?

(I understand that you want to split the state types on the GL side, not the 
D3D side. But when you split applying of one D3D state in 3 pieces, I fail to 
see how it is cleaner)

You didn't answer how you plan to implement state dirtification. You have a 
SetRenderState call that changes render state X. Which implementation 
state(s) do you dirtify? Ie:

> 
device->fragment_state_manager->mark_state_dirty(device->fragment_private_data,
> state);

Where does "state" come from?

> if (!use_vs) {
>     device->vertex_state_manager->apply_states(device->vertex_private_data);
> }
> ...
This would be done where?

> >  Where would you write the TEXCOORD0-7 and D3DCOLOR0 and 1 varyings from
> > a GLSL vertex shader, and where do you read them from in the pixel
> > shader? Keep indirect varying addressing in the pshader in mind.
>
> Just to be clear, with "GLSL vertex shader" you mean "GLSL vertex
> processing replacement", right? A vertex processing replacement shader
> would write to the regular fixed function output, ie gl_FrontColor,
> gl_FrontSecondaryColor, gl_TexCoord[], etc. The fragment shader would
> read them the same way as it does when paired with fixed function or
> pre-3.0 vertex shaders.
No, I mean a D3D (3.0) vertex shader that is translated and running via GLSL. 
Currently the pixel shader decides where the vertex shader(all versions) 
writes the varyings to(generate_param_reorder_function). If a fixed function 
vertex replacement shader and pre-3.0 shader writes to the regular fixed 
function output, how would you run a pixel shader like the one in 
vshader_version_varying_test() in visual.c together with a 1.x or 2.0 vertex 
shader, or XYZRHW data from a GLSL vertex pipeline replacement shader? (With 
the fixed function GL vertex pipeline we're screwed, but we aren't 
necessarily screwed with a GLSL vertex pipeline replacement)

> Pixel shaders + fragment processing replacement doesn't make sense.
> Either a GLSL vertex processing replacement + GLSL pixel shader or a
> GLSL vertex shader + GLSL fragment processing replacement would work
> though. The "GLSL pipeline object" would know if it's being used as
> vertex and/or fragment replacement and link everything together. In
> case atifs is used no linking is required.
What I meant was that: Scenario 1:
GLSL is used for pixel shaders and fragment pipeline replacement. How do I 
find out if I have to link the fragment replacement GLSL shader or the pixel 
shader GLSL shader into my program I activate? -> Share private data between 
GLSL shader backend and GLSL fixed function object

Followup scenario 2: We don't have a GLSL fixed function backend yet. I have 
an ATI X1600 card, I am using GLSL for pixel shaders, and I am using ATIFS 
for the pipeline replacement. The GLSL pixel shader code reads the GLSL 
fragment pipeline replacement private data. -> This GLSL fragment replacement 
private data is either nonexistant or hanging around without code maintaining 
it. How do we deal with that?

> > They are pretty widespread and are even used in the EEEPC, so I think
> > dealing with these cards will become a priority soon, at least for me.
> > Unfortunately the driver sucks in terms of stability and performance.
>
> Are those cards powerful enough to support a fixed function replacement?
Afaik the older cards do not support vertex processing, it's done in software, 
so it depends on the driver. On the fragment side they are pretty solid and 
work only with programmable fragment processing internally. The newer X3100 
only supports programmable vertex and fragment processing in hardware, so a 
pipeline replacement is either done by us or the driver. It might be powerful 
enough for GLSL as well though.


From wine-devel at kievinfo.com  Sat Apr 12 10:22:07 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 12 Apr 2008 09:22:07 -0600
Subject: Dead-loop in IWineD3DTextureImpl_PreLoad
Message-ID: <4800D39F.2000809@kievinfo.com>

Can some one take a look at this (bug 11630)?

I'm not sure how it works at all now:
IWineD3DTexture_PreLoad:144: http://source.winehq.org/source/dlls/wined3d/texture.c#L144
IWineD3DSurface_LoadTexture:488: http://source.winehq.org/source/dlls/wined3d/surface.c#L488

And of course container is Texture so the loop starts again until Wine runs out of stack.

Vitaliy.


From bmschwar at fas.harvard.edu  Sat Apr 12 10:37:07 2008
From: bmschwar at fas.harvard.edu (Benjamin M. Schwartz)
Date: Sat, 12 Apr 2008 11:37:07 -0400
Subject: Wine on OLPC
In-Reply-To: <4800D309.4090406@arcticnet.no>
References: <47FFED51.30608@fas.harvard.edu>	<22821af30804111607g283f398cg914e4461ba06c70d@mail.gmail.com>	<47FFF025.1070405@fas.harvard.edu>	<22821af30804111622o5313a0adu74f68daa564597a8@mail.gmail.com>	<48000620.6020902@fas.harvard.edu>	<22821af30804111753h40f9219fq783d57847534f9d3@mail.gmail.com>	<48004094.6010602@fas.harvard.edu>
	<4800D309.4090406@arcticnet.no>
Message-ID: <4800D723.8000104@fas.harvard.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Ove Kaaven wrote:
| Benjamin M. Schwartz skrev:
|> I'm particularly surprised because I cannot imagine any reasonable
|> scenario in which allowing non-root users to run in .wine/ directories
|> that they do not own is a security risk.  There is no privilege escalation
|> here; the non-root user is still required by the kernel to operate within
|> the bounds of posix permissions.
|
| That's not quite correct. If user B can run user A's installation of
| Wine, then user B can easily install some script or program that gets
| executed automatically (wineboot) the next time user A runs Wine; from
| there, user B can gain unlimited access to user A's account. (Or,
| perhaps, vice versa.)

My home directory is not world-writable.  Is yours?

|
| I think that's not really the point of the check, though. Perhaps more
| problematic is probably that if user B runs user A's Wine, then files
| written (registry included) might become owned by B, with the result
| that next time user A wants to start Wine, it can't access them. (The
| most frequent problem here is the one when user B called "root", but not
| necessarily.)

This only works if one user is root; otherwise (under any normal unix
permissions setup) multiple users do not have write access to each other's
.wine/ directories.

|
| And of course, if user A and user B happens to run Wine
| *simultaneously*, they're going to overwrite each other's files and end
| up with a broken Wine installation.

That is definitely an interesting problem, as noted in the very
comprehensive bug #11112.  The suggested solution of introducing a
lockfile does seem appropriate; it's how every other unix application
solves this problem.  In my case, I have external mechanisms to ensure
that multiple instances of wine are never running simultaneously.

|
|> I need the ability to run in profiles as a user who is not the "owner" of
|> the files on disk.  I am doing this quite specifically because, in my
|> case, this greatly _increases_ the security of the system.
|
| You have a poor understanding of Unix security if you think it's good
| that files and whatever uses them are on different accounts, and if you
| think making a (fake) Windows installation publicly accessible (and
| modifiable) by every other user on the system can possibly be called secure.

I'm afraid there is not space here to describe the Rainbow security
system.  However, I am operating in a special environment in which the
system has a single human user, and unix uid's have been repurposed to
provide software isolation.  I am not, in fact, suggesting making .wine/
publicly accessible.  I am actually using "chmod g+rwx" to make .wine/
available to a particular application, because each application has a
unique gid.  Also, Rainbow uses namespaced bindmounts in such a way that
applications not running with the gid in question cannot even determine
that this .wine/ directory exists.

See http://wiki.laptop.org/go/Rainbow

|
| I'm not sure why you even need to. If you're running Wine as a different
| user, why shouldn't that different user own its own .wine/ directory?

Rainbow works by generating a new uid every time an application is
launched.  Therefore, the second time the same human runs a wine-based
program, it runs under a different uid.  In order to provide continuity of
state, I need to be able to run in a permanent .wine/ despite having a uid
that is constantly changing.

Bug #11112 suggests that it may be possible to solve this problem using
dynamically generated symlinks.  I will try that.

- --Ben
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.7 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFIANcjUJT6e6HFtqQRAnHdAKCUxI/2HvzfiEjloGjwkcIiZ24ZpACcDBZ+
Cq9UlZY0euM9DHwlmyusyV4=
=C/Un
-----END PGP SIGNATURE-----


From Andrew.Talbot at talbotville.com  Sat Apr 12 10:54:41 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 12 Apr 2008 16:54:41 +0100
Subject: AVI file format documentation
References: <a71bd89a0804101142g699fdc9k7ebd4ce3f44e208a@mail.gmail.com><005501c89ba8$22d255c0$a600fea9@DMITRY>
	<b130c85e0804110055q4247a5e2rc7312b19c5992ee0@mail.gmail.com>
	<004001c89bbb$0108e950$a600fea9@DMITRY>
Message-ID: <ftqm01$bg6$1@ger.gmane.org>

While we are on the subject of AVI files: could someone please take a look
at the function IAVIStream_fnWriteData() in avifil32/avifile.c? There is an
unused variable "dwPos" (line 1326), which has been there since this
function was first implemented (2002-10-18), I could just remove this
variable, but I think the calculation of available space may be incorrect
anyway. Comments please!

Thanks,

-- 
Andy.




From luis.busquets at ilidium.com  Sat Apr 12 11:11:05 2008
From: luis.busquets at ilidium.com (Luis Busquets)
Date: Sat, 12 Apr 2008 18:11:05 +0200
Subject: Several patches for D3DX
In-Reply-To: <22821af30804111627ha04dbdfqac2c115e9f473c01@mail.gmail.com>
References: <47FFF246.4090003@ilidium.com>
	<22821af30804111627ha04dbdfqac2c115e9f473c01@mail.gmail.com>
Message-ID: <4800DF19.2040009@ilidium.com>

Thanks for your sincere response. I am aware that there are diverse 
styles of writing the functions and all can be criticised: some for its 
complexity, others for its unreadability, others for its length... 
Anyway at this point in time , what I see as evident is that the three 
implementations that I have submitted comply with their attached tests 
and I have tried to include all the modifications proposed. Although in 
my opinion the best would be to commit these patches and, if needed, 
increase the beautiness of the code in particular direction later, for 
me it is evident that it is not hard to implement these three functions 
in one way or another.

Therefore, in the case that the implementations submitted are not liked, 
please, I ask a more experienced programmer to submit his/her 
implementations and commit them to the tree for these really trivial 
functions (D3DXGetShaderVersion, D3DXGetShaderSize, D3DXGetFVFVertexSize).

James Hawkins escribi?:
> On Fri, Apr 11, 2008 at 6:20 PM, Luis Busquets
> <luis.busquets at ilidium.com> wrote:
>   
>> Is there still any problem with each of the attached patches or are they
>> going to be committed?
>>
>>     
>
> +WINAPI DWORD D3DXGetShaderVersion(CONST DWORD *pFunction)
> +{
> +    DWORD ver;
> +    if (!pFunction)
> +     {
> +      return 0;
> +      }
> +    /* The first DWORD of the stream is the version Token */
> +   ver=*pFunction;
> +   return ver;
> +}
>
> I can't attest to any of the rest, but the style in this function is
> horrendous.  Your spacing is all over the place.  Also, correctness of
> this function aside, the function can be written so much simpler as:
>
> WINAPI DWORD D3DXGetShaderVersion(CONST DWORD *pFunction)
> {
>     return (pFunction) ? *pFunction : 0;
> }
>
>   



From truiken at gmail.com  Sat Apr 12 11:14:58 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 12 Apr 2008 11:14:58 -0500
Subject: Several patches for D3DX
In-Reply-To: <4800DF19.2040009@ilidium.com>
References: <47FFF246.4090003@ilidium.com>
	<22821af30804111627ha04dbdfqac2c115e9f473c01@mail.gmail.com>
	<4800DF19.2040009@ilidium.com>
Message-ID: <22821af30804120914q16d9636dl1b2d0bc64408f173@mail.gmail.com>

On Sat, Apr 12, 2008 at 11:11 AM, Luis Busquets
<luis.busquets at ilidium.com> wrote:
> Thanks for your sincere response. I am aware that there are diverse styles
> of writing the functions and all can be criticised: some for its complexity,
> others for its unreadability, others for its length... Anyway at this point
> in time , what I see as evident is that the three implementations that I
> have submitted comply with their attached tests and I have tried to include
> all the modifications proposed. Although in my opinion the best would be to
> commit these patches and, if needed, increase the beautiness of the code in
> particular direction later, for me it is evident that it is not hard to
> implement these three functions in one way or another.
>
>  Therefore, in the case that the implementations submitted are not liked,
> please, I ask a more experienced programmer to submit his/her
> implementations and commit them to the tree for these really trivial
> functions (D3DXGetShaderVersion, D3DXGetShaderSize, D3DXGetFVFVertexSize).
>

That's definitely not going to happen.  Style consistency is of utmost
importance when submitting patches.  Very rarely does Julliard accept
a style "beautification" patch.  It has to be right the first time
it's committed.  Also, we're all busy working on whatever we're
working on, so you either fix them up and resend, or they're going to
bit-rot.  P.S. please bottom-post in this mailing list.

-- 
James Hawkins


From ovek at arcticnet.no  Sat Apr 12 11:22:39 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Sat, 12 Apr 2008 18:22:39 +0200
Subject: Wine on OLPC
In-Reply-To: <4800D723.8000104@fas.harvard.edu>
References: <47FFED51.30608@fas.harvard.edu>	<22821af30804111607g283f398cg914e4461ba06c70d@mail.gmail.com>	<47FFF025.1070405@fas.harvard.edu>	<22821af30804111622o5313a0adu74f68daa564597a8@mail.gmail.com>	<48000620.6020902@fas.harvard.edu>	<22821af30804111753h40f9219fq783d57847534f9d3@mail.gmail.com>	<48004094.6010602@fas.harvard.edu>
	<4800D309.4090406@arcticnet.no> <4800D723.8000104@fas.harvard.edu>
Message-ID: <4800E1CF.6090508@arcticnet.no>

Benjamin M. Schwartz skrev:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> Ove Kaaven wrote:
> | Benjamin M. Schwartz skrev:
> |> I'm particularly surprised because I cannot imagine any reasonable
> |> scenario in which allowing non-root users to run in .wine/ directories
> |> that they do not own is a security risk.  There is no privilege 
> escalation
> |> here; the non-root user is still required by the kernel to operate 
> within
> |> the bounds of posix permissions.
> |
> | That's not quite correct. If user B can run user A's installation of
> | Wine, then user B can easily install some script or program that gets
> | executed automatically (wineboot) the next time user A runs Wine; from
> | there, user B can gain unlimited access to user A's account. (Or,
> | perhaps, vice versa.)
> 
> My home directory is not world-writable.  Is yours?

Obviously you missed the point. If I have access to your .wine 
directory, then I can compromise your entire account and everything it 
owns, it doesn't matter whether it's world-writable or not. And 
similarly, you can compromise mine, it doesn't matter what permissions 
my home directory has. Any .wine can be converted into a SSH server, FTP 
server, spam proxy, whatever you fancy, as soon as someone runs Wine.

> | I think that's not really the point of the check, though. Perhaps more
> | problematic is probably that if user B runs user A's Wine, then files
> | written (registry included) might become owned by B, with the result
> | that next time user A wants to start Wine, it can't access them. (The
> | most frequent problem here is the one when user B called "root", but not
> | necessarily.)
> 
> This only works if one user is root; otherwise (under any normal unix
> permissions setup) multiple users do not have write access to each other's
> .wine/ directories.

But in your original post, you used chmod a+rwx precisely to give 
multiple users write access to each other's .wine directories. And since 
you're apparently arguing against that trick here, I guess you're seeing 
a reason why wine disallows it.

> | And of course, if user A and user B happens to run Wine
> | *simultaneously*, they're going to overwrite each other's files and end
> | up with a broken Wine installation.
> 
> That is definitely an interesting problem, as noted in the very
> comprehensive bug #11112.  The suggested solution of introducing a
> lockfile does seem appropriate; it's how every other unix application
> solves this problem.

For applications that need to process a file for a couple of seconds, 
sure. But Wine might run for hours or days, so in a multiuser setting, a 
lock file that locks out other users until the first user exits is not 
enough.

> |> I need the ability to run in profiles as a user who is not the 
> "owner" of
> |> the files on disk.  I am doing this quite specifically because, in my
> |> case, this greatly _increases_ the security of the system.
> |
> | You have a poor understanding of Unix security if you think it's good
> | that files and whatever uses them are on different accounts, and if you
> | think making a (fake) Windows installation publicly accessible (and
> | modifiable) by every other user on the system can possibly be called 
> secure.
> 
> I'm afraid there is not space here to describe the Rainbow security
> system.  However, I am operating in a special environment in which the
> system has a single human user, and unix uid's have been repurposed to
> provide software isolation.  I am not, in fact, suggesting making .wine/
> publicly accessible.  I am actually using "chmod g+rwx" to make .wine/
> available to a particular application, because each application has a
> unique gid.  Also, Rainbow uses namespaced bindmounts in such a way that
> applications not running with the gid in question cannot even determine
> that this .wine/ directory exists.

Well, you could perhaps relax the Wine checks for this special case, but 
such a patch could still not avoid "compromising the security of users 
in the general case".

> Bug #11112 suggests that it may be possible to solve this problem using
> dynamically generated symlinks.  I will try that.

The big reason .wine has to be owned by the right user is that the 
wineserver socket is stored there. That's what the check really 
protects. Everything else can be symlinked in, yes.





From bmschwar at fas.harvard.edu  Sat Apr 12 11:52:11 2008
From: bmschwar at fas.harvard.edu (Benjamin M. Schwartz)
Date: Sat, 12 Apr 2008 12:52:11 -0400
Subject: Wine on OLPC
In-Reply-To: <4800E1CF.6090508@arcticnet.no>
References: <47FFED51.30608@fas.harvard.edu>	<22821af30804111607g283f398cg914e4461ba06c70d@mail.gmail.com>	<47FFF025.1070405@fas.harvard.edu>	<22821af30804111622o5313a0adu74f68daa564597a8@mail.gmail.com>	<48000620.6020902@fas.harvard.edu>	<22821af30804111753h40f9219fq783d57847534f9d3@mail.gmail.com>	<48004094.6010602@fas.harvard.edu>	<4800D309.4090406@arcticnet.no>
	<4800D723.8000104@fas.harvard.edu> <4800E1CF.6090508@arcticnet.no>
Message-ID: <4800E8BB.1000808@fas.harvard.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Ove Kaaven wrote:
| Benjamin M. Schwartz skrev:
|> Bug #11112 suggests that it may be possible to solve this problem using
|> dynamically generated symlinks.  I will try that.
|
| The big reason .wine has to be owned by the right user is that the
| wineserver socket is stored there. That's what the check really
| protects. Everything else can be symlinked in, yes.

This appears to have worked.  WINEPREFIX cannot be a symlink, but making
it a directory with 5 symlinks in it solves the problem.

If the developers want to create a high barrier to running Wine under
multiple uid's, this is not a bad balance point.  Perhaps I will document it.

- --Ben
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.7 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFIAOi7UJT6e6HFtqQRAk1tAJ0cWn0ufywjXm2hrLBd3K0iN7KEyACfQfkz
iABAYzKR4F2amr7DtVVsy5o=
=KJ6Y
-----END PGP SIGNATURE-----


From hverbeet at gmail.com  Sat Apr 12 12:55:53 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Sat, 12 Apr 2008 19:55:53 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804121705.26521.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804121334.12321.stefan@codeweavers.com>
	<d658b69e0804120606k747928b2qd079aef9ce179289@mail.gmail.com>
	<200804121705.26521.stefan@codeweavers.com>
Message-ID: <d658b69e0804121055v5aebcab5jb190bb7bd3c10c4b@mail.gmail.com>

On 12/04/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> But since D3D vertex shaders always read the numbered arrays and fixed
>  function always reads the named arrays the named arrays get de-facto replaced
>  as far as we're concerned.
>
Which is completely irrelevant for classifying the operation.
Please read the ARB_vertex_program spec, issue 3 and the
ARB_fragment_program spec, issue 13 to get a better idea of what
shaders replace and what they don't.

>  > You only need two. One to toggle writing 1.0 to the 4th coordinate
>  > when needed, and one to toggle copying the 3th coordinate to the 4th
>  > when needed. It would certainly beat doing an extension check for
>  > every possible backend. Right now we always do the fixup, so in that
>  > respect it would be an improvement as well.
>
> I'm working on a patch that makes the atifs shader code take care of applying
>  the texture transform matrix. That works naturally without any flags or
>  backend check if you don't try to split vertex and fragment processing by
>  force.
>
If the issue is that you've got an interest in keeping the existing
structure because you've already written code on top of it there's not
much point in having this discussion in the first place. If that's not
the issue, I'd like to mention that the whole point of having
interfaces is that you can avoid ugliness like setting vertex
processing state in the fragment processing part of the pipeline.
There's also nothing forceful about splitting your pipeline in vertex
and fragment processing, that's how the hardware works, it's how GL
works, and it's how D3D works.

>  > That depends on the fog type. Vertex fog is a vertex state, fragment
>  > fog is a fragment state. Changing the type would obviously have
>  > interactions with both parts of the pipeline.
>
> On the GL side both vertex and fragment fog are applied to the same GL state.
>  Using a ARBFP or GLSL fragment shader replaces vertex fog as well, so you'll
>  have to implement both types in the fragment processing replacement.
>
The fog blending is a fragment operation, yes. Coordinate calculation
depends on the coordinate source and fog hint, and can happen either
during vertex processing, fragment processing or not at all if fog
coordinates are specified.

>  The fog settings depend on the vertex decl(XYZ vs XYZRHW) and the shader
>  properties("foggy shader"). That means the fragment processing code(pixel
>  shader and ffp replacement) would look at the core of the vertex processing
>  settings. Doesn't that defeat separating them in the first place?
>
No, like you correctly mention below, the point is to separate the
implementation, not where the implementation gets its information from
on the D3D side.

>  (I understand that you want to split the state types on the GL side, not the
>  D3D side. But when you split applying of one D3D state in 3 pieces, I fail to
>  see how it is cleaner)
>
This would hardly be something new. You mentioned the
vertexdeclaration state yourself that modifies multiple GL states, and
it's hardly the only one.

>  You didn't answer how you plan to implement state dirtification. You have a
>  SetRenderState call that changes render state X. Which implementation
>  state(s) do you dirtify? Ie:
>
>
>  >
>  device->fragment_state_manager->mark_state_dirty(device->fragment_private_data,
>  > state);
>
>
> Where does "state" come from?
>
I don't remember you asking, but I see no reason to change the basic
way dirtification is currently done.

>
>  > if (!use_vs) {
>  >     device->vertex_state_manager->apply_states(device->vertex_private_data);
>  > }
>
> > ...
>  This would be done where?
>
ActivateContext, CTXUSAGE_DRAWPRIM. (Yes it should probably be part of
the context, not the device, my bad.)

> No, I mean a D3D (3.0) vertex shader that is translated and running via GLSL.
>  Currently the pixel shader decides where the vertex shader(all versions)
>  writes the varyings to(generate_param_reorder_function). If a fixed function
>  vertex replacement shader and pre-3.0 shader writes to the regular fixed
>  function output, how would you run a pixel shader like the one in
>  vshader_version_varying_test() in visual.c together with a 1.x or 2.0 vertex
>  shader, or XYZRHW data from a GLSL vertex pipeline replacement shader? (With
>  the fixed function GL vertex pipeline we're screwed, but we aren't
>  necessarily screwed with a GLSL vertex pipeline replacement)
>
The pipeline object would certainly have access to all the information
required to create such a reordering function, but I fail to see how
it's relevant at this point. The idea here certainly isn't to
magically fix all state and shader related issues in wined3d, it's
just about making fixed function replacement shaders possible in a
maintainable way.

> What I meant was that: Scenario 1:
>  GLSL is used for pixel shaders and fragment pipeline replacement. How do I
>  find out if I have to link the fragment replacement GLSL shader or the pixel
>  shader GLSL shader into my program I activate? -> Share private data between
>  GLSL shader backend and GLSL fixed function object
>
>  Followup scenario 2: We don't have a GLSL fixed function backend yet. I have
>  an ATI X1600 card, I am using GLSL for pixel shaders, and I am using ATIFS
>  for the pipeline replacement. The GLSL pixel shader code reads the GLSL
>  fragment pipeline replacement private data. -> This GLSL fragment replacement
>  private data is either nonexistant or hanging around without code maintaining
>  it. How do we deal with that?
>
Not exactly. In the first place, if there's no GLSL fixed function
implementation you'll never have to link to it, simple as that. Now in
case there *is* a GLSL fixed function replacement but it isn't used
(for whatever reason), that simply means the GLSL pipeline object's
private data will tell it it doesn't have to link anything (or rather,
*not* tell it it has to link to the ffp replacement).

There really is no distinction between "pixel shader private data" and
"ffp replacement private data", they're both pointers to the same
block of memory, and eg. the shader backend will always only get
passed its own private data.

I'd also like to note that most of the issues you bring up are not new
or specific to this design at all, and some of them wouldn't work at
all with the current structure.


From kai.blin at gmail.com  Sat Apr 12 17:14:51 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Sun, 13 Apr 2008 00:14:51 +0200
Subject: Trying to get a grip on how to handle bug reports.
Message-ID: <200804130014.58380.kai.blin@gmail.com>

Hi folks,

I seem to have done something wrong referring a user to a closed bug report 
that seemed to be related to the problem he was having. (See bug 11639 for 
more context)

So in order to avoid me being the cause a user defiles the holy status of a 
closed bug, I'd like to have some clear rules on how to handle related bug 
reports.

And you folks wonder why we don't have a healthy user community. Sometimes I 
feel like talking to a brick wall.

Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080413/c552ae9d/attachment.pgp 

From stefan at codeweavers.com  Sat Apr 12 17:28:16 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 13 Apr 2008 00:28:16 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <d658b69e0804121055v5aebcab5jb190bb7bd3c10c4b@mail.gmail.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804121705.26521.stefan@codeweavers.com>
	<d658b69e0804121055v5aebcab5jb190bb7bd3c10c4b@mail.gmail.com>
Message-ID: <200804130028.16152.stefan@codeweavers.com>

Am Samstag, 12. April 2008 19:55:53 schrieb H. Verbeet:
> Which is completely irrelevant for classifying the operation.
> Please read the ARB_vertex_program spec, issue 3 and the
> ARB_fragment_program spec, issue 13 to get a better idea of what
> shaders replace and what they don't.
Yes, GL says so, but I think strictly sticking to the GL classification is a 
bad idea, see below.

> If the issue is that you've got an interest in keeping the existing
> structure because you've already written code on top of it there's not
> much point in having this discussion in the first place. If that's not
> the issue, I'd like to mention that the whole point of having
> interfaces is that you can avoid ugliness like setting vertex
> processing state in the fragment processing part of the pipeline.
> There's also nothing forceful about splitting your pipeline in vertex
> and fragment processing, that's how the hardware works, it's how GL
> works, and it's how D3D works.
I agree that GL works that way(fragment-vertex split), and almost certainly 
graphics hardware as well, although we don't know unless we look at the 
drivers(how the hardware works is irrelevant since GL abstracts that). 
However, D3D does *not* work that way, otherwise there would not be any issue 
to discuss here, since then D3D states would perfectly match the GL ones. 

As I understand it, this discussion comes down to the designing the state 
setting interface and implementation in an OpenGL oriented way or a D3D 
oriented way.

@ keeping old code: That's not too much of an issue, but you attacked my 
design on the grounds of a missing implementation of a functionality, so I 
explained how that would be implemented.

> > device->fragment_state_manager->mark_state_dirty(device->fragment_private
> >_data,
> >
> >  > state);
> >
> > Where does "state" come from?
>
> I don't remember you asking, but I see no reason to change the basic
> way dirtification is currently done.
Where does SetRenderState(or any other state setter) know if it has to dirtify 
a fragment, vertex, misc state, or multiples of them?

> >  > if (!use_vs) {
> >  >    
> >  > device->vertex_state_manager->apply_states(device->vertex_private_data
> >  >); }
> > >
> > > ...
> >
> >  This would be done where?
>
> ActivateContext, CTXUSAGE_DRAWPRIM. (Yes it should probably be part of
> the context, not the device, my bad.)
That means polling the states that use_vs() and use_ps() check for changes 
instead of getting notified about changes, as well as polling the 
SetPixelShader and SetVertexShader settings(via select_shader()). Avoiding 
polling was one of the goals of the state management rewrite more than a year 
ago. I don't think there's any relevant performance penalty in doing the 
little polling you suggest, but where do we draw the line?

> The pipeline object would certainly have access to all the information
> required to create such a reordering function, but I fail to see how
> it's relevant at this point. The idea here certainly isn't to
> magically fix all state and shader related issues in wined3d, it's
> just about making fixed function replacement shaders possible in a
> maintainable way.
It is insofar relevant as it affects the issues we can later on fix with the 
pipeline replacement and which we cannot. If the GLSL vertex pipeline 
replacement shader can only write to the builtin varying because the pixel 
shader input expects it that way, we'll never be able to fix the todo_wines 
in fixed_function_varying_test() in visual.c

> ...
> There really is no distinction between "pixel shader private data" and
> "ffp replacement private data", they're both pointers to the same
> block of memory, and eg. the shader backend will always only get
> passed its own private data.
Point taken, I see now how you can sort that out the fixed function 
replacement vs shader activation in the same backend via the private data. 
You'll have to watch out though that the default initialization value is a 
valid "do not load a replacement shader" request.

> I'd also like to note that most of the issues you bring up are not new
> or specific to this design at all, and some of them wouldn't work at
> all with the current structure.
Surely they aren't specific, but I do not see any that would not work with the 
current structure. Agreed, using ATIFS fragment processing + ARBFP / GLSL 
pixel shaders needs 3 inherited ATIFS shader backends, which is ugly, I 
agree. But it does not hide the ugliness and makes the issues that mixing GL 
shader functionality causes explicit. It does not limit the fixed function 
replacement to the lowest common denoimator(GL fixed function) and allows us 
to flexibly use additional features of GL extensions or GLSL to fix bugs we'd 
otherwise have to mark as WONTFIX.

I think designing the state setting interface in a D3D oriented way is better 
because it is opengl extension independent. If the state setting API is built 
on the GL state classifications some additional layer to deal with the 
differences of the state implementations is needed(e.g. by giving vertex, 
fragment and misc state setters a full state table each). Additionally with 
the splitup there is the already discussed hidden issue of implementation 
interactions which I don't think can be consumed in the abstraction layers, 
and the mentioned issue with the lowest common denominator interface of the 
fixed function replacement shaders.


From truiken at gmail.com  Sat Apr 12 17:57:52 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 12 Apr 2008 17:57:52 -0500
Subject: Trying to get a grip on how to handle bug reports.
In-Reply-To: <200804130014.58380.kai.blin@gmail.com>
References: <200804130014.58380.kai.blin@gmail.com>
Message-ID: <22821af30804121557t2e560a85ub1d5a9ecc55dbadb@mail.gmail.com>

On Sat, Apr 12, 2008 at 5:14 PM, Kai Blin <kai.blin at gmail.com> wrote:
> Hi folks,
>
>  I seem to have done something wrong referring a user to a closed bug report
>  that seemed to be related to the problem he was having. (See bug 11639 for
>  more context)
>
>  So in order to avoid me being the cause a user defiles the holy status of a
>  closed bug, I'd like to have some clear rules on how to handle related bug
>  reports.
>

It's actually a lot simpler than that.  While we don't want users
filing duplicate bug reports, a bug can't be a duplicate of another
bug that is already fixed.  The right thing to do would be to tell
that user to file a new bug report, referring to the closed bug report
if he really feels like it.  Sure they very well maybe be related, but
the fact remains that one bug is fixed, while another bug is not
fixed.  Thus, they're not the same bug.  By the way, if you really
want to help this situation, I don't recommend the sarcasm.

>  And you folks wonder why we don't have a healthy user community. Sometimes I
>  feel like talking to a brick wall.
>

http://bugs.winehq.org/show_bug.cgi?id=11639#c16
http://bugs.winehq.org/show_bug.cgi?id=11639#c18

Those are links to my comments for the bug report in question.  The
user was told to file a new bug report.  Once the user kept commenting
in the closed bug report (and not filing a new bug report), I told him
to stop posting in a closed bug.  Since when is this not standard?

-- 
James Hawkins


From ivg231 at gmail.com  Fri Apr 11 21:27:01 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Fri, 11 Apr 2008 22:27:01 -0400
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804111618.49900.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804110959.56731.stefan@codeweavers.com>
	<d658b69e0804110139n5182168bk54498b4e2ba02a7e@mail.gmail.com>
	<200804111618.49900.stefan@codeweavers.com>
Message-ID: <48001DF5.3050401@gmail.com>

Stefan D?singer wrote:
> Alexandre didn't commit the patch, I think we should come to an agreement on 
> this issue, otherwise it is going to come up again and again.
>   
The fundamental issue is pretty straightforward - not sure why it's so 
difficult to come to an agreement.

    - You want to mix and match vertex and fragment GL backends
    - The only maintainable way to do that is to define an interface 
between vertex and fragment objects

    - You're concerned about the interface constraining the ability of 
fragment to talk to vertex
    - Write a smarter interface, I also suggested an object to manage it 
(linker).

You can't have it both ways - ability to mix and match backends, and 
unconstrained interface. The interface doesn't have to be "the lowest 
common denominator" - it could be the highest common denominator if 
properly written. As Henri pointed out the fact that both GL and the 
hardware are vertex/fragment aligned naturally suggests we should break 
up things the same way. Even the D3D programmable pipeline is broken up 
this way (there are Pixel and Vertex shader objects) - and the fixed 
pipeline is going away, so if anything we should move away from its 
interface.

    - You want to replace the fixed pipeline using GL shaders.
    - Then replace the fixed pipeline - this has nothing to do with the 
programmable pipeline, therefore should not affect any programmable 
pipeline interfaces.

You've pointed out that shader_backend_t is more aligned to a GL 
extension than it is to a D3D shader. If that's the case I see little 
value to having that interface - it will just cause confusion as 
unrelated functionalities are packed into it. The disparity between GL 
extensions will get greater as we try to add new features using a 
particular extension, and we'll see a lot of functions that are just 
empty forwards to other "shader backends", since they don't support 
something themselves.

Ivan



From dmitry at codeweavers.com  Sun Apr 13 00:51:23 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 13 Apr 2008 14:51:23 +0900
Subject: wine.info add fake dlls for msacm32.drv and midimap.dll
References: <19e31a080804122129j75bc068cr1fe1e023e05aa011@mail.gmail.com>
Message-ID: <024001c89d2a$698bdc60$a600fea9@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> trace:winmm:DllMain 0x7e250000 0x1 (nil)
> trace:winmm:MMDRV_Init () trace:winmm:MMDRV_Install
> ('winealsa.drv', 'winealsa.drv', mapper=N);
> warn:winmm:MMDRV_Install Couldn't open driver 'winealsa.drv'
> trace:winmm:MMDRV_Install ('wineoss.drv', 'wineoss.drv',
> mapper=N); warn:winmm:MMDRV_Install Couldn't open driver 'wineoss.drv'
> trace:winmm:MMDRV_Install ('winecoreaudio.drv',
> 'winecoreaudio.drv', mapper=N); warn:winmm:MMDRV_Install
> Couldn't open driver 'winecoreaudio.drv'
> trace:winmm:MMDRV_Install ('wavemapper', 'msacm32.drv',
> mapper=Y); warn:winmm:MMDRV_Install Couldn't open driver 'msacm32.drv'
> trace:winmm:MMDRV_Install ('midimapper', 'midimap.dll',
> mapper=Y); warn:winmm:MMDRV_Install Couldn't open driver 'midimap.dll'
> 
> With this patch the firefox thinstall demo bug 10905 now works. I
> expect there may be other problems with other thinstall applications
> as he thinks there may be some changes that need to be done on their
> end to better accommodate Wine. I don't know if this really should be
> the case as it works on Windows and we should try to mimic that
> behavior.

DLLs are being added to wine.inf only if an app does check for a dll
existence, which is not the case here. You need to investigate further
what is going on.

-- 
Dmitry.


From winehacker at gmail.com  Sun Apr 13 00:56:29 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 13 Apr 2008 01:56:29 -0400
Subject: wine.info add fake dlls for msacm32.drv and midimap.dll
In-Reply-To: <024001c89d2a$698bdc60$a600fea9@DMITRY>
References: <19e31a080804122129j75bc068cr1fe1e023e05aa011@mail.gmail.com>
	<024001c89d2a$698bdc60$a600fea9@DMITRY>
Message-ID: <19e31a080804122256h6b4a5534m6b61acae87f8c479@mail.gmail.com>

Hi,

On Sun, Apr 13, 2008 at 1:51 AM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
>  DLLs are being added to wine.inf only if an app does check for a dll
>  existence, which is not the case here. You need to investigate further
>  what is going on.

This is what Ge said

--

I dug a bit deeper and understand what's going on now. Winmm (in driver.c)
will try to load the low-level drivers using LoadLibrary. Thinstall
intercepts that LoadLibrary call and tries to locate the driver, e.g.
wineoss.drv, using the normal Windows search path for DLLs. We can't find
the file because its not stored in the "normal" places like
C:\Windows\System32 but in the build tree. So we fail the load and return
error code 2 (ERROR_FILE_NOT_FOUND). Wine's LoadLibrary knows where to
search in the build tree and would have no problem locating it.

Unfortunately, we can't just pass the call on the Windows (or rather Wine)
if we can't find a file. The reason we can't find a file might be that the
application has deleted it. When a virtualized app deletes a file, we don't
really delete the file but mark it internally as deleted. If we pass on a
LoadLibrary call to Windows on a file that doesn't exist as far as the app
is concerned, Windows would still happily load it (we only hide the file
from the app, not from Windows).

--

If I understand the issue correctly the problem is in Wine. The
application works on Windows no problem. The Thinstall LoadLibrary
hook can't be expected to know about builtin dlls if its searching the
default directories or looking up KnownDLLs in the registry and they
are not there, then failure is by design.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Sun Apr 13 00:57:07 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 13 Apr 2008 01:57:07 -0400
Subject: wine.info add fake dlls for msacm32.drv and midimap.dll
In-Reply-To: <19e31a080804122256h6b4a5534m6b61acae87f8c479@mail.gmail.com>
References: <19e31a080804122129j75bc068cr1fe1e023e05aa011@mail.gmail.com>
	<024001c89d2a$698bdc60$a600fea9@DMITRY>
	<19e31a080804122256h6b4a5534m6b61acae87f8c479@mail.gmail.com>
Message-ID: <19e31a080804122257k21435dc0w65e76e9084651a8@mail.gmail.com>

On Sun, Apr 13, 2008 at 1:56 AM, Steven Edwards <winehacker at gmail.com> wrote:

>  If I understand the issue correctly the problem is in Wine. The
>  application works on Windows no problem. The Thinstall LoadLibrary
>  hook can't be expected to know about builtin dlls if its searching the
>  default directories or looking up KnownDLLs in the registry and they
>  are not there, then failure is by design.

This part was my thoughts on the subject.



-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Sun Apr 13 00:58:45 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 12 Apr 2008 22:58:45 -0700
Subject: Trying to get a grip on how to handle bug reports.
Message-ID: <a71bd89a0804122258s5e9e9a11i417729a30feb762b@mail.gmail.com>

James wrote:
> [ http://bugs.winehq.org/show_bug.cgi?id=11639#c15 et seq.]
> Once the user kept commenting
> in the closed bug report (and not filing a new bug report), I told him
> to stop posting in a closed bug.  Since when is this not standard?

The problem is, the user felt he was treated rudely:
"I will report a new bug, but don't treat me like i'm an
idiot or someone who deliberatly is spamming in closed bug reports."
and I tend to agree.  In this case, the user didn't need
education, he just needed to be gently told that
a new bug needs to be filed.
- Dan


From dmitry at codeweavers.com  Sun Apr 13 05:46:08 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 13 Apr 2008 19:46:08 +0900
Subject: urlmon: add stub for CoInternetSetFeatureEnabled
References: <784229.68185.qm@web23202.mail.ird.yahoo.com>
Message-ID: <003301c89d53$97751be0$a600fea9@DMITRY>

"Louis. Lenders" <xerox_xerox2000 at yahoo.co.uk> wrote:

> +HRESULT WINAPI  CoInternetSetFeatureEnabled(INTERNETFEATURELIST Feature, DWORD flags, BOOL fEnable)
> +{
> +    FIXME("%p, 0x%08x, %x, stub\n", &Feature, flags, fEnable);
> +    return E_NOTIMPL;
> +}
> diff --git a/dlls/urlmon/urlmon.spec b/dlls/urlmon/urlmon.spec
> index 1fa2f94..e89e049 100644
> --- a/dlls/urlmon/urlmon.spec
> +++ b/dlls/urlmon/urlmon.spec
> @@ -19,6 +19,7 @@
> @ stdcall CoInternetGetSession(long ptr long)
> @ stdcall CoInternetParseUrl(wstr long long wstr long ptr long)
> @ stdcall CoInternetQueryInfo(ptr long long ptr long ptr long)
> +@ stdcall CoInternetSetFeatureEnabled(ptr long long)

The first parameter of CoInternetSetFeatureEnabled is not a pointer even
if you pretend it is in the FIXME. Also Please use consistent spacing and
naming of variables (preferring 1 space and no hungarian/upper cased names).

-- 
Dmitry.


From bmschwar at fas.harvard.edu  Sun Apr 13 10:07:14 2008
From: bmschwar at fas.harvard.edu (Benjamin M. Schwartz)
Date: Sun, 13 Apr 2008 11:07:14 -0400
Subject: Desktop, x11drv, and _NET_WM_WINDOW_TYPE_DIALOG
Message-ID: <480221A2.8030403@fas.harvard.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

According to xprop, Wine is creating the desktop window with
_NET_WM_WINDOW_TYPE = _NET_WM_WINDOW_TYPE_DIALOG.  This is problematic for
me, because of the way my window manager (Matchbox) handles dialogs.  Is
there a reason that the desktop is not _NET_WM_WINDOW_TYPE_NORMAL?

I have tried to trace this through the code, and I wind up at
x11drv/desktop.c, but I don't see any reference to DIALOG there.
Alternatively, perhaps it is set with MAKEINTATOM at the top of
explorer/desktop.c, but I'm not sure how to interpret that constant.

- --Ben
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.7 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFIAiGiUJT6e6HFtqQRAvgmAJ0XJohI9u7VYzorTgKenG1qJpJzeACdEiqR
dUAVRyREOtjfx/bAgrUUeQ8=
=PkkE
-----END PGP SIGNATURE-----


From tony.wasserka at freenet.de  Sun Apr 13 11:22:29 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Sun, 13 Apr 2008 18:22:29 +0200
Subject: d3dx9_36: Add stubs and implementations for D3DXCreateTexturexx
Message-ID: <E1Jl4yL-00045q-1D@www19.emo.freenet-rz.de>

Hi,
Are you still working on the texture functions?
I'd need them for completing my ID3DXSprite implementation,
so if you don't mind I could complete your started patches.

Best regards,
    Tony




Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain inkl.
http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/index.html



From winehacker at gmail.com  Sun Apr 13 12:11:41 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 13 Apr 2008 13:11:41 -0400
Subject: Including Mono within a Wine package - should Wine expect this?
In-Reply-To: <20080411125059.293230@gmx.net>
References: <a71bd89a0804100645y2b7f9c94n719ab5f19374db04@mail.gmail.com>
	<47FECF9E.1030309@open-vote.org>
	<a71bd89a0804101954w31a24e2fn72c027796b771a6e@mail.gmail.com>
	<47FF506D.4010102@open-vote.org> <20080411125059.293230@gmx.net>
Message-ID: <19e31a080804131011s11342880qd0ee9d2981a1c9be@mail.gmail.com>

On Fri, Apr 11, 2008 at 8:50 AM, Roderick Colenbrander
<thunderbird2k at gmx.net> wrote:
>  For a part the issue is that lots of programs are hybrid ones. Some of them behave 'nicely' in the way they just call a few functions from a native win32 dll. I think apps that embed COM objects (like a Word viewer, ..) are worse as mono doesn't offer this at all. The most problematic thing is that mono's windows.forms is fully managed while microsoft just layered it on top of gdi32/gdiplus/user32. This allows you to use standard win32 apis on most windows.forms controls to override behavior. A lot of apps do this, so even if you could access native win32 dlls, magic like this won't work at all. Second COM objects might also rely on evil win32 magic.

Rather than ignoring mono these issues make it sound like Wine and
mono should try to work together again. The EULA for the .NET runtime
prohibits distributing it and using it on non-windows licensed systems
so we are in much the same legal situation with IE where we have to
have a replacement.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From wine-devel at kievinfo.com  Sun Apr 13 12:54:53 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 13 Apr 2008 11:54:53 -0600
Subject: loader: print a better message about reserving memory
In-Reply-To: <b6bb06270804122057n31449f68l6767edff89c1256e@mail.gmail.com>
References: <b6bb06270804122057n31449f68l6767edff89c1256e@mail.gmail.com>
Message-ID: <480248ED.1090207@kievinfo.com>

Austin English wrote:
> With ubuntu updating to the 2.6.24 kernel, a lot more people are
> running into errors about reserving memory. This patch adds a
> suggestion to check  /etc/sysctl.conf.
> 
> You may need to edit /etc/sysctl.conf to give Wine access to this memory.\n",

Can you be more specific what did Ubuntu do to break Wine?

Vitaliy.


From wine-devel at kievinfo.com  Sun Apr 13 13:07:29 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 13 Apr 2008 12:07:29 -0600
Subject: dinput: Convert keyboard buffer from internal data format to
	user data format
In-Reply-To: <4802384D.1090704@gmail.com>
References: <4802384D.1090704@gmail.com>
Message-ID: <48024BE1.1090008@kievinfo.com>

Sergey Khodych wrote:
> 
> 
> 
Any particular reason for this? Do you have a program that sets different 
data format? The reason I ask - copying 256 bytes is much faster then 
iterating over the whole data format and copying one byte at a time.

Vitaliy.


From wine-devel at kievinfo.com  Sun Apr 13 13:15:30 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 13 Apr 2008 12:15:30 -0600
Subject: dinput: Implement DIPROP_KEYNAME property for keyboard device
In-Reply-To: <48023854.9020308@gmail.com>
References: <48023854.9020308@gmail.com>
Message-ID: <48024DC2.3020008@kievinfo.com>

Sergey Khodych wrote:
> 
> 
> ------------------------------------------------------------------------
> 
> 

> +static HRESULT WINAPI SysKeyboardAImpl_GetProperty(
> ...
> +    if (TRACE_ON(dinput))
> +        _dump_DIPROPHEADER(pdiph);
Please drop the TRACE_ON check - it's being done in dump function.

> ...
> +                hr = SysKeyboardWImpl_GetObjectInfo( (LPDIRECTINPUTDEVICE8W)iface , &didoi,
> +                                                     ps->diph.dwObj, ps->diph.dwHow );

You mixing unicode and ascii. Also if you are implementing 
SysKeyboardAImpl_GetProperty you should also implement it's unicode 
counterpart SysKeyboardWImpl_GetProperty.

And please use 4-space indent.

Vitaliy.


From luis.busquets at ilidium.com  Sun Apr 13 13:41:05 2008
From: luis.busquets at ilidium.com (Luis Busquets)
Date: Sun, 13 Apr 2008 20:41:05 +0200
Subject: d3dx9_36: Add stubs and implementations for D3DXCreateTexturexx
In-Reply-To: <E1Jl4yL-00045q-1D@www19.emo.freenet-rz.de>
References: <E1Jl4yL-00045q-1D@www19.emo.freenet-rz.de>
Message-ID: <480253C1.9010604@ilidium.com>

The files that I have for textures are attached.

tony.wasserka at freenet.de escribi?:
> Hi,
> Are you still working on the texture functions?
> I'd need them for completing my ID3DXSprite implementation,
> so if you don't mind I could complete your started patches.
>
> Best regards,
>     Tony
>
>
>
>
> Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain inkl.
> http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/index.html
>
>   

-------------- next part --------------
A non-text attachment was scrubbed...
Name: cubetexture.c
Type: text/x-csrc
Size: 3357 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080413/4a09b2e4/attachment.c 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: texture.c
Type: text/x-csrc
Size: 1932 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080413/4a09b2e4/attachment-0001.c 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: volumetexture.c
Type: text/x-csrc
Size: 2049 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080413/4a09b2e4/attachment-0002.c 

From alexd4 at inbox.lv  Sun Apr 13 14:01:38 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Sun, 13 Apr 2008 22:01:38 +0300
Subject: Trying to get a grip on how to handle bug reports.
In-Reply-To: <22821af30804121557t2e560a85ub1d5a9ecc55dbadb@mail.gmail.com>
References: <200804130014.58380.kai.blin@gmail.com>
	<22821af30804121557t2e560a85ub1d5a9ecc55dbadb@mail.gmail.com>
Message-ID: <48025892.3090502@inbox.lv>

James Hawkins wrote:
> On Sat, Apr 12, 2008 at 5:14 PM, Kai Blin <kai.blin at gmail.com> wrote:
>> Hi folks,
>>
>>  I seem to have done something wrong referring a user to a closed bug report
>>  that seemed to be related to the problem he was having. (See bug 11639 for
>>  more context)
>>
>>  So in order to avoid me being the cause a user defiles the holy status of a
>>  closed bug, I'd like to have some clear rules on how to handle related bug
>>  reports.
>>
> 
> It's actually a lot simpler than that.  While we don't want users
> filing duplicate bug reports, a bug can't be a duplicate of another
> bug that is already fixed.  The right thing to do would be to tell
> that user to file a new bug report, referring to the closed bug report
> if he really feels like it.  Sure they very well maybe be related, but
> the fact remains that one bug is fixed, while another bug is not
> fixed.  Thus, they're not the same bug.  By the way, if you really
> want to help this situation, I don't recommend the sarcasm.
> 
>>  And you folks wonder why we don't have a healthy user community. Sometimes I
>>  feel like talking to a brick wall.
>>
> 
> http://bugs.winehq.org/show_bug.cgi?id=11639#c16
> http://bugs.winehq.org/show_bug.cgi?id=11639#c18
> 
> Those are links to my comments for the bug report in question.  The
> user was told to file a new bug report.  Once the user kept commenting
> in the closed bug report (and not filing a new bug report), I told him
> to stop posting in a closed bug.  Since when is this not standard?
> 

I think bugzilla operators are a bit too trigger happy lately, in particular 
with abandoning bugs. For example: http://bugs.winehq.org/show_bug.cgi?id=12437

"The tests aren't time consuming, but if you choose to not do the tests, we'll
have to close this bug as abandoned."

And there's a link mentioned in comments to downloadable trial that can 
(reportedly) be used to reproduce. Sure, the user should've filled the URL 
field. But, it's pointless to expect users to 1) do everything right 2) follow 
their bugs indefinitely (sometimes for years). 3) always be willing to do time 
consuming and otherwise demanding operations like regression test.

If a user submitted enough info to make it possible for developer to reproduce 
or otherwise make sense of a bug, he has already done a commendable job. IMHO 
care should be taken not to "abandon" bugs without good reason, such as bug 
description that makes no sense, absence of any useful logs and obscure app for 
which no download can be googled and user not responding for a long period of time.


From stefan at codeweavers.com  Sun Apr 13 14:26:19 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 13 Apr 2008 21:26:19 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <48001DF5.3050401@gmail.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<200804111618.49900.stefan@codeweavers.com>
	<48001DF5.3050401@gmail.com>
Message-ID: <200804132126.19422.stefan@codeweavers.com>

Am Samstag, 12. April 2008 04:27:01 schrieb Ivan Gyurdiev:
> Stefan D?singer wrote:
> > Alexandre didn't commit the patch, I think we should come to an agreement
> > on this issue, otherwise it is going to come up again and again.
>
> The fundamental issue is pretty straightforward - not sure why it's so
> difficult to come to an agreement.
>
>     - You want to mix and match vertex and fragment GL backends
>     - The only maintainable way to do that is to define an interface
> between vertex and fragment objects
I certainly see the advantages of a constrained interface, I just don't 
see(and still don't see) how it can be designed cleanly without greatly 
limiting functionality of the pipeline / shader implementation.

I discussed the topic with Henri on IRC again(@Henri: Please correct me if I 
missunderstood you), and he explained that his plans consider making GLSL 
vertex shaders, GLSL vertex replacement, GLSL fragment replacement and GLSL 
fragment replacement one object with different interfaces. So we can have 
backchannel communication between the various interface implementations(e.g. 
flags or private data) which keeps everything flexible. It's not precisely 
nice(backchannel communication somewhat defeats the point of interfaces), but 
my design has ugliness as well, so I can live with that.

What's most important to me about this is that we don't have to close any bug 
as WONTFIX due to design constraints. So I can stop feeling strongly against 
splitting up the interface since the implementations remain the same.

Now the main issue with not splitting up the interfaces I see is that it is 
unclear what code in state.c(or the shader backend's state table) changes 
which GL state. If state_something changes both vertex and fragment GL states 
I can't overwrite it properly in the ATIFS/NVRC code without messing with the 
vertex side as well.

I have a few remaining issues though:
-> With splitting up the state table there are now 5 "root" states which have 
to be polled for changes in CTXUSAGE_DRAWPRIM setting, also the 
GL_TEXTURE_SHADER_NV and GL_FRAGMENT_SHADER_ATI states need to be polled for 
enabling/disabling. Is there no way to avoid that?

-> Some cross pipeline part communication issues are still remaining, see 
below

-> Increased state dirtification complexity: Now each Set*State has to find 
out which part of the pipeline it has to dirtify(a switch-case statement or 
probably table referencing), and has to dirtify up to 3 pipelines. That's not 
precicely going to help performance.

I know that Ivan doesn't really care about that, especially since it's not an 
algorithmic complexity change. However, performance is a top priority issue, 
and no gamer will accept the next-gen hardware excuse for inefficient code.

I mainly want to avoid more bad PR like this:
http://www.phoronix.com/scan.php?page=article&item=938
http://www.phoronix.com/scan.php?page=article&item=crossover_games

The 2nd article would be good for me if it was due to a tuneup in cxgames, but 
it is a regression in wine instead. Yes, that's phoronix and all, and the 
first article's regressions are technically perfectly explainable. Still new 
features don't have to come with performance costs. I have a ~5% performance 
regression myself which I don't know where it comes from.

So I propose the following plan:

1) We commit the patch to fix fglrx

2) We keep the shader / ffp interface as it is for Wine 1.0. We freeze in two 
weeks. I am away for one week now, so if anyone wants any shader interface 
changes in 1.0 he'll have to do it himself

3) We investigate where the recent performance regression(s) came from

4) We audit the state handlers in state.c and find out which D3D state handler 
changes which parts of the GL pipeline and find states that touch more than 
one part and why.

5) Build a battle plan how to separate the following D3D states in various GL 
pipeline parts:

-> Vertex shaders - streams. The tricky part here is that the fixed function 
GL vertex pipeline needs named arrays, while an ARB/GLSL vertex pipeline 
needs numbered arrays(otherwise no vertex blending emulation). How do we 
communicate the need for numbered arrays, and the choosen assignment?

-> vertex decl - loaded pointers. We're currently checking the vertex shader 
and fog states when a vertex buffer offset it changed, that is not needed

-> Samplers - GL_TEXTURE_xD enable - colorop. That's a major pain for ATIFS 
and even more NVTS. I haven't found a nicer implementation using split up 
interfaces

-> How do we deal with the depth blit shaders? Do they belong to the shader 
backend, or to something else?

-> Should we move the SetupForBlit to some of the shader code? The blitting 
and state switching might be more efficient if we're using shaders for it and 
just set a ARB / GLSL shader instead of falling back to the absolute low 
level limit and killing all states

-> Texture transform flags, clipping, more?

My ultimate hope is to have a clean assignment for each code referenced by the 
state table to the pipeline part, so instead of splitting up the state table 
in code we have a programming guidelines about which part of the state table 
may be changed by which pipeline replacement to avoid the additional run-time 
costs. If that turns out to be impossible we need a clear assignment anyway 
for a splitup.

6) Investigate the performance implications of the state management, state 
polling, the current conditional state linking state dirtification checks and 
the driver side cost of fixed function state changing while a 

What are your opinions? (btw, I don't think I can implement that stuff alone 
anytime soon, I am pretty busy the next months)

> Even the D3D programmable pipeline is broken up 
> this way (there are Pixel and Vertex shader objects) - and the fixed 
> pipeline is going away, so if anything we should move away from its 
> interface.
One could argue that the name "pixel shader" already shows that Direct3D does 
not separate the pipeline parts properly(GL_NV_texture_shader, issue 1). 
Ironically pixel processing is one of the only remaining parts of Direct3D10 
that is not programmable.


From dank at kegel.com  Sun Apr 13 14:28:33 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 13 Apr 2008 12:28:33 -0700
Subject: Including Mono within a Wine package - should Wine expect this?
In-Reply-To: <19e31a080804131011s11342880qd0ee9d2981a1c9be@mail.gmail.com>
References: <a71bd89a0804100645y2b7f9c94n719ab5f19374db04@mail.gmail.com>
	<47FECF9E.1030309@open-vote.org>
	<a71bd89a0804101954w31a24e2fn72c027796b771a6e@mail.gmail.com>
	<47FF506D.4010102@open-vote.org> <20080411125059.293230@gmx.net>
	<19e31a080804131011s11342880qd0ee9d2981a1c9be@mail.gmail.com>
Message-ID: <a71bd89a0804131228w188ecd20r9802c35198b25764@mail.gmail.com>

On Sun, Apr 13, 2008 at 10:11 AM, Steven Edwards <winehacker at gmail.com> wrote:
>  Rather than ignoring mono these issues make it sound like Wine and
>  mono should try to work together again. The EULA for the .NET runtime
>  prohibits distributing it and using it on non-windows licensed systems
>  so we are in much the same legal situation with IE where we have to
>  have a replacement.

Yes, exactly.  I've been discussing this a bit on the mono list.

There are two big pieces of work needed:
1) support for mixed assemblies in Mono for Windows
2) porting Mono's WinForms on top of Wine gdiplus
instead of Mono gdiplus (and making it more win32-ish as
a result)

This would be a fine summer project for somebody properly motivated.

There will be more incentive to do this as we get Microsoft .NET working
better, and it becomes clearer just how many applications need one
or the other of the two items above to run.

In short: I think the path to Mono+Wine nivana at the moment leads
directly through enemy territory: we have to get MS .net working better first
before it's clear it'll be worth it.
- Dan


From truiken at gmail.com  Sun Apr 13 14:28:15 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 13 Apr 2008 14:28:15 -0500
Subject: Trying to get a grip on how to handle bug reports.
In-Reply-To: <48025892.3090502@inbox.lv>
References: <200804130014.58380.kai.blin@gmail.com>
	<22821af30804121557t2e560a85ub1d5a9ecc55dbadb@mail.gmail.com>
	<48025892.3090502@inbox.lv>
Message-ID: <22821af30804131228j7cd7d16cva450906cb2f0b54@mail.gmail.com>

On Sun, Apr 13, 2008 at 2:01 PM, Alexander Dorofeyev <alexd4 at inbox.lv> wrote:
>
> James Hawkins wrote:
>  > On Sat, Apr 12, 2008 at 5:14 PM, Kai Blin <kai.blin at gmail.com> wrote:
>  >> Hi folks,
>  >>
>  >>  I seem to have done something wrong referring a user to a closed bug report
>  >>  that seemed to be related to the problem he was having. (See bug 11639 for
>  >>  more context)
>  >>
>  >>  So in order to avoid me being the cause a user defiles the holy status of a
>  >>  closed bug, I'd like to have some clear rules on how to handle related bug
>  >>  reports.
>  >>
>  >
>  > It's actually a lot simpler than that.  While we don't want users
>  > filing duplicate bug reports, a bug can't be a duplicate of another
>  > bug that is already fixed.  The right thing to do would be to tell
>  > that user to file a new bug report, referring to the closed bug report
>  > if he really feels like it.  Sure they very well maybe be related, but
>  > the fact remains that one bug is fixed, while another bug is not
>  > fixed.  Thus, they're not the same bug.  By the way, if you really
>  > want to help this situation, I don't recommend the sarcasm.
>  >
>  >>  And you folks wonder why we don't have a healthy user community. Sometimes I
>  >>  feel like talking to a brick wall.
>  >>
>  >
>  > http://bugs.winehq.org/show_bug.cgi?id=11639#c16
>  > http://bugs.winehq.org/show_bug.cgi?id=11639#c18
>  >
>  > Those are links to my comments for the bug report in question.  The
>  > user was told to file a new bug report.  Once the user kept commenting
>  > in the closed bug report (and not filing a new bug report), I told him
>  > to stop posting in a closed bug.  Since when is this not standard?
>  >
>
>  I think bugzilla operators are a bit too trigger happy lately, in particular
>  with abandoning bugs. For example: http://bugs.winehq.org/show_bug.cgi?id=12437
>
>  "The tests aren't time consuming, but if you choose to not do the tests, we'll
>  have to close this bug as abandoned."
>

Can we all stop with the sensationalist comments?  Seriously.  If
you'll actually read what I said, I made no threats, nor was I rude.
I also didn't change the resolution of the bug, so where's the
trigger-pulling you refer to?  The only mistake I made, which was a
mistake on the part of everyone triaging this bug, was that I didn't
know the bug was freely reproducible.  That's the worst I did, and
that's not a big deal, and certainly not worth your reply.

>  And there's a link mentioned in comments to downloadable trial that can
>  (reportedly) be used to reproduce. Sure, the user should've filled the URL
>  field. But, it's pointless to expect users to 1) do everything right 2) follow
>  their bugs indefinitely (sometimes for years). 3) always be willing to do time
>  consuming and otherwise demanding operations like regression test.
>

On behalf of the regular bugzilla moderators (of which there are very
few), I'll go over the policy we have in place to keep, or strive to
attain, a manageable bugzilla database.  There are only a few
conditions that warrant abandoning a bug:

a) the bug must not be freely reproducible
b) the reporter has not responded to a request for more information in
at least 3 months, or
c) the reporter will not or can not provide the information requested,
usually not doing the regression testing

If you have a problem with any of these policies, bring it up in
wine-devel, but don't single me out.  We devote so much of our free
time to keep our bugzilla manageable, and a big part of that is
weeding out bugs which we can do nothing about (abandoned).

>  If a user submitted enough info to make it possible for developer to reproduce
>  or otherwise make sense of a bug, he has already done a commendable job. IMHO
>  care should be taken not to "abandon" bugs without good reason, such as bug
>  description that makes no sense, absence of any useful logs and obscure app for
>  which no download can be googled and user not responding for a long period of time.
>

Besides the reproducible part of this last paragraph, you're
describing an invalid bug, not abandoned.

-- 
James Hawkins


From dank at kegel.com  Sun Apr 13 14:37:15 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 13 Apr 2008 12:37:15 -0700
Subject: Trying to get a grip on how to handle bug reports.
Message-ID: <a71bd89a0804131237na75a460kfb7a494d866f8467@mail.gmail.com>

James wrote:
> If you'll actually read what I said, I made no threats, nor was I rude.

IMHO the cumulative attitude of your comments, especially

http://bugs.winehq.org/show_bug.cgi?id=11639#c18
Stop posting in a closed bug report!  You've already been told to open a new
bug report..

was in fact somewhat rude.
- Dan


From dank at kegel.com  Sun Apr 13 14:43:09 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 13 Apr 2008 12:43:09 -0700
Subject: loader: print a better message about reserving memory
Message-ID: <a71bd89a0804131243x4aab745dv1fd9eab359b6c7b1@mail.gmail.com>

Vitaliy wrote:
>Austin English wrote:
>> With ubuntu updating to the 2.6.24 kernel, a lot more people are
>> running into errors about reserving memory. This patch adds a
>> suggestion to check  /etc/sysctl.conf.
>>
>> You may need to edit /etc/sysctl.conf to give Wine access to this memory.\n",
>
>Can you be more specific what did Ubuntu do to break Wine?

It would have been helpful if Austin had linked to the bug report
from his patch.  I went and filed a (very well documented :-) bug report
http://bugs.winehq.org/show_bug.cgi?id=12548
that turned out to be a dup of the one Austin had been discussing
the bug in.

Austin's patch is helpful, but I think we can do better.  For instance,
we could ship a helper app that pops up a gui
and asks whether the user wants us to work around the problem
(by doing  gksudo sysctl -w vm.mmap_min_addr=0, say)
and run it in the preloader if we can't map the lowest page.


From kornelpal at gmail.com  Sun Apr 13 14:55:28 2008
From: kornelpal at gmail.com (=?iso-8859-1?B?S29ybulsIFDhbA==?=)
Date: Sun, 13 Apr 2008 21:55:28 +0200
Subject: Including Mono within a Wine package - should Wine expect this?
References: <a71bd89a0804100645y2b7f9c94n719ab5f19374db04@mail.gmail.com><47FECF9E.1030309@open-vote.org><a71bd89a0804101954w31a24e2fn72c027796b771a6e@mail.gmail.com><47FF506D.4010102@open-vote.org>
	<20080411125059.293230@gmx.net><19e31a080804131011s11342880qd0ee9d2981a1c9be@mail.gmail.com>
	<a71bd89a0804131228w188ecd20r9802c35198b25764@mail.gmail.com>
Message-ID: <002601c89da0$54349700$c542ee55@kornelpal.hu>

Hi,

> 1) support for mixed assemblies in Mono for Windows

I'm trying to do some work on that.

> 2) porting Mono's WinForms on top of Wine gdiplus
> instead of Mono gdiplus (and making it more win32-ish as
> a result)

Mono is using MS GDI+ on Windows since it uses GDI+. Mono's libgdiplus is 
only used on non-Windows platforms. If Wine's GDI+ is not supported by Mono 
(I haven't tried) it's Wine's GDI+ that has to be fixed because Mono works 
perfectly with MS GDI+.

I also suggested on mono-devel-list that process creation and module loading 
for managed modules should be supported by ntdll.dll via callbacks to 
mscoree.dll as described in
http://lists.ximian.com/pipermail/mono-devel-list/2008-April/027491.html

Korn?l 



From austinenglish at gmail.com  Sun Apr 13 15:24:51 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 13 Apr 2008 15:24:51 -0500
Subject: loader: print a better message about reserving memory
In-Reply-To: <a71bd89a0804131243x4aab745dv1fd9eab359b6c7b1@mail.gmail.com>
References: <a71bd89a0804131243x4aab745dv1fd9eab359b6c7b1@mail.gmail.com>
Message-ID: <b6bb06270804131324k675bea62nfe006c02f41f6d50@mail.gmail.com>

On Sun, Apr 13, 2008 at 2:43 PM, Dan Kegel <dank at kegel.com> wrote:
> Vitaliy wrote:
>  >Austin English wrote:
>  >> With ubuntu updating to the 2.6.24 kernel, a lot more people are
>  >> running into errors about reserving memory. This patch adds a
>  >> suggestion to check  /etc/sysctl.conf.
>  >>
>  >> You may need to edit /etc/sysctl.conf to give Wine access to this memory.\n",
>  >
>  >Can you be more specific what did Ubuntu do to break Wine?
>
>  It would have been helpful if Austin had linked to the bug report
>  from his patch.  I went and filed a (very well documented :-) bug report
>
> http://bugs.winehq.org/show_bug.cgi?id=12548
>  that turned out to be a dup of the one Austin had been discussing
>  the bug in.
>
>  Austin's patch is helpful, but I think we can do better.  For instance,
>  we could ship a helper app that pops up a gui
>  and asks whether the user wants us to work around the problem
>  (by doing  gksudo sysctl -w vm.mmap_min_addr=0, say)
>  and run it in the preloader if we can't map the lowest page.
>
>
>

I had started to notice it whenever ubuntu upgraded the hardy kernel
to 2.6.24. A helper app would be good, but in the meantime, I think a
link to a wiki page with links to the bug #'s, etc would be helpful. I
wrote the patch before your (very detailed :-D) report, however.


From r.kalbermatter at hccnet.nl  Sun Apr 13 15:28:16 2008
From: r.kalbermatter at hccnet.nl (Rolf Kalbermatter)
Date: Sun, 13 Apr 2008 22:28:16 +0200
Subject: Trouble in compiling Wine 0.9.57 and 0.9.58 on Solaris 10 08/07
In-Reply-To: <47FF74FD.4060307@sun.com>
References: <47FF74FD.4060307@sun.com>
Message-ID: <00a101c89da4$e7f77210$4001a8c0@NATERS>

Petr Sumbera [mailto:Petr.Sumbera at Sun.COM] 

>  >isinf is a function / macro which returns wether or not a 
> float is positive  >infinite or negative infinite. I think it 
> is a standard C function. Maybe  >solaris declares it in some 
> header that needs to be included, like math.h?
> 
> I have logged for this bug: 
> http://bugs.winehq.org/show_bug.cgi?id=12008
> 
> Not sure where to find it exactly. But isinf seems to be 
> defined by ISO
> 99 (not by standard C).

Following link might give some details about Sun Solaris support of
infinintes
and also ideas how to solve that problem.

http://www.google.nl/codesearch?q=isinf&ie=UTF-8&oe=utf-8&rls=org.mozilla:en
-US:official&client=firefox-a&um=1&sa=X&oi=codesearch_group&resnum=4&ct=titl
e

Rolf Kalbermatter



From dank at kegel.com  Sun Apr 13 15:50:58 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 13 Apr 2008 13:50:58 -0700
Subject: Including Mono within a Wine package - should Wine expect this?
In-Reply-To: <002601c89da0$54349700$c542ee55@kornelpal.hu>
References: <a71bd89a0804100645y2b7f9c94n719ab5f19374db04@mail.gmail.com>
	<47FECF9E.1030309@open-vote.org>
	<a71bd89a0804101954w31a24e2fn72c027796b771a6e@mail.gmail.com>
	<47FF506D.4010102@open-vote.org> <20080411125059.293230@gmx.net>
	<19e31a080804131011s11342880qd0ee9d2981a1c9be@mail.gmail.com>
	<a71bd89a0804131228w188ecd20r9802c35198b25764@mail.gmail.com>
	<002601c89da0$54349700$c542ee55@kornelpal.hu>
Message-ID: <a71bd89a0804131350o4935bf68n1de7253d00ab1e6e@mail.gmail.com>

On Sun, Apr 13, 2008 at 12:55 PM, Korn?l P?l <kornelpal at gmail.com> wrote:
> > 1) support for mixed assemblies in Mono for Windows
>
>  I'm trying to do some work on that.

Cool!

> > 2) porting Mono's WinForms on top of Wine gdiplus
> > instead of Mono gdiplus (and making it more win32-ish as
> > a result)
>
>  Mono is using MS GDI+ on Windows since it uses GDI+. Mono's libgdiplus is
> only used on non-Windows platforms.

I guess I assumed that Mono used native WinForms on Windows,
and that its winforms code was only used on Linux.  I clearly
don't know enough about Mono to discuss it intelligently :-)

>  I also suggested on mono-devel-list that process creation and module
> loading for managed modules should be supported by ntdll.dll via callbacks
> to mscoree.dll as described in
>  http://lists.ximian.com/pipermail/mono-devel-list/2008-April/027491.html

That's interesting info, thanks.

At the moment you seem to be taking the lead on these issues.
Please let us know how it goes.
- Dan


From scott at open-vote.org  Sun Apr 13 16:05:31 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Sun, 13 Apr 2008 14:05:31 -0700
Subject: cachedmetrics - still used?
In-Reply-To: <b6bb06270804101257j60cf6e40n3042b57532648a12@mail.gmail.com>
References: <b6bb06270804101257j60cf6e40n3042b57532648a12@mail.gmail.com>
Message-ID: <4802759B.2010903@open-vote.org>

Austin English wrote:
> Looking at documentation/PACKAGING, it seems there's quite a bit of
> outdated info (hasn't been updated in 2-3 years...). Anywho, I'm
> preparing a few updates for it, but wanted to verify that
> cachedmetrics is no longer used. There's a few references to it on
> AppDB, but only one reference in the code, and a few on wine-devel
> (all of which are pretty old). Is it safe to remove this info?
> 
> -Austin
> 

That documentation really should be deleted and moved to the wiki.

Thanks,
Scott Ritchie


From alexd4 at inbox.lv  Sun Apr 13 16:03:00 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Mon, 14 Apr 2008 00:03:00 +0300
Subject: Lots of input messages lingering in server slowing down wine
	tremendously?
Message-ID: <48027504.8070908@inbox.lv>

Hi.

There was a problem found recently in a fan-made mod of Forsaken (game), that 
certain input combinations were slowing wine very seriously. Holding down a 
keyboard button and moving mouse was found to be especially devastating to 
performance (200 fps to 10fps in a matter of 10-20 seconds).

With help from people who develop this mod, I was able to isolate it in a very 
small and simplistic testcase, which shows this same problem. It will be 
included as attachment. Holding a key and moving mouse over the window steadily 
increases main loop latency from 10 to 50 (and even 100) in a short time, 
especially so if quickly clicking both mouse buttons as well. In a game this 
means going from 100 fps to 20 or 10 just because of input messages. Has to be 
noted that in the actual game the rate of slowdown seemed at least 2-3 times 
faster for reasons I don't know, but the testcase still should enough to show 
the problem.

Now, I do realize that what the testcase is doing is bad practice, it's 
basically refusing to process certain types of messages, and PeekMessage just 
once during a loop is probably bad as well, but that's what the game was 
originally doing in its main game loop. They do plan to fix it in the game. 
Still, there are several concerns about it:

1) No slowdown happens of Windows as far as I can tell. No matter how much I 
move the mouse holding key and clicking madly, it shows same stable 15-16 ticks 
latency in the testcase. I don't know what it does, but somehow it handles this 
situation better than Wine.

2) Can this (broken) way of doing things be exposing some inefficiency in 
message handling, maybe something that could use optimization? I tried to put 
debug hacks into queue_hardware_message(), it seems that when slowdown is 
already VERY bad in Forsaken (10fps), message queue in wine server has about 400 
or maybe 600 messages. Is that kind of processing overhead per message 
inevitable? (This is happening on AMD Athlon(tm) 3200+). Perhaps somebody who 
knows that part of code well may be interested in looking into performance 
issues in this case. Because, if 400-600 messages in the queue slow down the 
application to a crawl, then who knows, perhaps it decreases performance of more 
well-behaved but input-intensive apps as well, just less drastically (holding 
one or several keys to move, all the while aiming with mouse and abusing mouse 
buttons is a common thing in games, so there can be quite a few input messages 
flooding the server).

The reason I decided to post it to wine-devel is because I'm not sure if this 
kind of thing is expected and unavoidable or a bug that can be fixed, so better 
to hear some comments first, then a bug entry can be opened if needed.
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: msgstresstest.c
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080414/16487cbc/attachment-0001.txt 

From wine.dev at web.de  Sun Apr 13 16:18:13 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Sun, 13 Apr 2008 23:18:13 +0200
Subject: [2/6] winspool/tests: Add tests for AddForm
In-Reply-To: <48015156.3060900@gmx.net>
References: <48015156.3060900@gmx.net>
Message-ID: <1208121493.7178.17.camel@p4>

On So, 2008-04-13 at 02:18 +0200, Marcel Partap wrote:
> Subject: [PATCH] winspool/tests: Add tests for AddForm

A test for AddForm / DeleteForm can't work with the stubs in our
"winspool.drv".
The implementation is needed first.

> +    SetLastError(MAGIC_DEAD);

Plase do not use MAGIG_DEAD, it was a mistake in my first Patchset.
Use the real Value instead.

> +    res = AddFormA(NULL, 0, NULL);
> +    RETURN_ON_DEACTIVATED_SPOOLER(res);
> +    ok( !res && (GetLastError() == ERROR_INVALID_LEVEL),
> +        "returned %d with %d (expected '0' with ERROR_INVALID_LEVEL)\n", res, GetLastError());
> +
> +    SetLastError(MAGIC_DEAD);
> +    res = AddFormA((HANDLE)MAGIC_DEAD, 1, NULL);

> +    RETURN_ON_DEACTIVATED_SPOOLER(res);

Use this macro only once.
I did not test, which AddFormA return RPC_S_SERVER_UNAVAILABLE.

Did you test the code with a non - admin account?
Many functions in winspool.drv return ERROR_ACCESS_DENIED


-- 
 
By by ... Detlef




From wine.dev at web.de  Sun Apr 13 16:21:35 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Sun, 13 Apr 2008 23:21:35 +0200
Subject: [3/6] winspool: Implement AddFormA/W for level 1 forms
In-Reply-To: <48015158.8050902@gmx.net>
References: <48015158.8050902@gmx.net>
Message-ID: <1208121695.7178.20.camel@p4>

On So, 2008-04-13 at 02:18 +0200, Marcel Partap wrote:
> + *
> + * FIXME: no level 2 support
> + *
>   */
>  BOOL WINAPI AddFormW(HANDLE hPrinter, DWORD Level, LPBYTE pForm)

"FIXME:" is not a valid section in our API-Documentation

Please use "NOTES" or "BUGS"


-- 
 
By by ... Detlef




From wine.dev at web.de  Sun Apr 13 16:24:02 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Sun, 13 Apr 2008 23:24:02 +0200
Subject: [5/6] winspool: Implement DeleteFormA/W
In-Reply-To: <4801515D.20407@gmx.net>
References: <4801515D.20407@gmx.net>
Message-ID: <1208121842.7178.23.camel@p4>

On So, 2008-04-13 at 02:18 +0200, Marcel Partap wrote:
> +    formNameW = HeapAlloc(GetProcessHeap(), 0, len * sizeof(WCHAR));
> +    MultiByteToWideChar(CP_ACP, 0, pFormName, -1, formNameW, len);
> +    return DeleteFormW(hPrinter, formNameW); 

Memory-leak: formnameW


-- 
 
By by ... Detlef




From austinenglish at gmail.com  Sun Apr 13 16:24:30 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 13 Apr 2008 16:24:30 -0500
Subject: cachedmetrics - still used?
In-Reply-To: <4802759B.2010903@open-vote.org>
References: <b6bb06270804101257j60cf6e40n3042b57532648a12@mail.gmail.com>
	<4802759B.2010903@open-vote.org>
Message-ID: <b6bb06270804131424x6cecccd7o13cec26875fa0978@mail.gmail.com>

On Sun, Apr 13, 2008 at 4:05 PM, Scott Ritchie <scott at open-vote.org> wrote:
>
> Austin English wrote:
>  > Looking at documentation/PACKAGING, it seems there's quite a bit of
>  > outdated info (hasn't been updated in 2-3 years...). Anywho, I'm
>  > preparing a few updates for it, but wanted to verify that
>  > cachedmetrics is no longer used. There's a few references to it on
>  > AppDB, but only one reference in the code, and a few on wine-devel
>  > (all of which are pretty old). Is it safe to remove this info?
>  >
>  > -Austin
>  >
>
>  That documentation really should be deleted and moved to the wiki.
>
>  Thanks,
>  Scott Ritchie
>

I just created http://wiki.winehq.org/Packaging

I just dumped my updated PACKING file, which is still incomplete. I
removed some old stuff, e.g., references to using windows partitions,
cachedmetrics, etc. Added info on optional packages, but it still
needs quite a bit of work (as well as wiki formatting).  Wine
components definitely needs updating, as well as the general info
about where to install files/etc.


From hintak_leung at yahoo.co.uk  Sun Apr 13 08:37:48 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Sun, 13 Apr 2008 14:37:48 +0100
Subject: urlmon: add stub for CoInternetSetFeatureEnabled
In-Reply-To: <003301c89d53$97751be0$a600fea9@DMITRY>
References: <784229.68185.qm@web23202.mail.ird.yahoo.com>
	<003301c89d53$97751be0$a600fea9@DMITRY>
Message-ID: <48020CAC.3090105@yahoo.co.uk>

Dmitry Timoshkov wrote:
> "Louis. Lenders" <xerox_xerox2000 at yahoo.co.uk> wrote:
> 
>> +HRESULT WINAPI  CoInternetSetFeatureEnabled(INTERNETFEATURELIST Feature, DWORD flags, BOOL fEnable)
>> +{
>> +    FIXME("%p, 0x%08x, %x, stub\n", &Feature, flags, fEnable);
>> +    return E_NOTIMPL;
>> +}
>> diff --git a/dlls/urlmon/urlmon.spec b/dlls/urlmon/urlmon.spec
>> index 1fa2f94..e89e049 100644
>> --- a/dlls/urlmon/urlmon.spec
>> +++ b/dlls/urlmon/urlmon.spec
>> @@ -19,6 +19,7 @@
>> @ stdcall CoInternetGetSession(long ptr long)
>> @ stdcall CoInternetParseUrl(wstr long long wstr long ptr long)
>> @ stdcall CoInternetQueryInfo(ptr long long ptr long ptr long)
>> +@ stdcall CoInternetSetFeatureEnabled(ptr long long)
> 
> The first parameter of CoInternetSetFeatureEnabled is not a pointer even
> if you pretend it is in the FIXME. Also Please use consistent spacing and
> naming of variables (preferring 1 space and no hungarian/upper cased names).
> 

oh, I just made the same comment (http://bugs.winehq.org/show_bug.cgi?id=12406#c7 ):

I had a look at this - INTERNETFEATURELIST is a enum, not a long pointer;
oh, and the stub code itself should go into internet.c (where similiarly
named/used functions resides), instead of urlmon_main.c .

Other than these, the patch took the doc explorer further, so
I think basically just needs a 'FIXME("Not implemented\n");' to be sent off...



From stefan at codeweavers.com  Sun Apr 13 16:08:19 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 13 Apr 2008 23:08:19 +0200
Subject: Trouble in compiling Wine 0.9.57 and 0.9.58 on Solaris 10 08/07
In-Reply-To: <00a101c89da4$e7f77210$4001a8c0@NATERS>
References: <47FF74FD.4060307@sun.com> <00a101c89da4$e7f77210$4001a8c0@NATERS>
Message-ID: <200804132308.19873.stefan@codeweavers.com>

Am Sonntag, 13. April 2008 22:28:16 schrieb Rolf Kalbermatter:
> Following link might give some details about Sun Solaris support of
> infinintes
> and also ideas how to solve that problem.
Yes, that would work. Any build system guru who could implement that? I think 
it is not a good idea to put that into wined3d


From fgouget at free.fr  Sun Apr 13 18:08:47 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 14 Apr 2008 01:08:47 +0200 (CEST)
Subject: Better sound support
In-Reply-To: <47FF9AEC.6060700@gmail.com>
References: <47FF9AEC.6060700@gmail.com>
Message-ID: <alpine.DEB.1.10.0804140105250.12478@amboise.dolphin>

On Fri, 11 Apr 2008, Kacper Pluta wrote:
[...]
> I'd also suggest correcting MIDI handling and integrating wine with 
> wineasio, which would enable using VST and VSTi on a quite high level, 
> as well as use other programmes.

There's a wineasio project which is in a separate tree, partly for 
licensing reasons. See http://sourceforge.net/projects/wineasio for more 
details.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
           Demander si un ordinateur peut penser revient


From dank at kegel.com  Sun Apr 13 21:15:49 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 13 Apr 2008 19:15:49 -0700
Subject: Wine 1.0 status: T minus 61 days, 69 bugs to go
Message-ID: <a71bd89a0804131915i519b4cb0q3f9418b66ecb2655@mail.gmail.com>

19 days to code freeze (!)

Big news of the week is an apparant regression in one of
the release criteria apps.  Also, happily, two bugs I had
pushed off to 1.2 got fixed anyway (demonstrating the
honorary nature of the release manager position :-)

Changes since last week:

Deferred earlier, but fixed anyway:
3534 	user32 	14 	Systray icons are not transparent...

Deferred earlier, but patch that really fixes it submitted, so undeferred:
10905  	shell32  0  	thinstall firefox demo requires native msvcrt

Deferred:
6254   richedit    4       Installer infinite loop from rich text error

New:
12561  -unknown  0  	Photoshop CS alt key for clone/healing - possible
regression

Here's the full list of current bugs:

11420 advapi32  0  service control manager API problem: name of named
objects might differ (client vs. service process)
556   build-en  1  Reconcile the Windows and Wine spec files
1114  comctl32  3  Winrar2.90/3.00: Comboex doesn't trigger a event
when you mouse-click in some value of it
2493  comctl32  2  Multi-select listview: Shift-arrow up only selects
top two items
4372  comctl32  1  listview: cannot drag several items
11509 crypt32   0  Wordviewer 2003 is unable to open documents
encrypted with AES
5535  directx-  17 Planescape:Torment doesn't work
9030  directx-  0  army men hangs on black screen
11681 directx-  17 Add support for video overlay
3270  gdi32     15 Problem with minimized top-level windows
6519  gdi32     7  Wine blacks out rotated font bitmap
7571  gdi32     1  Accented character glyphs are mixed up with
TrueType fonts (affects e.g. Lotus Notes R5)
9771  gdi32     42 Steam Friends doesn't work (fails to render
correctly or refresh)
5024  kernel32  4  Thief: Deadly Shadows crashes:page fault on read
access to 0x0000040c
5351  kernel32  11 Windows Installer 3.1 cannot install because of
non-standard drive labeling
5541  kernel32  0  WriteConsole can't write to stdout; affects e.g.
wsh's cscript's usage message
9039  kernel32  0  GS-Auftrag Professional SQL aborts on startup
9484  kernel32  19 Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
7098  mscoree   1  RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
8783  ntdll     13 USB serial ports do not work
9356  ntdll     8  Serial communication not working since wine-0.9.33
2539  ole       3  XDND (Drag and drop for X Windows) doesn't copy text
6607  ole       10 Drag and Drop not working
8095  ole       0  PQ Teaching toy crashes
9942  ole       2  Powerpoint Viewer 2007 crashes opening .pptx files
5926  programs  1  Wine does not provide an implementation of winhlp32.exe
5163  setupapi  13 Office XP 2002 crashes on installation
3546  shdocvw   2  CLSID_InternetShortcut not available...
6095  shdocvw   13 MOTD in counter-strike 1.6 and counter-strike
source does not render
8898  shdocvw   0  Run Time Error "445": Object doesn't support this
action in Europa Knowledgebase
9304  shdocvw   4  Temple of Elemental Evil demo doesn't start - gui
irresponsive
8439  shell32   8  Visual Studio .NET (7) install fails
9809  shell32   4  Autodesk Revit Architecture 2008 install fails
10905 shell32   0  thinstall firefox demo requires native msvcrt
11742 shlwapi   9  Small .net 1.1 app (FastMD5 1.3) fails to start up
12074 testcase  2  The conformance tests fail on Windows
6604  tools     3  Ship icons for the wine-tools that can be used in
.desktop files
12561 -unknown  0  Photoshop CS alt key for clone/healing - possible regression
5055  -unknown  5  Deleting files from a window in wine doesn't send
them to the Trash
5061  -unknown  6  Copying from Windows Firefox in Wine and pasting to
Linux OpenOffice pastes metadata as data
5402  -unknown  0  Trying to run PhotoStitch 3.1
5844  -unknown  12 tray minimize
5948  -unknown  1  Star Trek: Armada does not install
7404  -unknown  3  ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
7477  -unknown  1  Uplink demo crashes
8125  -unknown  0  Marratech 6.1 crashes on start
9178  -unknown  8  "hello world" dos program hangs
9916  -unknown  6  "make test" usually fails
9959  -unknown  9  Make wine updates work even if the registry changed
10147 -unknown  1  Word Viewer 2003 - Tab behavior differs from Windows
10815 -unknown  2  Cannot drag images into Adobe Photoshop 7 from the
web / desktop
11281 -unknown  4  CJK input many issues
12097 -unknown  3  Wine 1.0 should not ship out-of-sync resource translations
12246 -unknown  2  "make test" gives different results with and
without warn+heap
664   user32    7  The help menu functionality inside programs is
broken (messaging problem)
3023  user32    5  Orcad - "Place Part" never tries to put down a part
4523  user32    5  Can't copy from Firefox 1.5 and paste into
OpenOffice 2 under Wine
124   wineserv  2  Review of Wine Server Protocol
1990  winex11.  1  modifier keys not released when switching desktop
2368  winex11.  7  Wine loses its X-Window when switching to another
virt. desktop in Fvwm
3297  winex11.  12 UpdateWindow() doesn't call XFlush()
5623  winex11.  4  GetAsyncKeyState wrong if querying process doesn't have focus
5828  winex11.  25 Command and Conquer Generals (Zero Hour) doesn't
change the mouse cursor from the default X mouse
7372  winex11.  12 can't copy and paste between gnome apps eg
openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
10984 winex11.  5  sun jre 5 update 10 installer hangs in 0.9.52
11019 winex11.  3  matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
5625  wininet   4  Wine does not handle internet proxy settings conveniently
9787  winsock   47 Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
12005 wintab32  1  Regression in pressure sensitivity with wizardpen
tablet driver and Photoshop 7


From kai.blin at gmail.com  Sun Apr 13 23:37:20 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 14 Apr 2008 06:37:20 +0200
Subject: Wine 1.0 status: T minus 61 days, 69 bugs to go
In-Reply-To: <a71bd89a0804131915i519b4cb0q3f9418b66ecb2655@mail.gmail.com>
References: <a71bd89a0804131915i519b4cb0q3f9418b66ecb2655@mail.gmail.com>
Message-ID: <200804140637.28093.kai.blin@gmail.com>

On Monday 14 April 2008 04:15:49 Dan Kegel wrote:

> New:
> 12561  -unknown  0  	Photoshop CS alt key for clone/healing - possible
> regression

This is probably related to http://bugs.winehq.org/show_bug.cgi?id=12543 which 
in turn seems to be caused by the fix for 
http://bugs.winehq.org/show_bug.cgi?id=11639

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080414/a0e894e2/attachment.pgp 

From zgs at seas.upenn.edu  Sun Apr 13 23:53:56 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Mon, 14 Apr 2008 00:53:56 -0400
Subject: shell32: implement SHGetFolderPathAndSubDirA/W [2nd resend]
In-Reply-To: <87wsnj6lhq.fsf@wine.dyndns.org>
References: <200803272257.23004.Stefan.Leichter@camline.com>
	<87wsnj6lhq.fsf@wine.dyndns.org>
Message-ID: <b050a5e70804132153i566fa5xcfe8b3673089a4da@mail.gmail.com>

On Mon, Mar 31, 2008 at 10:01 AM, Alexandre Julliard
<julliard at winehq.org> wrote:
> Stefan Leichter <Stefan.Leichter at camline.com> writes:
>
>  > +    if (pszSubPath && (length = MultiByteToWideChar(CP_ACP, 0, pszSubPath, -1, NULL, 0))) {
>  > +        pszSubPathW = HeapAlloc(GetProcessHeap(), 0, length * sizeof(WCHAR));
>  > +        if(!pszSubPathW)
>  > +            return HRESULT_FROM_WIN32(ERROR_NOT_ENOUGH_MEMORY);
>
>  You are leaking memory on error. Also I don't think it makes sense to
>  test the return value of MultiByteToWideChar, it shouldn't fail in this
>  case (or if you test it, then you need to handle the error properly, not
>  use an empty path instead).
>
>  --
>  Alexandre Julliard
>  julliard at winehq.org
>
>
>

Stefan,

Any progress on this?

-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From thunderbird2k at gmx.net  Mon Apr 14 01:14:00 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Mon, 14 Apr 2008 08:14:00 +0200
Subject: Including Mono within a Wine package - should Wine expect this?
In-Reply-To: <a71bd89a0804131228w188ecd20r9802c35198b25764@mail.gmail.com>
References: <a71bd89a0804100645y2b7f9c94n719ab5f19374db04@mail.gmail.com>
	<47FECF9E.1030309@open-vote.org>
	<a71bd89a0804101954w31a24e2fn72c027796b771a6e@mail.gmail.com>
	<47FF506D.4010102@open-vote.org> <20080411125059.293230@gmx.net>
	<19e31a080804131011s11342880qd0ee9d2981a1c9be@mail.gmail.com>
	<a71bd89a0804131228w188ecd20r9802c35198b25764@mail.gmail.com>
Message-ID: <20080414061400.39750@gmx.net>

> On Sun, Apr 13, 2008 at 10:11 AM, Steven Edwards <winehacker at gmail.com>
> wrote:
> >  Rather than ignoring mono these issues make it sound like Wine and
> >  mono should try to work together again. The EULA for the .NET runtime
> >  prohibits distributing it and using it on non-windows licensed systems
> >  so we are in much the same legal situation with IE where we have to
> >  have a replacement.
> 
> Yes, exactly.  I've been discussing this a bit on the mono list.
> 
> There are two big pieces of work needed:
> 1) support for mixed assemblies in Mono for Windows
> 2) porting Mono's WinForms on top of Wine gdiplus
> instead of Mono gdiplus (and making it more win32-ish as
> a result)
> 
> This would be a fine summer project for somebody properly motivated.
> 
> There will be more incentive to do this as we get Microsoft .NET working
> better, and it becomes clearer just how many applications need one
> or the other of the two items above to run.
> 
> In short: I think the path to Mono+Wine nivana at the moment leads
> directly through enemy territory: we have to get MS .net working better
> first
> before it's clear it'll be worth it.
> - Dan
> 

What we really need is mono's windows.forms to be layered on top of gdi32 and user32 for windows controls like buttons, textboxes and so on .. As lots of programs do overrides using native dlls on them, so that's why it should be real windows controls with a wndproc.

Ironically the current situation is for a part our own issue. Years ago Mono's windows.forms used winelib. They moved to a managed implementation because they had wine integration issues and we weren't that cooperative. Further they didn't like the 2d performance much (likely due to the lack of a dib engine ..). They might be reluctant to Wine.

Roderick 
-- 
Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen! 
Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer


From Stefan.Leichter at camLine.com  Mon Apr 14 01:37:57 2008
From: Stefan.Leichter at camLine.com (Stefan Leichter)
Date: Mon, 14 Apr 2008 08:37:57 +0200
Subject: shell32: implement SHGetFolderPathAndSubDirA/W [2nd resend]
In-Reply-To: <b050a5e70804132153i566fa5xcfe8b3673089a4da@mail.gmail.com>
References: <200803272257.23004.Stefan.Leichter@camline.com>	
	<87wsnj6lhq.fsf@wine.dyndns.org>
	<b050a5e70804132153i566fa5xcfe8b3673089a4da@mail.gmail.com>
Message-ID: <4802FBC5.30806@camLine.com>

Zachary Goldberg schrieb:
> On Mon, Mar 31, 2008 at 10:01 AM, Alexandre Julliard
> <julliard at winehq.org> wrote:
>> Stefan Leichter <Stefan.Leichter at camline.com> writes:
>>
>>  > +    if (pszSubPath && (length = MultiByteToWideChar(CP_ACP, 0, pszSubPath, -1, NULL, 0))) {
>>  > +        pszSubPathW = HeapAlloc(GetProcessHeap(), 0, length * sizeof(WCHAR));
>>  > +        if(!pszSubPathW)
>>  > +            return HRESULT_FROM_WIN32(ERROR_NOT_ENOUGH_MEMORY);
>>
>>  You are leaking memory on error. Also I don't think it makes sense to
>>  test the return value of MultiByteToWideChar, it shouldn't fail in this
>>  case (or if you test it, then you need to handle the error properly, not
>>  use an empty path instead).
>>
>>  --
>>  Alexandre Julliard
>>  julliard at winehq.org
>>
>>
>>
> 
> Stefan,
> 
> Any progress on this?
> 
Yes,

http://www.winehq.org/pipermail/wine-patches/2008-April/053246.html

Stefan


From stefan at codeweavers.com  Mon Apr 14 03:26:37 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 14 Apr 2008 10:26:37 +0200
Subject: WineD3D: WineD3D: Use the shader backend to enable / disable
	atifs and nvts
In-Reply-To: <200804132126.19422.stefan@codeweavers.com>
References: <200804110031.13345.stefan@codeweavers.com>
	<48001DF5.3050401@gmail.com>
	<200804132126.19422.stefan@codeweavers.com>
Message-ID: <200804141026.37428.stefan@codeweavers.com>

A small implementation change plan:

With Henri's suggestion, we have two levels of indirection, one that maps a 
D3D state to a pipeline part and a state, and one that maps a pipeline part 
and a state to an application function. Since both states are known at latest 
at device creation time, we can remove one indirection there.

So my suggestion is this: Instead of trying to keep the single table in code, 
add 3 pipeline stage backends, like Henri suggested: A vertex one, a fragment 
and a misc backend. The pipeline backend has a description structure which 
contains a priv data creation and destruction data, possibly some flags to 
tell other parts of the pipeline how to communicate with it and a set of 
states and application functions:

struct pipeline_backend {
	DWORD state;		/* State this sets */
	apply_func apply;	/* Apply function like the current state mgmt uses */
	DWORD representative;/* For state grouping */
}

state and representative work like the current state identifiers via 
STATE_RENDER(x), STATE_TEXTURESTAGE(x, y), etc. The apply function takes the 
stateblock, state and context as argument, as usual.

The current global state table(s) are removed. At device creation(or Init3D or 
somewhere else) we select a vertex, fragment and misc state backend and a 
shader backend. The device contains a full state table like the current 
FFPStateTable / ATIFSStateTable. A pipeline compiler(is there some better 
name?) iterates over the 3 partial state tables and inserts them in the 
device's state table. If a state is handled by more than one pipeline part, a 
helper function can be used which calls the callbacks in a row. That's not as 
efficient as the current inlining, but it should be at least as fast as in 
Henri's proposal, and I can live with that.

Advantages:
-> We can split up pipeline part handlers and select them dynamically etc
-> We have no additional overhead in the rendering loop since we only deal 
with one state table there
-> Minimal state polling because pixel and vertex shaders are dirtifyable 
states

Problems:
-> The issues from the last mail still apply and need to be solved(not a 
problem, just mentioning)

-> Shaders not 100% separated from the fixed function pipeline since both are 
equal states in the vertex and fragment pipelines

-> No state handler or shader_select is not guaranted to be applied each draw, 
so we can't use them to enable GL_FRAGMENT_SHADER_ATI and 
GL_TEXTURE_SHADER_ATI. That will have to be a fixed function fragment 
pipeline callback. If there's a shader implementation using that extension in 
use as well, they can sort this out via private data sharing.
(Note: we would get away with using the colorop setter for this, because after 
device creation this state is dirty, after a blit it is dirty, and otherwise 
the extension will be enabled anyway. I don't particularly like that as it is 
a rather fragile setup)

-> What do we do if a state has different representatives in different 
pipeline parts? E.g. the vdecl and vertex shader will be linked in both misc 
and vertex pipeline backend. In the misc backend, the stream sources will be 
added there as well. This means that if a stream source is changed the VDECL 
fog/lighting changes will be performed needlessly(it happens currently as 
well, so it won't be a regression). There may be other such state groups, but 
I can't think of any right now.

Does that sound like a reasonable idea?


