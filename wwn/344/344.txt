From m.b.lankhorst at gmail.com  Mon Mar 17 03:33:19 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 17 Mar 2008 01:33:19 -0700
Subject: Improving the Wine Users Guide
In-Reply-To: <3a768c550803161532h3f64077fk2085a5ef0381ad3f@mail.gmail.com>
References: <558b2f5c0803161117h4b341754nd5261c16a1372c73@mail.gmail.com>
	<3a768c550803161532h3f64077fk2085a5ef0381ad3f@mail.gmail.com>
Message-ID: <b130c85e0803170133s33b7193ctc70d4d273bf1f884@mail.gmail.com>

2008/3/16, Juan Lang <juan.lang at gmail.com>:
> >  * Section 3.1.2.1 - are there dlls besides kernel32, gdi32, user32,
>  >  and ntdll that we should never use the native one? Add warning about
>  >  downloading dlls from the web.
>
>
> This list may end up being rather large.  Certainly not iphlpapi.
>  Right now, not netapi32 or crypt32, either, though whether that will
>  always be the case I can't say.
Winecfg already warns for a lot of dlls you shouldn't override.


From paul.vriens.wine at gmail.com  Mon Mar 17 03:50:24 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 09:50:24 +0100
Subject: user32: test processing of expose events (try 3)
In-Reply-To: <200803142359.54348.cjstimpson@utwire.net>
References: <200803142359.54348.cjstimpson@utwire.net>
Message-ID: <47DE30D0.3020802@gmail.com>

Clinton Stimpson wrote:
> Simplified from first try by removing unecessary thread.
> Also fixing style to other code in file (thanks for feedback).
> 
> ChangeLog:  
>   user32: test processing of expose events
> 
> Thanks,
> Clinton Stimpson
> 
> 
> ------------------------------------------------------------------------
> 
> 
The patch has been committed but makes sure that the user32 tests currently 
don't run on win95 anymore.

Can the MsgWaitForMultipleObjectsEx be changed to a MsgWaitForMultipleObjects?

If so, I'll sent in a patch, if not we have to exclude this test for win95 (and 
will also sent a patch).

-- 
Cheers,

Paul.


From hverbeet at gmail.com  Mon Mar 17 04:01:30 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 17 Mar 2008 10:01:30 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803170218.09473.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803162325.53786.stefan@codeweavers.com>
	<47DD4C4D.7040605@gmail.com>
	<200803170218.09473.stefan@codeweavers.com>
Message-ID: <d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>

On 17/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Sonntag, 16. M?rz 2008 17:35:25 schrieb Ivan Gyurdiev:
>
>
>  > To me this suggests that there should be two separate shader backends,
>  > selected differently for "fixed pipeline replacement" purposes and for
>  > shaders. I don't like the argument that this is only an intermediate
>  > step - if no one writes the glsl/arb replacement code, it becomes
>  > permanent.
>
> How would that work with e.g. GLSL, where vertex and fragment shaders are
>  linked? How would you use a D3D vertex shader together with a ffp replacement
>  fragment shader?
>
>  One of the aims of my patches is providing the infrastructure where summer of
>  code applicants could kick in. So I think chances that we get an ARB or GLSL
>  replacement soon are pretty good.
>

Personally, I'm not quite convinced of the need of an ati fragment
shader ffp replacement in the first place. The functionality seems
more of the level of register combiners and texture shaders.

Also, all the cards that are powerful enough to support a shader
implementation of fixed function processing support GLSL vertex and
fragment shaders, so realistically all you really need is a GLSL ffp
replacement.

On the subject of GSoC, I'm somewhat sceptical.


From mokresa at codeweavers.com  Mon Mar 17 04:05:53 2008
From: mokresa at codeweavers.com (Michal Okresa)
Date: Mon, 17 Mar 2008 10:05:53 +0100
Subject: Is the cxtest.org site down?
In-Reply-To: <b130c85e0803151844o411b74fbo11e4114ce9de912b@mail.gmail.com>
References: <b130c85e0803151844o411b74fbo11e4114ce9de912b@mail.gmail.com>
Message-ID: <47DE3471.8070204@codeweavers.com>

It is back again.

Maarten Lankhorst wrote:
> Hi,
> 
> I was trying to look at www.cxtest.org but the site seems not to work.
> Can this be fixed?
> 
> Cheers,
> Maarten.
> 
> 



From julliard at winehq.org  Mon Mar 17 04:15:39 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 17 Mar 2008 10:15:39 +0100
Subject: [Tools 7/7] winetest: Add some heuristics to detect missing dlls
	in version 3 reports.
In-Reply-To: <alpine.DEB.1.00.0803170036570.14363@amboise.dolphin> (Francois
	Gouget's message of "Mon, 17 Mar 2008 00:39:43 +0100 (CET)")
References: <alpine.DEB.1.00.0803142003100.23729@amboise.dolphin>
	<47DCE876.8020507@gmail.com>
	<alpine.DEB.1.00.0803170036570.14363@amboise.dolphin>
Message-ID: <87wso1btj8.fsf@wine.dyndns.org>

Francois Gouget <fgouget at free.fr> writes:

> Yes, but I'm surprised because the pristine Git checkout I have here 
> does not contain the word 'testref' and lines 142 and 171 don't 
> contain '<<'. So it looks like what's being run does not correspond to 
> what's in Git.

The problem is that someone (who shall remain nameless ;) committed
changes directly to the mirror repository, so updating from the main
repos failed. I've fixed it.

-- 
Alexandre Julliard
julliard at winehq.org


From jjmckenzie51 at earthlink.net  Sun Mar 16 21:56:36 2008
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Sun, 16 Mar 2008 19:56:36 -0700
Subject: Proposed EM_Fontrange Patch
Message-ID: <47DDDDE4.6050500@earthlink.net>

All:

I would like to see the problems with EM_Fontrange be fixed.  The 
attached patch is for comment/review and I would like SPECIFIC guidance 
on how to implement this patch as it relates to a Wine 1.0 bug 
(bug/issue 6254) and fixes the problem specified there.  The conformance 
tests are already in tests/editor.c and all they involve is removing 
some todo_wine blocks related to this issue.  The entire patch will do 
this.  Sorry that the patch is in UNIX diff format, I could not get git 
to do what I wanted.  The actual patch will be git format and use the 
daily git.

Also, I would like to extend thanks to Tony Rollo, Lei Zhang and Eric 
Pouech for their guidance and prior fixes.  I would like to thank Erich 
Pouech for moving some of the functionality that the original patch 
introduced into OLE handling.

Please be BRUTAL as I feel we have a limited time period to get this in 
and other related issues that the patch will expose fixed before Wine 1.0.

Thank you.

James McKenzie

-------------- next part --------------
A non-text attachment was scrubbed...
Name: EM_Fontrange.57.diff
Type: text/x-diff
Size: 30321 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080316/253bb96c/attachment-0001.diff 

From fgouget at free.fr  Mon Mar 17 05:26:36 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 17 Mar 2008 11:26:36 +0100 (CET)
Subject: Updated 1.0.0 release criteria; draft 1.0.0 release plan
In-Reply-To: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
References: <a71bd89a0803150811i67426e0foc0d2cd81e084eec2@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0803171028540.2931@amboise.dolphin>

On Sat, 15 Mar 2008, Dan Kegel wrote:

> I've updated http://wiki.winehq.org/WineReleaseCriteria
> to be a bit more final.
> 
> I've also written a draft release plan; see
> http://wiki.winehq.org/WineReleasePlan
> 
> Comments?

My understanding is that Wine 1.0's goal has never been to run 
everything under the sun but more to put a stake in the ground saying 
'now all the infrastructure is in place' and a change of gears to care 
more about not introducing regressions.

So I'd say that among the most important things to do for 1.0 is to:
 * make sure the conformance tests are correct. Currently a large 
fraction of them still fails on various Windows platforms which proves 
that they are far from correct (despite Paul Vriens' great work). As a 
start we could shoot for less than 10% failure on XP, 2003 and Vista for 
instance. Right now we stand at about 37%.

 * make sure the conformance tests work in Wine. This is actually on the 
1.0 bug list (bugs 7915 and 9916) but lost in the middle of the 99 bugs 
there's no chance they will be looked at very much.

 * I'd also consider '421 - Implement a DIB engine (framework)' as 
belonging to that list as it's clearly part of the infrastructure and 
has been needed for a long time (and the infrastructure part is within 
reach).


Also while I agree about having a small set of 'must run' applications, 
I think that most of the other application-specific issues can be moved 
to 1.1 (or future) right away:

5807 - Mercora IMRadio crashes while attempting to run
6048 - wine crashes while starting Strokes russian language course
2547 - word perfect 12 trial fails to install
6095 - MOTD in counter-strike 1.6 and counter-strike source does not render
5535 - Planescape:Torment doesn't work
1114 - Winrar2.90/3.00: Comboex doesn't trigger a event when you mouse-click in some value of it
3023 - Orcad - "Place Part" never tries to put down a part
3711 - Musicmatch fails to install (missing registry key, HTTP_HttpOpenRequest() problem)
4770 - BlackBerry Device Manager fails to install under wine
4971 - Corel Draw 12 demo install fails
5024 - Thief: Deadly Shadows crashes:page fault on read access to 0x0000040c
5163 - Office XP 2002 crashes on installation
5402 - Trying to run PhotoStitch 3.1
5828 - Command and Conquer Generals (Zero Hour) doesn't change the mouse cursor from the default X mouse
6126 - SoulSeek crashes
6526 - Typing Instructor for Kids 2 fails to install
6795 - Skype 3.0.0.137 Beta dies trying to login in win98, winme mode
7877 - Weatherbug install stops because of missing ie6
8095 - PQ Teaching toy crashes
8125 - Marratech 6.1 crashes on start
8898 - Run Time Error "445": Object doesn't support this action in Europa Knowledgebase
9030 - army men hangs on black screen
9039 - GS-Auftrag Professional SQL aborts on startup
9104 - Pdf-xchange viewer crashes
9304 - Temple of Elemental Evil demo doesn't start - gui irresponsive
9459 - FIFA 2007 crashes with the recent versions
9637 - Switchball only shows a blank screen
9809 - Autodesk Revit Architecture 2008 install fails
9895 - Alzip crashes: Invalid float operation
9942 - Powerpoint Viewer 2007 crashes opening .pptx files
10147 - Word Viewer 2003 - Tab behavior differs from Windows
10815 - Cannot drag images into Adobe Photoshop 7 from the web / desktop
10905 - thinstall firefox demo requires native msvcrt
10984 - sun jre 5 update 10 installer hangs in 0.9.52
11431 - Adobe Photoshop CS2: z-overlay of image containers
9469 - Adobe Photoshop Elements 1 welcome dialog options don't work
5948 - Star Trek: Armada does not install
7098 - RufzXP crashes on startup, needs mscoree.dll.CorBindToRuntimeEx


There, add a mere two bugs and remove 38. Isn't that a sweet deal?

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                     Avoid the Gates of Hell - use Linux.


From mstefani at redhat.com  Mon Mar 17 05:58:11 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Mon, 17 Mar 2008 11:58:11 +0100
Subject: gdi: Add a stub for GdipCreateFontFamilyFromName
In-Reply-To: <1205713085.6940.5.camel@mighmos>
References: <1205713085.6940.5.camel@mighmos>
Message-ID: <47DE4EC3.4000803@redhat.com>

Adam Petaccia wrote:
> This patch is needed for me to run Tabula Rasa.
> 
> This is my first patch, so please tell if I've broken conventions.
Please add the correct declarations for "struct GpFontCollection" and
"struct GpFontFamily". If you cannot find those on MSDN then check Mono;
that one seems to have them too. But please do not cut'n'paste.

bye
	michael

> ------------------------------------------------------------------------
> 
> diff --git a/dlls/gdiplus/font.c b/dlls/gdiplus/font.c
> index be60843..e0a781c 100644
> --- a/dlls/gdiplus/font.c
> +++ b/dlls/gdiplus/font.c
> @@ -27,6 +27,9 @@
>  
>  #include "gdiplus.h"
>  #include "gdiplus_private.h"
> +#include "wine/debug.h"
> +
> +WINE_DEFAULT_DEBUG_CHANNEL(gdiplus);
>  
>  GpStatus WINGDIPAPI GdipCreateFontFromLogfontW(HDC hdc,
>      GDIPCONST LOGFONTW *logfont, GpFont **font)
> @@ -99,3 +102,10 @@ GpStatus WINGDIPAPI GdipGetLogFontW(GpFont *font, GpGraphics *graphics,
>  
>      return Ok;
>  }
> +
> +GpStatus WINGDIPAPI GdipCreateFontFamilyFromName(GDIPCONST WCHAR *name, struct GpFontCollection *fontCollection, struct GpFontFamily **FontFamily)
> +{
> +	FIXME("GdipCreateFontFamilyFromName: stub!\n");
> +
> +	return Ok;
> +}
> diff --git a/dlls/gdiplus/gdiplus.spec b/dlls/gdiplus/gdiplus.spec
> index 4aac0df..1fbc57a 100644
> --- a/dlls/gdiplus/gdiplus.spec
> +++ b/dlls/gdiplus/gdiplus.spec
> @@ -85,7 +85,7 @@
>  @ stdcall GdipCreateCustomLineCap(ptr ptr long long ptr)
>  @ stub GdipCreateEffect
>  @ stub GdipCreateFont
> -@ stub GdipCreateFontFamilyFromName
> +@ stdcall GdipCreateFontFamilyFromName(ptr ptr ptr)
>  @ stub GdipCreateFontFromDC
>  @ stdcall GdipCreateFontFromLogfontA(ptr ptr ptr)
>  @ stdcall GdipCreateFontFromLogfontW(ptr ptr ptr)
> diff --git a/dlls/gdiplus/gdiplus_private.h b/dlls/gdiplus/gdiplus_private.h
> index 09ef83f..cd6a7d5 100644
> --- a/dlls/gdiplus/gdiplus_private.h
> +++ b/dlls/gdiplus/gdiplus_private.h
> @@ -184,4 +184,9 @@ struct GpStringFormat{
>      StringAlignment vertalign;
>  };
>  
> +struct GpFontCollection{
> +};
> +
> +struct GpFontFamily{
> +};
>  #endif
> 
> 
> ------------------------------------------------------------------------
> 
> 


-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Hauptst?tter Strasse 58, 70178 Stuttgart
Handelsregister: Amtsgericht Stuttgart HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                 Werner Knoblich


From stefan at codeweavers.com  Mon Mar 17 06:07:26 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 12:07:26 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803170218.09473.stefan@codeweavers.com>
	<d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>
Message-ID: <200803171207.27200.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 10:01:30 schrieb H. Verbeet:
> Personally, I'm not quite convinced of the need of an ati fragment
> shader ffp replacement in the first place. The functionality seems
> more of the level of register combiners and texture shaders.
Using that argument we could remove the nvrc/nvts code as well. Obviously this 
doesn't get us more functionality, but it brings ATI cards, most importantly 
the r200 cards to the same level as Nvidia cards.


From hverbeet at gmail.com  Mon Mar 17 06:18:11 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 17 Mar 2008 12:18:11 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803171207.27200.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803170218.09473.stefan@codeweavers.com>
	<d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>
	<200803171207.27200.stefan@codeweavers.com>
Message-ID: <d658b69e0803170418h69b9eee0od6d9805f186a7d13@mail.gmail.com>

On 17/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Montag, 17. M?rz 2008 10:01:30 schrieb H. Verbeet:
>
> > Personally, I'm not quite convinced of the need of an ati fragment
>  > shader ffp replacement in the first place. The functionality seems
>  > more of the level of register combiners and texture shaders.
>
> Using that argument we could remove the nvrc/nvts code as well. Obviously this
>  doesn't get us more functionality, but it brings ATI cards, most importantly
>  the r200 cards to the same level as Nvidia cards.
>
Supporting ATI fragment shader is useful, obviously. What I'm not so
sure about is positioning it as an ffp replacement.


From paul.vriens.wine at gmail.com  Mon Mar 17 07:21:36 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 13:21:36 +0100
Subject: wined3d: Check with "&& FALSE"
Message-ID: <47DE6250.6000506@gmail.com>

Hi,

In the past we had some occurrences of comparisons with NULL flags. I had this 
check run again today and it came back with:

./dlls/wined3d/arb_program_shader.c:316:         if(max_constantsF + 
extra_constants_needed + 1 < GL_LIMITS(pshader_constantsF) && FALSE) {

Is this line correct? Doesn't this alway return FALSE?

-- 
Cheers,

Paul.


From hverbeet at gmail.com  Mon Mar 17 07:39:35 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 17 Mar 2008 13:39:35 +0100
Subject: wined3d: Check with "&& FALSE"
In-Reply-To: <47DE6250.6000506@gmail.com>
References: <47DE6250.6000506@gmail.com>
Message-ID: <d658b69e0803170539h2a386946k35b1d82c9437a7f5@mail.gmail.com>

On 17/03/2008, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi,
>
>  In the past we had some occurrences of comparisons with NULL flags. I had this
>  check run again today and it came back with:
>
>  ./dlls/wined3d/arb_program_shader.c:316:         if(max_constantsF +
>  extra_constants_needed + 1 < GL_LIMITS(pshader_constantsF) && FALSE) {
>
>  Is this line correct? Doesn't this alway return FALSE?
>
Looks like leftover debug code to me.


From paul.vriens.wine at gmail.com  Mon Mar 17 07:48:30 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 13:48:30 +0100
Subject: wined3d: Check with "&& FALSE"
In-Reply-To: <d658b69e0803170539h2a386946k35b1d82c9437a7f5@mail.gmail.com>
References: <47DE6250.6000506@gmail.com>
	<d658b69e0803170539h2a386946k35b1d82c9437a7f5@mail.gmail.com>
Message-ID: <47DE689E.4030606@gmail.com>

H. Verbeet wrote:
> On 17/03/2008, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> Hi,
>>
>>  In the past we had some occurrences of comparisons with NULL flags. I had this
>>  check run again today and it came back with:
>>
>>  ./dlls/wined3d/arb_program_shader.c:316:         if(max_constantsF +
>>  extra_constants_needed + 1 < GL_LIMITS(pshader_constantsF) && FALSE) {
>>
>>  Is this line correct? Doesn't this alway return FALSE?
>>
> Looks like leftover debug code to me.
> 
Hi,

This is the commit responsible for this change:

commit 6313e0ffff5f57e437937e17fa482694d17d9664
Author: Stefan D?singer <stefan at codeweavers.com>
Date:   Fri Sep 14 13:02:59 2007 +0200

     wined3d: SRGB write correction emulation.

-- 
Cheers,

Paul.


From dank at kegel.com  Mon Mar 17 09:05:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 07:05:18 -0700
Subject: [Wine] Re: How to know which env vars a software wants
In-Reply-To: <1205761554.m2f.1445@forum.winehq.org>
References: <1205512949.m2f.1259@forum.winehq.org>
	<1205761554.m2f.1445@forum.winehq.org>
Message-ID: <a71bd89a0803170705u1757cee1m895f12c95de16dd1@mail.gmail.com>

vitamin <wineforum-user at winehq.org> wrote:
>  > > A simple touch ~/c:/windows/system32/drivers/etc/{services,host}
>  > So perhaps this will help other Informix-based apps?
>
>  Should probably add these files to Wine tree. "hosts" shouldn't need
> anything more then standard 127.0.0.1 localhost
>  And services should be empty.

Yep.  Filed as
http://bugs.winehq.org/show_bug.cgi?id=12076


From dank at kegel.com  Mon Mar 17 09:11:24 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 07:11:24 -0700
Subject: Make XP emulation the default?
Message-ID: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>

What would break if we made XP the default windows version in Wine?

I've run into several apps that fail to install unless I change that
setting lately...


From stefan at codeweavers.com  Mon Mar 17 09:14:21 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 15:14:21 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803170418h69b9eee0od6d9805f186a7d13@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171207.27200.stefan@codeweavers.com>
	<d658b69e0803170418h69b9eee0od6d9805f186a7d13@mail.gmail.com>
Message-ID: <200803171514.21417.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 12:18:11 schrieb H. Verbeet:
> Supporting ATI fragment shader is useful, obviously. What I'm not so
> sure about is positioning it as an ffp replacement.
Do you mean the term "ffp replacement", or what the code is doing? I for one 
call our nvrc code an ffp replacement as well, however, there's no sharp 
border between programmable and fixed function functionality. I've seen 
articles which called GL_ARB_texture_env_combine "programmable" as well.

I don't know if we can support 1.x pixel shaders properly using atifs because 
texkill and texdepth are missing. However, the visual test shows that the 
texdepth test is completely broken on my r200 card on Windows, and texkill 
basically works, but doesn't conform to the refrast and behavior of newer 
cards, so games should not really use those instructions.


From stefan at codeweavers.com  Mon Mar 17 09:06:46 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 15:06:46 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803170218.09473.stefan@codeweavers.com>
	<d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>
Message-ID: <200803171506.47002.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 10:01:30 schrieb H. Verbeet:
> Also, all the cards that are powerful enough to support a shader
> implementation of fixed function processing support GLSL vertex and
> fragment shaders, so realistically all you really need is a GLSL ffp
> replacement.
That's not quite true, my atifs replacement supports everything on the 
fragment side, and that card doesn't support GLSL(not even ARBfp). Also on 
the vertex side there are cards that have ARB only and not GLSL. I don't yet 
know if we can replace the fixed function vertex pipeline on r200 cards, as 
the 128 shader constants seem rather limiting, especially when it comes to 
indexed vertex blending. However, it should be able to do non-indexed vertex 
blending just fine, and we can get rid of the color conversion.


From julliard at winehq.org  Mon Mar 17 09:07:54 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 17 Mar 2008 15:07:54 +0100
Subject: msvcrt: Implement wcscat_s (try 4)
In-Reply-To: <frh8dd$kpq$1@ger.gmane.org> (Alistair Leslie-Hughes's message of
	"Sun, 16 Mar 2008 06:34:57 +1100")
References: <frh8dd$kpq$1@ger.gmane.org>
Message-ID: <87od9dbg05.fsf@wine.dyndns.org>

Alistair Leslie-Hughes <leslie_alistair at hotmail.com> writes:

> Hi,
> 	Added missing test

You should also test that you aren't overflowing the buffer. This should
help you find a bug in your implementation.

-- 
Alexandre Julliard
julliard at winehq.org


From hverbeet at gmail.com  Mon Mar 17 09:41:07 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 17 Mar 2008 15:41:07 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803171506.47002.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803170218.09473.stefan@codeweavers.com>
	<d658b69e0803170201n10b28d2fp1f849aa3c5dc3895@mail.gmail.com>
	<200803171506.47002.stefan@codeweavers.com>
Message-ID: <d658b69e0803170741i24251696gaae8e5ab6aa80f48@mail.gmail.com>

On 17/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Montag, 17. M?rz 2008 10:01:30 schrieb H. Verbeet:
>
> > Also, all the cards that are powerful enough to support a shader
>  > implementation of fixed function processing support GLSL vertex and
>  > fragment shaders, so realistically all you really need is a GLSL ffp
>  > replacement.
>
> That's not quite true, my atifs replacement supports everything on the
>  fragment side, and that card doesn't support GLSL(not even ARBfp).
Sure, but in that aspect it isn't really different from register combiners.

>  Also on
>  the vertex side there are cards that have ARB only and not GLSL. I don't yet
>  know if we can replace the fixed function vertex pipeline on r200 cards, as
>  the 128 shader constants seem rather limiting, especially when it comes to
>  indexed vertex blending. However, it should be able to do non-indexed vertex
>  blending just fine, and we can get rid of the color conversion.
>
I think a useful ffp replacement should at least replace the vertex
processing part. Extension s like ATI_fragment_shader and
NV_register_combiners, etc. can already support pretty much all of
fixed function fragment processing without having to integrate it in
the shader backends.

In terms of replacing vertex processing, anything that still has
dedicated hardware for fixed function processing isn't really powerful
enough to run such an ffp replacement, either because of instruction
count / number of constant limitations or simply execution speed. For
nvidia hardware that basically means you'll need at least something
like a GF5 or GF6.


From cjstimpson at utwire.net  Mon Mar 17 09:43:15 2008
From: cjstimpson at utwire.net (Clinton Stimpson)
Date: Mon, 17 Mar 2008 08:43:15 -0600
Subject: user32: test processing of expose events (try 3)
In-Reply-To: <47DE30D0.3020802@gmail.com>
References: <200803142359.54348.cjstimpson@utwire.net>
	<47DE30D0.3020802@gmail.com>
Message-ID: <47DE8383.5070205@utwire.net>

Paul Vriens wrote:
> Clinton Stimpson wrote:
>> Simplified from first try by removing unecessary thread.
>> Also fixing style to other code in file (thanks for feedback).
>>
>> ChangeLog:    user32: test processing of expose events
>>
>> Thanks,
>> Clinton Stimpson
>>
>>
>> ------------------------------------------------------------------------
>>
>>
> The patch has been committed but makes sure that the user32 tests 
> currently don't run on win95 anymore.
>
> Can the MsgWaitForMultipleObjectsEx be changed to a 
> MsgWaitForMultipleObjects?
Yes, it can be changed.  But its not clear to me why that fixes it.

Clint
>
> If so, I'll sent in a patch, if not we have to exclude this test for 
> win95 (and will also sent a patch).
>



From paul.vriens.wine at gmail.com  Mon Mar 17 09:46:43 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 15:46:43 +0100
Subject: user32: test processing of expose events (try 3)
In-Reply-To: <47DE8383.5070205@utwire.net>
References: <200803142359.54348.cjstimpson@utwire.net>
	<47DE30D0.3020802@gmail.com> <47DE8383.5070205@utwire.net>
Message-ID: <47DE8453.7060005@gmail.com>

Clinton Stimpson wrote:
> Paul Vriens wrote:
>> Clinton Stimpson wrote:
>>> Simplified from first try by removing unecessary thread.
>>> Also fixing style to other code in file (thanks for feedback).
>>>
>>> ChangeLog:    user32: test processing of expose events
>>>
>>> Thanks,
>>> Clinton Stimpson
>>>
>>>
>>> ------------------------------------------------------------------------
>>>
>>>
>> The patch has been committed but makes sure that the user32 tests 
>> currently don't run on win95 anymore.
>>
>> Can the MsgWaitForMultipleObjectsEx be changed to a 
>> MsgWaitForMultipleObjects?
> Yes, it can be changed.  But its not clear to me why that fixes it.
> 
> Clint

MsgWaitForMultipleObjectsEx is not available on win95. So we have to either load 
it via GetProcAddress and check for it's existence or just change to 
MsgWaitForMultipleObjects.

-- 
Cheers,

Paul.


From hverbeet at gmail.com  Mon Mar 17 09:53:04 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 17 Mar 2008 15:53:04 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803171514.21417.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171207.27200.stefan@codeweavers.com>
	<d658b69e0803170418h69b9eee0od6d9805f186a7d13@mail.gmail.com>
	<200803171514.21417.stefan@codeweavers.com>
Message-ID: <d658b69e0803170753y7b1046ffl35a3e372f80827bb@mail.gmail.com>

On 17/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Do you mean the term "ffp replacement", or what the code is doing? I for one
>  call our nvrc code an ffp replacement as well, however, there's no sharp
>  border between programmable and fixed function functionality. I've seen
>  articles which called GL_ARB_texture_env_combine "programmable" as well.
>
It's mostly a matter of where you integrate it into the code. At this
point I don't really see the advantage of making it a different shader
backend compared to integrating it into the existing fixed function
code.


From dank at kegel.com  Mon Mar 17 09:53:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 07:53:30 -0700
Subject: cabinet.dll -> FDICopy: Test added
Message-ID: <a71bd89a0803170753nc6caff2r4ce5766f262733e4@mail.gmail.com>

Did you forget the patch?


From stefan at codeweavers.com  Mon Mar 17 09:59:36 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 15:59:36 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803170741i24251696gaae8e5ab6aa80f48@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171506.47002.stefan@codeweavers.com>
	<d658b69e0803170741i24251696gaae8e5ab6aa80f48@mail.gmail.com>
Message-ID: <200803171559.36756.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 15:41:07 schrieb H. Verbeet:
> I think a useful ffp replacement should at least replace the vertex
> processing part. Extension s like ATI_fragment_shader and
> NV_register_combiners, etc. can already support pretty much all of
> fixed function fragment processing without having to integrate it in
> the shader backends.
From the atifs API putting the code into its own shader backend really helps 
abstraction and efficiency in wined3d(e.g. different state linking). nvrc has 
a vastly different API(individual stages instead of one "atomic" program that 
can't be split up).

If we ever implement pixel shaders using nvrc+nvts we'll have to move the code 
into a separate backend as well.

> In terms of replacing vertex processing, anything that still has
> dedicated hardware for fixed function processing isn't really powerful
> enough to run such an ffp replacement, either because of instruction
> count / number of constant limitations or simply execution speed. For
> nvidia hardware that basically means you'll need at least something
> like a GF5 or GF6.
I don't know how the r200 card works internally, but it might have dedicated 
ffp vertex hardware as well. At least from the development history of the 
r200 driver it seems like that, because the card didn't have ARBvp until the 
reverse engineered r300 code was backported.

Anyway, I do not intend to break the ability to use opengl fixed function + 
d3d shaders like we do now. Its just a matter of the shader backend 
configuring their state tables accordingly. Essentially glsl shader backend + 
its own state handlers = replacement pipeline, glsl shader backend + 
unmodified state table = opengl fixed function pipeline.

For the start I think we should prefer our current fixed function code with 
nvrc/ati by default and make a glsl or arb replacement opt-in for now. 
Especially glsl with its long shader linking time.


From thestig at google.com  Mon Mar 17 10:05:42 2008
From: thestig at google.com (Lei Zhang)
Date: Mon, 17 Mar 2008 08:05:42 -0700
Subject: explorer: add /startfile switch for starting files from file
	managers
In-Reply-To: <ced95fe0803162139q4a765f4dm1a84cc92a0ebe612@mail.gmail.com>
References: <ced95fe0803162139q4a765f4dm1a84cc92a0ebe612@mail.gmail.com>
Message-ID: <558b2f5c0803170805n1ec3f47kef243ac2f8732d4b@mail.gmail.com>

On Sun, Mar 16, 2008 at 9:39 PM, Vincent Povirk
<madewokherd+d41d at gmail.com> wrote:
> This patch adds a switch, /startfile, to explorer.exe, used as "wine
>  explorer /startfile filename". It accepts a windows or unix path. It
>  attempts to mimic what windows explorer does to start files and
>  provide some visible (gui) feedback when it doesn't work. The idea is
>  that wine.desktop can then be modified to use this switch instead of
>  wine, solving the following problems when starting exe files from file
>  managers:
>  * File managers typically do not set the working directory to the
>  directory that contains an exe when they start it. Setting the working
>  directory is the default behavior for windows explorer, and many
>  windows programs rely on it.
>  * File managers naturally use the unix path to start files, and the
>  wine binary passes the unix path along to the exe it starts, rather
>  than translating it to a windows path (this can and probably should
>  also be fixed somewhere else).
>  * Windows explorer always starts exe files with quotes around the path
>  in the command-line, even if the path does not contain spaces. The
>  wine binary does not (and probably should not) add quotes in this
>  situation. A few apps rely on the quotes. See
>  http://bugs.winehq.org/show_bug.cgi?id=5224#c14
>
>  My last attempt created a new winelib program; apparently this
>  functionality fits in explorer.
>
>  --
>  Vincent Povirk
>
>
>
>

Patches should go to wine-patches, not wine-devel.


From stefan at codeweavers.com  Mon Mar 17 10:15:21 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 16:15:21 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803170753y7b1046ffl35a3e372f80827bb@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171514.21417.stefan@codeweavers.com>
	<d658b69e0803170753y7b1046ffl35a3e372f80827bb@mail.gmail.com>
Message-ID: <200803171615.22030.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 15:53:04 schrieb H. Verbeet:
> It's mostly a matter of where you integrate it into the code. At this
> point I don't really see the advantage of making it a different shader
> backend compared to integrating it into the existing fixed function
> code.
As I explained in the other mail, atifs uses a complete fragment shader 
object, as opposed to nvrc/nvts and arb combiners, which configure single 
stages. This requires different state linking. So to implement that 
efficiently I need at least a different state table which links all fixed 
function states together, instead of one that links colorop settings and 
alphaop settings per stage.

Also if we ever implement pixel shaders using atifs we'll need a shader 
backend for it.


From hverbeet at gmail.com  Mon Mar 17 10:22:30 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 17 Mar 2008 16:22:30 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803171559.36756.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171506.47002.stefan@codeweavers.com>
	<d658b69e0803170741i24251696gaae8e5ab6aa80f48@mail.gmail.com>
	<200803171559.36756.stefan@codeweavers.com>
Message-ID: <d658b69e0803170822k1bba0bd8ve521f3dadb950456@mail.gmail.com>

On 17/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> From the atifs API putting the code into its own shader backend really helps
>  abstraction and efficiency in wined3d(e.g. different state linking). nvrc has
>  a vastly different API(individual stages instead of one "atomic" program that
>  can't be split up).
>
That's more an issue with the state table design than a reason to
create a new shader backend. A more hierarchical state table would
probably have helped there, but the general issue you're trying to
solve is that you want the state table to change depending on the
available extensions and wined3d configuration. I don't think that's
limited to shaders or fragment processing. If a GL3 spec ever actually
gets released, and actual drivers start implementing it, we'll run
into it there as well.


From dmitry at codeweavers.com  Mon Mar 17 10:36:42 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 17 Mar 2008 23:36:42 +0800
Subject: cabinet.dll -> FDICopy: Test added
References: <200803171816.51565.vitperov@etersoft.ru>
Message-ID: <05bf01c88844$b53f3030$a600fea9@DMITRY>

"Vitaly Perov" <vitperov at etersoft.ru> wrote:

> +void CreateEmptyCab(void)
> +{
> +    static char file_array [] = {77, 83, 67, 70, 0, 0, 0, 0, 36, 0, 0, 0, 0, 0, 0, 0, 36, 0, 0, 0, 0, 0, 0, 0, 3, 1, 
> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

It should be 'static const char' ?

> +    FILE* fp;
> +    int i;
> +
> +    fp = fopen("test1.cab", "wb" );
> +   if (!fp) trace("Can't create file test1.cab\n");

That should be an assert.

> +    for (i = 0; i < sizeof(file_array); i++)
> +        fputc(file_array[i], fp);

What about fwrite?

> +    fclose(fp);
> +}

Functions you add should be static. Use Win32 APIs to create a temporary
file. Set tab size to 8, and avoid using tabs to indent code at all. Avoid
trailing spaces.


-- 
Dmitry. 



From paul.vriens.wine at gmail.com  Mon Mar 17 10:41:13 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 16:41:13 +0100
Subject: advapi32 security tests and Vista (PROCESS_ALL_ACCESS)
Message-ID: <47DE9119.4040202@gmail.com>

Hi,

I'm now looking at some of the failures for the security tests on Vista. 
Apparently PROCESS_ALL_ACCESS which is defined as:

#define PROCESS_ALL_ACCESS         (STANDARD_RIGHTS_REQUIRED|SYNCHRONIZE|0xfff)

is changed on Vista:

#define PROCESS_ALL_ACCESS         (STANDARD_RIGHTS_REQUIRED|SYNCHRONIZE|0xffff)

Should I change the tests (CreateProcess) to check for both possibilities or 
should our PROCESS_ALL_ACCESS be changed?

I'm not sure what implications the latter one has yet. Only that using that mask 
on other windows versions will/could fail.

-- 
Cheers,

Paul.


From julliard at winehq.org  Mon Mar 17 10:43:05 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 17 Mar 2008 16:43:05 +0100
Subject: shell32: Support getting the shell folder path for users other
	than the current user and the default user (take 4)
In-Reply-To: <200803141125.m2EBPPPP010439@mailhost.geldorp.nl> (Ge van
	Geldorp's message of "Fri, 14 Mar 2008 12:25:27 +0100")
References: <200803141125.m2EBPPPP010439@mailhost.geldorp.nl>
Message-ID: <87abkxbbli.fsf@wine.dyndns.org>

"Ge van Geldorp" <ge at thinstall.com> writes:

> This is getting embarassing :). Fix memory leak.

Now it fails make test:

../../../tools/runtest -q -P wine -M shell32.dll -T ../../.. -p shell32_test.exe.so shellpath.c && touch shellpath.ok
shellpath.c:305: Test failed: SHGetFolderLocation(NULL, CSIDL_FAVORITES, 2, 0, &pidl) returned 0x80070006, expected E_FAIL
make[2]: *** [shellpath.ok] Error 1

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Mon Mar 17 10:47:39 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 16:47:39 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803170822k1bba0bd8ve521f3dadb950456@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171559.36756.stefan@codeweavers.com>
	<d658b69e0803170822k1bba0bd8ve521f3dadb950456@mail.gmail.com>
Message-ID: <200803171647.39614.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 16:22:30 schrieb H. Verbeet:
> That's more an issue with the state table design than a reason to
> create a new shader backend. A more hierarchical state table would
> probably have helped there, but the general issue you're trying to
> solve is that you want the state table to change depending on the
> available extensions and wined3d configuration. I don't think that's
> limited to shaders or fragment processing. If a GL3 spec ever actually
> gets released, and actual drivers start implementing it, we'll run
> into it there as well.

Couldn't we have discussed that one week ago when I sent the patches to 
wine-devel? ;-)

I think putting the state table into a shader backend is quite reasonable 
considering the existing opengl spec and extension, even if we do not call 
atifs/nvrc "shaders". With my patches we set the shader backend using complex 
conditions based on available extensions. If we keep the state table separate 
we'd set both that way, and probably need shader specific decisions in either 
the state handlers, or state table specific considerations in the shaders. I 
do not see what we would gain by not putting the atifs code into a shader 
backend, other than moving the temporary uglyness of the 3 backends to a 
permanent state table selection uglyness.

As far as opengl 3 is concerned, I think they wanted to get rid of the fixed 
function pipeline, in that case we'd be best of with the shader backend 
anyway. However, I think trying to find an architecture that deals with 
future interfaces is a bit of lottery anyway. We don't know what Direct3D 11 
will bring either.


From paul.vriens.wine at gmail.com  Mon Mar 17 11:21:51 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 17:21:51 +0100
Subject: [Tools 6/6] winetest: Issue a better description than '.' for
	the	special failure modes. Write them as a note so they stand out
	better.
In-Reply-To: <alpine.DEB.1.00.0803171232160.2931@amboise.dolphin>
References: <alpine.DEB.1.00.0803171232160.2931@amboise.dolphin>
Message-ID: <47DE9A9F.8000809@gmail.com>

Francois Gouget wrote:
> ---
>  winetest/gather |   12 ++++++------
>  1 files changed, 6 insertions(+), 6 deletions(-)
> 
> diff --git a/winetest/gather b/winetest/gather
> index b502345..ee49f4a 100755
> --- a/winetest/gather
> +++ b/winetest/gather
> @@ -329,21 +329,21 @@ sub singletest($$$) {
>  EOF
>      } elsif ($count eq "winetest crash") {
>          print OUT <<"EOF";
> -      <td class="result fail also-skip"><a
> +      <td class="note"><a
>          title="Test did not run as winetest crashed"
> -        >.</a></td>
> +        >winetest</a></td>
>  EOF
>      } elsif ($count eq "file limit") {
>          print OUT <<"EOF";
> -      <td class="result fail also-skip"><a
> +      <td class="note"><a
>          title="Test is missing because of a partial report file"
> -        >.</a></td>
> +        >truncated</a></td>
>  EOF
>      } elsif ($count eq "test missing") {
>          print OUT <<"EOF";
> -      <td class="result fail also-skip"><a
> +      <td class="note"><a
>          title="Test did not run for an unknown reason"
> -        >.</a></td>
> +        >not run</a></td>
>  EOF
>      } else {
>          my $class = $error?"fail":$todo?"todo":"pass";
Hi Francois,

We currently have these single '.' also when there are multiple failures for an 
OS that are actually the same failures.

For example the missing dll's. There are several dll's missing on win95 and 
win98 so it would be nice to have this reflected in the group piece of the page. 
I think green with a blue border looks much nicer than the single '.' we are 
currently having. Other thoughts?

The new page layout is now present and I must say it looks better although Wine 
looks a bit worse now because all the green is gone :-).

-- 
Cheers,

Paul.


From raccoonone at procyongames.com  Mon Mar 17 11:21:47 2008
From: raccoonone at procyongames.com (Christopher)
Date: Mon, 17 Mar 2008 09:21:47 -0700
Subject: Running services in WINE?
In-Reply-To: <47DAD30E.3060105@zalewski.pl>
References: <47D82648.30208@procyongames.com>		<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>		<47D8C6B9.8030607@procyongames.com>
	<47DA77A3.8060206@gmail.com>	<22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
	<47DACDF0.3060503@gmail.com> <47DAD30E.3060105@zalewski.pl>
Message-ID: <47DE9A9B.5060401@procyongames.com>

Miko?aj Zalewski wrote:
>
>> If we wanted to implemented a SCM where would that reside? wineboot?
>>   
>  The SCM is the servies.exe program. Other programs using advapi32 
> communicates with it using RPC. I've started writing it - see 
> http://www.winehq.org/pipermail/wine-patches/2007-September/044396.html 
> . The problems with widl are fixed so it should be possible to add 
> this code to Wine. Probably this code should be updated to current 
> Wine and I'm not sure if I moved all the database query function to 
> services.exe (it's good to more them all in one go to avoid 
> discrepancies between the current advapi implementation that relies on 
> the current state of registry keys and services.exe that loads all the 
> keys at start time and keeps them in memory).
>  I may have some time to work on it and I can help if someone who 
> wants to do it (if one wants to have an idea how the SCM works there 
> is a chapter about it in "Windows Internals" by M. Russinovich and D. 
> Solomon).
>
> Miko?aj Zalewski
>
>
Thanks for sending in your patch Miko?aj, I tested MozyHome with it, but 
it didn't help anything, the service still wouldn't start. I don't have 
the experience to work on that patch by myself, but if someone else 
starts on it and would like assistance making tests or something I'm 
happy to try.

Christopher Berner


From carlfongheiser at gmail.com  Mon Mar 17 11:23:47 2008
From: carlfongheiser at gmail.com (Carl Fongheiser)
Date: Mon, 17 Mar 2008 11:23:47 -0500
Subject: advapi32 security tests and Vista (PROCESS_ALL_ACCESS)
In-Reply-To: <47DE9119.4040202@gmail.com>
References: <47DE9119.4040202@gmail.com>
Message-ID: <1ba87a1f0803170923r7fbff0der7f2cc0a034da38e2@mail.gmail.com>

On Mon, Mar 17, 2008 at 10:41 AM, Paul Vriens <paul.vriens.wine at gmail.com>
wrote:

> Hi,
>
> I'm now looking at some of the failures for the security tests on Vista.
> Apparently PROCESS_ALL_ACCESS which is defined as:
>
> #define PROCESS_ALL_ACCESS
> (STANDARD_RIGHTS_REQUIRED|SYNCHRONIZE|0xfff)
>
> is changed on Vista:
>
> #define PROCESS_ALL_ACCESS
> (STANDARD_RIGHTS_REQUIRED|SYNCHRONIZE|0xffff)
>
> Should I change the tests (CreateProcess) to check for both possibilities
> or
> should our PROCESS_ALL_ACCESS be changed?
>
> I'm not sure what implications the latter one has yet. Only that using
> that mask
> on other windows versions will/could fail.
>

Windows Vista/Windows Server 2008 have a new permission flag,
PROCESS_QUERY_LIMITED_INFORMATION, with a value of 0x1000.  That's why they
added the extra nibble.   The permission check code isn't supposed to check
bits it doesn't know about, so it should be harmless to enable the extra
nibble even on older versions.

Carl Fongheiser
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080317/845f6ba8/attachment.htm 

From adam at tpetaccia.com  Mon Mar 17 11:35:37 2008
From: adam at tpetaccia.com (Adam Petaccia)
Date: Mon, 17 Mar 2008 12:35:37 -0400
Subject: gdi: Add a stub for GdipCreateFontFamilyFromName
In-Reply-To: <47DE4EC3.4000803@redhat.com>
References: <1205713085.6940.5.camel@mighmos>  <47DE4EC3.4000803@redhat.com>
Message-ID: <1205771738.6751.2.camel@mighmos>

On Mon, 2008-03-17 at 11:58 +0100, Michael Stefaniuc wrote:
> Adam Petaccia wrote:
> > This patch is needed for me to run Tabula Rasa.
> > 
> > This is my first patch, so please tell if I've broken conventions.
> Please add the correct declarations for "struct GpFontCollection" and
> "struct GpFontFamily". If you cannot find those on MSDN then check Mono;
> that one seems to have them too. But please do not cut'n'paste.
I believe they are abstract classes with no members of their own, but
I'm not sure how to write that in C. I'll take a look at similar wine
code in a bit, but does anyone have any pointers on where I should
start?

> 
> bye
> 	michael
> 
> > ------------------------------------------------------------------------
> > 
> > diff --git a/dlls/gdiplus/font.c b/dlls/gdiplus/font.c
> > index be60843..e0a781c 100644
> > --- a/dlls/gdiplus/font.c
> > +++ b/dlls/gdiplus/font.c
> > @@ -27,6 +27,9 @@
> >  
> >  #include "gdiplus.h"
> >  #include "gdiplus_private.h"
> > +#include "wine/debug.h"
> > +
> > +WINE_DEFAULT_DEBUG_CHANNEL(gdiplus);
> >  
> >  GpStatus WINGDIPAPI GdipCreateFontFromLogfontW(HDC hdc,
> >      GDIPCONST LOGFONTW *logfont, GpFont **font)
> > @@ -99,3 +102,10 @@ GpStatus WINGDIPAPI GdipGetLogFontW(GpFont *font, GpGraphics *graphics,
> >  
> >      return Ok;
> >  }
> > +
> > +GpStatus WINGDIPAPI GdipCreateFontFamilyFromName(GDIPCONST WCHAR *name, struct GpFontCollection *fontCollection, struct GpFontFamily **FontFamily)
> > +{
> > +	FIXME("GdipCreateFontFamilyFromName: stub!\n");
> > +
> > +	return Ok;
> > +}
> > diff --git a/dlls/gdiplus/gdiplus.spec b/dlls/gdiplus/gdiplus.spec
> > index 4aac0df..1fbc57a 100644
> > --- a/dlls/gdiplus/gdiplus.spec
> > +++ b/dlls/gdiplus/gdiplus.spec
> > @@ -85,7 +85,7 @@
> >  @ stdcall GdipCreateCustomLineCap(ptr ptr long long ptr)
> >  @ stub GdipCreateEffect
> >  @ stub GdipCreateFont
> > -@ stub GdipCreateFontFamilyFromName
> > +@ stdcall GdipCreateFontFamilyFromName(ptr ptr ptr)
> >  @ stub GdipCreateFontFromDC
> >  @ stdcall GdipCreateFontFromLogfontA(ptr ptr ptr)
> >  @ stdcall GdipCreateFontFromLogfontW(ptr ptr ptr)
> > diff --git a/dlls/gdiplus/gdiplus_private.h b/dlls/gdiplus/gdiplus_private.h
> > index 09ef83f..cd6a7d5 100644
> > --- a/dlls/gdiplus/gdiplus_private.h
> > +++ b/dlls/gdiplus/gdiplus_private.h
> > @@ -184,4 +184,9 @@ struct GpStringFormat{
> >      StringAlignment vertalign;
> >  };
> >  
> > +struct GpFontCollection{
> > +};
> > +
> > +struct GpFontFamily{
> > +};
> >  #endif
> > 
> > 
> > ------------------------------------------------------------------------
> > 
> > 
> 
> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080317/e1ec07b8/attachment.pgp 

From pure_evil at mail.bg  Mon Mar 17 12:04:44 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Mon, 17 Mar 2008 19:04:44 +0200
Subject: First wine cpl available to test - the regional settings
Message-ID: <200803171904.44476.pure_evil@mail.bg>

I made the first cpl (intl.cpl), and, the actual executable that goes with it.
http://www.keepandshare.com/doc/view.php?id=460541&da=y
that should link to a file called intl_wine.zip.
It contains 2 things: intl.cpl which goes into c:\windows\system32
and a folder - winecontrolapplets containing the executable 
winelocalesetup.exe. The folder goes into c:\windows. 
when using "wine control", that should've added a "Locale settings" icon in 
the control panel, and launching it should execute the winelocalesetup.exe.
For some reason, though, it only reads the reg values, when trying to 
write 'em, they revert.
(haven't tested it on a winbox yet though; if writing sticks there, a possible 
bug? Using wine 0.9.57. Tested it on two openSuSe 10.3 boxes though.)

Give the concept a test drive, see if the duality matching cpl/real executable 
is feasable etc, drop me a line on cpls in general - which ones should be 
emulated etc.

If you're more interested in only the regional settings themselves, test 'em 
out on a few locales; I've already done the US one, also 
"LANG=bg_BG wine control" and "LANG=ru_RU wine control" appear to show logical 
stuff, but I have no way of knowing whether the other locales look good.

Cheers,
Stefanov


From lich at math.spbu.ru  Mon Mar 17 12:22:33 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Mon, 17 Mar 2008 17:22:33 +0000
Subject: services.exe: series of patches - empty attachments.
Message-ID: <200803172022.34310.lich@math.spbu.ru>

Hi,

Empty patches are attached to every e-mail in this series.
Size: 0 bytes
http://www.winehq.org/pipermail/wine-patches/2008-March/051638.html
http://www.winehq.org/pipermail/wine-patches/2008-March/051651.html
http://www.winehq.org/pipermail/wine-patches/2008-March/051641.html
...
--
Kirill


From fgouget at free.fr  Mon Mar 17 12:18:08 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 17 Mar 2008 18:18:08 +0100 (CET)
Subject: [Tools 6/6] winetest: Issue a better description than '.' for
	the special failure modes. Write them as a note so they stand out
	better.
In-Reply-To: <47DE9A9F.8000809@gmail.com>
References: <alpine.DEB.1.00.0803171232160.2931@amboise.dolphin>
	<47DE9A9F.8000809@gmail.com>
Message-ID: <alpine.DEB.1.00.0803171756180.22074@amboise.dolphin>

On Mon, 17 Mar 2008, Paul Vriens wrote:
[...]
> We currently have these single '.' also when there are multiple failures for
> an OS that are actually the same failures.

Yes, I've noticed that. Essentially we lose information when merging bug 
reports. Fix That's next on my todo list. Here's my (optimistic) todo 
list:

 * Fix merging report data so the group-level information is more 
accurate.
 * Collect statistics about the number of unit tests that failed and 
their percentage, both for individual reports and for groups.
 * For each build, collect global statistics about the group-level 
results, how many reports of each type are present, etc. Store that 
in a new machine readable file (a bit like the individual report's 
summary.txt files).
 * Add a new script that takes these build-level summaries and generates 
a proper top-level index file showing the percentage of failed unit 
tests and the count of reports for each group.

That last bit would make progress more visible, and would make it easier 
to find a build which has been tested on a given platform.


> For example the missing dll's. There are several dll's missing on win95 and
> win98 so it would be nice to have this reflected in the group piece of the
> page. I think green with a blue border looks much nicer than the single '.' we
> are currently having. Other thoughts?

Well, if, for a given test, all the reports in the group have the 
same state ('crashed', 'timed out', 'errors', etc.), then the group's 
cell should look exactly like each of the corresponding report cells. So 
in the missing Win95 dlls, this would indeed be a 'pass also-skip' cell. 
But if they all crashed, then it should be a white cell with 
the 'crashed' message.

If the cells have different states, for instance one says 'crashed' and 
the other 'timed out', or one says 'not run' and the other says errors 
occurred, then I think the group cell should say something like 'mixed' 
and be on a white background.

Maybe the 'filelimit' and 'truncated' cells should be ignored when 
merging, though we should really not have any of these either.



> The new page layout is now present and I must say it looks better although
> Wine looks a bit worse now because all the green is gone :-).

Yeah :-/ But I think it more accurately reflects the state of Wine. 
Hopefully it's also more motivating for the people fixing Wine to 
eliminate todos.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                           La terre est une b


From mikolaj at zalewski.pl  Mon Mar 17 12:21:10 2008
From: mikolaj at zalewski.pl (=?UTF-8?B?TWlrb8WCYWogWmFsZXdza2k=?=)
Date: Mon, 17 Mar 2008 18:21:10 +0100
Subject: services.exe: series of patches - empty attachments.
In-Reply-To: <200803172022.34310.lich@math.spbu.ru>
References: <200803172022.34310.lich@math.spbu.ru>
Message-ID: <47DEA886.7040808@zalewski.pl>


>Hi,
>
>Empty patches are attached to every e-mail in this series.
>Size: 0 bytes
>http://www.winehq.org/pipermail/wine-patches/2008-March/051638.html
>http://www.winehq.org/pipermail/wine-patches/2008-March/051651.html
>http://www.winehq.org/pipermail/wine-patches/2008-March/051641.html
>...
>  
>
  For some reason the attachements are shown by the mail archive as 
separate [PATCH] entries, like: 
http://www.winehq.org/pipermail/wine-patches/2008-March/051639.html .

Miko?aj Zalewski


From mikolaj at zalewski.pl  Mon Mar 17 12:27:30 2008
From: mikolaj at zalewski.pl (=?UTF-8?B?TWlrb8WCYWogWmFsZXdza2k=?=)
Date: Mon, 17 Mar 2008 18:27:30 +0100
Subject: Running services in WINE?
In-Reply-To: <47DE9A9B.5060401@procyongames.com>
References: <47D82648.30208@procyongames.com>		<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>		<47D8C6B9.8030607@procyongames.com>
	<47DA77A3.8060206@gmail.com>	<22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
	<47DACDF0.3060503@gmail.com> <47DAD30E.3060105@zalewski.pl>
	<47DE9A9B.5060401@procyongames.com>
Message-ID: <47DEAA02.40101@zalewski.pl>


> Thanks for sending in your patch Miko?aj, I tested MozyHome with it, 
> but it didn't help anything, the service still wouldn't start. I don't 
> have the experience to work on that patch by myself, but if someone 
> else starts on it and would like assistance making tests or something 
> I'm happy to try.

  I can look into that (I see it's bug #12030) however it looks like 
it's not a problem with starting the service but may be a problem with 
the service itself. Have you tried to run this service with e.g. notepad 
running in the background - the services are marked as system processes 
and if there is no non-system process left, all the system processes 
will terminate themselves.

Miko?aj Zalewski


From paul.vriens.wine at gmail.com  Mon Mar 17 13:00:03 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 19:00:03 +0100
Subject: msi: Skip the endlines test if the table fails on import
In-Reply-To: <22821af30803171016i3ed4ffb6hdbfdaad76035057b@mail.gmail.com>
References: <22821af30803171016i3ed4ffb6hdbfdaad76035057b@mail.gmail.com>
Message-ID: <47DEB1A3.3090406@gmail.com>

James Hawkins wrote:
> Hi,
> 
> Fixes 33 test failures on win9x.
> 
> Changelog:
> * Skip the endlines test if the table fails on import.
> 
>  dlls/msi/tests/db.c |    7 ++++++-
>  1 files changed, 6 insertions(+), 1 deletions(-)
> 
> 
> 
> ------------------------------------------------------------------------
> 
> 
But shouldn't the ok-call stay and be moved after the if? Or is there not much 
extra information when add_table_to_db fails?

-- 
Cheers,

Paul.


From stefan at codeweavers.com  Mon Mar 17 13:08:28 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 19:08:28 +0100
Subject: wined3d: Check with "&& FALSE"
In-Reply-To: <47DE689E.4030606@gmail.com>
References: <47DE6250.6000506@gmail.com>
	<d658b69e0803170539h2a386946k35b1d82c9437a7f5@mail.gmail.com>
	<47DE689E.4030606@gmail.com>
Message-ID: <200803171908.28947.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 13:48:30 schrieb Paul Vriens:
> H. Verbeet wrote:
> > On 17/03/2008, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> >>  Is this line correct? Doesn't this alway return FALSE?
> >
> > Looks like leftover debug code to me.
Yes, this is leftover debugging code. Feel free to send a patch to remove it



From paul.vriens.wine at gmail.com  Mon Mar 17 13:19:15 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 19:19:15 +0100
Subject: wined3d: Check with "&& FALSE"
In-Reply-To: <200803171908.28947.stefan@codeweavers.com>
References: <47DE6250.6000506@gmail.com>
	<d658b69e0803170539h2a386946k35b1d82c9437a7f5@mail.gmail.com>
	<47DE689E.4030606@gmail.com>
	<200803171908.28947.stefan@codeweavers.com>
Message-ID: <47DEB623.8020301@gmail.com>

Stefan D?singer wrote:
> Am Montag, 17. M?rz 2008 13:48:30 schrieb Paul Vriens:
>> H. Verbeet wrote:
>>> On 17/03/2008, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>>>>  Is this line correct? Doesn't this alway return FALSE?
>>> Looks like leftover debug code to me.
> Yes, this is leftover debugging code. Feel free to send a patch to remove it
> 
OK, I'll sent a patch for that.

What's "strange" though is that Coverity didn't pick this up as DEADCODE.

Cheers,

Paul.


From paul.vriens.wine at gmail.com  Mon Mar 17 13:22:27 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 17 Mar 2008 19:22:27 +0100
Subject: Running services in WINE?
In-Reply-To: <47DEAA02.40101@zalewski.pl>
References: <47D82648.30208@procyongames.com>		<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>		<47D8C6B9.8030607@procyongames.com>
	<47DA77A3.8060206@gmail.com>	<22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
	<47DACDF0.3060503@gmail.com> <47DAD30E.3060105@zalewski.pl>
	<47DE9A9B.5060401@procyongames.com> <47DEAA02.40101@zalewski.pl>
Message-ID: <47DEB6E3.8060207@gmail.com>

Miko?aj Zalewski wrote:
> 
>> Thanks for sending in your patch Miko?aj, I tested MozyHome with it, 
>> but it didn't help anything, the service still wouldn't start. I don't 
>> have the experience to work on that patch by myself, but if someone 
>> else starts on it and would like assistance making tests or something 
>> I'm happy to try.
> 
>  I can look into that (I see it's bug #12030) however it looks like it's 
> not a problem with starting the service but may be a problem with the 
> service itself. Have you tried to run this service with e.g. notepad 
> running in the background - the services are marked as system processes 
> and if there is no non-system process left, all the system processes 
> will terminate themselves.
> 
> Miko?aj Zalewski

I already had a quick look and it looks like it fails while it tries to 
talk to mozyfilter. This is a system driver that's not (properly?) 
installed during installation for an yet unknown reason. Or is just that 
system drivers like this are not supported (yet)?

Cheers,

Paul.


From raccoonone at procyongames.com  Mon Mar 17 13:26:10 2008
From: raccoonone at procyongames.com (Christopher)
Date: Mon, 17 Mar 2008 11:26:10 -0700
Subject: Running services in WINE?
In-Reply-To: <47DEAA02.40101@zalewski.pl>
References: <47D82648.30208@procyongames.com>		<b130c85e0803121939x3f562627pe3ec5cdeb4f94235@mail.gmail.com>		<47D8C6B9.8030607@procyongames.com>
	<47DA77A3.8060206@gmail.com>	<22821af30803140939s40b21dd5pdb3f47cf3c2c8eff@mail.gmail.com>
	<47DACDF0.3060503@gmail.com> <47DAD30E.3060105@zalewski.pl>
	<47DE9A9B.5060401@procyongames.com> <47DEAA02.40101@zalewski.pl>
Message-ID: <47DEB7C2.1050805@procyongames.com>

Miko?aj Zalewski wrote:
>
>> Thanks for sending in your patch Miko?aj, I tested MozyHome with it, 
>> but it didn't help anything, the service still wouldn't start. I 
>> don't have the experience to work on that patch by myself, but if 
>> someone else starts on it and would like assistance making tests or 
>> something I'm happy to try.
>
>  I can look into that (I see it's bug #12030) however it looks like 
> it's not a problem with starting the service but may be a problem with 
> the service itself. Have you tried to run this service with e.g. 
> notepad running in the background - the services are marked as system 
> processes and if there is no non-system process left, all the system 
> processes will terminate themselves.
>
> Miko?aj Zalewski
>
>
I tried it with notepad running in the background, and the same thing 
happens: mozybackup.exe shows up in the process list for ~3seconds then 
disappears and the console displays the fixme's that I posted in bug #12030.

If you have time to look into it that would be great! My knowledge of 
how services work is limited at best (still an undergrad, and I haven't 
taken an OS class yet).
Christopher


From truiken at gmail.com  Mon Mar 17 15:08:58 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 17 Mar 2008 15:08:58 -0500
Subject: msi: Skip the endlines test if the table fails on import
In-Reply-To: <47DEB1A3.3090406@gmail.com>
References: <22821af30803171016i3ed4ffb6hdbfdaad76035057b@mail.gmail.com>
	<47DEB1A3.3090406@gmail.com>
Message-ID: <22821af30803171308l4f2e95at77ccc9fb842dc7e3@mail.gmail.com>

On Mon, Mar 17, 2008 at 1:00 PM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>
> James Hawkins wrote:
>  > Hi,
>  >
>  > Fixes 33 test failures on win9x.
>  >
>  > Changelog:
>  > * Skip the endlines test if the table fails on import.
>  >
>  >  dlls/msi/tests/db.c |    7 ++++++-
>  >  1 files changed, 6 insertions(+), 1 deletions(-)
>  >
>  >
>  >
>  > ------------------------------------------------------------------------
>  >
>  >
>  But shouldn't the ok-call stay and be moved after the if? Or is there not much
>  extra information when add_table_to_db fails?
>

The ok is kinda pointless after the if statement.  The real tests are
the rest of the oks.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Mon Mar 17 15:45:29 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 17 Mar 2008 13:45:29 -0700
Subject: Google Summer of Code 2008 is on!
Message-ID: <b130c85e0803171345g2d50b559g6697b1a4cf7ea5b8@mail.gmail.com>

Hi all,

Wine has been officially accepted as mentoring organisation for
2008!!!!!!!! Just thought I'd share.

I hope this will be the best summer of code for wine yet!

Cheers,
Maarten.


From stefan at codeweavers.com  Mon Mar 17 16:29:30 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 17 Mar 2008 22:29:30 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803171647.39614.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<d658b69e0803170822k1bba0bd8ve521f3dadb950456@mail.gmail.com>
	<200803171647.39614.stefan@codeweavers.com>
Message-ID: <200803172229.30779.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 16:47:39 schrieb Stefan D?singer:
> Am Montag, 17. M?rz 2008 16:22:30 schrieb H. Verbeet:
> > That's more an issue with the state table design than a reason to
> > create a new shader backend. A more hierarchical state table would
> > probably have helped there, but the general issue you're trying to
> > solve is that you want the state table to change depending on the
> > available extensions and wined3d configuration. I don't think that's
> > limited to shaders or fragment processing. If a GL3 spec ever actually
> > gets released, and actual drivers start implementing it, we'll run
> > into it there as well.
> I think putting the state table into a shader backend is quite reasonable
> considering the existing opengl spec and extension, even if we do not call
> atifs/nvrc "shaders". With my patches we set the shader backend using
> complex conditions based on available extensions.
> ...
Thinking about a bit more I think I have a better phrasing of this: The API of 
GL_ATI_fragment_shader is very close to the shader API of 
GL_ARB_fragment_program / GLSL, and as far as the global WineD3D design is 
concerend it is equal to the ARBfp one. Contrary to that, the nvrc API is 
comparable to the ARB_texture_env_combine API. We do not care how it works in 
the driver or the hardware, that's all abstracted away from us. API-wise it 
is a shader API, I think that is reason enough to give the atifs code its own 
shader backend.


From mailjohnmorris at gmail.com  Mon Mar 17 16:41:39 2008
From: mailjohnmorris at gmail.com (John Morris)
Date: Mon, 17 Mar 2008 16:41:39 -0500
Subject: UrlCanonicalize patch I submitted
Message-ID: <1125723f0803171441i585ba334u61ef5145ad8f9d75@mail.gmail.com>

Hi,

Last week I submitted a patch to correct the behavior of the
UrlCanonicalize{W,A} functions.
I found that "Stylus Studio 2007" had problems opening files that had
a space in the path name.

Tracing through the code, I found that the UrlCanonicalizeW function
was not removing the "%20" escaped space when the URL_UNESCAPE bit was
set in the flags parameter.  I wrote a small program that set the
flags like stylus studio was doing and ran it on both wine and
windows, and found that wine definitely didn't handle it the same as
windows.

I made a small change to dlls/shlwapi/url.c, as well as added a test
case to dlls/shlwapi/tests/url.c. With that change I got the same
result with my program on both windows and wine.

This is only my second patch to wine, so please feel free to give me
any feedback, and let me know if there is anything that would be
deemed incorrect about the way I did this.

Many Thanks,

John Morris


From dank at kegel.com  Mon Mar 17 18:03:39 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 16:03:39 -0700
Subject: improve winetricks dotnet 1.1
In-Reply-To: <a71bd89a0803111315m6812e01fqb30a2663b30f05d3@mail.gmail.com>
References: <a71bd89a0803111315m6812e01fqb30a2663b30f05d3@mail.gmail.com>
Message-ID: <a71bd89a0803171603s61c89741q2b5a98d8b0e9b4c0@mail.gmail.com>

On Tue, Mar 11, 2008 at 1:15 PM, Dan Kegel <dank at kegel.com> wrote:
> Louis wrote:
>  > Hi, i wonder if it would be possible to improve
>  > winetricks dotnet 1.1, so that it's actually able to run
>  >.net-1.1 applications. Currently it only installs the framework,
>  > but due to bugs the apps don't run.   Atm i use pretty worthless
>  > script below to get them running..

Louis, your script did

winetricks allfonts
wineprefixcreate  #to register the fonts

which I didn't quite understand.  Why do fonts installed by
perfectly valid corefonts installers from Microsoft need
to be registered?  Do we have a bug somewhere?

I ask because http://winehq.org/pipermail/wine-users/2008-March/030284.html
mentions that it helped him.  I'm still not quite convinced,
hoping you can enlighten me.
- Dan


From dank at kegel.com  Mon Mar 17 18:15:52 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 16:15:52 -0700
Subject: Please create 1.2.0 milestone in Bugzilla
Message-ID: <a71bd89a0803171615u6de6d3a6oca591b54a611bb21@mail.gmail.com>

The 1.1.x releases will be development releases,
so a 1.1.0 milestone doesn't make much sense.
Please create a 1.2.0 milestone in Bugzilla.
Thanks!
- Dan


From rob at codeweavers.com  Mon Mar 17 18:32:42 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 17 Mar 2008 23:32:42 +0000
Subject: services.exe/advapi32[3/7]: start a local RPC server
In-Reply-To: <47DD9147.9000802@zalewski.pl>
References: <47DD9147.9000802@zalewski.pl>
Message-ID: <47DEFF9A.4040800@codeweavers.com>

Miko?aj Zalewski wrote:
> @@ -231,6 +247,101 @@ static inline LPWSTR SERV_dupmulti(LPCSTR str)
>  }
>  
>  /******************************************************************************
> + * RPC connection with servies.exe
> + */
> +
> +static BOOL check_services_exe()
> +{
>   

Put "void" in the brackets here and in many other places.

> +static SvcCtlRpcHandle connect_to_server(LPCWSTR server)
> +{
> +    WCHAR transport[] = SVCCTL_TRANSPORT;
> +    WCHAR endpoint[] = SVCCTL_ENDPOINT;
> +    LPWSTR server_copy = NULL;
> +    RPC_WSTR binding_str;
> +    RPC_STATUS status;
> +    SvcCtlRpcHandle rpc_handle;
> +    
> +    /* unlike Windows we start services.exe on demand. We start it always as
> +     * checking if this is our address can be tricky */
> +    if (!check_services_exe())
> +        return NULL;
> +
> +    if (server) /* parameters of RpcStringBindingComposeW are not const */
> +    {
> +        server_copy = HeapAlloc(GetProcessHeap(), 0, sizeof(WCHAR)*(strlenW(server) + 1));
> +        strcpyW(server_copy, server);
> +    }
>   

RpcStringBindingComposeW doesn't change server if you pass it in, so 
there is no need to make a copy.

> +    status = RpcStringBindingComposeW(NULL, transport, server_copy, endpoint, NULL, &binding_str);
> +    HeapFree(GetProcessHeap(), 0, server_copy);
> +    if (status != RPC_S_OK)
> +    {
> +        ERR("RpcStringBindingComposeW failed (%d)\n", (DWORD)status);
> +        return NULL;
> +    }
>   

> diff --git a/include/wine/svcctl.idl b/include/wine/svcctl.idl
> new file mode 100644
> index 0000000..fefd12f
> --- /dev/null
> +++ b/include/wine/svcctl.idl
> @@ -0,0 +1,68 @@
> +/*
> + * svcctl interface definitions - exported by services.exe to access the
> + * services database
> + *
> + * Copyright 2007 Google (Mikolaj Zalewski)
> + *
> + * This library is free software; you can redistribute it and/or
> + * modify it under the terms of the GNU Lesser General Public
> + * License as published by the Free Software Foundation; either
> + * version 2.1 of the License, or (at your option) any later version.
> + *
> + * This library is distributed in the hope that it will be useful,
> + * but WITHOUT ANY WARRANTY; without even the implied warranty of
> + * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
> + * Lesser General Public License for more details.
> + *
> + * You should have received a copy of the GNU Lesser General Public
> + * License along with this library; if not, write to the Free Software
> + * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
> + */
> +
> +import "wtypes.idl";
> +
> +/* 
> + * some defined for the C code
> + */
> +cpp_quote("#define SVCCTL_TRANSPORT {'n','c','a','c','n','_','n','p',0}");
> +cpp_quote("#define SVCCTL_ENDPOINT {'\\\\','p','i','p','e','\\\\','s','v','c','c','t','l',0}");
> +
> +/* Not the Windows event name - if needed the true one can be found in Inside Windows */
> +cpp_quote("#define SVCCTL_STARTED_EVENT (const WCHAR[]){'_','_','w','i','n','e','_','S','v','c','c','t','l','S','t','a','r','t','e','d',0}");
> +
> +
> +/* Based on the Samba IDL. Some functions are compatible with Windows but some
> + * aren't and many are missing (thus function numbers are different) so we
> + * don't use the Windows uuid which is 367abb81-9844-35f1-ad32-98f038001003 .
> + */
> +[ uuid(78e2d9e8-d2a8-40d8-9bbe-7328cc5a9c32),
> +  version(2.0),
> +  pointer_default(unique),
> +  endpoint("ncacn_np:[\\pipe\\svcctl]"),
> +  helpstring("Service Control")
> +] interface svcctl
> +{
> +    typedef handle_t SvcCtlRpcHandle;
> +
> +    typedef struct _POLICY_HANDLE
> +    {
> +        DWORD dwHandleType;
> +	GUID uuid;
> +    } POLICY_HANDLE;
>   

There's no need to use Samba's concept of "POLICY_HANDLE". We fully 
support the DCE/RPC context_handle type which is what this actually is.

You can find out more about how to use context handles here:
http://msdn2.microsoft.com/en-us/library/aa373605(VS.85).aspx

> +
> +    /* Compatible with Windows function 0x00 */
> +    DWORD svcctl_CloseServiceHandle(
> +        [in] SvcCtlRpcHandle rpc_handle,
> +        [in,out] POLICY_HANDLE *handle
> +    );
>   

There's no need for the rpc_handle here once you make the second 
parameter into a context handle.

> +
> +    /* Compatible with Windows function 0x0f */
> +    DWORD svcctl_OpenSCManagerW(
> +        SvcCtlRpcHandle rpc_handle,
> +        [in,unique] LPCWSTR MachineName,
> +        [in,unique] LPCWSTR DatabaseName,
> +        [in] DWORD dwAccessMask,
> +        [out] POLICY_HANDLE *handle
> +    );
> +
> +}
>   

-- 
Rob Shearman



From wine at eternaldusk.com  Mon Mar 17 18:34:57 2008
From: wine at eternaldusk.com (Evil Jay)
Date: Mon, 17 Mar 2008 18:34:57 -0500
Subject: Make XP emulation the default?
In-Reply-To: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>
References: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>
Message-ID: <47DF0021.9050207@eternaldusk.com>

Dan Kegel wrote:
> What would break if we made XP the default windows version in Wine?
>
> I've run into several apps that fail to install unless I change that
> setting lately..

The only thing I can think of off-hand is IE6.  It will claim that an
equal/later version is already installed (even after
registry/file-system changes) if the Windows version is > Win2k.


-J


From dank at kegel.com  Mon Mar 17 18:40:54 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 16:40:54 -0700
Subject: Make XP emulation the default?
In-Reply-To: <47DF0021.9050207@eternaldusk.com>
References: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>
	<47DF0021.9050207@eternaldusk.com>
Message-ID: <a71bd89a0803171640h2eb57c38j8e6bd7895306da79@mail.gmail.com>

On Mon, Mar 17, 2008 at 4:34 PM, Evil Jay <wine at eternaldusk.com> wrote:
>  > What would break if we made XP the default windows version in Wine?
>  >
>  > I've run into several apps that fail to install unless I change that
>  > setting lately..
>
>  The only thing I can think of off-hand is IE6.  It will claim that an
>  equal/later version is already installed (even after
>  registry/file-system changes) if the Windows version is > Win2k.

Who's going to be affected by that?

ies4linux's author can work around that just fine, he won't mind.
- Dan


From rob at codeweavers.com  Mon Mar 17 18:55:46 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 17 Mar 2008 23:55:46 +0000
Subject: services.exe/advapi32[5/7]: Move QueryServiceConfig to
	services.exe
In-Reply-To: <47DD922D.1080505@zalewski.pl>
References: <47DD922D.1080505@zalewski.pl>
Message-ID: <47DF0502.4060700@codeweavers.com>

In the next patch you've found a problem:

Miko?aj Zalewski wrote:
> +#if 0 /* for some reason (rpcrt4 bug?) QueryServiceConfig for a non-NULL lpLoadOrder crashes Wine */
>   

The issue is to do with this code:

>                       LPQUERY_SERVICE_CONFIGW lpServiceConfig,
>                       DWORD cbBufSize, LPDWORD pcbBytesNeeded)
>  {
> -    WCHAR str_buffer[ MAX_PATH ];
> -    LONG r;
> -    DWORD type, val, sz, total, n;
> -    LPBYTE p;
> -    HKEY hKey;
> +    QUERY_SERVICE_CONFIGW config;
>      struct sc_service *hsvc;
> +    DWORD total;
> +    DWORD err;
> +    BYTE *bufpos;
>  
>      TRACE("%p %p %d %p\n", hService, lpServiceConfig,
>             cbBufSize, pcbBytesNeeded);
> @@ -1886,58 +1908,21 @@ QueryServiceConfigW( SC_HANDLE hService,
>          SetLastError( ERROR_INVALID_HANDLE );
>          return FALSE;
>      }
> -    hKey = hsvc->hkey;
> -
> -    /* TODO: Check which members are mandatory and what the registry types
> -     * should be. This should of course also be tested when a service is
> -     * created.
> -     */
> -
> -    /* calculate the size required first */
> -    total = sizeof (QUERY_SERVICE_CONFIGW);
>  
> -    sz = sizeof(str_buffer);
> -    r = RegQueryValueExW( hKey, szImagePath, 0, &type, (LPBYTE) str_buffer, &sz );
> -    if( ( r == ERROR_SUCCESS ) && ( type == REG_SZ || type == REG_EXPAND_SZ ) )
> +    if ((err = svcctl_QueryServiceConfigW(hsvc->hdr.rpc_handle, &hsvc->hdr.server_handle, &config)) != 0)
>   

The problem is that QUERY_SERVICE_CONFIGW contains pointers and the 
DCE/RPC programming model ensures that non-NULL pointers that are being 
unmarshalled into are used (presumably to reduce memory allocations). So 
the issue here is that you're not initialising config before passing it 
into svcctl_QueryServiceConfigW and it is blowing up just by chance on 
the pointer occupying the lpLoadOrderGroup; it could just as well have 
been lpBinaryName, lpServiceStartName or lpDisplayName.

> +
> +    /* Windows function 0x11 must be using a different prototype - not compatible */
> +    /* Robert Shearman thinks there should be a byte_count attribute but (as of Sep 2007)
> +     * this isn't supported by widl nor by rpcrt4 */
> +    DWORD svcctl_QueryServiceConfigW(
> +        SvcCtlRpcHandle rpc_handle,
> +        [in] POLICY_HANDLE *handle,
> +        [out] QUERY_SERVICE_CONFIGW *config);
> +
>  }
>   

The byte_count attribute is officially deprecated by Microsoft and it's 
not part of the DCE/RPC standard, plus you've already done the work and 
it's wire compatible (I think) without the attribute, so you can remove 
the comment about it.

-- 
Rob Shearman



From rob at codeweavers.com  Mon Mar 17 18:55:53 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 17 Mar 2008 23:55:53 +0000
Subject: services.exe/advapi32[7/7]: move GetServiceDisplayName to
	services.exe and implement GetServiceKeyName
In-Reply-To: <47DD934B.8050405@zalewski.pl>
References: <47DD934B.8050405@zalewski.pl>
Message-ID: <47DF0509.7010109@codeweavers.com>

Miko?aj Zalewski wrote:
> +    /* Windows function 0x14 must be using a different prototype - not compatible */
> +    DWORD svcctl_GetServiceDisplayNameW(
> +        SvcCtlRpcHandle rpc_handle,
> +        [in] POLICY_HANDLE *hSCManager,
> +        [in] LPCWSTR lpServiceName,
> +        [in,out,size_is(cchBufSize)] WCHAR lpBuffer[],
> +        [in] DWORD cchBufSize,
> +        [out] DWORD *cchLength);
> +
> +    /* Windows function 0x15 must be using a different prototype - not compatible */
> +    DWORD svcctl_GetServiceKeyNameW(
> +        SvcCtlRpcHandle rpc_handle,
> +        [in] POLICY_HANDLE *hSCManager,
> +        [in] LPCWSTR lpServiceDisplayName,
> +        [in,out,size_is(cchBufSize)] WCHAR lpBuffer[],
> +        [in] DWORD cchBufSize,
> +        [out] DWORD *cchLength);
>  }
>   

The lpBuffer parameter should be out-only instead of in and out. I 
believe this will make the prototype compatible.

-- 
Rob Shearman



From wine.dev at web.de  Mon Mar 17 18:59:34 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Tue, 18 Mar 2008 00:59:34 +0100
Subject: appdb request: "Browse Regressions"
In-Reply-To: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>
References: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>
Message-ID: <1205798374.17905.10.camel@p4>

On So, 2008-03-16 at 07:30 -0700, Dan Kegel wrote:
> want to use the appdb itself
> to see which apps have recently fallen in rating.

Nice Idea.

> Following past appdb practice, one would implement
> that by adding a new "Browse Regressions" menu
> item on the left,

I created recently the Patch for Bugzilla:
"Task Lists" => "Regressions"

http://bugs.winehq.org/buglist.cgi?bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&product=Wine&keywords=regression&keywords_type=anywords



-- 
 
By by ... Detlef




From dank at kegel.com  Mon Mar 17 19:21:33 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 17:21:33 -0700
Subject: appdb request: "Browse Regressions"
In-Reply-To: <20080316155323.139350@gmx.net>
References: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>
	<20080316155323.139350@gmx.net>
Message-ID: <a71bd89a0803171721o78f05734g240b09094f99312e@mail.gmail.com>

On Sun, Mar 16, 2008 at 8:53 AM, Roderick Colenbrander
<thunderbird2k at gmx.net> wrote:
>  Personally I don't trust appdb regressions much.

We could work around some of the problems by only listing
apps where the same reviewer gave it a lower rating in a
newer version of wine.  That compensates for the lack
of a uniform rating system somewhat.


From stefan at codeweavers.com  Mon Mar 17 19:35:33 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 01:35:33 +0100
Subject: 1/6 WineD3D: CheckDeviceFormat rewrite
In-Reply-To: <20080317192258.74730@gmx.net>
References: <20080317192258.74730@gmx.net>
Message-ID: <200803180135.33788.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 20:22:58 schrieb Roderick Colenbrander:
> Hi,
>
> This patch puts legacy bump mapping in its own function.
Battlefield 1942 is broken for me after these patches, apparently because 
D3DFMT_R8G8B8 is enabled again. As far as I can see this is due to the early 
if(!Usage) return in the texture resource check, the code never reaches the if 
condition that disables R8G8B8. Is this early return needed at all? It seems 
confusing to me and is only going to cause breakage similarly to the old 
code.

The old code enabled R8G8B8 for d3d7, but I think you can remove that and keep 
the format disabled altogether. As far as I can see Windows does not support 
it in ddraw either, and enabling it for d3d7 but not d3d8 wouldn't make 
sense.

By the way, I noticed(a bit late) that the patches from yesterday broke depth 
stencil selection for me. These patches fix this problem again, but I'm 
afraid it will cause some issues for regression testing.


From stefan at codeweavers.com  Mon Mar 17 19:35:33 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 01:35:33 +0100
Subject: 1/6 WineD3D: CheckDeviceFormat rewrite
In-Reply-To: <20080317192258.74730@gmx.net>
References: <20080317192258.74730@gmx.net>
Message-ID: <200803180135.33788.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 20:22:58 schrieb Roderick Colenbrander:
> Hi,
>
> This patch puts legacy bump mapping in its own function.
Battlefield 1942 is broken for me after these patches, apparently because 
D3DFMT_R8G8B8 is enabled again. As far as I can see this is due to the early 
if(!Usage) return in the texture resource check, the code never reaches the if 
condition that disables R8G8B8. Is this early return needed at all? It seems 
confusing to me and is only going to cause breakage similarly to the old 
code.

The old code enabled R8G8B8 for d3d7, but I think you can remove that and keep 
the format disabled altogether. As far as I can see Windows does not support 
it in ddraw either, and enabling it for d3d7 but not d3d8 wouldn't make 
sense.

By the way, I noticed(a bit late) that the patches from yesterday broke depth 
stencil selection for me. These patches fix this problem again, but I'm 
afraid it will cause some issues for regression testing.


From chris.kcat at gmail.com  Mon Mar 17 19:46:33 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Mon, 17 Mar 2008 16:46:33 -0800
Subject: ntoskrnl.exe: Implement MmIsAddressValid (bug 11082)
In-Reply-To: <1205795360.17905.4.camel@p4>
References: <1205795360.17905.4.camel@p4>
Message-ID: <200803171746.33498.chris.kcat@gmail.com>

On Monday 17 March 2008 04:09:20 pm Detlef Riekenberg wrote:
> + ? ? ? ?(info.Protect & (PAGE_READWRITE || PAGE_EXECUTE_READWRITE)) &&

Did you mean | instead of || there?


From jim at pagesmiths.com  Mon Mar 17 19:51:14 2008
From: jim at pagesmiths.com (Jim White)
Date: Mon, 17 Mar 2008 17:51:14 -0700
Subject: appdb request: "Browse Regressions"
In-Reply-To: <a71bd89a0803171721o78f05734g240b09094f99312e@mail.gmail.com>
References: <a71bd89a0803160730o466a24f9x2345e3aa64f8b512@mail.gmail.com>	<20080316155323.139350@gmx.net>
	<a71bd89a0803171721o78f05734g240b09094f99312e@mail.gmail.com>
Message-ID: <47DF1202.1080607@pagesmiths.com>

Dan Kegel wrote:
> On Sun, Mar 16, 2008 at 8:53 AM, Roderick Colenbrander
> <thunderbird2k at gmx.net> wrote:
> 
>> Personally I don't trust appdb regressions much.
> 
> We could work around some of the problems by only listing
> apps where the same reviewer gave it a lower rating in a
> newer version of wine.  That compensates for the lack
> of a uniform rating system somewhat.

Reminds me of a bit I just read on a guy who's doing really well in the 
Netflix competition.  One of the good heuristics he uses is to track the 
levels that a particular person uses to adjust for the "anchoring effect".

http://www.wired.com/techbiz/media/magazine/16-03/mf_netflix?currentPage=all

> One such phenomenon is the anchoring effect, a problem endemic to any
> numerical rating scheme. If a customer watches three movies in a row
> that merit four stars ? say, the Star Wars trilogy ? and then sees
> one that's a bit better ? say, Blade Runner ? they'll likely give the
> last movie five stars. But if they started the week with one-star
> stinkers like the Star Wars prequels, Blade Runner might get only a 4
> or even a 3. Anchoring suggests that rating systems need to take
> account of inertia ? a user who has recently given a lot of
> above-average ratings is likely to continue to do so. Potter finds
> precisely this phenomenon in the Netflix data; and by being aware of
> it, he's able to account for its biasing effects and thus more
> accurately pin down users' true tastes.

Jim


From dmitry at codeweavers.com  Mon Mar 17 20:09:37 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 18 Mar 2008 09:09:37 +0800
Subject: ntoskrnl.exe: Implement MmIsAddressValid (bug 11082)
References: <1205795360.17905.4.camel@p4>
Message-ID: <016e01c88894$be6b0080$a600fea9@DMITRY>

"Detlef Riekenberg" <wine.dev at web.de> wrote:

> +    len = VirtualQuery(VirtualAddress, &info, sizeof(MEMORY_BASIC_INFORMATION));
> +
> +    if ((len == sizeof(MEMORY_BASIC_INFORMATION)) && 
> +        (info.Protect & (PAGE_READWRITE || PAGE_EXECUTE_READWRITE)) &&
> +        ((info.Protect & PAGE_NOACCESS) == 0) &&
> +        (info.Type & MEM_COMMIT))
> +    {
> +        return TRUE;
> +    }

Besides the already pointed out '||' vs. '|' mismatch your code doesn't
handle PAGE_READONLY and others implying read-only access. Probably checking
for PAGE_NOACCESS and MEM_COMMIT should be enough.

-- 
Dmitry.


From wine at eternaldusk.com  Mon Mar 17 20:18:36 2008
From: wine at eternaldusk.com (Evil Jay)
Date: Mon, 17 Mar 2008 20:18:36 -0500
Subject: Make XP emulation the default?
In-Reply-To: <a71bd89a0803171640h2eb57c38j8e6bd7895306da79@mail.gmail.com>
References: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>	
	<47DF0021.9050207@eternaldusk.com>
	<a71bd89a0803171640h2eb57c38j8e6bd7895306da79@mail.gmail.com>
Message-ID: <47DF186C.9080707@eternaldusk.com>

Dan Kegel wrote:
> Who's going to be affected by that?
>
> ies4linux's author can work around that just fine, he won't mind.
> - Dan
>   
You do have an incredibly good point there...

-J


From dank at kegel.com  Mon Mar 17 20:24:52 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 Mar 2008 18:24:52 -0700
Subject: Fresh valgrind errors in richedit
Message-ID: <a71bd89a0803171824s5d998e2bgcf56300e72542ba4@mail.gmail.com>

Eric, could you have a look at

http://kegel.com/wine/valgrind/logs-2008-03-17/vg-riched20_editor-diff.txt

There are several new errors of the sort:

+ Conditional jump or move depends on uninitialised value(s)
+    at  ME_SetParaFormat (para.c:400)
+    by  ME_SetSelectionParaFormat (para.c:436)
+    by  ME_RTFReadHook (editor.c:662)
+    by  RTFGetToken (reader.c:417)
+    by  RTFRead (reader.c:333)
+    by  ME_StreamIn (editor.c:1095)
+    by  RichEditWndProc_common (editor.c:2432)
+    by  RichEditWndProcA (editor.c:3237)
+    by  (within /home/dank/wine-git/dlls/user32/user32.dll.so)
+    by  call_window_proc (winproc.c:457)
+    by  WINPROC_call_window (winproc.c:2207)
+    by  call_window_proc (message.c:1615)
+    by  send_message (message.c:2430)
+    by  SendMessageA (message.c:2575)
+    by  test_EM_SETTEXTMODE (editor.c:471)
+    by  func_editor (editor.c:2705)
+    by  run_test (test.h:406)
+    by  main (test.h:455)


From stefan at codeweavers.com  Mon Mar 17 20:37:25 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 02:37:25 +0100
Subject: [19/22] WineD3D: Enable V8U8 for legacy bump mapping with ati
	extensions
In-Reply-To: <200803171946.45445.stefan@codeweavers.com>
References: <200803162209.22453.stefan@codeweavers.com>
	<200803171946.45445.stefan@codeweavers.com>
Message-ID: <200803180237.25318.stefan@codeweavers.com>

Am Montag, 17. M?rz 2008 19:46:45 schrieb Stefan D?singer:
> Here is an updated patch that takes Roderick's recent changes into account
Yet another patch, it takes Rodericks patches from today into account. Feel 
free to apply whatever patch suits better. If none of them are applied I will 
resend all the patches when Roderick is done with his CheckDeviceFormat 
rewite

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0024-WineD3D-Enable-V8U8-for-legacy-bump-mapping-with-at.patch
Type: text/x-diff
Size: 1040 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080318/6341d694/attachment.patch 

From m.b.lankhorst at gmail.com  Tue Mar 18 00:08:32 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 17 Mar 2008 22:08:32 -0700
Subject: Google Summer of Code 2008 is on!
In-Reply-To: <b130c85e0803171345g2d50b559g6697b1a4cf7ea5b8@mail.gmail.com>
References: <b130c85e0803171345g2d50b559g6697b1a4cf7ea5b8@mail.gmail.com>
Message-ID: <b130c85e0803172208xde9970do4c346dd6b7a5599f@mail.gmail.com>

Hello all,

2008/3/17, Maarten Lankhorst <m.b.lankhorst at gmail.com>:
>  Wine has been officially accepted as mentoring organisation for
>  2008!!!!!!!! Just thought I'd share.
>
>  I hope this will be the best summer of code for wine yet!
Can everyone who wants to volunteer as mentor sign up at
http://code.google.com/soc/mentor_step1.html please?

Thanks!

Maarten


From andrewriedi at gmail.com  Tue Mar 18 00:11:06 2008
From: andrewriedi at gmail.com (Andrew Riedi)
Date: Mon, 17 Mar 2008 22:11:06 -0700
Subject: user32: Add test_CreateIconFromResourceEx().
In-Reply-To: <01bc01c887ec$78e0f720$a600fea9@DMITRY>
References: <689de9370803161544j310ad57p312e928e460aa3d0@mail.gmail.com>
	<01bc01c887ec$78e0f720$a600fea9@DMITRY>
Message-ID: <689de9370803172211w1cc996c2k517b1c0b8a8090d7@mail.gmail.com>

On Sun, Mar 16, 2008 at 10:05 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> "Andrew Riedi" <andrewriedi at gmail.com> wrote:
>
>  > changelog: user32: Add test_CreateIconFromResourceEx().
>
>  What this patch is supposed to test? Just that CreateIconFromResourceEx
>  returns a valid icon handle? What about the resulting icon contents?
>  What about cases when CreateIconFromResourceEx should fail?
>
>  --
>  Dmitry.
>
Mostly, this patch is just to serve as a check to make sure I don't
horribly screw up CreateIconFromResourceEx().  I need to abstract some
of the functionality out, and make use of it elsewhere.  Right now our
CreateIconFromResourceEx() works flawlessly, as far as I know.
Checking for contents afterwards would be a good idea though - I will
send an updated patch to do exactly that before I touch our
CreateIconFromResourceEx().

As always, thanks for looking over my code, Dmitry.  :)

-- 
Andrew Riedi


From dmitry at codeweavers.com  Tue Mar 18 00:35:31 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 18 Mar 2008 13:35:31 +0800
Subject: user32: Add test_CreateIconFromResourceEx().
References: <689de9370803161544j310ad57p312e928e460aa3d0@mail.gmail.com><01bc01c887ec$78e0f720$a600fea9@DMITRY>
	<689de9370803172211w1cc996c2k517b1c0b8a8090d7@mail.gmail.com>
Message-ID: <006901c888b9$e314af10$a600fea9@DMITRY>

"Andrew Riedi" <andrewriedi at gmail.com> wrote:

> Mostly, this patch is just to serve as a check to make sure I don't
> horribly screw up CreateIconFromResourceEx().  I need to abstract some
> of the functionality out, and make use of it elsewhere.  Right now our
> CreateIconFromResourceEx() works flawlessly, as far as I know.
> Checking for contents afterwards would be a good idea though - I will
> send an updated patch to do exactly that before I touch our
> CreateIconFromResourceEx().

I'd suggest to add the tests not only for various parameters passed
to CreateIconFromResourceEx (not just a random one), but also add to
the resources icons/images with different color depth and test how they
are loaded (for instance the bug 10854 mentions an app which has 24-bpp
bitmap or icon in its resources, and that leads to the problem later
on when the app usess the returned handle to draw an image).

-- 
Dmitry.


From paul.vriens.wine at gmail.com  Tue Mar 18 02:16:24 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 18 Mar 2008 08:16:24 +0100
Subject: wined3d: Check with "&& FALSE"
In-Reply-To: <200803171908.28947.stefan@codeweavers.com>
References: <47DE6250.6000506@gmail.com>
	<d658b69e0803170539h2a386946k35b1d82c9437a7f5@mail.gmail.com>
	<47DE689E.4030606@gmail.com>
	<200803171908.28947.stefan@codeweavers.com>
Message-ID: <47DF6C48.4050207@gmail.com>

Stefan D?singer wrote:
> Am Montag, 17. M?rz 2008 13:48:30 schrieb Paul Vriens:
>> H. Verbeet wrote:
>>> On 17/03/2008, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>>>>  Is this line correct? Doesn't this alway return FALSE?
>>> Looks like leftover debug code to me.
> Yes, this is leftover debugging code. Feel free to send a patch to remove it
> 
> 
A patch to remove the debugging code is no problem. It's the surrounding 
comments that worry me (what's should stay, what should go, what should change).

I'd rather have you (or any other volunteer) put this somewhere on your 
todo-list :-)

-- 
Cheers,

Paul.


From dank at kegel.com  Tue Mar 18 02:33:06 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 00:33:06 -0700
Subject: SoC page insurrection! Idea details needed, please read.
Message-ID: <a71bd89a0803180033r70a59ccatd14d11de179be174@mail.gmail.com>

Looking at our Summer of Code ideas page,
I realized it was getting dense and unruly,
so I and Maarten moved it off to the side
and did a simpler one; see
http://wiki.winehq.org/SummerOfCode

The DirectX stuff in particular could use some
more detail; could the knowledgeable people flesh it out?

Also each idea should probably have a sponsor
the students could turn to for ideas.  I've put a
few obvious ones in, but it'd be nice if each one
was claimed.

Thanks,
Dan


From thunderbird2k at gmx.net  Tue Mar 18 03:27:01 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 18 Mar 2008 09:27:01 +0100
Subject: 1/6 WineD3D: CheckDeviceFormat rewrite
In-Reply-To: <200803180135.33788.stefan@codeweavers.com>
References: <20080317192258.74730@gmx.net>
	<200803180135.33788.stefan@codeweavers.com>
Message-ID: <20080318082701.173790@gmx.net>

> > Hi,
> >
> > This patch puts legacy bump mapping in its own function.
> Battlefield 1942 is broken for me after these patches, apparently because 
> D3DFMT_R8G8B8 is enabled again. As far as I can see this is due to the
> early 
> if(!Usage) return in the texture resource check, the code never reaches
> the if 
> condition that disables R8G8B8. Is this early return needed at all? It
> seems 
> confusing to me and is only going to cause breakage similarly to the old 
> code.
> 
> The old code enabled R8G8B8 for d3d7, but I think you can remove that and
> keep 
> the format disabled altogether. As far as I can see Windows does not
> support 
> it in ddraw either, and enabling it for d3d7 but not d3d8 wouldn't make 
> sense.
> 
> By the way, I noticed(a bit late) that the patches from yesterday broke
> depth 
> stencil selection for me. These patches fix this problem again, but I'm 
> afraid it will cause some issues for regression testing.
> 

The patches from yesterday where the start. These new 6 patches will move most of the other code around. After it the change is done for about 90%. Today I will send a bunch of other patches which will move some smaller parts like one which takes care of this r8g8b8 version check (I moved it to the top of the function but I could also keep it where it is and remove !Usage checks). I also need to enable set dynamic / softwareprocessing and a few others.

I think it is best to continue now. I'll prepare some of the other patches now.

Roderick
-- 
Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen! 
Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer


From thunderbird2k at gmx.net  Tue Mar 18 03:44:28 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 18 Mar 2008 09:44:28 +0100
Subject: 1/6 WineD3D: CheckDeviceFormat rewrite
In-Reply-To: <20080318082701.173790@gmx.net>
References: <20080317192258.74730@gmx.net>
	<200803180135.33788.stefan@codeweavers.com>
	<20080318082701.173790@gmx.net>
Message-ID: <20080318084428.191020@gmx.net>

> > > Hi,
> > >
> > > This patch puts legacy bump mapping in its own function.
> > Battlefield 1942 is broken for me after these patches, apparently
> because 
> > D3DFMT_R8G8B8 is enabled again. As far as I can see this is due to the
> > early 
> > if(!Usage) return in the texture resource check, the code never reaches
> > the if 
> > condition that disables R8G8B8. Is this early return needed at all? It
> > seems 
> > confusing to me and is only going to cause breakage similarly to the old
> > code.
> > 
> > The old code enabled R8G8B8 for d3d7, but I think you can remove that
> and
> > keep 
> > the format disabled altogether. As far as I can see Windows does not
> > support 
> > it in ddraw either, and enabling it for d3d7 but not d3d8 wouldn't make 
> > sense.
> > 
> > By the way, I noticed(a bit late) that the patches from yesterday broke
> > depth 
> > stencil selection for me. These patches fix this problem again, but I'm 
> > afraid it will cause some issues for regression testing.
> > 
> 
> The patches from yesterday where the start. These new 6 patches will move
> most of the other code around. After it the change is done for about 90%.
> Today I will send a bunch of other patches which will move some smaller
> parts like one which takes care of this r8g8b8 version check (I moved it to the
> top of the function but I could also keep it where it is and remove !Usage
> checks). I also need to enable set dynamic / softwareprocessing and a few
> others.
> 
> I think it is best to continue now. I'll prepare some of the other patches
> now.
> 
> Roderick

Patch 7/6, 8/6, 9/6 should take away most issues. Yesterday I didn't have the time to prepare those but they should be fine.

Roderick
-- 
Psssst! Schon vom neuen GMX MultiMessenger geh?rt?
Der kann`s mit allen: http://www.gmx.net/de/go/multimessenger


From epssyis at gmail.com  Tue Mar 18 05:30:45 2008
From: epssyis at gmail.com (Edward Savage)
Date: Tue, 18 Mar 2008 21:30:45 +1100
Subject: Please create 1.2.0 milestone in Bugzilla
In-Reply-To: <a71bd89a0803171615u6de6d3a6oca591b54a611bb21@mail.gmail.com>
References: <a71bd89a0803171615u6de6d3a6oca591b54a611bb21@mail.gmail.com>
Message-ID: <d6c5d7290803180330x21e79457kebc236789952afdd@mail.gmail.com>

On Tue, Mar 18, 2008 at 10:15 AM, Dan Kegel <dank at kegel.com> wrote:
> The 1.1.x releases will be development releases,
>  so a 1.1.0 milestone doesn't make much sense.
>  Please create a 1.2.0 milestone in Bugzilla.
>  Thanks!
>  - Dan
>

Is there a reason we wont be continuing the current y.y.x (ie 0.9.x
and 1.0.x) style releases for development?

Most foss applications seem to have moved away from the even odd
release cycle and due to wines long lead times between releases having
it this way could get rather confusing for newer users not expecting
it.

Edward

Ps Sorry for the dupe dan, hit the wrong button.


From julliard at winehq.org  Tue Mar 18 05:56:16 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 18 Mar 2008 11:56:16 +0100
Subject: 6/6 WineD3D: CheckDeviceFormat rewrite
In-Reply-To: <20080317192720.74730@gmx.net> (Roderick Colenbrander's message
	of "Mon, 17 Mar 2008 20:27:20 +0100")
References: <20080317192720.74730@gmx.net>
Message-ID: <87y78g9u7j.fsf@wine.dyndns.org>

"Roderick Colenbrander" <thunderbird2k at gmx.net> writes:

> This patch removes some code which isn't needed anymore. All of this is now handled inside the resource type checks.

It doesn't work here:

../../../tools/runtest -q -P wine -M d3d9.dll -T ../../.. -p d3d9_test.exe.so visual.c && touch visual.ok
visual.c:2555: Test failed: quad 1 has color 00000000, expected 0x00FFFF00
visual.c:2559: Test failed: quad 3 has color 00000000, expected 0x0000FF00
visual.c:2642: Test failed: quad 1 has color 00000000, expected 0x00FF0000
visual.c:2649: Test failed: quad 4 has color 00000000, expected 0x0033cc00
wine: Unhandled page fault on write access to 0x05594884 at address 0x601cdcb6 (thread 0036), starting debugger...

-- 
Alexandre Julliard
julliard at winehq.org


From tony.wasserka at freenet.de  Tue Mar 18 06:05:49 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Tue, 18 Mar 2008 12:05:49 +0100
Subject: Proposal for debugging improvement
Message-ID: <E1JbZdd-0007MN-Dp@www14.emo.freenet-rz.de>

Hi,
When I was trying to find out how the native d3dx9_36.dll handles ID3DXRenderToSurface->BeginScene()
with WINEDEBUG="+d3d9,heap" I had the problem that I had to find out what functions are called
within the dll and what functions are called by the d3d9 functions (and thus are irrelevant for d3dx9).
For example this is what I got for BeginScene: (fixmes were disabled)

> trace:d3d9:IDirect3DSurface9Impl_GetDesc (0xc3b428) Relay
> trace:d3d9:IDirect3DDevice9Impl_CreateDepthStencilSurface Relay
> trace:d3d9:IDirect3DDevice9Impl_CreateSurface (0x1264c8) Relay
> trace:heap:RtlAllocateHeap (0x110000,0000000a,0000001c): returning 0xc3b450
> trace:d3d9:IDirect3DDevice9Impl_CreateSurface (0x1264c8) : w(256) h(256) fmt(0) surf@(nil)
> trace:heap:RtlAllocateHeap (0x110000,0000000a,00000114): returning 0x1b81e0
> trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 4
> trace:d3d9:IDirect3DDevice9Impl_CreateSurface (0x1264c8) : Created surface 0xc3b450
> trace:d3d9:IDirect3DDevice9Impl_BeginStateBlock (0x1264c8) Relay
> trace:heap:RtlAllocateHeap (0x110000,0000000a,0000c994): returning 0xd1df30
> trace:heap:RtlAllocateHeap (0x110000,0000000a,000006a0): returning 0xc3b820
> trace:heap:RtlAllocateHeap (0x110000,0000000a,000001a8): returning 0xa7b7e8
> trace:heap:RtlAllocateHeap (0x110000,0000000a,000006b0): returning 0x1b8300
> trace:heap:RtlAllocateHeap (0x110000,0000000a,000001ac): returning 0xd2a8d0
> trace:heap:RtlAllocateHeap (0x110000,00000002,000001ac): returning 0xc3bec8
> trace:heap:RtlAllocateHeap (0x110000,00000002,000001a8): returning 0xa7b998
> trace:d3d9:IDirect3DDevice9Impl_SetViewport (0x1264c8)0xc3b384 Relay
> trace:d3d9:IDirect3DDevice9Impl_EndStateBlock (0x1264c8) Relay
> trace:heap:RtlAllocateHeap (0x110000,0000000a,00000010): returning 0xd1dec8
> trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 5
> trace:d3d9:IDirect3DDevice9Impl_EndStateBlock (0x1264c8)Returning 0xd1dec8 0xd1df30
> trace:d3d9:IDirect3DStateBlock9Impl_Capture (0xd1dec8) Relay
> trace:d3d9:IDirect3DDevice9Impl_GetRenderTarget (0x1264c8) Relay
> trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d20)
> trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 6
> trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d20) : AddRef from 0
> trace:d3d9:IDirect3DDevice9Impl_GetDepthStencilSurface (0x1264c8) Relay
> trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d48)
> trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 7
> trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d48) : AddRef from 0
> trace:d3d9:IDirect3DDevice9Impl_SetRenderTarget (0x1264c8) Relay
> trace:heap:RtlFreeHeap (0x110000,00000002,0x178110): returning TRUE
> trace:d3d9:IDirect3DDevice9Impl_SetDepthStencilSurface (0x1264c8) Relay
> trace:d3d9:IDirect3DDevice9Impl_SetViewport (0x1264c8)0xc3b384 Relay
> trace:d3d9:IDirect3DDevice9Impl_BeginScene (0x1264c8) Relay
> trace:d3d9:IDirect3DSurface9Impl_AddRef (0xc3b428)
> trace:d3d9:IDirect3DSurface9Impl_AddRef (0xc3b428) : Forwarding to 0xa7b6e8
> trace:d3d9:IDirect3DTexture9Impl_AddRef (0xa7b6e8) : AddRef from 2
> trace:heap:RtlAllocateHeap (0x110000,00000002,0000001d): returning 0xc3b478

However, after distinguishing the direct and the indirect function calls, I would've found an output like this much better:
> trace:d3d9:IDirect3DSurface9Impl_GetDesc (0xc3b428) Relay
> trace:d3d9:IDirect3DDevice9Impl_CreateDepthStencilSurface Relay
>   trace:d3d9:IDirect3DDevice9Impl_CreateSurface (0x1264c8) Relay
>     trace:heap:RtlAllocateHeap (0x110000,0000000a,0000001c): returning 0xc3b450
>     trace:d3d9:IDirect3DDevice9Impl_CreateSurface (0x1264c8) : w(256) h(256) fmt(0) surf@(nil)
>     trace:heap:RtlAllocateHeap (0x110000,0000000a,00000114): returning 0x1b81e0
>     trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 4
> trace:d3d9:IDirect3DDevice9Impl_CreateSurface (0x1264c8) : Created surface 0xc3b450
> trace:d3d9:IDirect3DDevice9Impl_BeginStateBlock (0x1264c8) Relay
>   trace:heap:RtlAllocateHeap (0x110000,0000000a,0000c994): returning 0xd1df30
>   trace:heap:RtlAllocateHeap (0x110000,0000000a,000006a0): returning 0xc3b820
>   trace:heap:RtlAllocateHeap (0x110000,0000000a,000001a8): returning 0xa7b7e8
>   trace:heap:RtlAllocateHeap (0x110000,0000000a,000006b0): returning 0x1b8300
>   trace:heap:RtlAllocateHeap (0x110000,0000000a,000001ac): returning 0xd2a8d0
>   trace:heap:RtlAllocateHeap (0x110000,00000002,000001ac): returning 0xc3bec8
>   trace:heap:RtlAllocateHeap (0x110000,00000002,000001a8): returning 0xa7b998
> trace:d3d9:IDirect3DDevice9Impl_SetViewport (0x1264c8)0xc3b384 Relay
> trace:d3d9:IDirect3DDevice9Impl_EndStateBlock (0x1264c8) Relay
>   trace:heap:RtlAllocateHeap (0x110000,0000000a,00000010): returning 0xd1dec8
>   trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 5
>   trace:d3d9:IDirect3DDevice9Impl_EndStateBlock (0x1264c8)Returning 0xd1dec8 0xd1df30
> trace:d3d9:IDirect3DStateBlock9Impl_Capture (0xd1dec8) Relay
> trace:d3d9:IDirect3DDevice9Impl_GetRenderTarget (0x1264c8) Relay
>   trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d20)
>     trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 6
>     trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d20) : AddRef from 0
> trace:d3d9:IDirect3DDevice9Impl_GetRenderTarget (0x1264c8) Finished
> trace:d3d9:IDirect3DDevice9Impl_GetDepthStencilSurface (0x1264c8) Relay
>   trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d48)
>     trace:d3d9:IDirect3DDevice9Impl_AddRef (0x1264c8) : AddRef from 7
>   trace:d3d9:IDirect3DSurface9Impl_AddRef (0x177d48) : AddRef from 0
> trace:d3d9:IDirect3DDevice9Impl_SetRenderTarget (0x1264c8) Relay
>   trace:heap:RtlFreeHeap (0x110000,00000002,0x178110): returning TRUE
> trace:d3d9:IDirect3DDevice9Impl_SetDepthStencilSurface (0x1264c8) Relay
> trace:d3d9:IDirect3DDevice9Impl_SetViewport (0x1264c8)0xc3b384 Relay
> trace:d3d9:IDirect3DDevice9Impl_BeginScene (0x1264c8) Relay
>   trace:d3d9:IDirect3DSurface9Impl_AddRef (0xc3b428)
>     trace:d3d9:IDirect3DSurface9Impl_AddRef (0xc3b428) : Forwarding to 0xa7b6e8
>   trace:d3d9:IDirect3DTexture9Impl_AddRef (0xa7b6e8) : AddRef from 2
>   trace:heap:RtlAllocateHeap (0x110000,00000002,0000001d): returning 0xc3b478

I have to admit that I have yet no real idea if this distinction is correct, but I hope it makes clear what I want to approach.
All traces that have been made inside of a nested function call are written a bit more right, so that one
can easily see that it hasn't been called directly by an application.


A suggestion for how to realize this system would be to
1) add a variable that counts how much right a debug output should be
2) modify the debug macros TRACE, FIXME, etc... in such a way that they recognize this variable
3) replace all TRACE("(%p): relayn", This) calls, which are usually at the beginning of a function,
    with a new macro, let's say NEWTRACE, which does exactly the same but also increments our
    tab (or space) counter by one.
4) make sure that there's also an ENDTRACE macro at the end of each function that decrements
    the counter again.


At least I would find this idea very useful, so feel free to leave a comment about either the thing itself
or my implementation idea of it.

Best regards,
    Tony


PS: I know that there would be several workarounds that would help me in this case,
       but I'd like this proposal to get into the official tree if others like it, too.

PPS: We could also add a WINEDEBUG option that filters out any indirect function calls
          from e.g. the 4th level to make things more overviewable, however, it's just another idea, too ;-)











From wine-devel at kievinfo.com  Tue Mar 18 06:17:03 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 18 Mar 2008 05:17:03 -0600
Subject: Proposal for debugging improvement
In-Reply-To: <E1JbZdd-0007MN-Dp@www14.emo.freenet-rz.de>
References: <E1JbZdd-0007MN-Dp@www14.emo.freenet-rz.de>
Message-ID: <47DFA4AF.7040105@kievinfo.com>

tony.wasserka at freenet.de wrote:
> A suggestion for how to realize this system would be to
> 1) add a variable that counts how much right a debug output should be
> 2) modify the debug macros TRACE, FIXME, etc... in such a way that they recognize this variable
> 3) replace all TRACE("(%p): relayn", This) calls, which are usually at the beginning of a function,
>     with a new macro, let's say NEWTRACE, which does exactly the same but also increments our
>     tab (or space) counter by one.
> 4) make sure that there's also an ENDTRACE macro at the end of each function that decrements
>     the counter again.

Have you looked at tools/examine-relay script?
What you proposing will add unnecessary processing everywhere the debugging 
output is called. While it would only be useful for relay, which is already 
horribly slow just because it outputs so much.

Vitaliy.


From julliard at winehq.org  Tue Mar 18 06:53:31 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 18 Mar 2008 12:53:31 +0100
Subject: (X11 Series 2/3) Fix handling of non-default visuals
In-Reply-To: <1205698113.7447.12.camel@hermes2.karcher.local> (Michael
	Karcher's message of "Sun, 16 Mar 2008 21:08:33 +0100")
References: <1205698113.7447.12.camel@hermes2.karcher.local>
Message-ID: <87tzj49rk4.fsf@wine.dyndns.org>

Michael Karcher <wine at mkarcher.dialup.fu-berlin.de> writes:

> @@ -144,7 +170,7 @@ BOOL X11DRV_CreateDC( HDC hdc, X11DRV_PDEVICE **pdev, LPCWSTR driver, LPCWSTR de
>      else
>      {
>          physDev->bitmap    = NULL;
> -        physDev->drawable  = root_window;
> +        physDev->drawable  = template_window;
>          physDev->depth     = screen_depth;
>          physDev->drawable_rect = virtual_screen_rect;
>          SetRect( &physDev->dc_rect, 0, 0, virtual_screen_rect.right - virtual_screen_rect.left,

This won't work, a screen DC has to be able to paint on the root
window. I'm afraid that supporting different depths properly is pretty
complicated.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Tue Mar 18 06:53:13 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 12:53:13 +0100
Subject: 1/6 WineD3D: CheckDeviceFormat rewrite
In-Reply-To: <20080318084428.191020@gmx.net>
References: <20080317192258.74730@gmx.net> <20080318082701.173790@gmx.net>
	<20080318084428.191020@gmx.net>
Message-ID: <200803181253.13172.stefan@codeweavers.com>

Am Dienstag, 18. M?rz 2008 09:44:28 schrieb Roderick Colenbrander:
> Patch 7/6, 8/6, 9/6 should take away most issues. Yesterday I didn't have
> the time to prepare those but they should be fine.
Usually the idea is to apply patches in a order that does not cause known 
regressions, as this can make bisecting unknown regressions a hell. 


From mstefani at redhat.com  Tue Mar 18 07:30:40 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Tue, 18 Mar 2008 13:30:40 +0100
Subject: Translations and Wine 1.0
Message-ID: <47DFB5F0.1040304@redhat.com>

Hello!

We should try to update the translations of Wine to other languages for
1.0. The code freeze during the release candidate time frame is perfect
for this as the translations don't have to track a moving target.

Somebody had scripts/a web page to check for missing translations or
broken ones in the .rc files. But I seem to not enter the right search
words to find any info regarding that; if somebody has a pointer please
let me know. It would be nice if we could run that scripts regularly
during the release candidate time.

bye
	michael


From paul.vriens.wine at gmail.com  Tue Mar 18 07:53:46 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 18 Mar 2008 13:53:46 +0100
Subject: Translations and Wine 1.0
In-Reply-To: <47DFB5F0.1040304@redhat.com>
References: <47DFB5F0.1040304@redhat.com>
Message-ID: <47DFBB5A.9050708@gmail.com>

Michael Stefaniuc wrote:
> Hello!
> 
> We should try to update the translations of Wine to other languages for
> 1.0. The code freeze during the release candidate time frame is perfect
> for this as the translations don't have to track a moving target.
> 
> Somebody had scripts/a web page to check for missing translations or
> broken ones in the .rc files. But I seem to not enter the right search
> words to find any info regarding that; if somebody has a pointer please
> let me know. It would be nice if we could run that scripts regularly
> during the release candidate time.
> 
> bye
> 	michael
> 
> 
> 
You mean:

http://pf128.krakow.sdi.tpnet.pl/wine-transl/

-- 
Cheers,

Paul.


From mstefani at redhat.com  Tue Mar 18 07:59:56 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Tue, 18 Mar 2008 13:59:56 +0100
Subject: Translations and Wine 1.0
In-Reply-To: <47DFBB5A.9050708@gmail.com>
References: <47DFB5F0.1040304@redhat.com> <47DFBB5A.9050708@gmail.com>
Message-ID: <47DFBCCC.8020307@redhat.com>

Paul Vriens wrote:
> Michael Stefaniuc wrote:
>> Hello!
>>
>> We should try to update the translations of Wine to other languages for
>> 1.0. The code freeze during the release candidate time frame is perfect
>> for this as the translations don't have to track a moving target.
>>
>> Somebody had scripts/a web page to check for missing translations or
>> broken ones in the .rc files. But I seem to not enter the right search
>> words to find any info regarding that; if somebody has a pointer please
>> let me know. It would be nice if we could run that scripts regularly
>> during the release candidate time.

> http://pf128.krakow.sdi.tpnet.pl/wine-transl/
Yepp! Thanks!

bye
	michael
-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Hauptst?tter Strasse 58, 70178 Stuttgart
Handelsregister: Amtsgericht Stuttgart HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                 Werner Knoblich


From stefan at codeweavers.com  Tue Mar 18 08:26:23 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 14:26:23 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803172229.30779.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171647.39614.stefan@codeweavers.com>
	<200803172229.30779.stefan@codeweavers.com>
Message-ID: <200803181426.23481.stefan@codeweavers.com>

Hi,

Given the past discussion, do you agree with the code now? Alexandre wants 
your OKs before applying the patches.

Thanks,
Stefan


From julliard at winehq.org  Tue Mar 18 08:28:39 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 18 Mar 2008 14:28:39 +0100
Subject: [1/22] WineD3D: Add GL_ATI_fragment_shader
In-Reply-To: <200803162201.26223.stefan@codeweavers.com> ("Stefan
	=?utf-8?Q?D=C3=B6singer=22's?=
	message of "Sun, 16 Mar 2008 22:01:26 +0100")
References: <200803162201.26223.stefan@codeweavers.com>
Message-ID: <87prts9n5k.fsf@wine.dyndns.org>

Stefan D?singer <stefan at codeweavers.com> writes:

> Note that the extension is disabled for now. This allows a bottom-up
> contruction of the GL_ATI_fragment_shader replacement pipeline in the
> code with separate patches, and activating it at the end when it is at
> the same feature level as the existing ARB_texture_env_combine code it
> can be enabled at once, thus avoiding additional troubles when running
> regression tests.

It may avoid trouble, but it also makes regression testing useless,
since all problems with this code will point to the patch that enables
it. It's not a good idea to add code without making use of it.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Tue Mar 18 08:32:40 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Tue, 18 Mar 2008 14:32:40 +0100
Subject: [1/22] WineD3D: Add GL_ATI_fragment_shader
In-Reply-To: <87prts9n5k.fsf@wine.dyndns.org>
References: <200803162201.26223.stefan@codeweavers.com>
	<87prts9n5k.fsf@wine.dyndns.org>
Message-ID: <200803181432.40574.stefan@codeweavers.com>

Am Dienstag, 18. M?rz 2008 14:28:39 schrieb Alexandre Julliard:
> It may avoid trouble, but it also makes regression testing useless,
> since all problems with this code will point to the patch that enables
> it. It's not a good idea to add code without making use of it.
Otherwise regression testing would be useless as well, because I can only move 
all D3DOPS over at the same time or none. I can't say I use the new code only 
if the app does this or that. By enabling the code as it is added, I cause 
additional problems during the span of patches where the new codepath is not 
yet as feature-rich as the old one.

So I only see two ways, the one I've chosen here, or sending one huge patch 
that does everything at once


From ben at atomnet.co.uk  Tue Mar 18 09:13:21 2008
From: ben at atomnet.co.uk (Ben Hodgetts)
Date: Tue, 18 Mar 2008 14:13:21 +0000
Subject: Please create 1.2.0 milestone in Bugzilla
In-Reply-To: <d6c5d7290803180330x21e79457kebc236789952afdd@mail.gmail.com>
References: <a71bd89a0803171615u6de6d3a6oca591b54a611bb21@mail.gmail.com>
	<d6c5d7290803180330x21e79457kebc236789952afdd@mail.gmail.com>
Message-ID: <47DFCE01.5080703@atomnet.co.uk>



Edward Savage wrote:
> On Tue, Mar 18, 2008 at 10:15 AM, Dan Kegel <dank at kegel.com> wrote:
>   
>> The 1.1.x releases will be development releases,
>>  so a 1.1.0 milestone doesn't make much sense.
>>  Please create a 1.2.0 milestone in Bugzilla.
>>  Thanks!
>>  - Dan
>>
>>     
>
> Is there a reason we wont be continuing the current y.y.x (ie 0.9.x
> and 1.0.x) style releases for development?
>
> Most foss applications seem to have moved away from the even odd
> release cycle and due to wines long lead times between releases having
> it this way could get rather confusing for newer users not expecting
> it.
>
> Edward
>
> Ps Sorry for the dupe dan, hit the wrong button.
>
>
>   

As far as I'm aware, 1.2.0 will be a long time off (as would 1.1.0) it's 
just the next _big_ milestone. He doesn't mean that after 1.0.0 there 
wont be anything before 1.1.0. It's just a point to aim to fix the main 
bugs by.

Ben H.


From paul.vriens.wine at gmail.com  Tue Mar 18 09:29:26 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 18 Mar 2008 15:29:26 +0100
Subject: msi/tests: Skip the tests if we are unable to identify the user
	SID.	This fixes crashes on Win9x.
In-Reply-To: <alpine.DEB.1.00.0803181520420.12580@amboise.dolphin>
References: <alpine.DEB.1.00.0803181520420.12580@amboise.dolphin>
Message-ID: <47DFD1C6.1040606@gmail.com>

Francois Gouget wrote:
> ---
>  dlls/msi/tests/source.c |   50 ++++++++++++++++++++++++++++++++++++++--------
>  1 files changed, 41 insertions(+), 9 deletions(-)
> 
> diff --git a/dlls/msi/tests/source.c b/dlls/msi/tests/source.c
> index 49e40c7..5f75159 100644
> --- a/dlls/msi/tests/source.c
> +++ b/dlls/msi/tests/source.c
> @@ -122,18 +122,22 @@ static void create_test_guid(LPSTR prodcode, LPSTR squashed)
>      WideCharToMultiByte(CP_ACP, 0, squashedW, -1, squashed, MAX_PATH, NULL, NULL);
>  }
>  
> -static void get_user_sid(LPSTR *usersid)
> +static int get_user_sid(LPSTR *usersid)
>  {
>      HANDLE token;
>      BYTE buf[1024];
>      DWORD size;
>      PTOKEN_USER user;
> +    BOOL rc;
>  
> -    OpenProcessToken(GetCurrentProcess(), TOKEN_QUERY, &token);
> +    rc=OpenProcessToken(GetCurrentProcess(), TOKEN_QUERY, &token);
> +    if (!rc && GetLastError() == ERROR_CALL_NOT_IMPLEMENTED)
> +        return 0;
>      size = sizeof(buf);
>      GetTokenInformation(token, TokenUser, (void *)buf, size, &size);
>      user = (PTOKEN_USER)buf;
>      pConvertSidToStringSidA(user->User.Sid, usersid);
> +    return 1;
>  }
>  
>  static void check_reg_str(HKEY prodkey, LPCSTR name, LPCSTR expected, BOOL bcase, DWORD line)
> @@ -186,7 +190,11 @@ static void test_MsiSourceListGetInfo(void)
>      }
>  
>      create_test_guid(prodcode, prod_squashed);
> -    get_user_sid(&usersid);
> +    if (!get_user_sid(&usersid))
> +    {
> +        skip("User SID not available -> skipping MsiSourceListGetInfoA tests\n");
> +        return;
> +    }
>  

Couldn't we just check for pConvertSidToStringSidA like we do in the msi.c tests 
(line 6039)?

-- 
Cheers,

Paul.


From thestig at google.com  Tue Mar 18 09:56:02 2008
From: thestig at google.com (Lei Zhang)
Date: Tue, 18 Mar 2008 07:56:02 -0700
Subject: Translations and Wine 1.0
In-Reply-To: <47DFB5F0.1040304@redhat.com>
References: <47DFB5F0.1040304@redhat.com>
Message-ID: <558b2f5c0803180756s6904a163h38c6d2210bdbfc38@mail.gmail.com>

On Tue, Mar 18, 2008 at 5:30 AM, Michael Stefaniuc <mstefani at redhat.com> wrote:
> Hello!
>
>  We should try to update the translations of Wine to other languages for
>  1.0. The code freeze during the release candidate time frame is perfect
>  for this as the translations don't have to track a moving target.
>
>  Somebody had scripts/a web page to check for missing translations or
>  broken ones in the .rc files. But I seem to not enter the right search
>  words to find any info regarding that; if somebody has a pointer please
>  let me know. It would be nice if we could run that scripts regularly
>  during the release candidate time.
>
>  bye
>         michael
>
>
>

Would the Launchpad translations site be helpful?

https://translations.launchpad.net/

I think basically the workflow is:

* put phrases that need translation into the work queue.
* select the languages it needs to be translated into.
* people offer suggestions, and launchpad offers suggestions for the
same phrase already translated in other projects.
* pick the most appropriate suggestion.
* watch the percentage bars go up.

(please correct me if this is inaccurate)

- Lei


From mstefani at redhat.com  Tue Mar 18 10:06:48 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Tue, 18 Mar 2008 16:06:48 +0100
Subject: Translations and Wine 1.0
In-Reply-To: <558b2f5c0803180756s6904a163h38c6d2210bdbfc38@mail.gmail.com>
References: <47DFB5F0.1040304@redhat.com>
	<558b2f5c0803180756s6904a163h38c6d2210bdbfc38@mail.gmail.com>
Message-ID: <47DFDA88.3010906@redhat.com>

Hello Lei,

Lei Zhang wrote:
> On Tue, Mar 18, 2008 at 5:30 AM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>>  We should try to update the translations of Wine to other languages for
>>  1.0. The code freeze during the release candidate time frame is perfect
>>  for this as the translations don't have to track a moving target.
>>
>>  Somebody had scripts/a web page to check for missing translations or
>>  broken ones in the .rc files. But I seem to not enter the right search
>>  words to find any info regarding that; if somebody has a pointer please
>>  let me know. It would be nice if we could run that scripts regularly
>>  during the release candidate time.

> Would the Launchpad translations site be helpful?
> 
> https://translations.launchpad.net/
Something like that would be useful.


> I think basically the workflow is:
> 
> * put phrases that need translation into the work queue.
> * select the languages it needs to be translated into.
> * people offer suggestions, and launchpad offers suggestions for the
> same phrase already translated in other projects.
> * pick the most appropriate suggestion.
> * watch the percentage bars go up.
> 
> (please correct me if this is inaccurate)
Wine is already there:
"Translation setup needed
The Wine project is not set up for translation in Launchpad.
If you are Scott Ritchie, log in to begin the setup process.
Otherwise, you might want to talk with Scott Ritchie, the project
registrant, about using Launchpad for translations."

bye
	michael


From jnewman at codeweavers.com  Tue Mar 18 10:19:42 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Tue, 18 Mar 2008 10:19:42 -0500
Subject: Redirect http://forums.winehq.org -> http://forum.winehq.org.
In-Reply-To: <689de9370803161553v195b60f2h3c714782b63e9b70@mail.gmail.com>
References: <689de9370803161553v195b60f2h3c714782b63e9b70@mail.gmail.com>
Message-ID: <47DFDD8E.30801@codeweavers.com>

Done.

Andrew Riedi wrote:
> Because many other sites have forums spelled in the plural, such as
> http://ubuntuforums.org and http://forums.gentoo.org, many users
> simply assume we will too.  I would like to request a redirect from
> http://fourms.winehq.org to http://forum.winehq.org.
> 
> Note, even one of own developers made this mistake, which I sent in a
> fix for at:  http://article.gmane.org/gmane.comp.emulators.wine.patches/48512
> .
> 


From dank at kegel.com  Tue Mar 18 10:32:29 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 08:32:29 -0700
Subject: Please create 1.2.0 milestone in Bugzilla
In-Reply-To: <d6c5d7290803180330x21e79457kebc236789952afdd@mail.gmail.com>
References: <a71bd89a0803171615u6de6d3a6oca591b54a611bb21@mail.gmail.com>
	<d6c5d7290803180330x21e79457kebc236789952afdd@mail.gmail.com>
Message-ID: <a71bd89a0803180832n5f5f33c3v22907ebc413e7800@mail.gmail.com>

On Tue, Mar 18, 2008 at 3:30 AM, Edward Savage <epssyis at gmail.com> wrote:
> Is there a reason we wont be continuing the current y.y.x (ie 0.9.x
>  and 1.0.x) style releases for development?

We will, actually.  What made you think we wouldn't?
Is http://wiki.winehq.org/WineReleasePlan poorly written?

1.1.x will be our trunk during the 1.1 era.
We may or may not have development on the 1.0 branch;
depends on if there's demand and volunteer manpower.
- Dan


From dank at kegel.com  Tue Mar 18 10:43:49 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 08:43:49 -0700
Subject: Which IRC room to send SoC people to?
Message-ID: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>

http://wiki.winehq.org/SummerOfCode
currently sends people to #WineHQ.
Should it send them to #winehackers?


From hverbeet at gmail.com  Tue Mar 18 10:44:00 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Tue, 18 Mar 2008 16:44:00 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803181426.23481.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171647.39614.stefan@codeweavers.com>
	<200803172229.30779.stefan@codeweavers.com>
	<200803181426.23481.stefan@codeweavers.com>
Message-ID: <d658b69e0803180844q3d1918ads70c4a39e684c7f1c@mail.gmail.com>

On 18/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Hi,
>
>  Given the past discussion, do you agree with the code now? Alexandre wants
>  your OKs before applying the patches.
>
I don't think putting this stuff in its own shader backend is the
right approach. On the other hand, given my current level of
involvement with wined3d, I wouldn't mind too much if it got committed
anyway.


From hverbeet at gmail.com  Tue Mar 18 10:49:18 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Tue, 18 Mar 2008 16:49:18 +0100
Subject: Which IRC room to send SoC people to?
In-Reply-To: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>
References: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>
Message-ID: <d658b69e0803180849g7cb6ce1ak246b5876c625d240@mail.gmail.com>

On 18/03/2008, Dan Kegel <dank at kegel.com> wrote:
> http://wiki.winehq.org/SummerOfCode
>  currently sends people to #WineHQ.
>  Should it send them to #winehackers?
>
I'd say yes.


From mstefani at redhat.com  Tue Mar 18 10:49:24 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Tue, 18 Mar 2008 16:49:24 +0100
Subject: Which IRC room to send SoC people to?
In-Reply-To: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>
References: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>
Message-ID: <47DFE484.50906@redhat.com>

Dan Kegel wrote:
> http://wiki.winehq.org/SummerOfCode
> currently sends people to #WineHQ.
> Should it send them to #winehackers?
#winehackers is probably better.

bye
	michael


From stefan at codeweavers.com  Tue Mar 18 10:55:46 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 16:55:46 +0100
Subject: Which IRC room to send SoC people to?
In-Reply-To: <d658b69e0803180849g7cb6ce1ak246b5876c625d240@mail.gmail.com>
References: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>
	<d658b69e0803180849g7cb6ce1ak246b5876c625d240@mail.gmail.com>
Message-ID: <200803181655.47263.stefan@codeweavers.com>

Am Dienstag, 18. M?rz 2008 16:49:18 schrieb H. Verbeet:
> On 18/03/2008, Dan Kegel <dank at kegel.com> wrote:
> > http://wiki.winehq.org/SummerOfCode
> >  currently sends people to #WineHQ.
> >  Should it send them to #winehackers?
>
> I'd say yes.
Agreed as well


From saulius2 at ar.fi.lt  Tue Mar 18 11:34:31 2008
From: saulius2 at ar.fi.lt (Saulius Krasuckas)
Date: Tue, 18 Mar 2008 18:34:31 +0200 (EET)
Subject: user32: Test destroying the cursor of a parent process.
In-Reply-To: <4783D93F.7060800@orange.fr>
References: <689de9370801080507h7f7816cfh4271375aab126d45@mail.gmail.com>
	<4783D93F.7060800@orange.fr>
Message-ID: <Pine.LNX.4.62.0803181826560.10409@tvarka.ar.fi.lt>

* On Tue, 8 Jan 2008, Eric Pouech wrote:
> * Andrew Riedi a ?crit :
> >
> >  dlls/user32/tests/cursoricon.c |  201 ++++++++++++++++++++++++++++++++++++++++
    ...
> > +static void do_child(void)
> > +{
> > +    WNDCLASS class;
> > +    MSG msg;
> > +    BOOL ret;
> > +
> > +    /* Register a new class. */
> > +    class.style = CS_GLOBALCLASS;
> > +    class.lpfnWndProc = callback_child;
> > +    class.cbClsExtra = 0;
> > +    class.cbWndExtra = 0;
> > +    class.hInstance = GetModuleHandle(NULL);
> > +    class.hIcon = NULL;
> > +    class.hCursor = NULL;
> > +    class.hbrBackground = NULL;
> > +    class.lpszMenuName = NULL;
> > +    class.lpszClassName = "cursor_child";
> > +
> > +    SetLastError(0xdeadbeef);
> > +    ret = RegisterClass(&class);
> > +    ok(ret, "Failed to register window class. Error: %d\n", GetLastError());
  ...
>
> IMO, the ok() tests in the child process are a bad idea (they won't be 
> counted, nor returned as errors, by the parent process)

Was Wine test framework architecture done such way on a purpose?  Why 
would it be a bad idea to take into account a child output also?

From stefan at codeweavers.com  Tue Mar 18 10:55:46 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 18 Mar 2008 16:55:46 +0100
Subject: Which IRC room to send SoC people to?
In-Reply-To: <d658b69e0803180849g7cb6ce1ak246b5876c625d240@mail.gmail.com>
References: <a71bd89a0803180843u4bed61aet1da37cdfb5aaee10@mail.gmail.com>
	<d658b69e0803180849g7cb6ce1ak246b5876c625d240@mail.gmail.com>
Message-ID: <200803181655.47263.stefan@codeweavers.com>

Am Dienstag, 18. M?rz 2008 16:49:18 schrieb H. Verbeet:
> On 18/03/2008, Dan Kegel <dank at kegel.com> wrote:
> > http://wiki.winehq.org/SummerOfCode
> >  currently sends people to #WineHQ.
> >  Should it send them to #winehackers?
>
> I'd say yes.
Agreed as well


From austinenglish at gmail.com  Tue Mar 18 11:28:29 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 18 Mar 2008 11:28:29 -0500
Subject: Please create 1.2.0 milestone in Bugzilla
In-Reply-To: <a71bd89a0803180832n5f5f33c3v22907ebc413e7800@mail.gmail.com>
References: <a71bd89a0803171615u6de6d3a6oca591b54a611bb21@mail.gmail.com>
	<d6c5d7290803180330x21e79457kebc236789952afdd@mail.gmail.com>
	<a71bd89a0803180832n5f5f33c3v22907ebc413e7800@mail.gmail.com>
Message-ID: <b6bb06270803180928m42f075a3p470680d26c1367c6@mail.gmail.com>

On Tue, Mar 18, 2008 at 10:32 AM, Dan Kegel <dank at kegel.com> wrote:
> On Tue, Mar 18, 2008 at 3:30 AM, Edward Savage <epssyis at gmail.com> wrote:
>  > Is there a reason we wont be continuing the current y.y.x (ie 0.9.x
>  >  and 1.0.x) style releases for development?
>
>  We will, actually.  What made you think we wouldn't?
>  Is http://wiki.winehq.org/WineReleasePlan poorly written?
>
>  1.1.x will be our trunk during the 1.1 era.
>  We may or may not have development on the 1.0 branch;
>  depends on if there's demand and volunteer manpower.
>  - Dan
>

If 1.1.0 is set to be released two weeks after 1.0, then we may need
to adjust the target milestones in bugzilla for some of them. I doubt,
for instance, that a DIB engine will be implemented in a that time.

-Austin

(Sorry for the dupe Dan, hit the wrong button).


From susancragin at earthlink.net  Tue Mar 18 11:46:16 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Tue, 18 Mar 2008 12:46:16 -0400 (EDT)
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
Message-ID: <152199.1205858776693.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>

The new default pulseaudio in Hardy screws up every program that isn't gnome, delivering terrible sound. 
https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
Question -- what does WINE do with pulseaudio?
http://forum.skype.com/index.php?showtopic=112021






From rob at codeweavers.com  Tue Mar 18 12:00:33 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Tue, 18 Mar 2008 17:00:33 +0000
Subject: user32: Test destroying the cursor of a parent process.
In-Reply-To: <Pine.LNX.4.62.0803181826560.10409@tvarka.ar.fi.lt>
References: <689de9370801080507h7f7816cfh4271375aab126d45@mail.gmail.com>	<4783D93F.7060800@orange.fr>
	<Pine.LNX.4.62.0803181826560.10409@tvarka.ar.fi.lt>
Message-ID: <47DFF531.8070107@codeweavers.com>

Saulius Krasuckas wrote:
> * On Tue, 8 Jan 2008, Eric Pouech wrote:
>   
>> * Andrew Riedi a ?crit :
>>     
>>>  dlls/user32/tests/cursoricon.c |  201 ++++++++++++++++++++++++++++++++++++++++
>>>       
>     ...
>   
>>> +static void do_child(void)
>>> +{
>>> +    WNDCLASS class;
>>> +    MSG msg;
>>> +    BOOL ret;
>>> +
>>> +    /* Register a new class. */
>>> +    class.style = CS_GLOBALCLASS;
>>> +    class.lpfnWndProc = callback_child;
>>> +    class.cbClsExtra = 0;
>>> +    class.cbWndExtra = 0;
>>> +    class.hInstance = GetModuleHandle(NULL);
>>> +    class.hIcon = NULL;
>>> +    class.hCursor = NULL;
>>> +    class.hbrBackground = NULL;
>>> +    class.lpszMenuName = NULL;
>>> +    class.lpszClassName = "cursor_child";
>>> +
>>> +    SetLastError(0xdeadbeef);
>>> +    ret = RegisterClass(&class);
>>> +    ok(ret, "Failed to register window class. Error: %d\n", GetLastError());
>>>       
>   ...
>   
>> IMO, the ok() tests in the child process are a bad idea (they won't be 
>> counted, nor returned as errors, by the parent process)
>>     
>
> Was Wine test framework architecture done such way on a purpose?  Why 
> would it be a bad idea to take into account a child output also?

The architecture has been fixed since the introduction of the 
winetest_wait_child_process function in include/wine/test.h.

-- 
Rob Shearman



From fgouget at free.fr  Tue Mar 18 13:01:08 2008
From: fgouget at free.fr (Francois Gouget)
Date: Tue, 18 Mar 2008 19:01:08 +0100 (CET)
Subject: Translations and Wine 1.0
In-Reply-To: <558b2f5c0803180756s6904a163h38c6d2210bdbfc38@mail.gmail.com>
References: <47DFB5F0.1040304@redhat.com>
	<558b2f5c0803180756s6904a163h38c6d2210bdbfc38@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0803181852060.10478@amboise.dolphin>

On Tue, 18 Mar 2008, Lei Zhang wrote:
[...]
> I think basically the workflow is:
> 
> * put phrases that need translation into the work queue.
> * select the languages it needs to be translated into.
> * people offer suggestions, and launchpad offers suggestions for the
> same phrase already translated in other projects.
> * pick the most appropriate suggestion.
> * watch the percentage bars go up.

I think the problem is extracting the strings to translate from the rc 
files, and combining the translations with the reference rc file to 
generate a translated rc file. Besides the issue of handling include 
files and macros, one aspect that spices things up is that the 
translation may need to tweak the widget sizes in order for the 
translated text to fit. How to represent that is not clear.

Still I think it would be doable with some conventions (e.g. prepend 
the geometry data to the string to be translated). Might make a good 
GSoC project:

   Create a tool to manage rc file translations and integrate them with 
   standard localisation tools such as the PO tools or 
   https://translations.launchpad.net/.

One possible starting point would bethe po4a project.
http://po4a.alioth.debian.org/

Btw, is the translations.launchpad using po files?

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
        It really galls me that most of the computer power in the world
                          is wasted on screen savers.
                     Chris Caldwell from the GIMPS project
                       http://www.mersenne.org/prime.htm


From mikolaj at zalewski.pl  Tue Mar 18 14:14:59 2008
From: mikolaj at zalewski.pl (=?UTF-8?B?TWlrb8WCYWogWmFsZXdza2k=?=)
Date: Tue, 18 Mar 2008 20:14:59 +0100
Subject: Translations and Wine 1.0
In-Reply-To: <alpine.DEB.1.00.0803181852060.10478@amboise.dolphin>
References: <47DFB5F0.1040304@redhat.com>	<558b2f5c0803180756s6904a163h38c6d2210bdbfc38@mail.gmail.com>
	<alpine.DEB.1.00.0803181852060.10478@amboise.dolphin>
Message-ID: <47E014B3.3080401@zalewski.pl>

  I think the release candidate phase for Wine 1.0 is a good time to add 
new translations and it's also important to fix out-of-sync resources. 
They may cause programs to run incorrectly when running under with a 
different language (I've filled a bug about it: 
http://bugs.winehq.org/show_bug.cgi?id=12097).
  The lanuchpad looks interesting. What's the format for 
importing/exporting data from it? Extracting strings from a *.res is 
quite easy. Building a *.rc from a *.res and strings is also not too 
hard. It would be more tricky if we would like to extract the #define'd 
symbolic names of resources or comments.
  There is the problem of changing dialogs geometry (but we could use 
special files for that and write a dialog editor to edit them) and that 
sometimes the same string have different translations - e.g. in same 
langauges the column "Size" for directory view (where it means file 
size) is translated differently then the column "Size" in My Computer 
(where is means disk size). But that can be solved by preppending the 
string id to the string.
  Having string in different files than the resources would also help 
fixing out-of-sync resources (we could use English string if translated 
ones are not available).

Mikolaj Zalewski



From marcus at jet.franken.de  Tue Mar 18 14:15:44 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Tue, 18 Mar 2008 20:15:44 +0100
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
In-Reply-To: <152199.1205858776693.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>
References: <152199.1205858776693.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>
Message-ID: <20080318191544.GA4674@galeere>

On Tue, Mar 18, 2008 at 12:46:16PM -0400, Susan Cragin wrote:
> The new default pulseaudio in Hardy screws up every program that isn't gnome, delivering terrible sound. 
> https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
> Question -- what does WINE do with pulseaudio?
> http://forum.skype.com/index.php?showtopic=112021

Just tell the pulseaudio guys to take it a notch down.

Or use the ALSA pulseaudio wrapper plugin.

Ciao, Marcus


From eric.pouech at orange.fr  Tue Mar 18 15:29:57 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Tue, 18 Mar 2008 21:29:57 +0100
Subject: Proposed EM_Fontrange Patch
In-Reply-To: <47DDDDE4.6050500@earthlink.net>
References: <47DDDDE4.6050500@earthlink.net>
Message-ID: <47E02645.7010408@orange.fr>

James McKenzie a ?crit :
> All:
>
> I would like to see the problems with EM_Fontrange be fixed.  The 
> attached patch is for comment/review and I would like SPECIFIC 
> guidance on how to implement this patch as it relates to a Wine 1.0 
> bug (bug/issue 6254) and fixes the problem specified there.  The 
> conformance tests are already in tests/editor.c and all they involve 
> is removing some todo_wine blocks related to this issue.  The entire 
> patch will do this.  Sorry that the patch is in UNIX diff format, I 
> could not get git to do what I wanted.  The actual patch will be git 
> format and use the daily git.
I think that a couple of things should be improved in the patch:
- there are 3 hDC stored in the context, while only 2 are of use 
(rendering and measure)
- there is some interdependency with the EM_SETTARGETDEVICE message 
implementation, that should be looked at
- patch is likely a bit too big and should be sliced before inclusion

A+



From eric.pouech at orange.fr  Tue Mar 18 15:36:40 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Tue, 18 Mar 2008 21:36:40 +0100
Subject: Fresh valgrind errors in richedit
In-Reply-To: <a71bd89a0803171824s5d998e2bgcf56300e72542ba4@mail.gmail.com>
References: <a71bd89a0803171824s5d998e2bgcf56300e72542ba4@mail.gmail.com>
Message-ID: <47E027D8.1030902@orange.fr>

Dan Kegel a ?crit :
> Eric, could you have a look at
>
> http://kegel.com/wine/valgrind/logs-2008-03-17/vg-riched20_editor-diff.txt
>
> There are several new errors of the sort:
>
> + Conditional jump or move depends on uninitialised value(s)
> +    at  ME_SetParaFormat (para.c:400)
> +    by  ME_SetSelectionParaFormat (para.c:436)
> +    by  ME_RTFReadHook (editor.c:662)
> +    by  RTFGetToken (reader.c:417)
> +    by  RTFRead (reader.c:333)
> +    by  ME_StreamIn (editor.c:1095)
> +    by  RichEditWndProc_common (editor.c:2432)
> +    by  RichEditWndProcA (editor.c:3237)
> +    by  (within /home/dank/wine-git/dlls/user32/user32.dll.so)
> +    by  call_window_proc (winproc.c:457)
> +    by  WINPROC_call_window (winproc.c:2207)
> +    by  call_window_proc (message.c:1615)
> +    by  send_message (message.c:2430)
> +    by  SendMessageA (message.c:2575)
> +    by  test_EM_SETTEXTMODE (editor.c:471)
> +    by  func_editor (editor.c:2705)
> +    by  run_test (test.h:406)
> +    by  main (test.h:455)
>
>
>
>
>   
likely the RTF writer that isn't 100% compliant with the RTF specs (or 
my interpretation thereof)
won't have too much time until this week-end anyway, so if some wants to 
look at it before, feel free
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From susancragin at earthlink.net  Tue Mar 18 16:04:08 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Tue, 18 Mar 2008 17:04:08 -0400 (EDT)
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
Message-ID: <12143308.1205874248588.JavaMail.root@elwamui-mouette.atl.sa.earthlink.net>

http://www.pulseaudio.org/ticket/198
I'm not sure it's possible to use the pulseaudio plugin. 
Pulse seems to think it's a wine defect. 

-----Original Message-----
>From: Marcus Meissner <marcus at jet.franken.de>
>Sent: Mar 18, 2008 3:15 PM
>To: Susan Cragin <susancragin at earthlink.net>
>Cc: wine-devel at winehq.org
>Subject: Re: Hardy Heron -- Pulseaudio interferes with non-gnome audio
>
>On Tue, Mar 18, 2008 at 12:46:16PM -0400, Susan Cragin wrote:
>> The new default pulseaudio in Hardy screws up every program that isn't gnome, delivering terrible sound. 
>> https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
>> Question -- what does WINE do with pulseaudio?
>> http://forum.skype.com/index.php?showtopic=112021
>
>Just tell the pulseaudio guys to take it a notch down.
>
>Or use the ALSA pulseaudio wrapper plugin.
>
>Ciao, Marcus





From tom at dbservice.com  Tue Mar 18 16:14:43 2008
From: tom at dbservice.com (Tomas Carnecky)
Date: Tue, 18 Mar 2008 22:14:43 +0100
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
In-Reply-To: <152199.1205858776693.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>
References: <152199.1205858776693.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>
Message-ID: <47E030C3.4060804@dbservice.com>

Susan Cragin wrote:
> The new default pulseaudio in Hardy screws up every program that isn't gnome, delivering terrible sound. 
> https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453

Applications that use ALSA should work fine with the alsa pulse plugin - 
  should. Unfortunately the plugin has a few bugs, and the developers 
(of both pulseaudio and alsa) have been unresponsive in this matter. See
  - http://www.pulseaudio.org/ticket/198
  - https://bugtrack.alsa-project.org/alsa-bug/view.php?id=2601

> Question -- what does WINE do with pulseaudio?

Some suggested to create a native PulseAudio wine driver. That would 
yield the best results as far as the performance and reliability goes. 
Unfortunately we'll be stuck with the alsa driver for some time to come, 
so I tried to do the best to make the alsa pulse plugin to work with 
wine. I had to patch both the wine alsa driver as well as the alsa pulse 
plugin and it worked fine for my taste.

I submitted the patch to wine-patches:
http://www.winehq.org/pipermail/wine-patches/2008-February/050561.html

I don't know if the relevant alsa pulse plugin patch is publicly 
available, I haven't looked at that matter in a long time. Some of the 
needed patches are probably still in my local repositories. It makes no 
sense for me to work on this anymore until the developers respond to my 
questions.

> http://forum.skype.com/index.php?showtopic=112021

I heard that the skype developers are very interested in getting skype 
working with pulseaudio, even helped tisting some patches. I have gotten 
skype to work with pulseaudio, I think if you apply the second patch 
attached to alsa bug #2601 skype will work. I haven't looked at the code 
since because apparently nobody from the alsa team is interested in 
fixing the bug.

tom


From scott at open-vote.org  Tue Mar 18 17:02:35 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Tue, 18 Mar 2008 15:02:35 -0700
Subject: SoC page insurrection! Idea details needed, please read.
In-Reply-To: <a71bd89a0803180033r70a59ccatd14d11de179be174@mail.gmail.com>
References: <a71bd89a0803180033r70a59ccatd14d11de179be174@mail.gmail.com>
Message-ID: <47E03BFB.80706@open-vote.org>

Dan Kegel wrote:
> Looking at our Summer of Code ideas page,
> I realized it was getting dense and unruly,
> so I and Maarten moved it off to the side
> and did a simpler one; see
> http://wiki.winehq.org/SummerOfCode
> 
> The DirectX stuff in particular could use some
> more detail; could the knowledgeable people flesh it out?
> 
> Also each idea should probably have a sponsor
> the students could turn to for ideas.  I've put a
> few obvious ones in, but it'd be nice if each one
> was claimed.
> 
> Thanks,
> Dan
> 
> 
Unfortunately I am unable to sponsor my own idea (Case-insensitive
FUSE), since I'm not too involved with Wine's C code.

Could someone else please volunteer to mentor the project if it gets
accepted by Google?

Thanks,
Scott Ritchie


From winehacker at gmail.com  Tue Mar 18 17:57:21 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 18 Mar 2008 17:57:21 -0500
Subject: SoC page insurrection! Idea details needed, please read.
In-Reply-To: <47E03BFB.80706@open-vote.org>
References: <a71bd89a0803180033r70a59ccatd14d11de179be174@mail.gmail.com>
	<47E03BFB.80706@open-vote.org>
Message-ID: <19e31a080803181557t462e0bf8w489336aeff9b24f4@mail.gmail.com>

On Tue, Mar 18, 2008 at 5:02 PM, Scott Ritchie <scott at open-vote.org> wrote:
>  Unfortunately I am unable to sponsor my own idea (Case-insensitive
>  FUSE), since I'm not too involved with Wine's C code.
>
>  Could someone else please volunteer to mentor the project if it gets
>  accepted by Google?

If anyone takes this up, we might see about expanding it to include
better support for FUSE iso mounted filesystems. Currently when you
use fuse to mount an iso image, you have to manually configure a fake
drive letter. It would be nice if we could query the loaded fuse
module for a listing of mounted iso images and automatically create
fake cdrom devices.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Tue Mar 18 18:01:05 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 16:01:05 -0700
Subject: Wine wiki cleanup
Message-ID: <a71bd89a0803181601m3b4be848mdab24b14a76b19eb@mail.gmail.com>

Over time, the Wine wiki front page grew rather unwieldy,
so I split the developer information off into two new pages,
leaving only a simplified front page behind,
mostly aimed at users.

It's radically simpler.  Hopefully it'll be more welcoming to new users.

Comments?


From dank at kegel.com  Tue Mar 18 18:07:35 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 16:07:35 -0700
Subject: Bugzilla request: add new milestone 1.2.0
Message-ID: <a71bd89a0803181607u698cd1c4obf5efad1902474cf@mail.gmail.com>

Ping.  I need this so I can start deferring 1.0 bugs to 1.2.
(Deferring them to 1.1 doesn't make a whole lot
of sense.)


From dank at kegel.com  Tue Mar 18 18:10:42 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 16:10:42 -0700
Subject: Appdb request: allow browsing for downloadable platinum apps
Message-ID: <a71bd89a0803181610w12d2c53fq880a301ab110b8ea@mail.gmail.com>

The appdb has a "browse by rating" and a "browse downloadable"
option, but there's no way to combine them.

Can we add a 'downloadable' checkbox in the 'browse by rating'
page, maybe?


From wine.dev at web.de  Tue Mar 18 18:09:19 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Wed, 19 Mar 2008 00:09:19 +0100
Subject: ntoskrnl.exe: Implement MmIsAddressValid (bug 11082)
In-Reply-To: <200803171746.33498.chris.kcat@gmail.com>
References: <1205795360.17905.4.camel@p4>
	<200803171746.33498.chris.kcat@gmail.com>
Message-ID: <1205881759.7976.10.camel@p4>

On Mo, 2008-03-17 at 16:46 -0800, Chris Robinson wrote:
> On Monday 17 March 2008 04:09:20 pm Detlef Riekenberg wrote:
> > +        (info.Protect & (PAGE_READWRITE || PAGE_EXECUTE_READWRITE)) &&
> 
> Did you mean | instead of || there?

Opps.

Will resend. Thanks for your hint.

-- 
 
By by ... Detlef




From ead1234 at hotmail.com  Tue Mar 18 18:17:22 2008
From: ead1234 at hotmail.com (EA Durbin)
Date: Tue, 18 Mar 2008 18:17:22 -0500
Subject: Appdb request: allow browsing for downloadable platinum apps
In-Reply-To: <a71bd89a0803181610w12d2c53fq880a301ab110b8ea@mail.gmail.com>
References: <a71bd89a0803181610w12d2c53fq880a301ab110b8ea@mail.gmail.com>
Message-ID: <BAY128-W2DFC75BCB3934BCF06E05AB060@phx.gbl>


Eventually when I get more time I'd like to scrap the browse_by_rating page and browse_newest and create a dynamic query page that allows for multiple custom queries like application type, rating, age of application, etc. And I'd like to see the screenshots page with links by letter, since they are sorted alphabetically, list A B C D E 0-9, etc., or an option to sort screenshots by application type, say "games" so you can find them easier.

----------------------------------------
> Date: Tue, 18 Mar 2008 16:10:42 -0700
> From: dank at kegel.com
> To: wine-devel at winehq.org
> Subject: Appdb request: allow browsing for downloadable platinum apps
> 
> The appdb has a "browse by rating" and a "browse downloadable"
> option, but there's no way to combine them.
> 
> Can we add a 'downloadable' checkbox in the 'browse by rating'
> page, maybe?
> 
> 

_________________________________________________________________
Climb to the top of the charts!?Play the word scramble challenge with star power.
http://club.live.com/star_shuffle.aspx?icid=starshuffle_wlmailtextlink_jan

From wine.dev at web.de  Tue Mar 18 18:22:29 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Wed, 19 Mar 2008 00:22:29 +0100
Subject: ntoskrnl.exe: Implement MmIsAddressValid (bug 11082)
In-Reply-To: <016e01c88894$be6b0080$a600fea9@DMITRY>
References: <1205795360.17905.4.camel@p4>
	<016e01c88894$be6b0080$a600fea9@DMITRY>
Message-ID: <1205882549.7976.22.camel@p4>

On Di, 2008-03-18 at 09:09 +0800, Dmitry Timoshkov wrote:
> "Detlef Riekenberg" <wine.dev at web.de> wrote:
> 
> > +    len = VirtualQuery(VirtualAddress, &info, sizeof(MEMORY_BASIC_INFORMATION));
> > +
> > +    if ((len == sizeof(MEMORY_BASIC_INFORMATION)) && 
> > +        (info.Protect & (PAGE_READWRITE || PAGE_EXECUTE_READWRITE)) &&
> > +        ((info.Protect & PAGE_NOACCESS) == 0) &&
> > +        (info.Type & MEM_COMMIT))
> > +    {
> > +        return TRUE;
> > +    }
> 
> Besides the already pointed out '||' vs. '|' mismatch your code doesn't
> handle PAGE_READONLY and others implying read-only access. Probably checking
> for PAGE_NOACCESS and MEM_COMMIT should be enough.

This is not enough, since PAGE_READONLY will Pagefault on Write.
>From OSR, the result is only TRUE, when the Address does not pagefault
on read or write access:
http://www.osronline.com/DDKx/kmarch/k106_3vle.htm

Thanks for your review.

-- 
 
By by ... Detlef




From austinenglish at gmail.com  Tue Mar 18 20:41:06 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 18 Mar 2008 20:41:06 -0500
Subject: Wine wiki cleanup
In-Reply-To: <a71bd89a0803181601m3b4be848mdab24b14a76b19eb@mail.gmail.com>
References: <a71bd89a0803181601m3b4be848mdab24b14a76b19eb@mail.gmail.com>
Message-ID: <b6bb06270803181841s11d47e9dpcc7403100d366ace@mail.gmail.com>

On Tue, Mar 18, 2008 at 6:01 PM, Dan Kegel <dank at kegel.com> wrote:
> Over time, the Wine wiki front page grew rather unwieldy,
>  so I split the developer information off into two new pages,
>  leaving only a simplified front page behind,
>  mostly aimed at users.
>
>  It's radically simpler.  Hopefully it'll be more welcoming to new users.
>
>  Comments?
>
>
>

Ahh, that's much nicer. I'd thought about doing that a week or two
ago, but then got busy with other things.


From dank at kegel.com  Tue Mar 18 20:22:57 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 Mar 2008 18:22:57 -0700
Subject: cygwin runs!
Message-ID: <a71bd89a0803181822y1b687239o84aee2b308fc34a4@mail.gmail.com>

Hey!  Cygwin actually installs and runs inside Wine!
There are a few problems (gcc can't compile
"hello, world" yet, symlinks like the one for vi
don't work yet, the setup utility doesn't
resize properly, and mkpasswd -l aborts), but the shell starts up fine
and vim runs inside it!

Hats off to the Wine team!
- Dan


From tehblunderbuss at gmail.com  Tue Mar 18 23:42:58 2008
From: tehblunderbuss at gmail.com (TheBlunderbuss)
Date: Tue, 18 Mar 2008 23:42:58 -0500
Subject: cygwin runs!
In-Reply-To: <a71bd89a0803181822y1b687239o84aee2b308fc34a4@mail.gmail.com>
References: <a71bd89a0803181822y1b687239o84aee2b308fc34a4@mail.gmail.com>
Message-ID: <47E099D2.2020407@gmail.com>

Dan Kegel wrote:
> Hey!  Cygwin actually installs and runs inside Wine!
> There are a few problems (gcc can't compile
> "hello, world" yet, symlinks like the one for vi
> don't work yet, the setup utility doesn't
> resize properly, and mkpasswd -l aborts), but the shell starts up fine
> and vim runs inside it!
>
> Hats off to the Wine team!
> - Dan

Sounds like a recipe for absurdity :D


From ivg231 at gmail.com  Wed Mar 19 01:46:07 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Wed, 19 Mar 2008 02:46:07 -0400
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803181426.23481.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803171647.39614.stefan@codeweavers.com>
	<200803172229.30779.stefan@codeweavers.com>
	<200803181426.23481.stefan@codeweavers.com>
Message-ID: <47E0B6AF.9000406@gmail.com>

Stefan D?singer wrote:
> Hi,
>
> Given the past discussion, do you agree with the code now? Alexandre wants 
> your OKs before applying the patches.
>   

I am not familiar with the state table, atifs, or recent developments in 
the d3d codebase. That's why I suggested a diagram, so that everyone can 
understand the discussion. My concern is long-term maintainability of 
the shader API.  I think the problem is with the definition of "shader 
backend".

The original intent, and the way it's currently used is:
    "A backend for the d3d shader pipeline ("d3d shader backend"), which 
happens to be implemented using some kind of gl shader".

The way this patchset is heading is:
    "A (gl shader backend), which implements both d3d shader and ffp 
pipeline, depending on the circumstances, through a mixed api"

I don't mind sharing the GL shader code to implement FFP or D3D shader 
pipelines - whether it's ATIfs, ARBfp/ARBvp, GLSL, or some other thing 
providing the implementation.  What I do mind is sharing that code 
through the same API for both the FFP and D3D pipeline codepaths. This 
leads to combining APIs that don't belong together, and odd multiplexing 
like you have in patch 004 - forcing the shader path through atifs, even 
though atifs currently doesn't support handling shaders properly, and 
has to "borrow code" from other backends, and implement routing to the 
right one based on what flags are set.

Why do you need to reroute the shader path through atifs to support an 
unrelated set of functionality (ffp replacement)? Isn't it possible to 
have an ffp_backend, and a shader_backend (shader being the d3d shader), 
and you can implement both differently, with different APIs?

Ivan





From dimi at lattica.com  Wed Mar 19 01:08:56 2008
From: dimi at lattica.com (Dimi Paun)
Date: Wed, 19 Mar 2008 02:08:56 -0400
Subject: cygwin runs!
In-Reply-To: <47E099D2.2020407@gmail.com>
References: <a71bd89a0803181822y1b687239o84aee2b308fc34a4@mail.gmail.com>
	<47E099D2.2020407@gmail.com>
Message-ID: <1205906936.6297.246.camel@dimi.lattica.com>

Dan Kegel wrote:
> Hey!  Cygwin actually installs and runs inside Wine!

This is way cool! Last time I've checked there were some
nasty problems, and I haven't seen the patches targeting
this problem.

So satisfying! :) 

Now, if we can get cygwin to run wine... <g>

-- 
Dimi Paun <dimi at lattica.com>
Lattica, Inc.



From chris.teague at gmail.com  Wed Mar 19 01:31:33 2008
From: chris.teague at gmail.com (Chris Teague)
Date: Tue, 18 Mar 2008 23:31:33 -0700
Subject: Version of Windows
Message-ID: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>

This is probably trivial, but I'm having a tough time figuring out the
current version of Windows that Wine is mimicking.  I have a situation
where I need to behave differently if the version is NT (0x0500)
versus when it is XP (0x0600).  I see the WINVER #define, but that
doesn't seem right to me since this must be a runtime variable.  Can
someone point me at an example of how to tell what the current version
of Windows is?  Thanks,
Chris


From xixsimplicityxix at gmail.com  Wed Mar 19 02:02:57 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 02:02:57 -0500
Subject: Version of Windows
In-Reply-To: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
References: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
Message-ID: <78a7dad00803190002rf99030dr17126d7c22760c94@mail.gmail.com>

On Wed, Mar 19, 2008 at 1:31 AM, Chris Teague <chris.teague at gmail.com> wrote:
> This is probably trivial, but I'm having a tough time figuring out the
>  current version of Windows that Wine is mimicking.  I have a situation
>  where I need to behave differently if the version is NT (0x0500)
>  versus when it is XP (0x0600).  I see the WINVER #define, but that
>  doesn't seem right to me since this must be a runtime variable.  Can
>  someone point me at an example of how to tell what the current version
>  of Windows is?  Thanks,
>  Chris
>
>
>

http://wiki.winehq.org/UsefulRegistryKeys

Search for Version


From xixsimplicityxix at gmail.com  Wed Mar 19 02:05:16 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 02:05:16 -0500
Subject: Version of Windows
In-Reply-To: <78a7dad00803190002rf99030dr17126d7c22760c94@mail.gmail.com>
References: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
	<78a7dad00803190002rf99030dr17126d7c22760c94@mail.gmail.com>
Message-ID: <78a7dad00803190005nc4735bfmd80b71ca81cd6d1b@mail.gmail.com>

On Wed, Mar 19, 2008 at 2:02 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>
> On Wed, Mar 19, 2008 at 1:31 AM, Chris Teague <chris.teague at gmail.com> wrote:
>  > This is probably trivial, but I'm having a tough time figuring out the
>  >  current version of Windows that Wine is mimicking.  I have a situation
>  >  where I need to behave differently if the version is NT (0x0500)
>  >  versus when it is XP (0x0600).  I see the WINVER #define, but that
>  >  doesn't seem right to me since this must be a runtime variable.  Can
>  >  someone point me at an example of how to tell what the current version
>  >  of Windows is?  Thanks,
>  >  Chris
>  >
>  >
>  >
>
>  http://wiki.winehq.org/UsefulRegistryKeys
>
>  Search for Version
>
More direct perhaps
http://source.winehq.org/git/wine.git/?a=blobdiff;f=tools/wine.inf;h=97a773533ec65020d175416852dae2cc4b6669ee;hp=cf4b7a026962efa47279d6d26a69918b62aaa36d;hb=f629dc4eb6006fbdc3f658d13186b9c7e08b189d;hpb=0e9d02ded40810272f8cf8dfc429f8d07e9e6fb9


From xixsimplicityxix at gmail.com  Wed Mar 19 03:07:45 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 03:07:45 -0500
Subject: Appdb nice urls: best way to test indexing of production data
Message-ID: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>

On my spring break and had some free time so I thought I'd take a shot
at implementing nice urls for the appdb that DanK had suggested a
while back.

I have decent bit of code in place that will interpret the url
http://appdb.winehq.org/app/what-you-want-here
and then feed the chunks into a hash table and return the match or
matches however it goes.

However indexing the large amount of data in the production appdb
database could take sometime so I was wanting to test it before I sent
my code in.

I was wondering if there was a way to download the data from the appdb?

--John Klehm


From meissner at suse.de  Wed Mar 19 04:20:21 2008
From: meissner at suse.de (Marcus Meissner)
Date: Wed, 19 Mar 2008 10:20:21 +0100
Subject: winex11.drv: Handle arbitrary length composed input.
In-Reply-To: <200803190916361590760006MAA6@nm06mta.auone-net.jp>
References: <200803190916361590760006MAA6@nm06mta.auone-net.jp>
Message-ID: <20080319092020.GA9675@suse.de>

On Wed, Mar 19, 2008 at 06:16:36PM +0900, Kusanagi Kouichi wrote:
> Fix bug #9838. http://bugs.winehq.org/show_bug.cgi?id=9838
> ---
>  dlls/winex11.drv/keyboard.c |   25 ++++++++++++++++---------
>  dlls/winex11.drv/xim.c      |   16 ++++++++++------
>  2 files changed, 26 insertions(+), 15 deletions(-)
> 
> diff --git a/dlls/winex11.drv/keyboard.c b/dlls/winex11.drv/keyboard.c
> index 33640db..386a471 100644
> --- a/dlls/winex11.drv/keyboard.c
> +++ b/dlls/winex11.drv/keyboard.c
> @@ -1365,22 +1365,29 @@ void X11DRV_KeyEvent( HWND hwnd, XEvent *xev )
>      wine_tsx11_lock();
>      /* Clients should pass only KeyPress events to XmbLookupString */
>      if (xic && event->type == KeyPress)
> +    {
>          ascii_chars = XmbLookupString(xic, event, Str, sizeof(Str), &keysym, &status);
> +
> +        if (status == XBufferOverflow)
> +        {
> +            char buf[ascii_chars];

You should not use dynamic sized arrays. Use HeapAlloc() to allocate them.

Ciao, Marcus


From julliard at winehq.org  Wed Mar 19 05:26:21 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 19 Mar 2008 11:26:21 +0100
Subject: [2/2] qmgr: Add a stub implementation of IBackgroundCopyJob2.
In-Reply-To: <20080319013102.GS4608@linux.ucla.edu> (Dan Hipschman's message
	of "Tue, 18 Mar 2008 18:31:02 -0700")
References: <20080319013102.GS4608@linux.ucla.edu>
Message-ID: <87d4pr80xe.fsf@wine.dyndns.org>

Dan Hipschman <dsh at linux.ucla.edu> writes:

> @@ -93,6 +93,10 @@ typedef struct
>      const IClassFactoryVtbl *lpVtbl;
>  } ClassFactoryImpl;
>  
> +/* This makes it easier to upgrade to IBackgroundCopyJob3, IBackgroundCopyJob4,
> +   and whatever else MS decides to tack on later.  */
> +typedef IBackgroundCopyJob2 BITS_IBackgroundCopyJob;

Please don't do that, vtable entries should use the correct types,
otherwise it will be very confusing. You'll just have to rename them
when switching to a newer version of the interface.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Wed Mar 19 05:31:40 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 19 Mar 2008 11:31:40 +0100
Subject: [Try 2] A nicer icon for msiexec
In-Reply-To: <799667.6943.qm@web25809.mail.ukl.yahoo.com> (=?utf-8?Q?=22He?=
	=?utf-8?Q?rv=C3=BFffffe9?=
	Chanal"'s message of "Tue, 18 Mar 2008 14:37:28 +0000 (GMT)")
References: <799667.6943.qm@web25809.mail.ukl.yahoo.com>
Message-ID: <878x0f80oj.fsf@wine.dyndns.org>

Herv?ffffe9 Chanal <chanal_herve at yahoo.fr> writes:

> It's a nicer icon for msiexec. From the last submit, several size are
> now included in the icon file. The icons are generated using a script
> i submitted to wine-patch a long time ago.  The svg source is not in
> this patch. I can submit it too.

Yes, we should include the svg source, and make sure we can rebuild the
icons from it. Last time I tried to do that using your script I didn't
get good results, the image was all mangled, so we need to look into
this further. Can you please resubmit the svg?

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Wed Mar 19 06:11:19 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 19 Mar 2008 12:11:19 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E0B6AF.9000406@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803181426.23481.stefan@codeweavers.com>
	<47E0B6AF.9000406@gmail.com>
Message-ID: <200803191211.19315.stefan@codeweavers.com>

Am Mittwoch, 19. M?rz 2008 07:46:07 schrieb Ivan Gyurdiev:
> Why do you need to reroute the shader path through atifs to support an
> unrelated set of functionality (ffp replacement)? Isn't it possible to
> have an ffp_backend, and a shader_backend (shader being the d3d shader),
> and you can implement both differently, with different APIs?
Sounds all great and cool, but: How do you handle a case of a d3d vertex 
shader + fixed function fragment processing using a GLSL shader replacement? 
An Uber-Shader-Backend that links the shaders together?

I can happily drop the strange routing through GLSL and the none shader 
backend for ATIFS, or with ARB pixel shaders enabled. In that case we'll just 
don't make use of it on ATI 9500+ cards until we have an ARB or GLSL 
replacement.


From stefan at codeweavers.com  Wed Mar 19 06:18:53 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 19 Mar 2008 12:18:53 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E0B6AF.9000406@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803181426.23481.stefan@codeweavers.com>
	<47E0B6AF.9000406@gmail.com>
Message-ID: <200803191218.53293.stefan@codeweavers.com>

Am Mittwoch, 19. M?rz 2008 07:46:07 schrieb Ivan Gyurdiev:
> The way this patchset is heading is:
>     "A (gl shader backend), which implements both d3d shader and ffp
> pipeline, depending on the circumstances, through a mixed api"
Yes, that's the only way that will work. The shader backend mutually talks to 
opengl, we have to design it around the requirements of the opengl 
(extension) APIs. Trying to stick the shader backend's design to d3d will not 
work properly

All in all we can only have a ffp replacement shader OR a d3d shader active. 
Some instance has to sort out what is active, and given that in GLSL we'll 
need to link vertex+fragment+geometry shaders the shader backend is the best 
place to find that out IMHO


From volker.groeschel at sap.com  Wed Mar 19 06:26:48 2008
From: volker.groeschel at sap.com (Groeschel, Volker)
Date: Wed, 19 Mar 2008 12:26:48 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
Message-ID: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>

The Patch points to wine-cvs. Shouldn't it point to wine-devel.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080319/69bdbf7d/attachment.htm 

From ken at codeweavers.com  Wed Mar 19 07:21:14 2008
From: ken at codeweavers.com (Ken Thomases)
Date: Wed, 19 Mar 2008 07:21:14 -0500
Subject: Maarten Lankhorst : winmm: Fix midi deadlock by not holding lock
	on release .
In-Reply-To: <E1JbbBJ-0005Pn-Lp@wine.codeweavers.com>
References: <E1JbbBJ-0005Pn-Lp@wine.codeweavers.com>
Message-ID: <91CE46D3-520F-4A92-85CC-8C086DEF8370@codeweavers.com>

This has a whiff of the double-checked locking anti-pattern.  I can't  
see a way where it would really bite us in this case, but that anti- 
pattern has several subtleties.  So, I just wanted to prompt people to  
double-check it (pun acknowledged).

Cheers,
Ken

On Mar 18, 2008, at 7:44 AM, Alexandre Julliard wrote:
> Module: wine
> Branch: master
> Commit: 15907b5035ea7f03b369a0463ab1f6ac2b24704e
> URL:    http://source.winehq.org/git/wine.git/?a=commit;h=15907b5035ea7f03b369a0463ab1f6ac2b24704e
>
> Author: Maarten Lankhorst <m.b.lankhorst at gmail.com>
> Date:   Mon Mar 17 13:15:42 2008 -0700
>
> winmm: Fix midi deadlock by not holding lock on release.
>
> ---
>
> dlls/winmm/mci.c |   22 ++++++++++++++--------
> 1 files changed, 14 insertions(+), 8 deletions(-)
>
> diff --git a/dlls/winmm/mci.c b/dlls/winmm/mci.c
> index b7b5ac2..c792d18 100644
> --- a/dlls/winmm/mci.c
> +++ b/dlls/winmm/mci.c
> @@ -1767,19 +1767,25 @@ static	DWORD MCI_Close(UINT16 wDevID, DWORD  
> dwParam, LPMCI_GENERIC_PARMS lpParms
>     TRACE("(%04x, %08X, %p)\n", wDevID, dwParam, lpParms);
>
>     if (wDevID == MCI_ALL_DEVICE_ID) {
> -	LPWINE_MCIDRIVER	next;
> -
> -	EnterCriticalSection(&WINMM_cs);
> 	/* FIXME: shall I notify once after all is done, or for
> 	 * each of the open drivers ? if the latest, which notif
> 	 * to return when only one fails ?
> 	 */
> -	for (wmd = MciDrivers; wmd; ) {
> -	    next = wmd->lpNext;
> -	    MCI_Close(wmd->wDeviceID, dwParam, lpParms);
> -	    wmd = next;
> +	while (MciDrivers) {
> +            /* Retrieve the device ID under lock, but send the  
> message without,
> +             * the driver might be calling some winmm functions  
> from another
> +             * thread before being fully stopped.
> +             */
> +            EnterCriticalSection(&WINMM_cs);
> +            if (!MciDrivers)
> +            {
> +                LeaveCriticalSection(&WINMM_cs);
> +                break;
> +            }
> +            wDevID = MciDrivers->wDeviceID;
> +            LeaveCriticalSection(&WINMM_cs);
> +            MCI_Close(wDevID, dwParam, lpParms);
> 	}
> -	LeaveCriticalSection(&WINMM_cs);
> 	return 0;
>     }
>
>
>
>



From ivg231 at gmail.com  Wed Mar 19 08:19:02 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Wed, 19 Mar 2008 09:19:02 -0400
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803191211.19315.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803181426.23481.stefan@codeweavers.com>
	<47E0B6AF.9000406@gmail.com>
	<200803191211.19315.stefan@codeweavers.com>
Message-ID: <47E112C6.1010205@gmail.com>

Stefan D?singer wrote:
> Am Mittwoch, 19. M?rz 2008 07:46:07 schrieb Ivan Gyurdiev:
>   
>> Why do you need to reroute the shader path through atifs to support an
>> unrelated set of functionality (ffp replacement)? Isn't it possible to
>> have an ffp_backend, and a shader_backend (shader being the d3d shader),
>> and you can implement both differently, with different APIs?
>>     
> Sounds all great and cool, but: How do you handle a case of a d3d vertex 
> shader + fixed function fragment processing using a GLSL shader replacement? 
> An Uber-Shader-Backend that links the shaders together?
>
> I can happily drop the strange routing through GLSL and the none shader 
> backend for ATIFS, or with ARB pixel shaders enabled. In that case we'll just 
> don't make use of it on ATI 9500+ cards until we have an ARB or GLSL 
> replacement.
>   

I'll get back to you on that later tonight, need to think about this 
some more - way late for work right now... (thanks to you!)
 
However, yes, I think there needs to be distinction between a standalone 
shader concept, and a pipeline concept, which is concerned with linking 
several multifunctional shaders together - your "uber-shader-backend".  
Lack of distinction on this point is causing all this confusion.

Ivan






From mstefani at redhat.com  Wed Mar 19 07:28:46 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 19 Mar 2008 13:28:46 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>
Message-ID: <47E106FE.2080404@redhat.com>

Groeschel, Volker wrote:
> The Patch points to wine-cvs. Shouldn't it point to wine-devel.
It points to wine-devel.

bye
	michael


From rob at codeweavers.com  Wed Mar 19 07:36:04 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 19 Mar 2008 12:36:04 +0000
Subject: Version of Windows
In-Reply-To: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
References: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
Message-ID: <47E108B4.4080903@codeweavers.com>

Chris Teague wrote:
> This is probably trivial, but I'm having a tough time figuring out the
> current version of Windows that Wine is mimicking.  I have a situation
> where I need to behave differently if the version is NT (0x0500)
> versus when it is XP (0x0600).  I see the WINVER #define, but that
> doesn't seem right to me since this must be a runtime variable.  Can
> someone point me at an example of how to tell what the current version
> of Windows is?  Thanks,
>   

Errm, GetVersion()?

If you're a developer for a Windows application it is a much better 
policy to check for features rather than checking the Windows version, 
since that feature may be implemented in a later service pack for that 
version of Windows.

-- 
Rob Shearman



From volker.groeschel at sap.com  Wed Mar 19 07:38:46 2008
From: volker.groeschel at sap.com (Groeschel, Volker)
Date: Wed, 19 Mar 2008 13:38:46 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <47E106FE.2080404@redhat.com>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>
	<47E106FE.2080404@redhat.com>
Message-ID: <1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>

>> Groeschel, Volker wrote:
>> The Patch points to wine-cvs. Shouldn't it point to wine-devel.
> Stefaniuc, Michael  wrote:
> It points to wine-devel.
> 
> bye
>     michael

No, it doesn't.
<A HREF="http://www.winehq.org/mailman/listinfo/wine-cvs">wine-devel at
winehq.org</A>


From rob at codeweavers.com  Wed Mar 19 07:38:30 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 19 Mar 2008 12:38:30 +0000
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>
Message-ID: <47E10946.9010800@codeweavers.com>

Groeschel, Volker wrote:
> The Patch points to wine-cvs. Shouldn't it point to wine-devel.

Not in the version of the patch I'm looking at:
>              if (! is_tablet_cursor(target->name, device_type))
>              {
> -                WARN("Skipping device %d [name %s|type %s]; not apparently a tablet cursor type device.  If this is wrong, please report to http://forums.winehq.org\n",
> +                WARN("Skipping device %d [name %s|type %s]; not apparently a tablet cursor type device.  If this is wrong, please report it to wine-devel at winehq.org\n",
>                       loop, devices[loop].name, device_type ? device_type : "");
>                  XFree(device_type);
>                  cursor_target --;
>   

-- 
Rob Shearman



From susancragin at earthlink.net  Wed Mar 19 08:03:27 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Wed, 19 Mar 2008 09:03:27 -0400 (GMT-04:00)
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
Message-ID: <14934900.1205931808148.JavaMail.root@elwamui-huard.atl.sa.earthlink.net>

Wine has two bugs filed for this also:
http://bugs.winehq.org/show_bug.cgi?id=10495
http://bugs.winehq.org/show_bug.cgi?id=10910
I am worried that everyone (WINE, ALSA, Pulse, Ubuntu) is not on the same page. Will try cross-posting bug information. 
Part of the problem seems to be that the most-missed application is Skype, and some are trying to get away with blaming closed-source issues. 
Tom -- I should include the link to your patch, yes, so that other developers have access to it?
Susan
Dan -- What do you think? Good idea?

-----Original Message-----
>From: Tomas Carnecky <tom at dbservice.com>
>Sent: Mar 18, 2008 5:14 PM
>To: Susan Cragin <susancragin at earthlink.net>
>Cc: wine-devel at winehq.org
>Subject: Re: Hardy Heron -- Pulseaudio interferes with non-gnome audio
>
>Susan Cragin wrote:
>> The new default pulseaudio in Hardy screws up every program that isn't gnome, delivering terrible sound. 
>> https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
>
>Applications that use ALSA should work fine with the alsa pulse plugin - 
>  should. Unfortunately the plugin has a few bugs, and the developers 
>(of both pulseaudio and alsa) have been unresponsive in this matter. See
>  - http://www.pulseaudio.org/ticket/198
>  - https://bugtrack.alsa-project.org/alsa-bug/view.php?id=2601
>
>> Question -- what does WINE do with pulseaudio?
>
>Some suggested to create a native PulseAudio wine driver. That would 
>yield the best results as far as the performance and reliability goes. 
>Unfortunately we'll be stuck with the alsa driver for some time to come, 
>so I tried to do the best to make the alsa pulse plugin to work with 
>wine. I had to patch both the wine alsa driver as well as the alsa pulse 
>plugin and it worked fine for my taste.
>
>I submitted the patch to wine-patches:
>http://www.winehq.org/pipermail/wine-patches/2008-February/050561.html
>
>I don't know if the relevant alsa pulse plugin patch is publicly 
>available, I haven't looked at that matter in a long time. Some of the 
>needed patches are probably still in my local repositories. It makes no 
>sense for me to work on this anymore until the developers respond to my 
>questions.
>
>> http://forum.skype.com/index.php?showtopic=112021
>
>I heard that the skype developers are very interested in getting skype 
>working with pulseaudio, even helped tisting some patches. I have gotten 
>skype to work with pulseaudio, I think if you apply the second patch 
>attached to alsa bug #2601 skype will work. I haven't looked at the code 
>since because apparently nobody from the alsa team is interested in 
>fixing the bug.
>
>tom





From mstefani at redhat.com  Wed Mar 19 08:14:41 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 19 Mar 2008 14:14:41 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>
Message-ID: <47E111C1.3010001@redhat.com>

Groeschel, Volker wrote:
>>> Groeschel, Volker wrote:
>>> The Patch points to wine-cvs. Shouldn't it point to wine-devel.
>> Stefaniuc, Michael  wrote:
>> It points to wine-devel.
>>
>
> No, it doesn't.
> <A HREF="http://www.winehq.org/mailman/listinfo/wine-cvs">wine-devel at
> winehq.org</A>
At what are you looking at? The only email in wine-cvs with the Subject
"Alexandre Julliard : winex11: Fix bug report address" is this commit
http://source.winehq.org/git/wine.git/?a=commit;h=075df1b609d283c5d0b83a3e1b9bd48e53cb5b74
and the diff
http://source.winehq.org/git/wine.git/?a=commitdiff;h=075df1b609d283c5d0b83a3e1b9bd48e53cb5b74;hp=2cab7ff2c7a11563436e014e2affc73987039bf6
shows only this:
+                WARN("Skipping device %d [name %s|type %s]; not
apparently a tablet cursor type device.  If this is wrong, please report
it to wine-devel at winehq.org\n",

I cannot see any wine-cvs in there.

bye
	michael
-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Hauptst?tter Strasse 58, 70178 Stuttgart
Handelsregister: Amtsgericht Stuttgart HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                 Werner Knoblich


From volker.groeschel at sap.com  Wed Mar 19 08:26:27 2008
From: volker.groeschel at sap.com (Groeschel, Volker)
Date: Wed, 19 Mar 2008 14:26:27 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <47E111C1.3010001@redhat.com>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>
	<47E111C1.3010001@redhat.com>
Message-ID: <1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>

I apologize I was not looking in the diff but in the wine-cvs message
http://www.winehq.org/pipermail/wine-cvs/2008-March/041392.html

There it points to wine-cvs. 

I don't know where this difference comes from.


From volker.groeschel at sap.com  Wed Mar 19 08:34:26 2008
From: volker.groeschel at sap.com (Groeschel, Volker)
Date: Wed, 19 Mar 2008 14:34:26 +0100
Subject: : Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <47E111C1.3010001@redhat.com>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>
	<47E111C1.3010001@redhat.com>
Message-ID: <1DE958D0164F8043BB57265BB40ACDF7A036D5@dewdfe16.wdf.sap.corp>

But wouldn't be http://www.winehq.org/mailman/listinfo/wine-devel better
than wine-devel at winehq.org?

I just quote: "Note: You should be subscribed to the lists before you
post to them, otherwise your posting will be treated as possible spam by
the mailing list software."


From mstefani at redhat.com  Wed Mar 19 08:33:32 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 19 Mar 2008 14:33:32 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>
	<47E111C1.3010001@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>
Message-ID: <47E1162C.9040400@redhat.com>

Groeschel, Volker wrote:
> I apologize I was not looking in the diff but in the wine-cvs message
> http://www.winehq.org/pipermail/wine-cvs/2008-March/041392.html
> 
> There it points to wine-cvs. 
> 
> I don't know where this difference comes from.
The list archives obfuscate email addresses, adds links, etc. It looks
like the website is translating wine-devel at redhat.com to "wine-devel at
winehq.org" but adds a link to the wrong list archives.

Jeremy, do you want a bugzilla entry against the website for that?

bye
	michael


From paul.vriens.wine at gmail.com  Wed Mar 19 08:34:44 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 19 Mar 2008 14:34:44 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>	<47E111C1.3010001@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>
Message-ID: <47E11674.5050909@gmail.com>

Groeschel, Volker wrote:
> I apologize I was not looking in the diff but in the wine-cvs message
> http://www.winehq.org/pipermail/wine-cvs/2008-March/041392.html
> 
> There it points to wine-cvs. 
> 
> I don't know where this difference comes from.
> 
> 
> 
It's pipermail obfuscating the email addresses. (Same is true if you hover over 
"julliard at winehq.org").

-- 
Cheers,

Paul.


From mstefani at redhat.com  Wed Mar 19 08:40:12 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 19 Mar 2008 14:40:12 +0100
Subject: : Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A036D5@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>	<47E111C1.3010001@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A036D5@dewdfe16.wdf.sap.corp>
Message-ID: <47E117BC.1070700@redhat.com>

Groeschel, Volker wrote:
> But wouldn't be http://www.winehq.org/mailman/listinfo/wine-devel better
> than wine-devel at winehq.org?
> 
> I just quote: "Note: You should be subscribed to the lists before you
> post to them, otherwise your posting will be treated as possible spam by
> the mailing list software."
No, you cannot report it to
http://www.winehq.org/mailman/listinfo/wine-devel as that are the read
only archives. wine-devel has moderators and the emails from not
subscribed people make it through though delayed. For a person reporting
an one time problem that is ok to not be subscribed.

bye
	michael


From jnewman at codeweavers.com  Wed Mar 19 09:24:56 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Wed, 19 Mar 2008 09:24:56 -0500
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <47E1162C.9040400@redhat.com>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>
	<47E111C1.3010001@redhat.com>
	<1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>
	<47E1162C.9040400@redhat.com>
Message-ID: <47E12238.2030004@codeweavers.com>

IMO, a better place to file a bug would be with the mailman devs. My 
policy is to try to keep with un-patched packages from Debian stable.

I can manually fix the archives though.

Michael Stefaniuc wrote:
> Groeschel, Volker wrote:
>> I apologize I was not looking in the diff but in the wine-cvs message
>> http://www.winehq.org/pipermail/wine-cvs/2008-March/041392.html
>>
>> There it points to wine-cvs. 
>>
>> I don't know where this difference comes from.
> The list archives obfuscate email addresses, adds links, etc. It looks
> like the website is translating wine-devel at redhat.com to "wine-devel at
> winehq.org" but adds a link to the wrong list archives.
> 
> Jeremy, do you want a bugzilla entry against the website for that?
> 
> bye
> 	michael


From mstefani at redhat.com  Wed Mar 19 09:40:11 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 19 Mar 2008 15:40:11 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
In-Reply-To: <47E12238.2030004@codeweavers.com>
References: <1DE958D0164F8043BB57265BB40ACDF7A035B1@dewdfe16.wdf.sap.corp>	<47E106FE.2080404@redhat.com>	<1DE958D0164F8043BB57265BB40ACDF7A03661@dewdfe16.wdf.sap.corp>	<47E111C1.3010001@redhat.com>	<1DE958D0164F8043BB57265BB40ACDF7A036CA@dewdfe16.wdf.sap.corp>	<47E1162C.9040400@redhat.com>
	<47E12238.2030004@codeweavers.com>
Message-ID: <47E125CB.9040808@redhat.com>

Jeremy Newman wrote:
> IMO, a better place to file a bug would be with the mailman devs. My 
Huh? This looks to me like a configuration problem and not a mailman
bug. I doubt that mailman knows on it's own to expand
wine-devel at redhat.com to:
<A HREF="http://www.winehq.org/mailman/listinfo/wine-cvs">wine-devel at
winehq.org</A>

bye
	michael

> policy is to try to keep with un-patched packages from Debian stable.
> I can manually fix the archives though.
> 
> Michael Stefaniuc wrote:
>> Groeschel, Volker wrote:
>>> I apologize I was not looking in the diff but in the wine-cvs message
>>> http://www.winehq.org/pipermail/wine-cvs/2008-March/041392.html
>>>
>>> There it points to wine-cvs. 
>>>
>>> I don't know where this difference comes from.
>> The list archives obfuscate email addresses, adds links, etc. It looks
>> like the website is translating wine-devel at redhat.com to "wine-devel at
>> winehq.org" but adds a link to the wrong list archives.
>>
>> Jeremy, do you want a bugzilla entry against the website for that?


-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Hauptst?tter Strasse 58, 70178 Stuttgart
Handelsregister: Amtsgericht Stuttgart HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                 Werner Knoblich


From wine-devel at kievinfo.com  Wed Mar 19 09:56:32 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 19 Mar 2008 08:56:32 -0600
Subject: winex11drv: Distinguish left and right keys for shift, ctrl and
	alt.   (try 4)
In-Reply-To: <47DE0C9D.1010008@kievinfo.com>
References: <47DE0C9D.1010008@kievinfo.com>
Message-ID: <47E129A0.2090604@kievinfo.com>

Vitaliy Margolen wrote:
> This time with lots of tests that exposed number of other problems that 
> were fixed.
> 
> I could not separate this patch into separate pieces - they all linked 
> together and
> fixing one problem meant fixing or breaking something else. This 
> especially related
> to the tests that test everything together as a one black box.
> 
> There are still few problems remain that could be exposed by tightening 
> tests.
> ---

Anything wrong with this patch?
Vitaliy


From fgouget at free.fr  Wed Mar 19 09:59:56 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 19 Mar 2008 15:59:56 +0100 (CET)
Subject: The Linux/BSD DF kernel bug
Message-ID: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>


So I've just read the following article:

   GCC 4.3.0 exposes a kernel bug
   http://lwn.net/SubscriberLink/272048/ecf14f359bcdcd15/

And my question is: could this be relevant to Wine?
And I don't mean about GCC 4.3.0 but about MSVC.

Here's the core of the issue:

   The problem revolves around the x86 direction flag (DF), which 
   governs whether block memory operations operate forward through 
   memory or backwards. GCC [...] 4.3.0, assumes that the direction flag 
   has been cleared [...] at the entry of each function, as is specified 
   by the ABI [...] Prior to 4.3, GCC would emit a cld (clear direction 
   flag) opcode before doing inline string or memory operations.

So any compiler that not clear the direction flag at the start of each 
function can cause kernel crashes when running on a buggy Linux or BSD 
kernel.

So the questions are:

Does anyone know if MSVC does a cld in the right places?

What about other popular compilers used to compile Windows 
applications?

Mac OS X being (loosely) based on the BSD kernels, does it have 
this issue too?

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
          tcA thgirypoC muinelliM latigiD eht detaloiv tsuj evah uoY


From dank at kegel.com  Wed Mar 19 10:04:50 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 19 Mar 2008 08:04:50 -0700
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
In-Reply-To: <14934900.1205931808148.JavaMail.root@elwamui-huard.atl.sa.earthlink.net>
References: <14934900.1205931808148.JavaMail.root@elwamui-huard.atl.sa.earthlink.net>
Message-ID: <a71bd89a0803190804o3039dbc0s691feb948c8b73f9@mail.gmail.com>

On Wed, Mar 19, 2008 at 6:03 AM, Susan Cragin <susancragin at earthlink.net> wrote:
> Wine has two bugs filed for this also:
>  http://bugs.winehq.org/show_bug.cgi?id=10495
>  http://bugs.winehq.org/show_bug.cgi?id=10910
>  I am worried that everyone (WINE, ALSA, Pulse, Ubuntu) is not on the same page. Will try cross-posting bug information.
>  Part of the problem seems to be that the most-missed application is Skype, and some are trying to get away with blaming closed-source issues.
>  Tom -- I should include the link to your patch, yes, so that other developers have access to it?
>  Susan
>  Dan -- What do you think? Good idea?

Could be that a wiki page is the best way to provide a central rallying point
between two projects on an issue like this.

Really, though, the answer is for Wine to have a native pulse audio driver.
Maarten said he met somebody in IRC who is almost done with
one.  I do wish he would decloak...
- Dan


From fgouget at free.fr  Wed Mar 19 10:06:34 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 19 Mar 2008 16:06:34 +0100 (CET)
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
Message-ID: <alpine.DEB.1.00.0803191605180.32540@amboise.dolphin>

On Wed, 19 Mar 2008, Francois Gouget wrote:
[...]
> So any compiler that not clear the direction flag at the start of each 
> function can cause kernel crashes when running on a buggy Linux or BSD kernel.
                     ^^^^^^
                     remove

Sorry, it's just regular application crashes, not kernel crashes. It 
would still be interesting to know if that can impact Wine.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
     The software said it requires Win95 or better, so I installed Linux.


From zgold550 at gmail.com  Wed Mar 19 10:16:58 2008
From: zgold550 at gmail.com (Zachary Goldberg)
Date: Wed, 19 Mar 2008 11:16:58 -0400
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
Message-ID: <b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>

On Wed, Mar 19, 2008 at 4:07 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> On my spring break and had some free time so I thought I'd take a shot
>  at implementing nice urls for the appdb that DanK had suggested a
>  while back.
>
>  I have decent bit of code in place that will interpret the url
>  http://appdb.winehq.org/app/what-you-want-here
>  and then feed the chunks into a hash table and return the match or
>  matches however it goes.
>
>  However indexing the large amount of data in the production appdb
>  database could take sometime so I was wanting to test it before I sent
>  my code in.
>
>  I was wondering if there was a way to download the data from the appdb?
>
>  --John Klehm
>
>
>

I do this every week for the WWN to generate the status changes.

$file = "$year$mon$mday.tar.gz";
`wget -O appdb/wine-appdb-$file
ftp://ftp.winehq.org/pub/wine/wine-appdb-$file `;



-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From julliard at winehq.org  Wed Mar 19 10:18:43 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 19 Mar 2008 16:18:43 +0100
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
In-Reply-To: <a71bd89a0803190804o3039dbc0s691feb948c8b73f9@mail.gmail.com>
	(Dan Kegel's message of "Wed, 19 Mar 2008 08:04:50 -0700")
References: <14934900.1205931808148.JavaMail.root@elwamui-huard.atl.sa.earthlink.net>
	<a71bd89a0803190804o3039dbc0s691feb948c8b73f9@mail.gmail.com>
Message-ID: <87iqzi7ne4.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> Could be that a wiki page is the best way to provide a central rallying point
> between two projects on an issue like this.
>
> Really, though, the answer is for Wine to have a native pulse audio driver.

No, the right answer is to make the Alsa driver work right. We need to
stop rushing out to write a new driver every time there's a problem with
an existing one, all it leads to is more broken drivers.

-- 
Alexandre Julliard
julliard at winehq.org


From vostok at etersoft.ru  Wed Mar 19 10:26:03 2008
From: vostok at etersoft.ru (Anatoly Lyutin)
Date: Wed, 19 Mar 2008 18:26:03 +0300
Subject: wine.inf: Add "ShowMenuDelay" value
In-Reply-To: <47E12EC5.3060707@etersoft.ru>
References: <47E12EC5.3060707@etersoft.ru>
Message-ID: <47E1308B.9020008@etersoft.ru>

Anatoly Lyutin wrote:
> Changelog:
>    Add "ShowMenuDelay" value
Ooooops!
Right changelog:


Changelog:
 Add "MenuShowDelay" value.


-- 
Best regards
	Anatoly Lyutin.



From julliard at winehq.org  Wed Mar 19 10:28:55 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 19 Mar 2008 16:28:55 +0100
Subject: winex11drv: Distinguish left and right keys for shift,
	ctrl and alt.   (try 4)
In-Reply-To: <47E129A0.2090604@kievinfo.com> (Vitaliy Margolen's message of
	"Wed, 19 Mar 2008 08:56:32 -0600")
References: <47DE0C9D.1010008@kievinfo.com> <47E129A0.2090604@kievinfo.com>
Message-ID: <87abku7mx4.fsf@wine.dyndns.org>

Vitaliy Margolen <wine-devel at kievinfo.com> writes:

> Anything wrong with this patch?

The message patching inside peek_message looks very wrong, I have a hard
time believing that this is really where this should happen. It most
likely belongs somewhere like process_keyboard_message.

-- 
Alexandre Julliard
julliard at winehq.org


From xixsimplicityxix at gmail.com  Wed Mar 19 10:31:11 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 10:31:11 -0500
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
Message-ID: <78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>

On Wed, Mar 19, 2008 at 10:16 AM, Zachary Goldberg <zgold550 at gmail.com> wrote:
>
> On Wed, Mar 19, 2008 at 4:07 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  >  I was wondering if there was a way to download the data from the appdb?
>  >
>  >  --John Klehm
>  >
>
>  I do this every week for the WWN to generate the status changes.
>
>  $file = "$year$mon$mday.tar.gz";
>  `wget -O appdb/wine-appdb-$file
>  ftp://ftp.winehq.org/pub/wine/wine-appdb-$file `;
>

Thanks! =)


From susancragin at earthlink.net  Wed Mar 19 10:45:09 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Wed, 19 Mar 2008 11:45:09 -0400 (GMT-04:00)
Subject: Hardy Heron -- Pulseaudio interferes with non-gnome audio
Message-ID: <27071618.1205941509502.JavaMail.root@elwamui-hybrid.atl.sa.earthlink.net>

But wait! There are more! Alsa people tell me they have one for Ekiga. Gnome has one, too.
https://bugtrack.alsa-project.org/alsa-bug/view.php?id=3825
http://bugzilla.gnome.org/show_bug.cgi?id=413552
I think a wiki page is a great idea, and I'll set one up later on http://ossri.harvee.org


-----Original Message-----
>From: Susan Cragin <susancragin at earthlink.net>
>Sent: Mar 19, 2008 9:03 AM
>To: Wine Developers <wine-devel at winehq.org>
>Cc: Dan Kegel <dank06 at kegel.com>
>Subject: Re: Hardy Heron -- Pulseaudio interferes with non-gnome audio
>
>Wine has two bugs filed for this also:
>http://bugs.winehq.org/show_bug.cgi?id=10495
>http://bugs.winehq.org/show_bug.cgi?id=10910
>I am worried that everyone (WINE, ALSA, Pulse, Ubuntu) is not on the same page. Will try cross-posting bug information. 
>Part of the problem seems to be that the most-missed application is Skype, and some are trying to get away with blaming closed-source issues. 
>Tom -- I should include the link to your patch, yes, so that other developers have access to it?
>Susan
>Dan -- What do you think? Good idea?
>
>-----Original Message-----
>>From: Tomas Carnecky <tom at dbservice.com>
>>Sent: Mar 18, 2008 5:14 PM
>>To: Susan Cragin <susancragin at earthlink.net>
>>Cc: wine-devel at winehq.org
>>Subject: Re: Hardy Heron -- Pulseaudio interferes with non-gnome audio
>>
>>Susan Cragin wrote:
>>> The new default pulseaudio in Hardy screws up every program that isn't gnome, delivering terrible sound. 
>>> https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/198453
>>
>>Applications that use ALSA should work fine with the alsa pulse plugin - 
>>  should. Unfortunately the plugin has a few bugs, and the developers 
>>(of both pulseaudio and alsa) have been unresponsive in this matter. See
>>  - http://www.pulseaudio.org/ticket/198
>>  - https://bugtrack.alsa-project.org/alsa-bug/view.php?id=2601
>>
>>> Question -- what does WINE do with pulseaudio?
>>
>>Some suggested to create a native PulseAudio wine driver. That would 
>>yield the best results as far as the performance and reliability goes. 
>>Unfortunately we'll be stuck with the alsa driver for some time to come, 
>>so I tried to do the best to make the alsa pulse plugin to work with 
>>wine. I had to patch both the wine alsa driver as well as the alsa pulse 
>>plugin and it worked fine for my taste.
>>
>>I submitted the patch to wine-patches:
>>http://www.winehq.org/pipermail/wine-patches/2008-February/050561.html
>>
>>I don't know if the relevant alsa pulse plugin patch is publicly 
>>available, I haven't looked at that matter in a long time. Some of the 
>>needed patches are probably still in my local repositories. It makes no 
>>sense for me to work on this anymore until the developers respond to my 
>>questions.
>>
>>> http://forum.skype.com/index.php?showtopic=112021
>>
>>I heard that the skype developers are very interested in getting skype 
>>working with pulseaudio, even helped tisting some patches. I have gotten 
>>skype to work with pulseaudio, I think if you apply the second patch 
>>attached to alsa bug #2601 skype will work. I haven't looked at the code 
>>since because apparently nobody from the alsa team is interested in 
>>fixing the bug.
>>
>>tom
>
>
>
>
>





From cesar at ecuarock.net  Wed Mar 19 10:54:23 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Wed, 19 Mar 2008 10:54:23 -0500
Subject: SoC page insurrection! Idea details needed, please read.
In-Reply-To: <19e31a080803181557t462e0bf8w489336aeff9b24f4@mail.gmail.com>
References: <a71bd89a0803180033r70a59ccatd14d11de179be174@mail.gmail.com>
	<47E03BFB.80706@open-vote.org>
	<19e31a080803181557t462e0bf8w489336aeff9b24f4@mail.gmail.com>
Message-ID: <e3d3ae8f0803190854n781b3edek471e09cf8ae5facb@mail.gmail.com>

I'm planning on applying for the FUSE project. I guess there are a lot
of possibilities on this area. I have some experience on implementing
FUSE filesystems with python and C. I'll post some ideas in a couple
of days.

On Tue, Mar 18, 2008 at 5:57 PM, Steven Edwards <winehacker at gmail.com> wrote:
> On Tue, Mar 18, 2008 at 5:02 PM, Scott Ritchie <scott at open-vote.org> wrote:
>  >  Unfortunately I am unable to sponsor my own idea (Case-insensitive
>  >  FUSE), since I'm not too involved with Wine's C code.
>  >
>  >  Could someone else please volunteer to mentor the project if it gets
>  >  accepted by Google?
>
>  If anyone takes this up, we might see about expanding it to include
>  better support for FUSE iso mounted filesystems. Currently when you
>  use fuse to mount an iso image, you have to manually configure a fake
>  drive letter. It would be nice if we could query the loaded fuse
>  module for a listing of mounted iso images and automatically create
>  fake cdrom devices.
>
>  --
>  Steven Edwards
>
>  "There is one thing stronger than all the armies in the world, and
>  that is an idea whose time has come." - Victor Hugo
>
>
>


From chmorgan at gmail.com  Wed Mar 19 10:55:47 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Wed, 19 Mar 2008 11:55:47 -0400
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
	<78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
Message-ID: <f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>

I can provide help with integrating the code with the appdb if you
have any questions. The real question I've got, since I haven't done
it before, is how to get the path the user specified, eg.
appdb.winehq.org/vendor/adobe (or whatever), into a php script so we
can redirect to the list of applications for the vendor 'adobe'.

Chris



On Wed, Mar 19, 2008 at 11:31 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> On Wed, Mar 19, 2008 at 10:16 AM, Zachary Goldberg <zgold550 at gmail.com> wrote:
>  >
>  > On Wed, Mar 19, 2008 at 4:07 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>
> >  >  I was wondering if there was a way to download the data from the appdb?
>  >  >
>  >  >  --John Klehm
>  >  >
>  >
>  >  I do this every week for the WWN to generate the status changes.
>  >
>  >  $file = "$year$mon$mday.tar.gz";
>  >  `wget -O appdb/wine-appdb-$file
>  >  ftp://ftp.winehq.org/pub/wine/wine-appdb-$file `;
>  >
>
>  Thanks! =)
>
>
>
>


From zgold550 at gmail.com  Wed Mar 19 11:01:49 2008
From: zgold550 at gmail.com (Zachary Goldberg)
Date: Wed, 19 Mar 2008 12:01:49 -0400
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
	<78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
	<f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
Message-ID: <b050a5e70803190901q18ba5851iffe1c5ed1bd2d714@mail.gmail.com>

On Wed, Mar 19, 2008 at 11:55 AM, Chris Morgan <chmorgan at gmail.com> wrote:
> I can provide help with integrating the code with the appdb if you
>  have any questions. The real question I've got, since I haven't done
>  it before, is how to get the path the user specified, eg.
>  appdb.winehq.org/vendor/adobe (or whatever), into a php script so we
>  can redirect to the list of applications for the vendor 'adobe'.
>
>  Chris
>
>
Is

$_SERVER["REQUEST_URI"];

what your looking for?



>
>
>
>  On Wed, Mar 19, 2008 at 11:31 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  > On Wed, Mar 19, 2008 at 10:16 AM, Zachary Goldberg <zgold550 at gmail.com> wrote:
>  >  >
>  >  > On Wed, Mar 19, 2008 at 4:07 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  >
>  > >  >  I was wondering if there was a way to download the data from the appdb?
>  >  >  >
>  >  >  >  --John Klehm
>  >  >  >
>  >  >
>  >  >  I do this every week for the WWN to generate the status changes.
>  >  >
>  >  >  $file = "$year$mon$mday.tar.gz";
>  >  >  `wget -O appdb/wine-appdb-$file
>  >  >  ftp://ftp.winehq.org/pub/wine/wine-appdb-$file `;
>  >  >
>  >
>  >  Thanks! =)
>  >
>  >
>  >
>  >
>



-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From chmorgan at gmail.com  Wed Mar 19 11:12:58 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Wed, 19 Mar 2008 12:12:58 -0400
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <b050a5e70803190901q18ba5851iffe1c5ed1bd2d714@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
	<78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
	<f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
	<b050a5e70803190901q18ba5851iffe1c5ed1bd2d714@mail.gmail.com>
Message-ID: <f3f1b91a0803190912s332b8273r8b9081461dd16990@mail.gmail.com>

Yep, I'm aware of that server parameter.

So the idea would be to add code to appdb.winehq.org/index.php and
look at REQUEST_URI for a particular format and redirect based on
that? That sounds feasible.

Chris


On Wed, Mar 19, 2008 at 12:01 PM, Zachary Goldberg <zgold550 at gmail.com> wrote:
> On Wed, Mar 19, 2008 at 11:55 AM, Chris Morgan <chmorgan at gmail.com> wrote:
>  > I can provide help with integrating the code with the appdb if you
>  >  have any questions. The real question I've got, since I haven't done
>  >  it before, is how to get the path the user specified, eg.
>  >  appdb.winehq.org/vendor/adobe (or whatever), into a php script so we
>  >  can redirect to the list of applications for the vendor 'adobe'.
>  >
>  >  Chris
>  >
>  >
>  Is
>
>  $_SERVER["REQUEST_URI"];
>
>  what your looking for?
>
>
>
>
>  >
>  >
>  >
>  >  On Wed, Mar 19, 2008 at 11:31 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  >  > On Wed, Mar 19, 2008 at 10:16 AM, Zachary Goldberg <zgold550 at gmail.com> wrote:
>  >  >  >
>  >  >  > On Wed, Mar 19, 2008 at 4:07 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  >  >
>  >  > >  >  I was wondering if there was a way to download the data from the appdb?
>  >  >  >  >
>  >  >  >  >  --John Klehm
>  >  >  >  >
>  >  >  >
>  >  >  >  I do this every week for the WWN to generate the status changes.
>  >  >  >
>  >  >  >  $file = "$year$mon$mday.tar.gz";
>  >  >  >  `wget -O appdb/wine-appdb-$file
>  >  >  >  ftp://ftp.winehq.org/pub/wine/wine-appdb-$file `;
>  >  >  >
>  >  >
>  >  >  Thanks! =)
>  >  >
>  >  >
>  >  >
>  >  >
>  >
>
>
>
>
>
> --
>  Zachary Goldberg
>  Computer Science & Engineering
>  Electrical Captain of Penn Electric Race Team
>  School of Engineering at the University of Pennsylvania
>
>


From xixsimplicityxix at gmail.com  Wed Mar 19 11:12:59 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 11:12:59 -0500
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
	<78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
	<f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
Message-ID: <78a7dad00803190912m451f3548k796d837b6a2963d8@mail.gmail.com>

On Wed, Mar 19, 2008 at 10:55 AM, Chris Morgan <chmorgan at gmail.com> wrote:
> I can provide help with integrating the code with the appdb if you
>  have any questions. The real question I've got, since I haven't done
>  it before, is how to get the path the user specified, eg.
>  appdb.winehq.org/vendor/adobe (or whatever), into a php script so we
>  can redirect to the list of applications for the vendor 'adobe'.
>
>  Chris
>
>
>


Well that did take a bit for me to work out as well here is what is
working for me on my apache 2.2.8

You have to have allowoveride Options in the parent conf files and then

filename: htdocs/appdb/.htaccess
RewriteEngine On
Options FollowSymLinks # need this as well as RewriteEngine On to
acutally get it going
RewriteBase /appdb/
RewriteRule ^app/(.*)$ matchAppByName.php?AppName=$1



This will let you have:  $1 is matched by the part of the url that is
not matched by http://hostname.com/appb/app/

e.g. appdb/app/adobe-photoshop-cs2
Results in matchAppByName.php?AppName=adobe-photoshop-cs2

I'm not adverse to help with appdb whatever gets it solved more quickly =)

Be careful when choosing your rewritebase as its more important than
you'd think =P

Hope this helps,
John


From chmorgan at gmail.com  Wed Mar 19 11:15:19 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Wed, 19 Mar 2008 12:15:19 -0400
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <78a7dad00803190912m451f3548k796d837b6a2963d8@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
	<78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
	<f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
	<78a7dad00803190912m451f3548k796d837b6a2963d8@mail.gmail.com>
Message-ID: <f3f1b91a0803190915y233e9783yd7c7f15b568abd8e@mail.gmail.com>

On Wed, Mar 19, 2008 at 12:12 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> On Wed, Mar 19, 2008 at 10:55 AM, Chris Morgan <chmorgan at gmail.com> wrote:
>  > I can provide help with integrating the code with the appdb if you
>  >  have any questions. The real question I've got, since I haven't done
>  >  it before, is how to get the path the user specified, eg.
>  >  appdb.winehq.org/vendor/adobe (or whatever), into a php script so we
>  >  can redirect to the list of applications for the vendor 'adobe'.
>  >
>  >  Chris
>  >
>  >
>  >
>
>
>  Well that did take a bit for me to work out as well here is what is
>  working for me on my apache 2.2.8
>
>  You have to have allowoveride Options in the parent conf files and then
>
>  filename: htdocs/appdb/.htaccess
>  RewriteEngine On
>  Options FollowSymLinks # need this as well as RewriteEngine On to
>  acutally get it going
>  RewriteBase /appdb/
>  RewriteRule ^app/(.*)$ matchAppByName.php?AppName=$1
>
>
>
>  This will let you have:  $1 is matched by the part of the url that is
>  not matched by http://hostname.com/appb/app/
>
>  e.g. appdb/app/adobe-photoshop-cs2
>  Results in matchAppByName.php?AppName=adobe-photoshop-cs2
>
>  I'm not adverse to help with appdb whatever gets it solved more quickly =)
>
>  Be careful when choosing your rewritebase as its more important than
>  you'd think =P
>
>  Hope this helps,
>  John
>

Right, this makes more sense. Checking REQUEST_URI in index.php won't
work because the path given won't match an existing page so you'll get
the 404 page instead.

Chris


From xixsimplicityxix at gmail.com  Wed Mar 19 11:44:07 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 11:44:07 -0500
Subject: Appdb nice urls: best way to test indexing of production data
In-Reply-To: <f3f1b91a0803190915y233e9783yd7c7f15b568abd8e@mail.gmail.com>
References: <78a7dad00803190107r37525dd1kefc24e26da01cfc6@mail.gmail.com>
	<b050a5e70803190816i3136be1avfa2572c790b7e464@mail.gmail.com>
	<78a7dad00803190831j4610816cs9a45a3800c5c069c@mail.gmail.com>
	<f3f1b91a0803190855p89181e9y931835a026c877e2@mail.gmail.com>
	<78a7dad00803190912m451f3548k796d837b6a2963d8@mail.gmail.com>
	<f3f1b91a0803190915y233e9783yd7c7f15b568abd8e@mail.gmail.com>
Message-ID: <78a7dad00803190944h5b06e988h4405ae46c9c36413@mail.gmail.com>

On Wed, Mar 19, 2008 at 11:15 AM, Chris Morgan <chmorgan at gmail.com> wrote:
>
> On Wed, Mar 19, 2008 at 12:12 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>  > On Wed, Mar 19, 2008 at 10:55 AM, Chris Morgan <chmorgan at gmail.com> wrote:
>  >  > I can provide help with integrating the code with the appdb if you
>  >  >  have any questions. The real question I've got, since I haven't done
>  >  >  it before, is how to get the path the user specified, eg.
>  >  >  appdb.winehq.org/vendor/adobe (or whatever), into a php script so we
>  >  >  can redirect to the list of applications for the vendor 'adobe'.
>  >  >
>  >  >  Chris

If it is desirable for winehq.org/appdb/show/verb/term (allows for
appdb.winehq.org/show/vender appdb.winehq.org/show/app
winehq.org/show/catagory) then this works for me:

RewriteEngine On
Options FollowSymLinks
RewriteBase /appdb/
#RewriteRule ^app/(.*)$ matchAppByName.php?AppName=$1
RewriteRule ^show/([a-zA-Z]+)/(.*)$ matchByVerbAndTerm.php?verb=$1&term=$2

E.g
appdb.winehq.org/show/vendor/adobe
=> matchByVerbAndTerm.php?verb=vendor&term=adobe

appdb.winehq.org/show/app/adobe-photoshop-cs2
=> matchByVerbAndTerm.php?verb=app&term=adobe-photoshop-cs2

Regards,
John


From msclrhd at googlemail.com  Wed Mar 19 02:12:01 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 19 Mar 2008 07:12:01 +0000
Subject: Version of Windows
In-Reply-To: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
References: <a1e92ecf0803182331j7d7eb076t940023368c6b7369@mail.gmail.com>
Message-ID: <3f4fd2640803190012l5c8f7b57j4b9700df1683857c@mail.gmail.com>

On 19/03/2008, Chris Teague <chris.teague at gmail.com> wrote:
> This is probably trivial, but I'm having a tough time figuring out the
>  current version of Windows that Wine is mimicking.  I have a situation
>  where I need to behave differently if the version is NT (0x0500)
>  versus when it is XP (0x0600).  I see the WINVER #define, but that
>  doesn't seem right to me since this must be a runtime variable.  Can
>  someone point me at an example of how to tell what the current version
>  of Windows is?  Thanks,

Wine does not use the WINVER, or other associated version defines when
building a project - it automatically uses the latest Windows version
(although the API exposed may be incomplete due to missing functions).

Programatically, you can use GetVersionEx
[http://msdn2.microsoft.com/en-us/library/ms724451.aspx] to determine
the version of Windows at runtime in your program, although Microsoft
recommend using VerifyVersionInfo (see
[http://msdn2.microsoft.com/en-us/library/ms725491(VS.85).aspx] for an
example of its usage).

To change the version in Wine you can use winecfg (the 'Windows
Version' property on the 'Applications' tab).

HTH,
- Reece


From msclrhd at googlemail.com  Wed Mar 19 03:35:24 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 19 Mar 2008 08:35:24 +0000
Subject: Tests marked as todo are not displayed on the web results.
Message-ID: <3f4fd2640803190135icaac467q79f7bc3ee50e4c9f@mail.gmail.com>

Hi,

If you look at the output for a set of test results (e.g.
http://test.winehq.org/data/200803181000/), it indicates whether
particular tests need work on Wine. This is a great addition and works
very well... however, if you navigate to the information about that
test (e.g. http://test.winehq.org/data/200803181000/wine_xp_0.9.57-274-g5e463ac/gdiplus:graphicspath.txt),
you don't see what tests are marked as todo.

For example, using the above, it results in:

gdiplus:graphicspath start dlls/gdiplus/tests/graphicspath.c 1.13
graphicspath: 198 tests executed (5 marked as todo, 0 failures), 0 skipped.
gdiplus:graphicspath done (0)

...so does not tell me which of the 5 tests are todo and which are ok.

I haven't checked to see if this is also an issue with the `make test` output.

- Reece


From msclrhd at googlemail.com  Wed Mar 19 03:47:57 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 19 Mar 2008 08:47:57 +0000
Subject: [RFC] Improving the summary results on test.winehq.org
Message-ID: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>

Hi,

Looking at the results from a test run (e.g.
http://test.winehq.org/data/200803181000/), it would be nice to have:

    1.  A summary of a dlls overall results (i.e. the summation of all
its unit test results), preferably before the individual tests, but
could live with them at the bottom.

    2.  A summary of the entire test results (i.e. the summation of
all unit test results for all dlls). This would be best at the top
where it is easily visible.

    3.  Possibly display the number of tests run in a given pass (e.g.
0/12 or 1+3/27). This is to give an idea of how many tests have been
run easily (especially for the dll and overall summaries).

The idea is to get a quick idea of the health of the test results for
each operating system and dll.

- Reece


From volker.groeschel at sap.com  Wed Mar 19 06:09:22 2008
From: volker.groeschel at sap.com (Groeschel, Volker)
Date: Wed, 19 Mar 2008 12:09:22 +0100
Subject: Alexandre Julliard : winex11: Fix bug report address
Message-ID: <1DE958D0164F8043BB57265BB40ACDF7A03591@dewdfe16.wdf.sap.corp>

The Patch points to wine-cvs. Shouldn't it point to wine-devel.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080319/c124f521/attachment.htm 

From ian at ianmacfarlane.com  Wed Mar 19 09:01:54 2008
From: ian at ianmacfarlane.com (Ian Macfarlane)
Date: Wed, 19 Mar 2008 14:01:54 +0000
Subject: Wine1.0 and LGPLv3?
Message-ID: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>

Just to resurrect this topic, as last time, of the responses to my email,
two were positive (and the other just pointed out that I'd mistaken the
Samba licensing for LGPL instead of GPL) but nothing else happened after
that.

Seeing as Wine is officially going to be having a 1.0 in the not too distant
future, this would seem like the ideal time to introduce a license change (
e.g. Samba went to GPLv3 along with a version jump). I remember the WineConf
2007 presentation PDF from Alexandre mentioned it as a "post-1.0"
possibility - it would seem to me that 1.0 would in fact be the ideal time
to make such a change - being able to say "anything pre-1.0 is LGPLv2+ and
anything 1.0+ is LGPLv3+" is quite nice and is easy to understand.

LGPLv3 has a lot of benefits over the previous version (see my previous
email below), some of which are particularly pertinent given Microsoft's
attitude towards it (e.g. in the Novell agreement that led to a third draft
of the GPL, Wine would seem to be excluded from the patent protection
agreement - see http://tinyurl.com/25at6e).

It would be great to have a decision made on this - personally, I can't see
any reason why LGPLv3 would be detrimental to WINE (for example, I can't see
any reason CodeWeavers would dislike any of the new provisions, which mostly
target troll companies), and numerous reasons why it would be a good thing.

Ian Macfarlane

ps: Here's the email I sent about this some time back, but with the bits
about Samba and Solaris snipped out:

On 7/13/07, Ian Macfarlane <ian at ianmacfarlane.com> wrote:
>
> I've been meaning to ask about this since (L)GPL3 was released.
>
> The version 3 of the (L)GPL license has numerous benefits:
>
> - It's much more legally sound in the rest of the world (IMO one of
> the most important factors about the new license) - numerous reasons
> for this e.g. referencing WIPO rather than US laws.
>
> - It has an explicit patent agreement (really an extension of the
> above - (L)GPLv2 has an implicit patent agreement, but this is only
> valid in the US) - this means that people who contribute to and/or
> distribute WINE cannot sue WINE (or WINE users) for patent
> infringement.
>
> - It is compatible with the Apache 2.0 license, meaning that there is
> an even bigger pool of source code to draw from.
>
> - It helps ensure that companies cannot prevent people from modifying
> the source code by providing them explicit legal rights to change the
> code in these circumstances, and requiring information to allow users
> to change it.
>
> - For LGPL only, It makes 100% sure that GPL+linking exception and
> LGPL can be combined legally in all jurisdictions by merging them
> (which is essentially the only real difference, barring slightly
> different wording in the v2.1 of LGPL vs v2. of GPL)
>
> - It prevents patent agreements where only some people are protected.
>
> - It provides a mechanism for first-time accidental violations to be
> 'cured' more easily
>
> - ... and lots of other minor changes to improve the validity of the
> legal status of the license.


<snip>

So as you can see, (L)GPL version 3 has a lot of benefits. It also has
> broad support (excluding Linus of course, who I must point out objects
> only to a single clause in the license that can be resolved by adding
> an extra permission, as GPLv3 permits), including strong corporate
> backing (e.g. IBM, Red Hat, MySQL, Sun, even Novell). As one of the
> projects that Microsoft would most like to destroy, the added
> protections in this updated version of the license would seem even
> more valuable.
>
> Kind regards,
>
>
> Ian Macfarlane
>
>
> ps: As a last note to Damjan - all GPL versions have been considered
> both radical and political when they were released. In retrospect, the
> protections that they provided have been considered invaluable.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080319/6427820e/attachment.htm 

From xixsimplicityxix at gmail.com  Wed Mar 19 14:33:23 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 19 Mar 2008 14:33:23 -0500
Subject: [RFC] Improving the summary results on test.winehq.org
In-Reply-To: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>
References: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>
Message-ID: <78a7dad00803191233o757b22f5oe91940b3ae8bc3d3@mail.gmail.com>

On Wed, Mar 19, 2008 at 3:47 AM, Reece Dunn <msclrhd at googlemail.com> wrote:
>
>     3.  Possibly display the number of tests run in a given pass (e.g.
>  0/12 or 1+3/27). This is to give an idea of how many tests have been
>  run easily (especially for the dll and overall summaries).
>
>  The idea is to get a quick idea of the health of the test results for
>  each operating system and dll.
>

You mouse over any of the results and it will give you the number of tests.

--John


From paul.vriens.wine at gmail.com  Wed Mar 19 14:37:25 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 19 Mar 2008 20:37:25 +0100
Subject: [RFC] Improving the summary results on test.winehq.org
In-Reply-To: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>
References: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>
Message-ID: <47E16B75.2070308@gmail.com>

Reece Dunn wrote:
> Hi,
> 
> Looking at the results from a test run (e.g.
> http://test.winehq.org/data/200803181000/), it would be nice to have:
> 
>     1.  A summary of a dlls overall results (i.e. the summation of all
> its unit test results), preferably before the individual tests, but
> could live with them at the bottom.
> 
>     2.  A summary of the entire test results (i.e. the summation of
> all unit test results for all dlls). This would be best at the top
> where it is easily visible.
> 
>     3.  Possibly display the number of tests run in a given pass (e.g.
> 0/12 or 1+3/27). This is to give an idea of how many tests have been
> run easily (especially for the dll and overall summaries).
> 
> The idea is to get a quick idea of the health of the test results for
> each operating system and dll.
> 
> - Reece
> 
> 
I think Francois already put a lot of these on his todo list:

http://www.winehq.org/pipermail/wine-devel/2008-March/063641.html

Cheers,

Paul.


From mstefani at redhat.com  Wed Mar 19 14:55:42 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 19 Mar 2008 20:55:42 +0100
Subject: Wine1.0 and LGPLv3?
In-Reply-To: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>
References: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>
Message-ID: <47E16FBE.3080207@redhat.com>

Ian Macfarlane wrote:
> Just to resurrect this topic, as last time, of the responses to my
> email, two were positive (and the other just pointed out that I'd
> mistaken the Samba licensing for LGPL instead of GPL) but nothing else
> happened after that.
> 
> Seeing as Wine is officially going to be having a 1.0 in the not too
> distant future, this would seem like the ideal time to introduce a
Quite the contrary, this is the worst time to introduce a license change
as it drags developer time into unnecessary license discussion.

> license change (e.g. Samba went to GPLv3 along with a version jump). I
> remember the WineConf 2007 presentation PDF from Alexandre mentioned it
Right, we discussed the issue at the Wine conference and there was 1
vote to move to LGPL v3. The rest didn't care and prefer to stay with
the existing LGPL v2 until there is a compelling reason to move to v3.

> as a "post-1.0" possibility - it would seem to me that 1.0 would in fact
> be the ideal time to make such a change - being able to say "anything
> pre-1.0 is LGPLv2+ and anything 1.0+ is LGPLv3+" is quite nice and is
> easy to understand.
Wine 1.0 should have been the X11 license ... ;)


bye
	michael

> LGPLv3 has a lot of benefits over the previous version (see my previous
> email below), some of which are particularly pertinent given Microsoft's
> attitude towards it (e.g. in the Novell agreement that led to a third
> draft of the GPL, Wine would seem to be excluded from the patent
> protection agreement - see http://tinyurl.com/25at6e).
> 
> It would be great to have a decision made on this - personally, I can't
> see any reason why LGPLv3 would be detrimental to WINE (for example, I
> can't see any reason CodeWeavers would dislike any of the new
> provisions, which mostly target troll companies), and numerous reasons
> why it would be a good thing.
> 
> Ian Macfarlane
> 
> ps: Here's the email I sent about this some time back, but with the bits
> about Samba and Solaris snipped out:
> 
> On 7/13/07, *Ian Macfarlane* <ian at ianmacfarlane.com
> <mailto:ian at ianmacfarlane.com>> wrote:
> 
>     I've been meaning to ask about this since (L)GPL3 was released.
> 
>     The version 3 of the (L)GPL license has numerous benefits:
> 
>     - It's much more legally sound in the rest of the world (IMO one of
>     the most important factors about the new license) - numerous reasons
>     for this e.g. referencing WIPO rather than US laws.
> 
>     - It has an explicit patent agreement (really an extension of the
>     above - (L)GPLv2 has an implicit patent agreement, but this is only
>     valid in the US) - this means that people who contribute to and/or
>     distribute WINE cannot sue WINE (or WINE users) for patent
>     infringement.
> 
>     - It is compatible with the Apache 2.0 license, meaning that there is
>     an even bigger pool of source code to draw from.
> 
>     - It helps ensure that companies cannot prevent people from modifying
>     the source code by providing them explicit legal rights to change the
>     code in these circumstances, and requiring information to allow users
>     to change it.
> 
>     - For LGPL only, It makes 100% sure that GPL+linking exception and
>     LGPL can be combined legally in all jurisdictions by merging them
>     (which is essentially the only real difference, barring slightly
>     different wording in the v2.1 of LGPL vs v2. of GPL)
> 
>     - It prevents patent agreements where only some people are protected.
> 
>     - It provides a mechanism for first-time accidental violations to be
>     'cured' more easily
> 
>     - ... and lots of other minor changes to improve the validity of the
>     legal status of the license.
> 
> 
> <snip>
> 
>     So as you can see, (L)GPL version 3 has a lot of benefits. It also has
>     broad support (excluding Linus of course, who I must point out objects
>     only to a single clause in the license that can be resolved by adding
>     an extra permission, as GPLv3 permits), including strong corporate
>     backing (e.g. IBM, Red Hat, MySQL, Sun, even Novell). As one of the
>     projects that Microsoft would most like to destroy, the added
>     protections in this updated version of the license would seem even
>     more valuable.
> 
>     Kind regards,
> 
> 
>     Ian Macfarlane
> 
> 
>     ps: As a last note to Damjan - all GPL versions have been considered
>     both radical and political when they were released. In retrospect, the
>     protections that they provided have been considered invaluable.




From dank at kegel.com  Wed Mar 19 15:05:48 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 19 Mar 2008 13:05:48 -0700
Subject: "winefix" - interesting wrapper for wine
In-Reply-To: <471D0065.3010603@open-vote.org>
References: <a71bd89a0710220320h26570f27q1eb3f3b301c176ad@mail.gmail.com>
	<471D0065.3010603@open-vote.org>
Message-ID: <a71bd89a0803191305t7f1954c5h73542e0f65ae02bb@mail.gmail.com>

On Mon, Oct 22, 2007 at 12:56 PM, Scott Ritchie <scott at open-vote.org> wrote:
> Dan Kegel wrote:
>  > Tom W. found and publicized a script called "winefix" by
>  > an ubuntu forums user named "deadlydeathcone":
>  > http://digg.com/linux_unix/Winefix_improved_desktop_integration_for_Wine
>  > http://wine-review.blogspot.com/2007/10/winefix-improved-desktop-integration.html
>  > http://ubuntuforums.org/showthread.php?s=6e904c1df87d3fd1698ab5d7bbdbf664&t=533257
>  >
>  > It's got a bunch of interesting stuff.
>  > I wonder if we could get him to join wine-devel and start
>  > contributing to wine itself...
>  >
>  Yeah, it's very strange that he just came out of nowhere.  I found out
>  about his script through Digg.
>
>  I'm gonna spend some time this week dissecting it and seeing what we can
>  put right into the Wine package.

Did you ever get around to this?  This came up again today in
https://answers.launchpad.net/ubuntu/+source/wine/+question/26260
- Dan


From m.b.lankhorst at gmail.com  Wed Mar 19 15:09:26 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 19 Mar 2008 13:09:26 -0700
Subject: Summer of code and bidi
Message-ID: <b130c85e0803191309y60476f14u2135bca9d3d4ce83@mail.gmail.com>

Hi Shachar,

I've removed the bi-directional entry from summer of code. I don't
think it is a good project because it involves a lot of changes in
pretty much all wine user controls. The only way to do this would be
by using the pango library to do the laying out of text, but I'm not
even sure whether that is a good summer of code idea, since it would
need someone already very experienced with the plumbing of wine.

Maarten.


From dank at kegel.com  Wed Mar 19 14:58:38 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 19 Mar 2008 12:58:38 -0700
Subject: Splitting wine wiki FAQ (was: Wine wiki cleanup)
Message-ID: <a71bd89a0803191258j45e3135egefcaf54d67047757@mail.gmail.com>

On Wed, Mar 19, 2008 at 10:40 AM, Jim <wineforum-user at winehq.org> wrote:
>  Should we do this for the FAQ as well?  I mean:
>
>          Make a separate developer DeveloperFaq (WikiName)
>
>          Move developer related topics from FAQ to DeveloperFAQ
>
>          Add question to FAQ "Where is the Developer FAQ?" to FAQ.  -OR- Possibly not as a FAQ question but a very visible Note at the top.  "Developers see DeveloperFaq"
>
>  A shorter FAQ may look less intimidating to lazy readers thus encouraging more readers and possibly fewer "noob" questions on the list.

Sounds good to me!

I'm cc'ing wine-devel; if nobody objects by Friday, go ahead and do it.
- Dan


From shachar at shemesh.biz  Wed Mar 19 15:45:17 2008
From: shachar at shemesh.biz (Shachar Shemesh)
Date: Wed, 19 Mar 2008 22:45:17 +0200
Subject: Summer of code and bidi
In-Reply-To: <b130c85e0803191309y60476f14u2135bca9d3d4ce83@mail.gmail.com>
References: <b130c85e0803191309y60476f14u2135bca9d3d4ce83@mail.gmail.com>
Message-ID: <47E17B5D.2040802@shemesh.biz>

Maarten Lankhorst wrote:

> Hi Shachar,
>
> I've removed the bi-directional entry from summer of code. I don't
> think it is a good project because it involves a lot of changes in
> pretty much all wine user controls.
Actually, I don't think any touching of the actual user controls is 
involved at all. I think the first bullet (which can be all we want for 
this year) only really involves the ExtTextOut function, as well as the 
Uniscribe functions. No user controls are touched at all.
>  The only way to do this would be
> by using the pango library to do the laying out of text,
I was about to say that the code is practically already there, but I 
really think you should know that, being how it was you who put it there 
:-). I really think that if we came this far, we had better split the 
Unicode algorithm into the components it requires and put it into 
Uniscribe. I don't think we need any reliance on external libraries 
(pango, fribidi, or any other) for that.
>  but I'm not
> even sure whether that is a good summer of code idea, since it would
> need someone already very experienced with the plumbing of wine.
>   
It would require someone to learn the BiDi algorithm and the Uniscribe 
interface, but the reason I offered to mentor it was precisely so that 
the student not have to follow the entire Wine structure. I really don't 
believe this task is heavier than some of the Direct3D stuff on that page.
> Maarten.
>   
Just MHO

Shachar


From m.b.lankhorst at gmail.com  Wed Mar 19 16:31:21 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 19 Mar 2008 14:31:21 -0700
Subject: Summer of code and bidi
In-Reply-To: <47E17B5D.2040802@shemesh.biz>
References: <b130c85e0803191309y60476f14u2135bca9d3d4ce83@mail.gmail.com>
	<47E17B5D.2040802@shemesh.biz>
Message-ID: <b130c85e0803191431o47a92bafjd4feb74ffbaa8367@mail.gmail.com>

Hello,

2008/3/19, Shachar Shemesh <shachar at shemesh.biz>:
> Maarten Lankhorst wrote:
>
>  > Hi Shachar,
>  >
>  > I've removed the bi-directional entry from summer of code. I don't
>  > think it is a good project because it involves a lot of changes in
>  > pretty much all wine user controls.
>
> Actually, I don't think any touching of the actual user controls is
>  involved at all. I think the first bullet (which can be all we want for
>  this year) only really involves the ExtTextOut function, as well as the
>  Uniscribe functions. No user controls are touched at all.
I already did this work, exttextout relies on the reference bidi
implementation now. Took about 3 days to adapt the reference
implementation to wine. (dlls/gdi32/bidi.c)

> >  The only way to do this would be
>  > by using the pango library to do the laying out of text,
>
> I was about to say that the code is practically already there, but I
>  really think you should know that, being how it was you who put it there
>  :-). I really think that if we came this far, we had better split the
>  Unicode algorithm into the components it requires and put it into
>  Uniscribe. I don't think we need any reliance on external libraries
>  (pango, fribidi, or any other) for that.
There are all kinds of rules that tell how it work, a real rendering
engine is complicated to write, and since there are already a few
working, tried and tested engines out there we don't want to write our
own.

> >  but I'm not
>  > even sure whether that is a good summer of code idea, since it would
>  > need someone already very experienced with the plumbing of wine.
>  >
>
> It would require someone to learn the BiDi algorithm and the Uniscribe
>  interface, but the reason I offered to mentor it was precisely so that
>  the student not have to follow the entire Wine structure. I really don't
>  believe this task is heavier than some of the Direct3D stuff on that page.
As I said, bidi is already implemented. A real uniscribe algorythm is
something we want to depend on as external library, because a proper
engine would be huge and impossible to maintain/debug.

-Maarten.


From galeru at gmail.com  Wed Mar 19 17:01:38 2008
From: galeru at gmail.com (Corey McClymonds)
Date: Wed, 19 Mar 2008 18:01:38 -0400
Subject: Google Summer of Code Test Suite project
Message-ID: <63ee2bc70803191501u7c44c13cse73fdc59c76b6b1d@mail.gmail.com>

I would like to work on the Regression Suite project, but I'm not
quite sure of the scope.  Would I be choosing a good 30 or 40
applications that run well on wine, using wpkg to install them, and
then test for failures?  Because that would seem as though I am only
doing installer testing, instead of actual application testing.  I
would also like to do some sort of automated regression testing for
actual features you can easily test, if that would be possible.

Corey


From thestig at google.com  Wed Mar 19 17:10:16 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 19 Mar 2008 15:10:16 -0700
Subject: Google Summer of Code Test Suite project
In-Reply-To: <63ee2bc70803191501u7c44c13cse73fdc59c76b6b1d@mail.gmail.com>
References: <63ee2bc70803191501u7c44c13cse73fdc59c76b6b1d@mail.gmail.com>
Message-ID: <558b2f5c0803191510u12a5b2c8ma72f204a7bb38a5e@mail.gmail.com>

On Wed, Mar 19, 2008 at 3:01 PM, Corey McClymonds <galeru at gmail.com> wrote:
> I would like to work on the Regression Suite project, but I'm not
>  quite sure of the scope.  Would I be choosing a good 30 or 40
>  applications that run well on wine, using wpkg to install them, and
>  then test for failures?  Because that would seem as though I am only
>  doing installer testing, instead of actual application testing.  I
>  would also like to do some sort of automated regression testing for
>  actual features you can easily test, if that would be possible.
>
>  Corey

Let's just say you're going to write an installer tester. How do you
define a failure? If you're  doing silent installers, do you just look
at the return value from the installer? If you installed app foo, and
the installer created file bar on Windows with a checksum of qux, but
not in Wine, does that count as a failure? How about if a registry key
is missing on Wine?


From galeru at gmail.com  Wed Mar 19 18:07:14 2008
From: galeru at gmail.com (Corey McClymonds)
Date: Wed, 19 Mar 2008 19:07:14 -0400
Subject: Google Summer of Code Test Suite project
In-Reply-To: <558b2f5c0803191510u12a5b2c8ma72f204a7bb38a5e@mail.gmail.com>
References: <63ee2bc70803191501u7c44c13cse73fdc59c76b6b1d@mail.gmail.com>
	<558b2f5c0803191510u12a5b2c8ma72f204a7bb38a5e@mail.gmail.com>
Message-ID: <63ee2bc70803191607o3c1739a9l3d8196701ae9e669@mail.gmail.com>

On 3/19/08, Lei Zhang <thestig at google.com> wrote:
> On Wed, Mar 19, 2008 at 3:01 PM, Corey McClymonds <galeru at gmail.com> wrote:
>  > I would like to work on the Regression Suite project, but I'm not
>  >  quite sure of the scope.  Would I be choosing a good 30 or 40
>  >  applications that run well on wine, using wpkg to install them, and
>  >  then test for failures?  Because that would seem as though I am only
>  >  doing installer testing, instead of actual application testing.  I
>  >  would also like to do some sort of automated regression testing for
>  >  actual features you can easily test, if that would be possible.
>  >
>  >  Corey
>
>
> Let's just say you're going to write an installer tester. How do you
>  define a failure? If you're  doing silent installers, do you just look
>  at the return value from the installer? If you installed app foo, and
>  the installer created file bar on Windows with a checksum of qux, but
>  not in Wine, does that count as a failure? How about if a registry key
>  is missing on Wine?
>

It depends if any functionality is lost.  You could argue that if
anything is different, then wine isn't implementing something
correctly, but I would be fine with it completing and working as
intended.  I would probably do checks on all 3 things you talked
about, and likely anything else that could be easily checked for by a
computer.


From austinenglish at gmail.com  Wed Mar 19 18:15:05 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 19 Mar 2008 18:15:05 -0500
Subject: Google Summer of Code Test Suite project
In-Reply-To: <63ee2bc70803191607o3c1739a9l3d8196701ae9e669@mail.gmail.com>
References: <63ee2bc70803191501u7c44c13cse73fdc59c76b6b1d@mail.gmail.com>
	<558b2f5c0803191510u12a5b2c8ma72f204a7bb38a5e@mail.gmail.com>
	<63ee2bc70803191607o3c1739a9l3d8196701ae9e669@mail.gmail.com>
Message-ID: <b6bb06270803191615w50428d95k81d6cb394dec861f@mail.gmail.com>

On Wed, Mar 19, 2008 at 6:07 PM, Corey McClymonds <galeru at gmail.com> wrote:
>
> On 3/19/08, Lei Zhang <thestig at google.com> wrote:
>  > On Wed, Mar 19, 2008 at 3:01 PM, Corey McClymonds <galeru at gmail.com> wrote:
>  >  > I would like to work on the Regression Suite project, but I'm not
>  >  >  quite sure of the scope.  Would I be choosing a good 30 or 40
>  >  >  applications that run well on wine, using wpkg to install them, and
>  >  >  then test for failures?  Because that would seem as though I am only
>  >  >  doing installer testing, instead of actual application testing.  I
>  >  >  would also like to do some sort of automated regression testing for
>  >  >  actual features you can easily test, if that would be possible.
>  >  >
>  >  >  Corey
>  >
>  >
>  > Let's just say you're going to write an installer tester. How do you
>  >  define a failure? If you're  doing silent installers, do you just look
>  >  at the return value from the installer? If you installed app foo, and
>  >  the installer created file bar on Windows with a checksum of qux, but
>  >  not in Wine, does that count as a failure? How about if a registry key
>  >  is missing on Wine?
>  >
>
>  It depends if any functionality is lost.  You could argue that if
>  anything is different, then wine isn't implementing something
>  correctly, but I would be fine with it completing and working as
>  intended.  I would probably do checks on all 3 things you talked
>  about, and likely anything else that could be easily checked for by a
>  computer.
>
>
>

Using a program like AutoHotkey to install a program and test its
features would be a better route IMHO.


From wine-devel at kievinfo.com  Wed Mar 19 18:18:46 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 19 Mar 2008 17:18:46 -0600
Subject: winex11drv: Distinguish left and right keys for shift, ctrl and
	alt.   (try 4)
In-Reply-To: <87abku7mx4.fsf@wine.dyndns.org>
References: <47DE0C9D.1010008@kievinfo.com> <47E129A0.2090604@kievinfo.com>
	<87abku7mx4.fsf@wine.dyndns.org>
Message-ID: <47E19F56.6000107@kievinfo.com>

Alexandre Julliard wrote:
> Vitaliy Margolen <wine-devel at kievinfo.com> writes:
> 
>> Anything wrong with this patch?
> 
> The message patching inside peek_message looks very wrong, I have a hard
> time believing that this is really where this should happen. It most
> likely belongs somewhere like process_keyboard_message.
> 
Thank you. I wasn't sure where it should go myself. The 
process_keyboard_message is the last in the chain place it can go in. Some 
simple tests showed that journal hook gets the normal VK_SHIFT not 
left/right shift.


From dank at kegel.com  Wed Mar 19 18:31:03 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 19 Mar 2008 16:31:03 -0700
Subject: Google Summer of Code Test Suite project
Message-ID: <a71bd89a0803191631j7a96bbc1m4452b48926f88c88@mail.gmail.com>

On Wed, Mar 19, 2008 at 3:01 PM, Corey McClymonds <galeru at gmail.com> wrote:
> I would like to work on the Regression Suite project, but I'm not
>  quite sure of the scope.  Would I be choosing a good 30 or 40
>  applications that run well on wine, using wpkg to install them, and
>  then test for failures?  Because that would seem as though I am only
>  doing installer testing, instead of actual application testing.

That would be fine for starters.

>  I
>  would also like to do some sort of automated regression testing for
>  actual features you can easily test, if that would be possible.

That would be icing on the cake.

Application testing is insanely difficult.  Even installer testing
is difficult to actually deliver.  I would prefer that you aim
to get a simple run-this-script-and-it-tests-N-installers
script working and in the wine developers' hot little
hands ASAP before you get fancy and try to make
it test more than just installs.  Because essentially
all efforts to do that in the past have failed.

Make sense?

FWIW, here's my first try at it from long ago.  It's a minimal little
script that just tests one app's installer.   I would prefer you
start with something this simple.
http://www.winehq.org/pipermail/wine-devel/2006-July/049913.html
Also, maybe you could make some use of Lei's yawt script,
http://code.google.com/p/yawt/
It's kind of overkill, but it takes care of comparing registry keys and files
created by the installer.
- Dan


From galeru at gmail.com  Wed Mar 19 21:04:17 2008
From: galeru at gmail.com (Corey McClymonds)
Date: Wed, 19 Mar 2008 22:04:17 -0400
Subject: wine-devel Digest, Vol 32, Issue 75
In-Reply-To: <mailman.3838.1205969477.3734.wine-devel@winehq.org>
References: <mailman.3838.1205969477.3734.wine-devel@winehq.org>
Message-ID: <63ee2bc70803191904y56bcbe92m597ab47d27cf1ca@mail.gmail.com>

> From: "Dan Kegel" <dank at kegel.com>
> To: "Wine Developers List" <wine-devel at winehq.org>
> Date: Wed, 19 Mar 2008 16:31:03 -0700
> Subject: re: Google Summer of Code Test Suite project
> On Wed, Mar 19, 2008 at 3:01 PM, Corey McClymonds <galeru at gmail.com> wrote:
>  > I would like to work on the Regression Suite project, but I'm not
>  >  quite sure of the scope.  Would I be choosing a good 30 or 40
>  >  applications that run well on wine, using wpkg to install them, and
>  >  then test for failures?  Because that would seem as though I am only
>  >  doing installer testing, instead of actual application testing.
>
>  That would be fine for starters.
>
>  >  I
>  >  would also like to do some sort of automated regression testing for
>  >  actual features you can easily test, if that would be possible.
>
>  That would be icing on the cake.
>
>  Application testing is insanely difficult.  Even installer testing
>  is difficult to actually deliver.  I would prefer that you aim
>  to get a simple run-this-script-and-it-tests-N-installers
>  script working and in the wine developers' hot little
>  hands ASAP before you get fancy and try to make
>  it test more than just installs.  Because essentially
>  all efforts to do that in the past have failed.
>
>  Make sense?
>
>  FWIW, here's my first try at it from long ago.  It's a minimal little
>  script that just tests one app's installer.   I would prefer you
>  start with something this simple.
>  http://www.winehq.org/pipermail/wine-devel/2006-July/049913.html
>  Also, maybe you could make some use of Lei's yawt script,
>  http://code.google.com/p/yawt/
>  It's kind of overkill, but it takes care of comparing registry keys and files
>  created by the installer.
>  - Dan
>
>

Yeah, I was unaware of how difficult it would be, although now that I
put on my programmers cap, I can see how it would be really difficult
to do so.  In that case, I would still like to do a regression test
for installations to help out the wine project.


From dimi at lattica.com  Wed Mar 19 21:13:06 2008
From: dimi at lattica.com (Dimi Paun)
Date: Wed, 19 Mar 2008 22:13:06 -0400
Subject: wineboot: Add the Romanian translation.
In-Reply-To: <20080319225726.GD7092@redhat.com>
References: <20080319225726.GD7092@redhat.com>
Message-ID: <1205979186.6297.248.camel@dimi.lattica.com>


On Wed, 2008-03-19 at 23:57 +0100, Michael Stefaniuc wrote:
> +    LTEXT           "O ?e?ire sau oprire simulat? este ?n curs dar
> acest proces nu r?spunde.",

This should be "O ie?ire" not "O ?e?ire", no?

-- 
Dimi Paun <dimi at lattica.com>
Lattica, Inc.



From jjmckenzie51 at sprintpcs.com  Wed Mar 19 21:24:56 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Wed, 19 Mar 2008 19:24:56 -0700
Subject: Proposed EM_Fontrange Patch
In-Reply-To: <47E02645.7010408@orange.fr>
References: <47DDDDE4.6050500@earthlink.net> <47E02645.7010408@orange.fr>
Message-ID: <47E1CAF8.1020604@sprintpcs.com>

Eric Pouech wrote:
> James McKenzie a ?crit :
>   
>> All:
>>
>> I would like to see the problems with EM_Fontrange be fixed.  The 
>> attached patch is for comment/review and I would like SPECIFIC 
>> guidance on how to implement this patch as it relates to a Wine 1.0 
>> bug (bug/issue 6254) and fixes the problem specified there.  The 
>> conformance tests are already in tests/editor.c and all they involve 
>> is removing some todo_wine blocks related to this issue.  The entire 
>> patch will do this.  Sorry that the patch is in UNIX diff format, I 
>> could not get git to do what I wanted.  The actual patch will be git 
>> format and use the daily git.
>>     
> I think that a couple of things should be improved in the patch:
> - there are 3 hDC stored in the context, while only 2 are of use 
> (rendering and measure)
>   
Actually, there are four, but it appears the one that is not needed is 
fr.hdcTarget.  Does it appear to be not used in normal usage of this 
feature?  If so, then the portion of code that was written for this use 
of this handle would not be needed. That would remove a few lines of code.
> - there is some interdependency with the EM_SETTARGETDEVICE message 
> implementation, that should be looked at
>   
I will look at this when I can.  My time has become very limited as of 
late.  That may be changing in a few months, however.
> - patch is likely a bit too big and should be sliced before inclusion
>
>   
This is the most difficult part.  Where should I make the 'slice' at?  
With only the part that implements the called code first and then the 
calling code?  That would make the most sense to me.

James McKenzie



From stefan at codeweavers.com  Wed Mar 19 21:44:53 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 20 Mar 2008 03:44:53 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <alpine.DEB.1.00.0803191605180.32540@amboise.dolphin>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<alpine.DEB.1.00.0803191605180.32540@amboise.dolphin>
Message-ID: <200803200344.53338.stefan@codeweavers.com>

Am Mittwoch, 19. M?rz 2008 16:06:34 schrieb Francois Gouget:
> On Wed, 19 Mar 2008, Francois Gouget wrote:
> [...]
>
> > So any compiler that not clear the direction flag at the start of each
> > function can cause kernel crashes when running on a buggy Linux or BSD
> > kernel.
>
>                      ^^^^^^
>                      remove
>
> Sorry, it's just regular application crashes, not kernel crashes. It
> would still be interesting to know if that can impact Wine.
Wouldn't the WINAPI function declaration sort this sort of issues out, if GCC 
implements it correctly?


From ivg231 at gmail.com  Wed Mar 19 23:51:23 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Thu, 20 Mar 2008 00:51:23 -0400
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803200213.14491.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803191211.19315.stefan@codeweavers.com>
	<47E112C6.1010205@gmail.com>
	<200803200213.14491.stefan@codeweavers.com>
Message-ID: <47E1ED4B.9000309@gmail.com>

Stefan D?singer wrote:
>> I'll get back to you on that later tonight, need to think about this
>> some more - way late for work right now... (thanks to you!)
>>
>> However, yes, I think there needs to be distinction between a standalone
>> shader concept, and a pipeline concept, which is concerned with linking
>> several multifunctional shaders together - your "uber-shader-backend".
>> Lack of distinction on this point is causing all this confusion.
>>     
> Cool, I'm looking forward to suggestions.
>   
It looks to me as if shader_backend is being overloaded for many 
different purposes that are not really related to each other. Typical 
object structure is to group related data an functions in one place, but 
what's happening in shader_backend is that it has no data of its own, 
and it's a vtable routing between different GL extensions with the data 
being scattered across multiple different places.

    - some functions are related to management of a single shader and 
its resources [ state is BaseShader ]
    - other code manages the link between vertex and fragment shader [ 
glsl programs stored in the Device ]
    - other code manages a group of 2 shaders to handle some fixed 
function purpose [ _blt, using Device->shader_priv_data ]
    - now you want to replace the main fixed function fragment 
processing [ state is in the state table ]

I think it would be worthwhile to review all of this, and see if this 
organization makes sense.  Why aren't the functions grouped together 
with the data ? Why is some of the data in the device object ? Why are 
functions managing different data containers in the same vtable ?

I am no longer familiar with the details, but there's way too many 
things called "shader" by now - d3d shader, gl shader, this made up 
"shader_backend" that actually does fixed function stuff and represents 
neither.  Maybe it makes sense to create new object types - like a 
'pipeline', containing a 'vertex processor', 'fragment processor' (not 
necessarily implemented via shaders).  Maybe each of these should have a 
"fixed" and "dynamic" facing d3d API, but attach or detach to the 
pipeline in the same way. Maybe they can have different gl extensions 
"backend" implementing each.

> Meanwhile, I've separated the ATIFS implementation and the shader backend 
> changes in my patches. The result is attached. The patches 
> named "1", "2", ... will be merged together to avoid regressions due to 
> partial implementations, and they need some reordering. I've hacked that 
> together during my train ride, so I've no idea if it really works.
>   
Will take a look...



From mishra.anurag07 at gmail.com  Wed Mar 19 23:02:40 2008
From: mishra.anurag07 at gmail.com (Anurag Mishra)
Date: Thu, 20 Mar 2008 09:32:40 +0530
Subject: Questions regarding Summer of Code( and Dplay)
Message-ID: <e7ea0e360803192102i730d6fb2i5584209783ff27f3@mail.gmail.com>

Hi,
  I am student at IIT Kanpur[1]. I have quite good knowledge about C
and have been tracking development of Wine over a period of 6 months
or so. I have good knowledge about C(and using it theoretically to
implement stacks, efficient structures and so on). However, I have
little real life experience about programming a project. I have little
experience about Window's API.
  I was looking to participate in Wine development this summer. On SoC
page, the idea of Dplay was bought up. I am interested in trying hands
on that. Can anyone suggest what would be a good starting point?

Thanks,
Anurag Mishra.

[1] http://www.iitk.ac.in


From ovek at arcticnet.no  Wed Mar 19 23:54:47 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Thu, 20 Mar 2008 05:54:47 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
Message-ID: <47E1EE17.7090002@arcticnet.no>

Francois Gouget skrev:
>    The problem revolves around the x86 direction flag (DF), which 
>    governs whether block memory operations operate forward through 
>    memory or backwards. GCC [...] 4.3.0, assumes that the direction flag 
>    has been cleared [...] at the entry of each function, as is specified 
>    by the ABI [...] Prior to 4.3, GCC would emit a cld (clear direction 
>    flag) opcode before doing inline string or memory operations.
> 
> So any compiler that not clear the direction flag at the start of each 
> function can cause kernel crashes when running on a buggy Linux or BSD 
> kernel.

No, it doesn't say that. The kernel is unaffected. The problem is only 
with user-mode signal handlers; if DF is set when a signal occurs, the 
signal handler may get confused.

> Does anyone know if MSVC does a cld in the right places?

Maybe. But it hardly matters. Only GCC-generated code is affected. The 
problem might then show up in Wine signal/exception handling. Things 
like, say, copying the CONTEXT structures around, for example.

In Wine, you can probably easily manually clear the flag on Wine signal 
handler entry (init_handler), if you're worried.




From m.b.lankhorst at gmail.com  Thu Mar 20 00:52:21 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 19 Mar 2008 22:52:21 -0700
Subject: Questions regarding Summer of Code( and Dplay)
In-Reply-To: <b130c85e0803192251i19bce0eeof6fa098503273806@mail.gmail.com>
References: <e7ea0e360803192102i730d6fb2i5584209783ff27f3@mail.gmail.com>
	<b130c85e0803192251i19bce0eeof6fa098503273806@mail.gmail.com>
Message-ID: <b130c85e0803192252r28dbcf12nbb2633aab24f74a7@mail.gmail.com>

Hello Anurag,

 2008/3/19, Anurag Mishra <mishra.anurag07 at gmail.com>:

>   I am student at IIT Kanpur[1]. I have quite good knowledge about C
 >  and have been tracking development of Wine over a period of 6 months
 >  or so. I have good knowledge about C(and using it theoretically to
 >  implement stacks, efficient structures and so on). However, I have
 >  little real life experience about programming a project. I have little
 >  experience about Window's API.
 >   I was looking to participate in Wine development this summer. On SoC
 >  page, the idea of Dplay was bought up. I am interested in trying hands
 >  on that. Can anyone suggest what would be a good starting point?


There are only a few important things to directplay as far as I know.
 The first one is find a game that runs in wine and uses it, and works
 reasonably well single player but not at all multiplayer or online
 because of the missing things (fixmes on dplay in console). After you
 played the game a little bit, think of a plan on how you want to
 tackle this problem.

 Have you managed to compile a git version of wine yet?

 Cheers,

Maarten.


From ovek at arcticnet.no  Thu Mar 20 03:14:49 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Thu, 20 Mar 2008 09:14:49 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <47E1EE17.7090002@arcticnet.no>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<47E1EE17.7090002@arcticnet.no>
Message-ID: <47E21CF9.6070807@arcticnet.no>

Ove Kaaven skrev:
>> Does anyone know if MSVC does a cld in the right places?
> 
> Maybe. But it hardly matters. Only GCC-generated code is affected.

In order to avoid confusion about my answer, I should probably clarify. 
I was answering this question only:

"Could this kernel bug affect MSVC code?"

To this, the answer is "no", as Wine doesn't run application code from 
signal handlers. However, some may wonder what we can *learn* from the 
kernel bug, and maybe formulate a different question:

"Could the new *GCC* cause trouble for Wine, then?"

It's a completely different question, and it also goes far beyond 
whether Wine's own setup_exception clears DF before invoking exception 
handlers (currently it doesn't), and into the realm of differences 
between the Win32 and the Linux ABI. Here, the answer is "yes", but this 
is the case regardless of the kernel issue, and it is also not limited 
to exceptions, but applies to *any* call from application code to Wine.




From dmitry at codeweavers.com  Thu Mar 20 03:15:23 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 20 Mar 2008 16:15:23 +0800
Subject: [1/2] reg: Implement basic 'reg add'.
References: <689de9370803200034g24140491xea25c1deb8c6fcf@mail.gmail.com>
Message-ID: <002001c88a62$8d876d30$a600fea9@DMITRY>

"Andrew Riedi" <andrewriedi at gmail.com> wrote:

> +int reg_lstrncmpiW(const WCHAR *s1, const WCHAR *s2, size_t n)

CompareString is better.

> +    const WCHAR hkcrW[] = {'h','k','c','r',0};
> +    const WCHAR hkcuW[] = {'h','k','c','u',0};
> +    const WCHAR hklmW[] = {'h','k','l','m',0};
> +    const WCHAR hkuW[] = {'h','k','u',0};
> +    const WCHAR hkccW[] = {'h','k','c','c',0};
> +    const WCHAR hkddW[] = {'h','k','d','d',0};

You should make all const strings static.

> +    /* TODO: Remote registry editing. */
> +    if (key_name[0] == '\\' && key_name[1] == '\\')
> +    {
> +        fprintf(stderr, "Remote registry editing not implemented.\n");
> +        return 1;
> +    }

Please use normal WINE_TRACE, WINE_ERR, etc instead of fprintf.


-- 
Dmitry.


From martin at hinner.info  Thu Mar 20 04:26:20 2008
From: martin at hinner.info (Martin Hinner)
Date: Thu, 20 Mar 2008 10:26:20 +0100
Subject: First steps to make Win32 app running under Wine
Message-ID: <24d1a1690803200226p539396fat21bcdc7a9932e2e2@mail.gmail.com>

Hi,

   I am solving problem how to get one Win32 app (for which I have
source code) running under Wine. The biggest issue is drivers and
ioctls. Linux has driver support for what we need and provides similar
ioctls for some stuff, but it differs from Windows.

  The difference is *so big* that I would prefer to modify our source
code to use different pieces of code when it detects Wine. I
understand, that this is *against* Wine policy and generally should
not be used. But writing built-in replacement for some DLLs (hack
Linux-style drivers into Windows-style) would be a nightmare, so
having small mods to Win code would be much easier. I am not talking
about "generic" functions, but about specific drivers/etc.

Imagine this: Under windows you get usb driver with some ioctl-based
interface, sometimes with DLL or without it (vendor provides only .lib
file that gets statically linked). Under Linux there is libusb used.
Difference between these two ways of driver implementation is *huge*
and making libusb driver compatible with Win32 driver is almost
impossible (in Win you have a real file handle, under libusb only
pointer, etc.).

It would greatly help for this case to be able to:

- detect wine and platform from Win32 app (.exe)
- load native Linux library and perform ioctls (ioctl(2), not Windows
IOCTL!) on file handles
- get somehow access to files in Linux filesystem (i.e. in /dev)

This would allow to easily modify our source code in a few places
(i.e. hardware routines) and get it quickly running under Linux.

I can do all above by writing some built-in dll that would work just
for my case, but I think *maybe* it's worth it to provide some generic
interface in Wine??

Martin


From julliard at winehq.org  Thu Mar 20 04:31:44 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 Mar 2008 10:31:44 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <47E1EE17.7090002@arcticnet.no> (Ove Kaaven's message of "Thu, 20
	Mar 2008 05:54:47 +0100")
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<47E1EE17.7090002@arcticnet.no>
Message-ID: <877ifxspvj.fsf@wine.dyndns.org>

Ove Kaaven <ovek at arcticnet.no> writes:

> Francois Gouget skrev:
>> Does anyone know if MSVC does a cld in the right places?
>
> Maybe. But it hardly matters. Only GCC-generated code is affected. The 
> problem might then show up in Wine signal/exception handling. Things 
> like, say, copying the CONTEXT structures around, for example.

It matters in the sense that Wine currently doesn't clear the direction
flag before calling an exception handler, so if MSVC doesn't do a cld
then we'd have the same bug WRT msvc as the Linux kernel has WRT gcc.
Of course now that gcc is changed we'll have to make sure to clear the
flag regardless of what MSVC does.

-- 
Alexandre Julliard
julliard at winehq.org


From meissner at suse.de  Thu Mar 20 04:52:28 2008
From: meissner at suse.de (Marcus Meissner)
Date: Thu, 20 Mar 2008 10:52:28 +0100
Subject: First steps to make Win32 app running under Wine
In-Reply-To: <24d1a1690803200226p539396fat21bcdc7a9932e2e2@mail.gmail.com>
References: <24d1a1690803200226p539396fat21bcdc7a9932e2e2@mail.gmail.com>
Message-ID: <20080320095228.GA12971@suse.de>

On Thu, Mar 20, 2008 at 10:26:20AM +0100, Martin Hinner wrote:
> Hi,
> 
>    I am solving problem how to get one Win32 app (for which I have
> source code) running under Wine. The biggest issue is drivers and
> ioctls. Linux has driver support for what we need and provides similar
> ioctls for some stuff, but it differs from Windows.
> 
>   The difference is *so big* that I would prefer to modify our source
> code to use different pieces of code when it detects Wine. I
> understand, that this is *against* Wine policy and generally should
> not be used. But writing built-in replacement for some DLLs (hack
> Linux-style drivers into Windows-style) would be a nightmare, so
> having small mods to Win code would be much easier. I am not talking
> about "generic" functions, but about specific drivers/etc.
> 
> Imagine this: Under windows you get usb driver with some ioctl-based
> interface, sometimes with DLL or without it (vendor provides only .lib
> file that gets statically linked). Under Linux there is libusb used.
> Difference between these two ways of driver implementation is *huge*
> and making libusb driver compatible with Win32 driver is almost
> impossible (in Win you have a real file handle, under libusb only
> pointer, etc.).
> 
> It would greatly help for this case to be able to:
> 
> - detect wine and platform from Win32 app (.exe)

Best bet is to just check for the registry key HKLM\Software\Wine

> - load native Linux library and perform ioctls (ioctl(2), not Windows
> IOCTL!) on file handles

Needs code in your application, but is technically possible. 

> - get somehow access to files in Linux filesystem (i.e. in /dev)

Same as above. No need for any specific code if you map Z: to / for instance.

> This would allow to easily modify our source code in a few places
> (i.e. hardware routines) and get it quickly running under Linux.
> 
> I can do all above by writing some built-in dll that would work just
> for my case, but I think *maybe* it's worth it to provide some generic
> interface in Wine??

Hmm. We might be able to do this via msvcrt ioctl perhaps? No idea.

Ciao, Marcus


From martin at hinner.info  Thu Mar 20 05:31:08 2008
From: martin at hinner.info (Martin Hinner)
Date: Thu, 20 Mar 2008 11:31:08 +0100
Subject: First steps to make Win32 app running under Wine
In-Reply-To: <20080320095228.GA12971@suse.de>
References: <24d1a1690803200226p539396fat21bcdc7a9932e2e2@mail.gmail.com>
	<20080320095228.GA12971@suse.de>
Message-ID: <24d1a1690803200331q47930682r1acd9f302c191168@mail.gmail.com>

On 3/20/08, Marcus Meissner <meissner at suse.de> wrote:
> Best bet is to just check for the registry key HKLM\Software\Wine

I know also other methods, this is not a problem, I just wanted to ask
if it's possible to get some "official wine api" for all this stuff.

>  > - load native Linux library and perform ioctls (ioctl(2), not Windows
>  > IOCTL!) on file handles
> Needs code in your application, but is technically possible.

I know, the question is again about getting this officially into wine
so as I don't have to make my own built-in .dll.so

>  > - get somehow access to files in Linux filesystem (i.e. in /dev)
> Same as above. No need for any specific code if you map Z: to / for instance.

And if user does not? It would be nice to do
_wine_open("/dev/something", O_RDWR) from my app.

>  > This would allow to easily modify our source code in a few places
>  > (i.e. hardware routines) and get it quickly running under Linux.
>  >
>  > I can do all above by writing some built-in dll that would work just
>  > for my case, but I think *maybe* it's worth it to provide some generic
>  > interface in Wine??
> Hmm. We might be able to do this via msvcrt ioctl perhaps? No idea.

IMHO it would be nice to have "standard" wineapp.dll.so that would
work as a proxy between posix functions for applications that are
aware about Wine. Such DLL would be a great helper! In fact I would
need only dlopen() and dlsym(), maybe also uname()  :-).

This library could be loaded from Win32 app using LoadModule(..) on-demand.

Martin


From ovek at arcticnet.no  Thu Mar 20 05:33:45 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Thu, 20 Mar 2008 11:33:45 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <877ifxspvj.fsf@wine.dyndns.org>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>	<47E1EE17.7090002@arcticnet.no>
	<877ifxspvj.fsf@wine.dyndns.org>
Message-ID: <47E23D89.2030309@arcticnet.no>

Alexandre Julliard skrev:
> Ove Kaaven <ovek at arcticnet.no> writes:
> 
>> Francois Gouget skrev:
>>> Does anyone know if MSVC does a cld in the right places?
>> Maybe. But it hardly matters. Only GCC-generated code is affected. The 
>> problem might then show up in Wine signal/exception handling. Things 
>> like, say, copying the CONTEXT structures around, for example.
> 
> It matters in the sense that Wine currently doesn't clear the direction
> flag before calling an exception handler, so if MSVC doesn't do a cld
> then we'd have the same bug WRT msvc as the Linux kernel has WRT gcc.

But that's a bit of a different issue, unrelated to the kernel flaw. I 
was only talking about that flaw. I kind of tried to clarify that in my 
next followup... oh well.

When it comes to ABI issues with MSVC code, the question isn't so much 
whether it uses cld, but what Windows does when throwing exceptions. 
Does Windows clear the DF when it calls exception handlers? If not, then 
there's hardly any Wine bug here (that doesn't exist on Windows anyway). 
Perhaps someone should test, but my guess is that Windows doesn't clear it.

(And anyway, my experience is that MSVC assumes DF is undefined, and 
does the cld.)

> Of course now that gcc is changed we'll have to make sure to clear the
> flag regardless of what MSVC does.

But not just in the exception handling. Everywhere... there's no special 
case here.




From mstefani at redhat.com  Thu Mar 20 05:54:14 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 20 Mar 2008 11:54:14 +0100
Subject: wineboot: Add the Romanian translation.
In-Reply-To: <1205979186.6297.248.camel@dimi.lattica.com>
References: <20080319225726.GD7092@redhat.com>
	<1205979186.6297.248.camel@dimi.lattica.com>
Message-ID: <47E24256.1080707@redhat.com>

Dimi Paun wrote:
> On Wed, 2008-03-19 at 23:57 +0100, Michael Stefaniuc wrote:
>> +    LTEXT           "O ?e?ire sau oprire simulat? este ?n curs dar
>> acest proces nu r?spunde.",
> 
> This should be "O ie?ire" not "O ?e?ire", no?
Thanks man, I've resent it!

bye
	michael


From dgerard at gmail.com  Wed Mar 19 15:20:49 2008
From: dgerard at gmail.com (David Gerard)
Date: Wed, 19 Mar 2008 20:20:49 +0000
Subject: [Wine] Splitting wine wiki FAQ (was: Wine wiki cleanup)
In-Reply-To: <a71bd89a0803191258j45e3135egefcaf54d67047757@mail.gmail.com>
References: <a71bd89a0803191258j45e3135egefcaf54d67047757@mail.gmail.com>
Message-ID: <fbad4e140803191320m15d2464ei5cad4d43bb21f873@mail.gmail.com>

On 19/03/2008, Dan Kegel <dank at kegel.com> wrote:

>  Sounds good to me!
>  I'm cc'ing wine-devel; if nobody objects by Friday, go ahead and do it.


The thing to keep in mind is: with the new forum gateway, wine-users
is getting a flood of regular non-geek users - the sort of people who
are not geeks at all, but who are sick of Windows being flaky, so they
try Linux (often Ubuntu) and try Wine for that one Windows program
they're stuck with.

And with Wine 1.0 just around the corner, they're going to appear in a
*FLOOD*. You think wine-users has lots of n00bs now? This is NOTHING
to the flood that's about to show up ...

So yeah, the key thing to keep in mind will be to very clearly steer
them to stuff that answers the n00b questions well!

(And thus keep them out of the developers' hair, except the valiant
n00b-helpers who have been writing decent bug reports from scanty
information in the last few weeks from forum/list posts ...)


- d.


From stefan at codeweavers.com  Wed Mar 19 20:13:14 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 20 Mar 2008 02:13:14 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E112C6.1010205@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803191211.19315.stefan@codeweavers.com>
	<47E112C6.1010205@gmail.com>
Message-ID: <200803200213.14491.stefan@codeweavers.com>

> I'll get back to you on that later tonight, need to think about this
> some more - way late for work right now... (thanks to you!)
>
> However, yes, I think there needs to be distinction between a standalone
> shader concept, and a pipeline concept, which is concerned with linking
> several multifunctional shaders together - your "uber-shader-backend".
> Lack of distinction on this point is causing all this confusion.
Cool, I'm looking forward to suggestions.

Meanwhile, I've separated the ATIFS implementation and the shader backend 
changes in my patches. The result is attached. The patches 
named "1", "2", ... will be merged together to avoid regressions due to 
partial implementations, and they need some reordering. I've hacked that 
together during my train ride, so I've no idea if it really works.

I've separated the shader model changes and the atifs implementation to make 
Alexandre happy. I'm now also enabling ATIFS only if ARB vertex shaders are 
enabled, pixel shaders not disabled, GLSL not supported and 
ARB_fragment_program not supported. Thus atifs only inherits from the arb 
backend, which avoids the 3 shader backend structures and makes dealing with 
the private data easier. So I think it partially addresses your concerns. 
atifs still has to route vertex processing through the ARB backend, but we 
will need that if we implement d3d pixel shaders using atifs, unless we split 
up vertex and fragment shader processing backends(So separating fixed 
function and programmable won't help there).
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0.tar.bz2
Type: application/x-tbz
Size: 43138 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080320/b97692ad/attachment-0001.bin 

From fgouget at free.fr  Thu Mar 20 06:00:34 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 20 Mar 2008 12:00:34 +0100 (CET)
Subject: Google Summer of Code Test Suite project
In-Reply-To: <b6bb06270803191615w50428d95k81d6cb394dec861f@mail.gmail.com>
References: <63ee2bc70803191501u7c44c13cse73fdc59c76b6b1d@mail.gmail.com>
	<558b2f5c0803191510u12a5b2c8ma72f204a7bb38a5e@mail.gmail.com>
	<63ee2bc70803191607o3c1739a9l3d8196701ae9e669@mail.gmail.com>
	<b6bb06270803191615w50428d95k81d6cb394dec861f@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0803201143170.8197@amboise.dolphin>

On Wed, 19 Mar 2008, Austin English wrote:
[...]
> Using a program like AutoHotkey to install a program and test its
> features would be a better route IMHO.

I agree but I'm not sure AutoHotKey is quite ready yet. But I think that 
getting a robust graphical testing environment would be hugely 
beneficial for Wine.

There are a couple of options to get there:
 * cxtest
   http://www.cxtest.org/
   It has tools to record and replay clicks.
   One big drawback is that in its current form it is very Unixy, that 
   is you need bash and VNC in order to record an application 
   installation. This prevents running it on Windows which is really 
   needed imho. On the other hand it can handle both Unix and Windows 
   scripting. It is also missing support for some things like menus and 
   combo boxes.
   However it has a great backend for automating and reporting the 
   tests, identifying known issues and automatically grouping them 
   together, etc.

 * AutoHotKey
   http://www.autohotkey.com/
   It runs on Windows and has a very nice 'record' feature: you can 
   start it in record mode, install your application, stop the recording 
   and presto, you have a script ready to replay. However it generates 
   scripts that are coordinates based (i.e. left-click at 123x456), 
   rather than 'controls' based (i.e. left-click on the 'Ok' button in 
   the 'Step 3 windows'). That worries me as I'm not convinced these 
   coordinates will match well when the application is run in Wine 
   (potential font issues). I suspect that even on Windows there could 
   be issues if the user changes the font size, DPI or stuff like that. 
   However I don't know how commercial graphical regression testing 
   tools handle that so maybe it's not such a big issue.
   Also AutoHotKey has not yet been integrated in a framework with a 
   good backend.

So one thing that would be very good for Wine would be to improve 
AutoHotKey so it really does all that we need. It should be good enough 
that open-source projects would want to use it for their own regression 
testing on Windows, so that we would just reuse their scripts. However I 
don't know if it's suitable for a GSoC project. Also it may be more of 
an AutoHotKey GSoC than a Wine one.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
    Indifference will certainly be the downfall of mankind, but who cares?


From julliard at winehq.org  Thu Mar 20 06:12:14 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 Mar 2008 12:12:14 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <47E23D89.2030309@arcticnet.no> (Ove Kaaven's message of "Thu, 20
	Mar 2008 11:33:45 +0100")
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<47E1EE17.7090002@arcticnet.no> <877ifxspvj.fsf@wine.dyndns.org>
	<47E23D89.2030309@arcticnet.no>
Message-ID: <87y78dr6nl.fsf@wine.dyndns.org>

Ove Kaaven <ovek at arcticnet.no> writes:

> But that's a bit of a different issue, unrelated to the kernel flaw. I
> was only talking about that flaw. I kind of tried to clarify that in
> my next followup... oh well.

Sure, it has nothing to do with the kernel bug, except that it points to
a similar bug in the Wine kernel.

>> Of course now that gcc is changed we'll have to make sure to clear the
>> flag regardless of what MSVC does.
>
> But not just in the exception handling. Everywhere... there's no
> special case here.

It depends if MSVC respects that ABI constraint or not. If it doesn't
and calls API functions with the flag set then yes, we'd have to clear
it everywhere. But if it does respect the ABI, then exception handling
is definitely a special case, and we have to clear the flag there, and
nowhere else.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Mar 20 06:30:53 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 Mar 2008 12:30:53 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <47E23D89.2030309@arcticnet.no> (Ove Kaaven's message of "Thu, 20
	Mar 2008 11:33:45 +0100")
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<47E1EE17.7090002@arcticnet.no> <877ifxspvj.fsf@wine.dyndns.org>
	<47E23D89.2030309@arcticnet.no>
Message-ID: <87skylr5si.fsf@wine.dyndns.org>

Ove Kaaven <ovek at arcticnet.no> writes:

> When it comes to ABI issues with MSVC code, the question isn't so much
> whether it uses cld, but what Windows does when throwing
> exceptions. Does Windows clear the DF when it calls exception
> handlers? If not, then there's hardly any Wine bug here (that doesn't
> exist on Windows anyway). Perhaps someone should test, but my guess is
> that Windows doesn't clear it.
>
> (And anyway, my experience is that MSVC assumes DF is undefined, and
> does the cld.)

A quick test on Vista shows that the flag is cleared when calling
exception handlers, and that API functions (at least lstrcat) expect it
to be cleared on entry and don't do a cld.

-- 
Alexandre Julliard
julliard at winehq.org


From ovek at arcticnet.no  Thu Mar 20 07:04:06 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Thu, 20 Mar 2008 13:04:06 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <87y78dr6nl.fsf@wine.dyndns.org>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>	<47E1EE17.7090002@arcticnet.no>
	<877ifxspvj.fsf@wine.dyndns.org>	<47E23D89.2030309@arcticnet.no>
	<87y78dr6nl.fsf@wine.dyndns.org>
Message-ID: <47E252B6.9060207@arcticnet.no>

Alexandre Julliard skrev:
> Ove Kaaven <ovek at arcticnet.no> writes:
> 
>> But that's a bit of a different issue, unrelated to the kernel flaw. I
>> was only talking about that flaw. I kind of tried to clarify that in
>> my next followup... oh well.
> 
> Sure, it has nothing to do with the kernel bug, except that it points to
> a similar bug in the Wine kernel.

Yeah, I mentioned that.

>>> Of course now that gcc is changed we'll have to make sure to clear the
>>> flag regardless of what MSVC does.
>> But not just in the exception handling. Everywhere... there's no
>> special case here.
> 
> It depends if MSVC respects that ABI constraint or not.

Only if you want to make Wine depend on the compiler used to compile 
Windows applications. Not all of them are called "MSVC". I know Borland 
Delphi is used by some these days, and its ABI expectations might be 
different.

Well, I took a look to see what msvcrt expects these days. Looks like it 
expects DF clear now. But I don't think this was always the case in the 
past... (though it's also possible I'm thinking back to win16 here.)




From julliard at winehq.org  Thu Mar 20 07:12:14 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 Mar 2008 13:12:14 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <47E252B6.9060207@arcticnet.no> (Ove Kaaven's message of "Thu, 20
	Mar 2008 13:04:06 +0100")
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<47E1EE17.7090002@arcticnet.no> <877ifxspvj.fsf@wine.dyndns.org>
	<47E23D89.2030309@arcticnet.no> <87y78dr6nl.fsf@wine.dyndns.org>
	<47E252B6.9060207@arcticnet.no>
Message-ID: <87k5jxr3vl.fsf@wine.dyndns.org>

Ove Kaaven <ovek at arcticnet.no> writes:

> Alexandre Julliard skrev:
>> It depends if MSVC respects that ABI constraint or not.
>
> Only if you want to make Wine depend on the compiler used to compile
> Windows applications. Not all of them are called "MSVC". I know
> Borland Delphi is used by some these days, and its ABI expectations
> might be different.

All other Windows compilers have to respect the ABI as defined by MSVC,
if only because all the system dlls are built with MSVC.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Thu Mar 20 07:24:45 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 05:24:45 -0700
Subject: First steps to make Win32 app running under Wine
Message-ID: <a71bd89a0803200524r5f560c29pb4c43b8a6f09270f@mail.gmail.com>

Martin Hinner wrote:
>  I am solving problem how to get one Win32 app (for which I have
> source code) running under Wine. The biggest issue is drivers and
> ioctls. Linux has driver support for what we need and provides similar
> ioctls for some stuff, but it differs from Windows.

What drivers and ioctls, exactly?

Which driver framework are you using?
http://en.wikipedia.org/wiki/User-Mode_Driver_Framework
might be easier for us to directly support...
- Dan


From ovek at arcticnet.no  Thu Mar 20 07:26:25 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Thu, 20 Mar 2008 13:26:25 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <87k5jxr3vl.fsf@wine.dyndns.org>
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>	<47E1EE17.7090002@arcticnet.no>
	<877ifxspvj.fsf@wine.dyndns.org>	<47E23D89.2030309@arcticnet.no>
	<87y78dr6nl.fsf@wine.dyndns.org>	<47E252B6.9060207@arcticnet.no>
	<87k5jxr3vl.fsf@wine.dyndns.org>
Message-ID: <47E257F1.3030604@arcticnet.no>

Alexandre Julliard skrev:
> Ove Kaaven <ovek at arcticnet.no> writes:
> 
>> Alexandre Julliard skrev:
>>> It depends if MSVC respects that ABI constraint or not.
>> Only if you want to make Wine depend on the compiler used to compile
>> Windows applications. Not all of them are called "MSVC". I know
>> Borland Delphi is used by some these days, and its ABI expectations
>> might be different.
> 
> All other Windows compilers have to respect the ABI as defined by MSVC,
> if only because all the system dlls are built with MSVC.

Well, we don't really know how the system dlls are built, they could 
have different compiler flags and pragmas than the msvcrt, just to 
protect them against this sort of thing (I doubt a system like Delphi 
would really need msvcrt, so it wouldn't have to conform to the MSVC 
ABI, it'd just have to not crash the system DLLs). I don't know, but 
it's a possibility I wouldn't dismiss out of hand.





From julliard at winehq.org  Thu Mar 20 07:40:13 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 Mar 2008 13:40:13 +0100
Subject: The Linux/BSD DF kernel bug
In-Reply-To: <47E257F1.3030604@arcticnet.no> (Ove Kaaven's message of "Thu, 20
	Mar 2008 13:26:25 +0100")
References: <alpine.DEB.1.00.0803191548420.32540@amboise.dolphin>
	<47E1EE17.7090002@arcticnet.no> <877ifxspvj.fsf@wine.dyndns.org>
	<47E23D89.2030309@arcticnet.no> <87y78dr6nl.fsf@wine.dyndns.org>
	<47E252B6.9060207@arcticnet.no> <87k5jxr3vl.fsf@wine.dyndns.org>
	<47E257F1.3030604@arcticnet.no>
Message-ID: <87d4ppr2ky.fsf@wine.dyndns.org>

Ove Kaaven <ovek at arcticnet.no> writes:

> Alexandre Julliard skrev:
>> All other Windows compilers have to respect the ABI as defined by MSVC,
>> if only because all the system dlls are built with MSVC.
>
> Well, we don't really know how the system dlls are built, they could
> have different compiler flags and pragmas than the msvcrt, just to
> protect them against this sort of thing (I doubt a system like Delphi
> would really need msvcrt, so it wouldn't have to conform to the MSVC
> ABI, it'd just have to not crash the system DLLs). I don't know, but
> it's a possibility I wouldn't dismiss out of hand.

My test with lstrcat demonstrates that this is not the case (lstrcat is
in kernel32, not in msvcrt). I don't see any reason to believe that
msvcrt is built with a different ABI than the rest of the system.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Thu Mar 20 08:00:23 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 20 Mar 2008 14:00:23 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E1ED4B.9000309@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803200213.14491.stefan@codeweavers.com>
	<47E1ED4B.9000309@gmail.com>
Message-ID: <200803201400.24280.stefan@codeweavers.com>

Am Donnerstag, 20. M?rz 2008 05:51:23 schrieb Ivan Gyurdiev:
> It looks to me as if shader_backend is being overloaded for many
> different purposes that are not really related to each other. Typical
> object structure is to group related data an functions in one place, but
> what's happening in shader_backend is that it has no data of its own,
> and it's a vtable routing between different GL extensions with the data
> being scattered across multiple different places.
Yes, you're right, the shader backend does a few things right now. You have to 
see it as something dealing with OpenGL settings, don't see it as something 
talking D3D slang. Maybe renaming it to gl_pipeline_backend would give it a 
more suitable name.

> I think it would be worthwhile to review all of this, and see if this
> organization makes sense.  Why aren't the functions grouped together
> with the data ? Why is some of the data in the device object ? Why are
> functions managing different data containers in the same vtable ?
Henri once suggested making the shader_backend_t structure a COM object, that 
is created and destroyed by the device. That would make the state of the data 
it manages clearer(belongs to the shader object), though it would add some 
stuff we don't need, like the IUnknown parts, refcounting. If we did that we 
could call the "shader function routing" "inheritance" and are well within 
OOP slang again.

Keep in mind though that a D3DDevice is a conglomerate of many different 
things(fixed function, shaders, evaluators, resource management, ...), and 
many of the critiques you mentioned apply to the D3D API as a whole. And even 
if our shader_backend_t is opengl-centric, we can't fully ignore the D3D 
design.

> I am no longer familiar with the details, but there's way too many
> things called "shader" by now - d3d shader, gl shader, this made up
> "shader_backend" that actually does fixed function stuff and represents
> neither.  Maybe it makes sense to create new object types - like a
> 'pipeline', containing a 'vertex processor', 'fragment processor' (not
> necessarily implemented via shaders).  Maybe each of these should have a
> "fixed" and "dynamic" facing d3d API, but attach or detach to the
> pipeline in the same way. Maybe they can have different gl extensions
> "backend" implementing each.
My concern is that if we break up the shader structure into multiple 
objects(e.g. vertex shader handler, pixel shader handler, fixed function 
vertex replacement, fixed function pipeline replacement, depth blit handler, 
pipeline linker), then we'll get simple single objects, but the putting these 
parts together adds more complexity than we save in the first place. Often in 
OOP programs(and other paradigms as well) you don't know what one component 
does without knowing the whole program.


From hverbeet at gmail.com  Thu Mar 20 08:17:56 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Thu, 20 Mar 2008 14:17:56 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803201400.24280.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803200213.14491.stefan@codeweavers.com>
	<47E1ED4B.9000309@gmail.com>
	<200803201400.24280.stefan@codeweavers.com>
Message-ID: <d658b69e0803200617g64128da9ja130cf8a011d4215@mail.gmail.com>

On 20/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Henri once suggested making the shader_backend_t structure a COM object, that
>  is created and destroyed by the device. That would make the state of the data
I never mentioned COM there.


From volker.groeschel at sap.com  Thu Mar 20 08:40:32 2008
From: volker.groeschel at sap.com (Groeschel, Volker)
Date: Thu, 20 Mar 2008 14:40:32 +0100
Subject: Game Performance and Grafik Cards
Message-ID: <1DE958D0164F8043BB57265BB40ACDF7A448DD@dewdfe16.wdf.sap.corp>

Hi,
 
I have read many valuable information from Detlef, Roderick and Stefan
about this topic. Thank you very much for this so far!
 
e.g. 
http://wiki.winehq.org/DirectDraw
http://wiki.winehq.org/UsefulRegistryKeys
 
and some comments in bugzilla.
 
But it is still very hard for me to tell what I need to do to improve
performance. All I have is trial and error.
 
What I'm missing ist some kind of feature list for the different grafic
drivers. It would be very helpfull to have more infomation which
features are supported and how well supported with the most important
drivers and for which cards:
 - RADEON
 - AMD Catalyst
 - Nvidia binary
 
Another thing I'm missing is a guid how I can tell which features my
game needs.
 
Then I could bring this information together and find the best match.
 
Like "your games uses xxx and the driver supports yyy, in this case use
switch zzz for best results".
 
Is there any chance that we can get this in the Wiki?
 
Once this information is available the application maintainers in the
AppDB could start to add recommendations for each game and make it more
easy for beginners as well.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080320/d9f7b1ea/attachment-0001.htm 

From stefan at codeweavers.com  Thu Mar 20 08:46:57 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 20 Mar 2008 14:46:57 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803200617g64128da9ja130cf8a011d4215@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803201400.24280.stefan@codeweavers.com>
	<d658b69e0803200617g64128da9ja130cf8a011d4215@mail.gmail.com>
Message-ID: <200803201446.57709.stefan@codeweavers.com>

Am Donnerstag, 20. M?rz 2008 14:17:56 schrieb H. Verbeet:
> On 20/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> > Henri once suggested making the shader_backend_t structure a COM object,
> > that is created and destroyed by the device. That would make the state of
> > the data
>
> I never mentioned COM there.
On IRC I think you once mentioned making the shader backend an object, and 
since we don't have a C++ compiler anyway I concluded COM. (That was a 
follow-up discussion on the patch that moved the shader backend resources 
into a device instead of using static variables). I'm sorry if I put words in 
your mouth you didn't say.



From hverbeet at gmail.com  Thu Mar 20 09:26:07 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Thu, 20 Mar 2008 15:26:07 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803201446.57709.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803201400.24280.stefan@codeweavers.com>
	<d658b69e0803200617g64128da9ja130cf8a011d4215@mail.gmail.com>
	<200803201446.57709.stefan@codeweavers.com>
Message-ID: <d658b69e0803200726v56aaf604mc37290aaa66afc4@mail.gmail.com>

On 20/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> On IRC I think you once mentioned making the shader backend an object, and
>  since we don't have a C++ compiler anyway I concluded COM. (That was a
In essence an object is just a call table with some data, you don't
really need a C++ compiler for that. (And that specific discussion was
about moving the private data of the shader backend out of the device
and into the backend itself). COM would add a lot of stuff that we
don't really need.


From paul.vriens.wine at gmail.com  Thu Mar 20 09:36:30 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 20 Mar 2008 15:36:30 +0100
Subject: Testing service/driver install via setupapi
Message-ID: <47E2766E.9040605@gmail.com>

Hi,

I'm looking into bug 12030 (http://bugs.winehq.org/show_bug.cgi?id=12030). The 
driver service is not installed by our InstallHinfSection function.

I'm first trying to come up with a test before even trying to do the 
implementation. The question I'm having is whether I should be doing the test 
with InstallHinfSection and/or SetupInstallServicesFromInfSection[Ex]?

The current setupapi tests only test InstallHinfSection. But in the end 
SetupInstallFromInfSection will be called from within InstallHinfSection.

Should I take the same approach for the services piece?. So,

1) Implement in SetupInstallServicesFromInfSection[Ex]
2) Test via InstallHinfSection

-- 
Cheers,

Paul.


From thunderbird2k at gmx.net  Thu Mar 20 09:42:10 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Thu, 20 Mar 2008 15:42:10 +0100
Subject: Game Performance and Grafik Cards
In-Reply-To: <1DE958D0164F8043BB57265BB40ACDF7A448DD@dewdfe16.wdf.sap.corp>
References: <1DE958D0164F8043BB57265BB40ACDF7A448DD@dewdfe16.wdf.sap.corp>
Message-ID: <20080320144210.40360@gmx.net>

> Hi,
>  
> I have read many valuable information from Detlef, Roderick and Stefan
> about this topic. Thank you very much for this so far!
>  
> e.g. 
> http://wiki.winehq.org/DirectDraw
> http://wiki.winehq.org/UsefulRegistryKeys
>  
> and some comments in bugzilla.
>  
> But it is still very hard for me to tell what I need to do to improve
> performance. All I have is trial and error.
>  
> What I'm missing ist some kind of feature list for the different grafic
> drivers. It would be very helpfull to have more infomation which
> features are supported and how well supported with the most important
> drivers and for which cards:
>  - RADEON
>  - AMD Catalyst
>  - Nvidia binary
>  
> Another thing I'm missing is a guid how I can tell which features my
> game needs.
>  
> Then I could bring this information together and find the best match.
>  
> Like "your games uses xxx and the driver supports yyy, in this case use
> switch zzz for best results".
>  
> Is there any chance that we can get this in the Wiki?
>  
> Once this information is available the application maintainers in the
> AppDB could start to add recommendations for each game and make it more
> easy for beginners as well.

I think we want to discourage the use of register settings as much as possible. A lot of users don't understand well what options mean and use bad combinations. We are thinking about detecting the best settings at wine startup using perhaps basic benchmark tests. That would be the best for everyone. Using registry settings you would then be able to override the automatic option.

That's just my opinion.

Roderick
-- 
Psssst! Schon vom neuen GMX MultiMessenger geh?rt?
Der kann`s mit allen: http://www.gmx.net/de/go/multimessenger


From stefan at codeweavers.com  Thu Mar 20 09:45:37 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 20 Mar 2008 15:45:37 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <d658b69e0803200726v56aaf604mc37290aaa66afc4@mail.gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803201446.57709.stefan@codeweavers.com>
	<d658b69e0803200726v56aaf604mc37290aaa66afc4@mail.gmail.com>
Message-ID: <200803201545.37308.stefan@codeweavers.com>

Am Donnerstag, 20. M?rz 2008 15:26:07 schrieb H. Verbeet:
> On 20/03/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> > On IRC I think you once mentioned making the shader backend an object,
> > and since we don't have a C++ compiler anyway I concluded COM. (That was
> > a
>
> In essence an object is just a call table with some data, you don't
> really need a C++ compiler for that. (And that specific discussion was
> about moving the private data of the shader backend out of the device
> and into the backend itself). COM would add a lot of stuff that we
> don't really need.
Agreed. However, I'd rather use COM and have a few simple IUnknown methods 
hanging around that are not used instead of inventing yet another way to 
implement object to keep the code more readable. COM is a well-known scheme, 
so it will keep the code more understandable.

If we use COM and make the state table a per-shader-backend property I'd 
shadow the pointer in the device though, to avoid an extra function call in 
each MarkStateDirty call.


From pure_evil at mail.bg  Thu Mar 20 10:05:51 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Thu, 20 Mar 2008 17:05:51 +0200
Subject: developing hints appreciated
Message-ID: <200803201705.51626.pure_evil@mail.bg>

Folks, I'm working with Dan Kegel on the idea of a winecfg/control panel 
merger; I did a .cpl or two a few days ago, but it seems I didn't quite 
understand the rules of the dev on wine/ or on linux for that matter :(
I need someone to show me the ropes...
Basically, The Toolbox. 
Question 1: I need to mess about with winecfg. I want to compile only 
winecfg.exe so I can immediately see when I made a mistake /rather than 
trying to build the entire source of wine/. What's the console command(s) I 
need to execute in order to get a winecfg.exe or any other single file, 
executable or otherwise out of the source /preferably not overwriting the 
real one in use/?
Question 2: The cpls/any additional executables that have to be added to wine 
have to be in source form (duh!). Any particular quirks I should know about?
Say, example.exe has to be created when wine is built; it goes into "c:
\windows\system32". Is there anything special (some obscure settings?) that 
needs to be done in order for "./tools/wineinstall" and 
then "wineprefixcreate" to create "c:\windows\system32\example.exe" out of 
the source located in "<winesource>/programs/example"?
Sorry if the questions appear newbie-ish :(


From mpartap at gmx.net  Thu Mar 20 11:13:24 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Thu, 20 Mar 2008 17:13:24 +0100
Subject: developing hints appreciated
In-Reply-To: <200803201705.51626.pure_evil@mail.bg>
References: <200803201705.51626.pure_evil@mail.bg>
Message-ID: <47E28D24.1000000@gmx.net>

> but it seems I didn't quite understand the rules of
 > the dev on wine/ or on linux for that matter :(
> I need someone to show me the ropes...
> Basically, The Toolbox. 
Last year THAT was my biggest initial problem as well. There are really a few caveats you will most 
probably hit (seems to me I hit ALL of them at some point *g) so if you do just drop me a message 
and I'll try and help, so is anyone on winehackers and this mailing list.

> Question 1: I need to mess about with winecfg. I want to compile only 
> winecfg.exe so I can immediately see when I made a mistake /rather than 
> trying to build the entire source of wine/. What's the console command(s) I 
> need to execute in order to get a winecfg.exe or any other single file, 
> executable or otherwise out of the source /preferably not overwriting the 
> real one in use/?
Build Wine once, then cd into the directory (i.e. programs/winecfg) and issue a 'make' everytime you 
changed source files, make will only rebuilt those object files and link to the rest of the build. 
Then run wine with
LD_LIBRARY_PATH=/pathtoyourwinetree/libs /pathtoyourwinetree/wine something.exe... here's an example 
from a shell script I used during development:
make; WINEDEBUG=loaddll,all,snoop,eng LD_LIBRARY_PATH=/home/google-soc/wine-git/libs \
/home/google-soc/wine-git/wine printfile.exe "Canon PIXMA iP3000" &> printfile.log

> Question 2: The cpls/any additional executables that have to be added to wine 
> have to be in source form (duh!). Any particular quirks I should know about?
> Say, example.exe has to be created when wine is built; it goes into "c:
> \windows\system32". Is there anything special (some obscure settings?) that 
> needs to be done in order for "./tools/wineinstall" and 
I have no clue about that, but here's a hint: the gnu tools are your friends. Study the grep manual 
page.. f.e. grep -nIErC3 'foo[1-9]*' . will recursively (-r) search all non-binary (-I) files within 
the current directory (.) and output any matches like foo42 with three lines of context (-C3) and 
line number (-n). Very very handy working with wine. Also if you have the KDE libs installed, try 
kscope, an incredible useful tool for C-development.

last but not least, compiler messages in quotes fed into a search engine often results in useful 
hints but you may have to dig a bit.. :)
regards, marcel.


From thestig at google.com  Thu Mar 20 11:31:13 2008
From: thestig at google.com (Lei Zhang)
Date: Thu, 20 Mar 2008 09:31:13 -0700
Subject: developing hints appreciated
In-Reply-To: <47E28D24.1000000@gmx.net>
References: <200803201705.51626.pure_evil@mail.bg> <47E28D24.1000000@gmx.net>
Message-ID: <558b2f5c0803200931w35dc8087i31c7fe0bb8901cfe@mail.gmail.com>

On Thu, Mar 20, 2008 at 9:13 AM, Marcel Partap <mpartap at gmx.net> wrote:
> > but it seems I didn't quite understand the rules of
>   > the dev on wine/ or on linux for that matter :(
>  > I need someone to show me the ropes...
>  > Basically, The Toolbox.
>  Last year THAT was my biggest initial problem as well. There are really a few caveats you will most
>  probably hit (seems to me I hit ALL of them at some point *g) so if you do just drop me a message
>  and I'll try and help, so is anyone on winehackers and this mailing list.

Can you be more specific on what the issues are here? Just curious.


From stefan at codeweavers.com  Thu Mar 20 11:21:08 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 20 Mar 2008 17:21:08 +0100
Subject: developing hints appreciated
In-Reply-To: <200803201705.51626.pure_evil@mail.bg>
References: <200803201705.51626.pure_evil@mail.bg>
Message-ID: <200803201721.08898.stefan@codeweavers.com>

Am Donnerstag, 20. M?rz 2008 16:05:51 schrieb pure_evil at mail.bg:
> Question 1: I need to mess about with winecfg. I want to compile only
> winecfg.exe so I can immediately see when I made a mistake /rather than
> trying to build the entire source of wine/. What's the console command(s) I
> need to execute in order to get a winecfg.exe or any other single file,
> executable or otherwise out of the source /preferably not overwriting the
> real one in use/?
I use it mainly as a mesure of saving compile time, so I am not quite sure if 
it does what you want. But you can compile just the programs/winecfg 
subdirectory in the wine source, and run wine via /path/to/winesrc/wine 
winecfg, and it will run your new winecfg program. This saves you the time of 
make checking all directories, as well as the "make install" time.

> Question 2: The cpls/any additional executables that have to be added to
> wine have to be in source form (duh!). Any particular quirks I should know
> about? Say, example.exe has to be created when wine is built; it goes into
> "c: \windows\system32". Is there anything special (some obscure settings?)
> that needs to be done in order for "./tools/wineinstall" and
> then "wineprefixcreate" to create "c:\windows\system32\example.exe" out of
> the source located in "<winesource>/programs/example"?
I think that's done in wine.inf, but I am not sure. Wine itself does not need 
anything in C:\windows\system32, this is mainly done for Windows applications 
that check if the file is present and check the version. You do not have to 
put fake DLLs in there for wine-private things.




From dank at kegel.com  Thu Mar 20 12:11:15 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 10:11:15 -0700
Subject: developing hints appreciated
Message-ID: <a71bd89a0803201011r1efea1b2m3aec77f2de9d06bf@mail.gmail.com>

I think he's a windows developer, comfortable mostly
with IDEs like Visual C++.  He'd like to build winecfg
as a .exe on Wine, test it there, and also try running
it on Windows (at least part of it should kinda work there).

Here's what I told him:

On Ubuntu, 'sudo apt-get install mingw' should install a good compiler.
However, it might not be easy to build winecfg with mingw.
Ask on wine-devel if you have trouble.  See also
http://wiki.winehq.org/JohnKlehm
http://www.winehq.org/pipermail/wine-devel/2006-December/053069.html
If I were you, I'd just use Wine's normal build system on linux
and not even try to generate .exe's for now.
- Dan


From maxspamemail at gmail.com  Thu Mar 20 13:21:25 2008
From: maxspamemail at gmail.com (Max99x)
Date: Thu, 20 Mar 2008 11:21:25 -0700 (PDT)
Subject: GSoC: reg.exe
Message-ID: <16185690.post@talk.nabble.com>


Greetings,

I've noticed Wine is participating in GSoC and one of the ideas is an OSS
implementation of reg.exe. I'm very interested in working on this project,
but looking around the list it seems the stub was posted only a few days
ago, and the author is willing to work on it in the future (I believe a
patch was added even today). Does that mean the project is no longer free
for grabs?
-- 
View this message in context: http://www.nabble.com/GSoC%3A-reg.exe-tp16185690p16185690.html
Sent from the Wine - Devel mailing list archive at Nabble.com.



From austinenglish at gmail.com  Thu Mar 20 14:32:23 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 20 Mar 2008 14:32:23 -0500
Subject: Website: Update PC-BSD download link and icon
Message-ID: <b6bb06270803201232x3da43d5qf2ee629757516c0a@mail.gmail.com>

Any reason this patch wasn't applied?

http://www.winehq.org/pipermail/wine-patches/2008-March/051747.html


From m.b.lankhorst at gmail.com  Thu Mar 20 15:34:21 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 20 Mar 2008 13:34:21 -0700
Subject: quartz: Replace second EnterCriticalSection with
	LeaveCriticalSection (Smatch).
In-Reply-To: <20080320201527.GA18245@redhat.com>
References: <20080320201527.GA18245@redhat.com>
Message-ID: <b130c85e0803201334m30cd87c0w2ec50353a9382081@mail.gmail.com>

Hi Michael,

2008/3/20, Michael Stefaniuc <mstefani at redhat.de>:
>  This looks like an cut'n'paste error to me.
>
>  -    EnterCriticalSection(This->crst);
>  +    LeaveCriticalSection(This->crst);
Many thanks for catching that!

Cheers,
Maarten.


From dank at kegel.com  Thu Mar 20 16:45:47 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 14:45:47 -0700
Subject: GSoC: reg.exe
Message-ID: <a71bd89a0803201445k65ab0bbfi32a138341a8a16ca@mail.gmail.com>

> [Somebody is already working on reg.exe.]
> Does that mean the project is no longer free for grabs?

It depends.  The SoC staff frown on joint projects, but
it's possible.  I would suggest looking at other useful
commandline utilities (see e.g. the list at
http://commandwindows.com ) and check wine's bugzilla
to see if any have been requested, and then propose those.
- Dan


From julliard at winehq.org  Thu Mar 20 17:28:50 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 Mar 2008 23:28:50 +0100
Subject: loader: more stringent sanity check
In-Reply-To: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	(Dan Kegel's message of "Thu, 20 Mar 2008 14:15:18 -0700")
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
Message-ID: <87wsnxowrh.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> +    if (!strcmp( argv[1], "--nosanitycheck" ))
> +    {
> +        perform_sanity_check = 0;
> +
> +        /* Delete --nosanitycheck from argv */
> +
> +        /* Size of argv before is argc +1 for argv[0], +1 for argv[argc]=0 */
> +        /* Size of argv afterwards is one less */
> +        argv = malloc((argc + 1) * sizeof (char *));	
> +        argv[0] = (*pargv)[0];
> +        memcpy(argv+1, *pargv + 2, argc * sizeof(char *));  /* final 0, too */
> +        argc--;
> +        *pargc = argc;
> +        *pargv = argv;
> +    }
> +
> +    if (perform_sanity_check && !geteuid())
> +    {
> +        fprintf( stderr, "%s\n%s\n",
> +          "Please don't run wine as root!  See http://wiki.winehq.org/NoRoot",
> +           usage );
> +        exit(1);
> +    }

I hope you are not seriously suggesting that we do this...

I'm not at all convinced that we need even a warning, there doesn't seem
to be much concrete evidence that running as root is actually harmful,
and it's necessary in many cases. Refusing to run is clearly not an
option.

If we really need to have something then it should be at most a one-time
warning (in a message box so people have a chance to see it) at
wineprefixcreate time, with an easy way to disable it.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Thu Mar 20 17:41:00 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 15:41:00 -0700
Subject: loader: more stringent sanity check
In-Reply-To: <87wsnxowrh.fsf@wine.dyndns.org>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
Message-ID: <a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>

On Thu, Mar 20, 2008 at 3:28 PM, Alexandre Julliard <julliard at winehq.org> wrote:
>  I hope you are not seriously suggesting that we do this...

Seriously.

>  I'm not at all convinced that we need even a warning, there doesn't seem
>  to be much concrete evidence that running as root is actually harmful,

Many, many newbies are running wine as root without
really needing to.  They are much more likely to screw
up their systems this way.  Are you saying we should stop
advising against this?

>  and it's necessary in many cases. Refusing to run is clearly not an
>  option.

That's why the override is provided.

>  If we really need to have something then it should be at most a one-time
>  warning (in a message box so people have a chance to see it) at
>  wineprefixcreate time, with an easy way to disable it.

Then the newbies will just click past it.
- Dan


From mstefani at redhat.com  Thu Mar 20 17:55:43 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 20 Mar 2008 23:55:43 +0100
Subject: loader: more stringent sanity check
In-Reply-To: <a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
Message-ID: <47E2EB6F.6020401@redhat.com>

Dan Kegel wrote:
> On Thu, Mar 20, 2008 at 3:28 PM, Alexandre Julliard <julliard at winehq.org> wrote:
>>  I hope you are not seriously suggesting that we do this...
> 
> Seriously.
> 
>>  I'm not at all convinced that we need even a warning, there doesn't seem
>>  to be much concrete evidence that running as root is actually harmful,
> 
> Many, many newbies are running wine as root without
> really needing to.  They are much more likely to screw
> up their systems this way.  Are you saying we should stop
> advising against this?
They are working as root. They are screwed already! Though I would keep
the warning.

>>  and it's necessary in many cases. Refusing to run is clearly not an
>>  option.
> 
> That's why the override is provided.
> 
>>  If we really need to have something then it should be at most a one-time
>>  warning (in a message box so people have a chance to see it) at
>>  wineprefixcreate time, with an easy way to disable it.
> 
> Then the newbies will just click past it.
Put in a timer forcing the people to read it for 10 to 20 seconds. If
they click past that and still go on ... *shrug*. Welcome to the real
world: they are screwed already so let them screw them self up a little
bit more if they want. Freedom of choice.

bye
	michael


From dank at kegel.com  Thu Mar 20 18:04:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 16:04:18 -0700
Subject: loader: more stringent sanity check
In-Reply-To: <47E2EB6F.6020401@redhat.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<47E2EB6F.6020401@redhat.com>
Message-ID: <a71bd89a0803201604y3e4fce3cwd536fc03a918ebf4@mail.gmail.com>

On Thu, Mar 20, 2008 at 3:55 PM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>  >>  If we really need to have something then it should be at most a one-time
>  >>  warning (in a message box so people have a chance to see it) at
>  >>  wineprefixcreate time, with an easy way to disable it.
>  >
>  > Then the newbies will just click past it.
>
>  Put in a timer forcing the people to read it for 10 to 20 seconds. If
>  they click past that and still go on ... *shrug*. Welcome to the real
>  world: they are screwed already so let them screw them self up a little
>  bit more if they want.

We want to minimize power user annoyance
while also minimizing newbie system damage
and number of posts in wine-users saying "never run wine as root".

Four ideas are on the table:
- do nothing (but then wine-users is intolerable)
- just tell people in wine-users "don't tell people to not run wine as
root" (but that's poor practice)
- have wine abort (possibly with a gui warning) if run as root without
--nosanitycheck (but that might annoy power users)
- same, but put the check in wineprefixcreate (but newbies might bypass this)

Although I suspect users will just bypass the check if it's
only in wineprefixcreate, I'll code up that approach, it's
better than nothing, and Alexandre might go for it.
- Dan


From butterwell at gmail.com  Thu Mar 20 18:11:44 2008
From: butterwell at gmail.com (Christopher Buck)
Date: Thu, 20 Mar 2008 17:11:44 -0600
Subject: loader: more stringent sanity check
In-Reply-To: <a71bd89a0803201604y3e4fce3cwd536fc03a918ebf4@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<47E2EB6F.6020401@redhat.com>
	<a71bd89a0803201604y3e4fce3cwd536fc03a918ebf4@mail.gmail.com>
Message-ID: <2c95cb3f0803201611w498387a2h98619dc885072c5f@mail.gmail.com>

Strictly speaking, running as root is a OS level issue, not a wine
issue.   That being said, wine is being friendly if it notes the
possible issues with running as root.  That being said, letting the
user know the bypass switch or  when wine doesn't start up right away
is also friendly.

Perhaps we should be telling newbies how run "not as root", but that's
even further into the "it's not a wine issue" territory.

-Buck

On Thu, Mar 20, 2008 at 5:04 PM, Dan Kegel <dank at kegel.com> wrote:
> On Thu, Mar 20, 2008 at 3:55 PM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>  >  >>  If we really need to have something then it should be at most a one-time
>  >  >>  warning (in a message box so people have a chance to see it) at
>  >  >>  wineprefixcreate time, with an easy way to disable it.
>  >  >
>  >  > Then the newbies will just click past it.
>  >
>  >  Put in a timer forcing the people to read it for 10 to 20 seconds. If
>  >  they click past that and still go on ... *shrug*. Welcome to the real
>  >  world: they are screwed already so let them screw them self up a little
>  >  bit more if they want.
>
>  We want to minimize power user annoyance
>  while also minimizing newbie system damage
>  and number of posts in wine-users saying "never run wine as root".
>
>  Four ideas are on the table:
>  - do nothing (but then wine-users is intolerable)
>  - just tell people in wine-users "don't tell people to not run wine as
>  root" (but that's poor practice)
>  - have wine abort (possibly with a gui warning) if run as root without
>  --nosanitycheck (but that might annoy power users)
>  - same, but put the check in wineprefixcreate (but newbies might bypass this)
>
>  Although I suspect users will just bypass the check if it's
>  only in wineprefixcreate, I'll code up that approach, it's
>  better than nothing, and Alexandre might go for it.
>  - Dan
>
>
>


From dank at kegel.com  Thu Mar 20 18:21:59 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 16:21:59 -0700
Subject: loader: more stringent sanity check
In-Reply-To: <2c95cb3f0803201611w498387a2h98619dc885072c5f@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<47E2EB6F.6020401@redhat.com>
	<a71bd89a0803201604y3e4fce3cwd536fc03a918ebf4@mail.gmail.com>
	<2c95cb3f0803201611w498387a2h98619dc885072c5f@mail.gmail.com>
Message-ID: <a71bd89a0803201621x1b6fa1d3t82c49367ea0ca3ca@mail.gmail.com>

On Thu, Mar 20, 2008 at 4:11 PM, Christopher Buck <butterwell at gmail.com> wrote:
> Strictly speaking, running as root is a OS level issue, not a wine
> issue.

Wine is a newbie magnet, though; it's what pulls a lot of
Windows users onto this OS.  So it's kind of our fault,
it's best if we clean up the mess at the source...


From marcus at jet.franken.de  Thu Mar 20 18:28:34 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Fri, 21 Mar 2008 00:28:34 +0100
Subject: loader: more stringent sanity check
In-Reply-To: <a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
Message-ID: <20080320232833.GA5617@galeere>

On Thu, Mar 20, 2008 at 03:41:00PM -0700, Dan Kegel wrote:
> On Thu, Mar 20, 2008 at 3:28 PM, Alexandre Julliard <julliard at winehq.org> wrote:
> >  I hope you are not seriously suggesting that we do this...
> 
> Seriously.
> 
> >  I'm not at all convinced that we need even a warning, there doesn't seem
> >  to be much concrete evidence that running as root is actually harmful,
> 
> Many, many newbies are running wine as root without
> really needing to.  They are much more likely to screw
> up their systems this way.  Are you saying we should stop
> advising against this?

QUestion is ... Why do they do this?

Ciao, Marcus


From dank at kegel.com  Thu Mar 20 18:37:03 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 20 Mar 2008 16:37:03 -0700
Subject: loader: more stringent sanity check
In-Reply-To: <20080320232833.GA5617@galeere>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
Message-ID: <a71bd89a0803201637k3a2bd694xbe74e8a88befb9d4@mail.gmail.com>

On Thu, Mar 20, 2008 at 4:28 PM, Marcus Meissner <marcus at jet.franken.de> wrote:
>  > Many, many newbies are running wine as root without
>  > really needing to.
>
>  QUestion is ... Why do they do this?

They don't know any better...


From thestig at google.com  Thu Mar 20 18:40:00 2008
From: thestig at google.com (Lei Zhang)
Date: Thu, 20 Mar 2008 16:40:00 -0700
Subject: loader: more stringent sanity check
In-Reply-To: <20080320232833.GA5617@galeere>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
Message-ID: <558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>

On Thu, Mar 20, 2008 at 4:28 PM, Marcus Meissner <marcus at jet.franken.de> wrote:
> On Thu, Mar 20, 2008 at 03:41:00PM -0700, Dan Kegel wrote:
>  > On Thu, Mar 20, 2008 at 3:28 PM, Alexandre Julliard <julliard at winehq.org> wrote:
>  > >  I hope you are not seriously suggesting that we do this...
>  >
>  > Seriously.
>  >
>  > >  I'm not at all convinced that we need even a warning, there doesn't seem
>  > >  to be much concrete evidence that running as root is actually harmful,
>  >
>  > Many, many newbies are running wine as root without
>  > really needing to.  They are much more likely to screw
>  > up their systems this way.  Are you saying we should stop
>  > advising against this?
>
>  QUestion is ... Why do they do this?
>
>  Ciao, Marcus
>
>
>

On Ubuntu, you cannot even login as root, they'd have to run "sudo
wine". On many other distros, if you login as root, you'll get a
dialog warning you about it, and the desktop background will be bright
red. Are people going out of their way to run Wine as root?


From austinenglish at gmail.com  Thu Mar 20 19:39:22 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 20 Mar 2008 19:39:22 -0500
Subject: loader: more stringent sanity check
In-Reply-To: <558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
	<558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
Message-ID: <b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>

On Thu, Mar 20, 2008 at 6:40 PM, Lei Zhang <thestig at google.com> wrote:
>  On Ubuntu, you cannot even login as root, they'd have to run "sudo
>  wine". On many other distros, if you login as root, you'll get a
>  dialog warning you about it, and the desktop background will be bright
>  red. Are people going out of their way to run Wine as root?
>

I suspect it's more often people sudo'ing. I haven't tried it, but I
know that Alexandre committed a fix that checks if you're running with
sudo after the inital .wine directory is made, but I'm not sure about
what happens if you do it initially. I.e.,
$ wineprefixcreate
$ sudo wine notepad # gives an error about permissions

but does:

$ rm -rf ~/.wine
$ sudo wine notepad

give the same error (not at home or else I'd check).

Something should be done regardless, I'd personally rather see a gui
warning each time wine is run as root without a switch, but at least
if it is done at wineprefixcreate, then it'll catch most (and the
permissions check should catch those that run sudo on their user's
.wine directory). Those two efforts combined should catch most issues,
IMHO.


From ivg231 at gmail.com  Thu Mar 20 21:07:48 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Thu, 20 Mar 2008 22:07:48 -0400
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803201400.24280.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803200213.14491.stefan@codeweavers.com>
	<47E1ED4B.9000309@gmail.com>
	<200803201400.24280.stefan@codeweavers.com>
Message-ID: <47E31874.4000206@gmail.com>


> Henri once suggested making the shader_backend_t structure a COM object, that 
> is created and destroyed by the device. That would make the state of the data 
> it manages clearer(belongs to the shader object), though it would add some 
> stuff we don't need, like the IUnknown parts, refcounting. If we did that we 
> could call the "shader function routing" "inheritance" and are well within 
> OOP slang again.
>   
Yes, what you are doing is exactly inheritance - whether it's done 
through COM or not doesn't really matter.

However, since there are 3 base things to inherit from (arb, glsl, 
none), you're inheriting each of them and now you have 6 "backends". It 
seems that the base functionality is fairly independent of the derived 
functionality, so that's why I suggested composition over inheritance 
here. I understand you're concerned with linking vertex and fragment 
together - but that should probably go in a separate object.
> My concern is that if we break up the shader structure into multiple 
> objects(e.g. vertex shader handler, pixel shader handler, fixed function 
> vertex replacement, fixed function pipeline replacement, depth blit handler, 
> pipeline linker), then we'll get simple single objects, but the putting these 
> parts together adds more complexity than we save in the first place. Often in 
> OOP programs(and other paradigms as well) you don't know what one component 
> does without knowing the whole program.
>   
Sure, there are always tradeoffs - it's your call, I'm just offering a 
semi-informed opinion :)

I'm sure any approach will be successful in the end, but it will be 
interesting to see how code that's written now scales to GL3, D3D10, 
geometry shaders, and upcoming extensions. In that respect, it seems 
like a good idea to try an ATIfs backend now as a test of the underlying 
framework.

Ivan












From jjmckenzie51 at sprintpcs.com  Thu Mar 20 22:31:36 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Thu, 20 Mar 2008 20:31:36 -0700
Subject: Make XP emulation the default?
In-Reply-To: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>
References: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>
Message-ID: <47E32C18.4070706@sprintpcs.com>

Dan Kegel wrote:
> What would break if we made XP the default windows version in Wine?
>
> I've run into several apps that fail to install unless I change that
> setting lately...
>
>
>   
+1 to making XP the default.  Windows98 and Windows2000 are no longer 
supported by Microsoft, leaving XP as the last supported Windows OS for 
Home Users.

James McKenzie



From wine-devel at kievinfo.com  Thu Mar 20 22:48:31 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Thu, 20 Mar 2008 21:48:31 -0600
Subject: loader: more stringent sanity check
In-Reply-To: <b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>	<87wsnxowrh.fsf@wine.dyndns.org>	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>	<20080320232833.GA5617@galeere>	<558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
	<b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
Message-ID: <47E3300F.4080209@kievinfo.com>

Austin English wrote:
> On Thu, Mar 20, 2008 at 6:40 PM, Lei Zhang <thestig at google.com> wrote:
>>  On Ubuntu, you cannot even login as root, they'd have to run "sudo
>>  wine". On many other distros, if you login as root, you'll get a
>>  dialog warning you about it, and the desktop background will be bright
>>  red. Are people going out of their way to run Wine as root?
>>
> 
> I suspect it's more often people sudo'ing. I haven't tried it, but I
> know that Alexandre committed a fix that checks if you're running with
> sudo after the inital .wine directory is made, but I'm not sure about
> what happens if you do it initially. I.e.,
> $ wineprefixcreate
> $ sudo wine notepad # gives an error about permissions
> 
> but does:
> 
> $ rm -rf ~/.wine
> $ sudo wine notepad
> 
> give the same error (not at home or else I'd check).
> 
> Something should be done regardless, I'd personally rather see a gui
> warning each time wine is run as root without a switch, but at least
> if it is done at wineprefixcreate, then it'll catch most (and the
> permissions check should catch those that run sudo on their user's
> .wine directory). Those two efforts combined should catch most issues,
> IMHO.
> 
> 
GUI warning won't work - in some configurations root does not have $DISPLAY 
defined. So if a users logs in as a normal user then tries to do "sudo wine" 
it will be limited to text terminal only.

That btw is the main reason why we have to stop Wine from being run as a root.

Vitaliy.


From truiken at gmail.com  Fri Mar 21 00:09:36 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 20 Mar 2008 22:09:36 -0700
Subject: Make XP emulation the default?
In-Reply-To: <47E32C18.4070706@sprintpcs.com>
References: <a71bd89a0803170711s7c3a3551x623f0128c7d51ebf@mail.gmail.com>
	<47E32C18.4070706@sprintpcs.com>
Message-ID: <22821af30803202209y74cf2becw4c3fe1a37df1e973@mail.gmail.com>

On Thu, Mar 20, 2008 at 8:31 PM, James McKenzie
<jjmckenzie51 at sprintpcs.com> wrote:
>
> Dan Kegel wrote:
>  > What would break if we made XP the default windows version in Wine?
>  >
>  > I've run into several apps that fail to install unless I change that
>  > setting lately...
>  >
>  >
>  >
>  +1 to making XP the default.  Windows98 and Windows2000 are no longer
>  supported by Microsoft, leaving XP as the last supported Windows OS for
>  Home Users.
>

xp is default in git.

-- 
James Hawkins


From truiken at gmail.com  Fri Mar 21 00:21:11 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 20 Mar 2008 22:21:11 -0700
Subject: [Bug 12131] New: Need a 1.2.0 milestone
In-Reply-To: <bug-12131-11@http.bugs.winehq.org/>
References: <bug-12131-11@http.bugs.winehq.org/>
Message-ID: <22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>

On Thu, Mar 20, 2008 at 9:40 PM,  <wine-bugs at winehq.org> wrote:
> http://bugs.winehq.org/show_bug.cgi?id=12131
>
>            Summary: Need a 1.2.0 milestone
>            Product: WineHQ Bugzilla
>            Version: unspecified
>           Platform: Other
>         OS/Version: other
>             Status: NEW
>           Severity: enhancement
>           Priority: P2
>          Component: bugzilla-unknown
>         AssignedTo: wine-bugs at winehq.org
>         ReportedBy: dank at kegel.com
>
>
>  Please create a 1.2.0 target in bugzilla.
>
>  I've requested it a few times on the mailing list,
>  but it hasn't been created, so I'm trying it
>  on bugzilla now.
>

This is related to the problem, but there needs to be at least one
other bugzilla super-admin.  The only active bugzilla admin I know of
is Jan Zerebecki, and he is not online enough to keep up with the pace
of wine development, especially this close to the 1.0 release.  Who is
in charge of this and can add another super-admin?

-- 
James Hawkins


From xixsimplicityxix at gmail.com  Fri Mar 21 01:45:40 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 21 Mar 2008 01:45:40 -0500
Subject: [Bug 12131] New: Need a 1.2.0 milestone
In-Reply-To: <22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>
References: <bug-12131-11@http.bugs.winehq.org/>
	<22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>
Message-ID: <78a7dad00803202345h725a32c9x4d6c0d64e6566788@mail.gmail.com>

>  This is related to the problem, but there needs to be at least one
>  other bugzilla super-admin.  The only active bugzilla admin I know of
>  is Jan Zerebecki, and he is not online enough to keep up with the pace
>  of wine development, especially this close to the 1.0 release.  Who is
>  in charge of this and can add another super-admin?
>
>  --
>  James Hawkins

Maybe we could keep a list of the admins for wine collab tools on a
wiki page so people would know who to contact about stuff?

http://wiki.winehq.org/WhosWho

--John


From truiken at gmail.com  Fri Mar 21 02:03:09 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 21 Mar 2008 00:03:09 -0700
Subject: [Bug 12131] New: Need a 1.2.0 milestone
In-Reply-To: <78a7dad00803202345h725a32c9x4d6c0d64e6566788@mail.gmail.com>
References: <bug-12131-11@http.bugs.winehq.org/>
	<22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>
	<78a7dad00803202345h725a32c9x4d6c0d64e6566788@mail.gmail.com>
Message-ID: <22821af30803210003i6067e7abn134b0ec72a4b174d@mail.gmail.com>

On Thu, Mar 20, 2008 at 11:45 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> >  This is related to the problem, but there needs to be at least one
>  >  other bugzilla super-admin.  The only active bugzilla admin I know of
>  >  is Jan Zerebecki, and he is not online enough to keep up with the pace
>  >  of wine development, especially this close to the 1.0 release.  Who is
>  >  in charge of this and can add another super-admin?
>  >
>  >  --
>  >  James Hawkins
>
>  Maybe we could keep a list of the admins for wine collab tools on a
>  wiki page so people would know who to contact about stuff?
>
>  http://wiki.winehq.org/WhosWho
>

We know who the admins are.  The issue is that none of the current
super-admins (Jan and Tony that I know of) keep up with wine-devel on
a daily basis.  We need another admin, and this has been the case for
some time.

-- 
James Hawkins


From marcus at jet.franken.de  Fri Mar 21 03:28:18 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Fri, 21 Mar 2008 09:28:18 +0100
Subject: wineprefixcreate: more stringent sanity check (try 2)
In-Reply-To: <a71bd89a0803201725w407d58afre1c56775025ae617@mail.gmail.com>
References: <a71bd89a0803201725w407d58afre1c56775025ae617@mail.gmail.com>
Message-ID: <20080321082818.GB5617@galeere>

On Thu, Mar 20, 2008 at 05:25:12PM -0700, Dan Kegel wrote:
> (Moved check to wineprefixcreate as Alexandre suggested.)
> 
> Many newbies mistakenly run wine as root.  Catch
> this in wineprefixcreate and direct them to the wiki.
> Power users can bypass the check with --nosanitycheck.
> Fixes the remainder of http://bugs.winehq.org/show_bug.cgi?id=10324

> +if [ $do_sanitycheck = 1 ] && [ -w / ]; then 
> +    cat > /tmp/wineprefixcreate.$$.txt <<_EOF

Bad from a security point of view at least, its predictable
and should perhaps be removed later on.

Pass it directly as argument to botyh xmessage and echo I would say.

txt=<<EOL
...here the text ...
EOL

xmessage ... "$txt"

Ciao, Marcus


From marcus at jet.franken.de  Fri Mar 21 03:30:42 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Fri, 21 Mar 2008 09:30:42 +0100
Subject: loader: more stringent sanity check
In-Reply-To: <47E3300F.4080209@kievinfo.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
	<558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
	<b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
	<47E3300F.4080209@kievinfo.com>
Message-ID: <20080321083042.GC5617@galeere>

On Thu, Mar 20, 2008 at 09:48:31PM -0600, Vitaliy Margolen wrote:
> Austin English wrote:
> > On Thu, Mar 20, 2008 at 6:40 PM, Lei Zhang <thestig at google.com> wrote:
> >>  On Ubuntu, you cannot even login as root, they'd have to run "sudo
> >>  wine". On many other distros, if you login as root, you'll get a
> >>  dialog warning you about it, and the desktop background will be bright
> >>  red. Are people going out of their way to run Wine as root?
> >>
> > 
> > I suspect it's more often people sudo'ing. I haven't tried it, but I
> > know that Alexandre committed a fix that checks if you're running with
> > sudo after the inital .wine directory is made, but I'm not sure about
> > what happens if you do it initially. I.e.,
> > $ wineprefixcreate
> > $ sudo wine notepad # gives an error about permissions
> > 
> > but does:
> > 
> > $ rm -rf ~/.wine
> > $ sudo wine notepad
> > 
> > give the same error (not at home or else I'd check).
> > 
> > Something should be done regardless, I'd personally rather see a gui
> > warning each time wine is run as root without a switch, but at least
> > if it is done at wineprefixcreate, then it'll catch most (and the
> > permissions check should catch those that run sudo on their user's
> > .wine directory). Those two efforts combined should catch most issues,
> > IMHO.
> > 
> > 
> GUI warning won't work - in some configurations root does not have $DISPLAY 
> defined. So if a users logs in as a normal user then tries to do "sudo wine" 
> it will be limited to text terminal only.
> 
> That btw is the main reason why we have to stop Wine from being run as a root.

And the question still stands, why they think "sudo root" is necessary for Wine ...

We want to definitely fix the misconception in the users heads / documentation
in the Internet.

eg on http://appdb.winehq.org/objectManager.php?sClass=version&iId=9297&iTestingId=15991
like google just gave me... *sigh*

Ciao, Marcus


From julliard at winehq.org  Fri Mar 21 03:32:30 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 21 Mar 2008 09:32:30 +0100
Subject: loader: more stringent sanity check
In-Reply-To: <a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com> (Dan
	Kegel's message of "Thu, 20 Mar 2008 15:41:00 -0700")
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
Message-ID: <87skykpjdt.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> Many, many newbies are running wine as root without
> really needing to.  They are much more likely to screw
> up their systems this way.  Are you saying we should stop
> advising against this?

I have seen very little evidence that anybody screwed up their system by
running Wine as root, I think that's just paranoia. Of course it's
possible in theory, but you can screw up your system by running 'cat' as
root too, that doesn't mean it needs a warning.

Pretty much the only case I'm aware of is someone's system rebooting
because an app was searching through /proc and triggered the watchdog.
That shouldn't be hard to avoid, and it's really minor compared to the
thousands of people who reboot their box as normal users just by
starting OpenGL.

So yes, I'd say stop the "don't run as root" crusade, and fix the actual
problems that running as root causes, if there are any.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Mar 21 03:37:02 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 21 Mar 2008 09:37:02 +0100
Subject: loader: more stringent sanity check
In-Reply-To: <b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
	(Austin English's message of "Thu, 20 Mar 2008 19:39:22 -0500")
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
	<558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
	<b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
Message-ID: <87od98pj69.fsf@wine.dyndns.org>

"Austin English" <austinenglish at gmail.com> writes:

> I suspect it's more often people sudo'ing. I haven't tried it, but I
> know that Alexandre committed a fix that checks if you're running with
> sudo after the inital .wine directory is made, but I'm not sure about
> what happens if you do it initially. I.e.,
> $ wineprefixcreate
> $ sudo wine notepad # gives an error about permissions
>
> but does:
>
> $ rm -rf ~/.wine
> $ sudo wine notepad
>
> give the same error (not at home or else I'd check).

That's a good point, we could certainly prevent running wineprefixcreate
as root in that case too, that would probably solve most of the
problem. Then people have to explicitly login as root, and in that case
I don't think we want a warning at all.

-- 
Alexandre Julliard
julliard at winehq.org


From maxspamemail at gmail.com  Fri Mar 21 03:41:45 2008
From: maxspamemail at gmail.com (Max99x)
Date: Fri, 21 Mar 2008 01:41:45 -0700 (PDT)
Subject: GSoC: reg.exe
In-Reply-To: <a71bd89a0803201445k65ab0bbfi32a138341a8a16ca@mail.gmail.com>
References: <16185690.post@talk.nabble.com>
	<a71bd89a0803201445k65ab0bbfi32a138341a8a16ca@mail.gmail.com>
Message-ID: <16194940.post@talk.nabble.com>


> [Look at other command line utilities]

Thanks for the advice. So far it seems the stuff on the ConsoleConfiguration
wiki page is the only requested config-related console programs. I'd be
interested in implementing ftype.exe and assoc.exe from the list you linked
to, but when reg.exe is completed, they would become pretty redundant - a
shell script would be able to do the same tasks with much less code.
-- 
View this message in context: http://www.nabble.com/GSoC%3A-reg.exe-tp16185690p16194940.html
Sent from the Wine - Devel mailing list archive at Nabble.com.



From austinenglish at gmail.com  Fri Mar 21 03:44:44 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 21 Mar 2008 03:44:44 -0500
Subject: [Bug 12131] New: Need a 1.2.0 milestone
In-Reply-To: <22821af30803210003i6067e7abn134b0ec72a4b174d@mail.gmail.com>
References: <bug-12131-11@http.bugs.winehq.org/>
	<22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>
	<78a7dad00803202345h725a32c9x4d6c0d64e6566788@mail.gmail.com>
	<22821af30803210003i6067e7abn134b0ec72a4b174d@mail.gmail.com>
Message-ID: <b6bb06270803210144x44f96912q7a1f95a18dbc7f0e@mail.gmail.com>

On Fri, Mar 21, 2008 at 2:03 AM, James Hawkins <truiken at gmail.com> wrote:
>  We know who the admins are.  The issue is that none of the current
>  super-admins (Jan and Tony that I know of) keep up with wine-devel on
>  a daily basis.  We need another admin, and this has been the case for
>  some time.
>
>  --
>  James Hawkins
>
>
>

Correct me if I'm wrong, but I thought Dan also had quite a few
bugzilla privs. If not, he's on wine-devel quite a bit/been around a
while...


From hverbeet at gmail.com  Fri Mar 21 03:50:22 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Fri, 21 Mar 2008 09:50:22 +0100
Subject: d3dx9: Implement D3DXCreateRenderToSurface [PATCH 2/7]
In-Reply-To: <E1JcPs0-0006fy-79@www20.emo.freenet-rz.de>
References: <E1JcPs0-0006fy-79@www20.emo.freenet-rz.de>
Message-ID: <d658b69e0803210150r4e4a2691qbd693c56e343c7ef@mail.gmail.com>

On 20/03/2008, tony.wasserka at freenet.de <tony.wasserka at freenet.de> wrote:
> Just a little note: All functions have been coded using the output of WINEDEBUG="d3d9",
>  i.e. my implementation is doing exactly the same things as the native d3dx9 regarding
>  d3d stuff.
It would probably be better to avoid doing that. It isn't quite the
same as disassembling the native implementation, but in general you
want to avoid looking at how the native implementation is implemented
rather than how it behaves.


From ilia.klimov at gmail.com  Fri Mar 21 03:52:45 2008
From: ilia.klimov at gmail.com (Xanf)
Date: Fri, 21 Mar 2008 11:52:45 +0300
Subject: GSoC'08 - Tools - Scriptable Configuration
Message-ID: <4aa399f00803210152j6885fc52t1b89ec51ba485ac3@mail.gmail.com>

Hello, everyone.
My name is Illya  and I'm interested in taking part in GSoC 2008 for
implementing scriptable configuration for wine.

So I'd liked to discuss it with community.

First of all - why I'm interested in that project?

Currently I'm working as a kind of "software consultant" in my city.
My primary The  primary aim of work  - helping migrating from MS
Windows platform to Linux & Open Source. Unfortunately, a great number
of different applications were written and still heavily used in
companies of my city for Windows. And this is a place where Wine makes
great help.
Need of scriptable configuration is quite critical for helping me
quickly perform standard configuration for some apps, and even more -
make "install packages" which will help users unfamiliar with Wine
quickly run their software.


Now - Why me?
Quite hard question. First of all, I have a personal interest (see
above :) ). Second - now I have strong will and real possibility (as I
estimate) to implement that project. I've looked for projects of
GSoC'07 year ago - and realized that I wasn't ready for them.

Although I'm absolutely new to wine-devel, I've been using Wine (and
no windows at my computer at all) for about a year. I have experience
working on some big projects (it is mangos WoW emulator
(http://mangosproject.org/) and especially ScriptDev2 (scripting
engine for mangos) (http://scriptdev2.com) ). Currently I have strong
skills in reading and understanding code written by others.
I have quite strong C/C++ (mostly C++) skills. I've participated in
ACM contests and received 1 place in Ukraine and we (My team) were in
top-ten in Eastern Europe Region contests.

How I see my future work?
First of all, in short term after this message (possibly on weekend)
if I receive a positive (or at least non-negative response) from
community I plan to create a specification of CLI syntax, which I
expect to be implemented by me, divided in stages to have a
step-by-step working guide. After obtaining community suggestions
that'll become a future work plan for summer. Then I'll spend some
time in wine code reading (I've already have experience in some
"hacking" for my brother's favorite games, but I need some time for
deeper understanding). And after that - the work will start. I expect
to make a weekly "reports" how the work going on, and create a series
of patches for each step defined above.

Thanks for reading probably a bit long letter, and sorry for possibly
bad English - it is far away from my mother tongue.

Best regards,
Illya Klimov


From hverbeet at gmail.com  Fri Mar 21 03:53:53 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Fri, 21 Mar 2008 09:53:53 +0100
Subject: d3dx9: Implement ID3DXRenderToSurface_EndScene [PATCH 6/7]
In-Reply-To: <E1JcQ0Z-00037d-Pp@www19.emo.freenet-rz.de>
References: <E1JcQ0Z-00037d-Pp@www19.emo.freenet-rz.de>
Message-ID: <d658b69e0803210153k474a9761t1de709b0bfbb673c@mail.gmail.com>

On 20/03/2008, tony.wasserka at freenet.de <tony.wasserka at freenet.de> wrote:
> ...and clean up everything again.
>  I have no idea why it's StretchRect and not UpdateSurface or something, but the native dll is doing it like this.
>
>  +        /* The native d3dx9 does a buffer->GetDevice(&bufdev) here.
...and that's pretty much unacceptable.


From austinenglish at gmail.com  Fri Mar 21 03:56:08 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 21 Mar 2008 03:56:08 -0500
Subject: loader: more stringent sanity check
In-Reply-To: <87od98pj69.fsf@wine.dyndns.org>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
	<558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
	<b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
	<87od98pj69.fsf@wine.dyndns.org>
Message-ID: <b6bb06270803210156x37ce054foe4d32c4c45f63d91@mail.gmail.com>

On Fri, Mar 21, 2008 at 3:37 AM, Alexandre Julliard <julliard at winehq.org> wrote:
> "Austin English" <austinenglish at gmail.com> writes:
>
>  > I suspect it's more often people sudo'ing. I haven't tried it, but I
>  > know that Alexandre committed a fix that checks if you're running with
>  > sudo after the inital .wine directory is made, but I'm not sure about
>  > what happens if you do it initially. I.e.,
>  > $ wineprefixcreate
>  > $ sudo wine notepad # gives an error about permissions
>  >
>  > but does:
>  >
>  > $ rm -rf ~/.wine
>  > $ sudo wine notepad

Just tested this:
$ wineprefixcreate
$ sudo wine notepad
Fails with 'wine: /home/austin/.wine is not owned by you'

$ rm -rf ~/.wine
$ sudo wineprefixcreate
$ wine notepad
Fails with 'wine: /home/austin/.wine is not owned by you'

But:
$ rm -rf ~/.wine
$ sudo wine notepad
Works fine. Until you attempt to run wine as a normal user at least...

>  That's a good point, we could certainly prevent running wineprefixcreate
>  as root in that case too, that would probably solve most of the
>  problem. Then people have to explicitly login as root, and in that case
>  I don't think we want a warning at all.

Agreed. IMHO, we should not permit running wineprefixcreate with sudo
(or any other wine commands), but if someone explicitly logs in as
root, they (hopefully) know what they're doing. Running sudo on a
current wine directory already issues a warning. While it may be
paranoia based, I prefer to think of it as a preventative precaution,
since in due time (if measures aren't taken) someone's bound to take a
windows virus and screw up  a *nix machine severely. Might as well
prevent it early (especially well in advance of 1.0.0. It doesn't take
much effort, and prevents a lot of headache.


From hverbeet at gmail.com  Fri Mar 21 03:56:58 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Fri, 21 Mar 2008 09:56:58 +0100
Subject: d3dx9: Implement ID3DXRenderToSurface_OnLostDevice/OnResetDevice
	[PATCH 7/7]
In-Reply-To: <E1JcQ3s-0006Fz-Kp@www13.emo.freenet-rz.de>
References: <E1JcQ3s-0006Fz-Kp@www13.emo.freenet-rz.de>
Message-ID: <d658b69e0803210156o46786a33ua3068f4b0fbac4b3@mail.gmail.com>

On 20/03/2008, tony.wasserka at freenet.de <tony.wasserka at freenet.de> wrote:
> These are not very interesting...
>  On winehackers I was told that under wine the device won't ever get invalid anyways so these patches are just
>  for having the implementation complete.
>
It might be true that on wine the device never becomes invalid, but
that might not always remain true, and IMO our d3dx9 dlls should work
on native win32 as well.


From madscientist343 at gmail.com  Thu Mar 20 15:10:30 2008
From: madscientist343 at gmail.com (Mad Scientist)
Date: Thu, 20 Mar 2008 16:10:30 -0400
Subject: GSoC application
Message-ID: <e8dd149b0803201310v49d88891vcb601615e9eb53fd@mail.gmail.com>

Hello wine-devel,
I would like to submit my GSoC application link:
http://wiki.winehq.org/LouisLadas?action=show
Thanks :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080320/8977ff4f/attachment.htm 

From tony.wasserka at freenet.de  Fri Mar 21 04:10:20 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Fri, 21 Mar 2008 10:10:20 +0100
Subject: Implement ID3DXRenderToSurface*
Message-ID: <E1JcdGW-0001L8-AH@www14.emo.freenet-rz.de>

> It would probably be better to avoid doing that. It isn't quite the
> same as disassembling the native implementation, but in general you
> want to avoid looking at how the native implementation is implemented
> rather than how it behaves.
I have to admit that I didn't think of these kind of things, however for
D3DXCreateRenderToSurface this isn't a problem as all what I got
from the output was that I have to call no d3d functions.

> ...and that's pretty much unacceptable.
I see, this will probably need a fixed patch.

> It might be true that on wine the device never becomes invalid, but
> that might not always remain true, and IMO our d3dx9 dlls should work
> on native win32 as well.
The code should run on native windows, too, though it isn't that well tested.
(IMO there isn't much to test about a few release calls anyways).
Also, ResetDevice is the same as D3DXCreateRenderToSurface,
as it doesn't do anything either.

But thank you for the time you spent on reviewing my patches :)

 Best regards
    Tony




Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain inkl.
http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/index.html



From stefan at codeweavers.com  Fri Mar 21 06:48:27 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 21 Mar 2008 12:48:27 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E31874.4000206@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803201400.24280.stefan@codeweavers.com>
	<47E31874.4000206@gmail.com>
Message-ID: <200803211248.27279.stefan@codeweavers.com>

Am Freitag, 21. M?rz 2008 03:07:48 schrieb Ivan Gyurdiev:
> However, since there are 3 base things to inherit from (arb, glsl,
> none), you're inheriting each of them and now you have 6 "backends". It
> seems that the base functionality is fairly independent of the derived
> functionality, so that's why I suggested composition over inheritance
> here. I understand you're concerned with linking vertex and fragment
> together - but that should probably go in a separate object.
Thinking about it a bit more I am less convinced that having a separate linker 
object is going to work, thanks to the different varying handling.

Shader Model 3.0 and earlier versions have different ways to pass varyings 
from vertex to pixel shader. In the end this means that the pixel shader is 
dependent on the vertex shader. If the vertex shader is a GLSL shader, it can 
read either the builtin varyings or the declared ones, the GLSL vertex shader 
writes both and the driver (should) sort it out. If the vertex shader is not 
a GLSL shader, we can only write to builtin varyings, so a GLSL pixel shader 
has to use different code. Currently the GLSL linking code sorts it out, but 
we have dependencies between vertex and pixel shaders. In the end I think at 
least the linker object has to know way too many things about the shaders, 
and the shaders have to know things about each other.

(The visual tests suggest that the ATI driver on Windows does not handle 
pre-3.0 <-> 3.0 shader varying passing properly, but it is in violation of 
the refrast. While that suggests that games are unlikely to depend on this 
tricky behavior, I do not like the idea of justifying our design with an ATI 
driver bug)


From stefan at codeweavers.com  Fri Mar 21 09:20:09 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 21 Mar 2008 15:20:09 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E31874.4000206@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803201400.24280.stefan@codeweavers.com>
	<47E31874.4000206@gmail.com>
Message-ID: <200803211520.09665.stefan@codeweavers.com>

Am Freitag, 21. M?rz 2008 03:07:48 schrieb Ivan Gyurdiev:
> However, since there are 3 base things to inherit from (arb, glsl,
> none), you're inheriting each of them and now you have 6 "backends".
That's what I got rid of in the newest patches I sent to this list.



From felix at compsoc.nuigalway.ie  Fri Mar 21 09:37:28 2008
From: felix at compsoc.nuigalway.ie (Darragh Bailey)
Date: Fri, 21 Mar 2008 14:37:28 +0000
Subject: loader: more stringent sanity check
In-Reply-To: <b6bb06270803210156x37ce054foe4d32c4c45f63d91@mail.gmail.com>
References: <a71bd89a0803201415n16de449cjd21e09729bfb5446@mail.gmail.com>
	<87wsnxowrh.fsf@wine.dyndns.org>
	<a71bd89a0803201541jf79d677vf6961b9c73b2ef4e@mail.gmail.com>
	<20080320232833.GA5617@galeere>
	<558b2f5c0803201640n4132ab88s48a027c4a55f9b1@mail.gmail.com>
	<b6bb06270803201739i1c9a2afg3dfa3defaa12e00@mail.gmail.com>
	<87od98pj69.fsf@wine.dyndns.org>
	<b6bb06270803210156x37ce054foe4d32c4c45f63d91@mail.gmail.com>
Message-ID: <20080321143728.GB23806@compsoc.nuigalway.ie>

On Fri, Mar 21, 2008 at 03:56:08AM -0500, Austin English wrote:
> On Fri, Mar 21, 2008 at 3:37 AM, Alexandre Julliard <julliard at winehq.org> wrote:
<snipped>
> >  That's a good point, we could certainly prevent running wineprefixcreate
> >  as root in that case too, that would probably solve most of the
> >  problem. Then people have to explicitly login as root, and in that case
> >  I don't think we want a warning at all.
> 
> Agreed. IMHO, we should not permit running wineprefixcreate with sudo
> (or any other wine commands), but if someone explicitly logs in as
> root, they (hopefully) know what they're doing. Running sudo on a
> current wine directory already issues a warning. While it may be
> paranoia based, I prefer to think of it as a preventative precaution,
> since in due time (if measures aren't taken) someone's bound to take a
> windows virus and screw up  a *nix machine severely. Might as well
> prevent it early (especially well in advance of 1.0.0. It doesn't take
> much effort, and prevents a lot of headache.


I recall seeing an application intended to be run only by normal user
popping up a warning message if started by root. If I recall correctly
it didn't prevent the app from running, but was just a warning against
running the app as root unless you really, really have a good reason to,
with a timer for a couple of seconds to allow the user to abort the
opperation. If the user didn't do anything it would continue on after
timeout.

I think that would help avoid a lot users unnecessarily running wine as
root. It would also get the message out that it's not necessary.

-- 
Darragh

"Nothing is foolproof to a sufficiently talented fool."


From dank at kegel.com  Fri Mar 21 09:51:25 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 21 Mar 2008 07:51:25 -0700
Subject: [Bug 12131] New: Need a 1.2.0 milestone
In-Reply-To: <b6bb06270803210144x44f96912q7a1f95a18dbc7f0e@mail.gmail.com>
References: <bug-12131-11@http.bugs.winehq.org/>
	<22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>
	<78a7dad00803202345h725a32c9x4d6c0d64e6566788@mail.gmail.com>
	<22821af30803210003i6067e7abn134b0ec72a4b174d@mail.gmail.com>
	<b6bb06270803210144x44f96912q7a1f95a18dbc7f0e@mail.gmail.com>
Message-ID: <a71bd89a0803210751u16074ebct853ba1871e7327bd@mail.gmail.com>

On Fri, Mar 21, 2008 at 1:44 AM, Austin English <austinenglish at gmail.com> wrote:
> On Fri, Mar 21, 2008 at 2:03 AM, James Hawkins <truiken at gmail.com> wrote:
>  >  We know who the admins are.  The issue is that none of the current
>  >  super-admins (Jan and Tony that I know of) keep up with wine-devel on
>  >  a daily basis.  We need another admin, and this has been the case for
>  >  some time.
>
>  Correct me if I'm wrong, but I thought Dan also had quite a few
>  bugzilla privs. If not, he's on wine-devel quite a bit/been around a
>  while...

Jan says I've got privs.  Now if somebody would only show me
how to use them :-)


From ivg231 at gmail.com  Fri Mar 21 10:22:41 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Fri, 21 Mar 2008 11:22:41 -0400
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <200803211248.27279.stefan@codeweavers.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803201400.24280.stefan@codeweavers.com>
	<47E31874.4000206@gmail.com>
	<200803211248.27279.stefan@codeweavers.com>
Message-ID: <47E3D2C1.5020000@gmail.com>


> Shader Model 3.0 and earlier versions have different ways to pass varyings 
> from vertex to pixel shader. In the end this means that the pixel shader is 
> dependent on the vertex shader. If the vertex shader is a GLSL shader, it can 
> read either the builtin varyings or the declared ones, the GLSL vertex shader 
> writes both and the driver (should) sort it out. If the vertex shader is not 
> a GLSL shader, we can only write to builtin varyings, so a GLSL pixel shader 
> has to use different code. Currently the GLSL linking code sorts it out, but 
> we have dependencies between vertex and pixel shaders. In the end I think at 
> least the linker object has to know way too many things about the shaders, 
> and the shaders have to know things about each other.
>   
You mean the code in generate_param_reoder_function ? That's exactly the 
kind of thing that should go in a "linker" object - it takes as input a 
vertex and pixel shader, and handles how they talk to each other.  The 
"semantics" map is the interface between them that describes varyings - 
of course the interface has to be available to the linker to read the 
vertex outputs and make decisions as to the pixel inputs . Your "linker" 
could be backend-independent and try to support odd combinations like  
software vs / glsl ps or something like that, or it could be 
glsl-specific, and basically know how to link one glsl vertex shader to 
one glsl pixel shader (you could use a different linker for other things).

Why is the vertex/pixel linkage related to how you generated the vertex 
(or pixel) shader ? Does it matter if your shader was created from the 
fixed or programmable interface on the d3d-side in order to link it to 
the other one?

How will geometry shaders fit into the picture ?

Ivan



From stefan at codeweavers.com  Fri Mar 21 10:40:14 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 21 Mar 2008 16:40:14 +0100
Subject: [4/22] WineD3D: A shader backend descriptor for the ati fragment
	shader backend
In-Reply-To: <47E3D2C1.5020000@gmail.com>
References: <200803162204.44168.stefan@codeweavers.com>
	<200803211248.27279.stefan@codeweavers.com>
	<47E3D2C1.5020000@gmail.com>
Message-ID: <200803211640.15141.stefan@codeweavers.com>

Am Freitag, 21. M?rz 2008 16:22:41 schrieb Ivan Gyurdiev:
> > Shader Model 3.0 and earlier versions have different ways to pass
> > varyings from vertex to pixel shader. In the end this means that the
> > pixel shader is dependent on the vertex shader. If the vertex shader is a
> > GLSL shader, it can read either the builtin varyings or the declared
> > ones, the GLSL vertex shader writes both and the driver (should) sort it
> > out. If the vertex shader is not a GLSL shader, we can only write to
> > builtin varyings, so a GLSL pixel shader has to use different code.
> > Currently the GLSL linking code sorts it out, but we have dependencies
> > between vertex and pixel shaders. In the end I think at least the linker
> > object has to know way too many things about the shaders, and the shaders
> > have to know things about each other.
>
> You mean the code in generate_param_reoder_function ?
No, I mean pshader_glsl_input_pack, or rather its callers. As for the 
generate_param_reoder_function you're perfectly right, it is part of the 
linking code.

> Why is the vertex/pixel linkage related to how you generated the vertex
> (or pixel) shader ? Does it matter if your shader was created from the
> fixed or programmable interface on the d3d-side in order to link it to
> the other one?
It matters wether or not the vertex shader writes to the implicit opengl 
varyings(gl_TexCoord[], gl_Color, gl_SecondaryColor, ... in GLSL terms,  
output.* in ARB terms) or custom varyings("varying vec4 foo" in GLSL). If 
both shaders are GLSL, everything's fine, the vertex shader writes to both 
and lets the linker and the driver sort things out. But if the vertex 
processing is non-GLSL(fixed function, ARB or whatever), and the D3D pixel 
shader needs custom varyings(3.0 shader), then the GLSL fragment shader has 
to fetch them from the implicit varyings.


From dank at kegel.com  Fri Mar 21 11:29:22 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 21 Mar 2008 09:29:22 -0700
Subject: GSoC'08 - Tools - Scriptable Configuration
Message-ID: <a71bd89a0803210929p7109c4acu8efc1251c71fcda@mail.gmail.com>

Illya wrote:
>Currently I'm working as a kind of "software consultant" in my city.
>My primary The  primary aim of work  - helping migrating from MS
>Windows platform to Linux & Open Source. Unfortunately, a great number
>of different applications were written and still heavily used in
>companies of my city for Windows. And this is a place where Wine
>makes great help.
>Need of scriptable configuration is quite critical for helping me
>quickly perform standard configuration for some apps, and even more -
>make "install packages" which will help users unfamiliar with Wine
>quickly run their software.

Can you give some examples?

This sounds kind of like the wine-robot, wine-doors, and wpkg.org
efforts.  And there might be a lot of overlap with the
automated application test idea from
http://wiki.winehq.org/SummerOfCode
- Dan


From mpartap at gmx.net  Fri Mar 21 11:44:20 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Fri, 21 Mar 2008 17:44:20 +0100
Subject: developing hints appreciated
In-Reply-To: <558b2f5c0803200931w35dc8087i31c7fe0bb8901cfe@mail.gmail.com>
References: <200803201705.51626.pure_evil@mail.bg> <47E28D24.1000000@gmx.net>
	<558b2f5c0803200931w35dc8087i31c7fe0bb8901cfe@mail.gmail.com>
Message-ID: <47E3E5E4.7090204@gmx.net>

 > Can you be more specific on what the issues are here? Just curious.
Well.. basically everything that goes beyond compiling small one-file programs not using the win32api :)
I have to add that i didn't start hacking wine as first step but built an exe file outside of wine, 
so everything that is managed by the wine build system I had to find out by trial and error 
approach.. cross compiling linker flags, win32isms, pointer stuff, c macro syntax, grasping the nt 
printing subsystem.. it really was a tough way from start to.. well the finish line has yet to be 
crossed. Jesse and me will have to cooperate on getting our work merged into wine 1.1. I haven't 
worked on my code for more then three months and first have to check out a current git and look into 
the changes that went into x11drv and what that means for the eventual implementation of a git engine.
Having said that it was a very difficult thing to do and I am nowhere near personal satisfaction 
about my outcome, it was a great experience and VERY VERY valuable to me. After first being 
introduced to 'real' (complex) programs during the SoC time I am now starting to feel comfortable 
coding and will commit some small code changes to various FOSS projects (wine, kde, vlc, drupal..) 
in the next few months. And wearing that shirt just totally rulez. :D
sincerely,
marcel

-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>




From truiken at gmail.com  Fri Mar 21 12:12:34 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 21 Mar 2008 10:12:34 -0700
Subject: GSoC'08 - Tools - Scriptable Configuration
In-Reply-To: <4aa399f00803210152j6885fc52t1b89ec51ba485ac3@mail.gmail.com>
References: <4aa399f00803210152j6885fc52t1b89ec51ba485ac3@mail.gmail.com>
Message-ID: <22821af30803211012g53c180b0j8e57109c5c49bab7@mail.gmail.com>

On Fri, Mar 21, 2008 at 1:52 AM, Xanf <ilia.klimov at gmail.com> wrote:
> Hello, everyone.
>  My name is Illya  and I'm interested in taking part in GSoC 2008 for
>  implementing scriptable configuration for wine.
>
>  So I'd liked to discuss it with community.
>
>  First of all - why I'm interested in that project?
>
>  Currently I'm working as a kind of "software consultant" in my city.
>  My primary The  primary aim of work  - helping migrating from MS
>  Windows platform to Linux & Open Source. Unfortunately, a great number
>  of different applications were written and still heavily used in
>  companies of my city for Windows. And this is a place where Wine makes
>  great help.
>

Are you a student at a university?

-- 
James Hawkins


From ken at codeweavers.com  Fri Mar 21 12:41:17 2008
From: ken at codeweavers.com (Ken Thomases)
Date: Fri, 21 Mar 2008 12:41:17 -0500
Subject: winex11.drv: Indirection level fix
In-Reply-To: <200803211530.01744.andrew.talbot@talbotville.com>
References: <200803211530.01744.andrew.talbot@talbotville.com>
Message-ID: <96B08A1C-F87E-4846-A4DD-FA78057EFD03@codeweavers.com>

On Mar 21, 2008, at 10:30 AM, Andrew Talbot wrote:
> It seems that either "packet" should not be a WTPACKET **, or the  
> first
> parameter to the memcpy() should be *packet. Unable to find this  
> function being
> used anywhere, I guessed the former.

It's used in dlls/wintab32/wintab32.c via pGetCurrentPacket and you  
appear to have guessed correctly.

Cheers,
Ken


From raccoonone at procyongames.com  Fri Mar 21 14:16:55 2008
From: raccoonone at procyongames.com (Christopher)
Date: Fri, 21 Mar 2008 12:16:55 -0700
Subject: AppDB?
Message-ID: <47E409A7.1060209@procyongames.com>

Who's in charge of AppDB? I sent in a couple requests a week ago, and 
they still haven't been approved (or denied). The first was for a new 
application, PhoenixRC, which I'll be happy to maintain. And the other 
was for a new vendor, Mozy, Inc., so that I could update MozyHome to 
have the correct vendor.
Christopher


From dank at kegel.com  Fri Mar 21 16:13:10 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 21 Mar 2008 14:13:10 -0700
Subject: GSoC application
Message-ID: <a71bd89a0803211413y297794bcs63f4e248cbd4da5e@mail.gmail.com>

> I would like to submit my GSoC application link:
> http://wiki.winehq.org/LouisLadas

Hi Louis,
you should probably look for a couple backup apps to
implement as I suggested to the other applicant here:
http://winehq.org/pipermail/wine-devel/2008-March/063828.html

Have you already built wine from source?

Also, no reason to wait for SoC to start; you should
consider submitting patches ahead of time,
it'll help you ramp up.
- Dan


From Andrew.Talbot at talbotville.com  Fri Mar 21 16:16:36 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Fri, 21 Mar 2008 21:16:36 +0000
Subject: winex11.drv: Indirection level fix
References: <200803211530.01744.andrew.talbot@talbotville.com>
	<96B08A1C-F87E-4846-A4DD-FA78057EFD03@codeweavers.com>
Message-ID: <fs18jk$hsf$1@ger.gmane.org>

Ken Thomases wrote:

> It's used in dlls/wintab32/wintab32.c via pGetCurrentPacket and you
> appear to have guessed correctly.
> 
> Cheers,
> Ken

Looking good! Thanks for this, Ken.

-- 
Andy.



From stefan at codeweavers.com  Fri Mar 21 16:58:16 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 21 Mar 2008 22:58:16 +0100
Subject: 5/6 WineD3D: CheckDeviceFormat texture
In-Reply-To: <20080321210717.191010@gmx.net>
References: <20080321210717.191010@gmx.net>
Message-ID: <200803212258.16824.stefan@codeweavers.com>

Am Freitag, 21. M?rz 2008 22:07:17 schrieb Roderick Colenbrander:
> Hi,
>
> Don't continue with CheckDeviceFormat if a texture format isn't around.
What happens with volumetextures here?


From stefan at codeweavers.com  Fri Mar 21 17:03:01 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 21 Mar 2008 23:03:01 +0100
Subject: 6/6 WineD3D: CheckDeviceFormat remove dead code
In-Reply-To: <20080321211148.191010@gmx.net>
References: <20080321211148.191010@gmx.net>
Message-ID: <200803212303.01096.stefan@codeweavers.com>

Am Freitag, 21. M?rz 2008 22:11:48 schrieb Roderick Colenbrander:
> I expect a number of other 'fake' regressions like the one regarding srgb
> writing but those can only become visible after this patch.
Note that we perfectly well support srgb writing on all formats if ARB or GLSL 
pixel shaders are supported. We emulate the srgb correction in the shader

Note that this is not 100% there, if the game is using the fixed function 
fragment pipeline we currently have no ARB or GLSL pixel shader which could 
do the gamma correction. However, many games(like HL2) require srgb 
correction, so we should keep it enabled.


From stefan at codeweavers.com  Fri Mar 21 17:04:51 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 21 Mar 2008 23:04:51 +0100
Subject: 7/6 WineD3D: CheckDeviceFormat srgb write support
In-Reply-To: <20080321214905.191020@gmx.net>
References: <20080321214905.191020@gmx.net>
Message-ID: <200803212304.51826.stefan@codeweavers.com>

Am Freitag, 21. M?rz 2008 22:49:05 schrieb Roderick Colenbrander:
> Hi,
>
> This patch adds srgb write support to CheckDeviceFormat. Before we
> implicitly allowed it. Stefan said that we offer it using ARB/GLSL shaders
> when the format is X8R8G8B8 or A8R8G8B8.
Ah, looks like you were faster than I was with replying :-)

Did you check which formats offer srgb writing on Windows? Our pixel shader 
code offers it for all formats, although srgb correction is pretty pointless 
on float buffers


From jeroen.janssen at gmail.com  Fri Mar 21 16:06:24 2008
From: jeroen.janssen at gmail.com (Jeroen Janssen)
Date: Fri, 21 Mar 2008 21:06:24 +0000 (UTC)
Subject: wine + mono instead of .net framework?
Message-ID: <loom.20080321T210200-541@post.gmane.org>

Hi,

I was wondering if it is possible to use mono instead of the (microsoft) .net
framework for windows applications running under wine.

i.e. I have an application that 'requires' .net 2.0, and wants me to install it.
With mono 'installed' it would see that .net 2.0 is "already installed" and just
work ;)

Any thoughts on if this is possible (or even wanted?)

Best regards,

Jeroen Janssen



From xixsimplicityxix at gmail.com  Fri Mar 21 17:40:30 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 21 Mar 2008 17:40:30 -0500
Subject: wine + mono instead of .net framework?
In-Reply-To: <loom.20080321T210200-541@post.gmane.org>
References: <loom.20080321T210200-541@post.gmane.org>
Message-ID: <78a7dad00803211540s4c3e0d17nd2fb29ea8cf63da6@mail.gmail.com>

On Fri, Mar 21, 2008 at 4:06 PM, Jeroen Janssen
<jeroen.janssen at gmail.com> wrote:
> Hi,
>
>  I was wondering if it is possible to use mono instead of the (microsoft) .net
>  framework for windows applications running under wine.
>
>  i.e. I have an application that 'requires' .net 2.0, and wants me to install it.
>  With mono 'installed' it would see that .net 2.0 is "already installed" and just
>  work ;)
>
>  Any thoughts on if this is possible (or even wanted?)
>

Sure is. Simplest way is to grab the win32 installer from the mono page:
http://www.go-mono.com/mono-downloads/download.html

Tracked in appdb here:
http://appdb.winehq.org/objectManager.php?sClass=application&iId=4982

Or if you have winetricks it supports installing mono too:
http://wiki.winehq.org/winetricks

--John


From jan.wine at zerebecki.de  Fri Mar 21 17:59:40 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Fri, 21 Mar 2008 23:59:40 +0100
Subject: GSoC: reg.exe
In-Reply-To: <a71bd89a0803201445k65ab0bbfi32a138341a8a16ca@mail.gmail.com>
References: <a71bd89a0803201445k65ab0bbfi32a138341a8a16ca@mail.gmail.com>
Message-ID: <20080321225940.GL3557@crissy.swd.zerebecki.de>

On Thu, Mar 20, 2008 at 02:45:47PM -0700, Dan Kegel wrote:
> > [Somebody is already working on reg.exe.]
> > Does that mean the project is no longer free for grabs?
> It depends.  The SoC staff frown on joint projects, but
> it's possible.

It seem that Andrew Riedi, the author of the reg.exe stub woun't
participate in this years GSoC and is willing to leave work to a
GSoC student. I suppose that can be cleanly enough separated so
that it couldn't be seen as a joint project anymore than the
whole Wine itself.

I have no idea how much work there is in a reg.exe
implementation... but if there is (or will be) enough left that
means this project is still free.


Jan



From thunderbird2k at gmx.net  Fri Mar 21 18:06:26 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sat, 22 Mar 2008 00:06:26 +0100
Subject: 5/6 WineD3D: CheckDeviceFormat texture
In-Reply-To: <200803212258.16824.stefan@codeweavers.com>
References: <20080321210717.191010@gmx.net>
	<200803212258.16824.stefan@codeweavers.com>
Message-ID: <20080321230626.106920@gmx.net>

> > Hi,
> >
> > Don't continue with CheckDeviceFormat if a texture format isn't around.
> What happens with volumetextures here?
> 
This is already handled for Volume textures.

Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.gmx.net/de/entertainment/games/free


From thunderbird2k at gmx.net  Fri Mar 21 18:20:05 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sat, 22 Mar 2008 00:20:05 +0100
Subject: 7/6 WineD3D: CheckDeviceFormat srgb write support
In-Reply-To: <200803212304.51826.stefan@codeweavers.com>
References: <20080321214905.191020@gmx.net>
	<200803212304.51826.stefan@codeweavers.com>
Message-ID: <20080321232005.106920@gmx.net>

> > Hi,
> >
> > This patch adds srgb write support to CheckDeviceFormat. Before we
> > implicitly allowed it. Stefan said that we offer it using ARB/GLSL
> shaders
> > when the format is X8R8G8B8 or A8R8G8B8.
> Ah, looks like you were faster than I was with replying :-)
> 
> Did you check which formats offer srgb writing on Windows? Our pixel
> shader 
> code offers it for all formats, although srgb correction is pretty
> pointless 
> on float buffers
> 

The geforce7/8 offer it on R5G6B5 and the *8R8G8B8 formats. Not sure about ati or intel but I think ati at least offers it on 32bit formats.

Roderick
-- 
GMX startet ShortView.de. Hier findest Du Leute mit Deinen Interessen!
Jetzt dabei sein: http://www.shortview.de/?mc=sv_ext_mf at gmx


From austinenglish at gmail.com  Fri Mar 21 19:03:03 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 21 Mar 2008 19:03:03 -0500
Subject: Fun Projects page - needs update
Message-ID: <b6bb06270803211703s43ce8a1cgda7c8c3dbfe83703@mail.gmail.com>

Looking at http://winehq.org/site/fun_projects, A LOT of it is out of
date. I've been looking through the documentation and starting to
update some of it, but this is one I don't know too much about. Would
everyone mind taking a look and updating whatever they know is
fixed/what they're working on/etc. Perhaps we should move this to the
wiki...If not, send me an e-mail and I'll update it for you.

-Austin


From thunderbird2k at gmx.net  Fri Mar 21 18:20:05 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sat, 22 Mar 2008 00:20:05 +0100
Subject: 7/6 WineD3D: CheckDeviceFormat srgb write support
In-Reply-To: <200803212304.51826.stefan@codeweavers.com>
References: <20080321214905.191020@gmx.net>
	<200803212304.51826.stefan@codeweavers.com>
Message-ID: <20080321232005.106920@gmx.net>

> > Hi,
> >
> > This patch adds srgb write support to CheckDeviceFormat. Before we
> > implicitly allowed it. Stefan said that we offer it using ARB/GLSL
> shaders
> > when the format is X8R8G8B8 or A8R8G8B8.
> Ah, looks like you were faster than I was with replying :-)
> 
> Did you check which formats offer srgb writing on Windows? Our pixel
> shader 
> code offers it for all formats, although srgb correction is pretty
> pointless 
> on float buffers
> 

The geforce7/8 offer it on R5G6B5 and the *8R8G8B8 formats. Not sure about ati or intel but I think ati at least offers it on 32bit formats.

Roderick
-- 
GMX startet ShortView.de. Hier findest Du Leute mit Deinen Interessen!
Jetzt dabei sein: http://www.shortview.de/?mc=sv_ext_mf at gmx


From austinenglish at gmail.com  Fri Mar 21 20:19:12 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 21 Mar 2008 20:19:12 -0500
Subject: bug_report.pl
Message-ID: <b6bb06270803211819j7dabbcfek9bec850134c64465@mail.gmail.com>

In cleaning up the documentation, I found that we still reference
tools/bug_report.pl. The script is about 8-9 years old! I haven't seen
it referenced in a while, and looking in the archives, the last time
it was mentioned was in 2002:
http://www.winehq.org/pipermail/wine-devel/2002-May/006741.html

Which even then, some thought it should be removed, or drastically
updated. It currently strips down to 100 lines, which in most cases is
pretty useless. As I see it, there are a couple options (which,
coincidentally, were the same 6 years ago):
1) remove bug_report.pl, update the documentation for more useful debug info
2) have a perl mongerer update it drastically to where it is of some use.

Thoughts?


From truiken at gmail.com  Fri Mar 21 21:12:56 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 21 Mar 2008 19:12:56 -0700
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
In-Reply-To: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
References: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
Message-ID: <22821af30803211912x3929f20bkd446382996a9084a@mail.gmail.com>

On Fri, Mar 21, 2008 at 6:43 PM, Dan Kegel <dank at kegel.com> wrote:
> While investigating a crash in gs-auftrag in bug 9039, noticed
>  WideCharToMultiByte
>  wasn't quite conformant for negative destlen.  Fixed, with tests.
>

> diff --git a/dlls/kernel32/locale.c b/dlls/kernel32/locale.c
> index 1130349..2decf85 100644
> --- a/dlls/kernel32/locale.c
> +++ b/dlls/kernel32/locale.c
> @@ -31,6 +31,7 @@ #include <stdarg.h>
>  #include <stdio.h>
>  #include <ctype.h>
>  #include <stdlib.h>
> +#include <limits.h>
>
>  #ifdef __APPLE__
>  # include <CoreFoundation/CFBundle.h>

Leftover from a previous version of the patch?

-- 
James Hawkins


From dank at kegel.com  Fri Mar 21 22:21:59 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 21 Mar 2008 20:21:59 -0700
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
In-Reply-To: <22821af30803211912x3929f20bkd446382996a9084a@mail.gmail.com>
References: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
	<22821af30803211912x3929f20bkd446382996a9084a@mail.gmail.com>
Message-ID: <a71bd89a0803212021k641a302er1add00f7cf90416c@mail.gmail.com>

On Fri, Mar 21, 2008 at 7:12 PM, James Hawkins <truiken at gmail.com> wrote:
>  > +#include <limits.h>
>
>  Leftover from a previous version of the patch?

Whoops, yes.  I'll resend it Monday.


From kai.blin at gmail.com  Sat Mar 22 03:46:47 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Sat, 22 Mar 2008 09:46:47 +0100
Subject: Wine1.0 and LGPLv3?
In-Reply-To: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>
References: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>
Message-ID: <200803220946.51144.kai.blin@gmail.com>

On Wednesday 19 March 2008 15:01:54 Ian Macfarlane wrote:
> Just to resurrect this topic, as last time, of the responses to my email,
> two were positive (and the other just pointed out that I'd mistaken the
> Samba licensing for LGPL instead of GPL) but nothing else happened after
> that.

I think the agreement from WineConf 2007 was to change as soon as there's a 
reason to do so. So far it seems like there isn't.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080322/5c63c150/attachment.pgp 

From julliard at winehq.org  Sat Mar 22 07:20:39 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 22 Mar 2008 13:20:39 +0100
Subject: quartz: Parse audio packets in mpeg splitter to obtain the
	duration
In-Reply-To: <b130c85e0803211853p664f6370mc30129f853665fa5@mail.gmail.com>
	(Maarten Lankhorst's message of "Fri, 21 Mar 2008 18:53:25 -0700")
References: <b130c85e0803211853p664f6370mc30129f853665fa5@mail.gmail.com>
Message-ID: <87ve3frluw.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> +    /* Destination sample should contain no data! But the source sample should */
> +    assert(!dlen);
> +    assert(*flen);

Are all these asserts really internal code invariants?  It seems to me
they could be triggered by invalid input data, and in that case an
assert is not the appropriate response.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Sat Mar 22 09:21:05 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 22 Mar 2008 07:21:05 -0700
Subject: wine 1.0 status: T minus 76 days. 87 open bugs.
Message-ID: <a71bd89a0803220721w37dbbb02xd3d6ab2e7ff0eccc@mail.gmail.com>

76 days to go before release.

I'm slowly going through the 1.0 bug list and deferring bugs
that only affect single non-required apps and don't have good analysis
or patches,
or that can't be fixed in time.  e.g. I deferred bug 6971 (Mouse
"escapes" window)
even though lots of people voted for it, simply because it probably
requires changes
in X.

As of now we're down to 87 bugs.  My guess is we'll eventually fix 30
or so of these
(about ten look easy), and the other 57 or so will be deferred.
Here's the list, sorted
by component:

# 	 Comp  	 Votes  	 Summary
5948 	-unknown 	1 	Star Trek: Armada does not install
4971 	-unknown 	3 	Corel Draw 12 demo install fails
12097 	-unknown 	1 	Wine 1.0 should not ship out-of-sync resource translations
5055 	-unknown 	5 	Deleting files from a window in wine doesn't send
them to the Trash
11281 	-unknown 	2 	CJK input many issues
7477 	-unknown 	1 	Uplink demo crashes
7915 	-unknown 	4 	15 of the internal tests of wine fail on Mac OS X
5402 	-unknown 	0 	Trying to run PhotoStitch 3.1
8125 	-unknown 	0 	Marratech 6.1 crashes on start
9916 	-unknown 	5 	"make test" usually fails
5024 	-unknown 	3 	Thief: Deadly Shadows crashes:page fault on read
access to 0x0000040c
7404 	-unknown 	2 	ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
9459 	-unknown 	8 	FIFA 2007 crashes with the recent versions
5061 	-unknown 	5 	Copying from Windows Firefox in Wine and pasting to
Linux OpenOffice pastes metadata as data
5844 	-unknown 	8 	tray minimize
10815 	-unknown 	1 	Cannot drag images into Adobe Photoshop 7 from the
web / desktop
9178 	-unknown 	8 	"hello world" dos program hangs
10147 	-unknown 	0 	Word Viewer 2003 - Tab behavior differs from Windows
9959 	-unknown 	8 	Make wine updates work even if the registry changed
556 	build-en 	2 	Reconcile the Windows and Wine spec files
1114 	comctl32 	2 	Winrar2.90/3.00: Comboex doesn't trigger a event
when you mouse-click in some value of it
10111 	comctl32 	2 	WINEDEBUG=warn+heap "make test" has heap error in
comdlg32/tests/printdlg.c
2493 	comctl32 	1 	Multi-select listview: Shift-arrow up only selects
top two items
9104 	comdlg32 	1 	Pdf-xchange viewer crashes
11681 	directx- 	11 	Add support for video overlay
9030 	directx- 	0 	army men hangs on black screen
5955 	directx- 	6 	DirectDrawCreate crash on non-OpenGL desktop
1347 	directx- 	20 	Screen is wiped/blanked on usage of DirectDraw
5535 	directx- 	16 	Planescape:Torment doesn't work
82 	document 	1 	Stabilize Winelib User Guide Table of Contents
638 	document 	7 	Document Wine debugging channels
9926 	gdi32 	4 	gdi32.dll should not have exported function pointers
6519 	gdi32 	6 	Wine blacks out rotated font bitmap
9771 	gdi32 	37 	Steam Friends doesn't work (fails to render correctly
or refresh)
3270 	gdi32 	12 	Problem with minimized top-level windows
7571 	gdi32 	1 	Accented character glyphs are mixed up with TrueType
fonts (affects e.g. Lotus Notes R5)
9484 	kernel32 	17 	Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
5541 	kernel32 	0 	WriteConsole can't write to stdout; affects e.g.
wsh's cscript's usage message
6526 	kernel32 	1 	Typing Instructor for Kids 2 fails to install
9039 	kernel32 	0 	GS-Auftrag Professional SQL aborts on startup
5351 	kernel32 	8 	Windows Installer 3.1 cannot install because of
non-standard drive labeling
4733 	kernel32 	4 	Get optimized/compressed/packed executables (non-upx) working
7098 	mscoree 	1 	RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
5163 	msi 	11 	Office XP 2002 crashes on installation
8783 	ntdll 	11 	USB serial ports do not work
9356 	ntdll 	5 	Serial communication not working since wine-0.9.33
6607 	ole 	6 	Drag and Drop not working
9942 	ole 	2 	Powerpoint Viewer 2007 crashes opening .pptx files
2539 	ole 	2 	XDND (Drag and drop for X Windows) doesn't copy text
8095 	ole 	0 	PQ Teaching toy crashes
4770 	ole 	2 	BlackBerry Device Manager fails to install under wine
5926 	programs 	0 	Wine does not provide an implementation of winhlp32.exe
4803 	programs 	5 	Steam: not all lnk files are processed into linux shortcuts
6254 	richedit 	3 	Installer infinite loop from rich text error
6095 	shdocvw 	11 	MOTD in counter-strike 1.6 and counter-strike
source does not render
6795 	shdocvw 	0 	Skype 3.0.0.137 Beta dies trying to login in win98, winme mode
9304 	shdocvw 	3 	Temple of Elemental Evil demo doesn't start - gui irresponsive
3546 	shdocvw 	2 	CLSID_InternetShortcut not available...
8898 	shdocvw 	0 	Run Time Error "445": Object doesn't support this
action in Europa Knowledgebase
10905 	shell32 	0 	thinstall firefox demo requires native msvcrt
8439 	shell32 	4 	Visual Studio .NET (7) install fails
9809 	shell32 	4 	Autodesk Revit Architecture 2008 install fails
11742 	shlwapi 	8 	Small .net 1.1 app (FastMD5 1.3) fails to start up
12074 	testcase 	2 	The conformance tests fail on Windows
6604 	tools 	2 	Ship icons for the wine-tools that can be used in .desktop files
8246 	urlmon 	2 	invoking htmlhelp:HtmlHelpW crashes wine
10708 	user32 	21 	Wine lacks support for animated cursors
664 	user32 	5 	The help menu functionality inside programs is broken
(messaging problem)
11431 	user32 	5 	Adobe Photoshop CS2: z-overlay of image containers
3023 	user32 	5 	Orcad - "Place Part" never tries to put down a part
4523 	user32 	5 	Can't copy from Firefox 1.5 and paste into OpenOffice
2 under Wine
3534 	user32 	14 	Systray icons are not transparent...
124 	wineserv 	2 	Review of Wine Server Protocol
10984 	winex11. 	2 	sun jre 5 update 10 installer hangs in 0.9.52
7372 	winex11. 	12 	can't copy and paste between gnome apps eg
openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
5623 	winex11. 	2 	GetAsyncKeyState wrong if querying process doesn't have focus
1990 	winex11. 	1 	modifier keys not released when switching desktop
5828 	winex11. 	23 	Command and Conquer Generals (Zero Hour) doesn't
change the mouse cursor from the default X mouse
11884 	winex11. 	1 	Copy and paste garbage on end
3297 	winex11. 	9 	UpdateWindow() doesn't call XFlush()
11019 	winex11. 	1 	matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
2368 	winex11. 	4 	Wine loses its X-Window when switching to another
virt. desktop in Fvwm
3711 	winsock 	0 	Musicmatch fails to install (missing registry key,
HTTP_HttpOpenRequest() problem)
9787 	winsock 	44 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
10032 	winsock 	1 	Wine must not use unix select() for networking
where there might be high fd's
5625 	winsock 	3 	Wine does not handle internet proxy settings conveniently
12005 	wintab32 	0 	Regression in pressure sensitivity with wizardpen
tablet driver and Photoshop 7


From Andrew.Talbot at talbotville.com  Sat Mar 22 09:57:39 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 22 Mar 2008 14:57:39 +0000
Subject: Richedit regression
References: <200803221454.05287.andrew.talbot@talbotville.com>
Message-ID: <fs36p3$pld$1@ger.gmane.org>

Whoops! Sorry, I meant to send this to Eric [Pouech]. D'oh!

-- 
Andy.




From stefan at codeweavers.com  Sat Mar 22 09:59:13 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 22 Mar 2008 15:59:13 +0100
Subject: Richedit regression
In-Reply-To: <200803221454.05287.andrew.talbot@talbotville.com>
References: <200803221454.05287.andrew.talbot@talbotville.com>
Message-ID: <200803221559.13954.stefan@codeweavers.com>

Am Samstag, 22. M?rz 2008 15:54:05 schrieb Andrew Talbot:
> Hi Eric,
>
> An app I use - Blitzin2 - has a richedit control that used to wrap, and
> since your patch "richedit: Added support for EM_SETTARGETDEVICE with a
> NULL DC"
Wrong mailing list?



From Andrew.Talbot at talbotville.com  Sat Mar 22 10:07:23 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 22 Mar 2008 15:07:23 +0000
Subject: Richedit regression
References: <200803221454.05287.andrew.talbot@talbotville.com>
	<200803221559.13954.stefan@codeweavers.com>
Message-ID: <fs37bb$rlo$1@ger.gmane.org>

Stefan D?singer wrote:

> Am Samstag, 22. M?rz 2008 15:54:05 schrieb Andrew Talbot:
>> Hi Eric,
>>
>> An app I use - Blitzin2 - has a richedit control that used to wrap, and
>> since your patch "richedit: Added support for EM_SETTARGETDEVICE with a
>> NULL DC"
> Wrong mailing list?

Wrong address entirely. My patch-sending autopilot kicked in at the wrong
moment. :)

-- 
Andy.




From dank at kegel.com  Sat Mar 22 11:57:59 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 22 Mar 2008 09:57:59 -0700
Subject: Richedit regression
Message-ID: <a71bd89a0803220957s181da44bh294e840d9ca1de23@mail.gmail.com>

 Andrew Talbot wrote:
> An app I use - Blitzin2 - has a richedit control that used to wrap, and since
>  "richedit: Added support for EM_SETTARGETDEVICE with a NULL DC"
> (http://source.winehq.org/git/wine.git/?a=commit;h=33d7cea120bd7d37175cd5c89aa2a66d5c909f37)
> the text gets truncated, instead.

Yep.  I filed http://bugs.winehq.org/show_bug.cgi?id=12098
a while ago, it hits several apps.  Please append your info there.


From wine-devel at kievinfo.com  Sat Mar 22 12:14:40 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 22 Mar 2008 11:14:40 -0600
Subject: Please add new version 0.9.58 to bugzilla & appdb please
Message-ID: <47E53E80.8080207@kievinfo.com>

Please add new version 0.9.58 to bugzilla & appdb please.

Vitaliy.


From Andrew.Talbot at talbotville.com  Sat Mar 22 12:24:26 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 22 Mar 2008 17:24:26 +0000
Subject: Richedit regression
References: <a71bd89a0803220957s181da44bh294e840d9ca1de23@mail.gmail.com>
Message-ID: <fs3fca$l9t$1@ger.gmane.org>

Dan Kegel wrote:

> Yep.  I filed http://bugs.winehq.org/show_bug.cgi?id=12098
> a while ago, it hits several apps.  Please append your info there.

Done.




From stefan at codeweavers.com  Sat Mar 22 14:04:52 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 22 Mar 2008 20:04:52 +0100
Subject: wined3d: Initialize maxAttribs in case it isn't changed by
	glGetIntegerv.
In-Reply-To: <20080322172852.GA16190@zorkmid.localnetwork>
References: <20080322172852.GA16190@zorkmid.localnetwork>
Message-ID: <200803222004.52603.stefan@codeweavers.com>

Am Samstag, 22. M?rz 2008 18:28:52 schrieb Philip Nilsson:
> My OpenGL implementation (NVIDIA's binary driver, version 169.12)
> returns GL_NO_ERROR in this function, but doesn't change the passed
> value.  Uninitialized maxAttribs might be about 1500000 and thus
> generate a couple hundred megabytes of GL_CHECK_CALL errors.
>
> 16 is what is set if glGetIntegerv returns some error, and is also the
> minimum value required by an implementation.
I've seen this behavior very old drivers(87.xx), but I am kinda puzzled why it 
happens with the new drivers. The patch is OK, but we should investigate why 
the call fails for you


From stefan at codeweavers.com  Sat Mar 22 14:04:52 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 22 Mar 2008 20:04:52 +0100
Subject: wined3d: Initialize maxAttribs in case it isn't changed by
	glGetIntegerv.
In-Reply-To: <20080322172852.GA16190@zorkmid.localnetwork>
References: <20080322172852.GA16190@zorkmid.localnetwork>
Message-ID: <200803222004.52603.stefan@codeweavers.com>

Am Samstag, 22. M?rz 2008 18:28:52 schrieb Philip Nilsson:
> My OpenGL implementation (NVIDIA's binary driver, version 169.12)
> returns GL_NO_ERROR in this function, but doesn't change the passed
> value.  Uninitialized maxAttribs might be about 1500000 and thus
> generate a couple hundred megabytes of GL_CHECK_CALL errors.
>
> 16 is what is set if glGetIntegerv returns some error, and is also the
> minimum value required by an implementation.
I've seen this behavior very old drivers(87.xx), but I am kinda puzzled why it 
happens with the new drivers. The patch is OK, but we should investigate why 
the call fails for you


From pnilsson at nullref.se  Sat Mar 22 14:31:24 2008
From: pnilsson at nullref.se (Philip Nilsson)
Date: Sat, 22 Mar 2008 20:31:24 +0100
Subject: wined3d: Initialize maxAttribs in case it isn't changed by
	glGetIntegerv.
In-Reply-To: <200803222004.52603.stefan@codeweavers.com>
References: <20080322172852.GA16190@zorkmid.localnetwork>
	<200803222004.52603.stefan@codeweavers.com>
Message-ID: <20080322193124.GA18198@zorkmid.localnetwork>

On Sat, Mar 22, 2008 at 08:04:52PM +0100, Stefan D?singer wrote:
> Am Samstag, 22. M?rz 2008 18:28:52 schrieb Philip Nilsson:
> > glGetIntegerv
> I've seen this behavior very old drivers(87.xx), but I am kinda puzzled why it 
> happens with the new drivers. The patch is OK, but we should investigate why 
> the call fails for you

It appears to do nothing whichever enum I query.  It doesn't even care
if it's fed (-1, NULL).

I'll try some things.


From wine-devel at kievinfo.com  Sat Mar 22 15:21:29 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 22 Mar 2008 14:21:29 -0600
Subject: Failing user message sequences
Message-ID: <47E56A49.70602@kievinfo.com>

I've looked at the user32/tests/msg.c and there are some number of tests 
that are set to todo_wine. Conincedentaly number of those tests are a 
biggest problems (looking at bugzilla). For example WmSHOWNATopInvisible 
message sequence is failing on Wine because of absent WM_NCPAINT message. 
Could this be the source of the problem for all those full-screen programs 
that are being "lost" when switching between displays or minimizing / 
restoring windows.

I've tried to track this problem down but can't pinpoint the exact location 
where this masage should be sent. Is Wine missing a step somewhere (see 
attachment)? From what I can tell it should be somewhere between mapping the 
window and WM_WINDOWPOSCHANGED notification.

Also worth noting all the MDI tests that fail on Wine. It seems there are 
fair amount of bugs filed that are related to this tests.

IMHO some if not all of those failing tests should be fixed. This is core 
functionality and there are no excuses for not having it working.

I'd say that is much more important them some bugs listed on 1.0 list.

Vitaliy.
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: SW_SHOWNA.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080322/03472c88/attachment.txt 

From wine-devel at kievinfo.com  Sat Mar 22 15:37:39 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 22 Mar 2008 14:37:39 -0600
Subject: Disable editing/deleting/locking posts in wine-forum
Message-ID: <47E56E13.30307@kievinfo.com>

Jeremy,

Could you disable this functionality? It makes no sense with the link to the 
ML where one can't do that. Or now we are getting some users that think they 
can edit the post and everyone can see that.

Vitaliy.


From gynvael at coldwind.pl  Sat Mar 22 16:05:54 2008
From: gynvael at coldwind.pl (Gynvael Coldwind)
Date: Sat, 22 Mar 2008 22:05:54 +0100
Subject: Hello Email
Message-ID: <bd3a94bf0803221405k482ff7b0l3aac2dbb8d5855aa@mail.gmail.com>

Hello Wine Developers,

My name is Michael "Gynvael Coldwind" Skladnikiewicz, and I am
thinking about applying for the Google SoC to work on Wine. Please
excuse my English, I am not a native English speaker.

The first step written on the Wine Ideas page was -introduction-, so..
a little about myself.
I am currently at the Wroclaw Univeristy of Technology (it's
Politechnika Wroc?awska in Polish) on the faculty of Computer Science
and Management (Wydzia? Informatyki i Zarz?dzania), and my field of
study is Computer Science. I am currently at the first year of the
second degree - I already graduated the first degree, and I have the
right to the degree "in?ynier" (it's equal to BSc). I have graduated
the same University, but another faculty - The Fundamental Problems of
Technology Faculty, where my field of study was also Computer Science.
In addition to being a full-time student, I am also working (remotly)
at Hispasec Sistemat, where I am a malware reverse engineer, a
security researcher and a coder (mostly Windows stuff, both user and
kernel mode). Earlier I have worked at Arcabit, a Polish antivirus
company, where I created static unpackers for common PE
crypters/packers.

I started to code when I was about 7 years old (now I'm 24) on an
Atari 800 XL, and as the time passed I've moved to a PC and started to
code in other languages, like C, C++, Java, Assembler, PHP, and many
others. My personal field of interest is computer security (up to date
I have found some vulnerabilities in Mozilla Firefox, Opera, Blizzard
Starcraft, and few others), reverse engineering, computer graphics
(software rendering algorithms and OpenGL mostly), game developement
(and playing ;>), and OS research (mostly I focus on Microsoft
Windows, but I am also interested in Linux and QNX).
Some of my research papers can be found on http://vexillium.org/ and
http://gynvael.vexillium.org/.

I guess that is enough for introducing myself ;>
If You have any questions, don't hesitate to ask ;>

Best regards,
-- 
gynvael.coldwind//vx

From m.b.lankhorst at gmail.com  Sat Mar 22 18:21:58 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sat, 22 Mar 2008 16:21:58 -0700
Subject: quartz: Parse audio packets in mpeg splitter to obtain the duration
In-Reply-To: <b130c85e0803221620m16c70ad2xc952bc87369d18f@mail.gmail.com>
References: <b130c85e0803211853p664f6370mc30129f853665fa5@mail.gmail.com>
	<87ve3frluw.fsf@wine.dyndns.org>
	<b130c85e0803221620m16c70ad2xc952bc87369d18f@mail.gmail.com>
Message-ID: <b130c85e0803221621j2ebd84d6re958ac0e04ca547a@mail.gmail.com>

Hello Alexandre,

2008/3/22, Alexandre Julliard <julliard at winehq.org>:

> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:
>
>  > +    /* Destination sample should contain no data! But the source sample should */
>  > +    assert(!dlen);
>  > +    assert(*flen);
>
>  Are all these asserts really internal code invariants?  It seems to me
>  they could be triggered by invalid input data, and in that case an
>  assert is not the appropriate response.

They are invariants as far as I know, even with corrupt data. Source
sample has a value because that is the condition of the while loop.
The destination sample is empty because the loop makes the length zero
before handing it over. If it somehow had a length larger or equal to
4 (less then 4 is possible and handled) there is something seriously
wrong in the handling code since this should not happen, even in
invalid input.

Cheers,

Maarten.


From dank at kegel.com  Sat Mar 22 21:32:31 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 22 Mar 2008 19:32:31 -0700
Subject: Hello Email
Message-ID: <a71bd89a0803221932y7231542eledae357b986becc3@mail.gmail.com>

Hi Michael!  Any idea what you'll be proposing for SoC yet?


From raccoonone at procyongames.com  Sat Mar 22 22:08:02 2008
From: raccoonone at procyongames.com (Christopher)
Date: Sat, 22 Mar 2008 20:08:02 -0700
Subject: Adding a vendor to AppDB
Message-ID: <47E5C992.50807@procyongames.com>

I sent an email to appdb at winehq.org <mailto:appdb at winehq.org> asking to 
have the vendor "Mozy, Inc." added. Does anyone check that email 
address? I sent my request over a week ago. If anyone can add it for me, 
please add "Mozy, Inc." url=<http://mozy.com/about>. I'm the new 
MozyHome maintainer and the vendor which is listed is wrong.
Thanks,
Christopher Berner

p.s.
I just noticed that I'm not in the AUTHORS file, even though several of 
my patches have been accepted to Wine. Was I suppose to add myself, or 
is that automatically generated (in which case, why did it leave me out?)


From thestig at google.com  Sat Mar 22 22:53:22 2008
From: thestig at google.com (Lei Zhang)
Date: Sat, 22 Mar 2008 20:53:22 -0700
Subject: Adding a vendor to AppDB
In-Reply-To: <47E5C992.50807@procyongames.com>
References: <47E5C992.50807@procyongames.com>
Message-ID: <558b2f5c0803222053j37d5eeabu87851a63681845e7@mail.gmail.com>

On Sat, Mar 22, 2008 at 8:08 PM, Christopher
<raccoonone at procyongames.com> wrote:
>  p.s.
>  I just noticed that I'm not in the AUTHORS file, even though several of
>  my patches have been accepted to Wine. Was I suppose to add myself, or
>  is that automatically generated (in which case, why did it leave me out?)
>

The authors file gets updated about once a year. I'm sure someone will
update it for Wine 1.0.

http://source.winehq.org/git/wine.git/?a=history;f=AUTHORS;h=b72bfe83251e39beb03de98193b91a8707830388;hb=HEAD


From ns03ja at brocku.ca  Sun Mar 23 01:09:37 2008
From: ns03ja at brocku.ca (Neil Skrypuch)
Date: Sun, 23 Mar 2008 02:09:37 -0400
Subject: developing hints appreciated
In-Reply-To: <47E28D24.1000000@gmx.net>
References: <200803201705.51626.pure_evil@mail.bg> <47E28D24.1000000@gmx.net>
Message-ID: <200803230209.37405.ns03ja@brocku.ca>

On Thursday 20 March 2008, Marcel Partap wrote:
> Then run wine with
> LD_LIBRARY_PATH=/pathtoyourwinetree/libs /pathtoyourwinetree/wine
> something.exe...

I'm pretty sure you don't need to set LD_LIBRARY_PATH there, at least I've 
never needed to (and the wine script appears to do that).

- Neil


From m.b.lankhorst at gmail.com  Sun Mar 23 02:20:42 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 23 Mar 2008 00:20:42 -0700
Subject: C&C :D
Message-ID: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>

Hi all!

After an announcement that the original Command and conquer is
available free for download, I decided to test it. Command and Conquer
works perfectly in wine, I haven't tested network gaming over ipx, but
that will probably not work. For the rest it's flawless, apart from
the losing focus behavior, but playing it in a wine desktop helps.

Remember: KANE IS A TRAITOR! LONG LIVE THE GDI!

Cheers,
Maarten.


From thunderbird2k at gmx.net  Sun Mar 23 03:43:58 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 23 Mar 2008 09:43:58 +0100
Subject: Regression fix in directx.c
In-Reply-To: <47E5C94E.40006@gmail.com>
References: <47E5C94E.40006@gmail.com>
Message-ID: <20080323084358.40360@gmx.net>

> The flag that was removed with the patch in the link here:
> http://source.winehq.org/git/wine.git/?a=blobdiff;f=dlls/wined3d/directx.c;h=6665a4201311af5c494a77c64c43598ac84ca332;hp=1c7d9e397b8b02e7817e4c8142e8a63061a36ae3;hb=9e9ef6238a5f27423e28c8f95f69fb02b98d8f27;hpb=5d151c0ffc60627b1d54ae397a83ef1770491d1b
> caused the game "Sins of a solar empire" to not startup anymore.

This is not the right way to fix it. The code is quite new but works very differently from the old code. What videocard are you using? At what color depth? What offscreen rendering method are you using? Further could you provide your glxinfo output?

Thanks,
Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.gmx.net/de/entertainment/games/free


From thunderbird2k at gmx.net  Sun Mar 23 03:47:30 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 23 Mar 2008 09:47:30 +0100
Subject: C&C :D
In-Reply-To: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
References: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
Message-ID: <20080323084730.40340@gmx.net>

> Hi all!
> 
> After an announcement that the original Command and conquer is
> available free for download, I decided to test it. Command and Conquer
> works perfectly in wine, I haven't tested network gaming over ipx, but
> that will probably not work. For the rest it's flawless, apart from
> the losing focus behavior, but playing it in a wine desktop helps.
> 
> Remember: KANE IS A TRAITOR! LONG LIVE THE GDI!
> 
> Cheers,
> Maarten.
> 

Hi Maarten,

It will likely run better if you use DirectDrawRenderer=opengl + RenderTargetLockMode=readtex (at least on Nvidia hardware that is fast). Second IPX network should work (if this is the c&c version with updated ipx) but you need root as plain users don't have enough permissions to create a raw ipx socket.

Roderick
-- 
GMX startet ShortView.de. Hier findest Du Leute mit Deinen Interessen!
Jetzt dabei sein: http://www.shortview.de/?mc=sv_ext_mf at gmx


From thunderbird2k at gmx.net  Sun Mar 23 04:05:25 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 23 Mar 2008 10:05:25 +0100
Subject: Regression fix in directx.c
In-Reply-To: <20080323084344.40340@gmx.net>
References: <47E5C94E.40006@gmail.com> <20080323084344.40340@gmx.net>
Message-ID: <20080323090525.110830@gmx.net>

> > The flag that was removed with the patch in the link here:
> >
> http://source.winehq.org/git/wine.git/?a=blobdiff;f=dlls/wined3d/directx.c;h=6665a4201311af5c494a77c64c43598ac84ca332;hp=1c7d9e397b8b02e7817e4c8142e8a63061a36ae3;hb=9e9ef6238a5f27423e28c8f95f69fb02b98d8f27;hpb=5d151c0ffc60627b1d54ae397a83ef1770491d1b
> > caused the game "Sins of a solar empire" to not startup anymore.
> 
> This is not the right way to fix it. The code is quite new but works very
> differently from the old code. What videocard are you using? At what color
> depth? What offscreen rendering method are you using? Further could you
> provide your glxinfo output?
> 
> Thanks,
> Roderick

Also have you tried the latest GIT version? As there have been a number of CheckDeviceFormat fixes after .58.

Roderick
-- 
Psssst! Schon vom neuen GMX MultiMessenger geh?rt?
Der kann`s mit allen: http://www.gmx.net/de/go/multimessenger


From dank at kegel.com  Sun Mar 23 06:22:07 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 04:22:07 -0700
Subject: crash on exit in hardy on intel graphics?
Message-ID: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>

Grumble.  wineprefixcreate is showing a crash
while running
rundll32.exe setupapi.dll,InstallHinfSection DefaultInstall 128 wine.inf

No traceback is shown normally, but running that command under winedbg
shows one on exit:

Unhandled exception: page fault on read access to 0x00000200 in 32-bit
code (0xb7f03bad).
Register dump:
 CS:0073 SS:007b DS:007b ES:007b FS:0033 GS:003b
 EIP:b7f03bad ESP:0034fa90 EBP:0034fab8 EFLAGS:00010292(   - 00      -RISA1)
 EAX:b7f0bce0 EBX:b7f0bff4 ECX:b7efe5b9 EDX:b7c5e6ac
 ESI:00000000 EDI:00000000
Stack dump:
0x0034fa90:  b7ef0eec b7f0bff4 0034fae0 7c017834
0x0034faa0:  0034fb14 b7efa059 0034fb5c b7c61ff4
0x0034fab0:  00000000 7c003188 0034fac8 b7c5fcb4
0x0034fac0:  00000000 b7f0bff4 0034fba8 b7efe5d6
0x0034fad0:  00000000 00000000 0034fb38 b7cce2d1
0x0034fae0:  7c003190 7c003198 7c003194 b7c5e6ac
Backtrace:
=>1 0xb7f03bad in ld-linux.so.2 (+0x12bad) (0x0034fab8)
  2 0xb7c5fcb4 GLIBC_2+0xcb4() in libdl.so.2 (0x0034fac8)
  3 0xb7efe5d6 in ld-linux.so.2 (+0xd5d6) (0x0034fba8)
  4 0xb7c602bc in libdl.so.2 (+0x12bc) (0x0034fbc8)
  5 0xb7c5fcea GLIBC_2+0xcea() in libdl.so.2 (0x0034fbd8)
  6 0x7dda57bd in libgl.so.1 (+0x477bd) (0x0034fbf8)
  7 0x7dd8584a in libgl.so.1 (+0x2784a) (0x0034fc18)
  8 0x7dd87924 in libgl.so.1 (+0x29924) (0x0034fc48)
  9 0x7dd80ba4 in libgl.so.1 (+0x22ba4) (0x0034fc58)
  10 0x7ddc39bc glIsRenderbufferEXT+0x16c() in libgl.so.1 (0x0034fc68)
  11 0xb7efefdf in ld-linux.so.2 (+0xdfdf) (0x0034fe18)
  12 0xb7c90f74 exit+0xd4() in libc.so.6 (0x0034fe38)
  13 0x7efacc80 RtlGetCurrentPeb()
[/home/dank/wine-git/dlls/ntdll/process.c:70] in ntdll (0x0034fec8)
  14 0x7ee7d62f ExitProcess+0x2f(status=0x0)
[/home/dank/wine-git/dlls/kernel32/process.c:2046] in kernel32
(0x0034fee8)
  15 0x7ecad3ba __wine_spec_exe_entry+0x6a(peb=0x7ffdf000)
[/home/dank/wine-git/dlls/winecrt0/exe_entry.c:38] in rundll32
(0x0034ff08)
  16 0x7ee7fd4e start_process+0xee(arg=0x0)
[/home/dank/wine-git/dlls/kernel32/process.c:883] in kernel32
(0x0034ffe8)
  17 0xb7de18f7 wine_switch_to_stack+0x17() in libwine.so.1 (0x00000000)
0xb7f03bad: testb       $0x8,0x200(%edi)

libgl.so is involved, so perhaps the is a graphics driver bug?
The system is a thinkpad x60 with intel graphics.  glxgears
gets 960 fps.

Anybody else seeing this?

It seems kind of benign, and doesn't keep 'wine notepad' from working...


From gynvael at coldwind.pl  Sun Mar 23 06:28:52 2008
From: gynvael at coldwind.pl (Gynvael Coldwind)
Date: Sun, 23 Mar 2008 12:28:52 +0100
Subject: Hello Email
In-Reply-To: <5f9140a20803222352t624fdebes9abba31adaf7ddaf@mail.gmail.com>
References: <5f9140a20803221417v154a7e87ree6b61a080d97aca@mail.gmail.com>
	<bd3a94bf0803221430u1864febay9a7e1572dd4d53b@mail.gmail.com>
	<5f9140a20803222352t624fdebes9abba31adaf7ddaf@mail.gmail.com>
Message-ID: <bd3a94bf0803230428n7516d52j7b15e8785d8915fb@mail.gmail.com>

Hello again:

On Sun, Mar 23, 2008 at 3:32 AM, Dan Kegel <dank at kegel.com> wrote:
> Hi Michael!  Any idea what you'll be proposing for SoC yet?
Oh, sorry, I've missclicked and sent the ideas to David only.

I am currently thinking which idea interests me the most. The
following things are currently interesting me the most:
GDI+ - implement missing functions
Tools - Merge winecfg and control panel
DirectPlay - Implement the core protocol
Print Dialog
(from the most interesting to the least).


On Sun, Mar 23, 2008 at 7:52 AM, David Adam <david.adam.cnrs at gmail.com> wrote:
> You need to choose by yourself. Do not ask to us to decide for you. When you
> decided which of part of wine you want to work, please contact a mentor to
> have some indications. Before applicating officialy for a GSoC, you should
> prove that you can achieve some good jobs by sendind patches for wine in the
> area that you decided to work.

Please do not get me wrong, I am not asking You to decide for me, I'm
just asking for Your personal opinion. Don't worry, I'll choose what
to apply for by myself ;>
Anyway, thanks for Your reply, I'll contact the mentors of the
interesting me things.

Best regards,
-- 
gynvael.coldwind//vx


From dank at kegel.com  Sun Mar 23 06:39:12 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 04:39:12 -0700
Subject: Hello Email
In-Reply-To: <bd3a94bf0803230428n7516d52j7b15e8785d8915fb@mail.gmail.com>
References: <5f9140a20803221417v154a7e87ree6b61a080d97aca@mail.gmail.com>
	<bd3a94bf0803221430u1864febay9a7e1572dd4d53b@mail.gmail.com>
	<5f9140a20803222352t624fdebes9abba31adaf7ddaf@mail.gmail.com>
	<bd3a94bf0803230428n7516d52j7b15e8785d8915fb@mail.gmail.com>
Message-ID: <a71bd89a0803230439s8e24207r53b840f4a94618c8@mail.gmail.com>

On Sun, Mar 23, 2008 at 4:28 AM, Gynvael Coldwind <gynvael at coldwind.pl> wrote:
>  I am currently thinking which idea interests me the most. The
>  following things are currently interesting me the most:
>  GDI+ - implement missing functions
>  Tools - Merge winecfg and control panel
>  DirectPlay - Implement the core protocol
>  Print Dialog
>  (from the most interesting to the least).

GDI+, the one you say is most interesting, is
an excellent choice.  Lei and I had good luck
mentoring a group of UCLA students to implement
a bunch of missing GDI+ functions, and there
are tons more to do.  A google search for
  "unimplemented function gdiplus"
finds a dozen or so candidates.
- Dan


From mle+win at mega-nerd.com  Sun Mar 23 06:43:31 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 23 Mar 2008 22:43:31 +1100
Subject: winegcc: A spec file is currently needed in shared mode?
Message-ID: <20080323224331.b79254e9.mle+win@mega-nerd.com>

Hi all,

Any idea what the above means and how to fix it?

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"You can have quality software, or you can have pointer arithmetic;
but you cannot have both at the same time." -- Bertrand Meyer, 1989


From dank at kegel.com  Sun Mar 23 06:45:35 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 04:45:35 -0700
Subject: crash on exit in hardy on intel graphics?
In-Reply-To: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
References: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
Message-ID: <a71bd89a0803230445x32cb370h659dd7c997297db8@mail.gmail.com>

It's not so benign.  Apps fail to start because of this.
The workaround is to run wineprefixcreate by
hand; it still fails, but then when you run wine all is well.

Here's an example of the symptom.  In this case I was
trying to install the photoshop 7 trial without an existing .wine
directory:

wine: Unhandled page fault on read access to 0x00000200 at address
0xb7f28bad (thread 0009), starting debugger...
wine: wineprefixcreate failed while creating '/home/dank/.wine'.
dank at lappy:~/installers/adobe$ wineserver: could not save registry
branch to /home/dank/.wine-AGXTqe/system.reg : No such file or
directory
wineserver: could not save registry branch to
/home/dank/.wine-AGXTqe/userdef.reg : No such file or directory
wineserver: could not save registry branch to
/home/dank/.wine-AGXTqe/user.reg : No such file or directory


From stefan at codeweavers.com  Sun Mar 23 07:00:38 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 23 Mar 2008 13:00:38 +0100
Subject: crash on exit in hardy on intel graphics?
In-Reply-To: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
References: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
Message-ID: <200803231300.38257.stefan@codeweavers.com>

Am Sonntag, 23. M?rz 2008 12:22:07 schrieb Dan Kegel:
>   10 0x7ddc39bc glIsRenderbufferEXT+0x16c() in libgl.so.1 (0x0034fc68)
>   11 0xb7efefdf in ld-linux.so.2 (+0xdfdf) (0x0034fe18)
>   12 0xb7c90f74 exit+0xd4() in libc.so.6 (0x0034fe38)
Why would exit call glIsRenderbuffer() ? That doesn't make sense to me


From stefan at codeweavers.com  Sun Mar 23 07:04:54 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 23 Mar 2008 13:04:54 +0100
Subject: 5/3 WineD3D: Don't use blending on pixel formats which don't
	support it in combination with shaders
In-Reply-To: <20080322230800.41530@gmx.net>
References: <20080322230800.41530@gmx.net>
Message-ID: <200803231304.54583.stefan@codeweavers.com>

Am Sonntag, 23. M?rz 2008 00:08:00 schrieb Roderick Colenbrander:
> Hi,
>
> Windows drivers only offer post pixel shader blending support on generic
> (A)RGB-like formats and in case of dx10-class cards like the Geforce8 also
> on some float formats. Right now we enable blending even when it isn't
> needed. In case of R32F (if you would disable the software conversion code)
> this gives a 400% performance boost in
> http://www.angelcode.com/dev/shadow/.
Don't disable GL_BLEND() in context.c . This will be overwritten by the 
state_blend() state handler later if the state is dirty for some reason. 
Instead mark the state dirty and let the state handler code you added handle 
this.

You're checking for use_ps() in the state_blend handler, in this case you'll 
have to make sure that a pixel shader change updates this. However, I suspect 
that the pixel shader does not have any effect on blending and the flag's 
name is a red herring. Can you write a test testing blending on formats that 
do not support post pixel shader blending?


From dank at kegel.com  Sun Mar 23 07:10:26 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 05:10:26 -0700
Subject: crash on exit in hardy on intel graphics?
In-Reply-To: <200803231300.38257.stefan@codeweavers.com>
References: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
	<200803231300.38257.stefan@codeweavers.com>
Message-ID: <a71bd89a0803230510t19525745id6cfa5b5a23fd329@mail.gmail.com>

On Sun, Mar 23, 2008 at 5:00 AM, Stefan D?singer <stefan at codeweavers.com> wrote:
> >   10 0x7ddc39bc glIsRenderbufferEXT+0x16c() in libgl.so.1 (0x0034fc68)
>  >   11 0xb7efefdf in ld-linux.so.2 (+0xdfdf) (0x0034fe18)
>  >   12 0xb7c90f74 exit+0xd4() in libc.so.6 (0x0034fe38)
>  Why would exit call glIsRenderbuffer() ? That doesn't make sense to me

No idea... I guess I figured it was in an onexit handler installed
by opengl for some reason?


From stefan at codeweavers.com  Sun Mar 23 07:14:10 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 23 Mar 2008 13:14:10 +0100
Subject: [PATCH 3/5] wined3d: Handle zero primitive count.
In-Reply-To: <47E59D74.1050503@inbox.lv>
References: <47E59D74.1050503@inbox.lv>
Message-ID: <200803231314.10749.stefan@codeweavers.com>

Am Sonntag, 23. M?rz 2008 00:59:48 schrieb Alexander Dorofeyev:
> Native can handle zero primitive count both when using old interfaces
> (execute buffers etc) and when using d3d8 interface. Wine can crash in
> drawprim.c routines like drawStridedSlow and possibly others too, so filter
> it out in IWineD3DDeviceImpl_DrawIndexedPrimitiveUP. Fixes crash in
> Forsaken. ---
>   dlls/wined3d/device.c |    2 ++
>   1 files changed, 2 insertions(+), 0 deletions(-)
How will this work for other drawing functions? Shouldn't you filter it in the 
common drawPrimive() in drawprim.c?


From stefan at codeweavers.com  Sun Mar 23 07:15:05 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 23 Mar 2008 13:15:05 +0100
Subject: ddraw: Don't clear the returnvalue anymore,
	we keep the dwSize and fill out the rest anyway
In-Reply-To: <187148.4549.qm@web44803.mail.sp1.yahoo.com>
References: <187148.4549.qm@web44803.mail.sp1.yahoo.com>
Message-ID: <200803231315.05697.stefan@codeweavers.com>

Am Sonntag, 23. M?rz 2008 03:33:56 schrieb Kolbj?rn Fredheim:
> Fixes a crash in Anarchy Online
I think we need a test case for that - see dlls/ddraw/tests/d3d.c


From mle+win at mega-nerd.com  Sun Mar 23 07:32:41 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 23 Mar 2008 23:32:41 +1100
Subject: winegcc: A spec file is currently needed in shared mode?
In-Reply-To: <20080323224331.b79254e9.mle+win@mega-nerd.com>
References: <20080323224331.b79254e9.mle+win@mega-nerd.com>
Message-ID: <20080323233241.ca5f9668.mle+win@mega-nerd.com>

Erik de Castro Lopo wrote:

> Any idea what the above means and how to fix it?

Ah, I figured it out. For the record, I needed a .DEF file in order
to generate the DLL.

Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"Projects promoting programming in natural language are intrinsically
doomed to fail." -- Edsger Dijkstra


From alexd4 at inbox.lv  Sun Mar 23 07:27:42 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Sun, 23 Mar 2008 14:27:42 +0200
Subject: [PATCH 3/5] wined3d: Handle zero primitive count.
In-Reply-To: <200803231314.10749.stefan@codeweavers.com>
References: <47E59D74.1050503@inbox.lv>
	<200803231314.10749.stefan@codeweavers.com>
Message-ID: <47E64CBE.1090903@inbox.lv>

Stefan D?singer wrote:
> Am Sonntag, 23. M?rz 2008 00:59:48 schrieb Alexander Dorofeyev:
>> Native can handle zero primitive count both when using old interfaces
>> (execute buffers etc) and when using d3d8 interface. Wine can crash in
>> drawprim.c routines like drawStridedSlow and possibly others too, so filter
>> it out in IWineD3DDeviceImpl_DrawIndexedPrimitiveUP. Fixes crash in
>> Forsaken. ---
>>   dlls/wined3d/device.c |    2 ++
>>   1 files changed, 2 insertions(+), 0 deletions(-)
> How will this work for other drawing functions? Shouldn't you filter it in the 
> common drawPrimive() in drawprim.c?

You are right, drawPrimive() is a better place. I'll update the patch.


From coolbeer1980 at yahoo.com  Sun Mar 23 07:55:59 2008
From: coolbeer1980 at yahoo.com (=?iso-8859-1?Q?Kolbj=F8rn_Fredheim?=)
Date: Sun, 23 Mar 2008 05:55:59 -0700 (PDT)
Subject: ddraw: Don't clear the returnvalue anymore,
	we keep the dwSize and fill out the rest anyway
Message-ID: <874860.51512.qm@web44801.mail.sp1.yahoo.com>

Stefan Wrote:
>Am Sonntag, 23. M?rz 2008 03:33:56 schrieb Kolbj?rn Fredheim:
>> Fixes a crash in Anarchy Online
>I think we need a test case for that - see dlls/ddraw/tests/d3d.c

Not really a need for it, we fill out the whole struct when passing through the function, so there should be no need to memset it to 0, in the worst case we could take the size of the struct as the memset, but using the dwSize is not a good thing imo, it will only crash wine/the program if the program is passing some bizarre value there.

I do however have a testcase for it, but it is really messy and spews out alot of junk, so I _really_ didn't want it included in winecode.

I could clean up the test, but I'm unshure on how to pass or fail the test, as all I'm doing now is spewing out the raw data of the struct after it's been through the function.


      ____________________________________________________________________________________
Looking for last minute shopping deals?  
Find them fast with Yahoo! Search.  http://tools.search.yahoo.com/newsearch/category.php?category=shopping



From cesar at ecuarock.net  Sun Mar 23 11:06:43 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Sun, 23 Mar 2008 11:06:43 -0500
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<47D0296F.9020404@gmx.net>
	<e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>
Message-ID: <e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>

Here are some ideas of what I think could be implemented for the FUSE
project for GSOC.

- This FUSE can be a "proxy" filesystem. This means that we could use
an existing filesystem and mount this proxy filesystem and make it
appear as case insensitive. This means that if there's a file named
"A.txt" on a folder and I copy "a.txt", "A.txt" should be overridden.
Same logic for other cases.

- A utility to test for invalid filenames (like "A.txt" and "a.txt" on
the same original directory)

- Is there any need to simulate windows' permission schemes
(inheritance, ACLs) when using this filesystem?

- Since this will be a proxy filesystem, there is the chance to
present some folders with different names. For example "Program Files"
could be presented as "Archivos de Programa" when mounting the
filesystem with a Spanish locale. The original folder will be still
there and you could cd to it and both will point to the same back end
folder.

If you have any other ideas please let me know.

Cesar

On Thu, Mar 6, 2008 at 6:47 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
> Thanks for your help. I'll prepare something and post it here for
> suggestions soon.
>
>
>
> On Thu, Mar 6, 2008 at 12:27 PM, Marcel Partap <mpartap at gmx.net> wrote:
>
> >
> > > Is there any formal process I must go through to enter google summer
> > > of code for wine?
> > Just filing Google's application will do, although you may want to crash
> in #winehackers ..
> > What you should do IN TIME is to get intimate with the toolchain! That was
> the hardest part for me -
> > getting started on WINE - but if you already have programming experience I
> doubt that is a problem.
> > However, from personal experience of last years SoC, communicate your
> implementation ideas as early
> > as possible and don't be afraid to ask for help here on the list would
> probably be the two most
> > important things...
> > And another lesson learned: it takes a lot of polish for your patches to
> be approved and committed
> > by officer Julliard, be prepared to reiterate over your submitted code
> several times :D
> > Else - go for it, task sounds reasonable achievable. And the t-shirt is
> really worth the effort :)
> > regards
> >
> > --
> > <div id="signature">
> >   "Obstacles are those frightful things you see when you take your eyes
> off your goal."
> >                                                               -- Henry
> Ford (1863-1947)
> >   Change the world! Vote revolution: http://hfopi.org/vote-future
> > </div>
> >
>
>


From smoki00790 at gmail.com  Sun Mar 23 11:12:51 2008
From: smoki00790 at gmail.com (=?ISO-8859-2?Q?Milan_Kosti=E6?=)
Date: Sun, 23 Mar 2008 17:12:51 +0100
Subject: =?ISO-8859-1?Q?Regression_introduced_with_one_old_D=F6singer's_commit?=
Message-ID: <e1d9e62c0803230912hd422276qbc9f516264283b2e@mail.gmail.com>

http://source.winehq.org/git/wine.git?a=commit;h=fe0f0eb48a12e29af6a9e7407d4eec8bc500a057

 OK this is that commit with problem, but don't know what is corect
solution... i just remove it back and all my problems with water
flowing ine games is gone:). Problem is with changes just in utils.c
file and that is not working properly with Mesa drivers that i use (i
don't know for other drivers). Primer: water flow, wrong animation in
portals, etc in Dungeon Siege 2 and all other games with
similar functions.

 I'm just revert minus lines and remove plus:):

-        mat[12] = mat[8];
-        mat[13] = mat[9];
+        switch(coordtype) {
+            case WINED3DDECLTYPE_FLOAT1:
+                /* Direct3D passes the default 1.0 in the 2nd coord,
while gl passes it in the 4th.
+                 * swap 2nd and 4th coord. No need to store the value
of mat[12] in mat[4] because
+                 * the input value to the transformation will be 0,
so the matrix value is irrelevant
+                 */
+                mat[12] = mat[4];
+                mat[13] = mat[5];
+                mat[14] = mat[6];
+                mat[15] = mat[7];
+                break;
+            case WINED3DDECLTYPE_FLOAT2:
+                /* See above, just 3rd and 4th coord
+                 */
+                mat[12] = mat[8];
+                mat[13] = mat[9];
+                mat[14] = mat[10];
+                mat[15] = mat[11];
+                break;
+            case WINED3DDECLTYPE_FLOAT3: /* Opengl defaults match dx
defaults */
+            case WINED3DDECLTYPE_FLOAT4: /* No defaults apply, all
app defined */
+
+            /* This is to prevent swaping the matrix lines and put
the default 4th coord = 1.0
+             * into a bad place. The division elimination below will
apply to make sure the
+             * 1.0 doesn't do anything bad. The caller will set this
value if the stride is 0
+             */
+            case WINED3DDECLTYPE_UNUSED: /* No texture coords,
0/0/0/1 defaults are passed */
+                break;
+            default:
+                FIXME("Unexpected fixed function texture coord input\n");
+        }
+        switch (flags & ~WINED3DTTFF_PROJECTED) {
+            /* case WINED3DTTFF_COUNT1: Won't ever get here */
+            case WINED3DTTFF_COUNT2: mat[2] = mat[6] = mat[10] = mat[14] = 0;
+            /* OpenGL divides the first 3 vertex coord by the 4th by default,
+             * which is essentially the same as D3DTTFF_PROJECTED.
Make sure that
+             * the 4th coord evaluates to 1.0 to eliminate that.
+             *
+             * If the fixed function pipeline is used, the 4th value
remains unused,
+             * so there is no danger in doing this. With vertex
shaders we have a
+             * problem. Should an app hit that problem, the code here
would have to
+             * check for pixel shaders, and the shader has to undo
the default gl divide.
+             *
+             * A more serious problem occurs if the app passes 4
coordinates in, and the
+             * 4th is != 1.0(opengl default). This would have to be
fixed in drawStridedSlow
+             * or a replacement shader
+             */
+            default: mat[3] = mat[7] = mat[11] = 0; mat[15] = 1;
+        }

 and all problems with water animation is gone. Seems to any other
games not have problems with that i do, but i don't know is this
correct? Maybe someone of the developers knows better solution for
this?

 edit: this is tried in wine-0.9.58, Mesa versions 6.52, 7.0, 7.01,
7.02, 7.03rc2 (no problem with all this Mesas) and ATI 9250(r200) and
also ATI 9800(r300) cards.


From stefan at codeweavers.com  Sun Mar 23 11:51:43 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Sun, 23 Mar 2008 17:51:43 +0100
Subject: Regression introduced with one old =?utf-8?q?D=C3=B6singer=27s?=
	commit
In-Reply-To: <e1d9e62c0803230912hd422276qbc9f516264283b2e@mail.gmail.com>
References: <e1d9e62c0803230912hd422276qbc9f516264283b2e@mail.gmail.com>
Message-ID: <200803231751.43635.stefan@codeweavers.com>

Am Sonntag, 23. M?rz 2008 17:12:51 schrieb Milan Kosti?:
> ?OK this is that commit with problem, but don't know what is corect
> solution... i just remove it back and all my problems with water
> flowing ine games is gone:). Problem is with changes just in utils.c
> file and that is not working properly with Mesa drivers that i use (i
> don't know for other drivers). Primer: water flow, wrong animation in
> portals, etc in Dungeon Siege 2 and all other games with
> similar functions.
I recommend you to write a test for this to see how WineD3D should behave. 
Take a look at dlls/d3d9/tests/visual.c, function 
texture_transform_flags_test(). There are a lot of tests for this code 
already. The function is a bit messy unfortunately.

There are a few bug reports about regressions due to this patch. I fixed most 
of them already, but it seems that one bug is still remaining, which is the 
same as the one you're seeing.


From stefan at codeweavers.com  Sun Mar 23 11:51:43 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Sun, 23 Mar 2008 17:51:43 +0100
Subject: Regression introduced with one old =?utf-8?q?D=C3=B6singer=27s?=
	commit
In-Reply-To: <e1d9e62c0803230912hd422276qbc9f516264283b2e@mail.gmail.com>
References: <e1d9e62c0803230912hd422276qbc9f516264283b2e@mail.gmail.com>
Message-ID: <200803231751.43635.stefan@codeweavers.com>

Am Sonntag, 23. M?rz 2008 17:12:51 schrieb Milan Kosti?:
> ?OK this is that commit with problem, but don't know what is corect
> solution... i just remove it back and all my problems with water
> flowing ine games is gone:). Problem is with changes just in utils.c
> file and that is not working properly with Mesa drivers that i use (i
> don't know for other drivers). Primer: water flow, wrong animation in
> portals, etc in Dungeon Siege 2 and all other games with
> similar functions.
I recommend you to write a test for this to see how WineD3D should behave. 
Take a look at dlls/d3d9/tests/visual.c, function 
texture_transform_flags_test(). There are a lot of tests for this code 
already. The function is a bit messy unfortunately.

There are a few bug reports about regressions due to this patch. I fixed most 
of them already, but it seems that one bug is still remaining, which is the 
same as the one you're seeing.


From jgardou at yahoo.fr  Sun Mar 23 13:52:05 2008
From: jgardou at yahoo.fr (=?iso-8859-1?q?J=E9r=F4me_Gardou?=)
Date: Sun, 23 Mar 2008 19:52:05 +0100
Subject: winegcc: A spec file is currently needed in shared mode?
In-Reply-To: <20080323224331.b79254e9.mle+win@mega-nerd.com>
References: <20080323224331.b79254e9.mle+win@mega-nerd.com>
Message-ID: <200803231952.05724.jgardou@yahoo.fr>

Le Sunday 23 March 2008 12:43:31 Erik de Castro Lopo, vous avez ?crit?:
> Hi all,
>
> Any idea what the above means and how to fix it?
>
> Cheers,
> Erik

This means that winegcc is currently unable to know what function should be 
exported when building in shared mode. The only way to "fix" this is writing 
a spec file and passing it in winegcc args. See winegcc --help.

	

	
		
___________________________________________________________________________ 
Yahoo! Mail r?invente le mail ! D?couvrez le nouveau Yahoo! Mail et son interface r?volutionnaire.
http://fr.mail.yahoo.com



From thunderbird2k at gmx.net  Sun Mar 23 15:17:12 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 23 Mar 2008 21:17:12 +0100
Subject: 5/3 WineD3D: Don't use blending on pixel formats which don't
	support	it in combination with shaders
In-Reply-To: <20080322230800.41530@gmx.net>
References: <20080322230800.41530@gmx.net>
Message-ID: <20080323201712.182030@gmx.net>

Skip this one among with 5/3, 6/3 and 7/3. All other patches like 8/3 and 9/3 don't require this one and should apply fine.

Roderick

> Hi,
> 
> Windows drivers only offer post pixel shader blending support on generic
> (A)RGB-like formats and in case of dx10-class cards like the Geforce8 also
> on some float formats. Right now we enable blending even when it isn't
> needed. In case of R32F (if you would disable the software conversion code) this
> gives a 400% performance boost in http://www.angelcode.com/dev/shadow/.
> 
> A next patch will add D3DUSAGE_QUERY_PIXELFORMAT_BLENDING support.
> 
> Regards,
> Roderick Colenbrander

-- 
Ist Ihr Browser Vista-kompatibel? Jetzt die neuesten 
Browser-Versionen downloaden: http://www.gmx.net/de/go/browser


From galeru at gmail.com  Sun Mar 23 18:11:38 2008
From: galeru at gmail.com (Corey McClymonds)
Date: Sun, 23 Mar 2008 19:11:38 -0400
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<47D0296F.9020404@gmx.net>
	<e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>
	<e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>
Message-ID: <63ee2bc70803231611k31e16781j82f1de4e6cb73cf4@mail.gmail.com>

On 3/23/08, Cesar Izurieta <cesar at ecuarock.net> wrote:
> Here are some ideas of what I think could be implemented for the FUSE
>  project for GSOC.
>
>  - This FUSE can be a "proxy" filesystem. This means that we could use
>  an existing filesystem and mount this proxy filesystem and make it
>  appear as case insensitive. This means that if there's a file named
>  "A.txt" on a folder and I copy "a.txt", "A.txt" should be overridden.
>  Same logic for other cases.
>
>  - A utility to test for invalid filenames (like "A.txt" and "a.txt" on
>  the same original directory)
>
>  - Is there any need to simulate windows' permission schemes
>  (inheritance, ACLs) when using this filesystem?
>
>  - Since this will be a proxy filesystem, there is the chance to
>  present some folders with different names. For example "Program Files"
>  could be presented as "Archivos de Programa" when mounting the
>  filesystem with a Spanish locale. The original folder will be still
>  there and you could cd to it and both will point to the same back end
>  folder.
>
>  If you have any other ideas please let me know.
>
>  Cesar

Are you going to do integration under wine, or are you going to just
do the file system.  For instance, what happens if you run wine in a
folder that isn't case insensitive?
>
>  On Thu, Mar 6, 2008 at 6:47 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
>  > Thanks for your help. I'll prepare something and post it here for
>  > suggestions soon.
>  >
>  >
>  >
>  > On Thu, Mar 6, 2008 at 12:27 PM, Marcel Partap <mpartap at gmx.net> wrote:
>  >
>  > >
>  > > > Is there any formal process I must go through to enter google summer
>  > > > of code for wine?
>  > > Just filing Google's application will do, although you may want to crash
>  > in #winehackers ..
>  > > What you should do IN TIME is to get intimate with the toolchain! That was
>  > the hardest part for me -
>  > > getting started on WINE - but if you already have programming experience I
>  > doubt that is a problem.
>  > > However, from personal experience of last years SoC, communicate your
>  > implementation ideas as early
>  > > as possible and don't be afraid to ask for help here on the list would
>  > probably be the two most
>  > > important things...
>  > > And another lesson learned: it takes a lot of polish for your patches to
>  > be approved and committed
>  > > by officer Julliard, be prepared to reiterate over your submitted code
>  > several times :D
>  > > Else - go for it, task sounds reasonable achievable. And the t-shirt is
>  > really worth the effort :)
>  > > regards
>  > >
>  > > --
>  > > <div id="signature">
>  > >   "Obstacles are those frightful things you see when you take your eyes
>  > off your goal."
>  > >                                                               -- Henry
>  > Ford (1863-1947)
>  > >   Change the world! Vote revolution: http://hfopi.org/vote-future
>  > > </div>
>  > >
>  >
>  >
>
>
>


From dank at kegel.com  Sun Mar 23 18:36:53 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 16:36:53 -0700
Subject: winemenubuilder: Add support for 24 and 32 bit icons using png
	format.
Message-ID: <a71bd89a0803231636p27995ab1u7a5608570f1ce82@mail.gmail.com>

Your patch applies and creates .png icons...
But it seems to create the icons with two suffixes, e.g. file shows
  a680_forum.png.xpm: PNG image data, 32 x 32, 8-bit/color RGB, non-interlaced
Shouldn't that just be .png, not .png.xpm?

(This is for http://bugs.winehq.org/show_bug.cgi?id=4803 )


From wine-devel at kievinfo.com  Sun Mar 23 19:45:20 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 23 Mar 2008 18:45:20 -0600
Subject: winemenubuilder: Add support for 24 and 32 bit icons using png
	format.
In-Reply-To: <a71bd89a0803231636p27995ab1u7a5608570f1ce82@mail.gmail.com>
References: <a71bd89a0803231636p27995ab1u7a5608570f1ce82@mail.gmail.com>
Message-ID: <47E6F9A0.7080507@kievinfo.com>

Dan Kegel wrote:
> Your patch applies and creates .png icons...
> But it seems to create the icons with two suffixes, e.g. file shows
>   a680_forum.png.xpm: PNG image data, 32 x 32, 8-bit/color RGB, non-interlaced
> Shouldn't that just be .png, not .png.xpm?
> 
> (This is for http://bugs.winehq.org/show_bug.cgi?id=4803 )

Where are seeing that file? Also are you sure you are using patches 
wineshelllink? That's what copies the icon from c:\windows\temp to 
~/.local/share/icons

Vitaliy.


From dank at kegel.com  Sun Mar 23 19:53:21 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 17:53:21 -0700
Subject: crash on exit in hardy on intel graphics?
In-Reply-To: <a71bd89a0803230510t19525745id6cfa5b5a23fd329@mail.gmail.com>
References: <a71bd89a0803230422n7b715f46r6f52b54201695e98@mail.gmail.com>
	<200803231300.38257.stefan@codeweavers.com>
	<a71bd89a0803230510t19525745id6cfa5b5a23fd329@mail.gmail.com>
Message-ID: <a71bd89a0803231753m7371015ah885830fbb777cc11@mail.gmail.com>

On Sun, Mar 23, 2008 at 5:10 AM, Dan Kegel <dank at kegel.com> wrote:
> On Sun, Mar 23, 2008 at 5:00 AM, Stefan D?singer <stefan at codeweavers.com> wrote:
>  > >   10 0x7ddc39bc glIsRenderbufferEXT+0x16c() in libgl.so.1 (0x0034fc68)
>  >  >   11 0xb7efefdf in ld-linux.so.2 (+0xdfdf) (0x0034fe18)
>  >  >   12 0xb7c90f74 exit+0xd4() in libc.so.6 (0x0034fe38)
>  >  Why would exit call glIsRenderbuffer() ? That doesn't make sense to me
>
>  No idea... I guess I figured it was in an onexit handler installed
>  by opengl for some reason?

Now I'm getting that crash on exit from a game, American McGee's Alice demo.
Anybody else testing Hardy?
- Dan

p.s. here's the stack:

Unhandled exception: page fault on read access to 0x00000200 in 32-bit
code (0xb7f7cbad).
Register dump:
 CS:0073 SS:007b DS:007b ES:007b FS:0033 GS:003b
 EIP:b7f7cbad ESP:0174d868 EBP:0174d890 EFLAGS:00210292(   - 00      -RISA1)
 EAX:b7f84ce0 EBX:b7f84ff4 ECX:b7f775b9 EDX:b7cd76ac
 ESI:00000000 EDI:00000000
Stack dump:
0x0174d868:  b7f69eec b7f84ff4 0174d8b8 7c028dc4
0x0174d878:  0174d8ec b7f73059 0174d890 b7cdaff4
0x0174d888:  00000000 7c003188 0174d8a0 b7cd8cb4
0x0174d898:  00000000 b7f84ff4 0174d980 b7f775d6
0x0174d8a8:  00000000 00000000 00000000 00000000
0x0174d8b8:  7c003190 7c003198 7c003194 b7cd76ac
Backtrace:
=>1 0xb7f7cbad in ld-linux.so.2 (+0x12bad) (0x0174d890)
  2 0xb7cd8cb4 GLIBC_2+0xcb4() in libdl.so.2 (0x0174d8a0)
  3 0xb7f775d6 in ld-linux.so.2 (+0xd5d6) (0x0174d980)
  4 0xb7cd92bc in libdl.so.2 (+0x12bc) (0x0174d9a0)
  5 0xb7cd8cea GLIBC_2+0xcea() in libdl.so.2 (0x0174d9b0)
  6 0x7dc157bd in libgl.so.1 (+0x477bd) (0x0174d9d0)
  7 0x7dbf584a in libgl.so.1 (+0x2784a) (0x0174d9f0)
  8 0x7dbf7924 in libgl.so.1 (+0x29924) (0x0174da20)
  9 0x7dbf0ba4 in libgl.so.1 (+0x22ba4) (0x0174da30)
  10 0x7dc339bc glIsRenderbufferEXT+0x16c() in libgl.so.1 (0x0174da40)
  11 0xb7f77fdf in ld-linux.so.2 (+0xdfdf) (0x0174db90)
  12 0xb7d09f74 exit+0xd4() in libc.so.6 (0x0174dbb0)
  13 0x7efacc80 RtlGetCurrentPeb()
[/home/dank/wine-git/dlls/ntdll/process.c:70] in ntdll (0x0174dc40)
  14 0x7ee7d62f ExitProcess+0x2f(status=0x0)
[/home/dank/wine-git/dlls/kernel32/process.c:2046] in kernel32
(0x0174dc60)
  15 0x004e9767 in alice (+0xe9767) (0x00bd54c0)
0xb7f7cbad: testb       $0x8,0x200(%edi)


From dank at kegel.com  Sun Mar 23 20:48:34 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 18:48:34 -0700
Subject: winemenubuilder: Add support for 24 and 32 bit icons using png
	format.
In-Reply-To: <47E6F9A0.7080507@kievinfo.com>
References: <a71bd89a0803231636p27995ab1u7a5608570f1ce82@mail.gmail.com>
	<47E6F9A0.7080507@kievinfo.com>
Message-ID: <a71bd89a0803231848y46fa8255p40bc6d59301a69f7@mail.gmail.com>

On Sun, Mar 23, 2008 at 5:45 PM, Vitaliy Margolen
<wine-devel at kievinfo.com> wrote:
>  Where are seeing that file? Also are you sure you are using patches
>  wineshelllink?

My bad.  To use a noninstalled wineshelllink, you have
to start the installer with
   PATH=$HOME/wine-git/tools:$PATH wine-git/wine installers/BLMInstall277.exe
and then the icons are fine, since it's using the new code in the build tree.

Oddly, the link and shortcut on the desktop don't use any
of the icons, but the ones in the Wine menu look good.


From wine-devel at kievinfo.com  Sun Mar 23 20:55:09 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 23 Mar 2008 19:55:09 -0600
Subject: winemenubuilder: Add support for 24 and 32 bit icons using png
	format.
In-Reply-To: <a71bd89a0803231848y46fa8255p40bc6d59301a69f7@mail.gmail.com>
References: <a71bd89a0803231636p27995ab1u7a5608570f1ce82@mail.gmail.com>	
	<47E6F9A0.7080507@kievinfo.com>
	<a71bd89a0803231848y46fa8255p40bc6d59301a69f7@mail.gmail.com>
Message-ID: <47E709FD.1080403@kievinfo.com>

Dan Kegel wrote:
> On Sun, Mar 23, 2008 at 5:45 PM, Vitaliy Margolen
> <wine-devel at kievinfo.com> wrote:
>>  Where are seeing that file? Also are you sure you are using patches
>>  wineshelllink?
> 
> My bad.  To use a noninstalled wineshelllink, you have
> to start the installer with
>    PATH=$HOME/wine-git/tools:$PATH wine-git/wine installers/BLMInstall277.exe
> and then the icons are fine, since it's using the new code in the build tree.
> 
I just did 'ln -s wine.git/tools/wineshelllink ~/bin/wineshelllink'

> Oddly, the link and shortcut on the desktop don't use any
> of the icons, but the ones in the Wine menu look good.
Strange, unless there are some other problems with extracting an icon. Can 
you run this and attach the output?

WINEDEBUG=+menubuilder wine winemenubuilder 
"c:\windows\profiles\\$USER\desktop\file.lnk"

Vitaliy.


From m.b.lankhorst at gmail.com  Sun Mar 23 23:22:44 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 23 Mar 2008 21:22:44 -0700
Subject: Proposal template for SOC2008?
Message-ID: <b130c85e0803232122m6b4b8481nd9622ca4f584bb99@mail.gmail.com>

Hi all,

I was thinking of copying the template perl uses for people wanting to
submit a proposal.

Anyone sees anything wrong with using
http://www.perlfoundation.org/perl5/index.cgi?gsoc2008_proposal_template
?

Cheers,
Maarten.


From dank at kegel.com  Mon Mar 24 01:00:31 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 Mar 2008 23:00:31 -0700
Subject: wine 1.0 status: T minus 75 days. 82 open bugs.
Message-ID: <a71bd89a0803232300g168a6600j79b2b6f365cb09a3@mail.gmail.com>

This weekend, two bugs were resolved:
5535   directx-        16      Planescape:Torment doesn't work
6526   kernel32        1       Typing Instructor for Kids 2 fails to install

Four were deferred:
1347   directx-        20      Screen is wiped/blanked on usage of DirectDraw
3534   user32  14      Systray icons are not transparent...
6795   shdocvw 0       Skype 3.0.0.137 Beta dies trying to login in
win98, winme mode
10708  user32  21      Wine lacks support for animated cursors

And one more bug was nominated for 1.0.0 (!),
10040 	crypt32 	1 	Steam crashes during the startup

That takes us down from 87 bugs and 76 days to 82 bugs and 75 days.

Here's a list of the currently open 1.0 bugs, sorted by component, with votes:

5948   	-unknown  	1  	Star Trek: Armada does not install
5055 	-unknown 	5 	Deleting files from a window in wine doesn't send
them to the Trash
8125 	-unknown 	0 	Marratech 6.1 crashes on start
9916 	-unknown 	6 	"make test" usually fails
5844 	-unknown 	8 	tray minimize
7404 	-unknown 	2 	ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
9459 	-unknown 	8 	FIFA 2007 crashes with the recent versions
5402 	-unknown 	0 	Trying to run PhotoStitch 3.1
5024 	-unknown 	3 	Thief: Deadly Shadows crashes:page fault on read
access to 0x0000040c
10815 	-unknown 	1 	Cannot drag images into Adobe Photoshop 7 from the
web / desktop
9178 	-unknown 	7 	"hello world" dos program hangs
5061 	-unknown 	5 	Copying from Windows Firefox in Wine and pasting to
Linux OpenOffice pastes metadata as data
12097 	-unknown 	1 	Wine 1.0 should not ship out-of-sync resource translations
11281 	-unknown 	2 	CJK input many issues
7477 	-unknown 	1 	Uplink demo crashes
4971 	-unknown 	3 	Corel Draw 12 demo install fails
7915 	-unknown 	4 	15 of the internal tests of wine fail on Mac OS X
10147 	-unknown 	0 	Word Viewer 2003 - Tab behavior differs from Windows
9959 	-unknown 	8 	Make wine updates work even if the registry changed
556 	build-en 	2 	Reconcile the Windows and Wine spec files
1114 	comctl32 	2 	Winrar2.90/3.00: Comboex doesn't trigger a event
when you mouse-click in some value of it
10111 	comctl32 	2 	WINEDEBUG=warn+heap "make test" has heap error in
comdlg32/tests/printdlg.c
2493 	comctl32 	1 	Multi-select listview: Shift-arrow up only selects
top two items
9104 	comdlg32 	1 	Pdf-xchange viewer crashes
10040 	crypt32 	1 	Steam crashes during the startup
11681 	directx- 	11 	Add support for video overlay
5955 	directx- 	6 	DirectDrawCreate crash on non-OpenGL desktop
9030 	directx- 	0 	army men hangs on black screen
82 	document 	1 	Stabilize Winelib User Guide Table of Contents
638 	document 	7 	Document Wine debugging channels
3270 	gdi32 	12 	Problem with minimized top-level windows
9771 	gdi32 	37 	Steam Friends doesn't work (fails to render correctly
or refresh)
6519 	gdi32 	6 	Wine blacks out rotated font bitmap
9926 	gdi32 	4 	gdi32.dll should not have exported function pointers
7571 	gdi32 	1 	Accented character glyphs are mixed up with TrueType
fonts (affects e.g. Lotus Notes R5)
9484 	kernel32 	17 	Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
9039 	kernel32 	0 	GS-Auftrag Professional SQL aborts on startup
5351 	kernel32 	8 	Windows Installer 3.1 cannot install because of
non-standard drive labeling
5541 	kernel32 	0 	WriteConsole can't write to stdout; affects e.g.
wsh's cscript's usage message
4733 	kernel32 	4 	Get optimized/compressed/packed executables (non-upx) working
7098 	mscoree 	1 	RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
5163 	msi 	12 	Office XP 2002 crashes on installation
8783 	ntdll 	11 	USB serial ports do not work
9356 	ntdll 	5 	Serial communication not working since wine-0.9.33
6607 	ole 	6 	Drag and Drop not working
9942 	ole 	2 	Powerpoint Viewer 2007 crashes opening .pptx files
2539 	ole 	2 	XDND (Drag and drop for X Windows) doesn't copy text
8095 	ole 	0 	PQ Teaching toy crashes
4770 	ole 	2 	BlackBerry Device Manager fails to install under wine
5926 	programs 	0 	Wine does not provide an implementation of winhlp32.exe
4803 	programs 	5 	Steam: not all lnk files are processed into linux shortcuts
6254 	richedit 	3 	Installer infinite loop from rich text error
9304 	shdocvw 	3 	Temple of Elemental Evil demo doesn't start - gui irresponsive
6095 	shdocvw 	11 	MOTD in counter-strike 1.6 and counter-strike
source does not render
8898 	shdocvw 	0 	Run Time Error "445": Object doesn't support this
action in Europa Knowledgebase
3546 	shdocvw 	2 	CLSID_InternetShortcut not available...
10905 	shell32 	0 	thinstall firefox demo requires native msvcrt
8439 	shell32 	4 	Visual Studio .NET (7) install fails
9809 	shell32 	4 	Autodesk Revit Architecture 2008 install fails
11742 	shlwapi 	8 	Small .net 1.1 app (FastMD5 1.3) fails to start up
12074 	testcase 	2 	The conformance tests fail on Windows
6604 	tools 	2 	Ship icons for the wine-tools that can be used in .desktop files
8246 	urlmon 	3 	invoking htmlhelp:HtmlHelpW crashes wine
11431 	user32 	5 	Adobe Photoshop CS2: z-overlay of image containers
664 	user32 	5 	The help menu functionality inside programs is broken
(messaging problem)
4523 	user32 	5 	Can't copy from Firefox 1.5 and paste into OpenOffice
2 under Wine
3023 	user32 	5 	Orcad - "Place Part" never tries to put down a part
124 	wineserv 	2 	Review of Wine Server Protocol
11884 	winex11. 	1 	Copy and paste garbage on end
2368 	winex11. 	5 	Wine loses its X-Window when switching to another
virt. desktop in Fvwm
11019 	winex11. 	1 	matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
5623 	winex11. 	2 	GetAsyncKeyState wrong if querying process doesn't have focus
5828 	winex11. 	23 	Command and Conquer Generals (Zero Hour) doesn't
change the mouse cursor from the default X mouse
1990 	winex11. 	1 	modifier keys not released when switching desktop
10984 	winex11. 	2 	sun jre 5 update 10 installer hangs in 0.9.52
7372 	winex11. 	12 	can't copy and paste between gnome apps eg
openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
3297 	winex11. 	9 	UpdateWindow() doesn't call XFlush()
3711 	winsock 	0 	Musicmatch fails to install (missing registry key,
HTTP_HttpOpenRequest() problem)
10032 	winsock 	1 	Wine must not use unix select() for networking
where there might be high fd's
9787 	winsock 	44 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
5625 	winsock 	3 	Wine does not handle internet proxy settings conveniently
12005 	wintab32 	0 	Regression in pressure sensitivity with wizardpen
tablet driver and Photoshop 7


From m.b.lankhorst at gmail.com  Mon Mar 24 01:36:53 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 23 Mar 2008 23:36:53 -0700
Subject: C&C :D
In-Reply-To: <20080323084730.40340@gmx.net>
References: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
	<20080323084730.40340@gmx.net>
Message-ID: <b130c85e0803232336w1d5326b4wb68cb71929017a6@mail.gmail.com>

Hi Roderick,

2008/3/23, Roderick Colenbrander <thunderbird2k at gmx.net>:
> > Hi all!
>  >
>  > After an announcement that the original Command and conquer is
>  > available free for download, I decided to test it. Command and Conquer
>  > works perfectly in wine, I haven't tested network gaming over ipx, but
>  > that will probably not work. For the rest it's flawless, apart from
>  > the losing focus behavior, but playing it in a wine desktop helps.
>  >
>  > Remember: KANE IS A TRAITOR! LONG LIVE THE GDI!
>  >
>  > Cheers,
>  > Maarten.
>  >
>
>
> Hi Maarten,
>
>  It will likely run better if you use DirectDrawRenderer=opengl + RenderTargetLockMode=readtex (at least on Nvidia hardware that is fast). Second IPX network should work (if this is the c&c version with updated ipx) but you need root as plain users don't have enough permissions to create a raw ipx socket.
Tested that, none of the opengl modes work well:

disabled: In the menu I only get the menu, not the text that's written on it.
readtex: I get a white texture with only the text
textex: Nothing at all
readdraw: fails too

I'll play without opengl I think.

Cheers,
Maarten.


From m.b.lankhorst at gmail.com  Mon Mar 24 01:44:55 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 23 Mar 2008 23:44:55 -0700
Subject: C&C :D
In-Reply-To: <b130c85e0803232336w1d5326b4wb68cb71929017a6@mail.gmail.com>
References: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
	<20080323084730.40340@gmx.net>
	<b130c85e0803232336w1d5326b4wb68cb71929017a6@mail.gmail.com>
Message-ID: <b130c85e0803232344v57a8d65r7ec38f810758e760@mail.gmail.com>

Hello,

2008/3/23, Maarten Lankhorst <m.b.lankhorst at gmail.com>:
>  2008/3/23, Roderick Colenbrander <thunderbird2k at gmx.net>:
>
> > > Hi all!
>  >  >
>  >  > After an announcement that the original Command and conquer is
>  >  > available free for download, I decided to test it. Command and Conquer
>  >  > works perfectly in wine, I haven't tested network gaming over ipx, but
>  >  > that will probably not work. For the rest it's flawless, apart from
>  >  > the losing focus behavior, but playing it in a wine desktop helps.
>  >  >
>  >  > Remember: KANE IS A TRAITOR! LONG LIVE THE GDI!
>  >  >
>  >  > Cheers,
>  >  > Maarten.
>  >  >
>  >
>  >
>  > Hi Maarten,
>  >
>  >  It will likely run better if you use DirectDrawRenderer=opengl + RenderTargetLockMode=readtex (at least on Nvidia hardware that is fast). Second IPX network should work (if this is the c&c version with updated ipx) but you need root as plain users don't have enough permissions to create a raw ipx socket.
>
> Tested that, none of the opengl modes work well:
>
>  disabled: In the menu I only get the menu, not the text that's written on it.
>  readtex: I get a white texture with only the text
>  textex: Nothing at all
>  readdraw: fails too
>
>  I'll play without opengl I think.
Hold on, even without opengl it will fail sometimes dramatically, it
will stop updating the screen entirely if you fiddle around with the
menu too much. After that it doesn't work any more at all.


From sirnuke at gmail.com  Mon Mar 24 01:58:40 2008
From: sirnuke at gmail.com (Bryan DeGrendel)
Date: Mon, 24 Mar 2008 02:58:40 -0400
Subject: C&C :D
In-Reply-To: <b130c85e0803232344v57a8d65r7ec38f810758e760@mail.gmail.com>
References: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
	<20080323084730.40340@gmx.net>
	<b130c85e0803232336w1d5326b4wb68cb71929017a6@mail.gmail.com>
	<b130c85e0803232344v57a8d65r7ec38f810758e760@mail.gmail.com>
Message-ID: <82b7f9ee0803232358i123ef807od901f30efa614339@mail.gmail.com>

On Mon, Mar 24, 2008 at 2:44 AM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Hello,
>
>  2008/3/23, Maarten Lankhorst <m.b.lankhorst at gmail.com>:
>
>
> >  2008/3/23, Roderick Colenbrander <thunderbird2k at gmx.net>:
>  >
>  > > > Hi all!
>  >  >  >
>  >  >  > After an announcement that the original Command and conquer is
>  >  >  > available free for download, I decided to test it. Command and Conquer
>  >  >  > works perfectly in wine, I haven't tested network gaming over ipx, but
>  >  >  > that will probably not work. For the rest it's flawless, apart from
>  >  >  > the losing focus behavior, but playing it in a wine desktop helps.
>  >  >  >
>  >  >  > Remember: KANE IS A TRAITOR! LONG LIVE THE GDI!
>  >  >  >
>  >  >  > Cheers,
>  >  >  > Maarten.
>  >  >  >
>  >  >
>  >  >
>  >  > Hi Maarten,
>  >  >
>  >  >  It will likely run better if you use DirectDrawRenderer=opengl + RenderTargetLockMode=readtex (at least on Nvidia hardware that is fast). Second IPX network should work (if this is the c&c version with updated ipx) but you need root as plain users don't have enough permissions to create a raw ipx socket.
>  >
>  > Tested that, none of the opengl modes work well:
>  >
>  >  disabled: In the menu I only get the menu, not the text that's written on it.
>  >  readtex: I get a white texture with only the text
>  >  textex: Nothing at all
>  >  readdraw: fails too
>  >
>  >  I'll play without opengl I think.
>  Hold on, even without opengl it will fail sometimes dramatically, it
>  will stop updating the screen entirely if you fiddle around with the
>  menu too much. After that it doesn't work any more at all.
>
>
>

Are you working on a SMP system?  I had redraw problems with C&C Red
Alert on my Athlon X2, but the schedtool solution presented in bug
4487 worked for me [ http://bugs.winehq.org/show_bug.cgi?id=4487 ].

schedtool -a 0x2 -e wine

Bryan DeGrendel


From kai.blin at gmail.com  Mon Mar 24 05:09:29 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 24 Mar 2008 11:09:29 +0100
Subject: Proposal template for SOC2008?
In-Reply-To: <b130c85e0803232122m6b4b8481nd9622ca4f584bb99@mail.gmail.com>
References: <b130c85e0803232122m6b4b8481nd9622ca4f584bb99@mail.gmail.com>
Message-ID: <200803241109.33851.kai.blin@gmail.com>

On Monday 24 March 2008 05:22:44 Maarten Lankhorst wrote:
> Hi all,
>
> I was thinking of copying the template perl uses for people wanting to
> submit a proposal.
>
> Anyone sees anything wrong with using
> http://www.perlfoundation.org/perl5/index.cgi?gsoc2008_proposal_template

I think this is more verbose than all the applications I've ever written. :)
I think it's nice to give as a guidance if we don't require people to 100% 
stick to the template just for the template's sake.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080324/234f37da/attachment.pgp 

From smoki00790 at gmail.com  Mon Mar 24 05:20:38 2008
From: smoki00790 at gmail.com (=?ISO-8859-2?Q?Milan_Kosti=E6?=)
Date: Mon, 24 Mar 2008 11:20:38 +0100
Subject: =?ISO-8859-1?Q?Re:_Regression_introduced_with_one_old_D=F6singer's_commit?=
In-Reply-To: <200803231751.43635.stefan@codeweavers.com>
References: <e1d9e62c0803230912hd422276qbc9f516264283b2e@mail.gmail.com>
	<200803231751.43635.stefan@codeweavers.com>
Message-ID: <e1d9e62c0803240320l6c49e76ex3ef0fbd662139def@mail.gmail.com>

 Sorry Stefan but i'm prety new with Wine and for now don't understand
many things:(, i'm test games for now and don't know how to test tests
with wined3d.
 I tried to not remove any code from v0.9.58 utils.c, i'm just add
mat[12] = mat[8] and mat[13] = mat[9] like this:

             break;
        }
    } else { /* under directx the R/Z coord can be used for
translation, under opengl we use the Q coord instead */
	mat[12] = mat[8];
	mat[13] = mat[9];
        if(!calculatedCoords) {
            switch(coordtype) {
                case WINED3DDECLTYPE_FLOAT1:

 With that water flowing and portals also works good for me.


From julliard at winehq.org  Mon Mar 24 07:25:54 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 24 Mar 2008 13:25:54 +0100
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
In-Reply-To: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
	(Dan Kegel's message of "Fri, 21 Mar 2008 18:43:56 -0700")
References: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
Message-ID: <87skygqpf1.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> +static void test_negative_dest_length(void)
> +{
> +    int len;
> +    char buf[10];
> +
> +    /* Test return on negative dest length */
> +    SetLastError( 0xdeadbeef );
> +    memset(buf,'x',sizeof(buf));
> +    len = WideCharToMultiByte(CP_ACP, 0, foobarW, -1, buf, -1, NULL, NULL);
> +    ok(len == 0 && GetLastError() == ERROR_INVALID_PARAMETER,
> +       "WideCharToMultiByte(destlen -1): len=%d error=%x\n", len, GetLastError());

If you want to determine the behavior for negative values you have to
test more than just -1, it may well be special.

-- 
Alexandre Julliard
julliard at winehq.org


From epssyis at gmail.com  Mon Mar 24 07:47:10 2008
From: epssyis at gmail.com (Edward Savage)
Date: Mon, 24 Mar 2008 23:47:10 +1100
Subject: Wine1.0 and LGPLv3?
In-Reply-To: <200803220946.51144.kai.blin@gmail.com>
References: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>
	<200803220946.51144.kai.blin@gmail.com>
Message-ID: <d6c5d7290803240547v4328fa03u1bab261be70c3bc7@mail.gmail.com>

>  I think the agreement from WineConf 2007 was to change as soon as there's a
>  reason to do so. So far it seems like there isn't.
>

With my understanding of the new clauses (or protections) isn't this
attitude akin to not replacing the battery in your fire alarm until
you smell smoke?

I've noticed this stance from several gpl projects and it worries me
that every one is going to simply ignore the issues raised from gplv3
until some project gets burnt and there will be a made rush by every
one else to protect themselves.  What if wine is that project?

On the other hand the process of updating to the v3 license would be
rather time consuming (at least according to the time line fsf put
out) for the wine project and I agree that 1.0 probably wouldn't be
the time to do it and as we all know, none of the doom and gloom
predicted has come to pass (at least yet).

Could I suggest making a firm commitment to either stay with v2 or
move to v3 and set a release (or date)  that this will happen by as a
proper way of dealing with any change.


From kai.blin at gmail.com  Mon Mar 24 07:59:58 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 24 Mar 2008 13:59:58 +0100
Subject: Wine1.0 and LGPLv3?
In-Reply-To: <d6c5d7290803240547v4328fa03u1bab261be70c3bc7@mail.gmail.com>
References: <aac02a530803190701x5b19a028pa5a4b8f02326e78c@mail.gmail.com>
	<200803220946.51144.kai.blin@gmail.com>
	<d6c5d7290803240547v4328fa03u1bab261be70c3bc7@mail.gmail.com>
Message-ID: <200803241400.02463.kai.blin@gmail.com>

On Monday 24 March 2008 13:47:10 Edward Savage wrote:
> >  I think the agreement from WineConf 2007 was to change as soon as
> > there's a reason to do so. So far it seems like there isn't.
>
> I've noticed this stance from several gpl projects and it worries me
> that every one is going to simply ignore the issues raised from gplv3
> until some project gets burnt and there will be a made rush by every
> one else to protect themselves.  What if wine is that project?

That's about the patent protection, isn't it? We'll have to consider that when 
Microsoft starts contributing patches. ;)

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080324/54a45d1d/attachment.pgp 

From tony.wasserka at freenet.de  Mon Mar 24 07:56:26 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Mon, 24 Mar 2008 13:56:26 +0100
Subject: d3d9_36: partially implement D3DXCreateTextureFromFile
Message-ID: <E1JdmDy-00035O-5S@www20.emo.freenet-rz.de>

> Hello
> 
> 1) use 4 spaces instead of tab in
> 
>  	d3dx9_36_main.c 
>  	font.c 
> -	math.c
> +	math.c 
> +        texture.c
> 
> 
> 2) D3DXCreateTextureFromFileW(ptr wstr ptr) should be forwarded to its d3dx8 counterpart and you implement it in d3dx8 dll
> 
> 
> David

No, tabs are okay in Makefile.in (every dll is using tabs there). Also, the first parameter of D3DXCreateTextureFromFile is an LPDIRECT3DDEVICE8 in d3dx8 and an LPDIRECT3DDEVICE9 in d3dx9, i.e. this call can't be forwarded.
However, you should probably call D3DXCreateTextureFromFileEx here to prevent duplicated code. If you're going to implement that function, too, you may need to stub D3DXFilterTexture (just from looking at the parameter list of the extended function, not sure if you REALLY need to do so).

    Tony




Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain inkl.
http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/index.html



From kai.blin at gmail.com  Mon Mar 24 08:10:26 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 24 Mar 2008 14:10:26 +0100
Subject: wine 1.0 status: T minus 75 days. 82 open bugs.
In-Reply-To: <a71bd89a0803232300g168a6600j79b2b6f365cb09a3@mail.gmail.com>
References: <a71bd89a0803232300g168a6600j79b2b6f365cb09a3@mail.gmail.com>
Message-ID: <200803241410.26516.kai.blin@gmail.com>

On Monday 24 March 2008 07:00:31 Dan Kegel wrote:

> 3711 	winsock 	0 	Musicmatch fails to install (missing registry key,
> HTTP_HttpOpenRequest() problem)

That's a wininet bug, I've changed the component.

> 10032 	winsock 	1 	Wine must not use unix select() for networking
> where there might be high fd's

Sent a patch for that.

> 9787 	winsock 	44 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)

That one's Andrey Turkin's playground.

> 5625 	winsock 	3 	Wine does not handle internet proxy settings conveniently

This is a wininet bug as well.

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080324/2d9588df/attachment.pgp 

From kai.blin at gmail.com  Mon Mar 24 08:28:10 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 24 Mar 2008 14:28:10 +0100
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>
	<e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>
Message-ID: <200803241428.10359.kai.blin@gmail.com>

On Sunday 23 March 2008 17:06:43 Cesar Izurieta wrote:
> Here are some ideas of what I think could be implemented for the FUSE
> project for GSOC.
>
> - This FUSE can be a "proxy" filesystem. This means that we could use
> an existing filesystem and mount this proxy filesystem and make it
> appear as case insensitive. This means that if there's a file named
> "A.txt" on a folder and I copy "a.txt", "A.txt" should be overridden.
> Same logic for other cases.
>
> - A utility to test for invalid filenames (like "A.txt" and "a.txt" on
> the same original directory)

Perhaps this shouldn't be an extra tool but more like a setting what to do in 
a case like that.

> - Is there any need to simulate windows' permission schemes
> (inheritance, ACLs) when using this filesystem?

Alexandre said that wasn't interesting until Wine goes multi-user. So don't 
worry about that for now.

> - Since this will be a proxy filesystem, there is the chance to
> present some folders with different names. For example "Program Files"
> could be presented as "Archivos de Programa" when mounting the
> filesystem with a Spanish locale. The original folder will be still
> there and you could cd to it and both will point to the same back end
> folder.

I'm not sure if that's really useful. IIRC wineprefixcreate already creates a 
localized directory layout.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080324/010b0123/attachment-0001.pgp 

From julliard at winehq.org  Mon Mar 24 08:48:20 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 24 Mar 2008 14:48:20 +0100
Subject: [PATCH 01/45] [WinHelp]: now setting the text Window as a
	richedit one
In-Reply-To: <20080323091622.18009.13901.stgit@localhost> (Eric Pouech's
	message of "Sun, 23 Mar 2008 10:16:23 +0100")
References: <20080323091354.18009.31730.stgit@localhost>
	<20080323091622.18009.13901.stgit@localhost>
Message-ID: <87wsnsnsgr.fsf@wine.dyndns.org>

Eric Pouech <eric.pouech at orange.fr> writes:

> - all popups are now of MainWindow kind (and embed a richedit control)
>
> A+
> ---
>
>  programs/winhelp/string.c  |    1 
>  programs/winhelp/winhelp.c |  932 ++------------------------------------------
>  programs/winhelp/winhelp.h |   42 --
>  3 files changed, 40 insertions(+), 935 deletions(-)

This seems to break the text window pretty badly, the window is now
completely blank with just a blinking caret.

-- 
Alexandre Julliard
julliard at winehq.org


From juan.lang at gmail.com  Mon Mar 24 10:32:29 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Mon, 24 Mar 2008 08:32:29 -0700
Subject: Confusing SOCKET and int in netapi32
Message-ID: <3a768c550803240832l78bd03d0ld4151d70fb7c9a@mail.gmail.com>

Hi, commit 63504e9e80acb35666f8689526c67dd99c4fb3ba (janitorial: Use
poll() instead of select().) appears to confuse the use of a SOCKET
with an int:

 #include "winsock2.h"
 #include "windef.h"
@@ -302,13 +311,12 @@ static UCHAR NetBTWaitForNameResponse(const
NetBTAdapter *adapter, SOCKET fd,
     while (!found && ret == NRC_GOODRET && (now = GetTickCount()) < waitUntil)
     {
         DWORD msToWait = waitUntil - now;
-        struct fd_set fds;
-        struct timeval timeout = { msToWait / 1000, msToWait % 1000 };
+        struct pollfd pfd;
         int r;

-        FD_ZERO(&fds);
-        FD_SET(fd, &fds);
-        r = select(fd + 1, &fds, NULL, NULL, &timeout);
+        pfd.fd = fd;
+        pfd.events = POLLIN;
+        r = poll(&pfd, 1, msToWait);

I can't imagine how this could work.  Notice that netapi32 is linked
against ws2_32, includes winsock2.h, and that fd is a SOCKET.  Could
this part of the commit be reverted, please?
--Juan


From m.b.lankhorst at gmail.com  Mon Mar 24 10:54:34 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 24 Mar 2008 08:54:34 -0700
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
In-Reply-To: <87skygqpf1.fsf@wine.dyndns.org>
References: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
	<87skygqpf1.fsf@wine.dyndns.org>
Message-ID: <b130c85e0803240854n71dd0daao43a7272f85d84916@mail.gmail.com>

Hello Dan and AJ,

2008/3/24, Alexandre Julliard <julliard at winehq.org>:
> "Dan Kegel" <dank at kegel.com> writes:
>
>  > +static void test_negative_dest_length(void)
>  > +{
>  > +    int len;
>  > +    char buf[10];
>  > +
>  > +    /* Test return on negative dest length */
>  > +    SetLastError( 0xdeadbeef );
>  > +    memset(buf,'x',sizeof(buf));
>  > +    len = WideCharToMultiByte(CP_ACP, 0, foobarW, -1, buf, -1, NULL, NULL);
>  > +    ok(len == 0 && GetLastError() == ERROR_INVALID_PARAMETER,
>  > +       "WideCharToMultiByte(destlen -1): len=%d error=%x\n", len, GetLastError());
>
>  If you want to determine the behavior for negative values you have to
>  test more than just -1, it may well be special.
The test is valid at least on xp, however it could be that wine
internally relies on the broken behavior, so I'm not 100% sure whether
it can be committed without checking for that first?

Cheers,
Maarten


From kai.blin at gmail.com  Mon Mar 24 11:06:43 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 24 Mar 2008 17:06:43 +0100
Subject: Confusing SOCKET and int in netapi32
In-Reply-To: <3a768c550803240832l78bd03d0ld4151d70fb7c9a@mail.gmail.com>
References: <3a768c550803240832l78bd03d0ld4151d70fb7c9a@mail.gmail.com>
Message-ID: <200803241706.48440.kai.blin@gmail.com>

On Monday 24 March 2008 16:32:29 Juan Lang wrote:
> Hi, commit 63504e9e80acb35666f8689526c67dd99c4fb3ba (janitorial: Use
> poll() instead of select().) appears to confuse the use of a SOCKET
> with an int:

D'oh, you're right. I've sent a partial revert for this. Seems like that part 
isn't tested, as make test in netapi32 worked without any problems.

Thanks for the catch,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080324/97ea70ea/attachment.pgp 

From juan.lang at gmail.com  Mon Mar 24 11:09:29 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Mon, 24 Mar 2008 09:09:29 -0700
Subject: Confusing SOCKET and int in netapi32
In-Reply-To: <200803241706.48440.kai.blin@gmail.com>
References: <3a768c550803240832l78bd03d0ld4151d70fb7c9a@mail.gmail.com>
	<200803241706.48440.kai.blin@gmail.com>
Message-ID: <3a768c550803240909y244d7c34h86241f33d9acea70@mail.gmail.com>

>  D'oh, you're right. I've sent a partial revert for this. Seems like that part
>  isn't tested, as make test in netapi32 worked without any problems.

Right, there isn't any way to test it.  We can't run NBT servers in
Wine as normal users (requires a low port #, conflicts with Samba),
and we can't count on an external server being present.

--Juan


From truiken at gmail.com  Mon Mar 24 11:15:06 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 24 Mar 2008 11:15:06 -0500
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
In-Reply-To: <b130c85e0803240854n71dd0daao43a7272f85d84916@mail.gmail.com>
References: <a71bd89a0803211843j5bf05b3die054817766180cf5@mail.gmail.com>
	<87skygqpf1.fsf@wine.dyndns.org>
	<b130c85e0803240854n71dd0daao43a7272f85d84916@mail.gmail.com>
Message-ID: <22821af30803240915w77f600f6ieb0d65afbb86c04b@mail.gmail.com>

On Mon, Mar 24, 2008 at 10:54 AM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Hello Dan and AJ,
>
>  2008/3/24, Alexandre Julliard <julliard at winehq.org>:
>
>
> > "Dan Kegel" <dank at kegel.com> writes:
>  >
>  >  > +static void test_negative_dest_length(void)
>  >  > +{
>  >  > +    int len;
>  >  > +    char buf[10];
>  >  > +
>  >  > +    /* Test return on negative dest length */
>  >  > +    SetLastError( 0xdeadbeef );
>  >  > +    memset(buf,'x',sizeof(buf));
>  >  > +    len = WideCharToMultiByte(CP_ACP, 0, foobarW, -1, buf, -1, NULL, NULL);
>  >  > +    ok(len == 0 && GetLastError() == ERROR_INVALID_PARAMETER,
>  >  > +       "WideCharToMultiByte(destlen -1): len=%d error=%x\n", len, GetLastError());
>  >
>  >  If you want to determine the behavior for negative values you have to
>  >  test more than just -1, it may well be special.
>  The test is valid at least on xp, however it could be that wine
>  internally relies on the broken behavior, so I'm not 100% sure whether
>  it can be committed without checking for that first?
>

It's invalid because -1 may be a special case, as Alexandre stated.
That is, there may be a difference between length -1 and length -x,
where x is a positive integer > 1.

-- 
James Hawkins


From truiken at gmail.com  Mon Mar 24 12:51:13 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 24 Mar 2008 12:51:13 -0500
Subject: [Bug 9484] Program refuses to run because of ProtectCD/
	ProtectDISC copy-protection
In-Reply-To: <E1JdqiA-0001ij-Ul@wine.codeweavers.com>
References: <bug-9484-11@http.bugs.winehq.org/>
	<E1JdqiA-0001ij-Ul@wine.codeweavers.com>
Message-ID: <22821af30803241051g2b04962cub3749ee800bb96f7@mail.gmail.com>

On 3/24/08, wine-bugs at winehq.org <wine-bugs at winehq.org> wrote:
> http://bugs.winehq.org/show_bug.cgi?id=9484
>
>
> --- Comment #9 from Austin English <austinenglish at gmail.com>  2008-03-24 12:43:54 ---
>  Can anyone test this in wine 0.9.58? Some other copy protections are working
>  better, and if this isn't working yet, we might want to delay it to wine 1.2...
>

What's the point of having a blocker list if we keep deferring those
bugs?  Granted not every bug in the list deserves a spot, but we need
to knuckle down and get these bugs fixed.  When we get closer to the
release date, we can get a better idea of which bugs are not feasible
to fix before the release.  Until that point, this bug list needs to
receive top priority.

-- 
James Hawkins


From truiken at gmail.com  Mon Mar 24 12:33:05 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 24 Mar 2008 12:33:05 -0500
Subject: Download.template: Update PC-BSD download link and icon [Resend]
In-Reply-To: <b6bb06270803241005m353613a8l9baba479359114fc@mail.gmail.com>
References: <b6bb06270803241005m353613a8l9baba479359114fc@mail.gmail.com>
Message-ID: <22821af30803241033i3c3811fey9a8f3d447627cf7e@mail.gmail.com>

On 3/24/08, Austin English <austinenglish at gmail.com> wrote:
> Not sure why it wasn't applied the first time. Didn't receive any
>  comments on it. Anywho, in case it was accidently sent to /dev/null,
>  here it is again. Fixes bug 12095.
>  http://bugs.winehq.org/show_bug.cgi?id=12095
>

No patch attached.

-- 
James Hawkins


From austinenglish at gmail.com  Mon Mar 24 13:02:27 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 24 Mar 2008 13:02:27 -0500
Subject: [Bug 9484] Program refuses to run because of ProtectCD/
	ProtectDISC copy-protection
In-Reply-To: <22821af30803241051g2b04962cub3749ee800bb96f7@mail.gmail.com>
References: <bug-9484-11@http.bugs.winehq.org/>
	<E1JdqiA-0001ij-Ul@wine.codeweavers.com>
	<22821af30803241051g2b04962cub3749ee800bb96f7@mail.gmail.com>
Message-ID: <b6bb06270803241102g5c991ab5y877e35f8962138a1@mail.gmail.com>

On Mon, Mar 24, 2008 at 12:51 PM, James Hawkins <truiken at gmail.com> wrote:
> On 3/24/08, wine-bugs at winehq.org <wine-bugs at winehq.org> wrote:
>  > http://bugs.winehq.org/show_bug.cgi?id=9484
>  >
>  >
>  > --- Comment #9 from Austin English <austinenglish at gmail.com>  2008-03-24 12:43:54 ---
>  >  Can anyone test this in wine 0.9.58? Some other copy protections are working
>  >  better, and if this isn't working yet, we might want to delay it to wine 1.2...
>  >
>
>  What's the point of having a blocker list if we keep deferring those
>  bugs?  Granted not every bug in the list deserves a spot, but we need
>  to knuckle down and get these bugs fixed.  When we get closer to the
>  release date, we can get a better idea of which bugs are not feasible
>  to fix before the release.  Until that point, this bug list needs to
>  receive top priority.
>
>  --
>  James Hawkins
>

I was going through a few of the 1.0 bugs that haven't been tested in
a while. Since it has no demo, I can't personally test it, and was
trying to see if any progress has been made in the past few months (as
has been with SafeDisc). While it is certainly hard to tell if it can
be fixed by 1.0, having someone test it and see how much closer we are
to fixing it is the first step in figuring that out.


From truiken at gmail.com  Mon Mar 24 13:06:30 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 24 Mar 2008 13:06:30 -0500
Subject: [Bug 9484] Program refuses to run because of ProtectCD/
	ProtectDISC copy-protection
In-Reply-To: <b6bb06270803241102g5c991ab5y877e35f8962138a1@mail.gmail.com>
References: <bug-9484-11@http.bugs.winehq.org/>
	<E1JdqiA-0001ij-Ul@wine.codeweavers.com>
	<22821af30803241051g2b04962cub3749ee800bb96f7@mail.gmail.com>
	<b6bb06270803241102g5c991ab5y877e35f8962138a1@mail.gmail.com>
Message-ID: <22821af30803241106t1ff4c08cw81fde6ad3cc05db@mail.gmail.com>

On Mon, Mar 24, 2008 at 1:02 PM, Austin English <austinenglish at gmail.com> wrote:
>
> On Mon, Mar 24, 2008 at 12:51 PM, James Hawkins <truiken at gmail.com> wrote:
> > On 3/24/08, wine-bugs at winehq.org <wine-bugs at winehq.org> wrote:
> >  > http://bugs.winehq.org/show_bug.cgi?id=9484
> >  >
> >  >
> >  > --- Comment #9 from Austin English <austinenglish at gmail.com>  2008-03-24 12:43:54 ---
> >  >  Can anyone test this in wine 0.9.58? Some other copy protections are working
> >  >  better, and if this isn't working yet, we might want to delay it to wine 1.2...
> >  >
> >
> >  What's the point of having a blocker list if we keep deferring those
> >  bugs?  Granted not every bug in the list deserves a spot, but we need
> >  to knuckle down and get these bugs fixed.  When we get closer to the
> >  release date, we can get a better idea of which bugs are not feasible
> >  to fix before the release.  Until that point, this bug list needs to
> >  receive top priority.
> >
> >  --
> >  James Hawkins
> >
>
> I was going through a few of the 1.0 bugs that haven't been tested in
> a while. Since it has no demo, I can't personally test it, and was
> trying to see if any progress has been made in the past few months (as
> has been with SafeDisc). While it is certainly hard to tell if it can
> be fixed by 1.0, having someone test it and see how much closer we are
> to fixing it is the first step in figuring that out.
>

No objection there.  My point about deferring bugs stands though.

-- 
James Hawkins


From alex at thehandofagony.com  Mon Mar 24 13:16:54 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Mon, 24 Mar 2008 19:16:54 +0100
Subject: Appdb request: allow browsing for downloadable platinum apps
In-Reply-To: <a71bd89a0803181610w12d2c53fq880a301ab110b8ea@mail.gmail.com>
References: <a71bd89a0803181610w12d2c53fq880a301ab110b8ea@mail.gmail.com>
Message-ID: <200803241916.55294.alex@thehandofagony.com>

> The appdb has a "browse by rating" and a "browse downloadable"
> option, but there's no way to combine them.
>
> Can we add a 'downloadable' checkbox in the 'browse by rating'
> page, maybe?

We do have some filtering code lying around; hopefully there will be time to 
merge it in soon.


Alexander N. S?rnes


From julliard at winehq.org  Mon Mar 24 13:33:47 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 24 Mar 2008 19:33:47 +0100
Subject: winex11.drv: Don't add owned windows to the taskbar
In-Reply-To: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com> (Dmitry Timoshkov's
	message of "Mon, 24 Mar 2008 14:33:34 +0800")
References: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com>
Message-ID: <87fxugnf90.fsf@wine.dyndns.org>

Dmitry Timoshkov <dmitry at codeweavers.com> writes:

> this patch fixes the bug 12160. According to my tests explorer in XP
> doesn't add owned windows to the taskbar.

Do we really want to remove them from the pager too?

-- 
Alexandre Julliard
julliard at winehq.org


From mishra.anurag07 at gmail.com  Mon Mar 24 14:00:33 2008
From: mishra.anurag07 at gmail.com (Anurag Mishra)
Date: Tue, 25 Mar 2008 00:30:33 +0530
Subject: Fwd: Questions regarding Summer of Code( and Dplay)
In-Reply-To: <e7ea0e360803241200v5007b504m3e40e52e2c1dda59@mail.gmail.com>
References: <e7ea0e360803192102i730d6fb2i5584209783ff27f3@mail.gmail.com>
	<b130c85e0803192251i19bce0eeof6fa098503273806@mail.gmail.com>
	<e7ea0e360803241200v5007b504m3e40e52e2c1dda59@mail.gmail.com>
Message-ID: <e7ea0e360803241200h302f64f8va363dbbb0fdf6178@mail.gmail.com>

---------- Forwarded message ----------
From: Anurag Mishra <mishra.anurag07 at gmail.com>
Date: Tue, Mar 25, 2008 at 12:30 AM
Subject: Re: Questions regarding Summer of Code( and Dplay)
To: Maarten Lankhorst <m.b.lankhorst at gmail.com>


Hi,
  I have already compiled git version and am learning the basics of
 using git now.
  Someone on irc suggested to first write test cases about the
 functions in wine(that may be missing) and crosscheck on windows.
 Right now, I am looking to start in that direction.

 Thanks,
 Anurag.



 On Thu, Mar 20, 2008 at 11:21 AM, Maarten Lankhorst
 <m.b.lankhorst at gmail.com> wrote:
 > Hello Anurag,
 >
 >  2008/3/19, Anurag Mishra <mishra.anurag07 at gmail.com>:
 >
 >
 > >   I am student at IIT Kanpur[1]. I have quite good knowledge about C
 >  >  and have been tracking development of Wine over a period of 6 months
 >  >  or so. I have good knowledge about C(and using it theoretically to
 >  >  implement stacks, efficient structures and so on). However, I have
 >  >  little real life experience about programming a project. I have little
 >  >  experience about Window's API.
 >  >   I was looking to participate in Wine development this summer. On SoC
 >  >  page, the idea of Dplay was bought up. I am interested in trying hands
 >  >  on that. Can anyone suggest what would be a good starting point?
 >
 >  There are only a few important things to directplay as far as I know.
 >  The first one is find a game that runs in wine and uses it, and works
 >  reasonably well single player but not at all multiplayer or online
 >  because of the missing things (fixmes on dplay in console). After you
 >  played the game a little bit, think of a plan on how you want to
 >  tackle this problem.
 >
 >  Have you managed to compile a git version of wine yet?
 >
 >  Cheers,
 >  Maarten.
 >


From julliard at winehq.org  Mon Mar 24 15:17:21 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 24 Mar 2008 21:17:21 +0100
Subject: user32: Implement BroadcastSystemMessage, try 5.1
In-Reply-To: <b130c85e0803240515y66991587x19c0cebb899d7461@mail.gmail.com>
	(Maarten Lankhorst's message of "Mon, 24 Mar 2008 05:15:11 -0700")
References: <b130c85e0803240515y66991587x19c0cebb899d7461@mail.gmail.com>
Message-ID: <87zlsnnage.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> +    TRACE("Flags: %08x, recipients: %p(0x%x), msg: %04x, wparam: %08lx, lparam: %08lx\n", flags, recipients,
> +         (recipients ? *recipients : recips), msg, wp, lp);
> +
> +    if (flags > BSF_LUID)

It doesn't make sense to compare flags with >. What are you trying to
check for?

> -}
> +    else
> +        FIXME("Recipients %08x not supported!\n", *recipients);
> +
> +    if (ret > 0 && !GetLastError())
> +        SetLastError(lasterror);

In general if you have to save and restore last error you are doing
something wrong.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Mon Mar 24 15:20:09 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 24 Mar 2008 21:20:09 +0100
Subject: (resend)imm: implement ImmGetIMEFileNameW and ImmGetIMEFileNameA
	correct registry lookups
In-Reply-To: <47E7D1C5.1010409@codeweavers.com> (Aric Stewart's message of
	"Mon, 24 Mar 2008 11:07:33 -0500")
References: <47E7D1C5.1010409@codeweavers.com>
Message-ID: <87ve3bnabq.fsf@wine.dyndns.org>

Aric Stewart <aric at codeweavers.com> writes:

> +    if (rc > 0)
> +    {
> +        if (uBufLen && lpszFileName)
> +            rc = WideCharToMultiByte(CP_ACP, 0, bufW, uBufLen, lpszFileName,
> +                                 uBufLen, NULL, NULL);
> +        else /* get the length */
> +            rc = WideCharToMultiByte(CP_ACP, 0, bufW, wBufLen, NULL, 0, NULL,
> +                                     NULL);

The source length should be -1, you don't want to convert the whole
buffer.

> +    static CHAR KeyboardKey[] = "System\\CurrentControlSet\\Control\\Keyboard Layouts";
> +    static WCHAR szImeFileW[] = {'I','m','e',' ','F','i','l','e',0};
> +
> +    HKEY keyboardKey;
> +    DWORD length;
> +    DWORD rc;
> +    CHAR regKey[sizeof(KeyboardKey) + 11];
> +
> +    wsprintfA( regKey, "%s\\%08x", KeyboardKey, (unsigned)hKL );
> +    rc = RegOpenKeyA( HKEY_LOCAL_MACHINE, regKey, &keyboardKey);

This should use Unicode like the rest of the function.

-- 
Alexandre Julliard
julliard at winehq.org


From thestig at google.com  Mon Mar 24 17:05:01 2008
From: thestig at google.com (Lei Zhang)
Date: Mon, 24 Mar 2008 15:05:01 -0700
Subject: bugzilla patches
Message-ID: <558b2f5c0803241505q643908ebn4a0cbf08672d4c48@mail.gmail.com>

Hi,

Can someone take a look at my bugzilla patches from over a week ago?

http://www.winehq.org/pipermail/wine-patches/2008-March/051551.html
http://www.winehq.org/pipermail/wine-patches/2008-March/051552.html
http://www.winehq.org/pipermail/wine-patches/2008-March/051553.html
http://www.winehq.org/pipermail/wine-patches/2008-March/051768.html

- Lei


From jnewman at codeweavers.com  Mon Mar 24 17:20:01 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Mon, 24 Mar 2008 17:20:01 -0500
Subject: bugzilla patches
In-Reply-To: <558b2f5c0803241505q643908ebn4a0cbf08672d4c48@mail.gmail.com>
References: <558b2f5c0803241505q643908ebn4a0cbf08672d4c48@mail.gmail.com>
Message-ID: <47E82911.5010605@codeweavers.com>

I plan to, just in the middle of a ton of CW work ATM.

Lei Zhang wrote:
> Hi,
> 
> Can someone take a look at my bugzilla patches from over a week ago?
> 
> http://www.winehq.org/pipermail/wine-patches/2008-March/051551.html
> http://www.winehq.org/pipermail/wine-patches/2008-March/051552.html
> http://www.winehq.org/pipermail/wine-patches/2008-March/051553.html
> http://www.winehq.org/pipermail/wine-patches/2008-March/051768.html
> 
> - Lei
> 
> 


From cesar at ecuarock.net  Mon Mar 24 19:38:31 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Mon, 24 Mar 2008 19:38:31 -0500
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <63ee2bc70803231611k31e16781j82f1de4e6cb73cf4@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<47D0296F.9020404@gmx.net>
	<e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>
	<e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>
	<63ee2bc70803231611k31e16781j82f1de4e6cb73cf4@mail.gmail.com>
Message-ID: <e3d3ae8f0803241738j174283e7na8ce59616bfa20c7@mail.gmail.com>

On Sun, Mar 23, 2008 at 6:11 PM, Corey McClymonds <galeru at gmail.com> wrote:
> On 3/23/08, Cesar Izurieta <cesar at ecuarock.net> wrote:
>  > Here are some ideas of what I think could be implemented for the FUSE
>  >  project for GSOC.
>  >
>  >  - This FUSE can be a "proxy" filesystem. This means that we could use
>  >  an existing filesystem and mount this proxy filesystem and make it
>  >  appear as case insensitive. This means that if there's a file named
>  >  "A.txt" on a folder and I copy "a.txt", "A.txt" should be overridden.
>  >  Same logic for other cases.
>  >
>  >  - A utility to test for invalid filenames (like "A.txt" and "a.txt" on
>  >  the same original directory)
>  >
>  >  - Is there any need to simulate windows' permission schemes
>  >  (inheritance, ACLs) when using this filesystem?
>  >
>  >  - Since this will be a proxy filesystem, there is the chance to
>  >  present some folders with different names. For example "Program Files"
>  >  could be presented as "Archivos de Programa" when mounting the
>  >  filesystem with a Spanish locale. The original folder will be still
>  >  there and you could cd to it and both will point to the same back end
>  >  folder.
>  >
>  >  If you have any other ideas please let me know.
>  >
>  >  Cesar
>
>  Are you going to do integration under wine, or are you going to just
>  do the file system.  For instance, what happens if you run wine in a
>  folder that isn't case insensitive?
>

You could mount a case insensitive proxy to the whole file system
(starting from /) somewhere in .wine, maybe .wine/drives/x or
something like that and have wine access files only through .wine and
never from outside.

I'm pretty sure this could have performance penalties but I guess we
will have to find out how much performance you loose by using this
approach using some benchmarking tools or writing some test code for
that.


From cesar at ecuarock.net  Mon Mar 24 19:45:11 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Mon, 24 Mar 2008 19:45:11 -0500
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <200803241428.10359.kai.blin@gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<e3d3ae8f0803061547p5fdbd9cas4c7a2807eee7c777@mail.gmail.com>
	<e3d3ae8f0803230906vb7e6c14od0b3dd5b3f3db00c@mail.gmail.com>
	<200803241428.10359.kai.blin@gmail.com>
Message-ID: <e3d3ae8f0803241745h2c83d4d6lcb02059b211eddd7@mail.gmail.com>

On Mon, Mar 24, 2008 at 8:28 AM, Kai Blin <kai.blin at gmail.com> wrote:
> On Sunday 23 March 2008 17:06:43 Cesar Izurieta wrote:
>  > Here are some ideas of what I think could be implemented for the FUSE
>  > project for GSOC.
>  >
>  > - This FUSE can be a "proxy" filesystem. This means that we could use
>  > an existing filesystem and mount this proxy filesystem and make it
>  > appear as case insensitive. This means that if there's a file named
>  > "A.txt" on a folder and I copy "a.txt", "A.txt" should be overridden.
>  > Same logic for other cases.
>  >
>  > - A utility to test for invalid filenames (like "A.txt" and "a.txt" on
>  > the same original directory)
>
>  Perhaps this shouldn't be an extra tool but more like a setting what to do in
>  a case like that.
>

That sounds good. Maybe doing something like what windows does to long
file names when looking those files in a console, for example
"C:\Program Files" gets converted to "C:\Progra~1", we could apply the
same logic, have the first file "A.txt" and the second "a~1.txt". What
do you think?

>
>  > - Is there any need to simulate windows' permission schemes
>  > (inheritance, ACLs) when using this filesystem?
>
>  Alexandre said that wasn't interesting until Wine goes multi-user. So don't
>  worry about that for now.
>
>
>  > - Since this will be a proxy filesystem, there is the chance to
>  > present some folders with different names. For example "Program Files"
>  > could be presented as "Archivos de Programa" when mounting the
>  > filesystem with a Spanish locale. The original folder will be still
>  > there and you could cd to it and both will point to the same back end
>  > folder.
>
>  I'm not sure if that's really useful. IIRC wineprefixcreate already creates a
>  localized directory layout.
>
>  Cheers,
>  Kai
>
>  --
>  Kai Blin
>  WorldForge developer  http://www.worldforge.org/
>  Wine developer        http://wiki.winehq.org/KaiBlin
>  Samba team member     http://www.samba.org/samba/team/
>  --
>  Will code for cotton.
>
>
>
>


From stefan at codeweavers.com  Mon Mar 24 20:21:15 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 25 Mar 2008 02:21:15 +0100
Subject: [PATCH 9/9] d3d9/tests: Fix precision problems in shademode_test.
In-Reply-To: <47E8417A.6090104@inbox.lv>
References: <47E8417A.6090104@inbox.lv>
Message-ID: <200803250221.15369.stefan@codeweavers.com>

Am Dienstag, 25. M?rz 2008 01:04:10 schrieb Alexander Dorofeyev:
> ---
>   dlls/d3d9/tests/visual.c |   26 +++++++++++++++++++++-----
>   1 files changed, 21 insertions(+), 5 deletions(-)
The drawback of this is that if a driver behaves differently in 
D3DSHADEMODE_PHONG this will slip through as imprecision most likely. That is 
something we have to live with I am afraid


From raccoonone at procyongames.com  Tue Mar 25 00:18:50 2008
From: raccoonone at procyongames.com (Christopher)
Date: Mon, 24 Mar 2008 22:18:50 -0700
Subject: USB Human Interface Device support
Message-ID: <47E88B3A.3060003@procyongames.com>

I have a flight sim, PhoenixRC, which I'd like to get working under 
Wine. As of a couple months ago most of the DirectX problems have been 
fixed, but the game uses a USB adapter to connect various controllers to 
the computer. The USB adapter is an HID and is recognized by Linux; 
however I can't get it to work through Wine. At least part of the 
problem seems to be that SetupDiGetClassDevs calls 
SETUPDI_EnumerateInterfaces which tries to open registry keys that don't 
exist. There isn't an entry in 
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses for 
HID interfaces, in fact that whole set of registry keys seems to be 
missing. Is anyone working on patches to make this work, or can someone 
point me to the function(s) that need to be implemented for HIDs to be 
setup in the registry correctly? I'm not sure when/how those keys are 
suppose to be created.
Thanks,
Christopher Berner


From dank at kegel.com  Tue Mar 25 00:50:25 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 24 Mar 2008 22:50:25 -0700
Subject: Wine 1.0 status: T minus 74 days. 78 open bugs.
Message-ID: <a71bd89a0803242250g392d1c48r15094dd056bca78c@mail.gmail.com>

Today, three bugs were resolved:
4803   programs        5       Steam: not all lnk files are processed
into linux shortcuts
10032  winsock         1       Wine must not use unix select() for
networking where there might be high fd's
11431  user32  5       Adobe Photoshop CS2: z-overlay of image containers
(although 10032's fix went too far, and one hunk is pending reversion).

and one bug was deferred:
7915   -unknown        4       15 of the internal tests of wine fail on Mac OS X

History:
3/22: 87 bugs, 76 days to go
3/23: 82 bugs, 75 days to go
3/24: 78 bugs, 74 days to go
Excellent progress.  Too bad past performance is no indication of
future results :-)

Here's a list of the currently open 1.0 bugs, sorted by component, with votes:
5948    -unknown  	1  	Star Trek: Armada does not install
11281 	-unknown 	2 	CJK input many issues
5024 	-unknown 	4 	Thief: Deadly Shadows crashes:page fault on read
access to 0x0000040c
8125 	-unknown 	0 	Marratech 6.1 crashes on start
9916 	-unknown 	6 	"make test" usually fails
5061 	-unknown 	6 	Copying from Windows Firefox in Wine and pasting to
Linux OpenOffice pastes metadata as data
9459 	-unknown 	8 	FIFA 2007 crashes with the recent versions
12097 	-unknown 	2 	Wine 1.0 should not ship out-of-sync resource translations
7477 	-unknown 	1 	Uplink demo crashes
4971 	-unknown 	3 	Corel Draw 12 demo install fails
9178 	-unknown 	7 	"hello world" dos program hangs
5055 	-unknown 	5 	Deleting files from a window in wine doesn't send
them to the Trash
5844 	-unknown 	9 	tray minimize
10815 	-unknown 	2 	Cannot drag images into Adobe Photoshop 7 from the
web / desktop
7404 	-unknown 	2 	ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
5402 	-unknown 	0 	Trying to run PhotoStitch 3.1
10147 	-unknown 	0 	Word Viewer 2003 - Tab behavior differs from Windows
9959 	-unknown 	8 	Make wine updates work even if the registry changed
556 	build-en 	2 	Reconcile the Windows and Wine spec files
1114 	comctl32 	2 	Winrar2.90/3.00: Comboex doesn't trigger a event
when you mouse-click in some value of it
2493 	comctl32 	1 	Multi-select listview: Shift-arrow up only selects
top two items
10111 	comctl32 	2 	WINEDEBUG=warn+heap "make test" has heap error in
comdlg32/tests/printdlg.c
9104 	comdlg32 	2 	Pdf-xchange viewer crashes
10040 	crypt32 	2 	Steam crashes during the startup
11681 	directx- 	13 	Add support for video overlay
5955 	directx- 	6 	DirectDrawCreate crash on non-OpenGL desktop
9030 	directx- 	0 	army men hangs on black screen
82 	document 	1 	Stabilize Winelib User Guide Table of Contents
638 	document 	7 	Document Wine debugging channels
6519 	gdi32 	7 	Wine blacks out rotated font bitmap
9771 	gdi32 	37 	Steam Friends doesn't work (fails to render correctly
or refresh)
3270 	gdi32 	13 	Problem with minimized top-level windows
9926 	gdi32 	4 	gdi32.dll should not have exported function pointers
7571 	gdi32 	1 	Accented character glyphs are mixed up with TrueType
fonts (affects e.g. Lotus Notes R5)
9484 	kernel32 	17 	Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
5351 	kernel32 	8 	Windows Installer 3.1 cannot install because of
non-standard drive labeling
5541 	kernel32 	0 	WriteConsole can't write to stdout; affects e.g.
wsh's cscript's usage message
9039 	kernel32 	0 	GS-Auftrag Professional SQL aborts on startup
4733 	kernel32 	4 	Get optimized/compressed/packed executables (non-upx) working
7098 	mscoree 	1 	RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
5163 	msi 	12 	Office XP 2002 crashes on installation
8783 	ntdll 	11 	USB serial ports do not work
9356 	ntdll 	6 	Serial communication not working since wine-0.9.33
6607 	ole 	8 	Drag and Drop not working
9942 	ole 	2 	Powerpoint Viewer 2007 crashes opening .pptx files
2539 	ole 	3 	XDND (Drag and drop for X Windows) doesn't copy text
8095 	ole 	0 	PQ Teaching toy crashes
4770 	ole 	2 	BlackBerry Device Manager fails to install under wine
5926 	programs 	0 	Wine does not provide an implementation of winhlp32.exe
6254 	richedit 	4 	Installer infinite loop from rich text error
9304 	shdocvw 	3 	Temple of Elemental Evil demo doesn't start - gui irresponsive
8898 	shdocvw 	0 	Run Time Error "445": Object doesn't support this
action in Europa Knowledgebase
3546 	shdocvw 	2 	CLSID_InternetShortcut not available...
6095 	shdocvw 	11 	MOTD in counter-strike 1.6 and counter-strike
source does not render
8439 	shell32 	5 	Visual Studio .NET (7) install fails
10905 	shell32 	0 	thinstall firefox demo requires native msvcrt
9809 	shell32 	4 	Autodesk Revit Architecture 2008 install fails
11742 	shlwapi 	8 	Small .net 1.1 app (FastMD5 1.3) fails to start up
12074 	testcase 	2 	The conformance tests fail on Windows
6604 	tools 	2 	Ship icons for the wine-tools that can be used in .desktop files
8246 	urlmon 	3 	invoking htmlhelp:HtmlHelpW crashes wine
664 	user32 	5 	The help menu functionality inside programs is broken
(messaging problem)
3023 	user32 	5 	Orcad - "Place Part" never tries to put down a part
4523 	user32 	5 	Can't copy from Firefox 1.5 and paste into OpenOffice
2 under Wine
124 	wineserv 	2 	Review of Wine Server Protocol
5623 	winex11. 	2 	GetAsyncKeyState wrong if querying process doesn't have focus
3297 	winex11. 	11 	UpdateWindow() doesn't call XFlush()
5828 	winex11. 	24 	Command and Conquer Generals (Zero Hour) doesn't
change the mouse cursor from the default X mouse
7372 	winex11. 	12 	can't copy and paste between gnome apps eg
openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
2368 	winex11. 	5 	Wine loses its X-Window when switching to another
virt. desktop in Fvwm
11019 	winex11. 	1 	matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
11884 	winex11. 	1 	Copy and paste garbage on end
1990 	winex11. 	1 	modifier keys not released when switching desktop
10984 	winex11. 	2 	sun jre 5 update 10 installer hangs in 0.9.52
3711 	wininet 	1 	Musicmatch fails to install (missing registry key,
HTTP_HttpOpenRequest() problem)
5625 	wininet 	3 	Wine does not handle internet proxy settings conveniently
9787 	winsock 	45 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
12005 	wintab32 	0 	Regression in pressure sensitivity with wizardpen
tablet driver and Photoshop 7


From kai.blin at gmail.com  Tue Mar 25 02:26:50 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Tue, 25 Mar 2008 08:26:50 +0100
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <e3d3ae8f0803241745h2c83d4d6lcb02059b211eddd7@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<200803241428.10359.kai.blin@gmail.com>
	<e3d3ae8f0803241745h2c83d4d6lcb02059b211eddd7@mail.gmail.com>
Message-ID: <200803250826.55379.kai.blin@gmail.com>

On Tuesday 25 March 2008 01:45:11 Cesar Izurieta wrote:

> >  Perhaps this shouldn't be an extra tool but more like a setting what to
> > do in a case like that.
>
> That sounds good. Maybe doing something like what windows does to long
> file names when looking those files in a console, for example
> "C:\Program Files" gets converted to "C:\Progra~1", we could apply the
> same logic, have the first file "A.txt" and the second "a~1.txt". What
> do you think?

Well, that's probably an option. But I wouldn't even mind a mode that simply 
deletes one of A.txt or a.txt on mounting. If we start using a file system 
like that for ~/.wine/drive_c and people want to screw around in that 
directory manually, we can expect them to know what they're doing.

Cheers,
Kai
-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080325/b99780d3/attachment.pgp 

From thunderbird2k at gmx.net  Tue Mar 25 03:45:24 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 25 Mar 2008 09:45:24 +0100
Subject: [PATCH 8/9] wined3d: remove ENTER_GL/LEAVE_GL in texture and cube
	texture PreLoad.
In-Reply-To: <47E84178.6070908@inbox.lv>
References: <47E84178.6070908@inbox.lv>
Message-ID: <20080325084524.44120@gmx.net>

> 
> Not really needed for anything and can lead to ActivateContext being
> called 
> while holding lock.
> ---
>   dlls/wined3d/cubetexture.c |    2 --
>   dlls/wined3d/texture.c     |    3 +--
>   2 files changed, 1 insertions(+), 4 deletions(-)

Sure this is a problem but there needs to be a place which calls ENTER_GL/LEAVE_GL. I believe LoadTexture and some of the other functions aren't handling that properly yet, so I wouldn't add this yet.

It is very tricky.

Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.gmx.net/de/entertainment/games/free


From dmitry at codeweavers.com  Tue Mar 25 04:07:22 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 25 Mar 2008 17:07:22 +0800
Subject: Create stub dosx.exe
References: <47E87B6F.5080704@nexicom.net>
Message-ID: <015801c88e57$a42f2070$a600fea9@DMITRY>

"Justin Chevrier" <jchevrier at nexicom.net> wrote:

> +#define WIN32_LEAN_AND_MEAN
> +
> +#include <windows.h>

What's the reason to include anything in an empty stub?

> +int main(int argc, char *argv[])
> +{
> +    return 0;
> +}

-- 
Dmitry.


From paul.vriens.wine at gmail.com  Tue Mar 25 04:08:12 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 25 Mar 2008 10:08:12 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
Message-ID: <47E8C0FC.2010700@gmail.com>

Hi,

We didn't have a new winetest executable for the last few days. MinGW doesn't 
know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.

Especially while in the process of getting ready for 1.0 we should have winetest 
run as much as possible.

My main focus will be adding tests btw until 1.0 is out. These will be both 
tests to proof the correctness of the current implementation as well as tests to 
show missing stuff. There are loads of functions for which we have no tests yet 
and with the 1.0 in sight I think it becomes very important to have tests for 
virtually every function we (have) implement(ed).

-- 
Cheers,

Paul.


From truiken at gmail.com  Tue Mar 25 04:17:29 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 25 Mar 2008 04:17:29 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47E8C0FC.2010700@gmail.com>
References: <47E8C0FC.2010700@gmail.com>
Message-ID: <22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>

On Tue, Mar 25, 2008 at 4:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi,
>
>  We didn't have a new winetest executable for the last few days. MinGW doesn't
>  know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.
>
>  Especially while in the process of getting ready for 1.0 we should have winetest
>  run as much as possible.
>
>  My main focus will be adding tests btw until 1.0 is out. These will be both
>  tests to proof the correctness of the current implementation as well as tests to
>  show missing stuff. There are loads of functions for which we have no tests yet
>  and with the 1.0 in sight I think it becomes very important to have tests for
>  virtually every function we (have) implement(ed).
>

While that's a worthy goal, I think a better short-term goal for the
run up to 1.0 is to fix the current failing tests in Windows.

-- 
James Hawkins


From paul.vriens.wine at gmail.com  Tue Mar 25 04:27:24 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 25 Mar 2008 10:27:24 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
Message-ID: <47E8C57C.9030708@gmail.com>

James Hawkins wrote:
> On Tue, Mar 25, 2008 at 4:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> Hi,
>>
>>  We didn't have a new winetest executable for the last few days. MinGW doesn't
>>  know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.
>>
>>  Especially while in the process of getting ready for 1.0 we should have winetest
>>  run as much as possible.
>>
>>  My main focus will be adding tests btw until 1.0 is out. These will be both
>>  tests to proof the correctness of the current implementation as well as tests to
>>  show missing stuff. There are loads of functions for which we have no tests yet
>>  and with the 1.0 in sight I think it becomes very important to have tests for
>>  virtually every function we (have) implement(ed).
>>
> 
> While that's a worthy goal, I think a better short-term goal for the
> run up to 1.0 is to fix the current failing tests in Windows.
> 
But either way we need an up-to-date winetest executable ;-)

Fixing currently failing tests is as always top on my list as well until I have 
some real time to spend again on implementing stuff.

-- 
Cheers,

Paul.


From truiken at gmail.com  Tue Mar 25 04:30:42 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 25 Mar 2008 04:30:42 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47E8C57C.9030708@gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
Message-ID: <22821af30803250230k4b96628epb096b01290398501@mail.gmail.com>

On Tue, Mar 25, 2008 at 4:27 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>
> James Hawkins wrote:
>  > On Tue, Mar 25, 2008 at 4:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>  >> Hi,
>  >>
>  >>  We didn't have a new winetest executable for the last few days. MinGW doesn't
>  >>  know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.
>  >>
>  >>  Especially while in the process of getting ready for 1.0 we should have winetest
>  >>  run as much as possible.
>  >>
>  >>  My main focus will be adding tests btw until 1.0 is out. These will be both
>  >>  tests to proof the correctness of the current implementation as well as tests to
>  >>  show missing stuff. There are loads of functions for which we have no tests yet
>  >>  and with the 1.0 in sight I think it becomes very important to have tests for
>  >>  virtually every function we (have) implement(ed).
>  >>
>  >
>  > While that's a worthy goal, I think a better short-term goal for the
>  > run up to 1.0 is to fix the current failing tests in Windows.
>  >
>  But either way we need an up-to-date winetest executable ;-)
>

No argument there.  I've been waiting all weekend.  Hopefully we can
get the issue resolved and a new build out to test.

-- 
James Hawkins


From thunderbird2k at gmx.net  Tue Mar 25 04:39:48 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 25 Mar 2008 10:39:48 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47E8C0FC.2010700@gmail.com>
References: <47E8C0FC.2010700@gmail.com>
Message-ID: <20080325093948.145810@gmx.net>

> Hi,
> 
> We didn't have a new winetest executable for the last few days. MinGW
> doesn't 
> know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36
> tests.
> 
> Especially while in the process of getting ready for 1.0 we should have
> winetest 
> run as much as possible.
> 
> My main focus will be adding tests btw until 1.0 is out. These will be
> both 
> tests to proof the correctness of the current implementation as well as
> tests to 
> show missing stuff. There are loads of functions for which we have no
> tests yet 
> and with the 1.0 in sight I think it becomes very important to have tests
> for 
> virtually every function we (have) implement(ed).
> 
> -- 
> Cheers,
> 
> Paul.
> 

As a sidenote. You are also cross compiling wine dlls so now and then. It would be useful to also cross compile d3d8/d3d9 and wined3d but for wined3d -DUSE_WIN32_OPENGL must be set.

Roderick
-- 
Ist Ihr Browser Vista-kompatibel? Jetzt die neuesten 
Browser-Versionen downloaden: http://www.gmx.net/de/go/browser


From julliard at winehq.org  Tue Mar 25 05:08:58 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 25 Mar 2008 11:08:58 +0100
Subject: Create stub dosx.exe
In-Reply-To: <47E87B6F.5080704@nexicom.net> (Justin Chevrier's message of
	"Tue, 25 Mar 2008 00:11:27 -0400")
References: <47E87B6F.5080704@nexicom.net>
Message-ID: <877ifrund1.fsf@wine.dyndns.org>

Justin Chevrier <jchevrier at nexicom.net> writes:

> Changelog:
>
> Create stub dosx.exe

Why do you need this?

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Tue Mar 25 05:57:13 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 25 Mar 2008 11:57:13 +0100
Subject: [PATCH 7/9] wined3d: Make device palettes dynamically allocated.
In-Reply-To: <47E84175.7090205@inbox.lv> (Alexander Dorofeyev's message of
	"Tue, 25 Mar 2008 02:04:05 +0200")
References: <47E84175.7090205@inbox.lv>
Message-ID: <873aqful4m.fsf@wine.dyndns.org>

Alexander Dorofeyev <alexd4 at inbox.lv> writes:

> +    if (PaletteNumber >= This->NumberOfPalettes) {
> +        NewSize = This->NumberOfPalettes;
> +        do {
> +           NewSize *= 2;
> +        } while(PaletteNumber >= NewSize);
> +        palettes = HeapReAlloc(GetProcessHeap(), 0, This->palettes, sizeof(PALETTEENTRY[256]) * NewSize);

You should be using an array of pointers, not a single array for all
palettes, so that you don't need to move around the whole data on each
realloc.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Tue Mar 25 06:13:26 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 25 Mar 2008 12:13:26 +0100
Subject: WineD3D: Always report D16 (fixes bug 12130) [attempt 2]
In-Reply-To: <20080325102426.245230@gmx.net>
References: <20080325095746.230820@gmx.net> <20080325102426.245230@gmx.net>
Message-ID: <200803251213.26975.stefan@codeweavers.com>

> > 3dmark2000 broke recently because we aren't offering D16 anymore if a
> > card doesn't expose it using GLX. On a Geforce 8800 it isn't offered by
> > GLX (because the hardware is 24bit) but D3D9 on Windows offers it, so
> > offer it too. Second D3D <= 7 requires it too as at that time there was
> > no 24bit z-buffer.
The bug in 3Dmark2000 is a bug in ddraw, we do not report 24/32 bit formats in 
a way the game likes. I have a patch for that deep down in my sending queue 
that fixes the depth and stencil masks.

This patch is still perfectly valid, just pointing out that in case of 
3DMark2k it fixes the wrong bug. Other older apps are likely do demand D16, 
just 3Dmark2000 doesn't.



From aric at codeweavers.com  Tue Mar 25 06:28:49 2008
From: aric at codeweavers.com (Aric Stewart)
Date: Tue, 25 Mar 2008 06:28:49 -0500
Subject: (resend)imm: implement ImmGetIMEFileNameW and ImmGetIMEFileNameA
	correct registry lookups
In-Reply-To: <87ve3bnabq.fsf@wine.dyndns.org>
References: <47E7D1C5.1010409@codeweavers.com> <87ve3bnabq.fsf@wine.dyndns.org>
Message-ID: <47E8E1F1.1050909@codeweavers.com>

ok thanks. I will rework this.
-aric

Alexandre Julliard wrote:
> Aric Stewart <aric at codeweavers.com> writes:
> 
>> +    if (rc > 0)
>> +    {
>> +        if (uBufLen && lpszFileName)
>> +            rc = WideCharToMultiByte(CP_ACP, 0, bufW, uBufLen, lpszFileName,
>> +                                 uBufLen, NULL, NULL);
>> +        else /* get the length */
>> +            rc = WideCharToMultiByte(CP_ACP, 0, bufW, wBufLen, NULL, 0, NULL,
>> +                                     NULL);
> 
> The source length should be -1, you don't want to convert the whole
> buffer.
> 
>> +    static CHAR KeyboardKey[] = "System\\CurrentControlSet\\Control\\Keyboard Layouts";
>> +    static WCHAR szImeFileW[] = {'I','m','e',' ','F','i','l','e',0};
>> +
>> +    HKEY keyboardKey;
>> +    DWORD length;
>> +    DWORD rc;
>> +    CHAR regKey[sizeof(KeyboardKey) + 11];
>> +
>> +    wsprintfA( regKey, "%s\\%08x", KeyboardKey, (unsigned)hKL );
>> +    rc = RegOpenKeyA( HKEY_LOCAL_MACHINE, regKey, &keyboardKey);
> 
> This should use Unicode like the rest of the function.
> 


From mle+win at mega-nerd.com  Tue Mar 25 07:45:57 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Tue, 25 Mar 2008 23:45:57 +1100
Subject: Patch : fixme:msvcrt:MSVCRT__sopen : pmode 0x01a0 ignored
Message-ID: <20080325234557.8fc781fc.mle+win@mega-nerd.com>

Hi all,

My interest in Wine is mainly because it allows me run the test suite
for my projects when I use the Linux -> windows MinGW compiler.

Currently, the programs in my test suite spit out a lot of fixme
warnings like:

    fixme:msvcrt:MSVCRT__sopen : pmode 0x01a0 ignored

I've tracked this down in the code to the function in
dlls/msvcrt/file.c.

The patch below removes this fixme warning. I beleive that simply removing
the warning is valid in this case because the variable being warned about,
pmode, is not used after the warning. In fact, the only use of this variable
is the FIXME or WARN messages.

Cheers,
Erik

--- dlls/msvcrt/file.c~ 2008-03-25 23:42:47.000000000 +1100
+++ dlls/msvcrt/file.c  2008-03-25 23:44:14.000000000 +1100
@@ -1442,11 +1442,6 @@
       pmode = va_arg(ap, int);
     va_end(ap);
 
-    if(pmode & ~(MSVCRT__S_IREAD | MSVCRT__S_IWRITE))
-      FIXME(": pmode 0x%04x ignored\n", pmode);
-    else
-      WARN(": pmode 0x%04x ignored\n", pmode);
-
     if (oflags & MSVCRT__O_EXCL)
       creation = CREATE_NEW;
     else if (oflags & MSVCRT__O_TRUNC)


-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
Only people who suck have a problem with elitism.


From jchevrier at nexicom.net  Tue Mar 25 06:59:52 2008
From: jchevrier at nexicom.net (Justin Chevrier)
Date: Tue, 25 Mar 2008 07:59:52 -0400
Subject: Create stub dosx.exe
In-Reply-To: <877ifrund1.fsf@wine.dyndns.org>
References: <47E87B6F.5080704@nexicom.net> <877ifrund1.fsf@wine.dyndns.org>
Message-ID: <47E8E938.9080500@nexicom.net>

Alexandre Julliard wrote:
> Justin Chevrier <jchevrier at nexicom.net> writes:
>
>   
>> Changelog:
>>
>> Create stub dosx.exe
>>     
>
> Why do you need this?
>
>   
I've got a console app (Master of Orion 2 1.40p23 patch 
http://www.spheriumnorth.com/blog-images/Moo2v140b23.zip ) that crashes 
if it doesn't find dosx.exe in the system32 folder.




From julliard at winehq.org  Tue Mar 25 08:00:49 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 25 Mar 2008 14:00:49 +0100
Subject: Create stub dosx.exe
In-Reply-To: <47E8E938.9080500@nexicom.net> (Justin Chevrier's message of
	"Tue, 25 Mar 2008 07:59:52 -0400")
References: <47E87B6F.5080704@nexicom.net> <877ifrund1.fsf@wine.dyndns.org>
	<47E8E938.9080500@nexicom.net>
Message-ID: <87skyft0u6.fsf@wine.dyndns.org>

Justin Chevrier <jchevrier at nexicom.net> writes:

> I've got a console app (Master of Orion 2 1.40p23 patch
> http://www.spheriumnorth.com/blog-images/Moo2v140b23.zip ) that
> crashes if it doesn't find dosx.exe in the system32 folder.

Does it just need to file to exist, or does it actually try to run it?

-- 
Alexandre Julliard
julliard at winehq.org


From research at science.su  Tue Mar 25 07:18:59 2008
From: research at science.su (L. Rahyen)
Date: Tue, 25 Mar 2008 12:18:59 +0000
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <200803250826.55379.kai.blin@gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<e3d3ae8f0803241745h2c83d4d6lcb02059b211eddd7@mail.gmail.com>
	<200803250826.55379.kai.blin@gmail.com>
Message-ID: <200803251219.00048.research@science.su>

On Tuesday March 25 2008 07:26:50 Kai Blin wrote:
> On Tuesday 25 March 2008 01:45:11 Cesar Izurieta wrote:
> > >  Perhaps this shouldn't be an extra tool but more like a setting what
> > > to do in a case like that.
> >
> > That sounds good. Maybe doing something like what windows does to long
> > file names when looking those files in a console, for example
> > "C:\Program Files" gets converted to "C:\Progra~1", we could apply the
> > same logic, have the first file "A.txt" and the second "a~1.txt". What
> > do you think?
>
> Well, that's probably an option. But I wouldn't even mind a mode that
> simply deletes one of A.txt or a.txt on mounting.

	Deleting files like that (just because of case insensitive match) on mounting 
is very, very bad idea. And I don't see any reason for such destructive 
actions. Better idea to pick up one and use it (for example, choice may be 
either pseudo-random or by alphabetical order where big letters comes first - 
latter is more preferable in my opinion because it let easily guess what 
file/directory will be used).
	However it is understandable and intuitive that if I have *already* mounted 
case-insensitive file system then I cannot create both A.txt and a.txt there. 
But this is safe because I can get a warning that I'm going to overwrite 
existing file.


From jchevrier at nexicom.net  Tue Mar 25 08:46:08 2008
From: jchevrier at nexicom.net (Justin Chevrier)
Date: Tue, 25 Mar 2008 09:46:08 -0400
Subject: Create stub dosx.exe
In-Reply-To: <87skyft0u6.fsf@wine.dyndns.org>
References: <47E87B6F.5080704@nexicom.net>
	<877ifrund1.fsf@wine.dyndns.org>	<47E8E938.9080500@nexicom.net>
	<87skyft0u6.fsf@wine.dyndns.org>
Message-ID: <47E90220.6090901@nexicom.net>

Alexandre Julliard wrote:
> Justin Chevrier <jchevrier at nexicom.net> writes:
>
>   
>> I've got a console app (Master of Orion 2 1.40p23 patch
>> http://www.spheriumnorth.com/blog-images/Moo2v140b23.zip ) that
>> crashes if it doesn't find dosx.exe in the system32 folder.
>>     
>
> Does it just need to file to exist, or does it actually try to run it?
>
>   
It just needs the file to exist in the system32 folder.


From jchevrier at nexicom.net  Tue Mar 25 08:48:33 2008
From: jchevrier at nexicom.net (Justin Chevrier)
Date: Tue, 25 Mar 2008 09:48:33 -0400
Subject: Create stub dosx.exe
In-Reply-To: <015801c88e57$a42f2070$a600fea9@DMITRY>
References: <47E87B6F.5080704@nexicom.net>
	<015801c88e57$a42f2070$a600fea9@DMITRY>
Message-ID: <47E902B1.1000505@nexicom.net>

Dmitry Timoshkov wrote:
> "Justin Chevrier" <jchevrier at nexicom.net> wrote:
>
>> +#define WIN32_LEAN_AND_MEAN
>> +
>> +#include <windows.h>
>
> What's the reason to include anything in an empty stub?
>
>> +int main(int argc, char *argv[])
>> +{
>> +    return 0;
>> +}
>
Ya, that shouldn't be there. Thanks Dmitry.


From julliard at winehq.org  Tue Mar 25 08:52:39 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 25 Mar 2008 14:52:39 +0100
Subject: Create stub dosx.exe
In-Reply-To: <47E90220.6090901@nexicom.net> (Justin Chevrier's message of
	"Tue, 25 Mar 2008 09:46:08 -0400")
References: <47E87B6F.5080704@nexicom.net> <877ifrund1.fsf@wine.dyndns.org>
	<47E8E938.9080500@nexicom.net> <87skyft0u6.fsf@wine.dyndns.org>
	<47E90220.6090901@nexicom.net>
Message-ID: <87od92ud08.fsf@wine.dyndns.org>

Justin Chevrier <jchevrier at nexicom.net> writes:

> Alexandre Julliard wrote:
>> Does it just need to file to exist, or does it actually try to run it?
>>
>>   
> It just needs the file to exist in the system32 folder.

OK, then the wine.inf change should be enough, no need to create a real
program.

-- 
Alexandre Julliard
julliard at winehq.org


From kai.blin at gmail.com  Tue Mar 25 09:08:17 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Tue, 25 Mar 2008 15:08:17 +0100
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <200803251219.00048.research@science.su>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<200803250826.55379.kai.blin@gmail.com>
	<200803251219.00048.research@science.su>
Message-ID: <200803251508.21754.kai.blin@gmail.com>

On Tuesday 25 March 2008 13:18:59 L. Rahyen wrote:

> 	Deleting files like that (just because of case insensitive match) on
> mounting is very, very bad idea. And I don't see any reason for such
> destructive actions. Better idea to pick up one and use it (for example,
> choice may be either pseudo-random or by alphabetical order where big
> letters comes first - latter is more preferable in my opinion because it
> let easily guess what file/directory will be used).

Ok, let's think about the use case here. My idea is that this is going to be 
used on a new WINEPREFIX on a call to wineprefixcreate. We create a new 
directory here and can make sure we're not doing anything stupid here. I'm 
not suggesting to use this for the whole file system. If I have two files 
with filenames that only differ in capitalization, this will only add 
confusion.

That's why I still think having an option to delete unwanted files is useful.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080325/99257989/attachment.pgp 

From juan.lang at gmail.com  Tue Mar 25 09:37:47 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 25 Mar 2008 07:37:47 -0700
Subject: USB Human Interface Device support
In-Reply-To: <47E88B3A.3060003@procyongames.com>
References: <47E88B3A.3060003@procyongames.com>
Message-ID: <3a768c550803250737n28f9a235ga84d52bc817c3502@mail.gmail.com>

Hi Christopher,

>  There isn't an entry in
>  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses for
>  HID interfaces, in fact that whole set of registry keys seems to be
>  missing. Is anyone working on patches to make this work, or can someone
>  point me to the function(s) that need to be implemented for HIDs to be
>  setup in the registry correctly? I'm not sure when/how those keys are
>  suppose to be created.

Those should be created by explorer; see hal.c.  No one's working on
this that I know of.
--Juan


From juan.lang at gmail.com  Tue Mar 25 09:43:48 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 25 Mar 2008 07:43:48 -0700
Subject: Patch : fixme:msvcrt:MSVCRT__sopen : pmode 0x01a0 ignored
In-Reply-To: <20080325234557.8fc781fc.mle+win@mega-nerd.com>
References: <20080325234557.8fc781fc.mle+win@mega-nerd.com>
Message-ID: <3a768c550803250743i708d089bsea3202a858e13f78@mail.gmail.com>

>  The patch below removes this fixme warning. I beleive that simply removing
>  the warning is valid in this case because the variable being warned about,
>  pmode, is not used after the warning. In fact, the only use of this variable
>  is the FIXME or WARN messages.

Don't you think the reason for the warning is that pmode isn't used
when perhaps it should be?  Removing it without understanding it isn't
a help.
--Juan


From dank at kegel.com  Tue Mar 25 10:18:37 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 25 Mar 2008 08:18:37 -0700
Subject: New valgrind errors in GdiRealizationInfo?!
Message-ID: <a71bd89a0803250818r12d4176bx6fe4cf308d3b1be@mail.gmail.com>

http://kegel.com/wine/valgrind/logs-2008-03-24/vg-gdi32_font-diff.txt
shows a number of new warnings, e.g.

-fixme:font:GdiRealizationInfo (0x2e8, 0x7f22fc6c): stub!
-font.c:1774: Tests skipped: skipping GdiRealizationInfo with truetype font
...
+ Use of uninitialised value of size 4
+    at  WineEngGetGlyphOutline (freetype.c:4152)
+    by  GetGlyphOutlineW (font.c:2352)
+    by  GetGlyphOutlineA (font.c:2330)
+    by  enum_truetype_font_proc (font.c:1568)
+    by  FONT_EnumInstance (font.c:589)
+    by  WineEngEnumFonts (freetype.c:3762)
+    by  FONT_EnumFontFamiliesEx (font.c:626)
+    by  EnumFontFamiliesExA (font.c:664)
+    by  func_font (font.c:1714)
+    by  run_test (test.h:406)
+    by  main (test.h:455)


From scott at open-vote.org  Tue Mar 25 11:01:47 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Tue, 25 Mar 2008 09:01:47 -0700
Subject: Implementing a new Direct3D function
In-Reply-To: <200803091952.12638.jgardou@yahoo.fr>
References: <E1JYPQa-0000lW-41@www10.emo.freenet-rz.de>
	<200803091952.12638.jgardou@yahoo.fr>
Message-ID: <47E921EB.8080408@open-vote.org>

J?r?me Gardou wrote:
> OK, then I'll do this that way. 
> Also, d3dx9 provides support for multiple file format (PNG, TGA, BMP...). I 
> assume I'll have to add those dependencies in the build process.
> 
> 	

Just a friendly reminder, but when your patches get committed please do
remember to tell the devel list that the build dependencies have
changed.  It makes it much easier on package maintainers who otherwise
wouldn't know to build with the libraries that make your code actually
run ;)


Thanks,
Scott Ritchie


From austinenglish at gmail.com  Tue Mar 25 11:21:20 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 25 Mar 2008 11:21:20 -0500
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <200803251508.21754.kai.blin@gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<200803250826.55379.kai.blin@gmail.com>
	<200803251219.00048.research@science.su>
	<200803251508.21754.kai.blin@gmail.com>
Message-ID: <b6bb06270803250921m3bcf5107p9e199e7109d27504@mail.gmail.com>

On Tue, Mar 25, 2008 at 9:08 AM, Kai Blin <kai.blin at gmail.com> wrote:
>  Ok, let's think about the use case here. My idea is that this is going to be
>  used on a new WINEPREFIX on a call to wineprefixcreate. We create a new
>  directory here and can make sure we're not doing anything stupid here. I'm
>  not suggesting to use this for the whole file system. If I have two files
>  with filenames that only differ in capitalization, this will only add
>  confusion.
>
>  That's why I still think having an option to delete unwanted files is useful.
>

An option yes, but it should not be the default course of action. As
Rahyen said, a predictable order should be used, and when there are
conflicts, pick the first in that order for presentation through the
FUSE system. User can then rename files/delete files to get the one
they want (or if possible, have a configuration menu to adjust chosen
file order/allow exceptions, etc.).


From kai.blin at gmail.com  Tue Mar 25 12:02:32 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Tue, 25 Mar 2008 18:02:32 +0100
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <b6bb06270803250921m3bcf5107p9e199e7109d27504@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<200803251508.21754.kai.blin@gmail.com>
	<b6bb06270803250921m3bcf5107p9e199e7109d27504@mail.gmail.com>
Message-ID: <200803251802.38804.kai.blin@gmail.com>

On Tuesday 25 March 2008 17:21:20 Austin English wrote:

> An option yes, but it should not be the default course of action. As
> Rahyen said, a predictable order should be used, and when there are
> conflicts, pick the first in that order for presentation through the
> FUSE system. User can then rename files/delete files to get the one
> they want (or if possible, have a configuration menu to adjust chosen
> file order/allow exceptions, etc.).

As long as it's configurable, I don't care about the default. I'm just 
concerned that the most important reason to use a case sensitive file system 
(i.e. not having to check for all possible capitalizations) will suffer from 
having to check if we're allowed to just overwrite or not will suffer.

How about simply refusing to mount if there's e.g. two files like foo and Foo? 
Then the user gets to clean up manually before being able to mount.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080325/8e72d6b0/attachment.pgp 

From alexd4 at inbox.lv  Tue Mar 25 12:00:55 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Tue, 25 Mar 2008 19:00:55 +0200
Subject: [PATCH 8/9] wined3d: remove ENTER_GL/LEAVE_GL in texture and
	cube	texture PreLoad.
In-Reply-To: <20080325084524.44120@gmx.net>
References: <47E84178.6070908@inbox.lv> <20080325084524.44120@gmx.net>
Message-ID: <47E92FC7.3080708@inbox.lv>

Why, I checked what routines get called from that ENTER_GL/LEAVE_GL block in 
PreLoad, and they all seem to be pretty safe. LoadTexture doesn't do gl calls 
itself, but it calls LoadLocation. Other calls made in PreLoad like AddDirtyRect 
also don't do gl calls but may call LoadLocation. So it all comes down to 
LoadLocation (with location either INSYSMEM or INTEXTURE), and LoadLocation and 
all its callees that do gl calls appear to be handling this correctly.

Roderick Colenbrander wrote:
>> Not really needed for anything and can lead to ActivateContext being
>> called 
>> while holding lock.
> 
> Sure this is a problem but there needs to be a place which calls ENTER_GL/LEAVE_GL. I believe LoadTexture and some of the other functions aren't handling that properly yet, so I wouldn't add this yet.
> 
> It is very tricky.
> 
> Roderick



From m.b.lankhorst at gmail.com  Tue Mar 25 14:36:51 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 25 Mar 2008 12:36:51 -0700
Subject: Summer of Coders wanted!
Message-ID: <b130c85e0803251236j3e89062i460c9b4d6627dcd9@mail.gmail.com>

Hi all,

Since yesterday google is accepting applications for all participating
projects. See http://code.google.com/soc for how to apply and read the
faq linked there! The past few days a lot of good proposals were
discussed, but you really need to submit them to the google web
application officially to make them count. The deadline for this is 1
april 2008 00:00 UTC, but I would recommend submitting your
application a few days before that to be sure.

It optional, but recommended to slip a patch past Alexandre Julliard,
he's Swiss so bribing with chocolate doesn't work! It doesn't have to
be a big patch, just so that we know you can check out the wine git
tree, and know how to get a patch in. Of course if you already did
this once you don't have to do it again.

A good guideline to what should be in an application is at
http://www.perlfoundation.org/perl5/index.cgi?gsoc2008_proposal_template
You don't have to follow this, but it's a good indication of what an
application should contain. It's also a good idea to separate your
goals into must-haves and nice-to-haves. The must haves you definitely
want to do before the end of the summer, and the nice-to-haves are for
the goals that you want to do, but  you're not sure if you have all
the time for them.

Cheers,

Maarten.

PS: Mentors wanted, too! If you want to be a mentor, but have
questions or doubts, contact me privately. To sign up as mentor:
http://tinyurl.com/29awt6


From alexd4 at inbox.lv  Tue Mar 25 14:48:56 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Tue, 25 Mar 2008 21:48:56 +0200
Subject: winex11.drv: Don't add owned windows to the taskbar
In-Reply-To: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com>
References: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com>
Message-ID: <47E95728.8090202@inbox.lv>

Hi.

There's a regression in IDA Pro disassembler. Nothing is added to the taskbar at 
all, furthermore, when you are starting debugger, before there was a window 
appearing that asks pass control to the application or not. Now it's not 
appearing, and can't be found because there's nothing on the taskbar, which is 
pretty bad because the app doesn't respond to any other input at that moment. 
Minimizing  the main window makes the app disappear altogether, so it's pretty 
unusable.

I've KDE 3.5.

You can get free version (that has same symptoms) from 
http://www.datarescue.com/ to help tweaking this.

Dmitry Timoshkov wrote:
> Hello,
> 
> this patch fixes the bug 12160. According to my tests explorer in XP
> doesn't add owned windows to the taskbar.
> 
> Changelog:
>     winex11.drv: Don't add owned windows to the taskbar.
> ---



From artur.szymiec at gmail.com  Tue Mar 25 15:30:44 2008
From: artur.szymiec at gmail.com (Artur Szymiec)
Date: Tue, 25 Mar 2008 21:30:44 +0100
Subject: Google SoC proposal
Message-ID: <47E960F4.2080602@gmail.com>

Greetings,

I would like to participate in Wine SoC this year.
I propose to implement WINED3DPMISCCAPS_TSSARGTEMP which is
needed by some d3d games/apps using GL_ARB_fragment_program pixel shaders.

Do you think it's a good proposal for SoC ?

Best regards
Artur Szymiec

-- 
--------------------------------------------------------------------------
Registered User No 397465
Linux Debian 2.6.24.2 AMD Athlon(tm) 64 X2 Dual Core 5000+
Conquer your Desktop! http://www.kde.org/trykde/
Reclaim Your Inbox!   http://www.mozilla.org/products/thunderbird/
--------------------------------------------------------------------------



From mstefani at redhat.com  Tue Mar 25 15:36:25 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Tue, 25 Mar 2008 21:36:25 +0100
Subject: Alistair Leslie-Hughes : msxml3: Added support for SAXXMLReader.
In-Reply-To: <E1Je7nG-0003cU-OL@wine.codeweavers.com>
References: <E1Je7nG-0003cU-OL@wine.codeweavers.com>
Message-ID: <47E96249.7000108@redhat.com>

Hello Alistair,

Alexandre Julliard wrote:
> Module: wine
> Branch: master
> Commit: 264be58812fedf9a066bac521f9fff5821759890
> URL:    http://source.winehq.org/git/wine.git/?a=commit;h=264be58812fedf9a066bac521f9fff5821759890
> 
> Author: Alistair Leslie-Hughes <leslie_alistair at hotmail.com>
> Date:   Tue Mar 25 14:19:10 2008 +1100
> 
> msxml3: Added support for SAXXMLReader.
Smatch is complaining about SAXXMLReader_create() loosing memory.

HRESULT SAXXMLReader_create(IUnknown *pUnkOuter, LPVOID *ppObj)
{
    saxreader *reader;

    TRACE("(%p,%p)\n", pUnkOuter, ppObj);

    reader = HeapAlloc( GetProcessHeap(), 0, sizeof (*reader) );
    if( !reader )
        return E_OUTOFMEMORY;

    reader->lpVtbl = &saxreader_vtbl;
    reader->ref = 1;

    TRACE("returning iface %p\n", *ppObj);
    return S_OK;
}

reader is a local variable with function scope. Stuff gets assigned to
it but there is no usage of it nor is it "exported" aka made visible
outside of the function. Is there something missing here?

bye
	michael

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: OpenPGP digital signature
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080325/4150154f/attachment.pgp 

From truiken at gmail.com  Tue Mar 25 15:44:01 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 25 Mar 2008 15:44:01 -0500
Subject: Alistair Leslie-Hughes : msxml3: Added support for SAXXMLReader.
In-Reply-To: <47E96249.7000108@redhat.com>
References: <E1Je7nG-0003cU-OL@wine.codeweavers.com>
	<47E96249.7000108@redhat.com>
Message-ID: <22821af30803251344y41b87f89p7faa185d0fc4ed38@mail.gmail.com>

On Tue, Mar 25, 2008 at 3:36 PM, Michael Stefaniuc <mstefani at redhat.com> wrote:
> Hello Alistair,
>
>
>  Alexandre Julliard wrote:
>  > Module: wine
>  > Branch: master
>  > Commit: 264be58812fedf9a066bac521f9fff5821759890
>  > URL:    http://source.winehq.org/git/wine.git/?a=commit;h=264be58812fedf9a066bac521f9fff5821759890
>  >
>  > Author: Alistair Leslie-Hughes <leslie_alistair at hotmail.com>
>  > Date:   Tue Mar 25 14:19:10 2008 +1100
>  >
>  > msxml3: Added support for SAXXMLReader.
>  Smatch is complaining about SAXXMLReader_create() loosing memory.
>
>  HRESULT SAXXMLReader_create(IUnknown *pUnkOuter, LPVOID *ppObj)
>  {
>     saxreader *reader;
>
>     TRACE("(%p,%p)\n", pUnkOuter, ppObj);
>
>     reader = HeapAlloc( GetProcessHeap(), 0, sizeof (*reader) );
>     if( !reader )
>         return E_OUTOFMEMORY;
>
>     reader->lpVtbl = &saxreader_vtbl;
>     reader->ref = 1;

----------- added -----------

        *ppObj = (LPVOID *)reader;

-----------   end  ------------

>
>     TRACE("returning iface %p\n", *ppObj);
>     return S_OK;
>  }
>
>  reader is a local variable with function scope. Stuff gets assigned to
>  it but there is no usage of it nor is it "exported" aka made visible
>  outside of the function. Is there something missing here?
>

There should probably also be a check for NULL ppObj.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Tue Mar 25 15:48:19 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 25 Mar 2008 13:48:19 -0700
Subject: USB Human Interface Device support
In-Reply-To: <3a768c550803250737n28f9a235ga84d52bc817c3502@mail.gmail.com>
References: <47E88B3A.3060003@procyongames.com>
	<3a768c550803250737n28f9a235ga84d52bc817c3502@mail.gmail.com>
Message-ID: <b130c85e0803251348k554ca9b4g1c387b6acc533413@mail.gmail.com>

Hello Luang,

2008/3/25, Juan Lang <juan.lang at gmail.com>:
>  >  There isn't an entry in
>  >  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses for
>  >  HID interfaces, in fact that whole set of registry keys seems to be
>  >  missing. Is anyone working on patches to make this work, or can someone
>  >  point me to the function(s) that need to be implemented for HIDs to be
>  >  setup in the registry correctly? I'm not sure when/how those keys are
>  >  suppose to be created.
>
>
> Those should be created by explorer; see hal.c.  No one's working on
>  this that I know of.
I have been working on hal, but it's mostly moving everything to
mountmgr so I can get ipods (except iphone/ipod touch) working, if you
populate control\deviceclasses and control\enum a hid device is
'added'. Just copy those keys from a windows installation.

Cheers,
Maarten.


From thestig at google.com  Tue Mar 25 15:51:18 2008
From: thestig at google.com (Lei Zhang)
Date: Tue, 25 Mar 2008 13:51:18 -0700
Subject: Alistair Leslie-Hughes : msxml3: Added support for SAXXMLReader.
In-Reply-To: <22821af30803251344y41b87f89p7faa185d0fc4ed38@mail.gmail.com>
References: <E1Je7nG-0003cU-OL@wine.codeweavers.com>
	<47E96249.7000108@redhat.com>
	<22821af30803251344y41b87f89p7faa185d0fc4ed38@mail.gmail.com>
Message-ID: <558b2f5c0803251351u5ab98d23hf477389adb8b89a@mail.gmail.com>

On Tue, Mar 25, 2008 at 1:44 PM, James Hawkins <truiken at gmail.com> wrote:
> On Tue, Mar 25, 2008 at 3:36 PM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>  > Hello Alistair,
>  >
>  >
>  >  Alexandre Julliard wrote:
>  >  > Module: wine
>  >  > Branch: master
>  >  > Commit: 264be58812fedf9a066bac521f9fff5821759890
>  >  > URL:    http://source.winehq.org/git/wine.git/?a=commit;h=264be58812fedf9a066bac521f9fff5821759890
>  >  >
>  >  > Author: Alistair Leslie-Hughes <leslie_alistair at hotmail.com>
>  >  > Date:   Tue Mar 25 14:19:10 2008 +1100
>  >  >
>  >  > msxml3: Added support for SAXXMLReader.
>  >  Smatch is complaining about SAXXMLReader_create() loosing memory.
>  >
>  >  HRESULT SAXXMLReader_create(IUnknown *pUnkOuter, LPVOID *ppObj)
>  >  {
>  >     saxreader *reader;
>  >
>  >     TRACE("(%p,%p)\n", pUnkOuter, ppObj);
>  >
>  >     reader = HeapAlloc( GetProcessHeap(), 0, sizeof (*reader) );
>  >     if( !reader )
>  >         return E_OUTOFMEMORY;
>  >
>  >     reader->lpVtbl = &saxreader_vtbl;
>  >     reader->ref = 1;
>
>  ----------- added -----------
>
>         *ppObj = (LPVOID *)reader;
>
>  -----------   end  ------------
>
>
>  >
>  >     TRACE("returning iface %p\n", *ppObj);
>  >     return S_OK;
>  >  }
>  >
>  >  reader is a local variable with function scope. Stuff gets assigned to
>  >  it but there is no usage of it nor is it "exported" aka made visible
>  >  outside of the function. Is there something missing here?
>  >
>
>  There should probably also be a check for NULL ppObj.
>
>  --
>  James Hawkins
>
>
>

BTW, on systems without libxml2-dev, saxreader.c does not compile.


From stefan at codeweavers.com  Tue Mar 25 16:02:00 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 25 Mar 2008 22:02:00 +0100
Subject: Google SoC proposal
In-Reply-To: <47E960F4.2080602@gmail.com>
References: <47E960F4.2080602@gmail.com>
Message-ID: <200803252202.00906.stefan@codeweavers.com>

Am Dienstag, 25. M?rz 2008 21:30:44 schrieb Artur Szymiec:
> Greetings,
>
> I would like to participate in Wine SoC this year.
> I propose to implement WINED3DPMISCCAPS_TSSARGTEMP which is
> needed by some d3d games/apps using GL_ARB_fragment_program pixel shaders.
You phrased it a bit unluckily. What you'd have to do that way is to write a 
fragment processing replacement pipeline. Implementing TSSARGTEMP in the 
current GL_ATI_fragment_shader and GL_NV_register_combiners code is fairly 
easy and too small for gsoc. I think writing a plain fragment shader 
replacement in GL_ARB_fragment_program is a pretty small task as well, I'd 
estimate a work of one week. However, if you include vertex processing as 
well using GL_ARB_vertex_program I think it would work quite well.

For the application it would be very helpful to have a small demonstration 
that you understand what you are going to do. This could be some loose 
conceptual design and integration plans, and some shader code sniplets for 
various aspects of the fixed function pipelines(e.g. transformation, light 
types, texture operations, ...), or whatever you think is suitable.



From jan at zerebecki.de  Fri Mar 21 18:33:20 2008
From: jan at zerebecki.de (Jan Zerebecki)
Date: Sat, 22 Mar 2008 00:33:20 +0100
Subject: [Bug 12131] New: Need a 1.2.0 milestone
In-Reply-To: <a71bd89a0803210751u16074ebct853ba1871e7327bd@mail.gmail.com>
References: <bug-12131-11@http.bugs.winehq.org/>
	<22821af30803202221qaa96ad4r2734179200eb06ce@mail.gmail.com>
	<78a7dad00803202345h725a32c9x4d6c0d64e6566788@mail.gmail.com>
	<22821af30803210003i6067e7abn134b0ec72a4b174d@mail.gmail.com>
	<b6bb06270803210144x44f96912q7a1f95a18dbc7f0e@mail.gmail.com>
	<a71bd89a0803210751u16074ebct853ba1871e7327bd@mail.gmail.com>
Message-ID: <20080321233320.GM3557@crissy.swd.zerebecki.de>

All our Bugzilla administrators can give that permission to others.

On Fri, Mar 21, 2008 at 07:51:25AM -0700, Dan Kegel wrote:
> On Fri, Mar 21, 2008 at 1:44 AM, Austin English <austinenglish at gmail.com> wrote:
> >  Correct me if I'm wrong, but I thought Dan also had quite a few
> >  bugzilla privs. If not, he's on wine-devel quite a bit/been around a
> >  while...
> 
> Jan says I've got privs.  Now if somebody would only show me
> how to use them :-)

You can ask me per mail or IRC. Most administrative actions can
be invoked through the "Edit:"-line on the bottom of any bugzilla
page. ( I always wondered why you were saying things like you
didn't have admin priv.s :) )


Jan



From msclrhd at googlemail.com  Sat Mar 22 10:09:39 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sat, 22 Mar 2008 15:09:39 +0000
Subject: wine 1.0 status: T minus 76 days. 87 open bugs.
In-Reply-To: <a71bd89a0803220721w37dbbb02xd3d6ab2e7ff0eccc@mail.gmail.com>
References: <a71bd89a0803220721w37dbbb02xd3d6ab2e7ff0eccc@mail.gmail.com>
Message-ID: <3f4fd2640803220809kdc774ke80d58ee73032726@mail.gmail.com>

On 22/03/2008, Dan Kegel <dank at kegel.com> wrote:
> 76 days to go before release.
>
>  I'm slowly going through the 1.0 bug list and deferring bugs
>  that only affect single non-required apps and don't have good analysis
>  or patches,

I'm busy improving the conformance tests for Wine. As a part of this,
I can contribute test cases for various bugs on the 1.0 list.

>  1114    comctl32        2       Winrar2.90/3.00: Comboex doesn't trigger a event
>  when you mouse-click in some value of it

I was going to have a look and see if I can add tests for this.

Are there any specific areas that would be useful for me to
concentrate on (specifically in the UI area - user32, comctl32, etc)?

- Reece


From msclrhd at googlemail.com  Sat Mar 22 15:53:21 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sat, 22 Mar 2008 20:53:21 +0000
Subject: package install script for Ubuntu Hardy
Message-ID: <3f4fd2640803221353kcc32142p66af036648029fba@mail.gmail.com>

Hi,

I have tried out an alpha of Ubuntu Hardy Heron recently (I am
currently using Gutsy), and have updated Dan's gutsy.sh script to get
the correct packages to build wine.

Hardy does not have the libopencdk8-dev package, and didn't have time
to investigate which package to use (probably libopencdk9-dev).

They have also removed the cogito package, so I replaced it with gitk.

Dan: feel free to add this to your site along with the others and
update it as needed.

- Reece
-------------- next part --------------
A non-text attachment was scrubbed...
Name: hardy.sh
Type: application/x-sh
Size: 2638 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080322/7520f67b/attachment.sh 

From msclrhd at googlemail.com  Sun Mar 23 03:01:48 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 23 Mar 2008 08:01:48 +0000
Subject: C&C :D
In-Reply-To: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
References: <b130c85e0803230020p41ba7b21n49de1336d97f1568@mail.gmail.com>
Message-ID: <3f4fd2640803230101y4d70b4s77fd67d8f7ba275f@mail.gmail.com>

On 23/03/2008, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> Hi all!
>
>  After an announcement that the original Command and conquer is
>  available free for download, I decided to test it. Command and Conquer
>  works perfectly in wine, I haven't tested network gaming over ipx, but
>  that will probably not work. For the rest it's flawless, apart from
>  the losing focus behavior, but playing it in a wine desktop helps.
>
>  Remember: KANE IS A TRAITOR! LONG LIVE THE GDI!

This is great.

Welcome back commander!
- Reece


From erikd at mega-nerd.com  Sun Mar 23 05:07:51 2008
From: erikd at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 23 Mar 2008 21:07:51 +1100
Subject: winegcc: A spec file is currently needed in shared mode?
Message-ID: <20080323210751.49ed967b.erikd@mega-nerd.com>

Hi all,

Any idea what the above means and how to fix it?

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"You can have quality software, or you can have pointer arithmetic;
but you cannot have both at the same time." -- Bertrand Meyer, 1989


From msclrhd at googlemail.com  Sun Mar 23 13:07:44 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 23 Mar 2008 18:07:44 +0000
Subject: qmgr test needs bits.lib to link using the MSVC headers
Message-ID: <3f4fd2640803231107k3fecb704l43f87235f32b9744@mail.gmail.com>

Hi,

I have been going through the tests to see if I can make them work
using MSVC headers.

When building the qmgr tests, I have found that you need to add
bits.lib to LIBS (Linker/Input/Additional Dependencies). Doing this
gets the test to link properly.

Does anyone know how to add this to Wine? Adding EXTRALIBS=-lbits to
Makefile.in does not work on Wine itself. Is this the right way to go?

- Reece


From gmane at drealm.info  Mon Mar 24 12:01:43 2008
From: gmane at drealm.info (Peter L Jones)
Date: Mon, 24 Mar 2008 17:01:43 +0000 (UTC)
Subject: wineasio: source now hosted on SourceForge
Message-ID: <loom.20080324T170127-228@post.gmane.org>

I thought I'd post here to let interested parties know that the various strands
of source for wineasio have been brought together in a single SourceForge
project.  After a great deal of thought, the project name "wineasio" was chosen
by unanimous vote (okay, so only I got a say...).

Robert Reif and the early JackLab code branches are both preserved with change
history.  The trunk is wineasio-0.7.x, which is under "active" development.

Bug reports, feature requests, offers of help and code via the SF project
trackers, please.  Let me know your SF.net ID if you want to commit to the
project (and show some code...).

Thanks,

-- Peter
http://www.sourceforge.net/projects/wineasio




From mattshanks86 at googlemail.com  Mon Mar 24 16:42:11 2008
From: mattshanks86 at googlemail.com (Matt Shanks)
Date: Mon, 24 Mar 2008 21:42:11 +0000
Subject: GSoc: Scriptable Configuration
Message-ID: <847a3d070803241442t27ceaa92w8b964dc798abfb2f@mail.gmail.com>

Hello all,

Am quite keen to get involved with Wine for GSoC - specifically the project
titled "Scriptable Configuration <http://wiki.winehq.org/SummerOfCode>"

Having spoken briefly to Lei, he essentially said that the more features
added to the reg.exe in Wine, the better.

I looked up what the Windows version does, and it seems like a pretty solid
list of features to aim for;

- add               Adds a new subkey or entry into the registry
- delete           Deletes a subkey or entries from the registry
- query            Displays the data in a subkey or a value
- compare       Compares specified registry subkeys or entries
- copy             Copy a subkey to another subkey
- Save             Saves a copy of specified subkeys, entries, and values of
the registry in hive (binary) format-- could be changed to save as
plaintext/flatfile format
- Load             Load a key values
etc

(Source <http://commandwindows.com/reg.htm>)

An apparent missing feature seems to be editing an existing key value

Also, for the command line tools for wine, beyond uninstallation and
windows-version calls, (from Console
Configuration<http://wiki.winehq.org/ConsoleConfiguration>)
are there any other particularly desirable features?

Any input/comments from anyone is much appreciated,

Kind regards,

Matt Shanks
('napi' on IRC)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080324/7878cabf/attachment.htm 

From gmane at drealm.info  Mon Mar 24 17:40:19 2008
From: gmane at drealm.info (Peter L Jones)
Date: Mon, 24 Mar 2008 22:40:19 +0000
Subject: [Repost] wineasio source now on SourceForge
Message-ID: <fs9akj$6f6$1@ger.gmane.org>

Hi all,

wineasio, the ASIO to JACK driver for WINE, has been under some development
over recent months by various interested parties.  Co-ordination has been on a
best endeavours basis but really needed something more organised.  The project
really needed a proper home, too.

So I've gathered the various threads of source and committed them into a
SourceForge SVN project.  Robert Reif's wineasio-0.0.x and the JackLab work on
wineasio-0.x have their own branches.  The current work on wineasio-0.7.x forms
the SVN trunk.

wineasio-0.7.x releases (i.e. 0, 1, 2 and 3) are tagged.  HEAD currently has
two changes pending release (a fix for Nuendo and a possible fix for some xruns
being experienced by a 64studio user).

wineasio developers and packagers are encouraged to consider using the
SourceForge facilities - let me know if you want to be added as a committer and
please use the trackers for bugs, feature request, etc.

Right now, feedback would be appreciated on the current code in HEAD and around
the xrun issued mentioned, more details here:
http://forum.jacklab.net/viewtopic.php?f=2&t=726

I spent oh... seconds... considering a name for the SourceForge project.
Fortunately "wineasio" was available.  You can find the project on the end of
this url:
http://sf.net/projects/wineasio

wineasio would not exist without Robert Reif.  Ralf Beck undertook much work
for JackLab.  William Steidtmann and Nedko Arnaudov had provided bug fixes.  I
provided the config file handling and tried to combine Ralf and Robert's work
(thus kicking off 0.7.x).

Many thanks,

-- Peter



From mat at brain-dump.org  Tue Mar 25 16:33:51 2008
From: mat at brain-dump.org (Marc Andre Tanner)
Date: Tue, 25 Mar 2008 22:33:51 +0100
Subject: [GSoC][RFC] Case Insensitive Filesystem
Message-ID: <20080325213351.GA3237@debbook.brain-dump.org>

Hi,

During the last week i have been playing around with the idea
of writing a case insensitive fuse filesystem and i am know 
at the point were i can demonstrate a proof of concept 
implementation. And yes i have seen that there is already 
someone else interested in doing this but i thought it was fun
anyways.

The filesystem converts every path to lower case before further
operations take place. On file creation the original filename is
stored in an extended attribute and later returned upon request.

This means you will have a directory on a regular POSIX filesystem
with all filenames in lower case, this directory can then be mounted
in case insensitive fashion.

In order to compile the code you will need the fuse and libattr[1]
development files. Furthermore you will have to make sure that the
underlying filesystem supports extended attributes (for example 
for ext{2,3} you need a kernel with CONFIG_EXT{2,3}_FS_XATTR enabled). 
You probably also want to mount the underlying filesystem with the 
user_xattr option which allows non root users to create	extended 
attributes.

So fetch the code from the url below, extract the archive and type
make. This should generate a binary named ciopfs (which stands for
Case Insenstive On Purpose File System, alternative naming suggestions 
are welcome ;).
 
 http://www.brain-dump.org/projects/ciopfs/ciopfs-25.03.2008.tar.gz

Mounting the file system is straight forward, see `ciopfs -h` for
further options. But be carefull i haven't yet done any serious
testing, so only use it with unimportant data [insert standard 
warning about possible data loss here].

 ciopfs /path/to/my/directory /path/to/my/mountpoint

As i said before the current implementation is just a proof of
concept. That's why it currently only supports ascii filenames, or
whatever tolower(3) can cope with. This brings us to another 
problem[2,3], in certain languages there isn't a direct mapping 
between upper and lower case characters and case insensitivity in
filesystem is generally a bad thing.

Any comments are appreciated.

Regards,
Marc

[1] http://acl.bestbits.at/download.html#Attr
[2] http://www.somethinkodd.com/oddthinking/2005/10/25/the-world-of-upper-lower-case-mappings/
[3] http://drewthaler.blogspot.com/2007/12/case-against-insensitivity.html
-- 
 Marc Andre Tanner >< http://www.brain-dump.org/ >< GPG key: CF7D56C0


From cesar at ecuarock.net  Tue Mar 25 20:24:35 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Tue, 25 Mar 2008 20:24:35 -0500
Subject: fuse-iso and remote named pipes for GSOC
Message-ID: <e3d3ae8f0803251824s75bbd9f0ia25c930dfa7a80e@mail.gmail.com>

Besides the FUSE project for GSOC I see two items listed on the
http://wiki.winehq.org/SummerOfCode page:

# Better ISO FUSE file system integration
# A FUSE wrapper for remote named pipes using libsmbclient

Can anybody elaborate a little bit more on this?


From cesar at ecuarock.net  Tue Mar 25 20:43:43 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Tue, 25 Mar 2008 20:43:43 -0500
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <200803251802.38804.kai.blin@gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<200803251508.21754.kai.blin@gmail.com>
	<b6bb06270803250921m3bcf5107p9e199e7109d27504@mail.gmail.com>
	<200803251802.38804.kai.blin@gmail.com>
Message-ID: <e3d3ae8f0803251843h262099a3o10c8dc224ea8a4c6@mail.gmail.com>

On Tue, Mar 25, 2008 at 12:02 PM, Kai Blin <kai.blin at gmail.com> wrote:
> On Tuesday 25 March 2008 17:21:20 Austin English wrote:
>
>  > An option yes, but it should not be the default course of action. As
>  > Rahyen said, a predictable order should be used, and when there are
>  > conflicts, pick the first in that order for presentation through the
>  > FUSE system. User can then rename files/delete files to get the one
>  > they want (or if possible, have a configuration menu to adjust chosen
>  > file order/allow exceptions, etc.).
>
>  As long as it's configurable, I don't care about the default. I'm just
>  concerned that the most important reason to use a case sensitive file system
>  (i.e. not having to check for all possible capitalizations) will suffer from
>  having to check if we're allowed to just overwrite or not will suffer.
>
>  How about simply refusing to mount if there's e.g. two files like foo and Foo?
>  Then the user gets to clean up manually before being able to mount.
>
>
>
>  Cheers,
>  Kai
>
>  --
>  Kai Blin
>  WorldForge developer  http://www.worldforge.org/
>  Wine developer        http://wiki.winehq.org/KaiBlin
>  Samba team member     http://www.samba.org/samba/team/
>  --
>  Will code for cotton.
>
>
>
>

There could some sort of a warning and present the conflicted file
with a different name. Depending on how efficient the checking is, it
could take some time to traverse the whole file system (supposing we
also mount the root / in .wine/something ). If that is the case we
might need just to mount without checks and present the files with a
different name when doing a directory listing.


From winehacker at gmail.com  Tue Mar 25 21:34:05 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 25 Mar 2008 22:34:05 -0400
Subject: fuse-iso and remote named pipes for GSOC
In-Reply-To: <e3d3ae8f0803251824s75bbd9f0ia25c930dfa7a80e@mail.gmail.com>
References: <e3d3ae8f0803251824s75bbd9f0ia25c930dfa7a80e@mail.gmail.com>
Message-ID: <19e31a080803251934k1601e179j386f5ff9bd769a93@mail.gmail.com>

On Tue, Mar 25, 2008 at 9:24 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
> Besides the FUSE project for GSOC I see two items listed on the
>  http://wiki.winehq.org/SummerOfCode page:
>
>  # Better ISO FUSE file system integration

I don't know if the FUSE api supports enumeration of mounts in the VFS
but it would be cool if explorer could detect if a FUSE iso mounted
filesystem is mounted somewhere in the VFS and auto-magically create a
fake cdrom device associated with this mount. It would solve some of
the complexity we have in cxtest where you have to mount iso images
for regression testing, plus it would just save a bunch of time for
stupid installers that assume they are always running from a real
cdrom.

Thanks
-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Tue Mar 25 21:39:18 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 25 Mar 2008 22:39:18 -0400
Subject: qmgr test needs bits.lib to link using the MSVC headers
In-Reply-To: <3f4fd2640803231107k3fecb704l43f87235f32b9744@mail.gmail.com>
References: <3f4fd2640803231107k3fecb704l43f87235f32b9744@mail.gmail.com>
Message-ID: <19e31a080803251939n4aebc0adrba0cab90bc7c2bf7@mail.gmail.com>

On Sun, Mar 23, 2008 at 2:07 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
>  Does anyone know how to add this to Wine? Adding EXTRALIBS=-lbits to
>  Makefile.in does not work on Wine itself. Is this the right way to go?

Normally if you were using configure to generate the makefiles and
config.h you would use something like

EXTRALIBS=@BITSLIB@

That would seem to still be the right thing to do, you will just need
to extend msvcmaker to understand what BITSLIB really is and will we
just keep ignoring it on Unix.

See dlls/wininet/Makefile.in for EXTRALIBS=@SOCKETLIB@ for an example.
If your building with mingw configure defines @SOCKETLIB@ to -lws2_32
but if you use Unix this is ignored and we use normal unix sockets.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Tue Mar 25 23:01:45 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 26 Mar 2008 12:01:45 +0800
Subject: winex11.drv: Don't add owned windows to the taskbar
References: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com>
	<47E95728.8090202@inbox.lv>
Message-ID: <000f01c88ef6$21f7dc10$a600fea9@DMITRY>

"Alexander Dorofeyev" <alexd4 at inbox.lv> wrote:

> There's a regression in IDA Pro disassembler. Nothing is added to the taskbar at 
> all, furthermore, when you are starting debugger, before there was a window 
> appearing that asks pass control to the application or not. Now it's not 
> appearing, and can't be found because there's nothing on the taskbar, which is 
> pretty bad because the app doesn't respond to any other input at that moment. 
> Minimizing  the main window makes the app disappear altogether, so it's pretty 
> unusable.

The problem with IDA is that the button you see in the Windows task bar
does not belong to the main IDA window, it belongs to a zero sized visible
window with the same caption. Since it's zero sized Wine doesn't map it all.
So, while formally it's a regression, technically it's not: main IDA window
has never been added to the task bar before my patch. This all can be easily
discovered with spy++ and a simple test app.

-- 
Dmitry.


From m.b.lankhorst at gmail.com  Wed Mar 26 00:46:41 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 25 Mar 2008 22:46:41 -0700
Subject: GSoc: Scriptable Configuration
In-Reply-To: <847a3d070803241442t27ceaa92w8b964dc798abfb2f@mail.gmail.com>
References: <847a3d070803241442t27ceaa92w8b964dc798abfb2f@mail.gmail.com>
Message-ID: <b130c85e0803252246h41569f37xdd55ae455d32d92f@mail.gmail.com>

Hello Matt,

2008/3/24, Matt Shanks <mattshanks86 at googlemail.com>:
> Am quite keen to get involved with Wine for GSoC - specifically the project
> titled "Scriptable Configuration"
We have about 2 or 3 others also willing to do that project. I think
you would have a better chance of doing something like the print
dialog or one of the rich editor projects. They are good projects with
a known boundary.

> Having spoken briefly to Lei, he essentially said that the more features
> added to the reg.exe in Wine, the better.
>
> I looked up what the Windows version does, and it seems like a pretty solid
> list of features to aim for;
True, however most of them seem to map onto an existing advapi call,
so I'm not sure if it's that much work to implement.

> An apparent missing feature seems to be editing an existing key value
>
> Also, for the command line tools for wine, beyond uninstallation and
> windows-version calls, (from Console Configuration) are there any other
> particularly desirable features?
See above, you'll have more chance of being accepted by choosing
another project idea. Good luck!

Cheers,
Maarten


From raccoonone at procyongames.com  Wed Mar 26 01:02:54 2008
From: raccoonone at procyongames.com (Christopher)
Date: Tue, 25 Mar 2008 23:02:54 -0700
Subject: USB Human Interface Device support
In-Reply-To: <b130c85e0803251348k554ca9b4g1c387b6acc533413@mail.gmail.com>
References: <47E88B3A.3060003@procyongames.com>	
	<3a768c550803250737n28f9a235ga84d52bc817c3502@mail.gmail.com>
	<b130c85e0803251348k554ca9b4g1c387b6acc533413@mail.gmail.com>
Message-ID: <47E9E70E.6030509@procyongames.com>

Maarten Lankhorst wrote:
> Hello Luang,
>
> 2008/3/25, Juan Lang <juan.lang at gmail.com>:
>   
>>  >  There isn't an entry in
>>  >  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses for
>>  >  HID interfaces, in fact that whole set of registry keys seems to be
>>  >  missing. Is anyone working on patches to make this work, or can someone
>>  >  point me to the function(s) that need to be implemented for HIDs to be
>>  >  setup in the registry correctly? I'm not sure when/how those keys are
>>  >  suppose to be created.
>>
>>
>> Those should be created by explorer; see hal.c.  No one's working on
>>  this that I know of.
>>     
> I have been working on hal, but it's mostly moving everything to
> mountmgr so I can get ipods (except iphone/ipod touch) working, if you
> populate control\deviceclasses and control\enum a hid device is
> 'added'. Just copy those keys from a windows installation.
>
> Cheers,
> Maarten.
>
>   
Thanks! SetupDiGetClassDevs and GetDeviceInterfaceData seem to work now, 
but GetDeviceInterfaceDetailData causes several errors. I'll look into 
it now that I have somewhere concrete to start.
Christopher


From m.b.lankhorst at gmail.com  Wed Mar 26 01:22:21 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 25 Mar 2008 23:22:21 -0700
Subject: USB Human Interface Device support
In-Reply-To: <47E9E70E.6030509@procyongames.com>
References: <47E88B3A.3060003@procyongames.com>
	<3a768c550803250737n28f9a235ga84d52bc817c3502@mail.gmail.com>
	<b130c85e0803251348k554ca9b4g1c387b6acc533413@mail.gmail.com>
	<47E9E70E.6030509@procyongames.com>
Message-ID: <b130c85e0803252322s168b9ad3i90b4a93ceca92b51@mail.gmail.com>

Hello Christopher,

2008/3/25, Christopher <raccoonone at procyongames.com>:
> Maarten Lankhorst wrote:
>  > Hello Luang,
>  >
>  > 2008/3/25, Juan Lang <juan.lang at gmail.com>:
>  >
>  >>  >  There isn't an entry in
>  >>  >  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses for
>  >>  >  HID interfaces, in fact that whole set of registry keys seems to be
>  >>  >  missing. Is anyone working on patches to make this work, or can someone
>  >>  >  point me to the function(s) that need to be implemented for HIDs to be
>  >>  >  setup in the registry correctly? I'm not sure when/how those keys are
>  >>  >  suppose to be created.
>  >>
>  >>
>  >> Those should be created by explorer; see hal.c.  No one's working on
>  >>  this that I know of.
>  >>
>  > I have been working on hal, but it's mostly moving everything to
>  > mountmgr so I can get ipods (except iphone/ipod touch) working, if you
>  > populate control\deviceclasses and control\enum a hid device is
>  > 'added'. Just copy those keys from a windows installation.
>  >
>  > Cheers,
>  > Maarten.
>  >
>  >
>
> Thanks! SetupDiGetClassDevs and GetDeviceInterfaceData seem to work now,
>  but GetDeviceInterfaceDetaiData causes several errors. I'll look into
>  it now that I have somewhere concrete to start.
It probably asks for the specific keys in
\ENUM\category\devicename\idname so if you copy these over it will
probably work. WINEDEBUG=+setupapi is your friend.

Cheers,
Maarten.


From m.b.lankhorst at gmail.com  Wed Mar 26 02:26:27 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 26 Mar 2008 00:26:27 -0700
Subject: Scriptable configuration (reg.exe) proposals
Message-ID: <b130c85e0803260026p3ccc34c0m5f7ca044c8933f29@mail.gmail.com>

Hello potential students,

There have been at least 4 people interested in doing the reg.exe
project for summer of code, but unfortunately this is not really a
good project idea, becuse you can pretty much implement it all in a
single day by just calling the right advapi calls. Making winecfg work
from the command line is also not hard and you can't fill up 2 or 3
months with this.

I'm sorry for not investigating reg.exe further. This should never
have been on the ideas list to begin with, and I should be the one to
be blamed for not spotting it earlier.

I would strongly recommend adding a proposal for another project. It
doesn't have to be one from the ideas list, on the contrary: The most
succesful applications have been initiatives from people themselves.
As long as you work, interact with the community and communicate with
your mentor and share your code and ideas you will get paid.

I hope that you will have luck in finding other proposals, and that
you will be able to participate and complete gsoc succesfully.

Regards,
Maarten.


From kai.blin at gmail.com  Wed Mar 26 03:42:15 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Wed, 26 Mar 2008 09:42:15 +0100
Subject: fuse-iso and remote named pipes for GSOC
In-Reply-To: <e3d3ae8f0803251824s75bbd9f0ia25c930dfa7a80e@mail.gmail.com>
References: <e3d3ae8f0803251824s75bbd9f0ia25c930dfa7a80e@mail.gmail.com>
Message-ID: <200803260942.19076.kai.blin@gmail.com>

On Wednesday 26 March 2008 02:24:35 Cesar Izurieta wrote:
> Besides the FUSE project for GSOC I see two items listed on the
> http://wiki.winehq.org/SummerOfCode page:
>
> # Better ISO FUSE file system integration

Steven already took care of this part, so I'll wrap up the next one.

> # A FUSE wrapper for remote named pipes using libsmbclient

The goal of this is to be able to do RPC via Windows named pipes to remote 
machines. Of course the best solution would be to just use libsmbclient from 
Wine directly, but libsmbclient is under the GPL and Wine is under the LGPL, 
so that's not going to work.

So the obvious idea is some solution where we can use libsmbclient for what we 
need without having to link to libsmbclient. FUSE can provide this 
abstraction.

The idea would be to create a pipe subdirectory of WINEPREFIX and mount our 
pipefs there. Accessing pipe/server/pipename should connect to 
\\server\pipe\pipename, if possible.
One more thing that needs to be supported is mode switching on the named pipe.

I'd suggest to read up on remote named pipes to get a better idea what they're 
used for.

If you've got any more questions, I'm happy to help.
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080326/a5e2dcb7/attachment.pgp 

From pure_evil at mail.bg  Wed Mar 26 05:16:50 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Wed, 26 Mar 2008 12:16:50 +0200
Subject: DLL exports... HELP?!
Message-ID: <20080326121650.so9h52gms8gcs0go@mail.bg>



   Folks, I've been trying to make a bunch of control panel applets  
for wine for some time now.

   a CPL is basically a DLL which (the most importnat part) exports a  
function called "CPlApplet"; Without it, the cpl isn't worth a thing.  
It is the presence of that export which basically identifies it as a  
control panel applet.

   Indeed, opening a random .cpl with dllexp yields:

   Function: CPlApplet  Address: 0x0041b604 Relative Address:  
0x0041b604 Ordinal 1 (0x1) Filename: intl.cpl

   This one is from the cpl I wrote some time ago in Delphi, and it's  
the same with all other 'doze cpls. I'm working on porting it to C and  
wine, but that export is really getting the best of me.

   However, dllexp doesn't detect _any_ DLL exports in wine's .dlls,  
so I'm stuck without a template :( Am I missing something? (A simple  
*hello world* dll source that compiles against wine's source and  
exports ANY function would be greatly appreciated)

   Thanks in advance,

   Stefanov.

-------------------------------------

????? 2 ????????? ?????? ??? ADSL!
??????? online ?o 20 ???? 2008!
???????? ??????????????? ????????!
  http://www.btc.bg/bg/adsl_order.php?residential&action=order&view_pack=1
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080326/c5f0b132/attachment-0002.htm 
-------------- next part --------------


   Folks, I've been trying to make a bunch of control panel applets  
for wine for some time now.

   a CPL is basically a DLL which (the most importnat part) exports a  
function called "CPlApplet"; Without it, the cpl isn't worth a thing.  
It is the presence of that export which basically identifies it as a  
control panel applet.

   Indeed, opening a random .cpl with dllexp yields:

   Function: CPlApplet? Address: 0x0041b604 Relative Address:  
0x0041b604 Ordinal 1 (0x1) Filename: intl.cpl

   This one is from the cpl I wrote some time ago in Delphi, and it's  
the same with all other 'doze cpls. I'm working on porting it to C and  
wine, but that export is really getting the best of me.

   However, dllexp doesn't detect _any_ DLL exports in wine's .dlls,  
so I'm stuck without a template :( Am I missing something? (A simple  
*hello world* dll source that compiles against wine's source and  
exports ANY function would be greatly appreciated)

   Thanks in advance,

   Stefanov.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080326/c5f0b132/attachment-0003.htm 

From julliard at winehq.org  Wed Mar 26 05:21:04 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 11:21:04 +0100
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
	(take 2)
In-Reply-To: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
	(Dan Kegel's message of "Tue, 25 Mar 2008 19:23:54 -0700")
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
Message-ID: <87ej9xu6pb.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> While investigating a crash in gs-auftrag in bug 9039, noticed
> WideCharToMultiByte wasn't quite conformant for negative destlen.
> Fixed, with tests.  Passes for me in Wine and Win XP.

This would require reviewing all uses of WideCharToMultiByte in Wine,
many places get this wrong. Unless you have an app that requires this
fix I'd suggest to leave the test as todo_wine for now.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Wed Mar 26 05:28:50 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 11:28:50 +0100
Subject: [2/2] comctl32: tab.c The Item Interior should use HotTracking
	color not Hilight color (resend).
In-Reply-To: <47E92543.3070109@etersoft.ru> (Anatoly Lyutin's message of "Tue, 
	25 Mar 2008 19:16:03 +0300")
References: <47E92543.3070109@etersoft.ru>
Message-ID: <87abklu6cd.fsf@wine.dyndns.org>

Anatoly Lyutin <vostok at etersoft.ru> writes:

> @@ -1633,7 +1633,7 @@ TAB_DrawItemInterior(const TAB_INFO *inf
>        SetTextColor(hdc, (((lStyle & TCS_HOTTRACK) && (iItem == infoPtr->iHotTracked) 
>                            && !(lStyle & TCS_FLATBUTTONS)) 
>                          | (TAB_GetItem(infoPtr, iItem)->dwState & TCIS_HIGHLIGHTED)) ?
> -                        comctl32_color.clrHighlight : comctl32_color.clrBtnText);
> +                        comctl32_color.clrHotTrackingColor : comctl32_color.clrBtnText);

Shouldn't you distinguish between TCS_HOTTRACK and TCIS_HIGHLIGHTED
here?

-- 
Alexandre Julliard
julliard at winehq.org


From thunderbird2k at gmx.net  Wed Mar 26 05:39:39 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Wed, 26 Mar 2008 11:39:39 +0100
Subject: DLL exports... HELP?!
In-Reply-To: <20080326121650.so9h52gms8gcs0go@mail.bg>
References: <20080326121650.so9h52gms8gcs0go@mail.bg>
Message-ID: <20080326103939.115280@gmx.net>

If you build a wine dll inside the wine source tree we use gcc in combination with some wine magic for compilation. Exporting of functions in that case happens through a '.spec' file.

When you want to work outside the wine tree (as it can be more convenient) you could also use 'winegcc' for building a library. It will handle all the magic for you.

Roderick

> 
> 
>    Folks, I've been trying to make a bunch of control panel applets  
> for wine for some time now.
> 
>    a CPL is basically a DLL which (the most importnat part) exports a  
> function called "CPlApplet"; Without it, the cpl isn't worth a thing.  
> It is the presence of that export which basically identifies it as a  
> control panel applet.
> 
>    Indeed, opening a random .cpl with dllexp yields:
> 
>    Function: CPlApplet  Address: 0x0041b604 Relative Address:  
> 0x0041b604 Ordinal 1 (0x1) Filename: intl.cpl
> 
>    This one is from the cpl I wrote some time ago in Delphi, and it's  
> the same with all other 'doze cpls. I'm working on porting it to C and  
> wine, but that export is really getting the best of me.
> 
>    However, dllexp doesn't detect _any_ DLL exports in wine's .dlls,  
> so I'm stuck without a template :( Am I missing something? (A simple  
> *hello world* dll source that compiles against wine's source and  
> exports ANY function would be greatly appreciated)
> 
>    Thanks in advance,
> 
>    Stefanov.
> 
> -------------------------------------
> 
> ????? 2 ????????? ?????? ??? ADSL!
> ??????? online ?o 20 ???? 2008!
> ???????? ??????????????? ????????!
>   http://www.btc.bg/bg/adsl_order.php?residential&action=order&view_pack=1

-- 
Ist Ihr Browser Vista-kompatibel? Jetzt die neuesten 
Browser-Versionen downloaden: http://www.gmx.net/de/go/browser


From mstefani at redhat.com  Wed Mar 26 06:04:41 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 26 Mar 2008 12:04:41 +0100
Subject: kernel32: WideCharToMultiByte: return error on negative dest
	len	(take 2)
In-Reply-To: <87ej9xu6pb.fsf@wine.dyndns.org>
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
	<87ej9xu6pb.fsf@wine.dyndns.org>
Message-ID: <47EA2DC9.9030505@redhat.com>

Alexandre Julliard wrote:
> "Dan Kegel" <dank at kegel.com> writes:
> 
>> While investigating a crash in gs-auftrag in bug 9039, noticed
>> WideCharToMultiByte wasn't quite conformant for negative destlen.
>> Fixed, with tests.  Passes for me in Wine and Win XP.
> 
> This would require reviewing all uses of WideCharToMultiByte in Wine,
> many places get this wrong. Unless you have an app that requires this
> fix I'd suggest to leave the test as todo_wine for now.
Would that be a good janitorial work to be done before Wine 1.0? I feel
like I'm getting tired of translating ...

bye
	michael


From hans at it.vu.nl  Wed Mar 26 06:12:38 2008
From: hans at it.vu.nl (Hans Leidekker)
Date: Wed, 26 Mar 2008 12:12:38 +0100
Subject: Wine 1.0 status: T minus 74 days. 78 open bugs.
In-Reply-To: <a71bd89a0803242250g392d1c48r15094dd056bca78c@mail.gmail.com>
References: <a71bd89a0803242250g392d1c48r15094dd056bca78c@mail.gmail.com>
Message-ID: <200803261212.38493.hans@it.vu.nl>

On Tuesday 25 March 2008 06:50:25 am Dan Kegel wrote:

> 3711 ???wininet ????????1 ??????Musicmatch fails to install (missing registry key, HTTP_HttpOpenRequest() problem)
> 5625 ???wininet ????????3 ??????Wine does not handle internet proxy settings conveniently

I'll look into these two bugs.

 -Hans


From julliard at winehq.org  Wed Mar 26 06:17:40 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 12:17:40 +0100
Subject: kernel32: WideCharToMultiByte: return error on negative dest
	len	(take 2)
In-Reply-To: <47EA2DC9.9030505@redhat.com> (Michael Stefaniuc's message of
	"Wed, 26 Mar 2008 12:04:41 +0100")
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
	<87ej9xu6pb.fsf@wine.dyndns.org> <47EA2DC9.9030505@redhat.com>
Message-ID: <8763v9u42z.fsf@wine.dyndns.org>

Michael Stefaniuc <mstefani at redhat.com> writes:

> Would that be a good janitorial work to be done before Wine 1.0? I feel
> like I'm getting tired of translating ...

Sure, if you feel like doing it go ahead. I'm not sure the fix will go
in before 1.0, but already fixing as many callers as possible certainly
can't hurt.

-- 
Alexandre Julliard
julliard at winehq.org


From pure_evil at mail.bg  Wed Mar 26 06:46:01 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Wed, 26 Mar 2008 13:46:01 +0200
Subject: DLL exports... HELP?!
In-Reply-To: <20080326103939.115280@gmx.net>
References: <20080326121650.so9h52gms8gcs0go@mail.bg>
	<20080326103939.115280@gmx.net>
Message-ID: <200803261346.01843.pure_evil@mail.bg>

On Wednesday 26 March 2008 12:39:39 pm you wrote:
> If you build a wine dll inside the wine source tree we use gcc in
> combination with some wine magic for compilation. Exporting of functions in
> that case happens through a '.spec' file.
>
> When you want to work outside the wine tree (as it can be more convenient)
> you could also use 'winegcc' for building a library. It will handle all the
> magic for you.
>
> Roderick
cplskeleton.spec:
"
1 stdcall CPlApplet(long long long long)
"
"
libcplskeleton.def

; File generated automatically from ./cplskeleton.spec; do not edit!

LIBRARY cplskeleton.dll

EXPORTS
  CPlApplet at 16 @1
"


From fgouget at free.fr  Wed Mar 26 06:49:16 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 26 Mar 2008 12:49:16 +0100 (CET)
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <20080325213351.GA3237@debbook.brain-dump.org>
References: <20080325213351.GA3237@debbook.brain-dump.org>
Message-ID: <alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>

On Tue, 25 Mar 2008, Marc Andre Tanner wrote:
[...]
> The filesystem converts every path to lower case before further
> operations take place. On file creation the original filename is
> stored in an extended attribute and later returned upon request.

Shouldn't it be the other way around? I guess the way you've done it is 
simpler because you can simply rely on the standard kernel code to 
ensure filename uniqueness, but it also means that anyone accessing the 
underlying files directly will lose the case information.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
  Any sufficiently advanced Operating System is indistinguishable from Linux


From mpartap at gmx.net  Wed Mar 26 06:51:59 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Wed, 26 Mar 2008 12:51:59 +0100
Subject: DLL exports... HELP?!
In-Reply-To: <20080326121650.so9h52gms8gcs0go@mail.bg>
References: <20080326121650.so9h52gms8gcs0go@mail.bg>
Message-ID: <47EA38DF.3060501@gmx.net>

Hi Stefanov,
attached is the code of a standalone proxy DLL I developed last year during SoC, have a look 
especially at the makefile for cross-compilation...
regards marcel.

-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: printerproxydriver.tar.gz
Type: application/gzip
Size: 14302 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080326/0316aceb/attachment-0001.bin 

From julliard at winehq.org  Wed Mar 26 07:50:07 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 13:50:07 +0100
Subject: [PATCH 1 of 2] explorer: add /startfile switch for starting files
	from file managers
In-Reply-To: <ced95fe0803201906t70760536g828ebd2d5fc9dbc4@mail.gmail.com>
	(Vincent Povirk's message of "Thu, 20 Mar 2008 22:06:46 -0400")
References: <ced95fe0803201906t70760536g828ebd2d5fc9dbc4@mail.gmail.com>
Message-ID: <871w5xtzsw.fsf@wine.dyndns.org>

"Vincent Povirk" <madewokherd+d41d at gmail.com> writes:

> My last attempt created a new winelib program; apparently this
> functionality fits in explorer.

start.exe is probably more appropriate. Either way you are trying to
make it too smart; it should take a straight Unix path, and not try to
guess anything.

-- 
Alexandre Julliard
julliard at winehq.org


From madewokherd+d41d at gmail.com  Wed Mar 26 08:17:32 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Wed, 26 Mar 2008 09:17:32 -0400
Subject: [PATCH 1 of 2] explorer: add /startfile switch for starting files
	from file managers
In-Reply-To: <871w5xtzsw.fsf@wine.dyndns.org>
References: <ced95fe0803201906t70760536g828ebd2d5fc9dbc4@mail.gmail.com>
	<871w5xtzsw.fsf@wine.dyndns.org>
Message-ID: <ced95fe0803260617l34d03fbcu1a1414dfaac52818@mail.gmail.com>

My understanding is that start.exe will not work because it must be
compatible with the windows version of start. In any case, I don't
think I could usefully share code with the rest of start.

Attempting to guess between unix and windows paths is not necessary (I
saw no reason not to do it, but I can remove it).

I would like to keep the distinction between .exe and other files so
that bug 5368 can be fixed.

On Wed, Mar 26, 2008 at 8:50 AM, Alexandre Julliard <julliard at winehq.org> wrote:
> "Vincent Povirk" <madewokherd+d41d at gmail.com> writes:
>
>  > My last attempt created a new winelib program; apparently this
>  > functionality fits in explorer.
>
>  start.exe is probably more appropriate. Either way you are trying to
>  make it too smart; it should take a straight Unix path, and not try to
>  guess anything.
>
>  --
>  Alexandre Julliard
>  julliard at winehq.org
>



-- 
Vincent Povirk


From dank at kegel.com  Wed Mar 26 08:31:31 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 26 Mar 2008 06:31:31 -0700
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
	(take 2)
In-Reply-To: <47EA2DC9.9030505@redhat.com>
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
	<87ej9xu6pb.fsf@wine.dyndns.org> <47EA2DC9.9030505@redhat.com>
Message-ID: <a71bd89a0803260631q45e2e9bo1a53a1cdafddcddd@mail.gmail.com>

On Wed, Mar 26, 2008 at 4:04 AM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>  > This would require reviewing all uses of WideCharToMultiByte in Wine,
>  > many places get this wrong. Unless you have an app that requires this
>  > fix I'd suggest to leave the test as todo_wine for now.
>
>  Would that be a good janitorial work to be done before Wine 1.0? I feel
>  like I'm getting tired of translating ...

Sure.  A quick grep finds some obvious ones:

$ find . -name '*.c' | xargs grep WideCharToMultiByte | grep ' -1, NULL, NULL)'
./wininet/urlcache.c:        WideCharToMultiByte(CP_ACP, 0,
lpszLocalFileName, -1, achFile, -1, NULL, NULL);
./mshtml/editor.c:        WideCharToMultiByte(CP_ACP, 0, V_BSTR(in),
-1, stra, -1, NULL, NULL);
./mshtml/persist.c:            WideCharToMultiByte(CP_ACP, 0, headers,
-1, data, -1, NULL, NULL);
./mshtml/install.c:    WideCharToMultiByte(CP_ACP, 0, file_name, -1,
file_name_a, -1, NULL, NULL);
./mshtml/nsio.c:            WideCharToMultiByte(CP_ACP, 0,
container->doc->mime, -1, This->content, -1, NULL, NULL);
./mshtml/navigate.c:        WideCharToMultiByte(CP_ACP, 0,
szStatusText, -1, This->nschannel->content, -1, NULL, NULL);
./advapi32/cred.c:        string_len = WideCharToMultiByte(CP_ACP, 0,
CredentialW->TargetName, -1, CredentialA->TargetName, -1, NULL, NULL);
./advapi32/cred.c:        string_len = WideCharToMultiByte(CP_ACP, 0,
CredentialW->Comment, -1, CredentialA->Comment, -1, NULL, NULL);
./advapi32/cred.c:        string_len = WideCharToMultiByte(CP_ACP, 0,
CredentialW->TargetAlias, -1, CredentialA->TargetAlias, -1, NULL,
NULL);
./advapi32/cred.c:        string_len = WideCharToMultiByte(CP_ACP, 0,
CredentialW->UserName, -1, CredentialA->UserName, -1, NULL, NULL);
./urlmon/sec_mgr.c:    WideCharToMultiByte(CP_ACP, 0, url, -1,
(LPSTR)pbSecurityId, -1, NULL, NULL)

(I peeked at that last one.  The code is enforcing the length limit itself and
then telling WideCharToMultiByte that there's no limit.  May as well
pass the proper
limit to WideCharToMultiByte and let it do the length checking?)

The first step, as Alexandre says, is to add the test with a todo_wine
around the negative destlen test.
I would have done it but I'm more than happy to let you run with it.

I haven't quite figured out the fix for bug 9039, this is just something
I noticed along the way.
- Dan


From mstefani at redhat.com  Wed Mar 26 08:38:07 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 26 Mar 2008 14:38:07 +0100
Subject: kernel32: WideCharToMultiByte: return error on negative dest
	len	(take 2)
In-Reply-To: <a71bd89a0803260631q45e2e9bo1a53a1cdafddcddd@mail.gmail.com>
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>	<87ej9xu6pb.fsf@wine.dyndns.org>
	<47EA2DC9.9030505@redhat.com>
	<a71bd89a0803260631q45e2e9bo1a53a1cdafddcddd@mail.gmail.com>
Message-ID: <47EA51BF.5030308@redhat.com>

Dan Kegel wrote:
> On Wed, Mar 26, 2008 at 4:04 AM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>>  > This would require reviewing all uses of WideCharToMultiByte in Wine,
>>  > many places get this wrong. Unless you have an app that requires this
>>  > fix I'd suggest to leave the test as todo_wine for now.
>>
>>  Would that be a good janitorial work to be done before Wine 1.0? I feel
>>  like I'm getting tired of translating ...
> 
> Sure.  A quick grep finds some obvious ones:
> 
> $ find . -name '*.c' | xargs grep WideCharToMultiByte | grep ' -1, NULL, NULL)'

> The first step, as Alexandre says, is to add the test with a todo_wine
> around the negative destlen test.
> I would have done it but I'm more than happy to let you run with it.
Please go ahead and resubmit the patch with todo_wine around it. I don't
want to claim ownership for the patch you wrote.

bye
	michael


From patrol at sinus.cz  Wed Mar 26 08:49:21 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Wed, 26 Mar 2008 14:49:21 +0100
Subject: Can't determine disk space, install fails
Message-ID: <20080326134921.GA16578@tangens.sinus.cz>

Hi!
  We have a long-persisting problem there. It persists for many wine versions
and prevents some programs from installing.
  As an example, today my son complained about impossibility to install WoW.
The installer was not able to determine the free space on the disk (there was
a dash instead of a number in the box) and the Continue button was greyed out,
so it was not possible to proceed.
  There are other cases, in which the installers say that there is not enough
space on the disk and fail. Of course there is enough space, but the installer
is not able to find it.
  Especially WoW has Gold rating and these problems are not mentioned, so I
don't think that this is a common wine problem, thus I'm not going to open
a bug for it. I'm begging for a hint instead, what to try to find the cause
of the problem.
  Wine is always manually compiled and it runs on a "generic Linux system",
not on any particular, publicly known distro.

  With regards, Pavel Troller


From dank at kegel.com  Wed Mar 26 08:50:58 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 26 Mar 2008 06:50:58 -0700
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
	(take 2)
In-Reply-To: <47EA51BF.5030308@redhat.com>
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
	<87ej9xu6pb.fsf@wine.dyndns.org> <47EA2DC9.9030505@redhat.com>
	<a71bd89a0803260631q45e2e9bo1a53a1cdafddcddd@mail.gmail.com>
	<47EA51BF.5030308@redhat.com>
Message-ID: <a71bd89a0803260650y2e16ed95o8d3a7ff206f6dac@mail.gmail.com>

On Wed, Mar 26, 2008 at 6:38 AM, Michael Stefaniuc <mstefani at redhat.com> wrote:
> > The first step, as Alexandre says, is to add the test with a todo_wine
>  > around the negative destlen test.
>  > I would have done it but I'm more than happy to let you run with it.
>
>  Please go ahead and resubmit the patch with todo_wine around it.

Done.

> I don't want to claim ownership for the patch you wrote.

Don't worry, Alexandre usually gets that right.


From julliard at winehq.org  Wed Mar 26 08:53:13 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 14:53:13 +0100
Subject: [1/2] reg: Implement basic 'reg add'. [try 2]
In-Reply-To: <689de9370803240108w44d1730sbb3cd1fb41e10f6f@mail.gmail.com>
	(Andrew Riedi's message of "Mon, 24 Mar 2008 01:08:47 -0700")
References: <689de9370803240108w44d1730sbb3cd1fb41e10f6f@mail.gmail.com>
Message-ID: <87wsnpsiba.fsf@wine.dyndns.org>

"Andrew Riedi" <andrewriedi at gmail.com> writes:

> +{
> +    LPCTSTR lpSubKey;

Please don't use TCHAR types.

> +    static const WCHAR hkcrW[] = {'h','k','c','r',0};
> +    static const WCHAR hkcuW[] = {'h','k','c','u',0};
> +    static const WCHAR hklmW[] = {'h','k','l','m',0};
> +    static const WCHAR hkuW[] = {'h','k','u',0};
> +    static const WCHAR hkpdW[] = {'h','k','p','d',0};
> +    static const WCHAR hkccW[] = {'h','k','c','c',0};
> +    static const WCHAR hkddW[] = {'h','k','d','d',0};
> +
> +    /* Determine key type. */
> +    if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 4, hkcrW, 4) == CSTR_EQUAL)
> +        *hKey = HKEY_CLASSES_ROOT;
> +    else if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 4, hkcuW, 4) == CSTR_EQUAL)
> +        *hKey = HKEY_CURRENT_USER;
> +    else if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 4, hklmW, 4) == CSTR_EQUAL)
> +        *hKey = HKEY_LOCAL_MACHINE;
> +    else if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 3, hkuW, 3) == CSTR_EQUAL)
> +        *hKey = HKEY_USERS;
> +    else if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 4, hkpdW, 4) == CSTR_EQUAL)
> +        *hKey = HKEY_PERFORMANCE_DATA;
> +    else if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 4, hkccW, 4) == CSTR_EQUAL)
> +        *hKey = HKEY_CURRENT_CONFIG;
> +    else if (CompareString(LOCALE_NEUTRAL, NORM_IGNORECASE, key_name, 4, hkddW, 4) == CSTR_EQUAL)
> +        *hKey = HKEY_DYN_DATA;

You should use some sort of array instead of duplicating all that code,
and you need to check the next character of the string too.

-- 
Alexandre Julliard
julliard at winehq.org


From vit.hrachovy at sandbox.cz  Wed Mar 26 09:05:23 2008
From: vit.hrachovy at sandbox.cz (Vit Hrachovy)
Date: Wed, 26 Mar 2008 15:05:23 +0100
Subject: Can't determine disk space, install fails
In-Reply-To: <20080326134921.GA16578@tangens.sinus.cz>
References: <20080326134921.GA16578@tangens.sinus.cz>
Message-ID: <47EA5823.5020003@sandbox.cz>

Hi Pavel,
I've ran into similar issues when, for example, I've got more than 64GB 
free space on the partition, and the old Win installers just told me 
there was -1 bytes free. I'd vote for some Wine (or 3rd party tool) 
functionality that would decrease the reported bytes available per 
user's request.

As a temporary solution for such problems, I've used a small partition 
for installation with just 2GBs free and it worked for me. I've then 
moved the wineprefix into the target partition.
Regards
Vit Hrachovy

Pavel Troller wrote:
> Hi!
>   We have a long-persisting problem there. It persists for many wine versions
> and prevents some programs from installing.
>   As an example, today my son complained about impossibility to install WoW.
> The installer was not able to determine the free space on the disk (there was
> a dash instead of a number in the box) and the Continue button was greyed out,
> so it was not possible to proceed.
>   There are other cases, in which the installers say that there is not enough
> space on the disk and fail. Of course there is enough space, but the installer
> is not able to find it.
>   Especially WoW has Gold rating and these problems are not mentioned, so I
> don't think that this is a common wine problem, thus I'm not going to open
> a bug for it. I'm begging for a hint instead, what to try to find the cause
> of the problem.
>   Wine is always manually compiled and it runs on a "generic Linux system",
> not on any particular, publicly known distro.
> 
>   With regards, Pavel Troller
> 
> 



From rob at codeweavers.com  Wed Mar 26 09:02:46 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 26 Mar 2008 14:02:46 +0000
Subject: wininet: Implement chunked reads.
In-Reply-To: <200803261131.22218.hans@it.vu.nl>
References: <200803261131.22218.hans@it.vu.nl>
Message-ID: <47EA5786.2080108@codeweavers.com>

Hans Leidekker wrote:
>  static DWORD HTTPREQ_ReadFile(WININETHANDLEHEADER *hdr, void *buffer, DWORD size, DWORD *read)
>  {
>      WININETHTTPREQW *req = (WININETHTTPREQW*)hdr;
> +    static WCHAR encoding[20];
> +    DWORD buflen = sizeof(encoding);
> +    static const WCHAR szChunked[] = {'c','h','u','n','k','e','d',0}; 
>   

encoding shouldn't be static.

-- 
Rob Shearman



From julliard at winehq.org  Wed Mar 26 09:04:33 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 15:04:33 +0100
Subject: [PATCH 1 of 2] explorer: add /startfile switch for starting files
	from file managers
In-Reply-To: <ced95fe0803260617l34d03fbcu1a1414dfaac52818@mail.gmail.com>
	(Vincent Povirk's message of "Wed, 26 Mar 2008 09:17:32 -0400")
References: <ced95fe0803201906t70760536g828ebd2d5fc9dbc4@mail.gmail.com>
	<871w5xtzsw.fsf@wine.dyndns.org>
	<ced95fe0803260617l34d03fbcu1a1414dfaac52818@mail.gmail.com>
Message-ID: <87skydshse.fsf@wine.dyndns.org>

"Vincent Povirk" <madewokherd+d41d at gmail.com> writes:

> My understanding is that start.exe will not work because it must be
> compatible with the windows version of start. In any case, I don't
> think I could usefully share code with the rest of start.

It has to be compatible, but adding new options that don't exist on
Windows shouldn't be a problem. That's what you'd have to do in explorer
too anyway.

> I would like to keep the distinction between .exe and other files so
> that bug 5368 can be fixed.

I'm not sure I understand why you need that for 5368.

-- 
Alexandre Julliard
julliard at winehq.org


From htl10 at users.sourceforge.net  Wed Mar 26 09:05:25 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 14:05:25 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
Message-ID: <492306.48686.qm@web23110.mail.ird.yahoo.com>

I found a .NET2/System.Windows.Forms application which was running alright
in 0.9.56/0.9.57 with the appdb adaptations broke in 0.9.58. So I did a git bisect
and found that it is a commit to gdi32/freetype.c from Huw Davies which broke it. 
It is known that .NET does some strange things with fonts and font-related part of 
the registry (See http://bugs.winehq.org/show_bug.cgi?id=10467#c2 for discussion) and
the commit apparently breaks that... I believe I see what that specific commit does
and how it breaks .NET2, but I am not sure I understand *why* the commit was accepted
in the first place and what was its purpose... Can somebody explain, and possibly
either back-out the commit or at least modify it to make it not break stuff?

    commit 0436a5d14abf22af6ec10640496f9e0298a65f69
    Author: Huw Davies <huw at codeweavers.com>
    Date:   Mon Mar 10 12:31:43 2008 +0000

    gdi32: Store the Windows path (if it's available) in the font registry entries.

The error message I got was 'attempt to read or write protected memory. This is often
an indication that other memory is corrupt'.


      __________________________________________________________
Sent from Yahoo! Mail.
More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html


From thunderbird2k at gmx.net  Tue Mar 25 03:45:24 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 25 Mar 2008 09:45:24 +0100
Subject: [PATCH 8/9] wined3d: remove ENTER_GL/LEAVE_GL in texture and cube
	texture PreLoad.
In-Reply-To: <47E84178.6070908@inbox.lv>
References: <47E84178.6070908@inbox.lv>
Message-ID: <20080325084524.44120@gmx.net>

> 
> Not really needed for anything and can lead to ActivateContext being
> called 
> while holding lock.
> ---
>   dlls/wined3d/cubetexture.c |    2 --
>   dlls/wined3d/texture.c     |    3 +--
>   2 files changed, 1 insertions(+), 4 deletions(-)

Sure this is a problem but there needs to be a place which calls ENTER_GL/LEAVE_GL. I believe LoadTexture and some of the other functions aren't handling that properly yet, so I wouldn't add this yet.

It is very tricky.

Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.gmx.net/de/entertainment/games/free




From thestig at google.com  Wed Mar 26 09:40:43 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 26 Mar 2008 07:40:43 -0700
Subject: Can't determine disk space, install fails
In-Reply-To: <20080326134921.GA16578@tangens.sinus.cz>
References: <20080326134921.GA16578@tangens.sinus.cz>
Message-ID: <558b2f5c0803260740s5f6e5c14if5220e95c12c4e71@mail.gmail.com>

On Wed, Mar 26, 2008 at 6:49 AM, Pavel Troller <patrol at sinus.cz> wrote:
> Hi!
>   We have a long-persisting problem there. It persists for many wine versions
>  and prevents some programs from installing.
>   As an example, today my son complained about impossibility to install WoW.
>  The installer was not able to determine the free space on the disk (there was
>  a dash instead of a number in the box) and the Continue button was greyed out,
>  so it was not possible to proceed.
>   There are other cases, in which the installers say that there is not enough
>  space on the disk and fail. Of course there is enough space, but the installer
>  is not able to find it.
>   Especially WoW has Gold rating and these problems are not mentioned, so I
>  don't think that this is a common wine problem, thus I'm not going to open
>  a bug for it. I'm begging for a hint instead, what to try to find the cause
>  of the problem.
>   Wine is always manually compiled and it runs on a "generic Linux system",
>  not on any particular, publicly known distro.
>
>   With regards, Pavel Troller
>
>
>

Can you file a bug for this on Wine's bugzilla? [1] I'm really
surprised WoW does not install for you, considering it's probably one
of the most popular apps out there.

[1] http://bugs.winehq.org/


From galeru at gmail.com  Wed Mar 26 09:41:06 2008
From: galeru at gmail.com (Corey McClymonds)
Date: Wed, 26 Mar 2008 10:41:06 -0400
Subject: Google Summer of Code - Case Insensitive Filenames
In-Reply-To: <e3d3ae8f0803251843h262099a3o10c8dc224ea8a4c6@mail.gmail.com>
References: <e3d3ae8f0803060906m6046a9ahebceae6536271972@mail.gmail.com>
	<200803251508.21754.kai.blin@gmail.com>
	<b6bb06270803250921m3bcf5107p9e199e7109d27504@mail.gmail.com>
	<200803251802.38804.kai.blin@gmail.com>
	<e3d3ae8f0803251843h262099a3o10c8dc224ea8a4c6@mail.gmail.com>
Message-ID: <63ee2bc70803260741q7148dcc7sc97acfce7c84250d@mail.gmail.com>

On Tue, Mar 25, 2008 at 9:43 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
>
> On Tue, Mar 25, 2008 at 12:02 PM, Kai Blin <kai.blin at gmail.com> wrote:
>  > On Tuesday 25 March 2008 17:21:20 Austin English wrote:
>  >
>  >  > An option yes, but it should not be the default course of action. As
>  >  > Rahyen said, a predictable order should be used, and when there are
>  >  > conflicts, pick the first in that order for presentation through the
>  >  > FUSE system. User can then rename files/delete files to get the one
>  >  > they want (or if possible, have a configuration menu to adjust chosen
>  >  > file order/allow exceptions, etc.).
>  >

Wouldn't it make the most sense to use whichever one was modified
last?  In most cases. that gives you the right response, eg. you put
in a modified executable via patch or similar, and want it to use that
version.

[snip]


From vostok at etersoft.ru  Wed Mar 26 09:59:38 2008
From: vostok at etersoft.ru (Anatoly Lyutin)
Date: Wed, 26 Mar 2008 17:59:38 +0300
Subject: [2/2] comctl32: tab.c The Item Interior should use HotTracking
	color not Hilight color (resend).
In-Reply-To: <87abklu6cd.fsf@wine.dyndns.org>
References: <47E92543.3070109@etersoft.ru> <87abklu6cd.fsf@wine.dyndns.org>
Message-ID: <47EA64DA.9070905@etersoft.ru>

Alexandre Julliard wrote:
>> @@ -1633,7 +1633,7 @@ TAB_DrawItemInterior(const TAB_INFO *inf
>>        SetTextColor(hdc, (((lStyle & TCS_HOTTRACK) && (iItem == infoPtr->iHotTracked) 
>>                            && !(lStyle & TCS_FLATBUTTONS)) 
>>                          | (TAB_GetItem(infoPtr, iItem)->dwState & TCIS_HIGHLIGHTED)) ?
>> -                        comctl32_color.clrHighlight : comctl32_color.clrBtnText);
>> +                        comctl32_color.clrHotTrackingColor : comctl32_color.clrBtnText);
>>     
>
> Shouldn't you distinguish between TCS_HOTTRACK and TCIS_HIGHLIGHTED
> here?
I could not find anywhere documentation about TCIS_HIGHLIGHTED...
I just changed the registry value "HotTrackingColor" in Windows and 
after that I have seen that the tab flashes HotTracking color not Hilight.

Please tell me right way to fix this mistake.


-- 
Best regards
	Anatoly Lyutin.



From julliard at winehq.org  Wed Mar 26 09:13:33 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 15:13:33 +0100
Subject: kernel32: WideCharToMultiByte: return error on negative dest len
	(take 2)
In-Reply-To: <a71bd89a0803260650y2e16ed95o8d3a7ff206f6dac@mail.gmail.com> (Dan
	Kegel's message of "Wed, 26 Mar 2008 06:50:58 -0700")
References: <a71bd89a0803251923o3389a279t8cf1894ff0fb1339@mail.gmail.com>
	<87ej9xu6pb.fsf@wine.dyndns.org> <47EA2DC9.9030505@redhat.com>
	<a71bd89a0803260631q45e2e9bo1a53a1cdafddcddd@mail.gmail.com>
	<47EA51BF.5030308@redhat.com>
	<a71bd89a0803260650y2e16ed95o8d3a7ff206f6dac@mail.gmail.com>
Message-ID: <87myolshde.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

>> I don't want to claim ownership for the patch you wrote.
>
> Don't worry, Alexandre usually gets that right.

Maybe, but I don't like it. I really prefer for people to send their own
patches instead of having others do it for them.

-- 
Alexandre Julliard
julliard at winehq.org


From htl10 at users.sourceforge.net  Wed Mar 26 09:55:07 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 14:55:07 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <20080326144712.GB31599@merlot.physics.ox.ac.uk>
Message-ID: <394725.32322.qm@web23102.mail.ird.yahoo.com>

--- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
<snipped>
> > The error message I got was 'attempt to read or
> write protected memory. This is often
> > an indication that other memory is corrupt'.
>  
> Hi,
> 
> Could you explain how this breaks .NET2, I can't see
> why it should at the moment?
> The purpose of the commit is to do what Windows does.

I am not entirely sure myself - all I know is I did a git bisect to find what was 
the problematic commit, and reverting this particular commit on top of 0.9.58 fixes my problem. 

My understanding is that the .NET framework uses the windows registry font
entries for font look-ups, according to the discussion in http://bugs.winehq.org/show_bug.cgi?id=10467#c2, and it loads fonts directly based on the registry font list and does its own rendering thing with the font files directly; 
So changing font registry entries break things.



      ___________________________________________________________ 
Rise to the challenge for Sport Relief with Yahoo! For Good  

http://uk.promotions.yahoo.com/forgood/


From huw at codeweavers.com  Wed Mar 26 10:21:02 2008
From: huw at codeweavers.com (Huw Davies)
Date: Wed, 26 Mar 2008 15:21:02 +0000
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <394725.32322.qm@web23102.mail.ird.yahoo.com>
References: <20080326144712.GB31599@merlot.physics.ox.ac.uk>
	<394725.32322.qm@web23102.mail.ird.yahoo.com>
Message-ID: <20080326152102.GC31599@merlot.physics.ox.ac.uk>

On Wed, Mar 26, 2008 at 02:55:07PM +0000, Hin-Tak Leung wrote:
> --- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
> <snipped>
> > > The error message I got was 'attempt to read or
> > write protected memory. This is often
> > > an indication that other memory is corrupt'.
> >  
> > Hi,
> > 
> > Could you explain how this breaks .NET2, I can't see
> > why it should at the moment?
> > The purpose of the commit is to do what Windows does.
> 
> I am not entirely sure myself - all I know is I did a git bisect to find what was 
> the problematic commit, and reverting this particular commit on top of 0.9.58 fixes my problem. 
> 
> My understanding is that the .NET framework uses the windows registry font
> entries for font look-ups, according to the discussion in http://bugs.winehq.org/show_bug.cgi?id=10467#c2, and it loads fonts directly based on the registry font list and does its own rendering thing with the font files directly; 
> So changing font registry entries break things.

Well yes, but that doesn't actually mean the patch is incorrect.

Do you by any chance have the font 'ukai.ttf' installed?  If so could
you try removing it from your fontconfig path and see if that helps?

Huw.
-- 
Huw Davies
huw at codeweavers.com


From huw at codeweavers.com  Wed Mar 26 09:47:12 2008
From: huw at codeweavers.com (Huw Davies)
Date: Wed, 26 Mar 2008 14:47:12 +0000
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <492306.48686.qm@web23110.mail.ird.yahoo.com>
References: <492306.48686.qm@web23110.mail.ird.yahoo.com>
Message-ID: <20080326144712.GB31599@merlot.physics.ox.ac.uk>

On Wed, Mar 26, 2008 at 02:05:25PM +0000, Hin-Tak Leung wrote:
> I found a .NET2/System.Windows.Forms application which was running alright
> in 0.9.56/0.9.57 with the appdb adaptations broke in 0.9.58. So I did a git bisect
> and found that it is a commit to gdi32/freetype.c from Huw Davies which broke it. 
> It is known that .NET does some strange things with fonts and font-related part of 
> the registry (See http://bugs.winehq.org/show_bug.cgi?id=10467#c2 for discussion) and
> the commit apparently breaks that... I believe I see what that specific commit does
> and how it breaks .NET2, but I am not sure I understand *why* the commit was accepted
> in the first place and what was its purpose... Can somebody explain, and possibly
> either back-out the commit or at least modify it to make it not break stuff?
> 
>     commit 0436a5d14abf22af6ec10640496f9e0298a65f69
>     Author: Huw Davies <huw at codeweavers.com>
>     Date:   Mon Mar 10 12:31:43 2008 +0000
> 
>     gdi32: Store the Windows path (if it's available) in the font registry entries.
> 
> The error message I got was 'attempt to read or write protected memory. This is often
> an indication that other memory is corrupt'.
 
Hi,

Could you explain how this breaks .NET2, I can't see why it should at the moment?
The purpose of the commit is to do what Windows does.

Thanks,
Huw.
-- 
Huw Davies
huw at codeweavers.com


From htl10 at users.sourceforge.net  Wed Mar 26 10:33:27 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 15:33:27 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <20080326152102.GC31599@merlot.physics.ox.ac.uk>
Message-ID: <202895.60473.qm@web23114.mail.ird.yahoo.com>

--- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:

> From: Huw Davies <huw at codeweavers.com>
> Subject: Re: gdi32-related commit between 0.9.57<->0.9.58 broken .NET2/Systems.Windows.Forms
> To: "Hin-Tak Leung" <htl10 at users.sourceforge.net>
> Cc: wine-devel at winehq.org
> Date: Wednesday, 26 March, 2008, 3:21 PM
> On Wed, Mar 26, 2008 at 02:55:07PM +0000, Hin-Tak Leung
> wrote:
> > --- On Wed, 26/3/08, Huw Davies
> <huw at codeweavers.com> wrote:
> > <snipped>
> > > > The error message I got was 'attempt to
> read or
> > > write protected memory. This is often
> > > > an indication that other memory is
> corrupt'.
> > >  
> > > Hi,
> > > 
> > > Could you explain how this breaks .NET2, I
> can't see
> > > why it should at the moment?
> > > The purpose of the commit is to do what Windows
> does.
> > 
> > I am not entirely sure myself - all I know is I did a
> git bisect to find what was 
> > the problematic commit, and reverting this particular
> commit on top of 0.9.58 fixes my problem. 
> > 
> > My understanding is that the .NET framework uses the
> windows registry font
> > entries for font look-ups, according to the discussion
> in http://bugs.winehq.org/show_bug.cgi?id=10467#c2, and it
> loads fonts directly based on the registry font list and
> does its own rendering thing with the font files directly; 
> > So changing font registry entries break things.
> 
> Well yes, but that doesn't actually mean the patch is
> incorrect.

Well, it is certainly doing something that the .NET framework doesn't like -  
or, maybe exposing a bug elsewhere which wasn't reached due to incompleteness before.
Can you explain the purpose of your patch?

> Do you by any chance have the font 'ukai.ttf'
> installed?  If so could
> you try removing it from your fontconfig path and see if
> that helps?

Yes, I have ukai.ttf on my system (and others came with Fedora 8), 
but I am running wine in  LANG=en_US.UTF-8 . I'll give your suggestion a 
try.


      __________________________________________________________
Sent from Yahoo! Mail.
More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html


From msclrhd at googlemail.com  Tue Mar 25 17:55:26 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 25 Mar 2008 22:55:26 +0000
Subject: prevents WM_DISPLAYCHANGE message being sent when a call to
	ChangeDisplaySettingsEx fails due to the requested change to
	the display not occurring.
In-Reply-To: <47E7CBC0.8050806@mail.leather-wallet.co.uk>
References: <47E7CBC0.8050806@mail.leather-wallet.co.uk>
Message-ID: <3f4fd2640803251555r47d6fc73r2462567c7bd84286@mail.gmail.com>

On 24/03/2008, chris morgan <cmorgan at mail.leather-wallet.co.uk> wrote:
>  test code run on windows nt4 sp6, messages checked using ms spk++:
>
>       DEVMODE dev_mode;
>       memset(&dev_mode,0,sizeof(DEVMODE));
>       dev_mode.dmSize = sizeof(DEVMODE);
>
>       // Get the current display settings
>       if (!EnumDisplaySettings(NULL,ENUM_CURRENT_SETTINGS,&dev_mode))
>       {
>           printf("Could not EnumDisplaySettings, giving up.\n");
>           return 0;
>       }
>
>       // Call ChangeDisplaySettings with the current settings,
>       // No WM_DISPLAYCHANGE message sent
>       ChangeDisplaySettings(&dev_mode, 0);
>
>       // Change something (that works)
>       dev_mode.dmBitsPerPel = 32;
>
>       // WM_DISPLAYCHANGE message sent
>       ChangeDisplaySettings(&dev_mode, 0);
>
>       // Change something to an impossible value
>       dev_mode.dmBitsPerPel = 999;
>
>       // No WM_DISPLAYCHANGE message sent
>       ChangeDisplaySettings(&dev_mode, 0);

This should be incorporated into a conformance/regression test. That
way, this bug will not reappear and can also be verified as the
correct behaviour on different versions of Windows.

> +    if (width == screen_width && height == screen_height)
> +    {
> +	return;
> +    }

w.r.t. the implementation:
  *  ChangeDisplaySettings returns a long
(http://msdn2.microsoft.com/en-us/library/ms533260(VS.85).aspx), so
the correct value must be returned on error;
  *  the fix does not match the test cases (screen size vs colour depth).

In addition, your tests should:
  *  check that changing the screen resolution causes a
WM_DISPLAYCHANGE message to be sent;
  *  if there are no other tests, ChangeDisplaySettings should be
checked to see what happens with invalid arguments (for completeness);
  *  the return value is not checked for expected values (see
http://msdn2.microsoft.com/en-us/library/ms533260(VS.85).aspx);
  *  GetLastError() is not checked to see what it is set to (see other
tests for examples);
  *  restore the display settings back to what they were before the tests.

Thanks for improving Wine,
- Reece


From msclrhd at googlemail.com  Wed Mar 26 02:49:30 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 26 Mar 2008 07:49:30 +0000
Subject: [1/2] shlwapi: added tests for SHCreateStreamOnFile IStream_Read.
In-Reply-To: <3f4fd2640803251634k6951a4e0oa737b2c787115e84@mail.gmail.com>
References: <3f4fd2640803251634k6951a4e0oa737b2c787115e84@mail.gmail.com>
Message-ID: <3f4fd2640803260049r14b9885an3f6f5d8d730b171e@mail.gmail.com>

On 25/03/2008, Reece Dunn <msclrhd at googlemail.com> wrote:
> This patch adds some basic tests for the Read method of the various
>  SHCreateStreamOnFile APIs, while making it possible to add other
>  IStream method tests.
>
>  At the moment, these tests are being skipped on Wine because it is not
>  returning a valid stream object in the tests.

Alexandre: please ignore these patches for now. I am working on a more
comprehensive series of tests for the various IStream methods.

Thanks,
- Reece


From =?UTF-8?B?0J3QvtCy0LjQutC+0LIg0KDQvtC80LDQvSDQmtC+0L3RgdGC0LDQvdGC0Lg=?=  Wed Mar 26 04:57:56 2008
From: =?UTF-8?B?0J3QvtCy0LjQutC+0LIg0KDQvtC80LDQvSDQmtC+0L3RgdGC0LDQvdGC0Lg=?= (=?UTF-8?B?0J3QvtCy0LjQutC+0LIg0KDQvtC80LDQvSDQmtC+0L3RgdGC0LDQvdGC0Lg=?=)
Date: Wed, 26 Mar 2008 12:57:56 +0300
Subject: Trouble in compiling Wine 0.9.57 and 0.9.58 on Solaris 10 08/07
Message-ID: <47EA1E24.8010700@hisoft.ru>

Hi guys!
I've got some trouble with compiling Wine 0.9.57 & 0.9.58 on Solaris 10 
08/07
After 40 minutes of the compilation the process halted with messages:
wined3d_private.h: In function `float_32_to_16':
wined3d_private.h:159: warning: implicit declaration of function `isinf'
wined3d_main.c: At top level:
wined3d_main.c:271: warning: visibility attribute not supported in this 
configuration; ignored
(the last string repeated for many times)
I suppose the situation is connected with Solaris 'isinf' but I am too 
far from programming under UNIX...
My version of gcc is 3.4.3 (Solaris native):
bash-3.00# gcc -v
Reading specs from /usr/sfw/lib/gcc/i386-pc-solaris2.10/3.4.3/specs
Configured with: /builds/sfw10-gate/usr/src/cmd/gcc/gcc-3.4.3/configure 
--prefix=/usr/sfw --with-as=/usr/sfw/bin/gas --with-gnu-as 
--with-ld=/usr/ccs/bin/ld --without-gnu-ld --enable-languages=c,c++ 
--enable-shared
Thread model: posix
gcc version 3.4.3 (csl-sol210-3_4-branch+sol_rpath)

My configure string is:
./configure --enable-win64 --with-x --x-includes=/usr --x-libraries=/usr
I built successfully Wine 0.9.56 and earlier..
What can I do with this?
Thanks in advance.

Rome



From msclrhd at googlemail.com  Tue Mar 25 17:55:26 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 25 Mar 2008 22:55:26 +0000
Subject: prevents WM_DISPLAYCHANGE message being sent when a call to
	ChangeDisplaySettingsEx fails due to the requested change to
	the display not occurring.
In-Reply-To: <47E7CBC0.8050806@mail.leather-wallet.co.uk>
References: <47E7CBC0.8050806@mail.leather-wallet.co.uk>
Message-ID: <3f4fd2640803251555r47d6fc73r2462567c7bd84286@mail.gmail.com>

On 24/03/2008, chris morgan <cmorgan at mail.leather-wallet.co.uk> wrote:
>  test code run on windows nt4 sp6, messages checked using ms spk++:
>
>       DEVMODE dev_mode;
>       memset(&dev_mode,0,sizeof(DEVMODE));
>       dev_mode.dmSize = sizeof(DEVMODE);
>
>       // Get the current display settings
>       if (!EnumDisplaySettings(NULL,ENUM_CURRENT_SETTINGS,&dev_mode))
>       {
>           printf("Could not EnumDisplaySettings, giving up.\n");
>           return 0;
>       }
>
>       // Call ChangeDisplaySettings with the current settings,
>       // No WM_DISPLAYCHANGE message sent
>       ChangeDisplaySettings(&dev_mode, 0);
>
>       // Change something (that works)
>       dev_mode.dmBitsPerPel = 32;
>
>       // WM_DISPLAYCHANGE message sent
>       ChangeDisplaySettings(&dev_mode, 0);
>
>       // Change something to an impossible value
>       dev_mode.dmBitsPerPel = 999;
>
>       // No WM_DISPLAYCHANGE message sent
>       ChangeDisplaySettings(&dev_mode, 0);

This should be incorporated into a conformance/regression test. That
way, this bug will not reappear and can also be verified as the
correct behaviour on different versions of Windows.

> +    if (width == screen_width && height == screen_height)
> +    {
> +	return;
> +    }

w.r.t. the implementation:
  *  ChangeDisplaySettings returns a long
(http://msdn2.microsoft.com/en-us/library/ms533260(VS.85).aspx), so
the correct value must be returned on error;
  *  the fix does not match the test cases (screen size vs colour depth).

In addition, your tests should:
  *  check that changing the screen resolution causes a
WM_DISPLAYCHANGE message to be sent;
  *  if there are no other tests, ChangeDisplaySettings should be
checked to see what happens with invalid arguments (for completeness);
  *  the return value is not checked for expected values (see
http://msdn2.microsoft.com/en-us/library/ms533260(VS.85).aspx);
  *  GetLastError() is not checked to see what it is set to (see other
tests for examples);
  *  restore the display settings back to what they were before the tests.

Thanks for improving Wine,
- Reece


From hintak_leung at yahoo.co.uk  Wed Mar 26 09:47:31 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 14:47:31 +0000 (GMT)
Subject: DLL exports... HELP?!
In-Reply-To: <47EA38DF.3060501@gmx.net>
Message-ID: <494035.78583.qm@web23110.mail.ird.yahoo.com>

Wow :-). I have almost wanted to suggest such a native wine-based printer driver 
as a linux foundation/openprinting GOSC project (I am one of the mentors under the
openprinting umbrella https://www.linux-foundation.org/en/Google_Summer_of_Code). 
I am glad I didn't :-).

I suppose under the terms of the license you don't mind we do some work based
on your work? I'll let "the other printing folks" know. 

--- On Wed, 26/3/08, Marcel Partap <mpartap at gmx.net> wrote:

> From: Marcel Partap <mpartap at gmx.net>
> Subject: Re: DLL exports... HELP?!
> To: pure_evil at mail.bg
> Cc: wine-devel at winehq.org
> Date: Wednesday, 26 March, 2008, 11:51 AM
> Hi Stefanov,
> attached is the code of a standalone proxy DLL I developed
> last year during SoC, have a look 
> especially at the makefile for cross-compilation...
> regards marcel.
> 
> -- 
> <div id="signature">
>    "Obstacles are those frightful things you see when
> you take your eyes off your goal."
>                                                            
>    -- Henry Ford (1863-1947)
>    Change the world! Vote revolution:
> http://hfopi.org/vote-future
> </div>


      ___________________________________________________________ 
Rise to the challenge for Sport Relief with Yahoo! For Good  

http://uk.promotions.yahoo.com/forgood/


From huw at codeweavers.com  Wed Mar 26 10:40:53 2008
From: huw at codeweavers.com (Huw Davies)
Date: Wed, 26 Mar 2008 15:40:53 +0000
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <202895.60473.qm@web23114.mail.ird.yahoo.com>
References: <20080326152102.GC31599@merlot.physics.ox.ac.uk>
	<202895.60473.qm@web23114.mail.ird.yahoo.com>
Message-ID: <20080326154053.GD31599@merlot.physics.ox.ac.uk>

On Wed, Mar 26, 2008 at 03:33:27PM +0000, Hin-Tak Leung wrote:
> --- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
> > Well yes, but that doesn't actually mean the patch is
> > incorrect.
> 
> Well, it is certainly doing something that the .NET framework doesn't like -  
> or, maybe exposing a bug elsewhere which wasn't reached due to incompleteness before.
> Can you explain the purpose of your patch?

I think it's a bug in *native* gdiplus.  If you install ukai.ttf on
Windows then apps that use gdiplus will crash too.

> > Do you by any chance have the font 'ukai.ttf'
> > installed?  If so could
> > you try removing it from your fontconfig path and see if
> > that helps?
> 
> Yes, I have ukai.ttf on my system (and others came with Fedora 8), 
> but I am running wine in  LANG=en_US.UTF-8 . I'll give your suggestion a 
> try.

Actually I've just attached a hack to the bug, try that instead.

Thanks,
Huw.
-- 
Huw Davies
huw at codeweavers.com


From madewokherd+d41d at gmail.com  Wed Mar 26 11:09:08 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Wed, 26 Mar 2008 12:09:08 -0400
Subject: [PATCH 1 of 2] explorer: add /startfile switch for starting files
	from file managers
In-Reply-To: <87skydshse.fsf@wine.dyndns.org>
References: <ced95fe0803201906t70760536g828ebd2d5fc9dbc4@mail.gmail.com>
	<871w5xtzsw.fsf@wine.dyndns.org>
	<ced95fe0803260617l34d03fbcu1a1414dfaac52818@mail.gmail.com>
	<87skydshse.fsf@wine.dyndns.org>
Message-ID: <ced95fe0803260909w1351b9dbxc4f9ae8154f3051f@mail.gmail.com>

On Wed, Mar 26, 2008 at 10:04 AM, Alexandre Julliard
<julliard at winehq.org> wrote:
> "Vincent Povirk" <madewokherd+d41d at gmail.com> writes:
>
>
> > My understanding is that start.exe will not work because it must be
>  > compatible with the windows version of start. In any case, I don't
>  > think I could usefully share code with the rest of start.
>
>  It has to be compatible, but adding new options that don't exist on
>  Windows shouldn't be a problem. That's what you'd have to do in explorer
>  too anyway.
>
Ok, I'll have to look at this in more detail when I am at home.

>  > I would like to keep the distinction between .exe and other files so
>  > that bug 5368 can be fixed.
>
>  I'm not sure I understand why you need that for 5368.
>
It's more the combination of 5224 and 5368.

5224 requires quotes around the exe filename in the command line, even
if the filename contains no spaces. ShellExecuteEx does not let me put
in the quotes. I think I tested start.exe on windows and it also did
not let me add quotes, but I will check again.

5368 isn't very clear (someone apparently wants to make windows file
associations somehow work like those on Linux), but it seems like it
could be partially solved by having something that users can open
non-exe files with in nautilus to start it with the file association
in wine. I think it makes sense from a user perspective to do this by
starting them with "wine". For that to work, nautilus needs to be able
to start them with the same method as exe files.

I don't think starting non-exe files should be considered a separate
feature. wine.desktop really should do what windows explorer would do,
and that's the problem I want to solve here.

-- 
Vincent Povirk


From htl10 at users.sourceforge.net  Wed Mar 26 11:38:26 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 16:38:26 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <20080326154053.GD31599@merlot.physics.ox.ac.uk>
Message-ID: <887519.50316.qm@web23105.mail.ird.yahoo.com>

--- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
<snipped>
> I think it's a bug in *native* gdiplus.  If you install
> ukai.ttf on
> Windows then apps that use gdiplus will crash too.

oh. I suppose it is fair enough that installing any fonts
on windows can have bad effects. 

But, OTOH, should one expose the whole of fontconfig-available
fonts to wine? A lot of them may be dubious to various extent. 

If ukai is affected, I would suspect uming (also from Arphic)
would be the same? and how many non-english fonts one want to 
"work-around" like this?


> 
> > > Do you by any chance have the font
> 'ukai.ttf'
> > > installed?  If so could
> > > you try removing it from your fontconfig path and
> see if
> > > that helps?
> > 
> > Yes, I have ukai.ttf on my system (and others came
> with Fedora 8), 
> > but I am running wine in  LANG=en_US.UTF-8 . I'll
> give your suggestion a 
> > try.
> 
> Actually I've just attached a hack to the bug, try that
> instead.

Thanks - but I also have uming, and a a fair number of other fonts
shipped from fedora for non-english. (over 100).


      __________________________________________________________
Sent from Yahoo! Mail.
More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html


From austinenglish at gmail.com  Wed Mar 26 11:44:24 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 26 Mar 2008 11:44:24 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47E8C0FC.2010700@gmail.com>
References: <47E8C0FC.2010700@gmail.com>
Message-ID: <b6bb06270803260944r36fb307ar5911708dffa34e26@mail.gmail.com>

On Tue, Mar 25, 2008 at 4:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi,
>
>  We didn't have a new winetest executable for the last few days. MinGW doesn't
>  know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.
>
>  Especially while in the process of getting ready for 1.0 we should have winetest
>  run as much as possible.
>
>  My main focus will be adding tests btw until 1.0 is out. These will be both
>  tests to proof the correctness of the current implementation as well as tests to
>  show missing stuff. There are loads of functions for which we have no tests yet
>  and with the 1.0 in sight I think it becomes very important to have tests for
>  virtually every function we (have) implement(ed).

Might make a good SoC project?


From patrol at sinus.cz  Wed Mar 26 11:44:27 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Wed, 26 Mar 2008 17:44:27 +0100
Subject: Can't determine disk space, install fails
In-Reply-To: <47EA5823.5020003@sandbox.cz>
References: <20080326134921.GA16578@tangens.sinus.cz>
	<47EA5823.5020003@sandbox.cz>
Message-ID: <20080326164427.GA28884@tangens.sinus.cz>

Ahoj Vito / Hi Vit,
  many thanks for your valuable help! In our case, it depends on the
partition size, not on the free space remaining. We've found that on every
partition bigger than 64G, the installation fails.
  Now we are performing an experimental installation in /var/tmp, where /var
has only 15G in our case, and it works like a charm.
  What debugging options could we set to collect symptoms of the problem ?
  With regards,
     Pavel Troller
  
> Hi Pavel,
> I've ran into similar issues when, for example, I've got more than 64GB 
> free space on the partition, and the old Win installers just told me 
> there was -1 bytes free. I'd vote for some Wine (or 3rd party tool) 
> functionality that would decrease the reported bytes available per 
> user's request.
> 
> As a temporary solution for such problems, I've used a small partition 
> for installation with just 2GBs free and it worked for me. I've then 
> moved the wineprefix into the target partition.
> Regards
> Vit Hrachovy
> 
> Pavel Troller wrote:
> > Hi!
> >   We have a long-persisting problem there. It persists for many wine versions
> > and prevents some programs from installing.
> >   As an example, today my son complained about impossibility to install WoW.
> > The installer was not able to determine the free space on the disk (there was
> > a dash instead of a number in the box) and the Continue button was greyed out,
> > so it was not possible to proceed.
> >   There are other cases, in which the installers say that there is not enough
> > space on the disk and fail. Of course there is enough space, but the installer
> > is not able to find it.
> >   Especially WoW has Gold rating and these problems are not mentioned, so I
> > don't think that this is a common wine problem, thus I'm not going to open
> > a bug for it. I'm begging for a hint instead, what to try to find the cause
> > of the problem.
> >   Wine is always manually compiled and it runs on a "generic Linux system",
> > not on any particular, publicly known distro.
> > 
> >   With regards, Pavel Troller
> > 
> > 
> 
> 


From htl10 at users.sourceforge.net  Wed Mar 26 11:51:31 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 16:51:31 +0000 (GMT)
Subject: Fw: Re: Google Summer of Code 2008 - joined openprinting+wine project?
Message-ID: <94951.56539.qm@web23105.mail.ird.yahoo.com>

Hi, anybody on wine-devel want to take this on and make this more concrete?

--- On Wed, 26/3/08, Till Kamppeter <till.kamppeter at gmail.com> wrote:

> From: Till Kamppeter <till.kamppeter at gmail.com>
> Subject: Re: Google Summer of Code 2008 - Some general instructions for reviewing the student's applications
> To: "Hin-Tak Leung" <hintak_leung at yahoo.co.uk>
> Cc: "Casey Schaufler" <casey at schaufler-ca.com>, "'Glen Petrie'" <glen.petrie at eitc.epson.com>, "Rik van Riel" <riel at redhat.com>, "Jeff Licquia" <licquia at debian.org>, "Jon Masters" <jonmasters at gmail.com>, "Jonathan Riddell" <jriddell at ubuntu.com>, "Josef Spillner" <spillner at kde.org>, Matt_Domsch at dell.com, "Pekka Enberg" <penberg at cs.helsinki.fi>
> Date: Wednesday, 26 March, 2008, 4:34 PM
> Hin-Tak Leung wrote:
> > Hi Till and the rest of the gang.
> > 
> > Two people had got in touch with with about the
> IJS+PDF workflow, and I replied. 
> > (sorry I don't check the "other" e-mail
> often - I probably should set up re-direction).
> >
> 
> Great!
> 
> > I thought I should also mentioned that it has just
> came to my attention in some unrelated discussion on
> wine-devel - been doing some non-printing wine-related
> stuff lately - that there *was* a google summer of code
> 2007 project for a
> > wine-based native printer driver proxy - this is the
> sort of thing I have had in mind
> > for a while and I thought it would be interesting to
> do but I don't have in-depth
> > windows knowledge to make it happen, but the wine
> people already did!
> > http://google-summer-of-code-2007-wine.googlecode.com/
> > 
> > I just downloaded the gsoc 2007 printerproxy code. It
> seems that it is just for use
> > from within wine, but it just might be interesting to
> make it more general - via opvp
> > or IJS. We should follow up on this.
> 
> If this project still requires coding, it is not too late
> to add it as 
> project idea to the ideas pages of both the Linux
> Foundation and WINE 
> (having it presented at two mentoring organizations raises
> the chances 
> to find a student).
> 
> Our ideas page is a Wiki and you can simply edit it:
> 
> https://www.linux-foundation.org/en/Google_Summer_of_Code
> 
>     Till


      __________________________________________________________
Sent from Yahoo! Mail.
More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html


From huw at codeweavers.com  Wed Mar 26 11:51:41 2008
From: huw at codeweavers.com (Huw Davies)
Date: Wed, 26 Mar 2008 16:51:41 +0000
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <887519.50316.qm@web23105.mail.ird.yahoo.com>
References: <20080326154053.GD31599@merlot.physics.ox.ac.uk>
	<887519.50316.qm@web23105.mail.ird.yahoo.com>
Message-ID: <20080326165141.GE31599@merlot.physics.ox.ac.uk>

On Wed, Mar 26, 2008 at 04:38:26PM +0000, Hin-Tak Leung wrote:
> --- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
> But, OTOH, should one expose the whole of fontconfig-available
> fonts to wine? A lot of them may be dubious to various extent. 

Well we already did that anyway.  It was just the native gdiplus apps
didn't see them because of a bug that this commit fixed.

> If ukai is affected, I would suspect uming (also from Arphic)
> would be the same? and how many non-english fonts one want to 
> "work-around" like this?

I've not seen any problems with uming.  Most 'non-english' fonts will
work fine.  There's something very specific about ukai that causes
native gdiplis to have problems.

> > Actually I've just attached a hack to the bug, try that
> > instead.
> 
> Thanks - but I also have uming, and a a fair number of other fonts
> shipped from fedora for non-english. (over 100).

Please try the patch and report back.

Huw.
-- 
Huw Davies
huw at codeweavers.com


From mat at brain-dump.org  Wed Mar 26 11:59:10 2008
From: mat at brain-dump.org (Marc Andre Tanner)
Date: Wed, 26 Mar 2008 17:59:10 +0100
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
References: <20080325213351.GA3237@debbook.brain-dump.org>
	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
Message-ID: <20080326165909.GA3213@debbook.brain-dump.org>

On Wed, Mar 26, 2008 at 12:49:16PM +0100, Francois Gouget wrote:
> On Tue, 25 Mar 2008, Marc Andre Tanner wrote:
> [...]
> > The filesystem converts every path to lower case before further
> > operations take place. On file creation the original filename is
> > stored in an extended attribute and later returned upon request.
> 
> Shouldn't it be the other way around? I guess the way you've done it is 
> simpler because you can simply rely on the standard kernel code to 
> ensure filename uniqueness, but it also means that anyone accessing the 
> underlying files directly will lose the case information.

Yes that's true the case information is lost but is it really needed? 
If you create the files with the original mixed case you will have to
scan the whole directory in order to match it to a given filename. 
And if i am not mistaken this is exactly what wine does. 

Note also that in the current form having files with upper case letters in 
the underlying directory will cause problems (i will probably just ignore
them in readdir for now). Another quite crazy idea is to transform the
whole directory to lowercase on mount and then on unmount back to the 
original mixed case representation. That would preserve the case information,
but the mount/unmount will be quite expensive and probably cause some
problems if someone is messing around with de underlying directory 
directly.

By the way there is now a git repository available for those who want
to play with it.

  git clone git://repo.or.cz/ciopfs.git

Regards,
Marc

-- 
 Marc Andre Tanner >< http://www.brain-dump.org/ >< GPG key: CF7D56C0


From julliard at winehq.org  Wed Mar 26 12:10:16 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 26 Mar 2008 18:10:16 +0100
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <20080326165909.GA3213@debbook.brain-dump.org> (Marc Andre
	Tanner's message of "Wed, 26 Mar 2008 17:59:10 +0100")
References: <20080325213351.GA3237@debbook.brain-dump.org>
	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
	<20080326165909.GA3213@debbook.brain-dump.org>
Message-ID: <87iqz9s96v.fsf@wine.dyndns.org>

Marc Andre Tanner <mat at brain-dump.org> writes:

> Yes that's true the case information is lost but is it really needed? 
> If you create the files with the original mixed case you will have to
> scan the whole directory in order to match it to a given filename. 
> And if i am not mistaken this is exactly what wine does. 

Yes, and that's precisely because Wine wants to preserve case, so that
tools that look at the filesystem directly see the right thing. If you
are going to store everything lowercase in the filesystem, then we could
just as well do that inside Wine, without a FUSE module.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Wed Mar 26 12:30:44 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Wed, 26 Mar 2008 18:30:44 +0100
Subject: Trouble in compiling Wine 0.9.57 and 0.9.58 on Solaris 10 08/07
In-Reply-To: <47EA1E24.8010700@hisoft.ru>
References: <47EA1E24.8010700@hisoft.ru>
Message-ID: <200803261830.44932.stefan@codeweavers.com>

Am Mittwoch, 26. M?rz 2008 10:57:56 schrieb ??????? ????? ??????????????:
> After 40 minutes of the compilation the process halted with messages:
> wined3d_private.h: In function `float_32_to_16':
> wined3d_private.h:159: warning: implicit declaration of function `isinf'
> wined3d_main.c: At top level:
> wined3d_main.c:271: warning: visibility attribute not supported in this
> configuration; ignored
> (the last string repeated for many times)
> I suppose the situation is connected with Solaris 'isinf' but I am too
> far from programming under UNIX...
isinf is a function / macro which returns wether or not a float is positive 
infinite or negative infinite. I think it is a standard C function. Maybe 
solaris declares it in some header that needs to be included, like math.h?


From thestig at google.com  Wed Mar 26 13:38:59 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 26 Mar 2008 11:38:59 -0700
Subject: dlls/user32/tests/cursoricon.c - test succeeded inside todo block
Message-ID: <558b2f5c0803261138r2b942d8eo139082ed394644d8@mail.gmail.com>

Anyone else seeing this?

../../../tools/runtest -q -P wine -M user32.dll -T ../../.. -p
user32_test.exe.so cursoricon.c && touch cursoricon.ok
cursoricon.c:656: Test succeeded inside todo block: No hbmColor!
make: *** [cursoricon.ok] Error 1


From truiken at gmail.com  Wed Mar 26 13:42:27 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 26 Mar 2008 13:42:27 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47E8C57C.9030708@gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
Message-ID: <22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>

On Tue, Mar 25, 2008 at 4:27 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>
> James Hawkins wrote:
>  > On Tue, Mar 25, 2008 at 4:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>  >> Hi,
>  >>
>  >>  We didn't have a new winetest executable for the last few days. MinGW doesn't
>  >>  know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.
>  >>
>  >>  Especially while in the process of getting ready for 1.0 we should have winetest
>  >>  run as much as possible.
>  >>
>  >>  My main focus will be adding tests btw until 1.0 is out. These will be both
>  >>  tests to proof the correctness of the current implementation as well as tests to
>  >>  show missing stuff. There are loads of functions for which we have no tests yet
>  >>  and with the 1.0 in sight I think it becomes very important to have tests for
>  >>  virtually every function we (have) implement(ed).
>  >>
>  >
>  > While that's a worthy goal, I think a better short-term goal for the
>  > run up to 1.0 is to fix the current failing tests in Windows.
>  >
>  But either way we need an up-to-date winetest executable ;-)
>

Are you currently working on this?  Is it a problem that needs to be
fixed on the mingw side?

-- 
James Hawkins


From paul.vriens.wine at gmail.com  Wed Mar 26 14:19:28 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 26 Mar 2008 20:19:28 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>	
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>	
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
Message-ID: <47EAA1C0.5050004@gmail.com>

James Hawkins wrote:
> On Tue, Mar 25, 2008 at 4:27 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> James Hawkins wrote:
>>  > On Tue, Mar 25, 2008 at 4:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>>  >> Hi,
>>  >>
>>  >>  We didn't have a new winetest executable for the last few days. MinGW doesn't
>>  >>  know anything about a d3dx9 dll (yet) that's imported in the d3dx9_36 tests.
>>  >>
>>  >>  Especially while in the process of getting ready for 1.0 we should have winetest
>>  >>  run as much as possible.
>>  >>
>>  >>  My main focus will be adding tests btw until 1.0 is out. These will be both
>>  >>  tests to proof the correctness of the current implementation as well as tests to
>>  >>  show missing stuff. There are loads of functions for which we have no tests yet
>>  >>  and with the 1.0 in sight I think it becomes very important to have tests for
>>  >>  virtually every function we (have) implement(ed).
>>  >>
>>  >
>>  > While that's a worthy goal, I think a better short-term goal for the
>>  > run up to 1.0 is to fix the current failing tests in Windows.
>>  >
>>  But either way we need an up-to-date winetest executable ;-)
>>
> 
> Are you currently working on this?  Is it a problem that needs to be
> fixed on the mingw side?
> 
It's indeed a mingw issue and has to be fixed on that side.

I've never touched mingw so I'm relying on either Hans Leidekker, Stefan 
Leichter or Paul Millar to take this up.

Cheers,

Paul (Vriens).




From htl10 at users.sourceforge.net  Wed Mar 26 14:35:56 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 26 Mar 2008 19:35:56 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58 broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <20080326165141.GE31599@merlot.physics.ox.ac.uk>
Message-ID: <137645.21992.qm@web23108.mail.ird.yahoo.com>

--- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
<snipped>
> > If ukai is affected, I would suspect uming (also from
> Arphic)
> > would be the same? and how many non-english fonts one
> want to 
> > "work-around" like this?
> 
> I've not seen any problems with uming.  Most
> 'non-english' fonts will
> work fine.  There's something very specific about ukai
> that causes
> native gdiplis to have problems.
> 
> > > Actually I've just attached a hack to the
> bug, try that
> > > instead.
> > 
> > Thanks - but I also have uming, and a a fair number of
> other fonts
> > shipped from fedora for non-english. (over 100).
> 
> Please try the patch and report back.

Yes, your patch works alright - it is just ukai and nothing else. I'll put it on the bug report as well. Ukai (or rather, the original Arphic kai font) was the first
commercial quality chinese font released under an open license, so you are going to
have a lot of people - 20% of the world is Chinese, and also linux is rather more officially popular in China due to licensing/cost/idealological reasons and some
non-chinese will install "everything" - being affected by this. I don't know if it 
is ukai-specific or any Arphic kai derivatives, but if it affects any Arphic kai derivatives, filtering by font name as your patch did won't be effective. 
 



      __________________________________________________________
Sent from Yahoo! Mail.
More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html


From owen at owenrudge.net  Wed Mar 26 16:27:58 2008
From: owen at owenrudge.net (Owen Rudge)
Date: Wed, 26 Mar 2008 21:27:58 -0000
Subject: GSOC proposal - control panel
Message-ID: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>

Hi everyone,

I'm intending to apply for a Google Summer of Code placement working on the 
Wine control panel support. My main intention is to work on a proper Control 
Panel application for Wine that accepts standard .cpl files, and turn 
winecfg's configuration sections into appropriate control panels. (I notice 
that pure_evil @ mail.bg has been doing some work on this - if I were to get 
accepted to work on this, then I would like to continue his line of work, or 
assist him with it.) However, as I don't believe that project alone would 
necessarily take up an entire summer, my intention would also be to work on 
some new control panel applets for Wine. The examples given on the GSOC wiki 
pages (basic desktop/screen resizing, general network information, and font 
details) would be good applets for me to implement, but I would also be 
interested in working on some other applets, such as an Add/Remove Programs 
applet, or a Multimedia applet. Obviously, there wouldn't necessarily be 
time to implement all of these, so my intention would be to get the main 
control panel and basic Wine control panel applets from winecfg working well 
first, and then look at other applets that could be implemented.

I've developed applications and, indeed, Control Panel applets for Windows 
for many years now (I started programming using the Windows API when I was 
12!), so I feel confident that this is a task I would be able to handle. I 
believe that a good configuration interface for Wine that supports 
third-party control panels is something that would be very useful for 
end-users.

If anyone has any comments or suggestions regarding my proposal, I'd very 
much appreciate any feedback.

Regards,

-- 
Owen Rudge
http://www.owenrudge.net/ 



From winehacker at gmail.com  Wed Mar 26 16:42:53 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Wed, 26 Mar 2008 17:42:53 -0400
Subject: GSOC proposal - control panel
In-Reply-To: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
References: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
Message-ID: <19e31a080803261442w54c5c248sba3c0bd8d2f9e2f0@mail.gmail.com>

Hi Owen,

On Wed, Mar 26, 2008 at 5:27 PM, Owen Rudge <owen at owenrudge.net> wrote:
<snip>

>  interested in working on some other applets, such as an Add/Remove Programs
>  applet, or a Multimedia applet. Obviously, there wouldn't necessarily be
>  time to implement all of these, so my intention would be to get the main
>  control panel and basic Wine control panel applets from winecfg working well
>  first, and then look at other applets that could be implemented.
>
>  I've developed applications and, indeed, Control Panel applets for Windows
>  for many years now (I started programming using the Windows API when I was
>  12!), so I feel confident that this is a task I would be able to handle. I
>  believe that a good configuration interface for Wine that supports
>  third-party control panels is something that would be very useful for
>  end-users.
>
>  If anyone has any comments or suggestions regarding my proposal, I'd very
>  much appreciate any feedback.

I don't really know if we want to just focus on applets or if we
should not aim for having this project provide better integration with
the native desktop. As far as I understand there is some
infrastructure work that will need to be done in shell32 as I don't
think we fully implement the entire Control Panel shellname space. I
expect implementing this properly will take a good bit of time. What
would be cool would be if we fully supported the namespace so that
when you called control.exe it loaded the control panel window and
that could be embedded in a GTK or QT window for use by native
applications. There was a patch floating around on wine-patches a few
months back to allow for embedding a Win32 Wine window inside of an
existing X window that should do the trick.

As far as migration of the stuff in winecfg and other programs go, I
think starting with the Add/Remove applet is a good. I don't think it
would be too hard to take all of the current logic in
wine/programs/uninstall and wrap it in a proper applet. We want to
make sure that we don't introduce any sort of regression when we make
the switch over so reusing that code would be a good place to start.

So to recap, (this just goes for for me) I think the project should be
laid out as follows

1. A fully working Control Panel Namespace
2. The ability to embed the Control Panel window in a native window
3. Have a collection of applets to configure wine

I don't know who is mentoring this project so I think we should get
their thoughts on it.

Thanks
-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From mstefani at redhat.com  Wed Mar 26 16:47:49 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Wed, 26 Mar 2008 22:47:49 +0100
Subject: gdi32: PlgBlt implementation
In-Reply-To: <47EAC0E6.9070300@gmail.com>
References: <47EAC0E6.9070300@gmail.com>
Message-ID: <47EAC485.5000309@redhat.com>

Hello Nikolay,

thanks for the patch.

Nikolay Sivov wrote:
> Changelog:
>      gdi32: initial implementation using  coord transformation and MaskBlt
>      patch is made in Windows using TortoiseCVS functionality (all that 
> I can use at this moment, shouldn't be a problem I hope)
No that's not a problem as long as you do the cvs diff from the top
level wine directory.

Please do not use C++ style comments but the traditional /* */.

bye
	michael

> 
> Index: bitblt.c
> ===================================================================
> RCS file: /home/wine/wine/dlls/gdi32/bitblt.c,v
> retrieving revision 1.4
> diff -u -r1.4 bitblt.c
> --- bitblt.c    18 Sep 2007 10:32:56 -0000    1.4
> +++ bitblt.c    26 Mar 2008 21:19:31 -0000
> @@ -26,6 +26,9 @@
>  #include "gdi_private.h"
>  #include "wine/debug.h"
>  
> +#include <math.h>
> +#include <float.h>
> +
>  WINE_DEFAULT_DEBUG_CHANNEL(bitblt);
>  
>  
> @@ -522,9 +525,72 @@
>   *
>   */
>  BOOL WINAPI PlgBlt( HDC hdcDest, const POINT *lpPoint,
> -                        HDC hdcSrc, INT nXDest, INT nYDest, INT nWidth,
> +                        HDC hdcSrc, INT nXSrc, INT nYSrc, INT nWidth,
>                          INT nHeight, HBITMAP hbmMask, INT xMask, INT yMask)
>  {
> -    FIXME("PlgBlt, stub\n");
> -        return 1;
> +    //save actual mode, set GM_ADVANCED
> +    int oldgMode = SetGraphicsMode(hdcDest,GM_ADVANCED);
> +    if (oldgMode == 0)
> +        return FALSE;
> +
> +    //parallelogram coords
> +    POINT plg[3];
> +    memcpy(plg,lpPoint,sizeof(POINT)*3);
> +    //rect coords
> +    POINT rect[3];
> +    rect[0].x = nXSrc;
> +    rect[0].y = nYSrc;
> +    rect[1].x = nXSrc + nWidth;
> +    rect[1].y = nYSrc;
> +    rect[2].x = nXSrc;
> +    rect[2].y = nYSrc + nHeight;
> +    //calc XFORM matrix to transform hdcDest -> hdcSrc (parallelogram 
> to rectangle)
> +    XFORM xf;
> +    //determinant
> +    FLOAT det = (FLOAT)(rect[1].x*(rect[2].y - rect[0].y) - 
> rect[2].x*(rect[1].y - rect[0].y) - rect[0].x*(rect[2].y - rect[1].y));
> +
> +    if (fabs(det) < FLT_EPSILON)
> +    {
> +        SetGraphicsMode(hdcDest,oldgMode);
> +        return FALSE;
> +    }
> +  
> +    TRACE("hdcSrc=%p %d,%d,%dx%d -> hdcDest=%p %d,%d,%d,%d,%d,%d\n",
> +        hdcSrc, nXSrc, nYSrc, nWidth, nHeight, hdcDest, plg[0].x, 
> plg[0].y, plg[1].x, plg[1].y, plg[2].x, plg[2].y);
> +
> +    //X components
> +    xf.eM11 = (plg[1].x*(rect[2].y - rect[0].y) - plg[2].x*(rect[1].y - 
> rect[0].y) - plg[0].x*(rect[2].y - rect[1].y)) / det;
> +    xf.eM21 = (rect[1].x*(plg[2].x - plg[0].x) - rect[2].x*(plg[1].x - 
> plg[0].x) - rect[0].x*(plg[2].x - plg[1].x)) / det;
> +    xf.eDx  = (rect[0].x*(rect[1].y*plg[2].x - rect[2].y*plg[1].x) -
> +               rect[1].x*(rect[0].y*plg[2].x - rect[2].y*plg[0].x) +
> +               rect[2].x*(rect[0].y*plg[1].x - rect[1].y*plg[0].x)
> +               ) / det;
> +
> +    //Y components
> +    xf.eM12 = (plg[1].y*(rect[2].y - rect[0].y) - plg[2].y*(rect[1].y - 
> rect[0].y) - plg[0].y*(rect[2].y - rect[1].y)) / det;
> +    xf.eM22 = (plg[1].x*(rect[2].y - rect[0].y) - plg[2].x*(rect[1].y - 
> rect[0].y) - plg[0].x*(rect[2].y - rect[1].y)) / det;
> +    xf.eDy  = (rect[0].x*(rect[1].y*plg[2].y - rect[2].y*plg[1].y) -
> +               rect[1].x*(rect[0].y*plg[2].y - rect[2].y*plg[0].y) +
> +               rect[2].x*(rect[0].y*plg[1].y - rect[1].y*plg[0].y)
> +               ) / det;
> +
> +    XFORM SrcXf;
> +    GetWorldTransform(hdcSrc,&SrcXf);
> +    CombineTransform(&xf,&xf,&SrcXf);
> +   
> +    //save actual dest transform
> +    XFORM oldDestXf;
> +    GetWorldTransform(hdcDest,&oldDestXf);
> +    //
> +    SetWorldTransform(hdcDest,&xf);
> +    //now destination and source DCs use same coords
> +    MaskBlt(hdcDest,nXSrc,nYSrc,nWidth,nHeight,
> +            hdcSrc, nXSrc,nYSrc,
> +            hbmMask,xMask,yMask,
> +            SRCCOPY);
> +    //restore dest DC
> +    SetWorldTransform(hdcDest,&oldDestXf);
> +    SetGraphicsMode(hdcDest,oldgMode);
> +
> +    return TRUE;
>  }
> 
> 
> 



From owen at owenrudge.net  Wed Mar 26 16:57:06 2008
From: owen at owenrudge.net (Owen Rudge)
Date: Wed, 26 Mar 2008 21:57:06 -0000
Subject: GSOC proposal - control panel
References: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
	<19e31a080803261442w54c5c248sba3c0bd8d2f9e2f0@mail.gmail.com>
Message-ID: <016201c88f8c$56988a50$842a204e@lan.owenrudge.net>

Hi Steven,

> I don't really know if we want to just focus on applets or if we
> should not aim for having this project provide better integration with
> the native desktop. As far as I understand there is some
> infrastructure work that will need to be done in shell32 as I don't
> think we fully implement the entire Control Panel shellname space. I
> expect implementing this properly will take a good bit of time. What
> would be cool would be if we fully supported the namespace so that
> when you called control.exe it loaded the control panel window and
> that could be embedded in a GTK or QT window for use by native
> applications. There was a patch floating around on wine-patches a few
> months back to allow for embedding a Win32 Wine window inside of an
> existing X window that should do the trick.

Implementing the proper Control Panel namespace would certainly make the 
control panel section of the project a much longer one. My initial thoughts 
were that it may be an easier task to implement the Control Panel in a more 
old-fashioned style of simply having a list view into which the control 
panel icons were placed - this would certainly provide a sufficient 
interface for accessing the control panel. However, it probably would be 
better in the long run to implement things "properly", and at the very least 
getting Control Panel integrated with the shell namespace. Integration with 
native applications certainly looks as though it would provide an added 
challenge to that project, but is an interesting idea that could work quite 
nicely.

> As far as migration of the stuff in winecfg and other programs go, I
> think starting with the Add/Remove applet is a good. I don't think it
> would be too hard to take all of the current logic in
> wine/programs/uninstall and wrap it in a proper applet. We want to
> make sure that we don't introduce any sort of regression when we make
> the switch over so reusing that code would be a good place to start.

Indeed, my plan was to make use of appropriate Wine tools where they 
existed, such as in the case of the uninstaller, and flesh them out into 
fully-featured control panel applets.

> So to recap, (this just goes for for me) I think the project should be
> laid out as follows
>
> 1. A fully working Control Panel Namespace
> 2. The ability to embed the Control Panel window in a native window
> 3. Have a collection of applets to configure wine

This sounds like a pretty decent way of going about things. Number 2 was 
something I hadn't particularly considered doing initially, but I'll have a 
look for the patch that was posted recently and see what I think about it 
and how much work is likely to be involved.

Cheers,

-- 
Owen Rudge
http://www.owenrudge.net/



From mat at brain-dump.org  Wed Mar 26 17:17:28 2008
From: mat at brain-dump.org (Marc Andre Tanner)
Date: Wed, 26 Mar 2008 23:17:28 +0100
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <87iqz9s96v.fsf@wine.dyndns.org>
References: <20080325213351.GA3237@debbook.brain-dump.org>
	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
	<20080326165909.GA3213@debbook.brain-dump.org>
	<87iqz9s96v.fsf@wine.dyndns.org>
Message-ID: <20080326221728.GA1896@debbook.brain-dump.org>

On Wed, Mar 26, 2008 at 06:10:16PM +0100, Alexandre Julliard wrote:
> Marc Andre Tanner <mat at brain-dump.org> writes:
> 
> > Yes that's true the case information is lost but is it really needed? 
> > If you create the files with the original mixed case you will have to
> > scan the whole directory in order to match it to a given filename. 
> > And if i am not mistaken this is exactly what wine does. 
> 
> Yes, and that's precisely because Wine wants to preserve case, so that
> tools that look at the filesystem directly see the right thing. If you
> are going to store everything lowercase in the filesystem, then we could
> just as well do that inside Wine, without a FUSE module.

I am not quite sure whether i understand what you mean. Let's say we
mount the case insensitive filesystem at ~/.wine/drive_c this will
then preserve the case of the filenames the actual data which is all
lowercase is in ~/.wine/.drive_c. So as long as the applications are
looking for the files in ~/.wine/drive_c everything is fine. Now when
you unmount the filesystem or simply look into ~/.wine/.drive_c the 
case information is 'lost' (it's still there in the extended attributes 
but no one cares about it).

If this is all wrong, then what is the FUSE module supposed to do?

Thanks,
Marc

-- 
 Marc Andre Tanner >< http://www.brain-dump.org/ >< GPG key: CF7D56C0


From winehacker at gmail.com  Wed Mar 26 17:37:18 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Wed, 26 Mar 2008 18:37:18 -0400
Subject: GSOC proposal - control panel
In-Reply-To: <016201c88f8c$56988a50$842a204e@lan.owenrudge.net>
References: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
	<19e31a080803261442w54c5c248sba3c0bd8d2f9e2f0@mail.gmail.com>
	<016201c88f8c$56988a50$842a204e@lan.owenrudge.net>
Message-ID: <19e31a080803261537v27ab1f9cr41aaacd5d22c70fb@mail.gmail.com>

On Wed, Mar 26, 2008 at 5:57 PM, Owen Rudge <owen at owenrudge.net> wrote:
>  This sounds like a pretty decent way of going about things. Number 2 was
>  something I hadn't particularly considered doing initially, but I'll have a
>  look for the patch that was posted recently and see what I think about it
>  and how much work is likely to be involved.

I think the existing wine/programs/control should display the
enumerated applets but I've never really played with it. In ReactOS we
wrote a version of control.exe more enhanced version that did as you
suggested, creating a listview with item description and name and I
think it was rejected before because Alexandre preferred implementing
the namespace properly.

As for embedding the pseudo-control panel window in the X11 window,
here is the patch in question

http://www.winehq.org/pipermail/wine-patches/2008-February/050117.html

I don't know how Alexandre feels about this either as he did not merge
it in to Winehq. Perhaps he wants to do it some other way...

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From juan.lang at gmail.com  Wed Mar 26 17:42:12 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Wed, 26 Mar 2008 15:42:12 -0700
Subject: gdi32: PlgBlt implementation
In-Reply-To: <47EAC485.5000309@redhat.com>
References: <47EAC0E6.9070300@gmail.com> <47EAC485.5000309@redhat.com>
Message-ID: <3a768c550803261542t10ed5a47w128f8e37eddc569a@mail.gmail.com>

One more comment on your patch:

>  BOOL WINAPI PlgBlt( HDC hdcDest, const POINT *lpPoint,
> -                        HDC hdcSrc, INT nXDest, INT nYDest, INT nWidth,
> +                        HDC hdcSrc, INT nXSrc, INT nYSrc, INT nWidth,
>                          INT nHeight, HBITMAP hbmMask, INT xMask, INT yMask)
>  {
> -    FIXME("PlgBlt, stub\n");
> -        return 1;
> +    //save actual mode, set GM_ADVANCED
> +    int oldgMode = SetGraphicsMode(hdcDest,GM_ADVANCED);
> +    if (oldgMode == 0)
> +        return FALSE;
> +
> +    //parallelogram coords
> +    POINT plg[3];

Variables must be declared at the beginning of the function.  We
require strict ANSI C.
--Juan


From scott at open-vote.org  Wed Mar 26 18:17:57 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Wed, 26 Mar 2008 16:17:57 -0700
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <87iqz9s96v.fsf@wine.dyndns.org>
References: <20080325213351.GA3237@debbook.brain-dump.org>	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>	<20080326165909.GA3213@debbook.brain-dump.org>
	<87iqz9s96v.fsf@wine.dyndns.org>
Message-ID: <47EAD9A5.3050600@open-vote.org>

Alexandre Julliard wrote:
> Marc Andre Tanner <mat at brain-dump.org> writes:
> 
>> Yes that's true the case information is lost but is it really needed? 
>> If you create the files with the original mixed case you will have to
>> scan the whole directory in order to match it to a given filename. 
>> And if i am not mistaken this is exactly what wine does. 
> 
> Yes, and that's precisely because Wine wants to preserve case, so that
> tools that look at the filesystem directly see the right thing. If you
> are going to store everything lowercase in the filesystem, then we could
> just as well do that inside Wine, without a FUSE module.
> 

It seems like we have a few goals:

* Prevent having to read the whole directory when looking for a
case-insensitive file
* Allow non-Wine programs to work with the cased filenames
* Prevent the creation of conflicting files

The last one is important, as we need to have a 1:1 correspondence
between cased and uncased files in the .wine folder to prevent breakages
when someone, say, installs a patch with different casing from a zip file.

I don't see any reason why it would be bad to have the FUSE module
mounted at login rather than when Wine starts.  This would make your
Wine folder no different to other apps than, say, a vfat disk mounted
there.  I should be able to extract a zip with file-roller containing
"foo.txt" and have it overwrite "Foo.txt" even if Wine isn't running.

Thanks,
Scott Ritchie


From mpartap at gmx.net  Wed Mar 26 18:23:40 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Thu, 27 Mar 2008 00:23:40 +0100
Subject: Fw: Re: Google Summer of Code 2008 - joined openprinting+wine
	project?
In-Reply-To: <94951.56539.qm@web23105.mail.ird.yahoo.com>
References: <94951.56539.qm@web23105.mail.ird.yahoo.com>
Message-ID: <47EADAFC.8000206@gmx.net>

Hi Hin-Tak,
to sum it up, I was the one working on that project and I hit some ehh.. problems ;)
Anyways, my final result was that I got something out of the printer drivers I tried with, but 
useful results depended on something that is referred to as the ominous 'DIB engine'. Coincidently, 
there was another SoC project done by Jesse Allen which started implementing that. That code ended 
up at http://repo.or.cz/w/wine/dibdrv.git, and just as mine, general+AJ's consensus was to start 
merging it post-1.0. Now I didn't have time to look again at it up to now (uni!) but I still want to 
finish this, just not as part of a SoC project. Also I wouldn't recommend that to anyone, except he 
REEEAAALLY does grok all those mysterious inner-GDI concepts (DIB DDB DDI...) that this project 
touches. I myself have not fully reached insight of how best to merge the current winex11drv, 
wined3d and Jesse's dib engine, but I'll have a thorough look at it in the next few days. Another 
unsolved issue is whether to teach wine's internal GDI functions to speak DDI or rather to build a 
wineddi.drv bridge thing. I tried both approaches but there was no clear decision whether to use one 
or the other, with Alexandre's stance being 'once something actually works we can talk about that'.
Also my code to make printer drivers work depends on some stuff within the localspooler code, I have 
to investigate how far Detlef got it to work regarding installation of drivers.
Oh yeah and that printer proxy was only a DLL to see how native windows communicates with the 
drivers without getting into disassembling stuff.. the results scared me, astonishing levels of 
redundancy.. Anyways, even though all the bits and pieces of how to make native drivers actually 
work with wine are lying around, this is neither a fun nor a beginner's task (I know that now *g). 
That said, I'm going to look into it and hope to come up with something in the next few days.
regards marcel.


Hin-Tak Leung wrote:
> Hi, anybody on wine-devel want to take this on and make this more concrete?
> 
> --- On Wed, 26/3/08, Till Kamppeter <till.kamppeter at gmail.com> wrote:
> 
>> From: Till Kamppeter <till.kamppeter at gmail.com>
>> Subject: Re: Google Summer of Code 2008 - Some general instructions for reviewing the student's applications
>> To: "Hin-Tak Leung" <hintak_leung at yahoo.co.uk>
>> Cc: "Casey Schaufler" <casey at schaufler-ca.com>, "'Glen Petrie'" <glen.petrie at eitc.epson.com>, "Rik van Riel" <riel at redhat.com>, "Jeff Licquia" <licquia at debian.org>, "Jon Masters" <jonmasters at gmail.com>, "Jonathan Riddell" <jriddell at ubuntu.com>, "Josef Spillner" <spillner at kde.org>, Matt_Domsch at dell.com, "Pekka Enberg" <penberg at cs.helsinki.fi>
>> Date: Wednesday, 26 March, 2008, 4:34 PM
>> Hin-Tak Leung wrote:
>>> Hi Till and the rest of the gang.
>>>
>>> Two people had got in touch with with about the
>> IJS+PDF workflow, and I replied. 
>>> (sorry I don't check the "other" e-mail
>> often - I probably should set up re-direction).
>> Great!
>>
>>> I thought I should also mentioned that it has just
>> came to my attention in some unrelated discussion on
>> wine-devel - been doing some non-printing wine-related
>> stuff lately - that there *was* a google summer of code
>> 2007 project for a
>>> wine-based native printer driver proxy - this is the
>> sort of thing I have had in mind
>>> for a while and I thought it would be interesting to
>> do but I don't have in-depth
>>> windows knowledge to make it happen, but the wine
>> people already did!
>>> http://google-summer-of-code-2007-wine.googlecode.com/
>>>
>>> I just downloaded the gsoc 2007 printerproxy code. It
>> seems that it is just for use
>>> from within wine, but it just might be interesting to
>> make it more general - via opvp
>>> or IJS. We should follow up on this.
>> If this project still requires coding, it is not too late
>> to add it as 
>> project idea to the ideas pages of both the Linux
>> Foundation and WINE 
>> (having it presented at two mentoring organizations raises
>> the chances 
>> to find a student).
>>
>> Our ideas page is a Wiki and you can simply edit it:
>>
>> https://www.linux-foundation.org/en/Google_Summer_of_Code
>>
>>     Till
> 
> 
>       __________________________________________________________
> Sent from Yahoo! Mail.
> More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html
> 


-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>


From cesar at ecuarock.net  Wed Mar 26 18:39:22 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Wed, 26 Mar 2008 18:39:22 -0500
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <47EAD9A5.3050600@open-vote.org>
References: <20080325213351.GA3237@debbook.brain-dump.org>
	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
	<20080326165909.GA3213@debbook.brain-dump.org>
	<87iqz9s96v.fsf@wine.dyndns.org> <47EAD9A5.3050600@open-vote.org>
Message-ID: <e3d3ae8f0803261639t5a275fc6pc03bd0cdff071386@mail.gmail.com>

On Wed, Mar 26, 2008 at 6:17 PM, Scott Ritchie <scott at open-vote.org> wrote:
>
> Alexandre Julliard wrote:
>  > Marc Andre Tanner <mat at brain-dump.org> writes:
>  >
>  >> Yes that's true the case information is lost but is it really needed?
>  >> If you create the files with the original mixed case you will have to
>  >> scan the whole directory in order to match it to a given filename.
>  >> And if i am not mistaken this is exactly what wine does.
>  >
>  > Yes, and that's precisely because Wine wants to preserve case, so that
>  > tools that look at the filesystem directly see the right thing. If you
>  > are going to store everything lowercase in the filesystem, then we could
>  > just as well do that inside Wine, without a FUSE module.
>  >
>
>  It seems like we have a few goals:
>
>  * Prevent having to read the whole directory when looking for a
>  case-insensitive file
>  * Allow non-Wine programs to work with the cased filenames
>  * Prevent the creation of conflicting files

We could do this for the drive_c directory but what about /? you
cannot enforce that there. Maybe this part project should be divided
into two different problems. 1. How to achieve that for drive_c, and
2. how to mount a proxy filesystem for / and apply some rules when
conflicting files exist, as keep the newest conflicting file with the
original name and rename other files like it was proposed on another
thread on this list.

>
>  The last one is important, as we need to have a 1:1 correspondence
>  between cased and uncased files in the .wine folder to prevent breakages
>  when someone, say, installs a patch with different casing from a zip file.
>
>  I don't see any reason why it would be bad to have the FUSE module
>  mounted at login rather than when Wine starts.  This would make your
>  Wine folder no different to other apps than, say, a vfat disk mounted
>  there.  I should be able to extract a zip with file-roller containing
>  "foo.txt" and have it overwrite "Foo.txt" even if Wine isn't running.
>
>  Thanks,
>  Scott Ritchie
>
>
>


From fgouget at free.fr  Wed Mar 26 18:36:55 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 27 Mar 2008 00:36:55 +0100 (CET)
Subject: Tests marked as todo are not displayed on the web results.
In-Reply-To: <3f4fd2640803190135icaac467q79f7bc3ee50e4c9f@mail.gmail.com>
References: <3f4fd2640803190135icaac467q79f7bc3ee50e4c9f@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0803270034530.759@amboise.dolphin>

On Wed, 19 Mar 2008, Reece Dunn wrote:
[...]
> For example, using the above, it results in:
> 
> gdiplus:graphicspath start dlls/gdiplus/tests/graphicspath.c 1.13
> graphicspath: 198 tests executed (5 marked as todo, 0 failures), 0 skipped.
> gdiplus:graphicspath done (0)
> 
> ...so does not tell me which of the 5 tests are todo and which are ok.
> 
> I haven't checked to see if this is also an issue with the `make test` output.

Yep, that's because make test does not print the todo tests.
Maybe they should be printed but with 'Test failed' replaced with 'Todo 
test' or something like that. Maybe it should depend on WINETEST_DEBUG.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
           If it stinks, it's chemistry. If it moves, it's biology.
                  If it does not work, It's computer science.


From fgouget at free.fr  Wed Mar 26 18:43:10 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 27 Mar 2008 00:43:10 +0100 (CET)
Subject: [RFC] Improving the summary results on test.winehq.org
In-Reply-To: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>
References: <3f4fd2640803190147gb1d7437k5e7115e2cf242973@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0803270038150.759@amboise.dolphin>

On Wed, 19 Mar 2008, Reece Dunn wrote:

> Hi,
> 
> Looking at the results from a test run (e.g.
> http://test.winehq.org/data/200803181000/), it would be nice to have:
> 
>     1.  A summary of a dlls overall results (i.e. the summation of all
> its unit test results), preferably before the individual tests, but
> could live with them at the bottom.

I'm not sure this one is worth it. It would add quite a lot of lines 
too.


>     2.  A summary of the entire test results (i.e. the summation of
> all unit test results for all dlls). This would be best at the top
> where it is easily visible.

I've sent a patch doing just that, with the percentage of unit tests 
that have errors too.


>     3.  Possibly display the number of tests run in a given pass (e.g.
> 0/12 or 1+3/27). This is to give an idea of how many tests have been
> run easily (especially for the dll and overall summaries).

As mentioned before you get the number of individual checks that where 
run in the per-test tooltip. The 'statistics' patch also provides the 
total number of unit tests in a tooltip.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                            1 + e ^ ( i * pi ) = 0


From msclrhd at googlemail.com  Wed Mar 26 14:07:19 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 26 Mar 2008 19:07:19 +0000
Subject: dlls/user32/tests/cursoricon.c - test succeeded inside todo block
In-Reply-To: <558b2f5c0803261138r2b942d8eo139082ed394644d8@mail.gmail.com>
References: <558b2f5c0803261138r2b942d8eo139082ed394644d8@mail.gmail.com>
Message-ID: <3f4fd2640803261207q4daa953en5a7aaab2c91c8e69@mail.gmail.com>

On 26/03/2008, Lei Zhang <thestig at google.com> wrote:
> Anyone else seeing this?
>
>  ../../../tools/runtest -q -P wine -M user32.dll -T ../../.. -p
>  user32_test.exe.so cursoricon.c && touch cursoricon.ok
>  cursoricon.c:656: Test succeeded inside todo block: No hbmColor!
>  make: *** [cursoricon.ok] Error 1

http://test.winehq.org/data/200803211000/#group_Wine:user32:cursoricon

user32:cursoricon start dlls/user32/tests/cursoricon.c 1.11
cursoricon.c:655: Test succeeded inside todo block: yHotspot is 1.
cursoricon: 5 tests executed (2 marked as todo, 0 failures), 0 skipped.
cursoricon: 357 tests executed (10 marked as todo, 1 failure), 0 skipped.
user32:cursoricon done (1)

or

user32:cursoricon start dlls/user32/tests/cursoricon.c 1.11
cursoricon.c:655: Test succeeded inside todo block: yHotspot is 1.
cursoricon.c:656: Test succeeded inside todo block: No hbmColor!
cursoricon: 5 tests executed (2 marked as todo, 0 failures), 0 skipped.
cursoricon: 357 tests executed (9 marked as todo, 2 failures), 0 skipped.
user32:cursoricon done (2)

so yes.

- Reece


From austinenglish at gmail.com  Wed Mar 26 20:25:09 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 26 Mar 2008 20:25:09 -0500
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <e3d3ae8f0803261639t5a275fc6pc03bd0cdff071386@mail.gmail.com>
References: <20080325213351.GA3237@debbook.brain-dump.org>
	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
	<20080326165909.GA3213@debbook.brain-dump.org>
	<87iqz9s96v.fsf@wine.dyndns.org> <47EAD9A5.3050600@open-vote.org>
	<e3d3ae8f0803261639t5a275fc6pc03bd0cdff071386@mail.gmail.com>
Message-ID: <b6bb06270803261825p3870e195t9e8d6a4d4c8a6c47@mail.gmail.com>

On Wed, Mar 26, 2008 at 6:39 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
>  > Alexandre Julliard wrote:
>  >  > Yes, and that's precisely because Wine wants to preserve case, so that
>  >  > tools that look at the filesystem directly see the right thing. If you
>  >  > are going to store everything lowercase in the filesystem, then we could
>  >  > just as well do that inside Wine, without a FUSE module.
>
>  We could do this for the drive_c directory but what about /? you
>  cannot enforce that there. Maybe this part project should be divided
>  into two different problems. 1. How to achieve that for drive_c, and
>  2. how to mount a proxy filesystem for / and apply some rules when
>  conflicting files exist, as keep the newest conflicting file with the
>  original name and rename other files like it was proposed on another
>  thread on this list.

We could do this in wine itself for drive_c, which is where most of
the problem seems to lie (assuming no one links their program files to
a different mount point). Most performance issues/problem are with
patches or with installers searching for lots of files (within
drive_c). While it would be ideal to do this for the entire FS, doing
it  for drive_c should resolve most issues.


From scott at open-vote.org  Wed Mar 26 21:03:13 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Wed, 26 Mar 2008 19:03:13 -0700
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <b6bb06270803261825p3870e195t9e8d6a4d4c8a6c47@mail.gmail.com>
References: <20080325213351.GA3237@debbook.brain-dump.org>	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>	<20080326165909.GA3213@debbook.brain-dump.org>	<87iqz9s96v.fsf@wine.dyndns.org>
	<47EAD9A5.3050600@open-vote.org>	<e3d3ae8f0803261639t5a275fc6pc03bd0cdff071386@mail.gmail.com>
	<b6bb06270803261825p3870e195t9e8d6a4d4c8a6c47@mail.gmail.com>
Message-ID: <47EB0061.8070803@open-vote.org>

Austin English wrote:
> On Wed, Mar 26, 2008 at 6:39 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
>>  > Alexandre Julliard wrote:
>>  >  > Yes, and that's precisely because Wine wants to preserve case, so that
>>  >  > tools that look at the filesystem directly see the right thing. If you
>>  >  > are going to store everything lowercase in the filesystem, then we could
>>  >  > just as well do that inside Wine, without a FUSE module.
>>
>>  We could do this for the drive_c directory but what about /? you
>>  cannot enforce that there. Maybe this part project should be divided
>>  into two different problems. 1. How to achieve that for drive_c, and
>>  2. how to mount a proxy filesystem for / and apply some rules when
>>  conflicting files exist, as keep the newest conflicting file with the
>>  original name and rename other files like it was proposed on another
>>  thread on this list.
> 
> We could do this in wine itself for drive_c, which is where most of
> the problem seems to lie (assuming no one links their program files to
> a different mount point). Most performance issues/problem are with
> patches or with installers searching for lots of files (within
> drive_c). While it would be ideal to do this for the entire FS, doing
> it  for drive_c should resolve most issues.
> 

You're very right that doing this for just drive_c solves most issues
(as we can always fall back on Wine's existing behavior if we're outside
of C), however unless we have some Wine process always running there's
no way we can guarantee preserving the case integrity of drive_c just
inside Wine.

Thanks,
Scott Ritchie


From wine-devel at kievinfo.com  Wed Mar 26 21:22:25 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 26 Mar 2008 20:22:25 -0600
Subject: gdi32-related commit between 0.9.57<->0.9.58
	broken	.NET2/Systems.Windows.Forms
In-Reply-To: <137645.21992.qm@web23108.mail.ird.yahoo.com>
References: <137645.21992.qm@web23108.mail.ird.yahoo.com>
Message-ID: <47EB04E1.7020206@kievinfo.com>

Hin-Tak Leung wrote:
> --- On Wed, 26/3/08, Huw Davies <huw at codeweavers.com> wrote:
> <snipped>
>>> If ukai is affected, I would suspect uming (also from
>> Arphic)
>>> would be the same? and how many non-english fonts one
>> want to 
>>> "work-around" like this?
>> I've not seen any problems with uming.  Most
>> 'non-english' fonts will
>> work fine.  There's something very specific about ukai
>> that causes
>> native gdiplis to have problems.
>>
>>>> Actually I've just attached a hack to the
>> bug, try that
>>>> instead.
>>> Thanks - but I also have uming, and a a fair number of
>> other fonts
>>> shipped from fedora for non-english. (over 100).
>> Please try the patch and report back.
> 
> Yes, your patch works alright - it is just ukai and nothing else. I'll put it on the bug report as well. Ukai (or rather, the original Arphic kai font) was the first
> commercial quality chinese font released under an open license, so you are going to
> have a lot of people - 20% of the world is Chinese, and also linux is rather more officially popular in China due to licensing/cost/idealological reasons and some
> non-chinese will install "everything" - being affected by this. I don't know if it 
> is ukai-specific or any Arphic kai derivatives, but if it affects any Arphic kai derivatives, filtering by font name as your patch did won't be effective. 
>  
Looks like a time to start blacklisting fonts then. If the font is invalid 
and does not work even on windows yet it is available in the system - that's 
the only thing Wine can do. Or just contact all distros to remove it. Or 
request packagers to refuse installing Wine if said font found in the system.

Vitaliy.


From wine-devel at kievinfo.com  Wed Mar 26 21:26:18 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 26 Mar 2008 20:26:18 -0600
Subject: [PATCH 1/2] user32: Properly translate keyboard left/right-shift, 
	alt, ctrl keys hardware messages.
In-Reply-To: <47E199CB.508@kievinfo.com>
References: <47E199CB.508@kievinfo.com>
Message-ID: <47EB05CA.6050200@kievinfo.com>

Vitaliy Margolen wrote:
> ---
>  dlls/user32/message.c |   15 +++++++++++++++
>  1 files changed, 15 insertions(+), 0 deletions(-)
> 
> 
> [PATCH 2/2] winex11drv: Distinguish left and right keys for shift, ctrl and alt. (try 5)

Alexandre, what was wrong with these patches? I moved the remapping of 
messages as you suggested.

Vitaliy.


From dank at kegel.com  Wed Mar 26 22:37:12 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 26 Mar 2008 20:37:12 -0700
Subject: Wine 1.0 status: T minus 72 days. 74 open bugs.
Message-ID: <a71bd89a0803262037o5b6e2477r9ce71e492f34d5c7@mail.gmail.com>

44 days to code freeze.

Four bugs fixed in the last two days:

9104   comdlg32      2       Pdf-xchange viewer crashes
10040  crypt32         2       Steam crashes during the startup
10111  comctl32      2       WINEDEBUG=warn+heap "make test" has heap
error in comdlg32/tests/printdlg.c
11884  winex11.       1       Copy and paste garbage on end

History:
3/22: 87 bugs, 76 days to go
3/23: 82 bugs, 75 days to go
3/24: 78 bugs, 74 days to go
3/26: 74 bugs, 72 days to go

Here's a list of the currently open 1.0 bugs, sorted by component, with votes:
5948	-unknown  	1  	Star Trek: Armada does not install
4971 	-unknown 	3 	Corel Draw 12 demo install fails
5024 	-unknown 	4 	Thief: Deadly Shadows crashes:page fault on read
access to 0x0000040c
5055 	-unknown 	5 	Deleting files from a window in wine doesn't send
them to the Trash
5061 	-unknown 	6 	Copying from Windows Firefox in Wine and pasting to
Linux OpenOffice pastes metadata as data
5402 	-unknown 	0 	Trying to run PhotoStitch 3.1
5844 	-unknown 	10 	tray minimize
7404 	-unknown 	2 	ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
7477 	-unknown 	1 	Uplink demo crashes
8125 	-unknown 	0 	Marratech 6.1 crashes on start
9178 	-unknown 	7 	"hello world" dos program hangs
9459 	-unknown 	8 	FIFA 2007 crashes with the recent versions
9916 	-unknown 	6 	"make test" usually fails
9959 	-unknown 	8 	Make wine updates work even if the registry changed
10147 	-unknown 	1 	Word Viewer 2003 - Tab behavior differs from Windows
10815 	-unknown 	2 	Cannot drag images into Adobe Photoshop 7 from the
web / desktop
11281 	-unknown 	2 	CJK input many issues
12097 	-unknown 	2 	Wine 1.0 should not ship out-of-sync resource translations
556 	build-en 	2 	Reconcile the Windows and Wine spec files
1114 	comctl32 	2 	Winrar2.90/3.00: Comboex doesn't trigger a event
when you mouse-click in some value of it
2493 	comctl32 	2 	Multi-select listview: Shift-arrow up only selects
top two items
5955 	directx- 	7 	DirectDrawCreate crash on non-OpenGL desktop
9030 	directx- 	0 	army men hangs on black screen
11681 	directx- 	14 	Add support for video overlay
82 	document 	2 	Stabilize Winelib User Guide Table of Contents
638 	document 	8 	Document Wine debugging channels
12217 	document 	0 	Documentation should be in XML and not SGML format
3270 	gdi32 	14 	Problem with minimized top-level windows
6519 	gdi32 	7 	Wine blacks out rotated font bitmap
7571 	gdi32 	1 	Accented character glyphs are mixed up with TrueType
fonts (affects e.g. Lotus Notes R5)
9771 	gdi32 	38 	Steam Friends doesn't work (fails to render correctly
or refresh)
9926 	gdi32 	5 	gdi32.dll should not have exported function pointers
4733 	kernel32 	5 	Get optimized/compressed/packed executables (non-upx) working
5351 	kernel32 	9 	Windows Installer 3.1 cannot install because of
non-standard drive labeling
5541 	kernel32 	0 	WriteConsole can't write to stdout; affects e.g.
wsh's cscript's usage message
9039 	kernel32 	0 	GS-Auftrag Professional SQL aborts on startup
9484 	kernel32 	17 	Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
7098 	mscoree 	1 	RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
5163 	msi 	12 	Office XP 2002 crashes on installation
8783 	ntdll 	11 	USB serial ports do not work
9356 	ntdll 	6 	Serial communication not working since wine-0.9.33
2539 	ole 	3 	XDND (Drag and drop for X Windows) doesn't copy text
4770 	ole 	3 	BlackBerry Device Manager fails to install under wine
6607 	ole 	8 	Drag and Drop not working
8095 	ole 	0 	PQ Teaching toy crashes
9942 	ole 	2 	Powerpoint Viewer 2007 crashes opening .pptx files
5926 	programs 	0 	Wine does not provide an implementation of winhlp32.exe
6254 	richedit 	4 	Installer infinite loop from rich text error
3546 	shdocvw 	2 	CLSID_InternetShortcut not available...
6095 	shdocvw 	12 	MOTD in counter-strike 1.6 and counter-strike
source does not render
8898 	shdocvw 	0 	Run Time Error "445": Object doesn't support this
action in Europa Knowledgebase
9304 	shdocvw 	3 	Temple of Elemental Evil demo doesn't start - gui irresponsive
8439 	shell32 	7 	Visual Studio .NET (7) install fails
9809 	shell32 	4 	Autodesk Revit Architecture 2008 install fails
10905 	shell32 	0 	thinstall firefox demo requires native msvcrt
11742 	shlwapi 	8 	Small .net 1.1 app (FastMD5 1.3) fails to start up
12074 	testcase 	2 	The conformance tests fail on Windows
6604 	tools 	2 	Ship icons for the wine-tools that can be used in .desktop files
8246 	urlmon 	3 	invoking htmlhelp:HtmlHelpW crashes wine
664 	user32 	6 	The help menu functionality inside programs is broken
(messaging problem)
3023 	user32 	5 	Orcad - "Place Part" never tries to put down a part
4523 	user32 	5 	Can't copy from Firefox 1.5 and paste into OpenOffice
2 under Wine
124 	wineserv 	2 	Review of Wine Server Protocol
1990 	winex11. 	1 	modifier keys not released when switching desktop
2368 	winex11. 	6 	Wine loses its X-Window when switching to another
virt. desktop in Fvwm
3297 	winex11. 	12 	UpdateWindow() doesn't call XFlush()
5623 	winex11. 	3 	GetAsyncKeyState wrong if querying process doesn't have focus
5828 	winex11. 	24 	Command and Conquer Generals (Zero Hour) doesn't
change the mouse cursor from the default X mouse
7372 	winex11. 	12 	can't copy and paste between gnome apps eg
openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
10984 	winex11. 	4 	sun jre 5 update 10 installer hangs in 0.9.52
11019 	winex11. 	2 	matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
3711 	wininet 	1 	Musicmatch fails to install (missing registry key,
HTTP_HttpOpenRequest() problem)
5625 	wininet 	3 	Wine does not handle internet proxy settings conveniently
9787 	winsock 	46 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
12005 	wintab32 	0 	Regression in pressure sensitivity with wizardpen
tablet driver and Photoshop 7


From dmitry at codeweavers.com  Wed Mar 26 23:13:32 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 12:13:32 +0800
Subject: gdi32-related commit between
	0.9.57<->0.9.58broken	.NET2/Systems.Windows.Forms
References: <137645.21992.qm@web23108.mail.ird.yahoo.com>
	<47EB04E1.7020206@kievinfo.com>
Message-ID: <015b01c88fc0$edbdc970$a600fea9@DMITRY>

"Vitaliy Margolen" <wine-devel at kievinfo.com> wrote:

> Looks like a time to start blacklisting fonts then. If the font is invalid 
> and does not work even on windows yet it is available in the system - that's 
> the only thing Wine can do. Or just contact all distros to remove it. Or 
> request packagers to refuse installing Wine if said font found in the system.

Black listing the fonts is not an appropriate fix/workaround. There is
already a fixed version of ukai.ttf, and a broken one was causing problems
in a lot of native programs besides Wine.

-- 
Dmitry.


From iammisc at gmail.com  Thu Mar 27 00:43:32 2008
From: iammisc at gmail.com (Travis Athougies)
Date: Wed, 26 Mar 2008 22:43:32 -0700
Subject: Contributing
Message-ID: <91fef9720803262243r6ee697fk93cdda05572cc8b2@mail.gmail.com>

Hi,

I would like to help contribute to WINE because I use it so much yet
I've never actually contributed to it. I was wondering if there are
any simple bugs or other tasks that someone new to WINE development
could undertake.

Thanks.

-- 
From: Travis Athougies
2 + 2 = 4


From mat at brain-dump.org  Thu Mar 27 02:42:24 2008
From: mat at brain-dump.org (Marc Andre Tanner)
Date: Thu, 27 Mar 2008 08:42:24 +0100
Subject: [GSoC][RFC] Case Insensitive Filesystem
In-Reply-To: <47EAD9A5.3050600@open-vote.org>
References: <20080325213351.GA3237@debbook.brain-dump.org>
	<alpine.DEB.1.00.0803261245160.15829@amboise.dolphin>
	<20080326165909.GA3213@debbook.brain-dump.org>
	<87iqz9s96v.fsf@wine.dyndns.org> <47EAD9A5.3050600@open-vote.org>
Message-ID: <20080327074224.GA1829@debbook.brain-dump.org>

On Wed, Mar 26, 2008 at 04:17:57PM -0700, Scott Ritchie wrote:
> Alexandre Julliard wrote:
> > Marc Andre Tanner <mat at brain-dump.org> writes:
> > 
> >> Yes that's true the case information is lost but is it really needed? 
> >> If you create the files with the original mixed case you will have to
> >> scan the whole directory in order to match it to a given filename. 
> >> And if i am not mistaken this is exactly what wine does. 
> > 
> > Yes, and that's precisely because Wine wants to preserve case, so that
> > tools that look at the filesystem directly see the right thing. If you
> > are going to store everything lowercase in the filesystem, then we could
> > just as well do that inside Wine, without a FUSE module.
> > 
> 
> It seems like we have a few goals:
> 
> * Prevent having to read the whole directory when looking for a
> case-insensitive file

So what are the different method's to achieve this? Apart from
translating every thing to lower case which i did.

> * Allow non-Wine programs to work with the cased filenames
> * Prevent the creation of conflicting files

With my proposal it basically works as long as your accessing the files
via the mount point of the fuse filesystem, however when you start messing
around with the underlying directory directly things may go wrong.

> The last one is important, as we need to have a 1:1 correspondence
> between cased and uncased files in the .wine folder to prevent breakages
> when someone, say, installs a patch with different casing from a zip file.
> 
> I don't see any reason why it would be bad to have the FUSE module
> mounted at login rather than when Wine starts.  This would make your
> Wine folder no different to other apps than, say, a vfat disk mounted
> there.  I should be able to extract a zip with file-roller containing
> "foo.txt" and have it overwrite "Foo.txt" even if Wine isn't running.

Again this will work if you do it via the mountpoint:

  mkdir -p ~/ciopfs/{data,mountpoint} && cd ~/ciopfs
  ciopfs -d data mountpoint
  echo Testdata > mountpoint/Foo.txt

at this point your directories should look like this:
 
 |-- data
 |   `-- foo.txt
 `-- mountpoint
     `-- Foo.txt

and 'getfattr -dR data' should show the original file name of foo.txt:

 # file: data/foo.txt
 user.filename="Foo.txt"

now you extract your archive in mountpoint and should get:

 |-- data
 |   `-- foo.txt
 `-- mountpoint
     `-- foo.txt

What i am trying to say is that as long as you interact with your data
via mountpoint everything is fine.

When you start creating files directly in data which are not all
lowercase they will currently simply be ignored.

So the question is whether it is acceptable to say: don't touch data
directly do everything via mountpoint? 

Regards,
Marc

-- 
 Marc Andre Tanner >< http://www.brain-dump.org/ >< GPG key: CF7D56C0


From julliard at winehq.org  Thu Mar 27 05:31:09 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 27 Mar 2008 11:31:09 +0100
Subject: [3/5] D3D8: Reject broken normal declaration types with fixed
	function
In-Reply-To: <200803262023.25735.stefan@codeweavers.com> ("Stefan
	=?utf-8?Q?D=C3=B6singer=22's?=
	message of "Wed, 26 Mar 2008 20:23:25 +0100")
References: <200803262023.25735.stefan@codeweavers.com>
Message-ID: <877ifosbki.fsf@wine.dyndns.org>

Stefan D?singer <stefan at codeweavers.com> writes:

> From d9182d3da1416e0bfa06b1fe879c4c74c66b0c3e Mon Sep 17 00:00:00 2001
> From: Stefan Doesinger <stefan at codeweavers.com>
> Date: Wed, 12 Mar 2008 01:06:38 +0100
> Subject: [PATCH] D3D8: Reject broken normal declaration types with fixed function

This doesn't work for me:

../../../tools/runtest -q -P wine -M d3d8.dll -T ../../.. -p d3d8_test.exe.so visual.c && touch visual.ok
visual.c:1184: Test failed: IDirect3DDevice8_CreateVertexShader returned with 0x8876086c
make[2]: *** [visual.ok] Error 1

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Mar 27 05:34:04 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 27 Mar 2008 11:34:04 +0100
Subject: [PATCH] user32: add a DrawText test for bug 12226.
In-Reply-To: <558b2f5c0803261524s12a6a911u6988cccf0c634855@mail.gmail.com>
	(Lei Zhang's message of "Wed, 26 Mar 2008 15:24:35 -0700")
References: <558b2f5c0803261524s12a6a911u6988cccf0c634855@mail.gmail.com>
Message-ID: <873aqcsbfn.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> +static void test_Bug12226(void)
> +{

Please name functions according to what they do, not their bug
number. The code must be understandable without having to look things up
in bugzilla. In any case this should most likely go into the existing
test_DrawTextCalcRect() function.

> +    height = DrawTextA(hdc, "", -1, &rect,
> +                       DT_CALCRECT | DT_LEFT | DT_SINGLELINE);
> +    todo_wine ok(16 == height, "expected %d, got %d\n", 16, height);

I don't think you can hardcode 16, that should depend on the font
metrics.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Mar 27 05:52:40 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 27 Mar 2008 11:52:40 +0100
Subject: widl: Use is_string_type for detecting strings in
	write_typeformatstring_var to make it consistent with
	write_remoting_arg.
In-Reply-To: <47EA53E3.10200@codeweavers.com> (Robert Shearman's message of
	"Wed, 26 Mar 2008 13:47:15 +0000")
References: <47EA53E3.10200@codeweavers.com>
Message-ID: <87y784qw07.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> Fix the is_string_type function used for detecting strings by only
> examining aliases instead of both aliases and pointers. This is due to
> the requirement that pointers to strings be handled as pointers and so
> not detected as strings.

This breaks qmgr:

../../../tools/runtest -q -P wine -M qmgr.dll -T ../../.. -p qmgr_test.exe.so file.c && touch file.ok
file.c:127: Test failed: Got incorrect remote name
file.c:144: Test failed: Got incorrect local name
make: *** [file.ok] Error 2

-- 
Alexandre Julliard
julliard at winehq.org


From scott at open-vote.org  Thu Mar 27 05:59:54 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Thu, 27 Mar 2008 03:59:54 -0700
Subject: GSOC proposal - control panel
In-Reply-To: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
References: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
Message-ID: <47EB7E2A.10302@open-vote.org>

Owen Rudge wrote:
> The examples given on the GSOC wiki 
> pages (basic desktop/screen resizing, general network information, and font 
> details) would be good applets for me to implement, but I would also be 
> interested in working on some other applets, such as an Add/Remove Programs 
> applet, or a Multimedia applet. 

What I and the other Ubuntu UI people would really like to see is the
ability to uninstall Wine programs from within gnome-app-install (The
Gnome applet the user interacts with after selecting
Applications->Add/Remove).

The UI is a fairly intuitive step - just add a "Windows Applications"
category and list the installed Wine apps on the right.  Once that's
done, we don't need a special Wine program for uninstalling anymore,
since we can expand the functionality in a similar place where the user
could reasonably expects to find it.

As for what you'll need to do this done, uninstalling applications from
the command line isn't yet supported, though I believe someone else is
working on that through reg.exe.

Thanks,
Scott Ritchie


From chris.kcat at gmail.com  Thu Mar 27 06:15:42 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Thu, 27 Mar 2008 04:15:42 -0700
Subject: GSOC proposal - control panel
In-Reply-To: <47EB7E2A.10302@open-vote.org>
References: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
	<47EB7E2A.10302@open-vote.org>
Message-ID: <200803270415.43052.chris.kcat@gmail.com>

On Thursday 27 March 2008 03:59:54 am Scott Ritchie wrote:
> The UI is a fairly intuitive step - just add a "Windows Applications"
> category and list the installed Wine apps on the right.  Once that's
> done, we don't need a special Wine program for uninstalling anymore,
> since we can expand the functionality in a similar place where the user
> could reasonably expects to find it.
>
> As for what you'll need to do this done, uninstalling applications from
> the command line isn't yet supported, though I believe someone else is
> working on that through reg.exe.

Uninstallable Windows apps are listed in the registry at 
HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\*, and they contain 
the description of the app, as well as the command to uninstall it. Couldn't 
you use something like reg.exe (after it's implemented enough) to parse those 
registry keys and list the apps, and when the user asks to uninstall it, 
run "wine <uninstall string>"? No need for the control panel or applets at 
all.


From leslie_alistair at hotmail.com  Thu Mar 27 06:43:27 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Thu, 27 Mar 2008 22:43:27 +1100
Subject: midl question
Message-ID: <fsg18l$7c2$1@ger.gmane.org>

Hi,
  
In an IDL file I need to define the following
typedef HRESULT (__stdcall *FExecuteInAppDomainCallback) (void* cookie);

How do i get midl to understand what __stdcall is defined to?

Best Regards

Alistair Leslie-Hughes




From paul.vriens.wine at gmail.com  Thu Mar 27 07:06:32 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 27 Mar 2008 13:06:32 +0100
Subject: setupapi: Implement pSetupGetField, with tests.
Message-ID: <47EB8DC8.4030708@gmail.com>

Hi James,

I'm looking into a crash of the setupapi/parser test on Vista.

It crashes in this piece:

  465         ret = HeapFree( GetProcessHeap(), 0, (LPVOID)field );
  466         ok( !ret, "Expected HeapFree to fail\n" );
  467         ok( GetLastError() == ERROR_INVALID_PARAMETER,
  468             "Expected ERROR_INVALID_PARAMETER, got %u\n", GetLastError() );

when trying the second field.

It's been added by a patch of yours:

http://source.winehq.org/git/wine.git/?a=commit;h=7588b669d8331ff64fc3b75cebe40ef518cd0de1

What's the reason for checking the HeapFree here? Or what's the reason for doing 
it at all?

-- 
Cheers,

Paul.


From leslie_alistair at hotmail.com  Thu Mar 27 07:21:24 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Thu, 27 Mar 2008 23:21:24 +1100
Subject: midl question
In-Reply-To: <039601c89000$c66e8270$a600fea9@DMITRY>
References: <fsg18l$7c2$1@ger.gmane.org>
	<039601c89000$c66e8270$a600fea9@DMITRY>
Message-ID: <BAY117-W404160B8BD9054E0971F7693FE0@phx.gbl>





> From: dmitry at codeweavers.com> To: leslie_alistair at hotmail.com> CC: wine-devel at winehq.org> Subject: Re: midl question> Date: Thu, 27 Mar 2008 19:50:34 +0800> > "Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote:> > > In an IDL file I need to define the following> > typedef HRESULT (__stdcall *FExecuteInAppDomainCallback) (void* cookie);> > > > How do i get midl to understand what __stdcall is defined to?> > indexsrv.idl does:> > cpp_quote("struct tagTEXT_SOURCE;")> cpp_quote("typedef HRESULT (WINAPI *PFNFILLTEXTBUFFER)(struct tagTEXT_SOURCE *pTextSource);") Hi Dmitry,
  This isnt going to work for me.  Here is more information that I should of included in the first email.
interface ICLRRuntimeHost : IUnknown
...
HRESULT ExecuteInAppDomain([in] DWORD dwAppDomainId,                               [in] FExecuteInAppDomainCallback pCallback,                               [in] void* cookie);
...
So FExecuteInAppDomainCallback has to be defined or I will get compile errors.
 
Best Regards
 Alistair Leslie-Hughes
_________________________________________________________________
Are you paid what you're worth? Find out: SEEK Salary Centre
http://a.ninemsn.com.au/b.aspx?URL=http%3A%2F%2Fninemsn%2Eseek%2Ecom%2Eau%2Fcareer%2Dresources%2Fsalary%2Dcentre%2F%3Ftracking%3Dsk%3Ahet%3Asc%3Anine%3A0%3Ahot%3Atext&_t=764565661&_r=OCT07_endtext_salary&_m=EXT
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080327/e535a3b7/attachment.htm 

From rob at codeweavers.com  Thu Mar 27 07:42:54 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 27 Mar 2008 12:42:54 +0000
Subject: midl question
In-Reply-To: <fsg18l$7c2$1@ger.gmane.org>
References: <fsg18l$7c2$1@ger.gmane.org>
Message-ID: <47EB964E.7070101@codeweavers.com>

Alistair Leslie-Hughes wrote:
> Hi,
>   
> In an IDL file I need to define the following
> typedef HRESULT (__stdcall *FExecuteInAppDomainCallback) (void* cookie);
>
> How do i get midl to understand what __stdcall is defined to?

midl or widl? AFAIK midl supports the __stdcall keyword.


-- 
Rob Shearman



From leslie_alistair at hotmail.com  Thu Mar 27 07:48:37 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Thu, 27 Mar 2008 23:48:37 +1100
Subject: midl question
In-Reply-To: <47EB964E.7070101@codeweavers.com>
References: <fsg18l$7c2$1@ger.gmane.org> <47EB964E.7070101@codeweavers.com>
Message-ID: <BAY117-W391ACAA1FD9E0601C7A57293FE0@phx.gbl>



> Date: Thu, 27 Mar 2008 12:42:54 +0000> From: rob at codeweavers.com> To: leslie_alistair at hotmail.com> CC: wine-devel at winehq.org> Subject: Re: midl question> > Alistair Leslie-Hughes wrote:> > Hi,> > > > In an IDL file I need to define the following> > typedef HRESULT (__stdcall *FExecuteInAppDomainCallback) (void* cookie);> >> > How do i get midl to understand what __stdcall is defined to?> > midl or widl? AFAIK midl supports the __stdcall keyword.> Hi Rob,
 
widl.
 
Best Regards
 Alistair Leslie-Hughes
_________________________________________________________________
Are you paid what you're worth? Find out: SEEK Salary Centre
http://a.ninemsn.com.au/b.aspx?URL=http%3A%2F%2Fninemsn%2Eseek%2Ecom%2Eau%2Fcareer%2Dresources%2Fsalary%2Dcentre%2F%3Ftracking%3Dsk%3Ahet%3Asc%3Anine%3A0%3Ahot%3Atext&_t=764565661&_r=OCT07_endtext_salary&_m=EXT
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080327/06f0e4d2/attachment.htm 

From dmitry at codeweavers.com  Thu Mar 27 08:24:52 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 21:24:52 +0800
Subject: [1/2] Added a test: registering device interface and getting
	devicepath
References: <200803271422.57559.amorozov@etersoft.ru>
Message-ID: <049a01c8900d$f20ad570$a600fea9@DMITRY>

"Alexander Morozov" <amorozov at etersoft.ru> wrote:

> Changelog:
> Added a test for setupapi: registering device interface and getting device 
> path

Please consistently print GetLastError() values as %u (not %08x or %d),
otherwise the test looks good to me.


-- 
Dmitry.


From dmitry at codeweavers.com  Thu Mar 27 06:50:34 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 19:50:34 +0800
Subject: midl question
References: <fsg18l$7c2$1@ger.gmane.org>
Message-ID: <039601c89000$c66e8270$a600fea9@DMITRY>

"Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote:

> In an IDL file I need to define the following
> typedef HRESULT (__stdcall *FExecuteInAppDomainCallback) (void* cookie);
> 
> How do i get midl to understand what __stdcall is defined to?

indexsrv.idl does:

cpp_quote("struct tagTEXT_SOURCE;")
cpp_quote("typedef HRESULT (WINAPI *PFNFILLTEXTBUFFER)(struct tagTEXT_SOURCE *pTextSource);")

-- 
Dmitry.


From rob at codeweavers.com  Thu Mar 27 07:15:22 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 27 Mar 2008 12:15:22 +0000
Subject: widl: Use is_string_type for detecting strings in
	write_typeformatstring_var
	to make it consistent with write_remoting_arg.
In-Reply-To: <87y784qw07.fsf@wine.dyndns.org>
References: <47EA53E3.10200@codeweavers.com> <87y784qw07.fsf@wine.dyndns.org>
Message-ID: <47EB8FDA.7080806@codeweavers.com>

Alexandre Julliard wrote:
> Robert Shearman <rob at codeweavers.com> writes:
>
>   
>> Fix the is_string_type function used for detecting strings by only
>> examining aliases instead of both aliases and pointers. This is due to
>> the requirement that pointers to strings be handled as pointers and so
>> not detected as strings.
>>     
>
> This breaks qmgr:
>
> ../../../tools/runtest -q -P wine -M qmgr.dll -T ../../.. -p qmgr_test.exe.so file.c && touch file.ok
> file.c:127: Test failed: Got incorrect remote name
> file.c:144: Test failed: Got incorrect local name
> make: *** [file.ok] Error 2

Thanks, there was a typo in the patch. I'll resend it with the typo fixed.

I believe the patches titled "widl: Support using context handles as the 
binding handle in client functions." and "widl: Add support for generic 
binding handles." will still apply without this patch being committed first.

-- 
Rob Shearman



From dmitry at codeweavers.com  Thu Mar 27 08:27:57 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 21:27:57 +0800
Subject: [2/2] Setupapi patch
References: <200803271423.08655.amorozov@etersoft.ru>
Message-ID: <04a501c8900e$61142070$a600fea9@DMITRY>

"Alexander Morozov" <amorozov at etersoft.ru> wrote:

> +    if (ReferenceString && lstrlenW(ReferenceString))
>      {
>          /* space for a hash between string and reference string: */
>          len += lstrlenW(ReferenceString) + 1;
> @@ -258,10 +258,10 @@ static LPWSTR SETUPDI_CreateSymbolicLink
>          /* replace '\\' with '#' after the "\\\\?\\" beginning */
>          for (ptr = strchrW(ret + 4, '\\'); ptr; ptr = strchrW(ptr + 1, '\\'))
>              *ptr = '#';
> -        if (ReferenceString)
> +        if (ReferenceString && lstrlenW(ReferenceString))

Calling lstrlenW on ReferenceString is not needed, checking *ReferenceString
is enough.

-- 
Dmitry.


From paul.vriens.wine at gmail.com  Thu Mar 27 08:44:41 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 27 Mar 2008 14:44:41 +0100
Subject: [Tools 3/6] winetest: Fix merging of the individual test results
	into one group result,
	especially when they all report the dll is missing
	or that the test crashed, etc.
In-Reply-To: <alpine.DEB.1.00.0803262335490.10184@amboise.dolphin>
References: <alpine.DEB.1.00.0803262335490.10184@amboise.dolphin>
Message-ID: <47EBA4C9.9020207@gmail.com>

Francois Gouget wrote:
> Merge all the data for a given unit test to a single structure instead of scattering them into multiple hashtables.
> The new result data structure makes it possible for the same code to work for both group and individual report results.
> ---
> 
> This fixes the many '.' found in the summary table.
> 
>  winetest/gather |  333 ++++++++++++++++++++++++++++++++++---------------------
>  1 files changed, 204 insertions(+), 129 deletions(-)
> 
> diff --git a/winetest/gather b/winetest/gather
> index d032e23..881134a 100755
> --- a/winetest/gather
> +++ b/winetest/gather
> @@ -37,32 +37,45 @@ $name0 =~ s+^.*/++;
>  my $summary_version=4;
>  
>  
....
>  
> +sub min_to_max($)
> +{
> +    my ($minmax)=@_;
> +    return $minmax->[0] if ($minmax->[0] == $minmax->[1]);
> +    return "$minmax->[0] to $minmax->[1]";
> +}
> +

Don't we need quotes around "x to y"? Firebug complains about this.

> +        my $mm_count=min_to_max($result->{count});
> +        my $mm_errors=min_to_max($result->{errors});
> +        my $mm_todos=min_to_max($result->{todos});
> +        my $mm_skips=min_to_max($result->{skips});
> +        my $title="$mm_count tests, $mm_errors errors, $mm_todos todos, $mm_skips skips";

Or put the quotes here of course.

The results of your latest patches can be seen at:

http://test.winehq.org/data/200803191000/

-- 
Cheers,

Paul.


From dmitry at codeweavers.com  Thu Mar 27 09:09:19 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 22:09:19 +0800
Subject: [1/2] Added a test: registering device interface and getting
	devicepath
References: <200803271422.57559.amorozov@etersoft.ru>
	<049a01c8900d$f20ad570$a600fea9@DMITRY>
	<200803271655.16334.amorozov@etersoft.ru>
Message-ID: <050c01c89014$27a74b40$a600fea9@DMITRY>

"Alexander Morozov" <amorozov at etersoft.ru> wrote:

> > Please consistently print GetLastError() values as %u (not %08x or %d),
> > otherwise the test looks good to me.
> 
> Edit every test in tests/devinst.c or only testRegisterAndGetDetail?

My comment was about newly added code. If there are other places, then
they should be fixed as well, but in a separate patch.

-- 
Dmitry.


From pure_evil at mail.bg  Thu Mar 27 09:21:06 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Thu, 27 Mar 2008 16:21:06 +0200
Subject: GSOC proposal - control panel
Message-ID: <200803271621.06760.pure_evil@mail.bg>

No dice.
CPls are DLLs that export a function - CPlApplet(). 
winegcc coughs on dllexport. - not implemented.
I've been hacking at it for days on end now. 
Result: CPl can be compiled under windows and run under wine. CPls compiled 
with winegcc don't export that function => not treated as control panel 
applets.
software to aid anyone: dllexp.exe. Download and run on any dll/cpl of 
windows, you get exports in it; run on wine dlls - nada. (hence, No Template 
in wine's source. Twain DLL exports some methods though.)

MICROSOFT ISSUE: EASY TO DISTINGUISH BETWEEN WINE DLLS AND WINDOWS DLLS. 

If dllexp.exe can do it, so can they. Solution: M$ implements a code that 
*checks for a dll version* (based on what the DLL exports). Doesn't find 
export => coughs and dies with an "Incompatible DLL version". Happened before 
with OS2 / Windows. Maybe has happened now with all M$ that cough on wine.

Not enough intimate knowledge => can a soft cough and die based on a call to a 
DLL export which isn't there, without being designed to do so?


From paul.vriens.wine at gmail.com  Thu Mar 27 09:19:11 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 27 Mar 2008 15:19:11 +0100
Subject: [1/2] Added a test: registering device interface and getting
	devicepath
In-Reply-To: <050c01c89014$27a74b40$a600fea9@DMITRY>
References: <200803271422.57559.amorozov@etersoft.ru>	<049a01c8900d$f20ad570$a600fea9@DMITRY>	<200803271655.16334.amorozov@etersoft.ru>
	<050c01c89014$27a74b40$a600fea9@DMITRY>
Message-ID: <47EBACDF.8040309@gmail.com>

Dmitry Timoshkov wrote:
> "Alexander Morozov" <amorozov at etersoft.ru> wrote:
> 
>>> Please consistently print GetLastError() values as %u (not %08x or %d),
>>> otherwise the test looks good to me.
>> Edit every test in tests/devinst.c or only testRegisterAndGetDetail?
> 
> My comment was about newly added code. If there are other places, then
> they should be fixed as well, but in a separate patch.
> 

Is this just for this file or do you generally want %u instead of %d/%08x ?

-- 
Cheers,

Paul.


From fgouget at free.fr  Thu Mar 27 09:27:19 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 27 Mar 2008 15:27:19 +0100 (CET)
Subject: [Tools 3/6] winetest: Fix merging of the individual test results
	into one group result,
	especially when they all report the dll is missing
	or that the test crashed, etc.
In-Reply-To: <47EBA4C9.9020207@gmail.com>
References: <alpine.DEB.1.00.0803262335490.10184@amboise.dolphin>
	<47EBA4C9.9020207@gmail.com>
Message-ID: <alpine.DEB.1.00.0803271526270.19839@amboise.dolphin>

On Thu, 27 Mar 2008, Paul Vriens wrote:
[...]
> >  +sub min_to_max($)
> > +{
> > +    my ($minmax)=@_;
> > +    return $minmax->[0] if ($minmax->[0] == $minmax->[1]);
> > +    return "$minmax->[0] to $minmax->[1]";
> > +}
> > +
> 
> Don't we need quotes around "x to y"? Firebug complains about this.

Ah, I see, I forgot to put quotes for the refresh() parameters.
I'll send a patch.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
The nice thing about meditation is that it makes doing nothing quite respectable
                                  -- Paul Dean


From paul.vriens.wine at gmail.com  Thu Mar 27 09:30:34 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 27 Mar 2008 15:30:34 +0100
Subject: [1/2] Added a test: registering device interface and getting
	devicepath
In-Reply-To: <47EBACDF.8040309@gmail.com>
References: <200803271422.57559.amorozov@etersoft.ru>	<049a01c8900d$f20ad570$a600fea9@DMITRY>	<200803271655.16334.amorozov@etersoft.ru>
	<050c01c89014$27a74b40$a600fea9@DMITRY>
	<47EBACDF.8040309@gmail.com>
Message-ID: <47EBAF8A.1050302@gmail.com>

Paul Vriens wrote:
> Dmitry Timoshkov wrote:
>> "Alexander Morozov" <amorozov at etersoft.ru> wrote:
>>
>>>> Please consistently print GetLastError() values as %u (not %08x or %d),
>>>> otherwise the test looks good to me.
>>> Edit every test in tests/devinst.c or only testRegisterAndGetDetail?
>>
>> My comment was about newly added code. If there are other places, then
>> they should be fixed as well, but in a separate patch.
>>
> 
> Is this just for this file or do you generally want %u instead of %d/%08x ?
> 

I'm just asking as for most of the setupapi errors %08x looks much better than 
%u (and is easier traceable in the setupapi.h include file).

For example:

#define ERROR_INVALID_MACHINENAME 
(APPLICATION_ERROR_MASK|ERROR_SEVERITY_ERROR|0x220)

%u : 3758096928
%08x : e0000220

-- 
Cheers,

Paul.


From dmitry at codeweavers.com  Thu Mar 27 09:31:48 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 22:31:48 +0800
Subject: [1/2] Added a test: registering device interface and
	gettingdevicepath
References: <200803271422.57559.amorozov@etersoft.ru>	<049a01c8900d$f20ad570$a600fea9@DMITRY>	<200803271655.16334.amorozov@etersoft.ru><050c01c89014$27a74b40$a600fea9@DMITRY>
	<47EBACDF.8040309@gmail.com>
Message-ID: <054e01c89017$4d258050$a600fea9@DMITRY>

"Paul Vriens" <paul.vriens.wine at gmail.com> wrote:

> Is this just for this file or do you generally want %u instead of %d/%08x ?

GetLastError() returns an unsigned value, and winerror.h lists error values
in decimal (if anyone really wants to match a trace with a symbolic name).

-- 
Dmitry.


From rob at codeweavers.com  Thu Mar 27 09:53:36 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 27 Mar 2008 14:53:36 +0000
Subject: GSOC proposal - control panel
In-Reply-To: <200803271621.06760.pure_evil@mail.bg>
References: <200803271621.06760.pure_evil@mail.bg>
Message-ID: <47EBB4F0.5050009@codeweavers.com>

pure_evil at mail.bg wrote:
> No dice.
> CPls are DLLs that export a function - CPlApplet(). 
> winegcc coughs on dllexport. - not implemented.
>   

__declspec(dllexport) is a MSVC-only feature. Hence, when compiling with 
gcc (even using winegcc) it won't actually export the function. As has 
been stated before, you need to use a .spec or .def file to export it.

> I've been hacking at it for days on end now. 
> Result: CPl can be compiled under windows and run under wine. CPls compiled 
> with winegcc don't export that function => not treated as control panel 
> applets.
> software to aid anyone: dllexp.exe. Download and run on any dll/cpl of 
> windows, you get exports in it; run on wine dlls - nada. (hence, No Template 
> in wine's source. Twain DLL exports some methods though.)
>
> MICROSOFT ISSUE: EASY TO DISTINGUISH BETWEEN WINE DLLS AND WINDOWS DLLS. 
>
> If dllexp.exe can do it, so can they. Solution: M$ implements a code that 
> *checks for a dll version* (based on what the DLL exports). Doesn't find 
> export => coughs and dies with an "Incompatible DLL version". Happened before 
> with OS2 / Windows. Maybe has happened now with all M$ that cough on wine.
>
> Not enough intimate knowledge => can a soft cough and die based on a call to a 
> DLL export which isn't there, without being designed to do so?

A DLL compiled as a winelib DLL won't be parsed by a tool that reads PE 
DLLs, because winelib DLLs are Elf shared objects. Use winedump instead.

-- 
Rob Shearman



From pure_evil at mail.bg  Thu Mar 27 10:03:48 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Thu, 27 Mar 2008 17:03:48 +0200
Subject: GSOC proposal - control panel
In-Reply-To: <47EBB4F0.5050009@codeweavers.com>
References: <200803271621.06760.pure_evil@mail.bg>
	<47EBB4F0.5050009@codeweavers.com>
Message-ID: <200803271703.48555.pure_evil@mail.bg>

> __declspec(dllexport) is a MSVC-only feature. Hence, when compiling with
> gcc (even using winegcc) it won't actually export the function. As has
> been stated before, you need to use a .spec or .def file to export it.

Yes. 

> A DLL compiled as a winelib DLL won't be parsed by a tool that reads PE
> DLLs, because winelib DLLs are Elf shared objects. Use winedump instead.

Precisely. Easy to distinguish between wine and doze Dlls. 

> Use winedump instead.

I did. It dumps the CPlApplet() function nicely from all cpls (including one I 
made in Delphi). 



From truiken at gmail.com  Thu Mar 27 10:35:43 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 27 Mar 2008 10:35:43 -0500
Subject: Contributing
In-Reply-To: <91fef9720803262243r6ee697fk93cdda05572cc8b2@mail.gmail.com>
References: <91fef9720803262243r6ee697fk93cdda05572cc8b2@mail.gmail.com>
Message-ID: <22821af30803270835t67205ba5n6b415294cb4041e7@mail.gmail.com>

On Thu, Mar 27, 2008 at 12:43 AM, Travis Athougies <iammisc at gmail.com> wrote:
> Hi,
>
>  I would like to help contribute to WINE because I use it so much yet
>  I've never actually contributed to it. I was wondering if there are
>  any simple bugs or other tasks that someone new to WINE development
>  could undertake.
>

http://wiki.winehq.org/DeveloperDoc

-- 
James Hawkins


From truiken at gmail.com  Thu Mar 27 10:44:22 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 27 Mar 2008 10:44:22 -0500
Subject: setupapi: Implement pSetupGetField, with tests.
In-Reply-To: <47EB8DC8.4030708@gmail.com>
References: <47EB8DC8.4030708@gmail.com>
Message-ID: <22821af30803270844w37ab0472la98e1e992e793f45@mail.gmail.com>

On Thu, Mar 27, 2008 at 7:06 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi James,
>
>  I'm looking into a crash of the setupapi/parser test on Vista.
>
>  It crashes in this piece:
>
>   465         ret = HeapFree( GetProcessHeap(), 0, (LPVOID)field );
>   466         ok( !ret, "Expected HeapFree to fail\n" );
>   467         ok( GetLastError() == ERROR_INVALID_PARAMETER,
>   468             "Expected ERROR_INVALID_PARAMETER, got %u\n", GetLastError() );
>
>  when trying the second field.
>
>  It's been added by a patch of yours:
>
>  http://source.winehq.org/git/wine.git/?a=commit;h=7588b669d8331ff64fc3b75cebe40ef518cd0de1
>
>  What's the reason for checking the HeapFree here? Or what's the reason for doing
>  it at all?
>

To show that the value returned is not in the heap.

-- 
James Hawkins


From dmitry at codeweavers.com  Thu Mar 27 10:52:58 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 27 Mar 2008 23:52:58 +0800
Subject: setupapi: Implement pSetupGetField, with tests.
References: <47EB8DC8.4030708@gmail.com>
	<22821af30803270844w37ab0472la98e1e992e793f45@mail.gmail.com>
Message-ID: <05f501c89022$a37d12f0$a600fea9@DMITRY>

"James Hawkins" <truiken at gmail.com> wrote:

>>  What's the reason for checking the HeapFree here? Or what's the reason for doing
>>  it at all?
>>
> 
> To show that the value returned is not in the heap.

Isn't any of HeapValidate or HeapSize better in that case?

-- 
Dmitry.


From truiken at gmail.com  Thu Mar 27 11:05:42 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 27 Mar 2008 11:05:42 -0500
Subject: setupapi: Implement pSetupGetField, with tests.
In-Reply-To: <05f501c89022$a37d12f0$a600fea9@DMITRY>
References: <47EB8DC8.4030708@gmail.com>
	<22821af30803270844w37ab0472la98e1e992e793f45@mail.gmail.com>
	<05f501c89022$a37d12f0$a600fea9@DMITRY>
Message-ID: <22821af30803270905m6af22becj6358c53fcf98cb5b@mail.gmail.com>

On Thu, Mar 27, 2008 at 10:52 AM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> "James Hawkins" <truiken at gmail.com> wrote:
>
>  >>  What's the reason for checking the HeapFree here? Or what's the reason for doing
>  >>  it at all?
>  >>
>  >
>  > To show that the value returned is not in the heap.
>
>  Isn't any of HeapValidate or HeapSize better in that case?
>

Sure.  It worked on XP and earlier so I didn't really think twice
about it when I wrote the tests.

-- 
James Hawkins


From remco47 at gmail.com  Thu Mar 27 11:13:33 2008
From: remco47 at gmail.com (Remco)
Date: Thu, 27 Mar 2008 17:13:33 +0100
Subject: GSOC proposal - control panel
In-Reply-To: <200803271703.48555.pure_evil@mail.bg>
References: <200803271621.06760.pure_evil@mail.bg>
	<47EBB4F0.5050009@codeweavers.com>
	<200803271703.48555.pure_evil@mail.bg>
Message-ID: <36a11a3a0803270913p65d533eei3f89cf72d00939a8@mail.gmail.com>

On Thu, Mar 27, 2008 at 4:03 PM,  <pure_evil at mail.bg> wrote:
>  > A DLL compiled as a winelib DLL won't be parsed by a tool that reads PE
>  > DLLs, because winelib DLLs are Elf shared objects. Use winedump instead.
>
>  Precisely. Easy to distinguish between wine and doze Dlls.

Wine is easily detectable anyway. Just look at the Wine regkeys, or
try some Unix-calls. It's impossible to stop childish companies from
blocking Wine.

Remco


From juan.lang at gmail.com  Thu Mar 27 11:15:32 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 27 Mar 2008 09:15:32 -0700
Subject: [1/2] Added a test: registering device interface and
	gettingdevicepath
In-Reply-To: <054e01c89017$4d258050$a600fea9@DMITRY>
References: <200803271422.57559.amorozov@etersoft.ru>
	<049a01c8900d$f20ad570$a600fea9@DMITRY>
	<200803271655.16334.amorozov@etersoft.ru>
	<050c01c89014$27a74b40$a600fea9@DMITRY> <47EBACDF.8040309@gmail.com>
	<054e01c89017$4d258050$a600fea9@DMITRY>
Message-ID: <3a768c550803270915i354e1c7ta338dc1dd1a62c7b@mail.gmail.com>

>  GetLastError() returns an unsigned value, and winerror.h lists error values
>  in decimal (if anyone really wants to match a trace with a symbolic name).

That's not strictly true.  The cryptoapi errors are defined as
HRESULTs , but are returned via GetLastError.  More relevant to this
patch is that the setupapi errors are defined as bitmasks, and are
also returned via GetLastError.

I picked %08x for a reason in this code--it's far easier to find the
relevant error using it than using %u.
--Juan


From owen at owenrudge.net  Thu Mar 27 11:31:15 2008
From: owen at owenrudge.net (Owen Rudge)
Date: Thu, 27 Mar 2008 16:31:15 -0000
Subject: GSOC proposal - control panel
References: <012d01c88f88$44fec290$842a204e@lan.owenrudge.net>
	<47EB7E2A.10302@open-vote.org>
Message-ID: <025601c89027$fbc2c8b0$842a204e@lan.owenrudge.net>

> What I and the other Ubuntu UI people would really like to see is the
> ability to uninstall Wine programs from within gnome-app-install (The
> Gnome applet the user interacts with after selecting
> Applications->Add/Remove).
>
> The UI is a fairly intuitive step - just add a "Windows Applications"
> category and list the installed Wine apps on the right.  Once that's
> done, we don't need a special Wine program for uninstalling anymore,
> since we can expand the functionality in a similar place where the user
> could reasonably expects to find it.

This sounds somewhat like it'd be a bit of a side project to my intended 
plan. Implementing such a "Windows Applications" category wouldn't involve 
much more than interating through the registry, and then calling wine on the 
appropriate uninstaller .exe.

I would still suggest a proper Control Panel namespace for Wine would be 
best. Implementing functionality to embed the Wine control panel into other 
X windows would then be possible too, although looking at the patch 
submitted a few months ago, I fear the implementation of it may not be the 
most tidy thing. The idea of a side project implementing a basic set of 
reusable functions to iterate through the registry to retrieve application 
details (for Add/Remove Programs, at least) may be better.

Regards,

-- 
Owen Rudge
http://www.owenrudge.net/



From owen at owenrudge.net  Thu Mar 27 11:36:35 2008
From: owen at owenrudge.net (Owen Rudge)
Date: Thu, 27 Mar 2008 16:36:35 -0000
Subject: GSOC proposal - control panel
References: <200803271621.06760.pure_evil@mail.bg>
Message-ID: <026901c89028$baa29d50$842a204e@lan.owenrudge.net>

> No dice.
> CPls are DLLs that export a function - CPlApplet().
> winegcc coughs on dllexport. - not implemented.
> I've been hacking at it for days on end now.
> Result: CPl can be compiled under windows and run under wine. CPls 
> compiled
> with winegcc don't export that function => not treated as control panel
> applets.

I'm sure it must be possible to export routines in Wine .dll.so libraries 
via .def files or similar - whether GetProcAddress supports Wine "DLLs" is 
the issue. Even if for some reason it's not possible, I don't see that it 
would be impossible to detect that the .cpl file is actually a Wine DLL, and 
to use the appropriate dlopen-type routines to read it.

-- 
Owen Rudge
http://www.owenrudge.net/



From pure_evil at mail.bg  Thu Mar 27 11:51:47 2008
From: pure_evil at mail.bg (pure_evil at mail.bg)
Date: Thu, 27 Mar 2008 18:51:47 +0200
Subject: GSOC proposal - control panel
Message-ID: <200803271851.47420.pure_evil@mail.bg>

<off-topic>Sorry bout that, went a lil' /too/ paranoid. Thing is, I've spent 
so many days obsessing with the cpls, trying to get anything resembling a 
somewhat stable dev environment to produce anything resembling a *compilable* 
code, reverse-engineering Makefiles, and Makefile.ins, and defs and specs and 
C and gcc and ReactOS cpls and so forth /and being handed a code whose dev 
jumped on me for trying to cross-compile it, though that was what I asked for 
in the first place btw/ and when finally, SOMETHING compiled (a sample cpl 
included in Reactos 3.0. source code), I suddenly discovered that

A.) They can't be done the normal way /e.g. compiled against wine's 
source-tree by winegcc/
B.) If they could, they would've been done long ago (Reactos has 'em; Someone 
would've ported them by now, if not do 'em from scratch)

It was just too much for two weeks, sorry again.
</off-topic>

On-topic: CPls the normal way -> no-go. Binary CPls compiled on 'doze or with 
a 'doze compiler under wine -> yes. 

Sorry again.


From amorozov at etersoft.ru  Thu Mar 27 08:55:12 2008
From: amorozov at etersoft.ru (Alexander Morozov)
Date: Thu, 27 Mar 2008 16:55:12 +0300
Subject: [1/2] Added a test: registering device interface and getting
	devicepath
In-Reply-To: <049a01c8900d$f20ad570$a600fea9@DMITRY>
References: <200803271422.57559.amorozov@etersoft.ru>
	<049a01c8900d$f20ad570$a600fea9@DMITRY>
Message-ID: <200803271655.16334.amorozov@etersoft.ru>

? ????????? ?? Thursday 27 March 2008 16:24:52 Dmitry Timoshkov ???????(?):
> "Alexander Morozov" <amorozov at etersoft.ru> wrote:
> > Changelog:
> > Added a test for setupapi: registering device interface and getting
> > device path
>
> Please consistently print GetLastError() values as %u (not %08x or %d),
> otherwise the test looks good to me.

Edit every test in tests/devinst.c or only testRegisterAndGetDetail?


From cmorgan at mail.leather-wallet.co.uk  Thu Mar 27 15:00:03 2008
From: cmorgan at mail.leather-wallet.co.uk (chris morgan)
Date: Thu, 27 Mar 2008 20:00:03 +0000
Subject: prevents WM_DISPLAYCHANGE message being sent when a call to
	ChangeDisplaySettingsEx
	fails due to the requested change to the display not occurring.
In-Reply-To: <3f4fd2640803251555r47d6fc73r2462567c7bd84286@mail.gmail.com>
References: <47E7CBC0.8050806@mail.leather-wallet.co.uk>
	<3f4fd2640803251555r47d6fc73r2462567c7bd84286@mail.gmail.com>
Message-ID: <47EBFCC3.90907@mail.leather-wallet.co.uk>

thanks for the feedback, i'm new to this so it's very much appreciated - 
helped a lot.

I've updated the patch which hopefully covers the issues raised, but 
wanted to ask about the returning of an error:
> w.r.t. the implementation:
>   *  ChangeDisplaySettings returns a long
> (http://msdn2.microsoft.com/en-us/library/ms533260(VS.85).aspx), so
> the correct value must be returned on error;
>   
as failure to change the colour depth currently isn't treated as an 
error which seems sensible as it enables many older apps to run 
presumably without issue so thought it better not to change that.

from X11DRV_desktop_SetCurrentMode

        /* Ignore the depth mismatch
         *
         * Some (older) applications require a specific bit depth, this 
will allow them
         * to run. X11drv performs a color depth conversion if needed.
         */
>   *  the fix does not match the test cases (screen size vs colour depth). 
oops, bad oversight. to fix this i've created a variable to store the 
state of screens colour depth as it would be perceived by a client. this 
is used to detect changes to screen depth and prevent unexpected 
WM_DISPLAYCHANGE from being sent.

i.e. a program calls ChangeDisplaySettings changing the colour depth and 
receives back a WM_DISPLAYCHANGE message. As far as the client is 
concerned the screen is at the new colour depth as it's call to 
ChangeDisplaySettings succeeded.

If the program called ChangeDisplaySettings with setting the same colour 
depth as it's previous call then, if no other setting had changed, it 
would not expect to receive a WM_DISPLAYCHANGE message as it's view of 
the screen's colour depth had not changed.

> In addition, your tests should:
>   *  check that changing the screen resolution causes a
> WM_DISPLAYCHANGE message to be sent;
>   *  if there are no other tests, ChangeDisplaySettings should be
> checked to see what happens with invalid arguments (for completeness);
>   *  the return value is not checked for expected values (see
> http://msdn2.microsoft.com/en-us/library/ms533260(VS.85).aspx);
>   *  GetLastError() is not checked to see what it is set to (see other
> tests for examples);
>   *  restore the display settings back to what they were before the tests.  
found the existing test now which seem to cover much of this but will 
try and extend them further. the new patch seems to pass ok

new patch:

---
 dlls/winex11.drv/desktop.c     |   12 +++++++++++-
 dlls/winex11.drv/event.c       |    1 +
 dlls/winex11.drv/winpos.c      |    4 ++--
 dlls/winex11.drv/x11drv.h      |    1 +
 dlls/winex11.drv/x11drv_main.c |    3 ++-
 dlls/winex11.drv/xrandr.c      |   12 +++++++++++-
 6 files changed, 28 insertions(+), 5 deletions(-)
--------------1.5.2.5
Content-Type: text/x-patch; 
name="c65ac7a7c58d8d36c05bf789daf2c5f3cbb64959.diff"
Content-Transfer-Encoding: 8bit
Content-Disposition: attachment; 
filename="c65ac7a7c58d8d36c05bf789daf2c5f3cbb64959.diff"

diff --git a/dlls/winex11.drv/desktop.c b/dlls/winex11.drv/desktop.c
index 1699318..04ac482 100644
--- a/dlls/winex11.drv/desktop.c
+++ b/dlls/winex11.drv/desktop.c
@@ -94,8 +94,18 @@ static LONG X11DRV_desktop_SetCurrentMode(int mode)
          * to run. X11drv performs a color depth conversion if needed.
          */
     }
+
     TRACE("Resizing Wine desktop window to %dx%d\n", 
dd_modes[mode].dwWidth, dd_modes[mode].dwHeight);
-    X11DRV_resize_desktop(dd_modes[mode].dwWidth, dd_modes[mode].dwHeight);
+
+    if (client_bpp != dd_modes[mode].dwBPP ||
+        screen_width != dd_modes[mode].dwWidth ||
+        screen_height != dd_modes[mode].dwHeight)
+    {
+        // Only call if the desktop has acutally changed
+        client_bpp = dd_modes[mode].dwBPP;
+        X11DRV_resize_desktop(dd_modes[mode].dwWidth, 
dd_modes[mode].dwHeight);
+    }
+
     return DISP_CHANGE_SUCCESSFUL;
 }

diff --git a/dlls/winex11.drv/event.c b/dlls/winex11.drv/event.c
index cd6eaf6..6795d90 100644
--- a/dlls/winex11.drv/event.c
+++ b/dlls/winex11.drv/event.c
@@ -1106,6 +1106,7 @@ LRESULT X11DRV_WindowMessage( HWND hwnd, UINT msg, 
WPARAM wp, LPARAM lp )
     case WM_X11DRV_SET_WIN_FORMAT:
         return X11DRV_set_win_format( hwnd, (XID)wp );
     case WM_X11DRV_RESIZE_DESKTOP:
+        client_bpp = wp;
         X11DRV_resize_desktop( LOWORD(lp), HIWORD(lp) );
         return 0;
     default:
diff --git a/dlls/winex11.drv/winpos.c b/dlls/winex11.drv/winpos.c
index ad62236..6c68858 100644
--- a/dlls/winex11.drv/winpos.c
+++ b/dlls/winex11.drv/winpos.c
@@ -564,7 +564,7 @@ void X11DRV_resize_desktop( unsigned int width, 
unsigned int height )

     if (GetWindowThreadProcessId( hwnd, NULL ) != GetCurrentThreadId())
     {
-        SendMessageW( hwnd, WM_X11DRV_RESIZE_DESKTOP, 0, MAKELPARAM( 
width, height ) );
+        SendMessageW( hwnd, WM_X11DRV_RESIZE_DESKTOP, client_bpp, 
MAKELPARAM( width, height ) );
     }
     else
     {
@@ -573,7 +573,7 @@ void X11DRV_resize_desktop( unsigned int width, 
unsigned int height )
                       virtual_screen_rect.right - virtual_screen_rect.left,
                       virtual_screen_rect.bottom - virtual_screen_rect.top,
                       SWP_NOZORDER | SWP_NOACTIVATE | SWP_DEFERERASE );
-        SendMessageTimeoutW( HWND_BROADCAST, WM_DISPLAYCHANGE, screen_bpp,
+        SendMessageTimeoutW( HWND_BROADCAST, WM_DISPLAYCHANGE, client_bpp,
                              MAKELPARAM( width, height ), 
SMTO_ABORTIFHUNG, 2000, NULL );
     }

diff --git a/dlls/winex11.drv/x11drv.h b/dlls/winex11.drv/x11drv.h
index 52670e8..8c28f81 100644
--- a/dlls/winex11.drv/x11drv.h
+++ b/dlls/winex11.drv/x11drv.h
@@ -525,6 +525,7 @@ extern Window root_window;
 extern unsigned int screen_width;
 extern unsigned int screen_height;
 extern unsigned int screen_bpp;
+extern unsigned int client_bpp;
 extern unsigned int screen_depth;
 extern RECT virtual_screen_rect;
 extern unsigned int text_caps;
diff --git a/dlls/winex11.drv/x11drv_main.c b/dlls/winex11.drv/x11drv_main.c
index d445e64..58dd680 100644
--- a/dlls/winex11.drv/x11drv_main.c
+++ b/dlls/winex11.drv/x11drv_main.c
@@ -71,6 +71,7 @@ Visual *visual;
 unsigned int screen_width;
 unsigned int screen_height;
 unsigned int screen_bpp;
+unsigned int client_bpp;
 unsigned int screen_depth;
 RECT virtual_screen_rect;
 Window root_window;
@@ -517,7 +518,7 @@ static BOOL process_attach(void)
         }
     }
     if (!screen_depth) screen_depth = DefaultDepthOfScreen( screen );
-    screen_bpp = depth_to_bpp( screen_depth );
+    client_bpp = screen_bpp = depth_to_bpp( screen_depth );

     XInternAtoms( display, (char **)atom_names, NB_XATOMS - 
FIRST_XATOM, False, X11DRV_Atoms );

diff --git a/dlls/winex11.drv/xrandr.c b/dlls/winex11.drv/xrandr.c
index fd930a2..e977aa1 100644
--- a/dlls/winex11.drv/xrandr.c
+++ b/dlls/winex11.drv/xrandr.c
@@ -179,6 +179,7 @@ static LONG X11DRV_XRandR_SetCurrentMode(int mode)
     unsigned int i;
     int j;
     DWORD dwBpp = screen_bpp;
+    DWORD modeBPP = dd_modes[mode].dwBPP;

     wine_tsx11_lock();
     root = RootWindow (gdi_display, DefaultScreen(gdi_display));
@@ -188,6 +189,7 @@ static LONG X11DRV_XRandR_SetCurrentMode(int mode)
     {
         FIXME("Cannot change screen BPP from %d to %d\n", dwBpp, 
dd_modes[mode].dwBPP);
     }
+
     mode = mode%real_xrandr_modes_count;

     TRACE("Changing Resolution to %dx%d @%d Hz\n",
@@ -229,7 +231,15 @@ static LONG X11DRV_XRandR_SetCurrentMode(int mode)
     wine_tsx11_unlock();
     if (stat == RRSetConfigSuccess)
     {
-        X11DRV_resize_desktop( dd_modes[mode].dwWidth, 
dd_modes[mode].dwHeight );
+        if (client_bpp != modeBPP ||
+            screen_width != dd_modes[mode].dwWidth ||
+            screen_height != dd_modes[mode].dwHeight)
+        {
+            // Only call if the desktop has acutally changed
+            client_bpp = modeBPP;
+            X11DRV_resize_desktop( dd_modes[mode].dwWidth, 
dd_modes[mode].dwHeight );
+        }
+
         return DISP_CHANGE_SUCCESSFUL;
     }






From mstefani at redhat.com  Thu Mar 27 15:37:37 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 27 Mar 2008 21:37:37 +0100
Subject: comdlg32->printdlg: bug fixed
In-Reply-To: <200803272148.12065.vitperov@etersoft.ru>
References: <200803272148.12065.vitperov@etersoft.ru>
Message-ID: <47EC0591.9020600@redhat.com>

Vitaly Perov wrote:
> Bug is the following:
>  When a application is responsible for printing multiple copies printer prints 
> X^2 copies (4 instead of 2, 9 instead of 3 ...)
> It happen bacause application already prepared requested copies, and printer 
> driver prints copies ( number placed in dmCopies) of whole document.
> 
> Changelog:
> - When PD_USEDEVMODECOPIESANDCOLLATE flag is not set dmCopies must be 1.

You didn't attached the diff but the whole file.

bye
	michael


From htl10 at users.sourceforge.net  Thu Mar 27 15:39:23 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Thu, 27 Mar 2008 20:39:23 +0000 (GMT)
Subject: Fw: Re: Google Summer of Code 2008 - joined openprinting+wine
	project?
In-Reply-To: <47EADAFC.8000206@gmx.net>
Message-ID: <818031.96955.qm@web23108.mail.ird.yahoo.com>

Thanks for the info... I have updated the linux foundation GSOC page with some of my ideas.

Naively, I think it is almost scriptable - get cups to dump the input as temp postscript, use wine to run win32 ghostscript (which works quite well in wine, 
my first-hand experience) to render through GDI and if the printer proxy can receive 
the data that way, let wine send the data out through lpX, libusb or the network... just a thought, and maybe a pipe dream :-). This is slow, but maybe viable?

I have a fair amount of mingw-cross experience, and lately rather into wine. 

--- On Wed, 26/3/08, Marcel Partap <mpartap at gmx.net> wrote:

> From: Marcel Partap <mpartap at gmx.net>
> Subject: Re: Fw: Re: Google Summer of Code 2008 - joined openprinting+wine project?
> To: htl10 at users.sourceforge.net
> Cc: wine-devel at winehq.org, "Till Kamppeter" <till.kamppeter at gmail.com>
> Date: Wednesday, 26 March, 2008, 11:23 PM
> Hi Hin-Tak,
> to sum it up, I was the one working on that project and I
> hit some ehh.. problems ;)
> Anyways, my final result was that I got something out of
> the printer drivers I tried with, but 
> useful results depended on something that is referred to as
> the ominous 'DIB engine'. Coincidently, 
> there was another SoC project done by Jesse Allen which
> started implementing that. That code ended 
> up at http://repo.or.cz/w/wine/dibdrv.git, and just as
> mine, general+AJ's consensus was to start 
> merging it post-1.0. Now I didn't have time to look
> again at it up to now (uni!) but I still want to 
> finish this, just not as part of a SoC project. Also I
> wouldn't recommend that to anyone, except he 
> REEEAAALLY does grok all those mysterious inner-GDI
> concepts (DIB DDB DDI...) that this project 
> touches. I myself have not fully reached insight of how
> best to merge the current winex11drv, 
> wined3d and Jesse's dib engine, but I'll have a
> thorough look at it in the next few days. Another 
> unsolved issue is whether to teach wine's internal GDI
> functions to speak DDI or rather to build a 
> wineddi.drv bridge thing. I tried both approaches but there
> was no clear decision whether to use one 
> or the other, with Alexandre's stance being 'once
> something actually works we can talk about that'.
> Also my code to make printer drivers work depends on some
> stuff within the localspooler code, I have 
> to investigate how far Detlef got it to work regarding
> installation of drivers.
> Oh yeah and that printer proxy was only a DLL to see how
> native windows communicates with the 
> drivers without getting into disassembling stuff.. the
> results scared me, astonishing levels of 
> redundancy.. Anyways, even though all the bits and pieces
> of how to make native drivers actually 
> work with wine are lying around, this is neither a fun nor
> a beginner's task (I know that now *g). 
> That said, I'm going to look into it and hope to come
> up with something in the next few days.
> regards marcel.
> 
> 
> Hin-Tak Leung wrote:
> > Hi, anybody on wine-devel want to take this on and
> make this more concrete?
> > 
> > --- On Wed, 26/3/08, Till Kamppeter
> <till.kamppeter at gmail.com> wrote:
> > 
> >> From: Till Kamppeter
> <till.kamppeter at gmail.com>
> >> Subject: Re: Google Summer of Code 2008 - Some
> general instructions for reviewing the student's
> applications
> >> To: "Hin-Tak Leung"
> <hintak_leung at yahoo.co.uk>
> >> Cc: "Casey Schaufler"
> <casey at schaufler-ca.com>, "'Glen
> Petrie'" <glen.petrie at eitc.epson.com>,
> "Rik van Riel" <riel at redhat.com>,
> "Jeff Licquia" <licquia at debian.org>,
> "Jon Masters" <jonmasters at gmail.com>,
> "Jonathan Riddell" <jriddell at ubuntu.com>,
> "Josef Spillner" <spillner at kde.org>,
> Matt_Domsch at dell.com, "Pekka Enberg"
> <penberg at cs.helsinki.fi>
> >> Date: Wednesday, 26 March, 2008, 4:34 PM
> >> Hin-Tak Leung wrote:
> >>> Hi Till and the rest of the gang.
> >>>
> >>> Two people had got in touch with with about
> the
> >> IJS+PDF workflow, and I replied. 
> >>> (sorry I don't check the "other"
> e-mail
> >> often - I probably should set up re-direction).
> >> Great!
> >>
> >>> I thought I should also mentioned that it has
> just
> >> came to my attention in some unrelated discussion
> on
> >> wine-devel - been doing some non-printing
> wine-related
> >> stuff lately - that there *was* a google summer of
> code
> >> 2007 project for a
> >>> wine-based native printer driver proxy - this
> is the
> >> sort of thing I have had in mind
> >>> for a while and I thought it would be
> interesting to
> >> do but I don't have in-depth
> >>> windows knowledge to make it happen, but the
> wine
> >> people already did!
> >>>
> http://google-summer-of-code-2007-wine.googlecode.com/
> >>>
> >>> I just downloaded the gsoc 2007 printerproxy
> code. It
> >> seems that it is just for use
> >>> from within wine, but it just might be
> interesting to
> >> make it more general - via opvp
> >>> or IJS. We should follow up on this.
> >> If this project still requires coding, it is not
> too late
> >> to add it as 
> >> project idea to the ideas pages of both the Linux
> >> Foundation and WINE 
> >> (having it presented at two mentoring
> organizations raises
> >> the chances 
> >> to find a student).
> >>
> >> Our ideas page is a Wiki and you can simply edit
> it:
> >>
> >>
> https://www.linux-foundation.org/en/Google_Summer_of_Code
> >>
> >>     Till
> > 
> > 
> >      
> __________________________________________________________
> > Sent from Yahoo! Mail.
> > More Ways to Keep in Touch.
> http://uk.docs.yahoo.com/nowyoucan.html
> > 
> 
> 
> -- 
> <div id="signature">
>    "Obstacles are those frightful things you see when
> you take your eyes off your goal."
>                                                            
>    -- Henry Ford (1863-1947)
>    Change the world! Vote revolution:
> http://hfopi.org/vote-future
> </div>


      __________________________________________________________
Sent from Yahoo! Mail.
More Ways to Keep in Touch. http://uk.docs.yahoo.com/nowyoucan.html


From r.kalbermatter at hccnet.nl  Thu Mar 27 16:04:19 2008
From: r.kalbermatter at hccnet.nl (Rolf Kalbermatter)
Date: Thu, 27 Mar 2008 22:04:19 +0100
Subject: GSOC proposal - control panel
In-Reply-To: <200803271851.47420.pure_evil@mail.bg>
References: <200803271851.47420.pure_evil@mail.bg>
Message-ID: <001501c8904e$204bda70$4001a8c0@NATERS>

pure_evil at mail.bg [mailto:pure_evil at mail.bg] 

> On-topic: CPls the normal way -> no-go. Binary CPls compiled 
> on 'doze or with a 'doze compiler under wine -> yes. 

I may be very off here but isn't Wine's LoadLibrary/GetProcAddress
able to deal with wine shared library modules, even if they are not
really PE files?

Of course Windows can't deal with them. For a Windows compatible DLL
you do need a cross compiler like MingW or compile the sources in MSVC.
It should be the same here as what is actually the situation for the
test framework.

Rolf Kalbermatter



From cesar at ecuarock.net  Thu Mar 27 21:08:59 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Thu, 27 Mar 2008 21:08:59 -0500
Subject: fuse-iso and remote named pipes for GSOC
In-Reply-To: <200803260942.19076.kai.blin@gmail.com>
References: <e3d3ae8f0803251824s75bbd9f0ia25c930dfa7a80e@mail.gmail.com>
	<200803260942.19076.kai.blin@gmail.com>
Message-ID: <e3d3ae8f0803271908k4829097cid7ff7d0009066b75@mail.gmail.com>

On Wed, Mar 26, 2008 at 3:42 AM, Kai Blin <kai.blin at gmail.com> wrote:
> On Wednesday 26 March 2008 02:24:35 Cesar Izurieta wrote:
>  > Besides the FUSE project for GSOC I see two items listed on the
>  > http://wiki.winehq.org/SummerOfCode page:
>  >
>  > # Better ISO FUSE file system integration
>
>  Steven already took care of this part, so I'll wrap up the next one.
>
>
>  > # A FUSE wrapper for remote named pipes using libsmbclient
>
>  The goal of this is to be able to do RPC via Windows named pipes to remote
>  machines. Of course the best solution would be to just use libsmbclient from
>  Wine directly, but libsmbclient is under the GPL and Wine is under the LGPL,
>  so that's not going to work.
>
>  So the obvious idea is some solution where we can use libsmbclient for what we
>  need without having to link to libsmbclient. FUSE can provide this
>  abstraction.
>
>  The idea would be to create a pipe subdirectory of WINEPREFIX and mount our
>  pipefs there. Accessing pipe/server/pipename should connect to
>  \\server\pipe\pipename, if possible.
>  One more thing that needs to be supported is mode switching on the named pipe.

Implementing such a filesystem doesn't seem difficult at all.
libsmbclient contains all that is needed and we would only need to map
some samba structs to fuse structs. The only real problem that I see
is authentication. If we want to use this as a regular filesystem we
could mount one pipefs per connection (with authentication information
on connect) or provide login and domain information in the path itself
(doesn't sound like a good idea)

>
>  I'd suggest to read up on remote named pipes to get a better idea what they're
>  used for.
>
>  If you've got any more questions, I'm happy to help.
>  Kai
>
>  --
>  Kai Blin
>  WorldForge developer  http://www.worldforge.org/
>  Wine developer        http://wiki.winehq.org/KaiBlin
>  Samba team member     http://www.samba.org/samba/team/
>  --
>  Will code for cotton.
>


From dmitry at codeweavers.com  Thu Mar 27 22:07:15 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 28 Mar 2008 11:07:15 +0800
Subject: [1/2] Added a test: registering device interface
	andgettingdevicepath
References: <200803271422.57559.amorozov@etersoft.ru><049a01c8900d$f20ad570$a600fea9@DMITRY><200803271655.16334.amorozov@etersoft.ru><050c01c89014$27a74b40$a600fea9@DMITRY>
	<47EBACDF.8040309@gmail.com><054e01c89017$4d258050$a600fea9@DMITRY>
	<3a768c550803270915i354e1c7ta338dc1dd1a62c7b@mail.gmail.com>
Message-ID: <006d01c89080$d561f700$a600fea9@DMITRY>

"Juan Lang" <juan.lang at gmail.com> wrote:

>>  GetLastError() returns an unsigned value, and winerror.h lists error values
>>  in decimal (if anyone really wants to match a trace with a symbolic name).
> 
> That's not strictly true.  The cryptoapi errors are defined as
> HRESULTs , but are returned via GetLastError.  More relevant to this
> patch is that the setupapi errors are defined as bitmasks, and are
> also returned via GetLastError.
> 
> I picked %08x for a reason in this code--it's far easier to find the
> relevant error using it than using %u.

Then the tests should consistently use %08x, not a mixture of various
formats.

-- 
Dmitry.


From juan.lang at gmail.com  Thu Mar 27 22:12:24 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 27 Mar 2008 20:12:24 -0700
Subject: [1/2] Added a test: registering device interface
	andgettingdevicepath
In-Reply-To: <006d01c89080$d561f700$a600fea9@DMITRY>
References: <200803271422.57559.amorozov@etersoft.ru>
	<049a01c8900d$f20ad570$a600fea9@DMITRY>
	<200803271655.16334.amorozov@etersoft.ru>
	<050c01c89014$27a74b40$a600fea9@DMITRY> <47EBACDF.8040309@gmail.com>
	<054e01c89017$4d258050$a600fea9@DMITRY>
	<3a768c550803270915i354e1c7ta338dc1dd1a62c7b@mail.gmail.com>
	<006d01c89080$d561f700$a600fea9@DMITRY>
Message-ID: <3a768c550803272012x1614ad16g1b9e23873dea66e3@mail.gmail.com>

>  > I picked %08x for a reason in this code--it's far easier to find the
>  > relevant error using it than using %u.
>
>  Then the tests should consistently use %08x, not a mixture of various
>  formats.

Perhaps.  I generally chose a format that matched the "expected"
error.  Error values like ERROR_INVALID_PARAMETER should be %u--I
erroneously use %d, I think--whereas setupapi errors should be %08x.
But since the ok output is in exceptional conditions, it might be hard
to predict which range of values is more likely, so perhaps
consistency is better than trying to be smart about it.  I don't have
a firm opinion about that.
--Juan


From jim at darchons.net  Fri Mar 28 00:47:43 2008
From: jim at darchons.net (Jim Chen)
Date: Fri, 28 Mar 2008 01:47:43 -0400
Subject: Implement VBScript for Google Summer of Code
Message-ID: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>

Hi everyone,

I have this idea of implementing vbscript.dll for Google SoC. Any
comment would be appreciated before I start working on my proposal.

The reason for implementing vbscript.dll is because right now there's
nothing in the trunk about it. jscript.dll has a stub, but
vbscript.dll doesn't, and it's an area that I think I can work on.
VBScript is used by the Windows Installer, can be potentially be used
for DirectMusic script (from http://wiki.winehq.org/DirectX-ToDo), and
some applications use it.

Just the core language/runtime (vbscript.dll) is implemented, no extra
COM/OLE objects such as FSO (file system object), etc. (unless I have
time). The language by itself is designed to be simple and easy, so an
interpreter shouldn't be hard. I wrote a C-style script interpreter in
Java this past year. For a few years I used to hack VB, and I know the
language and VBScript is just a cousin of VB. The runtime library is
not big, and writing it shouldn't take too much time either.

I think the hardest part would be to implement the COM interfaces that
deal with scripting. And that's the area I know least about.

Thanks!
Jim


From paul.vriens.wine at gmail.com  Fri Mar 28 03:53:18 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 28 Mar 2008 09:53:18 +0100
Subject: [Tools 5/6] winetest: Add statistics for the number of unit tests
	with errors or todos.
In-Reply-To: <alpine.DEB.1.00.0803262337580.10184@amboise.dolphin>
References: <alpine.DEB.1.00.0803262337580.10184@amboise.dolphin>
Message-ID: <47ECB1FE.3020107@gmail.com>

Francois Gouget wrote:
> Also tweak the headers and footers a bit.
> ---
> 
> This gives us a better idea of how many unit tests are failing.
> 
>  winetest/gather |   67 ++++++++++++++++++++++++++++++++++++++++++++++++++----
>  1 files changed, 62 insertions(+), 5 deletions(-)
> 
> diff --git a/winetest/gather b/winetest/gather

Hi Francois,

I think something is 'wrong' with the statistics for the Wine group:

http://test.winehq.org/data/200803211000/#group_Wine

They are the same for every box with respect to the "X + Y". The title (on mouse 
  over) is correct though.

-- 
Cheers,

Paul.


From paul.vriens.wine at gmail.com  Fri Mar 28 03:55:29 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 28 Mar 2008 09:55:29 +0100
Subject: [Tools 5/6] winetest: Add statistics for the number of unit tests
	with errors or todos.
In-Reply-To: <47ECB1FE.3020107@gmail.com>
References: <alpine.DEB.1.00.0803262337580.10184@amboise.dolphin>
	<47ECB1FE.3020107@gmail.com>
Message-ID: <47ECB281.4080505@gmail.com>

Paul Vriens wrote:
> Francois Gouget wrote:
>> Also tweak the headers and footers a bit.
>> ---
>>
>> This gives us a better idea of how many unit tests are failing.
>>
>>  winetest/gather |   67 
>> ++++++++++++++++++++++++++++++++++++++++++++++++++----
>>  1 files changed, 62 insertions(+), 5 deletions(-)
>>
>> diff --git a/winetest/gather b/winetest/gather
> 
> Hi Francois,
> 
> I think something is 'wrong' with the statistics for the Wine group:
> 
> http://test.winehq.org/data/200803211000/#group_Wine
> 
> They are the same for every box with respect to the "X + Y". The title 
> (on mouse  over) is correct though.
> 

Would this do? :

diff --git a/winetest/gather b/winetest/gather
index 294ad06..fdacff5 100755
--- a/winetest/gather
+++ b/winetest/gather
@@ -362,7 +362,7 @@ EOF
                      "pass";
          my $count=!$report->{todos} ? $report->{errors} :
                    !$report->{errors} ? $report->{todos} :
-                  "$group->{errors}+$group->{todos}";
+                  "$report->{errors}+$report->{todos}";

          my $prcnt=!$report->{todos} ? percent($report->{errors}, $unit_count) :
                    !$report->{errors} ? percent($report->{todos}, $unit_count) :


-- 
Cheers,

Paul.


From xixsimplicityxix at gmail.com  Fri Mar 28 04:44:21 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 28 Mar 2008 04:44:21 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47EAA1C0.5050004@gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
Message-ID: <78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>

>  > Are you currently working on this?  Is it a problem that needs to be
>  > fixed on the mingw side?
>  >
>  It's indeed a mingw issue and has to be fixed on that side.
>
>  I've never touched mingw so I'm relying on either Hans Leidekker, Stefan
>  Leichter or Paul Millar to take this up.
>

The problem is that it is a mingw issue but they don't want any
patches from wines win32 api in their mingw w32api.  They believe that
looking at the actual ms header files taints our headers legally
speaking.  Stefan, hans, and PaulM maintain a rather large set of
patches against w32api.  [1]

So its a constant catchup game from when wines headers get new
additions until someone sends paulm a patch updating the mingw w32api.

I made a script [2] that will cross build winetest from git source no
mingw patches needed. In theory this could be useful in keeping the
cross built winetest.exe's rolling.

To use the script you need 3 dirs a wine-git, wine-native, and a
wine-pe.  Set those locations in the config part of the script as well
as the build and host settings for your compiler and cross compiler.
At the end winetest.exe will be in wine-pe/programs/winetest/ folder.
 This setup is from PaulMs recipe [3] with some tweaking.

Also if you trust me and just want the exe its at [4].


Hope this helps,
John

P.S. I logged some test results from my win2k machine, it seems they
are at [5].  Seems like I missed some setting though as the date is
not right.  Advice on how to fix that would be delicious =)


[1] http://readlist.com/lists/lists.sourceforge.net/mingw-users/1/5419.html
[2] http://klehm.net/wine/crossbuild_winetest.sh
[3] http://www.winehq.org/pipermail/wine-devel/2006-December/053069.html
[4] http://klehm.net/wine/winetest.exe
[5] http://test.winehq.org/data/06d429d6b6b6d63beaeda130a3bb261ef3b9fb41/


From paul.vriens.wine at gmail.com  Fri Mar 28 04:52:02 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 28 Mar 2008 10:52:02 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>	
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>	
	<47E8C57C.9030708@gmail.com>	
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>	
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
Message-ID: <47ECBFC2.2010805@gmail.com>

John Klehm wrote:
> 
> P.S. I logged some test results from my win2k machine, it seems they
> are at [5].  Seems like I missed some setting though as the date is
> not right.  Advice on how to fix that would be delicious =)
> 

It uses the file programs/winetest/build.id for this.

-- 
Cheers,

Paul.


From canterbury.matt at gmail.com  Thu Mar 27 13:50:02 2008
From: canterbury.matt at gmail.com (Matthew Canterbury)
Date: Thu, 27 Mar 2008 14:50:02 -0400
Subject: GSOC proposal: DirectPlay4
Message-ID: <8ec28a80803271150x2993ca08y98b15d409758f70a@mail.gmail.com>

Hello everybody,

I plan on applying for Google's Summer of Code to work on DirectPlay4
support in wine. (This was mentioned on the ideas page,
http://wiki.winehq.org/SummerOfCode). I've looked at the code currently in
wine, and it looks like there is some work done, but a number of the
functions exported in the corresponding dlls are stubs or partial stubs.
Alot of work needs to be done to dplay to make it more compliant (or at
least more functional). This would allow several games that depend on
DirectPlay to work without copying dll's from a windows partition. So I
intend to makes sure the IDirectPlay4 COM interface is sufficiently
implemented and that it meets the requirements set forth in in the
DirectPlay4 specification. If time permits, I'd like to look into the
Reliable Specification for DirectPlay4, but i think implementing just the
core specification will keep me busy. I've never worked on an open source
project before, but I have wanted to for quite some time. I'm looking
forward to contributing to a project that I've used quite a bit in the past
few years. ;)

I thought I would introduce myself a bit here. I'm currently a computer
engineering student at a University in the United States. I've been
programming since I was about 13, and I've had all kinds of personal
projects from a somewhat functional 3D game engines to a ray tracer. I was
also chosen to participate on our school's team for the ACM programming
competition. In short, I'm a programmer at heart.

I'm putting the final touches on my application and would greatly appreciate
any thoughts or comments before I submit it through Google.

Thanks,

Matthew Canterbury
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080327/672e0409/attachment.htm 

From julliard at winehq.org  Fri Mar 28 05:04:46 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 28 Mar 2008 11:04:46 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	(John Klehm's message of "Fri, 28 Mar 2008 04:44:21 -0500")
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
Message-ID: <877ifnqi4h.fsf@wine.dyndns.org>

"John Klehm" <xixsimplicityxix at gmail.com> writes:

> P.S. I logged some test results from my win2k machine, it seems they
> are at [5].  Seems like I missed some setting though as the date is
> not right.  Advice on how to fix that would be delicious =)

It's now using the git commit sha1 instead of a date when building from
a git tree, that's a feature. I'm hoping we can standardize on that to
make sure all test runs properly identify the exact source used.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Fri Mar 28 05:36:47 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 28 Mar 2008 10:36:47 +0000
Subject: amstream: IAMMultiMediaStream::EnumMediaStreams
In-Reply-To: <47EC3799.2060106@gmail.com>
References: <47EC3799.2060106@gmail.com>
Message-ID: <47ECCA3F.5020508@codeweavers.com>

Nikolay Sivov wrote:
> @@ -144,9 +144,18 @@
>  {
>      IAMMultiMediaStreamImpl *This = (IAMMultiMediaStreamImpl *)iface;
>  
> -    FIXME("(%p/%p)->(%ld,%p) stub!\n", This, iface, Index, ppMediaStream); 
> +    TRACE("(%p/%p)->(%d,%p)\n", This, iface, Index, ppMediaStream);
>  
> -    return E_NOTIMPL;
> +    /* check out of range */
> +    if(Index < 0 || Index >= This->nbStreams)
> +        return S_FALSE;
> +    /* NULL pointer */
> +    if(!(*ppMediaStream))
> +        return E_POINTER;
> +    
> +    *ppMediaStream = This->pStreams[Index];
> +    
> +    return S_OK;
>  }
>   

You need to call IMediaStream_AddRef on the returned stream.


-- 
Rob Shearman



From xixsimplicityxix at gmail.com  Fri Mar 28 06:05:57 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 28 Mar 2008 06:05:57 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <20080325093948.145810@gmx.net>
References: <47E8C0FC.2010700@gmail.com> <20080325093948.145810@gmx.net>
Message-ID: <78a7dad00803280405w3da1fd8dv383a1c7dc6688bfa@mail.gmail.com>

On Tue, Mar 25, 2008 at 4:39 AM, Roderick Colenbrander
<thunderbird2k at gmx.net> wrote:
>
>  As a sidenote. You are also cross compiling wine dlls so now and then. It would be useful to also cross compile d3d8/d3d9 and wined3d but for wined3d -DUSE_WIN32_OPENGL must be set.
>

Well let me know how this works for you.  I'll refactor my script a
bit later today but for right now you have to run this one after the
winetest script, as this one counts on the environment that the
winetest script sets up.

Script to crossbuild d3d dlls [1] and the dlls themselves [2], [3],
[4] are out there.


John

[1] http://klehm.net/wine/crossbuild_d3d_dlls.sh
[2] http://klehm.net/wine/d3d8.dll
[3] http://klehm.net/wine/d3d9.dll
[4] http://klehm.net/wine/wined3d.dll


From xixsimplicityxix at gmail.com  Fri Mar 28 06:50:43 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 28 Mar 2008 06:50:43 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <78a7dad00803280405w3da1fd8dv383a1c7dc6688bfa@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com> <20080325093948.145810@gmx.net>
	<78a7dad00803280405w3da1fd8dv383a1c7dc6688bfa@mail.gmail.com>
Message-ID: <78a7dad00803280450m69c5ff39v6cc90c33dc96473c@mail.gmail.com>

On Fri, Mar 28, 2008 at 6:05 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> On Tue, Mar 25, 2008 at 4:39 AM, Roderick Colenbrander
>  <thunderbird2k at gmx.net> wrote:
>  >
>
> >  As a sidenote. You are also cross compiling wine dlls so now and then. It would be useful to also cross compile d3d8/d3d9 and wined3d but for wined3d -DUSE_WIN32_OPENGL must be set.
>  >
>
>  Well let me know how this works for you.  I'll refactor my script a
>  bit later today but for right now you have to run this one after the
>  winetest script, as this one counts on the environment that the
>  winetest script sets up.
>
>  Script to crossbuild d3d dlls [1] and the dlls themselves [2], [3],
>  [4] are out there.
>
>
>  John
>
>  [1] http://klehm.net/wine/crossbuild_d3d_dlls.sh
>  [2] http://klehm.net/wine/d3d8.dll
>  [3] http://klehm.net/wine/d3d9.dll
>  [4] http://klehm.net/wine/wined3d.dll
>

Sorry I forgot it the first time, but you'll also need libwine.dll [1]
in addition to the other d3d dlls.  Test them out on your own window
machine with [2].  Just put them in the same directory as the program.

John

[1] http://klehm.net/wine/libwine.dll
[2] http://www.codesampler.com/source/dx8_multitexture.zip


From stefan at codeweavers.com  Fri Mar 28 07:04:34 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 28 Mar 2008 13:04:34 +0100
Subject: 2/2 WineD3D: initial post pixelshader blending support
In-Reply-To: <20080328092531.190990@gmx.net>
References: <20080328092531.190990@gmx.net>
Message-ID: <200803281304.34836.stefan@codeweavers.com>

Am Freitag, 28. M?rz 2008 10:25:31 schrieb Roderick Colenbrander:
> Hi,
>
> Store a flag whether a format supports blending in the formats table. This
> patch uses the flag in the blending code and in a few other places to
> verify if we should turn on blending for the given format. A next patch
> will also us e this flag for a CheckPixelShaderBlendingCapability call for
> CheckDeviceFormat. Later on I plan to move more of the Check*Capability
> functions over to the table.
Regarding the glDisable(GL_BLEND) in the CTXUSAGE_CLEAR setup: You have to 
mark the D3D state dirty in the context when doing that, otherwise blending 
might not be re-enabled properly on the next draw. I also think that 
disabling blending for clearing is orthogonal to the rest of the patch and 
should be done in a separate patch.

> +#define WINED3DFMT_FLAG_POSTPIXELSHADER_BLENDING 1
Maybe use 0x1 instead of 1? That will make adding new flags beyond 8 clearer.

Otherwise it looks good!




From stefan at codeweavers.com  Fri Mar 28 07:12:44 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 28 Mar 2008 13:12:44 +0100
Subject: [3/5] WineD3D: Support clipplanes with GLSL shaders
In-Reply-To: <200803280257.46649.stefan@codeweavers.com>
References: <200803280257.46649.stefan@codeweavers.com>
Message-ID: <200803281312.44946.stefan@codeweavers.com>

Am Freitag, 28. M?rz 2008 02:57:46 schrieb Stefan D?singer:
Please do not apply this patch yet. We are not sure if we should write the Z 
corrected coord as clip coord or not


From kai.blin at gmail.com  Fri Mar 28 07:34:18 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Fri, 28 Mar 2008 13:34:18 +0100
Subject: GSOC proposal: DirectPlay4
In-Reply-To: <8ec28a80803271150x2993ca08y98b15d409758f70a@mail.gmail.com>
References: <8ec28a80803271150x2993ca08y98b15d409758f70a@mail.gmail.com>
Message-ID: <200803281334.25132.kai.blin@gmail.com>

On Thursday 27 March 2008 19:50:02 Matthew Canterbury wrote:
> Hello everybody,
>
> I plan on applying for Google's Summer of Code to work on DirectPlay4
> support in wine. (This was mentioned on the ideas page,
> http://wiki.winehq.org/SummerOfCode). I've looked at the code currently in
> wine, and it looks like there is some work done, but a number of the
> functions exported in the corresponding dlls are stubs or partial stubs.
> Alot of work needs to be done to dplay to make it more compliant (or at
> least more functional).

Currently all it does is to not crash apps trying to load it. :)

> This would allow several games that depend on 
> DirectPlay to work without copying dll's from a windows partition. So I
> intend to makes sure the IDirectPlay4 COM interface is sufficiently
> implemented and that it meets the requirements set forth in in the
> DirectPlay4 specification.

Good, the idea here is to finish up the COM interface and make it send the 
appropriate dplay messages.

> If time permits, I'd like to look into the 
> Reliable Specification for DirectPlay4, but i think implementing just the
> core specification will keep me busy.

He, probably not worth the effort for now. I'd focus on the core protocol. My 
guess is that we can get all games to work without it.

You need to think about how you want to go about implementing the protocol 
step by step and what game you want to be using for testing.

Have you played with the DirectPlay dissector in Wireshark already? You need 
to get Wireshark from SVN to get the latest, greatest version of the 
dissector.

Try and get some network captures of the game you want to test to see what the 
messages look like on the wire and how a typical dplay session looks like.

Looking forward to your application,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080328/4f899ab3/attachment.pgp 

From dmitry at codeweavers.com  Fri Mar 28 07:52:19 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 28 Mar 2008 20:52:19 +0800
Subject: MinGW cross compilation fails for d3dx9_36/tests
References: <47E8C0FC.2010700@gmail.com><22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com><47E8C57C.9030708@gmail.com><22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com><47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
Message-ID: <00b601c890d2$919ac3b0$a600fea9@DMITRY>

"John Klehm" <xixsimplicityxix at gmail.com> wrote:

> The problem is that it is a mingw issue but they don't want any
> patches from wines win32 api in their mingw w32api.  They believe that
> looking at the actual ms header files taints our headers legally
> speaking.  Stefan, hans, and PaulM maintain a rather large set of
> patches against w32api.  [1]
> 
> So its a constant catchup game from when wines headers get new
> additions until someone sends paulm a patch updating the mingw w32api.

Then perhaps we (Alexandre) should reconsider the stance about using
Wine headers and import libraries in preference to mingw ones.

-- 
Dmitry.


From julliard at winehq.org  Fri Mar 28 08:35:31 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 28 Mar 2008 14:35:31 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <00b601c890d2$919ac3b0$a600fea9@DMITRY> (Dmitry Timoshkov's
	message of "Fri, 28 Mar 2008 20:52:19 +0800")
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
Message-ID: <873aqbq8d8.fsf@wine.dyndns.org>

"Dmitry Timoshkov" <dmitry at codeweavers.com> writes:

> "John Klehm" <xixsimplicityxix at gmail.com> wrote:
>
>> The problem is that it is a mingw issue but they don't want any
>> patches from wines win32 api in their mingw w32api.  They believe that
>> looking at the actual ms header files taints our headers legally
>> speaking.  Stefan, hans, and PaulM maintain a rather large set of
>> patches against w32api.  [1]
>> 
>> So its a constant catchup game from when wines headers get new
>> additions until someone sends paulm a patch updating the mingw w32api.
>
> Then perhaps we (Alexandre) should reconsider the stance about using
> Wine headers and import libraries in preference to mingw ones.

Agreed, the idea of using w32api is that we want to help improve mingw
by finding problems in their headers and libraries, but if they are not
going to accept our patches anyway, then there's clearly no point in
continuing to make our life harder by using their stuff.

-- 
Alexandre Julliard
julliard at winehq.org


From paul.vriens.wine at gmail.com  Fri Mar 28 08:41:55 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 28 Mar 2008 14:41:55 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <873aqbq8d8.fsf@wine.dyndns.org>
References: <47E8C0FC.2010700@gmail.com>	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>	<47E8C57C.9030708@gmail.com>	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>	<47EAA1C0.5050004@gmail.com>	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<873aqbq8d8.fsf@wine.dyndns.org>
Message-ID: <47ECF5A3.8090504@gmail.com>

Alexandre Julliard wrote:
> "Dmitry Timoshkov" <dmitry at codeweavers.com> writes:
> 
>> "John Klehm" <xixsimplicityxix at gmail.com> wrote:
>>
>>> The problem is that it is a mingw issue but they don't want any
>>> patches from wines win32 api in their mingw w32api.  They believe that
>>> looking at the actual ms header files taints our headers legally
>>> speaking.  Stefan, hans, and PaulM maintain a rather large set of
>>> patches against w32api.  [1]
>>>
>>> So its a constant catchup game from when wines headers get new
>>> additions until someone sends paulm a patch updating the mingw w32api.
>> Then perhaps we (Alexandre) should reconsider the stance about using
>> Wine headers and import libraries in preference to mingw ones.
> 
> Agreed, the idea of using w32api is that we want to help improve mingw
> by finding problems in their headers and libraries, but if they are not
> going to accept our patches anyway, then there's clearly no point in
> continuing to make our life harder by using their stuff.
> 

And can't we just start creating the winetest executable at winehq somewhere?

-- 
Cheers,

Paul.


From julliard at winehq.org  Fri Mar 28 08:48:42 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 28 Mar 2008 14:48:42 +0100
Subject: [PATCH 3/7] services: Start a local RPC server.
In-Reply-To: <47EBCBA4.8070504@codeweavers.com> (Robert Shearman's message of
	"Thu, 27 Mar 2008 16:30:28 +0000")
References: <47EBCBA4.8070504@codeweavers.com>
Message-ID: <87y783ot6t.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> +handle_t __RPC_USER MACHINE_HANDLEW_bind(MACHINE_HANDLEW MachineName)
> +{
> +    WCHAR transport[] = SVCCTL_TRANSPORT;
> +    WCHAR endpoint[] = SVCCTL_ENDPOINT;
> +    LPWSTR server_copy = NULL;
> +    RPC_WSTR binding_str;
> +    RPC_STATUS status;
> +    handle_t rpc_handle;
> +    
> +    /* unlike Windows we start services.exe on demand. We start it always as
> +     * checking if this is our address can be tricky */
> +    if (!check_services_exe())
> +        return NULL;

I think it would be OK to assume that services.exe is started by
wineboot and is always running, since we'll have at least the mountmgr
service running all the time.

> +/* Not the Windows event name - if needed the true one can be found in Inside Windows */
> +cpp_quote("#define SVCCTL_STARTED_EVENT (const WCHAR[]){'_','_','w','i','n','e','_','S','v','c','c','t','l','S','t','a','r','t','e','d',0}")

That's gcc-specific syntax, it would need some #ifdefs.

-- 
Alexandre Julliard
julliard at winehq.org


From fgouget at free.fr  Fri Mar 28 09:06:35 2008
From: fgouget at free.fr (Francois Gouget)
Date: Fri, 28 Mar 2008 15:06:35 +0100 (CET)
Subject: [Tools 5/6] winetest: Add statistics for the number of unit
	tests with errors or todos.
In-Reply-To: <47ECB281.4080505@gmail.com>
References: <alpine.DEB.1.00.0803262337580.10184@amboise.dolphin>
	<47ECB1FE.3020107@gmail.com> <47ECB281.4080505@gmail.com>
Message-ID: <alpine.DEB.1.00.0803281505550.26031@amboise.dolphin>

[...]
> Would this do? :
> 
> diff --git a/winetest/gather b/winetest/gather
> index 294ad06..fdacff5 100755
> --- a/winetest/gather
> +++ b/winetest/gather
> @@ -362,7 +362,7 @@ EOF
>                      "pass";
>          my $count=!$report->{todos} ? $report->{errors} :
>                    !$report->{errors} ? $report->{todos} :
> -                  "$group->{errors}+$group->{todos}";
> +                  "$report->{errors}+$report->{todos}";
> 
>          my $prcnt=!$report->{todos} ? percent($report->{errors}, $unit_count)
> :
>                    !$report->{errors} ? percent($report->{todos}, $unit_count)
> :

Yes, this patch is correct. Please, submit it to wine-patches.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
           Cahn's Axiom: When all else fails, read the instructions.


From winehacker at gmail.com  Fri Mar 28 10:25:09 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 28 Mar 2008 11:25:09 -0400
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <873aqbq8d8.fsf@wine.dyndns.org>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<873aqbq8d8.fsf@wine.dyndns.org>
Message-ID: <19e31a080803280825w3e8baf8ds42edaf0b43d60b50@mail.gmail.com>

On Fri, Mar 28, 2008 at 9:35 AM, Alexandre Julliard <julliard at winehq.org> wrote:
>  Agreed, the idea of using w32api is that we want to help improve mingw
>  by finding problems in their headers and libraries, but if they are not
>  going to accept our patches anyway, then there's clearly no point in
>  continuing to make our life harder by using their stuff.

Thank you!

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From juan.lang at gmail.com  Fri Mar 28 10:49:46 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 28 Mar 2008 08:49:46 -0700
Subject: [2/2] [try 2] Setupapi patch
Message-ID: <3a768c550803280849p4e745fb2h8fc299dd069b2798@mail.gmail.com>

Hi Alexander,

> Changelog:
> 1 - Creating device interface keys in registry as in Windows XP
> 2 - Creating DeviceInstance value in registry
> 3 - Creating SymbolicLink value in registry as in Windows XP
> 4 - SETUPDI_AddDeviceToSet: changing pointers on SP_DEVINFO_DATA after
> allocating new memory block for their array

One fix per patch, please.
--Juan


From paul.vriens.wine at gmail.com  Fri Mar 28 10:52:09 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 28 Mar 2008 16:52:09 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <877ifnqi4h.fsf@wine.dyndns.org>
References: <47E8C0FC.2010700@gmail.com>	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>	<47E8C57C.9030708@gmail.com>	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>	<47EAA1C0.5050004@gmail.com>	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<877ifnqi4h.fsf@wine.dyndns.org>
Message-ID: <47ED1429.6040308@gmail.com>

Alexandre Julliard wrote:
> "John Klehm" <xixsimplicityxix at gmail.com> writes:
> 
>> P.S. I logged some test results from my win2k machine, it seems they
>> are at [5].  Seems like I missed some setting though as the date is
>> not right.  Advice on how to fix that would be delicious =)
> 
> It's now using the git commit sha1 instead of a date when building from
> a git tree, that's a feature. I'm hoping we can standardize on that to
> make sure all test runs properly identify the exact source used.
> 

Wouldn't it be nicer to have something like:

0.9.58-06d429d6b6b6d63beaeda130a3bb261ef3b9fb41

Just a thought? The SHA's itself are not very pleasant for the eye. With the 
above you can at least group them visually.

-- 
Cheers,

Paul.


From juan.lang at gmail.com  Fri Mar 28 10:57:16 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 28 Mar 2008 08:57:16 -0700
Subject: Implement VBScript for Google Summer of Code
In-Reply-To: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
References: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
Message-ID: <3a768c550803280857o15d6546au64b95a6ce3929fff@mail.gmail.com>

Hi Jim,

>  I have this idea of implementing vbscript.dll for Google SoC. Any
>  comment would be appreciated before I start working on my proposal.

That sounds ambitious, but you're welcome to try!

>  For a few years I used to hack VB, and I know the
>  language and VBScript is just a cousin of VB. The runtime library is
>  not big, and writing it shouldn't take too much time either.

If you say so ;-)

>  I think the hardest part would be to implement the COM interfaces that
>  deal with scripting. And that's the area I know least about.

The recently added jscript stubs are probably a decent place to start.
 Getting yourself familiar with COM is probably important to the
success of your project.  I'd recommend a copy of Don Box's Essential
Com as the best way to "get" COM in a hurry.  There are plenty of
online references too, of course.

One general point is that people often don't plan for the amount of
time needed to get patches accepted--it's often more than people
realize.  You might start by trying to get a stub DLL for vbscript
accepted, just to get the hang of the development process.  Check out
the git tree, build it, make some changes, commit to it, and send the
patches in.  You'll find instructions on how to do all that on the
wiki.

Looking forward to seeing your application.  Good luck,
--Juan


From julliard at winehq.org  Fri Mar 28 11:16:32 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 28 Mar 2008 17:16:32 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47ED1429.6040308@gmail.com> (Paul Vriens's message of "Fri, 28
	Mar 2008 16:52:09 +0100")
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<877ifnqi4h.fsf@wine.dyndns.org> <47ED1429.6040308@gmail.com>
Message-ID: <87iqz6q0wv.fsf@wine.dyndns.org>

Paul Vriens <paul.vriens.wine at gmail.com> writes:

> Wouldn't it be nicer to have something like:
>
> 0.9.58-06d429d6b6b6d63beaeda130a3bb261ef3b9fb41
>
> Just a thought? The SHA's itself are not very pleasant for the
> eye. With the above you can at least group them visually.

Presentation issues should be separate from the actual id. Once all
builds are using SHA1 we can do a lot of fancy stuff in how we display
them.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Mar 28 11:22:14 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 28 Mar 2008 17:22:14 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <47ECF5A3.8090504@gmail.com> (Paul Vriens's message of "Fri, 28
	Mar 2008 14:41:55 +0100")
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<873aqbq8d8.fsf@wine.dyndns.org> <47ECF5A3.8090504@gmail.com>
Message-ID: <878x02q0nd.fsf@wine.dyndns.org>

Paul Vriens <paul.vriens.wine at gmail.com> writes:

> And can't we just start creating the winetest executable at winehq somewhere?

We probably can, but how would this help?

-- 
Alexandre Julliard
julliard at winehq.org


From paul.vriens.wine at gmail.com  Fri Mar 28 11:26:21 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 28 Mar 2008 17:26:21 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <878x02q0nd.fsf@wine.dyndns.org>
References: <47E8C0FC.2010700@gmail.com>	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>	<47E8C57C.9030708@gmail.com>	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>	<47EAA1C0.5050004@gmail.com>	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>	<00b601c890d2$919ac3b0$a600fea9@DMITRY>	<873aqbq8d8.fsf@wine.dyndns.org>
	<47ECF5A3.8090504@gmail.com> <878x02q0nd.fsf@wine.dyndns.org>
Message-ID: <47ED1C2D.20005@gmail.com>

Alexandre Julliard wrote:
> Paul Vriens <paul.vriens.wine at gmail.com> writes:
> 
>> And can't we just start creating the winetest executable at winehq somewhere?
> 
> We probably can, but how would this help?
> 

It wouldn't help as we will face the same issues. It's just that it seems more 
logical to create this where multiple resources have access in case there are 
issues.

We need a place where people can download the latest winetest executable and in 
the past it has been proven difficult to have it available all the time. Despite 
the excellent work that Paul Millar (and of course Hans and Stefan) is doing.

So having this at winehq has nothing to do with fixing this particular issue.

-- 
Cheers,

Paul.


From rob at codeweavers.com  Fri Mar 28 11:52:53 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 28 Mar 2008 16:52:53 +0000
Subject: [PATCH 3/7] services: Start a local RPC server.
In-Reply-To: <87y783ot6t.fsf@wine.dyndns.org>
References: <47EBCBA4.8070504@codeweavers.com> <87y783ot6t.fsf@wine.dyndns.org>
Message-ID: <47ED2265.5000103@codeweavers.com>

Alexandre Julliard wrote:
> Robert Shearman <rob at codeweavers.com> writes:
>
>   
>> +handle_t __RPC_USER MACHINE_HANDLEW_bind(MACHINE_HANDLEW MachineName)
>> +{
>> +    WCHAR transport[] = SVCCTL_TRANSPORT;
>> +    WCHAR endpoint[] = SVCCTL_ENDPOINT;
>> +    LPWSTR server_copy = NULL;
>> +    RPC_WSTR binding_str;
>> +    RPC_STATUS status;
>> +    handle_t rpc_handle;
>> +    
>> +    /* unlike Windows we start services.exe on demand. We start it always as
>> +     * checking if this is our address can be tricky */
>> +    if (!check_services_exe())
>> +        return NULL;
>>     
>
> I think it would be OK to assume that services.exe is started by
> wineboot and is always running, since we'll have at least the mountmgr
> service running all the time.
>   

I'm not sure that is a valid assumption, as we could have an option to 
disable wineboot in the future due to performance reasons.

>> +/* Not the Windows event name - if needed the true one can be found in Inside Windows */
>> +cpp_quote("#define SVCCTL_STARTED_EVENT (const WCHAR[]){'_','_','w','i','n','e','_','S','v','c','c','t','l','S','t','a','r','t','e','d',0}")
>>     
>
> That's gcc-specific syntax, it would need some #ifdefs.

Well spotted. I'll fix that.

-- 
Rob Shearman



From rob at codeweavers.com  Fri Mar 28 12:02:05 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 28 Mar 2008 17:02:05 +0000
Subject: amstream: IMediaStream::GetMultiMediaStream
In-Reply-To: <47EC3C4A.4000908@gmail.com>
References: <47EC3C4A.4000908@gmail.com>
Message-ID: <47ED248D.1040402@codeweavers.com>

Nikolay Sivov wrote:
> @@ -109,9 +109,14 @@
>  {
>      IMediaStreamImpl *This = (IMediaStreamImpl *)iface;
>  
> -    FIXME("(%p/%p)->(%p) stub!\n", This, iface, ppMultiMediaStream); 
> +    TRACE("(%p/%p)->(%p)\n", This, iface, ppMultiMediaStream);
>  
> -    return S_FALSE;
> +    if(!(*ppMultiMediaStream))
> +        return E_POINTER;
> +
> +    *ppMultiMediaStream = This->Parent;
> +
> +    return S_OK;
>  }
>   

Although I haven't looked at the context, you also likely need to add a 
reference to the returned COM object here.

-- 
Rob Shearman



From julliard at winehq.org  Fri Mar 28 12:38:16 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 28 Mar 2008 18:38:16 +0100
Subject: [PATCH 3/7] services: Start a local RPC server.
In-Reply-To: <47ED2265.5000103@codeweavers.com> (Robert Shearman's message of
	"Fri, 28 Mar 2008 16:52:53 +0000")
References: <47EBCBA4.8070504@codeweavers.com>
	<87y783ot6t.fsf@wine.dyndns.org> <47ED2265.5000103@codeweavers.com>
Message-ID: <874paqpx4n.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> I'm not sure that is a valid assumption, as we could have an option to
> disable wineboot in the future due to performance reasons.

I don't think we want to support that. On the contrary, we want to move
more of the startup processing that we currently do for every process
into wineboot, so that it is done only once per session. This requires
that we can guarantee that wineboot is always executed.

We may of course make some of the more expensive parts of wineboot
optional, but starting services.exe shouldn't be in the expensive
category (and if it is that should be fixed).

-- 
Alexandre Julliard
julliard at winehq.org


From htl10 at users.sourceforge.net  Fri Mar 28 13:12:15 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Fri, 28 Mar 2008 18:12:15 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <015b01c88fc0$edbdc970$a600fea9@DMITRY>
Message-ID: <20080328181219.34725.qmail@web23101.mail.ird.yahoo.com>

--- On Thu, 27/3/08, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> "Vitaliy Margolen" <wine-devel at kievinfo.com>
> wrote:
> 
> > Looks like a time to start blacklisting fonts then. If
> the font is invalid 
> > and does not work even on windows yet it is available
> in the system - that's 
> > the only thing Wine can do. Or just contact all
> distros to remove it. Or 
> > request packagers to refuse installing Wine if said
> font found in the system.
> 
> Black listing the fonts is not an appropriate
> fix/workaround. There is
> already a fixed version of ukai.ttf, and a broken one was
> causing problems
> in a lot of native programs besides Wine.

I think blacklisting is not a good approach - what one wants is really "white-listing": 
given microsoft only ships a certain number of fonts, wine should provide emulation/substitutions of *only* those fonts fron known open-source alternatives,
rather than expose the whole of fontconfig-available fonts to win32 applications.
And applications should only expect to get those known MS fonts (or clones/substitutes).

OTOH, ukai (or one of its Arphic derivative sibings) is fairly critical for most 
chinese-reading person :-). 

I am not sure "There is a fixed version of ukai" - from the codeweaver wiki and freedesktop's web site, I have the latest ukai release via redhat, and the wiki seems 
to suggests a non-debian mod older ukai to replace a debian-modified one. 
So my finger-pointing tendency would say that somehow a debian ukai modification which breaks gdiplus has got into freedesktop uptream... 


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Inbox http://uk.docs.yahoo.com/nowyoucan.html


From winehacker at gmail.com  Fri Mar 28 13:27:03 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 28 Mar 2008 14:27:03 -0400
Subject: SoC idea: enhance the Program Manager, winefile and friends
Message-ID: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>

Hi All,

From thestig at google.com  Fri Mar 28 13:31:41 2008
From: thestig at google.com (Lei Zhang)
Date: Fri, 28 Mar 2008 11:31:41 -0700
Subject: gdi32-related commit between 0.9.57<->0.9.58broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <20080328181219.34725.qmail@web23101.mail.ird.yahoo.com>
References: <015b01c88fc0$edbdc970$a600fea9@DMITRY>
	<20080328181219.34725.qmail@web23101.mail.ird.yahoo.com>
Message-ID: <558b2f5c0803281131m274f7d3ya2a61a5f81d08d10@mail.gmail.com>

On Fri, Mar 28, 2008 at 11:12 AM, Hin-Tak Leung
<htl10 at users.sourceforge.net> wrote:
>  I think blacklisting is not a good approach - what one wants is really "white-listing":
>  given microsoft only ships a certain number of fonts, wine should provide emulation/substitutions of *only* those fonts fron known open-source alternatives,
>  rather than expose the whole of fontconfig-available fonts to win32 applications.
>  And applications should only expect to get those known MS fonts (or clones/substitutes).

Umm, I have friends who are font fanatics that have thousands of fonts
installed on their system. If they can do that on Windows, they
certainly should be able to do that on Linux. Are you suggesting we a)
limit ourselves to only support what ships with Windows, and ignore
all other fonts out there, or b) create a white list for every known
font out there?

>  OTOH, ukai (or one of its Arphic derivative sibings) is fairly critical for most
>  chinese-reading person :-).
>
>  I am not sure "There is a fixed version of ukai" - from the codeweaver wiki and freedesktop's web site, I have the latest ukai release via redhat, and the wiki seems
>  to suggests a non-debian mod older ukai to replace a debian-modified one.
>  So my finger-pointing tendency would say that somehow a debian ukai modification which breaks gdiplus has got into freedesktop uptream...

AFAIK, the bad version of the ukai font is 20060928. It shiped with
Ubuntu Feisty [1], Gutsy [2], and FC 8 [3]. Possibly with other
distros as well, I have not done an exhaustive search. Just don't use
that version and you should be fine.

[1] http://packages.ubuntu.com/feisty/ttf-arphic-ukai
[2] http://packages.ubuntu.com/gutsy/ttf-arphic-ukai
[3] http://rpm.pbone.net/index.php3/stat/4/idpl/5312345/com/cjkunifonts-ukai-0.1.20060928-4.fc8.noarch.rpm.html


From msclrhd at googlemail.com  Fri Mar 28 08:35:07 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Fri, 28 Mar 2008 13:35:07 +0000
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <00b601c890d2$919ac3b0$a600fea9@DMITRY>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
Message-ID: <3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>

On 28/03/2008, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> "John Klehm" <xixsimplicityxix at gmail.com> wrote:
>
> > The problem is that it is a mingw issue but they don't want any
>  > patches from wines win32 api in their mingw w32api.  They believe that
>  > looking at the actual ms header files taints our headers legally
>  > speaking.  Stefan, hans, and PaulM maintain a rather large set of
>  > patches against w32api.  [1]
>  >
>  > So its a constant catchup game from when wines headers get new
>  > additions until someone sends paulm a patch updating the mingw w32api.
>
> Then perhaps we (Alexandre) should reconsider the stance about using
>  Wine headers and import libraries in preference to mingw ones.

I would have expected that when building for mingw, Wine would use the
Wine headers and libraries. Otherwise, as mentioned above, if someone
adds tests that rely on items that are not in the mingw headers then
the tests will not be built for the conformance tests, as has been
seen recently. Also, what happens with the widl generated headers?

- Reece


From winehacker at gmail.com  Fri Mar 28 13:53:49 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 28 Mar 2008 14:53:49 -0400
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
Message-ID: <19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>

On Fri, Mar 28, 2008 at 9:35 AM, Reece Dunn <msclrhd at googlemail.com> wrote:
>  I would have expected that when building for mingw, Wine would use the
>  Wine headers and libraries. Otherwise, as mentioned above, if someone
>  adds tests that rely on items that are not in the mingw headers then
>  the tests will not be built for the conformance tests, as has been
>  seen recently. Also, what happens with the widl generated headers?

We have always depended on the w32api package for the tests and
programs partly to make sure our own code is sane by having another
coverage point like building with the MSVC headers when compiling on
MSVC. Dmitry and I have disagreed with this for years though because
the mingw w32api maintainers can be a real PITA about getting patches
in and also because of the breakages that result when something is
missing like you mention. Switching to a using the wine headers and
import libs everywhere is long overdue and welcome!

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From truiken at gmail.com  Fri Mar 28 14:01:22 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 28 Mar 2008 14:01:22 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
	<19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>
Message-ID: <22821af30803281201m61f97a09g50ab810d0d73b60e@mail.gmail.com>

On Fri, Mar 28, 2008 at 1:53 PM, Steven Edwards <winehacker at gmail.com> wrote:
> On Fri, Mar 28, 2008 at 9:35 AM, Reece Dunn <msclrhd at googlemail.com> wrote:
>  >  I would have expected that when building for mingw, Wine would use the
>  >  Wine headers and libraries. Otherwise, as mentioned above, if someone
>  >  adds tests that rely on items that are not in the mingw headers then
>  >  the tests will not be built for the conformance tests, as has been
>  >  seen recently. Also, what happens with the widl generated headers?
>
>  We have always depended on the w32api package for the tests and
>  programs partly to make sure our own code is sane by having another
>  coverage point like building with the MSVC headers when compiling on
>  MSVC. Dmitry and I have disagreed with this for years though because
>  the mingw w32api maintainers can be a real PITA about getting patches
>  in and also because of the breakages that result when something is
>  missing like you mention. Switching to a using the wine headers and
>  import libs everywhere is long overdue and welcome!
>

What is the process for making this switch?  Do we need to contact
Paul Millar?  The lack of a new winetest is putting a hamper on our
efforts to fix up the tests in Windows.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Fri Mar 28 14:08:30 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 28 Mar 2008 12:08:30 -0700
Subject: Implement VBScript for Google Summer of Code
In-Reply-To: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
References: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
Message-ID: <b130c85e0803281208h544d526ft574b73e80020e596@mail.gmail.com>

Hi Jim,

2008/3/27, Jim Chen <jim at darchons.net>:
> Hi everyone,
>
>  I have this idea of implementing vbscript.dll for Google SoC. Any
>  comment would be appreciated before I start working on my proposal.
>
>  The reason for implementing vbscript.dll is because right now there's
>  nothing in the trunk about it. jscript.dll has a stub, but
>  vbscript.dll doesn't, and it's an area that I think I can work on.
>  VBScript is used by the Windows Installer, can be potentially be used
>  for DirectMusic script (from http://wiki.winehq.org/DirectX-ToDo), and
>  some applications use it.
>
>  Just the core language/runtime (vbscript.dll) is implemented, no extra
>  COM/OLE objects such as FSO (file system object), etc. (unless I have
>  time). The language by itself is designed to be simple and easy, so an
>  interpreter shouldn't be hard. I wrote a C-style script interpreter in
>  Java this past year. For a few years I used to hack VB, and I know the
>  language and VBScript is just a cousin of VB. The runtime library is
>  not big, and writing it shouldn't take too much time either.
>
>  I think the hardest part would be to implement the COM interfaces that
>  deal with scripting. And that's the area I know least about.
I don't know if you could do all of it in 3 months, what if it takes
longer, would you still be interested in continuing work on it? COM
isn't that hard, if you run into troubles with it a lot of wine
developers know about it, and there are a lot of good com examples in
the wine code.

Cheers,
Maarten.


From wine.dev at web.de  Fri Mar 28 14:19:56 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Fri, 28 Mar 2008 20:19:56 +0100
Subject: DLL exports... HELP?! (wine based win32 printer drivers for
	openprinting)
In-Reply-To: <494035.78583.qm@web23110.mail.ird.yahoo.com>
References: <494035.78583.qm@web23110.mail.ird.yahoo.com>
Message-ID: <1206731997.8726.19.camel@p4>

On Mi, 2008-03-26 at 14:47 +0000, Hin-Tak Leung wrote:
> Wow :-). I have almost wanted to suggest such a native wine-based
> printer driver 
> as a linux foundation/openprinting GOSC project (I am one of the
> mentors under the
> openprinting umbrella
> https://www.linux-foundation.org/en/Google_Summer_of_Code). 
> I am glad I didn't :-).
> 

I'm away for the weekend, but some quick notes:

- The ddiwrapper-hack works only with a very small amount of
  self-contained drivers
- Most Drivers today are plugins for the unidrv or the pscipt5 Driver
  (you can install pscript5 from Adobe since ~ 1/2 Year)
- Drivers expect dlls, that are not present in wine-2005*
  (They will not load)
- Rendering with full Drivers (Raster-Mode) need most Eng* Functions
  and Friends (This is the DIB-Engine).
- Rendering with full Drivers (Postscript) need some Eng* Functions
  and Friends.
  Nothing in this Area is implemented / exported in current Wine:
  Driver will not load
- Sending the rendered Data to the Printer need sometimes a vendor-
  specific Portmonitor / Languagemonitor
  (Not supported in current Wine)



-- 
 
By by ... Detlef




From winehacker at gmail.com  Fri Mar 28 14:22:53 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 28 Mar 2008 15:22:53 -0400
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <22821af30803281201m61f97a09g50ab810d0d73b60e@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<22821af30803250217t702d8cd7if98959c80e236b47@mail.gmail.com>
	<47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
	<19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>
	<22821af30803281201m61f97a09g50ab810d0d73b60e@mail.gmail.com>
Message-ID: <19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>

On Fri, Mar 28, 2008 at 3:01 PM, James Hawkins <truiken at gmail.com> wrote:
>  What is the process for making this switch?  Do we need to contact
>  Paul Millar?  The lack of a new winetest is putting a hamper on our
>  efforts to fix up the tests in Windows.

There should just be a few rules that need to be changed as far as I
know. Thats all that was needed for the programs case, I cannot Imagen
why the tests would be any more complex. If Alexandre has not already
done so, I'll look at it and submit patches tonight.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From jacek at codeweavers.com  Fri Mar 28 15:11:37 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Fri, 28 Mar 2008 20:11:37 +0000
Subject: Implement VBScript for Google Summer of Code
In-Reply-To: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
References: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
Message-ID: <47ED50F9.50208@codeweavers.com>

Jim Chen wrote:
> Hi everyone,
>
> I have this idea of implementing vbscript.dll for Google SoC. Any
> comment would be appreciated before I start working on my proposal.
>   
It would be great to have vbscript.dll implemented in Wine and I hope 
that some day we will have it, but I think you underestimate amount of 
work on it. It's a much bigger task than the usual SoC projects, IMO. 
Please do some research before deciding to work on it. I've found Eric 
Lippert's blog very useful for information about active scripts
http://blogs.msdn.com/ericlippert/default.aspx
esp. the archive from 2004. If you'll decide to apply for this project, 
please describe it well enough so we know that you can accomplish it.


Jacek


From leslie_alistair at hotmail.com  Fri Mar 28 15:16:47 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Sat, 29 Mar 2008 07:16:47 +1100
Subject: mscoree: Add missing interfaces
References: <fsg1am$7ip$1@ger.gmane.org>
Message-ID: <fsjjmn$h8s$1@ger.gmane.org>

"Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote in message 
news:fsg1am$7ip$1 at ger.gmane.org...
> Hi,
>
> Changelog:
> mscoree: Add missing interfaces
>
Anything wrong with this patch?

Best Regards
 Alistair Leslie-Hughes 




From juan.lang at gmail.com  Fri Mar 28 15:18:03 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 28 Mar 2008 13:18:03 -0700
Subject: SoC idea: enhance the Program Manager, winefile and friends
In-Reply-To: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
Message-ID: <3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>

>  From time to time the discussion comes up about having some sort of
>  Window manager or explorer replacement for when running in Desktop
>  mode.

Personally, I think enhancing explorer to have its own GUI (rather
than launching winefile) would be an interesting project.  If nothing
else, having a graphical way to explore the shell namespace might be
handy for debugging shell issues.  From there to an explorer for
desktop mode might not be such a big leap.

--Juan


From brian.vincent at gmail.com  Fri Mar 28 15:39:59 2008
From: brian.vincent at gmail.com (Brian Vincent)
Date: Fri, 28 Mar 2008 14:39:59 -0600
Subject: SoC idea: enhance the Program Manager, winefile and friends
In-Reply-To: <3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
Message-ID: <3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>

Hasn't someone else somewhere in the world already written an explorer
replacement and we could just get them to open source it so we can
include it with Wine?  No need to reinvent the wheel.

-Brian

On Fri, Mar 28, 2008 at 2:18 PM, Juan Lang <juan.lang at gmail.com> wrote:
> >  From time to time the discussion comes up about having some sort of
>  >  Window manager or explorer replacement for when running in Desktop
>  >  mode.
>
>  Personally, I think enhancing explorer to have its own GUI (rather
>  than launching winefile) would be an interesting project.  If nothing
>  else, having a graphical way to explore the shell namespace might be
>  handy for debugging shell issues.  From there to an explorer for
>  desktop mode might not be such a big leap.
>
>  --Juan
>
>
>


From juan.lang at gmail.com  Fri Mar 28 15:40:51 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 28 Mar 2008 13:40:51 -0700
Subject: SoC idea: enhance the Program Manager, winefile and friends
In-Reply-To: <3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
	<3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>
Message-ID: <3a768c550803281340m398fd884mf381980d5a3220cc@mail.gmail.com>

> Hasn't someone else somewhere in the world already written an explorer
>  replacement and we could just get them to open source it so we can
>  include it with Wine?  No need to reinvent the wheel.

There's the ReactOS one, but it's written in C++.  I don't know of any
ANSI C ones, but maybe I haven't looked hard enough.
--Juan


From austinenglish at gmail.com  Fri Mar 28 15:50:53 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 28 Mar 2008 15:50:53 -0500
Subject: SoC idea: enhance the Program Manager, winefile and friends
In-Reply-To: <3a768c550803281340m398fd884mf381980d5a3220cc@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
	<3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>
	<3a768c550803281340m398fd884mf381980d5a3220cc@mail.gmail.com>
Message-ID: <b6bb06270803281350h676c3334h238fd9cd4047696c@mail.gmail.com>

On Fri, Mar 28, 2008 at 3:40 PM, Juan Lang <juan.lang at gmail.com> wrote:
> > Hasn't someone else somewhere in the world already written an explorer
>  >  replacement and we could just get them to open source it so we can
>  >  include it with Wine?  No need to reinvent the wheel.
>
>  There's the ReactOS one, but it's written in C++.  I don't know of any
>  ANSI C ones, but maybe I haven't looked hard enough.
>  --Juan
>
>
>

http://www.google.com/search?q=windows+explorer+replacement&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a

List of windows explorer replacements:
http://gladiator-antivirus.com/forum/index.php?showtopic=50712&pid=167091&mode=threaded&show=&st=&

Here's direct links to a few I found:
http://www.xyplorer.com/index.htm
http://mustangpeak.net/
http://www.download32.com/directory-opus-i30453.html
http://www.explorerxp.com/
http://www.discount-softwares.com/soft/Utility/File_Disk_Management/9079_universal_explorer.htm

There's even an open source one (in visual basic though, bleh)
http://sourceforge.net/projects/pc-viewer


From juan.lang at gmail.com  Fri Mar 28 15:54:31 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 28 Mar 2008 13:54:31 -0700
Subject: SoC idea: enhance the Program Manager, winefile and friends
In-Reply-To: <b6bb06270803281350h676c3334h238fd9cd4047696c@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
	<3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>
	<3a768c550803281340m398fd884mf381980d5a3220cc@mail.gmail.com>
	<b6bb06270803281350h676c3334h238fd9cd4047696c@mail.gmail.com>
Message-ID: <3a768c550803281354x538b5381tde13d17a0ae297@mail.gmail.com>

>  http://www.google.com/search?q=windows+explorer+replacement&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a

Um.. yeah, I've heard of google, thanks.  How many are written in ANSI C?

Find me one of those, and I'll retract my suggestion as a SoC project.
 My suggestion is moot unless someone actually applies to do that
though.
--Juan


From stefan at codeweavers.com  Fri Mar 28 16:25:53 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 28 Mar 2008 22:25:53 +0100
Subject: wined3d: Improve detection of device palette change.
In-Reply-To: <47ED4833.3060609@inbox.lv>
References: <47ED4833.3060609@inbox.lv>
Message-ID: <200803282225.53467.stefan@codeweavers.com>

Am Freitag, 28. M?rz 2008 20:34:11 schrieb Alexander Dorofeyev:
>      ENTER_GL();
> +    if (This->resource.format == WINED3DFMT_P8 || This->resource.format == 
> WINED3DFMT_A8P8) {
> +         for (i = 0; i < This->baseTexture.levels; i++) {
> +            if(palette9_changed((IWineD3DSurfaceImpl *)This->surfaces[i])){
Why are you doing this inside ENTER_GL? I think LoadLocation locks on its own.


From stefan at codeweavers.com  Fri Mar 28 16:25:53 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 28 Mar 2008 22:25:53 +0100
Subject: wined3d: Improve detection of device palette change.
In-Reply-To: <47ED4833.3060609@inbox.lv>
References: <47ED4833.3060609@inbox.lv>
Message-ID: <200803282225.53467.stefan@codeweavers.com>

Am Freitag, 28. M?rz 2008 20:34:11 schrieb Alexander Dorofeyev:
>      ENTER_GL();
> +    if (This->resource.format == WINED3DFMT_P8 || This->resource.format == 
> WINED3DFMT_A8P8) {
> +         for (i = 0; i < This->baseTexture.levels; i++) {
> +            if(palette9_changed((IWineD3DSurfaceImpl *)This->surfaces[i])){
Why are you doing this inside ENTER_GL? I think LoadLocation locks on its own.


From xixsimplicityxix at gmail.com  Fri Mar 28 16:45:18 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 28 Mar 2008 16:45:18 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com> <47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
	<19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>
	<22821af30803281201m61f97a09g50ab810d0d73b60e@mail.gmail.com>
	<19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
Message-ID: <78a7dad00803281445y7f357b25t114057370cbfcbfd@mail.gmail.com>

On Fri, Mar 28, 2008 at 2:22 PM, Steven Edwards <winehacker at gmail.com> wrote:
> On Fri, Mar 28, 2008 at 3:01 PM, James Hawkins <truiken at gmail.com> wrote:
>  >  What is the process for making this switch?  Do we need to contact
>  >  Paul Millar?  The lack of a new winetest is putting a hamper on our
>  >  efforts to fix up the tests in Windows.
>
>  There should just be a few rules that need to be changed as far as I
>  know. Thats all that was needed for the programs case, I cannot Imagen
>  why the tests would be any more complex. If Alexandre has not already
>  done so, I'll look at it and submit patches tonight.
>

Winetest with todays git [1]

John

[1] http://klehm.net/wine/20080328-winetest-438868f37796e387cd6f6db5da1f73a7017b6e00.exe


From alexd4 at inbox.lv  Fri Mar 28 16:37:32 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Fri, 28 Mar 2008 23:37:32 +0200
Subject: wined3d: Improve detection of device palette change.
In-Reply-To: <200803282225.53467.stefan@codeweavers.com>
References: <47ED4833.3060609@inbox.lv>
	<200803282225.53467.stefan@codeweavers.com>
Message-ID: <47ED651C.9090805@inbox.lv>

Hi.

I just put it nearby other somewhat related calls. This code doesn't really need 
ENTER_GL/LEAVE_GL, but there's a bigger problem that this ENTER_GL/LEAVE_GL in 
PreLoad is around other routines too that mostly don't need it and leads to 
ActivateContext being called inside it etc. I've already sent a patch to remove 
ENTER_GL/LEAVE_GL in PreLoad, but it wasn't fully ok. I plan to fix and resend 
the latter patch after issues are taken care of (a bit of lack of consistency 
with holding / not-holding the lock in LoadLocation and its helper routines).

Stefan D?singer wrote:
> Am Freitag, 28. M?rz 2008 20:34:11 schrieb Alexander Dorofeyev:
>>      ENTER_GL();
>> +    if (This->resource.format == WINED3DFMT_P8 || This->resource.format == 
>> WINED3DFMT_A8P8) {
>> +         for (i = 0; i < This->baseTexture.levels; i++) {
>> +            if(palette9_changed((IWineD3DSurfaceImpl *)This->surfaces[i])){
> Why are you doing this inside ENTER_GL? I think LoadLocation locks on its own.



From a_villacis at palosanto.com  Fri Mar 28 17:13:40 2008
From: a_villacis at palosanto.com (=?ISO-8859-1?Q?Alex_Villac=ED=ADs_Lasso?=)
Date: Fri, 28 Mar 2008 17:13:40 -0500
Subject: winex11.drv: Don't add owned windows to the taskbar
In-Reply-To: <000f01c88ef6$21f7dc10$a600fea9@DMITRY>
References: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com>	<47E95728.8090202@inbox.lv>
	<000f01c88ef6$21f7dc10$a600fea9@DMITRY>
Message-ID: <47ED6D94.3090403@palosanto.com>

Dmitry Timoshkov escribio':
> "Alexander Dorofeyev" <alexd4 at inbox.lv> wrote:
>
>   
>> There's a regression in IDA Pro disassembler. Nothing is added to the taskbar at 
>> all, furthermore, when you are starting debugger, before there was a window 
>> appearing that asks pass control to the application or not. Now it's not 
>> appearing, and can't be found because there's nothing on the taskbar, which is 
>> pretty bad because the app doesn't respond to any other input at that moment. 
>> Minimizing  the main window makes the app disappear altogether, so it's pretty 
>> unusable.
>>     
>
> The problem with IDA is that the button you see in the Windows task bar
> does not belong to the main IDA window, it belongs to a zero sized visible
> window with the same caption. Since it's zero sized Wine doesn't map it all.
> So, while formally it's a regression, technically it's not: main IDA window
> has never been added to the task bar before my patch. This all can be easily
> discovered with spy++ and a simple test app.
>
>   
This also affects many, if not all, VB6 applications (and possibly many 
Delphi applications). Personally, I consider this a rather serious 
regression and propose backing out of commit 
cb3ff54789c652b02d852f40db71cafd9fd67ca9 as a fix.

BTW, this reminds me of bug 1598. If the explanation of the bug for IDA 
above is correct, then the "buggy" behavior of not assigning 
minimize/maximize buttons to the window that appears in the panel is 
sort of consistent with this regression. Maybe the behavior should be 
that visible windows owned by an invisible window should get mapped in 
the panel.

-- 
perl -e '$x=2.4;print sprintf("%.0f + %.0f = %.0f\n",$x,$x,$x+$x);'



From stefan at codeweavers.com  Fri Mar 28 17:39:04 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 28 Mar 2008 23:39:04 +0100
Subject: wined3d: Improve detection of device palette change.
In-Reply-To: <47ED651C.9090805@inbox.lv>
References: <47ED4833.3060609@inbox.lv>
	<200803282225.53467.stefan@codeweavers.com>
	<47ED651C.9090805@inbox.lv>
Message-ID: <200803282339.04546.stefan@codeweavers.com>

Am Freitag, 28. M?rz 2008 22:37:32 schrieb Alexander Dorofeyev:
> Hi.
>
> I just put it nearby other somewhat related calls. This code doesn't really
> need ENTER_GL/LEAVE_GL, but there's a bigger problem that this
> ENTER_GL/LEAVE_GL in PreLoad is around other routines too that mostly don't
> need it and leads to ActivateContext being called inside it etc. I've
> already sent a patch to remove ENTER_GL/LEAVE_GL in PreLoad, but it wasn't
> fully ok. I plan to fix and resend the latter patch after issues are taken
> care of (a bit of lack of consistency with holding / not-holding the lock
> in LoadLocation and its helper routines).
Ok, I am fine with this patch if the ENTER_GL/LEAVE_GL stuff needs a different 
fix anyway





From bunglehead at gmail.com  Fri Mar 28 19:15:31 2008
From: bunglehead at gmail.com (Nikolay Sivov)
Date: Sat, 29 Mar 2008 03:15:31 +0300
Subject: [Fwd: gdi32: PlgBlt implementation (resend)]
Message-ID: <47ED8A23.2070606@gmail.com>

What about this patch?

> Changelog (since first patch):
>     - HAVE_FLOAT_H used for #include
>     - all declarations moved to the beginning


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: bitblt.c.patch3
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080329/ea4815b1/attachment.txt 

From jim at darchons.net  Fri Mar 28 19:15:52 2008
From: jim at darchons.net (Jim Chen)
Date: Fri, 28 Mar 2008 20:15:52 -0400
Subject: Implement VBScript for Google Summer of Code
In-Reply-To: <b130c85e0803281208h544d526ft574b73e80020e596@mail.gmail.com>
References: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
	<b130c85e0803281208h544d526ft574b73e80020e596@mail.gmail.com>
Message-ID: <8133cc9f0803281715v1a4b29fdk46ede3a7644cc585@mail.gmail.com>

On Fri, Mar 28, 2008 at 3:08 PM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Hi Jim,
>
>  2008/3/27, Jim Chen <jim at darchons.net>:
>
>
> > Hi everyone,
>  >
>  >  I have this idea of implementing vbscript.dll for Google SoC. Any
>  >  comment would be appreciated before I start working on my proposal.
>  >
>  >  The reason for implementing vbscript.dll is because right now there's
>  >  nothing in the trunk about it. jscript.dll has a stub, but
>  >  vbscript.dll doesn't, and it's an area that I think I can work on.
>  >  VBScript is used by the Windows Installer, can be potentially be used
>  >  for DirectMusic script (from http://wiki.winehq.org/DirectX-ToDo), and
>  >  some applications use it.
>  >
>  >  Just the core language/runtime (vbscript.dll) is implemented, no extra
>  >  COM/OLE objects such as FSO (file system object), etc. (unless I have
>  >  time). The language by itself is designed to be simple and easy, so an
>  >  interpreter shouldn't be hard. I wrote a C-style script interpreter in
>  >  Java this past year. For a few years I used to hack VB, and I know the
>  >  language and VBScript is just a cousin of VB. The runtime library is
>  >  not big, and writing it shouldn't take too much time either.
>  >
>  >  I think the hardest part would be to implement the COM interfaces that
>  >  deal with scripting. And that's the area I know least about.
>  I don't know if you could do all of it in 3 months, what if it takes
>  longer, would you still be interested in continuing work on it? COM
>  isn't that hard, if you run into troubles with it a lot of wine
>  developers know about it, and there are a lot of good com examples in
>  the wine code.
>
>  Cheers,
>  Maarten.
>

Of course, if I end up doing it I will finish it till it's done. Isn't
that one of GSoC's purposes, to stay involved even after the program
ends? But obviously I still need to accomplish things during the
program so that's why I'm still doing research on it, to see how much
time I might need to get at least something done. I'm OK with the
basic COM stuff. IUnknown doesn't scar  e me :) But for more advanced
stuff, I'm sure I'll need to ask around.

Thanks!
Jim


From jim at darchons.net  Fri Mar 28 19:40:59 2008
From: jim at darchons.net (Jim Chen)
Date: Fri, 28 Mar 2008 20:40:59 -0400
Subject: Implement VBScript for Google Summer of Code
In-Reply-To: <47ED50F9.50208@codeweavers.com>
References: <8133cc9f0803272247y2fe1f706k7ecbcd4390dc95f7@mail.gmail.com>
	<47ED50F9.50208@codeweavers.com>
Message-ID: <8133cc9f0803281740n1552db0dx18b1c9584b4fc2a9@mail.gmail.com>

On Fri, Mar 28, 2008 at 4:11 PM, Jacek Caban <jacek at codeweavers.com> wrote:
> Jim Chen wrote:
>  > Hi everyone,
>  >
>  > I have this idea of implementing vbscript.dll for Google SoC. Any
>  > comment would be appreciated before I start working on my proposal.
>  >
>  It would be great to have vbscript.dll implemented in Wine and I hope
>  that some day we will have it, but I think you underestimate amount of
>  work on it. It's a much bigger task than the usual SoC projects, IMO.
>  Please do some research before deciding to work on it. I've found Eric
>  Lippert's blog very useful for information about active scripts
>  http://blogs.msdn.com/ericlippert/default.aspx
>  esp. the archive from 2004. If you'll decide to apply for this project,
>  please describe it well enough so we know that you can accomplish it.
>
>
>  Jacek
>

Wow thanks for the link! Surprisingly useful (for something from MS :D)
I've been doing research and I understand it will be a huge effort.
I've already applied to the windowless Rich Edit project, which will
most likely be easier than this, but I think this one will be more
exciting because it's more challenging :) I'm more than willing to
continue after SoC if I end up working on it. I don't have to
implement the newest version either, with support for classes, etc. If
I just implement VBScript say up to 2.0 that's within reach, I think.

Thanks again!
Jim


From winehacker at gmail.com  Fri Mar 28 22:52:30 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 28 Mar 2008 23:52:30 -0400
Subject: SoC idea: enhance the Program Manager, winefile and friends
In-Reply-To: <3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
Message-ID: <19e31a080803282052u136eeb07r230e9eb497c618c4@mail.gmail.com>

Hey Juan!

On Fri, Mar 28, 2008 at 4:18 PM, Juan Lang <juan.lang at gmail.com> wrote:
>  Personally, I think enhancing explorer to have its own GUI (rather
>  than launching winefile) would be an interesting project.  If nothing
>  else, having a graphical way to explore the shell namespace might be
>  handy for debugging shell issues.  From there to an explorer for
>  desktop mode might not be such a big leap.

Enhancing our explorer to be a full explorer replacement would be cool
with me too, there were just a few reasons I suggested using Program
Manager and Winefile rather than trying to extend explorer for the UI

1. Its kind of massive and I don't think we need all of that for
desktop mode. I view desktop mode as kind of a corner case that only
should be used like 5% of the time.
2. We have winefile and the Program Manager already and both are in
really bad shape. They have for the most part bit-rotted in the tree
for as long as I can remember. It would be nice to see them polished
for Wine 1.0
3. This is just my taste but I don't really like having a Window style
explorer bar running in a window. It would make Wine feel more like a
VM like environment to me. Maybe we want that for Desktop mode to
further try to discourage users from running it, like case 1.

I'd like to see when Desktop mode is invoked, a working Program
Manager launch that already has program groups for all of the
installed Shortcuts plus existing Winelib applications we ship in the
tree. Perhaps even a My Computer group minimized with support for the
Shell Namespace builtin and or support for launching winefile with
shellnamespace support. I know its a bit of a departure from the
normal Windows UI and some may even say using the Program Manager like
that is a throwback to Windows 3.1 but it just seems like it would
flow better from a UI perspective. Plus it would leverage the code we
already have in tree.

All of that being said I don't know if I could mentor such a project
anyway, just throwing out ideas. As with everything it really comes
down to what Julliard wants.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Sat Mar 29 00:58:42 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sat, 29 Mar 2008 01:58:42 -0400
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com> <47E8C57C.9030708@gmail.com>
	<22821af30803261142k52502f40mb9a51993fb86593e@mail.gmail.com>
	<47EAA1C0.5050004@gmail.com>
	<78a7dad00803280244y228a3397ubcd6f2952e714335@mail.gmail.com>
	<00b601c890d2$919ac3b0$a600fea9@DMITRY>
	<3f4fd2640803280635t19f23f8eu135353fea418f70@mail.gmail.com>
	<19e31a080803281153u4fbfa11fm76d80446662b5bf4@mail.gmail.com>
	<22821af30803281201m61f97a09g50ab810d0d73b60e@mail.gmail.com>
	<19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
Message-ID: <19e31a080803282258y5af80babp404ddc4f0d7e27d@mail.gmail.com>

On Fri, Mar 28, 2008 at 3:22 PM, Steven Edwards <winehacker at gmail.com> wrote:
>  There should just be a few rules that need to be changed as far as I
>  know. Thats all that was needed for the programs case, I cannot Imagen
>  why the tests would be any more complex. If Alexandre has not already
>  done so, I'll look at it and submit patches tonight.

The rules for building the import libs has changed quite a bit since
the last time I looked at them and I am not quite sure about how to
fix a couple of problems so I'll wait for Alexandre to comment.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sat Mar 29 02:55:34 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 29 Mar 2008 15:55:34 +0800
Subject: winex11.drv: Don't add owned windows to the taskbar
References: <E1JdgFO-0001Yv-Uq@mail.codeweavers.com>	<47E95728.8090202@inbox.lv><000f01c88ef6$21f7dc10$a600fea9@DMITRY>
	<47ED6D94.3090403@palosanto.com>
Message-ID: <01d101c89172$47da7ea0$a600fea9@DMITRY>

"Alex Villac??s Lasso" <a_villacis at palosanto.com> wrote:

>> The problem with IDA is that the button you see in the Windows task bar
>> does not belong to the main IDA window, it belongs to a zero sized visible
>> window with the same caption. Since it's zero sized Wine doesn't map it all.
>> So, while formally it's a regression, technically it's not: main IDA window
>> has never been added to the task bar before my patch. This all can be easily
>> discovered with spy++ and a simple test app.
>>
>>
> This also affects many, if not all, VB6 applications (and possibly many
> Delphi applications). Personally, I consider this a rather serious
> regression and propose backing out of commit
> cb3ff54789c652b02d852f40db71cafd9fd67ca9 as a fix.
>
> BTW, this reminds me of bug 1598. If the explanation of the bug for IDA
> above is correct, then the "buggy" behavior of not assigning
> minimize/maximize buttons to the window that appears in the panel is
> sort of consistent with this regression. Maybe the behavior should be
> that visible windows owned by an invisible window should get mapped in
> the panel.

1598 is closed as fixed, and I have no idea how missing minimize/maximize
buttons are related to owned windows, and why you think that it's somehow
related to the visibility of an owner.

What you need to be fixed is making a zero sized window with WS_VISIBLE
style set mapped, but X11/WMs doesn't handle that gracefully.

-- 
Dmitry. 



From julliard at winehq.org  Sat Mar 29 03:45:30 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 29 Mar 2008 09:45:30 +0100
Subject: winex11.drv: Connect to XIM server dynamically.
In-Reply-To: <200803290623351147810006MA71@nm06mta.auone-net.jp> (Kusanagi
	Kouichi's message of "Sat, 29 Mar 2008 15:23:34 +0900")
References: <200803290623351147810006MA71@nm06mta.auone-net.jp>
Message-ID: <87sky9sytx.fsf@wine.dyndns.org>

Kusanagi Kouichi <slash at ma.neweb.ne.jp> writes:

> If I want to use XIM, I must start XIM server before wine.
> Furthermore, if XIM server stops, wine can't use XIM again
> even if XIM server restarts.

You are changing too many things at once in your patches, including
things that don't necessarily need to be changed. Please try to do your
changes in smaller chunks.

-- 
Alexandre Julliard
julliard at winehq.org


From kwixbit at gmail.com  Sat Mar 29 05:12:16 2008
From: kwixbit at gmail.com (Warren Dumortier)
Date: Sat, 29 Mar 2008 11:12:16 +0100
Subject: Sims: Pet Stories Bug?
Message-ID: <f3a003030803290312s5b2d680bgb151050806a7b8b6@mail.gmail.com>

Hello everybody!

I send this mail because I made a bug report some time ago and nobody is
looking to help...
Here's the bug: http://bugs.winehq.org/show_bug.cgi?id=11946, is there any
person who could make this game work?

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080329/40e3f4f3/attachment.htm 

From paul at astro.gla.ac.uk  Sat Mar 29 06:01:15 2008
From: paul at astro.gla.ac.uk (Paul Millar)
Date: Sat, 29 Mar 2008 12:01:15 +0100
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <19e31a080803282258y5af80babp404ddc4f0d7e27d@mail.gmail.com>
References: <47E8C0FC.2010700@gmail.com>
	<19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
	<19e31a080803282258y5af80babp404ddc4f0d7e27d@mail.gmail.com>
Message-ID: <200803291201.22475.paul@astro.gla.ac.uk>

Hi all,

I've added support in MinGW support for d3dx9 (with help from Stefan Leichter, 
thanks!) and a build has now gone through.  New results should start to 
appear as people upload their results.

On Saturday 29 March 2008 06:58:42 Steven Edwards wrote:
> On Fri, Mar 28, 2008 at 3:22 PM, Steven Edwards <winehacker at gmail.com> 
wrote:
> >  [...] If Alexandre has not already done so, I'll look at it and
> >  submit patches tonight. 
>
> The rules for building the import libs has changed quite a bit since
> the last time I looked at them and I am not quite sure about how to
> fix a couple of problems so I'll wait for Alexandre to comment.

I, too, was going to have a look at this (but, if you want to do it, Steven, 
feel free ;-).  I'm not sure how best to approach this, though.

Cheers,

Paul.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080329/e7bc411e/attachment-0001.pgp 

From stefandoesinger at gmx.at  Sat Mar 29 06:22:08 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 29 Mar 2008 12:22:08 +0100
Subject: Sims: Pet Stories Bug?
In-Reply-To: <f3a003030803290312s5b2d680bgb151050806a7b8b6@mail.gmail.com>
References: <f3a003030803290312s5b2d680bgb151050806a7b8b6@mail.gmail.com>
Message-ID: <200803291222.08993.stefandoesinger@gmx.at>

Am Samstag, 29. M?rz 2008 11:12:16 schrieb Warren Dumortier:
> Hello everybody!
>
> I send this mail because I made a bug report some time ago and nobody is
> looking to help...
> Here's the bug: http://bugs.winehq.org/show_bug.cgi?id=11946, is there any
> person who could make this game work?
I'm sorry, but open source projects do not work that way. Filed bug reports do 
not get lost, but we do not promise any bug response time as well.

Usually I send bug reports back to the end of my list when people become too 
naggy, but I've had a quick look at it:

> trace:d3d:IWineD3DDeviceImpl_SetVertexShaderConstantF (iface 0x3aacff8,
> srcData 0x20f80b0, start 0, count 1024) 
It's the same problem as Sims 2, we need software vertex shader emulation for 
this game.



From htl10 at users.sourceforge.net  Sat Mar 29 11:03:22 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Sat, 29 Mar 2008 16:03:22 +0000 (GMT)
Subject: gdi32-related commit between 0.9.57<->0.9.58broken
	.NET2/Systems.Windows.Forms
In-Reply-To: <558b2f5c0803281131m274f7d3ya2a61a5f81d08d10@mail.gmail.com>
Message-ID: <472646.42281.qm@web23108.mail.ird.yahoo.com>

--- On Fri, 28/3/08, Lei Zhang <thestig at google.com> wrote:

> From: Lei Zhang <thestig at google.com>
<snipped>
> Umm, I have friends who are font fanatics that have
> thousands of fonts
> installed on their system. If they can do that on Windows,
> they
> certainly should be able to do that on Linux. Are you
> suggesting we a)
> limit ourselves to only support what ships with Windows,
> and ignore
> all other fonts out there, or b) create a white list for
> every known
> font out there?

I don't have an answer to that - in a different machine, I have maybe a 100 
chinese fonts of various level of obcurity :-). but it is going to be a
nightmare for the wine developers to allow random fonts to break some part of it.

<snipped>


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Inbox http://uk.docs.yahoo.com/nowyoucan.html


From spedrosa at gmail.com  Sat Mar 29 11:20:13 2008
From: spedrosa at gmail.com (Stephen Eilert)
Date: Sat, 29 Mar 2008 13:20:13 -0300
Subject: Sims: Pet Stories Bug?
In-Reply-To: <200803291222.08993.stefandoesinger@gmx.at>
References: <f3a003030803290312s5b2d680bgb151050806a7b8b6@mail.gmail.com>
	<200803291222.08993.stefandoesinger@gmx.at>
Message-ID: <47EE6C3D.9020306@gmail.com>

Stefan D?singer wrote:
> Am Samstag, 29. M?rz 2008 11:12:16 schrieb Warren Dumortier:
>   
>> Hello everybody!
>>
>> I send this mail because I made a bug report some time ago and nobody is
>> looking to help...
>> Here's the bug: http://bugs.winehq.org/show_bug.cgi?id=11946, is there any
>> person who could make this game work?
>>     
> I'm sorry, but open source projects do not work that way. Filed bug reports do 
> not get lost, but we do not promise any bug response time as well.
>
> Usually I send bug reports back to the end of my list when people become too 
> naggy, but I've had a quick look at it:
>
>   
>> trace:d3d:IWineD3DDeviceImpl_SetVertexShaderConstantF (iface 0x3aacff8,
>> srcData 0x20f80b0, start 0, count 1024) 
>>     
> It's the same problem as Sims 2, we need software vertex shader emulation for 
> this game.
>
>
>
>   
Wouldn't that be a suitable project for the Summer of Code?


Stephen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080329/a92184ab/attachment.htm 

From truiken at gmail.com  Sat Mar 29 13:00:31 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 29 Mar 2008 13:00:31 -0500
Subject: MinGW cross compilation fails for d3dx9_36/tests
In-Reply-To: <200803291201.22475.paul@astro.gla.ac.uk>
References: <47E8C0FC.2010700@gmail.com>
	<19e31a080803281222g10621351x11c51ba81e1ee7cf@mail.gmail.com>
	<19e31a080803282258y5af80babp404ddc4f0d7e27d@mail.gmail.com>
	<200803291201.22475.paul@astro.gla.ac.uk>
Message-ID: <22821af30803291100u530c7329x315021e222fefb7b@mail.gmail.com>

On Sat, Mar 29, 2008 at 6:01 AM, Paul Millar <paul at astro.gla.ac.uk> wrote:
> Hi all,
>
>  I've added support in MinGW support for d3dx9 (with help from Stefan Leichter,
>  thanks!) and a build has now gone through.  New results should start to
>  appear as people upload their results.
>
>

Thanks Paul!

-- 
James Hawkins


From wine-devel at kievinfo.com  Sat Mar 29 13:30:12 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 29 Mar 2008 12:30:12 -0600
Subject: Two more janitorial tasks
Message-ID: <47EE8AB4.80107@kievinfo.com>

This is a bit more involved then regular janitorial task, but pretty small 
never the less. It is for some one who wants to get their feet wet in Wine.

Convert all console applications (net, regsvr32, eject, msiexec, etc) to 
unicode (see cmd for example). This is to better support international 
translations.

Use WriteConsoleW to output text to the console instead printf & co. Again 
for better support of the international translations and to avoid bugs in 
Wine's msvcrt which prints to the wrong terminal.

Vitaliy.


From stefan at codeweavers.com  Sat Mar 29 14:49:27 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 29 Mar 2008 20:49:27 +0100
Subject: Sims: Pet Stories Bug?
In-Reply-To: <47EE6C3D.9020306@gmail.com>
References: <f3a003030803290312s5b2d680bgb151050806a7b8b6@mail.gmail.com>
	<200803291222.08993.stefandoesinger@gmx.at>
	<47EE6C3D.9020306@gmail.com>
Message-ID: <200803292049.27540.stefan@codeweavers.com>

Am Samstag, 29. M?rz 2008 17:20:13 schrieb Stephen Eilert:
> > It's the same problem as Sims 2, we need software vertex shader emulation
> > for this game.
>
> Wouldn't that be a suitable project for the Summer of Code?
Maybe, but it has rather huge requirements:

-> The amount of work is HUGE(ok, we can limit it to e.g. Shader model 1.1)
-> There is some integration work to do(a bit easier since my shader/pipeline 
model changes)
-> It requires very good knowledge about x86 / x86_64 assembler
-> Mapping the shader instructions on regular FPUs is rather hard

So if there is someone who really enjoys coding in assembler and has excellent 
knowledge about it I am tempted to agree with shader emulation as a GSoC 
project. It surely isn't a project for a novice programmer.


From hintak_leung at yahoo.co.uk  Sat Mar 29 10:57:08 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Sat, 29 Mar 2008 15:57:08 +0000 (GMT)
Subject: DLL exports... HELP?!
In-Reply-To: <47EA38DF.3060501@gmx.net>
Message-ID: <229656.50098.qm@web23112.mail.ird.yahoo.com>

There are two comments about the tarball - it is a tbz2 file (not tar.gz as the name implied). and it does build alright with mingw, with a little editing.
There is a header problem (which seems to be newly introduced compared to the older(?) GSOC submission), and a couple of compiler warnings which should be fixed.

BTW, I am using mingw-cross gcc 4.2.1(?), probably shows a bit more warnings than 3.4.5. 
and I think cross-compiler built from the mingw camp tends to have i386-mingw-* rather
than i586-mingw-*; some 3rd party distributes i586-mingw-*'s. In any case, i386-mingw-*
is what I have. (I did build the cross-compiler myself, rather than a downloaded binary).

--- On Wed, 26/3/08, Marcel Partap <mpartap at gmx.net> wrote:

> From: Marcel Partap <mpartap at gmx.net>
> Subject: Re: DLL exports... HELP?!
> To: pure_evil at mail.bg
> Cc: wine-devel at winehq.org
> Date: Wednesday, 26 March, 2008, 11:51 AM
> Hi Stefanov,
> attached is the code of a standalone proxy DLL I developed
> last year during SoC, have a look 
> especially at the makefile for cross-compilation...
> regards marcel.
> 
> -- 
> <div id="signature">
>    "Obstacles are those frightful things you see when
> you take your eyes off your goal."
>                                                            
>    -- Henry Ford (1863-1947)
>    Change the world! Vote revolution:
> http://hfopi.org/vote-future
> </div>


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Inbox http://uk.docs.yahoo.com/nowyoucan.html


From hintak_leung at yahoo.co.uk  Sat Mar 29 10:51:44 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Sat, 29 Mar 2008 15:51:44 +0000 (GMT)
Subject: DLL exports... HELP?! (wine based win32 printer drivers for
	openprinting)
In-Reply-To: <1206731997.8726.19.camel@p4>
Message-ID: <15655.45446.qm@web23112.mail.ird.yahoo.com>

I had a better look at the wine 2007 GSOC work - works quite alright, found my CUPS
spooler; I am surprised that it uses the registry. It builds alright with mingw cross compiler (I have it around for other stuff and reasonably familiar with it), but a little surprised that there are a few compiler warnings which should be fixed,
for code base this small.

--- On Fri, 28/3/08, Detlef Riekenberg <wine.dev at web.de> wrote:
<snipped>
> I'm away for the weekend, but some quick notes:
> 
> - The ddiwrapper-hack works only with a very small amount
> of
>   self-contained drivers

Yes, but say, a GSOC project for distinguishing which are self-contained and which are not?

I haven't got round to look at ddiwrapper yet, but it is in my hard disc now. 

> - Most Drivers today are plugins for the unidrv or the
> pscipt5 Driver
>   (you can install pscript5 from Adobe since ~ 1/2 Year)
> - Drivers expect dlls, that are not present in wine-2005*
>   (They will not load)
> - Rendering with full Drivers (Raster-Mode) need most Eng*
> Functions
>   and Friends (This is the DIB-Engine).
> - Rendering with full Drivers (Postscript) need some Eng*
> Functions
>   and Friends.
>   Nothing in this Area is implemented / exported in current
> Wine:
>   Driver will not load

The time frame - GSOC work being a little after wine 1.0 (and the merge of the other work) - should be interesting and useful?

> - Sending the rendered Data to the Printer need sometimes a
> vendor-
>   specific Portmonitor / Languagemonitor
>   (Not supported in current Wine)

Yes, I think the epson epl windows driver does that...

A personal question: would be like to be involved if a student comes along, or in general in this area? (I looked it up, you were the mentor for the 2007 wine project for the printerproxy).


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Inbox http://uk.docs.yahoo.com/nowyoucan.html


From Andrew.Talbot at talbotville.com  Sat Mar 29 15:47:49 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 29 Mar 2008 20:47:49 +0000
Subject: ws2_32 janitorial questions
Message-ID: <fsm9tm$msj$1@ger.gmane.org>

Hi,

ws2_32/async.c has the following global declarations:

/* protoptypes of some functions in socket.c
 */
UINT16 wsaErrno(void);
UINT16 wsaHerrno(int errnr);

ws2_32/socket.c has the following global declarations:

UINT wsaErrno(void);
UINT wsaHerrno(int errnr);

Where are these functions defined? And, assuming that the above are
conflicting declarations, what type does each of these functions actually
return?

Thanks,

-- 
Andy.




From mle+win at mega-nerd.com  Sat Mar 29 20:24:03 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 30 Mar 2008 12:24:03 +1100
Subject: find_dll_file ignoring WINEDLLPATH?
Message-ID: <20080330122403.02d947a3.mle+win@mega-nerd.com>

Hi all,

I have a windows executable named floating_point_test.exe which
requires a windows DLL that is in another directory. I'm trying
to run the exe from the current dir using:

    WINEDLLPATH="/path/to/dll:$WINEDLLPATH" wine floating_point_test.exe

but wine is not able to find the DLL. I've traced through the code
and ended up in the file dlls/ntdll/loader.c and the function
find_dll_file (). I've added a few printfs and found that when
looking for my DLL, the code ends up in a section with the following
comment:

    /* if libname doesn't contain a path at all, we simply return the name as is,
     * to be loaded as builtin */

It seems that this function makes no use of WINEDLLPATH. Shouldn't
this function also search along the paths specified by the
environment variable?

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"I could never learn to use C++, because of the completely
overwhelming desire to redesign the language every time I tried
to use it, but this is the normal, healthy reaction to C++."
-- Erik Naggum


From mle+win at mega-nerd.com  Sat Mar 29 21:31:13 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 30 Mar 2008 13:31:13 +1100
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <20080330122403.02d947a3.mle+win@mega-nerd.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
Message-ID: <20080330133113.a8a4a594.mle+win@mega-nerd.com>

Erik de Castro Lopo wrote:

> It seems that this function makes no use of WINEDLLPATH. Shouldn't
> this function also search along the paths specified by the
> environment variable?

I've grepped the sources and the only place that looks at 
WINEDLLPATH is the funcion build_dll_path() in libs/wine/loader.c.

The function build_dll_path() fills in an array dll_paths with
is private to that file. Looking at other things in that file
it seems that stuff in that file is mostly related to loading
the native Linux versions of the windows DLLs. Is that right?
If so, it looks like some of the code in libs/wine/loader.c
needs to be cloned or shared with the code in
dlls/ntdll/loader.c.

I'm willing to hack up a fix for this if someone can point me
in the right direction.

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
Open Source and Free Software means that you never sacrifice quality
of the code for meeting deadlines set up by people not participating
directly in the software development process.
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"Patents are bad for the software industry.."
-- Bill Gates in 1991


From mpartap at gmx.net  Sat Mar 29 23:03:08 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Sun, 30 Mar 2008 06:03:08 +0200
Subject: DLL exports... HELP?! (wine based win32 printer drivers
	for	openprinting)
In-Reply-To: <15655.45446.qm@web23112.mail.ird.yahoo.com>
References: <15655.45446.qm@web23112.mail.ird.yahoo.com>
Message-ID: <47EF10FC.2060905@gmx.net>

Hi Hin-Tak,
no no misunderstanding ;) ...that printer proxy does exactly what the name says: it's only purpose 
is to log the calls a printer driver receives from the windows spooler. And yes, somehow some 
glitches creeped in ^ ^
The rest of my work - as Detlef has already stated - depends on a lot of stuff that has yet to be 
implemented (huw is working on the DIB engine..). Anyways, I am working on getting something 
merged.. For now the target is to get the Adobe pscript5 driver working which has its own raster 
renderer and thus does not depend on the dib engine. Just started by making AddPrinter correctly get 
a default devmode out of the driver, patch is attached, detlef please comment on it (and hope you 
got to your family dinner in time...;)
regards marcel.


-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-winspool-localspl-native-driver-dll-calls.patch
Type: text/x-patch
Size: 0 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080330/ac9250dc/attachment-0001.bin 

From mpartap at gmx.net  Sat Mar 29 22:13:16 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Sun, 30 Mar 2008 05:13:16 +0200
Subject: [PATCH] winspool & localspl native driver dll calls
Message-ID: <mailman.301.1206849805.3731.wine-devel@winehq.org>

---
 dlls/localspl/localspl_main.c |   16 ++++++-
 dlls/winspool.drv/info.c      |   97 +++++++++++++++++++++++++++++++---------
 include/ddk/winddiui.h        |   17 +++++++
 3 files changed, 107 insertions(+), 23 deletions(-)

diff --git a/dlls/localspl/localspl_main.c b/dlls/localspl/localspl_main.c
index 77fb730..30628bd 100644
--- a/dlls/localspl/localspl_main.c
+++ b/dlls/localspl/localspl_main.c
@@ -29,6 +29,7 @@
 #include "winreg.h"
 #include "winspool.h"
 #include "ddk/winsplp.h"
+#include "ddk/winddiui.h"
 #include "winuser.h"
 
 #include "wine/debug.h"
@@ -62,6 +63,7 @@ HINSTANCE LOCALSPL_hInstance = NULL;
 
 static const PRINTPROVIDOR * pp = NULL;
 
+static PFN_DrvDriverEvent pDrvDriverEvent = NULL;
 
 static const WCHAR backslashW[] = {'\\',0};
 static const WCHAR configuration_fileW[] = {'C','o','n','f','i','g','u','r','a','t','i','o','n',' ','F','i','l','e',0};
@@ -408,6 +410,7 @@ static BOOL WINAPI myAddPrinterDriverEx(DWORD level, LPBYTE pDriverInfo, DWORD d
     DWORD   disposition;
     DWORD   len;
     LONG    lres;
+    HINSTANCE   hcfgdll;
 
     /* we need to set all entries in the Registry, independent from the Level of
        DRIVER_INFO, that the caller supplied */
@@ -525,7 +528,18 @@ static BOOL WINAPI myAddPrinterDriverEx(DWORD level, LPBYTE pDriverInfo, DWORD d
     if (level > 5) TRACE("level %u for Driver %s is incomplete\n", level, debugstr_w(di.pName));
 
     RegCloseKey(hdrv);
-    TRACE("### DrvDriverEvent(...,DRIVEREVENT_INITIALIZE) not implemented yet\n");
+
+    apd.dst[apd.dstlen] = '\0';
+    lstrcatW(apd.dst, di.pConfigFile);
+    hcfgdll = LoadLibraryW(apd.dst);
+    if (hcfgdll) {
+        pDrvDriverEvent = (void*)GetProcAddress(hcfgdll, "DrvDriverEvent");
+        if (pDrvDriverEvent) {
+            lres = pDrvDriverEvent(DRIVER_EVENT_INITIALIZE, 3, (LPBYTE)&di, (LPARAM)NULL);
+            TRACE("DrvDriverEvent returned %d\n", lres);
+        }
+        FreeLibrary(hcfgdll);
+    }
 
     TRACE("=> TRUE with %u\n", GetLastError());
     return TRUE;
diff --git a/dlls/winspool.drv/info.c b/dlls/winspool.drv/info.c
index dadc61f..6229d41 100644
--- a/dlls/winspool.drv/info.c
+++ b/dlls/winspool.drv/info.c
@@ -56,6 +56,7 @@
 #include "wine/debug.h"
 #include "wine/list.h"
 #include "winnls.h"
+#include "ddk/winddiui.h"
 
 #include "ddk/winsplp.h"
 #include "wspool.h"
@@ -147,6 +148,7 @@ static INT (WINAPI *GDI_CallExtDeviceMode16)( HWND hwnd, LPDEVMODEA lpdmOutput,
                                               LPSTR lpszDevice, LPSTR lpszPort,
                                               LPDEVMODEA lpdmInput, LPSTR lpszProfile,
                                               DWORD fwMode );
+static PFN_DrvDocumentPropertySheets pDrvDocumentPropertySheets = NULL;
 
 static const WCHAR DriversW[] = { 'S','y','s','t','e','m','\\',
                                   'C','u', 'r','r','e','n','t','C','o','n','t','r','o','l','S','e','t','\\',
@@ -2136,6 +2138,49 @@ LONG WINAPI DocumentPropertiesA(HWND hWnd,HANDLE hPrinter,
     return ret;
 }
 
+/*****************************************************************************
+ *  WINSPOOL_CallDrvDocumentProperties (internal)
+ * calls native driver's DrvDocumentProperties
+ */
+static LONG WINSPOOL_CallDrvDocumentProperties(HANDLE hPrinter, LPWSTR pDeviceName,
+                                               LPDEVMODEW pdmOut, LPDEVMODEW pdmIn,
+                                               DWORD fMode)
+{
+    DRIVER_INFO_2W *di;
+    DWORD needed;
+    HINSTANCE hcfgdll;
+    DOCUMENTPROPERTYHEADER dph;
+    LONG lres;
+
+    GetPrinterDriverW(hPrinter, NULL, 2, NULL, 0, &needed);
+    di = HeapAlloc(GetProcessHeap(), 0, needed);
+    if (!GetPrinterDriverW(hPrinter, NULL, 2, di, needed, &needed)) {
+        ERR("GetPrinterDriver failed on %p\n", hPrinter);
+        return -1;
+    }
+    hcfgdll = LoadLibraryW(di->pConfigFile);
+    if (!hcfgdll) {
+       ERR("LoadLibrary failed on %s\n", debugstr_w(di->pConfigFile));
+       return -1;
+    }
+    pDrvDocumentPropertySheets = (void*)GetProcAddress(hcfgdll, "DrvDocumentPropertySheets");
+    if (!pDrvDocumentPropertySheets) {
+        ERR("GetProcAddress could not find DrvDocumentPropertySheets in %s\n", debugstr_w(di->pConfigFile));
+        return -1;
+    }
+    TRACE("hcfgdll=%p pDrvDocumentPropertySheets=%p\n", hcfgdll, pDrvDocumentPropertySheets);
+    memset(&dph, 0, sizeof(dph));
+    dph.cbSize = sizeof(dph);
+    dph.hPrinter = hPrinter;
+    dph.pszPrinterName = pDeviceName;
+    dph.pdmIn = pdmIn;
+    dph.pdmOut = pdmOut;
+    dph.fMode = fMode;
+    lres = pDrvDocumentPropertySheets(NULL, &dph);
+    TRACE("returning %d needed = %d\n", lres, dph.cbOut);
+    FreeLibrary(hcfgdll);
+    return lres;
+}
 
 /*****************************************************************************
  *          DocumentPropertiesW (WINSPOOL.@)
@@ -2158,15 +2203,24 @@ LONG WINAPI DocumentPropertiesW(HWND hWnd, HANDLE hPrinter,
 	  fMode);
     if(pDevModeOutput) {
         ret = DocumentPropertiesA(hWnd, hPrinter, pDeviceNameA, NULL, NULL, 0);
-	if(ret < 0) return ret;
-	pDevModeOutputA = HeapAlloc(GetProcessHeap(), 0, ret);
+	if(ret > 0) pDevModeOutputA = HeapAlloc(GetProcessHeap(), 0, ret);
     }
     ret = DocumentPropertiesA(hWnd, hPrinter, pDeviceNameA, pDevModeOutputA,
 			      pDevModeInputA, fMode);
-    if(pDevModeOutput) {
+    if(pDevModeOutputA) {
         DEVMODEcpyAtoW(pDevModeOutput, pDevModeOutputA);
 	HeapFree(GetProcessHeap(),0,pDevModeOutputA);
     }
+
+    /* handle native 32-bit drivers (only unicode/W) */
+    if (ret <= 0) {
+        if (!hPrinter) {
+            OpenPrinterW(pDeviceName, &hPrinter, NULL);
+        }
+        ret = WINSPOOL_CallDrvDocumentProperties(hPrinter, pDeviceName, pDevModeOutput,
+                                                                  pDevModeInput, fMode);
+    }
+
     if(fMode == 0 && ret > 0)
         ret += (CCHDEVICENAME + CCHFORMNAME);
     HeapFree(GetProcessHeap(),0,pDevModeInputA);
@@ -3073,6 +3127,24 @@ HANDLE WINAPI AddPrinterW(LPWSTR pName, DWORD Level, LPBYTE pPrinter)
     RegSetValueExW(hkeyPrinter, attributesW, 0, REG_DWORD,
 		   (LPBYTE)&pi->Attributes, sizeof(DWORD));
     set_reg_szW(hkeyPrinter, DatatypeW, pi->pDatatype);
+    set_reg_szW(hkeyPrinter, DescriptionW, pi->pComment);
+    set_reg_szW(hkeyPrinter, LocationW, pi->pLocation);
+    set_reg_szW(hkeyPrinter, NameW, pi->pPrinterName);
+    set_reg_szW(hkeyPrinter, ParametersW, pi->pParameters);
+
+    set_reg_szW(hkeyPrinter, PortW, pi->pPortName);
+    set_reg_szW(hkeyPrinter, Print_ProcessorW, pi->pPrintProcessor);
+    set_reg_szW(hkeyPrinter, Printer_DriverW, pi->pDriverName);
+    RegSetValueExW(hkeyPrinter, priorityW, 0, REG_DWORD,
+                   (LPBYTE)&pi->Priority, sizeof(DWORD));
+    set_reg_szW(hkeyPrinter, Separator_FileW, pi->pSepFile);
+    set_reg_szW(hkeyPrinter, Share_NameW, pi->pShareName);
+    RegSetValueExW(hkeyPrinter, start_timeW, 0, REG_DWORD,
+                   (LPBYTE)&pi->StartTime, sizeof(DWORD));
+    RegSetValueExW(hkeyPrinter, statusW, 0, REG_DWORD,
+                   (LPBYTE)&pi->Status, sizeof(DWORD));
+    RegSetValueExW(hkeyPrinter, until_timeW, 0, REG_DWORD,
+                   (LPBYTE)&pi->UntilTime, sizeof(DWORD));
 
     /* See if we can load the driver.  We may need the devmode structure anyway
      *
@@ -3119,25 +3191,6 @@ HANDLE WINAPI AddPrinterW(LPWSTR pName, DWORD Level, LPBYTE pPrinter)
         if(!pi->pDevMode)
             HeapFree(GetProcessHeap(), 0, dmW);
     }
-    set_reg_szW(hkeyPrinter, DescriptionW, pi->pComment);
-    set_reg_szW(hkeyPrinter, LocationW, pi->pLocation);
-    set_reg_szW(hkeyPrinter, NameW, pi->pPrinterName);
-    set_reg_szW(hkeyPrinter, ParametersW, pi->pParameters);
-
-    set_reg_szW(hkeyPrinter, PortW, pi->pPortName);
-    set_reg_szW(hkeyPrinter, Print_ProcessorW, pi->pPrintProcessor);
-    set_reg_szW(hkeyPrinter, Printer_DriverW, pi->pDriverName);
-    RegSetValueExW(hkeyPrinter, priorityW, 0, REG_DWORD,
-                   (LPBYTE)&pi->Priority, sizeof(DWORD));
-    set_reg_szW(hkeyPrinter, Separator_FileW, pi->pSepFile);
-    set_reg_szW(hkeyPrinter, Share_NameW, pi->pShareName);
-    RegSetValueExW(hkeyPrinter, start_timeW, 0, REG_DWORD,
-                   (LPBYTE)&pi->StartTime, sizeof(DWORD));
-    RegSetValueExW(hkeyPrinter, statusW, 0, REG_DWORD,
-                   (LPBYTE)&pi->Status, sizeof(DWORD));
-    RegSetValueExW(hkeyPrinter, until_timeW, 0, REG_DWORD,
-                   (LPBYTE)&pi->UntilTime, sizeof(DWORD));
-
     RegCloseKey(hkeyPrinter);
     RegCloseKey(hkeyPrinters);
     if(!OpenPrinterW(pi->pPrinterName, &retval, NULL)) {
diff --git a/include/ddk/winddiui.h b/include/ddk/winddiui.h
index 7c6e775..0650416 100644
--- a/include/ddk/winddiui.h
+++ b/include/ddk/winddiui.h
@@ -22,6 +22,7 @@
 #define __WINE_WINDDIUI_H
 
 #include <ddk/compstui.h>
+#include <wingdi.h>
 
 #ifdef __cplusplus
 extern "C" {
@@ -40,9 +41,25 @@ extern "C" {
 
 #define PRINTER_EVENT_FLAG_NO_UI 1
 
+typedef struct _DOCUMENTPROPERTYHEADER {
+    WORD cbSize;
+    WORD Reserved;
+    HANDLE hPrinter;
+    LPWSTR pszPrinterName;
+    PDEVMODEW pdmIn;
+    PDEVMODEW pdmOut;
+    DWORD cbOut;
+    DWORD fMode;
+} DOCUMENTPROPERTYHEADER, *PDOCUMENTPROPERTYHEADER;
+
+LONG WINAPI DrvDocumentPropertySheets(PPROPSHEETUI_INFO, LPARAM);
 BOOL WINAPI DrvDriverEvent(DWORD, DWORD, LPBYTE, LPARAM);
 BOOL WINAPI DrvPrinterEvent(LPWSTR, INT, DWORD, LPARAM);
 
+typedef LONG WINAPI (*PFN_DrvDocumentPropertySheets)(PPROPSHEETUI_INFO, LPARAM);
+typedef BOOL WINAPI (*PFN_DrvDriverEvent)(DWORD, DWORD, LPBYTE, LPARAM);
+typedef BOOL WINAPI (*PFN_DrvPrinterEvent)(LPWSTR, INT, DWORD, LPARAM);
+
 #ifdef __cplusplus
 } /* extern "C" */
 #endif
-- 
1.5.4.4


--------------040200000709000007010901--


From jjmckenzie51 at sprintpcs.com  Sat Mar 29 23:11:09 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 29 Mar 2008 21:11:09 -0700
Subject: SoC idea: enhance the Program Manager, winefile and friends -
	Converting VB program to ANSI C for Windows Explorer replacement.
In-Reply-To: <b6bb06270803281350h676c3334h238fd9cd4047696c@mail.gmail.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
	<3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>
	<3a768c550803281340m398fd884mf381980d5a3220cc@mail.gmail.com>
	<b6bb06270803281350h676c3334h238fd9cd4047696c@mail.gmail.com>
Message-ID: <47EF12DD.8030103@sprintpcs.com>

Austin English wrote:
> On Fri, Mar 28, 2008 at 3:40 PM, Juan Lang <juan.lang at gmail.com> wrote:
>   
>>> Hasn't someone else somewhere in the world already written an explorer
>>>       
>>  >  replacement and we could just get them to open source it so we can
>>  >  include it with Wine?  No need to reinvent the wheel.
>>
>>  There's the ReactOS one, but it's written in C++.  I don't know of any
>>  ANSI C ones, but maybe I haven't looked hard enough.
>>  --Juan
>>
>>
>>
>>     
>
> http://www.google.com/search?q=windows+explorer+replacement&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a
>
> List of windows explorer replacements:
> http://gladiator-antivirus.com/forum/index.php?showtopic=50712&pid=167091&mode=threaded&show=&st=&
>
> Here's direct links to a few I found:
> http://www.xyplorer.com/index.htm
> http://mustangpeak.net/
> http://www.download32.com/directory-opus-i30453.html
> http://www.explorerxp.com/
> http://www.discount-softwares.com/soft/Utility/File_Disk_Management/9079_universal_explorer.htm
>
> There's even an open source one (in visual basic though, bleh)
> http://sourceforge.net/projects/pc-viewer
>
>   
It has been asked if any of these are written in ANSI C, how about 
converting the last one into ANSI C?  That would definitely be a mind 
expanding project, IMHO.  I've done language conversion in the past, and 
would do so now, if I had the available resource, time.   Would that be 
a good GSOC project?

James McKenzie


From winehacker at gmail.com  Sat Mar 29 23:29:19 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 30 Mar 2008 00:29:19 -0400
Subject: SoC idea: enhance the Program Manager,
	winefile and friends - Converting VB program to ANSI C for Windows
	Explorer replacement.
In-Reply-To: <47EF12DD.8030103@sprintpcs.com>
References: <19e31a080803281127m728a4e2bm6cd4c67f4a7b863c@mail.gmail.com>
	<3a768c550803281318m47af050fl55849cf8f60da92c@mail.gmail.com>
	<3010968c0803281339q23c3128q93debd694be162b3@mail.gmail.com>
	<3a768c550803281340m398fd884mf381980d5a3220cc@mail.gmail.com>
	<b6bb06270803281350h676c3334h238fd9cd4047696c@mail.gmail.com>
	<47EF12DD.8030103@sprintpcs.com>
Message-ID: <19e31a080803292129v3081cf52v519e82d4af2bed2@mail.gmail.com>

On Sun, Mar 30, 2008 at 12:11 AM, James McKenzie
<jjmckenzie51 at sprintpcs.com> wrote:
>  It has been asked if any of these are written in ANSI C, how about
>  converting the last one into ANSI C?  That would definitely be a mind
>  expanding project, IMHO.  I've done language conversion in the past, and
>  would do so now, if I had the available resource, time.   Would that be
>  a good GSOC project?

The real problem is most of the work needs to be done in shell32 not
explorer. If you look at Thomas Widenmullers explorer-new verses the
old ReactOS explorer (which is still default) you'll see that most of
windows explorer actually lives there and not enough of the shell
namespace and friends is actually implemented. Thats partly another
reason I suggested using Program Manager and Winefile. For examples
see below. I know linking to ReactOS code is normally not  acceptable
policy here but both the author of explorer Martin Fuchs and
explorer-new Thomas Widenmuller, have contributed quite a bit to Wine
in the past and besides, its obvious there is no way in hell they are
derived from Windows.

http://svn.reactos.org/svn/reactos/trunk/reactos/base/shell/explorer/
http://svn.reactos.org/svn/reactos/trunk/reactos/base/shell/explorer-new/

Explorer-new is written in C but it neither works on ReactOS or Wine
at this time. I don't think basing our explorer off of a third party
shell replacement that duplicated functionality that needs to be
reimplemented in shell32 is a good idea.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From xixsimplicityxix at gmail.com  Sun Mar 30 02:38:05 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Sun, 30 Mar 2008 02:38:05 -0500
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <20080330133113.a8a4a594.mle+win@mega-nerd.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
	<20080330133113.a8a4a594.mle+win@mega-nerd.com>
Message-ID: <78a7dad00803300038q654cb57buf87327ef7ab13a65@mail.gmail.com>

On Sat, Mar 29, 2008 at 9:31 PM, Erik de Castro Lopo
<mle+win at mega-nerd.com> wrote:
> Erik de Castro Lopo wrote:
>
>  > It seems that this function makes no use of WINEDLLPATH. Shouldn't
>  > this function also search along the paths specified by the
>  > environment variable?
>
>  I've grepped the sources and the only place that looks at
>  WINEDLLPATH is the funcion build_dll_path() in libs/wine/loader.c.
>
>  The function build_dll_path() fills in an array dll_paths with
>  is private to that file. Looking at other things in that file
>  it seems that stuff in that file is mostly related to loading
>  the native Linux versions of the windows DLLs. Is that right?
>  If so, it looks like some of the code in libs/wine/loader.c
>  needs to be cloned or shared with the code in
>  dlls/ntdll/loader.c.
>
>  I'm willing to hack up a fix for this if someone can point me
>  in the right direction.
>

When an app needs a certain dll windows (and wine) search according to
this:  directory of exe, current directory, system directory
(windows/system32),  windows directory (windows), and PATH env var.

What I would do if I were you is make a copy of that other needed dll
and put it in the applications exe directory.


From thestig at google.com  Sun Mar 30 02:59:09 2008
From: thestig at google.com (Lei Zhang)
Date: Sun, 30 Mar 2008 00:59:09 -0700
Subject: Two more janitorial tasks
In-Reply-To: <47EE8AB4.80107@kievinfo.com>
References: <47EE8AB4.80107@kievinfo.com>
Message-ID: <558b2f5c0803300059i2ba99f7ene2fa12d566e85416@mail.gmail.com>

On Sat, Mar 29, 2008 at 11:30 AM, Vitaliy Margolen
<wine-devel at kievinfo.com> wrote:
> This is a bit more involved then regular janitorial task, but pretty small
>  never the less. It is for some one who wants to get their feet wet in Wine.
>
>  Convert all console applications (net, regsvr32, eject, msiexec, etc) to
>  unicode (see cmd for example). This is to better support international
>  translations.
>
>  Use WriteConsoleW to output text to the console instead printf & co. Again
>  for better support of the international translations and to avoid bugs in
>  Wine's msvcrt which prints to the wrong terminal.
>

Sounds good. Please add it to the list:

http://wiki.winehq.org/JanitorialProjects


From mle+win at mega-nerd.com  Sun Mar 30 03:37:41 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 30 Mar 2008 19:37:41 +1100
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <78a7dad00803300038q654cb57buf87327ef7ab13a65@mail.gmail.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
	<20080330133113.a8a4a594.mle+win@mega-nerd.com>
	<78a7dad00803300038q654cb57buf87327ef7ab13a65@mail.gmail.com>
Message-ID: <20080330193741.cb5d53da.mle+win@mega-nerd.com>

John Klehm wrote:

> When an app needs a certain dll windows (and wine) search according to
> this:  directory of exe, current directory, system directory
> (windows/system32),  windows directory (windows), and PATH env var.
> 
> What I would do if I were you is make a copy of that other needed dll
> and put it in the applications exe directory.

Unfortunately, that is not a good option for my particular use
case.

My main interest in wine is for the case where I am cross
compiling from Linux to windows and want to run the cross
compiled windows executables (in particlular the test suite)
on Linux.

The particular project I want to compile like this are my
two projects libsndfile and libsamplerate, both of which have
top level source code layout of:

    src       - actual library source code
    tests     - the test suite programs
    examples  - some example programs

Since these libraries uses autoconf/automake/libtool, the generated
DLL ends up as:

    src/.libs/libwhatever-1.dll

and the test suite programs end up as say:

    tests/test_name.exe

When doing native Linux compiles, the libtool generated wrapper
scipt correctly points to the shared object file and the test
runs correctly. I'm looking for the same functionality when
running the tests under wine.

Your proposal of just copying the DLL is not a good solution in
this case because the copied executable could get out of sync
with the one in src/.libs, invalidating the tests.

> From what I've seen WINEDLLPATH is for internal dll.so parts of wine.

I've just re-read the wine man page and it seems does support
your statement.

However, my particular use case is a particluarly interesting one.
If I and other authors of cross platform code can easily compile
and test windows binaries on Linux, you will get more wine users
of the type that can hack on wine and write great bug reports.
I also means that windows becomes increasingly irrelevant.

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"C++ : Where friends have access to your private members."
-- Gavin Russell Baker


From xixsimplicityxix at gmail.com  Sun Mar 30 03:49:39 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Sun, 30 Mar 2008 03:49:39 -0500
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <20080330193741.cb5d53da.mle+win@mega-nerd.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
	<20080330133113.a8a4a594.mle+win@mega-nerd.com>
	<78a7dad00803300038q654cb57buf87327ef7ab13a65@mail.gmail.com>
	<20080330193741.cb5d53da.mle+win@mega-nerd.com>
Message-ID: <78a7dad00803300149m1fc44fb2pe71d1057b670c7a0@mail.gmail.com>

On Sun, Mar 30, 2008 at 3:37 AM, Erik de Castro Lopo
<mle+win at mega-nerd.com> wrote:
>
>  Your proposal of just copying the DLL is not a good solution in
>  this case because the copied executable could get out of sync
>  with the one in src/.libs, invalidating the tests.
>

Well you could have a script to recopy it there but there is one more
way I thought of that you could add the path (provided you dont remove
your .wine folder very often)

wine regedit

Then edit
\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session
Manager\Environment\Path

Add your additional path dirs at the start.

That will then permanently add those to your path (will get wiped if
you reinstall your .wine folder though).  Probably could get some kind
of .reg file to do this automatically.

--John


From mle+win at mega-nerd.com  Sun Mar 30 04:30:55 2008
From: mle+win at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 30 Mar 2008 20:30:55 +1100
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <78a7dad00803300149m1fc44fb2pe71d1057b670c7a0@mail.gmail.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
	<20080330133113.a8a4a594.mle+win@mega-nerd.com>
	<78a7dad00803300038q654cb57buf87327ef7ab13a65@mail.gmail.com>
	<20080330193741.cb5d53da.mle+win@mega-nerd.com>
	<78a7dad00803300149m1fc44fb2pe71d1057b670c7a0@mail.gmail.com>
Message-ID: <20080330203055.42c93e07.mle+win@mega-nerd.com>

John Klehm wrote:

> Well you could have a script to recopy it there but there is one more
> way I thought of that you could add the path (provided you dont remove
> your .wine folder very often)
> 
> wine regedit
> 
> Then edit
> \HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session
> Manager\Environment\Path

Thanks for your helpful suggestions, but this still isn't a good
solution. I hope to encourage others to do cross-compiled development
of libsndfile from Linux to windows and I would like to have all of
them hack their windows registry. It just seems too fragile.

However, I notice that if instead of copying the library I make a
symlink instead, the executable runs correctly. Of the solutions
I've seen so far, this is the least fragile and most easily 
implementable solution.

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
"Testing can prove the presence of bugs, but never their absence."
  -- Edsger Dijkstra


From marcus at jet.franken.de  Sun Mar 30 04:53:22 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Sun, 30 Mar 2008 11:53:22 +0200
Subject: strange menu behaviour
Message-ID: <20080330095322.GB4585@galeere>

Hi,

I am observing a strange menu behaviour.

How to reproduce:

- start notepad
- move the mouse over "Search", do not click
- press alt-f to get the file menu

=> the file menu flickers open, but suddenly switches
   to the search menu.

It seems the menu code checks the mouse pointer even
though it is not used for the menu activation.

http://bugs.winehq.org/show_bug.cgi?id=12289

Ciao, Marcus


From erikd at mega-nerd.com  Sat Mar 29 20:50:33 2008
From: erikd at mega-nerd.com (Erik de Castro Lopo)
Date: Sun, 30 Mar 2008 12:50:33 +1100
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <20080330122403.02d947a3.mle+win@mega-nerd.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
Message-ID: <20080330125033.26889303.erikd@mega-nerd.com>

Erik de Castro Lopo wrote:

> It seems that this function makes no use of WINEDLLPATH. Shouldn't
> this function also search along the paths specified by the
> environment variable?

I've grepped the sources and the only place that looks at 
WINEDLLPATH is the funcion build_dll_path() in libs/wine/loader.c.

The function build_dll_path() fills in an array dll_paths with
is private to that file. Looking at other things in that file
it seems that stuff in that file is mostly related to loading
the native Linux versions of the windows DLLs. Is that right?
If so, it looks like some of the code in libs/wine/loader.c
needs to be cloned or shared with the code in
dlls/ntdll/loader.c.

I'm willing to hack up a fix for this if someone can point me
in the right direction.

Cheers,
Erik
-- 
-----------------------------------------------------------------
Erik de Castro Lopo
-----------------------------------------------------------------
Open Source and Free Software means that you never sacrifice quality
of the code for meeting deadlines set up by people not participating
directly in the software development process.


From dank at kegel.com  Sun Mar 30 09:34:35 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 30 Mar 2008 07:34:35 -0700
Subject: Two more janitorial tasks
Message-ID: <a71bd89a0803300734y23d02c86vbba9c1cb9673f735@mail.gmail.com>

> Use WriteConsoleW to output text to the console instead printf & co.

Unless output is redirected to a file, in which case you
have to jump through a couple hoops.  See
WCMD_output_asis_len().

If anybody breaks commandline usage again, I'm
gonna myrtlize 'em :-)
- Dan


From dank at kegel.com  Sun Mar 30 09:58:07 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 30 Mar 2008 07:58:07 -0700
Subject: Wine 1.0 status: T minus 68 days. 73 open bugs.
Message-ID: <a71bd89a0803300758i28654b00w17cc4ae5e0e6acfb@mail.gmail.com>

40 days to code freeze.

One bug fixed in last couple days:
9459   -unknown        8       FIFA 2007 crashes with the recent versions

One bug added:
12246  -unknown        0       "make test" gives different results
with and without warn+heap

One bug deferred:
4971 	-unknown 	3 	Corel Draw 12 demo install fails

History:
3/22: 87 bugs, 76 days to go
3/23: 82 bugs, 75 days to go
3/24: 78 bugs, 74 days to go
3/26: 74 bugs, 72 days to go
3/30: 73 bugs, 69 days to go

Here's the current list of open bugs:


5948 	-unknown 	1 	Star Trek: Armada does not install
5061 	-unknown 	6 	Copying from Windows Firefox in Wine and pasting to
Linux OpenOffice pastes metadata as data
7477 	-unknown 	1 	Uplink demo crashes
12097 	-unknown 	2 	Wine 1.0 should not ship out-of-sync resource translations
5055 	-unknown 	5 	Deleting files from a window in wine doesn't send
them to the Trash
5844 	-unknown 	11 	tray minimize
11281 	-unknown 	2 	CJK input many issues
10815 	-unknown 	2 	Cannot drag images into Adobe Photoshop 7 from the
web / desktop
5402 	-unknown 	0 	Trying to run PhotoStitch 3.1
7404 	-unknown 	2 	ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
9916 	-unknown 	6 	"make test" usually fails
9178 	-unknown 	7 	"hello world" dos program hangs
5024 	-unknown 	4 	Thief: Deadly Shadows crashes:page fault on read
access to 0x0000040c
12246 	-unknown 	0 	"make test" gives different results with and
without warn+heap
8125 	-unknown 	0 	Marratech 6.1 crashes on start
10147 	-unknown 	1 	Word Viewer 2003 - Tab behavior differs from Windows
9959 	-unknown 	8 	Make wine updates work even if the registry changed
556 	build-en 	1 	Reconcile the Windows and Wine spec files
1114 	comctl32 	2 	Winrar2.90/3.00: Comboex doesn't trigger a event
when you mouse-click in some value of it
2493 	comctl32 	2 	Multi-select listview: Shift-arrow up only selects
top two items
11681 	directx- 	14 	Add support for video overlay
5955 	directx- 	8 	DirectDrawCreate crash on non-OpenGL desktop
9030 	directx- 	0 	army men hangs on black screen
82 	document 	2 	Stabilize Winelib User Guide Table of Contents
638 	document 	9 	Document Wine debugging channels
9771 	gdi32 	38 	Steam Friends doesn't work (fails to render correctly
or refresh)
9926 	gdi32 	5 	gdi32.dll should not have exported function pointers
3270 	gdi32 	15 	Problem with minimized top-level windows
6519 	gdi32 	7 	Wine blacks out rotated font bitmap
7571 	gdi32 	1 	Accented character glyphs are mixed up with TrueType
fonts (affects e.g. Lotus Notes R5)
9484 	kernel32 	17 	Program refuses to run because of
ProtectCD/ProtectDISC copy-protection
5351 	kernel32 	9 	Windows Installer 3.1 cannot install because of
non-standard drive labeling
5541 	kernel32 	0 	WriteConsole can't write to stdout; affects e.g.
wsh's cscript's usage message
9039 	kernel32 	0 	GS-Auftrag Professional SQL aborts on startup
4733 	kernel32 	5 	Get optimized/compressed/packed executables (non-upx) working
7098 	mscoree 	1 	RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
5163 	msi 	12 	Office XP 2002 crashes on installation
8783 	ntdll 	12 	USB serial ports do not work
9356 	ntdll 	6 	Serial communication not working since wine-0.9.33
6607 	ole 	9 	Drag and Drop not working
2539 	ole 	3 	XDND (Drag and drop for X Windows) doesn't copy text
8095 	ole 	0 	PQ Teaching toy crashes
4770 	ole 	3 	BlackBerry Device Manager fails to install under wine
9942 	ole 	2 	Powerpoint Viewer 2007 crashes opening .pptx files
5926 	programs 	0 	Wine does not provide an implementation of winhlp32.exe
6254 	richedit 	4 	Installer infinite loop from rich text error
8898 	shdocvw 	0 	Run Time Error "445": Object doesn't support this
action in Europa Knowledgebase
9304 	shdocvw 	3 	Temple of Elemental Evil demo doesn't start - gui irresponsive
3546 	shdocvw 	2 	CLSID_InternetShortcut not available...
6095 	shdocvw 	12 	MOTD in counter-strike 1.6 and counter-strike
source does not render
8439 	shell32 	8 	Visual Studio .NET (7) install fails
10905 	shell32 	0 	thinstall firefox demo requires native msvcrt
9809 	shell32 	4 	Autodesk Revit Architecture 2008 install fails
11742 	shlwapi 	8 	Small .net 1.1 app (FastMD5 1.3) fails to start up
12074 	testcase 	2 	The conformance tests fail on Windows
6604 	tools 	2 	Ship icons for the wine-tools that can be used in .desktop files
8246 	urlmon 	3 	invoking htmlhelp:HtmlHelpW crashes wine
664 	user32 	6 	The help menu functionality inside programs is broken
(messaging problem)
4523 	user32 	5 	Can't copy from Firefox 1.5 and paste into OpenOffice
2 under Wine
3023 	user32 	5 	Orcad - "Place Part" never tries to put down a part
124 	wineserv 	2 	Review of Wine Server Protocol
11019 	winex11. 	3 	matlab r14 and r16 (7.0.4 and 7.3.0) and
WriteItNow3.1.0s hang if X in 24bpp mode
7372 	winex11. 	12 	can't copy and paste between gnome apps eg
openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
2368 	winex11. 	7 	Wine loses its X-Window when switching to another
virt. desktop in Fvwm
1990 	winex11. 	1 	modifier keys not released when switching desktop
10984 	winex11. 	5 	sun jre 5 update 10 installer hangs in 0.9.52
5623 	winex11. 	3 	GetAsyncKeyState wrong if querying process doesn't have focus
5828 	winex11. 	24 	Command and Conquer Generals (Zero Hour) doesn't
change the mouse cursor from the default X mouse
3297 	winex11. 	12 	UpdateWindow() doesn't call XFlush()
3711 	wininet 	1 	Musicmatch fails to install (missing registry key,
HTTP_HttpOpenRequest() problem)
5625 	wininet 	3 	Wine does not handle internet proxy settings conveniently
9787 	winsock 	47 	Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
12005 	wintab32 	0 	Regression in pressure sensitivity with wizardpen
tablet driver and Photoshop 7


From dank at kegel.com  Sun Mar 30 10:38:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 30 Mar 2008 08:38:30 -0700
Subject: Proposal: versioning .wine directory
Message-ID: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>

On the wine-users list, we're getting a lot of users who
have old or even ancient .wine directories, and
whose problems go away with a fresh .wine directory

Perhaps we should have wineprefixcreate stamp the version
of wine the .wine directory was created with,
make wine-1.0 refuse to run with pre-1.0 .wine
directories, and require that future versions
of wine run properly with .wine directories created
by any earlier stable release of wine.

It wouldn't be hard, at least at first, and it might save a lot of
support inquiries.  What say?


From truiken at gmail.com  Sun Mar 30 13:35:40 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 30 Mar 2008 13:35:40 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
Message-ID: <22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>

On Sun, Mar 30, 2008 at 10:38 AM, Dan Kegel <dank at kegel.com> wrote:
> On the wine-users list, we're getting a lot of users who
>  have old or even ancient .wine directories, and
>  whose problems go away with a fresh .wine directory
>
>  Perhaps we should have wineprefixcreate stamp the version
>  of wine the .wine directory was created with,
>  make wine-1.0 refuse to run with pre-1.0 .wine
>  directories, and require that future versions
>  of wine run properly with .wine directories created
>  by any earlier stable release of wine.
>
>  It wouldn't be hard, at least at first, and it might save a lot of
>  support inquiries.  What say?
>

I can't find a quote of it anywhere, but I believe that a stable
wineprefix was a requirement (or at least a wish) of 1.0.

-- 
James Hawkins


From austinenglish at gmail.com  Sun Mar 30 13:46:08 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 30 Mar 2008 13:46:08 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
Message-ID: <b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>

On Sun, Mar 30, 2008 at 1:35 PM, James Hawkins <truiken at gmail.com> wrote:
>
> On Sun, Mar 30, 2008 at 10:38 AM, Dan Kegel <dank at kegel.com> wrote:
>  > On the wine-users list, we're getting a lot of users who
>  >  have old or even ancient .wine directories, and
>  >  whose problems go away with a fresh .wine directory
>  >
>  >  Perhaps we should have wineprefixcreate stamp the version
>  >  of wine the .wine directory was created with,
>  >  make wine-1.0 refuse to run with pre-1.0 .wine
>  >  directories, and require that future versions
>  >  of wine run properly with .wine directories created
>  >  by any earlier stable release of wine.
>  >
>  >  It wouldn't be hard, at least at first, and it might save a lot of
>  >  support inquiries.  What say?
>  >
>
>  I can't find a quote of it anywhere, but I believe that a stable
>  wineprefix was a requirement (or at least a wish) of 1.0.
>
>  --
>  James Hawkins
>
>
>

http://bugs.winehq.org/show_bug.cgi?id=9959

My comment from the bug:
"How about a little file in .wine  or a registry key that is read upon running
wine, and should match the current wine version. If it doesn't, call
wineprefixcreate (or pop up an error saying that the registry is outdated),
which then updates that key to the current wine version. Shouldn't be too much
overhead and prevents quite a few problems."


From austinenglish at gmail.com  Sun Mar 30 13:46:08 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 30 Mar 2008 13:46:08 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
Message-ID: <b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>

On Sun, Mar 30, 2008 at 1:35 PM, James Hawkins <truiken at gmail.com> wrote:
>
> On Sun, Mar 30, 2008 at 10:38 AM, Dan Kegel <dank at kegel.com> wrote:
>  > On the wine-users list, we're getting a lot of users who
>  >  have old or even ancient .wine directories, and
>  >  whose problems go away with a fresh .wine directory
>  >
>  >  Perhaps we should have wineprefixcreate stamp the version
>  >  of wine the .wine directory was created with,
>  >  make wine-1.0 refuse to run with pre-1.0 .wine
>  >  directories, and require that future versions
>  >  of wine run properly with .wine directories created
>  >  by any earlier stable release of wine.
>  >
>  >  It wouldn't be hard, at least at first, and it might save a lot of
>  >  support inquiries.  What say?
>  >
>
>  I can't find a quote of it anywhere, but I believe that a stable
>  wineprefix was a requirement (or at least a wish) of 1.0.
>
>  --
>  James Hawkins
>
>
>

http://bugs.winehq.org/show_bug.cgi?id=9959

My comment from the bug:
"How about a little file in .wine  or a registry key that is read upon running
wine, and should match the current wine version. If it doesn't, call
wineprefixcreate (or pop up an error saying that the registry is outdated),
which then updates that key to the current wine version. Shouldn't be too much
overhead and prevents quite a few problems."


From mstefani at redhat.com  Sun Mar 30 14:04:51 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Sun, 30 Mar 2008 21:04:51 +0200
Subject: Wine 1.0 status: T minus 68 days. 73 open bugs.
In-Reply-To: <a71bd89a0803300758i28654b00w17cc4ae5e0e6acfb@mail.gmail.com>
References: <a71bd89a0803300758i28654b00w17cc4ae5e0e6acfb@mail.gmail.com>
Message-ID: <47EFE453.8030109@redhat.com>

Dan Kegel wrote:
> 40 days to code freeze.
> 
> One bug fixed in last couple days:
> 9459   -unknown        8       FIFA 2007 crashes with the recent versions
> 
> One bug added:
> 12246  -unknown        0       "make test" gives different results
> with and without warn+heap
> 
> One bug deferred:
> 4971 	-unknown 	3 	Corel Draw 12 demo install fails
> 
> History:
> 3/22: 87 bugs, 76 days to go
> 3/23: 82 bugs, 75 days to go
> 3/24: 78 bugs, 74 days to go
> 3/26: 74 bugs, 72 days to go
> 3/30: 73 bugs, 69 days to go
> 
> Here's the current list of open bugs:

> 12097 	-unknown 	2 	Wine 1.0 should not ship out-of-sync resource translations
This bug can be closed only after Wine 1.0 ships. There are a lot of
changes/cleanups at the moment that constantly break the translations.

bye
	michael


From stefan at codeweavers.com  Sun Mar 30 13:37:56 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 30 Mar 2008 20:37:56 +0200
Subject: Proposal: versioning .wine directory
In-Reply-To: <b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
Message-ID: <200803302037.56555.stefan@codeweavers.com>

Am Sonntag, 30. M?rz 2008 20:46:08 schrieb Austin English:
> My comment from the bug:
> "How about a little file in .wine  or a registry key that is read upon
> running wine, and should match the current wine version. If it doesn't,
> call wineprefixcreate (or pop up an error saying that the registry is
> outdated), which then updates that key to the current wine version.
> Shouldn't be too much overhead and prevents quite a few problems."
In the past I've had more problems with wineprefixcreate trashing my registry 
than I had with outdated registry entries. Especially if you have Internet 
Explorer or the DirectX SDK or runtime installed running wineprefixcreate has 
bad side effects.


From sbrown7 at umbc.edu  Sun Mar 30 15:01:09 2008
From: sbrown7 at umbc.edu (Steve Brown)
Date: Sun, 30 Mar 2008 16:01:09 -0400 (EDT)
Subject: find_dll_file ignoring WINEDLLPATH?
In-Reply-To: <20080330193741.cb5d53da.mle+win@mega-nerd.com>
References: <20080330122403.02d947a3.mle+win@mega-nerd.com>
	<20080330133113.a8a4a594.mle+win@mega-nerd.com>
	<78a7dad00803300038q654cb57buf87327ef7ab13a65@mail.gmail.com>
	<20080330193741.cb5d53da.mle+win@mega-nerd.com>
Message-ID: <Pine.LNX.4.64.0803301559420.17962@cadence2.gl.umbc.edu>

On Sun, 30 Mar 2008, Erik de Castro Lopo wrote:

> Your proposal of just copying the DLL is not a good solution in
> this case because the copied executable could get out of sync
> with the one in src/.libs, invalidating the tests.

You could add the copy to your makefile, so every time your .dll gets 
rebuilt, it gets automagically copied as needed.

Steve Brown
sbrown7 at umbc.edu


From mstefani at redhat.com  Sun Mar 30 15:20:06 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Sun, 30 Mar 2008 22:20:06 +0200
Subject: Wine 1.0 status: T minus 68 days. 73 open bugs.
In-Reply-To: <3f4fd2640803301305p29cd0696i65c4f23254496cf@mail.gmail.com>
References: <a71bd89a0803300758i28654b00w17cc4ae5e0e6acfb@mail.gmail.com>	
	<47EFE453.8030109@redhat.com>
	<3f4fd2640803301305p29cd0696i65c4f23254496cf@mail.gmail.com>
Message-ID: <47EFF5F6.2090801@redhat.com>

Reece Dunn wrote:
> On 30/03/2008, Michael Stefaniuc <mstefani at redhat.com> wrote:
>> Dan Kegel wrote:
>>  > 40 days to code freeze.
>>  >
>>> 12097         -unknown        2       Wine 1.0 should not ship out-of-sync resource translations
>> This bug can be closed only after Wine 1.0 ships. There are a lot of
>>  changes/cleanups at the moment that constantly break the translations.
> 
> There should also be a resource freeze, during which only translators
> can modify the resources (i.e. no En.rc changes) to give them a chance
> to translate them.
> 
> Should this be done before the code freeze, or is the time during code
> freeze enough for the translations?
Code freeze should be enough. It's not so much about having everything
translated but more with having correct rc files. If somebody needs to
change an En.rc during code freeze he needs to update also the
translation rc files to keep them in sync (aka no missing menu or dialog
items, etc.).

See Mikolaj's page for broken rc files:
http://pf128.krakow.sdi.tpnet.pl/wine-transl/

bye
	michael


From m.b.lankhorst at gmail.com  Sun Mar 30 15:53:42 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 30 Mar 2008 13:53:42 -0700
Subject: user32: Implement BroadcastSystemMessage, try 5.1
In-Reply-To: <87zlsnnage.fsf@wine.dyndns.org>
References: <b130c85e0803240515y66991587x19c0cebb899d7461@mail.gmail.com>
	<87zlsnnage.fsf@wine.dyndns.org>
Message-ID: <b130c85e0803301353o5cfca3b0r7ac6247f5acee5af@mail.gmail.com>

Hello Alexandre,

2008/3/24, Alexandre Julliard <julliard at winehq.org>:
> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:
>
>  > +    TRACE("Flags: %08x, recipients: %p(0x%x), msg: %04x, wparam: %08lx, lparam: %08lx\n", flags, recipients,
>  > +         (recipients ? *recipients : recips), msg, wp, lp);
>  > +
>  > +    if (flags > BSF_LUID)
>
>  It doesn't make sense to compare flags with >. What are you trying to
>  check for?
>
>  > -}
>  > +    else
>  > +        FIXME("Recipients %08x not supported!\n", *recipients);
>  > +
>  > +    if (ret > 0 && !GetLastError())
>  > +        SetLastError(lasterror);
>
>  In general if you have to save and restore last error you are doing
>  something wrong.
Or wine is doing something wrong. After some more digging I found that
SetLastError() was set to 0 by TlsGetValue when called from X11DRV's
MsgWaitForMultipleObjectsEx. After I tried fixing this so that
SetLastError is only set when NULL is returned, one of the other tests
miraculously started working inside a todo block too (cursoricon).
I'll work on some testcases to verify that tlsgetvalue only calls
SetLastError(0) when succesfully returning null.

Cheers,
Maarten.


From julliard at winehq.org  Sun Mar 30 16:04:18 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sun, 30 Mar 2008 23:04:18 +0200
Subject: user32: Implement BroadcastSystemMessage, try 5.1
In-Reply-To: <b130c85e0803301353o5cfca3b0r7ac6247f5acee5af@mail.gmail.com>
	(Maarten Lankhorst's message of "Sun, 30 Mar 2008 13:53:42 -0700")
References: <b130c85e0803240515y66991587x19c0cebb899d7461@mail.gmail.com>
	<87zlsnnage.fsf@wine.dyndns.org>
	<b130c85e0803301353o5cfca3b0r7ac6247f5acee5af@mail.gmail.com>
Message-ID: <87y77zq5yl.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> Or wine is doing something wrong. After some more digging I found that
> SetLastError() was set to 0 by TlsGetValue when called from X11DRV's
> MsgWaitForMultipleObjectsEx. After I tried fixing this so that
> SetLastError is only set when NULL is returned, one of the other tests
> miraculously started working inside a todo block too (cursoricon).
> I'll work on some testcases to verify that tlsgetvalue only calls
> SetLastError(0) when succesfully returning null.

In most cases it's the test that is doing something wrong by being too
strict. We don't care whether last error is modified or not on success,
and there's no reason to test for it, unless it's one of the very few
functions that do something special on success, or unless there is a
real app that depends on it.

-- 
Alexandre Julliard
julliard at winehq.org


From austinenglish at gmail.com  Sun Mar 30 16:07:24 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 30 Mar 2008 16:07:24 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <200803302037.56555.stefan@codeweavers.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
Message-ID: <b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>

On Sun, Mar 30, 2008 at 1:37 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Sonntag, 30. M?rz 2008 20:46:08 schrieb Austin English:
>
> > My comment from the bug:
>  > "How about a little file in .wine  or a registry key that is read upon
>  > running wine, and should match the current wine version. If it doesn't,
>  > call wineprefixcreate (or pop up an error saying that the registry is
>  > outdated), which then updates that key to the current wine version.
>  > Shouldn't be too much overhead and prevents quite a few problems."
>  In the past I've had more problems with wineprefixcreate trashing my registry
>  than I had with outdated registry entries. Especially if you have Internet
>  Explorer or the DirectX SDK or runtime installed running wineprefixcreate has
>  bad side effects.
>

We could still store the version of wine last used and issue a (gui?)
warning if it's old/outdated telling the user to either run
wineprefixcreate, which may be bad in some cases, or to reinstall
their apps.

From truiken at gmail.com  Sun Mar 30 16:11:45 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 30 Mar 2008 16:11:45 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
	<b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>
Message-ID: <22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>

On Sun, Mar 30, 2008 at 4:07 PM, Austin English <austinenglish at gmail.com> wrote:
>
> On Sun, Mar 30, 2008 at 1:37 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
>  > Am Sonntag, 30. M?rz 2008 20:46:08 schrieb Austin English:
>  >
>  > > My comment from the bug:
>  >  > "How about a little file in .wine  or a registry key that is read upon
>  >  > running wine, and should match the current wine version. If it doesn't,
>  >  > call wineprefixcreate (or pop up an error saying that the registry is
>  >  > outdated), which then updates that key to the current wine version.
>  >  > Shouldn't be too much overhead and prevents quite a few problems."
>  >  In the past I've had more problems with wineprefixcreate trashing my registry
>  >  than I had with outdated registry entries. Especially if you have Internet
>  >  Explorer or the DirectX SDK or runtime installed running wineprefixcreate has
>  >  bad side effects.
>  >
>
>  We could still store the version of wine last used and issue a (gui?)
>  warning if it's old/outdated telling the user to either run
>  wineprefixcreate, which may be bad in some cases, or to reinstall
>  their apps.
>

You're missing the point of having a stable wine prefix.  After 1.0,
and assuming we can get a stable wine prefix, a user should never have
to reinstall their apps.

-- 
James Hawkins


From austinenglish at gmail.com  Sun Mar 30 16:14:20 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 30 Mar 2008 16:14:20 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
	<b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>
	<22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>
Message-ID: <b6bb06270803301414w7bdbc340s10e74cbaaa4beb5d@mail.gmail.com>

On Sun, Mar 30, 2008 at 4:11 PM, James Hawkins <truiken at gmail.com> wrote:
>
> On Sun, Mar 30, 2008 at 4:07 PM, Austin English <austinenglish at gmail.com> wrote:
>  >
>  > On Sun, Mar 30, 2008 at 1:37 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
>  >  > Am Sonntag, 30. M?rz 2008 20:46:08 schrieb Austin English:
>  >  >
>  >  > > My comment from the bug:
>  >  >  > "How about a little file in .wine  or a registry key that is read upon
>  >  >  > running wine, and should match the current wine version. If it doesn't,
>  >  >  > call wineprefixcreate (or pop up an error saying that the registry is
>  >  >  > outdated), which then updates that key to the current wine version.
>  >  >  > Shouldn't be too much overhead and prevents quite a few problems."
>  >  >  In the past I've had more problems with wineprefixcreate trashing my registry
>  >  >  than I had with outdated registry entries. Especially if you have Internet
>  >  >  Explorer or the DirectX SDK or runtime installed running wineprefixcreate has
>  >  >  bad side effects.
>  >  >
>  >
>  >  We could still store the version of wine last used and issue a (gui?)
>  >  warning if it's old/outdated telling the user to either run
>  >  wineprefixcreate, which may be bad in some cases, or to reinstall
>  >  their apps.
>  >
>
>  You're missing the point of having a stable wine prefix.  After 1.0,
>  and assuming we can get a stable wine prefix, a user should never have
>  to reinstall their apps.
>
>  --
>  James Hawkins
>

I was under the impression that we would still possibly require a
reinstall between major versions (1.0 -> 1.2, etc.). If not, then we
should focus on making sure wineprefixcreate doesn't trash the
registry.

From truiken at gmail.com  Sun Mar 30 16:17:17 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 30 Mar 2008 16:17:17 -0500
Subject: Proposal: versioning .wine directory
In-Reply-To: <b6bb06270803301414w7bdbc340s10e74cbaaa4beb5d@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
	<b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>
	<22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>
	<b6bb06270803301414w7bdbc340s10e74cbaaa4beb5d@mail.gmail.com>
Message-ID: <22821af30803301417k3a0357ffxab5a93eca69ba5fc@mail.gmail.com>

On Sun, Mar 30, 2008 at 4:14 PM, Austin English <austinenglish at gmail.com> wrote:
>
> On Sun, Mar 30, 2008 at 4:11 PM, James Hawkins <truiken at gmail.com> wrote:
>  >
>  > On Sun, Mar 30, 2008 at 4:07 PM, Austin English <austinenglish at gmail.com> wrote:
>  >  >
>  >  > On Sun, Mar 30, 2008 at 1:37 PM, Stefan D?singer <stefan at codeweavers.com> wrote:
>  >  >  > Am Sonntag, 30. M?rz 2008 20:46:08 schrieb Austin English:
>  >  >  >
>  >  >  > > My comment from the bug:
>  >  >  >  > "How about a little file in .wine  or a registry key that is read upon
>  >  >  >  > running wine, and should match the current wine version. If it doesn't,
>  >  >  >  > call wineprefixcreate (or pop up an error saying that the registry is
>  >  >  >  > outdated), which then updates that key to the current wine version.
>  >  >  >  > Shouldn't be too much overhead and prevents quite a few problems."
>  >  >  >  In the past I've had more problems with wineprefixcreate trashing my registry
>  >  >  >  than I had with outdated registry entries. Especially if you have Internet
>  >  >  >  Explorer or the DirectX SDK or runtime installed running wineprefixcreate has
>  >  >  >  bad side effects.
>  >  >  >
>  >  >
>  >  >  We could still store the version of wine last used and issue a (gui?)
>  >  >  warning if it's old/outdated telling the user to either run
>  >  >  wineprefixcreate, which may be bad in some cases, or to reinstall
>  >  >  their apps.
>  >  >
>  >
>  >  You're missing the point of having a stable wine prefix.  After 1.0,
>  >  and assuming we can get a stable wine prefix, a user should never have
>  >  to reinstall their apps.
>  >
>  >  --
>  >  James Hawkins
>  >
>
>  I was under the impression that we would still possibly require a
>  reinstall between major versions (1.0 -> 1.2, etc.). If not, then we
>  should focus on making sure wineprefixcreate doesn't trash the
>  registry.
>

If we have a stable wine prefix in 1.0, I don't see what could
possibly be added in 1.2 that would break that.  The idea is that,
even if you add a new dll that needs to be registered in, say, 1.0.5,
you still don't need to remove your wine prefix or reinstall any apps.

-- 
James Hawkins


From dank at kegel.com  Sun Mar 30 16:18:32 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 30 Mar 2008 14:18:32 -0700
Subject: Proposal: versioning .wine directory
In-Reply-To: <22821af30803301417k3a0357ffxab5a93eca69ba5fc@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
	<b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>
	<22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>
	<b6bb06270803301414w7bdbc340s10e74cbaaa4beb5d@mail.gmail.com>
	<22821af30803301417k3a0357ffxab5a93eca69ba5fc@mail.gmail.com>
Message-ID: <a71bd89a0803301418v143e5ef4v29288d1364bf03c8@mail.gmail.com>

On Sun, Mar 30, 2008 at 2:17 PM, James Hawkins <truiken at gmail.com> wrote:
>  If we have a stable wine prefix in 1.0, I don't see what could
>  possibly be added in 1.2 that would break that.  The idea is that,
>  even if you add a new dll that needs to be registered in, say, 1.0.5,
>  you still don't need to remove your wine prefix or reinstall any apps.

Can I bring the discussion back to my proposal,
which was to have wine-1.0 notice old, unsupported .wine
directories, and do something sensible?


From stefan at codeweavers.com  Sun Mar 30 17:04:25 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 31 Mar 2008 00:04:25 +0200
Subject: bugfix #12296
In-Reply-To: <47EFDCF2.5040206@online.de>
References: <47EFDCF2.5040206@online.de>
Message-ID: <200803310004.26228.stefan@codeweavers.com>

Am Sonntag, 30. M?rz 2008 20:33:22 schrieb Gregor M?nch:
> As discussed with stefand on irc:
> | feel free to send a patch adding that, it is needed

> - * Copyright 2006-2007 Stefan D?singer for CodeWeavers
> + * Copyright 2006-2007 Stefan D???singer for CodeWeavers
Watch out with the encoding... I think the general consent is to leave that 
character as it is until we have decided on a preferred Wine source file 
encoding.

The background story is that we throw away the sysmem copy of the surface, so 
we have to remove SFLAG_INSYSMEM. This might drop the last remaining 
location. Since we do not backup any contents of primaries and depth stencil, 
we can label the DRAWABLE as most up to date, this prevents needless loading 
attempts on the next draw.

So the patch is correct and should be applied, appart of the change to my 
name...



From scott at open-vote.org  Sun Mar 30 17:08:50 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Sun, 30 Mar 2008 15:08:50 -0700
Subject: Proposal: versioning .wine directory
In-Reply-To: <a71bd89a0803301418v143e5ef4v29288d1364bf03c8@mail.gmail.com>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>	<200803302037.56555.stefan@codeweavers.com>	<b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>	<22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>	<b6bb06270803301414w7bdbc340s10e74cbaaa4beb5d@mail.gmail.com>	<22821af30803301417k3a0357ffxab5a93eca69ba5fc@mail.gmail.com>
	<a71bd89a0803301418v143e5ef4v29288d1364bf03c8@mail.gmail.com>
Message-ID: <47F00F72.2090905@open-vote.org>

Dan Kegel wrote:
> On Sun, Mar 30, 2008 at 2:17 PM, James Hawkins <truiken at gmail.com> wrote:
>>  If we have a stable wine prefix in 1.0, I don't see what could
>>  possibly be added in 1.2 that would break that.  The idea is that,
>>  even if you add a new dll that needs to be registered in, say, 1.0.5,
>>  you still don't need to remove your wine prefix or reinstall any apps.
> 
> Can I bring the discussion back to my proposal,
> which was to have wine-1.0 notice old, unsupported .wine
> directories, and do something sensible?
> 
> 

If we're going to force users to remake ~/.wine, it would be ideal if we
only did that once.  Then we could provide some sort of upgrade path if
wineprefix changed again for some reason.

I'm wondering if the case-insensitive FUSE project could be finished in
time - this would allow us to both get a stable wineprefix and a
case-insensitive .wine folder.  This would save us the hassle of having
to worry about converting case-sensitive but proper-prefixed .wine folders.

Thanks,
Scott Ritchie


From hintak_leung at yahoo.co.uk  Sun Mar 30 12:35:26 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Sun, 30 Mar 2008 17:35:26 +0000 (GMT)
Subject: Don't bother...
In-Reply-To: <200803291951.48094.pure_evil@mail.bg>
Message-ID: <792997.74082.qm@web23105.mail.ird.yahoo.com>

--- On Sat, 29/3/08, pure_evil at mail.bg <pure_evil at mail.bg> wrote:

> From: pure_evil at mail.bg <pure_evil at mail.bg>
> Subject: Don't bother...
> To: "Hin-Tak Leung" <hintak_leung at yahoo.co.uk>
> Date: Saturday, 29 March, 2008, 5:51 PM
> I tried compiling it against wine's source tree, it spat
> out a bunch of 
> warnings. When I wrote to him, that's what he replied:
> 
> >guess what, that's a different compiler.
> 'winegcc' != 'mingw32'. Did I say 
> something about crosscompiling? AFAIK you dont (cant?) use
> stuff compiled 
> with winegcc on windows because it depends on wine.
> 
> >I just thought you might want to look at a sample that
> builds and lives 
> outside so you could test you code on win too.
> 
> So, it's not what you think it is :( It's not
> usable as wine driver.

I am a bit lost about your comments. I have both winegcc and mingw32. 
I am quite familar with the latter and new to the former. 
I am using the appropriate ones (mingw32 for the printproxy, and winegcc for ddiwrapper). 

The printerproxy needs cross-compiling (and it works alright against current wine), ddiwrapper needs to be built with winegcc (and does not build against current wine).



      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Inbox http://uk.docs.yahoo.com/nowyoucan.html


From msclrhd at googlemail.com  Sun Mar 30 15:05:02 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 30 Mar 2008 21:05:02 +0100
Subject: Wine 1.0 status: T minus 68 days. 73 open bugs.
In-Reply-To: <47EFE453.8030109@redhat.com>
References: <a71bd89a0803300758i28654b00w17cc4ae5e0e6acfb@mail.gmail.com>
	<47EFE453.8030109@redhat.com>
Message-ID: <3f4fd2640803301305p29cd0696i65c4f23254496cf@mail.gmail.com>

On 30/03/2008, Michael Stefaniuc <mstefani at redhat.com> wrote:
> Dan Kegel wrote:
>  > 40 days to code freeze.
>  >
> > 12097         -unknown        2       Wine 1.0 should not ship out-of-sync resource translations
>
> This bug can be closed only after Wine 1.0 ships. There are a lot of
>  changes/cleanups at the moment that constantly break the translations.

There should also be a resource freeze, during which only translators
can modify the resources (i.e. no En.rc changes) to give them a chance
to translate them.

Should this be done before the code freeze, or is the time during code
freeze enough for the translations?

- Reece


From dank at kegel.com  Sun Mar 30 17:12:37 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 30 Mar 2008 15:12:37 -0700
Subject: Proposal: versioning .wine directory
In-Reply-To: <47F00F72.2090905@open-vote.org>
References: <a71bd89a0803300838j438965alaa1af35f50e13e1a@mail.gmail.com>
	<22821af30803301135x3b584ef4j1dc6c2d2574ddb45@mail.gmail.com>
	<b6bb06270803301146t1fc093exda603020e8dfdb9a@mail.gmail.com>
	<200803302037.56555.stefan@codeweavers.com>
	<b6bb06270803301407l9c5bbf6u973eaf66e4d3888@mail.gmail.com>
	<22821af30803301411ld828a19yab285441b611bb6b@mail.gmail.com>
	<b6bb06270803301414w7bdbc340s10e74cbaaa4beb5d@mail.gmail.com>
	<22821af30803301417k3a0357ffxab5a93eca69ba5fc@mail.gmail.com>
	<a71bd89a0803301418v143e5ef4v29288d1364bf03c8@mail.gmail.com>
	<47F00F72.2090905@open-vote.org>
Message-ID: <a71bd89a0803301512k7c484eb5wf3dbbdd98b7f93e4@mail.gmail.com>

On Sun, Mar 30, 2008 at 3:08 PM, Scott Ritchie <scott at open-vote.org> wrote:
>  > Can I bring the discussion back to my proposal,
>  > which was to have wine-1.0 notice old, unsupported .wine
>  > directories, and do something sensible?
>
>  If we're going to force users to remake ~/.wine, it would be ideal if we
>  only did that once.  Then we could provide some sort of upgrade path if
>  wineprefix changed again for some reason.

Agreed.

>  I'm wondering if the case-insensitive FUSE project could be finished in
>  time - this would allow us to both get a stable wineprefix and a
>  case-insensitive .wine folder.  This would save us the hassle of having
>  to worry about converting case-sensitive but proper-prefixed .wine folders.

Not likely.  I don't even think it's a very good idea.
- Dan


From wine-devel at kievinfo.com  Sun Mar 30 17:17:37 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 30 Mar 2008 16:17:37 -0600
Subject: Wine 1.0 status: T minus 68 days. 73 open bugs.
In-Reply-To: <3f4fd2640803301305p29cd0696i65c4f23254496cf@mail.gmail.com>
References: <a71bd89a0803300758i28654b00w17cc4ae5e0e6acfb@mail.gmail.com>	<47EFE453.8030109@redhat.com>
	<3f4fd2640803301305p29cd0696i65c4f23254496cf@mail.gmail.com>
Message-ID: <47F01181.6090407@kievinfo.com>

Reece Dunn wrote:
> On 30/03/2008, Michael Stefaniuc <mstefani at redhat.com> wrote:
>> Dan Kegel wrote:
>>  > 40 days to code freeze.
>>  >
>>> 12097         -unknown        2       Wine 1.0 should not ship out-of-sync resource translations
>> This bug can be closed only after Wine 1.0 ships. There are a lot of
>>  changes/cleanups at the moment that constantly break the translations.
> 
> There should also be a resource freeze, during which only translators
> can modify the resources (i.e. no En.rc changes) to give them a chance
> to translate them.
> 
> Should this be done before the code freeze, or is the time during code
> freeze enough for the translations?
> 
Code freeze should be enough. IMHO 1 week to sync translations will be 
enough. So imposing an extra freeze is totally unnecessary.

Vitaliy.


From wine-devel at kievinfo.com  Sun Mar 30 17:24:41 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 30 Mar 2008 16:24:41 -0600
Subject: user32: Implement BroadcastSystemMessage, try 5.1
In-Reply-To: <87y77zq5yl.fsf@wine.dyndns.org>
References: <b130c85e0803240515y66991587x19c0cebb899d7461@mail.gmail.com>	<87zlsnnage.fsf@wine.dyndns.org>	<b130c85e0803301353o5cfca3b0r7ac6247f5acee5af@mail.gmail.com>
	<87y77zq5yl.fsf@wine.dyndns.org>
Message-ID: <47F01329.4050801@kievinfo.com>

Alexandre Julliard wrote:
> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:
> 
>> Or wine is doing something wrong. After some more digging I found that
>> SetLastError() was set to 0 by TlsGetValue when called from X11DRV's
>> MsgWaitForMultipleObjectsEx. After I tried fixing this so that
>> SetLastError is only set when NULL is returned, one of the other tests
>> miraculously started working inside a todo block too (cursoricon).
>> I'll work on some testcases to verify that tlsgetvalue only calls
>> SetLastError(0) when succesfully returning null.
> 
> In most cases it's the test that is doing something wrong by being too
> strict. We don't care whether last error is modified or not on success,
> and there's no reason to test for it, unless it's one of the very few
> functions that do something special on success, or unless there is a
> real app that depends on it.
> 
I remember sending the patch for this exact thing a while back, which you of 
course refused under the same pretense - showing a real life app that 
depends on it. So if tests are not a real life app that shows a difference 
between Wine and windows - then why do we bother with Wine at all? At least 
should change the moto to "might run some apps with loads of problems and 
never be 100% compatible".

One for sure will find an app that in one way or another depends on 
undocumented windows behavior. So if a test can be written to show a 
difference between Wine and windows. Then this difference should be fixed in 
Wine.

Vitaliy.



From wine.dev at web.de  Sun Mar 30 17:22:39 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Mon, 31 Mar 2008 00:22:39 +0200
Subject: DLL exports... HELP?! (wine based win32 printer drivers for
	openprinting)
In-Reply-To: <15655.45446.qm@web23112.mail.ird.yahoo.com>
References: <15655.45446.qm@web23112.mail.ird.yahoo.com>
Message-ID: <1206915760.7820.93.camel@p4>

On Sa, 2008-03-29 at 15:51 +0000, Hin-Tak Leung wrote:
> > - The ddiwrapper-hack works only with a very small amount
> > of self-contained drivers
> 
> Yes, but say, a GSOC project for distinguishing which are
> self-contained and which are not?
Only Usermode Printer Drivers (w2k and above) can work
(NT4 use Kernelmode Printer Drivers, which depends on "win32k.sys")

- use cabextract or unzip to get all files from the driver-installer
- use "wine expand.exe", when needed
- use winedump to get the imports for the driver
- Find the needed exports from gdi32.dll:
  $ grep " Eng"
  $ grep " [A-Z]*OBJ_"

- use winedump to get the exports
- to find the main driver dll and the driverui dll for later use:
  $ grep " Drv" 
  => DrvQueryDriverInfo is required for usermode Printer Drivers

> I haven't got round to look at ddiwrapper yet, but it is in my hard
> disc now. 

> > - Most Drivers today are plugins for the unidrv or the
> > pscipt5 Driver
> >   (you can install pscript5 from Adobe since ~ 1/2 Year)
> > - Drivers expect dlls, that are not present in wine-2005*
> >   (They will not load)
> > - Rendering with full Drivers (Raster-Mode) need most Eng*
> > Functions
> >   and Friends (This is the DIB-Engine).
> > - Rendering with full Drivers (Postscript) need some Eng*
> > Functions
> >   and Friends.
> >   Nothing in this Area is implemented / exported in current
> > Wine:
> >   Driver will not load
> 
> The time frame - GSOC work being a little after wine 1.0 (and the
> merge of the other work) - should be interesting and useful?

The implementation must be acceptable by Julliard.
My suggested way for an implementation:
1 Support "winspool" as Drivername in gdi32
  (gdi32 must use winspool.drv and winspool.drv must load and use
  the correct DriverUI)
  (Manage DEVMODEW and DeviceCapabilities. Use Dialogs)
2 The Dialogs for native Drivers would be nice at this stage, but this
  needs compstui.dll and printui.dll. The amount of work here is enough
  for a seperate SoC Project
3 Load and Initialize the native driver dll (ask winspool.drv for the
  real name) and expand the DC_FUNCTIONS array to store the results of
  DrvEnableDriver
4 Prefer the DDI-Functions over the current used API in all related
  gdi32 - Functions.
5 Pick one or more Windows Portscript-Driver and implement the needed
  Engine-Functions in gdi32.dll
6 Pick stupid Windows Raster-Drivers and implement the needed
  Engine-Functions in gdi32.dll
7 Pick other Windows Raster-Drivers and implement the needed
  Engine-Functions in gdi32.dll

The SoC 2007 Project of Marcel did #6 for a Canon Driver. 
Code is available, but the correct location is gdi32.dll

What is "Engine-Functions in gdi32.dll" ?
The famous DIB-Engine

> > - Sending the rendered Data to the Printer need sometimes a
> > vendor-
> >   specific Portmonitor / Languagemonitor
> >   (Not supported in current Wine)
> 
> Yes, I think the epson epl windows driver does that...

- grep "Initialize.*Monitor" exports_extracted_with_winedump.txt
  : InitializePrintMonitor2
  : InitializePrintMonitor
  : InitializeMonitorEx
  : InitializeMonitor
  => A Driver with a Portmonitor / Langemonitor does not work yet

  : InitializePrintMonitorUI
  => The Portmonitor User Interface works with a native printui.dll
  ( rundll32.exe printui.dll,PrintUIEntry /s /t 1 )
  (I use redmon 1.7 for testing)


> A personal question: would be like to be involved if a student comes
> along, or in general in this area? (I looked it up, you were the
> mentor for the 2007 wine project for the printerproxy).

In general in this Area, Please.


-- 
 
By by ... Detlef




From m.b.lankhorst at gmail.com  Sun Mar 30 17:47:19 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 30 Mar 2008 15:47:19 -0700
Subject: user32: Implement BroadcastSystemMessage, try 5.1
In-Reply-To: <87y77zq5yl.fsf@wine.dyndns.org>
References: <b130c85e0803240515y66991587x19c0cebb899d7461@mail.gmail.com>
	<87zlsnnage.fsf@wine.dyndns.org>
	<b130c85e0803301353o5cfca3b0r7ac6247f5acee5af@mail.gmail.com>
	<87y77zq5yl.fsf@wine.dyndns.org>
Message-ID: <b130c85e0803301547n73177c8ft7ac83b7db569e373@mail.gmail.com>

Hello Alexandre,

2008/3/30, Alexandre Julliard <julliard at winehq.org>:
> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:
>
>
> > Or wine is doing something wrong. After some more digging I found that
>  > SetLastError() was set to 0 by TlsGetValue when called from X11DRV's
>  > MsgWaitForMultipleObjectsEx. After I tried fixing this so that
>  > SetLastError is only set when NULL is returned, one of the other tests
>  > miraculously started working inside a todo block too (cursoricon).
>  > I'll work on some testcases to verify that tlsgetvalue only calls
>  > SetLastError(0) when succesfully returning null.
>
>
> In most cases it's the test that is doing something wrong by being too
>  strict. We don't care whether last error is modified or not on success,
>  and there's no reason to test for it, unless it's one of the very few
>  functions that do something special on success, or unless there is a
>  real app that depends on it.
Well, EnumWindows encourages applications to use setlasterror to set
an error message to pass a return value. Suppose if I took this
approach, and then called SendMessageTimeout from my enumeration
function, the last error would be useless because it's overwritten.
Adding a few lines to SendMessageTimeout confirms this behavior:
Windows doesn't overwrite the last error by default. I tracked where
it does timeout to that tlsgetvalue call in
MsgWaitForMultipleObjectsEx, which doesn't currently have last error
tests. I assume it doesn't change last error unless it returns null
and has success. This would fix SendMessageTimeout to act more like
windows and my BroadcastSystemMessage implementation.

And regarding 'there is no real life app that depends on it', too
often I find obscure problems with applications because wine does
something slightly different then windows does...

Cheers,
Maarten.


From wine.dev at web.de  Sun Mar 30 18:12:15 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Mon, 31 Mar 2008 01:12:15 +0200
Subject: wine based win32 printer drivers
In-Reply-To: <47EF10FC.2060905@gmx.net>
References: <15655.45446.qm@web23112.mail.ird.yahoo.com>
	<47EF10FC.2060905@gmx.net>
Message-ID: <1206918736.7820.140.camel@p4>

On So, 2008-03-30 at 06:03 +0200, Marcel Partap wrote:
> Anyways, I am working on getting something merged.. 

Great!

> For now the target is to get the Adobe pscript5 driver working which
> has its own raster renderer and thus does not depend on the dib
> engine. 
A Postscript Driver has no raster renderer...
A Postscript Driver has a Postscript Engine.

> Just started by making AddPrinter correctly get 
> a default devmode out of the driver, patch is attached, 

> DRIVER_EVENT_INITIALIZE, 3,
"3" is wrong here. See: myAddPrinterDriverEx(DWORD level, ...

Since there are much more Events, we need the DriverUI in more Places
later. I suggest a simple struct, which can be extended later
(The struct must include the Results from GetProcAddress)


The changes for winspool.drv must go in a seperate Patch.
WINSPOOL_CallDrvDocumentProperties is the wrong name, when you 
call DrvDocumentPropertySheets.

You should collect all API in winspool.drv, that need the driverui
(some are not implemented) and design a simple struct
with helper functions (Use monitor_t as example).
Not all Drivers Export DrvDocumentPropertySheets.
You must prepare to use a Fallback to get the default devmode
(DrvConvertDevMode)
See winspool.drv/monitor_load as Example:
- InitializePrintMonitor2 is suggested my MSDN, but not needed yet
- InitializePrintMonitor implemented
- InitializeMonitorEx and InitializeMonitor as Fallback.

The current Code is a crosscall from DocumentPropertiesW to
DocumentPropertiesA.
The DDI-API is unicode and should be the prefered way.
When wineps.drv is updated, the old code with the crosscall can be
removed, since we do not support ANSI Drivers (Windows 9x).

You can even use the same struct and helper functions 
in localspl.dll and winspool.drv


-- 
 
By by ... Detlef




From wine-devel at kievinfo.com  Sun Mar 30 20:13:46 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 30 Mar 2008 19:13:46 -0600
Subject: setupapi: prevent page faults in
	SetupDiDeleteDeviceInterfaceRegKey
In-Reply-To: <47F029C9.1060500@procyongames.com>
References: <47F029C9.1060500@procyongames.com>
Message-ID: <47F03ACA.5010308@kievinfo.com>

Christopher wrote:
> Changelog:
> Check that the handle and pointer passed to 
> SetupDiDeleteDeviceInterfaceRegKey are valid to read from. This patch 
> continues to address bug #12242
> 
> -    if (!DeviceInterfaceData ||
> +    if (!DeviceInterfaceData || IsBadReadPtr(DeviceInterfaceData, sizeof(SP_DEVICE_INTERFACE_DATA)) ||

Don't ever use IsBadReadPtr and IsBadWritePtr functions. They are bad and
even MS stopped using them. You have to use TRY-EXCEPT block around an
access to the memory. For example see implementation of lstrcpyA
(kernel32/string.c: 359).

> +    ok(!ret && GetLastError() == ERROR_INVALID_HANDLE, "Expected SetupDiDeleteDeviceInterfaceRegKey to return FALSE, got %s, \
> +with error code: 6, got %d\n", ret ? "TRUE" : "FALSE", GetLastError());

This is bad way to split strings in c. Do something like this:

    ok(!ret && GetLastError() == ERROR_INVALID_HANDLE,
	"Expected SetupDiDeleteDeviceInterfaceRegKey to return FALSE, got %s, "
	"with error code: 6, got %d\n", ret ? "TRUE" : "FALSE", GetLastError());

Vitaliy.


From mpartap at gmx.net  Sun Mar 30 22:52:32 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Mon, 31 Mar 2008 05:52:32 +0200
Subject: wine based win32 printer drivers
In-Reply-To: <1206918736.7820.140.camel@p4>
References: <15655.45446.qm@web23112.mail.ird.yahoo.com>	
	<47EF10FC.2060905@gmx.net> <1206918736.7820.140.camel@p4>
Message-ID: <47F06000.7050401@gmx.net>

> A Postscript Driver has no raster renderer...
> A Postscript Driver has a Postscript Engine.
... ^ ^

>> DRIVER_EVENT_INITIALIZE, 3,
> "3" is wrong here. See: myAddPrinterDriverEx(DWORD level, ...
It seemed suspicious to me anyway.. How do those integer shifts creep into my retyped header files 
again and again? mmmmhhh ... *g

> Since there are much more Events, we need the DriverUI in more Places
> later. I suggest a simple struct, which can be extended later
> (The struct must include the Results from GetProcAddress)
a struct.. that contains what? the function pointers and results? i had thought about adding a 
macro.. for hooking driver exports..

> The changes for winspool.drv must go in a seperate Patch.
yeah it jsut was a quick and dirty preview patch ;)

> WINSPOOL_CallDrvDocumentProperties is the wrong name, when you 
> call DrvDocumentPropertySheets.
statement totally makes sense.

> You should collect all API in winspool.drv, that need the driverui
> (some are not implemented) and design a simple struct
> with helper functions (Use monitor_t as example).
I dont really grok it... like the DDI_FUNCS array in the patch i sent you or rather somethign
stuct {
     LPWSTR name;
     LPWSTR driverdll;
     HMODULE hdriver;
     LPWSTR interfacedll;
     HMODULE hinterface,
     DWORD refcount;
} printertriver_t;
?

> Not all Drivers Export DrvDocumentPropertySheets.
> You must prepare to use a Fallback to get the default devmode
> (DrvConvertDevMode)
ok just need to transplant my old code

> See winspool.drv/monitor_load as Example:
l8r :)

> The current Code is a crosscall from DocumentPropertiesW to
> DocumentPropertiesA.
> The DDI-API is unicode and should be the prefered way.
so shall i put the ddi call before that deprecated stuff? and does it need to be called from docpropsA?
oh and I reodne the EnumForms patch (now less monsterous ;). Now here's only the part that provides 
the builtin forms, but very easy to expand, once its ready to be &/ comimtted i'll do the addforms 
delforms stuff..
and oh sh1t gotta write my soc application today last day heh.. this time i'm opting for drupal/php 
code though C/win32api is just too hellish *g
n8

-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0002-winspool-implement-EnumFormsA-W-with-built-in-forms.patch
Type: text/x-patch
Size: 0 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080331/cbf62e0d/attachment.bin 

From mpartap at gmx.net  Sun Mar 30 22:29:09 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Mon, 31 Mar 2008 05:29:09 +0200
Subject: [PATCH] winspool: implement EnumFormsA/W with built-in forms
Message-ID: <mailman.311.1206935570.3731.wine-devel@winehq.org>

---
 dlls/winspool.drv/info.c |  145 ++++++++++++++++++++++++++++++++++++++++++---
 1 files changed, 135 insertions(+), 10 deletions(-)

diff --git a/dlls/winspool.drv/info.c b/dlls/winspool.drv/info.c
index 351aaba..0071ef4 100644
--- a/dlls/winspool.drv/info.c
+++ b/dlls/winspool.drv/info.c
@@ -123,6 +123,17 @@ typedef struct {
     WCHAR *document_title;
 } job_t;
 
+typedef struct {
+    SIZEL size;
+    RECTL area;
+    DWORD formorder;
+    DWORD flags;
+} form_regentry_t;
+
+typedef struct {
+    WCHAR           formname[CCHFORMNAME];
+    form_regentry_t formdata;
+} builtin_form_t;
 
 typedef struct {
     LPCWSTR  envname;
@@ -248,6 +259,12 @@ static const WCHAR LPR_Port[] = {'L','P','R',':',0};
 static const WCHAR default_doc_title[] = {'L','o','c','a','l',' ','D','o','w','n','l','e','v','e','l',' ',
                                           'D','o','c','u','m','e','n','t',0};
 
+static const builtin_form_t builtin_forms[] = {
+    {{'L','e','t','t','e','r',0}, {{216000,279000}, {0,0,216000,279000}, 0, FORM_BUILTIN}},
+    {{'A','3',0}, {{297000,420000}, {0,0,297000,420000}, 0, FORM_BUILTIN}},
+    {{'A','4',0}, {{210000,297000}, {0,0,210000,297000}, 0, FORM_BUILTIN}},
+    {{'A','5',0}, {{148000,210000}, {0,0,148000,210000}, 0, FORM_BUILTIN}} };
+
 static const DWORD di_sizeof[] = {0, sizeof(DRIVER_INFO_1W), sizeof(DRIVER_INFO_2W),
                                      sizeof(DRIVER_INFO_3W), sizeof(DRIVER_INFO_4W),
                                      sizeof(DRIVER_INFO_5W), sizeof(DRIVER_INFO_6W),
@@ -7181,23 +7198,131 @@ BOOL WINAPI DeletePrintProvidorW(LPWSTR pName, LPWSTR pEnvironment, LPWSTR pPrin
 /******************************************************************************
  *      EnumFormsA (WINSPOOL.@)
  */
-BOOL WINAPI EnumFormsA( HANDLE hPrinter, DWORD Level, LPBYTE pForm,
-    DWORD cbBuf, LPDWORD pcbNeeded, LPDWORD pcReturned )
+BOOL WINAPI EnumFormsA(HANDLE hPrinter, DWORD Level, LPBYTE pForm,
+                       DWORD cbBuf, LPDWORD pcbNeeded, LPDWORD pcReturned)
 {
-    FIXME("%p %x %p %x %p %p\n", hPrinter, Level, pForm, cbBuf, pcbNeeded, pcReturned);
-    SetLastError(ERROR_CALL_NOT_IMPLEMENTED);
-    return FALSE;
+    PFORM_INFO_1A fiA;
+    PFORM_INFO_1W fiW;
+    LPBYTE bufferW;
+    BOOL   res;
+    DWORD  i;
+    DWORD  needed = 0;
+    DWORD  num = 0;
+
+    TRACE("(%p %d %p %d %p %p)\n", hPrinter, Level, pForm, cbBuf, pcbNeeded, pcReturned);
+
+    if (!pcbNeeded || !pcReturned) {
+        SetLastError(RPC_X_NULL_REF_POINTER);
+        return FALSE;
+    }
+    EnumFormsW(hPrinter, Level, NULL, 0, &needed, &num);
+    if (!needed)
+        return FALSE;
+    *pcbNeeded = (needed - num*sizeof(FORM_INFO_1W))/sizeof(WCHAR) + num*sizeof(FORM_INFO_1W);
+    if (cbBuf < *pcbNeeded) {
+        SetLastError(ERROR_INSUFFICIENT_BUFFER);
+        return FALSE;
+    }
+    if (!pForm) {
+        SetLastError(ERROR_INVALID_USER_BUFFER);
+        return FALSE;
+    }
+    bufferW = HeapAlloc(GetProcessHeap(), 0, needed);
+    res = EnumFormsW(hPrinter, Level, bufferW, needed, &needed, pcReturned);
+    if (res) {
+        fiA = (PFORM_INFO_1A)pForm;
+        fiW = (PFORM_INFO_1W)bufferW;
+        for (i = 0; i < *pcReturned; i++) {
+            memcpy(fiA, fiW, sizeof(FORM_INFO_1W));
+            cbBuf -= sizeof(FORM_INFO_1A);
+            cbBuf -= WideCharToMultiByte(CP_ACP, 0, fiW->pName, -1, fiA->pName, cbBuf, NULL, NULL);
+            fiA++;
+            fiW++;
+        }
+    }
+    HeapFree(GetProcessHeap(), 0, bufferW);
+    TRACE("returning %d with %d (%d Bytes for %d entries)\n", res, GetLastError(), *pcbNeeded, *pcReturned);
+    return res;
 }
 
 /******************************************************************************
  *      EnumFormsW (WINSPOOL.@)
+ * enumerates available paper forms (not printer specific)
+ * 
+ * PARAMS
+ *  hPrinter   (I) handle to printer (must be valid)
+ *  Level      (I) type of returned form information data structure
+ *  pForm      (O) pointer to user supplied buffer
+ *  cbBuf      (I) size of output buffer
+ *  pcbNeeded  (O) required/ used buffer space
+ *  pcReturned (O) number of returned forms
+ *
+ * RETURNS
+ *  Success: TRUE (non-zero value)
+ *  Failure: FALSE (0)
+ *
+ * FIXME
+ *  level 2 not yet implemented
  */
-BOOL WINAPI EnumFormsW( HANDLE hPrinter, DWORD Level, LPBYTE pForm,
-    DWORD cbBuf, LPDWORD pcbNeeded, LPDWORD pcReturned )
+BOOL WINAPI EnumFormsW(HANDLE hPrinter, DWORD Level, LPBYTE pForm,
+                       DWORD cbBuf, LPDWORD pcbNeeded, LPDWORD pcReturned)
 {
-    FIXME("%p %x %p %x %p %p\n", hPrinter, Level, pForm, cbBuf, pcbNeeded, pcReturned);
-    SetLastError(ERROR_CALL_NOT_IMPLEMENTED);
-    return FALSE;
+    opened_printer_t *printer = NULL;
+    PFORM_INFO_1W fiW;
+    LPWSTR strptr;
+    BOOL   res = FALSE;
+    DWORD  i;
+    DWORD  num;
+    DWORD  needed = 0;
+
+    TRACE("(%p %d %p %d %p %p)\n", hPrinter, Level, pForm, cbBuf, pcbNeeded, pcReturned);
+
+    if (!(printer = get_opened_printer(hPrinter))) {
+        SetLastError(ERROR_INVALID_HANDLE);
+        return FALSE;
+    }
+    if (Level != 1) {
+        if (Level == 2)
+            FIXME("level 2 not yet supported\n");
+        SetLastError(ERROR_INVALID_LEVEL);
+        return FALSE;
+    }
+
+    num = sizeof(builtin_forms)/sizeof(builtin_form_t);
+    for (i = 0; i < num; i++) {
+        needed += sizeof(FORM_INFO_1W) + (strlenW(builtin_forms[i].formname)+1)*sizeof(WCHAR);
+    }
+
+    if (cbBuf < needed) {
+        SetLastError(ERROR_INSUFFICIENT_BUFFER);
+        goto efw_cleanup;
+    }
+    if (!pForm) {
+        SetLastError(ERROR_INVALID_USER_BUFFER);
+        goto efw_cleanup;
+    }
+    if (!pcbNeeded || !pcReturned) {
+        SetLastError(RPC_X_NULL_REF_POINTER);
+        goto efw_cleanup;
+    }
+    strptr = (LPWSTR)(pForm + num*sizeof(FORM_INFO_1W));
+    fiW = (PFORM_INFO_1W)pForm;
+    for (i = 0; i < num; i++) {
+        fiW->pName = lstrcpyW(strptr, builtin_forms[i].formname);
+        fiW->Size = builtin_forms[i].formdata.size;
+        fiW->ImageableArea = builtin_forms[i].formdata.area;
+        fiW->Flags = builtin_forms[i].formdata.flags;
+        fiW++;
+        strptr += lstrlenW(builtin_forms[i].formname)+1;
+    }
+    res = TRUE;
+
+efw_cleanup:
+    if (pcbNeeded) *pcbNeeded = needed;
+    if (pcReturned && res) *pcReturned = num;
+
+    TRACE("returning %d with %d (%d Bytes for %d entries)\n", res, GetLastError(), needed, num);
+    return res;
 }
 
 /*****************************************************************************
-- 
1.5.4.4


--------------060407040401010404000601--


From juan.lang at gmail.com  Sun Mar 30 23:08:13 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Sun, 30 Mar 2008 21:08:13 -0700
Subject: ws2_32 janitorial questions
In-Reply-To: <fsm9tm$msj$1@ger.gmane.org>
References: <fsm9tm$msj$1@ger.gmane.org>
Message-ID: <3a768c550803302108x5b980f6av1eda8c583146a07e@mail.gmail.com>

>  ws2_32/async.c has the following global declarations:
>
>  /* protoptypes of some functions in socket.c
>   */
>  UINT16 wsaErrno(void);
>  UINT16 wsaHerrno(int errnr);
>
>  ws2_32/socket.c has the following global declarations:
>
>  UINT wsaErrno(void);
>  UINT wsaHerrno(int errnr);
>
>  Where are these functions defined? And, assuming that the above are
>  conflicting declarations, what type does each of these functions actually
>  return?

socket.c:
http://source.winehq.org/source/dlls/ws2_32/socket.c#L4055

They return UINTs.  The return types don't conflict if compiled with a
32-bit compiler, but the one in async.c at least looks incorrect.
--Juan


From stefandoesinger at gmx.at  Sun Mar 30 18:08:09 2008
From: stefandoesinger at gmx.at (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Mon, 31 Mar 2008 01:08:09 +0200
Subject: Direct3D shader compiler infrastructure
Message-ID: <200803310108.09269.stefandoesinger@gmx.at>

Hello,

So, I am getting serious about a shader compiler and related things now, and 
I've made a design proposal.

First of all, let us collect a few things we want regarding shader handling:
-> D3DXCompileShader & Friends
-> D3DXAssembleShader & Friends
-> D3DXDisassembleShader & Friends
-> A way to deal with d3d9 and d3d10 shader language differences

All these items are related in some way, so I am proposing the following 
design of a shader library:

The core part of the library is a wine internal shader language representing 
D3D assembler shaders. Shaders in this language can be created from D3D 
Bytecode("SlDisassembleShader"), D3D ASM("SlAssembleShader") and from 
HLSL("SlCompileShader"). From the intermediate language, D3D bytecode can be 
generated in various versions(SlGenBytecode), as well as D3D Text 
asm(SlGenAsm). Unlike regular D3D asm languages, this language does not have 
a version token, it is a superset of all asm language versions. It does have 
a pixel / vertex / geometry shader flag though.

The motivation behind an intermediate language is to avoid writing many 
different code generators, which is a big part of the HLSL compiler. We also 
need a WineD3D intermediate language to share our shader generator between 
d3d9 and d3d10, and use it for both kinds of shaders. The requirements for 
both intermediate asm languages are the same. This motivates making the 
language the same to reuse code.

With those functions, the D3DX functions are pretty streightforward:
D3DXAssembleShader:
bytecode = SlGenBytecode(SlAssembleShader(char *asm_text));

D3DXCompileShader:
bytecode = SlGenBytecode(SlCompileShader(char *hlsl_text));

D3DXDisassembleShader
asm_text = SlGenAsm(SlDisassembleShader(DWORD *bytecode));

WineD3D can be changed to use this shader language as shader input. In this 
case, d3d8, d3d9 and d3d10 run their shader bytecode through 
SlDisassembleShader, and pass the returned pointer to WineD3D. This in turn 
calls SlCopyShader to make a copy it owns, and d3d8/9/10 free their copy 
using SlDestroyShader.

With WineD3D working on the same language, we have to share the language 
definition between the shader library and WineD3D, or put the shader compiler 
into WineD3D as well. I do not like the 2nd way, as it puts things together 
that don't have to be in one lib, and wastes runtime memory. A 3rd way I have 
to consider was a SlReadShader() function with callbacks which takes over the 
current role of shader_generate_main() in WineD3D. I am not quite convinced 
by this either.

Attached are a few files for reference:
shaderlib.gif: A diagram explaining the roles of the languages(No, it is not 
UML 2.0)
uses.gif: Illustrating various uses of the shader library
shader-lang: A very early pseudocode definition of the language

The intermediate asm language follows the same principles as D3D bytecode. A 
shader contains any number of instructions, each instruction has one 
destination register and any number of source registers. The instructions 
have an opcode, writemask, modifiers. A register has a type, an index, 
information about relative addressing, source modifiers, and a swizzle.

Appart of the instructions, the shader contains a header with informations 
about the shader. Declarations, input/output semantics, special registers 
used, etc. This replaces the shader_get_registers_used() pass in WineD3D. It 
is done by the shader library, and it also generates the declarations for 1.x 
pixel shaders. (We still have to find out which texture type to read from in 
wined3d).

Thanks,
Stefan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: shaderlib.gif
Type: image/gif
Size: 19677 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080331/241fe54b/attachment-0002.gif 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: shader-lang
Type: text/x-csrc
Size: 812 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080331/241fe54b/attachment-0001.c 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: uses.gif
Type: image/gif
Size: 15819 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080331/241fe54b/attachment-0003.gif 

From hverbeet at gmail.com  Mon Mar 31 01:54:18 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 31 Mar 2008 08:54:18 +0200
Subject: Direct3D shader compiler infrastructure
In-Reply-To: <200803310108.09269.stefandoesinger@gmx.at>
References: <200803310108.09269.stefandoesinger@gmx.at>
Message-ID: <d658b69e0803302354v3b5f1dccufdc6a6c29a32fdc@mail.gmail.com>

On 31/03/2008, Stefan D?singer <stefandoesinger at gmx.at> wrote:
>  With WineD3D working on the same language, we have to share the language
>  definition between the shader library and WineD3D, or put the shader compiler
>  into WineD3D as well. I do not like the 2nd way, as it puts things together
>  that don't have to be in one lib, and wastes runtime memory. A 3rd way I have
>  to consider was a SlReadShader() function with callbacks which takes over the
>  current role of shader_generate_main() in WineD3D. I am not quite convinced
>  by this either.
>
Looks reasonable enough in general. I guess it would make sense to
create some kind of "shader utilities" library that can be used from
both wined3d and d3d9x. You could in principle even move GLSL/ARB code
generation in there, although that isn't required of course.


From leslie_alistair at hotmail.com  Mon Mar 31 03:14:51 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Mon, 31 Mar 2008 19:14:51 +1100
Subject: midl question
References: <fsg18l$7c2$1@ger.gmane.org> <47EB964E.7070101@codeweavers.com>
Message-ID: <fsq6h5$gia$1@ger.gmane.org>

Hi Rob,

What work would need to be done to get widl to support __stdcall?

Best Regards
 Alistair Leslie-Hughes



