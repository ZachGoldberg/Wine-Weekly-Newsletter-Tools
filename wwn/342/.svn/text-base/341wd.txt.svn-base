From dmitry at codeweavers.com  Fri Feb  1 00:09:12 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 1 Feb 2008 14:09:12 +0800
Subject: cabinet: Include wine/port.h for strcasecmp().
References: <22aa2f590801312129t183fc8fcne78f84b3ffc82b88@mail.gmail.com>
Message-ID: <004701c86498$f93a1900$a600fea9@DMITRY>

"Bang Jun-young" <junyoung at mogua.com> wrote

> cabinet: Include wine/port.h for strcasecmp().

If a Wine DLL uses strcasecmp() then it's a bug. It should
use an appropriate kernel32 API instead.

-- 
Dmitry.


From paul.vriens.wine at gmail.com  Fri Feb  1 01:01:08 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 01 Feb 2008 08:01:08 +0100
Subject: test.winehq.org
In-Reply-To: <3f4fd2640801311453i4587927dj2de20787e1b92a3e@mail.gmail.com>
References: <200801312340.56933.Stefan.Leichter@camline.com>
	<3f4fd2640801311453i4587927dj2de20787e1b92a3e@mail.gmail.com>
Message-ID: <47A2C3B4.6070906@gmail.com>

Reece Dunn wrote:
> On 31/01/2008, Stefan Leichter <Stefan.Leichter at camline.com> wrote:
>> Hello,
>>
>> i just noticed that the test results for advapi32:service tests are not
>> available for the last build (http://test.winehq.org/data/200801301937/). It
>> looks like the parser did not create the files.
>>
>> Can someone familar with this stuff have a look?
> 
> I noticed during the run on my Vista machine that the passed, failed,
> todo line for one of the tests outputted to the console. I don't know
> for which test it was though.
> 
> Also, the security tests (the previous one) have two output lines, e.g.:
> 
>   security: 18 tests executed (0 marked as todo, 0 failures), 0 skipped.
>   security: 944 tests executed (0 marked as todo, 0 failures), 1 skipped.
> 
> - Reece
> 
> 
> 
Multiple lines of output like that is common and taken care of by the framework.

AFAIK this usually happens when childprocesses/threads product output 
information like that.

-- 
Cheers,

Paul.


From paul.vriens.wine at gmail.com  Fri Feb  1 01:07:23 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 01 Feb 2008 08:07:23 +0100
Subject: test.winehq.org
In-Reply-To: <200801312340.56933.Stefan.Leichter@camline.com>
References: <200801312340.56933.Stefan.Leichter@camline.com>
Message-ID: <47A2C52B.4040808@gmail.com>

Stefan Leichter wrote:
> Hello,
> 
> i just noticed that the test results for advapi32:service tests are not 
> available for the last build (http://test.winehq.org/data/200801301937/). It 
> looks like the parser did not create the files. 
> 
> Can someone familar with this stuff have a look?
> 
> Thanks Stefan
> 
> 
> 
I don't think it has something to do with the testsuite but rather with some 
oddity of the webserver/browser.

When you click on the service test for 
http://test.winehq.org/data/200801301937/2003_fg-win2003es/advapi32:service.txt
you get an empty page.

When you however go to the directory 
http://test.winehq.org/data/200801301937/2003_fg-win2003es/ you will see that 
the file is there. But I can't download it though.

When I now look at the test.winehq.org server itself:

pvriens at wine:/home/winehq/opt/winetest/data/200801301937/2003_fg-win2003es$ more 
advapi32\:service.txt
service.c:941: Test failed: expected error ERROR_INVALID_ADDRESS, got 122
service: 196 tests executed (0 marked as todo, 1 failure), 0 skipped.

-- 
Cheers,

Paul.


From dmitry at codeweavers.com  Fri Feb  1 03:06:27 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 1 Feb 2008 17:06:27 +0800
Subject: cabinet: Include wine/port.h for strcasecmp().
References: <22aa2f590801312129t183fc8fcne78f84b3ffc82b88@mail.gmail.com>
	<004701c86498$f93a1900$a600fea9@DMITRY>
	<22aa2f590802010054i6aa9053eh1c00aead4e414f09@mail.gmail.com>
Message-ID: <008301c864b1$bbd90490$a600fea9@DMITRY>

"Bang Jun-young" <junyoung at mogua.com> wrote:

>> > cabinet: Include wine/port.h for strcasecmp().
>>
>> If a Wine DLL uses strcasecmp() then it's a bug. It should
>> use an appropriate kernel32 API instead.
> 
> I know, but it's too late. The tree is already contaminated with such
> functions and quite a number of other unnecessary Wine-specific APIs
> which shouldn't have been in the first place.

It doesn't mean that instead of replacing them you can simply make
an impression that it's OK to just hide the bug.

-- 
Dmitry.


From lats at yless4u.com.au  Fri Feb  1 04:06:55 2008
From: lats at yless4u.com.au (Jeff Latimer)
Date: Fri, 01 Feb 2008 21:06:55 +1100
Subject: Review comparing Wine and Vista for running games
In-Reply-To: <22aa2f590801312150g1aac1d18vad41ad5a48a538b2@mail.gmail.com>
References: <a71bd89a0801311336j407c7c3ch43106656e93923c9@mail.gmail.com>
	<22aa2f590801312150g1aac1d18vad41ad5a48a538b2@mail.gmail.com>
Message-ID: <47A2EF3F.8000700@yless4u.com.au>

Bang Jun-young wrote:
> I think this kind of a silly game doesn't help Wine as much...
>   
It may not be a help but like they say "there's not such thing as bad 
publicity".  A lot more people hear of Wine is better than not hearing 
about it.


From fgouget at free.fr  Fri Feb  1 05:05:17 2008
From: fgouget at free.fr (Francois Gouget)
Date: Fri, 1 Feb 2008 12:05:17 +0100 (CET)
Subject: cabinet: Include wine/port.h for strcasecmp().
In-Reply-To: <008301c864b1$bbd90490$a600fea9@DMITRY>
References: <22aa2f590801312129t183fc8fcne78f84b3ffc82b88@mail.gmail.com>
	<004701c86498$f93a1900$a600fea9@DMITRY>
	<22aa2f590802010054i6aa9053eh1c00aead4e414f09@mail.gmail.com>
	<008301c864b1$bbd90490$a600fea9@DMITRY>
Message-ID: <alpine.DEB.0.999999.0802011156240.16599@amboise.dolphin>



"Bang Jun-young" <junyoung at mogua.com> wrote:

>> > cabinet: Include wine/port.h for strcasecmp().
>>
>> If a Wine DLL uses strcasecmp() then it's a bug. It should
>> use an appropriate kernel32 API instead.
> 
> I know, but it's too late. The tree is already contaminated with such
> functions and quite a number of other unnecessary Wine-specific APIs
> which shouldn't have been in the first place.

The situation is not all that bad. I count only 158 references to 
strcasecmp(). So reviewing and fixing those that are wrong seems quite 
feasible and would make a good janitorial task.

The rules are as follows:

 * For case insensitive comparisons of 'windows strings', a Windows 
   function must be used (stricmp() or similar).
 * For case insensitive comparisons of 'Unix strings', that is of 
   strings coming from the Unix world such as Unix filenames, then using 
   strcasecmp() is fine. However, in the Unix world it's not very common 
   to want to do case insensitive comparisons.
 * Comparing a 'windows string' with a unix one is out altogether 
   (whether case insensitive or not) because they may not even be in the 
   same encoding.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
     Linux, WinNT, MS-DOS - also known as the Good, the Bad and the Ugly.


From fgouget at free.fr  Fri Feb  1 05:14:44 2008
From: fgouget at free.fr (Francois Gouget)
Date: Fri, 1 Feb 2008 12:14:44 +0100 (CET)
Subject: test.winehq.org
In-Reply-To: <3f4fd2640801311453i4587927dj2de20787e1b92a3e@mail.gmail.com>
References: <200801312340.56933.Stefan.Leichter@camline.com>
	<3f4fd2640801311453i4587927dj2de20787e1b92a3e@mail.gmail.com>
Message-ID: <alpine.DEB.0.999999.0802011207150.16599@amboise.dolphin>

On Thu, 31 Jan 2008, Reece Dunn wrote:
[...]
> Also, the security tests (the previous one) have two output lines, e.g.:
> 
>   security: 18 tests executed (0 marked as todo, 0 failures), 0 skipped.
>   security: 944 tests executed (0 marked as todo, 0 failures), 1 skipped.

Yes, this typically happens when one does tests in a child process.
This is wrong because it breaks 'make xxx.ok'.

The reason is that the parent process does not know whether some tests 
failed in the child process or not, and thus it will return 0. Make will 
thus think that everything went well and so 'make xxx.ok' will succeed 
eventhough it should have failed.

Alexandre relies on 'make test' to give him a reliable result so this 
may/will cause him not to notice new test failures introduced by a patch 
if they happen in a child process.


In dlls/kernel32/tests/debugger.c I have code that passes data from the 
child process back to the parent so the tests can be done in the parent, 
specifically to avoid this problem. But maybe we should have a general 
mechanism to deal with this.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
     We are Pentium of Borg. You will be approximated. Division is futile.


From eric.pouech at orange.fr  Fri Feb  1 14:23:29 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Fri, 01 Feb 2008 21:23:29 +0100
Subject: What's needed to make gdb work again?
In-Reply-To: <47A159BF.60004@gmail.com>
References: <47A159BF.60004@gmail.com>
Message-ID: <47A37FC1.3060204@orange.fr>

Maarten Lankhorst a ?crit :
> Hi folks,
>
> I've been trying some debugging with kdbg (Graphical kde debugger), but
> it fails on wine because it can't attach to a process.
>
> While it is of course possible to use WINEDEBUG flags, I want to be able
> to use a full debugger, and not just deduce from logs what happened, but
> rather be able to see the corresponding lines of source as well. so
> would it be possible to make gdb work with winedbg again, and perhaps
> make it understand threads this time?
>
> Cheers,
> Maarten.
>
>
>
>
>   
???
winedbg works
winedbg --gdb works
kdbg works as well (look at the tips on the wine doc about setting up 
kdbg with winedbg and the gdb proxy...). it however requires a patch for 
the proxy that i'm about to send for newer gdb versions
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From junyoung at mogua.com  Fri Feb  1 16:36:16 2008
From: junyoung at mogua.com (Bang Jun-young)
Date: Sat, 2 Feb 2008 07:36:16 +0900
Subject: cabinet: Include wine/port.h for strcasecmp().
In-Reply-To: <alpine.DEB.0.999999.0802011156240.16599@amboise.dolphin>
References: <22aa2f590801312129t183fc8fcne78f84b3ffc82b88@mail.gmail.com>
	<004701c86498$f93a1900$a600fea9@DMITRY>
	<22aa2f590802010054i6aa9053eh1c00aead4e414f09@mail.gmail.com>
	<008301c864b1$bbd90490$a600fea9@DMITRY>
	<alpine.DEB.0.999999.0802011156240.16599@amboise.dolphin>
Message-ID: <22aa2f590802011436m46f26e36vf4efc282f759518d@mail.gmail.com>

On 2/1/08, Francois Gouget <fgouget at free.fr> wrote:
> The rules are as follows:
>
>  * For case insensitive comparisons of 'windows strings', a Windows
>    function must be used (stricmp() or similar).

In this case, KERNEL32 lstrcmpiA() would be more appropriate. In
general, using stricmp() in Win32 code should be discouraged since it
may cause unnecessary dependency on MSVCRT.

BTW, isn't there any documentation for Wine hackers WRT this?


From marcus at jet.franken.de  Sat Feb  2 13:03:55 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Sat, 2 Feb 2008 20:03:55 +0100
Subject: winex11.drv: Use bitwise NOT not logical NOT
In-Reply-To: <200802021743.27717.andrew.talbot@talbotville.com>
References: <200802021743.27717.andrew.talbot@talbotville.com>
Message-ID: <20080202190355.GA4609@galeere>

On Sat, Feb 02, 2008 at 05:43:27PM +0000, Andrew Talbot wrote:
> Changelog:
>     winex11.drv: Use bitwise NOT not logical NOT.
> 
> diff --git a/dlls/winex11.drv/settings.c b/dlls/winex11.drv/settings.c
> index d68b674..2cd36c7 100644
> --- a/dlls/winex11.drv/settings.c
> +++ b/dlls/winex11.drv/settings.c
> @@ -369,10 +369,10 @@ LONG X11DRV_ChangeDisplaySettingsEx( LPCWSTR devname, LPDEVMODEW devmode,
>                devmode->dmBitsPerPel,devmode->dmDisplayFrequency, handler_name);
>  
>          dwBpp = devmode->dmBitsPerPel;
> -        if (devmode->dmFields & DM_BITSPERPEL) def_mode &= !dwBpp;
> -        if (devmode->dmFields & DM_PELSWIDTH)  def_mode &= !devmode->dmPelsWidth;
> -        if (devmode->dmFields & DM_PELSHEIGHT) def_mode &= !devmode->dmPelsHeight;
> -        if (devmode->dmFields & DM_DISPLAYFREQUENCY) def_mode &= !devmode->dmDisplayFrequency;
> +        if (devmode->dmFields & DM_BITSPERPEL) def_mode &= ~dwBpp;
> +        if (devmode->dmFields & DM_PELSWIDTH)  def_mode &= ~devmode->dmPelsWidth;
> +        if (devmode->dmFields & DM_PELSHEIGHT) def_mode &= ~devmode->dmPelsHeight;
> +        if (devmode->dmFields & DM_DISPLAYFREQUENCY) def_mode &= ~devmode->dmDisplayFrequency;

I do not think this is right, def_mode is a boolean and we actually check for
not-0-being of various struct members.

Ciao, Marcus


From wine-devel at kievinfo.com  Sat Feb  2 13:54:28 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 02 Feb 2008 12:54:28 -0700
Subject: winex11.drv: Use bitwise NOT not logical NOT
In-Reply-To: <20080202190355.GA4609@galeere>
References: <200802021743.27717.andrew.talbot@talbotville.com>
	<20080202190355.GA4609@galeere>
Message-ID: <47A4CA74.3020301@kievinfo.com>

Marcus Meissner wrote:
> On Sat, Feb 02, 2008 at 05:43:27PM +0000, Andrew Talbot wrote:
>> Changelog:
>>     winex11.drv: Use bitwise NOT not logical NOT.
>>
>> diff --git a/dlls/winex11.drv/settings.c b/dlls/winex11.drv/settings.c
>> index d68b674..2cd36c7 100644
>> --- a/dlls/winex11.drv/settings.c
>> +++ b/dlls/winex11.drv/settings.c
>> @@ -369,10 +369,10 @@ LONG X11DRV_ChangeDisplaySettingsEx( LPCWSTR devname, LPDEVMODEW devmode,
>>                devmode->dmBitsPerPel,devmode->dmDisplayFrequency, handler_name);
>>  
>>          dwBpp = devmode->dmBitsPerPel;
>> -        if (devmode->dmFields & DM_BITSPERPEL) def_mode &= !dwBpp;
>> -        if (devmode->dmFields & DM_PELSWIDTH)  def_mode &= !devmode->dmPelsWidth;
>> -        if (devmode->dmFields & DM_PELSHEIGHT) def_mode &= !devmode->dmPelsHeight;
>> -        if (devmode->dmFields & DM_DISPLAYFREQUENCY) def_mode &= !devmode->dmDisplayFrequency;
>> +        if (devmode->dmFields & DM_BITSPERPEL) def_mode &= ~dwBpp;
>> +        if (devmode->dmFields & DM_PELSWIDTH)  def_mode &= ~devmode->dmPelsWidth;
>> +        if (devmode->dmFields & DM_PELSHEIGHT) def_mode &= ~devmode->dmPelsHeight;
>> +        if (devmode->dmFields & DM_DISPLAYFREQUENCY) def_mode &= ~devmode->dmDisplayFrequency;
> 
> I do not think this is right, def_mode is a boolean and we actually check for
> not-0-being of various struct members.
> 
Correct. What all that meant, is if app asks for something, but the value is 
  0, switch to default mode.

Also Andrew, have you actually ran tests to check of they still pass? Of 
course you need to run them in interactive mode:
export WINETEST_INTERACTIVE=1

Vitaliy.


From Andrew.Talbot at talbotville.com  Sat Feb  2 14:01:46 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 02 Feb 2008 20:01:46 +0000
Subject: winex11.drv: Use bitwise NOT not logical NOT
References: <200802021743.27717.andrew.talbot@talbotville.com>
	<20080202190355.GA4609@galeere>
Message-ID: <fo2i7a$gvf$1@ger.gmane.org>

Marcus Meissner wrote:

> I do not think this is right, def_mode is a boolean and we actually check
> for not-0-being of various struct members.
> 
> Ciao, Marcus

Hi Marcus,

You are correct. I should have studied the code more carefully.

Thanks,

-- Andy.




From Andrew.Talbot at talbotville.com  Sat Feb  2 14:12:52 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 02 Feb 2008 20:12:52 +0000
Subject: winex11.drv: Use bitwise NOT not logical NOT
References: <200802021743.27717.andrew.talbot@talbotville.com>
	<20080202190355.GA4609@galeere> <47A4CA74.3020301@kievinfo.com>
Message-ID: <fo2is4$gvf$2@ger.gmane.org>

Vitaliy Margolen wrote:

> Marcus Meissner wrote:
>> On Sat, Feb 02, 2008 at 05:43:27PM +0000, Andrew Talbot wrote:

> Correct. What all that meant, is if app asks for something, but the value
> is
>   0, switch to default mode.
> 

Yes. I wrongly mistook it to be a case of setting one group of flags in
accordance with another. I should have looked more carefully.

> Also Andrew, have you actually ran tests to check of they still pass? Of
> course you need to run them in interactive mode:
> export WINETEST_INTERACTIVE=1
> 

No, I'm guilty again. Thanks for the advice.

-- Andy.




From wine-devel at kievinfo.com  Sat Feb  2 15:38:27 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 02 Feb 2008 14:38:27 -0700
Subject: Resend patch from Norbert
In-Reply-To: <47A4CDC3.2030905@web.de>
References: <47A4CDC3.2030905@web.de>
Message-ID: <47A4E2D3.8050305@kievinfo.com>

Rico Sch?ller wrote:
> Hi,
> 
> I only resend a patch because it isn't in the todays git and the author 
> didn't answer for a while.
> 
> Cheers
> Rico
> 
> 
> ------------------------------------------------------------------------
> 
> 
> -    memcpy(pRect, &This->updateStateBlock->scissorRect, sizeof(pRect));
> +    memcpy(pRect, &This->updateStateBlock->scissorRect, sizeof(RECT));

To avoid such problems in the future one should use something like:

     *pRect = This->updateStateBlock->scissorRect;

Doing a quick search through wined3d I've found number of places with memcpy 
instead of simple assignment of one struct to another struct. This is a good 
janitorial task to get rid of memcpy where simple assignment will work.

Vitaliy.


From lich at math.spbu.ru  Sun Feb  3 05:33:53 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Sun, 3 Feb 2008 14:33:53 +0300
Subject: cabinet: Include wine/port.h for strcasecmp().
Message-ID: <200802031433.54001.lich@math.spbu.ru>


>The rules are as follows:

> * For case insensitive comparisons of 'windows strings', a Windows 
>   function must be used (stricmp() or similar).

and

>In this case, KERNEL32 lstrcmpiA() would be more appropriate. In
>general, using stricmp() in Win32 code should be discouraged since it
>may cause unnecessary dependency on MSVCRT.

Wine lstrcmpi is broken (bug #10767). There are cases GLIBC strcasecmp and 
Windows lstrcmpi handle correctly but wine not. Should we fix this first?

--
Kirill


From dmitry at codeweavers.com  Sun Feb  3 06:04:02 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 3 Feb 2008 20:04:02 +0800
Subject: cabinet: Include wine/port.h for strcasecmp().
References: <200802031433.54001.lich@math.spbu.ru>
Message-ID: <004e01c8665c$e071fc10$a600fea9@DMITRY>

"Kirill K. Smirnov" <lich at math.spbu.ru> wrote:

>>The rules are as follows:
> 
>> * For case insensitive comparisons of 'windows strings', a Windows 
>>   function must be used (stricmp() or similar).
> 
> and
> 
>>In this case, KERNEL32 lstrcmpiA() would be more appropriate. In
>>general, using stricmp() in Win32 code should be discouraged since it
>>may cause unnecessary dependency on MSVCRT.
> 
> Wine lstrcmpi is broken (bug #10767). There are cases GLIBC strcasecmp and 
> Windows lstrcmpi handle correctly but wine not. Should we fix this first?

The bug 10767 is a corner case, and nothing prevents using kernel32 APIs
to perform string comparisons in Wine (which we do). I don't think that
you want to use glibc string comparison functions to compare for instance
cyrillic strings in CP1251 (Wine) and UTF-8 (Linux) encodings. Still, the bug
10767 has an explanation for an incompatibility, so the problem should be
either solved on unicode.org side, or by patching libs/wine/cpmap.pl.

-- 
Dmitry.


From truiken at gmail.com  Sun Feb  3 13:47:37 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 3 Feb 2008 13:47:37 -0600
Subject: winehq.org down?
Message-ID: <22821af30802031147q285f61b3s6f3e0beac15a17df@mail.gmail.com>

Hey guys,

I'm having problems connecting to the winehq.org server.  Is this a known issue?

-- 
James Hawkins


From jwhite at winehq.org  Sun Feb  3 15:31:58 2008
From: jwhite at winehq.org (Jeremy White)
Date: Sun, 03 Feb 2008 15:31:58 -0600
Subject: winehq.org down?
In-Reply-To: <22821af30802031147q285f61b3s6f3e0beac15a17df@mail.gmail.com>
References: <22821af30802031147q285f61b3s6f3e0beac15a17df@mail.gmail.com>
Message-ID: <47A632CE.8060103@winehq.org>

James Hawkins wrote:
> Hey guys,
> 
> I'm having problems connecting to the winehq.org server.  Is this a known issue?
> 

The server has been getting locked up lately.  Jeremy Newman thinks it's related to
MySQL, as he's seen it running amok in conjunction with the crashes; he fears that
recent changes to the appdb code may have triggered this, but that's mostly speculation.

At this point, there is little hard data; there haven't been console or other obvious
log messages that would point at a source of the problem.  We do now have a mysql
log file, perhaps that will shed some light.

It's definitely increasing in frequency, though, as it's happened both days this
weekend.

Cheers,

Jeremy


From austinenglish at gmail.com  Sun Feb  3 15:31:12 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 3 Feb 2008 15:31:12 -0600
Subject: winehq.org down?
In-Reply-To: <22821af30802031147q285f61b3s6f3e0beac15a17df@mail.gmail.com>
References: <22821af30802031147q285f61b3s6f3e0beac15a17df@mail.gmail.com>
Message-ID: <b6bb06270802031331s10ec8a82g8488f4307ebfcd0d@mail.gmail.com>

On Feb 3, 2008 1:47 PM, James Hawkins <truiken at gmail.com> wrote:
> Hey guys,
>
> I'm having problems connecting to the winehq.org server.  Is this a known issue?
>
> --
> James Hawkins
>

Appdb/bugzilla/wiki/winehq.org are all fine here.

-Austin


From msclrhd at googlemail.com  Sun Feb  3 15:32:48 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 3 Feb 2008 21:32:48 +0000
Subject: winehq.org down?
In-Reply-To: <22821af30802031147q285f61b3s6f3e0beac15a17df@mail.gmail.com>
References: <22821af30802031147q285f61b3s6f3e0beac15a17df@mail.gmail.com>
Message-ID: <3f4fd2640802031332udc95bf1w9cb362c2ff4f4738@mail.gmail.com>

On 03/02/2008, James Hawkins <truiken at gmail.com> wrote:
> Hey guys,
>
> I'm having problems connecting to the winehq.org server.  Is this a known issue?

It's working my side. Is there a problem with your connection? Do
other sites work?

- Reece


From harrison at odyssey.apana.org.au  Sun Feb  3 23:30:58 2008
From: harrison at odyssey.apana.org.au (Mike Harrison)
Date: Mon, 04 Feb 2008 14:30:58 +0900
Subject: attempt to install Wine from source
Message-ID: <47A6A312.8000304@odyssey.apana.org.au>

Dear Sir;
This below is the config.log I got from trying to install Wine (a source 
archive from a British Linux mag) on to my AMD64 m/c under Debian 4.0. 
64 bit OS.
A similar message was obtained from an attempt to install Wine on my 
AMD64 laptop under Ubuntu 7.04. (not 64 bit).
 From the report log I can't identify just what went wrong.
My aim is to use Wine to run Windows XP applications on both machines, 
and if possible Windows Vista applic'ns on the laptop - both machines 
running 32 bit applic'ns. My first priority for this is MS Excel XP pro.

 From a brief visit to WineHQ today (the connection died for some 
unknown reason) I believe it may not be as straightforward a project as 
I had hoped. Please tell me either what I must do to load/install my 
Wine source package, or where I have to go for help to go a little further.
I prefer to load the sources I already have, plus supplementary 
programs, if that's possible.
Any advice you can give would be appreciated.
Thanks;
Mike Harrison


This file contains any messages produced by compilers while
running configure, to aid debugging if configure makes a mistake.

It was created by Wine configure 20050830, which was
generated by GNU Autoconf 2.59.  Invocation command line was

  $ ./configure -C --prefix=/usr/local

## --------- ##
## Platform. ##
## --------- ##

hostname = ultima
uname -m = x86_64
uname -r = 2.6.18-4-amd64
uname -s = Linux
uname -v = #1 SMP Mon Mar 26 11:36:53 CEST 2007

/usr/bin/uname -p = unknown
/bin/uname -X     = unknown

/bin/arch              = x86_64
/usr/bin/arch -k       = unknown
/usr/convex/getsysinfo = unknown
hostinfo               = unknown
/bin/machine           = unknown
/usr/bin/oslevel       = unknown
/bin/universe          = unknown

PATH: /usr/local/bin
PATH: /usr/bin
PATH: /bin
PATH: /usr/bin/X11
PATH: /usr/games


## ----------- ##
## Core tests. ##
## ----------- ##

configure:1249: creating cache config.cache
configure:1424: checking build system type
configure:1442: result: x86_64-unknown-linux-gnu
configure:1450: checking host system type
configure:1464: result: x86_64-unknown-linux-gnu
configure:1504: checking whether make sets $(MAKE)
configure:1524: result: yes
configure:1579: checking for gcc
configure:1605: result: gcc -m32
configure:1849: checking for C compiler version
configure:1852: gcc -m32 --version </dev/null >&5
./configure: line 1853: gcc: command not found
configure:1855: $? = 127
configure:1857: gcc -m32 -v </dev/null >&5
./configure: line 1858: gcc: command not found
configure:1860: $? = 127
configure:1862: gcc -m32 -V </dev/null >&5
./configure: line 1863: gcc: command not found
configure:1865: $? = 127
configure:1888: checking for C compiler default output file name
configure:1891: gcc -m32    conftest.c  >&5
./configure: line 1892: gcc: command not found
configure:1894: $? = 127
configure: failed program was:
| /* confdefs.h.  */
|
| #define PACKAGE_NAME "Wine"
| #define PACKAGE_TARNAME "wine"
| #define PACKAGE_VERSION "20050830"
| #define PACKAGE_STRING "Wine 20050830"
| #define PACKAGE_BUGREPORT "wine-devel at winehq.org"
| /* end confdefs.h.  */
|
| int
| main ()
| {
|
|   ;
|   return 0;
| }
configure:1933: error: C compiler cannot create executables
See `config.log' for more details.

## ---------------- ##
## Cache variables. ##
## ---------------- ##

ac_cv_build=x86_64-unknown-linux-gnu
ac_cv_build_alias=x86_64-unknown-linux-gnu
ac_cv_env_CC_set=
ac_cv_env_CC_value=
ac_cv_env_CFLAGS_set=
ac_cv_env_CFLAGS_value=
ac_cv_env_CPPFLAGS_set=
ac_cv_env_CPPFLAGS_value=
ac_cv_env_CPP_set=
ac_cv_env_CPP_value=
ac_cv_env_CXXFLAGS_set=
ac_cv_env_CXXFLAGS_value=
ac_cv_env_CXX_set=
ac_cv_env_CXX_value=
ac_cv_env_LDFLAGS_set=
ac_cv_env_LDFLAGS_value=
ac_cv_env_build_alias_set=
ac_cv_env_build_alias_value=
ac_cv_env_host_alias_set=
ac_cv_env_host_alias_value=
ac_cv_env_target_alias_set=
ac_cv_env_target_alias_value=
ac_cv_host=x86_64-unknown-linux-gnu
ac_cv_host_alias=x86_64-unknown-linux-gnu
ac_cv_prog_ac_ct_CC='gcc -m32'
ac_cv_prog_make_make_set=yes

## ----------------- ##
## Output variables. ##
## ----------------- ##

ALSALIBS=''
AR=''
ARTSCCONFIG=''
ARTSINCL=''
ARTSLIBS=''
AS='as --32'
AUDIOIOLIBS=''
BISON=''
BUILTINFLAG=''
CC='gcc -m32'
CFLAGS=''
COREFOUNDATIONLIB=''
CPP=''
CPPBIN=''
CPPFLAGS=''
CROSSCC=''
CROSSTEST=''
CROSSWINDRES=''
CRTLIBS=''
CURSESLIBS=''
CXX=''
CXXFLAGS=''
DEFS=''
DLLDEFS=''
DLLEXT=''
DLLFLAGS=''
DLLIBS=''
DLLTOOL=''
DLLWRAP=''
ECHO_C=''
ECHO_N='-n'
ECHO_T=''
EGREP=''
ESDCONFIG=''
ESDINCL=''
ESDLIBS=''
EXEEXT=''
EXTRACFLAGS=''
FONTFORGE=''
FONTSSUBDIRS=''
FREETYPEINCL=''
FREETYPELIBS=''
GLU32FILES=''
GLUT32FILES=''
GLUT_LIBS=''
ICULIBS=''
IMPLIBEXT=''
INSTALL_DATA=''
INSTALL_PROGRAM=''
INSTALL_SCRIPT=''
IOKITLIB=''
LCMSLIBS=''
LD='ld -m elf_i386'
LDAPLIBS=''
LDCONFIG=''
LDD=''
LDDLLFLAGS=''
LDEXECFLAGS=''
LDFLAGS=''
LDLIBWINEFLAGS=''
LDPATH=''
LDSHARED=''
LEX=''
LEXLIB=''
LEX_OUTPUT_ROOT=''
LIBEXT=''
LIBOBJS=''
LIBPTHREAD=''
LIBS=''
LINT=''
LINTFLAGS=''
LN=''
LN_S=''
LTLIBOBJS=''
MAIN_BINARY=''
NASLIBS=''
OBJEXT=''
OPENGLFILES=''
OPENGL_LIBS=''
PACKAGE_BUGREPORT='wine-devel at winehq.org'
PACKAGE_NAME='Wine'
PACKAGE_STRING='Wine 20050830'
PACKAGE_TARNAME='wine'
PACKAGE_VERSION='20050830'
PATH_SEPARATOR=':'
PKG_CONFIG=''
PRELINK=''
RANLIB=''
SANEINCL=''
SANELIBS=''
SET_MAKE=''
SHELL='/bin/sh'
SOCKETLIBS=''
STRIP=''
TOOLSDIR=''
WIN16_FILES='$(WIN16_FILES)'
WIN16_INSTALL='$(WIN16_INSTALL)'
WINDRES=''
WINE_BINARIES=''
XFILES=''
XLEX=''
XLIB=''
XML2INCL=''
XML2LIBS=''
X_CFLAGS=''
X_EXTRA_LIBS=''
X_LIBS=''
X_PRE_LIBS=''
ac_ct_AR=''
ac_ct_AS=''
ac_ct_CC='gcc -m32'
ac_ct_CPPBIN=''
ac_ct_CXX=''
ac_ct_DLLTOOL=''
ac_ct_DLLWRAP=''
ac_ct_LD=''
ac_ct_RANLIB=''
ac_ct_STRIP=''
ac_ct_WINDRES=''
bindir='${exec_prefix}/bin'
build='x86_64-unknown-linux-gnu'
build_alias=''
build_cpu='x86_64'
build_os='linux-gnu'
build_vendor='unknown'
datadir='${prefix}/share'
exec_prefix='NONE'
ft_devel2=''
ft_devel=''
host='x86_64-unknown-linux-gnu'
host_alias=''
host_cpu='i386'
host_os='linux-gnu'
host_vendor='unknown'
includedir='${prefix}/include'
infodir='${prefix}/info'
libdir='${exec_prefix}/lib'
libexecdir='${exec_prefix}/libexec'
localstatedir='${prefix}/var'
mandir='${prefix}/man'
oldincludedir='/usr/include'
prefix='/usr/local'
program_transform_name='s,x,x,'
sane_devel=''
sbindir='${exec_prefix}/sbin'
sharedstatedir='${prefix}/com'
sysconfdir='${prefix}/etc'
target_alias=''

## ------------- ##
## Output files. ##
## ------------- ##

MAKE_DLL_RULES=''
MAKE_IMPLIB_RULES=''
MAKE_LIB_RULES=''
MAKE_PROG_RULES=''
MAKE_RULES=''
MAKE_TEST_RULES=''

## ----------- ##
## confdefs.h. ##
## ----------- ##

#define PACKAGE_BUGREPORT "wine-devel at winehq.org"
#define PACKAGE_NAME "Wine"
#define PACKAGE_STRING "Wine 20050830"
#define PACKAGE_TARNAME "wine"
#define PACKAGE_VERSION "20050830"

configure: exit 77



From austinenglish at gmail.com  Mon Feb  4 08:04:08 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 4 Feb 2008 08:04:08 -0600
Subject: winehq.org down?
In-Reply-To: <3f4fd2640802031332udc95bf1w9cb362c2ff4f4738@mail.gmail.com>
References: <22821af30802031147q285f61b3s6f3e0beac15a17df@mail.gmail.com>
	<3f4fd2640802031332udc95bf1w9cb362c2ff4f4738@mail.gmail.com>
Message-ID: <b6bb06270802040604j6e93bf6bh40180738b9cc1341@mail.gmail.com>

On Feb 3, 2008 3:32 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
> On 03/02/2008, James Hawkins <truiken at gmail.com> wrote:
> > Hey guys,
> >
> > I'm having problems connecting to the winehq.org server.  Is this a known issue?
>
> It's working my side. Is there a problem with your connection? Do
> other sites work?
>
> - Reece
>

It's off and on...Seems to be up right now (and has been for a couple
hours), but earlier today was out.

-Austin


From jjmckenzie51 at sprintpcs.com  Mon Feb  4 09:11:50 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Mon, 04 Feb 2008 08:11:50 -0700
Subject: winehq.org down?
In-Reply-To: <b6bb06270802040604j6e93bf6bh40180738b9cc1341@mail.gmail.com>
References: <22821af30802031147q285f61b3s6f3e0beac15a17df@mail.gmail.com>
	<3f4fd2640802031332udc95bf1w9cb362c2ff4f4738@mail.gmail.com>
	<b6bb06270802040604j6e93bf6bh40180738b9cc1341@mail.gmail.com>
Message-ID: <47A72B36.40204@sprintpcs.com>

Austin English wrote:
> On Feb 3, 2008 3:32 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
>   
>> On 03/02/2008, James Hawkins <truiken at gmail.com> wrote:
>>     
>>> Hey guys,
>>>
>>> I'm having problems connecting to the winehq.org server.  Is this a known issue?
>>>       
>> It's working my side. Is there a problem with your connection? Do
>> other sites work?
>>
>> - Reece
>>
>>     
>
> It's off and on...Seems to be up right now (and has been for a couple
> hours), but earlier today was out.
>
>   
And bugs.winehq.org seemed to have crashed last night around 200 GMT.  
Of course, the problem may have been me.

James McKenzie


From spencercw at googlemail.com  Mon Feb  4 09:32:45 2008
From: spencercw at googlemail.com (Chris Spencer)
Date: Mon, 04 Feb 2008 15:32:45 +0000
Subject: attempt to install Wine from source
In-Reply-To: <47A6A312.8000304@odyssey.apana.org.au>
References: <47A6A312.8000304@odyssey.apana.org.au>
Message-ID: <47A7301D.6000003@googlemail.com>

You do not have the gcc compiler installed. On Ubuntu you will need to
install build-essentials (I think that's what it's called), and also run
'sudo apt-get build-dep wine'. I'm not sure what the process is on Debian.

Mike Harrison wrote:
> Dear Sir;
> This below is the config.log I got from trying to install Wine (a source 
> archive from a British Linux mag) on to my AMD64 m/c under Debian 4.0. 
> 64 bit OS.
> A similar message was obtained from an attempt to install Wine on my 
> AMD64 laptop under Ubuntu 7.04. (not 64 bit).
>  From the report log I can't identify just what went wrong.
> My aim is to use Wine to run Windows XP applications on both machines, 
> and if possible Windows Vista applic'ns on the laptop - both machines 
> running 32 bit applic'ns. My first priority for this is MS Excel XP pro.
> 
>  From a brief visit to WineHQ today (the connection died for some 
> unknown reason) I believe it may not be as straightforward a project as 
> I had hoped. Please tell me either what I must do to load/install my 
> Wine source package, or where I have to go for help to go a little further.
> I prefer to load the sources I already have, plus supplementary 
> programs, if that's possible.
> Any advice you can give would be appreciated.
> Thanks;
> Mike Harrison
> 
> 
> This file contains any messages produced by compilers while
> running configure, to aid debugging if configure makes a mistake.
> 
> It was created by Wine configure 20050830, which was
> generated by GNU Autoconf 2.59.  Invocation command line was
> 
>   $ ./configure -C --prefix=/usr/local
> 
> ## --------- ##
> ## Platform. ##
> ## --------- ##
> 
> hostname = ultima
> uname -m = x86_64
> uname -r = 2.6.18-4-amd64
> uname -s = Linux
> uname -v = #1 SMP Mon Mar 26 11:36:53 CEST 2007
> 
> /usr/bin/uname -p = unknown
> /bin/uname -X     = unknown
> 
> /bin/arch              = x86_64
> /usr/bin/arch -k       = unknown
> /usr/convex/getsysinfo = unknown
> hostinfo               = unknown
> /bin/machine           = unknown
> /usr/bin/oslevel       = unknown
> /bin/universe          = unknown
> 
> PATH: /usr/local/bin
> PATH: /usr/bin
> PATH: /bin
> PATH: /usr/bin/X11
> PATH: /usr/games
> 
> 
> ## ----------- ##
> ## Core tests. ##
> ## ----------- ##
> 
> configure:1249: creating cache config.cache
> configure:1424: checking build system type
> configure:1442: result: x86_64-unknown-linux-gnu
> configure:1450: checking host system type
> configure:1464: result: x86_64-unknown-linux-gnu
> configure:1504: checking whether make sets $(MAKE)
> configure:1524: result: yes
> configure:1579: checking for gcc
> configure:1605: result: gcc -m32
> configure:1849: checking for C compiler version
> configure:1852: gcc -m32 --version </dev/null >&5
> ./configure: line 1853: gcc: command not found
> configure:1855: $? = 127
> configure:1857: gcc -m32 -v </dev/null >&5
> ./configure: line 1858: gcc: command not found
> configure:1860: $? = 127
> configure:1862: gcc -m32 -V </dev/null >&5
> ./configure: line 1863: gcc: command not found
> configure:1865: $? = 127
> configure:1888: checking for C compiler default output file name
> configure:1891: gcc -m32    conftest.c  >&5
> ./configure: line 1892: gcc: command not found
> configure:1894: $? = 127
> configure: failed program was:
> | /* confdefs.h.  */
> |
> | #define PACKAGE_NAME "Wine"
> | #define PACKAGE_TARNAME "wine"
> | #define PACKAGE_VERSION "20050830"
> | #define PACKAGE_STRING "Wine 20050830"
> | #define PACKAGE_BUGREPORT "wine-devel at winehq.org"
> | /* end confdefs.h.  */
> |
> | int
> | main ()
> | {
> |
> |   ;
> |   return 0;
> | }
> configure:1933: error: C compiler cannot create executables
> See `config.log' for more details.
> 
> ## ---------------- ##
> ## Cache variables. ##
> ## ---------------- ##
> 
> ac_cv_build=x86_64-unknown-linux-gnu
> ac_cv_build_alias=x86_64-unknown-linux-gnu
> ac_cv_env_CC_set=
> ac_cv_env_CC_value=
> ac_cv_env_CFLAGS_set=
> ac_cv_env_CFLAGS_value=
> ac_cv_env_CPPFLAGS_set=
> ac_cv_env_CPPFLAGS_value=
> ac_cv_env_CPP_set=
> ac_cv_env_CPP_value=
> ac_cv_env_CXXFLAGS_set=
> ac_cv_env_CXXFLAGS_value=
> ac_cv_env_CXX_set=
> ac_cv_env_CXX_value=
> ac_cv_env_LDFLAGS_set=
> ac_cv_env_LDFLAGS_value=
> ac_cv_env_build_alias_set=
> ac_cv_env_build_alias_value=
> ac_cv_env_host_alias_set=
> ac_cv_env_host_alias_value=
> ac_cv_env_target_alias_set=
> ac_cv_env_target_alias_value=
> ac_cv_host=x86_64-unknown-linux-gnu
> ac_cv_host_alias=x86_64-unknown-linux-gnu
> ac_cv_prog_ac_ct_CC='gcc -m32'
> ac_cv_prog_make_make_set=yes
> 
> ## ----------------- ##
> ## Output variables. ##
> ## ----------------- ##
> 
> ALSALIBS=''
> AR=''
> ARTSCCONFIG=''
> ARTSINCL=''
> ARTSLIBS=''
> AS='as --32'
> AUDIOIOLIBS=''
> BISON=''
> BUILTINFLAG=''
> CC='gcc -m32'
> CFLAGS=''
> COREFOUNDATIONLIB=''
> CPP=''
> CPPBIN=''
> CPPFLAGS=''
> CROSSCC=''
> CROSSTEST=''
> CROSSWINDRES=''
> CRTLIBS=''
> CURSESLIBS=''
> CXX=''
> CXXFLAGS=''
> DEFS=''
> DLLDEFS=''
> DLLEXT=''
> DLLFLAGS=''
> DLLIBS=''
> DLLTOOL=''
> DLLWRAP=''
> ECHO_C=''
> ECHO_N='-n'
> ECHO_T=''
> EGREP=''
> ESDCONFIG=''
> ESDINCL=''
> ESDLIBS=''
> EXEEXT=''
> EXTRACFLAGS=''
> FONTFORGE=''
> FONTSSUBDIRS=''
> FREETYPEINCL=''
> FREETYPELIBS=''
> GLU32FILES=''
> GLUT32FILES=''
> GLUT_LIBS=''
> ICULIBS=''
> IMPLIBEXT=''
> INSTALL_DATA=''
> INSTALL_PROGRAM=''
> INSTALL_SCRIPT=''
> IOKITLIB=''
> LCMSLIBS=''
> LD='ld -m elf_i386'
> LDAPLIBS=''
> LDCONFIG=''
> LDD=''
> LDDLLFLAGS=''
> LDEXECFLAGS=''
> LDFLAGS=''
> LDLIBWINEFLAGS=''
> LDPATH=''
> LDSHARED=''
> LEX=''
> LEXLIB=''
> LEX_OUTPUT_ROOT=''
> LIBEXT=''
> LIBOBJS=''
> LIBPTHREAD=''
> LIBS=''
> LINT=''
> LINTFLAGS=''
> LN=''
> LN_S=''
> LTLIBOBJS=''
> MAIN_BINARY=''
> NASLIBS=''
> OBJEXT=''
> OPENGLFILES=''
> OPENGL_LIBS=''
> PACKAGE_BUGREPORT='wine-devel at winehq.org'
> PACKAGE_NAME='Wine'
> PACKAGE_STRING='Wine 20050830'
> PACKAGE_TARNAME='wine'
> PACKAGE_VERSION='20050830'
> PATH_SEPARATOR=':'
> PKG_CONFIG=''
> PRELINK=''
> RANLIB=''
> SANEINCL=''
> SANELIBS=''
> SET_MAKE=''
> SHELL='/bin/sh'
> SOCKETLIBS=''
> STRIP=''
> TOOLSDIR=''
> WIN16_FILES='$(WIN16_FILES)'
> WIN16_INSTALL='$(WIN16_INSTALL)'
> WINDRES=''
> WINE_BINARIES=''
> XFILES=''
> XLEX=''
> XLIB=''
> XML2INCL=''
> XML2LIBS=''
> X_CFLAGS=''
> X_EXTRA_LIBS=''
> X_LIBS=''
> X_PRE_LIBS=''
> ac_ct_AR=''
> ac_ct_AS=''
> ac_ct_CC='gcc -m32'
> ac_ct_CPPBIN=''
> ac_ct_CXX=''
> ac_ct_DLLTOOL=''
> ac_ct_DLLWRAP=''
> ac_ct_LD=''
> ac_ct_RANLIB=''
> ac_ct_STRIP=''
> ac_ct_WINDRES=''
> bindir='${exec_prefix}/bin'
> build='x86_64-unknown-linux-gnu'
> build_alias=''
> build_cpu='x86_64'
> build_os='linux-gnu'
> build_vendor='unknown'
> datadir='${prefix}/share'
> exec_prefix='NONE'
> ft_devel2=''
> ft_devel=''
> host='x86_64-unknown-linux-gnu'
> host_alias=''
> host_cpu='i386'
> host_os='linux-gnu'
> host_vendor='unknown'
> includedir='${prefix}/include'
> infodir='${prefix}/info'
> libdir='${exec_prefix}/lib'
> libexecdir='${exec_prefix}/libexec'
> localstatedir='${prefix}/var'
> mandir='${prefix}/man'
> oldincludedir='/usr/include'
> prefix='/usr/local'
> program_transform_name='s,x,x,'
> sane_devel=''
> sbindir='${exec_prefix}/sbin'
> sharedstatedir='${prefix}/com'
> sysconfdir='${prefix}/etc'
> target_alias=''
> 
> ## ------------- ##
> ## Output files. ##
> ## ------------- ##
> 
> MAKE_DLL_RULES=''
> MAKE_IMPLIB_RULES=''
> MAKE_LIB_RULES=''
> MAKE_PROG_RULES=''
> MAKE_RULES=''
> MAKE_TEST_RULES=''
> 
> ## ----------- ##
> ## confdefs.h. ##
> ## ----------- ##
> 
> #define PACKAGE_BUGREPORT "wine-devel at winehq.org"
> #define PACKAGE_NAME "Wine"
> #define PACKAGE_STRING "Wine 20050830"
> #define PACKAGE_TARNAME "wine"
> #define PACKAGE_VERSION "20050830"
> 
> configure: exit 77
> 
> 
> 


From jgardou at yahoo.fr  Mon Feb  4 10:01:52 2008
From: jgardou at yahoo.fr (=?iso-8859-1?q?Gardou=20J=E9r=F4me?=)
Date: Mon, 4 Feb 2008 17:01:52 +0100 (CET)
Subject: attempt to install Wine from source
In-Reply-To: <47A7301D.6000003@googlemail.com>
Message-ID: <233864.92546.qm@web25001.mail.ukl.yahoo.com>

By the way, 20050803 seems to be a very old source package.

Chris Spencer <spencercw at googlemail.com> a ?crit : You do not have the gcc compiler installed. On Ubuntu you will need to
install build-essentials (I think that's what it's called), and also run
'sudo apt-get build-dep wine'. I'm not sure what the process is on Debian.

Mike Harrison wrote:
> Dear Sir;
> This below is the config.log I got from trying to install Wine (a source 
> archive from a British Linux mag) on to my AMD64 m/c under Debian 4.0. 
> 64 bit OS.
> A similar message was obtained from an attempt to install Wine on my 
> AMD64 laptop under Ubuntu 7.04. (not 64 bit).
>  From the report log I can't identify just what went wrong.
> My aim is to use Wine to run Windows XP applications on both machines, 
> and if possible Windows Vista applic'ns on the laptop - both machines 
> running 32 bit applic'ns. My first priority for this is MS Excel XP pro.
> 
>  From a brief visit to WineHQ today (the connection died for some 
> unknown reason) I believe it may not be as straightforward a project as 
> I had hoped. Please tell me either what I must do to load/install my 
> Wine source package, or where I have to go for help to go a little further.
> I prefer to load the sources I already have, plus supplementary 
> programs, if that's possible.
> Any advice you can give would be appreciated.
> Thanks;
> Mike Harrison
> 
> 
> This file contains any messages produced by compilers while
> running configure, to aid debugging if configure makes a mistake.
> 
> It was created by Wine configure 20050830, which was
> generated by GNU Autoconf 2.59.  Invocation command line was
> 
>   $ ./configure -C --prefix=/usr/local
> 
> ## --------- ##
> ## Platform. ##
> ## --------- ##
> 
> hostname = ultima
> uname -m = x86_64
> uname -r = 2.6.18-4-amd64
> uname -s = Linux
> uname -v = #1 SMP Mon Mar 26 11:36:53 CEST 2007
> 
> /usr/bin/uname -p = unknown
> /bin/uname -X     = unknown
> 
> /bin/arch              = x86_64
> /usr/bin/arch -k       = unknown
> /usr/convex/getsysinfo = unknown
> hostinfo               = unknown
> /bin/machine           = unknown
> /usr/bin/oslevel       = unknown
> /bin/universe          = unknown
> 
> PATH: /usr/local/bin
> PATH: /usr/bin
> PATH: /bin
> PATH: /usr/bin/X11
> PATH: /usr/games
> 
> 
> ## ----------- ##
> ## Core tests. ##
> ## ----------- ##
> 
> configure:1249: creating cache config.cache
> configure:1424: checking build system type
> configure:1442: result: x86_64-unknown-linux-gnu
> configure:1450: checking host system type
> configure:1464: result: x86_64-unknown-linux-gnu
> configure:1504: checking whether make sets $(MAKE)
> configure:1524: result: yes
> configure:1579: checking for gcc
> configure:1605: result: gcc -m32
> configure:1849: checking for C compiler version
> configure:1852: gcc -m32 --version &5
> ./configure: line 1853: gcc: command not found
> configure:1855: $? = 127
> configure:1857: gcc -m32 -v &5
> ./configure: line 1858: gcc: command not found
> configure:1860: $? = 127
> configure:1862: gcc -m32 -V &5
> ./configure: line 1863: gcc: command not found
> configure:1865: $? = 127
> configure:1888: checking for C compiler default output file name
> configure:1891: gcc -m32    conftest.c  >&5
> ./configure: line 1892: gcc: command not found
> configure:1894: $? = 127
> configure: failed program was:
> | /* confdefs.h.  */
> |
> | #define PACKAGE_NAME "Wine"
> | #define PACKAGE_TARNAME "wine"
> | #define PACKAGE_VERSION "20050830"
> | #define PACKAGE_STRING "Wine 20050830"
> | #define PACKAGE_BUGREPORT "wine-devel at winehq.org"
> | /* end confdefs.h.  */
> |
> | int
> | main ()
> | {
> |
> |   ;
> |   return 0;
> | }
> configure:1933: error: C compiler cannot create executables
> See `config.log' for more details.
> 
> ## ---------------- ##
> ## Cache variables. ##
> ## ---------------- ##
> 
> ac_cv_build=x86_64-unknown-linux-gnu
> ac_cv_build_alias=x86_64-unknown-linux-gnu
> ac_cv_env_CC_set=
> ac_cv_env_CC_value=
> ac_cv_env_CFLAGS_set=
> ac_cv_env_CFLAGS_value=
> ac_cv_env_CPPFLAGS_set=
> ac_cv_env_CPPFLAGS_value=
> ac_cv_env_CPP_set=
> ac_cv_env_CPP_value=
> ac_cv_env_CXXFLAGS_set=
> ac_cv_env_CXXFLAGS_value=
> ac_cv_env_CXX_set=
> ac_cv_env_CXX_value=
> ac_cv_env_LDFLAGS_set=
> ac_cv_env_LDFLAGS_value=
> ac_cv_env_build_alias_set=
> ac_cv_env_build_alias_value=
> ac_cv_env_host_alias_set=
> ac_cv_env_host_alias_value=
> ac_cv_env_target_alias_set=
> ac_cv_env_target_alias_value=
> ac_cv_host=x86_64-unknown-linux-gnu
> ac_cv_host_alias=x86_64-unknown-linux-gnu
> ac_cv_prog_ac_ct_CC='gcc -m32'
> ac_cv_prog_make_make_set=yes
> 
> ## ----------------- ##
> ## Output variables. ##
> ## ----------------- ##
> 
> ALSALIBS=''
> AR=''
> ARTSCCONFIG=''
> ARTSINCL=''
> ARTSLIBS=''
> AS='as --32'
> AUDIOIOLIBS=''
> BISON=''
> BUILTINFLAG=''
> CC='gcc -m32'
> CFLAGS=''
> COREFOUNDATIONLIB=''
> CPP=''
> CPPBIN=''
> CPPFLAGS=''
> CROSSCC=''
> CROSSTEST=''
> CROSSWINDRES=''
> CRTLIBS=''
> CURSESLIBS=''
> CXX=''
> CXXFLAGS=''
> DEFS=''
> DLLDEFS=''
> DLLEXT=''
> DLLFLAGS=''
> DLLIBS=''
> DLLTOOL=''
> DLLWRAP=''
> ECHO_C=''
> ECHO_N='-n'
> ECHO_T=''
> EGREP=''
> ESDCONFIG=''
> ESDINCL=''
> ESDLIBS=''
> EXEEXT=''
> EXTRACFLAGS=''
> FONTFORGE=''
> FONTSSUBDIRS=''
> FREETYPEINCL=''
> FREETYPELIBS=''
> GLU32FILES=''
> GLUT32FILES=''
> GLUT_LIBS=''
> ICULIBS=''
> IMPLIBEXT=''
> INSTALL_DATA=''
> INSTALL_PROGRAM=''
> INSTALL_SCRIPT=''
> IOKITLIB=''
> LCMSLIBS=''
> LD='ld -m elf_i386'
> LDAPLIBS=''
> LDCONFIG=''
> LDD=''
> LDDLLFLAGS=''
> LDEXECFLAGS=''
> LDFLAGS=''
> LDLIBWINEFLAGS=''
> LDPATH=''
> LDSHARED=''
> LEX=''
> LEXLIB=''
> LEX_OUTPUT_ROOT=''
> LIBEXT=''
> LIBOBJS=''
> LIBPTHREAD=''
> LIBS=''
> LINT=''
> LINTFLAGS=''
> LN=''
> LN_S=''
> LTLIBOBJS=''
> MAIN_BINARY=''
> NASLIBS=''
> OBJEXT=''
> OPENGLFILES=''
> OPENGL_LIBS=''
> PACKAGE_BUGREPORT='wine-devel at winehq.org'
> PACKAGE_NAME='Wine'
> PACKAGE_STRING='Wine 20050830'
> PACKAGE_TARNAME='wine'
> PACKAGE_VERSION='20050830'
> PATH_SEPARATOR=':'
> PKG_CONFIG=''
> PRELINK=''
> RANLIB=''
> SANEINCL=''
> SANELIBS=''
> SET_MAKE=''
> SHELL='/bin/sh'
> SOCKETLIBS=''
> STRIP=''
> TOOLSDIR=''
> WIN16_FILES='$(WIN16_FILES)'
> WIN16_INSTALL='$(WIN16_INSTALL)'
> WINDRES=''
> WINE_BINARIES=''
> XFILES=''
> XLEX=''
> XLIB=''
> XML2INCL=''
> XML2LIBS=''
> X_CFLAGS=''
> X_EXTRA_LIBS=''
> X_LIBS=''
> X_PRE_LIBS=''
> ac_ct_AR=''
> ac_ct_AS=''
> ac_ct_CC='gcc -m32'
> ac_ct_CPPBIN=''
> ac_ct_CXX=''
> ac_ct_DLLTOOL=''
> ac_ct_DLLWRAP=''
> ac_ct_LD=''
> ac_ct_RANLIB=''
> ac_ct_STRIP=''
> ac_ct_WINDRES=''
> bindir='${exec_prefix}/bin'
> build='x86_64-unknown-linux-gnu'
> build_alias=''
> build_cpu='x86_64'
> build_os='linux-gnu'
> build_vendor='unknown'
> datadir='${prefix}/share'
> exec_prefix='NONE'
> ft_devel2=''
> ft_devel=''
> host='x86_64-unknown-linux-gnu'
> host_alias=''
> host_cpu='i386'
> host_os='linux-gnu'
> host_vendor='unknown'
> includedir='${prefix}/include'
> infodir='${prefix}/info'
> libdir='${exec_prefix}/lib'
> libexecdir='${exec_prefix}/libexec'
> localstatedir='${prefix}/var'
> mandir='${prefix}/man'
> oldincludedir='/usr/include'
> prefix='/usr/local'
> program_transform_name='s,x,x,'
> sane_devel=''
> sbindir='${exec_prefix}/sbin'
> sharedstatedir='${prefix}/com'
> sysconfdir='${prefix}/etc'
> target_alias=''
> 
> ## ------------- ##
> ## Output files. ##
> ## ------------- ##
> 
> MAKE_DLL_RULES=''
> MAKE_IMPLIB_RULES=''
> MAKE_LIB_RULES=''
> MAKE_PROG_RULES=''
> MAKE_RULES=''
> MAKE_TEST_RULES=''
> 
> ## ----------- ##
> ## confdefs.h. ##
> ## ----------- ##
> 
> #define PACKAGE_BUGREPORT "wine-devel at winehq.org"
> #define PACKAGE_NAME "Wine"
> #define PACKAGE_STRING "Wine 20050830"
> #define PACKAGE_TARNAME "wine"
> #define PACKAGE_VERSION "20050830"
> 
> configure: exit 77
> 
> 
> 






       
---------------------------------
 Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080204/2142aa1b/attachment-0001.htm 

From jnewman at codeweavers.com  Mon Feb  4 10:38:16 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Mon, 04 Feb 2008 10:38:16 -0600
Subject: winehq.org down?
In-Reply-To: <47A72B36.40204@sprintpcs.com>
References: <22821af30802031147q285f61b3s6f3e0beac15a17df@mail.gmail.com>	<3f4fd2640802031332udc95bf1w9cb362c2ff4f4738@mail.gmail.com>	<b6bb06270802040604j6e93bf6bh40180738b9cc1341@mail.gmail.com>
	<47A72B36.40204@sprintpcs.com>
Message-ID: <47A73F78.4030601@codeweavers.com>

WineHQ.org, AppDB, and Bugzilla are all on the same server.

We have been having some issues with mysqld crashing the entire server. 
It so far has been a hard issue to track down. I've been tweaking the 
mysql config settings to hopefully prevent this issue.

James McKenzie wrote:
> Austin English wrote:
>> On Feb 3, 2008 3:32 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
>>   
>>> On 03/02/2008, James Hawkins <truiken at gmail.com> wrote:
>>>     
>>>> Hey guys,
>>>>
>>>> I'm having problems connecting to the winehq.org server.  Is this a known issue?
>>>>       
>>> It's working my side. Is there a problem with your connection? Do
>>> other sites work?
>>>
>>> - Reece
>>>
>>>     
>> It's off and on...Seems to be up right now (and has been for a couple
>> hours), but earlier today was out.
>>
>>   
> And bugs.winehq.org seemed to have crashed last night around 200 GMT.  
> Of course, the problem may have been me.
> 
> James McKenzie
> 
> 


From raccoonone at procyongames.com  Mon Feb  4 11:41:23 2008
From: raccoonone at procyongames.com (Christopher)
Date: Mon, 04 Feb 2008 09:41:23 -0800
Subject: running "make test" results in an error
Message-ID: <47A74E43.4080202@procyongames.com>

I tried running "make test" under Ubuntu 7.10, and I just updated to the 
latest cvs this morning so it's not too old. However, after only running 
a couple of tests it exited with an error. Is this normal, and if so how 
do I run the rest of the tests? I attached a log showing which test fails.

Christopher
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: test.log
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080204/c517fb32/attachment.txt 

From boardermj at yahoo.com  Mon Feb  4 12:44:39 2008
From: boardermj at yahoo.com (Michel Jacques)
Date: Mon, 4 Feb 2008 13:44:39 -0500 (EST)
Subject: winedbg pdb issue - n00b
Message-ID: <600608.9737.qm@web54603.mail.re2.yahoo.com>

Hi.

I've have setup my debug build (with pdbs) and MSVCRT debug dlls.

When stopping on a breakpoint with winedbg, I get a stack of calls in winedbg which does not
contains any function info from my dlls or app.  I only get hex offset of call within my dll.  But
I do see the information for wine sources though, function name + line number.

What do I need to do so that winedbg can extract info from my pdb?

Thanks,

Michel


      D?couvrez les styles qui font sensation sur Yahoo! Qu?bec Avatars.
http://cf.avatars.yahoo.com/


From dank at kegel.com  Mon Feb  4 13:31:38 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 4 Feb 2008 11:31:38 -0800
Subject: running "make test" results in an error
Message-ID: <a71bd89a0802041131q46729906j4af50ff3f7191e95@mail.gmail.com>

Christopher raccoonone at procyongames.com  wrote:
>I tried running "make test" under Ubuntu 7.10, and I just updated to the
>latest cvs this morning so it's not too old. However, after only running
>a couple of tests it exited with an error. Is this normal

Sadly, yes.  See http://bugs.winehq.org/show_bug.cgi?id=9916

Believe it or not, the situation was much worse five months ago.
At the last Wineconf, Jeremy White got everybody to spend
a whole day just fixing test failures.  We could use something
like that again.

> and if so how do I run the rest of the tests?

Elementary, my dear Watson.  "make -k test".
- Dan


From eric.pouech at orange.fr  Mon Feb  4 13:44:38 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Mon, 04 Feb 2008 20:44:38 +0100
Subject: winedbg pdb issue - n00b
In-Reply-To: <600608.9737.qm@web54603.mail.re2.yahoo.com>
References: <600608.9737.qm@web54603.mail.re2.yahoo.com>
Message-ID: <47A76B26.30209@orange.fr>

Michel Jacques a ?crit :
> Hi.
>
> I've have setup my debug build (with pdbs) and MSVCRT debug dlls.
>
> When stopping on a breakpoint with winedbg, I get a stack of calls in winedbg which does not
> contains any function info from my dlls or app.  I only get hex offset of call within my dll.  But
> I do see the information for wine sources though, function name + line number.
>
> What do I need to do so that winedbg can extract info from my pdb?
>   
_NT_SYMBOL_PATH env variable should point to where your pdb files are
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From austinenglish at gmail.com  Mon Feb  4 14:10:28 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 4 Feb 2008 14:10:28 -0600
Subject: running "make test" results in an error
In-Reply-To: <a71bd89a0802041131q46729906j4af50ff3f7191e95@mail.gmail.com>
References: <a71bd89a0802041131q46729906j4af50ff3f7191e95@mail.gmail.com>
Message-ID: <b6bb06270802041210r2b56848fk530fd15b7452027b@mail.gmail.com>

On Feb 4, 2008 1:31 PM, Dan Kegel <dank at kegel.com> wrote:
> Christopher raccoonone at procyongames.com  wrote:
> >I tried running "make test" under Ubuntu 7.10, and I just updated to the
> >latest cvs this morning so it's not too old. However, after only running
> >a couple of tests it exited with an error. Is this normal
>
> Sadly, yes.  See http://bugs.winehq.org/show_bug.cgi?id=9916
>
> Believe it or not, the situation was much worse five months ago.
> At the last Wineconf, Jeremy White got everybody to spend
> a whole day just fixing test failures.  We could use something
> like that again.

+1

-Austin


From luis.busquets at ilidium.com  Mon Feb  4 14:30:37 2008
From: luis.busquets at ilidium.com (=?ISO-8859-1?Q?=22Luis_C=2E_Busquets_P=E9rez=22?=)
Date: Mon, 04 Feb 2008 21:30:37 +0100
Subject: [Fwd: d3dx8: Implement D3DXCreateTextureFromFile]
In-Reply-To: <479CBB7A.5050004@ilidium.com>
References: <479CBB7A.5050004@ilidium.com>
Message-ID: <47A775ED.8060605@ilidium.com>


Why has this patch not been accepted?
Luis C. Busquets P?rez escribi?:
> I have created a /dlls/d3dx8/texture.c file where to put all functions 
> related to textures and d3dx8.
>
> I have included D3DXIMAGE_FILEFORMAT in the patch because it is 
> referred by D3DXIMAGE_FILEFORMAT which is referred in the function. If 
> not included, it would not compile. They both are now in 
> /include/d3dx8.h whci I think is the appropiate file. Do you propose 
> to put them elsewhere?
>
> Do you think I am missing anything or is it ok?



From stefan at codeweavers.com  Mon Feb  4 14:38:51 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 4 Feb 2008 21:38:51 +0100
Subject: running "make test" results in an error
In-Reply-To: <47A74E43.4080202@procyongames.com>
References: <47A74E43.4080202@procyongames.com>
Message-ID: <200802042138.51210.stefan@codeweavers.com>

Am Montag, 4. Februar 2008 18:41:23 schrieb Christopher:
> err:xrandr:X11DRV_XRandR_SetCurrentMode Resolution change not successful --
> perhaps display has changed? device.c:753: Test failed: Screen width is
> 1680
> device.c:754: Test failed: Screen height is 1050
That is causing the tests to fail. I've never seen that specific behavior 
before, but I think that winex11 doesn't return an error if the resolution 
change fails. This is because some users have "broken" X11 setups which only 
support one resolution. That way games run in a corner of the screen instead 
of bailing out.

The consequence is that the test isn't told that the resolution switch failed, 
and then complains about an unexpected resolution.

I think the problem with the test is that it assumes that 640x480 is 
available. I haven't seen a Windows box yet where this wasn't the case, but I 
think the best option is to check for that and skip the test with a warning 
to avoid failing make test.

Obviously, games that require 640x480 will have issues on your computer as 
well.


From dank at kegel.com  Mon Feb  4 17:50:55 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 4 Feb 2008 15:50:55 -0800
Subject: War on conformance test suite failures!
Message-ID: <a71bd89a0802041550k7e8e00c3k9e7dd83e012336de@mail.gmail.com>

Great progress was made at Wineconf last year on
getting our test suite closer to always passing on wine, but
http://test.winehq.org/data/200801301937/#Wine shows
that, according to the results collected from people who run
programs/winetest on Wine, twelve DLLs' tests are currently failing.
(Let alone the test failures on Windows!)
http://bugs.winehq.org/show_bug.cgi?id=9916 also
talks about the fact that "make test" shows failures.

This situation greatly confuses new developers,
who assume that any test failure is somehow their
fault.  And that's a reasonable assumption, let's make it so!
It would make validating a new Wine development
environment easy -- it'd be great to be able to say
  If it doesn't pass "make test" with no errors, something's
  wrong with the build environment.

What's the best way to encourage people to fix these problems?
Should we designate some upcoming day, week, or month
as a conformance test bug squishing party?
Should we offer prizes (or at least notoriety) for
the person who does the best job fixing
conformance test suite bugs (as judged by Alexandre
or his designate)?
Or is a simple call to arms enough?


From stefan at codeweavers.com  Mon Feb  4 18:06:10 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 5 Feb 2008 01:06:10 +0100
Subject: War on conformance test suite failures!
In-Reply-To: <a71bd89a0802041550k7e8e00c3k9e7dd83e012336de@mail.gmail.com>
References: <a71bd89a0802041550k7e8e00c3k9e7dd83e012336de@mail.gmail.com>
Message-ID: <200802050106.10940.stefan@codeweavers.com>

Am Dienstag, 5. Februar 2008 00:50:55 schrieb Dan Kegel:
> Great progress was made at Wineconf last year on
> getting our test suite closer to always passing on wine, but
> http://test.winehq.org/data/200801301937/#Wine shows
> that, according to the results collected from people who run
> programs/winetest on Wine, twelve DLLs' tests are currently failing.
> (Let alone the test failures on Windows!)
> http://bugs.winehq.org/show_bug.cgi?id=9916 also
> talks about the fact that "make test" shows failures.
This is only half on-topic, but the d3d9:visual test ran on this machine has 
some interesting results:

Vista: Vista-HomePrem-NoUAC

Do we have any track who reported them?

The bit that interests me is the sRGB test result. It shows that the sRGB 
correction is applied after the fog, which would allow us to use 
GLX_EXT_framebuffer_sRGB for performance improvements if we can find out in 
which cases games have to expect that. Currently I only know that Half Life 2 
should fail on this system.


From jwhite at winehq.org  Mon Feb  4 18:43:31 2008
From: jwhite at winehq.org (Jeremy White)
Date: Mon, 04 Feb 2008 18:43:31 -0600
Subject: War on conformance test suite failures!
In-Reply-To: <200802050106.10940.stefan@codeweavers.com>
References: <a71bd89a0802041550k7e8e00c3k9e7dd83e012336de@mail.gmail.com>
	<200802050106.10940.stefan@codeweavers.com>
Message-ID: <47A7B133.40405@winehq.org>

> What's the best way to encourage people to fix these problems?
> Should we designate some upcoming day, week, or month
> as a conformance test bug squishing party?
> Should we offer prizes (or at least notoriety) for
> the person who does the best job fixing
> conformance test suite bugs (as judged by Alexandre
> or his designate)?
> Or is a simple call to arms enough?

I was struck at how willing people were to work on it at Wineconf;
I suspect that a call to arms will do it, so long as someone sticks
around to pay attention to the results.

Of course, the WPF is relatively flush, so we could offer some prizes
as well...

I was hoping to sound a cry for the use of winetest [1], but was
stymied by a lack of documentation around winetest.

Cheers,

Jeremy

[1] http://www.winehq.org/pipermail/wine-devel/2007-October/059846.html


From chris.kcat at gmail.com  Mon Feb  4 19:18:11 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Mon, 4 Feb 2008 17:18:11 -0800
Subject: War on conformance test suite failures!
In-Reply-To: <200802050106.10940.stefan@codeweavers.com>
References: <a71bd89a0802041550k7e8e00c3k9e7dd83e012336de@mail.gmail.com>
	<200802050106.10940.stefan@codeweavers.com>
Message-ID: <200802041718.12312.chris.kcat@gmail.com>

On Monday 04 February 2008 04:06:10 pm Stefan D?singer wrote:
> The bit that interests me is the sRGB test result. It shows that the sRGB
> correction is applied after the fog, which would allow us to use
> GLX_EXT_framebuffer_sRGB for performance improvements if we can find out in
> which cases games have to expect that. Currently I only know that Half Life
> 2 should fail on this system.

This might be the reason:
http://msdn2.microsoft.com/en-us/library/bb172583(VS.85).aspx

D3DPMISCCAPS_POSTBLENDSRGBCONVERT -
Device supports conversion to sRGB after blending.
This flag is available in Direct3D 9Ex only.


From jwhite at codeweavers.com  Mon Feb  4 21:49:48 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Mon, 04 Feb 2008 21:49:48 -0600
Subject: winetest experience
Message-ID: <47A7DCDC.7090206@codeweavers.com>

Okay, so I boldly tried to use winetest with what documentation
I could find, and had an...um...interesting time.

I created these files:

[jertop] cat build.id
fcccd9fca605d1d4c462df5c33f4bacf03bdda5f
[jertop] cat build.nfo
A Large Shovel
[jertop] cat tests.url
http://www.IDontKnowWhatURLToPutHere.com/
[jertop]

did a make dist, and then did:

./winetest -c -t "jw-etch32"

It ran, did it's thing, and had one interactive thing
(Gecko fussed at me; that's not a Winetest bug afaik).

Then when it was all done, it transferred my nearly
1 MB file, and then errored out with:
  "Unknown build id"

So then I looked at the output file, and sure enough, it had
a - for build info, not my fancy git id.

So I hacked that, put in jwtip, and then ran winetest -s
to send my output file through.

And then I have a lovely result here:
  http://test.winehq.org/data/jwtip/

So that's *something* at least.  Although I suspect someone will now
have to go clean up my mess :-/.

So...what's the convention for build.id etc?  And
why didn't they get set?

Cheers,

Jeremy


From hverbeet at gmail.com  Tue Feb  5 02:34:50 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Tue, 5 Feb 2008 09:34:50 +0100
Subject: [7/20] WineD3D: De-Statify depth blit opengl resources
In-Reply-To: <200802050009.07866.stefan@codeweavers.com>
References: <200802050009.07866.stefan@codeweavers.com>
Message-ID: <d658b69e0802050034q3c0cb8betb0ff144315c85778@mail.gmail.com>

On 05/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
>
I was aware of this issue, but technically these resources should be
stored in the shader backend, not the device.


From hverbeet at gmail.com  Tue Feb  5 02:39:35 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Tue, 5 Feb 2008 09:39:35 +0100
Subject: [10/20] WineD3D: Make Clear aware of the depth stencil sharing
In-Reply-To: <200802050021.02780.stefan@codeweavers.com>
References: <200802050021.02780.stefan@codeweavers.com>
Message-ID: <d658b69e0802050039r5ca90f70gfafa3642c0ba0403@mail.gmail.com>

On 05/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
>
Stefan already knows this, but just for what it's worth, I've got a
more complete fix in my tree for depth stencil sharing. Unfortunately
that patch causes a couple of regressions, so it needs more work.


From msclrhd at googlemail.com  Mon Feb  4 10:52:34 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Mon, 4 Feb 2008 16:52:34 +0000
Subject: attempt to install Wine from source
In-Reply-To: <47A7301D.6000003@googlemail.com>
References: <47A6A312.8000304@odyssey.apana.org.au>
	<47A7301D.6000003@googlemail.com>
Message-ID: <3f4fd2640802040852o7166e51el12970023c6ecb416@mail.gmail.com>

On 04/02/2008, Chris Spencer <spencercw at googlemail.com> wrote:
> You do not have the gcc compiler installed. On Ubuntu you will need to
> install build-essentials (I think that's what it's called), and also run
> 'sudo apt-get build-dep wine'. I'm not sure what the process is on Debian.

See http://wiki.winehq.org/Recommended_Packages. Specifically:

The easiest way to set up an Ubuntu system is to use a shell script
that installs the above packages:

    * Gutsy Gibbon (Ubuntu 7.10) http://kegel.com/wine/gutsy.sh
    * Feisty Fawn (Ubuntu 7.04) http://kegel.com/wine/feisty.sh
    * Edgy Eft (Ubuntu 6.10) http://kegel.com/wine/edgy.sh
    * Dapper Drake (Ubuntu 6.06) http://kegel.com/wine/dapper.sh
    * Breezy Badger (Ubuntu 5.11) http://kegel.com/wine/breezy.sh

After which, you can follow the instructions at
http://www.winehq.org/site/git to get the lastest version of the code.

- Reece


From msclrhd at googlemail.com  Mon Feb  4 11:50:07 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Mon, 4 Feb 2008 17:50:07 +0000
Subject: running "make test" results in an error
In-Reply-To: <47A74E43.4080202@procyongames.com>
References: <47A74E43.4080202@procyongames.com>
Message-ID: <3f4fd2640802040950r277c035al91cdb187ca1a25fb@mail.gmail.com>

On 04/02/2008, Christopher <raccoonone at procyongames.com> wrote:
> I tried running "make test" under Ubuntu 7.10, and I just updated to the
> latest cvs this morning so it's not too old. However, after only running
> a couple of tests it exited with an error. Is this normal, and if so how
> do I run the rest of the tests? I attached a log showing which test fails.

You can check the state of the tests at
http://test.winehq.org/data/200801301937/. I also get test failures on
Ubuntu 7.10, so this is normal, even though it is undesirable.

You can run make -k test (the -k tells make to continue on error).

What I do is:

    make -k test | tee results.log
    cat results.log | grep -F Error

- Reece


From msclrhd at googlemail.com  Tue Feb  5 00:59:58 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 5 Feb 2008 06:59:58 +0000
Subject: War on conformance test suite failures!
In-Reply-To: <200802050106.10940.stefan@codeweavers.com>
References: <a71bd89a0802041550k7e8e00c3k9e7dd83e012336de@mail.gmail.com>
	<200802050106.10940.stefan@codeweavers.com>
Message-ID: <3f4fd2640802042259p4f54db04heef7e8350c974e47@mail.gmail.com>

On 05/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Dienstag, 5. Februar 2008 00:50:55 schrieb Dan Kegel:
> > Great progress was made at Wineconf last year on
> > getting our test suite closer to always passing on wine, but
> > http://test.winehq.org/data/200801301937/#Wine shows
> > that, according to the results collected from people who run
> > programs/winetest on Wine, twelve DLLs' tests are currently failing.
> > (Let alone the test failures on Windows!)
> > http://bugs.winehq.org/show_bug.cgi?id=9916 also
> > talks about the fact that "make test" shows failures.
> This is only half on-topic, but the d3d9:visual test ran on this machine has
> some interesting results:
>
> Vista: Vista-HomePrem-NoUAC
>
> Do we have any track who reported them?

That one is mine, along with Vista-HomePrem-UAC. They are both on the
same high-spec recent HP laptop (HP Pavilion DV95000) machine with an
NVidia GeForce 8600M GS graphics card.

Is there any specific tests/information you need.

- Reece


From msclrhd at googlemail.com  Tue Feb  5 01:08:28 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 5 Feb 2008 07:08:28 +0000
Subject: War on conformance test suite failures!
In-Reply-To: <a71bd89a0802041550k7e8e00c3k9e7dd83e012336de@mail.gmail.com>
References: <a71bd89a0802041550k7e8e00c3k9e7dd83e012336de@mail.gmail.com>
Message-ID: <3f4fd2640802042308p2181fd1bla2e99b21ee49ae3a@mail.gmail.com>

On 04/02/2008, Dan Kegel <dank at kegel.com> wrote:
> Great progress was made at Wineconf last year on
> getting our test suite closer to always passing on wine, but
> http://test.winehq.org/data/200801301937/#Wine shows
> that, according to the results collected from people who run
> programs/winetest on Wine, twelve DLLs' tests are currently failing.
> (Let alone the test failures on Windows!)
> http://bugs.winehq.org/show_bug.cgi?id=9916 also
> talks about the fact that "make test" shows failures.

I have been providing patches to help the situation on all platforms.
I am currently tracking 11 patches that are test related (9 on Windows
- mainly Vista, but the directory-based listview failures should be
fixed on all platforms, 2 on Wine). These haven't been applied yet
because Alexandre went on holiday when I started my campaign against
test suite failures.

A few of these patches I have updated and resent as they needed todo
blocks adding for Wine.

I also kicked off discussions about different aspects of the test
suite failures, but only some of these generated responses.

I am specifically interested in increasing the timeout when running
the Wine Test Shell to handle various timeouts (specifically software
rendered D3D tests and MSI install tests).

- Reece


From msclrhd at googlemail.com  Tue Feb  5 01:46:26 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 5 Feb 2008 07:46:26 +0000
Subject: winetest experience
In-Reply-To: <47A7DCDC.7090206@codeweavers.com>
References: <47A7DCDC.7090206@codeweavers.com>
Message-ID: <3f4fd2640802042346j11917e11lad4ba29c6915972e@mail.gmail.com>

On 05/02/2008, Jeremy White <jwhite at codeweavers.com> wrote:
> Okay, so I boldly tried to use winetest with what documentation
> I could find, and had an...um...interesting time.

The easiest thing I found for generating test results on Wine is to
treat it like Windows. That is, download the
winetest-[buildid]-paul-mingw.exe from the build you want to test and
run:

   wine winetest-[buildid]-paul-mingw.exe

e.g. on the http://test.winehq.org/data/200801301937/ page, the "Main
summary for build 200801301937", and downloaded
http://www.astro.gla.ac.uk/users/paulm/WRT/CrossBuilt/winetest-200801301937-paul-mingw.exe.
Then, I ran

    ./wine winetest-200801301937-paul-mingw.exe

from a build of wine-0.9.54 and followed the instructions on the
program. It did generate an error about not being able to clean the
log at the end, but it generated the "XP wine-0.9.54-notheme" and "XP
wine-0.9.54" results without any issues.

> So...what's the convention for build.id etc?  And
> why didn't they get set?

Looking at the results from the Wine Test Shell, it is using a build timestamp.

- Reece


From msclrhd at googlemail.com  Tue Feb  5 02:14:54 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 5 Feb 2008 08:14:54 +0000
Subject: winetest experience
In-Reply-To: <47A7DCDC.7090206@codeweavers.com>
References: <47A7DCDC.7090206@codeweavers.com>
Message-ID: <3f4fd2640802050014s3980d57br69eceed86b5415e1@mail.gmail.com>

On 05/02/2008, Jeremy White <jwhite at codeweavers.com> wrote:
> Okay, so I boldly tried to use winetest with what documentation
> I could find, and had an...um...interesting time.

I have added my experiences to the wiki
(http://wiki.winehq.org/ConformanceTests) with a link on the main
page.

Feel free to update it with your own experiences

- Reece


From tony.wasserka at freenet.de  Tue Feb  5 04:29:57 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Tue, 05 Feb 2008 11:29:57 +0100
Subject: d3dx9_36: Implementation of D3DXCheckVersion try 2
Message-ID: <E1JML3t-0002we-ST@www16.emo.freenet-rz.de>

I probably should've gone into a bit more detail about this function:
It's just for developer purpose. If you have a very big project and
are trying to upgrade e.g. from d3dx9_27 to d3dx9_36 some files
may need to be rebuild, some files may not. This function is just there
to ensure the developer that all files are built with the right dll.

Now THIS means, that we won't ever see an ENDUSER application
fail because of a d3dx9 version mismatch.

Also, we come to a problem when a user wants to built an application
with Winelib, where we can only use one definition of D3DX_SDK_VERSION
which only applies to ONE dll. Now just watch following code sample:
> #include "d3dx9.h"
>
> int check_version() {
>     if( D3DXCheckVersion( D3D_SDK_VERSION, D3DX_SDK_VERSION ) == FALSE ) {
>         MessageBox( NULL, "D3DX9 Versions don't match!", "Error!", MB_OK );
>         exit( 1 );
>     }
> }

Now, if a Winelib user compiles this, D3DX_SDK_VERSION is 9 (as its specified in our
current d3dx9core.h). But if the program requires to be built with d3dx9_36 (and thus
uses our implementation of D3DXCheckVersion) it will report an error as D3DX_SDK_VERSION
was expected to be 36.

So, the only thing we can test in this function is if D3DX_SDK_VERSION is between 24 and 36,
which are all compatible versions (also, no enduser application will need the accurate implementation
as stated above). I have made a mistake though, when I defined D3DX_SDK_VERSION to be 9,
which was caused by my somewhat old installation of the DX SDK, which is incompatible
with d3dx9_24 to d3dx9_36. (it was statically linked at that time), You don't need correct this
in your patch, as this will be addressed in one of my future patches, I am just waiting for
Julliard to (hopefully) accept my d3dx9_24 patch.

In conclusion, all you have to do is replace the line
> return ((D3DSdkVersion==D3D_SDK_VERSION) && (D3DXSdkVersion==D3DX_SDK_VERSION));
with
> return ((D3DSdkVersion==D3D_SDK_VERSION) && (D3DXSdkVersion>=24 && D3DXSdkVersion <=36));
(Could also be => and =<, ain't that familiar with it)

Best regards,
    Tony










From fgouget at free.fr  Tue Feb  5 04:51:04 2008
From: fgouget at free.fr (Francois Gouget)
Date: Tue, 5 Feb 2008 11:51:04 +0100 (CET)
Subject: comctl32 failures on Win95, Win98, NT4 asnd Win2K
In-Reply-To: <479F1401.4010008@gmail.com>
References: <3f4fd2640801290039g68cdc4e0tc4d327573ad563c2@mail.gmail.com>
	<479F1401.4010008@gmail.com>
Message-ID: <alpine.DEB.0.999999.0801292025370.873@amboise.dolphin>

On Tue, 29 Jan 2008, Paul Vriens wrote:
[...]
> > Several of the others have failures on Win95 and Win98 only.
> > 
> > Is anyone going to look at these?

I'm sending a patch to fix the InitCommonControlsEx() issue I 
introduced.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
              Linux: Because rebooting is for adding new hardware


From tony.wasserka at freenet.de  Tue Feb  5 04:48:39 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Tue, 05 Feb 2008 11:48:39 +0100
Subject: d3dx9_36: Implementation of D3DXCheckVersion try 2
Message-ID: <E1JMLLz-0007xb-2w@www9.emo.freenet-rz.de>

Oh well, I forgot one point:
if you take my example code again, but don't build it under winelib
but under windows (i.e. it's a real win application) but later run
it with wine it may also fail because all dlls forward to the
D3DXCheckVersion of d3dx9_36. I know that you would have
implemented another D3DXCheckVersion for each dll, but this
again would've ended in the case I mentioned in the first e-mail.



Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain inkl.
http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/index.html



From julliard at winehq.org  Tue Feb  5 05:15:39 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 05 Feb 2008 12:15:39 +0100
Subject: kernel32: Add tests for LoadLibraryEx
In-Reply-To: <22821af30802040924x33484888gbcef27c80c5d77b9@mail.gmail.com>
	(James Hawkins's message of "Mon, 4 Feb 2008 11:24:26 -0600")
References: <22821af30802040924x33484888gbcef27c80c5d77b9@mail.gmail.com>
Message-ID: <87fxw7velg.fsf@wine.dyndns.org>

"James Hawkins" <truiken at gmail.com> writes:

> I'm not sure how you feel this should be fixed.  Is there a reason we
> don't have tests for ntdll/loader.c?  If not, I'd like add some tests
> for LdrLoadDll.

We don't have tests for it because apps don't use LdrLoadDll, so testing
LoadLibraryEx should be enough. Of course if you have an app that
depends on a specific behavior of LdrLoadDll then this should be
tested.

The todo in your test is because builtin dlls are supposed to get loaded
even if the corresponding native file doesn't exist, that's a feature.

-- 
Alexandre Julliard
julliard at winehq.org


From fgouget at free.fr  Tue Feb  5 05:18:37 2008
From: fgouget at free.fr (Francois Gouget)
Date: Tue, 5 Feb 2008 12:18:37 +0100 (CET)
Subject: Blocked conformance tests
Message-ID: <Pine.LNX.4.64.0710262324400.21860@amboise.dolphin>


When I run winetest on Windows XP I get some dialog boxes asking me:

   Do you want to keep blocking this program?

According to the title bar, the impacted tests are:
   dplayx
   rpcrt4
   'Microsoft DirectPlay Helper'  ???
   ws2_32

My understanding is that it should only prevent the test from receiving 
network connections which I guess is not common. Does anyone know if 
this could cause any test failure currently?

How does XP determine whether to block the test or not?

Is the 'authorisation' based on the executable hash? If so there's no 
way to pre-authorise the tests for nightly tests.

Should the winetest mark the executable so it is not hampered by this 
check?


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
     Linux, WinNT, MS-DOS - also known as the Good, the Bad and the Ugly.


From julliard at winehq.org  Tue Feb  5 05:30:34 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 05 Feb 2008 12:30:34 +0100
Subject: running "make test" results in an error
In-Reply-To: <200802042138.51210.stefan@codeweavers.com> ("Stefan
	=?utf-8?Q?D=C3=B6singer=22's?=
	message of "Mon, 4 Feb 2008 21:38:51 +0100")
References: <47A74E43.4080202@procyongames.com>
	<200802042138.51210.stefan@codeweavers.com>
Message-ID: <8763x3vdwl.fsf@wine.dyndns.org>

Stefan D?singer <stefan at codeweavers.com> writes:

> Am Montag, 4. Februar 2008 18:41:23 schrieb Christopher:
>> err:xrandr:X11DRV_XRandR_SetCurrentMode Resolution change not successful --
>> perhaps display has changed? device.c:753: Test failed: Screen width is
>> 1680
>> device.c:754: Test failed: Screen height is 1050
> That is causing the tests to fail. I've never seen that specific behavior 
> before, but I think that winex11 doesn't return an error if the resolution 
> change fails. This is because some users have "broken" X11 setups which only 
> support one resolution. That way games run in a corner of the screen instead 
> of bailing out.

The usual cause for this failure is an Xrandr bug, the timestamp
checking is broken WRT wraparound. If you wait a few days (or restart
your X server) it will work again.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Tue Feb  5 05:47:48 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 5 Feb 2008 12:47:48 +0100
Subject: War on conformance test suite failures!
In-Reply-To: <3f4fd2640802042259p4f54db04heef7e8350c974e47@mail.gmail.com>
References: <a71bd89a0802041550k7e8e00c3k9e7dd83e012336de@mail.gmail.com>
	<200802050106.10940.stefan@codeweavers.com>
	<3f4fd2640802042259p4f54db04heef7e8350c974e47@mail.gmail.com>
Message-ID: <200802051247.49201.stefan@codeweavers.com>

Am Dienstag, 5. Februar 2008 07:59:58 schrieb Reece Dunn:
> On 05/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> > Am Dienstag, 5. Februar 2008 00:50:55 schrieb Dan Kegel:
> > > Great progress was made at Wineconf last year on
> > > getting our test suite closer to always passing on wine, but
> > > http://test.winehq.org/data/200801301937/#Wine shows
> > > that, according to the results collected from people who run
> > > programs/winetest on Wine, twelve DLLs' tests are currently failing.
> > > (Let alone the test failures on Windows!)
> > > http://bugs.winehq.org/show_bug.cgi?id=9916 also
> > > talks about the fact that "make test" shows failures.
> >
> > This is only half on-topic, but the d3d9:visual test ran on this machine
> > has some interesting results:
> >
> > Vista: Vista-HomePrem-NoUAC
> >
> > Do we have any track who reported them?
>
> That one is mine, along with Vista-HomePrem-UAC. They are both on the
> same high-spec recent HP laptop (HP Pavilion DV95000) machine with an
> NVidia GeForce 8600M GS graphics card.
Do you have Half Life 2? If yes, can you start a new game and take a few 
screenshots from Doktor Kleiner's lab? If you don't have the game I'll try to 
find a place to reproduce the fog bug at a place that can be reached in the 
demo.


From stefan at codeweavers.com  Tue Feb  5 05:50:06 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 5 Feb 2008 12:50:06 +0100
Subject: [10/20] WineD3D: Make Clear aware of the depth stencil sharing
In-Reply-To: <d658b69e0802050039r5ca90f70gfafa3642c0ba0403@mail.gmail.com>
References: <200802050021.02780.stefan@codeweavers.com>
	<d658b69e0802050039r5ca90f70gfafa3642c0ba0403@mail.gmail.com>
Message-ID: <200802051250.06762.stefan@codeweavers.com>

Am Dienstag, 5. Februar 2008 09:39:35 schrieb H. Verbeet:
> On 05/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
>
> Stefan already knows this, but just for what it's worth, I've got a
> more complete fix in my tree for depth stencil sharing. Unfortunately
> that patch causes a couple of regressions, so it needs more work.
Ya, I sent this patch nevertheless because this bug is causing some problems 
for me and I want the fix in finally.


From stefan at codeweavers.com  Tue Feb  5 05:51:09 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 5 Feb 2008 12:51:09 +0100
Subject: [7/20] WineD3D: De-Statify depth blit opengl resources
In-Reply-To: <d658b69e0802050034q3c0cb8betb0ff144315c85778@mail.gmail.com>
References: <200802050009.07866.stefan@codeweavers.com>
	<d658b69e0802050034q3c0cb8betb0ff144315c85778@mail.gmail.com>
Message-ID: <200802051251.09625.stefan@codeweavers.com>

Am Dienstag, 5. Februar 2008 09:34:50 schrieb H. Verbeet:
> On 05/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
>
> I was aware of this issue, but technically these resources should be
> stored in the shader backend, not the device.
Well, the textures are per device, and for now the shader backend doesn't have 
its own per device storage, thus I put them in the device


From stefan at codeweavers.com  Tue Feb  5 05:59:17 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 5 Feb 2008 12:59:17 +0100
Subject: War on conformance test suite failures!
In-Reply-To: <200802041718.12312.chris.kcat@gmail.com>
References: <a71bd89a0802041550k7e8e00c3k9e7dd83e012336de@mail.gmail.com>
	<200802050106.10940.stefan@codeweavers.com>
	<200802041718.12312.chris.kcat@gmail.com>
Message-ID: <200802051259.17577.stefan@codeweavers.com>

Am Dienstag, 5. Februar 2008 02:18:11 schrieb Chris Robinson:
> On Monday 04 February 2008 04:06:10 pm Stefan D?singer wrote:
> > The bit that interests me is the sRGB test result. It shows that the sRGB
> > correction is applied after the fog, which would allow us to use
> > GLX_EXT_framebuffer_sRGB for performance improvements if we can find out
> > in which cases games have to expect that. Currently I only know that Half
> > Life 2 should fail on this system.
>
> This might be the reason:
> http://msdn2.microsoft.com/en-us/library/bb172583(VS.85).aspx
>
> D3DPMISCCAPS_POSTBLENDSRGBCONVERT -
> Device supports conversion to sRGB after blending.
> This flag is available in Direct3D 9Ex only.
Blending as in D3DRS_ALPHABLENDENABLE is not used by the game in this case. 
However, in another cap flag Microsoft called fog blending. So maybe sRGB 
isn't applied at all with fog enabled on dx9 cards. I'll extend the test case 
to test that.


From hverbeet at gmail.com  Tue Feb  5 06:00:35 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Tue, 5 Feb 2008 13:00:35 +0100
Subject: [7/20] WineD3D: De-Statify depth blit opengl resources
In-Reply-To: <200802051251.09625.stefan@codeweavers.com>
References: <200802050009.07866.stefan@codeweavers.com>
	<d658b69e0802050034q3c0cb8betb0ff144315c85778@mail.gmail.com>
	<200802051251.09625.stefan@codeweavers.com>
Message-ID: <d658b69e0802050400i64c3f044jcfde274db77dab08@mail.gmail.com>

On 05/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Dienstag, 5. Februar 2008 09:34:50 schrieb H. Verbeet:
> > On 05/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> >
> > I was aware of this issue, but technically these resources should be
> > stored in the shader backend, not the device.
> Well, the textures are per device, and for now the shader backend doesn't have
> its own per device storage, thus I put them in the device
>
The backend itself should be set per device already, but it needs some
private storage.


From hverbeet at gmail.com  Tue Feb  5 06:01:59 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Tue, 5 Feb 2008 13:01:59 +0100
Subject: [10/20] WineD3D: Make Clear aware of the depth stencil sharing
In-Reply-To: <200802051250.06762.stefan@codeweavers.com>
References: <200802050021.02780.stefan@codeweavers.com>
	<d658b69e0802050039r5ca90f70gfafa3642c0ba0403@mail.gmail.com>
	<200802051250.06762.stefan@codeweavers.com>
Message-ID: <d658b69e0802050401k11a847a7qd1b3835d066cd7a3@mail.gmail.com>

On 05/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Dienstag, 5. Februar 2008 09:39:35 schrieb H. Verbeet:
> > On 05/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> >
> > Stefan already knows this, but just for what it's worth, I've got a
> > more complete fix in my tree for depth stencil sharing. Unfortunately
> > that patch causes a couple of regressions, so it needs more work.
> Ya, I sent this patch nevertheless because this bug is causing some problems
> for me and I want the fix in finally.
>
Yes, the patch should go in.


From julliard at winehq.org  Tue Feb  5 06:25:25 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 05 Feb 2008 13:25:25 +0100
Subject: kernel32: Implement ReplaceFileW. [RESEND]
In-Reply-To: <47A713A3.4090906@codeweavers.com> (Robert Shearman's message of
	"Mon, 04 Feb 2008 13:31:15 +0000")
References: <47A713A3.4090906@codeweavers.com>
Message-ID: <871w7rvbd6.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> +    /*
> +     * Open the replacement file for reading, writing, and deleting
> +     * (writing and deleting are needed when finished)
> +     */
> +    if ((hReplacement = CreateFileW(lpReplacementFileName,
> +        GENERIC_READ | GENERIC_WRITE,
> +        FILE_SHARE_READ | FILE_SHARE_WRITE | FILE_SHARE_DELETE,
> +        NULL, OPEN_EXISTING, 0, 0)) == INVALID_HANDLE_VALUE)
> +    {
> +        error = GetLastError(); /* Use error returned by CreateFileW */
> +        goto fail;
> +    }

Files should be opened with NtOpenFile the same way MoveFile does, to
avoid having to convert path names twice.

-- 
Alexandre Julliard
julliard at winehq.org


From jwhite at codeweavers.com  Tue Feb  5 10:07:49 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Tue, 05 Feb 2008 10:07:49 -0600
Subject: Call for winetest ing
Message-ID: <47A889D5.3080603@codeweavers.com>

Okay, so I got winetest to do something rational, and now I'd like to see if it
will work for someone else.

It's easy!

Just apply this patch to a current Wine tree:
  http://www.winehq.org/pipermail/wine-patches/2008-February/049675.html

Then configure and make Wine as you normally would.  Then,
  cd programs/winetest
  ./runtests <your-tag-here>
(The tag I used was jwhite-etch64; I think you should identify who you are,
and then if you have multiple systems, your system within that).

If you have winetricks in your path, it should be completely unattended.
(If you don't, you'll need to hang around to click 'go' to the Gecko install
dialog).

After about 5 minutes, your test results should be run and sent up to test.winehq.org.
The cron job runs every 5 minutes, so sometime after that, a reload of:
  firefox http://test.winehq.org/data/`date +%Y%m%d`/

Should show you your results!  Easy as Pi!

There is still quite a bit to do.  First, I'm waiting for a 'real' winetest expert
to wack me with a clue bat.  But I'll stumble along until the hammer falls...

Second, I want to do a stupidity check and make sure that winetest
essentially correlates to a make -k test run.  If they are not really identical,
then we need to fix that problem...

Next, I think we should probably shift the build-id from being the date to
being the HEAD sha1, but that's a radical enough change that I felt I needed
to start simpler and within the current conventions.

But I'd really appreciate it if folks could try this and see if we can gather
some data quickly.  In theory, we should be able to quickly see the common
points of failure and know where to attack first.

Cheers,

Jeremy


From paul.vriens.wine at gmail.com  Tue Feb  5 10:30:45 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 05 Feb 2008 17:30:45 +0100
Subject: Call for winetest ing
In-Reply-To: <47A889D5.3080603@codeweavers.com>
References: <47A889D5.3080603@codeweavers.com>
Message-ID: <47A88F35.7080104@gmail.com>

Jeremy White wrote:
> Okay, so I got winetest to do something rational, and now I'd like to see if it
> will work for someone else.
> 
> It's easy!
> 
> Just apply this patch to a current Wine tree:
>   http://www.winehq.org/pipermail/wine-patches/2008-February/049675.html
> 
> Then configure and make Wine as you normally would.  Then,
>   cd programs/winetest
>   ./runtests <your-tag-here>
> (The tag I used was jwhite-etch64; I think you should identify who you are,
> and then if you have multiple systems, your system within that).
> 
> If you have winetricks in your path, it should be completely unattended.
> (If you don't, you'll need to hang around to click 'go' to the Gecko install
> dialog).
> 
> After about 5 minutes, your test results should be run and sent up to test.winehq.org.
> The cron job runs every 5 minutes, so sometime after that, a reload of:
>   firefox http://test.winehq.org/data/`date +%Y%m%d`/
> 
> Should show you your results!  Easy as Pi!
> 
> There is still quite a bit to do.  First, I'm waiting for a 'real' winetest expert
> to wack me with a clue bat.  But I'll stumble along until the hammer falls...
> 
> Second, I want to do a stupidity check and make sure that winetest
> essentially correlates to a make -k test run.  If they are not really identical,
> then we need to fix that problem...
> 
> Next, I think we should probably shift the build-id from being the date to
> being the HEAD sha1, but that's a radical enough change that I felt I needed
> to start simpler and within the current conventions.
> 
> But I'd really appreciate it if folks could try this and see if we can gather
> some data quickly.  In theory, we should be able to quickly see the common
> points of failure and know where to attack first.
> 
> Cheers,
> 
> Jeremy
> 
> 
> 
Hi,

The good thing about having the winetest from one 
source(http://www.astro.gla.ac.uk/users/paulm/WRT/CrossBuilt/) is that all the 
output is actually from the same executable and it's easier to compare. If 
people are using different build-id we will end up with a lot of directories 
with single test in it.

Something we also have with the current tests is that the source files actually 
point to the correct version in CVS. I now see some strange links to refs on 
http://test.winehq.org/data/20080205/.

Even though the HEAD sha1 looks better than the date for a build-id it will 
again introduce a lot of directories with only a few tests in there.

I don't see a problem with running the winetest executable under Wine the same 
as I do under all kinds of Windows versions.

Just my $0.02

-- 
Cheers,

Paul.


From jwhite at codeweavers.com  Tue Feb  5 10:57:51 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Tue, 05 Feb 2008 10:57:51 -0600
Subject: Call for winetest ing
In-Reply-To: <47A88F35.7080104@gmail.com>
References: <47A889D5.3080603@codeweavers.com> <47A88F35.7080104@gmail.com>
Message-ID: <47A8958F.90702@codeweavers.com>

Hi Paul,

> Something we also have with the current tests is that the source files actually
> point to the correct version in CVS. I now see some strange links to refs on
> http://test.winehq.org/data/20080205/.

Well, I'm afraid I'd argue that the current tests should be updated to point
to git...

> Even though the HEAD sha1 looks better than the date for a build-id it will
> again introduce a lot of directories with only a few tests in there.

Is that really true?

Alexandre tends to touch the tree once a day, usually all in one batch.
If folks kick off winetest right before the leave for the day, wouldn't
the odds be that everyone would have the same HEAD sha1?  (I guess that requires
people to run winetest from a clean, winehq only tree).

And even if it is true, isn't it more logically correct?

Right now, I could download a winetest.exe and use
Wine-0.9.1 to run it, and it would be grouped in the same bucket as someone running
off their own badly hacked wine tip tree.  Doesn't that create misleading data?

However, I agree that if we changed that now it would be a mess; we'd need to change
the script that presents the directories to group them by date so as to present the
more recent sha1 keys.

> I don't see a problem with running the winetest executable under Wine the same 
> as I do under all kinds of Windows versions.

Perhaps you're right.  Occam would suggest you are.

But it sticks in my craw.  I have a source tree; I have
built the files; I can run make test and it fails badly.  I want to tell the world
about my failures now (/me stamps his little feet  <grin>).

Getting a .exe from you requires you to have reliably built winetest.exe, and does not
allow me to test the tip *now*.  Further, if there are any discrepancies introduced
by the way my system builds the test .exe files compared to yours, running your winetest.exe won't
catch them.  (I realize that may be pure rationalization).

I think to some extent we are at different purposes, which may explain a
reason to change.

I think winetest has long been used to test the tests themselves, and to identify
the issues with the tests and fix them.  That is, the variable is the tests, and the underlying
OS (i.e. Windows) is essentially a constant.

But my purpose requires 2 variables - the tests changing as needed, but also the
underlying OS - Wine - changing rapidly as well.

Cheers,

Jeremy


From austinenglish at gmail.com  Tue Feb  5 11:00:55 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 5 Feb 2008 11:00:55 -0600
Subject: Call for winetest ing
In-Reply-To: <47A88F35.7080104@gmail.com>
References: <47A889D5.3080603@codeweavers.com> <47A88F35.7080104@gmail.com>
Message-ID: <b6bb06270802050900k73d2fa36t7348865cf4c59ab5@mail.gmail.com>

On Feb 5, 2008 10:30 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi,
>
> The good thing about having the winetest from one
> source(http://www.astro.gla.ac.uk/users/paulm/WRT/CrossBuilt/) is that all the
> output is actually from the same executable and it's easier to compare. If
> people are using different build-id we will end up with a lot of directories
> with single test in it.


If some people went through the trouble of using buildid's and not the
precompiled winetest, along with documenting their hardware/OS on a
wiki page, for instance, then we could more information on where
specific failures are occuring. For instance, I noticed Joapa was
reporting some MSI bugs, and was the only one posting an MSI failure
in the make test usually failing bug.


From jwhite at winehq.org  Tue Feb  5 11:34:54 2008
From: jwhite at winehq.org (Jeremy White)
Date: Tue, 05 Feb 2008 11:34:54 -0600
Subject: Call for winetest ing
In-Reply-To: <47A8958F.90702@codeweavers.com>
References: <47A889D5.3080603@codeweavers.com> <47A88F35.7080104@gmail.com>
	<47A8958F.90702@codeweavers.com>
Message-ID: <47A89E3E.3050905@winehq.org>

Jeremy White wrote:
> Hi Paul,
> 
>> Something we also have with the current tests is that the source files actually
>> point to the correct version in CVS. I now see some strange links to refs on
>> http://test.winehq.org/data/20080205/.
> 
> Well, I'm afraid I'd argue that the current tests should be updated to point
> to git...

And, putting my money where my mouth is, I've ostensibly fixed that now.
The code supposedly can handle either git or cvs style revisions now
(although detection is crude; if rev has a period, it's cvs :-/).

Cheers,

Jeremy


From jwhite at codeweavers.com  Tue Feb  5 11:43:24 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Tue, 05 Feb 2008 11:43:24 -0600
Subject: Call for winetest ing
In-Reply-To: <b6bb06270802050900k73d2fa36t7348865cf4c59ab5@mail.gmail.com>
References: <47A889D5.3080603@codeweavers.com> <47A88F35.7080104@gmail.com>
	<b6bb06270802050900k73d2fa36t7348865cf4c59ab5@mail.gmail.com>
Message-ID: <47A8A03C.9090606@codeweavers.com>

> If some people went through the trouble of using buildid's and not the
> precompiled winetest, along with documenting their hardware/OS on a
> wiki page, for instance, then we could more information on where
> specific failures are occuring. For instance, I noticed Joapa was
> reporting some MSI bugs, and was the only one posting an MSI failure
> in the make test usually failing bug.

Actually, I think there is a better solution.  If we want to capture
additional system information, and there is a command line tool that
would allow that, we can do so in the new 'runtests' script.

Right now, I have it capturing gcc, glibc, and kernel version info,
and that is all readily available as part of the nifty winetest results page.

We could also conceivably add info on processor count and ram size,
as well as video and audio card.  (But those would require slightly
more sophisticated scripts to postprocess; we don't want to just
dump the results of xdpyinfo for example...).

Cheers,

Jeremy


From boardermj at yahoo.com  Tue Feb  5 11:54:36 2008
From: boardermj at yahoo.com (Michel Jacques)
Date: Tue, 5 Feb 2008 12:54:36 -0500 (EST)
Subject: winedbg - using pdb from Visual Studio 2005
Message-ID: <802215.94186.qm@web54603.mail.re2.yahoo.com>

Hello, 

I am using PDBs generated with 2005 with wine version 0.9.54.

I get errors related to my PDBs and I am wondering if I need 
to change the pdb format? Anything special to do when using 2005?

Here are the errors I get, each time one of my pdb gets loaded:

0009:trace:dbghelp:SymFindFileInPathW (hProcess = 0x30, searchPath = (null), full_path =
L"C:\\master\\x86\\debug\\bin\\mydll.pdb", id = 0x34c160, two = 0x00000002, three = 0x00000000,
flags = 0x00000008, buffer = 0x34b718, cb = 0x6020fb50, user = 0x34bd30)
0009:err:dbghelp_msc:pdb_process_types -Unknown type info version 20040203
0009:err:dbghelp_msc:pe_load_debug_directory Got a page fault while loading symbols
0009:trace:dbghelp:pcs_callback 0x111998 2 0x34c378
0009:trace:dbghelp:pcs_callback 0x111998 1 0x34c378
0009:trace:dbghelp:pe_load_stabs failed to load the STABS debug info

Thanks,

Michel Jacques



      D?couvrez les styles qui font sensation sur Yahoo! Qu?bec Avatars.
http://cf.avatars.yahoo.com/


From infyquest at gmail.com  Tue Feb  5 12:02:27 2008
From: infyquest at gmail.com (Vijay Kiran Kamuju)
Date: Tue, 5 Feb 2008 13:02:27 -0500
Subject: winedbg - using pdb from Visual Studio 2005
In-Reply-To: <802215.94186.qm@web54603.mail.re2.yahoo.com>
References: <802215.94186.qm@web54603.mail.re2.yahoo.com>
Message-ID: <36bf289b0802051002o37c366c9p41787e61ab5b1828@mail.gmail.com>

Hi,

can you try this patch:
http://www.winehq.org/pipermail/wine-patches/2008-January/049156.html

I think currently dbghelp in wine doesnt support pdb files generated by VS 2005.

Thanks,
VJ

On Feb 5, 2008 12:54 PM, Michel Jacques <boardermj at yahoo.com> wrote:
> Hello,
>
> I am using PDBs generated with 2005 with wine version 0.9.54.
>
> I get errors related to my PDBs and I am wondering if I need
> to change the pdb format? Anything special to do when using 2005?
>
> Here are the errors I get, each time one of my pdb gets loaded:
>
> 0009:trace:dbghelp:SymFindFileInPathW (hProcess = 0x30, searchPath = (null), full_path =
> L"C:\\master\\x86\\debug\\bin\\mydll.pdb", id = 0x34c160, two = 0x00000002, three = 0x00000000,
> flags = 0x00000008, buffer = 0x34b718, cb = 0x6020fb50, user = 0x34bd30)
> 0009:err:dbghelp_msc:pdb_process_types -Unknown type info version 20040203
> 0009:err:dbghelp_msc:pe_load_debug_directory Got a page fault while loading symbols
> 0009:trace:dbghelp:pcs_callback 0x111998 2 0x34c378
> 0009:trace:dbghelp:pcs_callback 0x111998 1 0x34c378
> 0009:trace:dbghelp:pe_load_stabs failed to load the STABS debug info
>
> Thanks,
>
> Michel Jacques
>
>
>
>       D?couvrez les styles qui font sensation sur Yahoo! Qu?bec Avatars.
> http://cf.avatars.yahoo.com/
>
>
>

From paul.vriens.wine at gmail.com  Tue Feb  5 12:19:53 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 05 Feb 2008 19:19:53 +0100
Subject: Call for winetest ing
In-Reply-To: <47A8958F.90702@codeweavers.com>
References: <47A889D5.3080603@codeweavers.com> <47A88F35.7080104@gmail.com>
	<47A8958F.90702@codeweavers.com>
Message-ID: <47A8A8C9.9060508@gmail.com>

Hi Jeremy,

Jeremy White wrote:
> Hi Paul,
> 
>> Something we also have with the current tests is that the source files actually
>> point to the correct version in CVS. I now see some strange links to refs on
>> http://test.winehq.org/data/20080205/.
> 
> Well, I'm afraid I'd argue that the current tests should be updated to point
> to git...
> 
>> Even though the HEAD sha1 looks better than the date for a build-id it will
>> again introduce a lot of directories with only a few tests in there.
> 
> Is that really true?
> 
> Alexandre tends to touch the tree once a day, usually all in one batch.
> If folks kick off winetest right before the leave for the day, wouldn't
> the odds be that everyone would have the same HEAD sha1?  (I guess that requires
> people to run winetest from a clean, winehq only tree).
> 
> And even if it is true, isn't it more logically correct?

Ok, so even if HEAD tends to be the same doesn't that mean the same test doesn't 
get run on Windows versions? With a common source (and I agree that there 
probably should be more) it better to compare.

If you build both the winetest your self and run the tests with that same 
winetest the objectivity goes away, not?

> 
> Right now, I could download a winetest.exe and use
> Wine-0.9.1 to run it, and it would be grouped in the same bucket as someone running
> off their own badly hacked wine tip tree.  Doesn't that create misleading data?
>

That's true and I don't see an easy solution to that. There are loads of 
variables that influence the outcome of test as mentioned in this email but also 
in the rest of the email-chain.
We already see failures with tests on Wine that were not present on AJ's box.

> However, I agree that if we changed that now it would be a mess; we'd need to change
> the script that presents the directories to group them by date so as to present the
> more recent sha1 keys.
> 
>> I don't see a problem with running the winetest executable under Wine the same 
>> as I do under all kinds of Windows versions.
> 
> Perhaps you're right.  Occam would suggest you are.
> 
> But it sticks in my craw.  I have a source tree; I have
> built the files; I can run make test and it fails badly.  I want to tell the world
> about my failures now (/me stamps his little feet  <grin>).
> 
> Getting a .exe from you requires you to have reliably built winetest.exe, and does not
> allow me to test the tip *now*.  Further, if there are any discrepancies introduced
> by the way my system builds the test .exe files compared to yours, running your winetest.exe won't
> catch them.  (I realize that may be pure rationalization).
>

'You' in this case is Paul Millar and not this Paul ;-).

> I think to some extent we are at different purposes, which may explain a
> reason to change.
> 
> I think winetest has long been used to test the tests themselves, and to identify
> the issues with the tests and fix them.  That is, the variable is the tests, and the underlying
> OS (i.e. Windows) is essentially a constant.
> 
> But my purpose requires 2 variables - the tests changing as needed, but also the
> underlying OS - Wine - changing rapidly as well.
> 
> Cheers,
> 
> Jeremy
> 

-- 
Cheers,

Paul.


From msclrhd at googlemail.com  Tue Feb  5 06:34:54 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 5 Feb 2008 12:34:54 +0000
Subject: Blocked conformance tests
In-Reply-To: <Pine.LNX.4.64.0710262324400.21860@amboise.dolphin>
References: <Pine.LNX.4.64.0710262324400.21860@amboise.dolphin>
Message-ID: <3f4fd2640802050434u49fb21f8v10047c60a3372e63@mail.gmail.com>

On 05/02/2008, Francois Gouget <fgouget at free.fr> wrote:
>
> When I run winetest on Windows XP I get some dialog boxes asking me:
>
>    Do you want to keep blocking this program?

This is because the Windows firewall is blocking the application from
connecting to the internet and/or making TCP/IP calls.

> According to the title bar, the impacted tests are:
>    dplayx
>    rpcrt4
>    'Microsoft DirectPlay Helper'  ???
>    ws2_32
>
> My understanding is that it should only prevent the test from receiving
> network connections which I guess is not common. Does anyone know if
> this could cause any test failure currently?

If the firewall is blocking the network traffic, it should cause those
tests to fail.

> How does XP determine whether to block the test or not?
>
> Is the 'authorisation' based on the executable hash? If so there's no
> way to pre-authorise the tests for nightly tests.
>
> Should the winetest mark the executable so it is not hampered by this
> check?

I don't know if it is possible to automatically (or even globally)
allow these tests to run without disabling the firewall. This would
need further investigation.

Also, could you add a note about the presence of a firewall to the
ConformanceTests wiki page.

Thanks,
- Reece


From msclrhd at googlemail.com  Tue Feb  5 12:18:12 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 5 Feb 2008 18:18:12 +0000
Subject: Call for winetest ing
In-Reply-To: <47A8A03C.9090606@codeweavers.com>
References: <47A889D5.3080603@codeweavers.com> <47A88F35.7080104@gmail.com>
	<b6bb06270802050900k73d2fa36t7348865cf4c59ab5@mail.gmail.com>
	<47A8A03C.9090606@codeweavers.com>
Message-ID: <3f4fd2640802051018q3dc23e5dx134df7ea8e7fba6d@mail.gmail.com>

On 05/02/2008, Jeremy White <jwhite at codeweavers.com> wrote:
> > If some people went through the trouble of using buildid's and not the
> > precompiled winetest, along with documenting their hardware/OS on a
> > wiki page, for instance, then we could more information on where
> > specific failures are occuring. For instance, I noticed Joapa was
> > reporting some MSI bugs, and was the only one posting an MSI failure
> > in the make test usually failing bug.
>
> Actually, I think there is a better solution.  If we want to capture
> additional system information, and there is a command line tool that
> would allow that, we can do so in the new 'runtests' script.

For hardware and software information, capturing this and including it
in the test results in an automated way is a good idea. Updates will
change Windows and Wine behaviour and thus affect the results. It is
not feasible to track this manually in a static page, nor reliable
when looking back at the data.

That said, some general information may be useful along with the build
id, for example:

    id ; owner ; OS ; Machine Type (Laptop, Desktop, VM, ...) ; Description

    Vista-HomePrem-NoUAC ; ReeceDunn ; Windows Vista Home Premium ;
Notebook ; Same as Vista-HomePrem-UAC, but with UAC disabled.
    wine-0.9.54 ; ReeceDunn ; Ubuntu Gutsy Gibbon (7.10) ; Notebook ;
Running with the Zune theme installed.

This would be supplementary to the automatically gathered data.

Another idea would be to store some user settings (like the above) for
each build id. If the settings exist, use them, otherwise prompt the
user for them. These can then be added into the Wine test results
data.

> Right now, I have it capturing gcc, glibc, and kernel version info,
> and that is all readily available as part of the nifty winetest results page.
>
> We could also conceivably add info on processor count and ram size,
> as well as video and audio card.  (But those would require slightly
> more sophisticated scripts to postprocess; we don't want to just
> dump the results of xdpyinfo for example...).

It would also be useful to detect driver name and version (e.g. nv,
proprietry NVidia or nouveau) to help track regressions.

- Reece


From bon at elektron.ikp.physik.tu-darmstadt.de  Tue Feb  5 13:12:17 2008
From: bon at elektron.ikp.physik.tu-darmstadt.de (Uwe Bonnes)
Date: Tue, 5 Feb 2008 20:12:17 +0100
Subject: OUTB() and friends on Win32 and .sys files
Message-ID: <18344.46353.181579.491940@hertz.ikp.physik.tu-darmstadt.de>

Hallo,

some programm with source uses giveio.sys to access the parallel port. You
can find the source for giveio.sys e.g. in the avrdude package.  We
have code in dlls/winedos/ppdev.c to emulate the directed access on the
parallel port to accesses to /dev/ppdev. 

However this code is not called for WIN32 code. So after starting giveio
with loaddrv.exe supplied with giveio
> wine loaddrv.exe start giveio
starting giveio... ok.
> wine javr.exe
crashes when the outb access happens:
javr [<filename>] [-p<port>] [-f<fusefilename>] [-e<eepromfilename>] [-L] [-V]
Allocated flash buffer of 128K
Using giveio.sys to gain port access to 0x378
trace:seh:raise_exception code=c0000096 flags=0 addr=0x4014b6
trace:seh:raise_exception  eax=00000000 ebx=00000000 ecx=00000378 edx=00000378 esi=00000378 edi=00110388
trace:seh:raise_exception  ebp=0072fe50 esp=0072fe50 cs=0073 ds=007b es=007b fs=0033 gs=003b flags=00010246
trace:seh:call_stack_handlers calling handler at 0x7eddc5bc code=c0000096 flags=0
trace:seh:MSVCRT_signal (4, (nil))
wine: Unhandled privileged instruction at address 0x4014b6 (thread 0011), starting debugger...
trace:seh:start_debugger Starting debugger "winedbg --auto 16 56"
trace:seh:call_stack_handlers handler at 0x7eddc5bc returned 1
Unhandled exception: privileged instruction in 32-bit code (0x004014b6).
Register dump:
 CS:0073 SS:007b DS:007b ES:007b FS:0033 GS:003b
 EIP:004014b6 ESP:0072fe50 EBP:0072fe50 EFLAGS:00010246(   - 00      -RIZP1)
 EAX:00000000 EBX:00000000 ECX:00000378 EDX:00000378
 ESI:00000378 EDI:00110388
Stack dump:
0x0072fe50:  0072fe58 0040151a 0072fe88 00406ccf
0x0072fe60:  00000378 00000000 00000000 00403411
0x0072fe70:  00000001 00110388 0072fe88 0040a3ef
0x0072fe80:  0040a3ef 00000001 0072fec8 004025e4
0x0072fe90:  00000378 00000378 00110048 0040255c
0x0072fea0:  7ed5ff48 7ffdf000 0072fec8 7ed30f5c
Backtrace:
=>1 0x004014b6 outb+0x6(value=0x0, port=0x378) [/spare/bon/jtagprog/win/javr-2.8/ppiwin.c:311] in javr (0x0072fe50)

MS msvcrt.dll also supplies outb().

What is the policy to handle outb() and friends?

Thanks

-- 
Uwe Bonnes                bon at elektron.ikp.physik.tu-darmstadt.de

Institut fuer Kernphysik  Schlossgartenstrasse 9  64289 Darmstadt
--------- Tel. 06151 162516 -------- Fax. 06151 164321 ----------


From infyquest at gmail.com  Tue Feb  5 13:29:53 2008
From: infyquest at gmail.com (Vijay Kiran Kamuju)
Date: Tue, 5 Feb 2008 13:29:53 -0600
Subject: winedbg - using pdb from Visual Studio 2005
In-Reply-To: <36bf289b0802051002o37c366c9p41787e61ab5b1828@mail.gmail.com>
References: <802215.94186.qm@web54603.mail.re2.yahoo.com>
	<36bf289b0802051002o37c366c9p41787e61ab5b1828@mail.gmail.com>
Message-ID: <36bf289b0802051129x1b0b0e93j557919fa71dadf28@mail.gmail.com>

can you also try this patch also?
--
VJ

On Feb 5, 2008 12:02 PM, Vijay Kiran Kamuju <infyquest at gmail.com> wrote:
> Hi,
>
> can you try this patch:
> http://www.winehq.org/pipermail/wine-patches/2008-January/049156.html
>
> I think currently dbghelp in wine doesnt support pdb files generated by VS 2005.
>
> Thanks,
> VJ
>
>
> On Feb 5, 2008 12:54 PM, Michel Jacques <boardermj at yahoo.com> wrote:
> > Hello,
> >
> > I am using PDBs generated with 2005 with wine version 0.9.54.
> >
> > I get errors related to my PDBs and I am wondering if I need
> > to change the pdb format? Anything special to do when using 2005?
> >
> > Here are the errors I get, each time one of my pdb gets loaded:
> >
> > 0009:trace:dbghelp:SymFindFileInPathW (hProcess = 0x30, searchPath = (null), full_path =
> > L"C:\\master\\x86\\debug\\bin\\mydll.pdb", id = 0x34c160, two = 0x00000002, three = 0x00000000,
> > flags = 0x00000008, buffer = 0x34b718, cb = 0x6020fb50, user = 0x34bd30)
> > 0009:err:dbghelp_msc:pdb_process_types -Unknown type info version 20040203
> > 0009:err:dbghelp_msc:pe_load_debug_directory Got a page fault while loading symbols
> > 0009:trace:dbghelp:pcs_callback 0x111998 2 0x34c378
> > 0009:trace:dbghelp:pcs_callback 0x111998 1 0x34c378
> > 0009:trace:dbghelp:pe_load_stabs failed to load the STABS debug info
> >
> > Thanks,
> >
> > Michel Jacques
> >
> >
> >
> >       D?couvrez les styles qui font sensation sur Yahoo! Qu?bec Avatars.
> > http://cf.avatars.yahoo.com/
> >
> >
> >
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: partialvc8pdbsupport.diff
Type: text/x-diff
Size: 2890 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080205/d022ed93/attachment.diff 

From eric.pouech at orange.fr  Tue Feb  5 14:43:02 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Tue, 05 Feb 2008 21:43:02 +0100
Subject: winedbg - using pdb from Visual Studio 2005
In-Reply-To: <36bf289b0802051002o37c366c9p41787e61ab5b1828@mail.gmail.com>
References: <802215.94186.qm@web54603.mail.re2.yahoo.com>
	<36bf289b0802051002o37c366c9p41787e61ab5b1828@mail.gmail.com>
Message-ID: <47A8CA56.5030800@orange.fr>

Vijay Kiran Kamuju a ?crit :
> Hi,
>
> can you try this patch:
> http://www.winehq.org/pipermail/wine-patches/2008-January/049156.html
>
> I think currently dbghelp in wine doesnt support pdb files generated by VS 2005.
>
> Thanks,
> VJ
>
> On Feb 5, 2008 12:54 PM, Michel Jacques <boardermj at yahoo.com> wrote:
>   
>> Hello,
>>
>> I am using PDBs generated with 2005 with wine version 0.9.54.
>>
>> I get errors related to my PDBs and I am wondering if I need
>> to change the pdb format? Anything special to do when using 2005?
>>
>> Here are the errors I get, each time one of my pdb gets loaded:
>>
>> 0009:trace:dbghelp:SymFindFileInPathW (hProcess = 0x30, searchPath = (null), full_path =
>> L"C:\\master\\x86\\debug\\bin\\mydll.pdb", id = 0x34c160, two = 0x00000002, three = 0x00000000,
>> flags = 0x00000008, buffer = 0x34b718, cb = 0x6020fb50, user = 0x34bd30)
>> 0009:err:dbghelp_msc:pdb_process_types -Unknown type info version 20040203
>> 0009:err:dbghelp_msc:pe_load_debug_directory Got a page fault while loading symbols
>> 0009:trace:dbghelp:pcs_callback 0x111998 2 0x34c378
>> 0009:trace:dbghelp:pcs_callback 0x111998 1 0x34c378
>> 0009:trace:dbghelp:pe_load_stabs failed to load the STABS debug info
>>
>> Thanks,
>>
>> Michel Jacques
>>
>>
>>
>>       D?couvrez les styles qui font sensation sur Yahoo! Qu?bec Avatars.
>> http://cf.avatars.yahoo.com/
>>
>>
>>
>>     
>
>   
as explained earlier, this patch is mostly wrong on lots of aspects
I do have partial solution to it, but it's not finished yet
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From eric.pouech at orange.fr  Tue Feb  5 14:43:56 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Tue, 05 Feb 2008 21:43:56 +0100
Subject: winedbg - using pdb from Visual Studio 2005
In-Reply-To: <802215.94186.qm@web54603.mail.re2.yahoo.com>
References: <802215.94186.qm@web54603.mail.re2.yahoo.com>
Message-ID: <47A8CA8C.9030507@orange.fr>

Michel Jacques a ?crit :
> Hello, 
>
> I am using PDBs generated with 2005 with wine version 0.9.54.
>
> I get errors related to my PDBs and I am wondering if I need 
> to change the pdb format? Anything special to do when using 2005?
>
> Here are the errors I get, each time one of my pdb gets loaded:
>
> 0009:trace:dbghelp:SymFindFileInPathW (hProcess = 0x30, searchPath = (null), full_path =
> L"C:\\master\\x86\\debug\\bin\\mydll.pdb", id = 0x34c160, two = 0x00000002, three = 0x00000000,
> flags = 0x00000008, buffer = 0x34b718, cb = 0x6020fb50, user = 0x34bd30)
> 0009:err:dbghelp_msc:pdb_process_types -Unknown type info version 20040203
> 0009:err:dbghelp_msc:pe_load_debug_directory Got a page fault while loading symbols
>   
that's to be looked at and is the cause of your problems
can you send me your mydll.pdb file ? (off mailing list)

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From luis.busquets at ilidium.com  Tue Feb  5 15:03:22 2008
From: luis.busquets at ilidium.com (=?ISO-8859-1?Q?=22Luis_C=2E_Busquets_P=E9rez=22?=)
Date: Tue, 05 Feb 2008 22:03:22 +0100
Subject: Bug in patch winex11.drv: Don't create a win_data structure for the
	desktop window, except in the process that owns it.
Message-ID: <47A8CF1A.6020600@ilidium.com>

There is a bug in the patch:

    c19af910ebafa9b1928b0f67bee68f6b0b237e8e is first bad commit
commit c19af910ebafa9b1928b0f67bee68f6b0b237e8e
Author: Alexandre Julliard <julliard at winehq.org>
Date:   Thu Jan 17 19:53:59 2008 +0100

    winex11.drv: Don't create a win_data structure for the desktop 
window, except in the process that owns it.
   
    Handle desktop size changes by sending a message to the desktop owner.

:040000 040000 b7c030353fe92121bb999481724a3689429b2e8a 
80fd2c5f4ace2707abb01648bd61663a6c9d7626 M      dlls


It affects to Patrician3.exe. When initiating, it hangs and does not 
allow to play the movie. Actually, the programm changes the screen 
resolution and hangs. I understand that the problem is that it does not 
send the appropiate message for binkplayer.exe to play the movie.


From leidola at newcon.de  Tue Feb  5 15:14:42 2008
From: leidola at newcon.de (Olaf Leidinger)
Date: Tue, 5 Feb 2008 22:14:42 +0100
Subject: regression in worms2
Message-ID: <20080205221442.499d67c4.leidola@newcon.de>

Hello!

I noticed that the game "worms 2" broke between wine-0.9.53 and wine-0.9.54. A git-bisect revealed the guilty patches.

The game includes a frontend.exe which starts game.exe and controls the settings of the game (the map and teams etc.). Running game.exe directly works but you can't alter the settings. When running game.exe via frontend the game doesn't show up but hangs after changing resolution. Before the following commit the game starts and is playable:

2921f5c156b368b4ce6e615eb61dad5c5f423bf8 is first bad commit
commit 2921f5c156b368b4ce6e615eb61dad5c5f423bf8
Author: Alexandre Julliard <julliard at winehq.org>
Date:   Tue Jan 22 20:06:35 2008 +0100

    server: Invalidate the correct region when custom valid rects are specified.

:040000 040000 1385d5899b5b6affd5da84328e1bc15985406976 5c8756013a67c0402f3bb5fb9f3ee7b4a50e124a M      server

And this one makes worms2 hang after exiting the game:

c19af910ebafa9b1928b0f67bee68f6b0b237e8e is first bad commit
commit c19af910ebafa9b1928b0f67bee68f6b0b237e8e
Author: Alexandre Julliard <julliard at winehq.org>
Date:   Thu Jan 17 19:53:59 2008 +0100

    winex11.drv: Don't create a win_data structure for the desktop window, except in the process that owns it.
    
    Handle desktop size changes by sending a message to the desktop owner.

:040000 040000 b7c030353fe92121bb999481724a3689429b2e8a 80fd2c5f4ace2707abb01648bd61663a6c9d7626 M      dlls

Thanks for your attention!

Ciao,
Olaf
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080205/13f7894b/attachment.pgp 

From julliard at winehq.org  Tue Feb  5 15:15:02 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 05 Feb 2008 22:15:02 +0100
Subject: Bug in patch winex11.drv: Don't create a win_data structure for
	the desktop window, except in the process that owns it.
In-Reply-To: <47A8CF1A.6020600@ilidium.com> ("Luis C. Busquets =?utf-8?Q?P?=
	=?utf-8?Q?=C3=A9rez=22's?=
	message of "Tue, 05 Feb 2008 22:03:22 +0100")
References: <47A8CF1A.6020600@ilidium.com>
Message-ID: <87odavt8a1.fsf@wine.dyndns.org>

"Luis C. Busquets P?rez" <luis.busquets at ilidium.com> writes:

> It affects to Patrician3.exe. When initiating, it hangs and does not 
> allow to play the movie. Actually, the programm changes the screen 
> resolution and hangs. I understand that the problem is that it does not 
> send the appropiate message for binkplayer.exe to play the movie.

What message is that, and why doesn't it send it?

-- 
Alexandre Julliard
julliard at winehq.org


From wine-devel at kievinfo.com  Tue Feb  5 15:18:56 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 05 Feb 2008 14:18:56 -0700
Subject: regression in worms2
In-Reply-To: <20080205221442.499d67c4.leidola@newcon.de>
References: <20080205221442.499d67c4.leidola@newcon.de>
Message-ID: <47A8D2C0.9070301@kievinfo.com>

What bug # is this? Please note this is not bugzilla, you will be expected 
to debug this problem yourself and provide technical information.

Vitaliy

Olaf Leidinger wrote:
> Hello!
> 
> I noticed that the game "worms 2" broke between wine-0.9.53 and wine-0.9.54. A git-bisect revealed the guilty patches.
> 
> The game includes a frontend.exe which starts game.exe and controls the settings of the game (the map and teams etc.). Running game.exe directly works but you can't alter the settings. When running game.exe via frontend the game doesn't show up but hangs after changing resolution. Before the following commit the game starts and is playable:
> 
> 2921f5c156b368b4ce6e615eb61dad5c5f423bf8 is first bad commit
> commit 2921f5c156b368b4ce6e615eb61dad5c5f423bf8
> Author: Alexandre Julliard <julliard at winehq.org>
> Date:   Tue Jan 22 20:06:35 2008 +0100
> 
>     server: Invalidate the correct region when custom valid rects are specified.
> 
> :040000 040000 1385d5899b5b6affd5da84328e1bc15985406976 5c8756013a67c0402f3bb5fb9f3ee7b4a50e124a M      server
> 
> And this one makes worms2 hang after exiting the game:
> 
> c19af910ebafa9b1928b0f67bee68f6b0b237e8e is first bad commit
> commit c19af910ebafa9b1928b0f67bee68f6b0b237e8e
> Author: Alexandre Julliard <julliard at winehq.org>
> Date:   Thu Jan 17 19:53:59 2008 +0100
> 
>     winex11.drv: Don't create a win_data structure for the desktop window, except in the process that owns it.
>     
>     Handle desktop size changes by sending a message to the desktop owner.
> 
> :040000 040000 b7c030353fe92121bb999481724a3689429b2e8a 80fd2c5f4ace2707abb01648bd61663a6c9d7626 M      dlls
> 
> Thanks for your attention!
> 
> Ciao,
> Olaf
> 
> 
> ------------------------------------------------------------------------
> 
> 



From wine-devel at kievinfo.com  Tue Feb  5 15:19:11 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 05 Feb 2008 14:19:11 -0700
Subject: Bug in patch winex11.drv: Don't create a win_data structure for
	the	desktop window, except in the process that owns it.
In-Reply-To: <47A8CF1A.6020600@ilidium.com>
References: <47A8CF1A.6020600@ilidium.com>
Message-ID: <47A8D2CF.7050704@kievinfo.com>

What bug # is this? Please note this is not bugzilla, you will be expected 
to debug this problem yourself and provide technical information.

Vitaliy


Luis C. Busquets P?rez wrote:
> There is a bug in the patch:
> 
>     c19af910ebafa9b1928b0f67bee68f6b0b237e8e is first bad commit
> commit c19af910ebafa9b1928b0f67bee68f6b0b237e8e
> Author: Alexandre Julliard <julliard at winehq.org>
> Date:   Thu Jan 17 19:53:59 2008 +0100
> 
>     winex11.drv: Don't create a win_data structure for the desktop 
> window, except in the process that owns it.
>    
>     Handle desktop size changes by sending a message to the desktop owner.
> 
> :040000 040000 b7c030353fe92121bb999481724a3689429b2e8a 
> 80fd2c5f4ace2707abb01648bd61663a6c9d7626 M      dlls
> 
> 
> It affects to Patrician3.exe. When initiating, it hangs and does not 
> allow to play the movie. Actually, the programm changes the screen 
> resolution and hangs. I understand that the problem is that it does not 
> send the appropiate message for binkplayer.exe to play the movie.
> 
> 



From leidola at newcon.de  Tue Feb  5 15:36:07 2008
From: leidola at newcon.de (Olaf Leidinger)
Date: Tue, 5 Feb 2008 22:36:07 +0100
Subject: bugzilla-problems - was Re: regression in worms2
In-Reply-To: <47A8D2C0.9070301@kievinfo.com>
References: <20080205221442.499d67c4.leidola@newcon.de>
	<47A8D2C0.9070301@kievinfo.com>
Message-ID: <20080205223607.31376556.leidola@newcon.de>

Hello!

> What bug # is this? Please note this is not bugzilla, you will be expected 
> to debug this problem yourself and provide technical information.

Well, I'd like to report the bug, but it seems bugzilla has problems:

Software error:

Can't connect to the database.
Error: Too many connections
  Is your database installed and up and running?
  Do you have the correct username and password selected in localconfig?

Ciao,

Olaf


From leidola at newcon.de  Tue Feb  5 15:39:24 2008
From: leidola at newcon.de (Olaf Leidinger)
Date: Tue, 5 Feb 2008 22:39:24 +0100
Subject: regression in worms2
In-Reply-To: <47A8D2C0.9070301@kievinfo.com>
References: <20080205221442.499d67c4.leidola@newcon.de>
	<47A8D2C0.9070301@kievinfo.com>
Message-ID: <20080205223924.9a0ab057.leidola@newcon.de>

Hello!

> What bug # is this? Please note this is not bugzilla, you will be expected 
> to debug this problem yourself and provide technical information.

Well, I'd like to report the bug, but it seems bugzilla has problems:

Software error:

Can't connect to the database.
Error: Too many connections
  Is your database installed and up and running?
  Do you have the correct username and password selected in localconfig?

Ciao,

Olaf


From leidola at newcon.de  Tue Feb  5 15:57:27 2008
From: leidola at newcon.de (Olaf Leidinger)
Date: Tue, 5 Feb 2008 22:57:27 +0100
Subject: regression in worms2
In-Reply-To: <20080205223924.9a0ab057.leidola@newcon.de>
References: <20080205221442.499d67c4.leidola@newcon.de>
	<47A8D2C0.9070301@kievinfo.com>
	<20080205223924.9a0ab057.leidola@newcon.de>
Message-ID: <20080205225727.7fabe4fa.leidola@newcon.de>

Hello again!

Bugzilla seems to work again. The bug number is 11481.

Ciao,
Olaf


From leidola at newcon.de  Tue Feb  5 15:58:57 2008
From: leidola at newcon.de (Olaf Leidinger)
Date: Tue, 5 Feb 2008 22:58:57 +0100
Subject: Bug in patch winex11.drv: Don't create a win_data structure for
	the desktop window, except in the process that owns it.
In-Reply-To: <47A8D2CF.7050704@kievinfo.com>
References: <47A8CF1A.6020600@ilidium.com>
	<47A8D2CF.7050704@kievinfo.com>
Message-ID: <20080205225857.79129218.leidola@newcon.de>

Hello!

This is also one patch that affects worms2. I added it to bugzilla as bug 11481.

Ciao,
Olaf


From wine-devel at kievinfo.com  Tue Feb  5 16:00:41 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 05 Feb 2008 15:00:41 -0700
Subject: regression in worms2
In-Reply-To: <20080205225727.7fabe4fa.leidola@newcon.de>
References: <20080205221442.499d67c4.leidola@newcon.de>	<47A8D2C0.9070301@kievinfo.com>	<20080205223924.9a0ab057.leidola@newcon.de>
	<20080205225727.7fabe4fa.leidola@newcon.de>
Message-ID: <47A8DC89.50208@kievinfo.com>

Olaf Leidinger wrote:
> Hello again!
> 
> Bugzilla seems to work again. The bug number is 11481.
> 
> Ciao,
> Olaf
> 
> 
Great now for your left to learn how to use search button:
Duplicate of Bug 11340!!!

What users doing here anyway?

Vitaliy


From leidola at newcon.de  Tue Feb  5 16:13:59 2008
From: leidola at newcon.de (Olaf Leidinger)
Date: Tue, 5 Feb 2008 23:13:59 +0100
Subject: regression in worms2
In-Reply-To: <47A8DC89.50208@kievinfo.com>
References: <20080205221442.499d67c4.leidola@newcon.de>
	<47A8D2C0.9070301@kievinfo.com>
	<20080205223924.9a0ab057.leidola@newcon.de>
	<20080205225727.7fabe4fa.leidola@newcon.de>
	<47A8DC89.50208@kievinfo.com>
Message-ID: <20080205231359.87a14313.leidola@newcon.de>

Hello!

> Great now for your left to learn how to use search button:
> Duplicate of Bug 11340!!!
Well, I'm sorry I posted a dublicate bug, perhaps I searched the wrong way ;-/
 
> What users doing here anyway?
Hm... that's exactly what "How to do regression testing using Git" recommends.

"report about it to Wine Bugzilla  or subscribe to wine-devel and post it there."

As bugzilla didn't work, I posted it to wine-devel.


Anyways, have a nice day!

Ciao,
Olaf
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080205/eb15a9a1/attachment-0001.pgp 

From thunderbird2k at gmx.net  Tue Feb  5 16:20:23 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Tue, 05 Feb 2008 23:20:23 +0100
Subject: added wgl_bind_to_texture_depth_nv to ConvertAttribWGLtoGLX
In-Reply-To: <47A8DE85.2050901@gmail.com>
References: <47A8DE85.2050901@gmail.com>
Message-ID: <20080205222023.41410@gmx.net>

> This patch doesn't implement the format, simply says that is can't be
> converted. This is my first patch, sorry if the format is wrong.

Ok not converting the format is fine but you are also changing the return value of wglMakeCurrent. Resubmit the patch without that unneeded change.

Roderick
-- 
Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen! 
Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer


From dank at kegel.com  Tue Feb  5 16:25:11 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 5 Feb 2008 14:25:11 -0800
Subject: Building tests with MSVC 6 broken?
Message-ID: <a71bd89a0802051425k7ed3bf68p3effb2ad3cae23d6@mail.gmail.com>

Call me an oldtimer, but I decided to try building
winetest with MSVC 6 today.

I installed cygwin's git and perl, grabbed wine from git,
and used msvcmaker as described at
http://winehq.org/site/docs/winedev-guide/testing-windows

I downloaded and installed the Platform SDK from
the first google hit, the Windows Server 2003 SP1 Platform SDK,
http://www.microsoft.com/downloads/details.aspx?FamilyId=A55B6B43-E24F-4EA3-A93E-40C0EC4F68E5
(although the latest is Windows Server 2003 R2 Platform SDK,
I thought the slightly older one would be ok).
Oddly, Microsoft's Platform SDK page lists the SP1 SDK
as the latest.  Pffft.

I then used Tools/ Options / Directories to tell msdev
about include and lib in both msvc6 and the platform SDK.
Then I tried building wineruntests.

First hitch:
error C2065: 'RRF_RT_REG_DWORD' : undeclared identifier
Fix:
Move Platform SDK higher in the priority list in Tools / Options / Directories.
msdev will then use the newer headers, which have that symbol.

Second hitch:
Linking... uuid.lib(cguid_i.obj) : fatal error LNK1103: debugging
information corrupt; recompile module Error executing link.exe.
Fix: From http://blogs.msdn.com/stephen_griffin/archive/2006/08/03/building-mfcmapi-with-visual-studio-6.aspx
In the platform SDK's lib directory, rename uuid.lib to uuid.lib.bad.
msdev will then use the older library.  (Microsoft intentionally removed
VC6 support from the newer one, whoops.)

Third hitch:
http://www.winehq.org/pipermail/wine-patches/2007-September/043988.html
introduced a type LSTATUS into winreg.h.  This isn't present in
the 2003 SP1 platform sdk, nor in the newer 2003 R2 platform SDK,
but as long as only our winreg.h uses it, that's fine.  Sadly, that
patch uses it elsewhere, so compilation breaks.
A google search for LSTATUS at microsoft.com finds nothing.
Fix:
change the LSTATUS in comctl32/tests/mru.c to LONG
(gee, maybe we should move the definition of LSTATUS from winreg.h to
advapi32/registry.c, too).
(But see below.)

Fourth hitch:
comdlg32\tests\printdlg.c: error C2064: 'LPPRINTDLGEXW' : undeclared identifier
Turns out commdlg.h in the platform sdk only defines LPPRINTDLGEXW if
STDMETHOD is declared.  STDMETHOD is declared in basetyps.h, but
including that file makes commdlg.h not even compile.  Bleah.
Fix:
replace the #include "windef.h" ... "winuser.h" with #include "windows.h"
in comdlg32/tests/printdlg.h.

Fifth hitch:
crypt32/tests/cert.c: error C2081: 'HCRYPTPROV_OR_NCRYPT_KEY_HANDLE':
name in formal parameter list illegal
Turns out that identifier was introduced in Vista, and added to Wine here:
http://www.winehq.org/pipermail/wine-patches/2007-August/042250.html
Fix:
Uninstall the platform SDK and install the Windows SDK!
http://www.microsoft.com/downloads/details.aspx?familyid=c2b1e300-f358-4523-b479-f53d234cdccf

Sixth hitch:
c:\program files\microsoft sdks\windows\v6.0\include\specstrings.h:
fatal error C1083: cannot open include file 'sal.h'
I think sal.h comes with Visual Studio 8 and higher.  Crap.

Thus it looks like you can't build wine's tests with Visual C 6 and
the Microsoft headers anymore.

So I tried building with the Wine headers.
That blows up with "can't find stdio.h".

So I'm stuck.  What's the recommended way to build the wine test suite
with Visual C 6, if any?
- Dan


From chris.kcat at gmail.com  Tue Feb  5 16:29:58 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Tue, 5 Feb 2008 14:29:58 -0800
Subject: added wgl_bind_to_texture_depth_nv to ConvertAttribWGLtoGLX
In-Reply-To: <47A8DE85.2050901@gmail.com>
References: <47A8DE85.2050901@gmail.com>
Message-ID: <200802051429.58688.chris.kcat@gmail.com>

On Tuesday 05 February 2008 02:09:09 pm Christopher Harvey wrote:
> @@ -758,6 +758,7 @@ static int ConvertAttribWGLtoGLX(const int* iWGLAttr,
> int* oGLXAttr, Wine_GLPBuf nvfloatattrib = iWGLAttr[++cur];
> ? ? ? ?TRACE("pAttr[%d] = WGL_FLOAT_COMPONENTS_NV: %x\n", cur,
> nvfloatattrib); break ;
> + ? ?case WGL_BIND_TO_TEXTURE_DEPTH_NV:
> ? ? ?case WGL_BIND_TO_TEXTURE_RGB_ARB:
> ? ? ?case WGL_BIND_TO_TEXTURE_RGBA_ARB:
> ? ? ?case WGL_BIND_TO_TEXTURE_RECTANGLE_FLOAT_R_NV:

I don't think it's correct to add this since it's not supported (the extension 
string isn't exported and it can't be easilly emulated). If an app is trying 
to set that attribute without the extension being advertised, I'd say the app 
is broken. If you're intending on adding support, you may want to familiarize 
yourself with how wine emulates render_to_texture and look over the 
extension:
http://opengl.org/registry/specs/NV/render_depth_texture.txt


From nessi at nessi-online.de  Tue Feb  5 16:33:25 2008
From: nessi at nessi-online.de (Jens Nestler)
Date: Tue, 5 Feb 2008 23:33:25 +0100
Subject: [Patch for Bug 8551] MoveFileWithProgressW unconditional fails
	for directories with flag MOVEFILE_REPLACE_EXISTING
In-Reply-To: <a71bd89a0801290733n449fcec6j50dbd0b767d4bf2b@mail.gmail.com>
References: <a71bd89a0801290733n449fcec6j50dbd0b767d4bf2b@mail.gmail.com>
Message-ID: <200802052333.25818.nessi@nessi-online.de>

Am Dienstag, 29. Januar 2008 16:33:14 schrieb Dan Kegel:
> James McKenzie wrote:
> > Please submit a git diff not a UNIX diff.
>
> Now, hang on there.  Jens submitted a perfectly
> good unified diff patch taken from the right directory.
> There is no reason to turn up our noses at it.
> It will apply using patch in exactly the same way as
> a diff generated by git.
>
> Jens, you're fine, I wouldn't bother rediffing.  You might
> however resend your patch next week when Alexandre
> the maintainer is back from vacation!
> - Dan

Thank you very much, Dan

here I resend the patch for the MoveFileWithProgressW bug.
Jens


From nessi at nessi-online.de  Tue Feb  5 16:50:42 2008
From: nessi at nessi-online.de (Jens Nestler)
Date: Tue, 5 Feb 2008 23:50:42 +0100
Subject: RegOverridePredefKey stub - Take 2
In-Reply-To: <01e301c8627d$16f7c5f0$a600fea9@DMITRY>
References: <200801282307.37940.nessi@nessi-online.de>
	<200801290817.56388.nessi@nessi-online.de>
	<01e301c8627d$16f7c5f0$a600fea9@DMITRY>
Message-ID: <200802052350.42794.nessi@nessi-online.de>

Am Dienstag, 29. Januar 2008 14:44:35 schrieb Dmitry Timoshkov:
> "Jens Nestler" <nessi at nessi-online.de> wrote:
> > Sorry, I haven't seen it.
> > Can you please change it, or should I deliver a changed patch ?
>
> Please resend and updated patch with a 'Take 2' in the subject and
> an explanation in the body what's changed.

Stub implementation for RegOverridePredefKey.
The added prototype in the winreg.h is now in alphabetical order.
Jens
-------------- next part --------------
A non-text attachment was scrubbed...
Name: patch_RegOverridePredefKey.diff
Type: text/x-diff
Size: 4292 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080205/1c0d593d/attachment.diff 

From xixsimplicityxix at gmail.com  Tue Feb  5 19:24:24 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Tue, 5 Feb 2008 19:24:24 -0600
Subject: Building tests with MSVC 6 broken?
In-Reply-To: <a71bd89a0802051425k7ed3bf68p3effb2ad3cae23d6@mail.gmail.com>
References: <a71bd89a0802051425k7ed3bf68p3effb2ad3cae23d6@mail.gmail.com>
Message-ID: <78a7dad00802051724h7147b7f0wdda319c74d9e2012@mail.gmail.com>

On Feb 5, 2008 4:25 PM, Dan Kegel <dank at kegel.com> wrote:
> Fifth hitch:
> crypt32/tests/cert.c: error C2081: 'HCRYPTPROV_OR_NCRYPT_KEY_HANDLE':
> name in formal parameter list illegal
> Turns out that identifier was introduced in Vista, and added to Wine here:
> http://www.winehq.org/pipermail/wine-patches/2007-August/042250.html
> Fix:
> Uninstall the platform SDK and install the Windows SDK!
> http://www.microsoft.com/downloads/details.aspx?familyid=c2b1e300-f358-4523-b479-f53d234cdccf
>

I don't know if this will help with compiling the tests. but I have
fought with that many headed SDK nonsense too.

Sorry Dan you still don't have the latest SDK =P (assuming you used
the one with the link you gave).

You have linked to the one published 2006-11-07:
"Microsoft(R) Windows(R) Software Development Kit for Windows Vista?
and .NET Framework 3.0 Runtime Components"

Trickily enough the latest SDK is actually published on 2007-03-22:
"Microsoft(R) Windows(R) Software Development Kit Update for Windows Vista?"
http://www.microsoft.com/downloads/details.aspx?FamilyID=4377F86D-C913-4B5C-B87E-EF72E5B4E065&displaylang=en


The only sane way I've found to find out what the heck is going on
with the SDK is the blog page:
http://blogs.msdn.com/windowssdk/

but lately they have this page now too (which hopefully will stay
maintained? who can say..) that lists the latest sdk right now (in
theory)
http://msdn2.microsoft.com/en-us/windowsserver/bb980924.aspx


So maybe grabbing the latest sdk will help maybe it won't.  Hopefully
this will save everyone some time in crazy msdn land.

Regards,
John Klehm

From dank at kegel.com  Tue Feb  5 19:50:13 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 5 Feb 2008 17:50:13 -0800
Subject: Building tests with Visual Studio 2005 Express
Message-ID: <a71bd89a0802051750w1ebed6a8p6f7d00f7e5f2cca5@mail.gmail.com>

After giving up for the moment on building with Visual C 6,
I tried Visual Studio 2005.

First hitch:
Boy, does it spew out lots of warnings about deprecated functions!
http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=87401&SiteID=1
talks about this a bit; defining _CRT_SECURE_NO_DEPRECATE
and _CRT_NONSTDC_NO_DEPRECATE suppresses the warnings.
Fix:
You can't set them via corewin_express.vsprops because our project is
converted from an
older visual studio version, so you have to add those two defines to
all the .dsp files, e.g.
  perl -p -i -e 's,/D "WIN32",/D "WIN32" /D
"_CRT_NONSTDC_NO_DEPRECATE" /D "_CRT_SECURE_NO_DEPRECATE",'  `find .
-iname '*.dsp'`

Second hitch:
For some reason, the imported projects lose their list of .lib files to link
against.
Fix:
As suggested at
http://msdn2.microsoft.com/en-us/express/aa700755.aspx
add user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib
shell32.lib ole32.lib oleaut32.lib uuid.lib
to the "Additional Dependencies" setting in the file corewin_express.vsprops.

Third hitch:
error C2065: 'PFORM_INFO_2A': undeclared identifier
See http://msdn2.microsoft.com/en-us/library/aa383745(VS.85).aspx
and http://blogs.msdn.com/oldnewthing/archive/2007/04/11/2079137.aspx
winspool.h only defines the new symbol if NTDDI_VERSION is NTDDI_LONGHORN
or higher.  NTDDI_LONGHORN is 0x06000000.
Fix:
add /D _WIN32_WINNT=0x0600 to that list of changes to all the .dsp
files in hitch #1 above.

Fourth hitch:
urlmon_test.exe refers to CLSID_IdentityUnmarshal, but that symbol is
not defined.
??

Fifth hitch:
generated.c refers to CS_STUB_INFO, which is not defined in
Microsoft's rpcndr.h.
??

Sixth hitch:
it can't find server.h
Seventh hitch:
can't find tmarshal.h
Fix:
Not sure, but maybe these files need to be generated by midl, and msvcmaker
doesn't know about that yet?  See
http://www.mail-archive.com/wine-devel at winehq.org/msg37442.html

Eighth hitch:
riched20/tests/editor.c fails to compile because in GETTEXTEX, the
field is named lpUsedDefChar, not lpUsedDefaultChar
Fix:
fix our richedit.h?

...

Seventy-seventh hitch:
gdiplus/tests/brush.c includes Microsoft's gdiplus.h, but that's not
safe to include from C, so you get an error on the namespace.

Golly.  I guess I won't be building the tests with any flavor of
microsoft C any time soon!
- Dan


From dank at kegel.com  Tue Feb  5 19:51:50 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 5 Feb 2008 17:51:50 -0800
Subject: Building tests with MSVC 6 broken?
In-Reply-To: <78a7dad00802051724h7147b7f0wdda319c74d9e2012@mail.gmail.com>
References: <a71bd89a0802051425k7ed3bf68p3effb2ad3cae23d6@mail.gmail.com>
	<78a7dad00802051724h7147b7f0wdda319c74d9e2012@mail.gmail.com>
Message-ID: <a71bd89a0802051751n39682847yd5addff62ae7a3f7@mail.gmail.com>

On Feb 5, 2008 5:24 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> > crypt32/tests/cert.c: error C2081: 'HCRYPTPROV_OR_NCRYPT_KEY_HANDLE':
> > name in formal parameter list illegal
> > Turns out that identifier was introduced in Vista, and added to Wine here:
> > http://www.winehq.org/pipermail/wine-patches/2007-August/042250.html
> > Fix:
> > Uninstall the platform SDK and install the Windows SDK!
> > http://www.microsoft.com/downloads/details.aspx?familyid=c2b1e300-f358-4523-b479-f53d234cdccf
>
> I don't know if this will help with compiling the tests. but I have
> fought with that many headed SDK nonsense too.

Yeah, I saw your post about make crosstest dependencies, too, thanks.

> Sorry Dan you still don't have the latest SDK =P (assuming you used
> the one with the link you gave).
>
> You have linked to the one published 2006-11-07:
> "Microsoft(R) Windows(R) Software Development Kit for Windows Vista?
> and .NET Framework 3.0 Runtime Components"
>
> Trickily enough the latest SDK is actually published on 2007-03-22:
> "Microsoft(R) Windows(R) Software Development Kit Update for Windows Vista?"
> http://www.microsoft.com/downloads/details.aspx?FamilyID=4377F86D-C913-4B5C-B87E-EF72E5B4E065&displaylang=en

Thanks for the tip!
- Dan


From dank at kegel.com  Tue Feb  5 19:51:50 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 5 Feb 2008 17:51:50 -0800
Subject: Building tests with MSVC 6 broken?
In-Reply-To: <78a7dad00802051724h7147b7f0wdda319c74d9e2012@mail.gmail.com>
References: <a71bd89a0802051425k7ed3bf68p3effb2ad3cae23d6@mail.gmail.com>
	<78a7dad00802051724h7147b7f0wdda319c74d9e2012@mail.gmail.com>
Message-ID: <a71bd89a0802051751n39682847yd5addff62ae7a3f7@mail.gmail.com>

On Feb 5, 2008 5:24 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> > crypt32/tests/cert.c: error C2081: 'HCRYPTPROV_OR_NCRYPT_KEY_HANDLE':
> > name in formal parameter list illegal
> > Turns out that identifier was introduced in Vista, and added to Wine here:
> > http://www.winehq.org/pipermail/wine-patches/2007-August/042250.html
> > Fix:
> > Uninstall the platform SDK and install the Windows SDK!
> > http://www.microsoft.com/downloads/details.aspx?familyid=c2b1e300-f358-4523-b479-f53d234cdccf
>
> I don't know if this will help with compiling the tests. but I have
> fought with that many headed SDK nonsense too.

Yeah, I saw your post about make crosstest dependencies, too, thanks.

> Sorry Dan you still don't have the latest SDK =P (assuming you used
> the one with the link you gave).
>
> You have linked to the one published 2006-11-07:
> "Microsoft(R) Windows(R) Software Development Kit for Windows Vista?
> and .NET Framework 3.0 Runtime Components"
>
> Trickily enough the latest SDK is actually published on 2007-03-22:
> "Microsoft(R) Windows(R) Software Development Kit Update for Windows Vista?"
> http://www.microsoft.com/downloads/details.aspx?FamilyID=4377F86D-C913-4B5C-B87E-EF72E5B4E065&displaylang=en

Thanks for the tip!
- Dan


From fgouget at free.fr  Tue Feb  5 19:01:28 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 6 Feb 2008 02:01:28 +0100 (CET)
Subject: Building tests with MSVC 6 broken?
In-Reply-To: <a71bd89a0802051425k7ed3bf68p3effb2ad3cae23d6@mail.gmail.com>
References: <a71bd89a0802051425k7ed3bf68p3effb2ad3cae23d6@mail.gmail.com>
Message-ID: <alpine.DEB.0.999999.0802060148420.14069@amboise.dolphin>

On Tue, 5 Feb 2008, Dan Kegel wrote:

> Building tests with MSVC 6 broken?

Yes.
MSVC 6 really starts to show its age.

It has trouble with some math stuff (rather large constants) used in one 
of the tests. That can be worked around by applying a service pack. See:
   http://www.winehq.org/site/docs/winedev-guide/testing-windows

But the show stopper is that it is incompatible with the latest SDKs.
 * First there's the LSTATUS stuff. The PSDK assumes it's defined in a 
   header that's provided by Visual C++ (basetyps.h), but VC6 does not 
   have it. Same for sal.h.
 * Then there's the format of some of the PSDK libraries which MSVC 6 
   does not understand. That's the error you got with uuid.lib but it 
   happens with others too (all static libraries I believe).


The solution is to use Visual Studio 2005 which is a free download.
There's still some hitches there:
 * it does not use .dsp files anymore but can convert them to the new 
   XML build files.
 * in the process it loses some dll imports so you'll have to add them 
   back manually, for each test. So it's feasible to compile individual 
   tests but compiling all of them is a real pain.
 * you'd better add _CRT_NONSTDC_NO_DEPRECATE and _CRT_SECURE_NO_DEPRECATE
   otherwise you'll get a ton of warnings.

What this means is that msvcmaker needs to be updated to generate the 
new XML build files directly, all with the right settings.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
     You can have my guns when you pry them from my kids cold, dead hands.


From dank at kegel.com  Tue Feb  5 20:08:45 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 5 Feb 2008 18:08:45 -0800
Subject: Building tests with MSVC 6 broken?
In-Reply-To: <alpine.DEB.0.999999.0802060148420.14069@amboise.dolphin>
References: <a71bd89a0802051425k7ed3bf68p3effb2ad3cae23d6@mail.gmail.com>
	<alpine.DEB.0.999999.0802060148420.14069@amboise.dolphin>
Message-ID: <a71bd89a0802051808n7556dcd2qa1a85a9897d6d5ce@mail.gmail.com>

On Feb 5, 2008 5:01 PM, Francois Gouget <fgouget at free.fr> wrote:
> The solution is to use Visual Studio 2005 which is a free download.
> There's still some hitches there:
>  * it does not use .dsp files anymore but can convert them to the new
>    XML build files.
>  * in the process it loses some dll imports so you'll have to add them
>    back manually, for each test. So it's feasible to compile individual
>    tests but compiling all of them is a real pain.
>  * you'd better add _CRT_NONSTDC_NO_DEPRECATE and _CRT_SECURE_NO_DEPRECATE
>    otherwise you'll get a ton of warnings.

I gathered that, but check out my next post, there are other
roadblocks.  Maybe if I use the right Windows SDK (as pointed out by John Klehm)
some of these will go away.

> What this means is that msvcmaker needs to be updated to generate the
> new XML build files directly, all with the right settings.

Yep.


From fgouget at free.fr  Tue Feb  5 20:48:15 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 6 Feb 2008 03:48:15 +0100 (CET)
Subject: Building tests with MSVC 6 broken?
In-Reply-To: <a71bd89a0802051808n7556dcd2qa1a85a9897d6d5ce@mail.gmail.com>
References: <a71bd89a0802051425k7ed3bf68p3effb2ad3cae23d6@mail.gmail.com>
	<alpine.DEB.0.999999.0802060148420.14069@amboise.dolphin>
	<a71bd89a0802051808n7556dcd2qa1a85a9897d6d5ce@mail.gmail.com>
Message-ID: <alpine.DEB.0.999999.0802060343020.11483@amboise.dolphin>

On Tue, 5 Feb 2008, Dan Kegel wrote:

> On Feb 5, 2008 5:01 PM, Francois Gouget <fgouget at free.fr> wrote:
> > The solution is to use Visual Studio 2005 which is a free download.
> > There's still some hitches there:
> >  * it does not use .dsp files anymore but can convert them to the new
> >    XML build files.
> >  * in the process it loses some dll imports so you'll have to add them
> >    back manually, for each test. So it's feasible to compile individual
> >    tests but compiling all of them is a real pain.
> >  * you'd better add _CRT_NONSTDC_NO_DEPRECATE and _CRT_SECURE_NO_DEPRECATE
> >    otherwise you'll get a ton of warnings.
> 
> I gathered that, but check out my next post, there are other
> roadblocks.  Maybe if I use the right Windows SDK (as pointed out by John Klehm)
> some of these will go away.

I remember that when I was still using VC6 I regularly had to update the 
PSDK in order to make the conformance tests happy (but note that I had a 
bias towards using the PSDK headers). But at some point I became stuck 
because I couldn't get the new PSDKs to work with VC6. That's when I got 
forced to switch to VC2005.

So I'm not sure there exists a PSDK that's both recent enough for the 
conformance tests and compatible with VC6.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                            $live{free} || die "";


From fgouget at free.fr  Tue Feb  5 21:06:44 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 6 Feb 2008 04:06:44 +0100 (CET)
Subject: Building tests with Visual Studio 2005 Express
In-Reply-To: <a71bd89a0802051750w1ebed6a8p6f7d00f7e5f2cca5@mail.gmail.com>
References: <a71bd89a0802051750w1ebed6a8p6f7d00f7e5f2cca5@mail.gmail.com>
Message-ID: <alpine.DEB.0.999999.0802060349500.11483@amboise.dolphin>

On Tue, 5 Feb 2008, Dan Kegel wrote:

> After giving up for the moment on building with Visual C 6,
> I tried Visual Studio 2005.
> 
> First hitch:
> Boy, does it spew out lots of warnings about deprecated functions!
> http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=87401&SiteID=1
> talks about this a bit; defining _CRT_SECURE_NO_DEPRECATE
> and _CRT_NONSTDC_NO_DEPRECATE suppresses the warnings.

commit aba98c62b4d44aae5d3e199acc6d7efceb7be417
Author: Francois Gouget <fgouget at free.fr>
Date:   Fri Feb 2 16:26:36 2007 +0100

    msvcmaker: Add _CRT macros to avoid being flooded with Visual Studio 
2005 warnings.

diff --git a/tools/winapi/msvcmaker b/tools/winapi/msvcmaker
index 50644ac..2176a9e 100755
--- a/tools/winapi/msvcmaker
+++ b/tools/winapi/msvcmaker
@@ -642,6 +642,8 @@ sub _generate_dsp($$) {
                push @includes, $wine_include_dir;
            }
        }
+       # Add these _CRT macros to avoid warnings with Visual Studio 2005
+       push @defines2, "_CRT_NONSTDC_NO_DEPRECATE", "_CRT_SECURE_NO_DEPRECATE";
 
        if($wine) {
            foreach my $include (@includes) {

But this patch is no good because we should really only set these 
when generating project files in the new format.


[...]
> Third hitch:
> error C2065: 'PFORM_INFO_2A': undeclared identifier
> See http://msdn2.microsoft.com/en-us/library/aa383745(VS.85).aspx
> and http://blogs.msdn.com/oldnewthing/archive/2007/04/11/2079137.aspx
> winspool.h only defines the new symbol if NTDDI_VERSION is NTDDI_LONGHORN
> or higher.  NTDDI_LONGHORN is 0x06000000.
> Fix:
> add /D _WIN32_WINNT=0x0600 to that list of changes to all the .dsp
> files in hitch #1 above.

Well, usually these are defined at the start of the relevant conformance 
test files. See dlls/shell32/tests/shlexec.c for instance.


[...]
> Fifth hitch:
> generated.c refers to CS_STUB_INFO, which is not defined in
> Microsoft's rpcndr.h.
> ??

It used to be there but has apparently been removed in the latest SDKs. 
The problem is the generated.c files are not being regenerated very 
often. It probably also means we should update our rpcndr.h to match 
the latest PSDK.


> Sixth hitch:
> it can't find server.h
> Seventh hitch:
> can't find tmarshal.h
> Fix:
> Not sure, but maybe these files need to be generated by midl, and msvcmaker
> doesn't know about that yet?  See
> http://www.mail-archive.com/wine-devel at winehq.org/msg37442.html

Yes.

 
> Eighth hitch:
> riched20/tests/editor.c fails to compile because in GETTEXTEX, the
> field is named lpUsedDefChar, not lpUsedDefaultChar
> Fix:
> fix our richedit.h?

Sent a patch. This is why it's useful to compile the conformance tests 
with the PSDK headers.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
May your Tongue stick to the Roof of your Mouth with the Force of a Thousand Caramels.


From dmitry at codeweavers.com  Tue Feb  5 22:56:30 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 6 Feb 2008 12:56:30 +0800
Subject: RegOverridePredefKey stub - Take 2
References: <200801282307.37940.nessi@nessi-online.de><200801290817.56388.nessi@nessi-online.de><01e301c8627d$16f7c5f0$a600fea9@DMITRY>
	<200802052350.42794.nessi@nessi-online.de>
Message-ID: <01ae01c8687c$a5037600$a600fea9@DMITRY>

"Jens Nestler" <nessi at nessi-online.de> wrote:

> Stub implementation for RegOverridePredefKey.
> The added prototype in the winreg.h is now in alphabetical order.

Patches should be sent to wine-patches.

-- 
Dmitry.


From dank at kegel.com  Wed Feb  6 01:32:57 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 5 Feb 2008 23:32:57 -0800
Subject: Building tests with Visual Studio 2005 Express
In-Reply-To: <3f4fd2640802052328t5df89f4j747277d247b6263b@mail.gmail.com>
References: <a71bd89a0802051750w1ebed6a8p6f7d00f7e5f2cca5@mail.gmail.com>
	<3f4fd2640802052328t5df89f4j747277d247b6263b@mail.gmail.com>
Message-ID: <a71bd89a0802052332n4df83715p2a31ea51f7b34826@mail.gmail.com>

On Feb 5, 2008 11:28 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
> Do you know where the Express download is for this, as I can only find
> VS 2008 Express?

Nope.  I just happen to have an old copy.


From dank at kegel.com  Wed Feb  6 01:43:12 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 5 Feb 2008 23:43:12 -0800
Subject: New winetricks: msxml6, riched30
Message-ID: <a71bd89a0802052343q3559a645yff22bd436349afa6@mail.gmail.com>

Johan Dahlin sent in a patch to add msxml6, and said
"It's enough to make msi2xml.exe to at least start-up (before failing in msi
later)."

Tom Wickline some time ago sent in a suggestion for
adding riched30.  I didn't know any apps it helped, but
apparantly Novell thinks it helps Groupwise a bit.
So it's in now.  Caution, it doesn't update riched32, no idea
what happens if apps try to use it after this...

As always, it's available at
  http://kegel.com/wine/winetricks
and the svn repository is
  http://code.google.com/p/winezeug/


From luis.busquets at ilidium.com  Wed Feb  6 01:59:02 2008
From: luis.busquets at ilidium.com (luis.busquets at ilidium.com)
Date: Wed, 6 Feb 2008 08:59:02 +0100 (CET)
Subject: Bug in patch winex11.drv: Don't create a win_data structure 
	for the	desktop window, except in the process that owns it.
In-Reply-To: <47A8D2CF.7050704@kievinfo.com>
References: <47A8CF1A.6020600@ilidium.com> <47A8D2CF.7050704@kievinfo.com>
Message-ID: <27900.158.169.9.14.1202284742.squirrel@ns2.ilidium.com>

It is the smae bug as 11340. The game executes binkplayer.exe and both
processes become stuck. If you kill one of them, the other executes
correctly (binkplayer.exe=plays a movie and stops, Patrician3.exe=begins
the game)
If you apply the patch that I have mentioned in the bug, the problem is
solved.

> What bug # is this? Please note this is not bugzilla, you will be expected
> to debug this problem yourself and provide technical information.
>
> Vitaliy
>
>
> Luis C. Busquets P?rez wrote:
>> There is a bug in the patch:
>>
>>     c19af910ebafa9b1928b0f67bee68f6b0b237e8e is first bad commit
>> commit c19af910ebafa9b1928b0f67bee68f6b0b237e8e
>> Author: Alexandre Julliard <julliard at winehq.org>
>> Date:   Thu Jan 17 19:53:59 2008 +0100
>>
>>     winex11.drv: Don't create a win_data structure for the desktop
>> window, except in the process that owns it.
>>
>>     Handle desktop size changes by sending a message to the desktop
>> owner.
>>
>> :040000 040000 b7c030353fe92121bb999481724a3689429b2e8a
>> 80fd2c5f4ace2707abb01648bd61663a6c9d7626 M      dlls
>>
>>
>> It affects to Patrician3.exe. When initiating, it hangs and does not
>> allow to play the movie. Actually, the programm changes the screen
>> resolution and hangs. I understand that the problem is that it does not
>> send the appropiate message for binkplayer.exe to play the movie.
>>
>>
>
>




From winehacker at gmail.com  Wed Feb  6 02:43:55 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Wed, 6 Feb 2008 03:43:55 -0500
Subject: Building tests with Visual Studio 2005 Express
In-Reply-To: <a71bd89a0802052332n4df83715p2a31ea51f7b34826@mail.gmail.com>
References: <a71bd89a0802051750w1ebed6a8p6f7d00f7e5f2cca5@mail.gmail.com>
	<3f4fd2640802052328t5df89f4j747277d247b6263b@mail.gmail.com>
	<a71bd89a0802052332n4df83715p2a31ea51f7b34826@mail.gmail.com>
Message-ID: <19e31a080802060043t3e28cbefw7f5cb88c3a02ecdc@mail.gmail.com>

On Feb 6, 2008 2:32 AM, Dan Kegel <dank at kegel.com> wrote:
> On Feb 5, 2008 11:28 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
> > Do you know where the Express download is for this, as I can only find
> > VS 2008 Express?
>
> Nope.  I just happen to have an old copy.

My copy of 2008 or 2009 cannot import the VC6 makefiles for the dlls.
I am assuming its choking on the custom commands. Can someone take a
poke at this as well?

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Wed Feb  6 03:38:05 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 6 Feb 2008 01:38:05 -0800
Subject: Stupid new winetricks: added a trivial GUI
Message-ID: <a71bd89a0802060138y5a6964fcwedc61d89e3109915@mail.gmail.com>

Some users freak at the thought of a commandline,
so I threw together a trivial GUI using whatever
gui-from-shell tool is appropriate for the current desktop.

Unfortunately, that means the default action is to put
up a gui, not show help.  You have to say winetricks -h
or the like to get help.

It's ugly, so shoot me :-)

As always, it's available at
  http://kegel.com/wine/winetricks
and the svn repository is
  http://code.google.com/p/winezeug/


From julliard at winehq.org  Wed Feb  6 04:39:59 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 06 Feb 2008 11:39:59 +0100
Subject: [winetest] Add a new utility to simply running + submitting tests
	via winetest when run from the Wine tree.
In-Reply-To: <47A886C9.70500@winehq.org> (Jeremy White's message of "Tue, 05
	Feb 2008 09:54:49 -0600")
References: <47A886C9.70500@winehq.org>
Message-ID: <87hcgmtlkw.fsf@wine.dyndns.org>

Jeremy White <jwhite at winehq.org> writes:

> +date +%Y%m%d >build.id
> +gcc --version >build.nfo
> +uname -a >>build.nfo
> +/lib/libc.so.6 >>build.nfo
> +echo N/A >tests.url
> +make dist
> +make
> +export WINEPREFIX=`mktemp -d`
> +wineprefixcreate
> +
> +type winetricks >/dev/null 2>&1
> +if [ $? -eq 0 ] ; then
> +    winetricks gecko
> +fi
> +
> +./winetest-dist -c -t "$1"

None of that should be necessary. The make dist stuff is supposed to be
for people who want to distribute a winetest binary. If what you want is
simply run the tests then you should just have to run winetest; if some
things don't work in that mode they should be fixed.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Wed Feb  6 04:56:40 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 06 Feb 2008 11:56:40 +0100
Subject: [5/8] WineD3D: Add infrastructure for faking driver versions
In-Reply-To: <200802060219.16865.stefan@codeweavers.com> ("Stefan
	=?utf-8?Q?D=C3=B6singer=22's?=
	message of "Wed, 6 Feb 2008 02:19:16 +0100")
References: <200802060219.16865.stefan@codeweavers.com>
Message-ID: <87d4ratkt3.fsf@wine.dyndns.org>

Stefan D?singer <stefan at codeweavers.com> writes:

> +/* Certain applications(Steam) complain if we report an outdated driver version. In general,
> + * reporting a driver version is moot because we are not the Windows driver, and we have different
> + * bugs, features, etc.
> + *
> + * Some drivers(ATI, Nvidia Linux drivers) have a shared codebase with the Windows driver, so we're
> + * reading the Linux driver version and report it to the app. Some drivers(Apple drivers, Mesa) don't
> + * have the version match, so we overwrite the OpenGL driver version with a hardcoded one. Obviously
> + * the hardcoded driver version is outdated once a new Windows driver is released, so we'll have to
> + * keep them in sync manually.
> + *
> + * If a card is not found in this table, the gl driver version is reported
> + */
> +struct driver_version_information {
> +    WORD vendor;                        /* reported PCI card vendor ID               */
> +    WORD card;                          /* reported PCI card device ID               */
> +    BOOL loword_matches_apple;          /* Are Mac and Win driver versions matching? */
> +    BOOL loword_matches_linux;          /* Are Lin and Win driver versions matching? */

The world is not limited to Mac and Linux, this sort of thing can't
scale.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Wed Feb  6 05:03:52 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 06 Feb 2008 12:03:52 +0100
Subject: dlls/gdi32/font.c warning removal (RESEND)
In-Reply-To: <Pine.LNX.4.64.0801251323440.4453@acrux.dbai.tuwien.ac.at>
	(Gerald Pfeifer's message of "Fri, 25 Jan 2008 13:24:00 +0100 (CET)")
References: <Pine.LNX.4.64.0801251323440.4453@acrux.dbai.tuwien.ac.at>
Message-ID: <878x1ytkh3.fsf@wine.dyndns.org>

Gerald Pfeifer <gerald at pfeifer.com> writes:

> The reason is that we have
>
>   #define HDPTOLP(y) ((y<0)?                                      \
>                 (-abs(INTERNAL_YDSTOWS(dc, (y)))):              \
>                 (abs(INTERNAL_YDSTOWS(dc, (y)))))
>
> which is overly complicated for unsigned types.  We can avoid these 
> warnings by using plain INTERNAL_YDSTOWS instead of HDPTOLP here.

No, you still need the abs().

-- 
Alexandre Julliard
julliard at winehq.org


From fgouget at free.fr  Wed Feb  6 05:06:49 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 6 Feb 2008 12:06:49 +0100 (CET)
Subject: winedbg - using pdb from Visual Studio 2005
In-Reply-To: <47A8CA8C.9030507@orange.fr>
References: <802215.94186.qm@web54603.mail.re2.yahoo.com>
	<47A8CA8C.9030507@orange.fr>
Message-ID: <alpine.DEB.0.999999.0802061111440.9107@amboise.dolphin>

On Tue, 5 Feb 2008, Eric Pouech wrote:
[...]
> that's to be looked at and is the cause of your problems
> can you send me your mydll.pdb file ? (off mailing list)

On a somewhat related subject, do you know if the performance issues 
related to our handling of the PDBs hashtables has been fixed?

That would be for bug 836:
http://bugs.winehq.com/show_bug.cgi?id=836


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                      Computers are like airconditioners
                They stop working properly if you open WINDOWS


From stefan at codeweavers.com  Wed Feb  6 05:26:20 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Wed, 6 Feb 2008 12:26:20 +0100
Subject: [5/8] WineD3D: Add infrastructure for faking driver versions
In-Reply-To: <87d4ratkt3.fsf@wine.dyndns.org>
References: <200802060219.16865.stefan@codeweavers.com>
	<87d4ratkt3.fsf@wine.dyndns.org>
Message-ID: <200802061226.21088.stefan@codeweavers.com>

Am Mittwoch, 6. Februar 2008 11:56:40 schrieb Alexandre Julliard:
> The world is not limited to Mac and Linux, this sort of thing can't
> scale.
Official drivers by Nvidia and ATI are limited to Mac, Linux and Windows. 
Nvidia has Solaris and FreeBSD drivers drivers as well, so maybe the Linux 
name should be renamed to non_apple.

I don't think we can come up with scheme that will scale to all future 
developments. In the near future we maybe should add Mesa to that list(open 
source ATI driver), but if a future event does big unforseen changes to the 
driver landscape then we might have to change this table.


From julliard at winehq.org  Wed Feb  6 05:47:37 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 06 Feb 2008 12:47:37 +0100
Subject: [5/8] WineD3D: Add infrastructure for faking driver versions
In-Reply-To: <200802061226.21088.stefan@codeweavers.com> ("Stefan
	=?utf-8?Q?D=C3=B6singer=22's?=
	message of "Wed, 6 Feb 2008 12:26:20 +0100")
References: <200802060219.16865.stefan@codeweavers.com>
	<87d4ratkt3.fsf@wine.dyndns.org>
	<200802061226.21088.stefan@codeweavers.com>
Message-ID: <874pcmtig6.fsf@wine.dyndns.org>

Stefan D?singer <stefan at codeweavers.com> writes:

> Am Mittwoch, 6. Februar 2008 11:56:40 schrieb Alexandre Julliard:
>> The world is not limited to Mac and Linux, this sort of thing can't
>> scale.
> Official drivers by Nvidia and ATI are limited to Mac, Linux and Windows. 
> Nvidia has Solaris and FreeBSD drivers drivers as well, so maybe the Linux 
> name should be renamed to non_apple.
>
> I don't think we can come up with scheme that will scale to all future 
> developments. In the near future we maybe should add Mesa to that list(open 
> source ATI driver), but if a future event does big unforseen changes to the 
> driver landscape then we might have to change this table.

I don't see the point of going through all that trouble to return the
real driver version on some platforms but not others. Since we have the
infrastructure to fake it why not always use that?  We'll have to keep
it up to date anyway.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Wed Feb  6 05:50:41 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Wed, 6 Feb 2008 12:50:41 +0100
Subject: [5/8] WineD3D: Add infrastructure for faking driver versions
In-Reply-To: <874pcmtig6.fsf@wine.dyndns.org>
References: <200802060219.16865.stefan@codeweavers.com>
	<200802061226.21088.stefan@codeweavers.com>
	<874pcmtig6.fsf@wine.dyndns.org>
Message-ID: <200802061250.41236.stefan@codeweavers.com>

Am Mittwoch, 6. Februar 2008 12:47:37 schrieb Alexandre Julliard:
> I don't see the point of going through all that trouble to return the
> real driver version on some platforms but not others. Since we have the
> infrastructure to fake it why not always use that?  We'll have to keep
> it up to date anyway.
For example, users with matching driver versions will get a correct warning 
from Steam if their driver is outdated.


From julliard at winehq.org  Wed Feb  6 05:56:04 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 06 Feb 2008 12:56:04 +0100
Subject: [5/8] WineD3D: Add infrastructure for faking driver versions
In-Reply-To: <200802061250.41236.stefan@codeweavers.com> ("Stefan
	=?utf-8?Q?D=C3=B6singer=22's?=
	message of "Wed, 6 Feb 2008 12:50:41 +0100")
References: <200802060219.16865.stefan@codeweavers.com>
	<200802061226.21088.stefan@codeweavers.com>
	<874pcmtig6.fsf@wine.dyndns.org>
	<200802061250.41236.stefan@codeweavers.com>
Message-ID: <87wspis3hn.fsf@wine.dyndns.org>

Stefan D?singer <stefan at codeweavers.com> writes:

> Am Mittwoch, 6. Februar 2008 12:47:37 schrieb Alexandre Julliard:
>> I don't see the point of going through all that trouble to return the
>> real driver version on some platforms but not others. Since we have the
>> infrastructure to fake it why not always use that?  We'll have to keep
>> it up to date anyway.
> For example, users with matching driver versions will get a correct warning 
> from Steam if their driver is outdated.

And what are the consequences of an outdated driver? Isn't that
something that wined3d should be working around anyway? What happens on
platforms where version numbers don't match, do things silently break?

-- 
Alexandre Julliard
julliard at winehq.org


From winehacker at gmail.com  Wed Feb  6 06:53:35 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Wed, 6 Feb 2008 07:53:35 -0500
Subject: Stupid new winetricks: added a trivial GUI
In-Reply-To: <a71bd89a0802060138y5a6964fcwedc61d89e3109915@mail.gmail.com>
References: <a71bd89a0802060138y5a6964fcwedc61d89e3109915@mail.gmail.com>
Message-ID: <19e31a080802060453r7f26a951v574ae7197ddc545a@mail.gmail.com>

On Feb 6, 2008 4:38 AM, Dan Kegel <dank at kegel.com> wrote:
> Some users freak at the thought of a commandline,
> so I threw together a trivial GUI using whatever
> gui-from-shell tool is appropriate for the current desktop.
>
> Unfortunately, that means the default action is to put
> up a gui, not show help.  You have to say winetricks -h
> or the like to get help.
>
> It's ugly, so shoot me :-)

Its actually kind of nice to have a gui for this. Would it be much
trouble to add support for a description field and a default geometry
like the Bordeaux winetricks manager?

http://bp3.blogger.com/_PpaJ8vsrkzo/R5-1PHBCUrI/AAAAAAAABQ0/Qmsc5_uvkxQ/s400/Screenshot-Bordeaux+Configuration.png

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From msclrhd at googlemail.com  Wed Feb  6 01:28:39 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 6 Feb 2008 07:28:39 +0000
Subject: Building tests with Visual Studio 2005 Express
In-Reply-To: <a71bd89a0802051750w1ebed6a8p6f7d00f7e5f2cca5@mail.gmail.com>
References: <a71bd89a0802051750w1ebed6a8p6f7d00f7e5f2cca5@mail.gmail.com>
Message-ID: <3f4fd2640802052328t5df89f4j747277d247b6263b@mail.gmail.com>

On 06/02/2008, Dan Kegel <dank at kegel.com> wrote:
> After giving up for the moment on building with Visual C 6,
> I tried Visual Studio 2005.

Do you know where the Express download is for this, as I can only find
VS 2008 Express?

These links (as well as the Platform SDK stuff) would be useful adding
to the building test documentation.

> First hitch:
> Boy, does it spew out lots of warnings about deprecated functions!

This is the same for 2008.

> Seventy-seventh hitch:
> gdiplus/tests/brush.c includes Microsoft's gdiplus.h, but that's not
> safe to include from C, so you get an error on the namespace.

It looks as if those tests need to be set to compile with C++ for the
SDK tests asnd add a "using namespace GdiPlus;" to them.

Alternatively, disable them for the SDK headers and use the Wine ones.

> Golly.  I guess I won't be building the tests with any flavor of
> microsoft C any time soon!

I have managed to get most of the tests building.

When I get the chance, I'll look at geetting msvcmaker to generate the
VC project files, but these keep changing and are incompatible with
each other!

To do it properly, VC 2002, VC 2003, VC 2005 and VC 2008 project files
need to be supported. I don't currently have access to the 2002 (7.0)
tools, but the format should be close to 2003 after the version number
differences.

- Reece


From josator at fiv.upv.es  Wed Feb  6 01:29:06 2008
From: josator at fiv.upv.es (=?ISO-8859-1?Q?Jos=E9?= Salavert Torres)
Date: Wed, 06 Feb 2008 08:29:06 +0100
Subject: regression in worms2
In-Reply-To: <20080205221442.499d67c4.leidola@newcon.de>
References: <20080205221442.499d67c4.leidola@newcon.de>
Message-ID: <1202282947.5869.1.camel@Compilator>

Happens the same in "Warcraft 3 : The Frozen Throne", you have to start
the application directly from "war3.exe", "Frozen\ Throne.exe" ceased to
work.

El mar, 05-02-2008 a las 22:14 +0100, Olaf Leidinger escribi?:
> Hello!
> 
> I noticed that the game "worms 2" broke between wine-0.9.53 and wine-0.9.54. A git-bisect revealed the guilty patches.
> 
> The game includes a frontend.exe which starts game.exe and controls the settings of the game (the map and teams etc.). Running game.exe directly works but you can't alter the settings. When running game.exe via frontend the game doesn't show up but hangs after changing resolution. Before the following commit the game starts and is playable:
> 
> 2921f5c156b368b4ce6e615eb61dad5c5f423bf8 is first bad commit
> commit 2921f5c156b368b4ce6e615eb61dad5c5f423bf8
> Author: Alexandre Julliard <julliard at winehq.org>
> Date:   Tue Jan 22 20:06:35 2008 +0100
> 
>     server: Invalidate the correct region when custom valid rects are specified.
> 
> :040000 040000 1385d5899b5b6affd5da84328e1bc15985406976 5c8756013a67c0402f3bb5fb9f3ee7b4a50e124a M      server
> 
> And this one makes worms2 hang after exiting the game:
> 
> c19af910ebafa9b1928b0f67bee68f6b0b237e8e is first bad commit
> commit c19af910ebafa9b1928b0f67bee68f6b0b237e8e
> Author: Alexandre Julliard <julliard at winehq.org>
> Date:   Thu Jan 17 19:53:59 2008 +0100
> 
>     winex11.drv: Don't create a win_data structure for the desktop window, except in the process that owns it.
>     
>     Handle desktop size changes by sending a message to the desktop owner.
> 
> :040000 040000 b7c030353fe92121bb999481724a3689429b2e8a 80fd2c5f4ace2707abb01648bd61663a6c9d7626 M      dlls
> 
> Thanks for your attention!
> 
> Ciao,
> Olaf
-- 
Jos? Salavert Torres <josator at fiv.upv.es>
Estudiante UPV



From msclrhd at googlemail.com  Wed Feb  6 03:14:20 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 6 Feb 2008 09:14:20 +0000
Subject: Building tests with Visual Studio 2005 Express
In-Reply-To: <19e31a080802060043t3e28cbefw7f5cb88c3a02ecdc@mail.gmail.com>
References: <a71bd89a0802051750w1ebed6a8p6f7d00f7e5f2cca5@mail.gmail.com>
	<3f4fd2640802052328t5df89f4j747277d247b6263b@mail.gmail.com>
	<a71bd89a0802052332n4df83715p2a31ea51f7b34826@mail.gmail.com>
	<19e31a080802060043t3e28cbefw7f5cb88c3a02ecdc@mail.gmail.com>
Message-ID: <3f4fd2640802060114k2fc018ccua54f549aedcba28b@mail.gmail.com>

On 06/02/2008, Steven Edwards <winehacker at gmail.com> wrote:
> On Feb 6, 2008 2:32 AM, Dan Kegel <dank at kegel.com> wrote:
> > On Feb 5, 2008 11:28 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
> > > Do you know where the Express download is for this, as I can only find
> > > VS 2008 Express?
> >
> > Nope.  I just happen to have an old copy.
>
> My copy of 2008 or 2009 cannot import the VC6 makefiles for the dlls.
> I am assuming its choking on the custom commands. Can someone take a
> poke at this as well?

Yeah, I got that for VC 2008.

Also, I'm building a document
[http://docs.google.com/View?docID=dfkc9w32_1cxfvb2c7&revision=_latest]
that describes the format of the VC project formats. This is with the
intention of using that information in msvcmaker to generate the
sln/vcproj files directly for your chosen version of VC.

Ideally, this information should be documented in a file along side
msvcmaker (along with the format of the dsp/dsw files) so that
maintainers can understand the project formats.

- Reece


From julliard at winehq.org  Wed Feb  6 07:20:09 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 06 Feb 2008 14:20:09 +0100
Subject: uxtheme: fix the system tests so they pass on Vista. [try 2]
	[RESEND]
In-Reply-To: <3f4fd2640802051407h15536987i9a777055d5e23155@mail.gmail.com>
	(Reece Dunn's message of "Tue, 5 Feb 2008 22:07:12 +0000")
References: <3f4fd2640802051407h15536987i9a777055d5e23155@mail.gmail.com>
Message-ID: <87lk5yrzli.fsf@wine.dyndns.org>

"Reece Dunn" <msclrhd at googlemail.com> writes:

> The Vista return code is what wine is returning, so remove the todo
> block as well.

Not for me:

../../../tools/runtest -q -P wine -M uxtheme.dll -T ../../.. -p uxtheme_test.exe.so system.c && touch system.ok
system.c:420: Test failed: Expected E_POINTER or S_OK, got 0x80070490
make: *** [system.ok] Error 1

-- 
Alexandre Julliard
julliard at winehq.org


From thunderbird2k at gmx.net  Wed Feb  6 07:23:02 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Wed, 06 Feb 2008 14:23:02 +0100
Subject: [5/8] WineD3D: Add infrastructure for faking driver versions
In-Reply-To: <87wspis3hn.fsf@wine.dyndns.org>
References: <200802060219.16865.stefan@codeweavers.com>
	<200802061226.21088.stefan@codeweavers.com>	<874pcmtig6.fsf@wine.dyndns.org>
	<200802061250.41236.stefan@codeweavers.com>
	<87wspis3hn.fsf@wine.dyndns.org>
Message-ID: <20080206132302.279230@gmx.net>

> Stefan D?singer <stefan at codeweavers.com> writes:
> 
> > Am Mittwoch, 6. Februar 2008 12:47:37 schrieb Alexandre Julliard:
> >> I don't see the point of going through all that trouble to return the
> >> real driver version on some platforms but not others. Since we have the
> >> infrastructure to fake it why not always use that?  We'll have to keep
> >> it up to date anyway.
> > For example, users with matching driver versions will get a correct
> warning 
> > from Steam if their driver is outdated.
> 
> And what are the consequences of an outdated driver? Isn't that
> something that wined3d should be working around anyway? What happens on
> platforms where version numbers don't match, do things silently break?
> 
> -- 
> Alexandre Julliard
> julliard at winehq.org
> 
> 

Personally I don't think we should report the real driver version to the games as we aren't the same as the Windows Direct3D drivers. Second driver version parsing is a lot of work. Just on Linux nvidia already has two different versioning mechanisms, second on e.g. OSX the version string again has a different layout. Faking the driver numbers is the best thing to do in my opinion.

Roderick
-- 
Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen! 
Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer


From stefan at codeweavers.com  Wed Feb  6 08:31:03 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 6 Feb 2008 15:31:03 +0100
Subject: [5/8] WineD3D: Add infrastructure for faking driver versions
In-Reply-To: <20080206132302.279230@gmx.net>
References: <200802060219.16865.stefan@codeweavers.com>
	<87wspis3hn.fsf@wine.dyndns.org> <20080206132302.279230@gmx.net>
Message-ID: <200802061531.03416.stefan@codeweavers.com>

Am Mittwoch, 6. Februar 2008 14:23:02 schrieb Roderick Colenbrander:
> > Stefan D?singer <stefan at codeweavers.com> writes:
> > > Am Mittwoch, 6. Februar 2008 12:47:37 schrieb Alexandre Julliard:
> > >> I don't see the point of going through all that trouble to return the
> > >> real driver version on some platforms but not others. Since we have
> > >> the infrastructure to fake it why not always use that?  We'll have to
> > >> keep it up to date anyway.
> > >
> > > For example, users with matching driver versions will get a correct
> >
> > warning
> >
> > > from Steam if their driver is outdated.
> >
> > And what are the consequences of an outdated driver? Isn't that
> > something that wined3d should be working around anyway? What happens on
> > platforms where version numbers don't match, do things silently break?
> >
> > --
> > Alexandre Julliard
> > julliard at winehq.org
>
> Personally I don't think we should report the real driver version to the
> games as we aren't the same as the Windows Direct3D drivers. Second driver
> version parsing is a lot of work. Just on Linux nvidia already has two
> different versioning mechanisms, second on e.g. OSX the version string
> again has a different layout. Faking the driver numbers is the best thing
> to do in my opinion.
Ok, I'll change the patches then to always fake the driver version



From dmitry at codeweavers.com  Wed Feb  6 08:50:53 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 6 Feb 2008 22:50:53 +0800
Subject: RegOverridePredefKey stub - Take 2
References: <200801282307.37940.nessi@nessi-online.de><200801290817.56388.nessi@nessi-online.de><01e301c8627d$16f7c5f0$a600fea9@DMITRY>
	<200802060800.06134.nessi@nessi-online.de>
Message-ID: <011801c868cf$afc85580$a600fea9@DMITRY>

"Jens Nestler" <nessi at nessi-online.de> wrote:

> Stub implementation for RegOverridePredefKey.
> The added prototype in the winreg.h is now in alphabetical order.

Please review yuor patches before sending, this one contains not
related changes.

-- 
Dmitry.


From dank at kegel.com  Wed Feb  6 08:53:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 6 Feb 2008 06:53:30 -0800
Subject: Stupid new winetricks: added a trivial GUI
In-Reply-To: <19e31a080802060453r7f26a951v574ae7197ddc545a@mail.gmail.com>
References: <a71bd89a0802060138y5a6964fcwedc61d89e3109915@mail.gmail.com>
	<19e31a080802060453r7f26a951v574ae7197ddc545a@mail.gmail.com>
Message-ID: <a71bd89a0802060653t63f3faak984a4b228cb7a2bd@mail.gmail.com>

On Feb 6, 2008 4:53 AM, Steven Edwards <winehacker at gmail.com> wrote:
> Its actually kind of nice to have a gui for this. Would it be much
> trouble to add support for a description field and a default geometry
> like the Bordeaux winetricks manager?
>
> http://bp3.blogger.com/_PpaJ8vsrkzo/R5-1PHBCUrI/AAAAAAAABQ0/Qmsc5_uvkxQ/s400/Screenshot-Bordeaux+Configuration.png

Hmm.  I tried downloading Bordeaux but it wants a password:
http://www.wine-forum.org/showthread.php?t=166

Tom, can you unprotect bordeaux?
- Dan


From chris.kcat at gmail.com  Wed Feb  6 14:17:55 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Wed, 6 Feb 2008 12:17:55 -0800
Subject: added wgl_bind_to_texture_depth_nv to ConvertAttribWGLtoGLX
In-Reply-To: <47AA0E3A.4050206@gmail.com>
References: <47A8DE85.2050901@gmail.com>
	<200802051429.58688.chris.kcat@gmail.com>
	<47AA0E3A.4050206@gmail.com>
Message-ID: <200802061217.55340.chris.kcat@gmail.com>

On Wednesday 06 February 2008 11:44:58 am you wrote:
> Chris Robinson wrote:
> > I don't think it's correct to add this since it's not supported (the
> > extension string isn't exported and it can't be easilly emulated). If an
> > app is trying to set that attribute without the extension being
> > advertised, I'd say the app is broken. If you're intending on adding
> > support, you may want to familiarize yourself with how wine emulates
> > render_to_texture and look over the extension:
> > http://opengl.org/registry/specs/NV/render_depth_texture.txt
>
> "I don't think it's correct to add this since it's not supported"
> The
>
>      case WGL_BIND_TO_TEXTURE_RGB_ARB:
>      case WGL_BIND_TO_TEXTURE_RGBA_ARB:
>      case WGL_BIND_TO_TEXTURE_RECTANGLE_FLOAT_R_NV:
> are not supported either. The WGL_BIND_TO_TEXTURE_DEPTH_NV came up as a
> fixme since it isn't in the switch.

The formats are supported in X11DRV_wglGetPixelFormatAttribivARB, 
X11DRV_wglCreatePbufferARB and the other render-to-texture functions, and the 
render-to-texture extension is advertised.. There's just nothing to do in 
that function for them since the hint will always be accepted. But I don't 
see the point in supporting a pbuffer creation hint that an app shouldn't be 
using without the extension being advertised (actually, I think pbuffer 
creation is supposed to fail if an unsupported attribute is specified). Which 
app is trying to use it?

> Again, just trying to learn, not annoy 
> people with tiny fixes.

No annoyance to me, just explaining why I don't think it's something to 
handle. :)


From wine.dev at web.de  Wed Feb  6 14:34:16 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Wed, 06 Feb 2008 21:34:16 +0100
Subject: Building tests with Visual Studio 2005 Express
In-Reply-To: <3f4fd2640802052328t5df89f4j747277d247b6263b@mail.gmail.com>
References: <a71bd89a0802051750w1ebed6a8p6f7d00f7e5f2cca5@mail.gmail.com>
	<3f4fd2640802052328t5df89f4j747277d247b6263b@mail.gmail.com>
Message-ID: <1202330056.6970.14.camel@p4>

On Mi, 2008-02-06 at 07:28 +0000, Reece Dunn wrote:
> On 06/02/2008, Dan Kegel <dank at kegel.com> wrote:
> > I tried Visual Studio 2005.
> 
> Do you know where the Express download is for this, as I can only find
> VS 2008 Express?

Download Page for "Visual * 2005 Express Edition":
http://www.microsoft.com/express/2005/download/offline.aspx

VS2005 SP1 update for Vista:
http://www.microsoft.com/downloads/details.aspx?familyid=90E2942D-3AD1-4873-A2EE-4ACC0AACE5B6&displaylang=en


For the Visual C++ Toolkit 2003:
http://www.google.de/search?q=VCToolkitSetup.exe
v1.0  was released 16. April 2004
v1.01 was released 06. July  2004


-- 
 
By by ... Detlef




From julliard at winehq.org  Wed Feb  6 15:23:19 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 06 Feb 2008 22:23:19 +0100
Subject: systray[1/4]: rewrite tooltips support
In-Reply-To: <200802061748.13080.lich@math.spbu.ru> (Kirill K. Smirnov's
	message of "Wed, 6 Feb 2008 17:48:12 +0000")
References: <200802061748.13080.lich@math.spbu.ru>
Message-ID: <873as5srso.fsf@wine.dyndns.org>

"Kirill K. Smirnov" <lich at math.spbu.ru> writes:

> diff --git a/programs/explorer/systray.c b/programs/explorer/systray.c

Please explain better what you are doing, "rewrite tooltips support"
doesn't say what is changing or why the change is needed (and "rewrite"
is an exaggeration, you are mostly just moving code around).

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Wed Feb  6 17:50:43 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 06 Feb 2008 23:50:43 +0000
Subject: systray[3/4]: Better validate icon owner
In-Reply-To: <200802061754.25525.lich@math.spbu.ru>
References: <200802061754.25525.lich@math.spbu.ru>
Message-ID: <47AA47D3.2070200@codeweavers.com>

Kirill K. Smirnov wrote:
> @@ -131,15 +130,18 @@ static LRESULT WINAPI adaptor_wndproc(HW
>          case WM_LBUTTONDBLCLK:
>          case WM_RBUTTONDBLCLK:
>          case WM_MBUTTONDBLCLK:
> -            /* notify the owner hwnd of the message */
> -            WINE_TRACE("relaying 0x%x\n", msg);
> -            ret = PostMessage(icon->owner, icon->callback_message, (WPARAM) icon->id, (LPARAM) msg);
> -            if (!ret && (GetLastError() == ERROR_INVALID_HANDLE))
> +            if (!IsWindow(icon->owner))
>              {
>                  WINE_WARN("application window was destroyed without removing "
>                            "notification icon, removing automatically\n");
>                  delete_icon_directly(icon);
>              }
> +            else
> +            {
> +                /* notify the owner hwnd of the message */
> +                WINE_TRACE("relaying 0x%x\n", msg);
> +                PostMessage(icon->owner, icon->callback_message, (WPARAM) icon->id, (LPARAM) msg);
> +            }
>              break;
>  
>          case WM_NCDESTROY:

I don't get why you need this change. PostMessage should correctly 
handle the case where icon->owner has been destroyed and adding a call 
to IsWindow just introduces a race condition.


-- 
Rob Shearman



From rob at codeweavers.com  Wed Feb  6 17:58:42 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 06 Feb 2008 23:58:42 +0000
Subject: systray[2/4]: correctly handle icon addition/deletion
In-Reply-To: <200802061757.09020.lich@math.spbu.ru>
References: <200802061757.09020.lich@math.spbu.ru>
Message-ID: <47AA49B2.1020402@codeweavers.com>

Kirill K. Smirnov wrote:
> @@ -71,6 +71,12 @@ struct icon
>  static struct tray tray;
>  static BOOL hide_systray;
>  
> +static BOOL add_icon(NOTIFYICONDATAW *nid);
> +static BOOL modify_icon(NOTIFYICONDATAW *nid);
> +static BOOL delete_icon(const NOTIFYICONDATAW *nid);
> +static BOOL delete_icon_directly(struct icon *icon);
> +static BOOL display_icon(struct icon *icon, BOOL hide);
> +
>  /* adaptor code */
>  
>  #define ICON_SIZE GetSystemMetrics(SM_CXSMICON)
>   

I don't see any reason why you need to add forward declarations for all 
of these functions.

-- 
Rob Shearman



From lich at math.spbu.ru  Wed Feb  6 16:34:15 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Thu, 7 Feb 2008 01:34:15 +0300
Subject: systray[1/4]: rewrite tooltips support
Message-ID: <200802070338.22994.lich@math.spbu.ru>

> Please explain better what you are doing, "rewrite tooltips support"
> doesn't say what is changing or why the change is needed (and "rewrite"
> is an exaggeration, you are mostly just moving code around).

  The main issue this patch fixes is an "attempt to set/modify a tooltip to a 
nonexistent window". This may happen when application modifies tip text while 
icon is hidden (e.g. when adding initially disabled icon with tooltip).

[verbose]
  The change I did:
1) Store tip text in the icon structure.
2) Move tooltip creation code  to the separate function.
3) Immediately bind tooltip to icon window at creation. We can bind empty 
tooltip text with icon window and further just update text when needed.  
4) set_tooltip function was renamed to update_tooltip_text and simplified.

Since tooltip support code is relatively small, this was enough for me to 
exaggeratedly proclaim tooltip support be rewritten ;-)
[/verbose]

So this ChangeLog is better:
  Avoid modifying non-existent tooltip windows of non-existent icon windows 
when application updates tip of hidden icon.

--
Kirill


From lich at math.spbu.ru  Wed Feb  6 18:24:23 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Thu, 7 Feb 2008 03:24:23 +0300
Subject: systray[2/4]: correctly handle icon addition/deletion
In-Reply-To: <47AA49B2.1020402.SS587SS@codeweavers.com>
References: <200802061757.09020.lich@math.spbu.ru>
	<47AA49B2.1020402.SS587SS@codeweavers.com>
Message-ID: <200802070338.45630.lich@math.spbu.ru>

? ????????? ?? Thursday 07 February 2008 02:58:42 ?? ????????:
> Kirill K. Smirnov wrote:
> > @@ -71,6 +71,12 @@ struct icon
> >  static struct tray tray;
> >  static BOOL hide_systray;
> >
> > +static BOOL add_icon(NOTIFYICONDATAW *nid);
> > +static BOOL modify_icon(NOTIFYICONDATAW *nid);
> > +static BOOL delete_icon(const NOTIFYICONDATAW *nid);
> > +static BOOL delete_icon_directly(struct icon *icon);
> > +static BOOL display_icon(struct icon *icon, BOOL hide);
> > +
> >  /* adaptor code */
> >
> >  #define ICON_SIZE GetSystemMetrics(SM_CXSMICON)
>
> I don't see any reason why you need to add forward declarations for all
> of these functions.

Hmmmm..... It may be an artifact from my development when I need to call them 
from places before they defined....
Anyway, is it really bad to have them declared here? If so I'll remove it.

--
Kirill


From lich at math.spbu.ru  Wed Feb  6 18:30:25 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Thu, 7 Feb 2008 03:30:25 +0300
Subject: systray[3/4]: Better validate icon owner
In-Reply-To: <47AA47D3.2070200.SS1294SS@codeweavers.com>
References: <200802061754.25525.lich@math.spbu.ru>
	<47AA47D3.2070200.SS1294SS@codeweavers.com>
Message-ID: <200802070339.58348.lich@math.spbu.ru>


> I don't get why you need this change. PostMessage should correctly
> handle the case where icon->owner has been destroyed and adding a call
> to IsWindow just introduces a race condition.

Just a testcase:
1) run any wine app (to be sure that explorer is running), e.g winecfg
2) run taskmgr
3) select taskmgr process in tasklist and kill it. taskmgr window will 
dissapear but tray icon not.
4) move mouse cursor over taskmgr tray icon. Before this patch it will not 
dissapear, but should.

The reason is that ERROR_INVALID_HANDLE is not the only value which indicates 
the absence of owner window (ERROR_INVALID_WINDOW_HANDLE too). I think that 
using robust and straightforward IsWindow() function is better than verify 
last error.

Is it acceptable to check return value of PostMessage only and do not check 
last error?

And what race condition introduces IsWindow() here?

--
Kirill


From truiken at gmail.com  Wed Feb  6 18:42:45 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 6 Feb 2008 18:42:45 -0600
Subject: systray[2/4]: correctly handle icon addition/deletion
In-Reply-To: <200802070338.45630.lich@math.spbu.ru>
References: <200802061757.09020.lich@math.spbu.ru>
	<47AA49B2.1020402.SS587SS@codeweavers.com>
	<200802070338.45630.lich@math.spbu.ru>
Message-ID: <22821af30802061642s3b62684at95be823de021203a@mail.gmail.com>

On Feb 6, 2008 6:24 PM, Kirill K. Smirnov <lich at math.spbu.ru> wrote:
> ? ????????? ?? Thursday 07 February 2008 02:58:42 ?? ????????:
>
> > Kirill K. Smirnov wrote:
> > > @@ -71,6 +71,12 @@ struct icon
> > >  static struct tray tray;
> > >  static BOOL hide_systray;
> > >
> > > +static BOOL add_icon(NOTIFYICONDATAW *nid);
> > > +static BOOL modify_icon(NOTIFYICONDATAW *nid);
> > > +static BOOL delete_icon(const NOTIFYICONDATAW *nid);
> > > +static BOOL delete_icon_directly(struct icon *icon);
> > > +static BOOL display_icon(struct icon *icon, BOOL hide);
> > > +
> > >  /* adaptor code */
> > >
> > >  #define ICON_SIZE GetSystemMetrics(SM_CXSMICON)
> >
> > I don't see any reason why you need to add forward declarations for all
> > of these functions.
>
> Hmmmm..... It may be an artifact from my development when I need to call them
> from places before they defined....
> Anyway, is it really bad to have them declared here? If so I'll remove it.
>

Forward declarations usually can, and should be, avoided.  Just
rearrange the code.

-- 
James Hawkins

From msclrhd at googlemail.com  Wed Feb  6 18:16:47 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Thu, 7 Feb 2008 00:16:47 +0000
Subject: systray[3/4]: Better validate icon owner
In-Reply-To: <47AA47D3.2070200@codeweavers.com>
References: <200802061754.25525.lich@math.spbu.ru>
	<47AA47D3.2070200@codeweavers.com>
Message-ID: <3f4fd2640802061616v2482de98w7298e8598754e810@mail.gmail.com>

On 06/02/2008, Robert Shearman <rob at codeweavers.com> wrote:
> Kirill K. Smirnov wrote:
> > @@ -131,15 +130,18 @@ static LRESULT WINAPI adaptor_wndproc(HW
> >          case WM_LBUTTONDBLCLK:
> >          case WM_RBUTTONDBLCLK:
> >          case WM_MBUTTONDBLCLK:
> > -            /* notify the owner hwnd of the message */
> > -            WINE_TRACE("relaying 0x%x\n", msg);
> > -            ret = PostMessage(icon->owner, icon->callback_message, (WPARAM) icon->id, (LPARAM) msg);
> > -            if (!ret && (GetLastError() == ERROR_INVALID_HANDLE))
> > +            if (!IsWindow(icon->owner))
> >              {
> >                  WINE_WARN("application window was destroyed without removing "
> >                            "notification icon, removing automatically\n");
> >                  delete_icon_directly(icon);
> >              }
> > +            else
> > +            {
> > +                /* notify the owner hwnd of the message */
> > +                WINE_TRACE("relaying 0x%x\n", msg);
> > +                PostMessage(icon->owner, icon->callback_message, (WPARAM) icon->id, (LPARAM) msg);
> > +            }
> >              break;
> >
> >          case WM_NCDESTROY:
>
> I don't get why you need this change. PostMessage should correctly
> handle the case where icon->owner has been destroyed and adding a call
> to IsWindow just introduces a race condition.

Is there a test case in the PostMessage tests to verify that behaviour?

- Reece


From junyoung at mogua.com  Wed Feb  6 20:55:06 2008
From: junyoung at mogua.com (Bang Jun-young)
Date: Thu, 7 Feb 2008 11:55:06 +0900
Subject: comctl32: Fix invalid syntax.
In-Reply-To: <22aa2f590802060007o7e66b2b5j9a8dfd771edc8b96@mail.gmail.com>
References: <22aa2f590802030009i2effb841nfd122db45f38b5f6@mail.gmail.com>
	<22aa2f590802060007o7e66b2b5j9a8dfd771edc8b96@mail.gmail.com>
Message-ID: <22aa2f590802061855k7ceb4abbie783b33cae813910@mail.gmail.com>

18 hours passed, and it looks like Alexandre decided to ignore this...why?

This fix is required for Wine to be built with VC2005/2008 (although
Alexandre doesn't seem to care about it).

On 2/6/08, Bang Jun-young <junyoung at mogua.com> wrote:
> Any reason why this hasn't been committed?
>


From julliard at winehq.org  Thu Feb  7 02:43:41 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 07 Feb 2008 09:43:41 +0100
Subject: comctl32: Fix invalid syntax.
In-Reply-To: <22aa2f590802061855k7ceb4abbie783b33cae813910@mail.gmail.com>
	(Bang Jun-young's message of "Thu, 7 Feb 2008 11:55:06 +0900")
References: <22aa2f590802030009i2effb841nfd122db45f38b5f6@mail.gmail.com>
	<22aa2f590802060007o7e66b2b5j9a8dfd771edc8b96@mail.gmail.com>
	<22aa2f590802061855k7ceb4abbie783b33cae813910@mail.gmail.com>
Message-ID: <87y79xqhqa.fsf@wine.dyndns.org>

"Bang Jun-young" <junyoung at mogua.com> writes:

> 18 hours passed, and it looks like Alexandre decided to ignore this...why?
>
> This fix is required for Wine to be built with VC2005/2008 (although
> Alexandre doesn't seem to care about it).

There's no need to count the hours, or to ask every day, especially not
with a mail to wine-patches. I have lots of pending patches from my
vacation, I'll get to it eventually, and if I don't you should resubmit
it after a week has passed. And if you want me to care about VC2005,
maybe you should mention in your patch that this is the reason for your
change, "fix invalid syntax" doesn't tell me anything.

-- 
Alexandre Julliard
julliard at winehq.org


From luis.busquets at ilidium.com  Thu Feb  7 03:39:47 2008
From: luis.busquets at ilidium.com (luis.busquets at ilidium.com)
Date: Thu, 7 Feb 2008 10:39:47 +0100 (CET)
Subject: regression in worms2
Message-ID: <59009.158.169.9.14.1202377187.squirrel@ns2.ilidium.com>

The same bug happens in Patrician3.exe
If you apply the attached patch if should  be ok.

Please let me know, if that worked also for you.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: b60b43c523aff32358b143672e59d5952587da39.diff
Type: application/octet-stream
Size: 637 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080207/dbd08bd4/attachment.obj 

From dmitry at codeweavers.com  Thu Feb  7 04:01:16 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 7 Feb 2008 18:01:16 +0800
Subject: regression in worms2
References: <59009.158.169.9.14.1202377187.squirrel@ns2.ilidium.com>
Message-ID: <005601c86970$62f842f0$a600fea9@DMITRY>

<luis.busquets at ilidium.com> wrote:

> The same bug happens in Patrician3.exe
> If you apply the attached patch if should  be ok.

That bug should be fixed in git. This is not an appropriate place
to report the bugs, use bugzilla instead.

-- 
Dmitry.


From leidola at newcon.de  Thu Feb  7 04:19:12 2008
From: leidola at newcon.de (Olaf Leidinger)
Date: Thu, 7 Feb 2008 11:19:12 +0100
Subject: regression in worms2
In-Reply-To: <59009.158.169.9.14.1202377187.squirrel@ns2.ilidium.com>
References: <59009.158.169.9.14.1202377187.squirrel@ns2.ilidium.com>
Message-ID: <20080207111912.6e534994.leidola@newcon.de>

Hello!

> The same bug happens in Patrician3.exe
> If you apply the attached patch if should  be ok.
> 
> Please let me know, if that worked also for you.

I already tried this work-around and it makes the game work. Alexandre
Julliard also proposed a patch which works fine, please have a look at
bug 11340.

Ciao,
Olaf

-- 
Olaf Leidinger <leidola at newcon.de>


From julliard at winehq.org  Thu Feb  7 04:38:31 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 07 Feb 2008 11:38:31 +0100
Subject: [PATCH] dinput: Skip old mouse movement evenets.
In-Reply-To: <47A86A38.40001@kievinfo.com> (Vitaliy Margolen's message of
	"Tue, 05 Feb 2008 06:52:56 -0700")
References: <47A86A38.40001@kievinfo.com>
Message-ID: <87prv9qcew.fsf@wine.dyndns.org>

Vitaliy Margolen <wine-patches at kievinfo.com> writes:

> @@ -280,6 +281,9 @@ static void dinput_mouse_hook( LPDIRECTINPUTDEVICE8A iface, WPARAM wparam, LPARA
>          {
>              POINT pt, pt1;
>  
> +            /* Skip old movement events */
> +            if (This->last_event_time > hook->time) break;

That's not an appropriate way to compare timestamps.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Feb  7 04:36:36 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 07 Feb 2008 11:36:36 +0100
Subject: x11drv: implement X11DRV_AlphaRender for non bitmap sources
In-Reply-To: <47A37BC6.5040705@codeweavers.com> (Aric Stewart's message of
	"Fri, 01 Feb 2008 14:06:30 -0600")
References: <47A37BC6.5040705@codeweavers.com>
Message-ID: <87tzklqci3.fsf@wine.dyndns.org>

Aric Stewart <aric at codeweavers.com> writes:

> @@ -1569,12 +1570,14 @@ BOOL X11DRV_AlphaBlend(X11DRV_PDEVICE *devDst, INT xDst, INT yDst, INT widthDst,
>  
>      if (!devSrc->bitmap || GetObjectW( devSrc->bitmap->hbitmap, sizeof(dib), &dib ) != sizeof(dib))
>      {
> -        FIXME("not a dibsection\n");
> -        return FALSE;
> +        TRACE("not a dibsection\n");
> +        bitmap = FALSE;

It can be an invalid handle too, you can't assume that it's a valid
bitmap just because it isn't a DIB. Also naming the boolean 'bitmap' for
the DIB section case is very confusing, both are bitmaps.
>  
> -    if (xSrc < 0 || ySrc < 0 || widthSrc < 0 || heightSrc < 0 || xSrc + widthSrc > dib.dsBmih.biWidth
> -        || ySrc + heightSrc > abs(dib.dsBmih.biHeight))
> +    if (xSrc < 0 || ySrc < 0 || widthSrc < 0 || heightSrc < 0 || (bitmap && xSrc + widthSrc > dib.dsBmih.biWidth)
> +        || (bitmap && ySrc + heightSrc > abs(dib.dsBmih.biHeight)))

Testing the flag all over the place is ugly, you should separate the
code completely, have one block for DIBs and one block for DDBs, with a
single if at the top.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Thu Feb  7 04:46:00 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 07 Feb 2008 10:46:00 +0000
Subject: systray[3/4]: Better validate icon owner
In-Reply-To: <200802070339.58348.lich@math.spbu.ru>
References: <200802061754.25525.lich@math.spbu.ru>
	<47AA47D3.2070200.SS1294SS@codeweavers.com>
	<200802070339.58348.lich@math.spbu.ru>
Message-ID: <47AAE168.2030002@codeweavers.com>

Kirill K. Smirnov wrote:
>> I don't get why you need this change. PostMessage should correctly
>> handle the case where icon->owner has been destroyed and adding a call
>> to IsWindow just introduces a race condition.
>>     
>
> Just a testcase:
> 1) run any wine app (to be sure that explorer is running), e.g winecfg
> 2) run taskmgr
> 3) select taskmgr process in tasklist and kill it. taskmgr window will 
> dissapear but tray icon not.
> 4) move mouse cursor over taskmgr tray icon. Before this patch it will not 
> dissapear, but should.
>   

This is pretty much the same test I did when I originally wrote the code.

> The reason is that ERROR_INVALID_HANDLE is not the only value which indicates 
> the absence of owner window (ERROR_INVALID_WINDOW_HANDLE too). I think that 
> using robust and straightforward IsWindow() function is better than verify 
> last error.
>   

The error value was changed in commit 
19e7fab981a75cdf0a339db35d36d9c1a6e64494. The code should be changed to 
check for ERROR_INVALID_WINDOW_HANDLE now.

> Is it acceptable to check return value of PostMessage only and do not check 
> last error?
>   

Possibly, although I can think of other errors such as out-of-memory 
that probably shouldn't indicate that the parent has disappeared and the 
icon destroyed.

> And what race condition introduces IsWindow() here?
>   

In general, you shouldn't check whether something can be done before you 
try doing it. Just try doing it and cope with it failing.

In this case, you're checking if the window is valid before you post a 
message to it. The window could be destroyed between IsWindow and 
PostMessage, in which case you'd have to detect the error by checking 
the result of the PostMessage call. After you've done this, the IsWindow 
call is redundant.

-- 
Rob Shearman



From rob at codeweavers.com  Thu Feb  7 04:49:35 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 07 Feb 2008 10:49:35 +0000
Subject: systray[3/4]: Better validate icon owner
In-Reply-To: <3f4fd2640802061616v2482de98w7298e8598754e810@mail.gmail.com>
References: <200802061754.25525.lich@math.spbu.ru>	
	<47AA47D3.2070200@codeweavers.com>
	<3f4fd2640802061616v2482de98w7298e8598754e810@mail.gmail.com>
Message-ID: <47AAE23F.10907@codeweavers.com>

Reece Dunn wrote:
> On 06/02/2008, Robert Shearman <rob at codeweavers.com> wrote:
>   
>> PostMessage should correctly
>> handle the case where icon->owner has been destroyed and adding a call
>> to IsWindow just introduces a race condition.
>>     
>
> Is there a test case in the PostMessage tests to verify that behaviour?
>   

No - I don't think the tests will tell us anything we don't already 
know, but don't let me stop you adding a test for 
"PostMessage((HWND)0xdeadbeef, WM_USER, 0, 0)".

-- 
Rob Shearman



From julliard at winehq.org  Thu Feb  7 04:58:50 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 07 Feb 2008 11:58:50 +0100
Subject: 2/2 start.exe: Handle the process title argument (try3)
In-Reply-To: <200801292210.14622.alex@thehandofagony.com> ("Alexander
	Nicolaysen =?utf-8?Q?S=C3=B8rnes=22's?= message of "Tue, 29 Jan 2008
	22:10:14 +0100")
References: <200801292210.14622.alex@thehandofagony.com>
Message-ID: <87lk5xqbh1.fsf@wine.dyndns.org>

Alexander Nicolaysen S?rnes <alex at thehandofagony.com> writes:

> +	vi.dwOSVersionInfoSize = sizeof(vi);
> +	GetVersionExW(&vi);
> +
> +	/* On Windows 9x start does not have the process title argument.
> +	   It works such that if the first parameter begins with a double quote ("),
> +	   it is taken as the process title.  Thus 'start "notepad" a' will work on
> +	   Windows 9x but not NT variants */
> +	if(argc > 1 && (vi.dwMajorVersion >= 5 || (vi.dwMajorVersion == 4 && vi.dwPlatformId == 2)))

The right way to check for Win9x is GetVersion() & 0x80000000.

> +	{
> +	    int cmdcount;
> +	    WCHAR* cmdline = GetCommandLineW();
> +	    WCHAR** cmdargs = CommandLineToArgvW(cmdline, &cmdcount);
> +	    WCHAR* pos = cmdline;
> +
> +	    pos += lstrlenW(cmdargs[0]);

This won't work if the program name is quoted.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Feb  7 05:12:08 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 07 Feb 2008 12:12:08 +0100
Subject: msi 2: Handle carriage returns in MsiDatabaseImport
In-Reply-To: <22821af30802061743r41aebab9i57990a53444fa130@mail.gmail.com>
	(James Hawkins's message of "Wed, 6 Feb 2008 19:43:33 -0600")
References: <22821af30802061743r41aebab9i57990a53444fa130@mail.gmail.com>
Message-ID: <87hcglqauv.fsf@wine.dyndns.org>

"James Hawkins" <truiken at gmail.com> writes:

> Hi,
>
> Fixes bug 11479.  http://bugs.winehq.org/show_bug.cgi?id=11479

This doesn't work:

../../../tools/runtest -q -P wine -M msi.dll -T ../../.. -p msi_test.exe.so automation.c && touch automation.ok
automation.c:276: Test failed: Expected ERROR_SUCCESS, got 1627
wine: Unhandled page fault on read access to 0x00000018 at address 0x6002a3da (thread 0009), starting debugger...
Unhandled exception: page fault on read access to 0x00000018 in 32-bit code (0x6002a3da).
Register dump:
 CS:0023 SS:002b DS:002b ES:002b FS:0063 GS:006b
 EIP:6002a3da ESP:0033f400 EBP:0033f578 EFLAGS:00010206(   - 00      - RIP1)
 EAX:00000018 EBX:60121844 ECX:00000018 EDX:0033f5b8
 ESI:602adce0 EDI:0033f52d
Stack dump:
0x0033f400:  00000000 4d430002 00132fac 00000004
0x0033f410:  600425f6 0033f44c 6065e20e 602adce0
0x0033f420:  0033f5b8 0033f5b8 00000001 7bc417fa
0x0033f430:  00000000 4d430002 00133004 00000004
0x0033f440:  00000010 0033f47c 0033f464 00000030
0x0033f450:  00134180 00110014 00000020 00000000
Backtrace:
=>1 0x6002a3da vsnprintfW+0x3ca(str=0x33f67a, len=0x7fffffff, format=0x6065e20a, valist=0x33f5b8) [/home/julliard/wine/wine/libs/wine/string.c:376] in libwine.so.1 (0x0033f578)
  2 0x6002a596 sprintfW+0x36(str=0x33f678, format=0x6065e20a) [/home/julliard/wine/wine/libs/wine/string.c:458] in libwine.so.1 (0x0033f5a8)
  3 0x60610808 MSI_DatabaseImport+0x13e8(db=0x130ef8, folder=<is not available>, file=0x1329ca) [/home/julliard/wine/wine/dlls/msi/database.c:603] in msi (0x0033f7f8)
  4 0x60610b29 MsiDatabaseImportW+0x129(handle=<register EDI not in topmost frame>, szFolder=0x12fcd0, szFilename=0x1329b0) [/home/julliard/wine/wine/dlls/msi/database.c:777] in msi (0x0033f828)
  5 0x60610cce MsiDatabaseImportA+0x18e(handle=0x1, szFolder=0x605b43c0, szFilename=0x605a3db7) [/home/julliard/wine/wine/dlls/msi/database.c:803] in msi (0x0033f868)
  6 0x60527631 test_Installer+0x571() [/home/julliard/wine/wine/dlls/msi/tests/automation.c:275] in msi_test (0x0033fbd8)
  7 0x6052983b func_automation+0xebb() [/home/julliard/wine/wine/dlls/msi/tests/automation.c:2428] in msi_test (0x0033fe68)
  8 0x60592cea run_test+0x14a(name=0x1103ec) [/home/julliard/wine/wine/dlls/msi/tests/../../../include/wine/test.h:389] in msi_test (0x0033fea8)
  9 0x60593332 main+0x142(argc=<register ECX not in topmost frame>, argv=0x1103d0) [/home/julliard/wine/wine/dlls/msi/tests/../../../include/wine/test.h:437] in msi_test (0x0033fed8)
  10 0x6059340b __wine_spec_exe_entry+0x5b(peb=0x7ffdf000) [/home/julliard/wine/wine/dlls/winecrt0/exe_entry.c:36] in msi_test (0x0033ff08)
  11 0x7b8744ee start_process+0xee(arg=0x0) [/home/julliard/wine/wine/dlls/kernel32/process.c:883] in kernel32 (0x0033ffe8)
  12 0x600288d7 wine_switch_to_stack+0x17() in libwine.so.1 (0x00000000)
0x6002a3da vsnprintfW+0x3ca [/home/julliard/wine/wine/libs/wine/string.c:376] in libwine.so.1: movzwl	0x0(%ecx),%edx
376	                while (*striter)

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Feb  7 05:14:16 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 07 Feb 2008 12:14:16 +0100
Subject: shell32: Fix security issue in SHELL_execute.
In-Reply-To: <47A9CFD7.9090304@codeweavers.com> (Robert Shearman's message of
	"Wed, 06 Feb 2008 15:18:47 +0000")
References: <47A9CFD7.9090304@codeweavers.com>
Message-ID: <87d4r9qarb.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> execfunc should not be called on files which aren't supposed to be
> executable.

This doesn't work:

../../../tools/runtest -q -P wine -M shell32.dll -T ../../.. -p shell32_test.exe.so shlexec.c && touch shlexec.ok
shlexec.c:971: Test failed: ShellExecuteEx(null, "C:\windows\temp\\test_shortcut_exe.lnk", null, null) failed: rc=31 err=2
shlexec.c:974: Test failed: argvA3 expected 'Lnk', got '(null)'
shlexec.c:1010: Test failed: ShellExecuteEx(null, "C:\windows\temp\\test_shortcut_exe.lnk", ""C:\windows\temp\\nonexistent.shlexec"", null) failed: rc=31 err=2
shlexec.c:1010: Test failed: ShellExecuteEx(null, "C:\windows\temp\\test_shortcut_exe.lnk", ""C:\windows\temp\\nonexistent.noassoc"", null) failed: rc=31 err=2
shlexec.c:1010: Test failed: ShellExecuteEx(null, "C:\windows\temp\\test_shortcut_exe.lnk", ""C:\windows\temp\\test file.shlexec"", null) failed: rc=31 err=2
shlexec.c:1010: Test failed: ShellExecuteEx(null, "C:\windows\temp\\test_shortcut_exe.lnk", ""C:\windows\temp\/%nasty% $file.shlexec"", null) failed: rc=31 err=2
shlexec.c:1010: Test failed: ShellExecuteEx(null, "C:\windows\temp\\test_shortcut_exe.lnk", ""C:\windows\temp\\test file.noassoc"", null) failed: rc=31 err=2
shlexec.c:1062: Test failed: ShellExecuteEx(null, "Z:\home\julliard\wine\wine\dlls\shell32\tests\shell32_test.exe.so", "shlexec "C:\windows\temp\wt51f.tmp" Exec", null) returned 31
shlexec.c:1064: Test failed: argvA3 expected 'Exec', got '(null)'
shlexec.c:1071: Test succeeded inside todo block: ShellExecute(null, "C:\windows\temp\\test file.noassoc", "shlexec "C:\windows\temp\wt51f.tmp" Exec", null) succeeded: rc=31
shlexec.c:1093: Test failed: ShellExecuteEx(null, "Z:\home\julliard\wine\wine\dlls\shell32\tests\shell32_test.exe.so", "shlexec "C:\windows\temp\wt51f.tmp" abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxy", null) returned 31
shlexec.c:1095: Test failed: argvA3 expected 'abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxy', got '(null)'
shlexec.c:1102: Test succeeded inside todo block: ShellExecute(null, "C:\windows\temp\\test file.noassoc", "shlexec "C:\windows\temp\wt51f.tmp" abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxy", null) succeeded: rc=31
make: *** [shlexec.ok] Error 13

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Feb  7 05:55:22 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 07 Feb 2008 12:55:22 +0100
Subject: gdi32: correct the test message in font.c that was out of sync
	with the test. [RESEND]
In-Reply-To: <3f4fd2640802070025re593f5u8f4b00e4ddef4d3a@mail.gmail.com>
	(Reece Dunn's message of "Thu, 7 Feb 2008 08:25:56 +0000")
References: <3f4fd2640802070025re593f5u8f4b00e4ddef4d3a@mail.gmail.com>
Message-ID: <878x1xq8ut.fsf@wine.dyndns.org>

"Reece Dunn" <msclrhd at googlemail.com> writes:

> diff --git a/dlls/gdi32/tests/font.c b/dlls/gdi32/tests/font.c
> index 7e560d2..bfdb0af 100644
> --- a/dlls/gdi32/tests/font.c
> +++ b/dlls/gdi32/tests/font.c
> @@ -604,7 +604,7 @@ static void test_GetGlyphIndices(void)
>      flags |= GGI_MARK_NONEXISTING_GLYPHS;
>      charcount = pGetGlyphIndicesW(hdc, testtext, (sizeof(testtext)/2)-1, glyphs, flags);
>      ok(charcount == 5, "GetGlyphIndices count of glyphs should = 5 not %d\n", charcount);
> -    ok((glyphs[4] == 0x001f || glyphs[4] == UNICODE_NOCHAR /* Vista */), "GetGlyphIndices should have returned a nonexistent char not %04x\n", glyphs[4]);
> +    ok((glyphs[4] == 0x001f || glyphs[4] == UNICODE_NOCHAR /* Vista */), "GetGlyphIndices should have returned a nonexistent char or UNICODE_NOCHAR, not %04x\n", glyphs[4]);

UNICODE_NOCHAR is a nonexistent char too. And if someone really cares
about the exact details they can always look at the test, we don't need
to duplicate all of it in the error message.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu Feb  7 05:57:23 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 07 Feb 2008 12:57:23 +0100
Subject: user32: make the listbox tests pass in directories other than
	dlls/user32/tests. [RESEND]
In-Reply-To: <3f4fd2640802070029t39866f5csf50e2c4ec14cd837@mail.gmail.com>
	(Reece Dunn's message of "Thu, 7 Feb 2008 08:29:10 +0000")
References: <3f4fd2640802070029t39866f5csf50e2c4ec14cd837@mail.gmail.com>
Message-ID: <874pclq8rg.fsf@wine.dyndns.org>

"Reece Dunn" <msclrhd at googlemail.com> writes:

> diff --git a/dlls/user32/tests/listbox.c b/dlls/user32/tests/listbox.c
> index 3645190..f1a7b2b 100644
> --- a/dlls/user32/tests/listbox.c
> +++ b/dlls/user32/tests/listbox.c
> @@ -560,6 +560,8 @@ static void test_listbox_LB_DIR()
>      char * p;
>      char driveletter;
>  
> +    fclose( fopen( "wtest1.tmp.c", "w" ) );

Using stdio is not really appropriate here, CreateFile() would be a
better choice.

-- 
Alexandre Julliard
julliard at winehq.org


From junyoung at mogua.com  Thu Feb  7 08:00:28 2008
From: junyoung at mogua.com (Bang Jun-young)
Date: Thu, 7 Feb 2008 23:00:28 +0900
Subject: comctl32: Fix invalid syntax.
In-Reply-To: <87y79xqhqa.fsf@wine.dyndns.org>
References: <22aa2f590802030009i2effb841nfd122db45f38b5f6@mail.gmail.com>
	<22aa2f590802060007o7e66b2b5j9a8dfd771edc8b96@mail.gmail.com>
	<22aa2f590802061855k7ceb4abbie783b33cae813910@mail.gmail.com>
	<87y79xqhqa.fsf@wine.dyndns.org>
Message-ID: <22aa2f590802070600j4d9ad19ewc8199739e68c94f2@mail.gmail.com>

On 2/7/08, Alexandre Julliard <julliard at winehq.org> wrote:
> "Bang Jun-young" <junyoung at mogua.com> writes:
>
> > 18 hours passed, and it looks like Alexandre decided to ignore this...why?
> >
> > This fix is required for Wine to be built with VC2005/2008 (although
> > Alexandre doesn't seem to care about it).
>
> There's no need to count the hours, or to ask every day, especially not
> with a mail to wine-patches. I have lots of pending patches from my
> vacation, I'll get to it eventually, and if I don't you should resubmit
> it after a week has passed.

That's because you wanted yourself to be the only committer in the
project. Why don't you give commit privilege to other Wine
contributors as well?

> And if you want me to care about VC2005,
> maybe you should mention in your patch that this is the reason for your
> change, "fix invalid syntax" doesn't tell me anything.

The patch is so obvious that I presumed you need no explanation.


From msclrhd at googlemail.com  Thu Feb  7 06:04:18 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Thu, 7 Feb 2008 12:04:18 +0000
Subject: gdi32: correct the test message in font.c that was out of sync
	with the test. [RESEND]
In-Reply-To: <878x1xq8ut.fsf@wine.dyndns.org>
References: <3f4fd2640802070025re593f5u8f4b00e4ddef4d3a@mail.gmail.com>
	<878x1xq8ut.fsf@wine.dyndns.org>
Message-ID: <3f4fd2640802070404j7cccc1d2r8f4925816c78ccdb@mail.gmail.com>

On 07/02/2008, Alexandre Julliard <julliard at winehq.org> wrote:
> "Reece Dunn" <msclrhd at googlemail.com> writes:
>
> > diff --git a/dlls/gdi32/tests/font.c b/dlls/gdi32/tests/font.c
> > index 7e560d2..bfdb0af 100644
> > --- a/dlls/gdi32/tests/font.c
> > +++ b/dlls/gdi32/tests/font.c
> > @@ -604,7 +604,7 @@ static void test_GetGlyphIndices(void)
> >      flags |= GGI_MARK_NONEXISTING_GLYPHS;
> >      charcount = pGetGlyphIndicesW(hdc, testtext, (sizeof(testtext)/2)-1, glyphs, flags);
> >      ok(charcount == 5, "GetGlyphIndices count of glyphs should = 5 not %d\n", charcount);
> > -    ok((glyphs[4] == 0x001f || glyphs[4] == UNICODE_NOCHAR /* Vista */), "GetGlyphIndices should have returned a nonexistent char not %04x\n", glyphs[4]);
> > +    ok((glyphs[4] == 0x001f || glyphs[4] == UNICODE_NOCHAR /* Vista */), "GetGlyphIndices should have returned a nonexistent char or UNICODE_NOCHAR, not %04x\n", glyphs[4]);
>
> UNICODE_NOCHAR is a nonexistent char too. And if someone really cares
> about the exact details they can always look at the test, we don't need
> to duplicate all of it in the error message.

Ok, I'll drop this patch from my list.

- Reece


From mstefani at redhat.com  Thu Feb  7 08:46:01 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 07 Feb 2008 15:46:01 +0100
Subject: comctl32: Fix invalid syntax.
In-Reply-To: <22aa2f590802070600j4d9ad19ewc8199739e68c94f2@mail.gmail.com>
References: <22aa2f590802030009i2effb841nfd122db45f38b5f6@mail.gmail.com>	<22aa2f590802060007o7e66b2b5j9a8dfd771edc8b96@mail.gmail.com>	<22aa2f590802061855k7ceb4abbie783b33cae813910@mail.gmail.com>	<87y79xqhqa.fsf@wine.dyndns.org>
	<22aa2f590802070600j4d9ad19ewc8199739e68c94f2@mail.gmail.com>
Message-ID: <47AB19A9.4010207@redhat.com>

Bang Jun-young wrote:
> On 2/7/08, Alexandre Julliard <julliard at winehq.org> wrote:
>> "Bang Jun-young" <junyoung at mogua.com> writes:
>>
>>> 18 hours passed, and it looks like Alexandre decided to ignore this...why?
>>>
>>> This fix is required for Wine to be built with VC2005/2008 (although
>>> Alexandre doesn't seem to care about it).
>> There's no need to count the hours, or to ask every day, especially not
>> with a mail to wine-patches. I have lots of pending patches from my
>> vacation, I'll get to it eventually, and if I don't you should resubmit
>> it after a week has passed.
> 
> That's because you wanted yourself to be the only committer in the
> project. Why don't you give commit privilege to other Wine
> contributors as well?
Huh? Why would you need that? Wine uses git, a distributed SCM. You are
free to publish your own Wine tree without waiting for Alexandre.

People prefer to follow Alexandre's tree but nobody forces them to use it.

bye
	michael
-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Hauptst?tter Strasse 58, 70178 Stuttgart
Handelsregister: Amtsgericht Stuttgart HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                 Werner Knoblich


From junyoung at mogua.com  Thu Feb  7 22:41:28 2008
From: junyoung at mogua.com (Bang Jun-young)
Date: Fri, 8 Feb 2008 13:41:28 +0900
Subject: Code quality (was Re: comctl32: Fix invalid syntax)
Message-ID: <22aa2f590802072041m647676dakadf197f1eec877d0@mail.gmail.com>

On 2/7/08, Michael Stefaniuc <mstefani at redhat.com> wrote:
> Bang Jun-young wrote:
> > On 2/7/08, Alexandre Julliard <julliard at winehq.org> wrote:
> >> "Bang Jun-young" <junyoung at mogua.com> writes:
> >>
> >>> 18 hours passed, and it looks like Alexandre decided to ignore this...why?
> >>>
> >>> This fix is required for Wine to be built with VC2005/2008 (although
> >>> Alexandre doesn't seem to care about it).
> >> There's no need to count the hours, or to ask every day, especially not
> >> with a mail to wine-patches. I have lots of pending patches from my
> >> vacation, I'll get to it eventually, and if I don't you should resubmit
> >> it after a week has passed.
> >
> > That's because you wanted yourself to be the only committer in the
> > project. Why don't you give commit privilege to other Wine
> > contributors as well?
> Huh? Why would you need that?

Because I'm concerned with the code quality of Wine. When Alexandre
commits what he doesn't understand, it's a red sign to the project.
Months ago I posted a patch similar to this one to wine-patches, and
he committed it:

 typedef struct _OLEOBJECTVTBL {
-    void CALLBACK *(*QueryProtocol)(_LPOLEOBJECT,LPCOLESTR16);
+    void *         (CALLBACK *QueryProtocol)(_LPOLEOBJECT,LPCOLESTR16);

How did he know what the patch does from the same message "Fix invalid
syntax?" IIRC, he didn't tell anything about what he doesn't
understand.

In fact, this is a well known mistake many newbie Win32 developers
make (and fix in minutes). It shouldn't have been in the tree in the
first place if he actually have read the patch. There are a lot of
easily catchable bugs in the tree, for example, potential security
holes like buffer overrun, meaningless comparison of unsigned < 0 (or
> 0), misuse of BOOL vs. HRESULT, misuse of functions such as
strcasecmp(), use of non-portable syntax, etc. Most of them (if not
all) could be filtered out if he have read the patches carefully.

That's the main reason why Wine keeps crashing every time I give it a
try with my Windows apps. Since 1993, Wine has never gotten to the
point where everybody could rely on it for his daily work. It has as
awfully many bugs as Win95. I see something fundamentally wrong with
development process.

> Wine uses git, a distributed SCM. You are
> free to publish your own Wine tree without waiting for Alexandre.

99% of the world won't benefit from what I have done in my own local
repository. People usually don't have a much time to keep track of
repositories of hundreds of developers around the world. That's why
every open source project has the main repository even if developers
usually maintain their own repostories at home.

> People prefer to follow Alexandre's tree but nobody forces them to use it.

If winehq.org is Alexandre's own property, this is something
fundametally wrong again.


From dank at kegel.com  Thu Feb  7 23:12:05 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 7 Feb 2008 21:12:05 -0800
Subject: Code quality (was Re: comctl32: Fix invalid syntax)
Message-ID: <a71bd89a0802072112l1ed3adbai740360bed7981b42@mail.gmail.com>

Bang Jun-young wrote:
>In fact, this is a well known mistake many newbie Win32 developers
>make (and fix in minutes). It shouldn't have been in the tree in the
>first place if he actually have read the patch. There are a lot of
>easily catchable bugs in the tree, for example, potential security
>holes like buffer overrun, meaningless comparison of unsigned < 0 (or
> > 0), misuse of BOOL vs. HRESULT, misuse of functions such as
> strcasecmp(), use of non-portable syntax, etc. Most of them (if not
> all) could be filtered out if he have read the patches carefully.
>That's the main reason why Wine keeps crashing every time I give it a
>try with my Windows apps.

I don't think so.  In my experience, it's either a missing feature
or something more subtle.  Outright bugs of the kind you
describe are the minority. I think.

> Since 1993, Wine has never gotten to the
> point where everybody could rely on it for his daily work. It has as
> awfully many bugs as Win95. I see something fundamentally
> wrong with development process.

Nah, Alexandre usually does a good job of screening patches.
We're lucky to have such a good maintainer, IMHO.
(I say this knowing full well that newbies are put off by
how difficult it is to get feedback because I have seen
much, much worse maintainers.  Imagine if, say, that guy
who always yells at the newbies to not paste logs in
bug reports was the maintainer.  We'd probably lose all
our developers in a month.)

So you're peeved you don't have commit access.
That's understandable, but it's time to get over it.
IMHO the single-committer system works pretty well
once you get into the swing of it.  It actually forces at least
one code review on every patch!
- Dan


From dmitry at codeweavers.com  Thu Feb  7 23:17:32 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 8 Feb 2008 13:17:32 +0800
Subject: Code quality (was Re: comctl32: Fix invalid syntax)
References: <22aa2f590802072041m647676dakadf197f1eec877d0@mail.gmail.com>
Message-ID: <005001c86a11$eaef2ab0$a600fea9@DMITRY>

"Bang Jun-young" <junyoung at mogua.com> wrote:

>> People prefer to follow Alexandre's tree but nobody forces them to use it.
> 
> If winehq.org is Alexandre's own property, this is something
> fundametally wrong again.

You may try to learn how things work in the Wine project by reading
the following thread:

http://www.winehq.org/pipermail/wine-devel/2006-September/050915.html

and I'd suggest you very carefully read what Mike said:

http://www.winehq.org/pipermail/wine-devel/2006-September/051163.html

-- 
Dmitry.


From winehacker at gmail.com  Fri Feb  8 01:51:15 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 8 Feb 2008 02:51:15 -0500
Subject: Patch tracking system - again...
Message-ID: <19e31a080802072351o66d8a818s9ccde4b5c6c00317@mail.gmail.com>

Hi,
I'm not sure if this would even really be of use with most of the
development being done on git anyway, but after re-reading the
governance thread when the point of patch tracking was brought up, It
got me thinking. last time around it got shelved as normal due to not
wanting to disrupt Alexandre's work flow. Thinking about it a bit more
I think I've come up with a solution to the problem that should not
disrupt Alexandre's flow if I understand git properly. Let me preface
this with saying that I don't.

At first I thought we might be able to use the sha1 hashes that are
the patch names themselves to track if a commit had be accepted or
not, but then I guess that would only work if we were pushing and
pulling directly in to each others tree's as I see the commit hash
differs from the patch hash in the patches I've reviewed. I can only
assume this is because of the way git views looks at the entire repo
as one chunk of data rather than dealing with single patches.

Then as I dug in to it a bit more I noticed the index's did match
provided Alexandre did not make any changes before he committed. I was
thinking this could be a use for a tracking system.

Lets imagine there is this patch daemon that sits out there and reads
wine-patches, storing the diff and parsing the index in to a database.
This deamon could do a git fetch every 30 mins or so to compare and
see if a patch has been merged in based on the index. It seems like we
already have most of the tools we need to do it now if someone really
wants the tracking system. We know about the patches and we know if
its been merged or not, defining rules for accepted or rejected seem
pretty trivial to me as we already have the rule, if its not merged in
a week then resend.

So here is what it would look like as far as work flow goes, someone
submits a patch, it goes to this database and up to a website with a
listview showing all the patches. Anything not merged yet still in the
two week window would show up in the list as white meaning still
pending.

The further up the list we would have patches that were merged and
accepted as is, like the following (showing up in green)
http://www.winehq.org/pipermail/wine-patches/2008-February/049719.html
http://source.winehq.org/git/wine.git/?a=commit;h=ac61b90f87a2062b99f6f70686ea86b5b6c241c3

The following patch would show up in yellow as the index differs for
the Makefile part of the patch as Julliard made local changes
http://www.winehq.org/pipermail/wine-patches/2008-February/049720.html
http://source.winehq.org/git/wine.git/?a=commit;h=5bad12c6bc3072a2676f0d9edc9e3a48bca1ceaf

Any other patches that don't get merged would show up in the list as
red after the one week window went by. The tracker would assume they
were rejected.

The cool thing about this is that we could directly link it in to
bugzilla so that when a patch is applied the bug could get
automatically updated.

Now this all hinges on being able to use the diff index to do the
tracking. I imagine there might be conflicts if your trying to use
that as the only data point as its not as long as a real hash, but
assuming your only doing a compare over as period of a few weeks or a
month I think it would work. Am I wack? Is there even still the desire
to have a graphical patch tracking system?

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From luis.busquets at ilidium.com  Fri Feb  8 02:07:59 2008
From: luis.busquets at ilidium.com (luis.busquets at ilidium.com)
Date: Fri, 8 Feb 2008 09:07:59 +0100 (CET)
Subject: kernel32: Implement ReplaceFileW
Message-ID: <64177.158.169.9.14.1202458079.squirrel@ns2.ilidium.com>

I have read this patch sent in several times and have realised that every
time it contains a large number of "goto"'s.

I certainly do not like "goto" in structured code.
My question to the forum is if it is allowed to use "goto" in wine or if
you prefer not to use it.

Even when this will make the code larger but it may give a little nore
readability,



From kai.blin at gmail.com  Fri Feb  8 03:24:24 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Fri, 8 Feb 2008 10:24:24 +0100
Subject: Patch tracking system - again...
In-Reply-To: <19e31a080802072351o66d8a818s9ccde4b5c6c00317@mail.gmail.com>
References: <19e31a080802072351o66d8a818s9ccde4b5c6c00317@mail.gmail.com>
Message-ID: <200802081024.30230.kai.blin@gmail.com>

On Friday 08 February 2008 08:51:15 Steven Edwards wrote:

I'll skip the technical discussion and go right to the beef.

> Is there even still the desire to have a graphical patch tracking system?

Personally I tend to use feature branches in git that I rebase on the top of 
Alexandre's tree. Simply starting gitk will show me which of my patches have 
been accepted and which of them are still on top of the tree. Of course that 
means I need to track which of those I sent.

Using more branches, this is even more clear.

Assume you have two git branches, 'submitted' and 'my-cool-feature'

You develop in 'my-cool-feature'. Once a patch is ready to be committed, you 
git-cherry-pick it to the 'submitted' branch, git-format-patch | 
git-imap-send or whatever you do to send it to wine-patches. Now you can keep 
track of your submitted patches easily.

A web interface can be nice, so if anyone feels like hacking this up I'm 
definitely not going to stop them. All I want to say is that I think it's not 
needed for personal use.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080208/76a9bdce/attachment.pgp 

From fgouget at free.fr  Fri Feb  8 05:27:28 2008
From: fgouget at free.fr (Francois Gouget)
Date: Fri, 8 Feb 2008 12:27:28 +0100 (CET)
Subject: Code quality (was Re: comctl32: Fix invalid syntax)
In-Reply-To: <22aa2f590802072041m647676dakadf197f1eec877d0@mail.gmail.com>
References: <22aa2f590802072041m647676dakadf197f1eec877d0@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0802081217480.3891@amboise.dolphin>

On Fri, 8 Feb 2008, Bang Jun-young wrote:
[...]
> In fact, this is a well known mistake many newbie Win32 developers
> make (and fix in minutes). It shouldn't have been in the tree in the
> first place if he actually have read the patch.

News flash!!!

You too are allowed to review patches posted to wine-patches and to 
point out their flaws. Some people do so regularly and thus help 
Alexandre. If bad patches are accepted it's partly your fault.

(and mine too cause I don't review patches enough)

> There are a lot of easily catchable bugs in the tree, for example, 
> potential security holes like buffer overrun, meaningless comparison 
> of unsigned < 0 (or > 0), misuse of BOOL vs. HRESULT, misuse of 
> functions such as strcasecmp(), use of non-portable syntax, etc.

You are welcome to review the Wine code and submit patches too. Again 
some others do so on a regular basis (me included this time :-). But if 
you don't want Wine to get better, then sure, just bitch about it.


> That's the main reason why Wine keeps crashing every time I give it a
> try with my Windows apps.

<sarcasm>
Riiiight. It must be the *main* cause of crashes. All the stub functions 
and unimplemented undocumented features must really be secondary causes 
of crashes in comparison.
</sarcasm>


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                            1 + e ^ ( i * pi ) = 0


From mstefani at redhat.com  Fri Feb  8 05:32:19 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Fri, 08 Feb 2008 12:32:19 +0100
Subject: kernel32: Implement ReplaceFileW
In-Reply-To: <64177.158.169.9.14.1202458079.squirrel@ns2.ilidium.com>
References: <64177.158.169.9.14.1202458079.squirrel@ns2.ilidium.com>
Message-ID: <47AC3DC3.4050702@redhat.com>

luis.busquets at ilidium.com wrote:
> I have read this patch sent in several times and have realised that every
> time it contains a large number of "goto"'s.
> 
> I certainly do not like "goto" in structured code.
> My question to the forum is if it is allowed to use "goto" in wine or if
> you prefer not to use it.
Wine takes the right (TM) approach to goto: the non ideological one:
goto is fine for handling a lot and complex cleanups needed on error
paths. You always need to balance the advantages and disadvantages of
goto: does the goto make the code more readable and clear? If yes use
the goto if not then don't.
See also Donald Knuth paper "Structured Programming with Goto
Statements" http://pplab.snu.ac.kr/courses/adv_pl05/papers/p261-knuth.pdf

> Even when this will make the code larger but it may give a little nore
> readability,
No, it doesn't increase readability it decreases readability a lot.
Especially as you have to replace "goto error:" with deeply nested
if/else code and that is not readable at all.
Using goto right is an art; you need to look at the code and say that it
looks good.

bye
	michael
-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Hauptst?tter Strasse 58, 70178 Stuttgart
Handelsregister: Amtsgericht Stuttgart HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                 Werner Knoblich


From msclrhd at googlemail.com  Thu Feb  7 14:43:14 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Thu, 7 Feb 2008 20:43:14 +0000
Subject: War on conformance test suite failures!
In-Reply-To: <200802051247.49201.stefan@codeweavers.com>
References: <a71bd89a0802041550k7e8e00c3k9e7dd83e012336de@mail.gmail.com>
	<200802050106.10940.stefan@codeweavers.com>
	<3f4fd2640802042259p4f54db04heef7e8350c974e47@mail.gmail.com>
	<200802051247.49201.stefan@codeweavers.com>
Message-ID: <3f4fd2640802071243xb61c7ffxf180f186cc5436ce@mail.gmail.com>

On 05/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> Am Dienstag, 5. Februar 2008 07:59:58 schrieb Reece Dunn:
> > On 05/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> > > Am Dienstag, 5. Februar 2008 00:50:55 schrieb Dan Kegel:
> > > > Great progress was made at Wineconf last year on
> > > > getting our test suite closer to always passing on wine, but
> > > > http://test.winehq.org/data/200801301937/#Wine shows
> > > > that, according to the results collected from people who run
> > > > programs/winetest on Wine, twelve DLLs' tests are currently failing.
> > > > (Let alone the test failures on Windows!)
> > > > http://bugs.winehq.org/show_bug.cgi?id=9916 also
> > > > talks about the fact that "make test" shows failures.
> > >
> > > This is only half on-topic, but the d3d9:visual test ran on this machine
> > > has some interesting results:
> > >
> > > Vista: Vista-HomePrem-NoUAC
> > >
> > > Do we have any track who reported them?
> >
> > That one is mine, along with Vista-HomePrem-UAC. They are both on the
> > same high-spec recent HP laptop (HP Pavilion DV95000) machine with an
> > NVidia GeForce 8600M GS graphics card.
> Do you have Half Life 2? If yes, can you start a new game and take a few
> screenshots from Doktor Kleiner's lab? If you don't have the game I'll try to
> find a place to reproduce the fog bug at a place that can be reached in the
> demo.

No, I don't have the game, sorry.

- Reece


From dmitry at codeweavers.com  Fri Feb  8 06:31:35 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 8 Feb 2008 20:31:35 +0800
Subject: user32: Implement GetWindowModuleFileName with tests
References: <b130c85e0802071303r74618f2cwa66a58b20a23c75@mail.gmail.com>
Message-ID: <00ac01c86a4e$8cf578f0$a600fea9@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

>  UINT WINAPI GetWindowModuleFileNameA( HWND hwnd, LPSTR lpszFileName, UINT cchFileNameMax)
>  {
> -    FIXME("GetWindowModuleFileNameA(hwnd %p, lpszFileName %p, cchFileNameMax %u) stub!\n",
> -          hwnd, lpszFileName, cchFileNameMax);
> -    return 0;
> +    LPWSTR filenameW = NULL;
> +    UINT retval;
> +
> +    if (cchFileNameMax)
> +    {
> +        filenameW = HeapAlloc(GetProcessHeap(), 0, cchFileNameMax);
> +        if (!filenameW)
> +        {
> +            SetLastError(ERROR_NOT_ENOUGH_MEMORY);
> +            return 0;
> +        }
> +    }

Probably GetWindowModuleFileNameA should simply allocate a buffer of size
MAX_PATH on the stack and fail with ERROR_FILENAME_EXCED_RANGE if unicode
counterpart returns a string longer than MAX_PATH. kernel32 APIs behave
that way.

> +    retval = GetWindowModuleFileNameW(hwnd, filenameW, cchFileNameMax);
> +    if (retval)
> +    {
> +        DWORD lasterror = GetLastError();
> +        WideCharToMultiByte(CP_ACP, 0, filenameW, -1, lpszFileName, cchFileNameMax, NULL, NULL);
> +        SetLastError(lasterror);

What's the point of saving/restoring last error value? If WideCharToMultiByte
fails you need to return an error in that case, not silently continue.

Also GetWindowModuleFileNameA also should be fixed to return correct value,
and not assume that the buffer is '\0' terminated.

>  UINT WINAPI GetWindowModuleFileNameW( HWND hwnd, LPWSTR lpszFileName, UINT cchFileNameMax)
>  {
> -    FIXME("GetWindowModuleFileNameW(hwnd %p, lpszFileName %p, cchFileNameMax %u) stub!\n",
> -          hwnd, lpszFileName, cchFileNameMax);
> -    return 0;
> +    PROCESS_BASIC_INFORMATION pbi;
> +    DWORD pid, retval;
> +    HANDLE hproc;
> +    DWORD lasterror = GetLastError();
> +    UNICODE_STRING *pathname;
> +    TRACE("GetWindowModuleFileNameW(hwnd %p, lpszFileName %p, cchFileNameMax %u)\n", hwnd, lpszFileName, 
> cchFileNameMax);

TRACE/WARN/ERR/etc already print the caller's name, there is no need to
duplicate it.

> +    if (!GetWindowThreadProcessId(hwnd, &pid))
> +    {
> +        SetLastError(ERROR_INVALID_WINDOW_HANDLE);
> +        return 0;
> +    }

GetWindowThreadProcessId already sets the error to the correct value,
there is no need to guess why it failed.

> +    if (!cchFileNameMax)
> +    { /* Fail silently without setting filename */
> +        SetLastError(lasterror);
> +        return 0;
> +    }

Saving/restoring last error value doesn't look correct at all.

> +    hproc = OpenProcess(PROCESS_QUERY_INFORMATION, 0, pid);
> +    if (!hproc)
> +    {
> +        FIXME("Is this correct?");
> +        SetLastError(ERROR_INVALID_WINDOW_HANDLE);
> +        return 0;
> +    }

There is no need to guess why OpenProcess failed.

> +    retval = NtQueryInformationProcess(hproc, ProcessBasicInformation, &pbi, sizeof(pbi), NULL);
> +    pathname = &pbi.PebBaseAddress->ProcessParameters->ImagePathName;
> +    if (pathname->Length / sizeof(WCHAR) < cchFileNameMax)
> +    {
> +        memcpy(lpszFileName, pathname->Buffer, pathname->Length);
> +        lpszFileName[pathname->Length / sizeof(WCHAR)] = 0;
> +        retval = pathname->Length / sizeof(WCHAR) + 1;
> +    }
> +    else
> +    {
> +        memcpy(lpszFileName, pathname->Buffer, cchFileNameMax * sizeof(WCHAR));
> +        retval = cchFileNameMax;
> +    }

Both branches above should be merged, that will simplify the code. Just '\0'
terminate the result if there is enough space in the provided buffer.

> +    CloseHandle(hproc);
> +    SetLastError(lasterror);
> +    FIXME("--> %u %s\n", retval, debugstr_w(lpszFileName));

Left-over from debugging?


-- 
Dmitry. 



From dmitry at codeweavers.com  Fri Feb  8 06:44:38 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 8 Feb 2008 20:44:38 +0800
Subject: user32: Implement GetWindowModuleFileName with tests
References: <b130c85e0802071303r74618f2cwa66a58b20a23c75@mail.gmail.com>
	<00ac01c86a4e$8cf578f0$a600fea9@DMITRY>
	<3f4fd2640802080442v2ea7bb48tf11e5af0b80088e2@mail.gmail.com>
Message-ID: <00f101c86a50$5f785a30$a600fea9@DMITRY>

"Reece Dunn" <msclrhd at googlemail.com> wrote:

>> > +    retval = GetWindowModuleFileNameW(hwnd, filenameW, cchFileNameMax);
>> > +    if (retval)
>> > +    {
>> > +        DWORD lasterror = GetLastError();
>> > +        WideCharToMultiByte(CP_ACP, 0, filenameW, -1, lpszFileName, cchFileNameMax, NULL, NULL);
>> > +        SetLastError(lasterror);
>>
>> What's the point of saving/restoring last error value? If WideCharToMultiByte
>> fails you need to return an error in that case, not silently continue.
> 
> The usual model is something like this:
> 
>    SetLastError(0xdeadbeef);
>    WinApiCall();
>    ok(GetLastError() == ERROR_SUCCESS, "WinApiCall failed, expected
> ERROR_SUCCESS, got %d", GetLastError());

In the tests, which is not the case here.

-- 
Dmitry.


From dmitry at codeweavers.com  Fri Feb  8 07:20:49 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 8 Feb 2008 21:20:49 +0800
Subject: user32: Implement GetWindowModuleFileName with tests
References: <b130c85e0802071303r74618f2cwa66a58b20a23c75@mail.gmail.com>
	<00ac01c86a4e$8cf578f0$a600fea9@DMITRY>
Message-ID: <015501c86a55$6df8b780$a600fea9@DMITRY>

> +    hproc = OpenProcess(PROCESS_QUERY_INFORMATION, 0, pid);

After reading MSDN and guessing from the API name shouldn't it
simply fetch GWL_HINSTANCE and call GetModuleFileName on it?

-- 
Dmitry.


From mpartap at gmx.net  Fri Feb  8 07:22:19 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Fri, 08 Feb 2008 14:22:19 +0100
Subject: Code quality (was Re: comctl32: Fix invalid syntax)
In-Reply-To: <005001c86a11$eaef2ab0$a600fea9@DMITRY>
References: <22aa2f590802072041m647676dakadf197f1eec877d0@mail.gmail.com>
	<005001c86a11$eaef2ab0$a600fea9@DMITRY>
Message-ID: <47AC578B.2@gmx.net>

hi base,
 >> If winehq.org is Alexandre's own property, this is something
 >> fundametally wrong again.
Well.. then 'something' must be wrong with the linux kernel aswell.. how comes noone forked? hmmm..

 > You may try to learn how things work in the Wine project by reading
 > the following thread:
 > http://www.winehq.org/pipermail/wine-devel/2006-September/050915.html
Although time consuming, it was rather a good read. While digesting the follow up 'governance ideas'
thread I had a little idea that might help, though I doubt the problems discussed at that time are
still that relevant. IMHO most of the wine-patches-black-hole problem is complexity of submitted
patches, making them hard to review and rather lead to those patches being silently skipped in favor
of the infinitly queuing later patches. One simple fix for this would be to recommend a maximum size
for diffs on the developer wiki (additionally to the recommendation to focus on a small context per
patch) and set up a wine-patches auto-reply for patches beyond that size, warning the submitter that
because of sheer size (=complexity), the patch is likely to be skipped because of merge pressure of
the following patches. That way, new contributors would get another visible warning to submit
patches that are easier to review.
Again, I can't estimate how much of an issue this is atm. I see a lot of patches commit or discussed
on -devel, so it might not be at all. Anyways..

Another thing: after my important exam in march, I will probably try setting up a drupal site and
see how it can be merged/ integrated with the wineforum, mailing lists and bugzilla.. there are some
cool modules and regexp power waiting to be explored :)

Last note: Jesse's DIB engine stuff, my work on printing aswell as Detlef's progress on sanitizing
the spooler will hopefully show some results, too. Jesse I'll discuss that stuff with you next month
be sure to be ready for some wine-patches resubmit cycles ;D
regards, marcel.

-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>



From dmitry at codeweavers.com  Fri Feb  8 07:31:37 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 8 Feb 2008 21:31:37 +0800
Subject: user32: Implement GetWindowModuleFileName with tests
References: <b130c85e0802071303r74618f2cwa66a58b20a23c75@mail.gmail.com><00ac01c86a4e$8cf578f0$a600fea9@DMITRY>
	<015501c86a55$6df8b780$a600fea9@DMITRY>
Message-ID: <016b01c86a56$f02509b0$a600fea9@DMITRY>

"Dmitry Timoshkov" <dmitry at codeweavers.com> wrote:

>> +    hproc = OpenProcess(PROCESS_QUERY_INFORMATION, 0, pid);
> 
> After reading MSDN and guessing from the API name shouldn't it
> simply fetch GWL_HINSTANCE and call GetModuleFileName on it?

And after looking at GetModuleFileNameW implementation, shouldn't it
treat hModule == 0 as GetModuleHandle(0) and not be 16-bit specific?
Guess this all needs a test case.

-- 
Dmitry.


From jwhite at codeweavers.com  Fri Feb  8 07:58:01 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Fri, 08 Feb 2008 07:58:01 -0600
Subject: Fixing make test - progress update
Message-ID: <47AC5FE9.6090100@codeweavers.com>

I believe that we have an easy way
to find out the 'state of the art' wrt to make test.

That is, my patch + request of a few days ago:
  http://www.winehq.org/pipermail/wine-devel/2008-February/062303.html
resulted in a very nice, easy to digest report
  http://test.winehq.org/data/20080205/

That data has five test runs and shows clear across
the board failures in msi:install, shell32:shellink,
user32:listbox, and user32:msg.

So, we can quickly and easily collate and visually see
the make test failures.

And, heck, I'm sure that fixing those failures is now
a trivial exercise.

Now we just need the will.  :-/.

Not sure how to arrange that, but I think having make
test succeed on all systems should be a mandatory
requirement for Wine 1.0, so I think we have to work
on solving it sooner rather than later.

The todo's as I see them are as follows:

  1.  Revise winetest to not require the 'make dist'
      step, so that the function of my patch can
      be implemented more cleanly.

  2.  Persuade people to run a script on a regular
      basis so we always have this data.  It's
      trickier than the average bear because the tests
      require the 'real' console, so you can't just
      stick it in a headless cron job.  Maybe some
      xauth magic... :-/

  3.  (The hard one)  Focus in and fix the issues.

I'll work on #1 and #2 (although not for a week or two),
if everyone else agrees to do #3 <evil grin>.

Cheers,

Jeremy


From paul.vriens.wine at gmail.com  Fri Feb  8 08:04:12 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 08 Feb 2008 15:04:12 +0100
Subject: Fixing make test - progress update
In-Reply-To: <47AC5FE9.6090100@codeweavers.com>
References: <47AC5FE9.6090100@codeweavers.com>
Message-ID: <47AC615C.2020306@gmail.com>

Jeremy White wrote:
> I believe that we have an easy way
> to find out the 'state of the art' wrt to make test.
> 
> That is, my patch + request of a few days ago:
>   http://www.winehq.org/pipermail/wine-devel/2008-February/062303.html
> resulted in a very nice, easy to digest report
>   http://test.winehq.org/data/20080205/
> 
Hi Jeremy,

I don't want to spoil your enthusiasm but how does that differ from for example 
(old one though) http://test.winehq.org/data/200801301937/#Wine ?

-- 
Cheers,

Paul.


From dank at kegel.com  Fri Feb  8 08:26:01 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 8 Feb 2008 06:26:01 -0800
Subject: [PATCH] msvcrt: Fix early pipe closing
Message-ID: <a71bd89a0802080626u18d3b530l7ab241e2eb31bcfc@mail.gmail.com>

On Sat Feb 2, Nguy?n Th?i Ng?c Duy wrote:
> Pipes are not like other normal files. If we do not read enough
> bytes, it does not mean it reaches EOF
> ... fixes broken pipe on git-fetch-pack (MinGW port)

This is the same problem as
   http://bugs.winehq.org/show_bug.cgi?id=11187
so it's my fault.  Thanks for the information about
git-fetch-pack failing, and for the proposed fix.

Before we can commit a fix like yours, we need a test case,
so I improved msvcrt/tests/file.c to test EOF on pipes more thoroughly.
It shows your patch was almost right.  I've fixed up your patch
and will send it in.
- Dan

From damjan.jov at gmail.com  Fri Feb  8 08:41:11 2008
From: damjan.jov at gmail.com (Damjan Jovanovic)
Date: Fri, 8 Feb 2008 16:41:11 +0200
Subject: msvcrt: Fix EOF behavior on read from pipe
In-Reply-To: <a71bd89a0802080631o138c5104u41905e34a245e2bd@mail.gmail.com>
References: <a71bd89a0802080631o138c5104u41905e34a245e2bd@mail.gmail.com>
Message-ID: <9e89675b0802080641n39ea7c05q9ee2745744ab3b7d@mail.gmail.com>

On Feb 8, 2008 4:31 PM, Dan Kegel <dank at kegel.com> wrote:
> Nguy?n Th?i Ng?c Duy's patch was almost right, he
> forgot a test case, and he neglected to move where
> EOF is detected for pipes instead of just removing it.
>
> Should fix http://bugs.winehq.org/show_bug.cgi?id=11187
>
>
>
>

The problem is more general: consoles *also* break on short reads
(Java 1.4.1's gdb takes 1 command then quits because it thinks it's
the end of file) and I'm sure short read != end of file for ordinary
files either, especially in *nix where read() can easily be
interrupted by a signal.

Damjan

From vostok at etersoft.ru  Fri Feb  8 09:00:52 2008
From: vostok at etersoft.ru (Anatoly Lyutin)
Date: Fri, 08 Feb 2008 18:00:52 +0300
Subject: user32:scroll.c: Compulsory enabling/disabling scrollbars after
	setting scrollbar`s flags.
In-Reply-To: <47AC610B.2090908@etersoft.ru>
References: <47AC610B.2090908@etersoft.ru>
Message-ID: <47AC6EA4.9070408@etersoft.ru>

Oh, Sorry! It crashes some another scrollbars. :(

-- 
Best regards
	Anatoly Lyutin.



From msclrhd at googlemail.com  Fri Feb  8 06:42:30 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Fri, 8 Feb 2008 12:42:30 +0000
Subject: user32: Implement GetWindowModuleFileName with tests
In-Reply-To: <00ac01c86a4e$8cf578f0$a600fea9@DMITRY>
References: <b130c85e0802071303r74618f2cwa66a58b20a23c75@mail.gmail.com>
	<00ac01c86a4e$8cf578f0$a600fea9@DMITRY>
Message-ID: <3f4fd2640802080442v2ea7bb48tf11e5af0b80088e2@mail.gmail.com>

On 08/02/2008, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:
>
> > +    retval = GetWindowModuleFileNameW(hwnd, filenameW, cchFileNameMax);
> > +    if (retval)
> > +    {
> > +        DWORD lasterror = GetLastError();
> > +        WideCharToMultiByte(CP_ACP, 0, filenameW, -1, lpszFileName, cchFileNameMax, NULL, NULL);
> > +        SetLastError(lasterror);
>
> What's the point of saving/restoring last error value? If WideCharToMultiByte
> fails you need to return an error in that case, not silently continue.

The usual model is something like this:

    SetLastError(0xdeadbeef);
    WinApiCall();
    ok(GetLastError() == ERROR_SUCCESS, "WinApiCall failed, expected
ERROR_SUCCESS, got %d", GetLastError());

- Reece


From msclrhd at googlemail.com  Fri Feb  8 06:53:24 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Fri, 8 Feb 2008 12:53:24 +0000
Subject: user32: Implement GetWindowModuleFileName with tests
In-Reply-To: <00f101c86a50$5f785a30$a600fea9@DMITRY>
References: <b130c85e0802071303r74618f2cwa66a58b20a23c75@mail.gmail.com>
	<00ac01c86a4e$8cf578f0$a600fea9@DMITRY>
	<3f4fd2640802080442v2ea7bb48tf11e5af0b80088e2@mail.gmail.com>
	<00f101c86a50$5f785a30$a600fea9@DMITRY>
Message-ID: <3f4fd2640802080453s45228458y7f4e0f541500337c@mail.gmail.com>

On 08/02/2008, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> "Reece Dunn" <msclrhd at googlemail.com> wrote:
> >> What's the point of saving/restoring last error value? If WideCharToMultiByte
> >> fails you need to return an error in that case, not silently continue.
> >
> > The usual model is something like this:
> >
> >    SetLastError(0xdeadbeef);
> >    WinApiCall();
> >    ok(GetLastError() == ERROR_SUCCESS, "WinApiCall failed, expected
> > ERROR_SUCCESS, got %d", GetLastError());
>
> In the tests, which is not the case here.

Sorry, yes. You are correct.

- Reece


From msclrhd at googlemail.com  Fri Feb  8 08:11:43 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Fri, 8 Feb 2008 14:11:43 +0000
Subject: Fixing make test - progress update
In-Reply-To: <47AC5FE9.6090100@codeweavers.com>
References: <47AC5FE9.6090100@codeweavers.com>
Message-ID: <3f4fd2640802080611l421af221g62b234e751ae3954@mail.gmail.com>

On 08/02/2008, Jeremy White <jwhite at codeweavers.com> wrote:
>
> That data has five test runs and shows clear across
> the board failures in msi:install, shell32:shellink,
> user32:listbox, and user32:msg.

The user32:listbox tests fail everywhere when not run from the
dlls/user32/tests directory! I have a patch in wine-patches that is in
current git (http://source.winehq.org/git/wine.git/?a=commitdiff;h=01af8501b992896a5fff38da365896b7708cc705)
 that fixes those failures.

I had a look at the user32:msg failures, but the test results for
these on Wine appear to be completely different on different wine
versions. I suspect these are down to configuration variations (e.g. X
vs. Wine window handling (with focus behaviour) and the like).

I haven't had a look at the others yet.

- Reece


From jwhite at codeweavers.com  Fri Feb  8 09:12:10 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Fri, 08 Feb 2008 09:12:10 -0600
Subject: Fixing make test - progress update
In-Reply-To: <47AC615C.2020306@gmail.com>
References: <47AC5FE9.6090100@codeweavers.com> <47AC615C.2020306@gmail.com>
Message-ID: <47AC714A.3010508@codeweavers.com>

> I don't want to spoil your enthusiasm but how does that differ from for example 
> (old one though) http://test.winehq.org/data/200801301937/#Wine ?

The main difference is that I ran it from my Wine tree, and getting it built
and ready to go was completely under my control.  That is, this is as close
to running make test in my tree, but dumping the results to a web site
for collation.

There is an arguably theoretical difference in that it was built with gcc
and my tool chain and is more theoretically identical to a 'make test' run
than running a prebuilt winetest.exe.

Cheers,

Jeremy


From dmitry at codeweavers.com  Fri Feb  8 10:26:55 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 9 Feb 2008 00:26:55 +0800
Subject: More correctly handle the presence of the default ime inputwindow
	on Ime open and close
References: <47AC8005.9020309@codeweavers.com>
Message-ID: <021601c86a6f$6d33e210$a600fea9@DMITRY>

"Aric Stewart" <aric at codeweavers.com> wrote:

> diff --git a/dlls/imm32/imm.c b/dlls/imm32/imm.c
> index 4acbde3..f3ed6f9 100644
> --- a/dlls/imm32/imm.c
> +++ b/dlls/imm32/imm.c
> @@ -190,19 +190,17 @@ static LRESULT ImmInternalSendIMENotify(WPARAM notify, LPARAM lParam)
> 
> static void ImmInternalSetOpenStatus(BOOL fOpen)
> {
> -    TRACE("Setting internal state to %s\n",(fOpen)?"OPEN":"CLOSED");
> +   TRACE("Setting internal state to %s\n",(fOpen)?"OPEN":"CLOSED");

Wouldn't it be better to change indentation to commonly used 4 spaces
instead of a strange mix of 3 and 4 spaces?

-- 
Dmitry.


From aric at codeweavers.com  Fri Feb  8 10:30:08 2008
From: aric at codeweavers.com (Aric Stewart)
Date: Fri, 08 Feb 2008 10:30:08 -0600
Subject: More correctly handle the presence of the default ime inputwindow
	on Ime open and close
In-Reply-To: <021601c86a6f$6d33e210$a600fea9@DMITRY>
References: <47AC8005.9020309@codeweavers.com>
	<021601c86a6f$6d33e210$a600fea9@DMITRY>
Message-ID: <47AC8390.4040801@codeweavers.com>

Good point, resending.

thanks,
-aric

Dmitry Timoshkov wrote:
> "Aric Stewart" <aric at codeweavers.com> wrote:
> 
>> diff --git a/dlls/imm32/imm.c b/dlls/imm32/imm.c
>> index 4acbde3..f3ed6f9 100644
>> --- a/dlls/imm32/imm.c
>> +++ b/dlls/imm32/imm.c
>> @@ -190,19 +190,17 @@ static LRESULT ImmInternalSendIMENotify(WPARAM 
>> notify, LPARAM lParam)
>>
>> static void ImmInternalSetOpenStatus(BOOL fOpen)
>> {
>> -    TRACE("Setting internal state to %s\n",(fOpen)?"OPEN":"CLOSED");
>> +   TRACE("Setting internal state to %s\n",(fOpen)?"OPEN":"CLOSED");
> 
> Wouldn't it be better to change indentation to commonly used 4 spaces
> instead of a strange mix of 3 and 4 spaces?
> 


From dank at kegel.com  Fri Feb  8 12:03:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 8 Feb 2008 10:03:30 -0800
Subject: msvcrt: Fix EOF behavior on read from pipe
Message-ID: <a71bd89a0802081003h3b72513by6ef2369f74fe76e3@mail.gmail.com>

Damjan wrote
> The problem is more general: consoles *also* break on short reads
> (Java 1.4.1's gdb takes 1 command then quits because it thinks it's
> the end of file)

Try my patch, it should help that case.

> I'm sure short read != end of file for ordinary
> files either, especially in *nix where read() can easily be
> interrupted by a signal.

If you can come up with an example of a real
app or even a test case that is currently broken,
I'll gladly try to fix it.
- Dan


From laxdragon at gmail.com  Fri Feb  8 14:15:41 2008
From: laxdragon at gmail.com (Jeremy Newman)
Date: Fri, 08 Feb 2008 14:15:41 -0600
Subject: AppDB Issues
Message-ID: <47ACB86D.7030504@gmail.com>

As many of you have noticed we've been having a bit of server trauma 
this past month. The issue boils down to a bug somewhere in mysqld. We 
are still trying to find the exact cause of the bug. We do have some 
leads. I just wanted to do a brain dump on wine-devel here before I go 
on Vacation for a week.

The problem:
mysqld will randomly eat up all resources on the system until the server 
is completely unresponsive to anything but pings.

My band-aids thus far:
1. mysql is now running at a nice of 1. This should allow us to at least 
ssh in and kill it if it gets out of control again.

2. I've removed InnoDB table support to save on memory. Not many tables 
where using it anyway, and nothing is using transaction support at this 
time.

3. I've patched the appdb to use memcached for session management. This 
will reduce some load on the DB as the session table was busiest and 
slowest table of the appdb.

These fixes should give longer uptime, but they are not solving the core 
issue.

While I'm gone, if the server goes offline again, please contact 
Alexandre or Jeremy White. They can kick proverbial butt of the server 
to get it going again.

Lastly, sorry for the issues.

-Newman

"We do what we must because we can" - GLaDOS


From m.b.lankhorst at gmail.com  Fri Feb  8 16:35:35 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 8 Feb 2008 14:35:35 -0800
Subject: user32: Implement GetWindowModuleFileName with tests
In-Reply-To: <016b01c86a56$f02509b0$a600fea9@DMITRY>
References: <b130c85e0802071303r74618f2cwa66a58b20a23c75@mail.gmail.com>
	<00ac01c86a4e$8cf578f0$a600fea9@DMITRY>
	<015501c86a55$6df8b780$a600fea9@DMITRY>
	<016b01c86a56$f02509b0$a600fea9@DMITRY>
Message-ID: <b130c85e0802081435m670c1584x86fb001f80473101@mail.gmail.com>

Hi folks,

2008/2/8, Dmitry Timoshkov <dmitry at codeweavers.com>:
> "Dmitry Timoshkov" <dmitry at codeweavers.com> wrote:
>
> >> +    hproc = OpenProcess(PROCESS_QUERY_INFORMATION, 0, pid);
> >
> > After reading MSDN and guessing from the API name shouldn't it
> > simply fetch GWL_HINSTANCE and call GetModuleFileName on it?
>
> And after looking at GetModuleFileNameW implementation, shouldn't it
> treat hModule == 0 as GetModuleHandle(0) and not be 16-bit specific?
> Guess this all needs a test case.

I've tried to do the GetWindowLongPtr GWLP_HINSTANCE thing but it
seems to always return 0 in wine, which according to msdn means error,
but it could just be not set in wine. Perhaps GWLP_HINSTANCE needs to
be set when the window is being created?

Cheers,
Maarten.


From research at science.su  Fri Feb  8 19:13:34 2008
From: research at science.su (L. Rahyen)
Date: Sat, 9 Feb 2008 01:13:34 +0000
Subject: Code quality (was Re: comctl32: Fix invalid syntax)
In-Reply-To: <22aa2f590802072041m647676dakadf197f1eec877d0@mail.gmail.com>
References: <22aa2f590802072041m647676dakadf197f1eec877d0@mail.gmail.com>
Message-ID: <200802090113.34579.research@science.su>

On Friday February 8 2008 04:41:28 Bang Jun-young wrote:
> That's the main reason why Wine keeps crashing every time I give it a
> try with my Windows apps.
> ...
> I see something fundamentally wrong with  development process. 

	I think that current development process isn't a problem at all. In fact AJ 
is very good at what he is doing!
	As far as I understand your patch ("comctl32: Fix invalid syntax.") was 
rejected just because you forgot to add proper (descriptive) changelog entry.
	What is the real problem is the lack of testers (who report regressions and 
bugs) and developers. This is why WINE still has a lot of bugs, regressions 
are quite common thing to happen, etc. To fix this, more people should read 
wine-patches and test patches before they are committed, more people should 
write bug reports, more people should be involved in the development, and so 
on. Unfortunately, not all people have enough time for such tasks.
	However, WINE is pretty usable today.

> Since 1993, Wine has never gotten to the
> point where everybody could rely on it for his daily work. It has as
> awfully many bugs as Win95.

	WINE can work reliably even with very complex programs (such as Photoshop 
CS - I use it pretty often). And if you don't see BIG improvement in last 
years you either tried very few Windows programs or you are very unlucky...
	In my practice WINE run most of the programs I try (well, I didn't tried 
thousands of Windows programs and there is no "hardcore" gamers in my family 
so my statistic may be biased). In fact, it is so good that I typically can 
rely on it to run any program I'm downloading from the Internet (success 
rate for me is more than 85% for "small" and "average" programs/games 
downloadable for free from the Internet). And if Windows program(s) work 
correctly on WINE, cases of "random" crashes are very rare. They (generally) 
do exist but most of Windows programs aren't affected by such bugs - much 
more often you find repeatable crashes after specific sequence(s) of steps.
	And your statement "Wine has never gotten to the point where everybody could 
rely on it for his daily work" is strange. In fact it is true for Windows too 
(Windows never gotten to the point where everybody could rely on it for his 
daily work). Maybe you just mean that WINE doesn't work well for you and some 
(or maybe even most) other people? But working well for some people or for 
nobody is very different things... There is a lot of people who use WINE for 
their daily tasks.
	For example, I and whole my family use Linux and WINE on daily basis (because 
of dependency on some Windows software and Windows games). There is no 
Windows installed on our computers (only I have Windows XP in VMWare for my 
very specific purposes to run Autodesk products).
	In my practice WINE and Linux are absolutely stable (if no bugs in WINE 
triggered by the program of course). In fact, I have trading station for 
Windows working 24 hours per day on my Linux server with WINE (if trading 
station fail or crash, I potentially can lose real money). And for this 
purpose (which by definition requires high stability) WINE+Linux works 
MUCH better than Windows XP.
	And your comparison of WINE with Windows 95 isn't true at all. Did you 
actually ever tried to use Windows 95? It will fail MUCH more often than 
WINE, and WINE can run more Windows programs than Windows 95 (I have it in 
VMWare so I really tested this with some programs year ago or so, "just for 
fun"). Even Windows 98 cannot run many important programs such as Photoshop 
(it require at least Windows 2000). And Windows 95/98 have a LOT of "random" 
crashes; WINE is much better - for many programs it can work for months 24 
hours per day without problems, and even if it crashes in some cases, other 
programs aren't affected (especially if they are launched from different 
prefix).
	Everything above is my personal experience, and for some users it may be 
worse. But for me, WINE work good enough for daily use, even for very 
important applications. So you can consider my story as 
yet-another-success-story-of-using-WINE.
	Obviously, this doesn't mean that WINE is good enough for everyone... But at 
least it is good enough for me, my family and some of my friends. There is 
some minor problems (for example, my brother have some games that don't work 
on WINE at all but he doesn't care very much about this) so WINE isn't 
perfect of course... But I just want to say that it is good enough for daily 
work and gaming at least for some people, and a lot of Windows software is 
usable on Linux with WINE.
	Personally, I think that AJ and all other WINE developers are doing very 
great and important work! Big thanks to all of them...


From dmitry at codeweavers.com  Fri Feb  8 19:47:58 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 9 Feb 2008 09:47:58 +0800
Subject: user32: Implement GetWindowModuleFileName with tests
References: <b130c85e0802071303r74618f2cwa66a58b20a23c75@mail.gmail.com><00ac01c86a4e$8cf578f0$a600fea9@DMITRY><015501c86a55$6df8b780$a600fea9@DMITRY><016b01c86a56$f02509b0$a600fea9@DMITRY>
	<b130c85e0802081435m670c1584x86fb001f80473101@mail.gmail.com>
Message-ID: <001401c86abd$ce1142a0$a600fea9@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

> I've tried to do the GetWindowLongPtr GWLP_HINSTANCE thing but it
> seems to always return 0 in wine, which according to msdn means error,
> but it could just be not set in wine. Perhaps GWLP_HINSTANCE needs to
> be set when the window is being created?

It works just fine in Wine, have a look at dlls/user32/tests/class.c,
test_instances().

-- 
Dmitry.


From damjan.jov at gmail.com  Sat Feb  9 04:15:38 2008
From: damjan.jov at gmail.com (Damjan Jovanovic)
Date: Sat, 9 Feb 2008 12:15:38 +0200
Subject: msvcrt: Fix EOF behavior on read from pipe
In-Reply-To: <a71bd89a0802081003h3b72513by6ef2369f74fe76e3@mail.gmail.com>
References: <a71bd89a0802081003h3b72513by6ef2369f74fe76e3@mail.gmail.com>
Message-ID: <9e89675b0802090215r48c76711w90f508c53084ddb6@mail.gmail.com>

On Feb 8, 2008 8:03 PM, Dan Kegel <dank at kegel.com> wrote:
> Damjan wrote
> > The problem is more general: consoles *also* break on short reads
> > (Java 1.4.1's gdb takes 1 command then quits because it thinks it's
> > the end of file)
>
> Try my patch, it should help that case.

It only helps if I change

+            if (type != FILE_TYPE_PIPE) {

to

+            if (type != FILE_TYPE_PIPE && type != FILE_TYPE_CHAR) {

> > I'm sure short read != end of file for ordinary
> > files either, especially in *nix where read() can easily be
> > interrupted by a signal.
>
> If you can come up with an example of a real
> app or even a test case that is currently broken,
> I'll gladly try to fix it.

Well, if the MSDN is correct about ReadFile() returning only when the
requested number of bytes is read unless an error occurs (it's a big
if :-), then it would be an NTDLL NtReadFile() issue where pread()
returns too soon due to a signal. But I haven't been able to get a
signal to interrupt pread() in my tests, maybe wine handles signals.

> - Dan
>

Thank you
Damjan


From jan.wine at zerebecki.de  Sat Feb  9 05:09:25 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sat, 9 Feb 2008 12:09:25 +0100
Subject: Bugzilla: Remove obsolete components
In-Reply-To: <22821af30801282152o70a84e8fje97a21e9be7cb0c@mail.gmail.com>
References: <b6bb06270801281112y732171c1n7a872639c22abc90@mail.gmail.com>
	<22821af30801282152o70a84e8fje97a21e9be7cb0c@mail.gmail.com>
Message-ID: <20080209110925.GC3557@crissy.swd.zerebecki.de>

On Mon, Jan 28, 2008 at 11:52:56PM -0600, James Hawkins wrote:
> On Jan 28, 2008 1:12 PM, Austin English <austinenglish at gmail.com> wrote:
> > I just finished moving over the last of the obsolete components.
> > _obsolete_binary, _obsolete_directx, and _obsolete_gui can all be
> > removed now.

Done.

> rename:
> 
> wineps-driver -> wineps.drv

> x11-driver -> winex11.drv
> 
> add:
> 
> wintab32
> msacm32
> wintrust
> rasapi32
> msvfw32

Done, except:

> winmm&mci -> winmm

This was discussed on IRC and the agreement was to have them both
in the same component because they are so tightly integrated.


Jan



From stefan at codeweavers.com  Sat Feb  9 06:02:22 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 9 Feb 2008 13:02:22 +0100
Subject: Code quality (was Re: comctl32: Fix invalid syntax)
In-Reply-To: <200802090113.34579.research@science.su>
References: <22aa2f590802072041m647676dakadf197f1eec877d0@mail.gmail.com>
	<200802090113.34579.research@science.su>
Message-ID: <200802091302.22720.stefan@codeweavers.com>

Am Samstag, 9. Februar 2008 02:13:34 schrieb L. Rahyen:
> On Friday February 8 2008 04:41:28 Bang Jun-young wrote:
> > That's the main reason why Wine keeps crashing every time I give it a
> > try with my Windows apps.
> > ...
> > I see something fundamentally wrong with  development process.
>
> 	I think that current development process isn't a problem at all. In fact
> AJ is very good at what he is doing!
> 	As far as I understand your patch ("comctl32: Fix invalid syntax.") was
> rejected just because you forgot to add proper (descriptive) changelog
> entry. What is the real problem is the lack of testers (who report
> regressions and bugs) and developers. This is why WINE still has a lot of
> bugs, regressions are quite common thing to happen, etc. To fix this, more
> people should read wine-patches and test patches before they are committed,
> more people should write bug reports, more people should be involved in the
> development, and so on. Unfortunately, not all people have enough time for
> such tasks. However, WINE is pretty usable today.
I'd say we need more tests. Any patch that breaks a test from our testsuite 
when AJ runs them prior to committing is rejected


From paul.vriens.wine at gmail.com  Sat Feb  9 08:24:14 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Sat, 09 Feb 2008 15:24:14 +0100
Subject: No win95 tests after commit "tests: Add a helper routine to wait
	for a child process and propagate its result correctly."
Message-ID: <47ADB78E.20100@gmail.com>

Hi,

This commit: 05c7174909e975fc7d0ebf9a59bb07160c09d66d introduces a new helper 
script but uses InterlockedExchangeAdd that is not available on win95.

This means that none of the tests run on win95 anymore.

-- 
Cheers,

Paul.


From stefan at codeweavers.com  Sat Feb  9 09:27:08 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 9 Feb 2008 16:27:08 +0100
Subject: wine keyboard fix
In-Reply-To: <47AD2377.5060809@msa.hinet.net>
References: <47AD2377.5060809@msa.hinet.net>
Message-ID: <200802091627.09300.stefan@codeweavers.com>

Am Samstag, 9. Februar 2008 04:52:23 schrieb dhliu:
> Some input methods  can send a much longer string. The original size is
> too small. Please consider enlarging it.
> Thanks.
You should send a patch generated via git to wine-patches. If you do not know 
how to do this, plese consider filing a bugreport about this issue, together 
with an example for "Some input methods" which can trigger the issue.


From dank at kegel.com  Sat Feb  9 09:27:47 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 9 Feb 2008 07:27:47 -0800
Subject: msvcrt: Fix EOF behavior on read from pipe
In-Reply-To: <9e89675b0802090215r48c76711w90f508c53084ddb6@mail.gmail.com>
References: <a71bd89a0802081003h3b72513by6ef2369f74fe76e3@mail.gmail.com>
	<9e89675b0802090215r48c76711w90f508c53084ddb6@mail.gmail.com>
Message-ID: <a71bd89a0802090727j29105015r30486843a3cf7d91@mail.gmail.com>

On Feb 9, 2008 2:15 AM, Damjan Jovanovic <damjan.jov at gmail.com> wrote:
> > Try my patch, it should help that case.
>
> It only helps if I change
> +            if (type != FILE_TYPE_PIPE) {
> to
> +            if (type != FILE_TYPE_PIPE && type != FILE_TYPE_CHAR) {

That makes me as uneasy as I bet it does you; switching to
detecting EOF by noticing zero byte reads as you suggested sounds safer.
Try the attached patch and let me know what you think.

> Well, if the MSDN is correct about ReadFile() returning only when the
> requested number of bytes is read unless an error occurs (it's a big
> if :-), then it would be an NTDLL NtReadFile() issue where pread()
> returns too soon due to a signal. But I haven't been able to get a
> signal to interrupt pread() in my tests, maybe wine handles signals.

Wine's ReadFile already tries to handle interrupted reads, but it looks
offhand like it only handles the case where the read is interrupted
before getting any bytes.
Wine uses signals internally, maybe a stress test that tickled
that part of wine heavily while doing lots of extremely large ReadFile() calls
would cause a partial read.  But it's possible that no apps would care,
especially if we get rid of the "short read = EOF" bug you pointed out
in msvcrt.
- Dan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pipe2.patch
Type: text/x-patch
Size: 4738 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080209/00d86a7a/attachment-0001.bin 

From paul.vriens.wine at gmail.com  Sat Feb  9 09:43:03 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Sat, 09 Feb 2008 16:43:03 +0100
Subject: No win95 tests after commit "tests: Add a helper routine to wait
	for a child process and propagate its result correctly."
In-Reply-To: <47ADB78E.20100@gmail.com>
References: <47ADB78E.20100@gmail.com>
Message-ID: <47ADCA07.2030509@gmail.com>

Paul Vriens wrote:
> Hi,
> 
> This commit: 05c7174909e975fc7d0ebf9a59bb07160c09d66d introduces a new 
> helper script but uses InterlockedExchangeAdd that is not available on 
> win95.
> 
> This means that none of the tests run on win95 anymore.
> 
Hi,

Another side effect of that change is that the kernel32/toolhelp tests shows a 
high number of failures for win98 (139):

http://test.winehq.org/data/200802091000/98_W98SE/kernel32:toolhelp.txt

compared to before (12):

http://test.winehq.org/data/200802062039/98_W98SE/kernel32:toolhelp.txt

-- 
Cheers,

Paul.


From damjan.jov at gmail.com  Sat Feb  9 09:46:58 2008
From: damjan.jov at gmail.com (Damjan Jovanovic)
Date: Sat, 9 Feb 2008 17:46:58 +0200
Subject: msvcrt: Fix EOF behavior on read from pipe
In-Reply-To: <a71bd89a0802090727j29105015r30486843a3cf7d91@mail.gmail.com>
References: <a71bd89a0802081003h3b72513by6ef2369f74fe76e3@mail.gmail.com>
	<9e89675b0802090215r48c76711w90f508c53084ddb6@mail.gmail.com>
	<a71bd89a0802090727j29105015r30486843a3cf7d91@mail.gmail.com>
Message-ID: <9e89675b0802090746k69147014x6ff2d0f939577009@mail.gmail.com>

On Feb 9, 2008 5:27 PM, Dan Kegel <dank at kegel.com> wrote:
> On Feb 9, 2008 2:15 AM, Damjan Jovanovic <damjan.jov at gmail.com> wrote:
> > > Try my patch, it should help that case.
> >
> > It only helps if I change
> > +            if (type != FILE_TYPE_PIPE) {
> > to
> > +            if (type != FILE_TYPE_PIPE && type != FILE_TYPE_CHAR) {
>
> That makes me as uneasy as I bet it does you; switching to
> detecting EOF by noticing zero byte reads as you suggested sounds safer.
> Try the attached patch and let me know what you think.

It works with jdb, and all msvcrt tests still pass. I was trying the
same thing a while back, but some tests always kept failing, so well
done!

> > Well, if the MSDN is correct about ReadFile() returning only when the
> > requested number of bytes is read unless an error occurs (it's a big
> > if :-), then it would be an NTDLL NtReadFile() issue where pread()
> > returns too soon due to a signal. But I haven't been able to get a
> > signal to interrupt pread() in my tests, maybe wine handles signals.
>
> Wine's ReadFile already tries to handle interrupted reads, but it looks
> offhand like it only handles the case where the read is interrupted
> before getting any bytes.
> Wine uses signals internally, maybe a stress test that tickled
> that part of wine heavily while doing lots of extremely large ReadFile() calls
> would cause a partial read.  But it's possible that no apps would care,
> especially if we get rid of the "short read = EOF" bug you pointed out
> in msvcrt.
> - Dan
>

Thank you
Damjan


From dank at kegel.com  Sat Feb  9 10:30:50 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 9 Feb 2008 08:30:50 -0800
Subject: gecko download not robust?
Message-ID: <a71bd89a0802090830vac3eb0aq7c607999354ddef6@mail.gmail.com>

Hmm.  gecko download hung for me once.  I saw
fixme:urlmon:ProtocolStream_Read Read failed: 800c0008
in the log, which makes me wonder if our download code
doesn't handle transient network errors well.

Time to get rid of the download, and just bundle gecko outright, I say...


From winehacker at gmail.com  Sat Feb  9 12:17:17 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sat, 9 Feb 2008 13:17:17 -0500
Subject: No win95 tests after commit "tests: Add a helper routine to wait
	for a child process and propagate its result correctly."
In-Reply-To: <47ADB78E.20100@gmail.com>
References: <47ADB78E.20100@gmail.com>
Message-ID: <19e31a080802091017k12c2139fv953fc0ccda885153@mail.gmail.com>

On Feb 9, 2008 9:24 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi,
>
> This commit: 05c7174909e975fc7d0ebf9a59bb07160c09d66d introduces a new helper
> script but uses InterlockedExchangeAdd that is not available on win95.
>
> This means that none of the tests run on win95 anymore.

Can we just implement our own version inline?

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From ucldb at wanadoo.es  Sat Feb  9 09:00:51 2008
From: ucldb at wanadoo.es (Julio Fernandez)
Date: Sat, 09 Feb 2008 16:00:51 +0100
Subject: Is wine reporting the right value for MaxVertexBlendMatrices ?
Message-ID: <fokf6d$jot$1@ger.gmane.org>

Hi, I don't know if this is the right place to post this, but sorry if 
not, and I'd like to be pointed to the right one

I have been working last weeks on making the game Everquest to work 
under wine, since 0.9.49 it was working flawlesly, but most models

were not shown properly. This corresponds with bug 
http://bugs.winehq.org/show_bug.cgi?id=8357.

These are my findings:

The main executable is eqgame.exe it typically accesses D3D through a 
custom dll eqgraphicsdx9 which interacts with D3D itself or through

d3dx9_30.dll

Using channels and adding some extra messages into certain source files 
I got to track a possible reason:

The game was declaring vertex lists with a vertex of type '0xfe' and 
+189 offset

Sadly, I could not get any extra information tracking just from source 
code, so I had to run the game under Windows on a computer and

using windbg to debug it, while running the same time on another 
computer the game under Debian etch using winedbg to debug, and so

tracing both programs in assambler (I burnt my eyelashes there!), the 
fact that I could have d3d dll symbols availables on the windows box

was the key here, I really missed winedbg to be able to read pdb files :(

After many hours I was able to track down the reason, and to my surprise 
it seems its not wine's fault (for the most of it)

The 'troublesome' vertex are apparently Blended ones on a Mesh setup.

When d3dx9_30 calls ConvertToIndexedBlendedMesh, it calls GetDeviceInfo 
to get the device capabilites, in the end wine returns the

capabilites through IWineD3DImpl_GetDeviceCaps in 
wine/dlls/wined3d/directx.c

Here comes the fun thing, the attribute MaxVertexBlendMatrices in 
D3DCAPS9, from (MSDN):

"Maximum number of matrices that this device can apply when performing 
multimatrix vertex blending. For a given physical device, this

capability may vary across Direct3D devices depending on the parameters 
supplied to IDirect3D9::CreateDevice."

At the moment is set in wine as *pCaps->MaxVertexBlendMatrices = 
GL_LIMITS(blends) which results in a value of 0 (at least in my Linux

computer/build), while under Windows (XPSP2 DX9c) results in a value of 4

d3dx9_30 has a check right after capabilites are returned comparing that 
value with 2, resulting in different code paths for the remaining

of MaxVertexBlendMatrices function, when the value was 0 both Linux and 
Windows (hacking the returned value to be 0) make those odd '0xfe'

vertexes to be inserted (in Linux that makes the models to not be shown, 
in Windows it makes eqgame.exe to crash)

I proceeded then to try to 'hack' wine to return a value of 4, adding 
the line

pCaps->MaxVertexBlendMatrices=0x4;

Before returning from function 
IDirect3DDevice9Impl_GetDeviceCaps(LPDIRECT3DDEVICE9 iface, D3DCAPS9* 
pCaps) at wine/dlls/d3d9/directx.c

The result: MaxVertexBlendMatrices runs the same path as Windows does, 
the odd '0xfe' vertexes are not generated and the models work are

now shown as expected

My apologies for the long post, but I thought it would be handy to tell 
the full story to justify calling your atention on this

- d3dx9_30 ConvertToIndexedBlendedMesh shows an 'odd' behavior when 
MaxVertexBlendMatrices capabilites in D3DCAPS9 is 0
- Is wine reporting the right value for MaxVertexBlendMatrices ??? As it 
seems the game works flawlesly in wine when it's hacked to be 4

(I don't know if this 'hack' would affect other programs in any other way




From ucldb at wanadoo.es  Sat Feb  9 08:31:14 2008
From: ucldb at wanadoo.es (Julio Fernandez)
Date: Sat, 09 Feb 2008 15:31:14 +0100
Subject: Is wine reporting the right value for MaxVertexBlendMatrices?
Message-ID: <fokdes$ff7$1@ger.gmane.org>

Hi, I don't know if this is the right place to post this, but sorry if 
not, and I'd like to be pointed to the right one

I have been working last weeks on making the game Everquest to work 
under wine, since 0.9.49 it was working flawlesly, but most models were 
not shown properly. This corresponds with bug 
http://bugs.winehq.org/show_bug.cgi?id=8357.

These are my findings:

The main executable is eqgame.exe it typically accesses D3D through a 
custom dll eqgraphicsdx9 which interacts with D3D itself or through 
d3dx9_30.dll

Using channels and adding some extra messages into certain source files 
I got to track a possible reason:

The game was declaring vertex lists with a vertex of type '0xfe' and 
+189 offset

Sadly, I could not get any extra information tracking just from source 
code, so I had to run the game under Windows on a computer and using 
windbg to debug it, while running the same time on another computer the 
game under Debian etch using winedbg to debug, and so tracing both 
programs in assambler (I burnt my eyelashes there!), the fact that I 
could have d3d dll symbols availables on the windows box was the key 
here, I really missed winedbg to be able to read pdb files :(

After many hours I was able to track down the reason, and to my surprise 
it seems its not wine's fault (for the most of it)

The 'troublesome' vertexes are apparently blended ones in mesh declarations.

When d3dx9_30 calls ConvertToIndexedBlendedMesh, it calls GetDeviceInfo 
to get the device capabilites, in the end wine returns the capabilites 
through IWineD3DImpl_GetDeviceCaps in wine/dlls/wined3d/directx.c

Here comes the fun thing, the attribute MaxVertexBlendMatrices in 
D3DCAPS9, from (MSDN):

"Maximum number of matrices that this device can apply when performing 
multimatrix vertex blending. For a given physical device, this 
capability may vary across Direct3D devices depending on the parameters 
supplied to IDirect3D9::CreateDevice."

At the moment is set in wine as *pCaps->MaxVertexBlendMatrices = 
GL_LIMITS(blends) which results in a value of 0 (at least in my Linux 
computer/build), while under Windows (XPSP2 DX9c) results in a value of 4

d3dx9_30 has a check right after the capabilites are returned comparing 
that value with 2, resulting in different code paths for the remaining 
of MaxVertexBlendMatrices function, when the value was 0 both Linux and 
Windows (hacking the returned value to be 0) make those odd '0xfe' 
vertexes to be inserted (in Linux that makes the models to not be shown, 
in Windows it makes eqgame.exe to crash)

I proceeded then to try to 'hack' wine to return a value of 4, adding 
the line

pCaps->MaxVertexBlendMatrices=0x4;

Before returning from function 
IDirect3DDevice9Impl_GetDeviceCaps(LPDIRECT3DDEVICE9 iface, D3DCAPS9* 
pCaps) at wine/dlls/d3d9/directx.c

The result: MaxVertexBlendMatrices runs the same path as Windows does, 
the odd '0xfe' vertexes are not generated and the models work are now 
shown as expected

My apologies for the long post, but I thought it would be handy to tell 
the full story to justify calling your atention on this


- d3dx9_30 ConvertToIndexedBlendedMesh shows an 'odd' behavior when 
MaxVertexBlendMatrices capabilites in D3DCAPS9 is 0

- Is wine reporting the right value for MaxVertexBlendMatrices ??? As it 
seems the game works flawlesly in wine when it's hacked to be 4 (I don't 
know if this 'hack' would affect other programs in any other way




From ucldb at wanadoo.es  Sat Feb  9 09:42:04 2008
From: ucldb at wanadoo.es (Julio Fernandez)
Date: Sat, 09 Feb 2008 16:42:04 +0100
Subject: Is wine reporting the right value for MaxVertexBlendMatrices ?
Message-ID: <fokhjm$r7j$1@ger.gmane.org>

Hi, I don't know if this is the right place to post this, but sorry if 
not, and I'd like to be pointed to the right one

I have been working last weeks on making the game Everquest to work 
under wine, since 0.9.49 it was working flawlesly, but most models were 
not shown properly. This corresponds with bug 
http://bugs.winehq.org/show_bug.cgi?id=8357.

These are my findings:

The main executable is eqgame.exe, it typically accesses D3D through a 
custom dll eqgraphicsdx9 which interacts with D3D itself or through 
d3dx9_30.dll

Using channels and adding some extra messages into certain source files 
I got to track a possible reason:

The game was declaring vertex lists with vertex of type '0xfe' and +189 
offset

Sadly, I could not get any extra information tracking just from source 
code, so I had to run the game under Windows on a computer and using 
windbg to debug it, while running at the same time on another computer 
the game under Debian etch using winedbg to debug, and so tracing both 
programs in assembler (I've burnt my eyelashes there!), the fact that I 
could have d3d dll symbols availables on the windows box was the key 
here, I really missed winedbg was able to read pdb files :(

After many hours I was able to track down the reason, and to my surprise 
it seems it's not wine's fault (for the most of it)

The 'troublesome' vertex are apparently Blended ones on a Mesh setup.

When d3dx9_30 calls ConvertToIndexedBlendedMesh, it calls GetDeviceInfo 
to get the device capabilites, in the end wine returns the capabilites 
through IWineD3DImpl_GetDeviceCaps in wine/dlls/wined3d/directx.c

Here comes the fun thing, for the attribute MaxVertexBlendMatrices in 
D3DCAPS9, from (MSDN):

"Maximum number of matrices that this device can apply when performing 
multimatrix vertex blending. For a given physical device, this 
capability may vary across Direct3D devices depending on the parameters 
supplied to IDirect3D9::CreateDevice."

At the moment is set in wine as *pCaps->MaxVertexBlendMatrices = 
GL_LIMITS(blends) which results in a value of 0 (at least in my Linux 
computer/build), while under Windows (XPSP2 DX9c) results in a value of 4

d3dx9_30 has a check right after capabilites are returned comparing that 
value with 2, resulting in different code paths for the remaining of 
MaxVertexBlendMatrices function, when the value was 0 both Linux and 
Windows (hacking the returned value to be 0) make those odd '0xfe' 
vertexes to be inserted (in Linux that makes the models not to be shown, 
in Windows it makes eqgame.exe to crash)

I proceeded then to try to 'hack' wine to return a value of 4, adding 
the line

pCaps->MaxVertexBlendMatrices=0x4;

Before returning from function 
IDirect3DDevice9Impl_GetDeviceCaps(LPDIRECT3DDEVICE9 iface, D3DCAPS9* 
pCaps) at wine/dlls/d3d9/directx.c

The result: MaxVertexBlendMatrices runs the same path as Windows does, 
the odd '0xfe' vertexes are not generated and the models are now shown 
as expected

My apologies for the long post, but I thought it would be handy to tell 
the full story to justify calling your atention on this

- d3dx9_30 ConvertToIndexedBlendedMesh shows an 'odd' behavior when 
MaxVertexBlendMatrices capabilites in D3DCAPS9 is 0
- Is wine reporting the right value for MaxVertexBlendMatrices ??? As it 
seems the game works flawlesly in wine when it's hacked to be 4 (I don't 
know if this 'hack' would affect other programs in any other way




From ucldb at wanadoo.es  Sat Feb  9 10:30:40 2008
From: ucldb at wanadoo.es (Julio Fernandez)
Date: Sat, 9 Feb 2008 16:30:40 +0000 (UTC)
Subject: Is wine reporting the right value for MaxVertexBlendMatrices ?
Message-ID: <loom.20080209T162831-776@post.gmane.org>

Hi, I don't know if this is the right place to post this, but sorry if not, and
I'd like to be pointed to the right one

I have been working last weeks on making the game Everquest to work under wine,
since 0.9.49 it was working flawlesly, but most models were not shown properly.
This corresponds with bug http://bugs.winehq.org/show_bug.cgi?id=8357

These are my findings:

The main executable is eqgame.exe it typically accesses D3D through a custom dll
eqgraphicsdx9 which interacts with D3D itself or through d3dx9_30.dll

Using channels and adding some extra messages into certain source files I got to
track a possible reason:

The game was declaring vertex lists with a vertex of type '0xfe' and +189 offset

Sadly, I could not get any extra information tracking just from source code, so
I had to run the game under Windows on a computer and using windbg to debug it,
while running the same time on another computer the game under Debian etch using
winedbg to debug, and so tracing both programs in assambler (I burnt my
eyelashes there!), the fact that I could have d3d dll symbols availables on the
windows box was the key here, I really missed winedbg to be able to read pdb
files :(

After many hours I was able to track down the reason, and to my surprise it
seems its not wine's fault (for the most of it)

The 'troublesome' vertex are apparently Blended ones on a Mesh setup.

When d3dx9_30 calls ConvertToIndexedBlendedMesh, it calls GetDeviceInfo to get
the device capabilites, in the end wine returns the capabilites through
IWineD3DImpl_GetDeviceCaps in wine/dlls/wined3d/directx.c

Here comes the fun thing, the attribute MaxVertexBlendMatrices in D3DCAPS9, from
(MSDN):

"Maximum number of matrices that this device can apply when performing
multimatrix vertex blending. For a given physical device, this capability may
vary across Direct3D devices depending on the parameters supplied to
IDirect3D9::CreateDevice."

At the moment is set in wine as *pCaps->MaxVertexBlendMatrices =
GL_LIMITS(blends) which results in a value of 0 (at least in my Linux
computer/build), while under Windows (XPSP2 DX9c) results in a value of 4

d3dx9_30 has a check right after capabilites are returned comparing that value
with 2, resulting in different code paths for the remaining of
MaxVertexBlendMatrices function, when the value was 0 both Linux and Windows
(hacking the returned value to be 0) make those odd '0xfe' vertexes to be
inserted (in Linux that makes the models to not be shown, in Windows it makes
eqgame.exe to crash)

I proceeded then to try to 'hack' wine to return a value of 4, adding the line

pCaps->MaxVertexBlendMatrices=0x4;

Before returning from function
IDirect3DDevice9Impl_GetDeviceCaps(LPDIRECT3DDEVICE9 iface, D3DCAPS9* pCaps) at
wine/dlls/d3d9/directx.c

The result: MaxVertexBlendMatrices runs the same path as Windows does, the odd
'0xfe' vertexes are not generated and the models work are now shown as expected

My apologies for the long post, but I thought it would be handy to tell the full
story to justify calling your atention on this

- d3dx9_30 ConvertToIndexedBlendedMesh shows an 'odd' behavior when
MaxVertexBlendMatrices capabilites in D3DCAPS9 is 0
- Is wine reporting the right value for MaxVertexBlendMatrices ??? As it seems
the game works flawlesly in wine when it's hacked to be 4 (I don't know if this
'hack' would affect other programs in any other way



From wine-devel at kievinfo.com  Sat Feb  9 13:05:28 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 09 Feb 2008 12:05:28 -0700
Subject: Is wine reporting the right value for MaxVertexBlendMatrices
 ?
In-Reply-To: <fokf6d$jot$1@ger.gmane.org>
References: <fokf6d$jot$1@ger.gmane.org>
Message-ID: <47ADF978.6040200@kievinfo.com>


Julio Fernandez wrote:
> Hi, I don't know if this is the right place to post this, but sorry if 
> not, and I'd like to be pointed to the right one

Please one message is enough! And please do not cross post! The bugzilla 
and/or wine-devel is enough.

What you failed to specify is your video card and driver version you are using.

Otherwise thanks for analysis this indeed should let someone who knows the 
area fix it or have a better explanation to what is going on.

Vitaliy


From stefan at codeweavers.com  Sat Feb  9 13:25:30 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 9 Feb 2008 20:25:30 +0100
Subject: Is wine reporting the right value for MaxVertexBlendMatrices ?
In-Reply-To: <fokf6d$jot$1@ger.gmane.org>
References: <fokf6d$jot$1@ger.gmane.org>
Message-ID: <200802092025.30711.stefan@codeweavers.com>

Am Samstag, 9. Februar 2008 16:00:51 schrieb Julio Fernandez:
> At the moment is set in wine as *pCaps->MaxVertexBlendMatrices =
> GL_LIMITS(blends) which results in a value of 0 (at least in my Linux
>
> computer/build), while under Windows (XPSP2 DX9c) results in a value of 4
What we return depends on the features of the OpenGL implementation. If 
GL_ARB_vertex_blend is not supported, we return 0, otherwise we return the 
limited reported to us by OpenGL, which is 4 on implementations that support 
it.

That said, GL_ARB_vertex_blend is not very common. Only MacOS supports it, and 
it is software emulated there. The Linux ATI driver used to support it until 
ATI switched to a different codebase. So this constant ends up beeing 0 
almost everywhere. The extension was dropped in favor of vertex programs, 
since vertex programs appeared shortly after vertex blending and no gl app 
was using it at this time. On Windows drivers emulate vertex blending using 
vertex shaders.

I am not sure if 0 is the correct value to return in case of no vertex 
blending support. What happens if you set it to 1? 1 would be a reasonable 
default as well, because we're still able to transform vertices with one 
matrix(ie, unblened transformation). It could also be that this game silently 
expects vertex blending to be supported: For one part, all dx8+ cards support 
this feature on Windows, and on older cards Windows has software vertex 
processing which can perform blending in a slow, but working fashion.

I have a patch for software emulated vertex blending somewhere, but I dropped 
it because I didn't come across an app which uses this function. Maybe its 
time to revive it, and continue the work on a fixed function replacement 
shader.


From ucldb at wanadoo.es  Sat Feb  9 15:19:35 2008
From: ucldb at wanadoo.es (Julio Fernandez)
Date: Sat, 09 Feb 2008 22:19:35 +0100
Subject: Is wine reporting the right value for MaxVertexBlendMatrices
 ?
In-Reply-To: <200802092025.30711.stefan@codeweavers.com>
References: <fokf6d$jot$1@ger.gmane.org>
	<200802092025.30711.stefan@codeweavers.com>
Message-ID: <fol5cf$tl9$1@ger.gmane.org>

First my deep apologize for the multiple/double post, I am not too used 
to post on news and I was not seeing my posts so I though they were 
getting 'lost' somewhere

As for system specs I run 2x Geforce 7900GS on SLI configuration with 
Nvidia 169.07 driver, x64 architecture, Debian etch, XOrg 7.1.1


Stefan D?singer escribi?:

> I am not sure if 0 is the correct value to return in case of no vertex 
> blending support. What happens if you set it to 1? 1 would be a reasonable 
> default as well, because we're still able to transform vertices with one 
> matrix(ie, unblened transformation). It could also be that this game silently 
> expects vertex blending to be supported: For one part, all dx8+ cards support 
> this feature on Windows, and on older cards Windows has software vertex 
> processing which can perform blending in a slow, but working fashion.

1 won't work as d3dx9_30 does <2 (or <=2, I cant rememeber the exact asm 
comparison) check against the returned value so both 0 and 1 will work 
the same way

The game made a requirement to have DX9c many months ago

The odd part of it all is the own d3dx9_30 declaring type '0xfe' 
vertexes and odd offsets when receiving a 0 as value


On a side note, what's the status of 2.0 and 1.4 shaders in wine?
wine reports

fixme:d3d:IWineD3DDeviceImpl_CreateVertexBuffer Out of memory!

trying to

D3DCREATERESOURCEOBJECTINSTANCE(object, VertexBuffer, 
WINED3DRTYPE_VERTEXBUFFER, Size)

when loading data from some zones, and then freezing the screen 
(although the rest of wine and the game keeps running in the background)




From marco at mandrivaclub.nl  Sat Feb  9 17:17:51 2008
From: marco at mandrivaclub.nl (marco)
Date: Sun, 10 Feb 2008 00:17:51 +0100
Subject: gecko download not robust?  
Message-ID: <47AE349F.7040605@mandrivaclub.nl>

>
> Hmm.  gecko download hung for me once.  I saw
> fixme:urlmon:ProtocolStream_Read Read failed: 800c0008
> in the log, which makes me wonder if our download code
> doesn't handle transient network errors well.
>
> Time to get rid of the download, and just bundle gecko outright, I say...

I make the mandriva rpms for wine.
This would make the rpms 30% bigger.
And you would download the same gecko binary over and over again with 
every new version.

But if that is not a problem than it can be easily done.





From austinenglish at gmail.com  Sat Feb  9 21:55:53 2008
From: austinenglish at gmail.com (Austin English)
Date: Sat, 9 Feb 2008 21:55:53 -0600
Subject: gecko download not robust?
In-Reply-To: <47AE349F.7040605@mandrivaclub.nl>
References: <47AE349F.7040605@mandrivaclub.nl>
Message-ID: <b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>

On Feb 9, 2008 5:17 PM, marco <marco at mandrivaclub.nl> wrote:
>
> >
> > Hmm.  gecko download hung for me once.  I saw
> > fixme:urlmon:ProtocolStream_Read Read failed: 800c0008
> > in the log, which makes me wonder if our download code
> > doesn't handle transient network errors well.
> >
> > Time to get rid of the download, and just bundle gecko outright, I say...
>
> I make the mandriva rpms for wine.
> This would make the rpms 30% bigger.
> And you would download the same gecko binary over and over again with
> every new version.
>
> But if that is not a problem than it can be easily done.
>
>

Why not have package maintainers package gecko like most do
development files. So you could have for example on ubuntu:
$ sudo apt-get install wine wine-dev wine-gecko

Where wine-gecko wouldn't have to be upgraded very often.

-Austin


From awj_in_japan at hotmail.com  Sat Feb  9 23:34:49 2008
From: awj_in_japan at hotmail.com (Alex Jackson)
Date: Sun, 10 Feb 2008 00:34:49 -0500
Subject: Is wine reporting the right value for MaxVertexBlendMatrices ?
In-Reply-To: <mailman.590.1202602602.2884.wine-devel@winehq.org>
References: <mailman.590.1202602602.2884.wine-devel@winehq.org>
Message-ID: <BAY123-W33B7DBA6C08A7B6D54EC35C0290@phx.gbl>


> That said, GL_ARB_vertex_blend is not very common. Only MacOS supports it, and 
> it is software emulated there. The Linux ATI driver used to support it until 
> ATI switched to a different codebase. So this constant ends up beeing 0 
> almost everywhere. The extension was dropped in favor of vertex programs, 
> since vertex programs appeared shortly after vertex blending and no gl app 
> was using it at this time. On Windows drivers emulate vertex blending using 
> vertex shaders.
> 
> I am not sure if 0 is the correct value to return in case of no vertex 
> blending support. What happens if you set it to 1? 1 would be a reasonable 
> default as well, because we're still able to transform vertices with one 
> matrix(ie, unblened transformation). It could also be that this game silently 
> expects vertex blending to be supported: For one part, all dx8+ cards support 
> this feature on Windows, and on older cards Windows has software vertex 
> processing which can perform blending in a slow, but working fashion.
> 
> I have a patch for software emulated vertex blending somewhere, but I dropped 
> it because I didn't come across an app which uses this function. Maybe its 
> time to revive it, and continue the work on a fixed function replacement 
> shader.


Even on Windows, no OpenGL implementation that I know of supports GL_ARB_vertex_blend other than ATI's (and as you've pointed out, the new OpenGL stack that the Radeon HD's use on Windows and that all Radeons now use on Linux has dropped it).


History lesson:  Both GL_ARB_vertex_blend and D3D vertex blending are historically tied to a specific piece of hardware: the original ATI Radeon (GL_ARB_vertex_blend started out as GL_ATI_vertex_blend).  Presumably, due to ATI's historically spotty OpenGL driver performance (okay, "historically" is being kind to ATI), any game developer who wanted to use the Radeon's capabilities targeted their game for D3D rather than OpenGL.   Consequently, when nVidia released the GeForce 3 (the first video card with vertex shaders) they did implement D3D vertex blending via shaders in their D3D driver (since games were using it, and it wouldn't do if the "new" GF3 couldn't handle effects that the "old" Radeon could), but they didn't bother to implement it in their OpenGL driver, even though ATI had gotten it ARB-approved some months before the GF3 came out,  since no games/apps were using it.  The other video hardware makers (the few that were left by the DX8 era) followed NV's example: implement D3D vertex blending via shaders or in software (for entry-level and onboard hardware without vertex shaders), but don't bother with GL_ARB_vertex_blend since no one uses it.

The upshot is that GL_ARB_vertex_blend is an ARB extension In Name Only; it's effectively ATI-only--and even ATI has abandoned it now.  On the other hand, D3D vertex blending is universally available on modern and semi-modern hardware regardless of maker, and it looks like even some D3D9 games still use it instead of using vertex shaders.  So it's better for WINE to implement vertex blending via vertex programs rather than depending on GL_ARB_vertex_blend.

--AWJ--

_________________________________________________________________

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080210/ccd04a61/attachment.htm 

From ucldb at wanadoo.es  Sun Feb 10 04:27:22 2008
From: ucldb at wanadoo.es (Julio Fernandez)
Date: Sun, 10 Feb 2008 11:27:22 +0100
Subject: Is wine reporting the right value for MaxVertexBlendMatrices
 ?
In-Reply-To: <BAY123-W33B7DBA6C08A7B6D54EC35C0290@phx.gbl>
References: <mailman.590.1202602602.2884.wine-devel@winehq.org>
	<BAY123-W33B7DBA6C08A7B6D54EC35C0290@phx.gbl>
Message-ID: <fomjhg$3s8$1@ger.gmane.org>

Alex Jackson escribi?:
>  > That said, GL_ARB_vertex_blend is not very common. Only MacOS 
> supports it, and
>  > it is software emulated there. The Linux ATI driver used to support 
> it until
>  > ATI switched to a different codebase. So this constant ends up beeing 0
>  > almost everywhere. The extension was dropped in favor of vertex 
> programs,
>  > since vertex programs appeared shortly after vertex blending and no 
> gl app
>  > was using it at this time. On Windows drivers emulate vertex blending 
> using
>  > vertex shaders.
>  >
>  > I am not sure if 0 is the correct value to return in case of no vertex
>  > blending support. What happens if you set it to 1? 1 would be a 
> reasonable
>  > default as well, because we're still able to transform vertices with one
>  > matrix(ie, unblened transformation). It could also be that this game 
> silently
>  > expects vertex blending to be supported: For one part, all dx8+ cards 
> support
>  > this feature on Windows, and on older cards Windows has software vertex
>  > processing which can perform blending in a slow, but working fashion.
>  >
>  > I have a patch for software emulated vertex blending somewhere, but I 
> dropped
>  > it because I didn't come across an app which uses this function. 
> Maybe its
>  > time to revive it, and continue the work on a fixed function replacement
>  > shader.
> 
> Even on Windows, no OpenGL implementation that I know of supports 
> GL_ARB_vertex_blend other than ATI's (and as you've pointed out, the new 
> OpenGL stack that the Radeon HD's use on Windows and that all Radeons 
> now use on Linux has dropped it).
> 
> History lesson:  Both GL_ARB_vertex_blend and D3D vertex blending are 
> historically tied to a specific piece of hardware: the original ATI 
> Radeon (GL_ARB_vertex_blend started out as GL_ATI_vertex_blend).  
> Presumably, due to ATI's historically spotty OpenGL driver performance 
> (okay, "historically" is being kind to ATI), any game developer who 
> wanted to use the Radeon's capabilities targeted their game for D3D 
> rather than OpenGL.   Consequently, when nVidia released the GeForce 3 
> (the first video card with vertex shaders) they did implement D3D vertex 
> blending via shaders in their D3D driver (since games were using it, and 
> it wouldn't do if the "new" GF3 couldn't handle effects that the "old" 
> Radeon could), but they didn't bother to implement it in their OpenGL 
> driver, even though ATI had gotten it ARB-approved some months before 
> the GF3 came out, since no games/apps were using it.  The other video 
> hardware makers (the few that were left by the DX8 era) followed NV's 
> example: implement D3D vertex blending via shaders or in software (for 
> entry-level and onboard hardware without vertex shaders), but don't 
> bother with GL_ARB_vertex_blend since no one uses it.
> 
> The upshot is that GL_ARB_vertex_blend is an ARB extension In Name Only; 
> it's effectively ATI-only--and even ATI has abandoned it now.  On the 
> other hand, D3D vertex blending is universally available on modern and 
> semi-modern hardware regardless of maker, and it looks like even some 
> D3D9 games still use it instead of using vertex shaders.  So it's better 
> for WINE to implement vertex blending via vertex programs rather than 
> depending on GL_ARB_vertex_blend.
> 
> --AWJ--
> 
> ------------------------------------------------------------------------
> 
> 
> ------------------------------------------------------------------------
> 
> 
I am a bit lost now, but then, for a fast recap:

1- Theres some programs that call ConvertToIndexedBlendedMesh at 
d3d9x_30.dll
2- wine returns (from opengl) MaxVertexBlendMatrices=0
3- d3d9x_30.dll misbehaves and generates vertex declarations with odd 
type codes and offsets when MaxVertexBlendMatrices=0
4- when we hack wine at IDirect3DDevice9Impl_GetDeviceCaps to return 4 
d3d9x_30.dll works properly and the programs run right

So my question is: is there any reason to not have wine return 
MaxVertexBlendMatrices=4 (as it works regardless of what opengl 
reports), and if so is it any other way for people willing to use some 
programs (like Everquest) to 'hack' it's value than modify 
IDirect3DDevice9Impl_GetDeviceCaps manually to make it return 4




From stefan at codeweavers.com  Sun Feb 10 06:10:10 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 10 Feb 2008 13:10:10 +0100
Subject: Is wine reporting the right value for MaxVertexBlendMatrices ?
In-Reply-To: <fomjhg$3s8$1@ger.gmane.org>
References: <mailman.590.1202602602.2884.wine-devel@winehq.org>
	<BAY123-W33B7DBA6C08A7B6D54EC35C0290@phx.gbl>
	<fomjhg$3s8$1@ger.gmane.org>
Message-ID: <200802101310.10973.stefan@codeweavers.com>

Am Sonntag, 10. Februar 2008 11:27:22 schrieb Julio Fernandez:
> So my question is: is there any reason to not have wine return
> MaxVertexBlendMatrices=4 (as it works regardless of what opengl
> reports), and if so is it any other way for people willing to use some
> programs (like Everquest) to 'hack' it's value than modify
> IDirect3DDevice9Impl_GetDeviceCaps manually to make it return 4
Returning 4 makes Everquest happy, but will break other apps.

I think the only way to fix this properly is to complete Henri's fixed 
function pipeline replacement shader in order to implemen vertex blending 
using shaders. This is major task unfortunately.


From dmitry at codeweavers.com  Sun Feb 10 07:04:26 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 10 Feb 2008 21:04:26 +0800
Subject: pdh[3:3]: remove unnecessary tests done in
	PdhLookupPerfNameByIndexW
References: <47AEA473.5040402@yless4u.com.au>
Message-ID: <007701c86be5$78a39b50$a600fea9@DMITRY>

"Jeff Latimer" <lats at yless4u.com.au> wrote:

> --- a/dlls/pdh/pdh_main.c
> +++ b/dlls/pdh/pdh_main.c
> @@ -837,14 +837,7 @@ PDH_STATUS WINAPI PdhLookupPerfNameByIndexA( LPCSTR machine, DWORD index, LPSTR
> 
>     TRACE("%s %d %p %p\n", debugstr_a(machine), index, buffer, size);
> 
> -    if (machine)
> -    {
> -        FIXME("remote machine not supported\n");
> -        return PDH_CSTATUS_NO_MACHINE;
> -    }
> -
>     if (!buffer || !size) return PDH_INVALID_ARGUMENT;
> -    if (!index) return ERROR_SUCCESS;

Changelog mentions PdhLookupPerfNameByIndexW by the change is in PdhLookupPerfNameByIndexA.
Why are you removing the checks in one place by leave the same in other one? Why the tests
are unnecessary?

-- 
Dmitry.


From stefan at codeweavers.com  Sun Feb 10 10:53:34 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 10 Feb 2008 17:53:34 +0100
Subject: WineD3D: split framebuffer -> texture path from LoadLocation
In-Reply-To: <20080210163725.41430@gmx.net>
References: <20080210163725.41430@gmx.net>
Message-ID: <200802101753.35074.stefan@codeweavers.com>

Am Sonntag, 10. Februar 2008 17:37:25 schrieb Roderick Colenbrander:
> Hi,
>
> This patch puts the framebuffer -> texture from LoadLocation in a separate
> function in a similar way to read_from_framebuffer. It borrows some code
> from LoadLocation and read_from_framebuffer.
>
> Regards,
> Roderick Colenbrander
You're mixing tabs and spaces in this patch


From joseph_d_stein at yahoo.com  Sun Feb 10 11:51:04 2008
From: joseph_d_stein at yahoo.com (Joseph Stein)
Date: Sun, 10 Feb 2008 09:51:04 -0800 (PST)
Subject: ? on Repositories for Unaccept Patches and (work in Progress).
Message-ID: <911927.81304.qm@web36907.mail.mud.yahoo.com>

Is there a Git Repositories for Unaccept Patches or (work in Progress)?

If not (which i think is the case and why I posting here instead of the user mailing list.), could you create one(along with a text file explain what need to be done to be accepted)?



Here are some reason I think It is Needed.

1.)  It would allow developer and users  to see what the source done.

I have read a very good article about usb support in wine an winehq.org here 

http://www.winehq.org/?issue=331

wich said that 

>An ntoskrnl.exe was written a couple of years ago to load drivers, >specifically the Safedisc Windows kernel driver, but it still hasn't been >accepted.  Apparently there's some low-level internal Wine issues >and Alexandre wants those fixed before accepting the patch.

 
2.) Allow people two git  possibly some things work that would other wise not work.

using the patch for ntoskrnl.exe  that was not accept as an example, (please correct me if i wrong), could possible git some drivers working (usb  driver may be?) program to work.  which is currently not possible with wine from what i read.

Yes It dose cause other wine problem which is not big deal, if you compile and run wine form the source directory from which it is compiled instead of installing it (the multiple wine install way).

In other words you code use the patch version of wine just for the  program that need the patch to work .(Is it not better to have a broken wine (with partal diver) support, then a stable wine with-out (partal diver) support when  The program you are running requires a driver.)

3.)If done right  in my humble opinion  would help prevent developer from getting discurage becuase all there work has be chuck out the window.

Giving more Light to what i said above,   What I mean buy  "if done right",Is that if a developer(who is looking for something to do) would go look at what patches Have not be accepted (but have almost all basic done) and help the developer git it accepted ,Would 
in my humble opinion encourage  more developer to join which is need for a complicated project such as wine.

Basically  threat unaccepted patch as bugs(while keeping the patch out of wine), instead of chucking it out the window.

This type of thing is done in boost  project i be-leave, but I taking it one step further and asking for a text file on "what need to be done to be include which each unaccepted patches".


Thank you for any reply, 

Please forgive me if I got any of what i said above wrong,  I'm not a real good developer and only have a real basic idea of wine and have not work on wine because it to confusing to me(but have download and looked at from git Repositories) 

       
---------------------------------
Be a better friend, newshound, and know-it-all with Yahoo! Mobile.  Try it now.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080210/214cfa3b/attachment-0001.htm 

From lats at yless4u.com.au  Sun Feb 10 12:36:02 2008
From: lats at yless4u.com.au (Jeff Latimer)
Date: Mon, 11 Feb 2008 05:36:02 +1100
Subject: pdh[3:3]: remove unnecessary tests done in
	PdhLookupPerfNameByIndexW
In-Reply-To: <007701c86be5$78a39b50$a600fea9@DMITRY>
References: <47AEA473.5040402@yless4u.com.au>
	<007701c86be5$78a39b50$a600fea9@DMITRY>
Message-ID: <47AF4412.3020201@yless4u.com.au>

Dmitry Timoshkov wrote:
> "Jeff Latimer" <lats at yless4u.com.au> wrote:
>
>> --- a/dlls/pdh/pdh_main.c
>> +++ b/dlls/pdh/pdh_main.c
>> @@ -837,14 +837,7 @@ PDH_STATUS WINAPI PdhLookupPerfNameByIndexA( 
>> LPCSTR machine, DWORD index, LPSTR
>>
>>     TRACE("%s %d %p %p\n", debugstr_a(machine), index, buffer, size);
>>
>> -    if (machine)
>> -    {
>> -        FIXME("remote machine not supported\n");
>> -        return PDH_CSTATUS_NO_MACHINE;
>> -    }
>> -
>>     if (!buffer || !size) return PDH_INVALID_ARGUMENT;
>> -    if (!index) return ERROR_SUCCESS;
>
> Changelog mentions PdhLookupPerfNameByIndexW by the change is in 
> PdhLookupPerfNameByIndexA.
> Why are you removing the checks in one place by leave the same in 
> other one? Why the tests
> are unnecessary?
>
The parameters, bufferW and sizeW passed by PdhLookupPerfNameByIndexA to 
PdhLookupPerfNameByIndexW are  local to PdhLookupPerfNameByIndexA.  The 
test is needed still in PdhLookupPerfNameByIndexA because the size and 
buffer are not passed but still need to be checked.

Jeff


From jacek at codeweavers.com  Sun Feb 10 12:44:14 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Sun, 10 Feb 2008 19:44:14 +0100
Subject: gecko download not robust?
In-Reply-To: <a71bd89a0802090830vac3eb0aq7c607999354ddef6@mail.gmail.com>
References: <a71bd89a0802090830vac3eb0aq7c607999354ddef6@mail.gmail.com>
Message-ID: <47AF45FE.4050500@codeweavers.com>

Dan Kegel wrote:
> Hmm.  gecko download hung for me once.  I saw
> fixme:urlmon:ProtocolStream_Read Read failed: 800c0008
> in the log, which makes me wonder if our download code
> doesn't handle transient network errors well.
>   

It looks like urlmon bug. Our Gecko downloader is also not really 
finished yet as its developing process stopped when it started to work. 
BTW, as a side effect, my current work on urlmon will allow us to 
improve the Gecko downloader a bit.

> Time to get rid of the download, and just bundle gecko outright, I say...
>   

 I'd agree, but we need Gecko packages. AFAIK only Gentoo supports it ATM.


Thanks,
    Jacek



From dank at kegel.com  Sun Feb 10 12:55:28 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 10 Feb 2008 10:55:28 -0800
Subject: Is there a Git Repositories for Unaccept Patches or (work in
	Progress)?
Message-ID: <a71bd89a0802101055m2d97cefaw7612fab9e1851fed@mail.gmail.com>

Joeseph wrote:
> Is there a Git Repositories for Unaccept Patches or (work in Progress)?

Not really, but people often attach patches to bugzilla
entries if they're not quite good enough to submit.
And if anybody wants to start such a git repository,
more power to them.

>An ntoskrnl.exe was written a couple of years ago to load drivers,
>specifically the Safedisc Windows kernel driver,
> but it still hasn't been accepted.

The article you read is out of date; ntoskrnl.exe is now part of wine.

> Basically  threat unaccepted patch as bugs(while keeping the patch out of wine), instead of chucking it out the window.

As I said above, developers are free to attach patches to bug reports.

What you're really trying to get at is: sometimes developers
get discouraged at how hard it is to get patches into Wine.
But no mechanical aid will really help there.  The only cure
is persistance on the part of the developer, and assistance
(chiefly good feedback) from other Wine developers.
After a developer gets a few patches committed, the
wine process starts to feel a lot smoother.
- Dan

-- 
Wine for Windows ISVs: http://kegel.com/wine/isv


From thunderbird2k at gmx.net  Sun Feb 10 13:20:20 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 10 Feb 2008 20:20:20 +0100
Subject: WineD3D: split framebuffer -> texture path from LoadLocation
In-Reply-To: <200802101753.35074.stefan@codeweavers.com>
References: <20080210163725.41430@gmx.net>
	<200802101753.35074.stefan@codeweavers.com>
Message-ID: <20080210192020.286910@gmx.net>

> > Hi,
> >
> > This patch puts the framebuffer -> texture from LoadLocation in a
> separate
> > function in a similar way to read_from_framebuffer. It borrows some code
> > from LoadLocation and read_from_framebuffer.
> >
> > Regards,
> > Roderick Colenbrander
> You're mixing tabs and spaces in this patch
> 

I already feared so. For some reason Kate from KDE 4.0.0/4.0.1 doesn't show tabulators for me which makes this a hell. I'll see what I can do about it.

Roderick
-- 
GMX FreeMail: 1 GB Postfach, 5 E-Mail-Adressen, 10 Free SMS.
Alle Infos und kostenlose Anmeldung: http://www.gmx.net/de/go/freemail


From thunderbird2k at gmx.net  Sun Feb 10 13:20:20 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 10 Feb 2008 20:20:20 +0100
Subject: WineD3D: split framebuffer -> texture path from LoadLocation
In-Reply-To: <200802101753.35074.stefan@codeweavers.com>
References: <20080210163725.41430@gmx.net>
	<200802101753.35074.stefan@codeweavers.com>
Message-ID: <20080210192020.286910@gmx.net>

> > Hi,
> >
> > This patch puts the framebuffer -> texture from LoadLocation in a
> separate
> > function in a similar way to read_from_framebuffer. It borrows some code
> > from LoadLocation and read_from_framebuffer.
> >
> > Regards,
> > Roderick Colenbrander
> You're mixing tabs and spaces in this patch
> 

I already feared so. For some reason Kate from KDE 4.0.0/4.0.1 doesn't show tabulators for me which makes this a hell. I'll see what I can do about it.

Roderick
-- 
GMX FreeMail: 1 GB Postfach, 5 E-Mail-Adressen, 10 Free SMS.
Alle Infos und kostenlose Anmeldung: http://www.gmx.net/de/go/freemail


From truiken at gmail.com  Sun Feb 10 15:16:19 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 10 Feb 2008 15:16:19 -0600
Subject: Implemented a stub for MsiSetExternalUIRecord in msi.dll
In-Reply-To: <d04858af0802101111n297bc7cend0a00db54a1af73a@mail.gmail.com>
References: <d04858af0802101111n297bc7cend0a00db54a1af73a@mail.gmail.com>
Message-ID: <22821af30802101316i3a0821en39c4773d84b9c675@mail.gmail.com>

On Feb 10, 2008 1:11 PM, Luke Benstead <kazade at gmail.com> wrote:
> This unimplemented function causes the .NET framework 3.0 installer to fail
> (and also Visual C++ express 8.0) with this patch the installer continues
> further before crashing. This is my first ever patch on Wine (and working
> with GIT) so I'm sure I've done something wrong, if so I apologize in
> advance :)
>

> diff --git a/dlls/msi/msi.c b/dlls/msi/msi.c
> index 643f9cc..9fb6906 100644
> --- a/dlls/msi/msi.c
> +++ b/dlls/msi/msi.c
> @@ -992,6 +992,7 @@ end:
>      return state;
>  }
>
> +
>  INSTALLUILEVEL WINAPI MsiSetInternalUI(INSTALLUILEVEL dwUILevel, HWND *phWnd)
>  {
>      INSTALLUILEVEL old = gUILevel;

Random whitespace change -> bad.


> @@ -1008,6 +1009,18 @@ INSTALLUILEVEL WINAPI MsiSetInternalUI(INSTALLUILEVEL dwUILevel, HWND *phWnd)
>      return old;
>  }
>
> +/***********************************************************************
> + * MsiSetExternalUIRecord        [MSI.@]
> + */
> +UINT WINAPI MsiSetExternalUIRecord( INSTALLUI_RECORD_HANDLER puiHandler,
> +									DWORD dwMessageFilter, LPVOID pvContext,
> +  									PINSTALLUI_RECORD_HANDLER ppuiPrevHandler )
> +{
> +	FIXME("%p %08x %p %p",
> +				puiHandler, dwMessageFilter, pvContext, ppuiPrevHandler);
> +	return ERROR_CALL_NOT_IMPLEMENTED;
> +}
> +
>  INSTALLUI_HANDLERA WINAPI MsiSetExternalUIA(INSTALLUI_HANDLERA puiHandler,
>                                    DWORD dwMessageFilter, LPVOID pvContext)
>  {

Used tabs -> bad.

> @@ -2452,3 +2465,5 @@ UINT WINAPI MsiAdvertiseScriptA( LPCSTR szScriptFile, DWORD dwFlags,
>            debugstr_a( szScriptFile ), dwFlags, phRegData, fRemoveItems );
>      return ERROR_CALL_NOT_IMPLEMENTED;
>  }
> +
> +

More random whitespace changes.

> @@ -573,6 +576,7 @@ UINT WINAPI MsiAdvertiseScriptW(LPCWSTR, DWORD, PHKEY, BOOL);
>  UINT WINAPI MsiCloseHandle(MSIHANDLE);
>  UINT WINAPI MsiCloseAllHandles(void);
>  INSTALLUILEVEL WINAPI MsiSetInternalUI(INSTALLUILEVEL, HWND*);
> +UINT WINAPI MsiSetExternalUIRecord( INSTALLUI_RECORD_HANDLER, DWORD, LPVOID, PINSTALLUI_RECORD_HANDLER);

Inconsistent whitespace.  The rest of the file does not have spaces
after parentheses.

-- 
James Hawkins


From thunderbird2k at gmx.net  Sun Feb 10 15:20:42 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 10 Feb 2008 22:20:42 +0100
Subject: WineD3D: split framebuffer -> texture path from LoadLocation [attempt
	2]
In-Reply-To: <20080210192020.286910@gmx.net>
References: <20080210163725.41430@gmx.net>
	<200802101753.35074.stefan@codeweavers.com>
	<20080210192020.286910@gmx.net>
Message-ID: <20080210212042.13850@gmx.net>

Hi,

This is a resubmit from the previous patch without messed up indent.

Regards,
Roderick Colenbrander
-- 
GMX FreeMail: 1 GB Postfach, 5 E-Mail-Adressen, 10 Free SMS.
Alle Infos und kostenlose Anmeldung: http://www.gmx.net/de/go/freemail
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-Add-read_from_framebuffer_texture-which-combines-cod.patch
Type: text/x-patch
Size: 0 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080210/91ce9aae/attachment.bin 

From thunderbird2k at gmx.net  Sun Feb 10 15:20:15 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sun, 10 Feb 2008 22:20:15 +0100
Subject: [PATCH] Add read_from_framebuffer_texture which combines code from read_from_framebuffer (drawpixels) and LoadLocation. This makes the code easier to read and the pieces borrowed from read_from_framebuffer are more correct than the code in LoadLocation.
Message-ID: <mailman.31.1202678857.2881.wine-devel@winehq.org>

---
 dlls/wined3d/surface.c |  116 ++++++++++++++++++++++++++++++++++--------------
 1 files changed, 83 insertions(+), 33 deletions(-)

diff --git a/dlls/wined3d/surface.c b/dlls/wined3d/surface.c
index bd73089..003f031 100644
--- a/dlls/wined3d/surface.c
+++ b/dlls/wined3d/surface.c
@@ -7,9 +7,9 @@
  * Copyright 2002-2003 Raphael Junqueira
  * Copyright 2004 Christian Costa
  * Copyright 2005 Oliver Stieber
- * Copyright 2006-2007 Stefan D?singer for CodeWeavers
+ * Copyright 2006-2007 Stefan D???inger for CodeWeavers
  * Copyright 2007 Henri Verbeet
- * Copyright 2006-2007 Roderick Colenbrander
+ * Copyright 2006-2008 Roderick Colenbrander
  *
  * This library is free software; you can redistribute it and/or
  * modify it under the terms of the GNU Lesser General Public
@@ -35,6 +35,7 @@ WINE_DEFAULT_DEBUG_CHANNEL(d3d_surface);
 
 HRESULT d3dfmt_convert_surface(BYTE *src, BYTE *dst, UINT pitch, UINT width, UINT height, UINT outpitch, CONVERT_TYPES convert, IWineD3DSurfaceImpl *surf);
 static void d3dfmt_p8_init_palette(IWineD3DSurfaceImpl *This, BYTE table[256][4], BOOL colorkey);
+static inline void clear_unused_channels(IWineD3DSurfaceImpl *This);
 
 static void surface_bind_and_dirtify(IWineD3DSurfaceImpl *This) {
     /* Make sure that a proper texture unit is selected, bind the texture
@@ -603,6 +604,7 @@ const void *WINAPI IWineD3DSurfaceImpl_GetData(IWineD3DSurface *iface) {
     return (CONST void*)(This->resource.allocatedMemory);
 }
 
+/* Read the framebuffer back into the surface */
 static void read_from_framebuffer(IWineD3DSurfaceImpl *This, CONST RECT *rect, void *dest, UINT pitch) {
     IWineD3DSwapChainImpl *swapchain;
     IWineD3DDeviceImpl *myDevice = This->resource.wineD3DDevice;
@@ -806,6 +808,79 @@ static void read_from_framebuffer(IWineD3DSurfaceImpl *This, CONST RECT *rect, v
     LEAVE_GL();
 }
 
+/* Read the framebuffer contents into a texture */
+static void read_from_framebuffer_texture(IWineD3DSurfaceImpl *This)
+{
+    IWineD3DDeviceImpl *device = This->resource.wineD3DDevice;
+    IWineD3DSwapChainImpl *swapchain;
+    int bpp;
+    GLenum format, internal, type;
+    CONVERT_TYPES convert;
+    BOOL srcIsUpsideDown;
+    GLint prevRead;
+
+    d3dfmt_get_conv(This, TRUE /* We need color keying */, TRUE /* We will use textures */, &format, &internal, &type, &convert, &bpp, This->srgb);
+
+    IWineD3DSurface_GetContainer((IWineD3DSurface *) This, &IID_IWineD3DSwapChain, (void **)&swapchain);
+    /* Activate the surface. Set it up for blitting now, although not necessarily needed for LockRect.
+     * Certain graphics drivers seem to dislike some enabled states when reading from opengl, the blitting usage
+     * should help here. Furthermore unlockrect will need the context set up for blitting. The context manager will find
+     * context->last_was_blit set on the unlock.
+     */
+    ActivateContext(device, (IWineD3DSurface *) This, CTXUSAGE_BLIT);
+    surface_bind_and_dirtify(This);
+    ENTER_GL();
+
+    glGetIntegerv(GL_READ_BUFFER, &prevRead);
+
+    /* Select the correct read buffer, and give some debug output.
+     * There is no need to keep track of the current read buffer or reset it, every part of the code
+     * that reads sets the read buffer as desired.
+     */
+    if(!swapchain) {
+        /* Locking the primary render target which is not on a swapchain(=offscreen render target).
+         * Read from the back buffer
+         */
+        TRACE("Locking offscreen render target\n");
+        glReadBuffer(device->offscreenBuffer);
+        srcIsUpsideDown = TRUE;
+    } else {
+        GLenum buffer = surface_get_gl_buffer((IWineD3DSurface *) This, (IWineD3DSwapChain *)swapchain);
+        TRACE("Locking %#x buffer\n", buffer);
+        glReadBuffer(buffer);
+        checkGLcall("glReadBuffer");
+
+        IWineD3DSwapChain_Release((IWineD3DSwapChain *) swapchain);
+        srcIsUpsideDown = FALSE;
+    }
+
+    if(!(This->Flags & SFLAG_ALLOCATED)) {
+        surface_allocate_surface(This, internal, This->pow2Width,
+                                 This->pow2Height, format, type);
+    }
+
+    clear_unused_channels(This);
+
+    /* If !SrcIsUpsideDown we should flip the surface.
+     * This can be done using glCopyTexSubImage2D but this
+     * is VERY slow, so don't do that. We should prevent
+     * this code from getting called in such cases or perhaps
+     * we can use FBOs */
+
+    glCopyTexSubImage2D(This->glDescription.target,
+                        This->glDescription.level,
+                        0, 0, 0, 0,
+                        This->currentDesc.Width,
+                        This->currentDesc.Height);
+    checkGLcall("glCopyTexSubImage2D");
+
+    glReadBuffer(prevRead);
+    vcheckGLcall("glReadBuffer");
+
+    LEAVE_GL();
+    TRACE("Updated target %d\n", This->glDescription.target);
+}
+
 static void surface_prepare_system_memory(IWineD3DSurfaceImpl *This) {
     /* Performance optimization: Count how often a surface is locked, if it is locked regularly do not throw away the system memory copy.
      * This avoids the need to download the surface from opengl all the time. The surface is still downloaded if the opengl texture is
@@ -3865,41 +3940,15 @@ static HRESULT WINAPI IWineD3DSurfaceImpl_LoadLocation(IWineD3DSurface *iface, D
                 HeapFree(GetProcessHeap(), 0, mem);
         }
     } else /* if(flag == SFLAG_INTEXTURE) */ {
-        d3dfmt_get_conv(This, TRUE /* We need color keying */, TRUE /* We will use textures */, &format, &internal, &type, &convert, &bpp, This->srgb);
-
-        ActivateContext(device, device->lastActiveRenderTarget, CTXUSAGE_RESOURCELOAD);
-        surface_bind_and_dirtify(This);
-
         if (This->Flags & SFLAG_INDRAWABLE) {
-            GLint prevRead;
+            read_from_framebuffer_texture(This);
+        } else { /* Upload from system memory */
+            d3dfmt_get_conv(This, TRUE /* We need color keying */, TRUE /* We will use textures */, &format, &internal, &type, &convert, &bpp, This->srgb);
 
+            ActivateContext(device, device->lastActiveRenderTarget, CTXUSAGE_RESOURCELOAD);
+            surface_bind_and_dirtify(This);
             ENTER_GL();
-            glGetIntegerv(GL_READ_BUFFER, &prevRead);
-            vcheckGLcall("glGetIntegerv");
-            glReadBuffer(This->resource.wineD3DDevice->offscreenBuffer);
-            vcheckGLcall("glReadBuffer");
-
-            if(!(This->Flags & SFLAG_ALLOCATED)) {
-                surface_allocate_surface(This, internal, This->pow2Width,
-                                            This->pow2Height, format, type);
-            }
 
-            clear_unused_channels(This);
-
-            glCopyTexSubImage2D(This->glDescription.target,
-                                This->glDescription.level,
-                                0, 0, 0, 0,
-                                This->currentDesc.Width,
-                                This->currentDesc.Height);
-            checkGLcall("glCopyTexSubImage2D");
-
-            glReadBuffer(prevRead);
-            vcheckGLcall("glReadBuffer");
-
-            LEAVE_GL();
-
-            TRACE("Updated target %d\n", This->glDescription.target);
-        } else {
             /* The only place where LoadTexture() might get called when isInDraw=1
              * is ActivateContext where lastActiveRenderTarget is preloaded.
              */
@@ -3967,6 +4016,7 @@ static HRESULT WINAPI IWineD3DSurfaceImpl_LoadLocation(IWineD3DSurface *iface, D
 
             /* Restore the default pitch */
             glPixelStorei(GL_UNPACK_ROW_LENGTH, 0);
+            LEAVE_GL();
 
             /* Don't delete PBO memory */
             if((mem != This->resource.allocatedMemory) && !(This->Flags & SFLAG_PBO))
-- 
1.5.3.4


--========GMX13851202678442639788--


From truiken at gmail.com  Sun Feb 10 15:43:44 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 10 Feb 2008 15:43:44 -0600
Subject: Gdiplus: GdipDrawArc in graphics.c does not return
	InvalidParameter for bad values of height and width
In-Reply-To: <401aea60802101319k4c2241fcrd6271ab217ddf7f2@mail.gmail.com>
References: <401aea60802101319k4c2241fcrd6271ab217ddf7f2@mail.gmail.com>
Message-ID: <22821af30802101343y5a14f449r910f9154b04a8cd7@mail.gmail.com>

On Feb 10, 2008 3:19 PM, Royal Chan <chanroyal at gmail.com> wrote:
> Change Log:
> -added two checks for non-positive values of width and height
> -added a conformance test for invalid parameters
>

You forgot the patch.

-- 
James Hawkins


From truiken at gmail.com  Sun Feb 10 15:49:27 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 10 Feb 2008 15:49:27 -0600
Subject: Gdiplus: conformance test for GdipDrawLineI in graphics.c
In-Reply-To: <401aea60802101346hbaf55cbyec5115ce0311b93f@mail.gmail.com>
References: <401aea60802101346hbaf55cbyec5115ce0311b93f@mail.gmail.com>
Message-ID: <22821af30802101349n44779033ve1c8adb4ab88cc00@mail.gmail.com>

On Feb 10, 2008 3:46 PM, Royal Chan <chanroyal at gmail.com> wrote:
> Change Log:
> -added conformance test mainly checking for input parameters
>

You forgot the patch again.

-- 
James Hawkins


From marcus at jet.franken.de  Sun Feb 10 15:53:09 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Sun, 10 Feb 2008 22:53:09 +0100
Subject: ? on Repositories for Unaccept Patches and (work in Progress).
In-Reply-To: <911927.81304.qm@web36907.mail.mud.yahoo.com>
References: <911927.81304.qm@web36907.mail.mud.yahoo.com>
Message-ID: <20080210215309.GA4744@galeere>

On Sun, Feb 10, 2008 at 09:51:04AM -0800, Joseph Stein wrote:
> Is there a Git Repositories for Unaccept Patches or (work in Progress)?
> 
> If not (which i think is the case and why I posting here instead of the user mailing list.), could you create one(along with a text file explain what need to be done to be accepted)?
> 
> 
> 
> Here are some reason I think It is Needed.
> 
> 1.)  It would allow developer and users  to see what the source done.
> 
> I have read a very good article about usb support in wine an winehq.org here 
> 
> http://www.winehq.org/?issue=331
> 
> wich said that 
> 
> >An ntoskrnl.exe was written a couple of years ago to load drivers, >specifically the Safedisc Windows kernel driver, but it still hasn't been >accepted.  Apparently there's some low-level internal Wine issues >and Alexandre wants those fixed before accepting the patch.
> 
>  
> 2.) Allow people two git  possibly some things work that would other wise not work.
> 
> using the patch for ntoskrnl.exe  that was not accept as an example, (please correct me if i wrong), could possible git some drivers working (usb  driver may be?) program to work.  which is currently not possible with wine from what i read.

This comment is outdated, current GIT has ntoskrnl and safedisc support.

And anyone can publish GIT repos, there is problem with that.
(And repos.cz (?) has several of them already.)

Ciao, Marcus


From truiken at gmail.com  Sun Feb 10 15:56:53 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 10 Feb 2008 15:56:53 -0600
Subject: ? on Repositories for Unaccept Patches and (work in Progress).
In-Reply-To: <20080210215309.GA4744@galeere>
References: <911927.81304.qm@web36907.mail.mud.yahoo.com>
	<20080210215309.GA4744@galeere>
Message-ID: <22821af30802101356m14312f6esbf6d6ce62f08c461@mail.gmail.com>

On Feb 10, 2008 3:53 PM, Marcus Meissner <marcus at jet.franken.de> wrote:
> On Sun, Feb 10, 2008 at 09:51:04AM -0800, Joseph Stein wrote:
> > Is there a Git Repositories for Unaccept Patches or (work in Progress)?
> >
> > If not (which i think is the case and why I posting here instead of the user mailing list.), could you create one(along with a text file explain what need to be done to be accepted)?
> >
> >
> >
> > Here are some reason I think It is Needed.
> >
> > 1.)  It would allow developer and users  to see what the source done.
> >
> > I have read a very good article about usb support in wine an winehq.org here
> >
> > http://www.winehq.org/?issue=331
> >
> > wich said that
> >
> > >An ntoskrnl.exe was written a couple of years ago to load drivers, >specifically the Safedisc Windows kernel driver, but it still hasn't been >accepted.  Apparently there's some low-level internal Wine issues >and Alexandre wants those fixed before accepting the patch.
> >
> >
> > 2.) Allow people two git  possibly some things work that would other wise not work.
> >
> > using the patch for ntoskrnl.exe  that was not accept as an example, (please correct me if i wrong), could possible git some drivers working (usb  driver may be?) program to work.  which is currently not possible with wine from what i read.
>
> This comment is outdated, current GIT has ntoskrnl and safedisc support.
>
> And anyone can publish GIT repos, there is problem with that.
> (And repos.cz (?) has several of them already.)
>

http://wiki.winehq.org/GIT_Repositories

-- 
James Hawkins


From truiken at gmail.com  Sun Feb 10 16:07:05 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 10 Feb 2008 16:07:05 -0600
Subject: Gdiplus: Implement GdipDrawArcI based on GdipDrawArc
In-Reply-To: <401aea60802101404n567ed030rf56f3c031bed09fc@mail.gmail.com>
References: <401aea60802101404n567ed030rf56f3c031bed09fc@mail.gmail.com>
Message-ID: <22821af30802101407q5e4929efl9b3e1de9a2af7f4d@mail.gmail.com>

On Feb 10, 2008 4:04 PM, Royal Chan <chanroyal at gmail.com> wrote:
> Change Log:
> -Added GdipDrawArcI as GdipDrawArc that takes INT arguments
> -Added a very similar conformance test to the one I did for GdipDrawArc
> -Corresponding change to gdiplus.spec
>

No patch.

-- 
James Hawkins


From dank at kegel.com  Sun Feb 10 16:22:32 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 10 Feb 2008 14:22:32 -0800
Subject: Wine patches integrated into Valgrind svn
Message-ID: <a71bd89a0802101422u54870ed5s96e38c563ae89472@mail.gmail.com>

Hey, the Valgrind developers finally merged the Wine
support patches!  I just built Valgrind from svn as
described here:
http://valgrind.org/downloads/repository.html
and on a fresh install of Gutsy, it just worked, no patches.

To run Valgrind's tests under Wine, I configure valgrind with
--prefix=/usr/local/valgrind-svn, then do something like

cd wine-git/tools
wget http://kegel.com/wine/valgrind/runtests.patch
wget http://kegel.com/wine/valgrind/valgrind-daily.sh
wget http://kegel.com/wine/valgrind/valgrind-suppressions
wget http://kegel.com/wine/valgrind/valgrind-split-pl.txt -O valgrind-split.pl
patch -p2 < runtests.patch

Then to run all the tests, I do

cd ~/wine-git
sh tools/valgrind-daily.sh

or to run just one test, I do
 export RUNTEST_USE_VALGRIND=1
 cd ~/wine-git/dlls/riched20/tests
 make test

I've only verified that this works well on one machine so far, but
I have high hopes.  Anyone else feel like giving it a whirl?
- Dan


From mclark4386 at charter.net  Sun Feb 10 19:00:58 2008
From: mclark4386 at charter.net (Matthew Clark)
Date: Sun, 10 Feb 2008 19:00:58 -0600
Subject: COD4 stopped working
In-Reply-To: <a71bd89a0802101422u54870ed5s96e38c563ae89472@mail.gmail.com>
References: <a71bd89a0802101422u54870ed5s96e38c563ae89472@mail.gmail.com>
Message-ID: <47AF9E4A.4040008@charter.net>

So around the time that 0.9.54 came out I lost COD4 on both my desktop 
and laptop. In order for it to work you have to compile wine with the 
3dmark patch, so I was using the git, but when that didn't work I tried 
52 and 54 tarballs. Thing is I know it worked with the 52 git and with 
the 52 tarball it still doesn't work, I've tried reinstalling all the 
depends even... I've tried using a completely fresh prefix. I've tried 
downgrading my nvidiadrivers(169.09) to 07 and to 100.14.19 on my 
laptop(desktop has a 8800GT) and everything else I could think of. Below 
is the error log.
tried versions 1.3, 1.4 and 1.5 of COD4
Desktop:
gentoo 2.6.24-r1 amd64
athlon 3800 x2
8GBs DDR2-800 ram
8800GT (169.09 and 169.07)

Laptop:
gentoo 2.6.24 amd 64
turion 2.2GHz (think it's ML-40)
1GB ram(don't remember the specs)
7900GS (169.09, 169.07 and 100.14.19)

system at SMOOTHMACHINE[~/.wine/COD4/drive_c/Program Files/Activision]$ 
WINEPREFIX="/home/system/.wine/COD4" 
/mnt/backup2/programs/games/wine-0.9.52/wine iw3mp.exe
ALSA lib pcm.c:6617:(snd_pcm_slave_conf) unknown format unchanged
ALSA lib pcm.c:6617:(snd_pcm_slave_conf) unknown format unchanged
fixme:d3d:IWineD3DImpl_FillGLCaps OpenGL implementation supports 32 
vertex samplers and 32 total samplers
fixme:d3d:IWineD3DImpl_FillGLCaps Expected vertex samplers + 
MAX_TEXTURES(=8) > combined_samplers
fixme:win:EnumDisplayDevicesW ((null),0,0x32f91c,0x00000000), stub!
fixme:d3d:IWineD3DImpl_CheckDeviceMultiSampleType Quality levels 
unsupported at present
fixme:d3d:CreateContext >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvi(GL_TEXTURE_SHADER_NV, GL_PREVIOUS_TEXTURE_INPUT_NV, ...
 @ context.c / 384
fixme:d3d:CreateContext >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvi(GL_TEXTURE_SHADER_NV, GL_PREVIOUS_TEXTURE_INPUT_NV, ...
 @ context.c / 384
fixme:d3d:CreateContext >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvi(GL_TEXTURE_SHADER_NV, GL_PREVIOUS_TEXTURE_INPUT_NV, ...
 @ context.c / 384
fixme:d3d:CreateContext >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvi(GL_TEXTURE_SHADER_NV, GL_PREVIOUS_TEXTURE_INPUT_NV, ...
 @ context.c / 384
fixme:d3d:CreateContext >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvi(GL_TEXTURE_SHADER_NV, GL_PREVIOUS_TEXTURE_INPUT_NV, ...
 @ context.c / 384
fixme:d3d:CreateContext >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvi(GL_TEXTURE_SHADER_NV, GL_PREVIOUS_TEXTURE_INPUT_NV, ...
 @ context.c / 384
fixme:d3d:CreateContext >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvi(GL_TEXTURE_SHADER_NV, GL_PREVIOUS_TEXTURE_INPUT_NV, ...
 @ context.c / 384
fixme:d3d:CreateContext >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvi(GL_TEXTURE_SHADER_NV, GL_PREVIOUS_TEXTURE_INPUT_NV, ...
 @ context.c / 384
fixme:d3d:IWineD3DVolumeImpl_LockBox (0x17fd3aa8) : pBox=(nil) stub
fixme:d3d_surface:flush_to_framebuffer_drawpixels >>>>>>>>>>>>>>>>> 
GL_INVALID_VALUE (0x501) from glDrawPixels @ surface.c / 1088
fixme:d3d:state_separateblend (WINED3DRS_SEPARATEALPHABLENDENABLE,1) not 
yet implemented
fixme:d3d:tex_bumpenvmat >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvfv(GL_TEXTURE_SHADER_NV, GL_OFFSET_TEXTURE_MATRIX_NV, mat) 
@ state.c / 2531
fixme:d3d:tex_bumpenvmat >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvfv(GL_TEXTURE_SHADER_NV, GL_OFFSET_TEXTURE_MATRIX_NV, mat) 
@ state.c / 2531
fixme:d3d:tex_bumpenvmat >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvfv(GL_TEXTURE_SHADER_NV, GL_OFFSET_TEXTURE_MATRIX_NV, mat) 
@ state.c / 2531
fixme:d3d:tex_bumpenvmat >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvfv(GL_TEXTURE_SHADER_NV, GL_OFFSET_TEXTURE_MATRIX_NV, mat) 
@ state.c / 2531
fixme:d3d:CreateContext >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvi(GL_TEXTURE_SHADER_NV, GL_PREVIOUS_TEXTURE_INPUT_NV, ...
 @ context.c / 384
fixme:d3d:CreateContext >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvi(GL_TEXTURE_SHADER_NV, GL_PREVIOUS_TEXTURE_INPUT_NV, ...
 @ context.c / 384
fixme:d3d:CreateContext >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvi(GL_TEXTURE_SHADER_NV, GL_PREVIOUS_TEXTURE_INPUT_NV, ...
 @ context.c / 384
fixme:d3d:CreateContext >>>>>>>>>>>>>>>>> GL_INVALID_OPERATION (0x502) 
from glTexEnvi(GL_TEXTURE_SHADER_NV, GL_PREVIOUS_TEXTURE_INPUT_NV, ...
 @ context.c / 384
wine: Unhandled page fault on read access to 0x0000003c at address 
0x4ecf76 (thread 0009), starting debugger...
fixme:wave:widRecorder Recovering from XRUN!
Unhandled exception: page fault on read access to 0x0000003c in 32-bit 
code (0x004ecf76).
Register dump:
 CS:0023 SS:002b DS:002b ES:002b FS:0063 GS:006b
 EIP:004ecf76 ESP:0032fd10 EBP:0032fd54 EFLAGS:00010206(   - 00      - RIP1)
 EAX:00000000 EBX:7ed55b60 ECX:0cbb4660 EDX:0000ffff
 ESI:00000000 EDI:00000000
Stack dump:
0x0032fd10:  0cc1b248 00000000 0032fcf4 0057ab7c
0x0032fd20:  00000000 027fac38 0000ffff 0046cb07
0x0032fd30:  00001388 00001388 0cc11e40 0050017a
0x0032fd40:  00400000 7ee37b80 0032fd54 00000000
0x0032fd50:  0050036f 0032fd60 0050037d 7ee399e0
0x0032fd60:  0032ff08 00577463 00000a28 00000002
Backtrace:
=>1 0x004ecf76 in iw3mp (+0xecf76) (0x0032fd54)
  2 0x0050037d in iw3mp (+0x10037d) (0x0032fd60)
  3 0x00577463 in iw3mp (+0x177463) (0x0032ff08)
  4 0x7ee2345e start_process+0xee(arg=0x0) 
[/mnt/backup2/programs/games/wine-0.9.52/dlls/kernel32/process.c:839] in 
kernel32 (0x0032ffe8)
  5 0xf7dda927 wine_switch_to_stack+0x17() in libwine.so.1 (0x00000000)
0x004ecf76: cmpb        $0x0,0x3c(%esi)
Modules:
Module  Address                 Debug info      Name (90 modules)
PE        400000- d935000       Export          iw3mp
PE       d940000- dcaf000       Deferred        d3dx9_34
PE      18000000-18033000       Deferred        binkw32
PE      21100000-21197000       Deferred        mss32
ELF     7bf00000-7bf04000       Deferred        <wine-loader>
ELF     7d07a000-7d0ad000       Deferred        uxtheme<elf>
  \-PE  7d080000-7d0ad000       \               uxtheme
ELF     7d0cd000-7d0e3000       Deferred        midimap<elf>
  \-PE  7d0d0000-7d0e3000       \               midimap
ELF     7d0e3000-7d196000       Deferred        libasound.so.2
ELF     7d19c000-7d1a2000       Deferred        libnss_dns.so.2
ELF     7d1a2000-7d1ca000       Deferred        msacm32<elf>
  \-PE  7d1b0000-7d1ca000       \               msacm32
ELF     7d53d000-7d556000       Deferred        msacm32<elf>
  \-PE  7d540000-7d556000       \               msacm32
ELF     7d556000-7d58d000       Deferred        winealsa<elf>
  \-PE  7d560000-7d58d000       \               winealsa
ELF     7d58d000-7d593000       Deferred        libxfixes.so.3
ELF     7d593000-7d597000       Deferred        libxcomposite.so.1
ELF     7d597000-7d5a0000       Deferred        libxrender.so.1
ELF     7d5a0000-7d5a4000       Deferred        libxinerama.so.1
ELF     7d5b0000-7d5ba000       Deferred        libxcursor.so.1
ELF     7d5ba000-7d5d8000       Deferred        imm32<elf>
  \-PE  7d5c0000-7d5d8000       \               imm32
ELF     7d681000-7e197000       Deferred        libglcore.so.1
ELF     7e197000-7e23b000       Deferred        libgl.so.1
ELF     7e23b000-7e241000       Deferred        libxdmcp.so.6
ELF     7e241000-7e32d000       Deferred        libx11.so.6
ELF     7e32d000-7e33c000       Deferred        libxext.so.6
ELF     7e33c000-7e354000       Deferred        libice.so.6
ELF     7e354000-7e35d000       Deferred        libsm.so.6
ELF     7e35d000-7e364000       Deferred        libxrandr.so.2
ELF     7e391000-7e424000       Deferred        winex11<elf>
  \-PE  7e3a0000-7e424000       \               winex11
ELF     7e45c000-7e47d000       Deferred        libexpat.so.1
ELF     7e47d000-7e4a9000       Deferred        libfontconfig.so.1
ELF     7e4a9000-7e4bc000       Deferred        libz.so.1
ELF     7e4bc000-7e537000       Deferred        libfreetype.so.6
ELF     7e539000-7e53b000       Deferred        libnvidia-tls.so.1
ELF     7e56b000-7e5c1000       Deferred        ddraw<elf>
  \-PE  7e570000-7e5c1000       \               ddraw
ELF     7e5c1000-7e67f000       Deferred        comctl32<elf>
  \-PE  7e5d0000-7e67f000       \               comctl32
ELF     7e67f000-7e6d8000       Deferred        shlwapi<elf>
  \-PE  7e690000-7e6d8000       \               shlwapi
ELF     7e6d8000-7e7de000       Deferred        shell32<elf>
  \-PE  7e6f0000-7e7de000       \               shell32
ELF     7e7de000-7e83c000       Deferred        rpcrt4<elf>
  \-PE  7e7f0000-7e83c000       \               rpcrt4
ELF     7e83c000-7e8de000       Deferred        ole32<elf>
  \-PE  7e850000-7e8de000       \               ole32
ELF     7e8de000-7e929000       Deferred        dsound<elf>
  \-PE  7e8f0000-7e929000       \               dsound
ELF     7e929000-7e991000       Deferred        msvcrt<elf>
  \-PE  7e940000-7e991000       \               msvcrt
ELF     7e991000-7ea80000       Deferred        wined3d<elf>
  \-PE  7e9a0000-7ea80000       \               wined3d
ELF     7ea80000-7eab0000       Deferred        d3d9<elf>
  \-PE  7ea90000-7eab0000       \               d3d9
ELF     7eab0000-7eacf000       Deferred        iphlpapi<elf>
  \-PE  7eac0000-7eacf000       \               iphlpapi
ELF     7eacf000-7eafd000       Deferred        ws2_32<elf>
  \-PE  7eae0000-7eafd000       \               ws2_32
ELF     7eafd000-7eb49000       Deferred        advapi32<elf>
  \-PE  7eb10000-7eb49000       \               advapi32
ELF     7eb49000-7ebe2000       Deferred        gdi32<elf>
  \-PE  7eb60000-7ebe2000       \               gdi32
ELF     7ebe2000-7ed1f000       Deferred        user32<elf>
  \-PE  7ec00000-7ed1f000       \               user32
ELF     7ed1f000-7edae000       Deferred        winmm<elf>
  \-PE  7ed30000-7edae000       \               winmm
ELF     7edae000-7eed8000       Dwarf           kernel32<elf>
  \-PE  7edd0000-7eed8000       \               kernel32
ELF     7eed8000-7eee3000       Deferred        libnss_files.so.2
ELF     7eee3000-7eeed000       Deferred        libnss_nis.so.2
ELF     7eeed000-7ef04000       Deferred        libnsl.so.1
ELF     7ef04000-7ef28000       Deferred        libm.so.6
ELF     7ef29000-7ef2f000       Deferred        libxxf86vm.so.1
ELF     7ef2f000-7ef41000       Deferred        libresolv.so.2
ELF     7ef41000-7ef5c000       Deferred        wsock32<elf>
  \-PE  7ef50000-7ef5c000       \               wsock32
ELF     7ef5c000-7f000000       Deferred        ntdll<elf>
  \-PE  7ef70000-7f000000       \               ntdll
ELF     f7c40000-f7c44000       Deferred        libxau.so.6
ELF     f7c44000-f7c4c000       Deferred        libnss_compat.so.2
ELF     f7c4d000-f7c51000       Deferred        libdl.so.2
ELF     f7c52000-f7d87000       Deferred        libc.so.6
ELF     f7d87000-f7d9f000       Deferred        libpthread.so.0
ELF     f7dd3000-f7ee7000       Dwarf           libwine.so.1
ELF     f7ee8000-f7f04000       Deferred        ld-linux.so.2
Threads:
process  tid      prio (all id:s are in hex)
0000000a
        0000000b    0
00000008 (D) Z:\mnt\backup2\programs\games\installed\Activision\iw3mp.exe
        00000010   15
        0000000f    0
        0000000e    0
        0000000d    0
        0000000c   -1
        00000009    0 <==
Backtrace:
=>1 0x004ecf76 in iw3mp (+0xecf76) (0x0032fd54)
  2 0x0050037d in iw3mp (+0x10037d) (0x0032fd60)
  3 0x00577463 in iw3mp (+0x177463) (0x0032ff08)
  4 0x7ee2345e start_process+0xee(arg=0x0) 
[/mnt/backup2/programs/games/wine-0.9.52/dlls/kernel32/process.c:839] in 
kernel32 (0x0032ffe8)
  5 0xf7dda927 wine_switch_to_stack+0x17() in libwine.so.1 (0x00000000)



From wine-devel at kievinfo.com  Sun Feb 10 19:23:27 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 10 Feb 2008 18:23:27 -0700
Subject: COD4 stopped working
In-Reply-To: <47AF9E4A.4040008@charter.net>
References: <a71bd89a0802101422u54870ed5s96e38c563ae89472@mail.gmail.com>
	<47AF9E4A.4040008@charter.net>
Message-ID: <47AFA38F.9010001@kievinfo.com>

Matthew Clark wrote:
> So around the time that 0.9.54 came out I lost COD4 on both my desktop 
> and laptop. In order for it to work you have to compile wine with the 

Please don't make posts like this. Open bug in bugzilla instead. The mailing 
list is the bad place to track any information, especially bug related.

Vitaliy.


From gerald at pfeifer.com  Sun Feb 10 15:31:20 2008
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Sun, 10 Feb 2008 22:31:20 +0100 (CET)
Subject: dlls/gdi32/font.c warning removal (RESEND)
In-Reply-To: <878x1ytkh3.fsf@wine.dyndns.org>
References: <Pine.LNX.4.64.0801251323440.4453@acrux.dbai.tuwien.ac.at>
	<878x1ytkh3.fsf@wine.dyndns.org>
Message-ID: <alpine.LSU.1.00.0802102229470.31939@acrux.dbai.tuwien.ac.at>

On Wed, 6 Feb 2008, Alexandre Julliard wrote:
>> The reason is that we have
>>
>>   #define HDPTOLP(y) ((y<0)?                                      \
>>                 (-abs(INTERNAL_YDSTOWS(dc, (y)))):              \
>>                 (abs(INTERNAL_YDSTOWS(dc, (y)))))
>>
>> which is overly complicated for unsigned types.  We can avoid these 
>> warnings by using plain INTERNAL_YDSTOWS instead of HDPTOLP here.
> No, you still need the abs().

You're right.  That was a stupid thinko on my side.  Please find below
an updated patch.

Gerald

ChangeLog:
For unsigned types, directly use INTERNAL_YDS

Index: font.c
===================================================================
RCS file: /home/wine/wine/dlls/gdi32/font.c,v
retrieving revision 1.39
diff -u -3 -p -r1.39 font.c
--- font.c	6 Feb 2008 13:28:51 -0000	1.39
+++ font.c	10 Feb 2008 21:26:59 -0000
@@ -1690,16 +1690,16 @@ UINT WINAPI GetOutlineTextMetricsW(
 	    output->otmTextMetrics.tmOverhang         = WDPTOLP(output->otmTextMetrics.tmOverhang);
 	    output->otmAscent = HDPTOLP(output->otmAscent);
 	    output->otmDescent = HDPTOLP(output->otmDescent);
-	    output->otmLineGap = HDPTOLP(output->otmLineGap);
-	    output->otmsCapEmHeight = HDPTOLP(output->otmsCapEmHeight);
-	    output->otmsXHeight = HDPTOLP(output->otmsXHeight);
+	    output->otmLineGap = abs(INTERNAL_YDSTOWS(dc,output->otmLineGap));
+	    output->otmsCapEmHeight = abs(INTERNAL_YDSTOWS(dc,output->otmsCapEmHeight));
+	    output->otmsXHeight = abs(INTERNAL_YDSTOWS(dc,output->otmsXHeight));
 	    output->otmrcFontBox.top = HDPTOLP(output->otmrcFontBox.top);
 	    output->otmrcFontBox.bottom = HDPTOLP(output->otmrcFontBox.bottom);
 	    output->otmrcFontBox.left = WDPTOLP(output->otmrcFontBox.left);
 	    output->otmrcFontBox.right = WDPTOLP(output->otmrcFontBox.right);
 	    output->otmMacAscent = HDPTOLP(output->otmMacAscent);
 	    output->otmMacDescent = HDPTOLP(output->otmMacDescent);
-	    output->otmMacLineGap = HDPTOLP(output->otmMacLineGap);
+	    output->otmMacLineGap = abs(INTERNAL_YDSTOWS(dc,output->otmMacLineGap));
 	    output->otmptSubscriptSize.x = WDPTOLP(output->otmptSubscriptSize.x);
 	    output->otmptSubscriptSize.y = HDPTOLP(output->otmptSubscriptSize.y);
 	    output->otmptSubscriptOffset.x = WDPTOLP(output->otmptSubscriptOffset.x);
@@ -1708,7 +1708,7 @@ UINT WINAPI GetOutlineTextMetricsW(
 	    output->otmptSuperscriptSize.y = HDPTOLP(output->otmptSuperscriptSize.y);
 	    output->otmptSuperscriptOffset.x = WDPTOLP(output->otmptSuperscriptOffset.x);
 	    output->otmptSuperscriptOffset.y = HDPTOLP(output->otmptSuperscriptOffset.y);
-	    output->otmsStrikeoutSize = HDPTOLP(output->otmsStrikeoutSize);
+	    output->otmsStrikeoutSize = abs(INTERNAL_YDSTOWS(dc,output->otmsStrikeoutSize));
 	    output->otmsStrikeoutPosition = HDPTOLP(output->otmsStrikeoutPosition);
 	    output->otmsUnderscoreSize = HDPTOLP(output->otmsUnderscoreSize);
 	    output->otmsUnderscorePosition = HDPTOLP(output->otmsUnderscorePosition);


From msclrhd at googlemail.com  Sun Feb 10 15:34:29 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 10 Feb 2008 21:34:29 +0000
Subject: winecfg improvements
Message-ID: <3f4fd2640802101334w5498729frd028700daf93d986@mail.gmail.com>

Hi,

I have just submitted 4 patches that make it possible to import a
colour theme from winecfg and have it correctly apply the colours.

One example is the Ubuntu Human theme (see attachment), adapted from
http://tombuntu.com/wp-content/uploads/2008/01/winehumancolours.txt.

Enjoy,
- Reece
-------------- next part --------------
A non-text attachment was scrubbed...
Name: human.theme
Type: application/octet-stream
Size: 730 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080210/0f218c4a/attachment.obj 

From msclrhd at googlemail.com  Sun Feb 10 16:00:35 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 10 Feb 2008 22:00:35 +0000
Subject: ? on Repositories for Unaccept Patches and (work in Progress).
In-Reply-To: <20080210215309.GA4744@galeere>
References: <911927.81304.qm@web36907.mail.mud.yahoo.com>
	<20080210215309.GA4744@galeere>
Message-ID: <3f4fd2640802101400x7644a00bu17915bd8b76fec55@mail.gmail.com>

On 10/02/2008, Marcus Meissner <marcus at jet.franken.de> wrote:
> And anyone can publish GIT repos, there is problem with that.
> (And repos.cz (?) has several of them already.)

repo.or.cz.

- Reece


From mclark4386 at charter.net  Sun Feb 10 19:45:13 2008
From: mclark4386 at charter.net (Matthew Clark)
Date: Sun, 10 Feb 2008 19:45:13 -0600
Subject: COD4 stopped working
In-Reply-To: <47AFA38F.9010001@kievinfo.com>
References: <a71bd89a0802101422u54870ed5s96e38c563ae89472@mail.gmail.com>
	<47AF9E4A.4040008@charter.net> <47AFA38F.9010001@kievinfo.com>
Message-ID: <47AFA8A9.1020202@charter.net>

Vitaliy Margolen wrote:
> Matthew Clark wrote:
>> So around the time that 0.9.54 came out I lost COD4 on both my 
>> desktop and laptop. In order for it to work you have to compile wine 
>> with the 
>
> Please don't make posts like this. Open bug in bugzilla instead. The 
> mailing list is the bad place to track any information, especially bug 
> related.
>
> Vitaliy.
>
sorry about that http://bugs.winehq.org/show_bug.cgi?id=11545


From scott at open-vote.org  Sun Feb 10 19:51:52 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Sun, 10 Feb 2008 17:51:52 -0800
Subject: gecko download not robust?
In-Reply-To: <b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>
References: <47AE349F.7040605@mandrivaclub.nl>
	<b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>
Message-ID: <47AFAA38.5070201@open-vote.org>

Austin English wrote:
> On Feb 9, 2008 5:17 PM, marco <marco at mandrivaclub.nl> wrote:
>>> Hmm.  gecko download hung for me once.  I saw
>>> fixme:urlmon:ProtocolStream_Read Read failed: 800c0008
>>> in the log, which makes me wonder if our download code
>>> doesn't handle transient network errors well.
>>>
>>> Time to get rid of the download, and just bundle gecko outright, I say...
>> I make the mandriva rpms for wine.
>> This would make the rpms 30% bigger.
>> And you would download the same gecko binary over and over again with
>> every new version.
>>
>> But if that is not a problem than it can be easily done.
>>
>>
> 
> Why not have package maintainers package gecko like most do
> development files. So you could have for example on ubuntu:
> $ sudo apt-get install wine wine-dev wine-gecko
> 
> Where wine-gecko wouldn't have to be upgraded very often.
> 
> -Austin
> 
> 

This would be ideal, however last I heard gecko didn't compile properly
in mingw.  Is this no longer the case?  Can we build it on Ubuntu?

Thanks,
Scott Ritchie


From joseph_d_stein at yahoo.com  Sun Feb 10 19:59:20 2008
From: joseph_d_stein at yahoo.com (Joseph Stein)
Date: Sun, 10 Feb 2008 17:59:20 -0800 (PST)
Subject: Is there a Git Repositories for Unaccept Patches or (work in
	Progress)?
In-Reply-To: <a71bd89a0802101055m2d97cefaw7612fab9e1851fed@mail.gmail.com>
Message-ID: <511080.4104.qm@web36912.mail.mud.yahoo.com>



Dan Kegel <dank at kegel.com> wrote:Dan Kegel wrote   

>Joeseph wrote:
>> Is there a Git Repositories for Unaccept Patches or (work >in Progress)?


>Not really, but people often attach patches to bugzilla
>entries if they're not quite good enough to submit.
>And if anybody wants to start such a git repository,
>more power to them.

Thank I did not know that.

>>An ntoskrnl.exe was written a couple of years ago to load drivers,
>>specifically the Safedisc Windows kernel driver,
>> but it still hasn't been accepted.

>>The article you read is out of date; ntoskrnl.exe is now part >>of >wine.

This is good to here to.

>> Basically  threat unaccepted patch as bugs(while keeping >>the patch out of wine), instead of chucking it out the window.

>As I said above, developers are free to attach patches to bug >reports.

>What you're really trying to get at is: sometimes developers
>get discouraged at how hard it is to get patches into Wine.
>But no mechanical aid will really help there.  The only cure
>is persistance on the part of the developer, and assistance
>(chiefly good feedback) from other Wine developers.
>After a developer gets a few patches committed, the
>wine process starts to feel a lot smoother.

That basically what i said yes but, the main reason I wanted the git Repositories was it more an acknowledge that you did do something and set a flag developer could use to help people if they wanted to.  

Please don't take this the wrong way but,

  Set a  patch that was rejected as a bug report seem to be a round about way of doing thing and a little air-i-gent to me is it not to you?    
 
If this is the way thing are done, why is it not listed in the doc on found on winehq  site, or was it there and I missed it.

Thank Dan you where a big help.


James Hawkins wrote: 
>>
>> And anyone can publish GIT repos, there is problem with that.
>> (And repos.cz (?) has several of them already.)
>>

> http://wiki.winehq.org/GIT_Repositories

>-- 
>James Hawkins

I never said you should allow everybody access 
just those who sud-met-ted a fairly good patch 

I never saw that site thou,(what is  Thank for the tip.
I browsed the wiki several times. I never 
really saw it as hack and i be-leave that why 
i missed it.

Thanks.






- Dan

-- 
Wine for Windows ISVs: http://kegel.com/wine/isv


       
---------------------------------
Be a better friend, newshound, and know-it-all with Yahoo! Mobile.  Try it now.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080210/b92fca9c/attachment.htm 

From wine-devel at kievinfo.com  Sun Feb 10 20:13:07 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 10 Feb 2008 19:13:07 -0700
Subject: Is there a Git Repositories for Unaccept Patches or (work in
	Progress)?
In-Reply-To: <511080.4104.qm@web36912.mail.mud.yahoo.com>
References: <511080.4104.qm@web36912.mail.mud.yahoo.com>
Message-ID: <47AFAF33.8000108@kievinfo.com>

Here we go again. Please read the archives. At least last few weeks would 
have pointed you to exactly the same topic which comes back again and again:
http://www.winehq.org/pipermail/wine-devel/2006-September/thread.html#50915

And please respect everyone and don't use that color thingy in mailing lists 
(plain text no html).

Vitaliy.

Joseph Stein wrote:
> 
skipped as it's impossible to read.


From wine-devel at kievinfo.com  Sun Feb 10 20:24:35 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 10 Feb 2008 19:24:35 -0700
Subject: COD4 stopped working
In-Reply-To: <47AFA8A9.1020202@charter.net>
References: <a71bd89a0802101422u54870ed5s96e38c563ae89472@mail.gmail.com>
	<47AF9E4A.4040008@charter.net> <47AFA38F.9010001@kievinfo.com>
	<47AFA8A9.1020202@charter.net>
Message-ID: <47AFB1E3.40806@kievinfo.com>

Matthew Clark wrote:
> Vitaliy Margolen wrote:
>> Matthew Clark wrote:
>>> So around the time that 0.9.54 came out I lost COD4 on both my 
>>> desktop and laptop. In order for it to work you have to compile wine 
>>> with the 
>>
>> Please don't make posts like this. Open bug in bugzilla instead. The 
>> mailing list is the bad place to track any information, especially bug 
>> related.
>>
>> Vitaliy.
>>
> sorry about that http://bugs.winehq.org/show_bug.cgi?id=11545

Thank you.

Vitaliy


From jacek at codeweavers.com  Sun Feb 10 21:11:25 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Mon, 11 Feb 2008 04:11:25 +0100
Subject: gecko download not robust?
In-Reply-To: <47AFAA38.5070201@open-vote.org>
References: <47AE349F.7040605@mandrivaclub.nl>	<b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>
	<47AFAA38.5070201@open-vote.org>
Message-ID: <47AFBCDD.2070206@codeweavers.com>

Scott Ritchie wrote:
> This would be ideal, however last I heard gecko didn't compile properly
> in mingw.  Is this no longer the case?  Can we build it on Ubuntu?
>   

Compiling the package is quite tricky. I've compiled it on Windows XP 
using MSVC. There is no other way ATM, so I think that my Gecko package 
should be included as is in Linux packages.

Thanks,
    Jacek


From dmitry at codeweavers.com  Sun Feb 10 21:19:15 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 11 Feb 2008 11:19:15 +0800
Subject: pdh[3:3]: remove unnecessary tests done
	inPdhLookupPerfNameByIndexW
References: <47AEA473.5040402@yless4u.com.au><007701c86be5$78a39b50$a600fea9@DMITRY>
	<47AF4412.3020201@yless4u.com.au>
Message-ID: <002201c86c5c$e2cbd7a0$a600fea9@DMITRY>

"Jeff Latimer" <lats at yless4u.com.au> wrote:

>>> --- a/dlls/pdh/pdh_main.c
>>> +++ b/dlls/pdh/pdh_main.c
>>> @@ -837,14 +837,7 @@ PDH_STATUS WINAPI PdhLookupPerfNameByIndexA( 
>>> LPCSTR machine, DWORD index, LPSTR
>>>
>>>     TRACE("%s %d %p %p\n", debugstr_a(machine), index, buffer, size);
>>>
>>> -    if (machine)
>>> -    {
>>> -        FIXME("remote machine not supported\n");
>>> -        return PDH_CSTATUS_NO_MACHINE;
>>> -    }
>>> -
>>>     if (!buffer || !size) return PDH_INVALID_ARGUMENT;
>>> -    if (!index) return ERROR_SUCCESS;
>>
>> Changelog mentions PdhLookupPerfNameByIndexW by the change is in 
>> PdhLookupPerfNameByIndexA.
>> Why are you removing the checks in one place by leave the same in 
>> other one? Why the tests
>> are unnecessary?
>>
> The parameters, bufferW and sizeW passed by PdhLookupPerfNameByIndexA to 
> PdhLookupPerfNameByIndexW are  local to PdhLookupPerfNameByIndexA.

That doesn't mean that PdhLookupPerfNameByIndexW can't be called directly.

> The 
> test is needed still in PdhLookupPerfNameByIndexA because the size and 
> buffer are not passed but still need to be checked.

That still doesn't answer my questions.

-- 
Dmitry.


From winehacker at gmail.com  Sun Feb 10 21:33:27 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 10 Feb 2008 22:33:27 -0500
Subject: Is there a Git Repositories for Unaccept Patches or (work in
	Progress)?
In-Reply-To: <a71bd89a0802101055m2d97cefaw7612fab9e1851fed@mail.gmail.com>
References: <a71bd89a0802101055m2d97cefaw7612fab9e1851fed@mail.gmail.com>
Message-ID: <19e31a080802101933m11ad2721u1cf3d82ca43e4fa5@mail.gmail.com>

On Feb 10, 2008 1:55 PM, Dan Kegel <dank at kegel.com> wrote:
> Joeseph wrote:
> > Is there a Git Repositories for Unaccept Patches or (work in Progress)?
>
> Not really, but people often attach patches to bugzilla
> entries if they're not quite good enough to submit.
> And if anybody wants to start such a git repository,
> more power to them.

+1

I've got a local git repo setup where I have the winequartzdrv from
darwine sitting and I have been trying to bring up to date but never
have time to mess with it. It would be cool if we had a repo for
unacceptable patches that we could write to and maintain branches on
for projects like this because with others working on it it might one
day evolve in to the shape of something he would accept.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From jjmckenzie51 at sprintpcs.com  Sun Feb 10 22:18:50 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sun, 10 Feb 2008 21:18:50 -0700
Subject: Is there a Git Repositories for Unaccept Patches or (work in
	Progress)?
In-Reply-To: <19e31a080802101933m11ad2721u1cf3d82ca43e4fa5@mail.gmail.com>
References: <a71bd89a0802101055m2d97cefaw7612fab9e1851fed@mail.gmail.com>
	<19e31a080802101933m11ad2721u1cf3d82ca43e4fa5@mail.gmail.com>
Message-ID: <47AFCCAA.3080804@sprintpcs.com>

Steven Edwards wrote:
> On Feb 10, 2008 1:55 PM, Dan Kegel <dank at kegel.com> wrote:
>   
>> Joeseph wrote:
>>     
>>> Is there a Git Repositories for Unaccept Patches or (work in Progress)?
>>>       
>> Not really, but people often attach patches to bugzilla
>> entries if they're not quite good enough to submit.
>> And if anybody wants to start such a git repository,
>> more power to them.
>>     
>
> +1
>
> I've got a local git repo setup where I have the winequartzdrv from
> darwine sitting and I have been trying to bring up to date but never
> have time to mess with it. It would be cool if we had a repo for
> unacceptable patches that we could write to and maintain branches on
> for projects like this because with others working on it it might one
> day evolve in to the shape of something he would accept.
>
>   
I would like to 'chime' in here.  If you have it local and it is not 
complete, why submit to the main program flow.  Create a bug and put it 
there.  Simple and it keeps the code tree "clean".  This allows others 
to become aware of what you are up to and can increase collaboration.   
Otherwise, your work becomes 'lost' and will never be complete.  I would 
NEVER submit anything to the tree that is not complete and ready for 
review by Alexandre.  I have been a victim of the dreaded drop, but that 
is not because the code I submitted was incomplete, but parts of it have 
become irrelivant because of changes to the tree.  So, I've had to back 
up and redo the work and then collaborate with the original submitter 
and have a peer review and then submit.  Hopefully this will be 
applicable to your project. 
Again, to summarize, if your code is not ready for Alexandre's review, 
open a bug, put your changes there, let the development list know and 
kick back and see what happens.  If you need help, submit your code and 
then let others help.  Don't expect things to happen overnight, 
sometimes it can take weeks or months.
Also, I am very interested in your work on winequartz, please let me 
know what the bug number is.

James McKenzie



From winehacker at gmail.com  Sun Feb 10 23:52:38 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 11 Feb 2008 00:52:38 -0500
Subject: Is there a Git Repositories for Unaccept Patches or (work in
	Progress)?
In-Reply-To: <47AFCCAA.3080804@sprintpcs.com>
References: <a71bd89a0802101055m2d97cefaw7612fab9e1851fed@mail.gmail.com>
	<19e31a080802101933m11ad2721u1cf3d82ca43e4fa5@mail.gmail.com>
	<47AFCCAA.3080804@sprintpcs.com>
Message-ID: <19e31a080802102152o48b42326yc7e3cddcd01ab02@mail.gmail.com>

On Feb 10, 2008 11:18 PM, James McKenzie <jjmckenzie51 at sprintpcs.com> wrote:
> I would like to 'chime' in here.  If you have it local and it is not
> complete, why submit to the main program flow.  Create a bug and put it
> there.  Simple and it keeps the code tree "clean".  This allows others
> to become aware of what you are up to and can increase collaboration.
> Otherwise, your work becomes 'lost' and will never be complete.  I would
> NEVER submit anything to the tree that is not complete and ready for
> review by Alexandre.  I have been a victim of the dreaded drop, but that
> is not because the code I submitted was incomplete, but parts of it have
> become irrelivant because of changes to the tree.  So, I've had to back
> up and redo the work and then collaborate with the original submitter
> and have a peer review and then submit.  Hopefully this will be
> applicable to your project.
> Again, to summarize, if your code is not ready for Alexandre's review,
> open a bug, put your changes there, let the development list know and
> kick back and see what happens.  If you need help, submit your code and
> then let others help.  Don't expect things to happen overnight,
> sometimes it can take weeks or months.
> Also, I am very interested in your work on winequartz, please let me
> know what the bug number is.

I am not talking about submitting anything broken to the main Wine
tree. I was talking about having seperate repo that would allow for a
limited amount of brokeness on public branches. The simple fact is
that too much in mainline Winehq has changed from when winequartzdrv
was first written and it needs to be in a tree somewhere that is
public so there can be a merge and collaboration to fix the brokeness.
Off the top of my head there is problems with visable region handling
that was moved in to wineserver and CreateWindow abstraction that need
to be fixed. Not to mention the fact Alexandre views the entire design
to be flawed as is...Development of major new features like this out
of bugzilla is a non-starter. See ntoskrnl development history for
example.

Let me put it another way. Having worked on multiple maintainer
projects with public write access repositories and a single maintainer
repo like Wine I know the up and down side of both methods, but it
will be a cold day in hell before I waste my time trying to do any
sort of major infrastructure work over bugzilla with plain diffs. Gits
design is supposed to remove the need for such development practices.
Its already in CVS in darwine but that does not make for easy merging
so I fail to see how bugzilla + diff's is supposed to be a more
effective development method.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Sun Feb 10 23:57:51 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 11 Feb 2008 00:57:51 -0500
Subject: Is there a Git Repositories for Unaccept Patches or (work in
	Progress)?
In-Reply-To: <19e31a080802102152o48b42326yc7e3cddcd01ab02@mail.gmail.com>
References: <a71bd89a0802101055m2d97cefaw7612fab9e1851fed@mail.gmail.com>
	<19e31a080802101933m11ad2721u1cf3d82ca43e4fa5@mail.gmail.com>
	<47AFCCAA.3080804@sprintpcs.com>
	<19e31a080802102152o48b42326yc7e3cddcd01ab02@mail.gmail.com>
Message-ID: <19e31a080802102157t4b4107eeu60fd94a0c3560d46@mail.gmail.com>

On Feb 11, 2008 12:52 AM, Steven Edwards <winehacker at gmail.com> wrote:
> Let me put it another way. Having worked on multiple maintainer
> projects with public write access repositories and a single maintainer
> repo like Wine I know the up and down side of both methods, but it
> will be a cold day in hell before I waste my time trying to do any
> sort of major infrastructure work over bugzilla with plain diffs. Gits
> design is supposed to remove the need for such development practices.
> Its already in CVS in darwine but that does not make for easy merging
> so I fail to see how bugzilla + diff's is supposed to be a more
> effective development method.

Sorry I didn't mean for that to sound quite so rude. Having invested a
good bit of time in trying to understand git, I think I git it now so
to speak and not having a public repo where there can be really
collaborative development seems to be a step back to me. Not that
bugzilla + diff's is bad. Its great for minor enhancements and small
patches that are not ready to go in but for major new developments
requiring multiple eye balls, a shared repository is the only sane way
to go.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Sun Feb 10 23:59:58 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 10 Feb 2008 21:59:58 -0800
Subject: Is there a Git Repositories for Unaccept Patches or (work in
	Progress)?
In-Reply-To: <19e31a080802102157t4b4107eeu60fd94a0c3560d46@mail.gmail.com>
References: <a71bd89a0802101055m2d97cefaw7612fab9e1851fed@mail.gmail.com>
	<19e31a080802101933m11ad2721u1cf3d82ca43e4fa5@mail.gmail.com>
	<47AFCCAA.3080804@sprintpcs.com>
	<19e31a080802102152o48b42326yc7e3cddcd01ab02@mail.gmail.com>
	<19e31a080802102157t4b4107eeu60fd94a0c3560d46@mail.gmail.com>
Message-ID: <a71bd89a0802102159h2af1c740j13a433631a96e62a@mail.gmail.com>

On Feb 10, 2008 9:57 PM, Steven Edwards <winehacker at gmail.com> wrote:
> ... Having invested a
> good bit of time in trying to understand git, I think I git it now so
> to speak and not having a public repo where there can be really
> collaborative development seems to be a step back to me.

?  But you don't need a central public git repository to do
collaborative development, that's the whole point of git...
- Dan


From truiken at gmail.com  Mon Feb 11 00:02:22 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 11 Feb 2008 00:02:22 -0600
Subject: Is there a Git Repositories for Unaccept Patches or (work in
	Progress)?
In-Reply-To: <19e31a080802102157t4b4107eeu60fd94a0c3560d46@mail.gmail.com>
References: <a71bd89a0802101055m2d97cefaw7612fab9e1851fed@mail.gmail.com>
	<19e31a080802101933m11ad2721u1cf3d82ca43e4fa5@mail.gmail.com>
	<47AFCCAA.3080804@sprintpcs.com>
	<19e31a080802102152o48b42326yc7e3cddcd01ab02@mail.gmail.com>
	<19e31a080802102157t4b4107eeu60fd94a0c3560d46@mail.gmail.com>
Message-ID: <22821af30802102202h11b92916s6108a7cee031f3bd@mail.gmail.com>

On Feb 10, 2008 11:57 PM, Steven Edwards <winehacker at gmail.com> wrote:
> On Feb 11, 2008 12:52 AM, Steven Edwards <winehacker at gmail.com> wrote:
> > Let me put it another way. Having worked on multiple maintainer
> > projects with public write access repositories and a single maintainer
> > repo like Wine I know the up and down side of both methods, but it
> > will be a cold day in hell before I waste my time trying to do any
> > sort of major infrastructure work over bugzilla with plain diffs. Gits
> > design is supposed to remove the need for such development practices.
> > Its already in CVS in darwine but that does not make for easy merging
> > so I fail to see how bugzilla + diff's is supposed to be a more
> > effective development method.
>
> Sorry I didn't mean for that to sound quite so rude. Having invested a
> good bit of time in trying to understand git, I think I git it now so
> to speak and not having a public repo where there can be really
> collaborative development seems to be a step back to me. Not that
> bugzilla + diff's is bad. Its great for minor enhancements and small
> patches that are not ready to go in but for major new developments
> requiring multiple eye balls, a shared repository is the only sane way
> to go.
>

This sparked a memory of the discussion about having a -devel and a
-stable branch after we release 1.0.

-- 
James Hawkins


From dank at kegel.com  Mon Feb 11 00:10:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 10 Feb 2008 22:10:30 -0800
Subject: Is there a Git Repositories for Unaccept Patches or (work in
	Progress)?
In-Reply-To: <22821af30802102202h11b92916s6108a7cee031f3bd@mail.gmail.com>
References: <a71bd89a0802101055m2d97cefaw7612fab9e1851fed@mail.gmail.com>
	<19e31a080802101933m11ad2721u1cf3d82ca43e4fa5@mail.gmail.com>
	<47AFCCAA.3080804@sprintpcs.com>
	<19e31a080802102152o48b42326yc7e3cddcd01ab02@mail.gmail.com>
	<19e31a080802102157t4b4107eeu60fd94a0c3560d46@mail.gmail.com>
	<22821af30802102202h11b92916s6108a7cee031f3bd@mail.gmail.com>
Message-ID: <a71bd89a0802102210o68df33b9ja470b0e27259fb3e@mail.gmail.com>

On Feb 10, 2008 10:02 PM, James Hawkins <truiken at gmail.com>
> This sparked a memory of the discussion about having a -devel and a
> -stable branch after we release 1.0.

Oh, yeah.  IMHO we should release 1.0.0 and 1.1.0 at the
same time, and treat 1.0.x as our stable branch.


From winehacker at gmail.com  Mon Feb 11 00:28:37 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 11 Feb 2008 01:28:37 -0500
Subject: Is there a Git Repositories for Unaccept Patches or (work in
	Progress)?
In-Reply-To: <a71bd89a0802102159h2af1c740j13a433631a96e62a@mail.gmail.com>
References: <a71bd89a0802101055m2d97cefaw7612fab9e1851fed@mail.gmail.com>
	<19e31a080802101933m11ad2721u1cf3d82ca43e4fa5@mail.gmail.com>
	<47AFCCAA.3080804@sprintpcs.com>
	<19e31a080802102152o48b42326yc7e3cddcd01ab02@mail.gmail.com>
	<19e31a080802102157t4b4107eeu60fd94a0c3560d46@mail.gmail.com>
	<a71bd89a0802102159h2af1c740j13a433631a96e62a@mail.gmail.com>
Message-ID: <19e31a080802102228x2aa74ebew9b0e83eef3497a0b@mail.gmail.com>

On Feb 11, 2008 12:59 AM, Dan Kegel <dank at kegel.com> wrote:
> On Feb 10, 2008 9:57 PM, Steven Edwards <winehacker at gmail.com> wrote:
> > ... Having invested a
> > good bit of time in trying to understand git, I think I git it now so
> > to speak and not having a public repo where there can be really
> > collaborative development seems to be a step back to me.
>
> ?  But you don't need a central public git repository to do
> collaborative development, that's the whole point of git...

Maybe I still don't get git. Right now there are not many others
interested in winequartzdrv and the only place its hosted is in CVS.
I've got it imported locally and I can publish changesets on
wine-patches or bugzilla but thats going to spam wine-patches or be
very sucky for development if its not ready to merge in to master for
months++ or longer. For a proper push or pull to work, I'd either have
to publish my repo here or someone else would have to pick it up and
import it right? Then we could rebase off of each others changes? We
could push and pull to each other via email and still pull in from
winehq and rebase right? Then wouldn't that imply that I'd have to
push my changes to everyone via a mailing or something or still host
my own public repo if multiple people want to pull from my most recent
bleeding edge broken stuff?

It seems to me that its less trouble to have a central repo hosted
somewhere like repo.or.cz where winehq origin is imported in parallel
and as changes come in they are merged on to a public winequartzdrv
branch. Then I fix the stuff I know I can fix in my local tree like
the keyboard input handling changes, push those changes up, while
leaving other broken stuff like visable region handling for someone
else to work on. If others come along with an existing winehq tree,
they can pull from that repo without much trouble. I've still got my
local git repo I can branch off of and hack the hell out of and cherry
pick patches from, push them up to the winequartdrv branch on the
public repo, etc.

Thats in effect what I have here. I've got a faux-public git repo and
a private repo where I pull winehq origin in I pull the faux-public's
quartzdrv branch in, I rebase winehq on top of my private branch, fix
the changes and then push the new "stable" winequartzdrv up to my
faux-public repos winequartzdrv branch. It would work really well for
others to pull and push from except. A. I don't want to host it on my
cable modem and B. I can't commit to running it due to lack of time
and skill with the code in question. I can do minor enhancements like
fix up the changes for mouse/keyboard handling now that its moved to
the server but as far as actual design and real programming go I don't
view myself and competent enough to waste my or anyone elses time
publicly hosting. I just did all of this as a experiment to teach
myself git.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Mon Feb 11 00:40:29 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 11 Feb 2008 01:40:29 -0500
Subject: Is there a Git Repositories for Unaccept Patches or (work in
	Progress)?
In-Reply-To: <19e31a080802102228x2aa74ebew9b0e83eef3497a0b@mail.gmail.com>
References: <a71bd89a0802101055m2d97cefaw7612fab9e1851fed@mail.gmail.com>
	<19e31a080802101933m11ad2721u1cf3d82ca43e4fa5@mail.gmail.com>
	<47AFCCAA.3080804@sprintpcs.com>
	<19e31a080802102152o48b42326yc7e3cddcd01ab02@mail.gmail.com>
	<19e31a080802102157t4b4107eeu60fd94a0c3560d46@mail.gmail.com>
	<a71bd89a0802102159h2af1c740j13a433631a96e62a@mail.gmail.com>
	<19e31a080802102228x2aa74ebew9b0e83eef3497a0b@mail.gmail.com>
Message-ID: <19e31a080802102240x2d06c00cv7af7b1fd35ee752b@mail.gmail.com>

On Feb 11, 2008 1:28 AM, Steven Edwards <winehacker at gmail.com> wrote:
> It seems to me that its less trouble to have a central repo hosted
> somewhere like repo.or.cz where winehq origin is imported in parallel
> and as changes come in they are merged on to a public winequartzdrv
> branch. Then I fix the stuff I know I can fix in my local tree like

So now that I've spammed the list enough I see in the other thread
people already have branches hosted on repo.or.cz. I guess I will push
my winequartzdrv there. Before these threads I didn't know anyone was
hosting wine related stuff there so send my spam to /dev/null

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From hverbeet at gmail.com  Mon Feb 11 03:04:55 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 11 Feb 2008 10:04:55 +0100
Subject: [1/9] WineD3D: Add a test for the vFace register
In-Reply-To: <200802110156.14545.stefan@codeweavers.com>
References: <200802110156.14545.stefan@codeweavers.com>
Message-ID: <d658b69e0802110104s5ed61fb4tda6e9096dd254de8@mail.gmail.com>

On 11/02/2008, Stefan D?singer <stefan at codeweavers.com> wrote:
> /* TODO: vFace (ps_3_0) */
You should probably remove that one :-)


From lats at yless4u.com.au  Mon Feb 11 03:51:08 2008
From: lats at yless4u.com.au (Jeff Latimer)
Date: Mon, 11 Feb 2008 20:51:08 +1100
Subject: pdh[3:3]: remove unnecessary tests done
	inPdhLookupPerfNameByIndexW
In-Reply-To: <002201c86c5c$e2cbd7a0$a600fea9@DMITRY>
References: <47AEA473.5040402@yless4u.com.au><007701c86be5$78a39b50$a600fea9@DMITRY>
	<47AF4412.3020201@yless4u.com.au>
	<002201c86c5c$e2cbd7a0$a600fea9@DMITRY>
Message-ID: <47B01A8C.6080800@yless4u.com.au>

Dmitry Timoshkov wrote:
> "Jeff Latimer" <lats at yless4u.com.au> wrote:
>
>>>> -    if (machine)
>>>> -    {
>>>> -        FIXME("remote machine not supported\n");
>>>> -        return PDH_CSTATUS_NO_MACHINE;
>>>> -    }
>>>> -
>>>>     if (!buffer || !size) return PDH_INVALID_ARGUMENT;
>>>> -    if (!index) return ERROR_SUCCESS;
>>> Changelog mentions PdhLookupPerfNameByIndexW by the change is in 
>>> PdhLookupPerfNameByIndexA.
>>> Why are you removing the checks in one place by leave the same in 
>>> other one? Why the tests
>>> are unnecessary?
>> The parameters, bufferW and sizeW passed by PdhLookupPerfNameByIndexA 
>> to PdhLookupPerfNameByIndexW are  local to PdhLookupPerfNameByIndexA.
My understanding of your question is: if I am removing the tests in one 
place then they should not be be necessary in the other.  This is not 
the case.  A call to PdhLookupPerfNameByIndexA will call 
PdhLookupPerfNameByIndexW and thus execute the all tests.  The way it is 
at the moment the tests get executed twice (in the negative), this 
change ensures that they only execute once.
>
> That doesn't mean that PdhLookupPerfNameByIndexW can't be called 
> directly.
Correct and that is why the tests are left in place.
>
>> The test is needed still in PdhLookupPerfNameByIndexA because the 
>> size and buffer are not passed but still need to be checked.
>
> That still doesn't answer my questions.
Does this clarify this things?



From dmitry at codeweavers.com  Mon Feb 11 03:59:40 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 11 Feb 2008 17:59:40 +0800
Subject: pdh[3:3]: remove unnecessary tests doneinPdhLookupPerfNameByIndexW
References: <47AEA473.5040402@yless4u.com.au><007701c86be5$78a39b50$a600fea9@DMITRY><47AF4412.3020201@yless4u.com.au><002201c86c5c$e2cbd7a0$a600fea9@DMITRY>
	<47B01A8C.6080800@yless4u.com.au>
Message-ID: <01fc01c86c94$d38cd180$a600fea9@DMITRY>

"Jeff Latimer" <lats at yless4u.com.au> wrote:

> My understanding of your question is: if I am removing the tests in one 
> place then they should not be be necessary in the other.  This is not 
> the case.  A call to PdhLookupPerfNameByIndexA will call 
> PdhLookupPerfNameByIndexW and thus execute the all tests.  The way it is 
> at the moment the tests get executed twice (in the negative), this 
> change ensures that they only execute once.

That's true for index, but not for machine.

-- 
Dmitry.


From lats at yless4u.com.au  Mon Feb 11 04:29:08 2008
From: lats at yless4u.com.au (Jeff Latimer)
Date: Mon, 11 Feb 2008 21:29:08 +1100
Subject: pdh[3:3]: remove unnecessary tests doneinPdhLookupPerfNameByIndexW
In-Reply-To: <01fc01c86c94$d38cd180$a600fea9@DMITRY>
References: <47AEA473.5040402@yless4u.com.au><007701c86be5$78a39b50$a600fea9@DMITRY><47AF4412.3020201@yless4u.com.au><002201c86c5c$e2cbd7a0$a600fea9@DMITRY>
	<47B01A8C.6080800@yless4u.com.au>
	<01fc01c86c94$d38cd180$a600fea9@DMITRY>
Message-ID: <47B02374.8060403@yless4u.com.au>

Dmitry Timoshkov wrote:
> That's true for index, but not for machine.
You are correct. I will resubmit.  I think it will be better to pass 
machine in this case.

Jeff


From dmitry at codeweavers.com  Mon Feb 11 04:34:26 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 11 Feb 2008 18:34:26 +0800
Subject: pdh[3:3]: remove unnecessary tests doneinPdhLookupPerfNameByIndexW
References: <47AEA473.5040402@yless4u.com.au><007701c86be5$78a39b50$a600fea9@DMITRY><47AF4412.3020201@yless4u.com.au><002201c86c5c$e2cbd7a0$a600fea9@DMITRY><47B01A8C.6080800@yless4u.com.au><01fc01c86c94$d38cd180$a600fea9@DMITRY>
	<47B02374.8060403@yless4u.com.au>
Message-ID: <021901c86c99$ae32cca0$a600fea9@DMITRY>

"Jeff Latimer" <lats at yless4u.com.au> wrote:

> I think it will be better to pass 
> machine in this case.

Yes, it just needs to be converted to unicode first.

-- 
Dmitry.


From josef.reidinger at gmail.com  Mon Feb 11 04:55:53 2008
From: josef.reidinger at gmail.com (Josef Reidinger)
Date: Mon, 11 Feb 2008 11:55:53 +0100
Subject: IStream interface for domdoc and terminate call
Message-ID: <47B029B9.6010201@gmail.com>

Hi, I try make IStream write interface for domdoc (msxml3). Problem is 
that microsoft doesn't have terminate string for write call and libxml 
have proble with it (more at 
http://mail.gnome.org/archives/xml/2008-February/msg00052.html ). Does 
anyone has any idea how solve it? (test in each dom call if is some 
nonparsed characters and force parsing looks very ugly).
JR


From kornelpal at gmail.com  Mon Feb 11 05:57:34 2008
From: kornelpal at gmail.com (=?iso-8859-1?B?S29ybulsIFDhbA==?=)
Date: Mon, 11 Feb 2008 12:57:34 +0100
Subject: IStream interface for domdoc and terminate call
References: <47B029B9.6010201@gmail.com>
Message-ID: <003a01c86ca5$4aecdda0$0100a8c0@kornelpal.hu>

Hi,

If you mean passing an IStream interface to DOMDocument.save method:
As far as I know save method is synchronous (if I'm wrong you still can set 
the async property to FALSE). So when the save method returns you know that 
the entire document has been passed to the IStream.

If you want to do something else please be more specific.

Korn?l

----- Original Message ----- 
From: "Josef Reidinger" <josef.reidinger at gmail.com>
To: <wine-devel at winehq.org>
Sent: Monday, February 11, 2008 11:55 AM
Subject: IStream interface for domdoc and terminate call


> Hi, I try make IStream write interface for domdoc (msxml3). Problem is
> that microsoft doesn't have terminate string for write call and libxml
> have proble with it (more at
> http://mail.gnome.org/archives/xml/2008-February/msg00052.html ). Does
> anyone has any idea how solve it? (test in each dom call if is some
> nonparsed characters and force parsing looks very ugly).
> JR
>
> 



From kornelpal at gmail.com  Mon Feb 11 06:15:29 2008
From: kornelpal at gmail.com (=?iso-8859-1?B?S29ybulsIFDhbA==?=)
Date: Mon, 11 Feb 2008 13:15:29 +0100
Subject: IStream interface for domdoc and terminate call
References: <47B029B9.6010201@gmail.com>
	<003a01c86ca5$4aecdda0$0100a8c0@kornelpal.hu>
	<47B03863.2060001@gmail.com>
Message-ID: <005501c86ca7$cb9c1040$0100a8c0@kornelpal.hu>

OK, sorry I didn't realized that you try to modify the Wine implementation.

I think that delaying pasing for the fist time you call a method of the 
DOMDocument object would be a good solution. This way you will not perform 
any unnecessary parings.

I don't know the exact details of MS implementations so you should check 
when and how are parsing errors reported and when is the parsed document 
available when you write the DOMDocument throug it's IStream interface and 
you should dealy parsing to the latest possible time.

Korn?l

----- Original Message ----- 
From: "Josef Reidinger" <josef.reidinger at gmail.com>
To: "Korn?l P?l" <kornelpal at gmail.com>
Sent: Monday, February 11, 2008 12:58 PM
Subject: Re: IStream interface for domdoc and terminate call


> Hi
> I mean using call IStream_write like it is describe in bug #4811.
>
> Korn?l P?l napsal(a):
>> Hi,
>>
>> If you mean passing an IStream interface to DOMDocument.save method:
>> As far as I know save method is synchronous (if I'm wrong you still can 
>> set the async property to FALSE). So when the save method returns you 
>> know that the entire document has been passed to the IStream.
>>
>> If you want to do something else please be more specific.
>>
>> Korn?l
>>
>> ----- Original Message ----- From: "Josef Reidinger" 
>> <josef.reidinger at gmail.com>
>> To: <wine-devel at winehq.org>
>> Sent: Monday, February 11, 2008 11:55 AM
>> Subject: IStream interface for domdoc and terminate call
>>
>>
>>> Hi, I try make IStream write interface for domdoc (msxml3). Problem is
>>> that microsoft doesn't have terminate string for write call and libxml
>>> have proble with it (more at
>>> http://mail.gnome.org/archives/xml/2008-February/msg00052.html ). Does
>>> anyone has any idea how solve it? (test in each dom call if is some
>>> nonparsed characters and force parsing looks very ugly).
>>> JR
>>>
>>>
>>
> 



From kornelpal at gmail.com  Mon Feb 11 06:30:53 2008
From: kornelpal at gmail.com (=?iso-8859-1?B?S29ybulsIFDhbA==?=)
Date: Mon, 11 Feb 2008 13:30:53 +0100
Subject: IStream interface for domdoc and terminate call
Message-ID: <007f01c86ca9$f30234a0$0100a8c0@kornelpal.hu>

Also note you should test the behavior when call QueryInterface for IStream 
multiple times whether a new wrapper or the same wrapper is returned and 
whether the tree is cleared on QueryInterface. And I forgot to mention that 
calling Release on the IStream interface is the correct way of disposing the 
interface so that call may have effect on the object as well.

Korn?l

----- Original Message ----- 
From: "Korn?l P?l" <kornelpal at gmail.com>
To: "Josef Reidinger" <josef.reidinger at gmail.com>; <wine-devel at winehq.org>
Sent: Monday, February 11, 2008 1:15 PM
Subject: Re: IStream interface for domdoc and terminate call


> OK, sorry I didn't realized that you try to modify the Wine
> implementation.
>
> I think that delaying pasing for the fist time you call a method of the
> DOMDocument object would be a good solution. This way you will not perform
> any unnecessary parings.
>
> I don't know the exact details of MS implementations so you should check
> when and how are parsing errors reported and when is the parsed document
> available when you write the DOMDocument throug it's IStream interface and
> you should dealy parsing to the latest possible time.
>
> Korn?l
>
> ----- Original Message ----- 
> From: "Josef Reidinger" <josef.reidinger at gmail.com>
> To: "Korn?l P?l" <kornelpal at gmail.com>
> Sent: Monday, February 11, 2008 12:58 PM
> Subject: Re: IStream interface for domdoc and terminate call
>
>
>> Hi
>> I mean using call IStream_write like it is describe in bug #4811.
>>
>> Korn?l P?l napsal(a):
>>> Hi,
>>>
>>> If you mean passing an IStream interface to DOMDocument.save method:
>>> As far as I know save method is synchronous (if I'm wrong you still can
>>> set the async property to FALSE). So when the save method returns you
>>> know that the entire document has been passed to the IStream.
>>>
>>> If you want to do something else please be more specific.
>>>
>>> Korn?l
>>>
>>> ----- Original Message ----- From: "Josef Reidinger"
>>> <josef.reidinger at gmail.com>
>>> To: <wine-devel at winehq.org>
>>> Sent: Monday, February 11, 2008 11:55 AM
>>> Subject: IStream interface for domdoc and terminate call
>>>
>>>
>>>> Hi, I try make IStream write interface for domdoc (msxml3). Problem is
>>>> that microsoft doesn't have terminate string for write call and libxml
>>>> have proble with it (more at
>>>> http://mail.gnome.org/archives/xml/2008-February/msg00052.html ). Does
>>>> anyone has any idea how solve it? (test in each dom call if is some
>>>> nonparsed characters and force parsing looks very ugly).
>>>> JR
>>>>
>>>>
>>>
>>
>



From kgbricola at web.de  Mon Feb 11 12:39:27 2008
From: kgbricola at web.de (=?ISO-8859-1?Q?Rico_Sch=FCller?=)
Date: Mon, 11 Feb 2008 19:39:27 +0100
Subject: Resend patch from Norbert
In-Reply-To: <47A4E2D3.8050305@kievinfo.com>
References: <47A4CDC3.2030905@web.de> <47A4E2D3.8050305@kievinfo.com>
Message-ID: <47B0965F.6020002@web.de>

Vitaliy Margolen wrote:
> Rico Sch?ller wrote:
>> Hi,
>>
>> I only resend a patch because it isn't in the todays git and the author 
>> didn't answer for a while.
>>
>> Cheers
>> Rico
>>
>>
>> ------------------------------------------------------------------------
>>
>>
>> -    memcpy(pRect, &This->updateStateBlock->scissorRect, sizeof(pRect));
>> +    memcpy(pRect, &This->updateStateBlock->scissorRect, sizeof(RECT));
> 
> To avoid such problems in the future one should use something like:
> 
>      *pRect = This->updateStateBlock->scissorRect;
> 
> Doing a quick search through wined3d I've found number of places with memcpy 
> instead of simple assignment of one struct to another struct. This is a good 
> janitorial task to get rid of memcpy where simple assignment will work.
> 
> Vitaliy.
> 
> 
> 

Is this the reason why this patch isn't excepted? Or is there any other 
reason?

Cheers
Rico


From stefan at codeweavers.com  Mon Feb 11 13:13:35 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 11 Feb 2008 20:13:35 +0100
Subject: Resend patch from Norbert
In-Reply-To: <47B0965F.6020002@web.de>
References: <47A4CDC3.2030905@web.de> <47A4E2D3.8050305@kievinfo.com>
	<47B0965F.6020002@web.de>
Message-ID: <200802112013.35677.stefan@codeweavers.com>

Am Montag, 11. Februar 2008 19:39:27 schrieb Rico Sch?ller:
> Vitaliy Margolen wrote:
> > Rico Sch?ller wrote:
> >> Hi,
> >>
> >> I only resend a patch because it isn't in the todays git and the author
> >> didn't answer for a while.
> >>
> >> Cheers
> >> Rico
> >>
> >>
> >> ------------------------------------------------------------------------
> >>
> >>
> >> -    memcpy(pRect, &This->updateStateBlock->scissorRect, sizeof(pRect));
> >> +    memcpy(pRect, &This->updateStateBlock->scissorRect, sizeof(RECT));
> >
> > To avoid such problems in the future one should use something like:
> >
> >      *pRect = This->updateStateBlock->scissorRect;
> >
> > Doing a quick search through wined3d I've found number of places with
> > memcpy instead of simple assignment of one struct to another struct. This
> > is a good janitorial task to get rid of memcpy where simple assignment
> > will work.
> >
> > Vitaliy.
>
> Is this the reason why this patch isn't excepted? Or is there any other
> reason?
I think because the suggested assignment is prefered over the memcpy that the 
patch uses


From dank at kegel.com  Mon Feb 11 19:58:03 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 11 Feb 2008 17:58:03 -0800
Subject: dbghelp/dwarf.c: new valgrind warnings?
Message-ID: <a71bd89a0802111758j6928b613u3a31bbf3307dbe6a@mail.gmail.com>

I'm now seeing some new valgrind warnings when
wine is doing stack dumps after crashes:

+ Conditional jump or move depends on uninitialised value(s)
+    at  dwarf2_load_one_entry (dwarf.c:983)
+    by  dwarf2_lookup_type (dwarf.c:858)
+    by  dwarf2_load_one_entry (dwarf.c:1020)
+    by  dwarf2_parse (dwarf.c:2060)
+    by  elf_load_debug_info (elf_module.c:1085)
+    by  module_get_debug (module.c:303)
+    by  SymFromAddr (symbol.c:1071)
+    by  stack_get_current_symbol (stack.c:143)
+    by  display_print (display.c:174)
+    by  wait_exception (tgt_active.c:178)
+    by  dbg_active_auto (tgt_active.c:951)
+    by  main (winedbg.c:544)

I don't know when this started, but maybe it's related
to recent changes by Eric Pouech?
- Dan


From dank at kegel.com  Mon Feb 11 20:15:10 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 11 Feb 2008 18:15:10 -0800
Subject: gecko valgrind errors show up better now
Message-ID: <a71bd89a0802111815s5a123a46tc222ba1740fcd570@mail.gmail.com>

The new version of valgrind shows better stack
dumps for gecko valgrind errors.  For instance,

 Invalid read of size 4
    at  (within 0.1.0/wine_gecko/components/xppref32.dll)
    by  (within 0.1.0/wine_gecko/components/xppref32.dll)
    by  (within 0.1.0/wine_gecko/components/xppref32.dll)
    by  (within 0.1.0/wine_gecko/components/xppref32.dll)
    by  (within 0.1.0/wine_gecko/components/xppref32.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/components/necko.dll)
    by  (within 0.1.0/wine_gecko/components/necko.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/components/necko.dll)
    by  (within 0.1.0/wine_gecko/components/necko.dll)
    by  load_gecko (nsembed.c:396)
    by  NSContainer_Create (nsembed.c:1574)
    by  HTMLDocument_Create (htmldoc.c:1232)
    by  ClassFactory_CreateInstance (main.c:206)
    by  CoCreateInstance (compobj.c:2411)
    by  report_data (binding.c:444)
    by  report_data_proc (binding.c:1262)
  Address 0x7f22e1e0 is not stack'd, malloc'd or (recently) free'd

 Invalid read of size 4
    at  (within 0.1.0/wine_gecko/components/rdf.dll)
    by  (within 0.1.0/wine_gecko/components/rdf.dll)
    by  (within 0.1.0/wine_gecko/components/chrome.dll)
    by  (within 0.1.0/wine_gecko/components/chrome.dll)
    by  (within 0.1.0/wine_gecko/components/chrome.dll)
    by  (within 0.1.0/wine_gecko/components/chrome.dll)
    by  (within 0.1.0/wine_gecko/components/chrome.dll)
    by  (within 0.1.0/wine_gecko/components/chrome.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/components/profile.dll)
    by  (within 0.1.0/wine_gecko/components/profile.dll)
    by  load_gecko (nsembed.c:338)
    by  NSContainer_Create (nsembed.c:1574)
    by  HTMLDocument_Create (htmldoc.c:1232)
    by  ClassFactory_CreateInstance (main.c:206)
    by  CoCreateInstance (compobj.c:2411)
    by  report_data (binding.c:444)
    by  report_data_proc (binding.c:1262)
    by  notif_wnd_proc (binding.c:184)
  Address 0x7f22e108 is not stack'd, malloc'd or (recently) free'd

 Conditional jump or move depends on uninitialised value(s)
    at  (within 0.1.0/wine_gecko/components/necko.dll)
    by  nsURI_QueryInterface (nsio.c:1181)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/components/necko.dll)
    by  (within 0.1.0/wine_gecko/components/necko.dll)
    by  nsIOService_NewChannelFromURI (nsio.c:2111)
    by  (within 0.1.0/wine_gecko/components/rdf.dll)
    by  (within 0.1.0/wine_gecko/components/rdf.dll)
    by  (within 0.1.0/wine_gecko/components/rdf.dll)
    by  (within 0.1.0/wine_gecko/components/chrome.dll)
    by  (within 0.1.0/wine_gecko/components/chrome.dll)
    by  (within 0.1.0/wine_gecko/components/chrome.dll)
    by  (within 0.1.0/wine_gecko/components/chrome.dll)
    by  (within 0.1.0/wine_gecko/components/chrome.dll)
    by  (within 0.1.0/wine_gecko/components/chrome.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/components/profile.dll)
    by  (within 0.1.0/wine_gecko/components/profile.dll)
    by  load_gecko (nsembed.c:338)

 Invalid read of size 4
    at  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/components/xpc3250.dll)
    by  (within 0.1.0/wine_gecko/components/xpc3250.dll)
    by  (within 0.1.0/wine_gecko/components/xpc3250.dll)
    by  (within 0.1.0/wine_gecko/components/xpc3250.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/xpcom_core.dll)
    by  (within 0.1.0/wine_gecko/components/profile.dll)
    by  load_gecko (nsembed.c:338)
    by  NSContainer_Create (nsembed.c:1574)
    by  HTMLDocument_Create (htmldoc.c:1232)
    by  ClassFactory_CreateInstance (main.c:206)
    by  CoCreateInstance (compobj.c:2411)
    by  report_data (binding.c:444)
    by  report_data_proc (binding.c:1262)
    by  notif_wnd_proc (binding.c:184)
    by  (within /home/dank/wine-git/dlls/user32/user32.dll.so)
  Address 0x7f22d1a8 is not stack'd, malloc'd or (recently) free'd

etc., etc.  Jacek, if you can give me a debug build of gecko,
I can probably give you even better info.  Interested?
- Dan


From leslie_alistair at hotmail.com  Mon Feb 11 21:54:55 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Tue, 12 Feb 2008 14:54:55 +1100
Subject: Regesstion Tests
Message-ID: <for5fi$q9j$1@ger.gmane.org>

Hi,
   If I have Msxml3 with SP7 installed all the msxml tests pass without 
issue, but if I have Msxml3 SP3 installed, some fail.

Should I improve the tests so that they can handle both cases?

Best Regards
 Alistair Leslie-Hughes 




From dimi at lattica.com  Mon Feb 11 22:15:03 2008
From: dimi at lattica.com (Dimi Paun)
Date: Mon, 11 Feb 2008 23:15:03 -0500
Subject: comctl32: Fixed listview bug, when client sends bogus
	SETITEMSTATE request
In-Reply-To: <1202783301.3002.1.camel@dhcppc4>
References: <20080212020528.BKTV10334.fep25.mail.dk@wine.codeweavers.com>
	<1202783301.3002.1.camel@dhcppc4>
Message-ID: <1202789703.9215.253.camel@dimi.lattica.com>


On Tue, 2008-02-12 at 03:28 +0100, Peter Dons Tychsen wrote:
> Fixed listview bug, when client sends bogus SETITEMSTATE request,
> requesting all items to be focused.

Looks good, tnx!

-- 
Dimi Paun <dimi at lattica.com>
Lattica, Inc.



From dank at kegel.com  Tue Feb 12 00:05:20 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 11 Feb 2008 22:05:20 -0800
Subject: Regular bugzilla hygeine
Message-ID: <a71bd89a0802112205y77be8c61j5d2768a0d103d44b@mail.gmail.com>

When we do a release, all the bugs in RESOLVED FIXED
state can be closed (since they were only waiting
on a release to be closed).
We haven't been doing that, and as a result, lots
and lots of bugs stacked up in RESOLVED FIXED state.
But I don't see any reason we shouldn't start doing it,
so I'm about to do it in honor of the 0.9.55 release.

(I think I've figured out how to avoid changing any
bugs flipped into that state since the 0.9.55 release,
let's see if I get it right.  Next time I'll do it right
when Alexandre releases.)
- Dan


-- 
Wine for Windows ISVs: http://kegel.com/wine/isv


From paul.vriens.wine at gmail.com  Tue Feb 12 00:53:05 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 12 Feb 2008 07:53:05 +0100
Subject: Regesstion Tests
In-Reply-To: <for5fi$q9j$1@ger.gmane.org>
References: <for5fi$q9j$1@ger.gmane.org>
Message-ID: <47B14251.1090601@gmail.com>

Alistair Leslie-Hughes wrote:
> Hi,
>    If I have Msxml3 with SP7 installed all the msxml tests pass without 
> issue, but if I have Msxml3 SP3 installed, some fail.
> 
> Should I improve the tests so that they can handle both cases?
> 
> Best Regards
>  Alistair Leslie-Hughes 
> 
> 
> 
> 
> 
Hi,

The general rule is to have the tests pass on all versions of OS/applications/dll's.

This has to be done, if possible, by checking behavior instead of retrieving 
version information.

-- 
Cheers,

Paul.


From dmitry at codeweavers.com  Tue Feb 12 05:40:15 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 12 Feb 2008 19:40:15 +0800
Subject: Oleview: Added Dutch translations
References: <47B17E8A.20101@gmail.com>
Message-ID: <000c01c86d6c$0ad49a60$a600fea9@DMITRY>

"Frans Kool" <frans.kool at gmail.com> wrote:

> From 2e5bda68273038f924f8f0d1b325a2a4c71f17ae Mon Sep 17 00:00:00 2001
> From: Frans Kool <Frans.Kool at gmail.com>
> Date: Tue, 12 Feb 2008 12:04:56 +0100
> Subject: Oleview: Added Dutch translations

This your patch as well as a previous one are wrapped.

-- 
Dmitry.



From dmitry at codeweavers.com  Tue Feb 12 08:41:59 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 12 Feb 2008 22:41:59 +0800
Subject: browseui: Add undocumented Component Category Cache Daemon class
References: <b130c85e0802111031o3831d661s78410a801e81fc84@mail.gmail.com>
Message-ID: <006e01c86d85$6e004ad0$a600fea9@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

> --- /dev/null
> +++ b/dlls/browseui/compcatcachedaemon.c
> @@ -0,0 +1,159 @@
> +/*
> + * Progress dialog
> + *
> + * Copyright 2007 Mikolaj Zalewski

Is the above information correct?

-- 
Dmitry.


From paul.vriens.wine at gmail.com  Tue Feb 12 10:42:13 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 12 Feb 2008 17:42:13 +0100
Subject: [winetest] Would it be worthwhile to send zipped version of the
	reports?
Message-ID: <47B1CC65.9030207@gmail.com>

Hi,

As more and more tests are developed I think it could make sense to zip the 
report files before sending.

It will of course put a small extra burden on the winehq server but as the 
reports are text only we gain a 90% or so per report.

Thoughts?

-- 
Cheers,

Paul.


From truiken at gmail.com  Tue Feb 12 10:43:51 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 12 Feb 2008 10:43:51 -0600
Subject: [advapi32/tests] Only use functions if they are implemented
In-Reply-To: <47B1CAB2.1010707@gmail.com>
References: <47B1CAB2.1010707@gmail.com>
Message-ID: <22821af30802120843h818df67w40ec4b545fb8f221@mail.gmail.com>

On Feb 12, 2008 10:34 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi,
>
> Added some verbosity to the GetProcAddress stuff. The skips prevent the
> crash(es) I'm seeing on win95.
>

What is the point of this 'verbosity'?  You already add the skips, so
if a function isn't available for a test, you're going to see it twice
now.  Also, it adds to the code size.

-- 
James Hawkins


From paul.vriens.wine at gmail.com  Tue Feb 12 11:00:15 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 12 Feb 2008 18:00:15 +0100
Subject: [advapi32/tests] Only use functions if they are implemented
In-Reply-To: <22821af30802120843h818df67w40ec4b545fb8f221@mail.gmail.com>
References: <47B1CAB2.1010707@gmail.com>
	<22821af30802120843h818df67w40ec4b545fb8f221@mail.gmail.com>
Message-ID: <47B1D09F.1040007@gmail.com>

James Hawkins wrote:
> On Feb 12, 2008 10:34 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> Hi,
>>
>> Added some verbosity to the GetProcAddress stuff. The skips prevent the
>> crash(es) I'm seeing on win95.
>>
> 
> What is the point of this 'verbosity'?  You already add the skips, so
> if a function isn't available for a test, you're going to see it twice
> now.  Also, it adds to the code size.
> 
I did the 'verbosity' to find out the missing functions before I did the skips 
in the first place. As a lot of the tests are still not running on all platforms 
I've added these extra trace.

If needed I'll sent a patch with just the skips.

There are a lot of tests already with these extra traces (and yes I'm guilty). 
Maybe we should have a janitorial task once we have a green testpage.

-- 
Cheers,

Paul.


From msclrhd at googlemail.com  Tue Feb 12 10:57:53 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 12 Feb 2008 16:57:53 +0000
Subject: [winetest] Would it be worthwhile to send zipped version of the
	reports?
In-Reply-To: <47B1CC65.9030207@gmail.com>
References: <47B1CC65.9030207@gmail.com>
Message-ID: <3f4fd2640802120857k3481afa9h42fad1708c457928@mail.gmail.com>

On 12/02/2008, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi,
>
> As more and more tests are developed I think it could make sense to zip the
> report files before sending.
>
> It will of course put a small extra burden on the winehq server but as the
> reports are text only we gain a 90% or so per report.
>
> Thoughts?

This is a good idea, although gzip or bzip2 would be better, and they
can be embedded into the winetest application.

It would also mean that we can finally get a full run of the Vista
tests, as they will then be under the 1.5MB file limit!

- Reece


From paul.vriens.wine at gmail.com  Tue Feb 12 11:05:13 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 12 Feb 2008 18:05:13 +0100
Subject: [winetest] Would it be worthwhile to send zipped version of the
	reports?
In-Reply-To: <3f4fd2640802120857k3481afa9h42fad1708c457928@mail.gmail.com>
References: <47B1CC65.9030207@gmail.com>
	<3f4fd2640802120857k3481afa9h42fad1708c457928@mail.gmail.com>
Message-ID: <47B1D1C9.3050508@gmail.com>

Reece Dunn wrote:
> On 12/02/2008, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> Hi,
>>
>> As more and more tests are developed I think it could make sense to zip the
>> report files before sending.
>>
>> It will of course put a small extra burden on the winehq server but as the
>> reports are text only we gain a 90% or so per report.
>>
>> Thoughts?
> 
> This is a good idea, although gzip or bzip2 would be better, and they
> can be embedded into the winetest application.
> 
> It would also mean that we can finally get a full run of the Vista
> tests, as they will then be under the 1.5MB file limit!
> 
> - Reece
> 
Hi,

Well I should have said 'compressed' cause I'm not in favor of any compression 
currently as long as the files get smaller.

-- 
Cheers,

Paul.


From eric.pouech at orange.fr  Tue Feb 12 14:26:04 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Tue, 12 Feb 2008 21:26:04 +0100
Subject: dbghelp/dwarf.c: new valgrind warnings?
In-Reply-To: <a71bd89a0802111758j6928b613u3a31bbf3307dbe6a@mail.gmail.com>
References: <a71bd89a0802111758j6928b613u3a31bbf3307dbe6a@mail.gmail.com>
Message-ID: <47B200DC.9090304@orange.fr>

Dan Kegel a ?crit :
> I'm now seeing some new valgrind warnings when
> wine is doing stack dumps after crashes:
>
> + Conditional jump or move depends on uninitialised value(s)
> +    at  dwarf2_load_one_entry (dwarf.c:983)
> +    by  dwarf2_lookup_type (dwarf.c:858)
> +    by  dwarf2_load_one_entry (dwarf.c:1020)
> +    by  dwarf2_parse (dwarf.c:2060)
> +    by  elf_load_debug_info (elf_module.c:1085)
> +    by  module_get_debug (module.c:303)
> +    by  SymFromAddr (symbol.c:1071)
> +    by  stack_get_current_symbol (stack.c:143)
> +    by  display_print (display.c:174)
> +    by  wait_exception (tgt_active.c:178)
> +    by  dbg_active_auto (tgt_active.c:951)
> +    by  main (winedbg.c:544)
>
> I don't know when this started, but maybe it's related
> to recent changes by Eric Pouech?
>   
my bad
patch sent to wine-patched
thx for spotting it
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From donpedro at tdcadsl.dk  Tue Feb 12 17:39:52 2008
From: donpedro at tdcadsl.dk (Peter Dons Tychsen)
Date: Wed, 13 Feb 2008 00:39:52 +0100
Subject: ddraw - Implement correct behavior for the DDEDM_REFRESHRATES flag
	in EnumDisplayModes() - REJECTED.
Message-ID: <1202859592.5660.3.camel@dhcppc4>

Hi Devs.

I had this patch silently rejected.
Can anybody spot what is wrong with this patch?

It is really needed for some older games like Grand Theft Auto,
and other oldies (but goodies!).

/pedro
-------------- next part --------------
An embedded message was scrubbed...
From: Peter Dons Tychsen <donpedro at tdcadsl.dk>
Subject: ddraw - Implement correct behavior for the DDEDM_REFRESHRATES flag
	in EnumDisplayModes().
Date: Fri, 04 Jan 2008 01:18:14 +0100
Size: 5549
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080213/0d43f772/attachment.eml 

From stefan at codeweavers.com  Tue Feb 12 17:50:20 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 13 Feb 2008 00:50:20 +0100
Subject: ddraw - Implement correct behavior for the DDEDM_REFRESHRATES
	flag in EnumDisplayModes() - REJECTED.
In-Reply-To: <1202859592.5660.3.camel@dhcppc4>
References: <1202859592.5660.3.camel@dhcppc4>
Message-ID: <200802130050.20918.stefan@codeweavers.com>

Am Mittwoch, 13. Februar 2008 00:39:52 schrieb Peter Dons Tychsen:
> Hi Devs.
>
> I had this patch silently rejected.
> Can anybody spot what is wrong with this patch?
My first thought was that filtering the modes like this is kinda ugly, but 
given that ddraw uses wined3d and wined3d uses the d3d9 interface this is the 
only way. (I don't think adding an extra flag to wined3d is cleaner, 
considering that ddraw can sort this out on its own).

However, I think you shouldn't clone the application's bug you're trying to 
work around and deal with the "out of mode buffer" case. you can e.g. use 
HeapReAlloc to increase the buffer without loosing the content.

Another minor thing is the if(buffer) HeapFree(buffer) code. HeapFree checks 
against NULL, so the extra check isn't needed, and it is sorta a policy not 
to have redundant checks before HeapFree



From donpedro at tdcadsl.dk  Tue Feb 12 18:16:30 2008
From: donpedro at tdcadsl.dk (Peter Dons Tychsen)
Date: Wed, 13 Feb 2008 01:16:30 +0100
Subject: ddraw - Implement correct behavior for the DDEDM_REFRESHRATES
	flag in EnumDisplayModes() - REJECTED.
In-Reply-To: <20080212235047.TUDW1374.fep29.mail.dk@mail.codeweavers.com>
References: <1202859592.5660.3.camel@dhcppc4>
	<20080212235047.TUDW1374.fep29.mail.dk@mail.codeweavers.com>
Message-ID: <1202861790.5660.6.camel@dhcppc4>

Hi Stefan.

OK thanks for the fast, precise and well-cut review (and probably
correct).

I will fix the 3 issues and re-submit.

/p

On Wed, 2008-02-13 at 00:50 +0100, Stefan D?singer wrote:
> Am Mittwoch, 13. Februar 2008 00:39:52 schrieb Peter Dons Tychsen:
> > Hi Devs.
> >
> > I had this patch silently rejected.
> > Can anybody spot what is wrong with this patch?
> My first thought was that filtering the modes like this is kinda ugly, but 
> given that ddraw uses wined3d and wined3d uses the d3d9 interface this is the 
> only way. (I don't think adding an extra flag to wined3d is cleaner, 
> considering that ddraw can sort this out on its own).
> 
> However, I think you shouldn't clone the application's bug you're trying to 
> work around and deal with the "out of mode buffer" case. you can e.g. use 
> HeapReAlloc to increase the buffer without loosing the content.
> 
> Another minor thing is the if(buffer) HeapFree(buffer) code. HeapFree checks 
> against NULL, so the extra check isn't needed, and it is sorta a policy not 
> to have redundant checks before HeapFree
> 



From donpedro at tdcadsl.dk  Tue Feb 12 19:14:12 2008
From: donpedro at tdcadsl.dk (Peter Dons Tychsen)
Date: Wed, 13 Feb 2008 02:14:12 +0100
Subject: Alsa spitting out warnings every time Wine runs.
Message-ID: <1202865252.5660.15.camel@dhcppc4>

Hi Maarten & Devs.

Great to see that audio is so much better in Wine now.

But....
On fedora core 6 and 8 i get this every time i start Wine:

ALSA lib conf.c:3949:(snd_config_expand) Unknown parameters 0
ALSA lib pcm.c:2145:(snd_pcm_open_noupdate) Unknown PCM default:0
ALSA lib conf.c:3949:(snd_config_expand) Unknown parameters 0
ALSA lib pcm.c:2145:(snd_pcm_open_noupdate) Unknown PCM default:0

I think its harmless, but what do you it means?
How do i stop it? Should i fix it in Wine or Alsa?

/p



From stefan at codeweavers.com  Tue Feb 12 19:26:57 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 13 Feb 2008 02:26:57 +0100
Subject: d3d: Add a slight delay before testing the ddraw and d3d9 visual
	tests
In-Reply-To: <b130c85e0802121725g5eb77f73k8c4c85a8a21173fe@mail.gmail.com>
References: <b130c85e0802121725g5eb77f73k8c4c85a8a21173fe@mail.gmail.com>
Message-ID: <200802130226.57441.stefan@codeweavers.com>

Am Mittwoch, 13. Februar 2008 02:25:30 schrieb Maarten Lankhorst:
> This makes the tests pass on my pc.

d3d8 might need it as well


From m.b.lankhorst at gmail.com  Tue Feb 12 20:09:18 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 12 Feb 2008 18:09:18 -0800
Subject: Fixing the last failing tests
Message-ID: <b130c85e0802121809v67ffe2f1mae9baa944de26cb3@mail.gmail.com>

Hi all,

I'm very close to passing the whole wine conformance suite on my pc.
The only tests failing are in user32. These tests are failing in any
version of windows though. How do I make them pass on at least 1
version of windows and wine? Would patches to make it run on xp and
wine be accepted?

And if I can succeed with that, how do I make it work with other
versions of windows as well.

Cheers,
Maarten.

An example is IsWindowUnicode. It always returns TRUE on XP, but it
won't do that on 9x. That would mean something like:
ok(IsWindowUnicode() || !IsWindowUnicode(), "How can this fail?");


From donpedro at tdcadsl.dk  Tue Feb 12 20:11:24 2008
From: donpedro at tdcadsl.dk (Peter Dons Tychsen)
Date: Wed, 13 Feb 2008 03:11:24 +0100
Subject: d3d: Add a slight delay before testing the ddraw and d3d9
	visual tests
In-Reply-To: <20080213013044.ZOPJ11715.fep26.mail.dk@wine.codeweavers.com>
References: <b130c85e0802121725g5eb77f73k8c4c85a8a21173fe@mail.gmail.com>
	<20080213013044.ZOPJ11715.fep26.mail.dk@wine.codeweavers.com>
Message-ID: <1202868684.5660.21.camel@dhcppc4>

Eh, this does not seem like a proper way to get a unit test to pass.

Sleep()... that leads to the dark side! :-)

Why does it need a Sleep()? If its failing on Wine, then shouldn't it be
fixed in the libs? And if its on orig-winxp-vista then there must be a
better way to wait? Or no?

The string "This makes the tests pass on my pc" isn't very good either.
What system?

In general, introducing magic Sleep() values in code is not a good idea.
If the test system is stressed, you will start getting failures again =
bad idea.

/p


On Wed, 2008-02-13 at 02:26 +0100, Stefan D?singer wrote:
> Am Mittwoch, 13. Februar 2008 02:25:30 schrieb Maarten Lankhorst:
> > This makes the tests pass on my pc.
> 
> d3d8 might need it as well
> 
> 



From donpedro at tdcadsl.dk  Tue Feb 12 20:16:31 2008
From: donpedro at tdcadsl.dk (Peter Dons Tychsen)
Date: Wed, 13 Feb 2008 03:16:31 +0100
Subject: Fixing the last failing tests
In-Reply-To: <20080213021049.UFVC22541.fep23.mail.dk@wine.codeweavers.com>
References: <20080213021049.UFVC22541.fep23.mail.dk@wine.codeweavers.com>
Message-ID: <1202868991.5660.25.camel@dhcppc4>

Hello M.

What is wrong with detecting the version, and branching the test code
accordingly? Other tests do that IIRC. I think that is a better
solution, if the version selector in winecfg is still going to be
meaningful (registry).

How about fixing the functions as well (like IsWindowUnicode),
so it returns the correct data according to the version in winecfg
(registry).

However, i do like the irony in your example :-)

/pedro


On Tue, 2008-02-12 at 18:09 -0800, Maarten Lankhorst wrote:
> Hi all,
> 
> I'm very close to passing the whole wine conformance suite on my pc.
> The only tests failing are in user32. These tests are failing in any
> version of windows though. How do I make them pass on at least 1
> version of windows and wine? Would patches to make it run on xp and
> wine be accepted?
> 
> And if I can succeed with that, how do I make it work with other
> versions of windows as well.
> 
> Cheers,
> Maarten.
> 
> An example is IsWindowUnicode. It always returns TRUE on XP, but it
> won't do that on 9x. That would mean something like:
> ok(IsWindowUnicode() || !IsWindowUnicode(), "How can this fail?");
> 
> 



From dank at kegel.com  Tue Feb 12 20:20:59 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 12 Feb 2008 18:20:59 -0800
Subject: Fixing the last failing tests
Message-ID: <a71bd89a0802121820s440d1298k560aa2e9e14ea70f@mail.gmail.com>

Maarten wrote:
> An example is IsWindowUnicode. It always returns TRUE on XP, but it
> won't do that on 9x. That would mean something like:
> ok(IsWindowUnicode() || !IsWindowUnicode(), "How can this fail?");

Maybe you can do something like
  if (CreateWindowExW doesn't work) {
    /* win95 without MSLU */
    ok(!IsWindowUnicode());
  } else {
    /* win95 with MSLU, or something with native unicode support */
    ok(IsWindowUnicode());
  }


From truiken at gmail.com  Tue Feb 12 20:21:32 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 12 Feb 2008 20:21:32 -0600
Subject: Fixing the last failing tests
In-Reply-To: <1202868991.5660.25.camel@dhcppc4>
References: <20080213021049.UFVC22541.fep23.mail.dk@wine.codeweavers.com>
	<1202868991.5660.25.camel@dhcppc4>
Message-ID: <22821af30802121821p2f73b1ebib29cfa7bc4d870ef@mail.gmail.com>

On Feb 12, 2008 8:16 PM, Peter Dons Tychsen <donpedro at tdcadsl.dk> wrote:
> Hello M.
>
> What is wrong with detecting the version, and branching the test code
> accordingly? Other tests do that IIRC. I think that is a better
> solution, if the version selector in winecfg is still going to be
> meaningful (registry).
>

The only time the tests should check for the windows version is if we
know an app does the same thing, which is hardly ever.

P.S. Please bottom-post on this mailing list.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Tue Feb 12 21:04:41 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 12 Feb 2008 19:04:41 -0800
Subject: Fwd: Congratulation!!!
In-Reply-To: <OF4CFE3E3F.B5406085-ONC12573EE.000E1660-C12573EE.000E166E@esplugues.org>
References: <OF4CFE3E3F.B5406085-ONC12573EE.000E1660-C12573EE.000E166E@esplugues.org>
Message-ID: <b130c85e0802121904m5f09e1e5k8d7c50a56bf616a4@mail.gmail.com>

Hooray! I won the Microsoft e-mail award!

And I thought my wine efforts would go unnoticed, but here I am
winning the grand prize!

---------- Forwarded message ----------
From: marinamg at esplugues.org <marinamg at esplugues.org>
Date: 12 feb. 2008 18:33
Subject: Congratulation!!!
To: undisclosed-recipients


Microsoft Award Team
22 Garden Close,PE9 2YP, London
Date: 13th Feb 2008.

Finally, Today we announce this year winners of the MICROSOFT E-MAIL
AWARD held on the 13/02/2008, Your Email has won (?1,000,000.00) (CSC)
Claims Security Code: CSC-74162007-04-LV-UK,Your Ref: MSC990/678.
Contact your Fudiciary agent Mr. Steve Wallace along with your
information via email.

Sir. John Smith
Email: johnsmithm at live.com


From dmitry at codeweavers.com  Tue Feb 12 22:32:39 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 13 Feb 2008 12:32:39 +0800
Subject: Fixing the last failing tests
References: <b130c85e0802121809v67ffe2f1mae9baa944de26cb3@mail.gmail.com>
Message-ID: <00d401c86df9$7af6fb70$a600fea9@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

> An example is IsWindowUnicode. It always returns TRUE on XP,

That's not true.

> but it
> won't do that on 9x. That would mean something like:
> ok(IsWindowUnicode() || !IsWindowUnicode(), "How can this fail?");

We need to skip the tests that rely on unicode user32 APIs, have a look
how other user32 tests check for win9x and cope with that.

-- 
Dmitry.


From twickline at gmail.com  Wed Feb 13 00:14:12 2008
From: twickline at gmail.com (Tom Wickline)
Date: Wed, 13 Feb 2008 01:14:12 -0500
Subject: Congratulation!!!
In-Reply-To: <b130c85e0802121904m5f09e1e5k8d7c50a56bf616a4@mail.gmail.com>
References: <OF4CFE3E3F.B5406085-ONC12573EE.000E1660-C12573EE.000E166E@esplugues.org>
	<b130c85e0802121904m5f09e1e5k8d7c50a56bf616a4@mail.gmail.com>
Message-ID: <53e3a9930802122214x5e81b65fx54e0b844d712faee@mail.gmail.com>

Now send them ?10,000 and your  ?1,000,000.00 will be on its way.

Don't delay this is your chance for riches.

LOL..... :D

Tom

On Feb 12, 2008 10:04 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> Hooray! I won the Microsoft e-mail award!
>
> And I thought my wine efforts would go unnoticed, but here I am
> winning the grand prize!
>
> ---------- Forwarded message ----------
> From: marinamg at esplugues.org <marinamg at esplugues.org>
> Date: 12 feb. 2008 18:33
> Subject: Congratulation!!!
> To: undisclosed-recipients
>
>
> Microsoft Award Team
> 22 Garden Close,PE9 2YP, London
> Date: 13th Feb 2008.
>
> Finally, Today we announce this year winners of the MICROSOFT E-MAIL
> AWARD held on the 13/02/2008, Your Email has won (?1,000,000.00) (CSC)
> Claims Security Code: CSC-74162007-04-LV-UK,Your Ref: MSC990/678.
> Contact your Fudiciary agent Mr. Steve Wallace along with your
> information via email.
>
> Sir. John Smith
> Email: johnsmithm at live.com
>
>
>


From paul.vriens.wine at gmail.com  Wed Feb 13 00:54:27 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 13 Feb 2008 07:54:27 +0100
Subject: Alsa spitting out warnings every time Wine runs.
In-Reply-To: <1202865252.5660.15.camel@dhcppc4>
References: <1202865252.5660.15.camel@dhcppc4>
Message-ID: <47B29423.7000802@gmail.com>

Peter Dons Tychsen wrote:
> Hi Maarten & Devs.
> 
> Great to see that audio is so much better in Wine now.
> 
> But....
> On fedora core 6 and 8 i get this every time i start Wine:
> 
> ALSA lib conf.c:3949:(snd_config_expand) Unknown parameters 0
> ALSA lib pcm.c:2145:(snd_pcm_open_noupdate) Unknown PCM default:0
> ALSA lib conf.c:3949:(snd_config_expand) Unknown parameters 0
> ALSA lib pcm.c:2145:(snd_pcm_open_noupdate) Unknown PCM default:0
> 
> I think its harmless, but what do you it means?
> How do i stop it? Should i fix it in Wine or Alsa?
> 
> /p
> 
> 
> 
> 
Hi,

I've seen that somebody created a patch for this:

http://bugs.winehq.org/show_bug.cgi?id=10942

I've no clue about Alsa so I can't comment on that patch.

-- 
Cheers,

Paul.


From crumb at google.com  Tue Feb 12 17:51:11 2008
From: crumb at google.com (Maarten Lankhorst)
Date: Tue, 12 Feb 2008 15:51:11 -0800
Subject: How is the testsuite built for windows
Message-ID: <d6e10bb10802121551ia747575jd89096615f7026cb@mail.gmail.com>

Hi all,

I'm trying to get the tests to run in windows, but I'm not sure how to build
them. Any attempt to do mingw cross compiling fails badly.

Who managed to compile all wine tests for windows, and how is it done?

Cheers,
Maarten.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080212/c5cdd11a/attachment.htm 

From timothy.lee at siriushk.com  Tue Feb 12 19:13:49 2008
From: timothy.lee at siriushk.com (Timothy Lee)
Date: Wed, 13 Feb 2008 09:13:49 +0800
Subject: [PATCH]  Environment variable to specify X11 window for desktop
Message-ID: <47B2444D.1090003@siriushk.com>

Dear all,

The attached patch allows the WINE desktop to be embedded within an 
existing X11 window, and is similar to the windowed mode in WINE.

I've tested this feature using MS PowerPoint Viewer 2007, so that a 
fullscreen slideshow can be fitted inside any X11 window.

Regards,
Timothy Lee

-------------- next part --------------
A non-text attachment was scrubbed...
Name: wine-rootwin.patch
Type: text/x-patch
Size: 1853 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080213/1ee57fb3/attachment.bin 

From paul.vriens.wine at gmail.com  Wed Feb 13 02:38:48 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 13 Feb 2008 09:38:48 +0100
Subject: How is the testsuite built for windows
In-Reply-To: <d6e10bb10802121551ia747575jd89096615f7026cb@mail.gmail.com>
References: <d6e10bb10802121551ia747575jd89096615f7026cb@mail.gmail.com>
Message-ID: <47B2AC98.8030100@gmail.com>

Maarten Lankhorst wrote:
> Hi all,
> 
> I'm trying to get the tests to run in windows, but I'm not sure how to build
> them. Any attempt to do mingw cross compiling fails badly.
> 
> Who managed to compile all wine tests for windows, and how is it done?
> 
> Cheers,
> Maarten.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> 
Hi Maarten,

I'm doing this all the time. Before I sent a patch I usually have it cross 
compiled and tested on different flavors of Windows.

I'm running Fedora 8 and I'm using the RPM's provided via 
http://mirzam.it.vu.nl/mingw/packages.

Mingw has to be very-up-to-date to be able to cross compile all tests. With the 
latest RPM's I can still cross compile all tests.

Or are you talking about the full winetest.exe?

-- 
Cheers,

Paul.


From dmitry at codeweavers.com  Wed Feb 13 03:10:35 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 13 Feb 2008 17:10:35 +0800
Subject: Add a slight delay before testing the ddraw and d3d9 visual tests
References: <b130c85e0802121725g5eb77f73k8c4c85a8a21173fe@mail.gmail.com>
Message-ID: <00cc01c86e20$4cf088a0$a600fea9@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

> This makes the tests pass on my pc.

Perhaps there is something less hacky way like GdiFlush() which is more
appropriate for this.

-- 
Dmitry.


From dmitry at codeweavers.com  Wed Feb 13 03:14:18 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 13 Feb 2008 17:14:18 +0800
Subject: Patch: create a WinHttpDetectAutoProxyConfigUrl function
References: <bda6d13a0802121929g17ad79a4qc28c12b8fede9c3f@mail.gmail.com>
Message-ID: <00dc01c86e20$d15226d0$a600fea9@DMITRY>

"Joshua Hudson" <joshudson at gmail.com> wrote:

> --- wine-0.9.54/dlls/winhttp/winhttp.spec       2008-02-11 20:54:39.000000000
> -0800
> +++ wine-0.9.54/dlls/winhttp/winhttp.spec.bak   2008-02-11 20:52:39.000000000
> -0800

The patch is wrapped.

> @@ -8,7 +8,7 @@
> @ stub WinHttpConnect
> @ stub WinHttpCrackUrl
> @ stub WinHttpCreateUrl
> -@ stdcall WinHttpDetectAutoProxyConfigUrl(long ptr)
> +@ stub WinHttpDetectAutoProxyConfigUrl

And this part seems to be reverted.

-- 
Dmitry.


From kai.blin at gmail.com  Wed Feb 13 03:37:35 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Wed, 13 Feb 2008 10:37:35 +0100
Subject: d3d: Add a slight delay before testing the ddraw and d3d9 visual
	tests
In-Reply-To: <1202868684.5660.21.camel@dhcppc4>
References: <b130c85e0802121725g5eb77f73k8c4c85a8a21173fe@mail.gmail.com>
	<20080213013044.ZOPJ11715.fep26.mail.dk@wine.codeweavers.com>
	<1202868684.5660.21.camel@dhcppc4>
Message-ID: <200802131037.42882.kai.blin@gmail.com>

On Wednesday 13 February 2008 03:11:24 Peter Dons Tychsen wrote:

> The string "This makes the tests pass on my pc" isn't very good either.
> What system?

Given that the default mode for the tests in the last years has been "Needs to 
pass on Alexandre's system", I don't think it's that bad. ;)

Cheeers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080213/50b5435f/attachment.pgp 

From stefan at codeweavers.com  Wed Feb 13 04:28:45 2008
From: stefan at codeweavers.com (Stefan =?utf-8?q?D=C3=B6singer?=)
Date: Wed, 13 Feb 2008 11:28:45 +0100
Subject: d3d: Add a slight delay before testing the ddraw and d3d9 visual
	tests
In-Reply-To: <1202868684.5660.21.camel@dhcppc4>
References: <b130c85e0802121725g5eb77f73k8c4c85a8a21173fe@mail.gmail.com>
	<20080213013044.ZOPJ11715.fep26.mail.dk@wine.codeweavers.com>
	<1202868684.5660.21.camel@dhcppc4>
Message-ID: <200802131128.45292.stefan@codeweavers.com>

Am Mittwoch, 13. Februar 2008 03:11:24 schrieb Peter Dons Tychsen:
> Eh, this does not seem like a proper way to get a unit test to pass.
>
> Sleep()... that leads to the dark side! :-)
I talked to Maarten on IRC about this. The problem seems to be that his 
monitor takes ages to mode switch, but ChangeDisplaySettings returns before 
this modeswitch is done. Also the opengl driver attempts to draw before the 
setup is ready, which fails and causes the test failures.

So it sounds like a driver bug which will only affect the tests(since games 
draw repeatedly and do not care if the first few frames do not render 
properly)


From rob at codeweavers.com  Wed Feb 13 07:10:23 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 13 Feb 2008 13:10:23 +0000
Subject: [PATCH #1] wininet: Added beginning support for HTTP cache files.
In-Reply-To: <47B2E371.8080805@codeweavers.com>
References: <47B2E371.8080805@codeweavers.com>
Message-ID: <47B2EC3F.9060204@codeweavers.com>

Jacek Caban wrote:
> +    /* FIXME: Better check, when we have to create the cache file */
> +    if(bSuccess && (lpwhr->hdr.dwFlags & INTERNET_FLAG_NEED_FILE)) {
> +        WCHAR url[INTERNET_MAX_URL_LENGTH];
> +        WCHAR cacheFileName[MAX_PATH+1];
> +        BOOL b;
> +
> +        b = HTTP_GetRequestURL(lpwhr, url);
> +        if(!b) {
> +            WARN("Could not get URL\n");
> +            goto lend;
> +        }
> +
> +        b = CreateUrlCacheEntryW(url, lpwhr->dwContentLength > 0 ? lpwhr->dwContentLength : 0, NULL, cacheFileName, 0);
> +        if(b) {
> +            lpwhr->lpszCacheFile = WININET_strdupW(cacheFileName);
> +            lpwhr->hCacheFile = CreateFileW(lpwhr->lpszCacheFile, GENERIC_WRITE, FILE_SHARE_READ|FILE_SHARE_WRITE,
> +                      NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);
> +            if(lpwhr->hCacheFile == INVALID_HANDLE_VALUE) {
> +                WARN("Could not create file: %u\n", GetLastError());
> +                lpwhr->hCacheFile = NULL;
> +            }
> +        }else {
> +            WARN("Could not create cache entry: %08x\n", GetLastError());
> +        }
> +    }
>
>   

It may be beyond the scope of your patch, but you're creating the cache 
file without committing the entry elsewhere so that it can be found at a 
later time. According to MSDN, this should be done in HTTP_FinishedReading.

-- 
Rob Shearman



From msclrhd at googlemail.com  Wed Feb 13 03:15:59 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 13 Feb 2008 09:15:59 +0000
Subject: [RFC] winecfg enhancements
Message-ID: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com>

Hi,

I am looking at how we can make winecfg more useful. I have already
supplied patches to allow importing a ubuntu human theme to work :).
So I am now looking at how to build on that.

On the Desktop Integration tab, I am planning on adding the following
improvements:

  * Split the Appearance section into Theme and Appearance.

    The rationale behind this is while the two are linked, they are
also distinct. It will make it possible to simplify "Install theme..."
to just "Install...", and support enhancements below.

  *  Pre-populate the Theme list with themes in
WINDOWS/Resources/Themes and with other *.theme files added by the
user.

    The rationale behind this is that it simplifies the workflow for
the average usage (e.g. install a theme, then select it).

  *  Rename "Install theme..." to "Add...".

     The rationale is that we are not installing a theme, but setting
it as the theme being used. Having the theme appear in the Themes list
in the future further supports this name change and workflow.

  *  Rename "(No Theme)" to "Wine Default".

    The rationale behind this is that it isn't true that there is no
theme installed (in the sense that a theme can be a set of colours and
metrics).

  *  Provide an "Export..." button to the Themes section.

    The rationale behind this is that it makes it easier to create,
modify and preview themes being created. Therefore, you could create a
Ubuntu Human or Oxygen theme from winecfg.

  *  Make the theme importer read the themes [Theme]/DisplayName property.

    The rationale behind this is to make the display name user friendly.

  *  Add --import-theme command line support to winecfg.

    The rationale behind this is to support loading a theme via a
script (e.g. post-install configuration), without resorting to the
winecfg GUI.

  *  Make the shell folders a drop down list.

    The rationale behind this is that it is unclear what "link to"
applies to. An alternative is to make the listview have the
showselalways flag, so it is clearer what folder "link to" is relating
to.

Q: Should we provide a --simple mode for winecfg that has the work
flow that Ubuntu is planning? Not specifying --simple would bring up
the standard winecfg dialog.

- Reece


From paul at astro.gla.ac.uk  Wed Feb 13 08:43:30 2008
From: paul at astro.gla.ac.uk (Paul Millar)
Date: Wed, 13 Feb 2008 15:43:30 +0100
Subject: How is the testsuite built for windows
In-Reply-To: <d6e10bb10802121551ia747575jd89096615f7026cb@mail.gmail.com>
References: <d6e10bb10802121551ia747575jd89096615f7026cb@mail.gmail.com>
Message-ID: <200802131543.30720.paul@astro.gla.ac.uk>

Hi Maarten,

On Wednesday 13 February 2008 00:51:11 Maarten Lankhorst wrote:
> Who managed to compile all wine tests for windows, and how is it done?

Once a day, quisquiliae head-node (attempt to) build winetest.exe (and also 
the other Wine .exe and .dll files).  Some details about this are available 
here:
	http://quisquiliae.physics.gla.ac.uk/cross/

The cron script builds winetest.exe and checks whether it has changed since 
last time.  If so, registers the new build.
(This is a slight over-simplification.)

There are some notes on how to build a Windows PE cross-compiler available 
from here:
	http://www.astro.gla.ac.uk/~paulm/Cross/

There is also a script that automates building the cross-compiler.  Wine is 
written exclusively in C, so by default, only the C frontend is built.  The 
script should support building other language frontends, but this hasn't been 
tested much.

This page also includes a set of patches for MinGW's Win32API package to allow 
MinGW to compile winetest.exe.  This patch-set is almost exclusively the work 
of others: Stefan Leichter featuring most prominently (many thanks!)

Hans Leidekker maintains a set of RPMs that should provide identical coverage 
of Win32API as Stefan, Hans, myself and others share the set of patches.  
Hans' RPMs are available from:

	http://mirzam.it.vu.nl/mingw/

Cheers,

Paul.





From kuba at mareimbrium.org  Wed Feb 13 09:51:51 2008
From: kuba at mareimbrium.org (Kuba Ober)
Date: Wed, 13 Feb 2008 10:51:51 -0500
Subject: Fixing the last failing tests
In-Reply-To: <22821af30802121821p2f73b1ebib29cfa7bc4d870ef@mail.gmail.com>
References: <20080213021049.UFVC22541.fep23.mail.dk@wine.codeweavers.com>
	<1202868991.5660.25.camel@dhcppc4>
	<22821af30802121821p2f73b1ebib29cfa7bc4d870ef@mail.gmail.com>
Message-ID: <200802131051.51793.kuba@mareimbrium.org>

On Tuesday 12 February 2008, James Hawkins wrote:
> On Feb 12, 2008 8:16 PM, Peter Dons Tychsen <donpedro at tdcadsl.dk> wrote:
> > Hello M.
> >
> > What is wrong with detecting the version, and branching the test code
> > accordingly? Other tests do that IIRC. I think that is a better
> > solution, if the version selector in winecfg is still going to be
> > meaningful (registry).
>
> The only time the tests should check for the windows version is if we
> know an app does the same thing, which is hardly ever.

Well, if we have an old app from win9x times, it will expect windows 95 
behavior, without checking for windows version of course.

So if Wine is set to impersonate win95, then it should behave like on win95 
and the tests should check windows (here: wine) version to select a proper 
test. Such a version-specific test should pass on win95 and wine with win95 
personality chosen. It should also pass on other versions, by choosing a 
different path (and possibly doing nothing if it doesn't apply to that 
windows version).

So, for example, methinks all applicable unicode tests should be disabled on 
the early win95 versions which had no such support (if so bolt-on unicode is 
detected).

Wouldn't that make sense?

Cheers, Kuba


From juan.lang at gmail.com  Wed Feb 13 11:56:05 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Wed, 13 Feb 2008 09:56:05 -0800
Subject: [RFC] winecfg enhancements
In-Reply-To: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com>
References: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com>
Message-ID: <3a768c550802130956g71369065q7e048e0511bce5fc@mail.gmail.com>

>  Q: Should we provide a --simple mode for winecfg that has the work
>  flow that Ubuntu is planning? Not specifying --simple would bring up
>  the standard winecfg dialog.

If you don't explain what that is, don't expect to many responses.  At
least, I don't know what it is.
--Juan


From lich at math.spbu.ru  Wed Feb 13 12:34:45 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Wed, 13 Feb 2008 18:34:45 +0000
Subject: missed systray patches
Message-ID: <200802131834.45125.lich@math.spbu.ru>

Hello,

Is there anything wrong with the serie of patches?

systray[0/4]: systray improvements [try 2]
http://www.winehq.org/pipermail/wine-patches/2008-February/049772.html

--
Kirill


From kumbayo84 at arcor.de  Wed Feb 13 13:03:22 2008
From: kumbayo84 at arcor.de (Peter Oberndorfer)
Date: Wed, 13 Feb 2008 20:03:22 +0100
Subject: user32: correct the caption bar and it's buttons' sizes
In-Reply-To: <6514eb960802130715u4fd478a5we6a1caee213e4e62@mail.gmail.com>
References: <6514eb960802130715u4fd478a5we6a1caee213e4e62@mail.gmail.com>
Message-ID: <200802132003.23126.kumbayo84@arcor.de>

On Mittwoch 13 Februar 2008, Divan Burger wrote:
> 

What is the problem without the patch?
is the caption bar drawn too high 1 pixel?

I ask because i have a patch that restores the 1 pixel
high line between the caption bar and the client area
(and at the same time decreases the height of the caption bar)
see it attached

for the NC_DrawXXXButton functions:
you also need to update hittest calculation
else the wrong buttons are activated.
For example when you press the mouse down on the left side of the close 
button, but maximize gets activated

>? ? ?case SM_CYCAPTION:
>? ? ? ? ?if (!spi_loaded[SPI_NONCLIENTMETRICS_IDX]) load_nonclient_metrics();
>- ? ? ? ?return nonclient_metrics.iCaptionHeight + 1;
>+ ? ? ? ?return nonclient_metrics.iCaptionHeight;

this breaks a test in sysparams.c:2416
ok_gsm( SM_CYCAPTION, ncm.iCaptionHeight+1);
and 5 other tests

Greetings Peter
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-fix-caption-bar-being-too-high-by-1-pixel.patch
Type: text/x-diff
Size: 1041 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080213/56f01b56/attachment.patch 

From thestig at google.com  Wed Feb 13 13:12:37 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 13 Feb 2008 11:12:37 -0800
Subject: [PATCH] Environment variable to specify X11 window for desktop
In-Reply-To: <47B2444D.1090003@siriushk.com>
References: <47B2444D.1090003@siriushk.com>
Message-ID: <558b2f5c0802131112t7808725dn3e4c23647c0f2bdd@mail.gmail.com>

On Feb 12, 2008 5:13 PM, Timothy Lee <timothy.lee at siriushk.com> wrote:
> Dear all,
>
> The attached patch allows the WINE desktop to be embedded within an
> existing X11 window, and is similar to the windowed mode in WINE.
>
> I've tested this feature using MS PowerPoint Viewer 2007, so that a
> fullscreen slideshow can be fitted inside any X11 window.
>
> Regards,
> Timothy Lee
>
>
>
>
>

Patches should be sent to wine-patches at winehq.org. Please do not use
C++ style comments. See:
http://www.winehq.org/site/docs/winedev-guide/style-notes


From leslie_alistair at hotmail.com  Wed Feb 13 13:41:54 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Thu, 14 Feb 2008 06:41:54 +1100
Subject: msxml3: Implement IXMLDOMDocument IDispatch interface
References: <fnchqv$a5r$1@ger.gmane.org>
Message-ID: <fovh5u$7ud$1@ger.gmane.org>

Hi,
  Was there anything wrong with this patch?

Dont commit this patch if nothing is wrong. I will submit a series of 
patches, that will include these changes.

Best Regards
 Alistair Leslie-Hughes


"Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote in message 
news:fnchqv$a5r$1 at ger.gmane.org...
> Hi,
>
> Fixes bug http://bugs.winehq.org/show_bug.cgi?id=11257
>
> Changelog:
> msxml3: Implement IXMLDOMDocument IDispatch interface
>
> Best Regards
>  Alistair Leslie-Hughes
>


--------------------------------------------------------------------------------


> From 7cc5228684ed6d9aaace829cc1b8ebb43e5f4325 Mon Sep 17 00:00:00 2001
> From: Alistair Leslie-Hughes <leslie_alistair at hotmail.com>
> Date: Fri, 25 Jan 2008 22:34:36 +1100
> Subject: [PATCH] Implement IXMLDOMDocument IDispatch interface
> To: wine-patches <wine-patches at winehq.org>
>
> ---
> dlls/msxml3/domdoc.c        |   53 +++++++++++++++++++++++++++++++++------
> dlls/msxml3/main.c          |   58 
> +++++++++++++++++++++++++++++++++++++++++++
> dlls/msxml3/msxml_private.h |    8 ++++++
> 3 files changed, 111 insertions(+), 8 deletions(-)
>
> diff --git a/dlls/msxml3/domdoc.c b/dlls/msxml3/domdoc.c
> index 06388c8..9d6b94b 100644
> --- a/dlls/msxml3/domdoc.c
> +++ b/dlls/msxml3/domdoc.c
> @@ -416,16 +416,29 @@ static ULONG WINAPI domdoc_Release(
>
> static HRESULT WINAPI domdoc_GetTypeInfoCount( IXMLDOMDocument2 *iface, 
> UINT* pctinfo )
> {
> -    FIXME("\n");
> -    return E_NOTIMPL;
> +    domdoc *This = impl_from_IXMLDOMDocument2( iface );
> +
> +    TRACE("(%p)->(%p)\n", This, pctinfo);
> +
> +    *pctinfo = 1;
> +
> +    return S_OK;
> }
>
> static HRESULT WINAPI domdoc_GetTypeInfo(
>     IXMLDOMDocument2 *iface,
>     UINT iTInfo, LCID lcid, ITypeInfo** ppTInfo )
> {
> -    FIXME("\n");
> -    return E_NOTIMPL;
> +    domdoc *This = impl_from_IXMLDOMDocument2( iface );
> +    HRESULT hr;
> +
> +    TRACE("(%p)->(%u %u %p)\n", This, iTInfo, lcid, ppTInfo);
> +
> +    hr = get_typeinfo(IXMLDOMDocument2_tid, ppTInfo);
> +    if(SUCCEEDED(hr))
> +        ITypeInfo_AddRef(*ppTInfo);
> +
> +    return hr;
> }
>
> static HRESULT WINAPI domdoc_GetIDsOfNames(
> @@ -436,8 +449,21 @@ static HRESULT WINAPI domdoc_GetIDsOfNames(
>     LCID lcid,
>     DISPID* rgDispId)
> {
> -    FIXME("\n");
> -    return E_NOTIMPL;
> +    domdoc *This = impl_from_IXMLDOMDocument2( iface );
> +    ITypeInfo *typeinfo;
> +    HRESULT hr;
> +
> +    TRACE("(%p)->(%s %p %u %u %p)\n", This, debugstr_guid(riid), 
> rgszNames, cNames,
> +          lcid, rgDispId);
> +
> +    if(!rgszNames || cNames == 0 || !rgDispId)
> +        return E_INVALIDARG;
> +
> +    hr = get_typeinfo(IXMLDOMDocument2_tid, &typeinfo);
> +    if(SUCCEEDED(hr))
> +        hr = ITypeInfo_GetIDsOfNames(typeinfo, rgszNames, cNames, 
> rgDispId);
> +
> +    return hr;
> }
>
>
> @@ -452,8 +478,19 @@ static HRESULT WINAPI domdoc_Invoke(
>     EXCEPINFO* pExcepInfo,
>     UINT* puArgErr)
> {
> -    FIXME("\n");
> -    return E_NOTIMPL;
> +    domdoc *This = impl_from_IXMLDOMDocument2( iface );
> +    ITypeInfo *typeinfo;
> +    HRESULT hr;
> +
> +    TRACE("(%p)->(%d %s %d %d %p %p %p %p)\n", This, dispIdMember, 
> debugstr_guid(riid),
> +          lcid, wFlags, pDispParams, pVarResult, pExcepInfo, puArgErr);
> +
> +    hr = get_typeinfo(IXMLDOMDocument2_tid, &typeinfo);
> +    if(SUCCEEDED(hr))
> +        hr = ITypeInfo_Invoke(typeinfo, &(This->lpVtbl), dispIdMember, 
> wFlags, pDispParams,
> +                pVarResult, pExcepInfo, puArgErr);
> +
> +    return hr;
> }
>
>
> diff --git a/dlls/msxml3/main.c b/dlls/msxml3/main.c
> index 62bf2b5..41afbe6 100644
> --- a/dlls/msxml3/main.c
> +++ b/dlls/msxml3/main.c
> @@ -21,6 +21,8 @@
>
> #include "config.h"
>
> +#define COBJMACROS
> +
> #include <stdarg.h>
> #include "windef.h"
> #include "winbase.h"
> @@ -34,6 +36,61 @@
>
> WINE_DEFAULT_DEBUG_CHANNEL(msxml);
>
> +
> +static ITypeLib *typelib;
> +static ITypeInfo *typeinfos[LAST_tid];
> +
> +static REFIID tid_ids[] = {
> +    &IID_IXMLDOMDocument2
> +};
> +
> +HRESULT get_typeinfo(enum tid_t tid, ITypeInfo **typeinfo)
> +{
> +    HRESULT hres;
> +
> +    if(!typelib) {
> +        ITypeLib *tl;
> +
> +        hres = LoadRegTypeLib(&LIBID_MSXML2, 3, 0, LOCALE_SYSTEM_DEFAULT, 
> &tl);
> +        if(FAILED(hres)) {
> +            ERR("LoadRegTypeLib failed: %08x\n", hres);
> +            return hres;
> +        }
> +
> +        if(InterlockedCompareExchangePointer((void**)&typelib, tl, NULL))
> +            ITypeLib_Release(tl);
> +    }
> +
> +    if(!typeinfos[tid]) {
> +        ITypeInfo *typeinfo;
> +
> +        hres = ITypeLib_GetTypeInfoOfGuid(typelib, tid_ids[tid], 
> &typeinfo);
> +        if(FAILED(hres)) {
> +            ERR("GetTypeInfoOfGuid failed: %08x\n", hres);
> +            return hres;
> +        }
> +
> +        if(InterlockedCompareExchangePointer((void**)(typeinfos+tid), 
> typeinfo, NULL))
> +            ITypeInfo_Release(typeinfo);
> +    }
> +
> +    *typeinfo = typeinfos[tid];
> +    return S_OK;
> +}
> +
> +static void process_detach(void)
> +{
> +    if(typelib) {
> +        unsigned i;
> +
> +        for(i=0; i < sizeof(typeinfos)/sizeof(*typeinfos); i++)
> +            if(typeinfos[i])
> +                ITypeInfo_Release(typeinfos[i]);
> +
> +        ITypeLib_Release(typelib);
> +    }
> +}
> +
> HRESULT WINAPI DllCanUnloadNow(void)
> {
>     FIXME("\n");
> @@ -53,6 +110,7 @@ BOOL WINAPI DllMain(HINSTANCE hInstDLL, DWORD 
> fdwReason, LPVOID lpv)
>     case DLL_PROCESS_DETACH:
> #ifdef HAVE_LIBXML2
>         xmlCleanupParser();
> +        process_detach();
> #endif
>         break;
>     }
> diff --git a/dlls/msxml3/msxml_private.h b/dlls/msxml3/msxml_private.h
> index 8d79d2e..c7d97a1 100644
> --- a/dlls/msxml3/msxml_private.h
> +++ b/dlls/msxml3/msxml_private.h
> @@ -91,4 +91,12 @@ extern HRESULT DOMDocument_create( IUnknown *pUnkOuter, 
> LPVOID *ppObj );
> extern HRESULT SchemaCache_create( IUnknown *pUnkOuter, LPVOID *ppObj );
> extern HRESULT XMLDocument_create( IUnknown *pUnkOuter, LPVOID *ppObj );
>
> +/* typelibs */
> +enum tid_t {
> +    IXMLDOMDocument2_tid,
> +    LAST_tid
> +};
> +
> +extern HRESULT get_typeinfo(enum tid_t tid, ITypeInfo **typeinfo);
> +
> #endif /* __MSXML_PRIVATE__ */
> -- 
> 1.5.3.7
>
>


--------------------------------------------------------------------------------


>
> 




From austinenglish at gmail.com  Wed Feb 13 15:30:31 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 13 Feb 2008 15:30:31 -0600
Subject: gecko download not robust?
In-Reply-To: <47B3600C.1030000@mandrivaclub.nl>
References: <47AE349F.7040605@mandrivaclub.nl>
	<b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>
	<47B3600C.1030000@mandrivaclub.nl>
Message-ID: <b6bb06270802131330k8432187od0b15e766cb2c4ae@mail.gmail.com>

You could make it a suggested package, a la wine-dev. Including is
also a possibility, but keep in mind that's several megabytes that
don't change with each release (or that often) that have to be
redownloaded each time. I've got high bandwith, so doesn't bother me,
but a lot of people don't...

-Austin

On Feb 13, 2008 3:24 PM, marco <marco at mandrivaclub.nl> wrote:
>
>
> Austin English wrote:
> > On Feb 9, 2008 5:17 PM, marco <marco at mandrivaclub.nl> wrote:
> >
> >>> Hmm.  gecko download hung for me once.  I saw
> >>> fixme:urlmon:ProtocolStream_Read Read failed: 800c0008
> >>> in the log, which makes me wonder if our download code
> >>> doesn't handle transient network errors well.
> >>>
> >>> Time to get rid of the download, and just bundle gecko outright, I say...
> >>>
> >> I make the mandriva rpms for wine.
> >> This would make the rpms 30% bigger.
> >> And you would download the same gecko binary over and over again with
> >> every new version.
> >>
> >> But if that is not a problem than it can be easily done.
> >>
> >>
> >>
> >
> > Why not have package maintainers package gecko like most do
> > development files. So you could have for example on ubuntu:
> > $ sudo apt-get install wine wine-dev wine-gecko
> >
> > Where wine-gecko wouldn't have to be upgraded very often.
> >
> > -Austin
> >
> >
>
> I looked into it.
> And there are some options.
>
> I can make a separate  package  of gecko  that  I can make it a
> dependencie of wine.
> Problem is people have to know where to find it or the get stuck.
>
> I can also make the package and make it not a dependencie on wine but
> the the people don't know it exist.
>
> And I can just put it in the wine package.
>
> I think this is the best option in this case. Its the easiest option
> because people only have to download en install one package.
>
> marco
>
>
>
>
>
>
>
>
>
>
>
>
>


From winehacker at gmail.com  Wed Feb 13 15:59:47 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Wed, 13 Feb 2008 16:59:47 -0500
Subject: gecko download not robust?
In-Reply-To: <47AFBCDD.2070206@codeweavers.com>
References: <47AE349F.7040605@mandrivaclub.nl>
	<b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>
	<47AFAA38.5070201@open-vote.org> <47AFBCDD.2070206@codeweavers.com>
Message-ID: <19e31a080802131359o20bf11cci2afc6d322bcdf23d@mail.gmail.com>

On Feb 10, 2008 10:11 PM, Jacek Caban <jacek at codeweavers.com> wrote:
> Compiling the package is quite tricky. I've compiled it on Windows XP
> using MSVC. There is no other way ATM, so I think that my Gecko package
> should be included as is in Linux packages.

Where is the source package? Is it just from the normal firefox source
tree with certain configuration options?

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Wed Feb 13 16:01:44 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 13 Feb 2008 14:01:44 -0800
Subject: Fixing the last failing tests
In-Reply-To: <a71bd89a0802121820s440d1298k560aa2e9e14ea70f@mail.gmail.com>
References: <a71bd89a0802121820s440d1298k560aa2e9e14ea70f@mail.gmail.com>
Message-ID: <a71bd89a0802131401q65e67b64jaf4289762e628fe4@mail.gmail.com>

Dmitry wrote:
>> An example is IsWindowUnicode. It always returns TRUE on XP,
>
>That's not true.

The test you submitted that checks this,
http://www.winehq.org/pipermail/wine-patches/2005-July/018839.html
must have passed once on Windows,
but it seems to be failing now; see e.g.
http://test.winehq.org/data/200802131000/xp_rs-winxp-sp2/user32:win.txt
which is full of lines like
win.c:3656: Test failed: IsWindowUnicode expected to return FALSE

Do you have a Windows system where that test passes currently?
- Dan


From thestig at google.com  Wed Feb 13 17:04:53 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 13 Feb 2008 15:04:53 -0800
Subject: [PATCH] include: add ISampleGrabber interface
In-Reply-To: <558b2f5c0802131503m277b32e1p3b32b64bec2025c0@mail.gmail.com>
References: <558b2f5c0802131503m277b32e1p3b32b64bec2025c0@mail.gmail.com>
Message-ID: <558b2f5c0802131504u201d96abi8117ed0725eef14e@mail.gmail.com>

On Feb 13, 2008 3:03 PM, Lei Zhang <thestig at google.com> wrote:
> Hi,
>
> This patch adds the ISampleGrabber interface, also needed by IMediaDet.
>

Bah, let me try again. Just realized I forgot to pass -n to git
format-patch as well.


From donpedro at tdcadsl.dk  Wed Feb 13 17:51:46 2008
From: donpedro at tdcadsl.dk (Peter Dons Tychsen)
Date: Thu, 14 Feb 2008 00:51:46 +0100
Subject: d3d: Add a slight delay before testing the ddraw and d3d9
	visual tests
In-Reply-To: <20080213102913.QLPQ11715.fep26.mail.dk@mail.codeweavers.com>
References: <b130c85e0802121725g5eb77f73k8c4c85a8a21173fe@mail.gmail.com>
	<20080213013044.ZOPJ11715.fep26.mail.dk@wine.codeweavers.com>
	<1202868684.5660.21.camel@dhcppc4>
	<20080213102913.QLPQ11715.fep26.mail.dk@mail.codeweavers.com>
Message-ID: <1202946706.2970.8.camel@dhcppc4>

OK. I still think he should put a FIXME remark in the test-case,
and document why Sleep() is needed. Someone might fix the driver
someday. 

The only reason i yelled "alert!", is that i have seen so much bad code
which has come to a state where the are Sleep(143) here and Sleep(1332)
there, where nobody can remember why they are there and what the Sleep
count represents (most of the time no-one ever knew! :-)). In the mean
time, the real bugs just getter harder to 
find, as they are covered by all the messy Sleeps(). I see allot of this
kind of yap in telecom embedded software (mobile phones etc.).

In this case Maarten probably knows what he is doing (he usually does).
But thanks for the follow up!

And now i will go to Sleep().

Thanks,

/p

On Wed, 2008-02-13 at 11:28 +0100, Stefan D?singer wrote:
> Am Mittwoch, 13. Februar 2008 03:11:24 schrieb Peter Dons Tychsen:
> > Eh, this does not seem like a proper way to get a unit test to pass.
> >
> > Sleep()... that leads to the dark side! :-)
> I talked to Maarten on IRC about this. The problem seems to be that his 
> monitor takes ages to mode switch, but ChangeDisplaySettings returns before 
> this modeswitch is done. Also the opengl driver attempts to draw before the 
> setup is ready, which fails and causes the test failures.
> 
> So it sounds like a driver bug which will only affect the tests(since games 
> draw repeatedly and do not care if the first few frames do not render 
> properly)



From m.b.lankhorst at gmail.com  Wed Feb 13 18:11:49 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 13 Feb 2008 16:11:49 -0800
Subject: Almost done...
Message-ID: <b130c85e0802131611v34cb58c9x413366f8ade2037d@mail.gmail.com>

Hi all,

Right now I got down to only the user32 msg test failing (minus the
todo's). I solved the user32 win test with a very high-tech solution:
Remove all icons from my desktop, which prevents the stupid file
description popup from failing the user32 win test. The other way
would be to run it in a wine desktop which would also prevent this (I
got no failures on runtest, except the todo's).

The msg tests are more difficult. For some reason I accidentally
passed them once, when I had  the debug scrolling on. But after that
there were always failures on my pc. Is there any way to sync those so
that it is less prone to timing issues?

Cheers,
Maarten.


From msclrhd at googlemail.com  Wed Feb 13 13:29:50 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 13 Feb 2008 19:29:50 +0000
Subject: [RFC] winecfg enhancements
In-Reply-To: <3a768c550802130956g71369065q7e048e0511bce5fc@mail.gmail.com>
References: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com>
	<3a768c550802130956g71369065q7e048e0511bce5fc@mail.gmail.com>
Message-ID: <3f4fd2640802131129m516726edw5b8f29d770e8475e@mail.gmail.com>

On 13/02/2008, Juan Lang <juan.lang at gmail.com> wrote:
> >  Q: Should we provide a --simple mode for winecfg that has the work
> >  flow that Ubuntu is planning? Not specifying --simple would bring up
> >  the standard winecfg dialog.
>
> If you don't explain what that is, don't expect to many responses.  At
> least, I don't know what it is.


From bogus@does.not.exist.com  Mon Feb  4 06:08:23 2008
From: bogus@does.not.exist.com ()
Date: Mon, 04 Feb 2008 12:08:23 -0000
Subject: No subject
Message-ID: <mailman.62.1202950368.2881.wine-devel@winehq.org>

<quote>
System->Preferences->Windows Applications

Here we reimplement only the Wine configuration options we need.

    * (Pulldown menu): "Default Windows version to emulate when
launching Windows applications"
          o Windows 2000 is currently the upstream default, which
works for most apps
    * (unchecked by default) Automatically launch applications upon
inserting a disc
          o This is where the user can disable autorun by default if
he enabled it with the checkbox in the autorun prompt
    * (radio button default): Allow full screen applications to change
the resolution
    * (radio button alternate): Contain full screen applications in a
window when smaller than the desktop
          o These are the two main use cases of Wine's various Window
managing options. The latter might not be fully functional in time for
Hardy.
    * (button) Advanced
          o Launches winecfg, or a similarly functional GTK
application. We can consider removing this when Wine's defaults get
good enough, however likely not by Hardy. To reimplement the
configuration we need in GTK requires some upstream changes (see [WWW]
ConsoleConfiguration on Wine's wiki.
</quote>

And the other proposed improvements? Those were mentioned and can be
commented on.

- Reece


From jeffzaroyko at gmail.com  Wed Feb 13 14:58:58 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Wed, 13 Feb 2008 20:58:58 +0000 (UTC)
Subject: [RFC] winecfg enhancements
References: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com>
Message-ID: <loom.20080213T205414-81@post.gmane.org>

Reece Dunn <msclrhd <at> googlemail.com> writes:

> 
> Hi,
> 
> I am looking at how we can make winecfg more useful. I have already
> supplied patches to allow importing a ubuntu human theme to work :).
> So I am now looking at how to build on that.
> 
[...]
> 
> - Reece
> 
> 

I think this could probably do with some consideration
http://bugs.winehq.org/show_bug.cgi?id=6233 , it describes how the
Applications tab does not belong among the other tabs because it should be
higher up in the hierarchy of things.




From marco at mandrivaclub.nl  Wed Feb 13 15:24:28 2008
From: marco at mandrivaclub.nl (marco)
Date: Wed, 13 Feb 2008 22:24:28 +0100
Subject: gecko download not robust?
In-Reply-To: <b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>
References: <47AE349F.7040605@mandrivaclub.nl>
	<b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>
Message-ID: <47B3600C.1030000@mandrivaclub.nl>


Austin English wrote:
> On Feb 9, 2008 5:17 PM, marco <marco at mandrivaclub.nl> wrote:
>   
>>> Hmm.  gecko download hung for me once.  I saw
>>> fixme:urlmon:ProtocolStream_Read Read failed: 800c0008
>>> in the log, which makes me wonder if our download code
>>> doesn't handle transient network errors well.
>>>
>>> Time to get rid of the download, and just bundle gecko outright, I say...
>>>       
>> I make the mandriva rpms for wine.
>> This would make the rpms 30% bigger.
>> And you would download the same gecko binary over and over again with
>> every new version.
>>
>> But if that is not a problem than it can be easily done.
>>
>>
>>     
>
> Why not have package maintainers package gecko like most do
> development files. So you could have for example on ubuntu:
> $ sudo apt-get install wine wine-dev wine-gecko
>
> Where wine-gecko wouldn't have to be upgraded very often.
>
> -Austin
>
>   

I looked into it.
And there are some options.

I can make a separate  package  of gecko  that  I can make it a 
dependencie of wine.
Problem is people have to know where to find it or the get stuck.

I can also make the package and make it not a dependencie on wine but 
the the people don't know it exist.

And I can just put it in the wine package.

I think this is the best option in this case. Its the easiest option 
because people only have to download en install one package.

marco














From m.b.lankhorst at gmail.com  Wed Feb 13 21:20:08 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 13 Feb 2008 19:20:08 -0800
Subject: Weird failure in kernel32 volume test
Message-ID: <b130c85e0802131920t4ec53045q4350a1711602992@mail.gmail.com>

Hi all,

The latest update of trying to be the second person for which all tests succeed.
I sent a bunch of patches that make some tests pass.

At the moment I have 3 failures on a clean wineprefix, with no icons
on my desktop, and with wine in native window mode on kde 3.5.x:
user32: 'msg' test fails. The famous 'win' test passes.
kernel32: I get a very weird bug on the 'volume' test. It only occurs
when I run my mini script for running the tests. I have absolutely no
idea why I get ERROR_FILE_NOT_FOUND on FindFirstVolumeA on the first
time I run the whole testsuite, and not successive runs. Anyone has
experienced the same, or have an idea what is going on?
msi: multi-sz failure in msi install, I did a todo_wine on it so it
doesn't stop the build. It seems to be a recent failure though because
I know that it didn't bomb out on install a few days ago.

Anyone else has some tests that consistently fail on make test?

Cheers,
Maarten.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: tests
Type: application/octet-stream
Size: 297 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080213/2f5c7455/attachment.obj 

From donpedro at tdcadsl.dk  Wed Feb 13 21:22:16 2008
From: donpedro at tdcadsl.dk (Peter Dons Tychsen)
Date: Thu, 14 Feb 2008 04:22:16 +0100
Subject: ddraw / wined3d fighting over the resolution!
In-Reply-To: <20080213013044.ZOPJ11715.fep26.mail.dk@wine.codeweavers.com>
References: <b130c85e0802121725g5eb77f73k8c4c85a8a21173fe@mail.gmail.com>
	<20080213013044.ZOPJ11715.fep26.mail.dk@wine.codeweavers.com>
Message-ID: <1202959336.2970.18.camel@dhcppc4>

Hi Stefan/Devs.

The funny old game "Insane" has a resolution bug when it exits.
I am not sure exactly how to fix this.

1) It call SetDisplayMode() - switches from 1280 x 1024 -> 640 x 480.
OK.
2) It creates a 3D surface which starts the SwapChain - swapchain saves
current resolution.
3) Exit. It calls RestoreDisplayMode() - switches back to 1280 x 1024.
OK.
4) SwapChain is destroyed. Switches "back" to 640 x 480 ! BAD!

I presume the code guesses that the caller does this in another sequence
(and it does work fine in other sequences).

Why does the SwapChain-destroy function play around with the resolution
at all. Is that really necessary? I think it should not do it if the
caller is ddraw at least.

How do i fix this?

Thanks,

/pedro



From winehacker at gmail.com  Wed Feb 13 23:55:14 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 14 Feb 2008 00:55:14 -0500
Subject: [RFC] winecfg enhancements
In-Reply-To: <3f4fd2640802131129m516726edw5b8f29d770e8475e@mail.gmail.com>
References: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com>
	<3a768c550802130956g71369065q7e048e0511bce5fc@mail.gmail.com>
	<3f4fd2640802131129m516726edw5b8f29d770e8475e@mail.gmail.com>
Message-ID: <19e31a080802132155y36bd91eu8da8aec3949732be@mail.gmail.com>

On Feb 13, 2008 2:29 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
> And the other proposed improvements? Those were mentioned and can be
> commented on.

I've skimmed the discussion and while its important to me it bears
much too verbose. Can we just get some mockup images of that the
proposed changes would look like?

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Thu Feb 14 00:03:21 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 13 Feb 2008 22:03:21 -0800
Subject: Google's support for Wine in 2007
Message-ID: <a71bd89a0802132203u5e4782f0g3708dbbdc249edc9@mail.gmail.com>

As you might know, I work for Google, and part of my
day job is to help improve Wine.  Here's a little report
about what we've been up to.

Google uses Wine primarily as the basis for the Linux
port of our photo management software, Picasa.
In fact, the Linux version is exactly the Windows build
of Picasa, bundled with a lightly patched version of Wine.
Most of the work in that port was to improve Wine so it
could handle Picasa, and that work is still going on.
Codeweavers did the initial port, and Googlers
Lei Zhang, Nigel Liang, and Michael Moss are
improving Wine further for Picasa 2.7.

Beyond Picasa, a few of us (Lei Zhang, Alex Balut, and I)
have been fixing random Wine bugs in our 20% time.
I've also been doing regular Valgrind runs over the Wine test suite,
pestering developers who accidentally check in code that Valgrind
doesn't like.  Hats off to the Valgrind team for a great tool, and
to the (non-Google) folks who work on Valgrind/Wine compatibility
(Eric Pouech, Tom Hughes, and John Reiser, among others).

Google also sponsored some work by Codeweavers to improve
support for Photoshop ('cause so many people want it) and
for Dragon Naturally Speaking ('cause even Linux users get RSI).
While not yet perfect, those apps are a lot more usable now
as a result.  In particular, Photoshop CS and CS2 are quite usable
indeed.  (See http://wiki.winehq.org/AdobePhotoshop for
details.)

I also had the pleasure of hosting eight students as
Google interns working on Wine throughout the year.
Here are their names, and roughly what they worked on:
Dan Hipschman: widl
Evan Stade: gdiplus, Powerpoint Viewer
James Hawkins: msi
Jennifer Lai: win16 conformance tests
Juan Lang: crypt32, iTunes
Matt Jones: mono testing
Mikolaj Zalewski: Photoshop, Limux
Roy Shea: svchost, BITS

So, you're wondering, what exactly does that all boil down to?
I tallied all our accepted patches recently; the list is now up
(along with the exact Wine source we use for Picasa) at
  http://code.google.com/opensource/wine.html
I was pleasantly surprised at the size of the list.

Separately, Google also sponsored nine Summer of Code
students this year.  Just to name two who remain active even
after the end of summer:
Alex S?rnes, who improved Wine's Wordpad, and
Maarten Lankhorst, who solved tons of sound problems.
(And oh, how nice it is to not have to change sound settings anymore!)

All that may sound like a lot, and perhaps it is, but it pales
compared to the work put in on Wine by the rest of the Wine developers.
Thanks, everybody!  I'm really looking forward to Wine 1.0
(which, according to Alexandre, is planned for sometime in 2008).

Dan Kegel
Software Engineer
Google


From stefan at codeweavers.com  Thu Feb 14 02:18:49 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 14 Feb 2008 09:18:49 +0100
Subject: ddraw / wined3d fighting over the resolution!
In-Reply-To: <1202959336.2970.18.camel@dhcppc4>
References: <b130c85e0802121725g5eb77f73k8c4c85a8a21173fe@mail.gmail.com>
	<20080213013044.ZOPJ11715.fep26.mail.dk@wine.codeweavers.com>
	<1202959336.2970.18.camel@dhcppc4>
Message-ID: <200802140918.49288.stefan@codeweavers.com>

Am Donnerstag, 14. Februar 2008 04:22:16 schrieb Peter Dons Tychsen:
> Why does the SwapChain-destroy function play around with the resolution
> at all. Is that really necessary? I think it should not do it if the
> caller is ddraw at least.
I thought I'm filtering this out in the case of ddraw, but maybe that got 
lost. The reason why the swapchain restores the resolution is the different 
way ddraw/d3d8 and d3d8/d3d9 set up the screen.

In ddraw the app calls IDirectDraw7::SetDisplayMode. This sets the mode. Then 
it creates a DDSCAPS_PRIMARYSURFACE surface, which creates the swapchain.

In d3d8/d3d9 the swapchain controls the video mode

I think the problem is that RestoreDisplayMode is called before the primary 
surface is destroyed. The question is why this happens. I can think of the 
following reasons:

-> Refcounting problem, or the app just doesn't release the surfaces. Then 
ddraw.dll destroys the objects on DLL_PROCESS_DETACH

-> The app calls it that way. This needs a test, but I think it is not allowed 
to call SetDisplayMode / RestoreDisplayMode while a primary surface is around


From paul.vriens.wine at gmail.com  Thu Feb 14 02:27:50 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 14 Feb 2008 09:27:50 +0100
Subject: [advapi32/tests] Don't crash tests for NT4
Message-ID: <47B3FB86.4030509@gmail.com>

Hi,

(Deliberately sent here and not to wine-patches).

Hopefully someone can shed some light on this.

I need this patch to have the security tests not crash on NT4. The part about
the missing function is obvious.

What is not so obvious though is that when I leave the LocalFree(NewAcl) in, the
test crash. If I only do the LocalFree on success (as stated btw on MSDN for
this function) this test doesn't crash.
AFAIK LocalFree deals with passed NULL pointers so there must be something else
going on.

Changelog
   Don't crash tests for NT4

-- 
Cheers,

Paul.



-------------- next part --------------
A non-text attachment was scrubbed...
Name: advapi32_tests_security.c.diff
Type: text/x-patch
Size: 3845 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080214/e17591c8/attachment-0001.bin 

From dmitry at codeweavers.com  Thu Feb 14 02:38:38 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 14 Feb 2008 16:38:38 +0800
Subject: Fixing the last failing tests
References: <a71bd89a0802121820s440d1298k560aa2e9e14ea70f@mail.gmail.com>
	<a71bd89a0802131401q65e67b64jaf4289762e628fe4@mail.gmail.com>
Message-ID: <02d201c86ee5$00b75480$a600fea9@DMITRY>

"Dan Kegel" <dank at kegel.com> wrote:

> The test you submitted that checks this,
> http://www.winehq.org/pipermail/wine-patches/2005-July/018839.html
> must have passed once on Windows,
> but it seems to be failing now; see e.g.
> http://test.winehq.org/data/200802131000/xp_rs-winxp-sp2/user32:win.txt
> which is full of lines like
> win.c:3656: Test failed: IsWindowUnicode expected to return FALSE
> 
> Do you have a Windows system where that test passes currently?

Hmm, thanks for pointing this out. The test doesn't pass anymore for me
under an up to date XP, and I don't have other systems to test with at
the moment.

Looks like at some point DefWindowProcA/W treatment in XP has changed after
the introduction of IsWindowUnicode test (at that time the test passed), even
a trick we use in class.c with GetProcAddress("DefWindowProcA") doesn't help
anymore.

I sent a fix to wine-patches.

-- 
Dmitry.


From austinenglish at gmail.com  Thu Feb 14 03:50:10 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 14 Feb 2008 03:50:10 -0600
Subject: Google's support for Wine in 2007
In-Reply-To: <a71bd89a0802132203u5e4782f0g3708dbbdc249edc9@mail.gmail.com>
References: <a71bd89a0802132203u5e4782f0g3708dbbdc249edc9@mail.gmail.com>
Message-ID: <b6bb06270802140150k28d57f90r9d38de926c2d3f5a@mail.gmail.com>

On Feb 14, 2008 12:03 AM, Dan Kegel <dank at kegel.com> wrote:
> I also had the pleasure of hosting eight students as
> Google interns working on Wine throughout the year.
> Here are their names, and roughly what they worked on:
> Dan Hipschman: widl
> Evan Stade: gdiplus, Powerpoint Viewer
> James Hawkins: msi
> Jennifer Lai: win16 conformance tests
> Juan Lang: crypt32, iTunes
> Matt Jones: mono testing
> Mikolaj Zalewski: Photoshop, Limux
> Roy Shea: svchost, BITS

What's the status of getting the win16 tests into wine? 16 bit support
broke a while back for many apps and is still broken.

-Austin


From hans at it.vu.nl  Thu Feb 14 03:51:17 2008
From: hans at it.vu.nl (Hans Leidekker)
Date: Thu, 14 Feb 2008 10:51:17 +0100
Subject: Resend pdh[3:3]: remove unnecessary test done in
	PdhLookupPerfNameByIndexW
In-Reply-To: <47B4027C.7020008@yless4u.com.au>
References: <47B4027C.7020008@yless4u.com.au>
Message-ID: <200802141051.17771.hans@it.vu.nl>

On Thursday 14 February 2008 09:57:32 am Jeff Latimer wrote:

> + ? ?machineW = pdh_strdup_aw( machine );
> +
> + ? ?if (!(ret = PdhLookupPerfNameByIndexW( machineW, index, bufferW, &sizeW )))

In the unlikely event that pdh_strdup_aw fails the query will be run on
the local machine instead of the remote machine. Please check for allocation
failures like most other functions in there do.

 -Hans


From lats at yless4u.com.au  Thu Feb 14 04:29:47 2008
From: lats at yless4u.com.au (Jeff Latimer)
Date: Thu, 14 Feb 2008 21:29:47 +1100
Subject: Resend pdh[3:3]: remove unnecessary test done in
	PdhLookupPerfNameByIndexW
In-Reply-To: <200802141051.17771.hans@it.vu.nl>
References: <47B4027C.7020008@yless4u.com.au>
	<200802141051.17771.hans@it.vu.nl>
Message-ID: <47B4181B.7090206@yless4u.com.au>

Hans Leidekker wrote:
> On Thursday 14 February 2008 09:57:32 am Jeff Latimer wrote:
>
>   
>> +    machineW = pdh_strdup_aw( machine );
>> +
>> +    if (!(ret = PdhLookupPerfNameByIndexW( machineW, index, bufferW, &sizeW )))
>>     
>
> In the unlikely event that pdh_strdup_aw fails the query will be run on
> the local machine instead of the remote machine. Please check for allocation
> failures like most other functions in there do.
>
>  -Hans
>   
I looked at that and it required another test.  When I discussed this 
last with Dmitry, I said it would be best to pass machine and he agreed 
that this would be best.  The checking for alloc failures will generate 
similar amounts of code to what I am removing.  I am happy to do it but 
have a concern that the code will look to be inefficient and not 
accepted.  Logically, the patch is the correct way to proceed as machine 
should be passed even if not implemented yet.  That said, if the patch 
is acceptable, there is another case that will need to be brought into line.

Jeff


From msclrhd at googlemail.com  Thu Feb 14 03:23:32 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Thu, 14 Feb 2008 09:23:32 +0000
Subject: [RFC] winecfg enhancements
In-Reply-To: <loom.20080213T205414-81@post.gmane.org>
References: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com>
	<loom.20080213T205414-81@post.gmane.org>
Message-ID: <3f4fd2640802140123o1a1fa8dl5fe7698cb128a382@mail.gmail.com>

On 13/02/2008, Jeff Zaroyko <jeffzaroyko at gmail.com> wrote:
> Reece Dunn <msclrhd <at> googlemail.com> writes:
>
>  > I am looking at how we can make winecfg more useful. I have already
>  > supplied patches to allow importing a ubuntu human theme to work :).
>  > So I am now looking at how to build on that.
>
>  I think this could probably do with some consideration
>  http://bugs.winehq.org/show_bug.cgi?id=6233 , it describes how the
>  Applications tab does not belong among the other tabs because it should be
>  higher up in the hierarchy of things.

There are several bugs related to winecfg currently. Also, the Ubuntu
devs have some ideas on improvements to winecfg on their wiki, as well
as some ideas for command line access to winecfg, install/uninstall
and other functionality.

Ideally, there should be a winecfg meta-bug, like what we have for 1.0
and have the various enhancements grouped into relevant bugs. This
will allow attachments (like mockups to be added), as well as tracking
patches and ideas.

I'll start setting this up, and raising the Ubuntu comments as
enhancements, to better track things and get the usability and
scriptability of wine configuration and management up to where they
should be.

Does anyone know how to set up the meta bug/group to track these?

- Reece


From dmitry at codeweavers.com  Thu Feb 14 05:32:26 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 14 Feb 2008 19:32:26 +0800
Subject: Resend pdh[3:3]: remove unnecessary test done
	inPdhLookupPerfNameByIndexW
References: <47B4027C.7020008@yless4u.com.au><200802141051.17771.hans@it.vu.nl>
	<47B4181B.7090206@yless4u.com.au>
Message-ID: <003a01c86efd$487b71d0$a600fea9@DMITRY>

"Jeff Latimer" <lats at yless4u.com.au> wrote:

> I looked at that and it required another test.  When I discussed this 
> last with Dmitry, I said it would be best to pass machine and he agreed 
> that this would be best.  The checking for alloc failures will generate 
> similar amounts of code to what I am removing.  I am happy to do it but 
> have a concern that the code will look to be inefficient and not 
> accepted.  Logically, the patch is the correct way to proceed as machine 
> should be passed even if not implemented yet.  That said, if the patch 
> is acceptable, there is another case that will need to be brought into line.

Hans means something like the following done in PdhOpenQueryA:

WCHAR *sourceW = NULL;
if (source && !(sourceW = pdh_strdup_aw( source ))) return PDH_MEMORY_ALLOCATION_FAILURE;

and that's certainly not a large amount of code. Actually all pdh_strdup_aw
callers already check for a possible NULL, but that may be sent as a separate
patch IMO.

-- 
Dmitry.


From dmitry at codeweavers.com  Thu Feb 14 05:36:09 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 14 Feb 2008 19:36:09 +0800
Subject: [RFC] winecfg enhancements
References: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com><loom.20080213T205414-81@post.gmane.org>
	<3f4fd2640802140123o1a1fa8dl5fe7698cb128a382@mail.gmail.com>
Message-ID: <003f01c86efd$ccbd04e0$a600fea9@DMITRY>

"Reece Dunn" <msclrhd at googlemail.com> wrote:

> Does anyone know how to set up the meta bug/group to track these?

We decided to avoid meta bugs in Wine. I'd suggest to discuss the things
first on wine-devel, and make sure that there is an agreement to what you
are planning to change. Only then start adding features, change functionality.

-- 
Dmitry.


From austinenglish at gmail.com  Thu Feb 14 06:11:27 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 14 Feb 2008 06:11:27 -0600
Subject: [RFC] winecfg enhancements
In-Reply-To: <003f01c86efd$ccbd04e0$a600fea9@DMITRY>
References: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com>
	<loom.20080213T205414-81@post.gmane.org>
	<3f4fd2640802140123o1a1fa8dl5fe7698cb128a382@mail.gmail.com>
	<003f01c86efd$ccbd04e0$a600fea9@DMITRY>
Message-ID: <b6bb06270802140411q6b72616v5c79420e36c70be5@mail.gmail.com>

How about a keyword/wiki page tracking the requests.

-Austin

On Thu, Feb 14, 2008 at 5:36 AM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> "Reece Dunn" <msclrhd at googlemail.com> wrote:
>
>
> > Does anyone know how to set up the meta bug/group to track these?
>
>  We decided to avoid meta bugs in Wine. I'd suggest to discuss the things
>  first on wine-devel, and make sure that there is an agreement to what you
>  are planning to change. Only then start adding features, change functionality.
>
>  --
>  Dmitry.
>
>
>


From bon at elektron.ikp.physik.tu-darmstadt.de  Thu Feb 14 06:55:45 2008
From: bon at elektron.ikp.physik.tu-darmstadt.de (Uwe Bonnes)
Date: Thu, 14 Feb 2008 13:55:45 +0100
Subject: OUTB() and friends on Win32 and .sys files(Resent)
Message-ID: <18356.14929.993365.826492@hertz.ikp.physik.tu-darmstadt.de>

Hallo,

some programm with source uses giveio.sys to access the parallel port. You
can find the source for giveio.sys e.g. in the avrdude package.  We
have code in dlls/winedos/ppdev.c to emulate the directed access on the
parallel port to accesses to /dev/ppdev. 

However this code is not called for WIN32 code. So after starting giveio
with loaddrv.exe supplied with giveio
> wine loaddrv.exe start giveio
starting giveio... ok.
> wine javr.exe
crashes when the outb access happens:
javr [<filename>] [-p<port>] [-f<fusefilename>] [-e<eepromfilename>] [-L] [-V]
Allocated flash buffer of 128K
Using giveio.sys to gain port access to 0x378
trace:seh:raise_exception code=c0000096 flags=0 addr=0x4014b6
trace:seh:raise_exception  eax=00000000 ebx=00000000 ecx=00000378 edx=00000378 esi=00000378 edi=00110388
trace:seh:raise_exception  ebp=0072fe50 esp=0072fe50 cs=0073 ds=007b es=007b fs=0033 gs=003b flags=00010246
trace:seh:call_stack_handlers calling handler at 0x7eddc5bc code=c0000096 flags=0
trace:seh:MSVCRT_signal (4, (nil))
wine: Unhandled privileged instruction at address 0x4014b6 (thread 0011), starting debugger...
trace:seh:start_debugger Starting debugger "winedbg --auto 16 56"
trace:seh:call_stack_handlers handler at 0x7eddc5bc returned 1
Unhandled exception: privileged instruction in 32-bit code (0x004014b6).
Register dump:
 CS:0073 SS:007b DS:007b ES:007b FS:0033 GS:003b
 EIP:004014b6 ESP:0072fe50 EBP:0072fe50 EFLAGS:00010246(   - 00      -RIZP1)
 EAX:00000000 EBX:00000000 ECX:00000378 EDX:00000378
 ESI:00000378 EDI:00110388
Stack dump:
0x0072fe50:  0072fe58 0040151a 0072fe88 00406ccf
0x0072fe60:  00000378 00000000 00000000 00403411
0x0072fe70:  00000001 00110388 0072fe88 0040a3ef
0x0072fe80:  0040a3ef 00000001 0072fec8 004025e4
0x0072fe90:  00000378 00000378 00110048 0040255c
0x0072fea0:  7ed5ff48 7ffdf000 0072fec8 7ed30f5c
Backtrace:
=>1 0x004014b6 outb+0x6(value=0x0, port=0x378) [/spare/bon/jtagprog/win/javr-2.8/ppiwin.c:311] in javr (0x0072fe50)

MS msvcrt.dll also supplies outb().

What is the policy to handle outb() and friends?

Thanks

-- 
Uwe Bonnes                bon at elektron.ikp.physik.tu-darmstadt.de

Institut fuer Kernphysik  Schlossgartenstrasse 9  64289 Darmstadt
--------- Tel. 06151 162516 -------- Fax. 06151 164321 ----------


From msclrhd at googlemail.com  Thu Feb 14 06:06:44 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Thu, 14 Feb 2008 12:06:44 +0000
Subject: [RFC] winecfg enhancements
In-Reply-To: <003f01c86efd$ccbd04e0$a600fea9@DMITRY>
References: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com>
	<loom.20080213T205414-81@post.gmane.org>
	<3f4fd2640802140123o1a1fa8dl5fe7698cb128a382@mail.gmail.com>
	<003f01c86efd$ccbd04e0$a600fea9@DMITRY>
Message-ID: <3f4fd2640802140406r383cb31n7f8c187f45863b73@mail.gmail.com>

On 14/02/2008, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> "Reece Dunn" <msclrhd at googlemail.com> wrote:
>
> > Does anyone know how to set up the meta bug/group to track these?
>
> We decided to avoid meta bugs in Wine. I'd suggest to discuss the things
>  first on wine-devel, and make sure that there is an agreement to what you
>  are planning to change. Only then start adding features, change functionality.

Ok. I was trying to find a better way of tracking planned changes -
what I am planning, the changes that Ubuntu are interested in and
other usability issues from other sources. Perhapse the wiki is a
better place for tracking planned changes, provided that there is a
more consistent way of tracking feature requests/requirements,
analysis and design documentation.

- Reece


From jwhite at winehq.org  Thu Feb 14 08:21:00 2008
From: jwhite at winehq.org (Jeremy White)
Date: Thu, 14 Feb 2008 08:21:00 -0600
Subject: Weird failure in kernel32 volume test
In-Reply-To: <b130c85e0802131920t4ec53045q4350a1711602992@mail.gmail.com>
References: <b130c85e0802131920t4ec53045q4350a1711602992@mail.gmail.com>
Message-ID: <47B44E4C.1040404@winehq.org>

> Anyone else has some tests that consistently fail on make test?

As of last nights git tip, I still had four failures:

  http://test.winehq.org/data/20080213/#Wine

Cheers,

Jeremy


From fgouget at free.fr  Thu Feb 14 09:01:49 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 14 Feb 2008 16:01:49 +0100 (CET)
Subject: Weird failure in kernel32 volume test
In-Reply-To: <47B44E4C.1040404@winehq.org>
References: <b130c85e0802131920t4ec53045q4350a1711602992@mail.gmail.com>
	<47B44E4C.1040404@winehq.org>
Message-ID: <alpine.DEB.1.00.0802141600360.31997@amboise.dolphin>

On Thu, 14 Feb 2008, Jeremy White wrote:

> > Anyone else has some tests that consistently fail on make test?
> 
> As of last nights git tip, I still had four failures:

Five actually.


>   http://test.winehq.org/data/20080213/#Wine



-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
             Research is the transformation of money to knowledge.
            Innovation is the transformation of knowledge to money.
                              -- Dr. Hans Meixner


From frank.richter at gmail.com  Thu Feb 14 09:03:29 2008
From: frank.richter at gmail.com (Frank Richter)
Date: Thu, 14 Feb 2008 16:03:29 +0100
Subject: [RFC] winecfg enhancements
In-Reply-To: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com>
References: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com>
Message-ID: <47B45841.2080600@gmail.com>

On 13.02.2008 10:15, Reece Dunn wrote:
>   *  Pre-populate the Theme list with themes in
> WINDOWS/Resources/Themes and with other *.theme files added by the
> user.

I dimly recall this is already the case. winecfg lets uxtheme enum 
installed themes, which in turn should look into said directory.

>   *  Rename "Install theme..." to "Add...".
> 
>      The rationale is that we are not installing a theme, but setting
> it as the theme being used. Having the theme appear in the Themes list
> in the future further supports this name change and workflow.

Well but it really installs. It copies the selected file to Themes dir. 
See on_theme_install() in winecfg.

-f.r.


From dank at kegel.com  Thu Feb 14 09:07:08 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 14 Feb 2008 07:07:08 -0800
Subject: Google's support for Wine in 2007
In-Reply-To: <b6bb06270802140150k28d57f90r9d38de926c2d3f5a@mail.gmail.com>
References: <a71bd89a0802132203u5e4782f0g3708dbbdc249edc9@mail.gmail.com>
	<b6bb06270802140150k28d57f90r9d38de926c2d3f5a@mail.gmail.com>
Message-ID: <a71bd89a0802140707k62654e44p63533ed9288b901d@mail.gmail.com>

On Thu, Feb 14, 2008 at 1:50 AM, Austin English <austinenglish at gmail.com> wrote:
>  What's the status of getting the win16 tests into wine? 16 bit support
>  broke a while back for many apps and is still broken.

The sticking point is that most people don't have a 16 bit C
compiler installed.  The only good free one is Open Watcom.
Unfortunately, you still can't just do 'sudo apt-get install openwatcom'
on most distributions (see
http://openwatcom.org/index.php/Installing_Open_Watcom_on_Linux ),
and there were some hitches using the Linux version anyway, so
win16test provides a shell script that installs the Windows version
under Wine.  (See
http://code.google.com/p/win16test/source/browse/trunk/src/README )
And that's kind of heavyweight, so we can't just jam it into the Wine
build system.

Potentially, though, the Wine build system could notice whether
openwatcom was available, and if so, it could build the win16 tests.

For now, they're kept out of tree in
http://code.google.com/p/win16test/
and I encourage others to try them out and fix problems they find.
- Dan


From meissner at suse.de  Thu Feb 14 09:11:36 2008
From: meissner at suse.de (Marcus Meissner)
Date: Thu, 14 Feb 2008 16:11:36 +0100
Subject: Google's support for Wine in 2007
In-Reply-To: <a71bd89a0802132203u5e4782f0g3708dbbdc249edc9@mail.gmail.com>
References: <a71bd89a0802132203u5e4782f0g3708dbbdc249edc9@mail.gmail.com>
Message-ID: <20080214151136.GA20727@suse.de>

On Wed, Feb 13, 2008 at 10:03:21PM -0800, Dan Kegel wrote:
> As you might know, I work for Google, and part of my
> day job is to help improve Wine.  Here's a little report
> about what we've been up to.
...

Nice work :)

> All that may sound like a lot, and perhaps it is, but it pales
> compared to the work put in on Wine by the rest of the Wine developers.
> Thanks, everybody!  I'm really looking forward to Wine 1.0
> (which, according to Alexandre, is planned for sometime in 2008).

I hope you have not forgotten that you volunteered to be Release Manager ;)

Ciao, Marcus


From dank06 at kegel.com  Thu Feb 14 09:12:53 2008
From: dank06 at kegel.com (Dan Kegel)
Date: Thu, 14 Feb 2008 07:12:53 -0800
Subject: Google's support for Wine in 2007
In-Reply-To: <20080214151136.GA20727@suse.de>
References: <a71bd89a0802132203u5e4782f0g3708dbbdc249edc9@mail.gmail.com>
	<20080214151136.GA20727@suse.de>
Message-ID: <a71bd89a0802140712r458f8599pcafc30417f154bec@mail.gmail.com>

On Thu, Feb 14, 2008 at 7:11 AM, Marcus Meissner <meissner at suse.de> wrote:
>  > Thanks, everybody!  I'm really looking forward to Wine 1.0
>  > (which, according to Alexandre, is planned for sometime in 2008).
>
>  I hope you have not forgotten that you volunteered to be Release Manager ;)

Not at all.  Just being realistic about how much influence
I can really have!
- Dan


From meissner at suse.de  Thu Feb 14 10:41:06 2008
From: meissner at suse.de (Marcus Meissner)
Date: Thu, 14 Feb 2008 17:41:06 +0100
Subject: OUTB() and friends on Win32 and .sys files(Resent)
In-Reply-To: <18356.14929.993365.826492@hertz.ikp.physik.tu-darmstadt.de>
References: <18356.14929.993365.826492@hertz.ikp.physik.tu-darmstadt.de>
Message-ID: <20080214164106.GA439@suse.de>

On Thu, Feb 14, 2008 at 01:55:45PM +0100, Uwe Bonnes wrote:
> Hallo,
> 
> some programm with source uses giveio.sys to access the parallel port. You
> can find the source for giveio.sys e.g. in the avrdude package.  We
> have code in dlls/winedos/ppdev.c to emulate the directed access on the
> parallel port to accesses to /dev/ppdev. 
> 
> However this code is not called for WIN32 code. So after starting giveio
> with loaddrv.exe supplied with giveio
> > wine loaddrv.exe start giveio
> starting giveio... ok.
> > wine javr.exe
> crashes when the outb access happens:
> =>1 0x004014b6 outb+0x6(value=0x0, port=0x378) [/spare/bon/jtagprog/win/javr-2.8/ppiwin.c:311] in javr (0x0072fe50)
> 
> MS msvcrt.dll also supplies outb().
> 
> What is the policy to handle outb() and friends?

We can handle such privileged opcodes in Win32 mode too, 
we do for some kernel drivers already.

For outb (or the specific exception code) it is probably not hooked correctly.

Ciao, Marcus


From austinenglish at gmail.com  Thu Feb 14 11:57:28 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 14 Feb 2008 11:57:28 -0600
Subject: Weird failure in kernel32 volume test
In-Reply-To: <alpine.DEB.1.00.0802141600360.31997@amboise.dolphin>
References: <b130c85e0802131920t4ec53045q4350a1711602992@mail.gmail.com>
	<47B44E4C.1040404@winehq.org>
	<alpine.DEB.1.00.0802141600360.31997@amboise.dolphin>
Message-ID: <b6bb06270802140957g780f01dm15b3643ad7561551@mail.gmail.com>

On Thu, Feb 14, 2008 at 9:01 AM, Francois Gouget <fgouget at free.fr> wrote:
> On Thu, 14 Feb 2008, Jeremy White wrote:
>
>  > > Anyone else has some tests that consistently fail on make test?
>  >
>  > As of last nights git tip, I still had four failures:
>
>  Five actually.
>
>
>
>
>  >   http://test.winehq.org/data/20080213/#Wine
>
>
>
>  --
>  Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
>              Research is the transformation of money to knowledge.
>             Innovation is the transformation of knowledge to money.
>                               -- Dr. Hans Meixner
>

http://test.winehq.org/data/200802141000/
I'm still getting a few failures. Keep in mind, this is run in a
virtualbox VM (Windows XP SP2 host, Ubuntu Feisty guest), so some
tests (d3d) are probably going to fail and should be a skip, but
others (msi/winmm/etc), should be fine. I'm currently seeing failures
in:

d3d8:visual
d3d9:visual
kernel32:process
msi:install
ntdll:exception
oleaut32:typelib
riched20:editor
shell32:shelllink
user32:input
user32:menu
user32:msg
user32:win
winmm:wave

-Austin


From tony.wasserka at freenet.de  Thu Feb 14 12:47:38 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Thu, 14 Feb 2008 19:47:38 +0100
Subject: d3dx9 patches
Message-ID: <E1JPj7S-0002pq-Ih@www12.emo.freenet-rz.de>

Hi,
It's nearly two weeks ago that I sent those patches, so I was curious if there are any
problems with it?
http://www.winehq.org/pipermail/wine-patches/2008-February/049554.html
http://www.winehq.org/pipermail/wine-patches/2008-February/049667.html
http://www.winehq.org/pipermail/wine-patches/2008-February/049677.html
http://www.winehq.org/pipermail/wine-patches/2008-February/049679.html
http://www.winehq.org/pipermail/wine-patches/2008-February/049705.html











From stefan at codeweavers.com  Thu Feb 14 12:58:41 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 14 Feb 2008 19:58:41 +0100
Subject: wined3d: fix memcpy with wrong size parameter to simple
	assignment in GetScissorRect
In-Reply-To: <47B359FF.3040004@web.de>
References: <47B359FF.3040004@web.de>
Message-ID: <200802141958.41586.stefan@codeweavers.com>

Am Mittwoch, 13. Februar 2008 21:58:39 schrieb Rico Sch?ller:
> Hi,
>
> this fixes the GetScissorRect function in wined3d. This is required for
> the game Gothic3 where the misbehavior is seen.
The patch looks ok to me


From m.b.lankhorst at gmail.com  Thu Feb 14 15:09:18 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 14 Feb 2008 13:09:18 -0800
Subject: Weird failure in kernel32 volume test
In-Reply-To: <b130c85e0802140937t5a99c287j86e0dbe3e194327@mail.gmail.com>
References: <b130c85e0802131920t4ec53045q4350a1711602992@mail.gmail.com>
	<47B44E4C.1040404@winehq.org>
	<b130c85e0802140937t5a99c287j86e0dbe3e194327@mail.gmail.com>
Message-ID: <b130c85e0802141309o24511b96mdbdc33488b6b2672@mail.gmail.com>

Hi Jeremy,
2008/2/14, Jeremy White <jwhite at winehq.org>:
> Anyone else has some tests that consistently fail on make test?
>
>
> As of last nights git tip, I still had four failures:
>
>   http://test.winehq.org/data/20080213/#Wine

I submitted a patch for the comm test. I'm not 100% sure about the
shelllink test.

On that site there is also a failure for 'volume' which I experienced
as well. I have really no idea what causes it though, but it looks
like aj has done some work on it. Maybe you have any idea alexandre?

Cheers,
Maarten.


From arthurmaciel at gmail.com  Thu Feb 14 12:10:30 2008
From: arthurmaciel at gmail.com (Arthur Maciel)
Date: Thu, 14 Feb 2008 15:10:30 -0300
Subject: Windows Mobile API
Message-ID: <b030cb940802141010y659076ebo724455ad0aafce84@mail.gmail.com>

Hi there.

I?m not part of the mailing list, but I really want to know if there is any
port of WINE to support Windows Mobile API (that is Windows for pocket pc,
handhelds and pocket phones). This would come as a great solution for me, as
I need specific WM programs on my pda.

I really appreciate any help and information.

Regards,
Arthur
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080214/7b6f61a9/attachment.htm 

From marco at mandrivaclub.nl  Thu Feb 14 15:08:33 2008
From: marco at mandrivaclub.nl (marco)
Date: Thu, 14 Feb 2008 22:08:33 +0100
Subject: gecko download not robust?
In-Reply-To: <b6bb06270802131330k8432187od0b15e766cb2c4ae@mail.gmail.com>
References: <47AE349F.7040605@mandrivaclub.nl>	
	<b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>	
	<47B3600C.1030000@mandrivaclub.nl>
	<b6bb06270802131330k8432187od0b15e766cb2c4ae@mail.gmail.com>
Message-ID: <47B4ADD1.8070302@mandrivaclub.nl>

Yes a suggested package is possible. But most people would not know it
is there and would not install it.

What is the status of the gecko package. Is it something people really
need for a good wine experience
or do we want to present it as a suggestion ?

Marco


Austin English wrote:
> You could make it a suggested package, a la wine-dev. Including is
> also a possibility, but keep in mind that's several megabytes that
> don't change with each release (or that often) that have to be
> redownloaded each time. I've got high bandwith, so doesn't bother me,
> but a lot of people don't...
>
> -Austin
>
> On Feb 13, 2008 3:24 PM, marco <marco at mandrivaclub.nl> wrote:
>   
>> Austin English wrote:
>>     
>>> On Feb 9, 2008 5:17 PM, marco <marco at mandrivaclub.nl> wrote:
>>>
>>>       
>>>>> Hmm.  gecko download hung for me once.  I saw
>>>>> fixme:urlmon:ProtocolStream_Read Read failed: 800c0008
>>>>> in the log, which makes me wonder if our download code
>>>>> doesn't handle transient network errors well.
>>>>>
>>>>> Time to get rid of the download, and just bundle gecko outright, I say...
>>>>>
>>>>>           
>>>> I make the mandriva rpms for wine.
>>>> This would make the rpms 30% bigger.
>>>> And you would download the same gecko binary over and over again with
>>>> every new version.
>>>>
>>>> But if that is not a problem than it can be easily done.
>>>>
>>>>
>>>>
>>>>         
>>> Why not have package maintainers package gecko like most do
>>> development files. So you could have for example on ubuntu:
>>> $ sudo apt-get install wine wine-dev wine-gecko
>>>
>>> Where wine-gecko wouldn't have to be upgraded very often.
>>>
>>> -Austin
>>>
>>>
>>>       
>> I looked into it.
>> And there are some options.
>>
>> I can make a separate  package  of gecko  that  I can make it a
>> dependencie of wine.
>> Problem is people have to know where to find it or the get stuck.
>>
>> I can also make the package and make it not a dependencie on wine but
>> the the people don't know it exist.
>>
>> And I can just put it in the wine package.
>>
>> I think this is the best option in this case. Its the easiest option
>> because people only have to download en install one package.
>>
>> marco
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>     
>
>   




From austinenglish at gmail.com  Thu Feb 14 16:02:20 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 14 Feb 2008 16:02:20 -0600
Subject: gecko download not robust?
In-Reply-To: <47B4ADD1.8070302@mandrivaclub.nl>
References: <47AE349F.7040605@mandrivaclub.nl>
	<b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>
	<47B3600C.1030000@mandrivaclub.nl>
	<b6bb06270802131330k8432187od0b15e766cb2c4ae@mail.gmail.com>
	<47B4ADD1.8070302@mandrivaclub.nl>
Message-ID: <b6bb06270802141402q39ad2ddancc29a76cce51b075@mail.gmail.com>

On Thu, Feb 14, 2008 at 3:08 PM, marco <marco at mandrivaclub.nl> wrote:
> Yes a suggested package is possible. But most people would not know it
>  is there and would not install it.

Could adjust the current dialog that asks to install gecko to say
something to the effect of 'This package may also be available through
your distribution's package manager.'

>  What is the status of the gecko package. Is it something people really
>  need for a good wine experience
>  or do we want to present it as a suggestion ?

In my personal experience when testing apps for bug reports/AppDB,
I've found around 1/4 or so of applications require it for some
functionality. This is highly subjective, of course, and others may
have different experiences.

-Austin


From donpedro at tdcadsl.dk  Thu Feb 14 16:09:20 2008
From: donpedro at tdcadsl.dk (Peter Dons Tychsen)
Date: Thu, 14 Feb 2008 23:09:20 +0100
Subject: ddraw / wined3d fighting over the resolution!
In-Reply-To: <20080214081919.FQMG4584.fep28.mail.dk@mail.codeweavers.com>
References: <b130c85e0802121725g5eb77f73k8c4c85a8a21173fe@mail.gmail.com>
	<20080213013044.ZOPJ11715.fep26.mail.dk@wine.codeweavers.com>
	<1202959336.2970.18.camel@dhcppc4>
	<20080214081919.FQMG4584.fep28.mail.dk@mail.codeweavers.com>
Message-ID: <1203026960.3047.9.camel@dhcppc4>

Hello S.

I have studied this a bit more.
The app seems to do this purposely.

In any case wined3d should not change the mode in this case.
Either wined3d must detect this, or the code should be moved into
d3d8/d3d9.

On a similar note, i found i found a funny "RestoreDisplayMode()" call
in "SetCooperateLevel()", when switching from full-screen. I tested with
win-xp, and here this does not happen. This causes additional
mode-switch flicker.

I think i will chew on some nice German wine-gums (Haribo), 
and then send some patches :-). mmmmmm.... wine-gums.... they should
sell them on wine.org... would be appropriate... :-)

/p


On Thu, 2008-02-14 at 09:18 +0100, Stefan D?singer wrote:
> Am Donnerstag, 14. Februar 2008 04:22:16 schrieb Peter Dons Tychsen:
> > Why does the SwapChain-destroy function play around with the resolution
> > at all. Is that really necessary? I think it should not do it if the
> > caller is ddraw at least.
> I thought I'm filtering this out in the case of ddraw, but maybe that got 
> lost. The reason why the swapchain restores the resolution is the different 
> way ddraw/d3d8 and d3d8/d3d9 set up the screen.
> 
> In ddraw the app calls IDirectDraw7::SetDisplayMode. This sets the mode. Then 
> it creates a DDSCAPS_PRIMARYSURFACE surface, which creates the swapchain.
> 
> In d3d8/d3d9 the swapchain controls the video mode
> 
> I think the problem is that RestoreDisplayMode is called before the primary 
> surface is destroyed. The question is why this happens. I can think of the 
> following reasons:
> 
> -> Refcounting problem, or the app just doesn't release the surfaces. Then 
> ddraw.dll destroys the objects on DLL_PROCESS_DETACH
> 
> -> The app calls it that way. This needs a test, but I think it is not allowed 
> to call SetDisplayMode / RestoreDisplayMode while a primary surface is around



From wine.dev at web.de  Thu Feb 14 16:30:05 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Thu, 14 Feb 2008 23:30:05 +0100
Subject: mscms: [GS]etColorSpace() are not supposed to be defined in icm.h.
In-Reply-To: <alpine.DEB.1.00.0802132151150.3491@amboise.dolphin>
References: <alpine.DEB.1.00.0802132151150.3491@amboise.dolphin>
Message-ID: <1203028205.7721.14.camel@p4>

On Mi, 2008-02-13 at 21:52 +0100, Francois Gouget wrote:

> diff --git a/include/icm.h b/include/icm.h

The end of the attached Patchfile is broken:

> &#0;&#0;&#0;&#0;&#0;&#0;&#0;&#;&#0;&#0;&#0;&#0;&#0;&#0;&

-- 
 
By by ... Detlef




From jacek at codeweavers.com  Thu Feb 14 16:41:48 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Thu, 14 Feb 2008 23:41:48 +0100
Subject: gecko download not robust?
In-Reply-To: <19e31a080802131359o20bf11cci2afc6d322bcdf23d@mail.gmail.com>
References: <47AE349F.7040605@mandrivaclub.nl>	
	<b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>	
	<47AFAA38.5070201@open-vote.org> <47AFBCDD.2070206@codeweavers.com>
	<19e31a080802131359o20bf11cci2afc6d322bcdf23d@mail.gmail.com>
Message-ID: <47B4C3AC.2050603@codeweavers.com>

Steven Edwards wrote:
> On Feb 10, 2008 10:11 PM, Jacek Caban <jacek at codeweavers.com> wrote:
>   
>> Compiling the package is quite tricky. I've compiled it on Windows XP
>> using MSVC. There is no other way ATM, so I think that my Gecko package
>> should be included as is in Linux packages.
>>     
>
> Where is the source package? Is it just from the normal firefox source
> tree with certain configuration options?
>   

The source available is on Wine's SourceForge site.

Jacek


From jacek at codeweavers.com  Thu Feb 14 16:41:50 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Thu, 14 Feb 2008 23:41:50 +0100
Subject: gecko valgrind errors show up better now
In-Reply-To: <a71bd89a0802111815s5a123a46tc222ba1740fcd570@mail.gmail.com>
References: <a71bd89a0802111815s5a123a46tc222ba1740fcd570@mail.gmail.com>
Message-ID: <47B4C3AE.1020605@codeweavers.com>

Dan Kegel wrote:
> The new version of valgrind shows better stack
> dumps for gecko valgrind errors.  For instance,
>   
>  ...
>   
> etc., etc.  Jacek, if you can give me a debug build of gecko,
> I can probably give you even better info.  Interested?
>   

I'm definitely interested. I can see from your examples that at most one 
of them may be a MSHTML problem. The other ones may be Gecko or some 
other part's problem. I don't have the debug build on my current 
machine, so I will send it to you as soon as I will have access to them.

Thanks,
    Jacek


From fgouget at free.fr  Thu Feb 14 16:55:09 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 14 Feb 2008 23:55:09 +0100 (CET)
Subject: mscms: [GS]etColorSpace() are not supposed to be defined in icm.h.
In-Reply-To: <1203028205.7721.14.camel@p4>
References: <alpine.DEB.1.00.0802132151150.3491@amboise.dolphin>
	<1203028205.7721.14.camel@p4>
Message-ID: <alpine.DEB.1.00.0802142353140.2928@amboise.dolphin>

On Thu, 14 Feb 2008, Detlef Riekenberg wrote:

> On Mi, 2008-02-13 at 21:52 +0100, Francois Gouget wrote:
> 
> > diff --git a/include/icm.h b/include/icm.h
> 
> The end of the attached Patch file is broken:
> 
> > &#0;&#0;&#0;&#0;&#0;&#0;&#0;&#;&#0;&#0;&#0;&#0;&#0;&#0;&

Actually it's ok, this is just extra padding so no part of the patch is 
missing. Also, I can export the email here and apply it with patch -p1. 
Still I admit this series of patches is a little weird, I'll change the 
git-format-patch command for the next round.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
        It really galls me that most of the computer power in the world
                          is wasted on screen savers.
                     Chris Caldwell from the GIMPS project
                       http://www.mersenne.org/prime.htm


From donpedro at tdcadsl.dk  Thu Feb 14 21:00:20 2008
From: donpedro at tdcadsl.dk (Peter Dons Tychsen)
Date: Fri, 15 Feb 2008 04:00:20 +0100
Subject: ddraw / wined3d fighting over the resolution!
In-Reply-To: <20080214081919.FQMG4584.fep28.mail.dk@mail.codeweavers.com>
References: <b130c85e0802121725g5eb77f73k8c4c85a8a21173fe@mail.gmail.com>
	<20080213013044.ZOPJ11715.fep26.mail.dk@wine.codeweavers.com>
	<1202959336.2970.18.camel@dhcppc4>
	<20080214081919.FQMG4584.fep28.mail.dk@mail.codeweavers.com>
Message-ID: <1203044420.3047.17.camel@dhcppc4>

On Thu, 2008-02-14 at 09:18 +0100, Stefan D?singer wrote:
> Am Donnerstag, 14. Februar 2008 04:22:16 schrieb Peter Dons Tychsen:
> > Why does the SwapChain-destroy function play around with the resolution
> > at all. Is that really necessary? I think it should not do it if the
> > caller is ddraw at least.
> I thought I'm filtering this out in the case of ddraw, but maybe that got 
> lost. The reason why the swapchain restores the resolution is the different 
> way ddraw/d3d8 and d3d8/d3d9 set up the screen.
> 
> In ddraw the app calls IDirectDraw7::SetDisplayMode. This sets the mode. Then 
> it creates a DDSCAPS_PRIMARYSURFACE surface, which creates the swapchain.
> 
> In d3d8/d3d9 the swapchain controls the video mode
> 
> I think the problem is that RestoreDisplayMode is called before the primary 
> surface is destroyed. The question is why this happens. I can think of the 
> following reasons:
> 
> -> Refcounting problem, or the app just doesn't release the surfaces. Then 
> ddraw.dll destroys the objects on DLL_PROCESS_DETACH
> 
> -> The app calls it that way. This needs a test, but I think it is not allowed 
> to call SetDisplayMode / RestoreDisplayMode while a primary surface is around

OK, i have now eaten enough wine-gums to comprehend this....

I think there is a general problem in swapchain->release. The swapchain
should only change the resolution back to the original *if* the current
resolution is still the same as the swapchain enforced. If someone else
has intervened, it should let it be. This fixes the problem at hand,
but would also fix other silly problems. Some could for example have
called Release() while the "window" is not even visible (tabbed to
desktop for example).

Please review my patch and let med know if it is submittable.
If you hate it, i will eat more wine-gums. :-)

/pedro 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix_for_resolution_battle.diff
Type: text/x-patch
Size: 1232 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080215/3104338b/attachment-0001.bin 

From jjmckenzie51 at sprintpcs.com  Thu Feb 14 21:50:49 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Thu, 14 Feb 2008 20:50:49 -0700
Subject: [RFC] winecfg enhancements
In-Reply-To: <3f4fd2640802140123o1a1fa8dl5fe7698cb128a382@mail.gmail.com>
References: <3f4fd2640802130115u9583e5hd4ace93e04806832@mail.gmail.com>
	<loom.20080213T205414-81@post.gmane.org>
	<3f4fd2640802140123o1a1fa8dl5fe7698cb128a382@mail.gmail.com>
Message-ID: <47B50C19.2010105@sprintpcs.com>

Reece Dunn wrote:
> On 13/02/2008, Jeff Zaroyko <jeffzaroyko at gmail.com> wrote:
>   
>> Reece Dunn <msclrhd <at> googlemail.com> writes:
>>
>>  > I am looking at how we can make winecfg more useful. I have already
>>  > supplied patches to allow importing a ubuntu human theme to work :).
>>  > So I am now looking at how to build on that.
>>
>>  I think this could probably do with some consideration
>>  http://bugs.winehq.org/show_bug.cgi?id=6233 , it describes how the
>>  Applications tab does not belong among the other tabs because it should be
>>  higher up in the hierarchy of things.
>>     
>
> There are several bugs related to winecfg currently. Also, the Ubuntu
> devs have some ideas on improvements to winecfg on their wiki, as well
> as some ideas for command line access to winecfg, install/uninstall
> and other functionality.
>   
Great.  One bug == one bugzilla entry.  One enhancement == one bugzilla 
enhancement entry
> Ideally, there should be a winecfg meta-bug, like what we have for 1.0
> and have the various enhancements grouped into relevant bugs. This
> will allow attachments (like mockups to be added), as well as tracking
> patches and ideas.
>   
There is no metabug for Wine 1.0.  There is a query that is run that 
shows bugs that should be closed/corrected  before Wine 1.0 is released
> I'll start setting this up, and raising the Ubuntu comments as
> enhancements, to better track things and get the usability and
> scriptability of wine configuration and management up to where they
> should be.
>
>   
Again, one bug or one enhancement - one bugzilla entry.  Some of the 
bugs/enhancements should be there before Wine 1.0 is released, some 
others can wait and others still may never be there.
> Does anyone know how to set up the meta bug/group to track these?
>
>   
No.  Metabugz are not desired for additional functionality.  Their 
purpose should be only to track bugs found in a particular release 
candidate that will stop a product release.  It is undesirable to have a 
metabug for a series of enhancements.

James



From dmitry at codeweavers.com  Thu Feb 14 22:15:41 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 15 Feb 2008 12:15:41 +0800
Subject: Fixing the last failing tests
References: <a71bd89a0802121820s440d1298k560aa2e9e14ea70f@mail.gmail.com>
	<a71bd89a0802131401q65e67b64jaf4289762e628fe4@mail.gmail.com>
Message-ID: <008501c86f89$711dcc00$a600fea9@DMITRY>

"Dan Kegel" <dank at kegel.com> wrote:

> The test you submitted that checks this,
> http://www.winehq.org/pipermail/wine-patches/2005-July/018839.html
> must have passed once on Windows,
> but it seems to be failing now; see e.g.
> http://test.winehq.org/data/200802131000/xp_rs-winxp-sp2/user32:win.txt
> which is full of lines like
> win.c:3656: Test failed: IsWindowUnicode expected to return FALSE
> 
> Do you have a Windows system where that test passes currently?

I've performed a little investigation trying to find out at which point XP
has changed its behaviour. It's pretty much hard taking into account how
many broken user32:win.c tests we have at test.winehq.org (all the tests
marked as 'failed' are useless). It looks like the change/breakage occured
somewhere at the end of October 2007 - beginning of November 2007:

http://test.winehq.org/data/200710271000/xp_brainless-20071027/user32:win.txt
http://test.winehq.org/data/200710271000/xp_mbv-.48/user32:win.txt

don't have failing IsWindowUnicode tests,
but http://test.winehq.org/data/200711072209/#XP suite already has them:

http://test.winehq.org/data/200711072209/xp_200711SCHOEMB/user32:win.txt

-- 
Dmitry.


From dmitry at codeweavers.com  Thu Feb 14 22:18:49 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 15 Feb 2008 12:18:49 +0800
Subject: winedos: Allocate a console when loading dos applications
References: <b130c85e0802141355l5d2e1879k2d19356c5b156a40@mail.gmail.com>
Message-ID: <00bf01c86f89$def6fb70$a600fea9@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

> Fixes bug 9178.
> 
> I was looking hard at it, then I had to laugh, hard, when I found this
> simple fix.

This patch is not correct, think for instance of all win16 applications.

-- 
Dmitry.


From julliard at winehq.org  Fri Feb 15 04:26:44 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 15 Feb 2008 11:26:44 +0100
Subject: [PATCH] winex11.drv: get hwnd for injected mouse events
In-Reply-To: <558b2f5c0802111803l28216443q9a4d5bec59c272d1@mail.gmail.com>
	(Lei Zhang's message of "Mon, 11 Feb 2008 18:03:58 -0800")
References: <558b2f5c0802111803l28216443q9a4d5bec59c272d1@mail.gmail.com>
Message-ID: <874pcafrbv.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> --- a/dlls/winex11.drv/mouse.c
> +++ b/dlls/winex11.drv/mouse.c
> @@ -278,6 +278,7 @@ void X11DRV_send_mouse_input( HWND hwnd, DWORD flags, DWORD x, DWORD y,
>          {
>              pt.x = (x * screen_width) >> 16;
>              pt.y = (y * screen_height) >> 16;
> +            hwnd = GetAncestor(WindowFromPoint(pt), GA_PARENT);

This should not be needed, for injected events the window is determined
on the server side.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Feb 15 04:39:24 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 15 Feb 2008 11:39:24 +0100
Subject: systray [4/4]: implement systray transparency
In-Reply-To: <200802071523.59519.lich@math.spbu.ru> (Kirill K. Smirnov's
	message of "Thu, 7 Feb 2008 15:23:59 +0000")
References: <200802071523.59519.lich@math.spbu.ru>
Message-ID: <87zlu2ec6b.fsf@wine.dyndns.org>

"Kirill K. Smirnov" <lich at math.spbu.ru> writes:

> diff --git a/dlls/winex11.drv/winex11.drv.spec b/dlls/winex11.drv/winex11.drv.spec
> index 36b83d7..126cbc5 100644
> --- a/dlls/winex11.drv/winex11.drv.spec
> +++ b/dlls/winex11.drv/winex11.drv.spec
> @@ -130,6 +130,7 @@ # Desktop
>  
>  # System tray
>  @ cdecl wine_make_systray_window(long) X11DRV_make_systray_window
> +@ cdecl wine_systray_window_clear(long) X11DRV_systray_window_clear

We don't want to export such a specific function. Besides, it should
really be setting the window shape.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Feb 15 04:49:05 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 15 Feb 2008 11:49:05 +0100
Subject: [PATCH 1/2] Add IRunnableTask interface (resend)
In-Reply-To: <b130c85e0802121728u559f35f6y2c44705f46b5c08e@mail.gmail.com>
	(Maarten Lankhorst's message of "Tue, 12 Feb 2008 17:28:55 -0800")
References: <b130c85e0802121728u559f35f6y2c44705f46b5c08e@mail.gmail.com>
Message-ID: <87ve4qebq6.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> I have no idea why it wasn't applied, so this is a resend with no modifications.

It should go in shobjidl.idl.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Feb 15 04:50:09 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 15 Feb 2008 11:50:09 +0100
Subject: user32: Implement GetWindowModuleFileName with tests (try 2)
In-Reply-To: <b130c85e0802121730m16fd0baej12eb451172d2add@mail.gmail.com>
	(Maarten Lankhorst's message of "Tue, 12 Feb 2008 17:30:39 -0800")
References: <b130c85e0802121730m16fd0baej12eb451172d2add@mail.gmail.com>
Message-ID: <87r6feeboe.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> @@ -3121,9 +3133,21 @@ UINT WINAPI GetWindowModuleFileNameA( HWND hwnd, LPSTR lpszFileName, UINT cchFil
>   */
>  UINT WINAPI GetWindowModuleFileNameW( HWND hwnd, LPWSTR lpszFileName, UINT cchFileNameMax)
>  {
> -    FIXME("GetWindowModuleFileNameW(hwnd %p, lpszFileName %p, cchFileNameMax %u) stub!\n",
> -          hwnd, lpszFileName, cchFileNameMax);
> -    return 0;
> +    HINSTANCE hInst;
> +    UINT ret;
> +    TRACE("hwnd %p, lpszFileName %p, cchFileNameMax %u\n", hwnd, lpszFileName, cchFileNameMax);
> +
> +    hInst = (HINSTANCE)GetWindowLongPtrW(hwnd, GWLP_HINSTANCE);
> +    if (!hInst)
> +    {
> +        if (hwnd == GetDesktopWindow() || !IsWindow(hwnd))
> +            return 0;
> +        hInst = GetModuleHandleW(0);
> +    }
> +
> +    ret = GetModuleFileNameW(hInst, lpszFileName, cchFileNameMax);
> +    TRACE("--> %d %s\n", ret, debugstr_wn(lpszFileName, ret));
> +    return ret;

This won't work across processes.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Feb 15 04:52:24 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 15 Feb 2008 11:52:24 +0100
Subject: include: Fix the C_ASSERT macro to not generate an unused
	variable warning when compiling with gcc.
In-Reply-To: <47B2E40B.6090105@codeweavers.com> (Robert Shearman's message of
	"Wed, 13 Feb 2008 12:35:23 +0000")
References: <47B2E40B.6090105@codeweavers.com>
Message-ID: <87myq2ebkn.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> @@ -279,10 +279,10 @@ extern "C" {
>  
>  /* Compile time assertion */
>  
> -#if defined(_MSC_VER)
> +#if defined(_MSC_VER) || defined(__GNUC__)
>  # define C_ASSERT(e) typedef char __C_ASSERT__[(e)?1:-1]
> -#elif defined(__GNUC__) 
> -# define C_ASSERT(e) extern char __C_ASSERT__[(e)?1:-1]
> +#else
> +# define C_ASSERT(e)

This will break if you do two C_ASSERTs in the same scope.

-- 
Alexandre Julliard
julliard at winehq.org


From johan.gill at gmail.com  Fri Feb 15 05:37:49 2008
From: johan.gill at gmail.com (Johan Gill)
Date: Fri, 15 Feb 2008 12:37:49 +0100
Subject: What's up with GetPrivateProfileString?
Message-ID: <103c33d10802150337r3bcc7c4bx4a489600fa38bc65@mail.gmail.com>

http://bugs.winehq.org/show_bug.cgi?id=5424

The bug above is causing me some confusion regarding how
GetPrivateProfileString should behave.

Wine looks for maxis.ini in C:\Windows, and does not find it there.
Therefore, Setup.exe exits.
MSDN claims that if an absolute path is not provided, the windows
directory is searched for the file. There are also some registry
things to take into account, but maxis.ini
should not be referenced in the registry since it is located on a
CD-ROM and read before the autorun screen is shown.

It seems very likely that GetPrivateProfileString on real Windows with
just a filename as path argument looks in the current directory, but
it would be nice if someone with a real
Windows installation would check that.

I can have a try at writing the test source if necessary.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080215/34666e31/attachment.htm 

From stefan at codeweavers.com  Fri Feb 15 06:54:12 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 15 Feb 2008 13:54:12 +0100
Subject: ddraw / wined3d fighting over the resolution!
In-Reply-To: <1203044420.3047.17.camel@dhcppc4>
References: <b130c85e0802121725g5eb77f73k8c4c85a8a21173fe@mail.gmail.com>
	<20080214081919.FQMG4584.fep28.mail.dk@mail.codeweavers.com>
	<1203044420.3047.17.camel@dhcppc4>
Message-ID: <200802151354.12714.stefan@codeweavers.com>

Am Freitag, 15. Februar 2008 04:00:20 schrieb Peter Dons Tychsen:
> I think there is a general problem in swapchain->release. The swapchain
> should only change the resolution back to the original *if* the current
> resolution is still the same as the swapchain enforced. If someone else
> has intervened, it should let it be. This fixes the problem at hand,
> but would also fix other silly problems. Some could for example have
> called Release() while the "window" is not even visible (tabbed to
> desktop for example).
It sounds good and plausible, but I think a test case(preferably d3d8, d3d9 
and ddraw) would make it even better.

> Please review my patch and let med know if it is submittable.
> If you hate it, i will eat more wine-gums. :-)
I like them, but they make the teeth and everything in the mouth sticky due to 
all the sugar :-)


From julliard at winehq.org  Fri Feb 15 07:08:36 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 15 Feb 2008 14:08:36 +0100
Subject: Don't use GetExceptionCode and GetExceptionInformation in
	exception filter functions.
In-Reply-To: <47B452F3.7060604@codeweavers.com> (Robert Shearman's message of
	"Thu, 14 Feb 2008 14:40:51 +0000")
References: <47B452F3.7060604@codeweavers.com>
Message-ID: <87bq6ie59n.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> Alternatively, we could get rid of the WINE_EXCEPTION_FILTER and
> WINE_FINALLY_FUNC functions and make users of __EXCEPT and __FINALLY
> declare the functions themselves and access the exception data
> directly without use of macros.

That would be better, the macros only make sense if we can use the
standard ones. If we have to use a Wine-specific approach anyway then
the macros are just making it harder to see what's going on.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Fri Feb 15 07:08:25 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 15 Feb 2008 14:08:25 +0100
Subject: Windows Mobile API
In-Reply-To: <b030cb940802141010y659076ebo724455ad0aafce84@mail.gmail.com>
References: <b030cb940802141010y659076ebo724455ad0aafce84@mail.gmail.com>
Message-ID: <200802151408.25719.stefan@codeweavers.com>

Am Donnerstag, 14. Februar 2008 19:10:30 schrieb Arthur Maciel:
> Hi there.
>
> I?m not part of the mailing list, but I really want to know if there is any
> port of WINE to support Windows Mobile API (that is Windows for pocket pc,
> handhelds and pocket phones). This would come as a great solution for me,
> as I need specific WM programs on my pda.
This question is asked from time to time, and I think it is technically doable 
and a reasonable amount of code can be shared. However, the total interest 
has been too small for anything to happen. It might change if more Linux PDAs 
and cell phones appear in the future. So we're open to patches ;-)

The obstacles may be loader specific parts, and PDA specific APIs, as well as 
the different CPU type.


From lich at math.spbu.ru  Fri Feb 15 08:10:31 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Fri, 15 Feb 2008 14:10:31 +0000
Subject: systray [4/4]: implement systray transparency
In-Reply-To: <87zlu2ec6b.fsf.SS594SS@wine.dyndns.org>
References: <200802071523.59519.lich@math.spbu.ru>
	<87zlu2ec6b.fsf.SS594SS@wine.dyndns.org>
Message-ID: <200802151410.31168.lich@math.spbu.ru>

> "Kirill K. Smirnov" <lich at math.spbu.ru> writes:
> > diff --git a/dlls/winex11.drv/winex11.drv.spec
> > b/dlls/winex11.drv/winex11.drv.spec index 36b83d7..126cbc5 100644
> > --- a/dlls/winex11.drv/winex11.drv.spec
> > +++ b/dlls/winex11.drv/winex11.drv.spec
> > @@ -130,6 +130,7 @@ # Desktop
> >
> >  # System tray
> >  @ cdecl wine_make_systray_window(long) X11DRV_make_systray_window
> > +@ cdecl wine_systray_window_clear(long) X11DRV_systray_window_clear
>
> We don't want to export such a specific function. Besides, it should
> really be setting the window shape.

  Do I understand you correct that we should cut off transparent parts of 
icon, thus making window shape to match solid part of icon? Taking into 
account that almost every xembed-systray-aware application uses 
ParentRelative attribute (and KDE developers assumes this as I noticed at bug 
#3534), the idea of changing window shape sounds really strange.

  1) Is there any strong reason why we really must change windows shape to 
achieve visual transparency?

  2) Will it be better to stop embedding wine windows in favor of embedding 
pure X windows (like other apps do)? This way assumes implementing all 
xembed-specific stuff at winex11.drv side and exporting ONLY ONE function 
like wine_xembed_systray_handler(int cmd, void *data), which converts windows 
icon to X11 icon, creates X11 window with ParentRelative bkgrnd and embeds 
it. Explorer will use this function when it adds/removes icon to/from system 
tray. Also, this function will detect the case of wine virtual desktop and 
notify explorer to stop using xembed.
  I'm just not sure that this way will not break relaying mouse events.

--
Kirill


From fgouget at free.fr  Fri Feb 15 09:12:16 2008
From: fgouget at free.fr (Francois Gouget)
Date: Fri, 15 Feb 2008 16:12:16 +0100 (CET)
Subject: shell32: Fix character count passed into lstrcpnA in
	SHGetDataFromIDListA.
In-Reply-To: <47B56415.90007@codeweavers.com>
References: <47B56415.90007@codeweavers.com>
Message-ID: <alpine.DEB.1.00.0802151610500.2362@amboise.dolphin>


         if (shortname)
-            lstrcpynA(pfd->cAlternateFileName, shortname, MAX_PATH);
+            lstrcpynA(pfd->cAlternateFileName, shortname, 14);

sizeof(*pfd->cAlternateFileName) would be better than the magic 14 here.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
     You can have my guns when you pry them from my kids cold, dead hands.


From jwhite at winehq.org  Fri Feb 15 09:14:16 2008
From: jwhite at winehq.org (Jeremy White)
Date: Fri, 15 Feb 2008 09:14:16 -0600
Subject: Google's support for Wine in 2007
In-Reply-To: <a71bd89a0802140712r458f8599pcafc30417f154bec@mail.gmail.com>
References: <a71bd89a0802132203u5e4782f0g3708dbbdc249edc9@mail.gmail.com>	<20080214151136.GA20727@suse.de>
	<a71bd89a0802140712r458f8599pcafc30417f154bec@mail.gmail.com>
Message-ID: <47B5AC48.5070805@winehq.org>

I just want to take a moment to personally and publicly thank Dan and Google.

We have appreciated Google's support, and the work of all Google employees,
interns, and SOC students very much; it has been a great boon to Wine.

I also worry sometimes that Dan is overly humble.  His direct technical work
is brilliant and the untold secret is the amazing job Dan has done of stretching every tool
and resource at his command at Google so as to maximize the positive impact for Wine.

It's clear evidence that one person can truly make an enormous difference in the world.

Thanks, Dan!

Cheers,

Jeremy


From fgouget at free.fr  Fri Feb 15 09:14:46 2008
From: fgouget at free.fr (Francois Gouget)
Date: Fri, 15 Feb 2008 16:14:46 +0100 (CET)
Subject: shell32: Fix character count passed into lstrcpnA in
	SHGetDataFromIDListA.
In-Reply-To: <alpine.DEB.1.00.0802151610500.2362@amboise.dolphin>
References: <47B56415.90007@codeweavers.com>
	<alpine.DEB.1.00.0802151610500.2362@amboise.dolphin>
Message-ID: <alpine.DEB.1.00.0802151614220.2362@amboise.dolphin>

On Fri, 15 Feb 2008, Francois Gouget wrote:

> 
>          if (shortname)
> -            lstrcpynA(pfd->cAlternateFileName, shortname, MAX_PATH);
> +            lstrcpynA(pfd->cAlternateFileName, shortname, 14);
> 
> sizeof(*pfd->cAlternateFileName) would be better than the magic 14 here.

Whoops, no '*' of course.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                 There are 10 types of people in the world...
               those who understand binary and those who don't.


From rob at codeweavers.com  Fri Feb 15 09:46:17 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 15 Feb 2008 15:46:17 +0000
Subject: [PATCH]  Environment variable to specify X11 window for desktop
In-Reply-To: <47B594E7.90501@siriushk.com>
References: <47B594E7.90501@siriushk.com>
Message-ID: <47B5B3C9.7000308@codeweavers.com>

Timothy Lee wrote:
> The attached patch allows the WINE desktop to be embedded within an 
> existing X11 window, and is similar to the windowed mode in WINE.
>
> I've tested this feature using MS PowerPoint Viewer 2007, so that a 
> fullscreen slideshow can be fitted inside any X11 window.

I'm struggling to imagine a case where the behaviour you've implemented 
is useful.

-- 
Rob Shearman



From julliard at winehq.org  Fri Feb 15 09:52:07 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 15 Feb 2008 16:52:07 +0100
Subject: systray [4/4]: implement systray transparency
In-Reply-To: <200802151410.31168.lich@math.spbu.ru> (Kirill K. Smirnov's
	message of "Fri, 15 Feb 2008 14:10:31 +0000")
References: <200802071523.59519.lich@math.spbu.ru>
	<87zlu2ec6b.fsf.SS594SS@wine.dyndns.org>
	<200802151410.31168.lich@math.spbu.ru>
Message-ID: <87y79mcj4o.fsf@wine.dyndns.org>

"Kirill K. Smirnov" <lich at math.spbu.ru> writes:

>   2) Will it be better to stop embedding wine windows in favor of embedding 
> pure X windows (like other apps do)? This way assumes implementing all 
> xembed-specific stuff at winex11.drv side and exporting ONLY ONE function 
> like wine_xembed_systray_handler(int cmd, void *data), which converts windows 
> icon to X11 icon, creates X11 window with ParentRelative bkgrnd and embeds 
> it. Explorer will use this function when it adds/removes icon to/from system 
> tray. Also, this function will detect the case of wine virtual desktop and 
> notify explorer to stop using xembed.
>   I'm just not sure that this way will not break relaying mouse events.

I don't think there's any point in making it a non-Wine window, it would
just add complexity for no good reason. But moving more of the window
support to winex11 would probably be a good idea.

-- 
Alexandre Julliard
julliard at winehq.org


From lich at math.spbu.ru  Fri Feb 15 10:28:49 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Fri, 15 Feb 2008 16:28:49 +0000
Subject: systray [4/4]: implement systray transparency
In-Reply-To: <87zlu2ec6b.fsf.SS594SS@wine.dyndns.org>
References: <200802071523.59519.lich@math.spbu.ru>
	<87zlu2ec6b.fsf.SS594SS@wine.dyndns.org>
Message-ID: <200802151628.49486.lich@math.spbu.ru>


> We don't want to export such a specific function. Besides, it should
> really be setting the window shape.
I've just understood why we cannot rely upon setting window shape to get 
transparency. Let's consider almost empty icon or even empty - this may 
happen when application "flashes" icon, e.g. on incoming ICQ message.
1) Can be there active windows with empty visible area?
2) This windows do not correctly relay mouse events.

--
Kirill


From thestig at google.com  Fri Feb 15 10:47:37 2008
From: thestig at google.com (Lei Zhang)
Date: Fri, 15 Feb 2008 08:47:37 -0800
Subject: [PATCH] winex11.drv: get hwnd for injected mouse events
In-Reply-To: <874pcafrbv.fsf@wine.dyndns.org>
References: <558b2f5c0802111803l28216443q9a4d5bec59c272d1@mail.gmail.com>
	<874pcafrbv.fsf@wine.dyndns.org>
Message-ID: <558b2f5c0802150847n6d1ad279n82c1179d40e272a1@mail.gmail.com>

On Fri, Feb 15, 2008 at 2:26 AM, Alexandre Julliard <julliard at winehq.org> wrote:
> "Lei Zhang" <thestig at google.com> writes:
>
>  > --- a/dlls/winex11.drv/mouse.c
>  > +++ b/dlls/winex11.drv/mouse.c
>  > @@ -278,6 +278,7 @@ void X11DRV_send_mouse_input( HWND hwnd, DWORD flags, DWORD x, DWORD y,
>  >          {
>  >              pt.x = (x * screen_width) >> 16;
>  >              pt.y = (y * screen_height) >> 16;
>  > +            hwnd = GetAncestor(WindowFromPoint(pt), GA_PARENT);
>
>  This should not be needed, for injected events the window is determined
>  on the server side.
>
>  --
>  Alexandre Julliard
>  julliard at winehq.org
>

I've definitely seen cases where it doesn't work. I'll write a test...


From winehacker at gmail.com  Fri Feb 15 11:23:55 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 15 Feb 2008 12:23:55 -0500
Subject: [PATCH] Environment variable to specify X11 window for desktop
In-Reply-To: <47B5B3C9.7000308@codeweavers.com>
References: <47B594E7.90501@siriushk.com> <47B5B3C9.7000308@codeweavers.com>
Message-ID: <19e31a080802150923k48a5333du14cea0d6718c3e80@mail.gmail.com>

On Fri, Feb 15, 2008 at 10:46 AM, Robert Shearman <rob at codeweavers.com> wrote:
> Timothy Lee wrote:
>  > The attached patch allows the WINE desktop to be embedded within an
>  > existing X11 window, and is similar to the windowed mode in WINE.
>  >
>  > I've tested this feature using MS PowerPoint Viewer 2007, so that a
>  > fullscreen slideshow can be fitted inside any X11 window.
>
>  I'm struggling to imagine a case where the behaviour you've implemented
>  is useful.

Perhaps something like a plugin window like the crossover plugin in
the browsers? I can think of  a couple of other usage cases where this
could come in handy.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From tehblunderbuss at gmail.com  Fri Feb 15 11:32:37 2008
From: tehblunderbuss at gmail.com (TheBlunderbuss)
Date: Fri, 15 Feb 2008 11:32:37 -0600
Subject: gecko download not robust?
In-Reply-To: <47B3600C.1030000@mandrivaclub.nl>
References: <47AE349F.7040605@mandrivaclub.nl>	<b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>
	<47B3600C.1030000@mandrivaclub.nl>
Message-ID: <47B5CCB5.9030508@gmail.com>

marco wrote:
> I looked into it.
> And there are some options.
>
> I can make a separate  package  of gecko  that  I can make it a 
> dependencie of wine.
> Problem is people have to know where to find it or the get stuck.
>
> I can also make the package and make it not a dependencie on wine but 
> the the people don't know it exist.
>
> And I can just put it in the wine package.
>
> I think this is the best option in this case. Its the easiest option 
> because people only have to download en install one package.
>
> marco
>   
This sounds good to me, but lets not compartmentalize wine too much, 
like Debian.
Who wants to find out that you need so many wine* packages in order to 
get something to work?


From arthurmaciel at gmail.com  Fri Feb 15 10:32:32 2008
From: arthurmaciel at gmail.com (Arthur Maciel)
Date: Fri, 15 Feb 2008 13:32:32 -0300
Subject: Windows Mobile API
In-Reply-To: <200802151408.25719.stefan@codeweavers.com>
References: <b030cb940802141010y659076ebo724455ad0aafce84@mail.gmail.com>
	<200802151408.25719.stefan@codeweavers.com>
Message-ID: <b030cb940802150832v2ce2bf50wb12e39a316fb43be@mail.gmail.com>

Stefan, I appreciate your attention. Unfortunately I don?t have enough
hardware knowledge to make these patches by myself. I hope the interest for
linux raises, or maybe I fill the knowledge gap :-).

Thanks again.
Arthur

PS.: I believe that on WINE page I?ll find info about its implementation and
how I could (on a high level description) adapt it to PDA APIs, right?

2008/2/15, Stefan D?singer <stefan at codeweavers.com>:
>
> Am Donnerstag, 14. Februar 2008 19:10:30 schrieb Arthur Maciel:
>
> > Hi there.
> >
> > I?m not part of the mailing list, but I really want to know if there is
> any
> > port of WINE to support Windows Mobile API (that is Windows for pocket
> pc,
> > handhelds and pocket phones). This would come as a great solution for
> me,
> > as I need specific WM programs on my pda.
>
> This question is asked from time to time, and I think it is technically
> doable
> and a reasonable amount of code can be shared. However, the total interest
> has been too small for anything to happen. It might change if more Linux
> PDAs
> and cell phones appear in the future. So we're open to patches ;-)
>
> The obstacles may be loader specific parts, and PDA specific APIs, as well
> as
> the different CPU type.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080215/49005459/attachment-0001.htm 

From austinenglish at gmail.com  Fri Feb 15 11:55:26 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 15 Feb 2008 11:55:26 -0600
Subject: gecko download not robust?
In-Reply-To: <47B5CCB5.9030508@gmail.com>
References: <47AE349F.7040605@mandrivaclub.nl>
	<b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>
	<47B3600C.1030000@mandrivaclub.nl> <47B5CCB5.9030508@gmail.com>
Message-ID: <b6bb06270802150955r4797ca47pa6f83cddbf1287f6@mail.gmail.com>

On Fri, Feb 15, 2008 at 11:32 AM, TheBlunderbuss
<tehblunderbuss at gmail.com> wrote:
> marco wrote:
>  > I looked into it.
>  > And there are some options.
>  >
>  > I can make a separate  package  of gecko  that  I can make it a
>  > dependencie of wine.
>  > Problem is people have to know where to find it or the get stuck.
>  >
>  > I can also make the package and make it not a dependencie on wine but
>  > the the people don't know it exist.
>  >
>  > And I can just put it in the wine package.
>  >
>  > I think this is the best option in this case. Its the easiest option
>  > because people only have to download en install one package.
>  >
>  > marco
>  >
>  This sounds good to me, but lets not compartmentalize wine too much,
>  like Debian.
>  Who wants to find out that you need so many wine* packages in order to
>  get something to work?
>
>
>

Agreed, but I don't think wine, wine-dev, and wine-gecko is too much,
especially considering that wine-gecko rarely changes...

- Austin


From austinenglish at gmail.com  Fri Feb 15 12:12:49 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 15 Feb 2008 12:12:49 -0600
Subject: Google's support for Wine in 2007
In-Reply-To: <47B5AC48.5070805@winehq.org>
References: <a71bd89a0802132203u5e4782f0g3708dbbdc249edc9@mail.gmail.com>
	<20080214151136.GA20727@suse.de>
	<a71bd89a0802140712r458f8599pcafc30417f154bec@mail.gmail.com>
	<47B5AC48.5070805@winehq.org>
Message-ID: <b6bb06270802151012n2cba30b0md06572087d99b921@mail.gmail.com>

On Fri, Feb 15, 2008 at 9:14 AM, Jeremy White <jwhite at winehq.org> wrote:
> I just want to take a moment to personally and publicly thank Dan and Google.
>
>  We have appreciated Google's support, and the work of all Google employees,
>  interns, and SOC students very much; it has been a great boon to Wine.
>
>  I also worry sometimes that Dan is overly humble.  His direct technical work
>  is brilliant and the untold secret is the amazing job Dan has done of stretching every tool
>  and resource at his command at Google so as to maximize the positive impact for Wine.
>
>  It's clear evidence that one person can truly make an enormous difference in the world.
>
>  Thanks, Dan!
>
>  Cheers,
>
>  Jeremy

+1


From stefan at codeweavers.com  Fri Feb 15 12:27:20 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 15 Feb 2008 19:27:20 +0100
Subject: Windows Mobile API
In-Reply-To: <b030cb940802150832v2ce2bf50wb12e39a316fb43be@mail.gmail.com>
References: <b030cb940802141010y659076ebo724455ad0aafce84@mail.gmail.com>
	<200802151408.25719.stefan@codeweavers.com>
	<b030cb940802150832v2ce2bf50wb12e39a316fb43be@mail.gmail.com>
Message-ID: <200802151927.20628.stefan@codeweavers.com>

Am Freitag, 15. Februar 2008 17:32:32 schrieb Arthur Maciel:
> PS.: I believe that on WINE page I?ll find info about its implementation
> and how I could (on a high level description) adapt it to PDA APIs, right?
I don't think we have any documentation or attacking angle for Windows Mobile 
support yet, not even an in-depth investigation.

The Windows Mobile API is "documented" at www.msdn.com.


From stefandoesinger at gmx.at  Fri Feb 15 14:20:59 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 15 Feb 2008 21:20:59 +0100
Subject: d3dx9 patches
In-Reply-To: <E1JPj7S-0002pq-Ih@www12.emo.freenet-rz.de>
References: <E1JPj7S-0002pq-Ih@www12.emo.freenet-rz.de>
Message-ID: <200802152120.59408.stefandoesinger@gmx.at>

Am Donnerstag, 14. Februar 2008 19:47:38 schrieb tony.wasserka at freenet.de:
> Hi,
> It's nearly two weeks ago that I sent those patches, so I was curious if
> there are any problems with it?
Maybe they got lost due to Alexandre's vacations and travels?

Other than that I've followed the controversy about some patches, but I don't 
have any strong opinion regarding any possible solution.

> http://www.winehq.org/pipermail/wine-patches/2008-February/049554.html
> http://www.winehq.org/pipermail/wine-patches/2008-February/049667.html
> http://www.winehq.org/pipermail/wine-patches/2008-February/049677.html
> http://www.winehq.org/pipermail/wine-patches/2008-February/049679.html
> http://www.winehq.org/pipermail/wine-patches/2008-February/049705.html


From parasti at gmail.com  Fri Feb 15 15:07:11 2008
From: parasti at gmail.com (=?us-ascii?B?PT91dGYtOD9xP0o9QzQ9ODFuaXM9MjBSPUM1PUFCY2lzPz0=?=)
Date: Fri, 15 Feb 2008 23:07:11 +0200
Subject: [PATCH] msvcrt/tests: Add more scanf floating-point tests.
Message-ID: <20080215210711.GA3896@localhost.localdomain>

The included patch adds a couple of scanf floating-point tests to expose
a problem with the algorithm.  It seems that it doesn't handle negative
exponents very well, resulting in single-precision values being
off-by-one in the last bit of significant compared to those obtained
with the GNU C library or natively on Windows XP.

All five tests pass on my Windows XP SP2 system (using a self-compiled
msvcrt_crosstest.exe tool).  Test 3 and 4 fail with the current source
in Git.  I will send another patch to this list with a potential fix.

(I am not sending these to wine-patches because I'm not sure I should.
"wine-devel" sounds about right.)

---
 dlls/msvcrt/tests/scanf.c |   40 ++++++++++++++++++++++++++++++++++++----
 1 files changed, 36 insertions(+), 4 deletions(-)

diff --git a/dlls/msvcrt/tests/scanf.c b/dlls/msvcrt/tests/scanf.c
index 65bea46..d5da3f6 100644
--- a/dlls/msvcrt/tests/scanf.c
+++ b/dlls/msvcrt/tests/scanf.c
@@ -28,7 +28,7 @@ static void test_sscanf( void )
     char format[20];
     int result, ret;
     char c;
-    float res1= -82.6267f, res2= 27.76f, res11, res12;
+    float orig, res;
     static const char pname[]=" St. Petersburg, Florida\n";
     int hour=21,min=59,sec=20;
     int  number,number_so_far;
@@ -64,9 +64,41 @@ static void test_sscanf( void )
     ok( result == 12, "sscanf reads %x instead of %x\n", result, 12 );
 
     /* Check float */
-    ret = sprintf(buffer,"%f %f",res1, res2);
-    ret = sscanf(buffer,"%f%f",&res11, &res12);
-    ok( (res11 == res1) && (res12 == res2), "Error reading floats\n");
+
+    orig = -82.6267f;
+    ret = sprintf(buffer, "%f", orig);
+    ret = sscanf(buffer, "%f", &res);
+    ok(ret == 1, "Expected 1 float, got %d\n", ret);
+    ok(res == orig, "Wrote %e (0x%x), but read %e (0x%x)\n",
+       orig, *(unsigned int *) &orig, res, *(unsigned int *) &res);
+
+    orig = 27.76f;
+    ret = sprintf(buffer, "%f", orig);
+    ret = sscanf(buffer, "%f", &res);
+    ok(ret == 1, "Expected 1 float, got %d\n", ret);
+    ok(res == orig, "Wrote %e (0x%x), but read %e (0x%x)\n",
+       orig, *(unsigned int *) &orig, res, *(unsigned int *) &res);
+
+    orig = -6.61589e-2f;
+    ret = sprintf(buffer, "%e", orig);
+    ret = sscanf(buffer, "%e", &res);
+    ok(ret == 1, "Expected 1 float, got %d\n", ret);
+    ok(res == orig, "Wrote %e (0x%x), but read %e (0x%x)\n",
+       orig, *(unsigned int *) &orig, res, *(unsigned int *) &res);
+
+    orig = 1.72567e-7f;
+    ret = sprintf(buffer, "%e", orig);
+    ret = sscanf(buffer, "%e", &res);
+    ok(ret == 1, "Expected 1 float, got %d\n", ret);
+    ok(res == orig, "Wrote %e (0x%x), but read %e (0x%x)\n",
+       orig, *(unsigned int *) &orig, res, *(unsigned int *) &res);
+
+    orig = 15.483e+3f;
+    ret = sprintf(buffer, "%e", orig);
+    ret = sscanf(buffer, "%e", &res);
+    ok(ret == 1, "Expected 1 float, got %d\n", ret);
+    ok(res == orig, "Wrote %e (0x%x), but read %e (0x%x)\n",
+       orig, *(unsigned int *) &orig, res, *(unsigned int *) &res);
 
     /* check strings */
     ret = sprintf(buffer," %s", pname);
-- 
1.5.3.8



From parasti at gmail.com  Fri Feb 15 15:09:52 2008
From: parasti at gmail.com (=?us-ascii?B?PT91dGYtOD9xP0o9QzQ9ODFuaXM9MjBSPUM1PUFCY2lzPz0=?=)
Date: Fri, 15 Feb 2008 23:09:52 +0200
Subject: [PATCH] msvcrt: Fix scanf floating-point exponent handling.
Message-ID: <20080215210952.GA4125@localhost.localdomain>

This patch modifies the scanf floating-point algorithm to pass the tests
I sent in my previous message.

---
 dlls/msvcrt/scanf.h |   40 +++++++++++++++++++++++++---------------
 1 files changed, 25 insertions(+), 15 deletions(-)

diff --git a/dlls/msvcrt/scanf.h b/dlls/msvcrt/scanf.h
index 7fe3cc4..66df15e 100644
--- a/dlls/msvcrt/scanf.h
+++ b/dlls/msvcrt/scanf.h
@@ -241,6 +241,12 @@ _FUNCTION_ {
             case 'G': { /* read a float */
                     long double cur = 0;
 		    int negative = 0;
+
+		    int decimal_places = 0;
+		    unsigned int exponent = 0;
+		    int negexp = 0;
+		    long double be;
+
                     /* skip initial whitespace */
                     while ((nch!=_EOF_) && _ISSPACE_(nch))
                         nch = _GETC_(file);
@@ -268,20 +274,17 @@ _FUNCTION_ {
 		    }
 		    /* handle decimals */
                     if (width!=0 && nch == '.') {
-                        float dec = 1;
                         nch = _GETC_(file);
 			if (width>0) width--;
                         while (width!=0 && (nch!=_EOF_) && _ISDIGIT_(nch)) {
-                            dec /= 10;
-                            cur += dec * (nch - '0');
+                            cur = cur * 10 + (nch - '0');
+                            decimal_places += 1;
                             nch = _GETC_(file);
 			    if (width>0) width--;
                         }
                     }
 		    /* handle exponent */
 		    if (width!=0 && (nch == 'e' || nch == 'E')) {
-			int exponent = 0, negexp = 0;
-			float expcnt;
                         nch = _GETC_(file);
 			if (width>0) width--;
 			/* possible sign on the exponent */
@@ -292,20 +295,27 @@ _FUNCTION_ {
 			}
 			/* exponent digits */
 			while (width!=0 && (nch!=_EOF_) && _ISDIGIT_(nch)) {
-			    exponent *= 10;
-			    exponent += (nch - '0');
+			    exponent = exponent * 10 + (nch - '0');
                             nch = _GETC_(file);
 			    if (width>0) width--;
                         }
-			/* update 'cur' with this exponent. */
-			expcnt =  negexp ? .1 : 10;
-			while (exponent!=0) {
-			    if (exponent&1)
-				cur*=expcnt;
-			    exponent/=2;
-			    expcnt=expcnt*expcnt;
-			}
 		    }
+
+		    /* Combine exponent with decimal point. */
+		    for (; decimal_places > 0; decimal_places--)
+		    {
+			if (exponent == 0)
+			    negexp = 1;
+
+			exponent += negexp ? +1 : -1;
+		    }
+
+		    /* Perform exponentiation. */
+		    for (be = 1.0; exponent > 0; exponent--)
+			be *= 10.0;
+
+		    cur = negexp ? cur / be : cur * be;
+
                     st = 1;
                     if (!suppress) {
 			if (L_prefix) _SET_NUMBER_(long double);
-- 
1.5.3.8



From m.b.lankhorst at gmail.com  Fri Feb 15 15:21:34 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 15 Feb 2008 13:21:34 -0800
Subject: winedos: Allocate a console when loading dos applications
In-Reply-To: <01b801c86f91$1aabb1e0$a600fea9@DMITRY>
References: <b130c85e0802141355l5d2e1879k2d19356c5b156a40@mail.gmail.com>
	<00bf01c86f89$def6fb70$a600fea9@DMITRY>
	<b130c85e0802142050k7973f89fqd91a47f8d1240fdb@mail.gmail.com>
	<01a001c86f8f$50e301c0$a600fea9@DMITRY>
	<b130c85e0802142103k2d9e3193k617e4faaa3929663@mail.gmail.com>
	<01b801c86f91$1aabb1e0$a600fea9@DMITRY>
Message-ID: <b130c85e0802151321s6419779eq38599c2e37e72853@mail.gmail.com>

Hi all,

2008/2/14, Dmitry Timoshkov <dmitry at codeweavers.com>:
> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:
>
>
> > It worked before ba896e75d7fce68e5183007b65eae7e35490ccd4. (Around
>  > wine 0.9.33 or so) After that it was broken. I have a wine 0.9.9 that
>  > when run does create a seperate console for dos apps. My guess is that
>  > somewhere in the initialisation allocconsole would have to be called.
>
>
> You need to talk to Alexandre since that's his patch. Still, there is
>  no AllocConsole() call removed by that commit, so it has nothing to do
>  with the regression.
I've done a bunch of tests with a simple mingw app linked with
-mconsole and found the following results (in xp sp2 vmware):
- Asynchronous calls are not available for console handles (ReadFile
only works in synchronous mode, ReadFileEx doesn't work)
- I can do WaitForSingleObject(GetStdHandle(STD_INPUT_HANDLE),
INFINITE); and it will only return when there is data to be read, like
a key being pressed. in wine it will return immediately, this causes
the breakage of dos apps after wine 0.9.33.

These things make me think that the old behavior of wine is more
correct then the current one, with relation to console handles.

-Maarten.


From jan.wine at zerebecki.de  Fri Feb 15 15:33:41 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Fri, 15 Feb 2008 22:33:41 +0100
Subject: gecko download not robust?
In-Reply-To: <b6bb06270802150955r4797ca47pa6f83cddbf1287f6@mail.gmail.com>
References: <47AE349F.7040605@mandrivaclub.nl>
	<b6bb06270802091955l638369d4p4b4a892ae4299457@mail.gmail.com>
	<47B3600C.1030000@mandrivaclub.nl> <47B5CCB5.9030508@gmail.com>
	<b6bb06270802150955r4797ca47pa6f83cddbf1287f6@mail.gmail.com>
Message-ID: <20080215213341.GA17971@crissy.swd.zerebecki.de>

On Fri, Feb 15, 2008 at 11:55:26AM -0600, Austin English wrote:
> On Fri, Feb 15, 2008 at 11:32 AM, TheBlunderbuss <tehblunderbuss at gmail.com> wrote:
> > marco wrote:
> > > I can make a separate  package  of gecko

> > This sounds good to me, but lets not compartmentalize wine too much,
> > like Debian.
> > Who wants to find out that you need so many wine* packages in order to
> > get something to work?
> Agreed, but I don't think wine, wine-dev, and wine-gecko is too much,
> especially considering that wine-gecko rarely changes...

IMHO there should be a meta-package that is named wine which depends on
everything wine, but which itself doesn't contain any files. That is
also how it seems to have been done in the latest wine in debian, so it
is no problem anymore that their wine is split up in many packages. But
users who know what they do can still choose the subset they want.


Jan



From tony.wasserka at freenet.de  Sat Feb 16 03:07:17 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Sat, 16 Feb 2008 10:07:17 +0100
Subject: d3dx9 patches
Message-ID: <E1JQJ0v-0004k6-Po@www15.emo.freenet-rz.de>

Okay, thanks. Then I'll just resend them and see if they get in this time.




Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain inkl.
http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/index.html



From timothy.lee at siriushk.com  Fri Feb 15 12:07:05 2008
From: timothy.lee at siriushk.com (Timothy Lee)
Date: Sat, 16 Feb 2008 02:07:05 +0800
Subject: [PATCH]  Environment variable to specify X11 window for desktop
In-Reply-To: <47B5B3C9.7000308@codeweavers.com>
References: <47B594E7.90501@siriushk.com> <47B5B3C9.7000308@codeweavers.com>
Message-ID: <47B5D4C9.3000601@siriushk.com>

Robert Shearman wrote:
> Timothy Lee wrote:
>> The attached patch allows the WINE desktop to be embedded within an 
>> existing X11 window, and is similar to the windowed mode in WINE.
>>
>> I've tested this feature using MS PowerPoint Viewer 2007, so that a 
>> fullscreen slideshow can be fitted inside any X11 window.
>
> I'm struggling to imagine a case where the behaviour you've 
> implemented is useful.
>
I'm actually using this code as the basis of a PowerPoint plugin under 
Linux.

Regards,
Timothy


From julliard at winehq.org  Sat Feb 16 04:36:06 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 16 Feb 2008 11:36:06 +0100
Subject: winedos: Allocate a console when loading dos applications
In-Reply-To: <b130c85e0802151321s6419779eq38599c2e37e72853@mail.gmail.com>
	(Maarten Lankhorst's message of "Fri, 15 Feb 2008 13:21:34 -0800")
References: <b130c85e0802141355l5d2e1879k2d19356c5b156a40@mail.gmail.com>
	<00bf01c86f89$def6fb70$a600fea9@DMITRY>
	<b130c85e0802142050k7973f89fqd91a47f8d1240fdb@mail.gmail.com>
	<01a001c86f8f$50e301c0$a600fea9@DMITRY>
	<b130c85e0802142103k2d9e3193k617e4faaa3929663@mail.gmail.com>
	<01b801c86f91$1aabb1e0$a600fea9@DMITRY>
	<b130c85e0802151321s6419779eq38599c2e37e72853@mail.gmail.com>
Message-ID: <87d4qxchnt.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> These things make me think that the old behavior of wine is more
> correct then the current one, with relation to console handles.

The behavior hasn't changed for console handles, but the default case is
to run on the unix stdio handles, not true console ones. That's a
feature, we don't want to create a separate window for a simple command
line app.

There are two bugs here: one is that the unix stdio should be presented
to the app as a real console as far as possible, the other is that the
code should work correctly on non-console handles because even if we fix
the first one we can always redirect i/o. The second bug should be
easier to fix so I'd suggest to start with that.

-- 
Alexandre Julliard
julliard at winehq.org


From dmitry at codeweavers.com  Sat Feb 16 07:23:41 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 16 Feb 2008 21:23:41 +0800
Subject: [PATCH]  Environment variable to specify X11 window for desktop
References: <47B594E7.90501@siriushk.com> <47B5B3C9.7000308@codeweavers.com>
	<47B5D4C9.3000601@siriushk.com>
Message-ID: <004f01c8709f$275e1f90$a600fea9@DMITRY>

"Timothy Lee" <timothy.lee at siriushk.com> wrote:

>> I'm struggling to imagine a case where the behaviour you've 
>> implemented is useful.
>>
> I'm actually using this code as the basis of a PowerPoint plugin under 
> Linux.

I little bit more information won't hurt. For instance why your plugin
needs to re-route the whole desktop window, and not just its own one.

-- 
Dmitry.


From dank at kegel.com  Sat Feb 16 07:58:46 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 16 Feb 2008 05:58:46 -0800
Subject: Autoplay considered harmful
Message-ID: <a71bd89a0802160558l7e9b5af9k10e714454ead8c23@mail.gmail.com>

http://www.sfgate.com/cgi-bin/article.cgi?f=/c/a/2008/02/15/BU47V0VOH.DTL&type=business
says that USB devices are being sold with infected
autorun apps.  "If you plug in, you're already infected,"

I'd say that's a pretty good argument for not supporting autoplay...


From dank at kegel.com  Sat Feb 16 08:04:39 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 16 Feb 2008 06:04:39 -0800
Subject: X developer's conference, April 16-18
Message-ID: <a71bd89a0802160604l377da7fdy10d2414eaffc4b3c@mail.gmail.com>

http://www.x.org/wiki/Events/XDC2008

Seems like Wine might want a representative.
What issues would we want to bring up there?
- relative mouse motion events
...?

- Dan


From chris.kcat at gmail.com  Sat Feb 16 08:15:39 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Sat, 16 Feb 2008 06:15:39 -0800
Subject: wined3d: Fix bug in swapchain release which causes incorrect
	display mode changes.
In-Reply-To: <1203170508.9503.4.camel@dhcppc4>
References: <1203170508.9503.4.camel@dhcppc4>
Message-ID: <200802160615.39351.chris.kcat@gmail.com>

On Saturday 16 February 2008 06:01:48 am Peter Dons Tychsen wrote:
> Fixed bug in wined3d swapchain, which caused the release of the
> swap-chain to mess around with the display-modes set by ddraw. Also
> added test-case for this scenario. Reworked test code minimally, to
> re-use existing test code.

You may want to test D3D8 and D3D9 too, to see what they do when presented by 
the situation (since the code is shared). Also I don't think you should make 
those 2-space indents just to avoid changing those few lines.


From jjmckenzie51 at sprintpcs.com  Sat Feb 16 08:17:58 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 16 Feb 2008 07:17:58 -0700
Subject: Autoplay considered harmful
In-Reply-To: <a71bd89a0802160558l7e9b5af9k10e714454ead8c23@mail.gmail.com>
References: <a71bd89a0802160558l7e9b5af9k10e714454ead8c23@mail.gmail.com>
Message-ID: <47B6F096.1040902@sprintpcs.com>

Dan Kegel wrote:
> http://www.sfgate.com/cgi-bin/article.cgi?f=/c/a/2008/02/15/BU47V0VOH.DTL&type=business
> says that USB devices are being sold with infected
> autorun apps.  "If you plug in, you're already infected,"
>
> I'd say that's a pretty good argument for not supporting autoplay...
>
>
>   
+1

Let's not forget the infected CDs as well.

James McKenzie



From julliard at winehq.org  Sat Feb 16 09:01:19 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 16 Feb 2008 16:01:19 +0100
Subject: [1/16] msxml3: Support functions for typelib
In-Reply-To: <fp15a2$u7m$1@ger.gmane.org> (Alistair Leslie-Hughes's message of
	"Thu, 14 Feb 2008 21:31:34 +1100")
References: <fp15a2$u7m$1@ger.gmane.org>
Message-ID: <878x1lc5ds.fsf@wine.dyndns.org>

Alistair Leslie-Hughes <leslie_alistair at hotmail.com> writes:

> +HRESULT get_typeinfo(enum tid_t tid, ITypeInfo **typeinfo)
> +{
> +    HRESULT hres;
> +
> +    if(!typelib) {
> +        ITypeLib *tl;
> +
> +        hres = LoadRegTypeLib(&LIBID_MSXML2, 3, 0, LOCALE_SYSTEM_DEFAULT, &tl);
> +        if(FAILED(hres)) {
> +            ERR("LoadRegTypeLib failed: %08x\n", hres);
> +            return hres;
> +        }
> +
> +        if(InterlockedCompareExchangePointer((void**)&typelib, tl, NULL))
> +            ITypeLib_Release(tl);
> +    }
> +
> +    if(!typeinfos[tid]) {
> +        ITypeInfo *typeinfo;
> +
> +        hres = ITypeLib_GetTypeInfoOfGuid(typelib, tid_ids[tid], &typeinfo);
> +        if(FAILED(hres)) {
> +            ERR("GetTypeInfoOfGuid failed: %08x\n", hres);
> +            return hres;
> +        }
> +
> +        if(InterlockedCompareExchangePointer((void**)(typeinfos+tid), typeinfo, NULL))
> +            ITypeInfo_Release(typeinfo);
> +    }
> +
> +    *typeinfo = typeinfos[tid];
> +    return S_OK;

You should increment the ref count when you are returning a pointer,
even if it's also stored in a global variable.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Sat Feb 16 09:03:53 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 16 Feb 2008 16:03:53 +0100
Subject: dlls/shell32/pidl.c -- adjust to unsignedness of a type
In-Reply-To: <alpine.LSU.1.00.0802140219440.19228@pulcherrima.dbai.tuwien.ac.at>
	(Gerald Pfeifer's message of "Thu, 14 Feb 2008 02:22:15 +0100 (CET)")
References: <alpine.LSU.1.00.0802140219440.19228@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <874pc9c59i.fsf@wine.dyndns.org>

Gerald Pfeifer <gerald at pfeifer.com> writes:

> @@ -109,7 +109,7 @@ BOOL WINAPI ILGetDisplayNameExW(LPSHELLF
>              return FALSE;
>      }
>  
> -    if (type >= 0 && type <= 2)
> +    if (type <= 2)
>      {
>          switch (type)
>          {

The test should probably be removed completely since there's already a
default for it in the switch() that follows.

-- 
Alexandre Julliard
julliard at winehq.org


From xixsimplicityxix at gmail.com  Sat Feb 16 09:08:27 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Sat, 16 Feb 2008 09:08:27 -0600
Subject: Autoplay considered harmful
In-Reply-To: <47B6F096.1040902@sprintpcs.com>
References: <a71bd89a0802160558l7e9b5af9k10e714454ead8c23@mail.gmail.com>
	<47B6F096.1040902@sprintpcs.com>
Message-ID: <78a7dad00802160708y7a414d7fw959d7cdd527cb699@mail.gmail.com>

> Dan Kegel wrote:
> > http://www.sfgate.com/cgi-bin/article.cgi?f=/c/a/2008/02/15/BU47V0VOH.DTL&type=business
> > says that USB devices are being sold with infected
> > autorun apps.  "If you plug in, you're already infected,"
> >
> > I'd say that's a pretty good argument for not supporting autoplay...
> >

Completely not supported or disabled by default?

--John Klehm


From dank at kegel.com  Sat Feb 16 09:38:01 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 16 Feb 2008 07:38:01 -0800
Subject: Autoplay considered harmful
In-Reply-To: <78a7dad00802160708y7a414d7fw959d7cdd527cb699@mail.gmail.com>
References: <a71bd89a0802160558l7e9b5af9k10e714454ead8c23@mail.gmail.com>
	<47B6F096.1040902@sprintpcs.com>
	<78a7dad00802160708y7a414d7fw959d7cdd527cb699@mail.gmail.com>
Message-ID: <a71bd89a0802160738q44855f8et23e31b2db4f48494@mail.gmail.com>

On Feb 16, 2008 7:08 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> > Dan Kegel wrote:
> > > http://www.sfgate.com/cgi-bin/article.cgi?f=/c/a/2008/02/15/BU47V0VOH.DTL&type=business
> > > says that USB devices are being sold with infected
> > > autorun apps.  "If you plug in, you're already infected,"
> > >
> > > I'd say that's a pretty good argument for not supporting autoplay...
>
> Completely not supported or disabled by default?

By default, I guess.   Some customers might know their cd-rom's
are safe, and we should let them enable it via a control panel, I guess.
But autoplay support is kind of a distro packaging thing, I think,
so we probably have to discuss this with whoever builds the packages...?


From winehacker at gmail.com  Sat Feb 16 10:09:19 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sat, 16 Feb 2008 11:09:19 -0500
Subject: Autoplay considered harmful
In-Reply-To: <a71bd89a0802160558l7e9b5af9k10e714454ead8c23@mail.gmail.com>
References: <a71bd89a0802160558l7e9b5af9k10e714454ead8c23@mail.gmail.com>
Message-ID: <19e31a080802160809k1193d71fp8a57334e763af778@mail.gmail.com>

On Feb 16, 2008 8:58 AM, Dan Kegel <dank at kegel.com> wrote:
> http://www.sfgate.com/cgi-bin/article.cgi?f=/c/a/2008/02/15/BU47V0VOH.DTL&type=business
> says that USB devices are being sold with infected
> autorun apps.  "If you plug in, you're already infected,"
>
> I'd say that's a pretty good argument for not supporting autoplay...

I was actually thinking about this today. The right method would be to
use HAL notification events to prompt the user if they want to autorun
when sticking a new cdrom in. There could even be warning text in the
dialog so that if it pops up with other device insertion, the user
would know that it could be a virus.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From thunderbird2k at gmx.net  Sat Feb 16 10:25:40 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sat, 16 Feb 2008 17:25:40 +0100
Subject: X developer's conference, April 16-18
In-Reply-To: <a71bd89a0802160604l377da7fdy10d2414eaffc4b3c@mail.gmail.com>
References: <a71bd89a0802160604l377da7fdy10d2414eaffc4b3c@mail.gmail.com>
Message-ID: <20080216162540.60570@gmx.net>

> http://www.x.org/wiki/Events/XDC2008
> 
> Seems like Wine might want a representative.
> What issues would we want to bring up there?
> - relative mouse motion events
> ...?
> 
> - Dan
> 

Perhaps X developers should be aware about the way we implement windowed opengl rendering (bug 2398) using Composite. Basically we use an 'offscreen' window as a buffer and so now and then we copy this data over. Not all drivers support this properly yet (yes, they are working on features like this) but I don't think most are aware of the way Wine uses them (there is more than compiz).

Roderick
-- 
Ist Ihr Browser Vista-kompatibel? Jetzt die neuesten 
Browser-Versionen downloaden: http://www.gmx.net/de/go/browser


From wine at eternaldusk.com  Sat Feb 16 10:44:15 2008
From: wine at eternaldusk.com (Evil Jay)
Date: Sat, 16 Feb 2008 10:44:15 -0600
Subject: Autoplay considered harmful
In-Reply-To: <19e31a080802160809k1193d71fp8a57334e763af778@mail.gmail.com>
References: <a71bd89a0802160558l7e9b5af9k10e714454ead8c23@mail.gmail.com>
	<19e31a080802160809k1193d71fp8a57334e763af778@mail.gmail.com>
Message-ID: <47B712DF.1050806@eternaldusk.com>

The purist in me says that WINE should not improve on Windows - it
should behave the same way, warts and all.  If I had a vote, I'd vote to
enable it by default, but give the user an easy way to disable it in
winecfg.  (And I'd immediately disable it the first time I ran Winecfg!)

But, whatever you guys decide to do is cool - as long as you keep
cranking out this great package!  :)

-Jesse



Steven Edwards wrote:
> On Feb 16, 2008 8:58 AM, Dan Kegel <dank at kegel.com> wrote:
>   
>> http://www.sfgate.com/cgi-bin/article.cgi?f=/c/a/2008/02/15/BU47V0VOH.DTL&type=business
>> says that USB devices are being sold with infected
>> autorun apps.  "If you plug in, you're already infected,"
>>
>> I'd say that's a pretty good argument for not supporting autoplay...
>>     
>
> I was actually thinking about this today. The right method would be to
> use HAL notification events to prompt the user if they want to autorun
> when sticking a new cdrom in. There could even be warning text in the
> dialog so that if it pops up with other device insertion, the user
> would know that it could be a virus.
>
>   



From fgouget at free.fr  Sat Feb 16 11:07:11 2008
From: fgouget at free.fr (Francois Gouget)
Date: Sat, 16 Feb 2008 18:07:11 +0100 (CET)
Subject: MSG_PEEK race in urlmon_test?
Message-ID: <alpine.DEB.1.00.0802161804290.31897@amboise.dolphin>


When I run the urlmon_test test the kernel (2.6.22.9) has this to say:

Feb 16 05:53:54 amboise kernel: TCP(urlmon_test.exe:9836): Application 
bug, race in MSG_PEEK.

Does anyone know what's up with that?
Maybe someone who knows more than me about urlmon?

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                  Hiroshima '45 - Czernobyl '86 - Windows '95


From topace at oijk.net  Sat Feb 16 09:29:25 2008
From: topace at oijk.net (=?ISO-8859-1?Q?Robert_L=F6vlie?=)
Date: Sat, 16 Feb 2008 16:29:25 +0100
Subject: Autoplay considered harmful
In-Reply-To: <78a7dad00802160708y7a414d7fw959d7cdd527cb699@mail.gmail.com>
References: <a71bd89a0802160558l7e9b5af9k10e714454ead8c23@mail.gmail.com>	<47B6F096.1040902@sprintpcs.com>
	<78a7dad00802160708y7a414d7fw959d7cdd527cb699@mail.gmail.com>
Message-ID: <47B70155.3070209@oijk.net>

John Klehm wrote:
>> Dan Kegel wrote:
>>     
>>> http://www.sfgate.com/cgi-bin/article.cgi?f=/c/a/2008/02/15/BU47V0VOH.DTL&type=business
>>> says that USB devices are being sold with infected
>>> autorun apps.  "If you plug in, you're already infected,"
>>>
>>> I'd say that's a pretty good argument for not supporting autoplay...
>>>
>>>       
>
> Completely not supported or disabled by default?
>
> --John Klehm
>   
The autorun.inf files are simple enough to support with a simple script,
and they usually launch a windows program. This can be implementet in an
end system with minimum effort and no changes to the wine codebase.
I'm firmly opposed to wine polling disk drives for new mediums and
autoplaying them by default.

--
Robert L?vlie
topace at oijk.net



From wine-devel at kievinfo.com  Sat Feb 16 11:47:46 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 16 Feb 2008 10:47:46 -0700
Subject: X developer's conference, April 16-18
In-Reply-To: <a71bd89a0802160604l377da7fdy10d2414eaffc4b3c@mail.gmail.com>
References: <a71bd89a0802160604l377da7fdy10d2414eaffc4b3c@mail.gmail.com>
Message-ID: <47B721C2.1010405@kievinfo.com>

Dan Kegel wrote:
> http://www.x.org/wiki/Events/XDC2008
> 
> Seems like Wine might want a representative.
> What issues would we want to bring up there?
> - relative mouse motion events
> ...?
> 
> - Dan
> 
> 
I'd phrase this as ability to open main pointer device and keyboard as 
XInput device. That will be enough.

Vitaliy


From dank at kegel.com  Sat Feb 16 11:53:15 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 16 Feb 2008 09:53:15 -0800
Subject: X developer's conference, April 16-18
In-Reply-To: <47B721C2.1010405@kievinfo.com>
References: <a71bd89a0802160604l377da7fdy10d2414eaffc4b3c@mail.gmail.com>
	<47B721C2.1010405@kievinfo.com>
Message-ID: <a71bd89a0802160953x418f9620l3a1669d8708fd27d@mail.gmail.com>

On Feb 16, 2008 9:47 AM, Vitaliy Margolen <wine-devel at kievinfo.com> wrote:
> > - relative mouse motion events
>
> I'd phrase this as ability to open main pointer device and keyboard as
> XInput device. That will be enough.

Ah.  Yes.  That makes a lot more sense.  Thanks!


From remco47 at yahoo.com  Sat Feb 16 12:54:47 2008
From: remco47 at yahoo.com (Remco)
Date: Sat, 16 Feb 2008 10:54:47 -0800 (PST)
Subject: Autoplay considered harmful
Message-ID: <765468.77405.qm@web50101.mail.re2.yahoo.com>

Vista (and I think XP too) ask whether you want to start the Autorun program, or do a few other actions (open explorer, copy disk, etc).

Remco

----- Original Message ----
> From: Evil Jay <wine at eternaldusk.com>
> To: Steven Edwards <winehacker at gmail.com>
> Cc: wine-devel <wine-devel at winehq.org>; Dan Kegel <dank at kegel.com>
> Sent: Saturday, February 16, 2008 5:44:15 PM
> Subject: Re: Autoplay considered harmful
> 
> The purist in me says that WINE should not improve on Windows - it
> should behave the same way, warts and all.  If I had a vote, I'd vote to
> enable it by default, but give the user an easy way to disable it in
> winecfg.  (And I'd immediately disable it the first time I ran Winecfg!)
> 
> But, whatever you guys decide to do is cool - as long as you keep
> cranking out this great package!  :)
> 
> -Jesse
> 
> 
> 
> Steven Edwards wrote:
> > On Feb 16, 2008 8:58 AM, Dan Kegel  wrote:
> >   
> >> 
> http://www.sfgate.com/cgi-bin/article.cgi?f=/c/a/2008/02/15/BU47V0VOH.DTL&type=business
> >> says that USB devices are being sold with infected
> >> autorun apps.  "If you plug in, you're already infected,"
> >>
> >> I'd say that's a pretty good argument for not supporting autoplay...
> >>     
> >
> > I was actually thinking about this today. The right method would be to
> > use HAL notification events to prompt the user if they want to autorun
> > when sticking a new cdrom in. There could even be warning text in the
> > dialog so that if it pops up with other device insertion, the user
> > would know that it could be a virus.
> >
> >   
> 
> 
> 
> 




      ____________________________________________________________________________________
Never miss a thing.  Make Yahoo your home page. 
http://www.yahoo.com/r/hs


From wine at eternaldusk.com  Sat Feb 16 13:07:14 2008
From: wine at eternaldusk.com (Evil Jay)
Date: Sat, 16 Feb 2008 13:07:14 -0600
Subject: Autoplay considered harmful
In-Reply-To: <765468.77405.qm@web50101.mail.re2.yahoo.com>
References: <765468.77405.qm@web50101.mail.re2.yahoo.com>
Message-ID: <47B73462.2000505@eternaldusk.com>

XP does not do this.  I've never used Vista, nor can I imagine why
anyone would want to.

If Vista does do this, then prompting would be proper, but only when
Wine is configured to present itself as Vista.

-J



Remco wrote:
> Vista (and I think XP too) ask whether you want to start the Autorun program, or do a few other actions (open explorer, copy disk, etc).
>
> Remco
>
> ----- Original Message ----
>   
>> From: Evil Jay <wine at eternaldusk.com>
>> To: Steven Edwards <winehacker at gmail.com>
>> Cc: wine-devel <wine-devel at winehq.org>; Dan Kegel <dank at kegel.com>
>> Sent: Saturday, February 16, 2008 5:44:15 PM
>> Subject: Re: Autoplay considered harmful
>>
>> The purist in me says that WINE should not improve on Windows - it
>> should behave the same way, warts and all.  If I had a vote, I'd vote to
>> enable it by default, but give the user an easy way to disable it in
>> winecfg.  (And I'd immediately disable it the first time I ran Winecfg!)
>>
>> But, whatever you guys decide to do is cool - as long as you keep
>> cranking out this great package!  :)
>>
>> -Jesse
>>
>>
>>
>> Steven Edwards wrote:
>>     
>>> On Feb 16, 2008 8:58 AM, Dan Kegel  wrote:
>>>   
>>>       
>> http://www.sfgate.com/cgi-bin/article.cgi?f=/c/a/2008/02/15/BU47V0VOH.DTL&type=business
>>     
>>>> says that USB devices are being sold with infected
>>>> autorun apps.  "If you plug in, you're already infected,"
>>>>
>>>> I'd say that's a pretty good argument for not supporting autoplay...
>>>>     
>>>>         
>>> I was actually thinking about this today. The right method would be to
>>> use HAL notification events to prompt the user if they want to autorun
>>> when sticking a new cdrom in. There could even be warning text in the
>>> dialog so that if it pops up with other device insertion, the user
>>> would know that it could be a virus.
>>>
>>>   
>>>       
>>
>>
>>     
>
>
>
>
>       ____________________________________________________________________________________
> Never miss a thing.  Make Yahoo your home page. 
> http://www.yahoo.com/r/hs
>
>
>
>
>   



From chris.kcat at gmail.com  Sat Feb 16 13:29:59 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Sat, 16 Feb 2008 11:29:59 -0800
Subject: Autoplay considered harmful
In-Reply-To: <765468.77405.qm@web50101.mail.re2.yahoo.com>
References: <765468.77405.qm@web50101.mail.re2.yahoo.com>
Message-ID: <200802161129.59540.chris.kcat@gmail.com>

On Saturday 16 February 2008 10:54:47 am Remco wrote:
> Vista (and I think XP too) ask whether you want to start the Autorun
> program, or do a few other actions (open explorer, copy disk, etc).

Some desktop managers already do autoplay-like behavior. In KDE, when I put in 
a CD/DVD for the first time, it'll ask me if I want to play it (if it's a 
video dvd/audio cd), if I want to open a burning program (if it's a blank 
cd/dvd), or if I want to browse it. And whether I want it to continue asking. 
It'd be quite annoying for both Wine *and* the DM to keep trying to autorun a 
disc I put in.


From stefandoesinger at gmx.at  Sat Feb 16 14:38:00 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 16 Feb 2008 21:38:00 +0100
Subject: WineD3D: add separate alpha blend support 3/3
In-Reply-To: <20080216162931.60580@gmx.net>
References: <20080216162931.60580@gmx.net>
Message-ID: <200802162138.03131.stefandoesinger@gmx.at>

Am Samstag, 16. Februar 2008 17:29:31 schrieb Roderick Colenbrander:
> Hi,
>
> This patch adds support for separate alpha blend one of the last
> unimplemented D3D9 features.
Here are a few suggestions:

*) Setting WINED3DPMISCCAPS_SEPARATEALPHABLEND in directx.c should only be 
done if the extension is supported

*) after the "GL_LINE_SMOOTH needs GL_BLEND to work, according to the", 
WINED3DRS_SEPARATEALPHABLENDENABLE should probably be removed from the if 
block. I don't think that blending should be enabled if the 
WINED3DRS_ALPHABLENDENABLE is off. A test would be helpful for certainty.

*) The code translating the separate blending settings could be moved into the 
if(stateblock->renderState[WINED3DRS_SEPARATEALPHABLENDENABLE]) block. That 
way they are only executed if they're needed(The compiler may take care of 
that though)

*) The separate blend states should be grouped with the alpha states, ie, set 
the representative to STATE_RENDER(WINED3DRS_ALPHABLENDENABLE) instead of 
STATE_RENDER(WINED3DRS_SEPARATEALPHABLENDENABLE). Not doing that should not 
cause any rendering problems because the whole alpha blend states are set 
every time, but grouping them will improve performance. (e.g., if 
alphablendenable and separatealphaenable are changed state_blend is only 
executed once, not twice)

*) The blendop is currently not reapplied if 
WINED3DRS_SEPARATEALPHABLENDENABLE is changed. One solution is to group the 
blendops with alphablend and move the code from state_blendop to state_blend. 
A better way is to make this a one-way dependency from state_alpha to 
state_blend. Compare STATE_RENDER(WINED3DRS_LIGHTING) and STATE_VDECL for a 
reference.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080216/12cdea6e/attachment.pgp 

From stefan at codeweavers.com  Sat Feb 16 16:51:23 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 16 Feb 2008 23:51:23 +0100
Subject: ddraw: Assign to structs instead of using memcpy
In-Reply-To: <200802162233.37827.andrew.talbot@talbotville.com>
References: <200802162233.37827.andrew.talbot@talbotville.com>
Message-ID: <200802162351.23513.stefan@codeweavers.com>

Am Samstag, 16. Februar 2008 23:33:37 schrieb Andrew Talbot:
> Here, I am assuming that the "dwSize" elements in all these cases should be
> set to the size of the struct each is in, respectively. Please advise if
> this assumption is wrong.
It's not necessarily true. Sometimes there are multiple versions of the same 
structure. You can check ddraw.h and d3dtypes.h. If there is only one version 
your assumption should be true.

If there isn't, then your assumption may still be true. In that case there are 
some tests how the Setter methods deal with newer or older structures(in some 
cases we may need more tests)

> Thanks,
>
> -- Andy.
> ---
> Changelog:
>     ddraw: Assign to structs instead of using memcpy.
>
> diff --git a/dlls/ddraw/device.c b/dlls/ddraw/device.c
> index b60b6f3..03ccea8 100644
> --- a/dlls/ddraw/device.c
> +++ b/dlls/ddraw/device.c
> @@ -704,7 +704,7 @@
> IDirect3DDeviceImpl_1_CreateExecuteBuffer(IDirect3DDevice *iface,
> object->d3ddev = This;
>
>      /* Initializes memory */
> -    memcpy(&object->desc, Desc, Desc->dwSize);
> +    object->desc = *Desc;
>
>      /* No buffer given */
>      if ((object->desc.dwFlags & D3DDEB_LPDATA) == 0)
> diff --git a/dlls/ddraw/material.c b/dlls/ddraw/material.c
> index d6b9a7c..8e17174 100644
> --- a/dlls/ddraw/material.c
> +++ b/dlls/ddraw/material.c
> @@ -250,7 +250,7 @@ IDirect3DMaterialImpl_SetMaterial(IDirect3DMaterial3
> *iface, /* Stores the material */
>      EnterCriticalSection(&ddraw_cs);
>      memset(&This->mat, 0, sizeof(This->mat));
> -    memcpy(&This->mat, lpMat, lpMat->dwSize);
> +    This->mat = *lpMat;
>      LeaveCriticalSection(&ddraw_cs);
>
>      return DD_OK;
> @@ -285,7 +285,7 @@ IDirect3DMaterialImpl_GetMaterial(IDirect3DMaterial3
> *iface, EnterCriticalSection(&ddraw_cs);
>      dwSize = lpMat->dwSize;
>      memset(lpMat, 0, dwSize);
> -    memcpy(lpMat, &This->mat, dwSize);
> +    *lpMat = This->mat;
>      LeaveCriticalSection(&ddraw_cs);
>
>      return DD_OK;
> diff --git a/dlls/ddraw/viewport.c b/dlls/ddraw/viewport.c
> index deb4146..8dfc015 100644
> --- a/dlls/ddraw/viewport.c
> +++ b/dlls/ddraw/viewport.c
> @@ -261,7 +261,7 @@ IDirect3DViewportImpl_GetViewport(IDirect3DViewport3
> *iface, }
>      dwSize = lpData->dwSize;
>      memset(lpData, 0, dwSize);
> -    memcpy(lpData, &(This->viewports.vp1), dwSize);
> +    *lpData = This->viewports.vp1;
>
>      if (TRACE_ON(d3d7)) {
>          TRACE("  returning D3DVIEWPORT :\n");
> @@ -301,7 +301,7 @@ IDirect3DViewportImpl_SetViewport(IDirect3DViewport3
> *iface, EnterCriticalSection(&ddraw_cs);
>      This->use_vp2 = 0;
>      memset(&(This->viewports.vp1), 0, sizeof(This->viewports.vp1));
> -    memcpy(&(This->viewports.vp1), lpData, lpData->dwSize);
> +    This->viewports.vp1 = *lpData;
>
>      /* Tests on two games show that these values are never used properly
> so override them with proper ones :-)
> @@ -856,7 +856,7 @@ IDirect3DViewportImpl_GetViewport2(IDirect3DViewport3
> *iface, }
>      dwSize = lpData->dwSize;
>      memset(lpData, 0, dwSize);
> -    memcpy(lpData, &(This->viewports.vp2), dwSize);
> +    *lpData = This->viewports.vp2;
>
>      if (TRACE_ON(d3d7)) {
>          TRACE("  returning D3DVIEWPORT2 :\n");
> @@ -895,7 +895,7 @@ IDirect3DViewportImpl_SetViewport2(IDirect3DViewport3
> *iface, EnterCriticalSection(&ddraw_cs);
>      This->use_vp2 = 1;
>      memset(&(This->viewports.vp2), 0, sizeof(This->viewports.vp2));
> -    memcpy(&(This->viewports.vp2), lpData, lpData->dwSize);
> +    This->viewports.vp2 = *lpData;
>
>      if (This->active_device) {
>       
> IDirect3DDevice3_GetCurrentViewport(ICOM_INTERFACE(This->active_device,
> IDirect3DDevice3), &current_viewport);




From Andrew.Talbot at talbotville.com  Sat Feb 16 18:38:50 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sun, 17 Feb 2008 00:38:50 +0000
Subject: ddraw: Assign to structs instead of using memcpy
References: <200802162233.37827.andrew.talbot@talbotville.com>
	<200802162351.23513.stefan@codeweavers.com>
Message-ID: <fp7vmr$cj3$1@ger.gmane.org>

Stefan D?singer wrote:

> Am Samstag, 16. Februar 2008 23:33:37 schrieb Andrew Talbot:
>> Here, I am assuming that the "dwSize" elements in all these cases should
>> be set to the size of the struct each is in, respectively. Please advise
>> if this assumption is wrong.
> It's not necessarily true. Sometimes there are multiple versions of the
> same structure. You can check ddraw.h and d3dtypes.h. If there is only one
> version your assumption should be true.
> 
> If there isn't, then your assumption may still be true. In that case there
> are some tests how the Setter methods deal with newer or older
> structures(in some cases we may need more tests)
> 

Hi Stefan,

I checked that I wasn't assigning between entities whose types had different
suffixes, such as assigning to a D3DVIEWPORT variable from one of type
D3DVIEWPORT2, for example. (In fact, the only one I had to avoid was the
assignment to a DDSURFACEDESC type variable from a DDSURFACEDESC2 one, in
ddraw/ddraw_thunks.c.) And I presume that if the underlying struct tags are
different between two similar types, then the compiler would warn of type
incompatibility if such an assignment were attempted.

Thanks,

-- 
Andy.




From winehacker at gmail.com  Sat Feb 16 19:07:32 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sat, 16 Feb 2008 20:07:32 -0500
Subject: Autoplay considered harmful
In-Reply-To: <200802161129.59540.chris.kcat@gmail.com>
References: <765468.77405.qm@web50101.mail.re2.yahoo.com>
	<200802161129.59540.chris.kcat@gmail.com>
Message-ID: <19e31a080802161707w3fe14029hb922126e4d83e194@mail.gmail.com>

On Feb 16, 2008 2:29 PM, Chris Robinson <chris.kcat at gmail.com> wrote:
> Some desktop managers already do autoplay-like behavior. In KDE, when I put in
> a CD/DVD for the first time, it'll ask me if I want to play it (if it's a
> video dvd/audio cd), if I want to open a burning program (if it's a blank
> cd/dvd), or if I want to browse it. And whether I want it to continue asking.
> It'd be quite annoying for both Wine *and* the DM to keep trying to autorun a
> disc I put in.

Ideally the freedesktop should define a spec (which they may already
do as part of HAL) that we should be able to interface with. There
should be a way to have the auto insert event detect a autorun.inf and
prompt the user if they want to open it with Wine. If no one else
wants to research it I'll try to take a look in to it sometime.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Sat Feb 16 19:25:52 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 16 Feb 2008 17:25:52 -0800
Subject: New winetricks 20080216: fixed comctl32 override, hide winetrickscache,
	add --version option
Message-ID: <a71bd89a0802161725k21541301y8ee323b28a3f0af3@mail.gmail.com>

Austin nudged me into fixing comctl32 override, which has
been broken since wine added support for sxs assemblies.
He also was the third person to suggest hiding winetrickscache,
so I guess it's what people want.
And I added a --version option for a guy who said it would
make packaging easier.

As always, it's available at
 http://kegel.com/wine/winetricks
and the svn repository is
 http://code.google.com/p/winezeug/

-- 
Wine for Windows ISVs: http://kegel.com/wine/isv


From madewokherd+d41d at gmail.com  Sat Feb 16 19:50:24 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Sat, 16 Feb 2008 20:50:24 -0500
Subject: tools: add a wrapper script for starting files from file managers
	and make wine.desktop use it
In-Reply-To: <ced95fe0802131644i3a6a779x769a96d8f5d248d4@mail.gmail.com>
References: <ced95fe0802131644i3a6a779x769a96d8f5d248d4@mail.gmail.com>
Message-ID: <ced95fe0802161750y59bd266cp30db71c8997931b1@mail.gmail.com>

Please do not commit this patch as explained in comment 18 of bug
5224: http://bugs.winehq.org/show_bug.cgi?id=5224#c18

Windows explorer's default behavior is to always start programs with
double quotes around their filenames, even if the filename does not
contain a space. Apparently, this is impossible (or more difficult
than it's worth) to do in a shell script so I will need to rewrite
this as a winelib program.

On Feb 13, 2008 7:44 PM, Vincent Povirk <madewokherd+d41d at gmail.com> wrote:
> This is an attempt to solve the problems with double-clicking .exe
> files from file managers.
>
> The patch adds a script named winestartfile that mimics what happens
> on windows when a file is double-clicked in explorer. It starts the
> file using start.exe with the full path to the file and in the
> directory that contains it.
>
> It also modifies the wine.desktop shortcut to use that script when
> opening .exe files.
>
> My previous attempt at this incorrectly ran start without giving a
> full path (so that if a file named start.exe exists in the current
> path, it will take precedence) and probably tried to change too many
> things at once.
>
> --
> Vincent Povirk
>



-- 
Vincent Povirk


From dank at kegel.com  Sun Feb 17 03:15:24 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 01:15:24 -0800
Subject: Next big app(s) to try?
Message-ID: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>

Now that Adobe Photoshop CS2 is running kind of
well (there are bugs that need fixing, but I'm trying
to look ahead a bit), what big app(s) are worth focusing on next?

Using http://wiki.winehq.org/LinuxApplicatonRequestSurvey,
skipping Photoshop (which we should continue to fix up)
and the ones that are either too hard, have native versions,
or are probably something Codeweavers might already be
doing, and adding in good old Framemaker (so close to working
we might want to go for it just for the goodwill from all
those tech writers),  I think that leaves about seven big
ticket apps, in rough order of popularity:

http://wiki.winehq.org/AdobeDreamweaver
iTunes
http://wiki.winehq.org/AdobeIllustrator
http://wiki.winehq.org/AdobeFlash
http://wiki.winehq.org/AdobePremiere
http://wiki.winehq.org/AdobeAcrobatPro
http://wiki.winehq.org/AdobeFramemaker

I've created wiki pages with trial download URLs for all but iTunes,
and done a bunch of triage on them.
Most of these could all use more triage and bugs filed.
At some point the dust might settle, and it might become
clearer which one(s) deserve to be focused on.
I think Maarten is going to try iTunes, which would be great.
- Dan


From leslie_alistair at hotmail.com  Sun Feb 17 04:05:34 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Sun, 17 Feb 2008 21:05:34 +1100
Subject: [1/16] msxml3: Support functions for typelib
References: <fp15a2$u7m$1@ger.gmane.org> <878x1lc5ds.fsf@wine.dyndns.org>
Message-ID: <fp90t9$etb$1@ger.gmane.org>

"Alexandre Julliard" <julliard at winehq.org> wrote in message 
news:878x1lc5ds.fsf at wine.dyndns.org...
> Alistair Leslie-Hughes <leslie_alistair at hotmail.com> writes:
>
>> +    *typeinfo = typeinfos[tid];
>> +    return S_OK;
>
> You should increment the ref count when you are returning a pointer,
> even if it's also stored in a global variable.

If have corrected this in the next patch, the other 2-16 patches should be 
disregarded since they
increment the typeinfo pointer in each function is called.  Ill correct the 
2-16 patches shortly.

Best Regards
 Alistair Leslie-Hughes 




From pgquiles at elpauer.org  Sun Feb 17 04:57:11 2008
From: pgquiles at elpauer.org (Pau Garcia i Quiles)
Date: Sun, 17 Feb 2008 11:57:11 +0100
Subject: Next big app(s) to try?
In-Reply-To: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>
References: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>
Message-ID: <20080217115711.uabknx6omckckkk4@www.elpauer.org>

Quoting Dan Kegel <dank at kegel.com>:

> Now that Adobe Photoshop CS2 is running kind of
> well (there are bugs that need fixing, but I'm trying
> to look ahead a bit), what big app(s) are worth focusing on next?
>
> Using http://wiki.winehq.org/LinuxApplicatonRequestSurvey,
> skipping Photoshop (which we should continue to fix up)
> and the ones that are either too hard, have native versions,
> or are probably something Codeweavers might already be
> doing, and adding in good old Framemaker (so close to working
> we might want to go for it just for the goodwill from all
> those tech writers),  I think that leaves about seven big
> ticket apps, in rough order of popularity:
>
> http://wiki.winehq.org/AdobeDreamweaver
> iTunes
> http://wiki.winehq.org/AdobeIllustrator
> http://wiki.winehq.org/AdobeFlash
> http://wiki.winehq.org/AdobePremiere
> http://wiki.winehq.org/AdobeAcrobatPro
> http://wiki.winehq.org/AdobeFramemaker
>
> I've created wiki pages with trial download URLs for all but iTunes,
> and done a bunch of triage on them.
> Most of these could all use more triage and bugs filed.
> At some point the dust might settle, and it might become
> clearer which one(s) deserve to be focused on.
> I think Maarten is going to try iTunes, which would be great.

AutoCAD, please


-- 
Pau Garcia i Quiles
http://www.elpauer.org
(Due to my workload, I may need 10 days to answer)



From leszek.hanusz at gmail.com  Sun Feb 17 05:32:21 2008
From: leszek.hanusz at gmail.com (leszek)
Date: Sun, 17 Feb 2008 12:32:21 +0100
Subject: Autoplay considered harmful
In-Reply-To: <19e31a080802161707w3fe14029hb922126e4d83e194@mail.gmail.com>
References: <765468.77405.qm@web50101.mail.re2.yahoo.com>
	<200802161129.59540.chris.kcat@gmail.com>
	<19e31a080802161707w3fe14029hb922126e4d83e194@mail.gmail.com>
Message-ID: <1203247941.2344.4.camel@pc1>


Le samedi 16 f?vrier 2008 ? 20:07 -0500, Steven Edwards a ?crit :
> 
> Ideally the freedesktop should define a spec (which they may already
> do as part of HAL) that we should be able to interface with. There
> should be a way to have the auto insert event detect a autorun.inf and
> prompt the user if they want to open it with Wine. If no one else
> wants to research it I'll try to take a look in to it sometime.
> 

It is already implemented in gnome svn.
Have a look here: 
http://bugzilla.gnome.org/show_bug.cgi?id=453266

-Hanusz Leszek



From research at science.su  Sun Feb 17 06:02:40 2008
From: research at science.su (L. Rahyen)
Date: Sun, 17 Feb 2008 12:02:40 +0000
Subject: Next big app(s) to try?
In-Reply-To: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>
References: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>
Message-ID: <200802171202.41075.research@science.su>

On Sunday February 17 2008 09:15:24 Dan Kegel wrote:
> Now that Adobe Photoshop CS2 is running kind of
> well (there are bugs that need fixing, but I'm trying
> to look ahead a bit), what big app(s) are worth focusing on next?
>
> Using http://wiki.winehq.org/LinuxApplicatonRequestSurvey,
> skipping Photoshop (which we should continue to fix up)
> and the ones that are either too hard, have native versions,
> or are probably something Codeweavers might already be
> doing, and adding in good old Framemaker (so close to working
> we might want to go for it just for the goodwill from all
> those tech writers),  I think that leaves about seven big
> ticket apps, in rough order of popularity:
>
> http://wiki.winehq.org/AdobeDreamweaver
> iTunes
> http://wiki.winehq.org/AdobeIllustrator
> http://wiki.winehq.org/AdobeFlash
> http://wiki.winehq.org/AdobePremiere
> http://wiki.winehq.org/AdobeAcrobatPro
> http://wiki.winehq.org/AdobeFramemaker
>
> I've created wiki pages with trial download URLs for all but iTunes,
> and done a bunch of triage on them.
> Most of these could all use more triage and bugs filed.
> At some point the dust might settle, and it might become
> clearer which one(s) deserve to be focused on.
> I think Maarten is going to try iTunes, which would be great.
> - Dan

	What about support for Autodesk products (such as AutoCAD and 3ds max)? As 
far as I know there is two group of problems preventing them from working: 
copy-protection related and .NET related. This is true for most recent 
versions.
	However for not-so-new versions there is no .NET issues (just copy-protection 
problems). For example this is true for 3ds max 4, 5, 6, 7 (but I didn't check 
this personally). I heard that it is possible to get 3ds max 3 working on 
WINE but it's so old that this is useless today but it gives hope that newer 
versions of 3ds max will work if proper support for copy-protection used by 
Autodesk will be implemented.
	This is true for AutoCAD too (as far as I know AutoCAD and 3ds max are using 
same protection called C-Dilla).
	Unfortunately, I'm not an expert on this topic so I don't know how difficult 
to implement proper support for C-Dilla. But if it's implemented, it is very 
likely that both AutoCAD and 3ds max will work (as I said, because of .NET 
issues, most recent versions may not work but at least not so new versions 
will work; in future, when .NET support will be better, new versions will 
probably work too).
	In other words, proper support for C-Dilla is most important thing for 
AutoCAD and 3ds max support so it is possible to temporary ignore .NET bugs 
related to most recent Autodesk products for now.
	By the way, AutoCAD and 3ds max are very popular applications. It's easy to 
check how they are popular by using Google. For example, for AutoCAD alone 
you will get 43,800,000 results [1]. So there is a really a lot of people who 
depends on Autodesk products such as AutoCAD.

[1] http://www.google.com/search?hl=en&q=AutoCAD&btnG=Google+Search&aq=f

	*	*	*

	(Everything below is just my personal experience as a person who depends on 
Autodesk products so you can skip it if you don't like such stories).
	Because of above problems many people (who depends on these applications) 
just forced to use Windows. In fact, I wasn't able to "convert" to Linux some 
of my friends because of AutoCAD being unsupported in Linux.
	For now, I'm stuck with VMWare. But it doesn't support DirectX or OpenGL so 
working with many projects is a pain (therefore it's difficult to call use of 
VMWare "Linux support for Autodesk products", even worse, use of VMWare not 
only means use of Windows but it also means BAD performance in even not very 
big projects) but I currently havn't other choices. I depend heavily on Linux 
applications/environment/daemons so dual-boot isn't an option for me - 
virtual machine in Linux host is the only choice. I really tired from bad 
performance and bad integration of the VMWare, I really hope that WINE will 
support Autodesk products someday...
	However, I use WINE for many other application such as Photoshop CS, AVR 
Studio, XnView and many others, so I'm really happy that WINE exists and I'm 
really thankful to all WINE developers.
	AutoCAD and 3ds max are two last programs that force me to use virtual 
machine with Windows...


From jwstolk at gmail.com  Sun Feb 17 06:07:21 2008
From: jwstolk at gmail.com (Jaap Stolk)
Date: Sun, 17 Feb 2008 13:07:21 +0100
Subject: Next big app(s) to try?
In-Reply-To: <20080217115711.uabknx6omckckkk4@www.elpauer.org>
References: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>
	<20080217115711.uabknx6omckckkk4@www.elpauer.org>
Message-ID: <95c320f10802170407j5a54c82bveadda35d8c8473d0@mail.gmail.com>

On Feb 17, 2008 11:57 AM, Pau Garcia i Quiles <pgquiles at elpauer.org> wrote:
>
> AutoCAD, please
>

I spend a lot of time trying to get autocad (2004) to run on Wine.
There where some small problems like registry things and with Internet
Explorer dependencies, but those where easy to solve. The big problem
is that the copy protection (and the anti-debugging tricks in it) run
as a couple of windows drivers and do things that are far from
"normal" in Windows. It is also very picky about almost everything,
and does not generate any timely or useful error messages. (it just
exits at the very end, without any clue about what went wrong.)
Without the copy protection I'm sure autocad would run just fine with
Wine. Newer autocad versions use .NET as well, which could be more
complicated. (And no, "p2p" versions still have all the copy
protection and anti-debugging tricks. )

Personally (as a programmer), I think my time would be better spend on
many of the open-source CAD programs.
(Or ask rhino3d very nicely if they want to make a Linux version. please. :-)

jaap.


From epssyis at gmail.com  Sun Feb 17 07:18:10 2008
From: epssyis at gmail.com (Edward Savage)
Date: Sun, 17 Feb 2008 23:18:10 +1000
Subject: Next big app(s) to try?
In-Reply-To: <95c320f10802170407j5a54c82bveadda35d8c8473d0@mail.gmail.com>
References: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>
	<20080217115711.uabknx6omckckkk4@www.elpauer.org>
	<95c320f10802170407j5a54c82bveadda35d8c8473d0@mail.gmail.com>
Message-ID: <d6c5d7290802170518r45a18c79i10d53687de255d05@mail.gmail.com>

CS3 photoshop, illustrator, flash, and aftereffects so I can drag my
girlfriend to linux.

Thanks :D

(Sorry for the dupe Jaap, hit the wrong reply button.)

On Feb 17, 2008 10:07 PM, Jaap Stolk <jwstolk at gmail.com> wrote:

> On Feb 17, 2008 11:57 AM, Pau Garcia i Quiles <pgquiles at elpauer.org>
> wrote:
> >
> > AutoCAD, please
> >
>
> I spend a lot of time trying to get autocad (2004) to run on Wine.
> There where some small problems like registry things and with Internet
> Explorer dependencies, but those where easy to solve. The big problem
> is that the copy protection (and the anti-debugging tricks in it) run
> as a couple of windows drivers and do things that are far from
> "normal" in Windows. It is also very picky about almost everything,
> and does not generate any timely or useful error messages. (it just
> exits at the very end, without any clue about what went wrong.)
> Without the copy protection I'm sure autocad would run just fine with
> Wine. Newer autocad versions use .NET as well, which could be more
> complicated. (And no, "p2p" versions still have all the copy
> protection and anti-debugging tricks. )
>
> Personally (as a programmer), I think my time would be better spend on
> many of the open-source CAD programs.
> (Or ask rhino3d very nicely if they want to make a Linux version. please.
> :-)
>
> jaap.
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080217/84952fb8/attachment.htm 

From dank at kegel.com  Sun Feb 17 11:11:58 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 09:11:58 -0800
Subject: Next big app(s) to try?
In-Reply-To: <200802171202.41075.research@science.su>
References: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>
	<200802171202.41075.research@science.su>
Message-ID: <a71bd89a0802170911n76e5ac56x3acff7917cd390af@mail.gmail.com>

On Feb 17, 2008 4:02 AM, L. Rahyen <research at science.su> wrote:
>         What about support for Autodesk products (such as AutoCAD and 3ds max)? As
> far as I know there is two group of problems preventing them from working:
> copy-protection related and .NET related. ...
>         However for not-so-new versions there is no .NET issues (just copy-protection
> problems)....
>         This is true for AutoCAD too (as far as I know AutoCAD and 3ds max are using
> same protection called C-Dilla).

Yeah, getting .net working would be great, and we seem to be making
some progress there.  And getting the copy protection used by these apps
would be great.  Googling around, I see that C-Dilla has sometimes been
called Safecast, which is related to Safedisc, so I took the liberty of updating
http://wiki.winehq.org/SafeDisc with a link to the Autocad 2000 bug,
http://bugs.winehq.org/show_bug.cgi?id=8466.  That one looks like
it's waiting for some action - James pointed out a simple-looking problem,
but nobody's tackled it yet.

I'm torn between tackling hard problems and just going for the
low-hanging fruit.
I think the upshot is: I'm going to push hard on the low-hanging fruit,
and let the hard problems sort themselves out in their own time,
since pushing on them usually tends to involve a lot of wheel spinning.
- Dan


From gerald at pfeifer.com  Sun Feb 17 06:18:51 2008
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Sun, 17 Feb 2008 13:18:51 +0100 (CET)
Subject: dlls/msi/streams.c -- simplify and constify
In-Reply-To: <Pine.LNX.4.64.0711032244220.26054@acrux.dbai.tuwien.ac.at>
References: <Pine.LNX.4.64.0711031906340.26054@acrux.dbai.tuwien.ac.at>
	<22821af30711031415h202a503agc789253167f89f11@mail.gmail.com>
	<Pine.LNX.4.64.0711032244220.26054@acrux.dbai.tuwien.ac.at>
Message-ID: <alpine.LSU.1.00.0802171309370.32184@pulcherrima.dbai.tuwien.ac.at>

For the record, while I don't think I saw a response to this, the
issue itself was now fixed with basically the same patch submitted
by Marcusso we can remove this from our radars.

Thanks for trying again, Marcus! :-)

Gerald

On Sat, 3 Nov 2007, Gerald Pfeifer wrote:
> Good observation, though comparing an unsigned type against -1 is not
> exactly good practice.  Delving more into msi/streams.c, I came up with 
> the patch below which tries to address this (and some other issues).  
> 
> If Alexandre and you prefer, I can change the check and really make it
> just read sv->num_rows == -1.  I just wanted to point out there also is
> an alternative way.
> 
> Thanks again for your feedback.  It was very helpful, and I'll watch
> out for cases like this.
> 
> Gerald
> 
> Index: streams.c
> ===================================================================
> RCS file: /home/wine/wine/dlls/msi/streams.c,v
> retrieving revision 1.7
> diff -u -3 -p -r1.7 streams.c
> --- streams.c	18 Oct 2007 13:00:57 -0000	1.7
> +++ streams.c	3 Nov 2007 22:01:13 -0000
> @@ -39,7 +39,7 @@ WINE_DEFAULT_DEBUG_CHANNEL(msidb);
>  
>  typedef struct tabSTREAM
>  {
> -    int str_index;
> +    UINT str_index;
>      LPWSTR name;
>      IStream *stream;
>  } STREAM;
> @@ -54,7 +54,7 @@ typedef struct tagMSISTREAMSVIEW
>      UINT row_size;
>  } MSISTREAMSVIEW;
>  
> -static BOOL add_stream_to_table(MSISTREAMSVIEW *sv, STREAM *stream, int index)
> +static BOOL add_stream_to_table(MSISTREAMSVIEW *sv, STREAM *stream, UINT index)
>  {
>      if (index >= sv->max_streams)
>      {
> @@ -315,7 +315,7 @@ static UINT STREAMS_modify(struct tagMSI
>  static UINT STREAMS_delete(struct tagMSIVIEW *view)
>  {
>      MSISTREAMSVIEW *sv = (MSISTREAMSVIEW *)view;
> -    int i;
> +    UINT i;
>  
>      TRACE("(%p)\n", view);
>  
> @@ -381,7 +381,8 @@ static const MSIVIEWOPS streams_ops =
>      NULL,
>  };
>  
> -static UINT add_streams_to_table(MSISTREAMSVIEW *sv)
> +static int add_streams_to_table(MSISTREAMSVIEW *sv)
> +    /* Return -1 in case of error. */
>  {
>      IEnumSTATSTG *stgenum = NULL;
>      STATSTG stat;
> @@ -433,6 +434,7 @@ static UINT add_streams_to_table(MSISTRE
>  UINT STREAMS_CreateView(MSIDATABASE *db, MSIVIEW **view)
>  {
>      MSISTREAMSVIEW *sv;
> +    INT i;
>  
>      TRACE("(%p, %p)\n", db, view);
>  
> @@ -442,10 +444,12 @@ UINT STREAMS_CreateView(MSIDATABASE *db,
>  
>      sv->view.ops = &streams_ops;
>      sv->db = db;
> -    sv->num_rows = add_streams_to_table(sv);
>  
> -    if (sv->num_rows < 0)
> -        return ERROR_FUNCTION_FAILED;
> +    i = add_streams_to_table(sv);
> +    if (i < 0)
> +       return ERROR_FUNCTION_FAILED;
> +    else
> +       sv->num_rows = i;
>  
>      *view = (MSIVIEW *)sv;
>


From dank at kegel.com  Sun Feb 17 11:51:52 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 09:51:52 -0800
Subject: bugzilla on the fritz again
Message-ID: <a71bd89a0802170951s7d39cfbbld5d6bbc2bd1252c0@mail.gmail.com>

Just started getting this:

Software error:

Can't connect to the database.
Error: Too many connections
  Is your database installed and up and running?
  Do you have the correct username and password selected in localconfig?


From dank at kegel.com  Sun Feb 17 11:55:06 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 09:55:06 -0800
Subject: appdb feature request: hide the ugly urls
Message-ID: <a71bd89a0802170955k3d276728ue3fa165cb6370044@mail.gmail.com>

How hard would it be for the appdb to support
more readable URLs for vendors and applications?  e.g.
Adobe Premiere is currently at
http://appdb.winehq.org/objectManager.php?sClass=application&iId=128
but it'd be so slick to see instead
http://appdb.winehq.org/adobe/premiere

Believe it or not, that little change would make the appdb
less scary for newcomers.
- Dan


From truiken at gmail.com  Sun Feb 17 12:04:47 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 17 Feb 2008 12:04:47 -0600
Subject: dlls/msi/streams.c type fixes
In-Reply-To: <alpine.LSU.1.00.0802171320180.32184@pulcherrima.dbai.tuwien.ac.at>
References: <alpine.LSU.1.00.0802171320180.32184@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <22821af30802171004u47fb4c2dw2d0f1b20d3e8316c@mail.gmail.com>

On Feb 17, 2008 6:23 AM, Gerald Pfeifer <gerald at pfeifer.com> wrote:
> This patch contains one or two items from my November patch the core
> of which was independently recreated by Marcus and accepted and one
> or two additional changes.  It addresses the following warnings:
>
>   streams.c: In function 'streams_set_table_size':
>   streams.c:59: warning: comparison between signed and unsigned
>   streams.c: In function 'STREAMS_delete':
>   streams.c:379: warning: comparison between signed and unsigned
>   streams.c: In function 'STREAMS_find_matching_rows':
>   streams.c:404: warning: comparison between signed and unsigned
>
> Gerald
>
> ChangeLog:
> Adjust the signedness of three variables and add a comment for
> add_streams_to_table().
>
> Index: streams.c
> ===================================================================
> RCS file: /home/wine/wine/dlls/msi/streams.c,v
> retrieving revision 1.11
> diff -u -3 -p -r1.11 streams.c
> --- streams.c   16 Feb 2008 15:59:26 -0000      1.11
> +++ streams.c   17 Feb 2008 12:17:50 -0000
> @@ -39,7 +39,7 @@ WINE_DEFAULT_DEBUG_CHANNEL(msidb);
>
>  typedef struct tabSTREAM
>  {
> -    int str_index;
> +    UINT str_index;
>      LPWSTR name;
>      IStream *stream;
>  } STREAM;
> @@ -54,7 +54,7 @@ typedef struct tagMSISTREAMSVIEW
>      UINT row_size;
>  } MSISTREAMSVIEW;
>
> -static BOOL streams_set_table_size(MSISTREAMSVIEW *sv, int size)
> +static BOOL streams_set_table_size(MSISTREAMSVIEW *sv, UINT size)
>  {
>      if (size >= sv->max_streams)
>      {
> @@ -372,7 +372,7 @@ static UINT STREAMS_modify(struct tagMSI
>  static UINT STREAMS_delete(struct tagMSIVIEW *view)
>  {
>      MSISTREAMSVIEW *sv = (MSISTREAMSVIEW *)view;
> -    int i;
> +    UINT i;
>
>      TRACE("(%p)\n", view);
>
> @@ -440,6 +440,7 @@ static const MSIVIEWOPS streams_ops =
>  };
>
>  static INT add_streams_to_table(MSISTREAMSVIEW *sv)
> +    /* Return -1 in case of error. */
>  {
>      IEnumSTATSTG *stgenum = NULL;
>      STATSTG stat;
>

Don't add random comments like this.

-- 
James Hawkins


From nemes.sorin at gmail.com  Sun Feb 17 12:13:07 2008
From: nemes.sorin at gmail.com (Nemes Ioan Sorin)
Date: Sun, 17 Feb 2008 20:13:07 +0200
Subject: Next big app(s) to try?
In-Reply-To: <d6c5d7290802170518r45a18c79i10d53687de255d05@mail.gmail.com>
References: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>	<20080217115711.uabknx6omckckkk4@www.elpauer.org>	<95c320f10802170407j5a54c82bveadda35d8c8473d0@mail.gmail.com>
	<d6c5d7290802170518r45a18c79i10d53687de255d05@mail.gmail.com>
Message-ID: <47B87933.5090208@gmail.com>

Can I add here Corel Draw suite ?
I've managed to start and work with Corel Draw 12 (with Wine Doors I add 
VB common controls) but after wine 0.9.45 Corel stop working.

Also Corel Draw is widely used in DTP industry.

Finally imagine AVID* working better and faster under WINE, ..stop   I 
walk in a dream now, sorry for that ;)

Edward Savage wrote:
> CS3 photoshop, illustrator, flash, and aftereffects so I can drag my 
> girlfriend to linux. 
> 
> Thanks :D
> 
> (Sorry for the dupe Jaap, hit the wrong reply button.)
> 
> On Feb 17, 2008 10:07 PM, Jaap Stolk <jwstolk at gmail.com 
> <mailto:jwstolk at gmail.com>> wrote:
> 
>     On Feb 17, 2008 11:57 AM, Pau Garcia i Quiles <pgquiles at elpauer.org
>     <mailto:pgquiles at elpauer.org>> wrote:
>      >
>      > AutoCAD, please
>      >
> 
>     I spend a lot of time trying to get autocad (2004) to run on Wine.
>     There where some small problems like registry things and with Internet
>     Explorer dependencies, but those where easy to solve. The big problem
>     is that the copy protection (and the anti-debugging tricks in it) run
>     as a couple of windows drivers and do things that are far from
>     "normal" in Windows. It is also very picky about almost everything,
>     and does not generate any timely or useful error messages. (it just
>     exits at the very end, without any clue about what went wrong.)
>     Without the copy protection I'm sure autocad would run just fine with
>     Wine. Newer autocad versions use .NET as well, which could be more
>     complicated. (And no, "p2p" versions still have all the copy
>     protection and anti-debugging tricks. )
> 
>     Personally (as a programmer), I think my time would be better spend on
>     many of the open-source CAD programs.
>     (Or ask rhino3d very nicely if they want to make a Linux version.
>     please. :-)
> 
>     jaap.
> 
> 
> 
> 
> ------------------------------------------------------------------------
> 
> 



From stefan at codeweavers.com  Sun Feb 17 12:15:28 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 17 Feb 2008 19:15:28 +0100
Subject: [6/6] wined3d: take alpha from device palette entry for d3d 8 and
	later
In-Reply-To: <47B8E13C.7050105@inbox.lv>
References: <47B8E13C.7050105@inbox.lv>
Message-ID: <200802171915.31646.stefan@codeweavers.com>

Am Montag, 18. Februar 2008 02:37:00 schrieb Alexander Dorofeyev:

>/*can ddraw and d3d < 8 surfaces use device's palette (d3d >= 8 feature)?*/
No, they can't, there is no API to access them
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080217/14c668d4/attachment.pgp 

From stefan at codeweavers.com  Sun Feb 17 12:37:12 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 17 Feb 2008 19:37:12 +0100
Subject: [1/6] ddraw: fix executebuffer branching with non-zero offset
In-Reply-To: <47B8E123.6010609@inbox.lv>
References: <47B8E123.6010609@inbox.lv>
Message-ID: <200802171937.14949.stefan@codeweavers.com>

Am Montag, 18. Februar 2008 02:36:35 schrieb Alexander Dorofeyev:
> Fixes a crash in Moto Racer 2.
> ---
>   dlls/ddraw/executebuffer.c |   10 ++++++++--
>   1 files changed, 8 insertions(+), 2 deletions(-)
The patches look good to me
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080217/2d3a737f/attachment.pgp 

From julliard at winehq.org  Sun Feb 17 12:43:54 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sun, 17 Feb 2008 19:43:54 +0100
Subject: include: Add support for executing finally code for exceptions
	without using a separate function.
In-Reply-To: <47B879D8.8080307@codeweavers.com> (Robert Shearman's message of
	"Sun, 17 Feb 2008 18:15:52 +0000")
References: <47B879D8.8080307@codeweavers.com>
Message-ID: <87skzr4e51.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> The first goal is accomplished by changing the previous two-state
> variable of __first into a three-state variable where the third state
> is the state in which the finally code is executed in the normal
> case. The second goal is accomplished by calling sigsetjmp in
> __wine_finally_handler to give the finally code a place to jump back
> to after it has finished executing.

That can't work, once you longjmp into the finally block you can't
longjmp back, since you are no longer inside the function that did the
setjmp.

-- 
Alexandre Julliard
julliard at winehq.org


From alexd4 at inbox.lv  Sun Feb 17 22:49:44 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Sun, 17 Feb 2008 20:49:44 -0800
Subject: [6/6] wined3d: take alpha from device palette entry for d3d 8
	and	later
In-Reply-To: <200802171915.31646.stefan@codeweavers.com>
References: <47B8E13C.7050105@inbox.lv>
	<200802171915.31646.stefan@codeweavers.com>
Message-ID: <47B90E68.1040608@inbox.lv>

Yes, I think so too, personally I've the impression that for dx <= 7 apps RGB 
from device palette shouldn't be copied, and maybe the only thing to do in such 
cases is storing palette index in alpha, in case the app will want to lock the 
surface. But, this is a thing for another patch. At least one game - C&C Red 
Alert 1 - enters that codepath, so care is needed.

The comment is just a reminder that the code may need further work.

Stefan D?singer wrote:
> Am Montag, 18. Februar 2008 02:37:00 schrieb Alexander Dorofeyev:
> 
>> /*can ddraw and d3d < 8 surfaces use device's palette (d3d >= 8 feature)?*/
> No, they can't, there is no API to access them
> 



From dank at kegel.com  Sun Feb 17 12:44:38 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 10:44:38 -0800
Subject: Next big app(s) to try?
In-Reply-To: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>
References: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>
Message-ID: <a71bd89a0802171044t5e9d3b54vbf3c756e8cdeca2c@mail.gmail.com>

Edward Savage wrote:
> CS3 photoshop, illustrator, flash, and aftereffects so I can drag my
> girlfriend to linux.

OK, just for you I created
http://wiki.winehq.org/AdobeAfterEffects
with download links, etc.

There's one common bug stopping all CS3 installs, I think,
but in my experience bugs in the earlier versions also
show up in later versions, and the earlier versions have
easier to work on.

So if you want us to work on After Effects, please start testing
all the trial versions before CS3 and filing bugs.  That will
get the app ready for when we fix that common CS3 bug.
- Dan


From madewokherd+d41d at gmail.com  Sun Feb 17 14:28:53 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Sun, 17 Feb 2008 15:28:53 -0500
Subject: programs: add winestartfile for starting files from the unix path
	(for file managers)
Message-ID: <ced95fe0802171228t137b679kb7bad999a44dad56@mail.gmail.com>

This is now attempt 4, not that anyone's counting.

Adding winelib programs is a bit involved, and I imagine I've screwed
something up along the way. If you know how to add them properly,
please say something, even if it's to tell me I did it right.

This patch adds a winelib program called winestartfile for starting
files given the unix path. It attempts to mimic what windows explorer
does to start files and provide some visible (gui) feedback when it
doesn't work. The idea is that wine.desktop can then be modified to
use winestartfile instead of wine, solving the following problems when
starting exe files from file managers:
* File managers typically do not set the working directory to the
directory that contains an exe when they start it. Setting the working
directory is the default behavior for windows explorer, and many
windows programs rely on it.
* File managers naturally use the unix path to start files, and the
wine binary passes the unix path along to the exe it starts, rather
than translating it to a windows path (this can and probably should
also be fixed somewhere else).
* Windows explorer always starts exe files with quotes around the path
in the command-line, even if the path does not contain spaces. The
wine binary does not (and probably should not) add quotes in this
situation. A few apps rely on the quotes. See
http://bugs.winehq.org/show_bug.cgi?id=5224#c14

-- 
Vincent Povirk
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-programs-add-winestartfile-for-starting-files-from.patch
Type: text/x-patch
Size: 15268 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080217/9b0e1cd1/attachment-0001.bin 

From gerald at pfeifer.com  Sun Feb 17 12:47:27 2008
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Sun, 17 Feb 2008 19:47:27 +0100 (CET)
Subject: dlls/shell32/pidl.c -- adjust to unsignedness of a type
In-Reply-To: <874pc9c59i.fsf@wine.dyndns.org>
References: <alpine.LSU.1.00.0802140219440.19228@pulcherrima.dbai.tuwien.ac.at>
	<874pc9c59i.fsf@wine.dyndns.org>
Message-ID: <alpine.LSU.1.00.0802171943420.32184@pulcherrima.dbai.tuwien.ac.at>

On Sat, 16 Feb 2008, Alexandre Julliard wrote:
> The test should probably be removed completely since there's already a
> default for it in the switch() that follows.

I was thinking of this, but wanted to go for the smaller patch initially,
but your wish is my command ;-). 

Updated patch below.  Nearly everything here is whitespace changes; the 
second hunk only removes "if (type >= 0 && type <= 2) {" and "}".

Gerald

ChangeLog:
Adjust a format specifier and remove a redundant range check in
ILGetDisplayNameExW().

Index: pidl.c
===================================================================
RCS file: /home/wine/wine/dlls/shell32/pidl.c,v
retrieving revision 1.159
diff -u -3 -p -r1.159 pidl.c
--- pidl.c	16 Feb 2008 15:58:53 -0000	1.159
+++ pidl.c	17 Feb 2008 18:44:54 -0000
@@ -97,7 +97,7 @@ BOOL WINAPI ILGetDisplayNameExW(LPSHELLF
     STRRET strret;
     DWORD flag;
 
-    TRACE("%p %p %p %d\n", psf, pidl, path, type);
+    TRACE("%p %p %p %x\n", psf, pidl, path, type);
 
     if (!pidl || !path)
         return FALSE;
@@ -109,46 +109,44 @@ BOOL WINAPI ILGetDisplayNameExW(LPSHELLF
             return FALSE;
     }
 
-    if (type >= 0 && type <= 2)
+    switch (type)
     {
-        switch (type)
+    case ILGDN_FORPARSING:
+        flag = SHGDN_FORPARSING | SHGDN_FORADDRESSBAR;
+        break;
+    case ILGDN_NORMAL:
+        flag = SHGDN_NORMAL;
+        break;
+    case ILGDN_INFOLDER:
+        flag = SHGDN_INFOLDER;
+        break;
+    default:
+        FIXME("Unknown type parameter = %x\n", type);
+        flag = SHGDN_FORPARSING | SHGDN_FORADDRESSBAR;
+        break;
+    }
+
+    if (!*(const WORD*)pidl || type == ILGDN_FORPARSING)
+    {
+        ret = IShellFolder_GetDisplayNameOf(lsf, pidl, flag, &strret);
+        if (SUCCEEDED(ret))
         {
-        case ILGDN_FORPARSING:
-            flag = SHGDN_FORPARSING | SHGDN_FORADDRESSBAR;
-            break;
-        case ILGDN_NORMAL:
-            flag = SHGDN_NORMAL;
-            break;
-        case ILGDN_INFOLDER:
-            flag = SHGDN_INFOLDER;
-            break;
-        default:
-            FIXME("Unknown type parameter = %x\n", type);
-            flag = SHGDN_FORPARSING | SHGDN_FORADDRESSBAR;
-            break;
+            if(!StrRetToStrNW(path, MAX_PATH, &strret, pidl))
+                ret = E_FAIL;
         }
-        if (!*(const WORD*)pidl || type == ILGDN_FORPARSING)
+    }
+    else
+    {
+        ret = SHBindToParent(pidl, &IID_IShellFolder, (LPVOID*)&psfParent, &pidllast);
+        if (SUCCEEDED(ret))
         {
-            ret = IShellFolder_GetDisplayNameOf(lsf, pidl, flag, &strret);
+            ret = IShellFolder_GetDisplayNameOf(psfParent, pidllast, flag, &strret);
             if (SUCCEEDED(ret))
             {
-                if(!StrRetToStrNW(path, MAX_PATH, &strret, pidl))
+                if(!StrRetToStrNW(path, MAX_PATH, &strret, pidllast))
                     ret = E_FAIL;
             }
-        }
-        else
-        {
-            ret = SHBindToParent(pidl, &IID_IShellFolder, (LPVOID*)&psfParent, &pidllast);
-            if (SUCCEEDED(ret))
-            {
-                ret = IShellFolder_GetDisplayNameOf(psfParent, pidllast, flag, &strret);
-                if (SUCCEEDED(ret))
-                {
-                    if(!StrRetToStrNW(path, MAX_PATH, &strret, pidllast))
-                        ret = E_FAIL;
-                }
-                IShellFolder_Release(psfParent);
-            }
+            IShellFolder_Release(psfParent);
         }
     }
 


From denis.bonnenfant at diderot.org  Sun Feb 17 16:06:24 2008
From: denis.bonnenfant at diderot.org (denis bonnenfant)
Date: Sun, 17 Feb 2008 23:06:24 +0100
Subject: Next big app(s) to try?
In-Reply-To: <47B87933.5090208@gmail.com>
References: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>	<20080217115711.uabknx6omckckkk4@www.elpauer.org>	<95c320f10802170407j5a54c82bveadda35d8c8473d0@mail.gmail.com>	<d6c5d7290802170518r45a18c79i10d53687de255d05@mail.gmail.com>
	<47B87933.5090208@gmail.com>
Message-ID: <47B8AFE0.6060509@diderot.org>

Another major application that may be interesting to support is SolidWorks.
http://appdb.winehq.org/objectManager.php?sClass=version&iId=8983

Why ?

- It's one of the most popular CAD application for mechanical design and 
engineering, and surely the most used for educationnal purposes. Although the 
industrial version is quite expensive, thousands of $ or ?, it is availiable for 
free for students in europe, and currently, it is the only app that may prevent 
them from switching from Windows to Linux.

- The Vista version is a pure disaster (or is vista the disaster ?), on a 
high-end notebook, it runs much slower than on a 4-years old low-end one with 
Win2K ! I saw many users really disappointed having to switch their brand new 
notebook back to XP, So there is a real "market" for linux/wine here !

- No MacOs version or alternatives.

- No opensource alternatives, and no linux native equivalents too ( Pro/E used 
to have a linux version, but i have no news about it )



Technically, most of the work seems to be done, i'm regularly testing it against 
  new wine versions, and it mostly works, except 3 blocking bugs that prevent 
any real use. Unfortunately, it looks like there are no other apps impacted, as 
  I saw no evolution for long months.  :

+ installation just works out of the box, no tricks needed, so testing is really 
simple, as the downloadable version can be run without registration during one 
month.

+ The modeler, the parasolid kernel, works perfectly. Very big assemblies can be 
opened and modified, and all the functions works, except one.

- The most important function, extrude, is crashing, but it is related to the UI 
only, I guess. unfortunately, I wasn't able to find the problem. 
http://bugs.winehq.org/show_bug.cgi?id=9545

- OpenGL child windows bug http://bugs.winehq.org/show_bug.cgi?id=2398, or its 
cousin is still here, it was mostly solved by this patch 
http://www.winehq.org/pipermail/wine-devel/attachments/20070821/b0f56ecf/wine_glwin4-0001.bin
, but actual wine version is in regression.

- Can't save files, looks like some things are missing in storage implementation
http://bugs.winehq.org/show_bug.cgi?id=9396

- Big issues with flicker-free screen redraw, causing visual artifacts and huge 
bitmaps to be allocated ( surely sync issues, causing0 messages to be passed in 
bad order, with unallocated values)   http://bugs.winehq.org/show_bug.cgi?id=9561




From wine.dev at web.de  Sun Feb 17 17:10:10 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Mon, 18 Feb 2008 00:10:10 +0100
Subject: [PATCH]  Environment variable to specify X11 window for desktop
In-Reply-To: <47B5B3C9.7000308@codeweavers.com>
References: <47B594E7.90501@siriushk.com> <47B5B3C9.7000308@codeweavers.com>
Message-ID: <1203289810.8827.7.camel@p4>

On Fr, 2008-02-15 at 15:46 +0000, Robert Shearman wrote:
> Timothy Lee wrote:
> > The attached patch allows the WINE desktop to be embedded within an 
> > existing X11 window, and is similar to the windowed mode in WINE.

> I'm struggling to imagine a case where the behaviour you've implemented 
> is useful.

With XSCREENSAVER_WINDOW as the Environment Variable:
http://wiki.winehq.org/ScreenSavers


-- 
 
By by ... Detlef




From remco47 at yahoo.com  Sun Feb 17 17:19:01 2008
From: remco47 at yahoo.com (Remco)
Date: Sun, 17 Feb 2008 15:19:01 -0800 (PST)
Subject: appdb feature request: hide the ugly urls
Message-ID: <693989.83877.qm@web50103.mail.re2.yahoo.com>

----- Original Message ----
> From: Dan Kegel <dank at kegel.com>
> To: wine-devel <wine-devel at winehq.org>
> Sent: Sunday, February 17, 2008 6:55:06 PM
> Subject: appdb feature request: hide the ugly urls
> 
> How hard would it be for the appdb to support
> more readable URLs for vendors and applications?  e.g.
> Adobe Premiere is currently at
> http://appdb.winehq.org/objectManager.php?sClass=application&iId=128
> but it'd be so slick to see instead
> http://appdb.winehq.org/adobe/premiere
> 
> Believe it or not, that little change would make the appdb
> less scary for newcomers.
> - Dan
 

That's relatively easy to do with mod_rewrite. But it would have to be something like:

http://appdb.winehq.org/app/128/adobe-premiere.html

All the info is still in the URL (which mod_rewrite can extract), but it does look less scary.

Remco



      ____________________________________________________________________________________
Be a better friend, newshound, and 
know-it-all with Yahoo! Mobile.  Try it now.  http://mobile.yahoo.com/;_ylt=Ahu06i62sR8HDtDypao8Wcj9tAcJ 



From dank at kegel.com  Sun Feb 17 18:13:23 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 16:13:23 -0800
Subject: appdb feature request: hide the ugly urls
In-Reply-To: <693989.83877.qm@web50103.mail.re2.yahoo.com>
References: <693989.83877.qm@web50103.mail.re2.yahoo.com>
Message-ID: <a71bd89a0802171613j206801e0yda55301d505979fa@mail.gmail.com>

On Feb 17, 2008 3:19 PM, Remco <remco47 at yahoo.com> wrote:
> > Adobe Premiere is currently at
> > http://appdb.winehq.org/objectManager.php?sClass=application&iId=128
> > but it'd be so slick to see instead
> > http://appdb.winehq.org/adobe/premiere
>
> That's relatively easy to do with mod_rewrite. But it would have to be something like:
>
> http://appdb.winehq.org/app/128/adobe-premiere.html
>
> All the info is still in the URL (which mod_rewrite can extract), but it does look less scary.

Not quite good enough.   People need to be able to guess the
URL.  We should be able to look up 'adobe-premiere' and get '128'.
So maybe http://appdb.winehq.org/app/adobe-premiere.html
- Dan


From wine-devel at kievinfo.com  Sun Feb 17 18:22:25 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 17 Feb 2008 17:22:25 -0700
Subject: appdb feature request: hide the ugly urls
In-Reply-To: <a71bd89a0802171613j206801e0yda55301d505979fa@mail.gmail.com>
References: <693989.83877.qm@web50103.mail.re2.yahoo.com>
	<a71bd89a0802171613j206801e0yda55301d505979fa@mail.gmail.com>
Message-ID: <47B8CFC1.6020403@kievinfo.com>

Dan Kegel wrote:
> On Feb 17, 2008 3:19 PM, Remco <remco47 at yahoo.com> wrote:
>>> Adobe Premiere is currently at
>>> http://appdb.winehq.org/objectManager.php?sClass=application&iId=128
>>> but it'd be so slick to see instead
>>> http://appdb.winehq.org/adobe/premiere
>> That's relatively easy to do with mod_rewrite. But it would have to be something like:
>>
>> http://appdb.winehq.org/app/128/adobe-premiere.html
>>
>> All the info is still in the URL (which mod_rewrite can extract), but it does look less scary.
> 
> Not quite good enough.   People need to be able to guess the
> URL.  We should be able to look up 'adobe-premiere' and get '128'.
> So maybe http://appdb.winehq.org/app/adobe-premiere.html
> - Dan
> 
> 
I don't think that would work all that well. As-is AppDB having all sorts of 
problem with it's search function. You want to break all the links as well? 
Granted having all the links as some ID to some cryptic script is even worse.

If you want the link to be a application's name, how about games with a huge 
long name? Like "Command & Conquer 3: Tiberium Wars 1.x". Is that easier to 
enter? I don't think so.

IMHO just fixing the search and getting rid of all those banners in the 
search results would be much more helpful.

Vitaliy.


From dank at kegel.com  Sun Feb 17 18:43:04 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 16:43:04 -0800
Subject: appdb feature request: hide the ugly urls
In-Reply-To: <a71bd89a0802171613j206801e0yda55301d505979fa@mail.gmail.com>
References: <693989.83877.qm@web50103.mail.re2.yahoo.com>
	<a71bd89a0802171613j206801e0yda55301d505979fa@mail.gmail.com>
Message-ID: <a71bd89a0802171643k1e204cack4759f3821996e431@mail.gmail.com>

On Feb 17, 2008 4:13 PM, Dan Kegel <dank at kegel.com> wrote:
>> People need to be able to guess the URL.
>> We should be able to look up 'adobe-premiere' and get '128'.
>> So maybe http://appdb.winehq.org/app/adobe-premiere.html
>
> I don't think that would work all that well.
> As-is AppDB having all sorts of problem with it's search function.
> You want to break all the links as well?

No, of course not.  All the existing URLs should remain valid.

> How about games with a huge long name?
> Like "Command & Conquer 3: Tiberium Wars 1.x".

http://appdb.winehq.org/app/command-conquer-3-tiberium-wars/
doesn't sound too bad, actually.  And if somebody types in
an ambiguous URL, like
http://appdb.winehq.org/app/command-conquer
they should get a list of matching apps.  So this is kind of
like a search function rather than a unique ID.
The difference being that apps would normally be
displayed at their shortest unique human-readable URL
rather than by ID #.
This may have an obscure but important benefit: I
read on the web somewhere that it boosts search engine rankings.
(Not that I'd know; I'm way away from that part of google.)
- Dan


From wine-devel at kievinfo.com  Sun Feb 17 18:45:04 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 17 Feb 2008 17:45:04 -0700
Subject: appdb feature request: hide the ugly urls
In-Reply-To: <47B8D15F.4060103@kievinfo.com>
References: <693989.83877.qm@web50103.mail.re2.yahoo.com>	<a71bd89a0802171613j206801e0yda55301d505979fa@mail.gmail.com>
	<47B8CFC1.6020403@kievinfo.com> <47B8D15F.4060103@kievinfo.com>
Message-ID: <47B8D510.8090103@kievinfo.com>

Vitaliy wrote:
> Vitaliy Margolen wrote:
>> Dan Kegel wrote:
>>> On Feb 17, 2008 3:19 PM, Remco <remco47 at yahoo.com> wrote:
>>>>> Adobe Premiere is currently at
>>>>> http://appdb.winehq.org/objectManager.php?sClass=application&iId=128
>>>>> but it'd be so slick to see instead
>>>>> http://appdb.winehq.org/adobe/premiere
>>>> That's relatively easy to do with mod_rewrite. But it would have to 
>>>> be something like:
>>>>
>>>> http://appdb.winehq.org/app/128/adobe-premiere.html
>>>>
>>>> All the info is still in the URL (which mod_rewrite can extract), 
>>>> but it does look less scary.
>>> Not quite good enough.   People need to be able to guess the
>>> URL.  We should be able to look up 'adobe-premiere' and get '128'.
>>> So maybe http://appdb.winehq.org/app/adobe-premiere.html
>>> - Dan
>>>
>>>
>> I don't think that would work all that well. As-is AppDB having all 
>> sorts of problem with it's search function. You want to break all the 
>> links as well? Granted having all the links as some ID to some cryptic 
>> script is even worse.
>>
>> If you want the link to be a application's name, how about games with 
>> a huge long name? Like "Command & Conquer 3: Tiberium Wars 1.x". Is 
>> that easier to enter? I don't think so.
>>
>> IMHO just fixing the search and getting rid of all those banners in 
>> the search results would be much more helpful.
>>
> And while we are on the AppDB topic can someone finally add pages or add 
> at least one usable threads display mode? Any application with more then 
> 10 posts is impossible to read! And god forbid a thread having 5 replays 
> - then it's unusable at all regardless how you looking at it.
> 
> Vitaliy
> 

Now from the right address.

And while we are on the AppDB topic can someone finally add pages or add at 
least one usable threads display mode? Any application with more then 10 
posts is impossible to read! And god forbid a thread having 5 replays - then 
it's unusable at all regardless how you looking at it.

Vitaliy


From remco47 at yahoo.com  Sun Feb 17 19:33:33 2008
From: remco47 at yahoo.com (Remco)
Date: Sun, 17 Feb 2008 17:33:33 -0800 (PST)
Subject: appdb feature request: hide the ugly urls
Message-ID: <978778.42052.qm@web50107.mail.re2.yahoo.com>

> http://appdb.winehq.org/app/command-conquer-3-tiberium-wars/
> doesn't sound too bad, actually.  And if somebody types in
> an ambiguous URL, like
> http://appdb.winehq.org/app/command-conquer
> they should get a list of matching apps.  So this is kind of
> like a search function rather than a unique ID.
> The difference being that apps would normally be
> displayed at their shortest unique human-readable URL
> rather than by ID #.
> This may have an obscure but important benefit: I
> read on the web somewhere that it boosts search engine rankings.
> (Not that I'd know; I'm way away from that part of google.)
> - Dan

I'm pretty sure that's just because of the related words in the URL. An additional number doesn't hurt ranking. I know a lot of sites use an ID number and a title. The title makes it easy to see what the link points to. That's a usability benefit of itself. I don't think people should start using the URL bar as a search engine. The AppDB has a nice search engine already. And I think searching for literally all URLs is going to put a lot of strain on the server.

Remco
 



      ____________________________________________________________________________________
Never miss a thing.  Make Yahoo your home page. 
http://www.yahoo.com/r/hs


From remco47 at yahoo.com  Sun Feb 17 19:35:46 2008
From: remco47 at yahoo.com (Remco)
Date: Sun, 17 Feb 2008 17:35:46 -0800 (PST)
Subject: Usable Wine interface
Message-ID: <705362.282.qm@web50106.mail.re2.yahoo.com>

I'd like to add a feature-request (should this go somewhereelse?). What about making a Wine GUI to behave more like emulators likeVirtualBox. It's extremely hard right now to get Wine in desktop mode.It would be nice if you could start Wine as an application, which opensup a window like this:

http://xs224.xs.to/xs224/08081/mockup918.png (ignore the virtualbox-stuff)

And if you start one of those prefixes, it by default opens a WineDesktop with a simple Taskbar & Start-menu. Somewhere in theStart-menu could be the option to switch to desktop integration mode.There could also be an option to run the Wine Desktop full-screen. Likethis:

http://xs224.xs.to/xs224/08081/winedesktop771.png (forgive my GIMP skills)

I believe this would be very good for usability. Desktop mode is morestable than seamless mode, yet it's hidden in winecfg. This kind of UIalso exposes the prefix-functionality in a transparent way. Wouldn'tthat be a nice 1.0 polishing idea?

Remco



      ____________________________________________________________________________________
Never miss a thing.  Make Yahoo your home page. 
http://www.yahoo.com/r/hs


From remco47 at yahoo.com  Sun Feb 17 19:36:41 2008
From: remco47 at yahoo.com (Remco)
Date: Sun, 17 Feb 2008 17:36:41 -0800 (PST)
Subject: Next big app(s) to try?
Message-ID: <774769.43597.qm@web50101.mail.re2.yahoo.com>

I'd say, of the work-related apps, definitely MS Office 2007 (especially Outlook) and Internet Explorer 6 and 7. IE7 needs a lot of work still. IE6 doesn't break on any Wine bugs AFAIK, but needs a special environment to install correctly. A little Wine magic might help here. IE is one of the few native Windows parts that cannot reasonably be replaced. Web developers need to test their sites in the real thing.

Of the fun-related apps, a few press-generating apps would be Crysis DX10-mode and iTunes (iPod sync).

Remco



      ____________________________________________________________________________________
Never miss a thing.  Make Yahoo your home page. 
http://www.yahoo.com/r/hs


From chris.kcat at gmail.com  Sun Feb 17 20:09:46 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Sun, 17 Feb 2008 18:09:46 -0800
Subject: Usable Wine interface
In-Reply-To: <705362.282.qm@web50106.mail.re2.yahoo.com>
References: <705362.282.qm@web50106.mail.re2.yahoo.com>
Message-ID: <200802171809.47012.chris.kcat@gmail.com>

On Sunday 17 February 2008 05:35:46 pm Remco wrote:
> I'd like to add a feature-request (should this go somewhereelse?). What
> about making a Wine GUI to behave more like emulators likeVirtualBox. It's
> extremely hard right now to get Wine in desktop mode.

winecfg->Graphics->Emulate a virtual desktop (kind of a redundant option name) 
isn't that hard. Besides, I've actually had more problems with the virtual 
desktop because I had to use a smaller resolution, like 800x600, that some 
GUI apps don't tend to like (Google Earth for example, will complain and 
subsequent starts cause crashes because one of the window sizes went into the 
negative).

> It would be nice if 
> you could start Wine as an application, which opensup a window like this:
>
> http://xs224.xs.to/xs224/08081/mockup918.png (ignore the virtualbox-stuff)

IIRC, there was an app that managed Wine prefixes, wasn't there?

> And if you start one of those prefixes, it by default opens a WineDesktop
> with a simple Taskbar & Start-menu.

Wine doesn't have any shell programs. Though there are some Windows shell 
replacements floating around. If you set one of them into the Run registry 
key, it'll automatically start up with an app (except Run entries on startup 
are currently disabled..).


Personally, I think it's the wrong way to go. Wine is supposed to integrate 
with the X11 desktop, so users should be encouraged to use that (and get any 
integration bugs fixed). The virtual desktop is for when you really want to 
run an app, which won't work under non-virtual desktop mode (which I think 
there's fewer and fewer apps like that left). Some people might want it left 
in for fullscreen apps that they want run in a window, though.

My 2c...


From dank at kegel.com  Sun Feb 17 21:09:49 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 19:09:49 -0800
Subject: Next big app(s) to try?
In-Reply-To: <774769.43597.qm@web50101.mail.re2.yahoo.com>
References: <774769.43597.qm@web50101.mail.re2.yahoo.com>
Message-ID: <a71bd89a0802171909xefc0982wd7f7fda63a7b880b@mail.gmail.com>

On Feb 17, 2008 5:36 PM, Remco <remco47 at yahoo.com> wrote:
> I'd say, of the work-related apps, definitely MS Office 2007
> (especially Outlook) and Internet Explorer 6 and 7.

My assumption has been that Codeweavers is busily
working on MS Office etc. aready.

> Of the fun-related apps, a few press-generating apps
> would be Crysis DX10-mode and iTunes (iPod sync).

Yeah, getting iTunes working properly seems like a must.
- Dan


From arbuckle911 at gmail.com  Sun Feb 17 21:15:39 2008
From: arbuckle911 at gmail.com (Christopher Harvey)
Date: Sun, 17 Feb 2008 22:15:39 -0500
Subject: iTunes
Message-ID: <47B8F85B.2030703@gmail.com>

What needs to get done for iTunes to work?


From wine-devel at kievinfo.com  Sun Feb 17 21:16:17 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 17 Feb 2008 20:16:17 -0700
Subject: Usable Wine interface
In-Reply-To: <705362.282.qm@web50106.mail.re2.yahoo.com>
References: <705362.282.qm@web50106.mail.re2.yahoo.com>
Message-ID: <47B8F881.9090802@kievinfo.com>

Remco wrote:
> I'd like to add a feature-request (should this go somewhereelse?)
Yes, bugzilla -> enhancement.

Vitaliy.


From dank at kegel.com  Sun Feb 17 21:17:25 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 19:17:25 -0800
Subject: appdb feature request: hide the ugly urls
In-Reply-To: <978778.42052.qm@web50107.mail.re2.yahoo.com>
References: <978778.42052.qm@web50107.mail.re2.yahoo.com>
Message-ID: <a71bd89a0802171917i6840c731l4e16675f4600c632@mail.gmail.com>

On Feb 17, 2008 5:33 PM, Remco <remco47 at yahoo.com> wrote:
> I think searching for literally all URLs is going to put
> a lot of strain on the server.

Not if it's just a hash table lookup.
Note how Google is blindingly fast even though every
query is a search.  It's all due to the magic of hash tables...
and elves...
- Dan


From truiken at gmail.com  Sun Feb 17 21:23:53 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 17 Feb 2008 21:23:53 -0600
Subject: iTunes
In-Reply-To: <47B8F85B.2030703@gmail.com>
References: <47B8F85B.2030703@gmail.com>
Message-ID: <22821af30802171923h1badb3ebga9997454d2d12058@mail.gmail.com>

On Feb 17, 2008 9:15 PM, Christopher Harvey <arbuckle911 at gmail.com> wrote:
> What needs to get done for iTunes to work?
>

80% of bug fixing development is figuring out the answer to that
question.  If we knew all that was needed, it wouldn't take that long
to fix.  I'm not really sure what your motivation is for asking that
question, but assuming it's because you want to help out, you're
probably out of luck.  If you have to ask that question, you certainly
won't be able to fix it even if someone tells you what's needed.  If,
on the other hand, you just want to stir up the fire for developers to
focus on iTunes...well, most of us don't take too kindly to that.

-- 
James Hawkins


From dank at kegel.com  Sun Feb 17 21:42:15 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 19:42:15 -0800
Subject: How should we treat users on bugzilla?
Message-ID: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>

I've been seeing a lot of bugs closed as INVALID
when a poor user didn't file the bug perfectly.
IMHO this leads to Wine having a user-hostile reputation.

Case in point:
http://bugs.winehq.org/show_bug.cgi?id=11625

What can we do to reduce this kind of behavior?
Maybe we should have a "three warnings" sort of
policy.  If somebody continues to be rude to users
after being asked twice not to, we should consider
taking away their Bugzilla privileges for a while.
Sure, that would hurt our productivity, but it might
be better to do that than to alienate our users.

What do other people think?
- Dan


From m.b.lankhorst at gmail.com  Sun Feb 17 21:42:52 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 17 Feb 2008 19:42:52 -0800
Subject: iTunes
Message-ID: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>

Hi Christopher,

Christopher Harvey wrote:
> What needs to get done for iTunes to work?

v7.6 basically works if you set windows version to windows vista, and
find out why the installer fails to create the 'Bonjour service'
registry stuff properly.

I submitted 8 or so stub dll's to wine-patches that make iTunes v7.6
actually start after installation. It checks for the dll's and
silently fails if they don't exist.

I haven't done any further testing yet though, but it looks like it is
probably a small installer bug that prevents itunes v7.6 from
installing without first manually creating those registry keys.

Cheers,
Maarten.


From dmitry at codeweavers.com  Sun Feb 17 21:57:08 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 18 Feb 2008 11:57:08 +0800
Subject: [PATCH]  Environment variable to specify X11 window for desktop
References: <47B594E7.90501@siriushk.com> <47B5B3C9.7000308@codeweavers.com>
	<47B5D4C9.3000601@siriushk.com>
	<004f01c8709f$275e1f90$a600fea9@DMITRY>
	<47B8E4DC.8070001@siriushk.com>
Message-ID: <005401c871e2$56c8b1c0$a600fea9@DMITRY>

"Timothy Lee" <timothy.lee at siriushk.com> wrote:

>>>> I'm struggling to imagine a case where the behaviour you've 
>>>> implemented is useful.
>>> I'm actually using this code as the basis of a PowerPoint plugin 
>>> under Linux.
>> I little bit more information won't hurt. For instance why your plugin
>> needs to re-route the whole desktop window, and not just its own one.
> The patch was used in a browser plugin that uses PowerPoint Viewer 
> (97/2003/2007) and WINE to display PowerPoint slideshows.

It's still now clear to me what kind of plugin it is, and what it is
doing. You call it once "a PowerPoint plugin", and next time "a browser
plugin".

> While 
> developing the plugin, I've found that PowerPoint Viewer always playback 
> slides inside a window that covers the whole desktop.  Hence the idea 
> was born to embed the desktop inside a native X11 window.

An application plugin usually has access to the application internals in
some fashion, so I don't understand how that idea jumped from an application
window (where the plugin lives) to the whole desktop window (a separate
process).

> I thought this patch might be useful to others with similar 
> requirements, namely, to embed full-screen win32 applications inside a 
> native X11 window.

That kind of hack has nothing to do with Wine desktop window if what it
targets is just an application window.

-- 
Dmitry.


From remco47 at yahoo.com  Sun Feb 17 21:57:13 2008
From: remco47 at yahoo.com (Remco)
Date: Sun, 17 Feb 2008 19:57:13 -0800 (PST)
Subject: Usable Wine interface
Message-ID: <84536.27314.qm@web50106.mail.re2.yahoo.com>

----- Original Message ----
> From: Vitaliy Margolen <wine-devel at kievinfo.com>
> To: wine-devel at winehq.org
> Sent: Monday, February 18, 2008 4:16:17 AM
> Subject: Re: Usable Wine interface
> 
> Remco wrote:
> > I'd like to add a feature-request (should this go somewhereelse?)
> Yes, bugzilla -> enhancement.
> 
> Vitaliy.


Ok, thanks for the info. I added an entry: http://bugs.winehq.org/show_bug.cgi?id=11629

Remco



      ____________________________________________________________________________________
Looking for last minute shopping deals?  
Find them fast with Yahoo! Search.  http://tools.search.yahoo.com/newsearch/category.php?category=shopping


From truiken at gmail.com  Sun Feb 17 22:03:21 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 17 Feb 2008 22:03:21 -0600
Subject: iTunes
In-Reply-To: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
Message-ID: <22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>

On Feb 17, 2008 9:42 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> Hi Christopher,
>
> Christopher Harvey wrote:
> > What needs to get done for iTunes to work?
>
> v7.6 basically works if you set windows version to windows vista, and
> find out why the installer fails to create the 'Bonjour service'
> registry stuff properly.
>
> I submitted 8 or so stub dll's to wine-patches that make iTunes v7.6
> actually start after installation. It checks for the dll's and
> silently fails if they don't exist.
>
> I haven't done any further testing yet though, but it looks like it is
> probably a small installer bug that prevents itunes v7.6 from
> installing without first manually creating those registry keys.
>

The Bonjour service depends on the tcpip service.  As far as I know,
we don't provide that service.  What registry keys are you referring
to?

-- 
James Hawkins


From juan.lang at gmail.com  Sun Feb 17 22:16:34 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Sun, 17 Feb 2008 20:16:34 -0800
Subject: iTunes
In-Reply-To: <47B8F85B.2030703@gmail.com>
References: <47B8F85B.2030703@gmail.com>
Message-ID: <3a768c550802172016h38eb6bfdk32402380e5b80814@mail.gmail.com>

Hi Christopher,

> What needs to get done for iTunes to work?

As James said, it's a broad question.  Scan bugs.winehq.org for logged
bugs about iTunes.  Lots doesn't work, depending on which version of
iTunes you're interested in running.  Also check the appdb--this
probably isn't the right forum to be asking about it.
--Juan


From dmitry at codeweavers.com  Sun Feb 17 22:29:31 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 18 Feb 2008 12:29:31 +0800
Subject: [PATCH]  Environment variable to specify X11 window for desktop
References: <47B594E7.90501@siriushk.com> <47B5B3C9.7000308@codeweavers.com>
	<47B5D4C9.3000601@siriushk.com>
	<004f01c8709f$275e1f90$a600fea9@DMITRY>
	<47B8E4DC.8070001@siriushk.com>
	<005401c871e2$56c8b1c0$a600fea9@DMITRY>
	<47B90766.5040507@siriushk.com>
Message-ID: <016601c871e6$dd805110$a600fea9@DMITRY>

"Timothy Lee" <timothy.lee at siriushk.com> wrote:

>> That kind of hack has nothing to do with Wine desktop window if what it
>> targets is just an application window.
> Um.  How about if the scope of the patch is repharsed as "embedding the 
> Wine desktop inside an X11 window"?

Perhaps the most easy way for you to accomplish this would be write a
replacement for Wine's explorer. Have a look at programs/explorer/desktop.c
for ideas.

-- 
Dmitry.


From tlarhices at gmail.com  Sun Feb 17 22:35:58 2008
From: tlarhices at gmail.com (Tlarhices)
Date: Mon, 18 Feb 2008 13:35:58 +0900
Subject: How should we treat users on bugzilla?
In-Reply-To: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
Message-ID: <47B90B2E.8070703@gmail.com>

I think Wine is already considered has user-hostile.
In my opinion the main problem is that the bug tracker is too easy to 
find and the forum too hard to find. Also the forum could be a place to 
ask question without having to call it a bug but is only a simple 
discussion channel and totally inconvenient for a user to find / add 
questions / answers.
As wine is attracting more and more people, a place for the simple user 
which is afraid of compiling / command line / ... should be added. I 
think Ubuntu is a great example of 'normal' user and information management.
The forum could also be used to discuss out of wine source bugs and to 
keep solutions without perturbing the developers focusing on wine (Think 
of pulseaudio and wine, that problem will be recurrent has it is seems 
to be coming as a standard for many future distribution, ...).

Dan Kegel a ?crit :
> I've been seeing a lot of bugs closed as INVALID
> when a poor user didn't file the bug perfectly.
> IMHO this leads to Wine having a user-hostile reputation.
>
> Case in point:
> http://bugs.winehq.org/show_bug.cgi?id=11625
>
> What can we do to reduce this kind of behavior?
> Maybe we should have a "three warnings" sort of
> policy.  If somebody continues to be rude to users
> after being asked twice not to, we should consider
> taking away their Bugzilla privileges for a while.
> Sure, that would hurt our productivity, but it might
> be better to do that than to alienate our users.
>
> What do other people think?
> - Dan
>
>
>
>   


From jjmckenzie51 at sprintpcs.com  Sun Feb 17 22:53:31 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sun, 17 Feb 2008 21:53:31 -0700
Subject: How should we treat users on bugzilla?
In-Reply-To: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
Message-ID: <47B90F4B.4080103@sprintpcs.com>

Dan Kegel wrote:
> I've been seeing a lot of bugs closed as INVALID
> when a poor user didn't file the bug perfectly.
> IMHO this leads to Wine having a user-hostile reputation.
>
> Case in point:
> http://bugs.winehq.org/show_bug.cgi?id=11625
>
> What can we do to reduce this kind of behavior?
> Maybe we should have a "three warnings" sort of
> policy.  If somebody continues to be rude to users
> after being asked twice not to, we should consider
> taking away their Bugzilla privileges for a while.
> Sure, that would hurt our productivity, but it might
> be better to do that than to alienate our users.
>
> What do other people think?
> - Dan
>
>
>   
+1.  We need to have someone triage the bugs and link together those 
that are similar.  Marking issues IMMEDIATELY as INVALID shows users 
that we really don't care about their reports and gives them a negative 
impression.   Marking a bug as a duplicate, after confirmation, does 
show that we care and that the bugzilla is extremely hard to search 
through (this is and continues to be a major shortcoming of Bugzilla, 
not of the Wine/Mozilla projects and is a reason the company I work for 
did not adopt it.)

BTW, this bug appears to be related to the bug I'm working on a patch 
for.  It is issue 6254.

James



From m.b.lankhorst at gmail.com  Sun Feb 17 23:07:21 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 17 Feb 2008 21:07:21 -0800
Subject: iTunes
In-Reply-To: <22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>
Message-ID: <b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>

2008/2/17, James Hawkins <truiken at gmail.com>:
> On Feb 17, 2008 9:42 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > Hi Christopher,
> >
> > Christopher Harvey wrote:
> > > What needs to get done for iTunes to work?
> >
> > v7.6 basically works if you set windows version to windows vista, and
> > find out why the installer fails to create the 'Bonjour service'
> > registry stuff properly.
> >
> > I submitted 8 or so stub dll's to wine-patches that make iTunes v7.6
> > actually start after installation. It checks for the dll's and
> > silently fails if they don't exist.
> >
> > I haven't done any further testing yet though, but it looks like it is
> > probably a small installer bug that prevents itunes v7.6 from
> > installing without first manually creating those registry keys.
> >
>
> The Bonjour service depends on the tcpip service.  As far as I know,
> we don't provide that service.  What registry keys are you referring
> to?
Keys like:
In HKLM\SYSTEM\CurrentControlSet\Services\Bonjour Service:
ImagePath="C:\...."
Start=0x00000002
Description="....."

Those are not created during install. If I manually add them the
'bonjour service' will report success on start, but actually crash
right after. However it is enough to satisfy the itunes installer.
Without those it will report failure without even attempting to start
the service. :-)

Cheers,
Maarten.


From truiken at gmail.com  Sun Feb 17 23:11:56 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 17 Feb 2008 23:11:56 -0600
Subject: iTunes
In-Reply-To: <b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>
	<b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>
Message-ID: <22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>

On Feb 17, 2008 11:07 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> 2008/2/17, James Hawkins <truiken at gmail.com>:
>
> > On Feb 17, 2008 9:42 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > > Hi Christopher,
> > >
> > > Christopher Harvey wrote:
> > > > What needs to get done for iTunes to work?
> > >
> > > v7.6 basically works if you set windows version to windows vista, and
> > > find out why the installer fails to create the 'Bonjour service'
> > > registry stuff properly.
> > >
> > > I submitted 8 or so stub dll's to wine-patches that make iTunes v7.6
> > > actually start after installation. It checks for the dll's and
> > > silently fails if they don't exist.
> > >
> > > I haven't done any further testing yet though, but it looks like it is
> > > probably a small installer bug that prevents itunes v7.6 from
> > > installing without first manually creating those registry keys.
> > >
> >
> > The Bonjour service depends on the tcpip service.  As far as I know,
> > we don't provide that service.  What registry keys are you referring
> > to?
> Keys like:
> In HKLM\SYSTEM\CurrentControlSet\Services\Bonjour Service:
> ImagePath="C:\...."
> Start=0x00000002
> Description="....."
>
> Those are not created during install. If I manually add them the
> 'bonjour service' will report success on start, but actually crash
> right after. However it is enough to satisfy the itunes installer.
> Without those it will report failure without even attempting to start
> the service. :-)
>

hmm according to the logs, the service is installed just fine.  You'd
get an err otherwise.  The dependencies aren't listed, but since we
don't have the tcpip service anyway, it won't make a difference
(though that might be why it crashes when you get the service to
start.)

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Sun Feb 17 23:16:31 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 17 Feb 2008 21:16:31 -0800
Subject: iTunes
In-Reply-To: <22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>
	<b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>
	<22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>
Message-ID: <b130c85e0802172116n40bb2b01h55e76989ca0c7c5d@mail.gmail.com>

Hi James,

2008/2/17, James Hawkins <truiken at gmail.com>:
> On Feb 17, 2008 11:07 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > 2008/2/17, James Hawkins <truiken at gmail.com>:
> >
> > > On Feb 17, 2008 9:42 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > > > Hi Christopher,
> > > >
> > > > Christopher Harvey wrote:
> > > > > What needs to get done for iTunes to work?
> > > >
> > > > v7.6 basically works if you set windows version to windows vista, and
> > > > find out why the installer fails to create the 'Bonjour service'
> > > > registry stuff properly.
> > > >
> > > > I submitted 8 or so stub dll's to wine-patches that make iTunes v7.6
> > > > actually start after installation. It checks for the dll's and
> > > > silently fails if they don't exist.
> > > >
> > > > I haven't done any further testing yet though, but it looks like it is
> > > > probably a small installer bug that prevents itunes v7.6 from
> > > > installing without first manually creating those registry keys.
> > > >
> > >
> > > The Bonjour service depends on the tcpip service.  As far as I know,
> > > we don't provide that service.  What registry keys are you referring
> > > to?
> > Keys like:
> > In HKLM\SYSTEM\CurrentControlSet\Services\Bonjour Service:
> > ImagePath="C:\...."
> > Start=0x00000002
> > Description="....."
> >
> > Those are not created during install. If I manually add them the
> > 'bonjour service' will report success on start, but actually crash
> > right after. However it is enough to satisfy the itunes installer.
> > Without those it will report failure without even attempting to start
> > the service. :-)
> >
>
> hmm according to the logs, the service is installed just fine.  You'd
> get an err otherwise.  The dependencies aren't listed, but since we
> don't have the tcpip service anyway, it won't make a difference
> (though that might be why it crashes when you get the service to
> start.)
There is a big difference. Without it it will abort installation
because the bonjour service fails to start. With it it will start but
immediately crash, however that happens after start so installation
happily continues. The effect is that installer will continue. I don't
see how it can be fine if it fails to create the appropiate registry
keys.

Cheers,
Maarten.


From epssyis at gmail.com  Sun Feb 17 23:17:14 2008
From: epssyis at gmail.com (Edward Savage)
Date: Mon, 18 Feb 2008 15:17:14 +1000
Subject: iTunes
In-Reply-To: <22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>
	<b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>
	<22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>
Message-ID: <d6c5d7290802172117r603eda76v714a8935171169a4@mail.gmail.com>

Why are we interested in iTunes? There seem to be plenty of alternatives
available.

Or are we talking about ipod compatibility specifically, as there are no
viable alternatives to iTunes for syncing.

Edward

On Feb 18, 2008 3:11 PM, James Hawkins <truiken at gmail.com> wrote:

> On Feb 17, 2008 11:07 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com>
> wrote:
> > 2008/2/17, James Hawkins <truiken at gmail.com>:
> >
> > > On Feb 17, 2008 9:42 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com>
> wrote:
> > > > Hi Christopher,
> > > >
> > > > Christopher Harvey wrote:
> > > > > What needs to get done for iTunes to work?
> > > >
> > > > v7.6 basically works if you set windows version to windows vista,
> and
> > > > find out why the installer fails to create the 'Bonjour service'
> > > > registry stuff properly.
> > > >
> > > > I submitted 8 or so stub dll's to wine-patches that make iTunes v7.6
> > > > actually start after installation. It checks for the dll's and
> > > > silently fails if they don't exist.
> > > >
> > > > I haven't done any further testing yet though, but it looks like it
> is
> > > > probably a small installer bug that prevents itunes v7.6 from
> > > > installing without first manually creating those registry keys.
> > > >
> > >
> > > The Bonjour service depends on the tcpip service.  As far as I know,
> > > we don't provide that service.  What registry keys are you referring
> > > to?
> > Keys like:
> > In HKLM\SYSTEM\CurrentControlSet\Services\Bonjour Service:
> > ImagePath="C:\...."
> > Start=0x00000002
> > Description="....."
> >
> > Those are not created during install. If I manually add them the
> > 'bonjour service' will report success on start, but actually crash
> > right after. However it is enough to satisfy the itunes installer.
> > Without those it will report failure without even attempting to start
> > the service. :-)
> >
>
> hmm according to the logs, the service is installed just fine.  You'd
> get an err otherwise.  The dependencies aren't listed, but since we
> don't have the tcpip service anyway, it won't make a difference
> (though that might be why it crashes when you get the service to
> start.)
>
> --
> James Hawkins
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080218/fddc213b/attachment.htm 

From m.b.lankhorst at gmail.com  Sun Feb 17 23:18:20 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 17 Feb 2008 21:18:20 -0800
Subject: iTunes
In-Reply-To: <d6c5d7290802172117r603eda76v714a8935171169a4@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>
	<b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>
	<22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>
	<d6c5d7290802172117r603eda76v714a8935171169a4@mail.gmail.com>
Message-ID: <b130c85e0802172118x770adbe9vdc8510ecbc410f76@mail.gmail.com>

Hi Edward,

2008/2/17, Edward Savage <epssyis at gmail.com>:
> Why are we interested in iTunes? There seem to be plenty of alternatives
> available.
>
> Or are we talking about ipod compatibility specifically, as there are no
> viable alternatives to iTunes for syncing.
Because this is a project that runs windows apps in linux, instead of
writing alternatives for it? ;-)

Cheers,
Maarten.


From truiken at gmail.com  Sun Feb 17 23:20:36 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 17 Feb 2008 23:20:36 -0600
Subject: iTunes
In-Reply-To: <b130c85e0802172116n40bb2b01h55e76989ca0c7c5d@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>
	<b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>
	<22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>
	<b130c85e0802172116n40bb2b01h55e76989ca0c7c5d@mail.gmail.com>
Message-ID: <22821af30802172120y3eab91b3je6ba0b0c31d7fc44@mail.gmail.com>

On Feb 17, 2008 11:16 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> Hi James,
>
>
> 2008/2/17, James Hawkins <truiken at gmail.com>:
> > On Feb 17, 2008 11:07 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > > 2008/2/17, James Hawkins <truiken at gmail.com>:
> > >
> > > > On Feb 17, 2008 9:42 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > > > > Hi Christopher,
> > > > >
> > > > > Christopher Harvey wrote:
> > > > > > What needs to get done for iTunes to work?
> > > > >
> > > > > v7.6 basically works if you set windows version to windows vista, and
> > > > > find out why the installer fails to create the 'Bonjour service'
> > > > > registry stuff properly.
> > > > >
> > > > > I submitted 8 or so stub dll's to wine-patches that make iTunes v7.6
> > > > > actually start after installation. It checks for the dll's and
> > > > > silently fails if they don't exist.
> > > > >
> > > > > I haven't done any further testing yet though, but it looks like it is
> > > > > probably a small installer bug that prevents itunes v7.6 from
> > > > > installing without first manually creating those registry keys.
> > > > >
> > > >
> > > > The Bonjour service depends on the tcpip service.  As far as I know,
> > > > we don't provide that service.  What registry keys are you referring
> > > > to?
> > > Keys like:
> > > In HKLM\SYSTEM\CurrentControlSet\Services\Bonjour Service:
> > > ImagePath="C:\...."
> > > Start=0x00000002
> > > Description="....."
> > >
> > > Those are not created during install. If I manually add them the
> > > 'bonjour service' will report success on start, but actually crash
> > > right after. However it is enough to satisfy the itunes installer.
> > > Without those it will report failure without even attempting to start
> > > the service. :-)
> > >
> >
> > hmm according to the logs, the service is installed just fine.  You'd
> > get an err otherwise.  The dependencies aren't listed, but since we
> > don't have the tcpip service anyway, it won't make a difference
> > (though that might be why it crashes when you get the service to
> > start.)
> There is a big difference. Without it it will abort installation
> because the bonjour service fails to start. With it it will start but
> immediately crash, however that happens after start so installation
> happily continues. The effect is that installer will continue. I don't
> see how it can be fine if it fails to create the appropiate registry
> keys.
>

I'm not saying it's not.  I'm saying that the call to CreateService
doesn't fail, or you'd get an err, like I said before.

    service = CreateServiceW(hscm, name, disp, GENERIC_ALL, serv_type,
                             start_type, err_control, file->TargetPath,
                             load_order, NULL, NULL, serv_name, pass);
    if (!service)
    {
        if (GetLastError() != ERROR_SERVICE_EXISTS)
            ERR("Failed to create service %s: %d\n", debugstr_w(name),
GetLastError());
    }

I'm not saying there's not a bug in CreateServiceW, but as it stands,
we don't get a failure.

-- 
James Hawkins


From epssyis at gmail.com  Sun Feb 17 23:34:04 2008
From: epssyis at gmail.com (Edward Savage)
Date: Mon, 18 Feb 2008 15:34:04 +1000
Subject: iTunes
In-Reply-To: <b130c85e0802172118x770adbe9vdc8510ecbc410f76@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>
	<b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>
	<22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>
	<d6c5d7290802172117r603eda76v714a8935171169a4@mail.gmail.com>
	<b130c85e0802172118x770adbe9vdc8510ecbc410f76@mail.gmail.com>
Message-ID: <d6c5d7290802172134h1c2745aav917531221ff227ca@mail.gmail.com>

Maarten why not focus on supporting applications that don't have viable open
source solutions first? I can think of hundreds.

The only thing iTunes will add, with full support, is ipod syncing (that
isn't useless).

Or should we avoid that debate?

On Feb 18, 2008 3:18 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:

> Hi Edward,
>
> 2008/2/17, Edward Savage <epssyis at gmail.com>:
> > Why are we interested in iTunes? There seem to be plenty of alternatives
> > available.
> >
> > Or are we talking about ipod compatibility specifically, as there are no
> > viable alternatives to iTunes for syncing.
> Because this is a project that runs windows apps in linux, instead of
> writing alternatives for it? ;-)
>
> Cheers,
> Maarten.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080218/0cf80aab/attachment.htm 

From m.b.lankhorst at gmail.com  Sun Feb 17 23:39:05 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 17 Feb 2008 21:39:05 -0800
Subject: iTunes
In-Reply-To: <22821af30802172120y3eab91b3je6ba0b0c31d7fc44@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>
	<b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>
	<22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>
	<b130c85e0802172116n40bb2b01h55e76989ca0c7c5d@mail.gmail.com>
	<22821af30802172120y3eab91b3je6ba0b0c31d7fc44@mail.gmail.com>
Message-ID: <b130c85e0802172139p1f0acfe8r69431019a09b5c85@mail.gmail.com>

Hi James,

2008/2/17, James Hawkins <truiken at gmail.com>:
> On Feb 17, 2008 11:16 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > Hi James,
> >
> >
> > 2008/2/17, James Hawkins <truiken at gmail.com>:
> > > On Feb 17, 2008 11:07 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > > > 2008/2/17, James Hawkins <truiken at gmail.com>:
> > > >
> > > > > On Feb 17, 2008 9:42 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > > > > > Hi Christopher,
> > > > > >
> > > > > > Christopher Harvey wrote:
> > > > > > > What needs to get done for iTunes to work?
> > > > > >
> > > > > > v7.6 basically works if you set windows version to windows vista, and
> > > > > > find out why the installer fails to create the 'Bonjour service'
> > > > > > registry stuff properly.
> > > > > >
> > > > > > I submitted 8 or so stub dll's to wine-patches that make iTunes v7.6
> > > > > > actually start after installation. It checks for the dll's and
> > > > > > silently fails if they don't exist.
> > > > > >
> > > > > > I haven't done any further testing yet though, but it looks like it is
> > > > > > probably a small installer bug that prevents itunes v7.6 from
> > > > > > installing without first manually creating those registry keys.
> > > > > >
> > > > >
> > > > > The Bonjour service depends on the tcpip service.  As far as I know,
> > > > > we don't provide that service.  What registry keys are you referring
> > > > > to?
> > > > Keys like:
> > > > In HKLM\SYSTEM\CurrentControlSet\Services\Bonjour Service:
> > > > ImagePath="C:\...."
> > > > Start=0x00000002
> > > > Description="....."
> > > >
> > > > Those are not created during install. If I manually add them the
> > > > 'bonjour service' will report success on start, but actually crash
> > > > right after. However it is enough to satisfy the itunes installer.
> > > > Without those it will report failure without even attempting to start
> > > > the service. :-)
> > > >
> > >
> > > hmm according to the logs, the service is installed just fine.  You'd
> > > get an err otherwise.  The dependencies aren't listed, but since we
> > > don't have the tcpip service anyway, it won't make a difference
> > > (though that might be why it crashes when you get the service to
> > > start.)
> > There is a big difference. Without it it will abort installation
> > because the bonjour service fails to start. With it it will start but
> > immediately crash, however that happens after start so installation
> > happily continues. The effect is that installer will continue. I don't
> > see how it can be fine if it fails to create the appropiate registry
> > keys.
> >
>
> I'm not saying it's not.  I'm saying that the call to CreateService
> doesn't fail, or you'd get an err, like I said before.
>
>     service = CreateServiceW(hscm, name, disp, GENERIC_ALL, serv_type,
>                              start_type, err_control, file->TargetPath,
>                              load_order, NULL, NULL, serv_name, pass);
>     if (!service)
>     {
>         if (GetLastError() != ERROR_SERVICE_EXISTS)
>             ERR("Failed to create service %s: %d\n", debugstr_w(name),
> GetLastError());
>     }
>
> I'm not saying there's not a bug in CreateServiceW, but as it stands,
> we don't get a failure.
You can try for yourself at the following link:
http://www.apple.com/downloads/macosx/apple/windows/bonjourforwindows.html

Or try iTunes v7.6 directly.

It could also be that it never calls CreateService for some reason,
I'm not 100% sure.

Cheers,
Maarten.


From truiken at gmail.com  Sun Feb 17 23:42:45 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 17 Feb 2008 23:42:45 -0600
Subject: iTunes
In-Reply-To: <b130c85e0802172139p1f0acfe8r69431019a09b5c85@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>
	<b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>
	<22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>
	<b130c85e0802172116n40bb2b01h55e76989ca0c7c5d@mail.gmail.com>
	<22821af30802172120y3eab91b3je6ba0b0c31d7fc44@mail.gmail.com>
	<b130c85e0802172139p1f0acfe8r69431019a09b5c85@mail.gmail.com>
Message-ID: <22821af30802172142l5e3283aey6e32487d982955be@mail.gmail.com>

On Feb 17, 2008 11:39 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
>
> Hi James,
>
> 2008/2/17, James Hawkins <truiken at gmail.com>:
> > On Feb 17, 2008 11:16 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > > Hi James,
> > >
> > >
> > > 2008/2/17, James Hawkins <truiken at gmail.com>:
> > > > On Feb 17, 2008 11:07 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > > > > 2008/2/17, James Hawkins <truiken at gmail.com>:
> > > > >
> > > > > > On Feb 17, 2008 9:42 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > > > > > > Hi Christopher,
> > > > > > >
> > > > > > > Christopher Harvey wrote:
> > > > > > > > What needs to get done for iTunes to work?
> > > > > > >
> > > > > > > v7.6 basically works if you set windows version to windows vista, and
> > > > > > > find out why the installer fails to create the 'Bonjour service'
> > > > > > > registry stuff properly.
> > > > > > >
> > > > > > > I submitted 8 or so stub dll's to wine-patches that make iTunes v7.6
> > > > > > > actually start after installation. It checks for the dll's and
> > > > > > > silently fails if they don't exist.
> > > > > > >
> > > > > > > I haven't done any further testing yet though, but it looks like it is
> > > > > > > probably a small installer bug that prevents itunes v7.6 from
> > > > > > > installing without first manually creating those registry keys.
> > > > > > >
> > > > > >
> > > > > > The Bonjour service depends on the tcpip service.  As far as I know,
> > > > > > we don't provide that service.  What registry keys are you referring
> > > > > > to?
> > > > > Keys like:
> > > > > In HKLM\SYSTEM\CurrentControlSet\Services\Bonjour Service:
> > > > > ImagePath="C:\...."
> > > > > Start=0x00000002
> > > > > Description="....."
> > > > >
> > > > > Those are not created during install. If I manually add them the
> > > > > 'bonjour service' will report success on start, but actually crash
> > > > > right after. However it is enough to satisfy the itunes installer.
> > > > > Without those it will report failure without even attempting to start
> > > > > the service. :-)
> > > > >
> > > >
> > > > hmm according to the logs, the service is installed just fine.  You'd
> > > > get an err otherwise.  The dependencies aren't listed, but since we
> > > > don't have the tcpip service anyway, it won't make a difference
> > > > (though that might be why it crashes when you get the service to
> > > > start.)
> > > There is a big difference. Without it it will abort installation
> > > because the bonjour service fails to start. With it it will start but
> > > immediately crash, however that happens after start so installation
> > > happily continues. The effect is that installer will continue. I don't
> > > see how it can be fine if it fails to create the appropiate registry
> > > keys.
> > >
> >
> > I'm not saying it's not.  I'm saying that the call to CreateService
> > doesn't fail, or you'd get an err, like I said before.
> >
> >     service = CreateServiceW(hscm, name, disp, GENERIC_ALL, serv_type,
> >                              start_type, err_control, file->TargetPath,
> >                              load_order, NULL, NULL, serv_name, pass);
> >     if (!service)
> >     {
> >         if (GetLastError() != ERROR_SERVICE_EXISTS)
> >             ERR("Failed to create service %s: %d\n", debugstr_w(name),
> > GetLastError());
> >     }
> >
> > I'm not saying there's not a bug in CreateServiceW, but as it stands,
> > we don't get a failure.
> You can try for yourself at the following link:
> http://www.apple.com/downloads/macosx/apple/windows/bonjourforwindows.html
>
> Or try iTunes v7.6 directly.
>
> It could also be that it never calls CreateService for some reason,
> I'm not 100% sure.
>

I already have tried it; that's how I know the call doesn't fail.  Yes
it does call CreateService.  All the error paths in
ITERATE_InstallService have ERRs, so you'd see it if it did fail.

-- 
James Hawkins


From dank at kegel.com  Sun Feb 17 23:45:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 21:45:18 -0800
Subject: Winnowing the 1.0 bug list
Message-ID: <a71bd89a0802172145m65686ae8w2be35a8bc8185896@mail.gmail.com>

We now have about 100 bugs nominated for fixing in 1.0.
Thanks to everybody who nominated bugs.

Now it's time to winnow the list a bit.  1.0 bugs should
be 'important' somehow, easy to reproduce, and
have some chance of actually being fixed by, say, summer.
The better understood a bug is, the more likely it is
it can be fixed for 1.0, so even less important bugs
can be 1.0 bugs if they're well enough understood and
a patch is available.

Here are a few bugs I'm thinking of deferring, and why:

Not important enough
http://bugs.winehq.org/show_bug.cgi?id=5807 Mercora IMRadio crashes
http://bugs.winehq.org/show_bug.cgi?id=6048 Stokes crashes
http://bugs.winehq.org/show_bug.cgi?id=8687 everestpoker and
Programmer's Editor don't work
http://bugs.winehq.org/show_bug.cgi?id=9288 Armed Assault doesn't load web page
http://bugs.winehq.org/show_bug.cgi?id=9895 Alzip crashes

Probably not doable by summer
http://bugs.winehq.org/show_bug.cgi?id=609 Add BiDi support

Not well enough understood:
http://bugs.winehq.org/show_bug.cgi?id=6383 Dual-core not being
correctly supported

Do people agree with those assessments, and are there other
bugs nominated for 1.0 that don't quite deserve it?
- Dan


From dank at kegel.com  Sun Feb 17 23:56:15 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 21:56:15 -0800
Subject: iTunes
Message-ID: <a71bd89a0802172156r494fa035h5feee1e772ad9577@mail.gmail.com>

E. Savage wrote:
> Maarten why not focus on supporting applications that
> don't have viable open source solutions first?

iTunes doesn't have any alternatives for these functions:
- purchasing songs from iTunes Store
- activating iPhone
- new ipod/iPhone syncing

Anybody who buys an iPhone and can't activate
it on their Linux PC will blame Linux and think it's crap.
Even developers like jwz, I bet; see
http://jwz.livejournal.com/494040.html

So yeah, iTunes is important.
- Dan


From dank at kegel.com  Mon Feb 18 00:01:21 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 17 Feb 2008 22:01:21 -0800
Subject: How should we treat users on bugzilla?
In-Reply-To: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
Message-ID: <a71bd89a0802172201m6ec55fedy2488ce62a03ffc04@mail.gmail.com>

Tlarhices wrote:
> In my opinion the main problem is that the bug tracker is too easy to
> find and the forum too hard to find.

The appdb is our forum, and it's quite easy to find.

I do agree it could use some interface improvements.
For instance, I think the front page is too crowded.

Also, the 'browse by rating' feature (thanks for adding it!)
needs to list apps sorted by name; the current seemingly-random
sort order isn't very useful.
- Dan


From epssyis at gmail.com  Mon Feb 18 00:14:38 2008
From: epssyis at gmail.com (Edward Savage)
Date: Mon, 18 Feb 2008 16:14:38 +1000
Subject: iTunes
In-Reply-To: <a71bd89a0802172156r494fa035h5feee1e772ad9577@mail.gmail.com>
References: <a71bd89a0802172156r494fa035h5feee1e772ad9577@mail.gmail.com>
Message-ID: <d6c5d7290802172214n3e2ce819v53bfc0a94dad0528@mail.gmail.com>

Assuming syncing is the primary push behind this (or ends up being
done either way) I support iTunes being supports.  Though if people go
to a lot of effort on this and those features aren't implemented I
would consider this a waste of time.  For the person who does fix ipod
syncing I thank you very much.

Edward

On Feb 18, 2008 3:56 PM, Dan Kegel <dank at kegel.com> wrote:
> E. Savage wrote:
> > Maarten why not focus on supporting applications that
> > don't have viable open source solutions first?
>
> iTunes doesn't have any alternatives for these functions:
> - purchasing songs from iTunes Store
> - activating iPhone
> - new ipod/iPhone syncing
>
> Anybody who buys an iPhone and can't activate
> it on their Linux PC will blame Linux and think it's crap.
> Even developers like jwz, I bet; see
> http://jwz.livejournal.com/494040.html
>
> So yeah, iTunes is important.
> - Dan
>
>
>


From epssyis at gmail.com  Mon Feb 18 00:54:57 2008
From: epssyis at gmail.com (Edward Savage)
Date: Mon, 18 Feb 2008 16:54:57 +1000
Subject: Usable Wine interface
In-Reply-To: <84536.27314.qm@web50106.mail.re2.yahoo.com>
References: <84536.27314.qm@web50106.mail.re2.yahoo.com>
Message-ID: <d6c5d7290802172254v78b40728k4bad6b61a0f18b6d@mail.gmail.com>

I would very much like to see a --spawn-new trigger that can be added
to a command to start a new virtual desktop.

At the moment my default setting is a virtual desktop for everything
and I believe this is the current wine default.  My issue is that
every application comes into that virtual desktop and you cannot alt
tab between them.  This is an issue when you have three full screen
games running at once and I really don't want to go making custom
settings for all of them.

Edward

On Feb 18, 2008 1:57 PM, Remco <remco47 at yahoo.com> wrote:
>
> ----- Original Message ----
> > From: Vitaliy Margolen <wine-devel at kievinfo.com>
> > To: wine-devel at winehq.org
> > Sent: Monday, February 18, 2008 4:16:17 AM
> > Subject: Re: Usable Wine interface
> >
> > Remco wrote:
> > > I'd like to add a feature-request (should this go somewhereelse?)
> > Yes, bugzilla -> enhancement.
> >
> > Vitaliy.
>
>
> Ok, thanks for the info. I added an entry: http://bugs.winehq.org/show_bug.cgi?id=11629
>
> Remco
>
>
>
>       ____________________________________________________________________________________
> Looking for last minute shopping deals?
> Find them fast with Yahoo! Search.  http://tools.search.yahoo.com/newsearch/category.php?category=shopping
>
>
>


From dmitry at codeweavers.com  Mon Feb 18 01:30:30 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 18 Feb 2008 15:30:30 +0800
Subject: Usable Wine interface
References: <84536.27314.qm@web50106.mail.re2.yahoo.com>
	<d6c5d7290802172254v78b40728k4bad6b61a0f18b6d@mail.gmail.com>
Message-ID: <000a01c87200$2601fc90$a600fea9@DMITRY>

"Edward Savage" <epssyis at gmail.com> wrote:

> I would very much like to see a --spawn-new trigger that can be added
> to a command to start a new virtual desktop.
> 
> At the moment my default setting is a virtual desktop for everything
> and I believe this is the current wine default.

No, it is not.

> My issue is that
> every application comes into that virtual desktop and you cannot alt
> tab between them.  This is an issue when you have three full screen
> games running at once and I really don't want to go making custom
> settings for all of them.

What's the purpose of running 3 full screen games simultaneously?
Perhaps you have to run them with different wine prefixes then.

-- 
Dmitry.


From frick at sc-networks.de  Mon Feb 18 01:48:08 2008
From: frick at sc-networks.de (Christoph Frick)
Date: Mon, 18 Feb 2008 08:48:08 +0100
Subject: Usable Wine interface
In-Reply-To: <000a01c87200$2601fc90$a600fea9@DMITRY>
References: <84536.27314.qm@web50106.mail.re2.yahoo.com>
	<d6c5d7290802172254v78b40728k4bad6b61a0f18b6d@mail.gmail.com>
	<000a01c87200$2601fc90$a600fea9@DMITRY>
Message-ID: <20080218074808.GA353@byleth.sc-networks.de>

On Mon, Feb 18, 2008 at 03:30:30PM +0800, Dmitry Timoshkov wrote:

> What's the purpose of running 3 full screen games simultaneously?
> Perhaps you have to run them with different wine prefixes then.

i run all my games in a desktop as big as the root window. this is a
must for the game Grand Prix Legends and i grew acustomed to it. i can
change to other apps/desktops without screen-res-changes or similar
stuff - and there are games out there, that do not need 100% attention -
playing Heroes Of Might And Magic mulitplayer comes into my mind here.

-- 
cu
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 163 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080218/82cba654/attachment.pgp 

From dmitry at codeweavers.com  Mon Feb 18 02:55:42 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 18 Feb 2008 16:55:42 +0800
Subject: user32: Check for .ico and .cur magic.
References: <689de9370802180006s1fdc8084qa7c2e0958a9a9adf@mail.gmail.com>
Message-ID: <001f01c8720c$0cfde900$a600fea9@DMITRY>

"Andrew Riedi" <andrewriedi at gmail.com> wrote:

> +#define ICON_DIB_SIZE 4264

It would be helpful to actually calculate the size instead of hardcoding
the magic value.

> +    handle = LoadImageA(NULL, "icon.ico", IMAGE_CURSOR, 0, 0, LR_LOADFROMFILE);
> +    ok(handle != NULL, "LoadImage() failed.\n");
> +    error = GetLastError();
> +    ok(error == 0, "Last error: %u\n", error);
> +    
> +    /* Clean up. */
> +    ret = DestroyIcon(handle);

The fact that LoadImage has returned a not zero handle actually confirms
nothing, you need to verify the contents of the loaded image with GetIconInfo.

-- 
Dmitry.


From vitaliy at kievinfo.com  Sun Feb 17 18:29:19 2008
From: vitaliy at kievinfo.com (Vitaliy)
Date: Sun, 17 Feb 2008 17:29:19 -0700
Subject: appdb feature request: hide the ugly urls
In-Reply-To: <47B8CFC1.6020403@kievinfo.com>
References: <693989.83877.qm@web50103.mail.re2.yahoo.com>	<a71bd89a0802171613j206801e0yda55301d505979fa@mail.gmail.com>
	<47B8CFC1.6020403@kievinfo.com>
Message-ID: <47B8D15F.4060103@kievinfo.com>

Vitaliy Margolen wrote:
> Dan Kegel wrote:
>> On Feb 17, 2008 3:19 PM, Remco <remco47 at yahoo.com> wrote:
>>>> Adobe Premiere is currently at
>>>> http://appdb.winehq.org/objectManager.php?sClass=application&iId=128
>>>> but it'd be so slick to see instead
>>>> http://appdb.winehq.org/adobe/premiere
>>> That's relatively easy to do with mod_rewrite. But it would have to be something like:
>>>
>>> http://appdb.winehq.org/app/128/adobe-premiere.html
>>>
>>> All the info is still in the URL (which mod_rewrite can extract), but it does look less scary.
>> Not quite good enough.   People need to be able to guess the
>> URL.  We should be able to look up 'adobe-premiere' and get '128'.
>> So maybe http://appdb.winehq.org/app/adobe-premiere.html
>> - Dan
>>
>>
> I don't think that would work all that well. As-is AppDB having all sorts of 
> problem with it's search function. You want to break all the links as well? 
> Granted having all the links as some ID to some cryptic script is even worse.
> 
> If you want the link to be a application's name, how about games with a huge 
> long name? Like "Command & Conquer 3: Tiberium Wars 1.x". Is that easier to 
> enter? I don't think so.
> 
> IMHO just fixing the search and getting rid of all those banners in the 
> search results would be much more helpful.
> 
And while we are on the AppDB topic can someone finally add pages or add at 
least one usable threads display mode? Any application with more then 10 
posts is impossible to read! And god forbid a thread having 5 replays - then 
it's unusable at all regardless how you looking at it.

Vitaliy


From timothy.lee at siriushk.com  Sun Feb 17 19:52:28 2008
From: timothy.lee at siriushk.com (Timothy Lee)
Date: Mon, 18 Feb 2008 09:52:28 +0800
Subject: [PATCH]  Environment variable to specify X11 window for desktop
In-Reply-To: <004f01c8709f$275e1f90$a600fea9@DMITRY>
References: <47B594E7.90501@siriushk.com> <47B5B3C9.7000308@codeweavers.com>
	<47B5D4C9.3000601@siriushk.com>
	<004f01c8709f$275e1f90$a600fea9@DMITRY>
Message-ID: <47B8E4DC.8070001@siriushk.com>

Dear Dmitry,

Dmitry Timoshkov wrote:
>>> I'm struggling to imagine a case where the behaviour you've 
>>> implemented is useful.
>> I'm actually using this code as the basis of a PowerPoint plugin 
>> under Linux.
> I little bit more information won't hurt. For instance why your plugin
> needs to re-route the whole desktop window, and not just its own one.
The patch was used in a browser plugin that uses PowerPoint Viewer 
(97/2003/2007) and WINE to display PowerPoint slideshows.  While 
developing the plugin, I've found that PowerPoint Viewer always playback 
slides inside a window that covers the whole desktop.  Hence the idea 
was born to embed the desktop inside a native X11 window.

I thought this patch might be useful to others with similar 
requirements, namely, to embed full-screen win32 applications inside a 
native X11 window.

Regards,
Timothy Lee


From timothy.lee at siriushk.com  Sun Feb 17 22:19:50 2008
From: timothy.lee at siriushk.com (Timothy Lee)
Date: Mon, 18 Feb 2008 12:19:50 +0800
Subject: [PATCH]  Environment variable to specify X11 window for desktop
In-Reply-To: <005401c871e2$56c8b1c0$a600fea9@DMITRY>
References: <47B594E7.90501@siriushk.com> <47B5B3C9.7000308@codeweavers.com>
	<47B5D4C9.3000601@siriushk.com>
	<004f01c8709f$275e1f90$a600fea9@DMITRY>
	<47B8E4DC.8070001@siriushk.com>
	<005401c871e2$56c8b1c0$a600fea9@DMITRY>
Message-ID: <47B90766.5040507@siriushk.com>

Dear Dmitry,

Dmitry Timoshkov wrote:
> "Timothy Lee" <timothy.lee at siriushk.com> wrote:
>>>>> I'm struggling to imagine a case where the behaviour you've 
>>>>> implemented is useful.
>>>> I'm actually using this code as the basis of a PowerPoint plugin 
>>>> under Linux.
>>> I little bit more information won't hurt. For instance why your plugin
>>> needs to re-route the whole desktop window, and not just its own one.
>> The patch was used in a browser plugin that uses PowerPoint Viewer 
>> (97/2003/2007) and WINE to display PowerPoint slideshows.
> It's still now clear to me what kind of plugin it is, and what it is
> doing. You call it once "a PowerPoint plugin", and next time "a browser
> plugin".
It's a PowerPoint plugin for Mozilla-based browsers, which can be used 
to embed a PowerPoint slideshow inside a web page.  So yes, both 
references were valid (though, as you have indicated, no crystal clear).
>> While developing the plugin, I've found that PowerPoint Viewer always 
>> playback slides inside a window that covers the whole desktop.  Hence 
>> the idea was born to embed the desktop inside a native X11 window.
> An application plugin usually has access to the application internals in
> some fashion, so I don't understand how that idea jumped from an 
> application
> window (where the plugin lives) to the whole desktop window (a separate
> process).
No, I don't have the "internal" of the PowerPoint Viewer, as it's 
written by Microsoft.  However, the plugin code does know about the X11 
window supplied by the browser for embedding purpose, and this is passed 
via the newly defined environmental variable to Wine.
>> I thought this patch might be useful to others with similar 
>> requirements, namely, to embed full-screen win32 applications inside 
>> a native X11 window.
> That kind of hack has nothing to do with Wine desktop window if what it
> targets is just an application window.
Um.  How about if the scope of the patch is repharsed as "embedding the 
Wine desktop inside an X11 window"?

Regards,
Timothy


From timothy.lee at siriushk.com  Mon Feb 18 01:04:27 2008
From: timothy.lee at siriushk.com (Timothy Lee)
Date: Mon, 18 Feb 2008 15:04:27 +0800
Subject: [PATCH]  Environment variable to specify X11 window for desktop
In-Reply-To: <016601c871e6$dd805110$a600fea9@DMITRY>
References: <47B594E7.90501@siriushk.com> <47B5B3C9.7000308@codeweavers.com>
	<47B5D4C9.3000601@siriushk.com>
	<004f01c8709f$275e1f90$a600fea9@DMITRY>
	<47B8E4DC.8070001@siriushk.com>
	<005401c871e2$56c8b1c0$a600fea9@DMITRY>
	<47B90766.5040507@siriushk.com>
	<016601c871e6$dd805110$a600fea9@DMITRY>
Message-ID: <47B92DFB.8000609@siriushk.com>

Dmitry Timoshkov wrote:
> "Timothy Lee" <timothy.lee at siriushk.com> wrote:
>
>>> That kind of hack has nothing to do with Wine desktop window if what it
>>> targets is just an application window.
>> Um.  How about if the scope of the patch is repharsed as "embedding 
>> the Wine desktop inside an X11 window"?
>
> Perhaps the most easy way for you to accomplish this would be write a
> replacement for Wine's explorer. Have a look at 
> programs/explorer/desktop.c
> for ideas.
>
Thanks for the tip.  Will checkout the source code.

Regards,
Timothy


From winehacker at gmail.com  Mon Feb 18 03:59:41 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 18 Feb 2008 04:59:41 -0500
Subject: [PATCH] Environment variable to specify X11 window for desktop
In-Reply-To: <016601c871e6$dd805110$a600fea9@DMITRY>
References: <47B594E7.90501@siriushk.com> <47B5B3C9.7000308@codeweavers.com>
	<47B5D4C9.3000601@siriushk.com>
	<004f01c8709f$275e1f90$a600fea9@DMITRY>
	<47B8E4DC.8070001@siriushk.com>
	<005401c871e2$56c8b1c0$a600fea9@DMITRY>
	<47B90766.5040507@siriushk.com>
	<016601c871e6$dd805110$a600fea9@DMITRY>
Message-ID: <19e31a080802180159sf7c5029v527f99cb4d8279f@mail.gmail.com>

On 2/17/08, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> "Timothy Lee" <timothy.lee at siriushk.com> wrote:
>
> >> That kind of hack has nothing to do with Wine desktop window if what it
> >> targets is just an application window.
> > Um.  How about if the scope of the patch is repharsed as "embedding the
> > Wine desktop inside an X11 window"?
>
> Perhaps the most easy way for you to accomplish this would be write a
> replacement for Wine's explorer. Have a look at programs/explorer/desktop.c
> for ideas.

As detlef pointed out about the screensavers, there does seem to be a
few valid cases for this. Maybe support for embedding could be put
inside of the existing explorer? I'd like to add support for Windows
screensavers. A while back I submitted a patch that needs some rework
for xdg-screensavers but I expect users will want to also be able to
use the native ones.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Mon Feb 18 04:07:00 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 18 Feb 2008 05:07:00 -0500
Subject: programs: add winestartfile for starting files from the unix path
	(for file managers)
In-Reply-To: <ced95fe0802171228t137b679kb7bad999a44dad56@mail.gmail.com>
References: <ced95fe0802171228t137b679kb7bad999a44dad56@mail.gmail.com>
Message-ID: <19e31a080802180207t229d26d9ia26879c9804ac126@mail.gmail.com>

As explorer.exe is always running could you do something like extend
it so that that KFM and friends could call 'explorer.exe filename'
directly? It seems redundant to add another winelib application when
you are trying to emulate explorer functionality anyway and explorer
is always running. You could extend it to use messaging to connect to
an existing explorer.exe process also.

Thanks
Steven


On 2/17/08, Vincent Povirk <madewokherd+d41d at gmail.com> wrote:
> This is now attempt 4, not that anyone's counting.
>
> Adding winelib programs is a bit involved, and I imagine I've screwed
> something up along the way. If you know how to add them properly,
> please say something, even if it's to tell me I did it right.
>
> This patch adds a winelib program called winestartfile for starting
> files given the unix path. It attempts to mimic what windows explorer
> does to start files and provide some visible (gui) feedback when it
> doesn't work. The idea is that wine.desktop can then be modified to
> use winestartfile instead of wine, solving the following problems when
> starting exe files from file managers:
> * File managers typically do not set the working directory to the
> directory that contains an exe when they start it. Setting the working
> directory is the default behavior for windows explorer, and many
> windows programs rely on it.
> * File managers naturally use the unix path to start files, and the
> wine binary passes the unix path along to the exe it starts, rather
> than translating it to a windows path (this can and probably should
> also be fixed somewhere else).
> * Windows explorer always starts exe files with quotes around the path
> in the command-line, even if the path does not contain spaces. The
> wine binary does not (and probably should not) add quotes in this
> situation. A few apps rely on the quotes. See
> http://bugs.winehq.org/show_bug.cgi?id=5224#c14
>
> --
> Vincent Povirk
>


-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From thunderbird2k at gmx.net  Mon Feb 18 04:14:44 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Mon, 18 Feb 2008 11:14:44 +0100
Subject: [PATCH]  Environment variable to specify X11 window for desktop
In-Reply-To: <47B92DFB.8000609@siriushk.com>
References: <47B594E7.90501@siriushk.com> <47B5B3C9.7000308@codeweavers.com>
	<47B5D4C9.3000601@siriushk.com>	<004f01c8709f$275e1f90$a600fea9@DMITRY>
	<47B8E4DC.8070001@siriushk.com>	<005401c871e2$56c8b1c0$a600fea9@DMITRY>
	<47B90766.5040507@siriushk.com>	<016601c871e6$dd805110$a600fea9@DMITRY>
	<47B92DFB.8000609@siriushk.com>
Message-ID: <20080218101444.62940@gmx.net>

Hi,

I'm just bumping into this discussion. From what I read the reason you need such functionality is for a mozilla powerpoint plugin. Have you figured out how this embedding is done on Windows? I don't know much about it but I think embedding works using COM and perhaps almost the same as e.g. Flash.

For example codeweavers has a plugin to embed IE plugins in mozilla, the same for the KDE reaktivate project which did something similar for Konqueror (although it can be used on mozilla too as they put it all in a library). Likely IE plugins work differently but I think the same embedding mechanism could be used, so you won't need such an X11 hack.

Regards,
Roderick
-- 
Der GMX SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen! 
Ideal f?r Modem und ISDN: http://www.gmx.net/de/go/smartsurfer


From dmitry at codeweavers.com  Mon Feb 18 04:53:57 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 18 Feb 2008 18:53:57 +0800
Subject: [PATCH] Environment variable to specify X11 window for desktop
References: <47B594E7.90501@siriushk.com>
	<47B5B3C9.7000308@codeweavers.com><47B5D4C9.3000601@siriushk.com><004f01c8709f$275e1f90$a600fea9@DMITRY><47B8E4DC.8070001@siriushk.com><005401c871e2$56c8b1c0$a600fea9@DMITRY><47B90766.5040507@siriushk.com><016601c871e6$dd805110$a600fea9@DMITRY>
	<19e31a080802180159sf7c5029v527f99cb4d8279f@mail.gmail.com>
Message-ID: <007a01c8721c$91b2bd00$a600fea9@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> As detlef pointed out about the screensavers, there does seem to be a
> few valid cases for this. Maybe support for embedding could be put
> inside of the existing explorer? I'd like to add support for Windows
> screensavers. A while back I submitted a patch that needs some rework
> for xdg-screensavers but I expect users will want to also be able to
> use the native ones.

Windows screen-savers already support drawing in a window without
external ugly hacks.

-- 
Dmitry.


From leslie_alistair at hotmail.com  Mon Feb 18 05:12:59 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Mon, 18 Feb 2008 22:12:59 +1100
Subject: [1/16] msxml3: Support functions for typelib
References: <fp15a2$u7m$1@ger.gmane.org> <878x1lc5ds.fsf@wine.dyndns.org>
Message-ID: <fpbp7l$t4$1@ger.gmane.org>


"Alexandre Julliard" <julliard at winehq.org> wrote in message 
news:878x1lc5ds.fsf at wine.dyndns.org...
>> +    *typeinfo = typeinfos[tid];
>> +    return S_OK;
>
> You should increment the ref count when you are returning a pointer,
> even if it's also stored in a global variable.
Hi,
  After reviewing the changes I need to an AddRef to typeinfo, it doesnt 
make sense.

In each GetTypeInfo function we do an AddRef since the user gets a pointer 
pack to the typinfo pointer.

Where as, in GetIDsOfNames and Invoke functions we use the get_typeinfo 
function to retreive the pointer
and in this case we dont want to increment the pointer.

What is the best course of actions?
1. AddRef in get_typeinfo and therefore Release in GetIDsOfNames and Invoke
or
2. AddRef in GetTypeInfo, and nothing else has to be changed.

Best Regards
 Alistair Leslie-Hughes




From m.b.lankhorst at gmail.com  Mon Feb 18 05:41:39 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 18 Feb 2008 03:41:39 -0800
Subject: iTunes
In-Reply-To: <22821af30802172142l5e3283aey6e32487d982955be@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>
	<b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>
	<22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>
	<b130c85e0802172116n40bb2b01h55e76989ca0c7c5d@mail.gmail.com>
	<22821af30802172120y3eab91b3je6ba0b0c31d7fc44@mail.gmail.com>
	<b130c85e0802172139p1f0acfe8r69431019a09b5c85@mail.gmail.com>
	<22821af30802172142l5e3283aey6e32487d982955be@mail.gmail.com>
Message-ID: <b130c85e0802180341h5be768ccm206ffd4d3f64520d@mail.gmail.com>

Hi James,

2008/2/17, James Hawkins <truiken at gmail.com>:
> On Feb 17, 2008 11:39 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> >
> > Hi James,
> >
> > 2008/2/17, James Hawkins <truiken at gmail.com>:
> > > On Feb 17, 2008 11:16 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > > > Hi James,
> > > >
> > > >
> > > > 2008/2/17, James Hawkins <truiken at gmail.com>:
> > > > > On Feb 17, 2008 11:07 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > > > > > 2008/2/17, James Hawkins <truiken at gmail.com>:
> > > > > >
> > > > > > > On Feb 17, 2008 9:42 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> > > > > > > > Hi Christopher,
> > > > > > > >
> > > > > > > > Christopher Harvey wrote:
> > > > > > > > > What needs to get done for iTunes to work?
> > > > > > > >
> > > > > > > > v7.6 basically works if you set windows version to windows vista, and
> > > > > > > > find out why the installer fails to create the 'Bonjour service'
> > > > > > > > registry stuff properly.
> > > > > > > >
> > > > > > > > I submitted 8 or so stub dll's to wine-patches that make iTunes v7.6
> > > > > > > > actually start after installation. It checks for the dll's and
> > > > > > > > silently fails if they don't exist.
> > > > > > > >
> > > > > > > > I haven't done any further testing yet though, but it looks like it is
> > > > > > > > probably a small installer bug that prevents itunes v7.6 from
> > > > > > > > installing without first manually creating those registry keys.
> > > > > > > >
> > > > > > >
> > > > > > > The Bonjour service depends on the tcpip service.  As far as I know,
> > > > > > > we don't provide that service.  What registry keys are you referring
> > > > > > > to?
> > > > > > Keys like:
> > > > > > In HKLM\SYSTEM\CurrentControlSet\Services\Bonjour Service:
> > > > > > ImagePath="C:\...."
> > > > > > Start=0x00000002
> > > > > > Description="....."
> > > > > >
> > > > > > Those are not created during install. If I manually add them the
> > > > > > 'bonjour service' will report success on start, but actually crash
> > > > > > right after. However it is enough to satisfy the itunes installer.
> > > > > > Without those it will report failure without even attempting to start
> > > > > > the service. :-)
> > > > > >
> > > > >
> > > > > hmm according to the logs, the service is installed just fine.  You'd
> > > > > get an err otherwise.  The dependencies aren't listed, but since we
> > > > > don't have the tcpip service anyway, it won't make a difference
> > > > > (though that might be why it crashes when you get the service to
> > > > > start.)
> > > > There is a big difference. Without it it will abort installation
> > > > because the bonjour service fails to start. With it it will start but
> > > > immediately crash, however that happens after start so installation
> > > > happily continues. The effect is that installer will continue. I don't
> > > > see how it can be fine if it fails to create the appropiate registry
> > > > keys.
> > > >
> > >
> > > I'm not saying it's not.  I'm saying that the call to CreateService
> > > doesn't fail, or you'd get an err, like I said before.
> > >
> > >     service = CreateServiceW(hscm, name, disp, GENERIC_ALL, serv_type,
> > >                              start_type, err_control, file->TargetPath,
> > >                              load_order, NULL, NULL, serv_name, pass);
> > >     if (!service)
> > >     {
> > >         if (GetLastError() != ERROR_SERVICE_EXISTS)
> > >             ERR("Failed to create service %s: %d\n", debugstr_w(name),
> > > GetLastError());
> > >     }
> > >
> > > I'm not saying there's not a bug in CreateServiceW, but as it stands,
> > > we don't get a failure.
> > You can try for yourself at the following link:
> > http://www.apple.com/downloads/macosx/apple/windows/bonjourforwindows.html
> >
> > Or try iTunes v7.6 directly.
> >
> > It could also be that it never calls CreateService for some reason,
> > I'm not 100% sure.
> >
>
> I already have tried it; that's how I know the call doesn't fail.  Yes
> it does call CreateService.  All the error paths in
> ITERATE_InstallService have ERRs, so you'd see it if it did fail.
It could be that it fails with a parameter error and then exits
silently, those paths are not covered.

On a slightly related note: Do you know if the hardware drivers are
installed somewhere? I would be interested in getting iTunes syncing
to my ipod touch (similar to iphone). I didn't see anything in my
wineprefix after installation.

Cheers,
Maarten.


From meissner at suse.de  Mon Feb 18 06:41:10 2008
From: meissner at suse.de (Marcus Meissner)
Date: Mon, 18 Feb 2008 13:41:10 +0100
Subject: inetcomm: Fix compilation on systems that don't support
	nameless unions.
In-Reply-To: <alpine.DEB.1.00.0802181153590.21550@amboise.dolphin>
References: <alpine.DEB.1.00.0802181153590.21550@amboise.dolphin>
Message-ID: <20080218124110.GA11087@suse.de>

On Mon, Feb 18, 2008 at 11:54:22AM +0100, Francois Gouget wrote:
> ---
>  dlls/inetcomm/mimeole.c |   12 ++++++------
>  1 files changed, 6 insertions(+), 6 deletions(-)
> diff --git a/dlls/inetcomm/mimeole.c b/dlls/inetcomm/mimeole.c
> index a0da6b9..e986e7f 100644
> --- a/dlls/inetcomm/mimeole.c
> +++ b/dlls/inetcomm/mimeole.c
> @@ -1257,7 +1257,7 @@ static HRESULT WINAPI sub_stream_CopyTo(
>      ULARGE_INTEGER totalBytesRead;
>      ULARGE_INTEGER totalBytesWritten;
>  
> -    TRACE("(%p)->(%p, %d, %p, %p)\n", iface, pstm, cb.LowPart, pcbRead, pcbWritten);
> +    TRACE("(%p)->(%p, %d, %p, %p)\n", iface, pstm, cb.u.LowPart, pcbRead, pcbWritten);
>  
>      totalBytesRead.QuadPart = 0;
>      totalBytesWritten.QuadPart = 0;
> @@ -1525,7 +1525,7 @@ static HRESULT create_body_offset_list(IStream *stm, const char *boundary, struc
>  
>      zero.QuadPart = 0;
>      hr = IStream_Seek(stm, zero, STREAM_SEEK_CUR, &cur);
> -    start = cur.LowPart;
> +    start = cur.u.LowPart;
>  
>      do {
>          hr = IStream_Read(stm, overlap, PARSER_BUF_SIZE, &read);
> @@ -1599,7 +1599,7 @@ static body_t *create_sub_body(MimeMessage *msg, IStream *pStm, BODYOFFSETS *off
>      IMimeBody_Load(mime_body, pStm);
>      zero.QuadPart = 0;
>      hr = IStream_Seek(pStm, zero, STREAM_SEEK_CUR, &cur);
> -    offset->cbBodyStart = cur.LowPart + offset->cbHeaderStart;
> +    offset->cbBodyStart = cur.u.LowPart + offset->cbHeaderStart;
>      if(parent) MimeBody_set_offsets(impl_from_IMimeBody(mime_body), offset);
>      IMimeBody_SetData(mime_body, IET_BINARY, NULL, NULL, &IID_IStream, pStm);
>      body = new_body_entry(mime_body, msg->next_hbody, parent);
> @@ -1629,8 +1629,8 @@ static body_t *create_sub_body(MimeMessage *msg, IStream *pStm, BODYOFFSETS *off
>                      IStream *sub_stream;
>                      ULARGE_INTEGER start, length;
>  
> -                    start.LowPart = cur->offsets.cbHeaderStart;
> -                    length.LowPart = cur->offsets.cbBodyEnd - cur->offsets.cbHeaderStart;
> +                    start.u.LowPart = cur->offsets.cbHeaderStart;
> +                    length.u.LowPart = cur->offsets.cbBodyEnd - cur->offsets.cbHeaderStart;
>                      create_sub_stream(pStm, start, length, &sub_stream);
>                      sub_body = create_sub_body(msg, sub_stream, &cur->offsets, body);
>                      IStream_Release(sub_stream);
> @@ -1674,7 +1674,7 @@ static HRESULT WINAPI MimeMessage_Load(
>  
>      zero.QuadPart = 0;
>      IStream_Seek(pStm, zero, STREAM_SEEK_END, &cur);
> -    offsets.cbBodyEnd = cur.LowPart;
> +    offsets.cbBodyEnd = cur.u.LowPart;
>      MimeBody_set_offsets(impl_from_IMimeBody(root_body->mime_body), &offsets);
>  
>      list_add_head(&This->body_tree, &root_body->entry);
>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 


There seems to be damage in here, both ^M and lose 0s.

Ciao, Marcus


From julliard at winehq.org  Mon Feb 18 07:17:50 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 18 Feb 2008 14:17:50 +0100
Subject: [advapi32/tests #2] Don't set last error to 0 so we can check if
	it has changed
In-Reply-To: <47B702E7.2060506@gmail.com> (Paul Vriens's message of "Sat, 16
	Feb 2008 16:36:07 +0100")
References: <47B702E7.2060506@gmail.com>
Message-ID: <87lk5ixv29.fsf@wine.dyndns.org>

Paul Vriens <paul.vriens.wine at gmail.com> writes:

> We test for a last error of 0, so we shouldn't set it to 0 before the
> function is called. This however introduces a todo_wine.

Is there any reason to believe that last error should be 0 on success?
This looks more like a broken test to me.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Mon Feb 18 07:54:19 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 18 Feb 2008 13:54:19 +0000
Subject: iTunes
In-Reply-To: <b130c85e0802180341h5be768ccm206ffd4d3f64520d@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>	<22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>	<b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>	<22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>	<b130c85e0802172116n40bb2b01h55e76989ca0c7c5d@mail.gmail.com>	<22821af30802172120y3eab91b3je6ba0b0c31d7fc44@mail.gmail.com>	<b130c85e0802172139p1f0acfe8r69431019a09b5c85@mail.gmail.com>	<22821af30802172142l5e3283aey6e32487d982955be@mail.gmail.com>
	<b130c85e0802180341h5be768ccm206ffd4d3f64520d@mail.gmail.com>
Message-ID: <47B98E0B.5010601@codeweavers.com>

Maarten Lankhorst wrote:
> On a slightly related note: Do you know if the hardware drivers are
> installed somewhere? I would be interested in getting iTunes syncing
> to my ipod touch (similar to iphone). I didn't see anything in my
> wineprefix after installation.

I don't know about the iPod Touch and iPhone, but iPods are USB mass 
storage devices in Windows and so don't require any device drivers.

iTunes 4.x communicated with an iPod using DeviceIoControl(..., 
IOCTL_SCSI_PASS_THROUGH, ...) and DeviceIoControl(..., 
IOCTL_SCSI_PASS_THROUGH_DIRECT, ...), but only after doing a whole bunch 
of low-level calls using setupapi and other ioctls to find the device.

The 4.x versions of iTunes did install a driver for the CD burning 
functionality, however.

Good luck, but bear in mind that any hard work done on iTunes may need 
to re-done in 3-6 months time when the next version of iTunes comes out.

-- 
Rob Shearman



From spam at authmann.de  Mon Feb 18 08:15:34 2008
From: spam at authmann.de (Christian Authmann)
Date: Mon, 18 Feb 2008 15:15:34 +0100
Subject: Usable Wine interface
In-Reply-To: <d6c5d7290802172254v78b40728k4bad6b61a0f18b6d@mail.gmail.com>
References: <84536.27314.qm@web50106.mail.re2.yahoo.com>
	<d6c5d7290802172254v78b40728k4bad6b61a0f18b6d@mail.gmail.com>
Message-ID: <47B99306.6030701@authmann.de>

Edward Savage wrote:
> I would very much like to see a --spawn-new trigger that can be added
> to a command to start a new virtual desktop.

wine explorer.exe /desktop=Name,800x600 myapp.exe

a hint about that command-line trick could be added to winecfg though, 
as it seems to be quite unknown.


From madewokherd+d41d at gmail.com  Mon Feb 18 08:18:44 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Mon, 18 Feb 2008 09:18:44 -0500
Subject: programs: add winestartfile for starting files from the unix path
	(for file managers)
In-Reply-To: <19e31a080802180207t229d26d9ia26879c9804ac126@mail.gmail.com>
References: <ced95fe0802171228t137b679kb7bad999a44dad56@mail.gmail.com>
	<19e31a080802180207t229d26d9ia26879c9804ac126@mail.gmail.com>
Message-ID: <ced95fe0802180618i47a0ae89g632760114e451e64@mail.gmail.com>

The odd thing about wine's explorer is that it doesn't seem to copy
any UI that's handled by explorer on windows. It seems to be some sort
of service and have something to do with HAL (and controlling virtual
desktops for some reason). I must admit I don't understand the
reasoning behind any of the current things that are or are not handled
by explorer, but I think this is probably not the right place.

The reason for trying to emulate explorer functionality is that some
apps depend on being called exactly the way they would be called by
explorer. AFAIK they do not care if they're called by explorer.exe or
some other program.

I imagine this wouldn't be too difficult to add, but I'd have to make
explorer depend on shell32 (and possibly shlwapi). I'm also not sure
how this would interact with /desktop functionality (come to think of
it, explorer would read any path starting in a / as a command-line
switch..).

On Feb 18, 2008 5:07 AM, Steven Edwards <winehacker at gmail.com> wrote:
> As explorer.exe is always running could you do something like extend
> it so that that KFM and friends could call 'explorer.exe filename'
> directly? It seems redundant to add another winelib application when
> you are trying to emulate explorer functionality anyway and explorer
> is always running. You could extend it to use messaging to connect to
> an existing explorer.exe process also.
>
> Thanks
> Steven
>
>
>
> On 2/17/08, Vincent Povirk <madewokherd+d41d at gmail.com> wrote:
> > This is now attempt 4, not that anyone's counting.
> >
> > Adding winelib programs is a bit involved, and I imagine I've screwed
> > something up along the way. If you know how to add them properly,
> > please say something, even if it's to tell me I did it right.
> >
> > This patch adds a winelib program called winestartfile for starting
> > files given the unix path. It attempts to mimic what windows explorer
> > does to start files and provide some visible (gui) feedback when it
> > doesn't work. The idea is that wine.desktop can then be modified to
> > use winestartfile instead of wine, solving the following problems when
> > starting exe files from file managers:
> > * File managers typically do not set the working directory to the
> > directory that contains an exe when they start it. Setting the working
> > directory is the default behavior for windows explorer, and many
> > windows programs rely on it.
> > * File managers naturally use the unix path to start files, and the
> > wine binary passes the unix path along to the exe it starts, rather
> > than translating it to a windows path (this can and probably should
> > also be fixed somewhere else).
> > * Windows explorer always starts exe files with quotes around the path
> > in the command-line, even if the path does not contain spaces. The
> > wine binary does not (and probably should not) add quotes in this
> > situation. A few apps rely on the quotes. See
> > http://bugs.winehq.org/show_bug.cgi?id=5224#c14
> >
> > --
> > Vincent Povirk
> >
>
>
> --
> Steven Edwards
>
> "There is one thing stronger than all the armies in the world, and
> that is an idea whose time has come." - Victor Hugo
>



-- 
Vincent Povirk


From paul.vriens.wine at gmail.com  Mon Feb 18 08:45:51 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 18 Feb 2008 15:45:51 +0100
Subject: [advapi32/tests #2] Don't set last error to 0 so we can check if
	it has changed
In-Reply-To: <87lk5ixv29.fsf@wine.dyndns.org>
References: <47B702E7.2060506@gmail.com> <87lk5ixv29.fsf@wine.dyndns.org>
Message-ID: <229cc3050802180645y7693a8c4ic73332b4f761bfcf@mail.gmail.com>

On Feb 18, 2008 2:17 PM, Alexandre Julliard <julliard at winehq.org> wrote:
> Paul Vriens <paul.vriens.wine at gmail.com> writes:
>
> > We test for a last error of 0, so we shouldn't set it to 0 before the
> > function is called. This however introduces a todo_wine.
>
> Is there any reason to believe that last error should be 0 on success?
> This looks more like a broken test to me.
>
Well no.

I agree it looks more like a broken test me as well. That's why I said
I didn't see any of the tests enter this
'if' statement.

This if statement was introduced by Rob Shearman:

http://source.winehq.org/git/wine.git/?a=commit;h=1731df4ca0460c3ef15b274503e18d95ffe86036

I have no clue what the test does and what's wrong with it so can we
leave it like this? Or should we ask Rob to go
way back in his memory (June 2005) ;-)

Cheers,

Paul.


From fgouget at free.fr  Mon Feb 18 11:31:10 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 18 Feb 2008 18:31:10 +0100 (CET)
Subject: [PATCH] msvcrt/tests: Add more scanf floating-point tests.
In-Reply-To: <20080215210711.GA3896@localhost.localdomain>
References: <20080215210711.GA3896@localhost.localdomain>
Message-ID: <alpine.DEB.1.00.0802181829110.21550@amboise.dolphin>

On Fri, 15 Feb 2008, =?utf-8?q?J=C4=81nis=20R=C5=ABcis?= wrote:
[...]
> All five tests pass on my Windows XP SP2 system (using a self-compiled
> msvcrt_crosstest.exe tool).  Test 3 and 4 fail with the current source
> in Git.  I will send another patch to this list with a potential fix.
> 
> (I am not sending these to wine-patches because I'm not sure I should.
> "wine-devel" sounds about right.)

If you want the patch to be applied you do have to poast it to 
wine-patches. Before you post it there, though, you'll need to add 
todo_wine statements so they don't fail on Wine. You can then remove the 
todo_wines in the patch that fixes Wine's msvcrt.



-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
        It really galls me that most of the computer power in the world
                          is wasted on screen savers.
                     Chris Caldwell from the GIMPS project
                       http://www.mersenne.org/prime.htm


From madewokherd+d41d at gmail.com  Mon Feb 18 11:07:49 2008
From: madewokherd+d41d at gmail.com (Vincent Povirk)
Date: Mon, 18 Feb 2008 12:07:49 -0500
Subject: programs: add winestartfile for starting files from the unix path
	(for file managers)
In-Reply-To: <ced95fe0802180618i47a0ae89g632760114e451e64@mail.gmail.com>
References: <ced95fe0802171228t137b679kb7bad999a44dad56@mail.gmail.com>
	<19e31a080802180207t229d26d9ia26879c9804ac126@mail.gmail.com>
	<ced95fe0802180618i47a0ae89g632760114e451e64@mail.gmail.com>
Message-ID: <ced95fe0802180907y27878d53s138826126cde3d9a@mail.gmail.com>

I talked to Alexandre Julliard on irc, and he thinks moving this to
explorer is a good idea (I still don't understand what goes into this,
but I'll accept it).

I'm supposed to use delayed imports for shell32 and shlwapi. I'll need
to add a switch for this (so you'd do something like wine explorer
/startfile ~/whatever.exe), and it'll probably be easier for users if
I assume only things that contain a / are unix paths (instead of
treating everything like one).

On Feb 18, 2008 9:18 AM, Vincent Povirk <madewokherd+d41d at gmail.com> wrote:
> The odd thing about wine's explorer is that it doesn't seem to copy
> any UI that's handled by explorer on windows. It seems to be some sort
> of service and have something to do with HAL (and controlling virtual
> desktops for some reason). I must admit I don't understand the
> reasoning behind any of the current things that are or are not handled
> by explorer, but I think this is probably not the right place.
>
> The reason for trying to emulate explorer functionality is that some
> apps depend on being called exactly the way they would be called by
> explorer. AFAIK they do not care if they're called by explorer.exe or
> some other program.
>
> I imagine this wouldn't be too difficult to add, but I'd have to make
> explorer depend on shell32 (and possibly shlwapi). I'm also not sure
> how this would interact with /desktop functionality (come to think of
> it, explorer would read any path starting in a / as a command-line
> switch..).
>
>
> On Feb 18, 2008 5:07 AM, Steven Edwards <winehacker at gmail.com> wrote:
> > As explorer.exe is always running could you do something like extend
> > it so that that KFM and friends could call 'explorer.exe filename'
> > directly? It seems redundant to add another winelib application when
> > you are trying to emulate explorer functionality anyway and explorer
> > is always running. You could extend it to use messaging to connect to
> > an existing explorer.exe process also.
> >
> > Thanks
> > Steven
> >
> >
> >
> > On 2/17/08, Vincent Povirk <madewokherd+d41d at gmail.com> wrote:
> > > This is now attempt 4, not that anyone's counting.
> > >
> > > Adding winelib programs is a bit involved, and I imagine I've screwed
> > > something up along the way. If you know how to add them properly,
> > > please say something, even if it's to tell me I did it right.
> > >
> > > This patch adds a winelib program called winestartfile for starting
> > > files given the unix path. It attempts to mimic what windows explorer
> > > does to start files and provide some visible (gui) feedback when it
> > > doesn't work. The idea is that wine.desktop can then be modified to
> > > use winestartfile instead of wine, solving the following problems when
> > > starting exe files from file managers:
> > > * File managers typically do not set the working directory to the
> > > directory that contains an exe when they start it. Setting the working
> > > directory is the default behavior for windows explorer, and many
> > > windows programs rely on it.
> > > * File managers naturally use the unix path to start files, and the
> > > wine binary passes the unix path along to the exe it starts, rather
> > > than translating it to a windows path (this can and probably should
> > > also be fixed somewhere else).
> > > * Windows explorer always starts exe files with quotes around the path
> > > in the command-line, even if the path does not contain spaces. The
> > > wine binary does not (and probably should not) add quotes in this
> > > situation. A few apps rely on the quotes. See
> > > http://bugs.winehq.org/show_bug.cgi?id=5224#c14
> > >
> > > --
> > > Vincent Povirk
> > >
> >
> >
> > --
> > Steven Edwards
> >
> > "There is one thing stronger than all the armies in the world, and
> > that is an idea whose time has come." - Victor Hugo
> >
>
>
>
> --
> Vincent Povirk
>



-- 
Vincent Povirk


From austinenglish at gmail.com  Mon Feb 18 11:49:40 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 18 Feb 2008 11:49:40 -0600
Subject: How should we treat users on bugzilla?
In-Reply-To: <a71bd89a0802172201m6ec55fedy2488ce62a03ffc04@mail.gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<a71bd89a0802172201m6ec55fedy2488ce62a03ffc04@mail.gmail.com>
Message-ID: <b6bb06270802180949l190e8666uac45885f020946cc@mail.gmail.com>

On Feb 18, 2008 12:01 AM, Dan Kegel <dank at kegel.com> wrote:
> Tlarhices wrote:
> > In my opinion the main problem is that the bug tracker is too easy to
> > find and the forum too hard to find.
>
> The appdb is our forum, and it's quite easy to find.
>
> I do agree it could use some interface improvements.
> For instance, I think the front page is too crowded.
>
> Also, the 'browse by rating' feature (thanks for adding it!)
> needs to list apps sorted by name; the current seemingly-random
> sort order isn't very useful.
> - Dan
>
>
>

What's the possibility of a winehq forum? There seem to be a few
floating around online, but none are too popular. This fragments users
looking for help, and doesn't give those wanting to help a consistent
place to look. Plus, it's sort of hard to use AppDB to try and get
help with compiling wine, figuring out driver/wine issues, and other
things that aren't really related to a single application.

-Austin


From arbuckle911 at gmail.com  Mon Feb 18 11:55:37 2008
From: arbuckle911 at gmail.com (Christopher Harvey)
Date: Mon, 18 Feb 2008 12:55:37 -0500
Subject: iTunes
In-Reply-To: <22821af30802171923h1badb3ebga9997454d2d12058@mail.gmail.com>
References: <47B8F85B.2030703@gmail.com>
	<22821af30802171923h1badb3ebga9997454d2d12058@mail.gmail.com>
Message-ID: <47B9C699.3090908@gmail.com>

James Hawkins wrote:
> On Feb 17, 2008 9:15 PM, Christopher Harvey <arbuckle911 at gmail.com> wrote:
>   
>> What needs to get done for iTunes to work?
>>
>>     
>
> 80% of bug fixing development is figuring out the answer to that
> question.  If we knew all that was needed, it wouldn't take that long
> to fix.  I'm not really sure what your motivation is for asking that
> question, but assuming it's because you want to help out, you're
> probably out of luck.  If you have to ask that question, you certainly
> won't be able to fix it even if someone tells you what's needed.  If,
> on the other hand, you just want to stir up the fire for developers to
> focus on iTunes...well, most of us don't take too kindly to that.
>
>   
That really wasn't the response I expected, I thought there would have
been one major thing that couldn't be translated into unix calls, and I
was just curious as to what that was. Yeah I'm trying to help out with
wined3d, but have no idea how to work on things like iTunes.
Disclaimer:
I have no motivation to get wine developers to work on iTunes because
even if it was platinum I would never use it.


From amaranth at ubuntu.com  Mon Feb 18 12:12:09 2008
From: amaranth at ubuntu.com (Travis Watkins)
Date: Mon, 18 Feb 2008 12:12:09 -0600
Subject: iTunes
In-Reply-To: <b130c85e0802180341h5be768ccm206ffd4d3f64520d@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<22821af30802172003y55273bbfq930fc620ed717c13@mail.gmail.com>
	<b130c85e0802172107x37ac2168scccf16dbc90c3748@mail.gmail.com>
	<22821af30802172111p6920b7a3o40a35f5f5dcf0519@mail.gmail.com>
	<b130c85e0802172116n40bb2b01h55e76989ca0c7c5d@mail.gmail.com>
	<22821af30802172120y3eab91b3je6ba0b0c31d7fc44@mail.gmail.com>
	<b130c85e0802172139p1f0acfe8r69431019a09b5c85@mail.gmail.com>
	<22821af30802172142l5e3283aey6e32487d982955be@mail.gmail.com>
	<b130c85e0802180341h5be768ccm206ffd4d3f64520d@mail.gmail.com>
Message-ID: <adca365a0802181012v38076ff7l1ed85457726626ed@mail.gmail.com>

On Feb 18, 2008 5:41 AM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> On a slightly related note: Do you know if the hardware drivers are
> installed somewhere? I would be interested in getting iTunes syncing
> to my ipod touch (similar to iphone). I didn't see anything in my
> wineprefix after installation.

You'll want to look for iTunesMobileDevice.dll, not a driver. The
whole thing is just a proprietary USB protocol.


-- 
Travis Watkins
http://www.realistanew.com


From zgold550 at gmail.com  Mon Feb 18 12:21:04 2008
From: zgold550 at gmail.com (Zachary Goldberg)
Date: Mon, 18 Feb 2008 13:21:04 -0500
Subject: How should we treat users on bugzilla?
In-Reply-To: <b6bb06270802180949l190e8666uac45885f020946cc@mail.gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<a71bd89a0802172201m6ec55fedy2488ce62a03ffc04@mail.gmail.com>
	<b6bb06270802180949l190e8666uac45885f020946cc@mail.gmail.com>
Message-ID: <b050a5e70802181021j1bac0f48l2aada80a845b087b@mail.gmail.com>

On Feb 18, 2008 12:49 PM, Austin English <austinenglish at gmail.com> wrote:
>
> On Feb 18, 2008 12:01 AM, Dan Kegel <dank at kegel.com> wrote:
> > Tlarhices wrote:
> > > In my opinion the main problem is that the bug tracker is too easy to
> > > find and the forum too hard to find.
> >
> > The appdb is our forum, and it's quite easy to find.
> >
> > I do agree it could use some interface improvements.
> > For instance, I think the front page is too crowded.
> >
> > Also, the 'browse by rating' feature (thanks for adding it!)
> > needs to list apps sorted by name; the current seemingly-random
> > sort order isn't very useful.
> > - Dan
> >
> >
> >
>
> What's the possibility of a winehq forum? There seem to be a few
> floating around online, but none are too popular. This fragments users
> looking for help, and doesn't give those wanting to help a consistent
> place to look. Plus, it's sort of hard to use AppDB to try and get
> help with compiling wine, figuring out driver/wine issues, and other
> things that aren't really related to a single application.
>
> -Austin
>
>

Would that be too redundant with the user mailing list?


--Zach


From research at science.su  Mon Feb 18 12:35:15 2008
From: research at science.su (L. Rahyen)
Date: Mon, 18 Feb 2008 18:35:15 +0000
Subject: How should we treat users on bugzilla?
In-Reply-To: <b6bb06270802180949l190e8666uac45885f020946cc@mail.gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<a71bd89a0802172201m6ec55fedy2488ce62a03ffc04@mail.gmail.com>
	<b6bb06270802180949l190e8666uac45885f020946cc@mail.gmail.com>
Message-ID: <200802181835.15391.research@science.su>

On Monday February 18 2008 17:49:40 Austin English wrote:
> On Feb 18, 2008 12:01 AM, Dan Kegel <dank at kegel.com> wrote:
> > Tlarhices wrote:
> > > In my opinion the main problem is that the bug tracker is too easy to
> > > find and the forum too hard to find.
> >
> > The appdb is our forum, and it's quite easy to find.
> >
> > I do agree it could use some interface improvements.
> > For instance, I think the front page is too crowded.
> >
> > Also, the 'browse by rating' feature (thanks for adding it!)
> > needs to list apps sorted by name; the current seemingly-random
> > sort order isn't very useful.
> > - Dan
>
> What's the possibility of a winehq forum? There seem to be a few
> floating around online, but none are too popular. This fragments users
> looking for help, and doesn't give those wanting to help a consistent
> place to look. Plus, it's sort of hard to use AppDB to try and get
> help with compiling wine, figuring out driver/wine issues, and other
> things that aren't really related to a single application.

	There is wine-users mailing list for such questions. As far as I know it even 
possible to send message to it without subscribing first so I think that it 
is very usable for users. What is more important, it is simpler to use than 
typical forum (no complex registration process, no delays in page refreshes, 
etc.). It is especially important to person(s) that want to help users on 
regular basis - it is very hard to refresh pages on multiple forums but it 
is very easy to receive messages from multiple mailing lists.
	Of course, there is some people who like forums. If we decide to create 
forum specifically for them, it is important to have possibility to subscribe 
for receiving all (full) messages from the forum to e-mail with direct link 
to reply page for corresponding message, and ability to login permanently 
without stupid timeout (using cookies). In fact there is some forums like 
this (unfortunately, all of them are unrelated to WINE) and they are pretty 
usable (however, personally I like mailing lists more, and didn't used forums 
for a long time). Of course, if there is no volunteer(s) to create and 
support such forum - then wine-users is enough I think.


From rob at codeweavers.com  Mon Feb 18 13:35:22 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 18 Feb 2008 19:35:22 +0000
Subject: include: Add support for executing finally code for exceptions
	without using a separate function.
In-Reply-To: <87skzr4e51.fsf@wine.dyndns.org>
References: <47B879D8.8080307@codeweavers.com> <87skzr4e51.fsf@wine.dyndns.org>
Message-ID: <47B9DDFA.3000408@codeweavers.com>

Alexandre Julliard wrote:
> Robert Shearman <rob at codeweavers.com> writes:
>
>   
>> The first goal is accomplished by changing the previous two-state
>> variable of __first into a three-state variable where the third state
>> is the state in which the finally code is executed in the normal
>> case. The second goal is accomplished by calling sigsetjmp in
>> __wine_finally_handler to give the finally code a place to jump back
>> to after it has finished executing.
>>     
>
> That can't work, once you longjmp into the finally block you can't
> longjmp back, since you are no longer inside the function that did the
> setjmp.

Ah, yes. I thought there might be some caveat like that on the use of 
longjmp, but I couldn't break it with any of the tests I did. I can see 
why it wouldn't work on all platforms or in all circumstances.

-- 
Rob Shearman



From austinenglish at gmail.com  Mon Feb 18 13:44:08 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 18 Feb 2008 13:44:08 -0600
Subject: How should we treat users on bugzilla?
In-Reply-To: <200802181835.15391.research@science.su>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<a71bd89a0802172201m6ec55fedy2488ce62a03ffc04@mail.gmail.com>
	<b6bb06270802180949l190e8666uac45885f020946cc@mail.gmail.com>
	<200802181835.15391.research@science.su>
Message-ID: <b6bb06270802181144q1d636858l1dfd5c33cec45915@mail.gmail.com>

On Feb 18, 2008 12:35 PM, L. Rahyen <research at science.su> wrote:
>         Of course, there is some people who like forums. If we decide to create
> forum specifically for them, it is important to have possibility to subscribe
> for receiving all (full) messages from the forum to e-mail with direct link
> to reply page for corresponding message, and ability to login permanently
> without stupid timeout (using cookies). In fact there is some forums like
> this (unfortunately, all of them are unrelated to WINE) and they are pretty
> usable (however, personally I like mailing lists more, and didn't used forums
> for a long time). Of course, if there is no volunteer(s) to create and
> support such forum - then wine-users is enough I think.

In my experience, the 'older' crowd prefers newsgroups, but 'younger'
people prefer message boards. Similar to how more advanced users
prefer CLI, but inexperienced/novices use GUI. It seems to me we're
trying to help the gui type of person, and a message board would be an
easier way to do this, IMHO.

-Austin


From julliard at winehq.org  Mon Feb 18 13:46:49 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 18 Feb 2008 20:46:49 +0100
Subject: [advapi32/tests #2] Don't set last error to 0 so we can check if
	it has changed
In-Reply-To: <229cc3050802180645y7693a8c4ic73332b4f761bfcf@mail.gmail.com>
	(Paul Vriens's message of "Mon, 18 Feb 2008 15:45:51 +0100")
References: <47B702E7.2060506@gmail.com> <87lk5ixv29.fsf@wine.dyndns.org>
	<229cc3050802180645y7693a8c4ic73332b4f761bfcf@mail.gmail.com>
Message-ID: <87bq6exd1y.fsf@wine.dyndns.org>

"Paul Vriens" <paul.vriens.wine at gmail.com> writes:

> I have no clue what the test does and what's wrong with it so can we
> leave it like this? Or should we ask Rob to go
> way back in his memory (June 2005) ;-)

Probably the last error check should simply be removed, since we expect
the call to succeed.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Mon Feb 18 13:55:26 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 18 Feb 2008 19:55:26 +0000
Subject: [advapi32/tests #2] Don't set last error to 0 so we can check
	if	it has changed
In-Reply-To: <87bq6exd1y.fsf@wine.dyndns.org>
References: <47B702E7.2060506@gmail.com>
	<87lk5ixv29.fsf@wine.dyndns.org>	<229cc3050802180645y7693a8c4ic73332b4f761bfcf@mail.gmail.com>
	<87bq6exd1y.fsf@wine.dyndns.org>
Message-ID: <47B9E2AE.2060402@codeweavers.com>

Alexandre Julliard wrote:
> "Paul Vriens" <paul.vriens.wine at gmail.com> writes:
>
>   
>> I have no clue what the test does and what's wrong with it so can we
>> leave it like this? Or should we ask Rob to go
>> way back in his memory (June 2005) ;-)
>>     

I've sent a patch to cause this part of the test to now be run.

> Probably the last error check should simply be removed, since we expect
> the call to succeed.

AccessCheck can return TRUE but still set the last error. AccessCheck 
only returns FALSE if an invalid parameter is input or there is 
something wrong with the token being checked against. It can return TRUE 
but set last error if access to the object secured by the security 
descriptor was denied.

-- 
Rob Shearman



From julliard at winehq.org  Mon Feb 18 14:09:36 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 18 Feb 2008 21:09:36 +0100
Subject: [advapi32/tests #2] Don't set last error to 0 so we can check
	if	it has changed
In-Reply-To: <47B9E2AE.2060402@codeweavers.com> (Robert Shearman's message of
	"Mon, 18 Feb 2008 19:55:26 +0000")
References: <47B702E7.2060506@gmail.com> <87lk5ixv29.fsf@wine.dyndns.org>
	<229cc3050802180645y7693a8c4ic73332b4f761bfcf@mail.gmail.com>
	<87bq6exd1y.fsf@wine.dyndns.org> <47B9E2AE.2060402@codeweavers.com>
Message-ID: <877ih2xbzz.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> AccessCheck can return TRUE but still set the last error. AccessCheck
> only returns FALSE if an invalid parameter is input or there is
> something wrong with the token being checked against. It can return
> TRUE but set last error if access to the object secured by the
> security descriptor was denied.

Yes, you have to check both the return value and the AccessStatus value,
but if both succeed there's no reason to expect last error to be set.
If it is really set in that case on Windows then the test needs to be
fixed to reflect that fact.

-- 
Alexandre Julliard
julliard at winehq.org


From wine.dev at web.de  Mon Feb 18 14:20:47 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Mon, 18 Feb 2008 21:20:47 +0100
Subject: Autoplay considered harmful
In-Reply-To: <19e31a080802160809k1193d71fp8a57334e763af778@mail.gmail.com>
References: <a71bd89a0802160558l7e9b5af9k10e714454ead8c23@mail.gmail.com>
	<19e31a080802160809k1193d71fp8a57334e763af778@mail.gmail.com>
Message-ID: <1203366047.8071.6.camel@p4>

On Sa, 2008-02-16 at 11:09 -0500, Steven Edwards wrote:

> I was actually thinking about this today. The right method would be to
> use HAL notification events to prompt the user if they want to autorun
> when sticking a new cdrom in. There could even be warning text in the
> dialog so that if it pops up with other device insertion, the user
> would know that it could be a virus.

It is the right way, but this must be done in the Desktop Environment.

The new Gnome Version has support for this features (Autoplay).



-- 
 
By by ... Detlef




From weber.vincent at gmail.com  Mon Feb 18 14:25:25 2008
From: weber.vincent at gmail.com (Vincent Weber)
Date: Mon, 18 Feb 2008 21:25:25 +0100
Subject: [feature requist] Glide API support
Message-ID: <ee59d8c70802181225l1b871193md11e7dff3579103c@mail.gmail.com>

Dear Wine devs,

There are some games out there that were built with the Glide API. The Glide
API is the graphics API of the 3dfx Voodoo cards and is basically a stripped
down version of OpenGL. Could please consider adding support for the Glide
API because I, and other have games that requires this API to be able to run
under Wine. Now I know that there are Glide wrappers but they don't seem to
work for a lot of people, including me, and Glide has been a very popular
game API in the mid- to late 90's.

Thanks in advance,

Vincent Weber,
weber dot vincent at gmail dot com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080218/87ee810f/attachment.htm 

From research at science.su  Mon Feb 18 14:21:46 2008
From: research at science.su (L. Rahyen)
Date: Mon, 18 Feb 2008 20:21:46 +0000
Subject: Do we need a forum?
In-Reply-To: <b6bb06270802181144q1d636858l1dfd5c33cec45915@mail.gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802181835.15391.research@science.su>
	<b6bb06270802181144q1d636858l1dfd5c33cec45915@mail.gmail.com>
Message-ID: <200802182021.47203.research@science.su>

On Monday February 18 2008 19:44:08 Austin English wrote:
> On Feb 18, 2008 12:35 PM, L. Rahyen <research at science.su> wrote:
> >         Of course, there is some people who like forums. If we decide to
> > create forum specifically for them, it is important to have possibility
> > to subscribe for receiving all (full) messages from the forum to e-mail
> > with direct link to reply page for corresponding message, and ability to
> > login permanently without stupid timeout (using cookies). In fact there
> > is some forums like this (unfortunately, all of them are unrelated to
> > WINE) and they are pretty usable (however, personally I like mailing
> > lists more, and didn't used forums for a long time). Of course, if there
> > is no volunteer(s) to create and support such forum - then wine-users is
> > enough I think.
>
> In my experience, the 'older' crowd prefers newsgroups, but 'younger'
> people prefer message boards. Similar to how more advanced users
> prefer CLI, but inexperienced/novices use GUI. It seems to me we're
> trying to help the gui type of person, and a message board would be an
> easier way to do this, IMHO.

	Then what exactly we want? It is useful to decide what we need. For example, 
phpBB forum with certain mods/modifications to give functionality I 
mentioned. If we agree with this (or decide to choose something else), then 
we can discuss next details, etc.
	In fact, if we decide to create phpBB forum, I can help here. I have 
programming experience with this in the past, and I can create ready-for-use 
forum if we decide we need this (of course I can make also its design, etc.). 
Also, I can give hosting on my server.
	But first, we should make decision what we need. If above offer is 
acceptable, then design details can be discussed farther. If not then what is 
acceptable.


From thunderbird2k at gmx.net  Mon Feb 18 14:42:13 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Mon, 18 Feb 2008 21:42:13 +0100
Subject: [feature requist] Glide API support
In-Reply-To: <ee59d8c70802181225l1b871193md11e7dff3579103c@mail.gmail.com>
References: <ee59d8c70802181225l1b871193md11e7dff3579103c@mail.gmail.com>
Message-ID: <20080218204213.15010@gmx.net>

> Dear Wine devs,
> 
> There are some games out there that were built with the Glide API. The
> Glide
> API is the graphics API of the 3dfx Voodoo cards and is basically a
> stripped
> down version of OpenGL. Could please consider adding support for the Glide
> API because I, and other have games that requires this API to be able to
> run
> under Wine. Now I know that there are Glide wrappers but they don't seem
> to
> work for a lot of people, including me, and Glide has been a very popular
> game API in the mid- to late 90's.
> 
> Thanks in advance,
> 
> Vincent Weber,
> weber dot vincent at gmail dot com

The policy is roughly to ship dlls that are a core part of Windows. Yes there are glide wrappers and quite a bunch of those succesfuly work on Wine. Personally I don't know actual names but a lot of users have used Glide->OpenGL and even Glide->Direct3D wrappers without issues.

Roderick
-- 
Psst! Geheimtipp: Online Games kostenlos spielen bei den GMX Free Games! 
http://games.entertainment.web.de/de/entertainment/games/free


From jeffzaroyko at gmail.com  Mon Feb 18 14:48:59 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Mon, 18 Feb 2008 20:48:59 +0000 (UTC)
Subject: How should we treat users on bugzilla?
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<a71bd89a0802172201m6ec55fedy2488ce62a03ffc04@mail.gmail.com>
	<b6bb06270802180949l190e8666uac45885f020946cc@mail.gmail.com>
	<b050a5e70802181021j1bac0f48l2aada80a845b087b@mail.gmail.com>
Message-ID: <loom.20080218T203047-484@post.gmane.org>

Zachary Goldberg <zgold550 <at> gmail.com> writes:

> 
> On Feb 18, 2008 12:49 PM, Austin English <austinenglish <at> gmail.com> wrote:
> >
> > On Feb 18, 2008 12:01 AM, Dan Kegel <dank <at> kegel.com> wrote:
> > > Tlarhices wrote:
> > > > In my opinion the main problem is that the bug tracker is too easy to
> > > > find and the forum too hard to find.
> > >
> > > The appdb is our forum, and it's quite easy to find.
> > >
> > > I do agree it could use some interface improvements.
> > > For instance, I think the front page is too crowded.
> > >
> > > Also, the 'browse by rating' feature (thanks for adding it!)
> > > needs to list apps sorted by name; the current seemingly-random
> > > sort order isn't very useful.
> > > - Dan
> > >
> > >
> > >
> >
> > What's the possibility of a winehq forum? There seem to be a few
> > floating around online, but none are too popular. This fragments users
> > looking for help, and doesn't give those wanting to help a consistent
> > place to look. Plus, it's sort of hard to use AppDB to try and get
> > help with compiling wine, figuring out driver/wine issues, and other
> > things that aren't really related to a single application.
> >
> > -Austin
> >
> >
> 
> Would that be too redundant with the user mailing list?
> 
> --Zach
> 
> 

I've been thinking about the appdb from a usability point of view
and why some people might think of it as being not much of a forum.

looking at the design of the appdb as a "forum", does anyone else 
think that the pages potentially have too many things going on? I see          
                                        
5 different things here                         
                                                                       
http://appdb.winehq.org/objectManager.php?sClass=version&iId=7591 
                                  
1. test results
2. open bugs 
3. warnings 
4. howtos                                                                
5. discussions for the app since the beginning of time

although I think it might be a bit busy, rather than fundamentally
change the way it looks, I think that the existing data and structure
can be reused to provide something closer to the look and feel of a more
modern forum.   The idea is that a different view be provided of the data,
here http://appdb.winehq.org/appbrowse.php we have a list of categories
which can be forum areas

* Games	Games
* Multimedia
* Graphics, Audio and Video
* Networking & Communication
* Productivit
* Programming / Software Engineering
* Reference/Documentation/Info
* Scientific/Technical/Math
* Special Purpose	
* Utilities

Which would look something like this: http://www.scienceforums.net/forum/

Within these areas, visible would be all posts for all applications in that
category, sorted by date, visible would be the subject and the specific app name.

which would look quite similar to this:

http://www.scienceforums.net/forum/forumdisplay.php?f=19


This setup would mean that a user could either post in this new "forum" area,
select their specific app version and we would then automatically retain app
specific comments on the individual appdb pages and also have a more friendly
interface at the same time.

I don't think it'd be too hard to implement either, as there shouldn't be any
need for a change to database schema.




From dank at kegel.com  Mon Feb 18 14:51:36 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 18 Feb 2008 12:51:36 -0800
Subject: How should we treat users on bugzilla?
In-Reply-To: <b050a5e70802181021j1bac0f48l2aada80a845b087b@mail.gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<a71bd89a0802172201m6ec55fedy2488ce62a03ffc04@mail.gmail.com>
	<b6bb06270802180949l190e8666uac45885f020946cc@mail.gmail.com>
	<b050a5e70802181021j1bac0f48l2aada80a845b087b@mail.gmail.com>
Message-ID: <a71bd89a0802181251g77ed27fen717dcb2be818ab7@mail.gmail.com>

On Feb 18, 2008 10:21 AM, Zachary Goldberg <zgold550 at gmail.com> wrote:
> > > The appdb is our forum, and it's quite easy to find.
> >
> > What's the possibility of a winehq forum? There seem to be a few
> > floating around online, but none are too popular. This fragments users
> > looking for help, and doesn't give those wanting to help a consistent
> > place to look. Plus, it's sort of hard to use AppDB to try and get
> > help with compiling wine, figuring out driver/wine issues, and other
> > things that aren't really related to a single application.
>
> Would that be too redundant with the user mailing list?

As I said above, the appdb is enough of a forum for us.
The mailing list is the right place for general discussion.

There has been some talk of moving the mailing list to a
system with a better web interface, one that allows
posting from the web, but there doesn't seem to be enough
reason to do it.

Adding one more discussion area would just fragment the
discussion.  Better that we use the existing ones, I think.
- Dan


From jeffzaroyko at gmail.com  Mon Feb 18 15:01:25 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Mon, 18 Feb 2008 21:01:25 +0000 (UTC)
Subject: [feature requist] Glide API support
References: <ee59d8c70802181225l1b871193md11e7dff3579103c@mail.gmail.com>
	<20080218204213.15010@gmx.net>
Message-ID: <loom.20080218T205939-773@post.gmane.org>

Roderick Colenbrander <thunderbird2k <at> gmx.net> writes:

> The policy is roughly to ship dlls that are a core part of Windows. Yes there
are glide wrappers and quite a
> bunch of those succesfuly work on Wine. Personally I don't know actual names
but a lot of users have used
> Glide->OpenGL and even Glide->Direct3D wrappers without issues.
> 
> Roderick


I've had the most success with this wrapper.  http://www.zeckensack.de/glide/



From arbuckle911 at gmail.com  Mon Feb 18 15:07:46 2008
From: arbuckle911 at gmail.com (Christopher Harvey)
Date: Mon, 18 Feb 2008 16:07:46 -0500
Subject: Do we need a forum?
In-Reply-To: <200802182021.47203.research@science.su>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>	<200802181835.15391.research@science.su>	<b6bb06270802181144q1d636858l1dfd5c33cec45915@mail.gmail.com>
	<200802182021.47203.research@science.su>
Message-ID: <47B9F3A2.4090204@gmail.com>

L. Rahyen wrote:
> On Monday February 18 2008 19:44:08 Austin English wrote:
>   
>> On Feb 18, 2008 12:35 PM, L. Rahyen <research at science.su> wrote:
>>     
>>>         Of course, there is some people who like forums. If we decide to
>>> create forum specifically for them, it is important to have possibility
>>> to subscribe for receiving all (full) messages from the forum to e-mail
>>> with direct link to reply page for corresponding message, and ability to
>>> login permanently without stupid timeout (using cookies). In fact there
>>> is some forums like this (unfortunately, all of them are unrelated to
>>> WINE) and they are pretty usable (however, personally I like mailing
>>> lists more, and didn't used forums for a long time). Of course, if there
>>> is no volunteer(s) to create and support such forum - then wine-users is
>>> enough I think.
>>>       
>> In my experience, the 'older' crowd prefers newsgroups, but 'younger'
>> people prefer message boards. Similar to how more advanced users
>> prefer CLI, but inexperienced/novices use GUI. It seems to me we're
>> trying to help the gui type of person, and a message board would be an
>> easier way to do this, IMHO.
>>     
>
> 	Then what exactly we want? It is useful to decide what we need. For example, 
> phpBB forum with certain mods/modifications to give functionality I 
> mentioned. If we agree with this (or decide to choose something else), then 
> we can discuss next details, etc.
> 	In fact, if we decide to create phpBB forum, I can help here. I have 
> programming experience with this in the past, and I can create ready-for-use 
> forum if we decide we need this (of course I can make also its design, etc.). 
> Also, I can give hosting on my server.
> 	But first, we should make decision what we need. If above offer is 
> acceptable, then design details can be discussed farther. If not then what is 
> acceptable.
>
>
>
>   
I agree with Austin. Mailing lists are faster and come with less bloat
and wasted time waiting for icons to load. I'm assuming most people use
an e-mail client like Thunderbird or evolution. What do we have to gain
with a forum? The biggest loss with a forum would be more stress and
dependence on the server....besides, mailing lists are the standard for
this sort of thing.


From research at science.su  Mon Feb 18 15:48:11 2008
From: research at science.su (L. Rahyen)
Date: Mon, 18 Feb 2008 21:48:11 +0000
Subject: Do we need a forum?
In-Reply-To: <47B9F3A2.4090204@gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802182021.47203.research@science.su>
	<47B9F3A2.4090204@gmail.com>
Message-ID: <200802182148.12200.research@science.su>

On Monday February 18 2008 21:07:46 Christopher Harvey wrote:
> L. Rahyen wrote:
> > On Monday February 18 2008 19:44:08 Austin English wrote:
> >> On Feb 18, 2008 12:35 PM, L. Rahyen <research at science.su> wrote:
> >>>         Of course, there is some people who like forums. If we decide
> >>> to create forum specifically for them, it is important to have
> >>> possibility to subscribe for receiving all (full) messages from the
> >>> forum to e-mail with direct link to reply page for corresponding
> >>> message, and ability to login permanently without stupid timeout (using
> >>> cookies). In fact there is some forums like this (unfortunately, all of
> >>> them are unrelated to WINE) and they are pretty usable (however,
> >>> personally I like mailing lists more, and didn't used forums for a long
> >>> time). Of course, if there is no volunteer(s) to create and support
> >>> such forum - then wine-users is enough I think.
> >>
> >> In my experience, the 'older' crowd prefers newsgroups, but 'younger'
> >> people prefer message boards. Similar to how more advanced users
> >> prefer CLI, but inexperienced/novices use GUI. It seems to me we're
> >> trying to help the gui type of person, and a message board would be an
> >> easier way to do this, IMHO.
> >
> > 	Then what exactly we want? It is useful to decide what we need. For
> > example, phpBB forum with certain mods/modifications to give
> > functionality I mentioned. If we agree with this (or decide to choose
> > something else), then we can discuss next details, etc.
> > 	In fact, if we decide to create phpBB forum, I can help here. I have
> > programming experience with this in the past, and I can create
> > ready-for-use forum if we decide we need this (of course I can make also
> > its design, etc.). Also, I can give hosting on my server.
> > 	But first, we should make decision what we need. If above offer is
> > acceptable, then design details can be discussed farther. If not then
> > what is acceptable.
>
> I agree with Austin. Mailing lists are faster and come with less bloat
> and wasted time waiting for icons to load. I'm assuming most people use
> an e-mail client like Thunderbird or evolution. What do we have to gain
> with a forum?

	Yeah, I agree. This is why I like mailing list more than forums. But some 
users prefer forums. Just see how many users use forums for general 
WINE-related discussions, and compare this to mailing list activity.
	if we decide that we need a forum, I can help here as I said 
already. But I don't have strong opinion here (because, as I said, I like 
mailing lists more than forums; however, if there is demand + positive 
decision in the developer community I will be glad to help anyway).
	So if someone think that we need such forum - please tell about this! There 
is no point in whole this discussion if there is no demand for this...

> The biggest loss with a forum would be more stress and
> dependence on the server....besides, mailing lists are the standard for
> this sort of thing.

	Actually, forums are the standard also. There is a lot of projects who have 
forums for general discussion. Personally I don't like this at all, 
registration and posting almost always are very complex and annoying; this 
another reason why I like mailing lists more. But this isn't as bad as it 
seems, because it is possible to create better forums, without such 
drawbacks (and I can try to do this in case of positive decision). Server 
isn't a problem, I can give my server for this purpose. And of course mailing 
list will stay as is (so users will be able to choose between official 
mailing list and official forum).
	Question is, will be a (official) forum a useful *addition* (for our users) 
to what we have now or not?...


From julliard at winehq.org  Mon Feb 18 16:07:34 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 18 Feb 2008 23:07:34 +0100
Subject: [1/16] msxml3: Support functions for typelib
In-Reply-To: <fpbp7l$t4$1@ger.gmane.org> (Alistair Leslie-Hughes's message of
	"Mon, 18 Feb 2008 22:12:59 +1100")
References: <fp15a2$u7m$1@ger.gmane.org> <878x1lc5ds.fsf@wine.dyndns.org>
	<fpbp7l$t4$1@ger.gmane.org>
Message-ID: <87y79hx6jd.fsf@wine.dyndns.org>

"Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> writes:

> What is the best course of actions?
> 1. AddRef in get_typeinfo and therefore Release in GetIDsOfNames and Invoke
> or
> 2. AddRef in GetTypeInfo, and nothing else has to be changed.

You have to follow the COM rules, so 1.

-- 
Alexandre Julliard
julliard at winehq.org


From jeffzaroyko at gmail.com  Mon Feb 18 16:10:52 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Mon, 18 Feb 2008 22:10:52 +0000 (UTC)
Subject: Do we need a forum?
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802182021.47203.research@science.su>
	<47B9F3A2.4090204@gmail.com>
	<200802182148.12200.research@science.su>
Message-ID: <loom.20080218T220443-27@post.gmane.org>

L. Rahyen <research <at> science.su> writes:


> 	Actually, forums are the standard also. There is a lot of projects who have 
> forums for general discussion. Personally I don't like this at all, 
> registration and posting almost always are very complex and annoying; this 
> another reason why I like mailing lists more. But this isn't as bad as it 
> seems, because it is possible to create better forums, without such 
> drawbacks (and I can try to do this in case of positive decision). Server 
> isn't a problem, I can give my server for this purpose. And of course mailing 
> list will stay as is (so users will be able to choose between official 
> mailing list and official forum).
> 	Question is, will be a (official) forum a useful *addition* (for our users) 
> to what we have now or not?...
> 

We already have a forum, the appdb.  

I think it just needs some work to make what we have, better so that it
actually looks like a forum, as I elaborated on in this post here

http://article.gmane.org/gmane.comp.emulators.wine.devel/57058

It's just a matter of some modification to create a better user interface,
there's no need to create a new forum, just change how we can view and
interact with the existing data.
 






From mstefani at redhat.com  Mon Feb 18 16:31:19 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Mon, 18 Feb 2008 23:31:19 +0100
Subject: [PATCH 2/3] gdi32: Move EnumFontFamiliesEx16() and helper
	functions to gdi16.c.
In-Reply-To: <20080218222516.GB379@redhat.com>
References: <20080218222516.GB379@redhat.com>
Message-ID: <47BA0737.9040805@redhat.com>

Michael Stefaniuc wrote:
> ---
> This duplicates for now the FONT_LogFont16ToW() function but Alexandre
It duplicates FONT_LogFontWTo16() and not FONT_LogFont16ToW() (that one
was already duplicated).

> told me on irc that he removed the other user of it in an yet unpublished
> patch. Thus FONT_LogFont16ToW() can be removed from font.c in a later
FONT_LogFontWTo16() can be removed later on.

> patch.
> 

bye
	michael


From stefandoesinger at gmx.at  Mon Feb 18 16:33:58 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 18 Feb 2008 23:33:58 +0100
Subject: iTunes
In-Reply-To: <d6c5d7290802172134h1c2745aav917531221ff227ca@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<b130c85e0802172118x770adbe9vdc8510ecbc410f76@mail.gmail.com>
	<d6c5d7290802172134h1c2745aav917531221ff227ca@mail.gmail.com>
Message-ID: <200802182334.05448.stefandoesinger@gmx.at>

Am Montag, 18. Februar 2008 06:34:04 schrieb Edward Savage:
> Maarten why not focus on supporting applications that don't have viable
> open source solutions first? I can think of hundreds.
>
> The only thing iTunes will add, with full support, is ipod syncing (that
> isn't useless).
>
> Or should we avoid that debate?
I think it would probably be better not to debate, but the issue is this: For 
you there are viable itunes alternatives, and for you there are other 
applications which do not have alternatives. Compare this to the discussions 
wether working on Microsoft Office is a waste of time or not. Everyone has 
other expectations, so it is *very* hard to judge which application will be 
useful and which not.

In the same way the usefullness of $APP in Wine differs from person to person. 
A bug which is worth a small remark on a review for one person is a killer 
bug for another.

To come back to iTunes, I have met a few people who considered Linux but were 
stopped by iTunes for various reasons. Some may seem laughable to tech-savy 
people(Other apps look differently), some are technically reasonable(iTunes 
shop, DRM support). Of couse you can find 100 reasons why AutoCAD is more 
important than iTunes, but you can also find 100 reasons why iTunes is more 
important than ACAD
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080218/758cae8c/attachment.pgp 

From winehacker at gmail.com  Mon Feb 18 16:51:07 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 18 Feb 2008 17:51:07 -0500
Subject: Do we need a forum?
In-Reply-To: <loom.20080218T220443-27@post.gmane.org>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802182021.47203.research@science.su> <47B9F3A2.4090204@gmail.com>
	<200802182148.12200.research@science.su>
	<loom.20080218T220443-27@post.gmane.org>
Message-ID: <19e31a080802181451m4c626b59xd3993d738c7e89c7@mail.gmail.com>

On Feb 18, 2008 5:10 PM, Jeff Zaroyko <jeffzaroyko at gmail.com> wrote:
> We already have a forum, the appdb.

appdb seems limited by default to being about applications. What about
discussion issues with other linux distros, solaris, OS X and forks of
Wine? That was the purpose of http://www.wine-forum.org

It should cover everything the appdb forum does not.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From jeffzaroyko at gmail.com  Mon Feb 18 17:13:20 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Mon, 18 Feb 2008 23:13:20 +0000 (UTC)
Subject: Do we need a forum?
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802182021.47203.research@science.su>
	<47B9F3A2.4090204@gmail.com>
	<200802182148.12200.research@science.su>
	<loom.20080218T220443-27@post.gmane.org>
	<19e31a080802181451m4c626b59xd3993d738c7e89c7@mail.gmail.com>
Message-ID: <loom.20080218T230451-646@post.gmane.org>

Steven Edwards <winehacker <at> gmail.com> writes:

> 
> On Feb 18, 2008 5:10 PM, Jeff Zaroyko <jeffzaroyko <at> gmail.com> wrote:
> > We already have a forum, the appdb.
> 
> appdb seems limited by default to being about applications. What about
> discussion issues with other linux distros, solaris, OS X and forks of
> Wine? That was the purpose of http://www.wine-forum.org
> 
> It should cover everything the appdb forum does not.
> 

I don't see what you mean, the majority of discussion or request for help
with wine is to do with applications, if a user is experiencing a problem
with an application on any distro it still relevant to the application.

This is why I think that my idea of simply creating useful view of the
current data and a slightly different styled interface would be better
than websites like wine-forum.org.

I don't see the point in discussing forks of wine in a _wine_ discussion
forum, discussion of other projects should be elsewhere imo.






From research at science.su  Mon Feb 18 17:57:41 2008
From: research at science.su (L. Rahyen)
Date: Mon, 18 Feb 2008 23:57:41 +0000
Subject: Do we need a forum?
In-Reply-To: <loom.20080218T220443-27@post.gmane.org>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802182148.12200.research@science.su>
	<loom.20080218T220443-27@post.gmane.org>
Message-ID: <200802182357.41785.research@science.su>

On Monday February 18 2008 22:10:52 Jeff Zaroyko wrote:
> L. Rahyen <research <at> science.su> writes:
> > 	Actually, forums are the standard also. There is a lot of projects who
> > have forums for general discussion. Personally I don't like this at all,
> > registration and posting almost always are very complex and annoying;
> > this another reason why I like mailing lists more. But this isn't as bad
> > as it seems, because it is possible to create better forums, without such
> > drawbacks (and I can try to do this in case of positive decision). Server
> > isn't a problem, I can give my server for this purpose. And of course
> > mailing list will stay as is (so users will be able to choose between
> > official mailing list and official forum).
> > 	Question is, will be a (official) forum a useful *addition* (for our
> > users) to what we have now or not?...
>
> We already have a forum, the appdb.
>
> I think it just needs some work to make what we have, better so that it
> actually looks like a forum, as I elaborated on in this post here
>
> http://article.gmane.org/gmane.comp.emulators.wine.devel/57058
>
> It's just a matter of some modification to create a better user interface,
> there's no need to create a new forum, just change how we can view and
> interact with the existing data.

	It is important that someone actually started to work on this 
otherwise your idea will never be actually implemented (in near future at 
least). For me, for example, this is to hard to implement because I don't 
know AppDB good enough and have very limited free time.
	And personally I think that it will be too hard even for someone who knows 
AppDB very well. Also, there is naming confusion ("WINE forum" and "AppDB 
forum" - this will not allow users to find easily official WINE forum). And 
of course currently AppDB isn't specified as a forum at all (just try in 
Google "AppDB forum" - it seems that no one call AppDB "forum"). Another 
problem is that not all questions/comments are related to one particular 
application or applications at all - for example, general question about 
compile issues or other problems are possible (just compare wine-users 
archive with AppDB to see the difference).
	Currently it's hard for newbie to find a official WINE forum (try in Google 
for example "WINE forum linux"); well, this is because there is no official 
WINE forum currently... So most users who want to discuss WINE related issues 
in a forum discuss them on general Linux/distribution' forums.
	Unfortunately, it is almost impossible to read all such forums, this is 
really too much "fragmented", this leads to some inefficiencies: sometimes 
WINE related questions on such forums cannot receive useful answer for a long 
time. Even worse, even if I find some question that I can quickly answer on 
the forum, it is impossible to do so without time consuming registration 
process. In fact there was some cases when I searched for some WINE related 
issues, find someone's unanswered question that I can answer quickly, but 
never find enough time and motivation to register.
	This is actually the problem that should be addressed if we decide to create 
forum. Registration shouldn't be required. At most (for protection from spam 
bots), few digits from a small picture should be entered by unregistered 
users before posting and that's all. As I said earlier, it is also important 
to have ability to subscribe for all messages from the forum otherwise 
(reliable) user support will be hard. And there is a lot of other important 
issues... By the way, http://wine-forum.org don't have these important 
features at all (just a note).
	And of course, I'm able to implement myself everything I'm talking above, 
with well looking design. But I will do this only if there is demand in 
this... That is, if it would be decided to create forum I will be glad to 
help, but if not then there is no point in creating of something that is 
intended for the community and isn't demanded high enough by this community.
	As I already said, I like mailing lists much more than forums, so my opinion 
about usefulness/uselessness of the forum is neutral. But I think it is 
useful to discuss this topic so right decision can be made (create or not to 
create the forum, or find other solution(s), or don't change anything at all) 
as a result of the discussion.


From m.b.lankhorst at gmail.com  Mon Feb 18 18:02:43 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 18 Feb 2008 16:02:43 -0800
Subject: iTunes
In-Reply-To: <200802182334.05448.stefandoesinger@gmx.at>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<b130c85e0802172118x770adbe9vdc8510ecbc410f76@mail.gmail.com>
	<d6c5d7290802172134h1c2745aav917531221ff227ca@mail.gmail.com>
	<200802182334.05448.stefandoesinger@gmx.at>
Message-ID: <b130c85e0802181602n6ee6f5e9ua687c2a50a4258d6@mail.gmail.com>

2008/2/18, Stefan D?singer <stefandoesinger at gmx.at>:
> Am Montag, 18. Februar 2008 06:34:04 schrieb Edward Savage:
> > Maarten why not focus on supporting applications that don't have viable
> > open source solutions first? I can think of hundreds.
> >
> > The only thing iTunes will add, with full support, is ipod syncing (that
> > isn't useless).
> >
> > Or should we avoid that debate?
> I think it would probably be better not to debate, but the issue is this: For
> you there are viable itunes alternatives, and for you there are other
> applications which do not have alternatives. Compare this to the discussions
> wether working on Microsoft Office is a waste of time or not. Everyone has
> other expectations, so it is *very* hard to judge which application will be
> useful and which not.
>
> In the same way the usefullness of $APP in Wine differs from person to person.
> A bug which is worth a small remark on a review for one person is a killer
> bug for another.
>
> To come back to iTunes, I have met a few people who considered Linux but were
> stopped by iTunes for various reasons. Some may seem laughable to tech-savy
> people(Other apps look differently), some are technically reasonable(iTunes
> shop, DRM support). Of couse you can find 100 reasons why AutoCAD is more
> important than iTunes, but you can also find 100 reasons why iTunes is more
> important than ACAD
Well I bought an ipod touch. But there are no other apps then iTunes
that can do the firmware upload so it's sort of laying on my desk
until I can figure it out. That aside, the alternatives rely on
tactics that are similar to loading malware. Real alternatives for
iTunes? Not so much.

Cheers,
Maarten.


From winehacker at gmail.com  Mon Feb 18 18:55:23 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 18 Feb 2008 19:55:23 -0500
Subject: Do we need a forum?
In-Reply-To: <200802182357.41785.research@science.su>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802182148.12200.research@science.su>
	<loom.20080218T220443-27@post.gmane.org>
	<200802182357.41785.research@science.su>
Message-ID: <19e31a080802181655u89f9fe4yad12edeeb31327bd@mail.gmail.com>

On Feb 18, 2008 6:57 PM, L. Rahyen <research at science.su> wrote:

>         And personally I think that it will be too hard even for someone who knows
> AppDB very well. Also, there is naming confusion ("WINE forum" and "AppDB
> forum" - this will not allow users to find easily official WINE forum). And
> of course currently AppDB isn't specified as a forum at all (just try in
> Google "AppDB forum" - it seems that no one call AppDB "forum"). Another
> problem is that not all questions/comments are related to one particular
> application or applications at all - for example, general question about
> compile issues or other problems are possible (just compare wine-users
> archive with AppDB to see the difference).

We discussed this at wineconf and could not reach consensus on what would be the
best method.

>         Currently it's hard for newbie to find a official WINE forum (try in Google
> for example "WINE forum linux"); well, this is because there is no official
> WINE forum currently... So most users who want to discuss WINE related issues
> in a forum discuss them on general Linux/distribution' forums.

That was the idea in creating wine-forum. It would be one forum to
bind them all so to
speak. Currently wine discussion is fragmented across various forums
in ubuntu, gentoo,
Play on Linux, Winedoors, etc

>         Unfortunately, it is almost impossible to read all such forums, this is
> really too much "fragmented", this leads to some inefficiencies: sometimes
> WINE related questions on such forums cannot receive useful answer for a long
> time. Even worse, even if I find some question that I can quickly answer on
> the forum, it is impossible to do so without time consuming registration
> process. In fact there was some cases when I searched for some WINE related
> issues, find someone's unanswered question that I can answer quickly, but
> never find enough time and motivation to register.
>         This is actually the problem that should be addressed if we decide to create
> forum. Registration shouldn't be required. At most (for protection from spam
> bots), few digits from a small picture should be entered by unregistered
> users before posting and that's all. As I said earlier, it is also important
> to have ability to subscribe for all messages from the forum otherwise
> (reliable) user support will be hard. And there is a lot of other important
> issues... By the way, http://wine-forum.org don't have these important
> features at all (just a note).
>         And of course, I'm able to implement myself everything I'm talking above,
> with well looking design. But I will do this only if there is demand in
> this... That is, if it would be decided to create forum I will be glad to
> help, but if not then there is no point in creating of something that is
> intended for the community and isn't demanded high enough by this community.
>         As I already said, I like mailing lists much more than forums, so my opinion
> about usefulness/uselessness of the forum is neutral. But I think it is
> useful to discuss this topic so right decision can be made (create or not to
> create the forum, or find other solution(s), or don't change anything at all)
> as a result of the discussion.

As I stated, we discussed this at wineconf and consesus was not
reached. Dan wanted to use google groups, others want to keep mailing
lists, while others still want to use the newsgroups. wine-forum is
run by Tom Wickline who is a long time wine contributor so while I
would support a better system that integrates with appdb and the
winehq mainsite better, I am leery of yet another system if its not
going to have someone or someones dedicated to maintain it for years
to come. Also as I stated, I don't think appdb is covers every
discussion topic unless you extend it to support distros, Wine forks,
winelib application projects, etc. Tom is committed to doing this with
wine-forum. If there is something you don't like, such as the
registration, advertisements, etc I am sure he is willing to adjust
the user experience.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From research at science.su  Mon Feb 18 19:19:57 2008
From: research at science.su (L. Rahyen)
Date: Tue, 19 Feb 2008 01:19:57 +0000
Subject: Do we need a forum?
In-Reply-To: <19e31a080802181655u89f9fe4yad12edeeb31327bd@mail.gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802182357.41785.research@science.su>
	<19e31a080802181655u89f9fe4yad12edeeb31327bd@mail.gmail.com>
Message-ID: <200802190119.57809.research@science.su>

On Tuesday February 19 2008 00:55:23 Steven Edwards wrote:
> On Feb 18, 2008 6:57 PM, L. Rahyen <research at science.su> wrote:
> >         And personally I think that it will be too hard even for someone
> > who knows AppDB very well. Also, there is naming confusion ("WINE forum"
> > and "AppDB forum" - this will not allow users to find easily official
> > WINE forum). And of course currently AppDB isn't specified as a forum at
> > all (just try in Google "AppDB forum" - it seems that no one call AppDB
> > "forum"). Another problem is that not all questions/comments are related
> > to one particular application or applications at all - for example,
> > general question about compile issues or other problems are possible
> > (just compare wine-users archive with AppDB to see the difference).
>
> We discussed this at wineconf and could not reach consensus on what would
> be the best method.
>
> >         Currently it's hard for newbie to find a official WINE forum (try
> > in Google for example "WINE forum linux"); well, this is because there is
> > no official WINE forum currently... So most users who want to discuss
> > WINE related issues in a forum discuss them on general
> > Linux/distribution' forums.
>
> That was the idea in creating wine-forum. It would be one forum to
> bind them all so to
> speak. Currently wine discussion is fragmented across various forums
> in ubuntu, gentoo,
> Play on Linux, Winedoors, etc
>
> >         Unfortunately, it is almost impossible to read all such forums,
> > this is really too much "fragmented", this leads to some inefficiencies:
> > sometimes WINE related questions on such forums cannot receive useful
> > answer for a long time. Even worse, even if I find some question that I
> > can quickly answer on the forum, it is impossible to do so without time
> > consuming registration process. In fact there was some cases when I
> > searched for some WINE related issues, find someone's unanswered question
> > that I can answer quickly, but never find enough time and motivation to
> > register.
> >         This is actually the problem that should be addressed if we
> > decide to create forum. Registration shouldn't be required. At most (for
> > protection from spam bots), few digits from a small picture should be
> > entered by unregistered users before posting and that's all. As I said
> > earlier, it is also important to have ability to subscribe for all
> > messages from the forum otherwise (reliable) user support will be hard.
> > And there is a lot of other important issues... By the way,
> > http://wine-forum.org don't have these important features at all (just a
> > note).
> >         And of course, I'm able to implement myself everything I'm
> > talking above, with well looking design. But I will do this only if there
> > is demand in this... That is, if it would be decided to create forum I
> > will be glad to help, but if not then there is no point in creating of
> > something that is intended for the community and isn't demanded high
> > enough by this community. As I already said, I like mailing lists much
> > more than forums, so my opinion about usefulness/uselessness of the forum
> > is neutral. But I think it is useful to discuss this topic so right
> > decision can be made (create or not to create the forum, or find other
> > solution(s), or don't change anything at all) as a result of the
> > discussion.
>
> As I stated, we discussed this at wineconf and consesus was not
> reached. Dan wanted to use google groups, others want to keep mailing
> lists, while others still want to use the newsgroups. wine-forum is
> run by Tom Wickline who is a long time wine contributor so while I
> would support a better system that integrates with appdb and the
> winehq mainsite better, I am leery of yet another system if its not
> going to have someone or someones dedicated to maintain it for years
> to come.

	Well, if I created something, I will be able to maintain it as long as it 
useful. So this isn't a problem.
	Problem is that I don't see any kind of the agreement even between two 
people - so it is very difficult (or even impossible) to really create 
*official* forum in such situation... If agreement cannot be found, I think 
best idea is to not change anything.
	Well, that's not that bad - personally I think WINE community and its mailing 
lists (along with AppDB) are good enough for most users "as is".

> Also as I stated, I don't think appdb is covers every 
> discussion topic unless you extend it to support distros, Wine forks,
> winelib application projects, etc.

	That's (almost) what I said in my message (its too hard too 
implement + other issues mentioned by me and you) - so I agree with you.

> Tom is committed to doing this with 
> wine-forum. If there is something you don't like, such as the
> registration, advertisements, etc I am sure he is willing to adjust
> the user experience.

	OK, then if he is reading this list hopefully he will consider my words as 
feature request. If he really will fix these issues that would be great. 
Thanks.


From winehacker at gmail.com  Mon Feb 18 20:23:44 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 18 Feb 2008 21:23:44 -0500
Subject: Do we need a forum?
In-Reply-To: <200802190119.57809.research@science.su>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802182357.41785.research@science.su>
	<19e31a080802181655u89f9fe4yad12edeeb31327bd@mail.gmail.com>
	<200802190119.57809.research@science.su>
Message-ID: <19e31a080802181823l1a41bfb8nbd7b454d3fcb2a3a@mail.gmail.com>

On Feb 18, 2008 8:19 PM, L. Rahyen <research at science.su> wrote:
>         OK, then if he is reading this list hopefully he will consider my words as
> feature request. If he really will fix these issues that would be great.
> Thanks.

He lurks on wine-devel all the time so I am sure he wants to make the
system easy to please for everyone. I'll discuss it with him at length
off list because there was tighter integration I want to see also with
appdb.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Mon Feb 18 20:23:44 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 18 Feb 2008 21:23:44 -0500
Subject: Do we need a forum?
In-Reply-To: <200802190119.57809.research@science.su>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802182357.41785.research@science.su>
	<19e31a080802181655u89f9fe4yad12edeeb31327bd@mail.gmail.com>
	<200802190119.57809.research@science.su>
Message-ID: <19e31a080802181823l1a41bfb8nbd7b454d3fcb2a3a@mail.gmail.com>

On Feb 18, 2008 8:19 PM, L. Rahyen <research at science.su> wrote:
>         OK, then if he is reading this list hopefully he will consider my words as
> feature request. If he really will fix these issues that would be great.
> Thanks.

He lurks on wine-devel all the time so I am sure he wants to make the
system easy to please for everyone. I'll discuss it with him at length
off list because there was tighter integration I want to see also with
appdb.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From arbuckle911 at gmail.com  Mon Feb 18 20:53:16 2008
From: arbuckle911 at gmail.com (Christopher Harvey)
Date: Mon, 18 Feb 2008 21:53:16 -0500
Subject: Do we need a forum?
In-Reply-To: <200802182021.47203.research@science.su>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>	<200802181835.15391.research@science.su>	<b6bb06270802181144q1d636858l1dfd5c33cec45915@mail.gmail.com>
	<200802182021.47203.research@science.su>
Message-ID: <47BA449C.6090909@gmail.com>

L. Rahyen wrote:
> On Monday February 18 2008 19:44:08 Austin English wrote:
>   
>> On Feb 18, 2008 12:35 PM, L. Rahyen <research at science.su> wrote:
>>     
>>>         Of course, there is some people who like forums. If we decide to
>>> create forum specifically for them, it is important to have possibility
>>> to subscribe for receiving all (full) messages from the forum to e-mail
>>> with direct link to reply page for corresponding message, and ability to
>>> login permanently without stupid timeout (using cookies). In fact there
>>> is some forums like this (unfortunately, all of them are unrelated to
>>> WINE) and they are pretty usable (however, personally I like mailing
>>> lists more, and didn't used forums for a long time). Of course, if there
>>> is no volunteer(s) to create and support such forum - then wine-users is
>>> enough I think.
>>>       
>> In my experience, the 'older' crowd prefers newsgroups, but 'younger'
>> people prefer message boards. Similar to how more advanced users
>> prefer CLI, but inexperienced/novices use GUI. It seems to me we're
>> trying to help the gui type of person, and a message board would be an
>> easier way to do this, IMHO.
>>     
>
> 	Then what exactly we want? It is useful to decide what we need. For example, 
> phpBB forum with certain mods/modifications to give functionality I 
> mentioned. If we agree with this (or decide to choose something else), then 
> we can discuss next details, etc.
> 	In fact, if we decide to create phpBB forum, I can help here. I have 
> programming experience with this in the past, and I can create ready-for-use 
> forum if we decide we need this (of course I can make also its design, etc.). 
> Also, I can give hosting on my server.
> 	But first, we should make decision what we need. If above offer is 
> acceptable, then design details can be discussed farther. If not then what is 
> acceptable.
>
>
>
>   
Why not make a forum and then have winehq link to it? If it becomes
popular maybe it'll become the official one. That's the spirit of the
GPL, the way I see it, don't need popular support or permission.


From austinenglish at gmail.com  Mon Feb 18 21:11:24 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 18 Feb 2008 21:11:24 -0600
Subject: Do we need a forum?
In-Reply-To: <47BA449C.6090909@gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802181835.15391.research@science.su>
	<b6bb06270802181144q1d636858l1dfd5c33cec45915@mail.gmail.com>
	<200802182021.47203.research@science.su> <47BA449C.6090909@gmail.com>
Message-ID: <b6bb06270802181911w1276008fr382b87b8d907b5e@mail.gmail.com>

On Feb 18, 2008 8:53 PM, Christopher Harvey <arbuckle911 at gmail.com> wrote:
>
> L. Rahyen wrote:
> > On Monday February 18 2008 19:44:08 Austin English wrote:
> >
> >> On Feb 18, 2008 12:35 PM, L. Rahyen <research at science.su> wrote:
> >>
> >>>         Of course, there is some people who like forums. If we decide to
> >>> create forum specifically for them, it is important to have possibility
> >>> to subscribe for receiving all (full) messages from the forum to e-mail
> >>> with direct link to reply page for corresponding message, and ability to
> >>> login permanently without stupid timeout (using cookies). In fact there
> >>> is some forums like this (unfortunately, all of them are unrelated to
> >>> WINE) and they are pretty usable (however, personally I like mailing
> >>> lists more, and didn't used forums for a long time). Of course, if there
> >>> is no volunteer(s) to create and support such forum - then wine-users is
> >>> enough I think.
> >>>
> >> In my experience, the 'older' crowd prefers newsgroups, but 'younger'
> >> people prefer message boards. Similar to how more advanced users
> >> prefer CLI, but inexperienced/novices use GUI. It seems to me we're
> >> trying to help the gui type of person, and a message board would be an
> >> easier way to do this, IMHO.
> >>
> >
> >       Then what exactly we want? It is useful to decide what we need. For example,
> > phpBB forum with certain mods/modifications to give functionality I
> > mentioned. If we agree with this (or decide to choose something else), then
> > we can discuss next details, etc.
> >       In fact, if we decide to create phpBB forum, I can help here. I have
> > programming experience with this in the past, and I can create ready-for-use
> > forum if we decide we need this (of course I can make also its design, etc.).
> > Also, I can give hosting on my server.
> >       But first, we should make decision what we need. If above offer is
> > acceptable, then design details can be discussed farther. If not then what is
> > acceptable.
> >
> >
> >
> >
> Why not make a forum and then have winehq link to it? If it becomes
> popular maybe it'll become the official one. That's the spirit of the
> GPL, the way I see it, don't need popular support or permission.
>
>
>

If everyone seems happy the way wine-forum.org is organized, we could
simply add a link on winehq. That way we don't add another forum to
the mix, and also have one area that can gather users of wine with
winehq's blessing.

-Austin


From epssyis at gmail.com  Mon Feb 18 21:12:57 2008
From: epssyis at gmail.com (Edward Savage)
Date: Tue, 19 Feb 2008 13:12:57 +1000
Subject: Usable Wine interface
In-Reply-To: <47B99306.6030701@authmann.de>
References: <84536.27314.qm@web50106.mail.re2.yahoo.com>
	<d6c5d7290802172254v78b40728k4bad6b61a0f18b6d@mail.gmail.com>
	<47B99306.6030701@authmann.de>
Message-ID: <d6c5d7290802181912g4f9203eex7be1e424b3a16d6b@mail.gmail.com>

Thanks for this Christian.  Running the apps in their own wine window
fixes several usability issues I was having with them (as I don't like
playing games fullscreen).  Christoph how do you change between apps
in the one window, or are you using multiple?

On Feb 19, 2008 12:15 AM, Christian Authmann <spam at authmann.de> wrote:
> Edward Savage wrote:
> > I would very much like to see a --spawn-new trigger that can be added
> > to a command to start a new virtual desktop.
>
> wine explorer.exe /desktop=Name,800x600 myapp.exe
>
> a hint about that command-line trick could be added to winecfg though,
> as it seems to be quite unknown.
>
>
>


From epssyis at gmail.com  Mon Feb 18 21:29:02 2008
From: epssyis at gmail.com (Edward Savage)
Date: Tue, 19 Feb 2008 13:29:02 +1000
Subject: iTunes
In-Reply-To: <b130c85e0802181602n6ee6f5e9ua687c2a50a4258d6@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<b130c85e0802172118x770adbe9vdc8510ecbc410f76@mail.gmail.com>
	<d6c5d7290802172134h1c2745aav917531221ff227ca@mail.gmail.com>
	<200802182334.05448.stefandoesinger@gmx.at>
	<b130c85e0802181602n6ee6f5e9ua687c2a50a4258d6@mail.gmail.com>
Message-ID: <d6c5d7290802181929l791d345fx57149e9c3b08a80f@mail.gmail.com>

Does iTunes sync with devices when being run under xp in qemu or similiar?

I honestly haven't updated my ipod for a year and don't use it any
more as i haven't found a viable and easy way to do it.  Maarten will
probably be interested in the answer as well.

On Feb 19, 2008 10:02 AM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> 2008/2/18, Stefan D?singer <stefandoesinger at gmx.at>:
>
> > Am Montag, 18. Februar 2008 06:34:04 schrieb Edward Savage:
> > > Maarten why not focus on supporting applications that don't have viable
> > > open source solutions first? I can think of hundreds.
> > >
> > > The only thing iTunes will add, with full support, is ipod syncing (that
> > > isn't useless).
> > >
> > > Or should we avoid that debate?
> > I think it would probably be better not to debate, but the issue is this: For
> > you there are viable itunes alternatives, and for you there are other
> > applications which do not have alternatives. Compare this to the discussions
> > wether working on Microsoft Office is a waste of time or not. Everyone has
> > other expectations, so it is *very* hard to judge which application will be
> > useful and which not.
> >
> > In the same way the usefullness of $APP in Wine differs from person to person.
> > A bug which is worth a small remark on a review for one person is a killer
> > bug for another.
> >
> > To come back to iTunes, I have met a few people who considered Linux but were
> > stopped by iTunes for various reasons. Some may seem laughable to tech-savy
> > people(Other apps look differently), some are technically reasonable(iTunes
> > shop, DRM support). Of couse you can find 100 reasons why AutoCAD is more
> > important than iTunes, but you can also find 100 reasons why iTunes is more
> > important than ACAD
> Well I bought an ipod touch. But there are no other apps then iTunes
> that can do the firmware upload so it's sort of laying on my desk
> until I can figure it out. That aside, the alternatives rely on
> tactics that are similar to loading malware. Real alternatives for
> iTunes? Not so much.
>
> Cheers,
> Maarten.
>


From research at science.su  Mon Feb 18 21:44:50 2008
From: research at science.su (L. Rahyen)
Date: Tue, 19 Feb 2008 03:44:50 +0000
Subject: Do we need a forum?
In-Reply-To: <b6bb06270802181911w1276008fr382b87b8d907b5e@mail.gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<47BA449C.6090909@gmail.com>
	<b6bb06270802181911w1276008fr382b87b8d907b5e@mail.gmail.com>
Message-ID: <200802190344.51000.research@science.su>

On Tuesday February 19 2008 03:11:24 Austin English wrote:
> On Feb 18, 2008 8:53 PM, Christopher Harvey <arbuckle911 at gmail.com> wrote:
> > L. Rahyen wrote:
> > > On Monday February 18 2008 19:44:08 Austin English wrote:
> > >> On Feb 18, 2008 12:35 PM, L. Rahyen <research at science.su> wrote:
> > >>>         Of course, there is some people who like forums. If we decide
> > >>> to create forum specifically for them, it is important to have
> > >>> possibility to subscribe for receiving all (full) messages from the
> > >>> forum to e-mail with direct link to reply page for corresponding
> > >>> message, and ability to login permanently without stupid timeout
> > >>> (using cookies). In fact there is some forums like this
> > >>> (unfortunately, all of them are unrelated to WINE) and they are
> > >>> pretty usable (however, personally I like mailing lists more, and
> > >>> didn't used forums for a long time). Of course, if there is no
> > >>> volunteer(s) to create and support such forum - then wine-users is
> > >>> enough I think.
> > >>
> > >> In my experience, the 'older' crowd prefers newsgroups, but 'younger'
> > >> people prefer message boards. Similar to how more advanced users
> > >> prefer CLI, but inexperienced/novices use GUI. It seems to me we're
> > >> trying to help the gui type of person, and a message board would be an
> > >> easier way to do this, IMHO.
> > >
> > >       Then what exactly we want? It is useful to decide what we need.
> > > For example, phpBB forum with certain mods/modifications to give
> > > functionality I mentioned. If we agree with this (or decide to choose
> > > something else), then we can discuss next details, etc.
> > >       In fact, if we decide to create phpBB forum, I can help here. I
> > > have programming experience with this in the past, and I can create
> > > ready-for-use forum if we decide we need this (of course I can make
> > > also its design, etc.). Also, I can give hosting on my server.
> > >       But first, we should make decision what we need. If above offer
> > > is acceptable, then design details can be discussed farther. If not
> > > then what is acceptable.
> >
> > Why not make a forum and then have winehq link to it? If it becomes
> > popular maybe it'll become the official one. That's the spirit of the
> > GPL, the way I see it, don't need popular support or permission.
>
> If everyone seems happy the way wine-forum.org is organized, we could
> simply add a link on winehq. That way we don't add another forum to
> the mix, and also have one area that can gather users of wine with
> winehq's blessing.

	What I want to say is to wait 1-2 months and see what will change in 
wine-forum after this discussion. If major issues will not be fixed after 
this time then I think creating the forum from scratch is better just because 
I already have heavily modified and improved source code of phpBB forum (but 
it is somewhat old; however, updating to new version should be not very hard 
task) - so in my case much less programming is needed at the start.
	If I decide to create the forum in next few weeks, then let another 2-3 
months to pass... After this it should be possible to make elaborated 
decisions. There is no need for rush in this case I think.
	Also Christopher Harvey is right, maybe it is better to create the forum 
first and only after this + 2-4 months waiting discuss this topic again. Then 
comparison with other forums will be possible in order to pick the best. But 
as I said, I want to wait at least 3-4 weeks to see if wine-forum.org will 
start to improve or not... If not I probably will try to create something 
better.


From m.b.lankhorst at gmail.com  Mon Feb 18 22:02:05 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 18 Feb 2008 20:02:05 -0800
Subject: iTunes
In-Reply-To: <d6c5d7290802181929l791d345fx57149e9c3b08a80f@mail.gmail.com>
References: <b130c85e0802171942k199a9eck1779e9bd9e7050ab@mail.gmail.com>
	<b130c85e0802172118x770adbe9vdc8510ecbc410f76@mail.gmail.com>
	<d6c5d7290802172134h1c2745aav917531221ff227ca@mail.gmail.com>
	<200802182334.05448.stefandoesinger@gmx.at>
	<b130c85e0802181602n6ee6f5e9ua687c2a50a4258d6@mail.gmail.com>
	<d6c5d7290802181929l791d345fx57149e9c3b08a80f@mail.gmail.com>
Message-ID: <b130c85e0802182002j33899f8amf6f334701b505395@mail.gmail.com>

Hi Edward,

2008/2/18, Edward Savage <epssyis at gmail.com>:
> Does iTunes sync with devices when being run under xp in qemu or similiar?
>
> I honestly haven't updated my ipod for a year and don't use it any
> more as i haven't found a viable and easy way to do it.  Maarten will
> probably be interested in the answer as well.
It might run under vmplayer 2.0 if you add EHCI.present = "TRUE" to
your config file. However iTunes doesn't seem to really like it and
bombs out with an error in XP. (0xE8000001)

Cheers,
Maarten.


From dank at kegel.com  Mon Feb 18 23:43:33 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 18 Feb 2008 21:43:33 -0800
Subject: Do we need a forum?
Message-ID: <a71bd89a0802182143k27b6c2d6h1a834d0625cddfdc@mail.gmail.com>

Anybody who thinks we need another forum
needs his head examined.  There is no shortage
of Wine forums.  We just need to use the ones that
already exist.  Adding a new one will just fragment
the community further.

In particular, there are two forums right now
that people already use to discuss wine problems:
a generic one at
http://www.linuxforums.org/forum/wine/
and an Ubuntu-specific one at
http://ubuntuforums.org/forumdisplay.php?f=313
Let's just link to them.  I'll submit a patch to do
that in a minute.

And I like Griswold's idea (on IRC) of improving
the current appdb in small ways, e.g. changing the
reply behavior to not open up a new page.

For goodness' sake, don't create yet another new forum!
- Dan


From k04jg02 at kzoo.edu  Mon Feb 18 23:52:15 2008
From: k04jg02 at kzoo.edu (Joseph Garvin)
Date: Tue, 19 Feb 2008 00:52:15 -0500
Subject: [feature requist] Glide API support
In-Reply-To: <loom.20080218T205939-773@post.gmane.org>
References: <ee59d8c70802181225l1b871193md11e7dff3579103c@mail.gmail.com>	<20080218204213.15010@gmx.net>
	<loom.20080218T205939-773@post.gmane.org>
Message-ID: <47BA6E8F.60108@kzoo.edu>

Wouldn't a wine implementation of Glide _be_ an OpenGL wrapper? Unless 
you wanted to implement it in terms of Wine's D3D for some reason.

Jeff Zaroyko wrote:
> Roderick Colenbrander <thunderbird2k <at> gmx.net> writes:
>
>   
>> The policy is roughly to ship dlls that are a core part of Windows. Yes there
>>     
> are glide wrappers and quite a
>   
>> bunch of those succesfuly work on Wine. Personally I don't know actual names
>>     
> but a lot of users have used
>   
>> Glide->OpenGL and even Glide->Direct3D wrappers without issues.
>>
>> Roderick
>>     
>
>
> I've had the most success with this wrapper.  http://www.zeckensack.de/glide/
>
>
>
>
>   



From research at science.su  Tue Feb 19 00:09:23 2008
From: research at science.su (L. Rahyen)
Date: Tue, 19 Feb 2008 06:09:23 +0000
Subject: Do we need a forum?
In-Reply-To: <a71bd89a0802182143k27b6c2d6h1a834d0625cddfdc@mail.gmail.com>
References: <a71bd89a0802182143k27b6c2d6h1a834d0625cddfdc@mail.gmail.com>
Message-ID: <200802190609.24115.research@science.su>

On Tuesday February 19 2008 05:43:33 Dan Kegel wrote:
> Anybody who thinks we need another forum
> needs his head examined.  There is no shortage
> of Wine forums.  We just need to use the ones that
> already exist.  Adding a new one will just fragment
> the community further.
>
> In particular, there are two forums right now
> that people already use to discuss wine problems:
> a generic one at
> http://www.linuxforums.org/forum/wine/
> and an Ubuntu-specific one at
> http://ubuntuforums.org/forumdisplay.php?f=313
> Let's just link to them.  I'll submit a patch to do
> that in a minute.

	This is certainly good idea!

> And I like Griswold's idea (on IRC) of improving
> the current appdb in small ways, e.g. changing the
> reply behavior to not open up a new page.
>
> For goodness' sake, don't create yet another new forum!
> - Dan

	I agree that there is no need in "just another forum", really... Main point 
of this discussion was that winehq.org should have a link(s) to a forum(s) of 
some kind (WINE related) so users can find it easily. That's more than 
enough, actually.
	I saw your recent patch for this and I think this is exactly what was needed 
to fix the issue. So I think this topic is resolved (or, to be exact, will be 
resolved when your patch will be committed). Thank you for quick fix!


From xixsimplicityxix at gmail.com  Tue Feb 19 01:04:00 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Tue, 19 Feb 2008 01:04:00 -0600
Subject: slc: Add Initial DLL
In-Reply-To: <fpdn81$gpd$1@ger.gmane.org>
References: <fpdn81$gpd$1@ger.gmane.org>
Message-ID: <78a7dad00802182304v7d1780f9lba65d21dba5ea738@mail.gmail.com>

On Feb 18, 2008 10:48 PM, Alistair Leslie-Hughes
<leslie_alistair at hotmail.com> wrote:
> Hi,
>
> Changelog:
>         slc: Added Initial DLL
>
> Best Regards
>   Alistair Leslie-Hughes
>
>
>
>

No Patch?


From winehacker at gmail.com  Tue Feb 19 02:38:53 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 19 Feb 2008 03:38:53 -0500
Subject: Do we need a forum?
In-Reply-To: <a71bd89a0802182143k27b6c2d6h1a834d0625cddfdc@mail.gmail.com>
References: <a71bd89a0802182143k27b6c2d6h1a834d0625cddfdc@mail.gmail.com>
Message-ID: <19e31a080802190038lf6b2846wc438e79e91be79d7@mail.gmail.com>

On Feb 19, 2008 12:43 AM, Dan Kegel <dank at kegel.com> wrote:
> Anybody who thinks we need another forum
> needs his head examined.  There is no shortage
> of Wine forums.  We just need to use the ones that
> already exist.  Adding a new one will just fragment
> the community further.

The whole point of the discussion at wineconf was not adding yet
another non-official sanctioned forum but having one that was blessed
as the official go to place for information about any issue related to
Wine. If we want to bless a list of existing forums it does nothing to
reduce the fragmentation that already exists. My thoughts, as well as
Tom's was that by creating a "blessed" location, all third parties as
well as vendors that develop Wine related products could say "if you
want to discuss using a vendor provided Wine product in a
non-supported manner all are advised to go here and share information"
Right now you have POL, Winedoors, CrossOver, Cedega, Bordeaux, etc
all are Wine forks and addons that have little cross-polination of
user related issues, tips and tweaks. Because Wine does not have all
the spit and polish needed to "just work" out of the box there is a
lot of duplicate work, some done by distribution maintainers, others
done by lone hackers and still others done by Wine companies. As far
as the users or these products go, who do they talk to when they have
an unsupported issue?

Lets say a gentoo user runs Cedega for an unsupported game, maybe it
works in Winehq on Ubuntu but because of the existing forum
fragmentation, where do they look? Winehq appdb? The news group?
wine-users? Ubuntu forums? What about the CodeWeavers user running a
non-supported application on Wine 0.9.foo and he wants to know how to
drop a dll in to his CW install from stock Wine? CodeWeavers should
not support that but Wine having a stable API makes it possible for
the community to support that, provided that vendors package Wine in a
sane manner. I could go on, but I think you should get the idea.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From timothy.lee at siriushk.com  Mon Feb 18 20:01:00 2008
From: timothy.lee at siriushk.com (Timothy Lee)
Date: Tue, 19 Feb 2008 10:01:00 +0800
Subject: [PATCH]  Environment variable to specify X11 window for desktop
In-Reply-To: <20080218101444.62940@gmx.net>
References: <47B594E7.90501@siriushk.com>
	<47B5B3C9.7000308@codeweavers.com>	<47B5D4C9.3000601@siriushk.com>	<004f01c8709f$275e1f90$a600fea9@DMITRY>	<47B8E4DC.8070001@siriushk.com>	<005401c871e2$56c8b1c0$a600fea9@DMITRY>	<47B90766.5040507@siriushk.com>	<016601c871e6$dd805110$a600fea9@DMITRY>
	<47B92DFB.8000609@siriushk.com> <20080218101444.62940@gmx.net>
Message-ID: <47BA385C.1000708@siriushk.com>

Dear Roderick,

Roderick Colenbrander wrote:
> I'm just bumping into this discussion. From what I read the reason you need such functionality is for a mozilla powerpoint plugin. Have you figured out how this embedding is done on Windows? I don't know much about it but I think embedding works using COM and perhaps almost the same as e.g. Flash.
>
> For example codeweavers has a plugin to embed IE plugins in mozilla, the same for the KDE reaktivate project which did something similar for Konqueror (although it can be used on mozilla too as they put it all in a library). Likely IE plugins work differently but I think the same embedding mechanism could be used, so you won't need such an X11 hack.
>    
I've been doing some research on this during the development of my 
plugin, and came across the info on http://pptfaq.com/FAQ00153.htm, 
which mentioned that ActiveX support on PowerPoint Viewer 2003 and 2007 
were removed on purpose.  The only way to embed using COM objects is to 
install the full suite of MS Office.

Another possibility to embed PowerPoint under Windows is to make use of 
system hooks, which can intercept the creation of the slideshow window.  
I believe it could be done this way, but have not investigated further.

Regards,
Timothy


From gerald at pfeifer.com  Mon Feb 18 20:54:28 2008
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Tue, 19 Feb 2008 03:54:28 +0100 (CET)
Subject: dlls/user32/edit.c -- remove superflous check (RESEND)
In-Reply-To: <Pine.LNX.4.64.0712262215090.29138@acrux.dbai.tuwien.ac.at>
References: <Pine.LNX.4.64.0712260959170.29138@acrux.dbai.tuwien.ac.at>
	<87abnxmr3x.fsf@wine.dyndns.org>
	<Pine.LNX.4.64.0712262215090.29138@acrux.dbai.tuwien.ac.at>
Message-ID: <alpine.LSU.1.00.0802190352220.22593@pulcherrima.dbai.tuwien.ac.at>

A second one which Marcus ended up reinventing, but at least the
underlying problem is solved now. :-/

Gerald

On Wed, 26 Dec 2007, Gerald Pfeifer wrote:
> Okay.  In that case, to account for possible future enhancements of 
> ImmGetCompositionStringW(), we'll need a patch like the following. The 
> current error handling code in EDIT_GetCompositionStr() simply doesn't 
> work due to the unsignedness of dwBufLen.
> 
> Gerald
> 
> ChangeLog:
> Fix error handling in EDIT_GetCompositionStr().
> 
> Index: dlls/user32/edit.c
> ===================================================================
> RCS file: /home/wine/wine/dlls/user32/edit.c,v
> retrieving revision 1.16
> diff -u -3 -p -r1.16 edit.c
> --- dlls/user32/edit.c	20 Nov 2007 16:56:17 -0000	1.16
> +++ dlls/user32/edit.c	26 Dec 2007 21:29:33 -0000
> @@ -5360,6 +5348,7 @@ static void EDIT_UpdateText(EDITSTATE *e
>  
>  static void EDIT_GetCompositionStr(HWND hwnd, LPARAM CompFlag, EDITSTATE *es)
>  {
> +    LONG l;
>      DWORD dwBufLen;
>      LPWSTR lpCompStr = NULL;
>      HIMC hIMC;
> @@ -5369,9 +5358,9 @@ static void EDIT_GetCompositionStr(HWND 
>      if (!(hIMC = ImmGetContext(hwnd)))
>          return;
>  
> -    dwBufLen = ImmGetCompositionStringW(hIMC, GCS_COMPSTR, NULL, 0);
> +    dwBufLen = l = ImmGetCompositionStringW(hIMC, GCS_COMPSTR, NULL, 0);
>  
> -    if (dwBufLen < 0)
> +    if (l < 0)
>      {
>          ImmReleaseContext(hwnd, hIMC);
>          return;


From julius at zgod.cjb.net  Tue Feb 19 03:11:17 2008
From: julius at zgod.cjb.net (Julius Schwartzenberg)
Date: Tue, 19 Feb 2008 09:11:17 +0000 (UTC)
Subject: [feature requist] Glide API support
References: <ee59d8c70802181225l1b871193md11e7dff3579103c@mail.gmail.com>
Message-ID: <loom.20080219T090807-758@post.gmane.org>

Vincent Weber <weber.vincent <at> gmail.com> writes:

> 
> Dear Wine devs,There are some games out there that were built with the Glide
API. The Glide API is the graphics API of the 3dfx Voodoo cards and is basically
a stripped down version of OpenGL. Could please consider adding support for the
Glide API

Wine already works fine with the Linux version of Glide. You need Voodoo
hardware to be able to use this though.

Someone could create a Glide>OpenGL library independantly of Wine and also call
it libglide{23}x.so. Then all Linux Glide apps could use it and Wine would also
use it automaticly. It may be handy to look into porting an opensource version
of a currently existing wrapper from Windows.

This is not really related to Wine directly. This wrapper could and should be
created independantly of Wine.

Regards,
Julius



From meissner at suse.de  Tue Feb 19 04:12:54 2008
From: meissner at suse.de (Marcus Meissner)
Date: Tue, 19 Feb 2008 11:12:54 +0100
Subject: [feature requist] Glide API support
In-Reply-To: <loom.20080219T090807-758@post.gmane.org>
References: <ee59d8c70802181225l1b871193md11e7dff3579103c@mail.gmail.com>
	<loom.20080219T090807-758@post.gmane.org>
Message-ID: <20080219101254.GA4235@suse.de>

On Tue, Feb 19, 2008 at 09:11:17AM +0000, Julius Schwartzenberg wrote:
> Vincent Weber <weber.vincent <at> gmail.com> writes:
> 
> > 
> > Dear Wine devs,There are some games out there that were built with the Glide
> API. The Glide API is the graphics API of the 3dfx Voodoo cards and is basically
> a stripped down version of OpenGL. Could please consider adding support for the
> Glide API
> 
> Wine already works fine with the Linux version of Glide. You need Voodoo
> hardware to be able to use this though.
> 
> Someone could create a Glide>OpenGL library independantly of Wine and also call
> it libglide{23}x.so. Then all Linux Glide apps could use it and Wine would also
> use it automaticly. It may be handy to look into porting an opensource version
> of a currently existing wrapper from Windows.
> 
> This is not really related to Wine directly. This wrapper could and should be
> created independantly of Wine.

Btw, we had such a wrapper some time ago ... Linking to the Linux glide2x and glide3x.  ;)

Ciao, Marcus


From julliard at winehq.org  Tue Feb 19 04:15:46 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 19 Feb 2008 11:15:46 +0100
Subject: Make.rules.in: Pass the --nounistd flag to flex since unistd.h is
	a header that might not be present on all systems.
In-Reply-To: <47B9DE66.9080500@codeweavers.com> (Robert Shearman's message of
	"Mon, 18 Feb 2008 19:37:10 +0000")
References: <47B9DE66.9080500@codeweavers.com>
Message-ID: <87odadw8tp.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> If we do need it, we can include it in the .l file after config.h and
> with an appropriate include guard.

You should instead put a %option in the files that need it.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Tue Feb 19 04:49:23 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Tue, 19 Feb 2008 10:49:23 +0000
Subject: Make.rules.in: Pass the --nounistd flag to flex since unistd.h
	is a header that might not be present on all systems.
In-Reply-To: <87odadw8tp.fsf@wine.dyndns.org>
References: <47B9DE66.9080500@codeweavers.com> <87odadw8tp.fsf@wine.dyndns.org>
Message-ID: <47BAB433.1010207@codeweavers.com>

Alexandre Julliard wrote:
> Robert Shearman <rob at codeweavers.com> writes:
>
>   
>> If we do need it, we can include it in the .l file after config.h and
>> with an appropriate include guard.
>>     
>
> You should instead put a %option in the files that need it.

The point is that all of the files need it. Only tools/widl/parser.l 
needs to include unistd.h and it already does so manually.

-- 
Rob Shearman



From julliard at winehq.org  Tue Feb 19 04:57:56 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 19 Feb 2008 11:57:56 +0100
Subject: Make.rules.in: Pass the --nounistd flag to flex since unistd.h is
	a header that might not be present on all systems.
In-Reply-To: <47BAB433.1010207@codeweavers.com> (Robert Shearman's message of
	"Tue, 19 Feb 2008 10:49:23 +0000")
References: <47B9DE66.9080500@codeweavers.com>
	<87odadw8tp.fsf@wine.dyndns.org> <47BAB433.1010207@codeweavers.com>
Message-ID: <87k5l1w6vf.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> The point is that all of the files need it. Only tools/widl/parser.l
> needs to include unistd.h and it already does so manually.

Then you should put the option in all the files. That sort of thing
doesn't belong in the global make rules.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Tue Feb 19 05:45:24 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Tue, 19 Feb 2008 11:45:24 +0000
Subject: Make.rules.in: Pass the --nounistd flag to flex since unistd.h
	is a header that might not be present on all systems.
In-Reply-To: <87k5l1w6vf.fsf@wine.dyndns.org>
References: <47B9DE66.9080500@codeweavers.com>	<87odadw8tp.fsf@wine.dyndns.org>
	<47BAB433.1010207@codeweavers.com> <87k5l1w6vf.fsf@wine.dyndns.org>
Message-ID: <47BAC154.7000500@codeweavers.com>

Alexandre Julliard wrote:
> Robert Shearman <rob at codeweavers.com> writes:
>
>   
>> The point is that all of the files need it. Only tools/widl/parser.l
>> needs to include unistd.h and it already does so manually.
>>     
>
> Then you should put the option in all the files. That sort of thing
> doesn't belong in the global make rules.

I disagree. The global make rules, among other things, should enforce 
policies whether this be telling the C compiler to error on certain 
non-portable constructs like declarations after statements or telling 
flex not to output code that includes headers that might not be present, 
like unistd.h.

However, I've sent a patch that turns the option on individually for 
each file so that you can choose which route to take.

-- 
Rob Shearman



From dmitry at codeweavers.com  Mon Feb 18 22:06:44 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 19 Feb 2008 12:06:44 +0800
Subject: How should we treat users on bugzilla?
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com><a71bd89a0802172201m6ec55fedy2488ce62a03ffc04@mail.gmail.com><b6bb06270802180949l190e8666uac45885f020946cc@mail.gmail.com><200802181835.15391.research@science.su>
	<b6bb06270802181144q1d636858l1dfd5c33cec45915@mail.gmail.com>
Message-ID: <003a01c872f1$648239c0$a600fea9@DMITRY>

"Austin English" <austinenglish at gmail.com> wrote:

> In my experience, the 'older' crowd prefers newsgroups, but 'younger'
> people prefer message boards. Similar to how more advanced users
> prefer CLI, but inexperienced/novices use GUI. It seems to me we're
> trying to help the gui type of person, and a message board would be an
> easier way to do this, IMHO.

It's pretty much easy to see who needs help then. And assuming that
inexperienced/novices can't help themselves, and people who really
can answer their questions are not going to participate on forums
(because it's mostly a waste of time IMO) the answer should be clear
enough. Of course, if the creation of the forum doesn't aim to really
help, but just a general form of discussing everything here and there,
for the sake of it...

-- 
Dmitry.


From dmitry at codeweavers.com  Tue Feb 19 07:14:48 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 19 Feb 2008 21:14:48 +0800
Subject: Pass parms through to PdhLookupPerfIndexByNameW for checking
References: <47BAA83A.7060003@yless4u.com.au>
Message-ID: <018301c872f9$688ddd50$a600fea9@DMITRY>

"Jeff Latimer" <lats at yless4u.com.au> wrote:

> +    if (machine && !(machineW = pdh_strdup_aw( machine ))) return PDH_MEMORY_ALLOCATION_FAILURE;
> 
> -    if (machine)
> -    {
> -        FIXME("remote machine not supported\n");
> -        return PDH_CSTATUS_NO_MACHINE;
> -    }
>     if (!(nameW = pdh_strdup_aw( name )))
>         return PDH_MEMORY_ALLOCATION_FAILURE;
> 
>     ret = PdhLookupPerfIndexByNameW( NULL, nameW, index );

You forgot to actually pass machineW to PdhLookupPerfIndexByNameW.

-- 
Dmitry.


From julliard at winehq.org  Tue Feb 19 07:47:06 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 19 Feb 2008 14:47:06 +0100
Subject: Make.rules.in: Pass the --nounistd flag to flex since unistd.h is
	a header that might not be present on all systems.
In-Reply-To: <47BAC154.7000500@codeweavers.com> (Robert Shearman's message of
	"Tue, 19 Feb 2008 11:45:24 +0000")
References: <47B9DE66.9080500@codeweavers.com>
	<87odadw8tp.fsf@wine.dyndns.org> <47BAB433.1010207@codeweavers.com>
	<87k5l1w6vf.fsf@wine.dyndns.org> <47BAC154.7000500@codeweavers.com>
Message-ID: <87fxvpvz1h.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> I disagree. The global make rules, among other things, should enforce
> policies whether this be telling the C compiler to error on certain
> non-portable constructs like declarations after statements or telling
> flex not to output code that includes headers that might not be
> present, like unistd.h.

Yes, but policies about headers don't always apply globally. Some parts
of the project, like the server, are Unix-only, and using unistd.h in
those parts is perfectly legitimate.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Tue Feb 19 11:04:31 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Tue, 19 Feb 2008 17:04:31 +0000
Subject: slc: Initial stub DLL (try 2)
In-Reply-To: <fpel17$b92$1@ger.gmane.org>
References: <fpel17$b92$1@ger.gmane.org>
Message-ID: <47BB0C1F.7060803@codeweavers.com>

Alistair Leslie-Hughes wrote:
>     slc: Initial stub dll

I'm not sure we want to go down the path of implementing the functions 
in this DLL. Furthermore, this file isn't present on an XP SP2 installation.

Can you give some information as to why this is needed and how the 
application depends on this DLL?

-- 
Rob Shearman



From dank at kegel.com  Tue Feb 19 12:48:22 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 19 Feb 2008 10:48:22 -0800
Subject: Do we need a forum?
Message-ID: <a71bd89a0802191048t1a98a913i1f04efa83b9baad5@mail.gmail.com>

Steven Edwards wrote:
> My thoughts, as well as
> Tom's was that by creating a "blessed" location, all third parties as
> well as vendors that develop Wine related products could say "if you
> want to discuss using a vendor provided Wine product in a
> non-supported manner all are advised to go here and share information"

Yes, of course, it would be nice if there were One True Place to go,
but the closest we're ever going to get is essentially the status quo,
where the wine-users mailing list is the place of record for user support,
the appdb is the place of record for looking for tips for a particular app,
and all the other areas are secondary.  We can improve slightly
on this by linking to other popular wine forums as they pop up,
emphasizing all the while that they are secondary.
- Dan


From leslie_alistair at hotmail.com  Tue Feb 19 14:41:32 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Wed, 20 Feb 2008 07:41:32 +1100
Subject: slc: Initial stub DLL (try 2)
References: <fpel17$b92$1@ger.gmane.org> <47BB0C1F.7060803@codeweavers.com>
Message-ID: <fpfetp$kgc$1@ger.gmane.org>

"Robert Shearman" <rob at codeweavers.com> wrote in message 
news:47BB0C1F.7060803 at codeweavers.com...
> Alistair Leslie-Hughes wrote:
>>     slc: Initial stub dll
>
> I'm not sure we want to go down the path of implementing the functions
> in this DLL. Furthermore, this file isn't present on an XP SP2 
> installation.
This dll is present for vista and Windows Server 2008.

>
> Can you give some information as to why this is needed and how the
> application depends on this DLL?
The standard Solitaire under Vista requires this dll, and uses function 
SLGetWindowsInformationDWORD
(Stubbing this function was going to be my next patch).

Best Regards
 Alistair Leslie-Hughes 




From kornelpal at gmail.com  Tue Feb 19 14:07:18 2008
From: kornelpal at gmail.com (=?iso-8859-1?B?S29ybulsIFDhbA==?=)
Date: Tue, 19 Feb 2008 21:07:18 +0100
Subject: slc: Initial stub DLL (try 2)
References: <fpel17$b92$1@ger.gmane.org> <47BB0C1F.7060803@codeweavers.com>
Message-ID: <002901c87333$092364e0$5747ee55@kornelpal.hu>

slc.dll is part of Windows Vista, and seems to be responsible for 
activation, key validation, maybe genuine validation and probably trial time 
limit.

I don't think that this is required by Wine unless the DLL has some 
publically documented API.

Korn?l

----- Original Message ----- 
From: "Robert Shearman" <rob at codeweavers.com>
To: <leslie_alistair at hotmail.com>
Cc: <wine-devel at winehq.org>
Sent: Tuesday, February 19, 2008 6:04 PM
Subject: Re: slc: Initial stub DLL (try 2)


> Alistair Leslie-Hughes wrote:
>>     slc: Initial stub dll
>
> I'm not sure we want to go down the path of implementing the functions
> in this DLL. Furthermore, this file isn't present on an XP SP2 
> installation.
>
> Can you give some information as to why this is needed and how the
> application depends on this DLL?
>
> -- 
> Rob Shearman
>
>
> 



From leslie_alistair at hotmail.com  Tue Feb 19 15:09:34 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Wed, 20 Feb 2008 08:09:34 +1100
Subject: slc: Initial stub DLL (try 2)
References: <fpel17$b92$1@ger.gmane.org> <47BB0C1F.7060803@codeweavers.com>
	<002901c87333$092364e0$5747ee55@kornelpal.hu>
Message-ID: <fpfgia$r0g$1@ger.gmane.org>

> "Korn?l P?l" <kornelpal at gmail.com> wrote in message 
> news:002901c87333$092364e0$5747ee55 at kornelpal.hu...
> slc.dll is part of Windows Vista, and seems to be responsible for
> activation, key validation, maybe genuine validation and probably trial 
> time
> limit.

>I don't think that this is required by Wine unless the DLL has some
>publically documented API.

The public API for this dllcan be found in slpublic.h

Best Regards
 Alistair Leslie-Hughes






From stefan at codeweavers.com  Tue Feb 19 09:52:13 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 19 Feb 2008 16:52:13 +0100
Subject: ddraw: Assign to structs instead of using memcpy
In-Reply-To: <fp7vmr$cj3$1@ger.gmane.org>
References: <200802162233.37827.andrew.talbot@talbotville.com>
	<200802162351.23513.stefan@codeweavers.com>
	<fp7vmr$cj3$1@ger.gmane.org>
Message-ID: <200802191652.16001.stefan@codeweavers.com>

Am Sonntag, 17. Februar 2008 01:38:50 schrieb Andrew Talbot:
> And I presume that if the underlying struct tags 
> are different between two similar types, then the compiler would warn of
> type incompatibility if such an assignment were attempted.
Not quite. You can have a DDSURFACEDESC2 *ddsd pointer, with ddsd->dwSize == 
sizeof(DDSURFACEDESC). Then you have in binary a DDSURFACEDESC *, not a 
DDSURFACEDESC2 *. The compiler won't see that, since the type is determined 
at runtime.

(Don't blame me, Microsoft invented that)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080219/82384838/attachment.pgp 

From stefan at codeweavers.com  Tue Feb 19 15:12:05 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 19 Feb 2008 22:12:05 +0100
Subject: WineD3D: let flush_to_framebuffer_drawpixels use a valid rect
In-Reply-To: <20080219202624.285280@gmx.net>
References: <20080219202624.285280@gmx.net>
Message-ID: <200802192212.08055.stefan@codeweavers.com>

Am Dienstag, 19. Februar 2008 21:26:24 schrieben Sie:
> Hi,
>
> Originally flush_to_framebuffer_drawpixels was called from UnlockRect, so
> in that case LockedRect was always set. These days it can also be called
> (through LoadLocation) from other places. This patch makes it use the
> LockedRect when the surface is locked else the whole surface is uploaded.
> This fixes rendering issues in Red Alert and other apps.
Wouldn't it be better to make sure that the caller passes the correct 
rectangle to flush_to_framebuffer_* ?

> -            if(dxVersion >= 8) {
> +            if(0 && dxVersion >= 8) {
Is this intentional?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080219/6a5dbfcb/attachment.pgp 

From phil at newstar.rinet.ru  Tue Feb 19 16:33:38 2008
From: phil at newstar.rinet.ru (Phil Krylov)
Date: Wed, 20 Feb 2008 01:33:38 +0300
Subject: Do we need a forum?
In-Reply-To: <a71bd89a0802191048t1a98a913i1f04efa83b9baad5@mail.gmail.com>
References: <a71bd89a0802191048t1a98a913i1f04efa83b9baad5@mail.gmail.com>
Message-ID: <c10dbf450802191433t3f0af92ex3218f02dfde29f7e@mail.gmail.com>

Hi,

On 19/02/2008, Dan Kegel <dank at kegel.com> wrote:
> Steven Edwards wrote:
> > My thoughts, as well as
> > Tom's was that by creating a "blessed" location, all third parties as
> > well as vendors that develop Wine related products could say "if you
> > want to discuss using a vendor provided Wine product in a
> > non-supported manner all are advised to go here and share information"
>
> Yes, of course, it would be nice if there were One True Place to go,
> but the closest we're ever going to get is essentially the status quo,
> where the wine-users mailing list is the place of record for user support,
> the appdb is the place of record for looking for tips for a particular app,
> and all the other areas are secondary.  We can improve slightly
> on this by linking to other popular wine forums as they pop up,
> emphasizing all the while that they are secondary.

I think that any existing place will eventually grow really popular if
it will be called "http://forum.winehq.org".

-- Ph.


From Andrew.Talbot at talbotville.com  Tue Feb 19 16:42:14 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Tue, 19 Feb 2008 22:42:14 +0000
Subject: ddraw: Assign to structs instead of using memcpy
References: <200802162233.37827.andrew.talbot@talbotville.com>
	<200802162351.23513.stefan@codeweavers.com>
	<fp7vmr$cj3$1@ger.gmane.org>
	<200802191652.16001.stefan@codeweavers.com>
Message-ID: <fpfm06$ggr$1@ger.gmane.org>

Stefan D?singer wrote:

> Am Sonntag, 17. Februar 2008 01:38:50 schrieb Andrew Talbot:
>> And I presume that if the underlying struct tags
>> are different between two similar types, then the compiler would warn of
>> type incompatibility if such an assignment were attempted.
> Not quite. You can have a DDSURFACEDESC2 *ddsd pointer, with ddsd->dwSize
> == sizeof(DDSURFACEDESC). Then you have in binary a DDSURFACEDESC *, not a
> DDSURFACEDESC2 *. The compiler won't see that, since the type is
> determined at runtime.
> 
> (Don't blame me, Microsoft invented that)

Hi Stefan,

I am probably losing the plot, but thank you for your patience and I am
always glad to be put straight. My thinking is as follows.

If I apply the following patch:

diff --git a/dlls/ddraw/ddraw_thunks.c b/dlls/ddraw/ddraw_thunks.c
index b748ad4..57210a5 100644
--- a/dlls/ddraw/ddraw_thunks.c
+++ b/dlls/ddraw/ddraw_thunks.c
@@ -615,7 +615,7 @@ EnumDisplayModesCallbackThunk(LPDDSURFACEDESC2 pDDSD2,
LPVOID context)
     DDSURFACEDESC DDSD;
     struct displaymodescallback_context *cbcontext = context;
 
-    memcpy(&DDSD,pDDSD2,sizeof(DDSD));
+    DDSD = *pDDSD2;
     DDSD.dwSize = sizeof(DDSD);
 
     return cbcontext->func(&DDSD, cbcontext->context);

I get this from the compiler (doing "make clean && make"):

ddraw_thunks.c: In function ?EnumDisplayModesCallbackThunk?:
ddraw_thunks.c:618: error: incompatible types in assignment
make: *** [ddraw_thunks.o] Error 1

I reason that the compiler throws this error because a DDSURFACEDESC is a
type based on a struct _DDSURFACEDESC, and a DDSURFACEDESC2 is one based on
a struct _DDSURFACEDESC2. So, regardless of size issues, the compiler will
not let me assign between two derived types that are not both aliases for a
common base type. One beauty of assignment over bit copying is the type
checking one gains. Am I missing the point?

Thanks,

-- 
Andy.




From dank at kegel.com  Tue Feb 19 17:07:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 19 Feb 2008 15:07:18 -0800
Subject: Do we need a forum?
In-Reply-To: <c10dbf450802191433t3f0af92ex3218f02dfde29f7e@mail.gmail.com>
References: <a71bd89a0802191048t1a98a913i1f04efa83b9baad5@mail.gmail.com>
	<c10dbf450802191433t3f0af92ex3218f02dfde29f7e@mail.gmail.com>
Message-ID: <a71bd89a0802191507j494a1001p226f2efc234a82d3@mail.gmail.com>

On Feb 19, 2008 2:33 PM, Phil Krylov <phil at newstar.rinet.ru> wrote:
> I think that any existing place will eventually grow really popular if
> it will be called "http://forum.winehq.org".

OK.  I propose we make that a redirect to
http://groups.google.com/group/comp.emulators.ms-windows.wine/topics?lnk=srg


From winehacker at gmail.com  Tue Feb 19 17:23:21 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 19 Feb 2008 18:23:21 -0500
Subject: Do we need a forum?
In-Reply-To: <a71bd89a0802191507j494a1001p226f2efc234a82d3@mail.gmail.com>
References: <a71bd89a0802191048t1a98a913i1f04efa83b9baad5@mail.gmail.com>
	<c10dbf450802191433t3f0af92ex3218f02dfde29f7e@mail.gmail.com>
	<a71bd89a0802191507j494a1001p226f2efc234a82d3@mail.gmail.com>
Message-ID: <19e31a080802191523u36d84b22p735399595c66d0eb@mail.gmail.com>

On Feb 19, 2008 6:07 PM, Dan Kegel <dank at kegel.com> wrote:
> OK.  I propose we make that a redirect to
> http://groups.google.com/group/comp.emulators.ms-windows.wine/topics?lnk=srg

-1 I still don't like the layout and easy of use of google groups. It
has decent search but thats about all it has going for it. Running our
own forum gives us more control over the layout and features.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From m.b.lankhorst at gmail.com  Tue Feb 19 17:40:08 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 19 Feb 2008 15:40:08 -0800
Subject: Making use of setupapi
Message-ID: <b130c85e0802191540m7ed85464r3f0e29f244a6b2d6@mail.gmail.com>

Hi folks,

Any one around who understands setupapi? For iTunes I would need to
add appropriate registry keys so that my usb device is detected. My
idea is to use libusb to find the things like guid, revision etc and
then adding the keys. However I am not 100% what the layout of the
keys is.

Cheers,
Maarten.


From juan.lang at gmail.com  Tue Feb 19 17:44:50 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 19 Feb 2008 15:44:50 -0800
Subject: Making use of setupapi
In-Reply-To: <b130c85e0802191540m7ed85464r3f0e29f244a6b2d6@mail.gmail.com>
References: <b130c85e0802191540m7ed85464r3f0e29f244a6b2d6@mail.gmail.com>
Message-ID: <3a768c550802191544h5b30a40bi8cf1dcdf07f54229@mail.gmail.com>

Hi Maarten,

>  Any one around who understands setupapi? For iTunes I would need to
>  add appropriate registry keys so that my usb device is detected. My
>  idea is to use libusb to find the things like guid, revision etc and
>  then adding the keys. However I am not 100% what the layout of the
>  keys is.

Check bug 9649, it's got a sample .reg file that fools iTunes into
thinking an iPod is present.  Or here's the link to the attachment:
http://bugs.winehq.org/attachment.cgi?id=8216

--Juan


From m.b.lankhorst at gmail.com  Tue Feb 19 17:48:36 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 19 Feb 2008 15:48:36 -0800
Subject: Adding devices in setupapi
Message-ID: <b130c85e0802191548p31ce171dm44ffa728b9216545@mail.gmail.com>

Hi all,

I'm trying to add the ipod detection from crossover wine to winehq.
However it seems to be not compatibel due to changes to setupapi in
the last 3 years.

Basically what I want to do is add an usb mass storage device with the
correct device path and register it with setupapi. Composing the
string is easy but I'm not 100% sure what the locations are. The code
seems a bit vague in that aspect. The snippet iTunes uses for
detection is shown below:

SetupDiGetClassDevsExW {53f56307-b6bf-11d0-94f2-00a0c91efb8b} (null)
(nil) 0x00000012 (nil) (null) (nil)
SetupDiEnumDeviceInterfaces 0x136638, (nil),
{53f56307-b6bf-11d0-94f2-00a0c91efb8b}, 0, 0x7aa2140c

How do I get my device listed in SetupDiEnumDeviceInterfaces there so
iTunes can pick it up?

Cheers,
Maarten.


From truiken at gmail.com  Tue Feb 19 17:49:05 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 19 Feb 2008 17:49:05 -0600
Subject: Making use of setupapi
In-Reply-To: <b130c85e0802191540m7ed85464r3f0e29f244a6b2d6@mail.gmail.com>
References: <b130c85e0802191540m7ed85464r3f0e29f244a6b2d6@mail.gmail.com>
Message-ID: <22821af30802191549v1d39abd6xe6a4ff2f13c3647f@mail.gmail.com>

On Feb 19, 2008 5:40 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> Hi folks,
>
> Any one around who understands setupapi? For iTunes I would need to
> add appropriate registry keys so that my usb device is detected. My
> idea is to use libusb to find the things like guid, revision etc and
> then adding the keys. However I am not 100% what the layout of the
> keys is.
>

The test suite is your friend.  Off the top of my head, I don't know
if the setupapi device installation API requires an actual device or
not, but regardless, tests are possible.  The SetupDi.*Get.* APIs can
be tested using regmon.  You call the function in question then look
at the regmon results to see what registry keys were queried.  With
this method, you then know the format of the registry entries.  This
is how most of the msi tests concerning the registry were written.
Check out dlls/msi/tests/msi.c,source.c.  It's tedious but accurate.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Tue Feb 19 17:49:43 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 19 Feb 2008 15:49:43 -0800
Subject: Making use of setupapi
In-Reply-To: <3a768c550802191544h5b30a40bi8cf1dcdf07f54229@mail.gmail.com>
References: <b130c85e0802191540m7ed85464r3f0e29f244a6b2d6@mail.gmail.com>
	<3a768c550802191544h5b30a40bi8cf1dcdf07f54229@mail.gmail.com>
Message-ID: <b130c85e0802191549yc143c62l7d54bcbf17010d85@mail.gmail.com>

2008/2/19, Juan Lang <juan.lang at gmail.com>:
> Check bug 9649, it's got a sample .reg file that fools iTunes into
> thinking an iPod is present.  Or here's the link to the attachment:
> http://bugs.winehq.org/attachment.cgi?id=8216
Oops, sorry for the double post. I couldn't really sleep last night. :-/

Thanks. I'll take a look at it.

Cheers,
Maarten.


From truiken at gmail.com  Tue Feb 19 17:53:16 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 19 Feb 2008 17:53:16 -0600
Subject: Adding devices in setupapi
In-Reply-To: <b130c85e0802191548p31ce171dm44ffa728b9216545@mail.gmail.com>
References: <b130c85e0802191548p31ce171dm44ffa728b9216545@mail.gmail.com>
Message-ID: <22821af30802191553j37dcc3ffj6b84fd7584cc67c9@mail.gmail.com>

On Feb 19, 2008 5:48 PM, Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:
> Hi all,
>
> I'm trying to add the ipod detection from crossover wine to winehq.
> However it seems to be not compatibel due to changes to setupapi in
> the last 3 years.
>
> Basically what I want to do is add an usb mass storage device with the
> correct device path and register it with setupapi. Composing the
> string is easy but I'm not 100% sure what the locations are. The code
> seems a bit vague in that aspect. The snippet iTunes uses for
> detection is shown below:
>
> SetupDiGetClassDevsExW {53f56307-b6bf-11d0-94f2-00a0c91efb8b} (null)
> (nil) 0x00000012 (nil) (null) (nil)
> SetupDiEnumDeviceInterfaces 0x136638, (nil),
> {53f56307-b6bf-11d0-94f2-00a0c91efb8b}, 0, 0x7aa2140c
>
> How do I get my device listed in SetupDiEnumDeviceInterfaces there so
> iTunes can pick it up?
>

Call the function in windows and check which registry keys are queried
using regmon.  See the post I just sent to your last question.

-- 
James Hawkins


From juan.lang at gmail.com  Tue Feb 19 18:00:41 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 19 Feb 2008 16:00:41 -0800
Subject: Adding devices in setupapi
In-Reply-To: <b130c85e0802191548p31ce171dm44ffa728b9216545@mail.gmail.com>
References: <b130c85e0802191548p31ce171dm44ffa728b9216545@mail.gmail.com>
Message-ID: <3a768c550802191600u4ffc8744q9a31b01d37d753b7@mail.gmail.com>

No worries on the double post, you ask a slightly different question here:

>  I'm trying to add the ipod detection from crossover wine to winehq.
>  However it seems to be not compatibel due to changes to setupapi in
>  the last 3 years.

The crossover Wine tree was written for version 4.x of iTunes, I
believe.  Using it directly in winehq is not likely to be a help,
because that version of iTunes is quite old, and the method newer
versions of iTunes uses to find and talk to iPods is different.
(Remember also Rob's comment about iTunes changing every 3-6
months...)

The code in winehq is, I believe, correct as far as which registry
keys it queries.  I wrote it with iTunes in mind, at any rate.  What
you want to figure out is not how to extend setupapi's SetupDi
functions.  Instead, you want to figure out how to enumerate the iPod,
and call the SetupDi functions to have them create the appropriate
registry keys.

Assuming the version of iTunes you're testing with behaves similarly
to the one I tested for bug 9649, once you've got the right registry
keys set, you'll get crashes due to the missing CM_* functions in
cfgmgr32/setupapi.  Or, maybe the version you're playing with is
different all over again...
--Juan


From dank at kegel.com  Tue Feb 19 18:30:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 19 Feb 2008 16:30:18 -0800
Subject: Do we need a forum?
In-Reply-To: <19e31a080802191523u36d84b22p735399595c66d0eb@mail.gmail.com>
References: <a71bd89a0802191048t1a98a913i1f04efa83b9baad5@mail.gmail.com>
	<c10dbf450802191433t3f0af92ex3218f02dfde29f7e@mail.gmail.com>
	<a71bd89a0802191507j494a1001p226f2efc234a82d3@mail.gmail.com>
	<19e31a080802191523u36d84b22p735399595c66d0eb@mail.gmail.com>
Message-ID: <a71bd89a0802191630k34e2e6cdyc4ea0fbd7507e236@mail.gmail.com>

On Feb 19, 2008 3:23 PM, Steven Edwards <winehacker at gmail.com> wrote:
> > OK.  I propose we make that a redirect to
> > http://groups.google.com/group/comp.emulators.ms-windows.wine/topics?lnk=srg
>
> -1 I still don't like the layout and easy of use of google groups. It
> has decent search but thats about all it has going for it. Running our
> own forum gives us more control over the layout and features.

I was mostly joking.

Now that http://winehq.org/site/forums links to the two
existing popular forums about Wine, I think we should be
covered.

As I said earlier, I think creating our own forum would just
fragment users further.  I know somehow you think that
won't happen, and you think every user everywhere would
flock to our forum, but I think there's very little chance of
users abandoning the forums they're familiar with.

Wine should strive to not be a destination site in and of itself,
it should strive to be an invisible part of the plumbing of
every linux distro.
- Dan


From m.b.lankhorst at gmail.com  Tue Feb 19 21:04:46 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 19 Feb 2008 19:04:46 -0800
Subject: Fwd: Adding devices in setupapi
In-Reply-To: <b130c85e0802191901r7533922do8c7ceb5326c86ac2@mail.gmail.com>
References: <b130c85e0802191548p31ce171dm44ffa728b9216545@mail.gmail.com>
	<3a768c550802191600u4ffc8744q9a31b01d37d753b7@mail.gmail.com>
	<b130c85e0802191604r11a75c2drdbfe72a77161bba5@mail.gmail.com>
	<3a768c550802191615r72a2792dy11363e774797784c@mail.gmail.com>
	<b130c85e0802191703r61e0f238jbce39c2b0873ce70@mail.gmail.com>
	<3a768c550802191706t29b94d8bo934ad9fca565644f@mail.gmail.com>
	<b130c85e0802191901r7533922do8c7ceb5326c86ac2@mail.gmail.com>
Message-ID: <b130c85e0802191904p41a97a6albc32c65a7d58f6f4@mail.gmail.com>

Hi Juan,

2008/2/19, Juan Lang <juan.lang at gmail.com>:
> >  I stubbed CM_get_parent by returning itself, however that makes it go
> >  in an infinite loop.
>
> Hm.
>
> >  My guess is that I need to have some hub and usb ehci device as well.
> >  I don't know why it would want to call CreateFile on the device though
> >  but my expertise on that part is very limited, perhaps it allows
> >  communication to the ipod by accessing the device in a raw way?
>
> Perhaps, or perhaps it's just making sure you don't have a fake device :-/
> --Juan
The only way to be sure would be to create my own test program that
would do the same, and see what happens. How hard is it to create a
stub forwarder dll for setupapi and cfgmgr32?

Cheers,
Maarten.


From jjmckenzie51 at sprintpcs.com  Tue Feb 19 21:58:15 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Tue, 19 Feb 2008 20:58:15 -0700
Subject: Do we need a forum?
In-Reply-To: <a71bd89a0802191630k34e2e6cdyc4ea0fbd7507e236@mail.gmail.com>
References: <a71bd89a0802191048t1a98a913i1f04efa83b9baad5@mail.gmail.com>
	<c10dbf450802191433t3f0af92ex3218f02dfde29f7e@mail.gmail.com>
	<a71bd89a0802191507j494a1001p226f2efc234a82d3@mail.gmail.com>
	<19e31a080802191523u36d84b22p735399595c66d0eb@mail.gmail.com>
	<a71bd89a0802191630k34e2e6cdyc4ea0fbd7507e236@mail.gmail.com>
Message-ID: <47BBA557.6000608@sprintpcs.com>

Dan Kegel wrote:
> Now that http://winehq.org/site/forums links to the two
> existing popular forums about Wine, I think we should be
> covered.
>
> As I said earlier, I think creating our own forum would just
> fragment users further.  I know somehow you think that
> won't happen, and you think every user everywhere would
> flock to our forum, but I think there's very little chance of
> users abandoning the forums they're familiar with.
>
> Wine should strive to not be a destination site in and of itself,
> it should strive to be an invisible part of the plumbing of
> every linux distro.
>
>   
Let's not forget the growing crowd of Macs as well.  I would like to see 
the code from Darwine brought back into the Wine distribution.  I doubt 
we will ever see an integrated Wine in Mac OS X.

James McKenzie




From saulius2 at gmail.com  Tue Feb 19 20:58:10 2008
From: saulius2 at gmail.com (Saulius)
Date: Tue, 19 Feb 2008 20:58:10 -0600
Subject: Saulius sent you a friend request on Yaari...
Message-ID: <c20e7d4faebefd88a6d5a8b8d021ead9@localhost.localdomain>

An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080219/883ff630/attachment.htm 

From dmitry at codeweavers.com  Tue Feb 19 22:25:33 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 20 Feb 2008 12:25:33 +0800
Subject: Do we need a forum?
References: <a71bd89a0802191048t1a98a913i1f04efa83b9baad5@mail.gmail.com><c10dbf450802191433t3f0af92ex3218f02dfde29f7e@mail.gmail.com><a71bd89a0802191507j494a1001p226f2efc234a82d3@mail.gmail.com><19e31a080802191523u36d84b22p735399595c66d0eb@mail.gmail.com><a71bd89a0802191630k34e2e6cdyc4ea0fbd7507e236@mail.gmail.com>
	<47BBA557.6000608@sprintpcs.com>
Message-ID: <017401c87378$a474d8d0$a600fea9@DMITRY>

"James McKenzie" <jjmckenzie51 at sprintpcs.com> wrote:

> Let's not forget the growing crowd of Macs as well.  I would like to see 
> the code from Darwine brought back into the Wine distribution.

Which code are you talking about?

> I doubt 
> we will ever see an integrated Wine in Mac OS X.

I don't think that spreading this kind of misinformation is helpful,
especially in the developers list.

-- 
Dmitry.


From winehacker at gmail.com  Tue Feb 19 22:51:41 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 19 Feb 2008 23:51:41 -0500
Subject: Do we need a forum?
In-Reply-To: <017401c87378$a474d8d0$a600fea9@DMITRY>
References: <a71bd89a0802191048t1a98a913i1f04efa83b9baad5@mail.gmail.com>
	<c10dbf450802191433t3f0af92ex3218f02dfde29f7e@mail.gmail.com>
	<a71bd89a0802191507j494a1001p226f2efc234a82d3@mail.gmail.com>
	<19e31a080802191523u36d84b22p735399595c66d0eb@mail.gmail.com>
	<a71bd89a0802191630k34e2e6cdyc4ea0fbd7507e236@mail.gmail.com>
	<47BBA557.6000608@sprintpcs.com>
	<017401c87378$a474d8d0$a600fea9@DMITRY>
Message-ID: <19e31a080802192051w61b73713xa2f76563e1a73412@mail.gmail.com>

On Feb 19, 2008 11:25 PM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> > Let's not forget the growing crowd of Macs as well.  I would like to see
> > the code from Darwine brought back into the Wine distribution.
>
> Which code are you talking about?

He means this patch

http://sourceforge.net/tracker/?group_id=69890&atid=526089

I have it applied in my local tree and am working to get it working
with the latest Winehq sources. Some stuff has changed and moved in to
user/gdi so I have a patch but it does not work yet...

>
> > I doubt
> > we will ever see an integrated Wine in Mac OS X.
>
> I don't think that spreading this kind of misinformation is helpful,
> especially in the developers list.

He means we will not bloodly likely see apple bundle Wine with OS X.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Tue Feb 19 23:00:48 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 20 Feb 2008 13:00:48 +0800
Subject: Do we need a forum?
References: <a71bd89a0802191048t1a98a913i1f04efa83b9baad5@mail.gmail.com>
	<c10dbf450802191433t3f0af92ex3218f02dfde29f7e@mail.gmail.com>
	<a71bd89a0802191507j494a1001p226f2efc234a82d3@mail.gmail.com>
	<19e31a080802191523u36d84b22p735399595c66d0eb@mail.gmail.com>
	<a71bd89a0802191630k34e2e6cdyc4ea0fbd7507e236@mail.gmail.com>
	<47BBA557.6000608@sprintpcs.com>
	<017401c87378$a474d8d0$a600fea9@DMITRY>
	<19e31a080802192051w61b73713xa2f76563e1a73412@mail.gmail.com>
Message-ID: <021201c8737d$90c5fda0$a600fea9@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> On Feb 19, 2008 11:25 PM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
>> > Let's not forget the growing crowd of Macs as well.  I would like to see
>> > the code from Darwine brought back into the Wine distribution.
>>
>> Which code are you talking about?
> 
> He means this patch
> 
> http://sourceforge.net/tracker/?group_id=69890&atid=526089

Then he is probably aware that this is a developers list, and we always
appreciate the patches.

> I have it applied in my local tree and am working to get it working
> with the latest Winehq sources. Some stuff has changed and moved in to
> user/gdi so I have a patch but it does not work yet...

Feel free to send the patches once you have it working.

>> > I doubt
>> > we will ever see an integrated Wine in Mac OS X.
>>
>> I don't think that spreading this kind of misinformation is helpful,
>> especially in the developers list.
> 
> He means we will not bloodly likely see apple bundle Wine with OS X.

How is that related to "the code from Darwine"?

-- 
Dmitry.


From juan.lang at gmail.com  Tue Feb 19 23:35:47 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 19 Feb 2008 21:35:47 -0800
Subject: Adding devices in setupapi
In-Reply-To: <b130c85e0802191901r7533922do8c7ceb5326c86ac2@mail.gmail.com>
References: <b130c85e0802191548p31ce171dm44ffa728b9216545@mail.gmail.com>
	<3a768c550802191600u4ffc8744q9a31b01d37d753b7@mail.gmail.com>
	<b130c85e0802191604r11a75c2drdbfe72a77161bba5@mail.gmail.com>
	<3a768c550802191615r72a2792dy11363e774797784c@mail.gmail.com>
	<b130c85e0802191703r61e0f238jbce39c2b0873ce70@mail.gmail.com>
	<3a768c550802191706t29b94d8bo934ad9fca565644f@mail.gmail.com>
	<b130c85e0802191901r7533922do8c7ceb5326c86ac2@mail.gmail.com>
Message-ID: <3a768c550802192135m6826777h41c6d200d0bb6be7@mail.gmail.com>

>  How hard is it to create a stub forwarder dll for setupapi and cfgmgr32?

Not sure what you mean exactly.  cfgmgr32 should forward to setupapi
already, and I sent a patch that does that for the few stub functions
that it had.  setupapi's CM_* stubs could be improved, but I don't
think you'll be able to forward them to any native code to try out:  I
expect the Windows configuration manager is rather too low level to
run under Wine.

You'll probably want to create a hacky version of setupapi that
creates a fake device tree, with a root, USB hub, and iPod device,
just to see if that makes iTunes happy.

Does that answer your question?
--Juan


From julliard at winehq.org  Wed Feb 20 05:24:05 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 20 Feb 2008 12:24:05 +0100
Subject: [1/2] user32:scroll: Added some tests for scrollbar [try2]
In-Reply-To: <47BAF5EA.6070703@etersoft.ru> (Anatoly Lyutin's message of "Tue, 
	19 Feb 2008 18:29:46 +0300")
References: <47BAF5EA.6070703@etersoft.ru>
Message-ID: <87skznvpka.fsf@wine.dyndns.org>

Anatoly Lyutin <vostok at etersoft.ru> writes:

> Changelog:
>   Added some tests for scrollbar

The tests fail:

../../../tools/runtest -q -P wine -M user32.dll -T ../../.. -p user32_test.exe.so scroll.c && touch scroll.ok
scroll.c:56: Test failed: The scrollbar window should be disabled.
scroll.c:122: Test failed: The ShowScrollBar() should failed.
make: *** [scroll.ok] Error 2

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Wed Feb 20 05:45:42 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 20 Feb 2008 12:45:42 +0100
Subject: [advapi32] QueryServiceConfig2 (3rd try) [resend]
In-Reply-To: <200802151804.13711.Stefan.Leichter@camline.com> (Stefan
	Leichter's message of "Fri, 15 Feb 2008 18:04:13 +0100")
References: <200802151804.13711.Stefan.Leichter@camline.com>
Message-ID: <87lk5fvok9.fsf@wine.dyndns.org>

Stefan Leichter <Stefan.Leichter at camline.com> writes:

> +    switch(dwLevel) {
> +        case SERVICE_CONFIG_DESCRIPTION: {
> +            static const WCHAR szDescription[] = {'D','e','s','c','r','i','p','t','i','o','n',0};
> +            LPSERVICE_DESCRIPTIONW config = (LPSERVICE_DESCRIPTIONW) buffer;
> +            *needed = sizeof (SERVICE_DESCRIPTIONW);
> +            sz = size - *needed;
> +            r = RegQueryValueExW( hKey, szDescription, 0, &type, (LPBYTE) (config ? config + 1: NULL), &sz );
> +            if((r == ERROR_SUCCESS) && ( type != REG_SZ)) {
> +                FIXME("SERVICE_CONFIG_DESCRIPTION: don't know how to handle type %d\n", type);
> +                return FALSE;
> +            }
> +            *needed += sz;
> +            if(config) {
> +                if(r == ERROR_SUCCESS)
> +                    config->lpDescription = (LPWSTR) (config + 1);
> +                else
> +                    config->lpDescription = NULL;

You are still not handling overflows correctly. What happens if size is
less than sizeof(SERVICE_DESCRIPTIONW)?

-- 
Alexandre Julliard
julliard at winehq.org


From christian.gmeiner at gmail.com  Wed Feb 20 05:59:14 2008
From: christian.gmeiner at gmail.com (Christian Gmeiner)
Date: Wed, 20 Feb 2008 12:59:14 +0100
Subject: Adding devices to registry with the help of hal
Message-ID: <3192d3cd0802200359n518a1f6asf9a081fe70ad5865@mail.gmail.com>

Hi all,

I want you to present my current proof-of-conecpt. It shows how we can use
hal.c of explorer to
create registry keys for devices.
Keep in mind that it only creates one registry key for each usb device at
the moment. Before I
investigate more time in this, I want to get some feedback about my method.
If you are happy with it, I will finish this suftt :)

Greets,
Christian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080220/464277f7/attachment.htm 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: devices_to_registry_preview.diff
Type: application/octet-stream
Size: 2899 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080220/464277f7/attachment.obj 

From julliard at winehq.org  Wed Feb 20 06:45:29 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 20 Feb 2008 13:45:29 +0100
Subject: shell32: Support getting the shell folder path for users other
	than the current user and the default user (take 2)
In-Reply-To: <200801271841.m0RIfM85030414@mailhost.geldorp.nl> (Ge van
	Geldorp's message of "Sun, 27 Jan 2008 19:41:27 +0100")
References: <200801271841.m0RIfM85030414@mailhost.geldorp.nl>
Message-ID: <87bq6bvlsm.fsf@wine.dyndns.org>

"Ge van Geldorp" <ge at thinstall.com> writes:

>      else
>      {
> +        LPWSTR sidStr = NULL;
>          LPCWSTR userPrefix = NULL;
>          HKEY hRootKey;

This is not used anywhere.

-- 
Alexandre Julliard
julliard at winehq.org


From mahanuu at free.fr  Wed Feb 20 07:17:41 2008
From: mahanuu at free.fr (Emmanuel Maillard)
Date: Wed, 20 Feb 2008 14:17:41 +0100
Subject: add rule for the .m suffix
In-Reply-To: <19e31a080802200431m3c3c9372mbb2090ef2ac3987b@mail.gmail.com>
References: <19e31a080802200431m3c3c9372mbb2090ef2ac3987b@mail.gmail.com>
Message-ID: <C85E13C8-1DA8-4E4F-9FB5-97FE7E451AB1@free.fr>

Hi,

Did you convince Alexandre Julliard to include Objective-C on wine  
tree ??
Because you need to if you want to submit my patches to winehq,
or rewrite it in plain C with Carbon.

Emmanuel

Le 20 f?vr. 08 ? 13:31, Steven Edwards a ?crit :

> This is needed for quartzdrv patch. Trying to reduce the size of the
> diff, I expect a real winequartzdrv will need it later on anyway
>
> -- 
> Steven Edwards
>
> "There is one thing stronger than all the armies in the world, and
> that is an idea whose time has come." - Victor Hugo
> <support-m-suffix.patch>



From vostok at etersoft.ru  Wed Feb 20 08:19:24 2008
From: vostok at etersoft.ru (Anatoly Lyutin)
Date: Wed, 20 Feb 2008 17:19:24 +0300
Subject: [1/2] user32:scroll: Added some tests for scrollbar [try2]
Message-ID: <47BC36EC.8010606@etersoft.ru>

Alexandre Julliard wrote:
> The tests fail:
>
> ../../../tools/runtest -q -P wine -M user32.dll -T ../../.. -p 
> user32_test.exe.so scroll.c && touch scroll.ok
> scroll.c:56: Test failed: The scrollbar window should be disabled.
> scroll.c:122: Test failed: The ShowScrollBar() should failed.
>   
Yes! These tests  must be failed in WINE,  but it passes clear in Win 
XP. I just want to show you some incorrect behavior of scrollbar in WINE.

Should I mark these tests  as "todo_wine"?

-- 
Best regards
	Anatoly Lyutin.



From christian.gmeiner at gmail.com  Wed Feb 20 05:09:54 2008
From: christian.gmeiner at gmail.com (Christian Gmeiner)
Date: Wed, 20 Feb 2008 12:09:54 +0100
Subject: Adding devices to registry with the help of hal
Message-ID: <3192d3cd0802200309w426ec451xeee11602abe19243@mail.gmail.com>

Hi all,

I want you to present my current proof-of-conecpt. It shows how we can use
hal.c of explorer to
create registry keys for devices.
Keep in mind that it only creates one registry key for each usb device at
the moment. Before I
investigate more time in this, I want to get some feedback about my method.
If you are happy with it, I will finish this suftt :)

Greets,
Christian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080220/bde75863/attachment-0001.htm 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: devices_to_registry_preview.diff
Type: application/octet-stream
Size: 2899 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080220/bde75863/attachment-0001.obj 

From dmitry at codeweavers.com  Wed Feb 20 09:13:53 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 20 Feb 2008 23:13:53 +0800
Subject: gdi32dll: bitblt.c. Fix copying from uninitialized memory
References: <200802201707.25519.avd@office.etersoft.ru>
Message-ID: <019101c873d3$36c19890$a600fea9@DMITRY>

"Alexander Demakin" <avd at etersoft.ru> wrote:

> This patch adds check of return value of GetDIBits in BitBlt.c. If a error 
> occurs, GetDIBits returns 0 and bits variable points to  uninitialized data. 
> It always occurs when calling BitBlt for printer context due to 
> implementation of PSDRV_SelectBitmap().
> Changelog:
> gdi32.dll Fix copying from uninitialized memory.

You are mixing tabs and spaces in the patch, otherwise tha patch looks
good to me.

-- 
Dmitry.


From dmitry at baikal.ru  Wed Feb 20 09:39:10 2008
From: dmitry at baikal.ru (Dmitry Timoshkov)
Date: Wed, 20 Feb 2008 23:39:10 +0800
Subject: user32dll: cursoricon.c. Fix 16b BMP handling with BT_BITFIELD.
References: <200802201706.35517.avd@office.etersoft.ru>
Message-ID: <01ad01c873d6$c1a85810$a600fea9@DMITRY>

"Alexander Demakin" <avd at etersoft.ru> wrote:

> This patch fixes image header handling with BT_BITFIELD flag. 12 bytes of mask 
> were included into image bits, it caused some color troubles and image 
> horizontal shift. Size of bitmap info structure includes now this bytes. 

You are mixing tabs and spaces again, and please use 4 spaces for indentation.

>  static int bitmap_info_size( const BITMAPINFO * info, WORD coloruse )
>  {
>      int colors;
> -
> +    int result;
>      if (info->bmiHeader.biSize == sizeof(BITMAPCOREHEADER))

Any reason you have removed a space after a variable declaration?

> Changelog:
> user32.dll Fix 16b BMP handling with BT_BITFIELD.

Please have a look how others name the patches. A usual convenience is
to write dll name without extension, ': ' and short description.

-- 
Dmitry.


From juan.lang at gmail.com  Wed Feb 20 10:09:08 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Wed, 20 Feb 2008 08:09:08 -0800
Subject: Adding devices to registry with the help of hal
In-Reply-To: <3192d3cd0802200359n518a1f6asf9a081fe70ad5865@mail.gmail.com>
References: <3192d3cd0802200359n518a1f6asf9a081fe70ad5865@mail.gmail.com>
Message-ID: <3a768c550802200809j1af36096l2e36529f2248e08d@mail.gmail.com>

Hi Christian,

+        /* [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USB\Vid_13fe&Pid_1a00\
*/
+        sprintf(reg_key, "%s%04x&Pid_%04x", usb_key, pid, vid);

I think you mix up pid and vid here.

I don't think you shouldn't create the registry keys directly.  You
should be using the SetupDi APIs instead, I think.  That should make
getting all the fiddly little details right a little easier.
--Juan


From thestig at google.com  Wed Feb 20 11:52:03 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 20 Feb 2008 09:52:03 -0800
Subject: bugzilla on the fritz again
In-Reply-To: <a71bd89a0802170951s7d39cfbbld5d6bbc2bd1252c0@mail.gmail.com>
References: <a71bd89a0802170951s7d39cfbbld5d6bbc2bd1252c0@mail.gmail.com>
Message-ID: <558b2f5c0802200952p2a50d7d4rc659023c3c5a61b0@mail.gmail.com>

On Feb 17, 2008 9:51 AM, Dan Kegel <dank at kegel.com> wrote:
> Just started getting this:
>
> Software error:
>
> Can't connect to the database.
> Error: Too many connections
>   Is your database installed and up and running?
>   Do you have the correct username and password selected in localconfig?
>
>
>

Bugzilla is down again.


From gerald at pfeifer.com  Wed Feb 20 09:11:12 2008
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Wed, 20 Feb 2008 16:11:12 +0100 (CET)
Subject: dlls/msi/streams.c type fixes
In-Reply-To: <22821af30802171004u47fb4c2dw2d0f1b20d3e8316c@mail.gmail.com>
References: <alpine.LSU.1.00.0802171320180.32184@pulcherrima.dbai.tuwien.ac.at>
	<22821af30802171004u47fb4c2dw2d0f1b20d3e8316c@mail.gmail.com>
Message-ID: <alpine.LSU.1.00.0802201610440.9517@pulcherrima.dbai.tuwien.ac.at>

On Sun, 17 Feb 2008, James Hawkins wrote:
>>  static INT add_streams_to_table(MSISTREAMSVIEW *sv)
>> +    /* Return -1 in case of error. */
> Don't add random comments like this.

Okay, will keep this in mind, especially for dlls/msi.

Gerald


From wine.dev at web.de  Wed Feb 20 15:04:51 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Wed, 20 Feb 2008 22:04:51 +0100
Subject: James Hawkins : msi: Forward MsiSourceListEnumSourcesA to a
	stub implementation of MsiSourceListEnumSourcesW .
In-Reply-To: <E1JRoLV-0001Jm-Gl@wine.codeweavers.com>
References: <E1JRoLV-0001Jm-Gl@wine.codeweavers.com>
Message-ID: <1203541491.7008.12.camel@p4>

On Mi, 2008-02-20 at 06:46 -0600, 
> +/******************************************************************
> + *  MsiSourceListEnumSourcesA   (MSI.@)
> + */
> +UINT WINAPI MsiSourceListEnumSourcesW( 


Greetings from Copy & Paste :-)


BTW: Congratulations James for you new Address


-- 
 
By by ... Detlef




From m.b.lankhorst at gmail.com  Wed Feb 20 15:07:15 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 20 Feb 2008 13:07:15 -0800
Subject: Adding devices in setupapi
In-Reply-To: <3a768c550802192135m6826777h41c6d200d0bb6be7@mail.gmail.com>
References: <b130c85e0802191548p31ce171dm44ffa728b9216545@mail.gmail.com>
	<3a768c550802191600u4ffc8744q9a31b01d37d753b7@mail.gmail.com>
	<b130c85e0802191604r11a75c2drdbfe72a77161bba5@mail.gmail.com>
	<3a768c550802191615r72a2792dy11363e774797784c@mail.gmail.com>
	<b130c85e0802191703r61e0f238jbce39c2b0873ce70@mail.gmail.com>
	<3a768c550802191706t29b94d8bo934ad9fca565644f@mail.gmail.com>
	<b130c85e0802191901r7533922do8c7ceb5326c86ac2@mail.gmail.com>
	<3a768c550802192135m6826777h41c6d200d0bb6be7@mail.gmail.com>
Message-ID: <b130c85e0802201307p5c446a11o99395bd78d469858@mail.gmail.com>

Hi Juan,

2008/2/19, Juan Lang <juan.lang at gmail.com>:
> >  How hard is it to create a stub forwarder dll for setupapi and cfgmgr32?
>
> Not sure what you mean exactly.  cfgmgr32 should forward to setupapi
> already, and I sent a patch that does that for the few stub functions
> that it had.  setupapi's CM_* stubs could be improved, but I don't
> think you'll be able to forward them to any native code to try out:  I
> expect the Windows configuration manager is rather too low level to
> run under Wine.
>
> You'll probably want to create a hacky version of setupapi that
> creates a fake device tree, with a root, USB hub, and iPod device,
> just to see if that makes iTunes happy.

I think it probably does something similar to:
http://www.codeproject.com/KB/system/RemoveDriveByLetter.aspx

Except instead of mapping a drive to usb device, it does it the other
way around.

After looking more into it it really looks like this is the thing it
does. (I need a bunch of hacks for it to work, but alas.) However it
doesn't get me much further since our IOCTL_STORAGE_GET_DEVICE_NUMBER
ioctl is a stub. I would need something that can at least guarantee
uniqueness per volume for it, perhaps a conversion of drive letter to
integer. Now I just need to figure that one out.

Cheers,
Maarten.


From dank at kegel.com  Wed Feb 20 16:02:23 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 20 Feb 2008 14:02:23 -0800
Subject: Kudos for Photoshop work
Message-ID: <a71bd89a0802201402i776b2049r720c7913fce84b61@mail.gmail.com>

In http://linux.slashdot.org/comments.pl?sid=460616&cid=22493322, an
anonymous coward said:

--- snip ---
Preamble: I'm a photographer needing to process tens of thousands of
photos relatively swiftly. The functionality I need isn't all that
advanced (curves, levels, an occasional straighten horizon (measure +
arbitrary rotate), crop, unsharp mask, and sometimes an action to find
edges, feather and apply unsharp mask on that), but being able to
access and apply this functionality swiftly is an absolute must
because of the volume of photos I deal with. Photoshop is optimized to
perfection to allow a swift workflow, while the gimp seems optimized
to perfection to hinder it. Focus is never where I need it, shortcuts
to access tools don't work depending on which sub-window has focus,
etc. So yes, I really need Photoshop.

I last tried Photoshop 7 under wine about a year ago. It was
functional to an amazing degree (for someone who'd never seen or used
wine before), but the rough edges were slightly too rough for me to be
able to switch to Linux fulltime. I could trigger a dozen crashes in
Photoshop at will just by resizing panels and doing other simple
things like that, the program didn't feel native (alt-tabbing would
keep the panels in the foreground, obscuring other programs), and
focus sometimes strayed, amongst other lesser (but still annoyingly
noticeable) issues.

I just tried the latest wine with these Google sponsored improvements,
and wow. This is an amazing difference. Every single issue I saw a
year ago is gone. Photoshop feels as responsive as it does under
Windows (perhaps even more so), and I went through an hour long
editing session without being slowed down or annoyed even once.

As far as I'm concerned, Linux is now ready to become my main OS.

Google: I don't like your lack of respect for my privacy, but for this
work on Wine, I can say from the bottom of my heart: Thank you!
--- snip ---

Ah.  Music to my ears :-)

- Dan


From julliard at winehq.org  Wed Feb 20 16:15:36 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 20 Feb 2008 23:15:36 +0100
Subject: [1/2] user32:scroll: Added some tests for scrollbar [try2]
In-Reply-To: <47BC36EC.8010606@etersoft.ru> (Anatoly Lyutin's message of "Wed, 
	20 Feb 2008 17:19:24 +0300")
References: <47BC36EC.8010606@etersoft.ru>
Message-ID: <87lk5ftgtz.fsf@wine.dyndns.org>

Anatoly Lyutin <vostok at etersoft.ru> writes:

> Yes! These tests  must be failed in WINE,  but it passes clear in Win 
> XP. I just want to show you some incorrect behavior of scrollbar in WINE.
>
> Should I mark these tests  as "todo_wine"?

Yes.

-- 
Alexandre Julliard
julliard at winehq.org


From austinenglish at gmail.com  Wed Feb 20 16:50:19 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 20 Feb 2008 16:50:19 -0600
Subject: No new Wine Weekly News?
Message-ID: <b6bb06270802201450m105824fyf76c2faab17235d5@mail.gmail.com>

Hasn't been a new Wine Weekly News in about a month...quite a bit has
been going on, with CS2 working out of the box, test suite fixes, etc.
Anyone know what's going on?

-Austin


From chmorgan at gmail.com  Wed Feb 20 18:31:06 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Wed, 20 Feb 2008 19:31:06 -0500
Subject: appdb: database issues
In-Reply-To: <f5d9424f0802201501ma5f9b3ewb18d719938761268@mail.gmail.com>
References: <f5d9424f0802201501ma5f9b3ewb18d719938761268@mail.gmail.com>
Message-ID: <f3f1b91a0802201631r3501d5ci5bc3f9a08b0e5311@mail.gmail.com>

In include/query.php in query_appdb() we only call mysql_connect() if
the global $hAppdbLink isn't a valid resource. So, when a user
connects to display a page the first query should open the connection
and upon completion of the script $hAppdbLink will be freed and the
connection should be closed. So I'm not sure that this is the cause of
the out-of-connections issue although I don't see a reason why we
shouldn't just let php take care of this internally and apply a
variation of your change where we always attempt to connect and select
the appropriate database and remove the global handle and the resource
check etc.

Chris



On Wed, Feb 20, 2008 at 6:01 PM, Jeff Zaroyko <jeffzaroyko at gmail.com> wrote:
> The mysql database for the appdb/bugzilla appears to have gone down again,
>  I decided to look at the connection code in the appdb, as the appdb is thought
>  to be the culprit.
>
>  I came across the call to mysql_connect which is using the new_link parameter
>  set to true, which is supposedly to force a new connection to be established.
>
>  So, I searched through the git commit history using gitk and saw that Paul van
>  Schayck made a change introducing this, apparently because mysql was having
>  stability issues, back in 2005.
>
>  http://www.winehq.org/pipermail/wine-patches/2005-January/014985.html
>
>  my understanding is that php will automagically reuse connections if this is not
>  set, would there by any objection to trialling a removal of this
>  option to see if
>  stability increases?
>
>
>
>


From zgold550 at gmail.com  Wed Feb 20 19:14:55 2008
From: zgold550 at gmail.com (Zachary Goldberg)
Date: Wed, 20 Feb 2008 20:14:55 -0500
Subject: No new Wine Weekly News?
In-Reply-To: <b6bb06270802201450m105824fyf76c2faab17235d5@mail.gmail.com>
References: <b6bb06270802201450m105824fyf76c2faab17235d5@mail.gmail.com>
Message-ID: <b050a5e70802201714k6b8b5df2g6b7d8444eb940856@mail.gmail.com>

On Wed, Feb 20, 2008 at 5:50 PM, Austin English <austinenglish at gmail.com> wrote:
> Hasn't been a new Wine Weekly News in about a month...quite a bit has
>  been going on, with CS2 working out of the box, test suite fixes, etc.
>  Anyone know what's going on?
>
>  -Austin
>

I got a new job a few weeks ago and I immediately checked with my boss
as to whether or not I was allowed to continue with WWN.  He hasn't
gotten back to me on the matter until now.  Expect a new WWN next
Monday which will cover _a lot_.

-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From fgouget at free.fr  Wed Feb 20 19:36:44 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 21 Feb 2008 02:36:44 +0100 (CET)
Subject: appdb: Increase readability by using slightly softer colours on
	Warning and Notes
In-Reply-To: <f5d9424f0802191812o14be580doc15deb623fc273b@mail.gmail.com>
References: <f5d9424f0802191812o14be580doc15deb623fc273b@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0802210235480.13643@amboise.dolphin>

On Wed, 20 Feb 2008, Jeff Zaroyko wrote:

> The default colours for warnings and notes on the appdb pages feel
> rather strong, this patch changes the red and blue to be a bit softer.
> 
> I think this makes it more readable.  A comparison can be seen here:
> http://jeffz.name/tmp/

In new.png the green looks darker than the others. Maybe it should be 
lightened up a bit too.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                  In a world without fences who needs Gates?


From chmorgan at gmail.com  Wed Feb 20 19:45:41 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Wed, 20 Feb 2008 20:45:41 -0500
Subject: appdb: Increase readability by using slightly softer colours on
	Warning and Notes
In-Reply-To: <alpine.DEB.1.00.0802210235480.13643@amboise.dolphin>
References: <f5d9424f0802191812o14be580doc15deb623fc273b@mail.gmail.com>
	<alpine.DEB.1.00.0802210235480.13643@amboise.dolphin>
Message-ID: <f3f1b91a0802201745p51ec130bid27dda37eda33d6b@mail.gmail.com>

On Wed, Feb 20, 2008 at 8:36 PM, Francois Gouget <fgouget at free.fr> wrote:
>
> On Wed, 20 Feb 2008, Jeff Zaroyko wrote:
>
>  > The default colours for warnings and notes on the appdb pages feel
>  > rather strong, this patch changes the red and blue to be a bit softer.
>  >
>  > I think this makes it more readable.  A comparison can be seen here:
>  > http://jeffz.name/tmp/
>
>  In new.png the green looks darker than the others. Maybe it should be
>  lightened up a bit too.
>
>
>  --
>  Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
>                   In a world without fences who needs Gates?
>
>


We might also consider inverting the color of the text to increase the
contrast since it seems difficult to read.

Chris


From ehoover at mines.edu  Wed Feb 20 20:08:11 2008
From: ehoover at mines.edu (Erich Hoover)
Date: Wed, 20 Feb 2008 19:08:11 -0700
Subject: Adding devices in setupapi
Message-ID: <4c1ac96d0802201808u16f20b1bke6081bb73df7dc19@mail.gmail.com>

>
> I think it probably does something similar to:
> http://www.codeproject.com/KB/system/RemoveDriveByLetter.aspx
>
> Except instead of mapping a drive to usb device, it does it the other
> way around.
>
> After looking more into it it really looks like this is the thing it
> does. (I need a bunch of hacks for it to work, but alas.) However it
> doesn't get me much further since our IOCTL_STORAGE_GET_DEVICE_NUMBER
> ioctl is a stub. I would need something that can at least guarantee
> uniqueness per volume for it, perhaps a conversion of drive letter to
> integer. Now I just need to figure that one out.
>
> Cheers,
> Maarten.
>
> I do not believe the device number matching is the problem, I have been
exploring this problem a little with RemoveDriveByLetter and I believe that
it is not working because the SymbolicLink entry is not added as a "real"
thing in Wine. Performing an experiment with accessing the same drive letter
in three different ways (results below, last parameter is "hDrive") I see
that only the call with the registry-returned value for the drive fails
(even if it is added to "HKLM/System/MountedDevices").  I believe that a
call to IoCreateSymbolicLink must be made in order for the name returned by
the registry to be recognized as an alias for the drive.  I think iTunes is
probably going through the device tree looking for its vendor and product
code.  It should get this back from CM_Get_Device_ID, but I do not have
Windows so I cannot fake iTunes out to confirm this.

SetupDiGetDeviceInterfaceDetail
'\\?\USBSTOR#Disk&Ven_Apple&Prod_iPod&Rev_1.62#000A27001420C124&0#{53f56307-b6bf-11d0-94f2-00a0c91efb8b}':
-1
SetupDiGetDeviceInterfaceDetail
'\\?\Volume{00000000-0000-0000-0000-000000000048}': 60
SetupDiGetDeviceInterfaceDetail '\\.\H:': 64
Device number comparison: 1 1
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080220/af222f85/attachment-0001.htm 

From jeffzaroyko at gmail.com  Wed Feb 20 20:24:55 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Thu, 21 Feb 2008 13:24:55 +1100
Subject: appdb: Increase readability by using slightly softer colours on
	Warning and Notes
In-Reply-To: <f3f1b91a0802201745p51ec130bid27dda37eda33d6b@mail.gmail.com>
References: <f5d9424f0802191812o14be580doc15deb623fc273b@mail.gmail.com>
	<alpine.DEB.1.00.0802210235480.13643@amboise.dolphin>
	<f3f1b91a0802201745p51ec130bid27dda37eda33d6b@mail.gmail.com>
Message-ID: <f5d9424f0802201824v4183a3b1m69be50cdf3272c5d@mail.gmail.com>

On Thu, Feb 21, 2008 at 12:45 PM, Chris Morgan <chmorgan at gmail.com> wrote:
>
> On Wed, Feb 20, 2008 at 8:36 PM, Francois Gouget <fgouget at free.fr> wrote:
>  >
>  > On Wed, 20 Feb 2008, Jeff Zaroyko wrote:
>  >
>  >  > The default colours for warnings and notes on the appdb pages feel
>  >  > rather strong, this patch changes the red and blue to be a bit softer.
>  >  >
>  >  > I think this makes it more readable.  A comparison can be seen here:
>  >  > http://jeffz.name/tmp/
>  >
>  >  In new.png the green looks darker than the others. Maybe it should be
>  >  lightened up a bit too.
>  >
>  >
>  >  --
>  >  Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
>  >                   In a world without fences who needs Gates?
>  >
>  >
>
>
>  We might also consider inverting the color of the text to increase the
>  contrast since it seems difficult to read.
>
>  Chris
>

how about moving the title to the row below?  removes the contrasting
text problem

http://jeffz.name/tmp/suggestion.png


From jeffzaroyko at gmail.com  Wed Feb 20 20:47:35 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Thu, 21 Feb 2008 13:47:35 +1100
Subject: appdb: Increase readability by using slightly softer colours on
	Warning and Notes
In-Reply-To: <f5d9424f0802201824v4183a3b1m69be50cdf3272c5d@mail.gmail.com>
References: <f5d9424f0802191812o14be580doc15deb623fc273b@mail.gmail.com>
	<alpine.DEB.1.00.0802210235480.13643@amboise.dolphin>
	<f3f1b91a0802201745p51ec130bid27dda37eda33d6b@mail.gmail.com>
	<f5d9424f0802201824v4183a3b1m69be50cdf3272c5d@mail.gmail.com>
Message-ID: <f5d9424f0802201847h3a83f6e6qf84758b08b304b82@mail.gmail.com>

On Thu, Feb 21, 2008 at 1:24 PM, Jeff Zaroyko <jeffzaroyko at gmail.com> wrote:
> On Thu, Feb 21, 2008 at 12:45 PM, Chris Morgan <chmorgan at gmail.com> wrote:
>  >
>
>
> > On Wed, Feb 20, 2008 at 8:36 PM, Francois Gouget <fgouget at free.fr> wrote:
>  >  >
>  >  > On Wed, 20 Feb 2008, Jeff Zaroyko wrote:
>  >  >
>  >  >  > The default colours for warnings and notes on the appdb pages feel
>  >  >  > rather strong, this patch changes the red and blue to be a bit softer.
>  >  >  >
>  >  >  > I think this makes it more readable.  A comparison can be seen here:
>  >  >  > http://jeffz.name/tmp/
>  >  >
>  >  >  In new.png the green looks darker than the others. Maybe it should be
>  >  >  lightened up a bit too.
>  >  >
>  >  >
>  >  >  --
>  >  >  Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
>  >  >                   In a world without fences who needs Gates?
>  >  >
>  >  >
>  >
>  >
>  >  We might also consider inverting the color of the text to increase the
>  >  contrast since it seems difficult to read.
>  >
>  >  Chris
>  >
>
>
>
> how about moving the title to the row below?  removes the contrasting
>  text problem
>
>  http://jeffz.name/tmp/suggestion.png
>

I think this looks good, http://jeffz.name/tmp/suggestion3.png

Do you still think we need to change the green Francois?


From paul.vriens.wine at gmail.com  Thu Feb 21 03:38:10 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 21 Feb 2008 10:38:10 +0100
Subject: slc: Added stub for SLGetWindowsInformationDWORD
In-Reply-To: <fpjfr7$675$1@ger.gmane.org>
References: <fpjfr7$675$1@ger.gmane.org>
Message-ID: <229cc3050802210138p14dc60ch4bf9ef81c8d0bfd@mail.gmail.com>

On Thu, Feb 21, 2008 at 10:20 AM, Alistair Leslie-Hughes
<leslie_alistair at hotmail.com> wrote:
> Hi,
>
>  Changelog:
>         slc: Added stub for SLGetWindowsInformationDWORD
>
>  Best Regards
>   Alistair Leslie-Hughes
>
Hi Alistair,

I know that function descriptions should always be your own words but
I guess this is also true for header files.

The comments in slerror.h are exactly like the comments on MSDN:
http://msdn2.microsoft.com/en-us/library/aa965835(VS.85).aspx

Cheers,

Paul.


From truiken at gmail.com  Thu Feb 21 03:48:07 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 21 Feb 2008 03:48:07 -0600
Subject: slc: Added stub for SLGetWindowsInformationDWORD
In-Reply-To: <229cc3050802210138p14dc60ch4bf9ef81c8d0bfd@mail.gmail.com>
References: <fpjfr7$675$1@ger.gmane.org>
	<229cc3050802210138p14dc60ch4bf9ef81c8d0bfd@mail.gmail.com>
Message-ID: <22821af30802210148k75256e03r482388a79a1110d6@mail.gmail.com>

On Thu, Feb 21, 2008 at 3:38 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>
> On Thu, Feb 21, 2008 at 10:20 AM, Alistair Leslie-Hughes
>  <leslie_alistair at hotmail.com> wrote:
>  > Hi,
>  >
>  >  Changelog:
>  >         slc: Added stub for SLGetWindowsInformationDWORD
>  >
>  >  Best Regards
>  >   Alistair Leslie-Hughes
>  >
>  Hi Alistair,
>
>  I know that function descriptions should always be your own words but
>  I guess this is also true for header files.
>
>  The comments in slerror.h are exactly like the comments on MSDN:
>  http://msdn2.microsoft.com/en-us/library/aa965835(VS.85).aspx
>

And on top of that, you really shouldn't be adding those types of
comments to the headers anyway (commenting a define).

-- 
James Hawkins


From leslie_alistair at hotmail.com  Thu Feb 21 04:06:49 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Thu, 21 Feb 2008 21:06:49 +1100
Subject: slc: Added stub for SLGetWindowsInformationDWORD
References: <fpjfr7$675$1@ger.gmane.org><229cc3050802210138p14dc60ch4bf9ef81c8d0bfd@mail.gmail.com>
	<22821af30802210148k75256e03r482388a79a1110d6@mail.gmail.com>
Message-ID: <fpjifl$f1g$1@ger.gmane.org>

Gee, you guys are quick. 

Submitted again without the comments.

Best Regards
 Alistair Leslie-Hughes



From fgouget at free.fr  Thu Feb 21 04:45:32 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 21 Feb 2008 11:45:32 +0100 (CET)
Subject: appdb: Increase readability by using slightly softer colours on
	Warning and Notes
In-Reply-To: <f5d9424f0802201847h3a83f6e6qf84758b08b304b82@mail.gmail.com>
References: <f5d9424f0802191812o14be580doc15deb623fc273b@mail.gmail.com>
	<alpine.DEB.1.00.0802210235480.13643@amboise.dolphin>
	<f3f1b91a0802201745p51ec130bid27dda37eda33d6b@mail.gmail.com>
	<f5d9424f0802201824v4183a3b1m69be50cdf3272c5d@mail.gmail.com>
	<f5d9424f0802201847h3a83f6e6qf84758b08b304b82@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0802211142410.17617@amboise.dolphin>

On Thu, 21 Feb 2008, Jeff Zaroyko wrote:
[...]
> I think this looks good, http://jeffz.name/tmp/suggestion3.png
> 
> Do you still think we need to change the green Francois?

I prefer to have the text in the colored bar because that way it matches 
the title at the top (Known bugs in suggestion.png).

So here's my proposal with a slightly lighter green and white text.
http://fgouget.free.fr/tmp/newfg.png

But I don't have a strong opinion on this, so do as you think is best.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
  Any sufficiently advanced Operating System is indistinguishable from Linux


From wine.dev at web.de  Thu Feb 21 06:50:06 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Thu, 21 Feb 2008 13:50:06 +0100
Subject: James Hawkins : itircl: Add a stub implementation of itircl.dll.
In-Reply-To: <E1JQPPz-0003H9-Me@wine.codeweavers.com>
References: <E1JQPPz-0003H9-Me@wine.codeweavers.com>
Message-ID: <1203598206.7395.14.camel@p4>

On Sa, 2008-02-16 at 09:57 -0600, Alexandre Julliard wrote:
> Module: wine
> Branch: master
> Commit: 58b0686e951364686c3b5b55c18566df0960fd96
> URL:
> http://source.winehq.org/git/wine.git/?a=commit;h=58b0686e951364686c3b5b55c18566df0960fd96
> 
> Author: James Hawkins <jhawkins at codeweavers.com>
> Date:   Fri Feb 15 17:39:46 2008 -0600
> 
> itircl: Add a stub implementation of itircl.dll.


Hi James.
While adding your Patch to http://wiki.winehq.org/Developers-Hints ,
I found this Page:

http://www.helpware.net/aphelp/info.htm

itircl.dll:   HTML Help 1 (found on w2k and xp)
itircl52.dll: MS Help 2
apircl.dll:   Assistance Platform 1.0 (Vista)



-- 
 
By by ... Detlef




From rob at codeweavers.com  Thu Feb 21 10:22:19 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 21 Feb 2008 16:22:19 +0000
Subject: dmband: Indirection levels fix
In-Reply-To: <200802202252.47917.andrew.talbot@talbotville.com>
References: <200802202252.47917.andrew.talbot@talbotville.com>
Message-ID: <47BDA53B.40301@codeweavers.com>

Andrew Talbot wrote:
> diff --git a/dlls/dmband/band.c b/dlls/dmband/band.c
> index 891fb5a..8b89573 100644
> --- a/dlls/dmband/band.c
> +++ b/dlls/dmband/band.c
> @@ -173,7 +173,7 @@ static HRESULT WINAPI IDirectMusicBandImpl_IDirectMusicObject_SetDescriptor (LPD
>  		This->pDesc->ftDate = pDesc->ftDate;
>  	if (pDesc->dwValidData & DMUS_OBJ_MEMORY) {
>  		This->pDesc->llMemLength = pDesc->llMemLength;
> -		memcpy (This->pDesc->pbMemData, pDesc->pbMemData, sizeof (pDesc->pbMemData));
> +		memcpy (&This->pDesc->pbMemData, &pDesc->pbMemData, sizeof (pDesc->pbMemData));
>  	}
>  	if (pDesc->dwValidData & DMUS_OBJ_STREAM) {
>  		/* according to MSDN, we copy the stream */

This isn't correct. Judging by the surrounding code, this should be 
allocating a block of memory of This->pDesc->pbMemData and then passing 
pDesc->llMemLength into memcpy, possibly validating that 
pDesc->llMemLength isn't greater than UINT_MAX to avoid an overflow.

-- 
Rob Shearman



From twickline at gmail.com  Thu Feb 21 10:37:15 2008
From: twickline at gmail.com (Tom Wickline)
Date: Thu, 21 Feb 2008 11:37:15 -0500
Subject: Do we need a forum?
In-Reply-To: <200802190119.57809.research@science.su>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802182357.41785.research@science.su>
	<19e31a080802181655u89f9fe4yad12edeeb31327bd@mail.gmail.com>
	<200802190119.57809.research@science.su>
Message-ID: <53e3a9930802210837jc2066eq8f9c821547252c35@mail.gmail.com>

On Mon, Feb 18, 2008 at 8:19 PM, L. Rahyen <research at science.su> wrote:
>
>
>  > Tom is committed to doing this with
>  > wine-forum. If there is something you don't like, such as the
>  > registration, advertisements, etc I am sure he is willing to adjust
>  > the user experience.
>
>         OK, then if he is reading this list hopefully he will consider my words as
>  feature request. If he really will fix these issues that would be great.
>  Thanks.
>
>
>

Sorry for the late reply, ive caught the flu bug and ive been sick for
the past week.

I have yet to receive the first email of complaint about the
advertisements on the forum.
I know the Kontera adverts are considered by some as nag, pop-up advertising but
ive yet to receive a message or email asking me to remove them.

As for registration, every forum ive ever visited asked for registration,
sorry but I don't understand what your asking for?

Tom


From meissner at suse.de  Thu Feb 21 10:54:19 2008
From: meissner at suse.de (Marcus Meissner)
Date: Thu, 21 Feb 2008 17:54:19 +0100
Subject: dplayx: Fix incorrect check in
	DirectPlayLobbyAImpl_EnumLocalApplications and
	IDirectPlayLobbyAImpl_EnumAddressTypes.
In-Reply-To: <47BDAA72.5070606@codeweavers.com>
References: <47BDAA72.5070606@codeweavers.com>
Message-ID: <20080221165419.GA13541@suse.de>

On Thu, Feb 21, 2008 at 04:44:34PM +0000, Robert Shearman wrote:
>
> Dereferencing a function pointer and checking it against NULL doesn't make 
> any sense, so remove the checks.


> -  if( !lpEnumAddressTypeCallback || !*lpEnumAddressTypeCallback )
> +  if( !lpEnumAddressTypeCallback )

It looks as if they were meant as &&, but that does not make much sense
either.

Ciao, Marcus


From stefandoesinger at gmx.at  Thu Feb 21 11:13:08 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 21 Feb 2008 18:13:08 +0100
Subject: [1/2] ddraw: release interfaces when exiting with error
In-Reply-To: <47BC95B7.3090109@inbox.lv>
References: <47BC95B7.3090109@inbox.lv>
Message-ID: <200802211813.08497.stefandoesinger@gmx.at>

Am Mittwoch, 20. Februar 2008 22:03:51 schrieben Sie:
> ---
>   dlls/ddraw/texture.c |    2 ++
>   1 files changed, 2 insertions(+), 0 deletions(-)
Just a general comment(not specific to comments): For such cleanup work it 
works quite nice to use goto(!), as shown below. Your patch is OK as it is, 
but I think its a good idea to use this scheme in all places because it helps 
to prevent new problems from coming in when the code is changed.

void *a = NULL, *b = NULL, *c = NULL;

a = malloc(10);
if(!a) goto error;
b = malloc(10);
if(!b) goto error;
c = malloc(10);
if(!c) goto error;
if(dosomethingelse() == FAIL) goto error;

return SUCCESS;

error:
f(c) free(c);
f(b) free(b);
f(a) free(a);
return FAIL;


From twickline at gmail.com  Thu Feb 21 11:32:36 2008
From: twickline at gmail.com (Tom Wickline)
Date: Thu, 21 Feb 2008 12:32:36 -0500
Subject: website: add links to most popular active Wine forums
In-Reply-To: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
Message-ID: <53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>

If you know of another active Wine forum - especially a non-english
one - please let us know so we can add it to the list. (Email to
dank at kegel.com would do.)

 ???????

http://www.wine-forum.org/forumdisplay.php?f=44

Tom

P.S

Sorry, the forums at http://www.wine-forum.org/index.php were not
popular enough to make this cut,
may I ask how many users = popular? The forum has 750+ registered users
in just over three months... 1, 2, 5 thousand??


On Tue, Feb 19, 2008 at 12:45 AM, Dan Kegel <dank at kegel.com> wrote:
> Perhaps this will help slake the thirst of those who periodically ask
>  if Wine needs a forum.
>
>
>
>

From kgbricola at web.de  Thu Feb 21 12:30:45 2008
From: kgbricola at web.de (=?ISO-8859-1?Q?Rico_Sch=FCller?=)
Date: Thu, 21 Feb 2008 19:30:45 +0100
Subject: wined3d: ActivateContext: try to fix wrong parameter?
Message-ID: <47BDC355.1080302@web.de>

Hi,

as suggested I send this patch for a discussion. This is a workaround 
for this bug http://bugs.winehq.org/show_bug.cgi?id=11584 .

I don't know if this patch is the right way to fix the problem.

Could someone with more knowledge have a look at this?

Cheers
Rico
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-wined3d-ActivateContext-try-to-fix-wrong-parameter.patch
Type: text/x-diff
Size: 0 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080221/336c5cd8/attachment.patch 

From kgbricola at web.de  Thu Feb 21 11:44:51 2008
From: kgbricola at web.de (=?utf-8?q?Rico=20Sch=C3=BCller?=)
Date: Thu, 21 Feb 2008 18:44:51 +0100
Subject: [PATCH] wined3d: ActivateContext: try to fix wrong parameter?
Message-ID: <mailman.5.1203618716.3731.wine-devel@winehq.org>

---
 dlls/wined3d/surface.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/dlls/wined3d/surface.c b/dlls/wined3d/surface.c
index 6a17949..fe460cd 100644
--- a/dlls/wined3d/surface.c
+++ b/dlls/wined3d/surface.c
@@ -835,7 +835,7 @@ static void read_from_framebuffer_texture(IWineD3DSurfaceImpl *This)
      * should help here. Furthermore unlockrect will need the context set up for blitting. The context manager will find
      * context->last_was_blit set on the unlock.
      */
-    ActivateContext(device, (IWineD3DSurface *) This, CTXUSAGE_BLIT);
+    ActivateContext(device, device->lastActiveRenderTarget, CTXUSAGE_BLIT); 
     surface_bind_and_dirtify(This);
     ENTER_GL();
 
-- 
1.5.3.3


--------------030407030109010102070207--


From dank at kegel.com  Thu Feb 21 12:41:28 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 21 Feb 2008 10:41:28 -0800
Subject: website: add links to most popular active Wine forums
In-Reply-To: <53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>
Message-ID: <a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>

2008/2/21 Tom Wickline <twickline at gmail.com>:
>  [if] the forums at http://www.wine-forum.org/index.php were not
>  popular enough to make this cut, may I ask how many users = popular?

Well, let's see:
Ubuntuforums: Threads: 685,027, Posts: 4,364,352, Members: 509,031
Linuxforums: Threads: 111,640, Posts: 550,654, Members: 149,826
Linuxforen.de: Themen: 238.148, Beitr?ge: 1.602.009, Benutzer: 70.611
comp.emulators.ms-windows.wine:  Threads: 22,816; no idea how many
posts or members.
wine-forum.org: Threads: 174, Posts: 529, Members: 751

I think you have to grow by about two orders of magnitude
to complete.  And even then, you'd be
fragmenting the user space.  I rather doubt the
average Ubuntu user, comfortable in his or her Ubuntu
forum, will venture afield when there's a wine area right
there in the ubuntu forum site.  Likewise, users comfortable
with the wine-users mailing list are unlikely to switch.  etc.
By adding a new forum, you're decreasing the quality of
support in the existing ones.
- Dan


From thunderbird2k at gmx.net  Thu Feb 21 13:12:24 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Thu, 21 Feb 2008 20:12:24 +0100
Subject: wined3d: ActivateContext: try to fix wrong parameter?
In-Reply-To: <47BDC355.1080302@web.de>
References: <47BDC355.1080302@web.de>
Message-ID: <20080221191224.59570@gmx.net>

> Hi,
> 
> as suggested I send this patch for a discussion. This is a workaround 
> for this bug http://bugs.winehq.org/show_bug.cgi?id=11584 .
> 
> I don't know if this patch is the right way to fix the problem.
> 
> Could someone with more knowledge have a look at this?
> 
> Cheers
> Rico

It is not a workaround but a patch which restores the original behavior of the LoadLocation function. During the merge of the two codepaths I missed this part.

Roderick
-- 
+++ GMX empfiehlt 1&1 Surf & Phone! +++
20 Jahre 1&1 - Jetzt 20%* Rabatt auf alle DSL-Pakete! http://www.gmx.net/de/go/dsl


From twickline at gmail.com  Thu Feb 21 13:29:32 2008
From: twickline at gmail.com (Tom Wickline)
Date: Thu, 21 Feb 2008 14:29:32 -0500
Subject: website: add links to most popular active Wine forums
In-Reply-To: <a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>
	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>
Message-ID: <53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>

http://img407.imageshack.us/img407/3949/googlegroupsmozillafirejz8.png

And Google Groups has 738 subscribers :D

There for a second I was feeling rather poorly about the wine-forum site.

So, I suppose the forums I put up are about as destructive as Goggle Groups.
Actually 13 Members less destructive.

-Tom


On Thu, Feb 21, 2008 at 1:41 PM, Dan Kegel <dank at kegel.com> wrote:
> 2008/2/21 Tom Wickline <twickline at gmail.com>:
>  >  [if] the forums at http://www.wine-forum.org/index.php were not
>
> >  popular enough to make this cut, may I ask how many users = popular?
>
>  Well, let's see:
>  Ubuntuforums: Threads: 685,027, Posts: 4,364,352, Members: 509,031
>  Linuxforums: Threads: 111,640, Posts: 550,654, Members: 149,826
>  Linuxforen.de: Themen: 238.148, Beitr?ge: 1.602.009, Benutzer: 70.611
>  comp.emulators.ms-windows.wine:  Threads: 22,816; no idea how many
>  posts or members.
>  wine-forum.org: Threads: 174, Posts: 529, Members: 751
>
>  I think you have to grow by about two orders of magnitude
>  to complete.  And even then, you'd be
>  fragmenting the user space.  I rather doubt the
>  average Ubuntu user, comfortable in his or her Ubuntu
>  forum, will venture afield when there's a wine area right
>  there in the ubuntu forum site.  Likewise, users comfortable
>  with the wine-users mailing list are unlikely to switch.  etc.
>  By adding a new forum, you're decreasing the quality of
>  support in the existing ones.
>  - Dan
>


From dank at kegel.com  Thu Feb 21 13:30:53 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 21 Feb 2008 11:30:53 -0800
Subject: website: add links to most popular active Wine forums
In-Reply-To: <53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>
	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>
	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>
Message-ID: <a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>

On Thu, Feb 21, 2008 at 11:29 AM, Tom Wickline <twickline at gmail.com> wrote:
>  And Google Groups has 738 subscribers :D
>
>  There for a second I was feeling rather poorly about the wine-forum site.
>
>  So, I suppose the forums I put up are about as destructive as Goggle Groups.

Nah, the usenet group's been there for over a decade,
it's not hurting anybody.  (Though it sure would be nice if
we had that bidirectional gateway working.  It never seems
to stay up.)


From mitchell.mebane at gmail.com  Thu Feb 21 13:39:21 2008
From: mitchell.mebane at gmail.com (Mitchell Mebane)
Date: Thu, 21 Feb 2008 13:39:21 -0600
Subject: website: add links to most popular active Wine forums
In-Reply-To: <a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>
	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>
Message-ID: <47BDD369.9060909@gmail.com>

Dan Kegel wrote:
> 2008/2/21 Tom Wickline <twickline at gmail.com>:
>   
>>  [if] the forums at http://www.wine-forum.org/index.php were not
>>  popular enough to make this cut, may I ask how many users = popular?
>>     
>
> Well, let's see:
> Ubuntuforums: Threads: 685,027, Posts: 4,364,352, Members: 509,031
> Linuxforums: Threads: 111,640, Posts: 550,654, Members: 149,826
> Linuxforen.de: Themen: 238.148, Beitr?ge: 1.602.009, Benutzer: 70.611
> comp.emulators.ms-windows.wine:  Threads: 22,816; no idea how many
> posts or members.
> wine-forum.org: Threads: 174, Posts: 529, Members: 751
>
> I think you have to grow by about two orders of magnitude
> to complete.  And even then, you'd be
> fragmenting the user space.  I rather doubt the
> average Ubuntu user, comfortable in his or her Ubuntu
> forum, will venture afield when there's a wine area right
> there in the ubuntu forum site.  Likewise, users comfortable
> with the wine-users mailing list are unlikely to switch.  etc.
> By adding a new forum, you're decreasing the quality of
> support in the existing ones.
> - Dan
>
>
>
>   

Soo... the obvious thing to do is contact all the major Linux forums 
with Wine sections, explain that we're trying to set up an official 
forum, and see if they'll lock their Wine sections and redirect members 
to the official forum.

If they all buy in, great.  If not, keep the status quo.

--mmebane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080221/c514415a/attachment.htm 

From Andrew.Talbot at talbotville.com  Thu Feb 21 15:13:32 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Thu, 21 Feb 2008 21:13:32 +0000
Subject: dmband: Indirection levels fix
References: <200802202252.47917.andrew.talbot@talbotville.com>
	<47BDA53B.40301@codeweavers.com>
Message-ID: <fpkpi5$ec8$1@ger.gmane.org>

Robert Shearman wrote:

> This isn't correct. Judging by the surrounding code, this should be
> allocating a block of memory of This->pDesc->pbMemData and then passing
> pDesc->llMemLength into memcpy, possibly validating that
> pDesc->llMemLength isn't greater than UINT_MAX to avoid an overflow.
> 

Yes. I realised later that there were two possibilites: pointer copying or
memory copying, so I sent an email to Alexandre, since I didn't have my
normal usenet access at the time.

I was unable to figure out whether This->pDesc->pbMemData needs its own
slice of memory or whether it can use that which comes with
pDesc->pbMemData. I shall leave this one (and a similar one in
dmcompos/chordmap.c) and sweep on with the easy fixes.

Thanks,

-- 
Andy.





From stefandoesinger at gmx.at  Thu Feb 21 16:57:49 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 21 Feb 2008 23:57:49 +0100
Subject: wined3d: ActivateContext: try to fix wrong parameter?
In-Reply-To: <20080221191224.59570@gmx.net>
References: <47BDC355.1080302@web.de> <20080221191224.59570@gmx.net>
Message-ID: <200802212357.51891.stefandoesinger@gmx.at>

Am Donnerstag, 21. Februar 2008 20:12:24 schrieb Roderick Colenbrander:
> It is not a workaround but a patch which restores the original behavior of
> the LoadLocation function. During the merge of the two codepaths I missed
> this part.
What happens if e.g. the current render target is an offscreen target and the 
application tries to read back the front or back buffer? In this case you'll 
read the offscreen target back.

So I am not sure this patch is correct
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080221/02349d50/attachment.pgp 

From winehacker at gmail.com  Thu Feb 21 17:11:05 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 21 Feb 2008 18:11:05 -0500
Subject: website: add links to most popular active Wine forums
In-Reply-To: <a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>
	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>
	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>
	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>
Message-ID: <19e31a080802211511i2b0b2985l980385395219e0e4@mail.gmail.com>

On Thu, Feb 21, 2008 at 2:30 PM, Dan Kegel <dank at kegel.com> wrote:
> On Thu, Feb 21, 2008 at 11:29 AM, Tom Wickline <twickline at gmail.com> wrote:
>  >  And Google Groups has 738 subscribers :D
>  >
>  >  There for a second I was feeling rather poorly about the wine-forum site.
>  >
>  >  So, I suppose the forums I put up are about as destructive as Goggle Groups.
>
>  Nah, the usenet group's been there for over a decade,
>  it's not hurting anybody.  (Though it sure would be nice if
>  we had that bidirectional gateway working.  It never seems
>  to stay up.)

So we have about 1400 people in a short period of time that like
forums and how no where else to go. I for one hate, despise, loath and
in general just don't like google groups. I like the general layout of
other web-forums like wine-forum however. All google groups gives us
is a gateway to wineusers newsgroup which has been around forever and
a day. I propose we make the gateway on wine-forum so it will have a
much more sane layout. Then it won't disrupt the existing userbase of
fragmented forum usage while adding a valuable service to the
community. Evidently an equal number of people prefer the wine-forum
to posting on google groups so the only solution I see is to add a
news gateway to wine-forum so it can access the same content....

Unless you have the power to make google groups not suck.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Thu Feb 21 17:13:11 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 21 Feb 2008 18:13:11 -0500
Subject: website: add links to most popular active Wine forums
In-Reply-To: <19e31a080802211511i2b0b2985l980385395219e0e4@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>
	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>
	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>
	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>
	<19e31a080802211511i2b0b2985l980385395219e0e4@mail.gmail.com>
Message-ID: <19e31a080802211513j3080cf62q1f375f0c2ea320d0@mail.gmail.com>

On Thu, Feb 21, 2008 at 6:11 PM, Steven Edwards <winehacker at gmail.com> wrote:
>  So we have about 1400 people in a short period of time that like
>  forums and how no where else to go. I for one hate, despise, loath and

Sorry let me make that clear. 1400 people that want a forum of some
type, wine-forum 700ish or  700ish google groups. How/Have no where
else to go...

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Thu Feb 21 17:28:28 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 21 Feb 2008 15:28:28 -0800
Subject: website: add links to most popular active Wine forums
In-Reply-To: <19e31a080802211511i2b0b2985l980385395219e0e4@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>
	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>
	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>
	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>
	<19e31a080802211511i2b0b2985l980385395219e0e4@mail.gmail.com>
Message-ID: <a71bd89a0802211528w74db5d5ci3d75a288dd402d02@mail.gmail.com>

On Thu, Feb 21, 2008 at 3:11 PM, Steven Edwards <winehacker at gmail.com> wrote:
>  So we have about 1400 people in a short period of time that like
>  forums and how no where else to go. I for one hate, despise, loath and
>  in general just don't like google groups. I like the general layout of
>  other web-forums like wine-forum however. All google groups gives us
>  is a gateway to wineusers newsgroup which has been around forever and
>  a day. I propose we make the gateway on wine-forum so it will have a
>  much more sane layout. Then it won't disrupt the existing userbase of
>  fragmented forum usage while adding a valuable service to the
>  community. ...
>
>  Unless you have the power to make google groups not suck.

I like the idea of a bidirectional forum gateway to wine-users. I
haven't seen one I actually like yet, but I trust one exists.

If you can explain what it is that makes google groups suck,
maybe I can do something about it.  Send those comments
to me offlist, though.
- Dan


From mpartap at gmx.net  Thu Feb 21 18:07:10 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Fri, 22 Feb 2008 01:07:10 +0100
Subject: website: add links to most popular active Wine forums
In-Reply-To: <a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>
	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>
Message-ID: <47BE122E.1000108@gmx.net>

 > (Though it sure would be nice if we had that bidirectional
 > gateway working.  It never seems to stay up.)

I tried to bring it up before, but anyways: drupal looks like a good way too go. It's fast, foss, 
flexible and with these modules
http://drupal.org/project/mailman_manager
http://drupal.org/project/user_mailman_register
http://drupal.org/project/mailhandler
http://drupal.org/project/listhandler
and a bit of work it will be a perfectly synchronized mailing list - forum hybrid thing mirroring 
f.e. wine-user in a forum and vice versa. However, these modules have not yet been ported to Drupal 
6 yet, also this all still looks a bit hackish. At the moment I have to do some intensive studying 
for an exam in three weeks, after that I'll try messing with those as I want to use them on my own 
website, too. When I'm ready with that, I'll report back. Don't hold your breath, it'll take at 
least another month...
regards marcel


-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution @ http://hfopi.org/vote-future
</div>



From jwhite at winehq.org  Thu Feb 21 18:28:11 2008
From: jwhite at winehq.org (Jeremy White)
Date: Thu, 21 Feb 2008 18:28:11 -0600
Subject: website: add links to most popular active Wine forums
In-Reply-To: <47BE122E.1000108@gmx.net>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>
	<47BE122E.1000108@gmx.net>
Message-ID: <47BE171B.90303@winehq.org>

> I tried to bring it up before, but anyways: drupal looks like a good way too go. It's fast, foss, 
> flexible and with these modules

I did some looking into this myself.  Drupal looked interesting, but the solution
that seemed simplest and best to me was using a  phpbb and a mailman <--> phpbb gateway.
So we're experimenting with that at the moment (thanks, Newman :-/).

The plan is to continue fuddling and let some data fill, and then cut
it live in a day or so.   If we hate it, we can continue looking for
a solution...

Cheers,

Jeremy


From tom at dbservice.com  Thu Feb 21 18:50:09 2008
From: tom at dbservice.com (Tomas Carnecky)
Date: Fri, 22 Feb 2008 01:50:09 +0100
Subject: Wine and PulseAudio
Message-ID: <47BE1C41.7040506@dbservice.com>

This subject was discussed a few months ago (around 10/2007). But it was 
rather a discussion about whether to make a PA sound driver or not. I 
personally would love to see that happen, if not only because PA has 
some very nifty features, like per-app volume, transparent sink 
switching etc, some of which are impossible to emulate through the alsa 
pulse plugin. Also, then next Ubuntu and Fedora releases will have PA 
enabled by default so if Wine doesn't work with that well there will be 
  complaints.

I switched my desktop to PA yesterday, got most apps working, and to my 
surprise even flash (netscape 32bit plugin in a 64bit browser). All apps 
that I need use PA natively, only Wine doesn't have a PA sound driver. 
Since winealsa.drv will stay the default driver for Linux for the 
foreseeable future, I started digging and hacking to see why it doesn't 
work with the alsa pulse plugin and what can be fixed. There are a few 
bug reports that track the winealsa.drv/PA issue, such as [1].

There is very little required to make it work. Only two tiny changes to 
the alsa pulse plugin (one can be described as a quirk, until I figure 
out how exactly the alsa API can be emulated using PA, seems to be a 
very specific issue in how Wine uses the alsa API since other apps work 
fine) and sound works perfectly (tested with foobar2000 and WoW, both 
playback and recording). alsa-1.0.16 was just released, so I hope the 
needed changes make it into the next version.

In the PA volume control, all wine apps show up under the same name:
ALSA plug-in [wine-preloader]
and thus share the same volume and sink preferences. The alsa plugin 
could try to do some /proc/self voodoo to extract the true exe name. But 
given the simplicity of the PA API (no hwparams negotiation, just 
request a format and you'll get it) and the current problems with the 
alsa pulse plugin, I think a true wine sound driver would be a viable 
alternative. I'm still waiting to hear from those people who have said 
that they have a wine PA driver working :)

tom

[1] http://bugs.winehq.org/show_bug.cgi?id=10910.


From jjmckenzie51 at sprintpcs.com  Thu Feb 21 19:57:10 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Thu, 21 Feb 2008 18:57:10 -0700
Subject: appdb: Increase readability by using slightly softer colours
	on	Warning and Notes
In-Reply-To: <alpine.DEB.1.00.0802211142410.17617@amboise.dolphin>
References: <f5d9424f0802191812o14be580doc15deb623fc273b@mail.gmail.com>
	<alpine.DEB.1.00.0802210235480.13643@amboise.dolphin>
	<f3f1b91a0802201745p51ec130bid27dda37eda33d6b@mail.gmail.com>
	<f5d9424f0802201824v4183a3b1m69be50cdf3272c5d@mail.gmail.com>
	<f5d9424f0802201847h3a83f6e6qf84758b08b304b82@mail.gmail.com>
	<alpine.DEB.1.00.0802211142410.17617@amboise.dolphin>
Message-ID: <47BE2BF6.7090506@sprintpcs.com>

Francois Gouget wrote:
> On Thu, 21 Feb 2008, Jeff Zaroyko wrote:
> [...]
>   
>> I think this looks good, http://jeffz.name/tmp/suggestion3.png
>>
>> Do you still think we need to change the green Francois?
>>     
>
> I prefer to have the text in the colored bar because that way it matches 
> the title at the top (Known bugs in suggestion.png).
>
> So here's my proposal with a slightly lighter green and white text.
> http://fgouget.free.fr/tmp/newfg.png
>
> But I don't have a strong opinion on this, so do as you think is best.
>
>   
I like this order better.  Warnings should be first, howtos second and 
notes last.  Warnings should also be visible in 1024x768 mode as well.

James McKenzie



From winehacker at gmail.com  Thu Feb 21 20:48:50 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 21 Feb 2008 21:48:50 -0500
Subject: website: add links to most popular active Wine forums
In-Reply-To: <a71bd89a0802211528w74db5d5ci3d75a288dd402d02@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>
	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>
	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>
	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>
	<19e31a080802211511i2b0b2985l980385395219e0e4@mail.gmail.com>
	<a71bd89a0802211528w74db5d5ci3d75a288dd402d02@mail.gmail.com>
Message-ID: <19e31a080802211848u7cf73963jeeb031e3a604a43@mail.gmail.com>

On Thu, Feb 21, 2008 at 6:28 PM, Dan Kegel <dank at kegel.com> wrote:
> can explain what it is that makes google groups suck,
>  maybe I can do something about it.  Send those comments
>  to me offlist, though.

I can't think of a way to make it not suck so sending these thoughts
here as they relate still to the current discussion about the
wine-users gateway...

I think the problem is more inherit in newsgroup design. Like you can
view topics in but there is no way to have topics broken in to
categories. I guess this is historical as the traditional newsgroup
structure would have each group be its own catagory if there was
enough demand

example newsgroup structure would be

comp.emulators.ms-windows.wine
comp.emulators.ms-windows.wine.general
comp.emulators.ms-windows.wine.devel
comp.emulators.ms-windows.wine.solaris
comp.emulators.ms-windows.wine.ubuntu

etc

but we just have comp.emulators.ms-windows.wine because the demand
metric is not high enough to have separate groups for each category.
Plus it would make searching a bitch

This is where forums really shine over google groups or a traditional
mailing list to forum gateway. I am all for having mailman cross post
to a forum category but ideally the forum should be an alternative
front end with categories for wine-users and the wine newsgroup.

I don't think it would be any trouble to get Tom's site to have a
gateway that pulled wine-users and the newsgroup feeds in read-only.
If someone wants to post to those forums they would still have to use
traditional means ala mailing list, google groups, but it would
provide a unified location for read-only access. Of course if the
gateway is turned back on I guess wine-users and the newsgroups are
really a single source.

So to recap. Its all about categories for me.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From jeffzaroyko at gmail.com  Thu Feb 21 21:11:04 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Fri, 22 Feb 2008 14:11:04 +1100
Subject: appdb: Increase readability by using slightly softer colours on
	Warning and Notes
In-Reply-To: <47BE2BF6.7090506@sprintpcs.com>
References: <f5d9424f0802191812o14be580doc15deb623fc273b@mail.gmail.com>
	<alpine.DEB.1.00.0802210235480.13643@amboise.dolphin>
	<f3f1b91a0802201745p51ec130bid27dda37eda33d6b@mail.gmail.com>
	<f5d9424f0802201824v4183a3b1m69be50cdf3272c5d@mail.gmail.com>
	<f5d9424f0802201847h3a83f6e6qf84758b08b304b82@mail.gmail.com>
	<alpine.DEB.1.00.0802211142410.17617@amboise.dolphin>
	<47BE2BF6.7090506@sprintpcs.com>
Message-ID: <f5d9424f0802211911r6dd00d1bqfff0dfdf45ae7121@mail.gmail.com>

On Fri, Feb 22, 2008 at 12:57 PM, James McKenzie
<jjmckenzie51 at sprintpcs.com> wrote:
> Francois Gouget wrote:
>  > On Thu, 21 Feb 2008, Jeff Zaroyko wrote:
>  > [...]
>  >
>  >> I think this looks good, http://jeffz.name/tmp/suggestion3.png
>  >>
>  >> Do you still think we need to change the green Francois?
>  >>
>  >
>  > I prefer to have the text in the colored bar because that way it matches
>  > the title at the top (Known bugs in suggestion.png).
>  >
>  > So here's my proposal with a slightly lighter green and white text.
>  > http://fgouget.free.fr/tmp/newfg.png
>  >
>  > But I don't have a strong opinion on this, so do as you think is best.
>  >
>  >
>  I like this order better.  Warnings should be first, howtos second and
>  notes last.  Warnings should also be visible in 1024x768 mode as well.
>
>  James McKenzie
>
>

The order and presence is specified by the maintainer, I just so
happened to create them in this order when I was testing.

There's been no change to layout so this still looks fine in 1024x768 too.


From jjmckenzie51 at sprintpcs.com  Thu Feb 21 21:28:17 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Thu, 21 Feb 2008 20:28:17 -0700
Subject: appdb: Increase readability by using slightly softer colours
	on Warning and Notes
In-Reply-To: <f5d9424f0802211911r6dd00d1bqfff0dfdf45ae7121@mail.gmail.com>
References: <f5d9424f0802191812o14be580doc15deb623fc273b@mail.gmail.com>
	<alpine.DEB.1.00.0802210235480.13643@amboise.dolphin>
	<f3f1b91a0802201745p51ec130bid27dda37eda33d6b@mail.gmail.com>
	<f5d9424f0802201824v4183a3b1m69be50cdf3272c5d@mail.gmail.com>
	<f5d9424f0802201847h3a83f6e6qf84758b08b304b82@mail.gmail.com>
	<alpine.DEB.1.00.0802211142410.17617@amboise.dolphin>
	<47BE2BF6.7090506@sprintpcs.com>
	<f5d9424f0802211911r6dd00d1bqfff0dfdf45ae7121@mail.gmail.com>
Message-ID: <47BE4151.5050400@sprintpcs.com>

Jeff Zaroyko wrote:
> On Fri, Feb 22, 2008 at 12:57 PM, James McKenzie
> <jjmckenzie51 at sprintpcs.com> wrote:
>   
>> Francois Gouget wrote:
>>  > On Thu, 21 Feb 2008, Jeff Zaroyko wrote:
>>  > [...]
>>  >
>>  >> I think this looks good, http://jeffz.name/tmp/suggestion3.png
>>  >>
>>  >> Do you still think we need to change the green Francois?
>>  >>
>>  >
>>  > I prefer to have the text in the colored bar because that way it matches
>>  > the title at the top (Known bugs in suggestion.png).
>>  >
>>  > So here's my proposal with a slightly lighter green and white text.
>>  > http://fgouget.free.fr/tmp/newfg.png
>>  >
>>  > But I don't have a strong opinion on this, so do as you think is best.
>>  >
>>  >
>>  I like this order better.  Warnings should be first, howtos second and
>>  notes last.  Warnings should also be visible in 1024x768 mode as well.
>>
>>  James McKenzie
>>
>>
>>     
>
> The order and presence is specified by the maintainer, I just so
> happened to create them in this order when I was testing.
>   
+1. 
> There's been no change to layout so this still looks fine in 1024x768 too.
>
>   

+1.  It appears that this screen layout is now the default (when I 
learned to program HTML it was 680x400 or smaller, i.e. webTV.)

I look forward to implementation of the new colors.

James McKenzie


From dmitry at codeweavers.com  Thu Feb 21 21:55:44 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 22 Feb 2008 11:55:44 +0800
Subject: msvcrt: Implemented wcscpy_s
References: <fplg2u$fsk$1@ger.gmane.org>
Message-ID: <016401c87506$cf94d3f0$a600fea9@DMITRY>

"Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote:

> --- a/dlls/msvcrt/msvcrt.spec
> +++ b/dlls/msvcrt/msvcrt.spec
> @@ -761,6 +761,7 @@
> @ cdecl wcscmp(wstr wstr) ntdll.wcscmp
> @ cdecl wcscoll(wstr wstr) MSVCRT_wcscoll
> @ cdecl wcscpy(ptr wstr) ntdll.wcscpy
> +@ cdecl wcscpy_s(wstr long wstr) MSVCRT_wcscpy_s

Type of the first parameter should be ptr, not wstr.

-- 
Dmitry.


From dank at kegel.com  Thu Feb 21 22:59:46 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 21 Feb 2008 20:59:46 -0800
Subject: website: add links to most popular active Wine forums
In-Reply-To: <19e31a080802211848u7cf73963jeeb031e3a604a43@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>
	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>
	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>
	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>
	<19e31a080802211511i2b0b2985l980385395219e0e4@mail.gmail.com>
	<a71bd89a0802211528w74db5d5ci3d75a288dd402d02@mail.gmail.com>
	<19e31a080802211848u7cf73963jeeb031e3a604a43@mail.gmail.com>
Message-ID: <a71bd89a0802212059g6fa41d10h866570ba71ef4b9c@mail.gmail.com>

On Thu, Feb 21, 2008 at 6:48 PM, Steven Edwards <winehacker at gmail.com> wrote:
>  I think the problem is more inherit in newsgroup design. Like you can
>  view topics in but there is no way to have topics broken in to
>  categories. I guess this is historical as the traditional newsgroup
>  structure would have each group be its own catagory if there was
>  enough demand

Y'know, there isn't as much difference between
newsgroups and forums here as you think.
One thing that makes a forum look lonely
and forsaken is if it has tons of categories
with only a post or two in each.   Just like
a newsgroup that's been prematurely subdivided.
- Dan


From winehacker at gmail.com  Fri Feb 22 01:02:44 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 22 Feb 2008 02:02:44 -0500
Subject: Fun Project: Add dialogs to builtin IE
Message-ID: <19e31a080802212302t305c2609ic0e9ad11ea7f78a8@mail.gmail.com>

Hi,
I submitted a proof of concept patch for this a week or so back that
added a simple file->exit menu to the builtin Internet Explorer. I've
spoken with Jacek a bit about it and it seems shdocvw.dll is the
correct place to implement the UI layout if we are targeting IE
versions less the 7. There seems to be a plugin interface the GUI uses
for browser extensions but if a first pass I don't think we really
need to support it. Unfortuntly due to time constraints I am not going
to be able to work on this project so if there is anyone out there
that wants to contribute with a simple fun project, please feel free
to add menus, dialogs and the address bar. I'll try to help as best I
can but I expect to be tied up for some time to come.

Thanks
Steven

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From leslie_alistair at hotmail.com  Fri Feb 22 02:56:35 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Fri, 22 Feb 2008 19:56:35 +1100
Subject: New dll. Wbemprox.dll
In-Reply-To: <200802221035.29915.ivan@etersoft.ru>
References: <200802221035.29915.ivan@etersoft.ru>
Message-ID: <47BE8E43.50804@hotmail.com>

Ivan Sinitsin wrote:
> This patch add new library to the project wine. Name of the library 
> is - "wbemprox.dll".This library is a part of WMI technology. Now there four 
> interfaces are described - "IWbemLocator, IWbemServices, 
> IEnumWbemClassObject, IWbemClassObject". Almost all methods are stubs.
> This library is used with some programs like "1C", to get some information 
> about system.
> 
> static struct regsvr_interface const interface_list[] = {
>+    { &IID_IWbemLocator,
>+      "IWbemLocator",
>+      NULL,
>+      1,                /*????? ???????*/
Comment should be in English.

 >#define _WIN32_WINNT 0x0600
 >
 >#ifndef __wbemprox_PRIVATE_H__

Defining _WIN32_WINNT doesn't seem right.

This patches is large, try breaking it up.

Best Regards
  Alistair Leslie-Hughes


From cbill.lam at gmail.com  Fri Feb 22 03:48:41 2008
From: cbill.lam at gmail.com (bill lam)
Date: Fri, 22 Feb 2008 17:48:41 +0800
Subject: gdiplus: negative stride from dipCreateBitmapFromFile
Message-ID: <47BE9A79.6040905@gmail.com>

WHen I read a jpeg file of size about 600x400 pixels using gdiplus like this,

GdipCreateBitmapFromFile fn BMP
GdipGetImageWidth BMP w
GdipGetImageHeight BMP h
rt=. 0 0, w, h
GdipBitmapLockBits BMP rt ImageLockModeRead PixelFormat32bppARGB DATA
'w h s f p r'=. DATA

the member stride inside bitmapdata is negative, and its data buffer cannot be 
read successfully.

when using native gdiplus that stride is positive, and it work ok.

wine said itself cannot handle negitive stride yet so why itself create a bitmap 
wih negative stride in GdipCreateBitmapFromFile?




From mpartap at gmx.net  Fri Feb 22 05:00:02 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Fri, 22 Feb 2008 12:00:02 +0100
Subject: website: add links to most popular active Wine forums
In-Reply-To: <47BE171B.90303@winehq.org>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>
	<47BE122E.1000108@gmx.net> <47BE171B.90303@winehq.org>
Message-ID: <47BEAB32.4090801@gmx.net>

 > I did some looking into this myself.  Drupal looked interesting, but the solution
 > that seemed simplest and best to me was using a  phpbb and a mailman <--> phpbb gateway.
There are more advantages a drupal solution would have, namely a proper issue tracker / project 
management thing (have a look at http://drupal.org/project/issues). Also there's a CVS deploy 
module, so maybe in the long run it will be possible to integrate the main winehq.org site, the 
mailman lists and the bug tracker into one drupal thing (also, phpbb can be integrated.. but the 
Drupal forum is way leaner and of course can be styled with CSS to be inline with the winehq.org 
corporate design)
However migrating in a single step is probably not very clever, so let's just bring up here if we 
manage to produce something that works.. I'll report back, too, once I've migrated those modules to 
drupal 6 and got it to work properly.
regards,
marcel.

-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>



From stefandoesinger at gmx.at  Fri Feb 22 02:19:23 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 22 Feb 2008 09:19:23 +0100
Subject: Wine and PulseAudio
In-Reply-To: <47BE1C41.7040506@dbservice.com>
References: <47BE1C41.7040506@dbservice.com>
Message-ID: <200802220919.27013.stefandoesinger@gmx.at>

Am Freitag, 22. Februar 2008 01:50:09 schrieb Tomas Carnecky:
> I switched my desktop to PA yesterday, got most apps working, and to my
> surprise even flash (netscape 32bit plugin in a 64bit browser). All apps
> that I need use PA natively, only Wine doesn't have a PA sound driver.
The point was and is that we don't want yet another half working sound backend 
in Wine. We will have to maintain the Alsa one because there are things PA 
won't be able to give us by design, like HW mixing and lowest-latency direct 
access which is needed for gaming.

Of course, as you said, if someone has patches and intends to maintain it 
we're happy to accept it. But I think none of the current Wine sound 
developers(aka Maarten) has any intentions to spend time on a PA backend.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080222/88bde67c/attachment.pgp 

From julliard at winehq.org  Fri Feb 22 05:09:06 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 22 Feb 2008 12:09:06 +0100
Subject: [2/3] qmgr: Implement IUnkown interface for IBackgroundCopyJob.
In-Reply-To: <20080221234815.GB19437@linux.ucla.edu> (Dan Hipschman's message
	of "Thu, 21 Feb 2008 15:48:15 -0800")
References: <20080221234815.GB19437@linux.ucla.edu>
Message-ID: <87abltl031.fsf@wine.dyndns.org>

Dan Hipschman <dsh at linux.ucla.edu> writes:

> +static ULONG WINAPI BITS_IBackgroundCopyJob_AddRef(IBackgroundCopyJob* iface)
> +{
> +    ICOM_THIS_MULTI(BackgroundCopyJobImpl, lpVtbl, iface);
> +    return InterlockedIncrement(&This->ref);
> +}

There's no reason to use something like ICOM_THIS_MULTI with a single
interface. And if you really do have multiple interfaces, please use an
inline function instead.

-- 
Alexandre Julliard
julliard at winehq.org


From crumb at google.com  Thu Feb 21 12:18:16 2008
From: crumb at google.com (Maarten Lankhorst)
Date: Thu, 21 Feb 2008 10:18:16 -0800
Subject: wineprefixcreate failing?
Message-ID: <d6e10bb10802211018t5e7db29asb1f01479f7dceef2@mail.gmail.com>

Hi all,

Is it just me or is wineprefixcreate crashing horribly for others as well?

Cheers,
Maarten.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080221/bfa4cdcd/attachment.htm 

From avd at etersoft.ru  Fri Feb 22 05:08:06 2008
From: avd at etersoft.ru (Alexander Demakin)
Date: Fri, 22 Feb 2008 14:08:06 +0300
Subject: Printing images
Message-ID: <200802221408.09792.avd@office.etersoft.ru>

Hi all,
	
I have some troubles with printing. BitBlt returns error when calling it for 
printer context due to implementation of PSDRV_SelectBitmap(). Does anybody 
know how to implement this function? Where can i find any documentation about 
it?  Implementation of SelectBitmap() in EMFDRV and MFDRV just returns 0. Is 
it correct? Please, share your ideas.

Thanks in advance,
Demakin Alexander.


From jnewman at codeweavers.com  Fri Feb 22 07:34:07 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Fri, 22 Feb 2008 07:34:07 -0600
Subject: website: add links to most popular active Wine forums
In-Reply-To: <a71bd89a0802211528w74db5d5ci3d75a288dd402d02@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>	<19e31a080802211511i2b0b2985l980385395219e0e4@mail.gmail.com>
	<a71bd89a0802211528w74db5d5ci3d75a288dd402d02@mail.gmail.com>
Message-ID: <47BECF4F.2010701@codeweavers.com>

Dan Kegel wrote:
> I like the idea of a bidirectional forum gateway to wine-users. I
> haven't seen one I actually like yet, but I trust one exists.

http://forum.winehq.org/


From hans at it.vu.nl  Fri Feb 22 07:40:15 2008
From: hans at it.vu.nl (Hans Leidekker)
Date: Fri, 22 Feb 2008 14:40:15 +0100
Subject: website: add links to most popular active Wine forums
In-Reply-To: <47BECF4F.2010701@codeweavers.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
	<a71bd89a0802211528w74db5d5ci3d75a288dd402d02@mail.gmail.com>
	<47BECF4F.2010701@codeweavers.com>
Message-ID: <200802221440.15541.hans@it.vu.nl>

On Friday 22 February 2008 02:34:07 pm Jeremy Newman wrote:

> http://forum.winehq.org/

$ host forum.winehq.org
Host forum.winehq.org not found: 3(NXDOMAIN)


From vostok at etersoft.ru  Fri Feb 22 08:10:50 2008
From: vostok at etersoft.ru (Anatoly Lyutin)
Date: Fri, 22 Feb 2008 17:10:50 +0300
Subject: [1/2] user32:scroll: Added some tests for scrollbar [try2]
In-Reply-To: <87lk5ftgtz.fsf@wine.dyndns.org>
References: <47BC36EC.8010606@etersoft.ru> <87lk5ftgtz.fsf@wine.dyndns.org>
Message-ID: <47BED7EA.9080106@etersoft.ru>

Alexandre Julliard wrote:
> Yes.
>
>   
I have posted a new version of patches.

-- 
Best regards
	Anatoly Lyutin.



From jnewman at codeweavers.com  Fri Feb 22 09:31:12 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Fri, 22 Feb 2008 09:31:12 -0600
Subject: website: add links to most popular active Wine forums
In-Reply-To: <200802221440.15541.hans@it.vu.nl>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>	<a71bd89a0802211528w74db5d5ci3d75a288dd402d02@mail.gmail.com>	<47BECF4F.2010701@codeweavers.com>
	<200802221440.15541.hans@it.vu.nl>
Message-ID: <47BEEAC0.6090907@codeweavers.com>

Fixed. Apparently, our slave DNS server was not syncing to the master.

Hans Leidekker wrote:
> On Friday 22 February 2008 02:34:07 pm Jeremy Newman wrote:
> 
>> http://forum.winehq.org/
> 
> $ host forum.winehq.org
> Host forum.winehq.org not found: 3(NXDOMAIN)
> 
> 


From mpartap at gmx.net  Fri Feb 22 09:38:51 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Fri, 22 Feb 2008 16:38:51 +0100
Subject: website: add links to most popular active Wine forums
In-Reply-To: <47BECF4F.2010701@codeweavers.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>	<19e31a080802211511i2b0b2985l980385395219e0e4@mail.gmail.com>	<a71bd89a0802211528w74db5d5ci3d75a288dd402d02@mail.gmail.com>
	<47BECF4F.2010701@codeweavers.com>
Message-ID: <47BEEC8B.5050806@gmx.net>

>> I haven't seen one I actually like yet, but I trust one exists.
> http://forum.winehq.org/
Very nice work Jeremy. Cool :)
(Now I still will have to get something like this to work on my drupal site, but at least no user 
shall suffer under my disreliability nor lack of a hybrid forum list anymore.)
regards,
  marcel.


-- 
<div id="signature">
   "Obstacles are those frightful things you see when you take your eyes off your goal."
                                                               -- Henry Ford (1863-1947)
   Change the world! Vote revolution: http://hfopi.org/vote-future
</div>


From dank at kegel.com  Fri Feb 22 11:39:39 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 22 Feb 2008 09:39:39 -0800
Subject: Bugs fixed in 0.9.56
Message-ID: <a71bd89a0802220939l60e8d89ak4bfae23eefa242c5@mail.gmail.com>

Here are the bugs marked fixed during the 0.9.56 cycle.
(A few of them were fixed earlier, but not marked as such before.)

1737    Metafiles embedded in Rich Text don't render
3768 	Blood 2 The Chosen - keyboard and mouse do not work
5114 	suggesting more descriptive desktop window titles
5503 	Opening help in Office97 triggers unhandled page fault
6383 	Dual-core not being correctly supported
6914 	C&C Red Alert pauses on shaking game view
7544 	ReplaceFileW not implemented
7660 	Mouse Movement not recognized at slower speeds in World of Warcraft
8236 	Dungeon Siege 2 has some animation issues
8687 	Online Poker program: unimplemented classes in shdocvw
8722 	Unhandled Exception in InstallShield Wizard for 'Star Wars: The
Best of PC' Games
9741 	URLDownloadToFile only supports HTTP URL's
9917 	Add X11 child window for client area
10010 	Call of Duty 4 Demo: Fails to start: "Video card or driver
doesn't support separate alpha blend."
10083 	Inverted colours in C&C RA demo exit screen
10736 	iTunes 7.5 hangs
10787 	Can't install 3ds max 9
10808 	Saitek P990 crashes MVP Baseball 2005
10973 	Regression: Commandos 3 - menu not properly rendered
11008 	Problem through the registration of an assembly
11009 	Battlefield 1942: no longer starts after patching to Version 1.6
11037 	Painkiller game crashes on startup
11136 	Trados: TagEditor loosing contact with Workbench.
11187 	Scanf bug
11204 	mail inspector doubles messages in 0.9.53
11257 	Can't install Slingplayer
11340 	Warcraft 3 displays the start splashscreen forever and doesn't
continue with the game start.
11348 	EVE Online: character portrait parts are rendered with glitches
11362 	ChemDraw9 messed up struture fonts
11398 	Some PhotoShop controls are not working properly.
11426 	Cryptographic exception in .NET Framework application
11480 	msi2xml fails to convert an msi file to xml
11488 	corefont installers hanging
11514 	Adobe Acrobat Professional 6 fails to install
11545 	call of duty 4 stopped working around the time of 0.9.54(not
fixed with 55)
11550 	Speed Commander 12 hangs on install while copying files
11553 	Paintbrush movement becomes erratic with large brush in photoshop
11573 	GTA San Andreas: Mouse skips with recent change to Wine
11645 	OSDRT Client fails with "Protocol error: process 0015: sendmsg:
Bad file descriptor" (wineserver crash)
11646 	resident evil 4 crash just after wine start

- Dan


From truiken at gmail.com  Fri Feb 22 11:47:26 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 22 Feb 2008 11:47:26 -0600
Subject: msi: MsiMergeDatabaseA/W stub
In-Reply-To: <47BDDE5E.9020002@async.com.br>
References: <47BDDE5E.9020002@async.com.br>
Message-ID: <22821af30802220947t4c8c94e1v640851ac24515110@mail.gmail.com>

On Thu, Feb 21, 2008 at 2:26 PM, Johan Dahlin <jdahlin at async.com.br> wrote:
> Add stubs for MsiMergeDatabaseA/W, used by WiX's msi validation.
>
> diff --git a/dlls/msi/database.c b/dlls/msi/database.c
>  index 425486e..e74db8f 100644
>  --- a/dlls/msi/database.c
>  +++ b/dlls/msi/database.c
>  @@ -1119,3 +1119,22 @@ HRESULT create_msi_remote_database( IUnknown *pOuter, LPVOID *ppObj )
>
>      return S_OK;
>   }
>  +
>  +UINT WINAPI MsiDatabaseMergeW( MSIHANDLE hDatabase,
>  +                              MSIHANDLE hDatabaseMerge,
>  +                              LPCWSTR szTableName )
>  +{
>  +  FIXME("(%ld %ld %s): stub!\n", hDatabase, hDatabaseMerge,
>  +       debugstr_w(szTableName));
>  +  return ERROR_SUCCESS;
>  +}
>  +
>  +UINT WINAPI MsiDatabaseMergeA( MSIHANDLE hDatabase,
>  +                              MSIHANDLE hDatabaseMerge,
>  +                              LPCSTR szTableName )
>  +{
>  +  FIXME("(%ld %ld %s): stub!\n", hDatabase, hDatabaseMerge,
>  +       szTableName);
>  +
>  +  return ERROR_SUCCESS;
>  +}
>

Please use the same style as the rest of the file (4 space
indentation).  The A version should be before the W version.

-- 
James Hawkins


From truiken at gmail.com  Fri Feb 22 12:57:38 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 22 Feb 2008 12:57:38 -0600
Subject: msi: MsiMergeDatabaseA/W stub
In-Reply-To: <47BF1549.5090102@async.com.br>
References: <47BDDE5E.9020002@async.com.br>
	<22821af30802220947t4c8c94e1v640851ac24515110@mail.gmail.com>
	<47BF1549.5090102@async.com.br>
Message-ID: <22821af30802221057i6805051ib61e27a28ce290a5@mail.gmail.com>

On Fri, Feb 22, 2008 at 12:32 PM, Johan Dahlin <jdahlin at async.com.br> wrote:
> James Hawkins wrote:
>  > On Thu, Feb 21, 2008 at 2:26 PM, Johan Dahlin <jdahlin at async.com.br> wrote:
>  [..]
>
> > Please use the same style as the rest of the file (4 space
>  > indentation).  The A version should be before the W version.
>
>  It appears that the coding style is different from different dlls, is there
>  a general agreement how to configure emacs (or any other editors) properly
>  so it picks up the right coding style for each sub-part of wine?
>

There are minor variations everywhere, but most of the code uses 4
space indentations.

-- 
James Hawkins


From luis.busquets at ilidium.com  Fri Feb 22 13:24:10 2008
From: luis.busquets at ilidium.com (=?ISO-8859-1?Q?=22Luis_C=2E_Busquets_P=E9rez=22?=)
Date: Fri, 22 Feb 2008 20:24:10 +0100
Subject: d3dx9_xx
Message-ID: <47BF215A.8090401@ilidium.com>

The number of functions reported in
http://www.winehq.org/site/winapi_stats
for the following dlls is

d3dx9_24 	308
d3dx9_25 	311
d3dx9_26 	315
d3dx9_27 	315
d3dx9_28 	320
d3dx9_29 	320
d3dx9_30 	320
d3dx9_31 	317
d3dx9_32 	322
d3dx9_33 	322
d3dx9_34 	322
d3dx9_35 	322
d3dx9_36 	325


Nevertheless, the correct number is

d3dx9_24 	320
d3dx9_25 	323
d3dx9_26 	327
d3dx9_27 	327
d3dx9_28 	332
d3dx9_29 	332
d3dx9_30 	332
d3dx9_31 	329
d3dx9_32 	334
d3dx9_33 	334
d3dx9_34 	334
d3dx9_35 	334
d3dx9_36 	336



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080222/8d45eab5/attachment.htm 

From austinenglish at gmail.com  Fri Feb 22 14:02:24 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 22 Feb 2008 14:02:24 -0600
Subject: wineprefixcreate failing?
In-Reply-To: <d6e10bb10802211018t5e7db29asb1f01479f7dceef2@mail.gmail.com>
References: <d6e10bb10802211018t5e7db29asb1f01479f7dceef2@mail.gmail.com>
Message-ID: <b6bb06270802221202u4520f92ap4ea65c271d0642ea@mail.gmail.com>

On Thu, Feb 21, 2008 at 12:18 PM, Maarten Lankhorst <crumb at google.com> wrote:
> Hi all,
>
> Is it just me or is wineprefixcreate crashing horribly for others as well?
>
> Cheers,
> Maarten.
>
>
>
>

Are you running ubuntu by chance? Seems to be a bug in Hardy/Gutsy
that may be related to gcc. See:
https://bugs.edge.launchpad.net/ubuntu/+source/wine/+bug/191575

-Austin


From stefan at codeweavers.com  Fri Feb 22 15:10:41 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 22 Feb 2008 22:10:41 +0100
Subject: 1/2 WGL: remove the pixel format limitation (!)
In-Reply-To: <20080222201623.291930@gmx.net>
References: <20080222201623.291930@gmx.net>
Message-ID: <200802222210.44205.stefan@codeweavers.com>

Am Freitag, 22. Februar 2008 21:16:23 schrieb Roderick Colenbrander:
> WineD3D has some small issues due to this change but those should be
> investigated by Stefan, Chris, me and others. The code should get a lot of
> testing as soon as possible.
We discussed this on IRC. The problem is that we're still defaulting to back 
buffer / aux buffer offscreen rendering, and thus offscreen targets are bound 
to use the same format as the back buffer. In the D3D9 test this means that 
the backbuffer is X8R8G8B8, and the onscreen target is A8R8G8B8. The alpha is 
missing with this patch(used to be always there), so the test fails.

The proper fix is to switch to FBOs for onscreen rendering whereever 
possible(FBO support still has problems that prevent that though), and on 
cards without FBOs try to use A8R8G8B8 instead of X8R8G8B8 for the 
backbuffer, and similarly for X1R5G5B5 and X4R4G4B4.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080222/14e0f616/attachment.pgp 

From kgbricola at web.de  Fri Feb 22 15:45:23 2008
From: kgbricola at web.de (=?ISO-8859-1?Q?Rico_Sch=FCller?=)
Date: Fri, 22 Feb 2008 22:45:23 +0100
Subject: wined3d: ActivateContext: try to fix wrong parameter?
In-Reply-To: <200802212357.51891.stefandoesinger@gmx.at>
References: <47BDC355.1080302@web.de> <20080221191224.59570@gmx.net>
	<200802212357.51891.stefandoesinger@gmx.at>
Message-ID: <47BF4273.7040003@web.de>

Stefan D?singer wrote:
> What happens if e.g. the current render target is an offscreen target and the 
> application tries to read back the front or back buffer? In this case you'll 
> read the offscreen target back.
> 
> So I am not sure this patch is correct

I have no idea I just tried a bit around and got cod4 
(http://bugs.winehq.org/show_bug.cgi?id=11584) working again with this 
patch.

I didn't step deep into this problem. So if I could help with some logs 
or other things, please let me know. Properly, the real bug is somewhere 
else?

Cheers
Rico


From xerox_xerox2000 at yahoo.co.uk  Fri Feb 22 15:56:30 2008
From: xerox_xerox2000 at yahoo.co.uk (Louis Lenders)
Date: Fri, 22 Feb 2008 21:56:30 +0000 (UTC)
Subject: Next big app(s) to try?
References: <a71bd89a0802170115o7a7a7585o8462762cbda414ad@mail.gmail.com>
	<200802171202.41075.research@science.su>
Message-ID: <loom.20080222T214854-729@post.gmane.org>


> 	By the way, AutoCAD and 3ds max are very popular applications. It's easy to
check how they are popular by using Google. For example, for AutoCAD alone 
> you will get 43,800,000 results [1]. So there is a really a lot of people who 
> depends on Autodesk products such as AutoCAD.
> 
So I think it's about time to get .Net 2.0 support into wine. Actually all the
info is there in bugzilla to get a lot of .net applications running . I know
.net support is not a target of wine-1.0.0, but why not reconsider? I got 3dmax
9 somehow running, but it seems to suffer from opengl bug; AutoCad 2008 only
made it into the main screeen,then threw up a messagebox about a fatal error. So
if someone could pick this up , and fix the remaining .net issues, i think wine
could get another boost...........



From stefan at codeweavers.com  Fri Feb 22 16:20:51 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 22 Feb 2008 23:20:51 +0100
Subject: wined3d: ActivateContext: try to fix wrong parameter?
In-Reply-To: <47BF4273.7040003@web.de>
References: <47BDC355.1080302@web.de>
	<200802212357.51891.stefandoesinger@gmx.at>
	<47BF4273.7040003@web.de>
Message-ID: <200802222320.51896.stefan@codeweavers.com>

Am Freitag, 22. Februar 2008 22:45:23 schrieb Rico Sch?ller:
> I didn't step deep into this problem. So if I could help with some logs
> or other things, please let me know. Properly, the real bug is somewhere
> else?
Did you intend to attach a file to the mail, or did you refer to the last 
attachment to the bug?


From stefan at codeweavers.com  Fri Feb 22 16:26:50 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 22 Feb 2008 23:26:50 +0100
Subject: 1/2 WGL: remove the pixel format limitation (!)
In-Reply-To: <200802222210.44205.stefan@codeweavers.com>
References: <20080222201623.291930@gmx.net>
	<200802222210.44205.stefan@codeweavers.com>
Message-ID: <200802222326.52852.stefan@codeweavers.com>

Am Freitag, 22. Februar 2008 22:10:41 schrieb Stefan D?singer:

> The proper fix is to switch to FBOs for onscreen rendering
I meant *off*screen rendering, sorry for the confusion
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080222/b752a888/attachment.pgp 

From stefan at codeweavers.com  Fri Feb 22 16:34:23 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 22 Feb 2008 23:34:23 +0100
Subject: WineD3D: request alpha in backbuffer mode,
	to work correctly with multiple opengl pixel formats
In-Reply-To: <20080222223143.62950@gmx.net>
References: <20080222223143.62950@gmx.net>
Message-ID: <200802222334.25437.stefan@codeweavers.com>

Am Freitag, 22. Februar 2008 23:31:43 schrieb Roderick Colenbrander:
> Hi,
>
> In the default backbuffer based renderer in WineD3D the front and
> backbuffer share the same pixel format while D3D itself decouples them. A
> lot of applications use alpha on the backbuffer, so make sure we have
> alpha. This change is needed because the single pixel format which we had
> before always had alpha.

> +        /* In case of ORM_BACKBUFFER, make sure to request an alpha 
component for X4R4G4B4/X8R8G8B8 as we might need it for the backbuffer. */
It would be for offscreen buffers, not the back buffer. I'm sorry for the 
confusion in the earlier mail
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080222/bfbf19e6/attachment.pgp 

From austinenglish at gmail.com  Fri Feb 22 16:35:57 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 22 Feb 2008 16:35:57 -0600
Subject: wineprefixcreate failing?
In-Reply-To: <b6bb06270802221202u4520f92ap4ea65c271d0642ea@mail.gmail.com>
References: <d6e10bb10802211018t5e7db29asb1f01479f7dceef2@mail.gmail.com>
	<b6bb06270802221202u4520f92ap4ea65c271d0642ea@mail.gmail.com>
Message-ID: <b6bb06270802221435r47ed727buf9974487850ee5d1@mail.gmail.com>

On Fri, Feb 22, 2008 at 2:02 PM, Austin English <austinenglish at gmail.com> wrote:
>
> On Thu, Feb 21, 2008 at 12:18 PM, Maarten Lankhorst <crumb at google.com> wrote:
>  > Hi all,
>  >
>  > Is it just me or is wineprefixcreate crashing horribly for others as well?
>  >
>  > Cheers,
>  > Maarten.
>  >
>  >
>  >
>  >
>
>  Are you running ubuntu by chance? Seems to be a bug in Hardy/Gutsy
>  that may be related to gcc. See:
>  https://bugs.edge.launchpad.net/ubuntu/+source/wine/+bug/191575
>
>  -Austin
>

I ran a regression test, and got all the way back to wine-0.9.56
without a failure. I was about to book an appointment with a
psychiatrist or a bartender, then found that the failure only occurs
when calling wine from a different directory. I.e.:

austin at austin-desktop:~/wine-git$ rm -rf ~/.wine && ~/wine-git/wine
notepad # this works fine
austin at austin-desktop:~$ rm -rf ~/.wine && ~/wine-git/wine notepad # fails

So I'm rerunning the tests now. However, thought I'd let everyone know
just in case they need a workaround until the problem can be fixed...

-Austin


From dank at kegel.com  Fri Feb 22 17:33:21 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 22 Feb 2008 15:33:21 -0800
Subject: New winetricks 20080222: new verb 'colorprofile' by Hans
Message-ID: <a71bd89a0802221533u32168deep7fac1106a106bc4e@mail.gmail.com>

Hans Leidekker is working on http://bugs.winehq.org/show_bug.cgi?id=11532
(Photoshop doesn't support custom monitor profiles),
and contributed a new verb for winetricks, 'colorprofile'.

As usual, you can pick it up at
  http://kegel.com/wine/winetricks


From lists at stephengentle.com  Fri Feb 22 17:58:18 2008
From: lists at stephengentle.com (Stephen Gentle)
Date: Sat, 23 Feb 2008 09:58:18 +1000
Subject: website: add links to most popular active Wine forums
In-Reply-To: <47BECF4F.2010701@codeweavers.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>	<19e31a080802211511i2b0b2985l980385395219e0e4@mail.gmail.com>	<a71bd89a0802211528w74db5d5ci3d75a288dd402d02@mail.gmail.com>
	<47BECF4F.2010701@codeweavers.com>
Message-ID: <47BF619A.5060804@stephengentle.com>

>  http://forum.winehq.org/
I just signed up. Need moderators?



From jan.wine at zerebecki.de  Fri Feb 22 18:02:56 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sat, 23 Feb 2008 01:02:56 +0100
Subject: Wine and PulseAudio
In-Reply-To: <47BE1C41.7040506@dbservice.com>
References: <47BE1C41.7040506@dbservice.com>
Message-ID: <20080223000256.GE3557@crissy.swd.zerebecki.de>

On Fri, Feb 22, 2008 at 01:50:09AM +0100, Tomas Carnecky wrote:
> nifty features, like per-app volume, transparent sink switching
> etc, some of which are impossible to emulate through the alsa
> pulse plugin.

Which features can't be used through the alsa->pulse plugin? And
is there any technical reason for that or just missing
functionality in that plugin?



Jan



From jdahlin at async.com.br  Fri Feb 22 12:32:41 2008
From: jdahlin at async.com.br (Johan Dahlin)
Date: Fri, 22 Feb 2008 15:32:41 -0300
Subject: msi: MsiMergeDatabaseA/W stub
In-Reply-To: <22821af30802220947t4c8c94e1v640851ac24515110@mail.gmail.com>
References: <47BDDE5E.9020002@async.com.br>
	<22821af30802220947t4c8c94e1v640851ac24515110@mail.gmail.com>
Message-ID: <47BF1549.5090102@async.com.br>

James Hawkins wrote:
> On Thu, Feb 21, 2008 at 2:26 PM, Johan Dahlin <jdahlin at async.com.br> wrote:
[..]
> Please use the same style as the rest of the file (4 space
> indentation).  The A version should be before the W version.

It appears that the coding style is different from different dlls, is there 
a general agreement how to configure emacs (or any other editors) properly
so it picks up the right coding style for each sub-part of wine?

Johan



From v_scherbina at mvps.org  Fri Feb 22 13:50:00 2008
From: v_scherbina at mvps.org (Volodymyr Shcherbyna)
Date: Fri, 22 Feb 2008 20:50:00 +0100
Subject: [Wine] Windows Kernel & Executive implementation
In-Reply-To: <a71bd89a0802220844t1966408bse2430d0e1f6f106e@mail.gmail.com>
References: <7410225b0802220302j306d6a5fx4d8f8c94049b9f3b@mail.gmail.com>
	<a71bd89a0802220844t1966408bse2430d0e1f6f106e@mail.gmail.com>
Message-ID: <7410225b0802221150m2d480de2of793658542d737e7@mail.gmail.com>

Unfortunately, that code just do stubs, and it is not actually executed in
kernel mode.

-- 
with best regards,
Volodymyr

2008/2/22, Dan Kegel <dank at kegel.com>:
>
> On Fri, Feb 22, 2008 at 3:02 AM, Volodymyr Shcherbyna
> <v_scherbina at mvps.org> wrote:
>
> >  I discovered that WineHQ project does not have support for drivers (am
> I
> >  wrong?). In other words, quite a big amount of applications will fail
> to
> >  function properly, because many of them are using helper device drivers
> to
> >  get some extended functionality. I can just mention RegMon, FileMon,
> TDIMom,
> >  and others.
>
>
> I know very little about this, but my impression is that
> Wine supports a limited set of NT os kernel APIs already.
> The initial support was added by this patch:
> http://www.winehq.org/pipermail/wine-cvs/2007-May/032546.html
> The current set of supported calls can be seen here:
> http://source.winehq.org/source/dlls/ntoskrnl.exe/ntoskrnl.c
>
> Feel free to implement more, or file enhancement requests
> describing what nt os apis a popular app needs.
>
> - Dan
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080222/9fdca897/attachment.htm 

From volodymyr.shcherbyna at gmail.com  Fri Feb 22 18:00:28 2008
From: volodymyr.shcherbyna at gmail.com (Volodymyr Shcherbyna)
Date: Sat, 23 Feb 2008 01:00:28 +0100
Subject: [Wine] Re: Windows Kernel & Executive implementation
In-Reply-To: <1203723123.m2f.27@forum.winehq.org>
References: <1203723123.m2f.27@forum.winehq.org>
Message-ID: <7410225b0802221600x672294bbp102287970329bb7b@mail.gmail.com>

I am not sure that ReacOS is a good example. Quite a big amount of code in
ReactOS contains leaked code of Windows (from Windows 2k). Recently I did a
research, since I have access to Windows code(code premium subscription), I
am able to compare things.

2008/2/23, Fireball <wineforum-user at winehq.org>:
>
> You could have a look at ReactOS about this (www.reactos.org). But anyway,
> Wine's way of supporting this will [most probably] be different from
> reactos' way.
>
>
>
>
>
>


-- 
with best regards,
Volodymyr
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080223/3df9949f/attachment.htm 

From v_scherbina at mvps.org  Fri Feb 22 18:25:21 2008
From: v_scherbina at mvps.org (Volodymyr Shcherbyna)
Date: Sat, 23 Feb 2008 01:25:21 +0100
Subject: [Wine] Windows Kernel & Executive implementation
In-Reply-To: <a71bd89a0802221600k71d1a902xa5a83ca39733d21@mail.gmail.com>
References: <7410225b0802220302j306d6a5fx4d8f8c94049b9f3b@mail.gmail.com>
	<a71bd89a0802220844t1966408bse2430d0e1f6f106e@mail.gmail.com>
	<7410225b0802221150m2d480de2of793658542d737e7@mail.gmail.com>
	<a71bd89a0802221600k71d1a902xa5a83ca39733d21@mail.gmail.com>
Message-ID: <7410225b0802221625t6a60e157g58c0ebc1c9b39625@mail.gmail.com>

RegMon was just one of the examples. But basically, RegMon uses vxd driver
for Windows 9x. For XP it uses NT driver which hooks SDT. On Server 2003 it
uses legacy registry notification API.

UMDF support started from XP. It does not cover 2k. Also, UMDF is just a
part of WDF. However, I think it will be good to implement basic things,
like NT drivers support.

2008/2/23, Dan Kegel <dank06 at kegel.com>:
>
> Volodymyr Shcherbyna <v_scherbina at mvps.org> wrote:
>
> >>>[many apps use helper device drivers, e.g. RegMon, FileMon, TDIMom]
>
> > > http://source.winehq.org/source/dlls/ntoskrnl.exe/ntoskrnl.c
>
> > Unfortunately, that code just do stubs, and it is not actually executed
> in
> > kernel mode.
>
>
> The current ntoskrnl.c is enough to run a few apps.
> It's not intended to run arbitrary NT drivers.
>
> Now, RegMon uses a VxD, and I don't think we're ever planning on
> really supporting those.   Wine does ship with nine 'fake' VxD's;
> these were added because they were needed by popular apps.
> So if you have a particular VxD that's important enough,
> we can reimplement it as part of Wine.
>
> I just noticed Microsoft's UMDF (User Mode Driver Framework).
> I bet we could support UMDF drivers pretty well if we wanted to.
> Have you ever played with that?
>
> - Dan
>



-- 
with best regards,
Volodymyr
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080223/5fa4c5d9/attachment.htm 

From volodymyr.shcherbyna at gmail.com  Fri Feb 22 18:33:24 2008
From: volodymyr.shcherbyna at gmail.com (Volodymyr Shcherbyna)
Date: Sat, 23 Feb 2008 01:33:24 +0100
Subject: [Wine] Windows Kernel & Executive implementation
In-Reply-To: <200802230209.14431.alan.mckinnon@gmail.com>
References: <7410225b0802220302j306d6a5fx4d8f8c94049b9f3b@mail.gmail.com>
	<e9084d080802220712j71186169tf92f4d5276ec9a1a@mail.gmail.com>
	<7410225b0802220741o6e494c37uec0b9a37dff62415@mail.gmail.com>
	<200802230209.14431.alan.mckinnon@gmail.com>
Message-ID: <7410225b0802221633yd24c103m94af5a6946741573@mail.gmail.com>

Read comments inline,

2008/2/23, Alan McKinnon <alan.mckinnon at gmail.com>:
>
> On Friday 22 February 2008, Volodymyr Shcherbyna wrote:
> > Hello Tres,
> >
> > Yes, agree, there might be Linux equivalents to accomplish the same
> > tasks. But let me pickup the description of winehq from official
> > web-site : "[...] a compatibility layer for running Windows programs
> > [...]". Doesn't that mean, that *all* software should work?
>
>
> NO.
>
> It means that applications that users can reasonably expect to run
> should be able to run. Note that it is applications that Wine targets.


The description is quite non-precise. Who defines the policy of what should
be run and what shouldn't? What I am trying to explain, is that, once
something is designed to be compatible with Windows API, it should be
compatible with at any case at any layers.

For example, there is no sane reason in the world that VC++ should
> always work under Wine, considering the deep knowledge of Windows that
> is built into VC++. If you are developing a Windows app, then you
> should compile it on ... Windows. And Wine runs atop a *nix system, so
> it has no need to implement any NTFS-specific code as it does not need
> to use NTFS as a storage layer. Should you need to manipulate NTFS for
> some reason, we have ntfs-ng for that job.


I don't care about file systems. What I would like to see in wine, is a
little more abstractionist things, for example, file system filters support.
NDIS IM filters, TDI providers, WFP, Kernel sockets and other things.

There has to be a point where Wine stops and the correct answer to
> anything more is "You should use Windows for that". I believe that line
> lies just beyond user-space apps.


Any other ideas on this issue?

--
> Alan McKinnon
> alan dot mckinnon at gmail dot com
>
>
>

-- 
with best regards,
Volodymyr
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080223/2e4055bc/attachment.htm 

From austinenglish at gmail.com  Fri Feb 22 19:37:21 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 22 Feb 2008 19:37:21 -0600
Subject: website: add links to most popular active Wine forums
In-Reply-To: <47BF619A.5060804@stephengentle.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>
	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>
	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>
	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>
	<19e31a080802211511i2b0b2985l980385395219e0e4@mail.gmail.com>
	<a71bd89a0802211528w74db5d5ci3d75a288dd402d02@mail.gmail.com>
	<47BECF4F.2010701@codeweavers.com>
	<47BF619A.5060804@stephengentle.com>
Message-ID: <b6bb06270802221737g42b77e83w701bdcb1b77ba341@mail.gmail.com>

On Fri, Feb 22, 2008 at 5:58 PM, Stephen Gentle <lists at stephengentle.com> wrote:
> >  http://forum.winehq.org/
>  I just signed up. Need moderators?
>
>
>
>

I can moderate if needed. Username - austin987

-Austin


From winehacker at gmail.com  Fri Feb 22 20:00:56 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 22 Feb 2008 21:00:56 -0500
Subject: [Wine] Re: Windows Kernel & Executive implementation
In-Reply-To: <7410225b0802221600x672294bbp102287970329bb7b@mail.gmail.com>
References: <1203723123.m2f.27@forum.winehq.org>
	<7410225b0802221600x672294bbp102287970329bb7b@mail.gmail.com>
Message-ID: <19e31a080802221800v284566b7s5ef401d82bf2204d@mail.gmail.com>

On Fri, Feb 22, 2008 at 7:00 PM, Volodymyr Shcherbyna
<volodymyr.shcherbyna at gmail.com> wrote:
> I am not sure that ReacOS is a good example. Quite a big amount of code in
> ReactOS contains leaked code of Windows (from Windows 2k). Recently I did a
> research, since I have access to Windows code(code premium subscription), I
> am able to compare things.

I was the project cordinator for ReactOS for a while and still have a
pretty good relationship with a lot of the active developers. Can you
provide me a list of all code (just a list of offending functions
would be fine) that is in ReactOS that you know to be from leaked
windows sources and I will work with them to remove all offending
code.

Thanks
Steven

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From research at science.su  Fri Feb 22 20:15:23 2008
From: research at science.su (L. Rahyen)
Date: Sat, 23 Feb 2008 02:15:23 +0000
Subject: website: add links to most popular active Wine forums
In-Reply-To: <b6bb06270802221737g42b77e83w701bdcb1b77ba341@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
	<47BF619A.5060804@stephengentle.com>
	<b6bb06270802221737g42b77e83w701bdcb1b77ba341@mail.gmail.com>
Message-ID: <200802230215.24453.research@science.su>

On Saturday February 23 2008 01:37:21 Austin English wrote:
> On Fri, Feb 22, 2008 at 5:58 PM, Stephen Gentle <lists at stephengentle.com> 
wrote:
> > >  http://forum.winehq.org/
> >
> >  I just signed up. Need moderators?
>
> I can moderate if needed. Username - austin987
>
> -Austin

	Creation of such forum (linked with wine-users mailing list) was the best 
solution I can imagine! This is really great.
	BTW, I can help with its moderation too. My username is "L. Rahyen".


From zgold550 at gmail.com  Fri Feb 22 20:23:41 2008
From: zgold550 at gmail.com (Zachary Goldberg)
Date: Fri, 22 Feb 2008 21:23:41 -0500
Subject: website: add links to most popular active Wine forums
In-Reply-To: <b6bb06270802221737g42b77e83w701bdcb1b77ba341@mail.gmail.com>
References: <a71bd89a0802182145s5e4d3c46ta0a1ce31ca434acb@mail.gmail.com>
	<53e3a9930802210932y5a68e127xac1ae2401b518e8f@mail.gmail.com>
	<a71bd89a0802211041m476ad5a8sa77152f02c8f6f18@mail.gmail.com>
	<53e3a9930802211129m786382afp6fbe6f499b400559@mail.gmail.com>
	<a71bd89a0802211130j5ef772daxc0a845ce9a832065@mail.gmail.com>
	<19e31a080802211511i2b0b2985l980385395219e0e4@mail.gmail.com>
	<a71bd89a0802211528w74db5d5ci3d75a288dd402d02@mail.gmail.com>
	<47BECF4F.2010701@codeweavers.com>
	<47BF619A.5060804@stephengentle.com>
	<b6bb06270802221737g42b77e83w701bdcb1b77ba341@mail.gmail.com>
Message-ID: <b050a5e70802221823p12874c5al1c1196c0c2b69269@mail.gmail.com>

On Fri, Feb 22, 2008 at 8:37 PM, Austin English <austinenglish at gmail.com> wrote:
> On Fri, Feb 22, 2008 at 5:58 PM, Stephen Gentle <lists at stephengentle.com> wrote:
>  > >  http://forum.winehq.org/
>  >  I just signed up. Need moderators?
>  >
>  >
>  >
>  >
>
>  I can moderate if needed. Username - austin987
>
>  -Austin
>
>
>

phpBB forums actually can get spammed really badly in a short amount
of time.  Perhaps we should look into requiring administrative
approval for new forum members?

-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From research at science.su  Sat Feb 23 00:13:35 2008
From: research at science.su (L. Rahyen)
Date: Sat, 23 Feb 2008 06:13:35 +0000
Subject: Do we need a forum?
In-Reply-To: <53e3a9930802210837jc2066eq8f9c821547252c35@mail.gmail.com>
References: <a71bd89a0802171942k6b06ecc9sa1266c7720be0cb1@mail.gmail.com>
	<200802190119.57809.research@science.su>
	<53e3a9930802210837jc2066eq8f9c821547252c35@mail.gmail.com>
Message-ID: <200802230613.36137.research@science.su>

On Thursday February 21 2008 16:37:15 Tom Wickline wrote:
> On Mon, Feb 18, 2008 at 8:19 PM, L. Rahyen <research at science.su> wrote:
> >  > Tom is committed to doing this with
> >  > wine-forum. If there is something you don't like, such as the
> >  > registration, advertisements, etc I am sure he is willing to adjust
> >  > the user experience.
> >
> >         OK, then if he is reading this list hopefully he will consider my
> > words as feature request. If he really will fix these issues that would
> > be great. Thanks.
>
> Sorry for the late reply, ive caught the flu bug and ive been sick for
> the past week.
>
> I have yet to receive the first email of complaint about the
> advertisements on the forum.
> I know the Kontera adverts are considered by some as nag, pop-up
> advertising but ive yet to receive a message or email asking me to remove
> them.

	Well, personally I don't care about ads. I simply don't see them in most 
cases anyway. I use complex custom filters on all web-pages - and 
auto-removing of ads is just of one their features. In fact, I even didn't 
know about existence of ads on wine-forum (and many other sites)! BTW, I 
never mentioned ads in my messages as a problem...

> As for registration, every forum ive ever visited asked for registration,
> sorry but I don't understand what your asking for?
>
> Tom

	Well, there is some forums which provides "quick reply" form at the bottom of 
the thread (on any of its pages). If you are logged in, you can type text 
there and then submit it as usually. If you are not logged in, you will be 
able to enter your nickname, protection code and text with your reply. 
Protection code is intended as protection from "spam bots". Usually, 
protection code provided as somewhat noisy image with few digits and user 
should recognize them and enter correctly in the "protection code" field. 
Sometimes additional optional fields with password is provided so user can 
login and send an answer simultaneously. If he/she leave password field blank 
then reply is posted anyway with provided nickname but with "guest" settings 
(such as default avatar for all guests or not avatar at all, etc.) and guest 
privileges. Sometimes nickname collisions are allowed, sometimes not. 
Typically it is good idea to make "guest" settings in the way that clearly 
marks all guest posts as such.
	However, depending on the code base of a forum, it may be simple to integrate 
such a feature, or hard.

	But registration is one-time problem, especially for people who just want to 
ask one question or answer to some topic (that was found using Google for 
example) and don't plan to use the forum frequently. And many people can 
consider this as "minor" issue.
	More important problem is lack of ability to subscribe for all messages from 
the forum as as well as inability to answer via standard mail client. These 
problems are most important. wine-forum.org doesn't provide such 
functionality. It would be great if this is fixed.
	*At least* there should be possibility to subscribe to all messages from the 
forum and possibility to answer by clicking on the link (to the reply form on 
the forum) in each e-mail message from the forum (direct processing of the 
e-mail answers is even better but can be harder to implement). It is also 
important that after you logged in you don't need to login every time again 
and there is no short timeout (use of cookies is necessary for this to work). 
But I have no idea how hard/easy will be to implement these features on 
wine-forum.org because I know very little about vBulletin used by wine-forum.

	I think that recently created http://forum.winehq.org/ seems to be the best 
solution. Registration there isn't a problem because anyone can write a 
message directly to the mailing list without registration on the forum. This 
is exactly what I imagine as a perfect solution suitable for all users: 
everyone can post answers without logging in (via the mailing list), 
everybody can use forum or mailing list (depending on personal choice), and 
it is possible to receive and answer using any e-mail client you like. So I 
think winehq.org now have very good forum with nice sync with wine-users 
mailing list! I really like it. In fact it solves all major problems that I 
mentioned in my previous messages!


From kgbricola at web.de  Sat Feb 23 10:04:52 2008
From: kgbricola at web.de (=?ISO-8859-1?Q?Rico_Sch=FCller?=)
Date: Sat, 23 Feb 2008 17:04:52 +0100
Subject: wined3d: ActivateContext: try to fix wrong parameter?
In-Reply-To: <200802222320.51896.stefan@codeweavers.com>
References: <47BDC355.1080302@web.de>
	<200802212357.51891.stefandoesinger@gmx.at>
	<47BF4273.7040003@web.de>
	<200802222320.51896.stefan@codeweavers.com>
Message-ID: <47C04424.2000400@web.de>

I refer to the last attachment to the bug (and the patch which was sent 
in the initial mail 
http://www.winehq.org/pipermail/wine-devel/2008-February/062835.html - 
it's the same).

I just want to say if my patch is wrong and the other way is wrong (see 
bug http://bugs.winehq.org/show_bug.cgi?id=11584 ) then the real issue 
must be somewhere else!
To find that my knowledge isn't good enough yet. So I just want to have 
some help/hints to find the real source of the bug ;-)

Cheers
Rico


Stefan D?singer wrote:
> Am Freitag, 22. Februar 2008 22:45:23 schrieb Rico Sch?ller:
>> I didn't step deep into this problem. So if I could help with some logs
>> or other things, please let me know. Properly, the real bug is somewhere
>> else?
> Did you intend to attach a file to the mail, or did you refer to the last 
> attachment to the bug?
> 


From ivg231 at gmail.com  Sat Feb 23 19:04:23 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Sat, 23 Feb 2008 20:04:23 -0500
Subject: Bugs fixed in 0.9.56
In-Reply-To: <a71bd89a0802220939l60e8d89ak4bfae23eefa242c5@mail.gmail.com>
References: <a71bd89a0802220939l60e8d89ak4bfae23eefa242c5@mail.gmail.com>
Message-ID: <47C0C297.7040509@gmail.com>

Dan Kegel wrote:
> Here are the bugs marked fixed during the 0.9.56 cycle.
> (A few of them were fixed earlier, but not marked as such before.)
>   
It might be nice if the "Lots of bugfixes" line in each release ANNOUNCE 
file would link to a list like this one.
Proof there were lots of bugfixes...

Ivan


From dank at kegel.com  Sat Feb 23 19:17:57 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 23 Feb 2008 17:17:57 -0800
Subject: Bugs fixed in 0.9.56
In-Reply-To: <47C0C297.7040509@gmail.com>
References: <a71bd89a0802220939l60e8d89ak4bfae23eefa242c5@mail.gmail.com>
	<47C0C297.7040509@gmail.com>
Message-ID: <a71bd89a0802231717u336257e2lc7b5f0302a1769a5@mail.gmail.com>

On Sat, Feb 23, 2008 at 5:04 PM, Ivan Gyurdiev <ivg231 at gmail.com> wrote:
> Dan Kegel wrote:
>  > Here are the bugs marked fixed during the 0.9.56 cycle.
>  > (A few of them were fixed earlier, but not marked as such before.)
 >
>  It might be nice if the "Lots of bugfixes" line in each release ANNOUNCE
>  file would link to a list like this one.
>  Proof there were lots of bugfixes...

Alexandre told me he's thinking of doing that from now on.

I guess seeing that list made it pretty obvious we should do it!
- Dan


From austinenglish at gmail.com  Sat Feb 23 19:54:42 2008
From: austinenglish at gmail.com (Austin English)
Date: Sat, 23 Feb 2008 19:54:42 -0600
Subject: Sending updates to wine developers guide
Message-ID: <b6bb06270802231754y16635493n961f4fec6144235b@mail.gmail.com>

I was looking at the website.git online, I can't find the
documentation so I can edit it.
http://source.winehq.org/git/website.git/?a=blob;f=templates/en/documentation.template
references /docs/, but that doesn't exist on git. I'm sure a lot of
the info is outdated, but I was mostly looking to fix the regression
testing guides, which still reference CVS, and are horribly outdated.
Any possibility of adding /docs/ to website.git?

-Austin


From dank at kegel.com  Sat Feb 23 21:48:27 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 23 Feb 2008 19:48:27 -0800
Subject: Sending updates to wine developers guide
Message-ID: <a71bd89a0802231948y3e22495dx3f11121522b6a5b4@mail.gmail.com>

> I can't find the documentation so I can edit it.

Look at the bottom of
http://winehq.org/site/git

The command to load it into a local git repository is
git cvsimport -v -k -d
:pserver:anonymous at wine.cvs.sourceforge.net:/cvsroot/wine docs

You can then send in patches.


From truiken at gmail.com  Sat Feb 23 23:10:28 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 23 Feb 2008 23:10:28 -0600
Subject: gdiplus: Implement GdipLoadImageFromFile
In-Reply-To: <3a22664a0802232100w5be026bbp8e787d02fad8bd21@mail.gmail.com>
References: <3a22664a0802232028p7e5e49a8ia9a349d330b0ff02@mail.gmail.com>
	<3a22664a0802232100w5be026bbp8e787d02fad8bd21@mail.gmail.com>
Message-ID: <22821af30802232110x320343ck918a957eb9dacd4c@mail.gmail.com>

On Sat, Feb 23, 2008 at 11:00 PM, Nathan Beckmann
<nathan.beckmann at gmail.com> wrote:
> Hi. My name is Nathan Beckmann. I'm working on GDI+ for a class
>  project at UCLA (sponsored by Google).
>
>  This patch implements GdipLoadImageFromFile.
>
>  It includes basic tests for invalid parameters, all of which pass on
>  Windows. I'm working on this in order to get ConvertImage.exe
>  (http://bugs.winehq.org/show_bug.cgi?id=10980) to work. Now I'm
>  working on image encoders/decoders.
>


> Implemented GdipLoadImageFromFile using
> GdipLoadImageFromStream. Implementation based on
> GdipCreateBitmapFromFile.
>
> Changed GdipCreateBitmapFromFile to properly release the Stream COM
> object.
>
> Added tests for CreateBitmapFromFile and LoadImageFromFile when passed
> with invalid parameters.

One fix per patch.

http://winehq.org/site/sending_patches

-- 
James Hawkins


From dmitry at codeweavers.com  Sat Feb 23 23:41:41 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 24 Feb 2008 13:41:41 +0800
Subject: gdiplus: Implement GdipLoadImageFromFile
References: <3a22664a0802232028p7e5e49a8ia9a349d330b0ff02@mail.gmail.com>
	<3a22664a0802232100w5be026bbp8e787d02fad8bd21@mail.gmail.com>
Message-ID: <003001c876a7$f2e2e070$a600fea9@DMITRY>

"Nathan Beckmann" <nathan.beckmann at gmail.com> wrote:

>      stat = GdipCreateBitmapFromStream(stream, bitmap);
>  
> -    if(!stat)
> +    if(stream)
>          IStream_Release(stream);

The 'if' check above is not needed, GdipCreateStreamOnFile returns
a status which is already checked.

> +    stat = GdipCreateStreamOnFile(filename, GENERIC_READ, &stream);
> +
> +    if (stat != Ok)
> +        return stat;
> +
> +    stat = GdipLoadImageFromStream(stream, image);
> +   
> +    if (stream)
> +        IStream_Release(stream);

Same thing here.

-- 
Dmitry.


From hverbeet at gmail.com  Sun Feb 24 01:30:14 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Sun, 24 Feb 2008 08:30:14 +0100
Subject: d3dx9: Add stubs for the ID3DXFont functions [PATCH 5/9]
In-Reply-To: <E1JSzw3-0005zv-0I@www15.emo.freenet-rz.de>
References: <E1JSzw3-0005zv-0I@www15.emo.freenet-rz.de>
Message-ID: <d658b69e0802232330n6768323amf3834aa42c145116@mail.gmail.com>

On 23/02/2008, tony.wasserka at freenet.de <tony.wasserka at freenet.de> wrote:
>  +    TRACE("stubn");
Shouldn't that be a \n (here and in the other patches)?


From hverbeet at gmail.com  Sun Feb 24 01:38:41 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Sun, 24 Feb 2008 08:38:41 +0100
Subject: d3dx9: Add stubs for the ID3DXRenderToSurface functions [PATCH
	8/9]
In-Reply-To: <E1JSzy1-0005Gq-OW@www9.emo.freenet-rz.de>
References: <E1JSzy1-0005Gq-OW@www9.emo.freenet-rz.de>
Message-ID: <d658b69e0802232338h605e3094we1cedb3c1ef01717@mail.gmail.com>

On 23/02/2008, tony.wasserka at freenet.de <tony.wasserka at freenet.de> wrote:
>  +static HRESULT WINAPI ID3DXRenderToSurfaceImpl_QueryInterface(LPD3DXRENDERTOSURFACE iface, REFIID riid, LPVOID *object)
>  +{
>  +    ID3DXRenderToSurfaceImpl *This=(ID3DXRenderToSurfaceImpl*)iface;
>  +
>  +    if(IsEqualGUID(riid, &IID_IUnknown) || IsEqualGUID(riid, &IID_ID3DXRenderToSurface)) {
>  +        TRACE("(%p): QueryInterface from %sn", This, debugstr_guid(riid));
>  +        IUnknown_AddRef(iface);
>  +        *object=This;
>  +        return S_OK;
>  +    }
>  +    WARN("(%p)->(%s, %p): not foundn", iface, debugstr_guid(riid), object);
>  +    object=NULL;
>  +    return E_NOINTERFACE;
>  +}
>  +
Setting object to NULL here doesn't do a whole lot, you should set
*object to NULL (also goes for the other QueryInterface
implementations). Also, you'll probably want to put the TRACE before
the if block.


From tony.wasserka at freenet.de  Sun Feb 24 02:24:31 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Sun, 24 Feb 2008 09:24:31 +0100
Subject: d3dx9: Add stubs for the ID3DXRenderToSurface functions [PATCH
	8/9]
Message-ID: <E1JTC9v-0001Ad-Gq@www11.emo.freenet-rz.de>

> Shouldn't that be a n (here and in the other patches)?

> Setting object to NULL here doesn't do a whole lot, you should set
> *object to NULL (also goes for the other QueryInterface
> implementations). Also, you'll probably want to put the TRACE before
> the if block.

Thank you very much for pointing that out :)
Is there anything else wrong with it or can I resend the patches?




Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain inkl.
http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/index.html



From dmitry at codeweavers.com  Sun Feb 24 02:45:13 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 24 Feb 2008 16:45:13 +0800
Subject: d3dx9: Add stubs for the ID3DXRenderToSurface functions [PATCH8/9]
References: <E1JTC9v-0001Ad-Gq@www11.emo.freenet-rz.de>
Message-ID: <004901c876c1$93accc00$a600fea9@DMITRY>

<tony.wasserka at freenet.de> wrote:

> Thank you very much for pointing that out :)
> Is there anything else wrong with it or can I resend the patches?

You may try with smaller patches first, and send them one by one,
waiting for the previous one being committed.

-- 
Dmitry.


