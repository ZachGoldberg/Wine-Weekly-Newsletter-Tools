From stefan at codeweavers.com  Mon Jan 14 04:10:12 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 14 Jan 2008 11:10:12 +0100
Subject: entry to add in wine registry
In-Reply-To: <200801140029.39384.jacques.noe@laposte.net>
References: <200801140029.39384.jacques.noe@laposte.net>
Message-ID: <200801141110.12645.stefan@codeweavers.com>

Am Montag, 14. Januar 2008 00:29:39 schrieb Jacques No?:
> Hello,
>
> this is not a patch, but a new entry to add to
> http://wiki.winehq.org/UsefulRegistryKeys I have seen that the page is
> maintained by
> RoderickColenBrander, but I do not know
> how to contact him.
This is a wiki, you can just edit it yourself


From julliard at winehq.org  Mon Jan 14 08:24:09 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 14 Jan 2008 15:24:09 +0100
Subject: dlls/d3d9/tests/visual.c -- address five compiler warnings
	(RESEND)
In-Reply-To: <Pine.LNX.4.64.0801121848470.4453@acrux.dbai.tuwien.ac.at>
	(Gerald Pfeifer's message of "Sat, 12 Jan 2008 18:49:05 +0100 (CET)")
References: <Pine.LNX.4.64.0801121848470.4453@acrux.dbai.tuwien.ac.at>
Message-ID: <87bq7oiiye.fsf@wine.dyndns.org>

Gerald Pfeifer <gerald at pfeifer.com> writes:

> @@ -4348,12 +4349,12 @@ static void vshader_version_varying_test
>         "vs_3_0 returned color 0x%08x, expected 0x00203366\n", color);
>      color = getPixelColor(device, 160, 360);
>      ok((color & 0x00ff0000) >= 0x003c0000 && (color & 0x00ff0000) <= 0x004e0000 &&
> -       (color & 0x0000ff00) >= 0x00000000 && (color & 0x0000ff00) <= 0x00000000 &&
> +                                             (color & 0x0000ff00) <= 0x00000000 &&
>         (color & 0x000000ff) >= 0x00000066 && (color & 0x000000ff) <= 0x00210068,
>         "vs_1_1 returned color 0x%08x, expected 0x00808080\n", color);
>      color = getPixelColor(device, 480, 360);
>      ok((color & 0x00ff0000) >= 0x003c0000 && (color & 0x00ff0000) <= 0x004e0000 &&
> -       (color & 0x0000ff00) >= 0x00000000 && (color & 0x0000ff00) <= 0x00000000 &&
> +                                             (color & 0x0000ff00) <= 0x00000000 &&
>         (color & 0x000000ff) >= 0x00000066 && (color & 0x000000ff) <= 0x00210068,
>         "vs_2_0 returned color 0x%08x, expected 0x00000000\n", color);

These tests don't make much sense, with or without your fix, plus the
error messages don't match the tests. This needs more work.

-- 
Alexandre Julliard
julliard at winehq.org


From kde at graph-ix.net  Mon Jan 14 08:26:20 2008
From: kde at graph-ix.net (Markus)
Date: Mon, 14 Jan 2008 15:26:20 +0100
Subject: How to fix bug #11114?
Message-ID: <200801141526.20405.kde@graph-ix.net>

Hi,

regarding bug #11114, can anyone knowledgable in the area tell me how 
difficult it would be to resolve the issue?
As far as I can see, the game World in Conflict is using dxdiag.dll to 
determine whether a system is capable of running the game. Is there an 
implementation for this dll at all in Wine? The native library appears to not 
fool the game sufficiently enough to start without an error. Using plain Wine 
(no native dxdiag dll) leads to the error in line 44725 of the logfile in the 
report.

Thanks.
-- 
Markus


From kuba at mareimbrium.org  Mon Jan 14 09:11:03 2008
From: kuba at mareimbrium.org (Kuba Ober)
Date: Mon, 14 Jan 2008 10:11:03 -0500
Subject: Towards Zero Test Suite Failures
In-Reply-To: <478B0CC5.8030201@gmail.com>
References: <a71bd89a0801131553k305c3cf8x655c7f0b1dbb8ff1@mail.gmail.com>
	<a71bd89a0801132150w71bfa479v27af0f20949d4f71@mail.gmail.com>
	<478B0CC5.8030201@gmail.com>
Message-ID: <200801141011.03349.kuba@mareimbrium.org>

[snipsnipsnip]
> >>> On my machine, we've been hovering between
> >>> five and ten test suite failures for some time
> >>> (see http://bugs.winehq.org/show_bug.cgi?id=9916 )
> >>> ...
> >>> How 'bout folks spend some time tracking
> >>> the current six odd failures down and cleaning them up?
> >>
> >> Sounds like a worthy goal IMO.  It seems theres much more than 5 or 6
> >> things which need work though
> >
> > Not a pretty picture, is it?
> > But I was only referring to the tests that fail on Wine; there,
> > we have control over both the test and the code, so if
> > we can't get those tests passing, we're pretty weak :-)
>
> Are these tests passing (now) on Alexandre's machine? I thought he didn't
> apply patches that break the wine tests? (at least on his box).

A funny observation perhaps, but I doubt that Microsoft has actually employed 
such a stringent QA process when they developed the code whose bugs Wine now 
works around :)

Cheers, Kuba


From forrest at alumni.ncsu.edu  Mon Jan 14 09:17:27 2008
From: forrest at alumni.ncsu.edu (Forrest Samuels)
Date: Mon, 14 Jan 2008 10:17:27 -0500
Subject: Improving Default Serial Port Configuration
In-Reply-To: <200801131439.49335.hans@it.vu.nl>
References: <781397410801122119s5f5d3e48h7e2d0890242f16be@mail.gmail.com>
	<200801131439.49335.hans@it.vu.nl>
Message-ID: <781397410801140717j78704799x4d994cba3fe79c1c@mail.gmail.com>

On Jan 13, 2008 8:39 AM, Hans Leidekker <hans at it.vu.nl> wrote:
> On Sunday 13 January 2008 06:19:06 Forrest Samuels wrote:
>
> > Does anyone have any insight on where I should start looking to
> > implement this? Implementation suggestions? In the bug, Juan Lang made
> > the suggestion that "Explorer's hal.c should be extended to create new
> > devices for all the ports it finds, using SetupDiCreateDeviceInfo
> > followed by SetupDiRegisterDeviceInfo. For some devices it should also
> > call SetupDiCreateDeviceInterface to register a particular interface."
> > I've looked in programs/explorer/hal.c and I am not sure where to
> > begin hooking something like that in.
>
> I'd like to know where and when SetupDiRegisterDeviceInfo gets called on
> Windows. I know that Alexandre is planning to move drive detection from
> explorer to mountmgr.sys, serial devices will probably end up in serial.sys
> or something like that. Perhaps this could work by making the driver itself
> do device registration.
>
>  -Hans
>

Is there a time frame for the mountmgr.sys changes? Do I need to wait
until Alexandre makes those changes or could I start working on this
fix elsewhere and just move it later. I'm not really sure where to
start and would love a little direction to get started. I don't think
this is taking on too much for my first work on wine but I may be
wrong on that too. Thanks for the help.

-- 
Forrest Samuels (forrest at alumni.ncsu.edu)


From julliard at winehq.org  Mon Jan 14 09:19:20 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 14 Jan 2008 16:19:20 +0100
Subject: [PATCH] [DbgHelp]: A couple of enhancements for writing minidumps
In-Reply-To: <20080113160216.20959.46624.stgit@localhost> (Eric Pouech's
	message of "Sun, 13 Jan 2008 17:02:16 +0100")
References: <20080113160216.20959.46624.stgit@localhost>
Message-ID: <877iicigef.fsf@wine.dyndns.org>

Eric Pouech <eric.pouech at orange.fr> writes:

> - returning (instead of passing a pointer to) the size of the blocks pointed by the directories
> - now storing the PE version information in module blocks
> - fixed an un-initialized field in minidump header
> - fixed the suspend count value in thread block

Please send separate fixes as separate patches.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Mon Jan 14 10:13:43 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 14 Jan 2008 08:13:43 -0800
Subject: Towards Zero Test Suite Failures
In-Reply-To: <3f4fd2640801140541i3cbb8a0i3f34b0903d7cb360@mail.gmail.com>
References: <a71bd89a0801131553k305c3cf8x655c7f0b1dbb8ff1@mail.gmail.com>
	<b050a5e70801132030u25c2c7c4uaa7aa6dcdd0baba8@mail.gmail.com>
	<a71bd89a0801132150w71bfa479v27af0f20949d4f71@mail.gmail.com>
	<3f4fd2640801140541i3cbb8a0i3f34b0903d7cb360@mail.gmail.com>
Message-ID: <a71bd89a0801140813v677cd2a5i5a046fcdc881be7d@mail.gmail.com>

On Jan 14, 2008 5:41 AM, Reece Dunn <msclrhd at googlemail.com> wrote:
> > But I was only referring to the tests that fail on Wine; there,
> > we have control over both the test and the code, so if
> > we can't get those tests passing, we're pretty weak :-)
>
> But if you fix a test failure in Wine that is failing on Windows, then
> you are introducing a bug in Wine.

When fixing those 5 - 10 tests on Wine, one should also
make sure they work on Windows.

> I like the idea of getting the tests passing on Windows XP (SP2?) -
> that will then be the baseline for Wine. This should not cause
> regressions on other versions of Windows.

Yep.  And at some point we should indeed make Windows XP
the default personality in Wine.  Seems like a 1.0 kind of thing.
- Dan


From dank at kegel.com  Mon Jan 14 10:22:39 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 14 Jan 2008 08:22:39 -0800
Subject: Good source for msvcr71?
Message-ID: <a71bd89a0801140822s75db446did3f9c8a1fa4e3ccf@mail.gmail.com>

I finally ran into an app that wanted msvcr71
but didn't bundle it (supercopyright).
After a few minutes of looking, I couldn't find it
anywhere on microsoft.com.  The best source
I could find was the installer for spambayes 1.1,
but that's inconvenient.  Anyone know a better source,
preferably at microsoft.com?
I'd like to add it to winetricks.

Thanks,
Dan


From dank at kegel.com  Mon Jan 14 10:25:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 14 Jan 2008 08:25:18 -0800
Subject: Overriding comctl32
Message-ID: <a71bd89a0801140825w656c5715w8d1c25a96ded1c55@mail.gmail.com>

For future reference:
It turns out that installing a native comctl32
and setting overrides for comctl32, as
  sh winetricks cc580
does, is no longer enough to override comctl32.
You also have to remove Wine's sxs manifest
for comctl32, too, e.g.
  rm -rf
~/.wine/drive_c/windows/winsxs/manifests/x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.2600.2982_none_deadbeef.manifest
else wine continues loading the builtin one.
- Dan


From zgold550 at gmail.com  Mon Jan 14 11:06:38 2008
From: zgold550 at gmail.com (Zachary Goldberg)
Date: Mon, 14 Jan 2008 12:06:38 -0500
Subject: Towards Zero Test Suite Failures
In-Reply-To: <a71bd89a0801140813v677cd2a5i5a046fcdc881be7d@mail.gmail.com>
References: <a71bd89a0801131553k305c3cf8x655c7f0b1dbb8ff1@mail.gmail.com>
	<b050a5e70801132030u25c2c7c4uaa7aa6dcdd0baba8@mail.gmail.com>
	<a71bd89a0801132150w71bfa479v27af0f20949d4f71@mail.gmail.com>
	<3f4fd2640801140541i3cbb8a0i3f34b0903d7cb360@mail.gmail.com>
	<a71bd89a0801140813v677cd2a5i5a046fcdc881be7d@mail.gmail.com>
Message-ID: <b050a5e70801140906r47f87abo6c0ce09f0ec51e7@mail.gmail.com>

On Jan 14, 2008 11:13 AM, Dan Kegel <dank at kegel.com> wrote:
> On Jan 14, 2008 5:41 AM, Reece Dunn <msclrhd at googlemail.com> wrote:
> > > But I was only referring to the tests that fail on Wine; there,
> > > we have control over both the test and the code, so if
> > > we can't get those tests passing, we're pretty weak :-)
> >
> > But if you fix a test failure in Wine that is failing on Windows, then
> > you are introducing a bug in Wine.
>
> When fixing those 5 - 10 tests on Wine, one should also
> make sure they work on Windows.
>
> > I like the idea of getting the tests passing on Windows XP (SP2?) -
> > that will then be the baseline for Wine. This should not cause
> > regressions on other versions of Windows.
>
> Yep.  And at some point we should indeed make Windows XP
> the default personality in Wine.  Seems like a 1.0 kind of thing.
> - Dan
>


Is there a reason there isn't a Linux column on that giant test.wine list?


-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From thunderbird2k at gmx.net  Mon Jan 14 11:23:27 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Mon, 14 Jan 2008 18:23:27 +0100
Subject: Fix texture coordinate calculation in surface_blt_to_drawable
In-Reply-To: <98f9d06a0801120957j79836a26u5a4bdb25c7f7d7d@mail.gmail.com>
References: <98f9d06a0801120957j79836a26u5a4bdb25c7f7d7d@mail.gmail.com>
Message-ID: <20080114172327.95260@gmx.net>

I just wanted to confirm that this patch is correct. Stefan and I talked about it and it should be right. Before the surface rewrite there were two codepaths like this and one of them used integers and the other texture one used floats. During the rewrite they were merged and the combined one used integers. That's what caused the regression. The use of floats makes much more sense.

Roderick


> This fixes a bug with the use of opengl to render direct draw in older
> graphic cards.
> 
> The problem is in dlls/wined3d/surface.c in surface_blt_to_drawable.
> 
> 3547          coords[0].x = rect.left   / This->pow2Width;
> 
> 3550          coords[1].x = rect.left   / This->pow2Width;
> 
> 3553          coords[2].x = rect.right  / This->pow2Width;
> 
> 3556          coords[3].x = rect.right  / This->pow2Width;
> 
> 3559          coords[0].y = rect.top    / This->pow2Height;
> 3560          coords[1].y = rect.bottom / This->pow2Height;
> 3561          coords[2].y = rect.bottom / This->pow2Height;
> 3562          coords[3].y = rect.top    / This->pow2Height;
> 
> 
> All calculation are done with integers so when rect.right < pow2Wdith and
> rect.bottom < pow2Height
> all texture coordinates are set to 0 thus only the upper left pixel of the
> image is displayed
> scaled up to cover the entire window.

-- 
GMX FreeMail: 1 GB Postfach, 5 E-Mail-Adressen, 10 Free SMS.
Alle Infos und kostenlose Anmeldung: http://www.gmx.net/de/go/freemail


From msclrhd at googlemail.com  Mon Jan 14 07:41:35 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Mon, 14 Jan 2008 13:41:35 +0000
Subject: Towards Zero Test Suite Failures
In-Reply-To: <a71bd89a0801132150w71bfa479v27af0f20949d4f71@mail.gmail.com>
References: <a71bd89a0801131553k305c3cf8x655c7f0b1dbb8ff1@mail.gmail.com>
	<b050a5e70801132030u25c2c7c4uaa7aa6dcdd0baba8@mail.gmail.com>
	<a71bd89a0801132150w71bfa479v27af0f20949d4f71@mail.gmail.com>
Message-ID: <3f4fd2640801140541i3cbb8a0i3f34b0903d7cb360@mail.gmail.com>

On 14/01/2008, Dan Kegel <dank at kegel.com> wrote:
> On Jan 13, 2008 8:30 PM, Zachary Goldberg <zgold550 at gmail.com> wrote:
> > > On my machine, we've been hovering between
> > > five and ten test suite failures for some time
> > > (see http://bugs.winehq.org/show_bug.cgi?id=9916 )
> > > ...
> > > How 'bout folks spend some time tracking
> > > the current six odd failures down and cleaning them up?
> >
> > Sounds like a worthy goal IMO.  It seems theres much more than 5 or 6
> > things which need work though:
> > http://test.winehq.org/data/200801121000/
>
> Not a pretty picture, is it?
> But I was only referring to the tests that fail on Wine; there,
> we have control over both the test and the code, so if
> we can't get those tests passing, we're pretty weak :-)

But if you fix a test failure in Wine that is failing on Windows, then
you are introducing a bug in Wine.

> > Perhaps we should try and
> > have the nightly suite also pass all tests -- or is this too much of a
> > frivolous goal?
>
> Getting all tests passing on Windows XP would be great,
> but it's a lot of work.   It'd be less work if we focused on just the tests
> that are failing on *all* Win XP systems, but that's still
> at least 180 ok's that aren't ok.  Let's at least fix the 5 or 10 that are
> failing on Wine, and try to keep them fixed.

Ideally, all tests should pass on all platforms. However, there are
issues with different service packs/hot fixes on each version of
Windows, different user configuration (themes, UAC on/off, locale,
etc.), different hardware and even different behaviour between
different versions of Windows.

I like the idea of getting the tests passing on Windows XP (SP2?) -
that will then be the baseline for Wine. This should not cause
regressions on other versions of Windows.

Getting the tests passing on older verisons of Windows will be
important for backward compatibility (e.g. if you have a program that
only runs on Windows 3.1 or Windows 95), and will ensure that Wine
does not break in those cases.

- Reece


From truiken at gmail.com  Mon Jan 14 11:46:36 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 14 Jan 2008 11:46:36 -0600
Subject: Improving Default Serial Port Configuration
In-Reply-To: <781397410801140717j78704799x4d994cba3fe79c1c@mail.gmail.com>
References: <781397410801122119s5f5d3e48h7e2d0890242f16be@mail.gmail.com>
	<200801131439.49335.hans@it.vu.nl>
	<781397410801140717j78704799x4d994cba3fe79c1c@mail.gmail.com>
Message-ID: <22821af30801140946w1bc3e15au671fc9da8fb0a858@mail.gmail.com>

On Jan 14, 2008 9:17 AM, Forrest Samuels <forrest at alumni.ncsu.edu> wrote:
>
> On Jan 13, 2008 8:39 AM, Hans Leidekker <hans at it.vu.nl> wrote:
> > On Sunday 13 January 2008 06:19:06 Forrest Samuels wrote:
> >
> > > Does anyone have any insight on where I should start looking to
> > > implement this? Implementation suggestions? In the bug, Juan Lang made
> > > the suggestion that "Explorer's hal.c should be extended to create new
> > > devices for all the ports it finds, using SetupDiCreateDeviceInfo
> > > followed by SetupDiRegisterDeviceInfo. For some devices it should also
> > > call SetupDiCreateDeviceInterface to register a particular interface."
> > > I've looked in programs/explorer/hal.c and I am not sure where to
> > > begin hooking something like that in.
> >
> > I'd like to know where and when SetupDiRegisterDeviceInfo gets called on
> > Windows. I know that Alexandre is planning to move drive detection from
> > explorer to mountmgr.sys, serial devices will probably end up in serial.sys
> > or something like that. Perhaps this could work by making the driver itself
> > do device registration.
> >
> >  -Hans
> >
>
> Is there a time frame for the mountmgr.sys changes? Do I need to wait
> until Alexandre makes those changes or could I start working on this
> fix elsewhere and just move it later. I'm not really sure where to
> start and would love a little direction to get started. I don't think
> this is taking on too much for my first work on wine but I may be
> wrong on that too. Thanks for the help.
>

To be honest, you're greatly underestimating the difficulty of the
task.  The fact that you have to ask such questions should alert you
to this.

-- 
James Hawkins


From austinenglish at gmail.com  Mon Jan 14 12:00:54 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 14 Jan 2008 12:00:54 -0600
Subject: WineD3D Spelling Fixes
Message-ID: <b6bb06270801141000y17f602e1j64634941f26ea45b@mail.gmail.com>

Any reason this patch wasn't applied? I didn't see any feedback on wine-patches.

http://www.winehq.org/pipermail/wine-patches/2008-January/048933.html

-Austin


From stefan at codeweavers.com  Mon Jan 14 12:14:10 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 14 Jan 2008 19:14:10 +0100
Subject: Towards Zero Test Suite Failures
In-Reply-To: <3f4fd2640801140541i3cbb8a0i3f34b0903d7cb360@mail.gmail.com>
References: <a71bd89a0801131553k305c3cf8x655c7f0b1dbb8ff1@mail.gmail.com>
	<a71bd89a0801132150w71bfa479v27af0f20949d4f71@mail.gmail.com>
	<3f4fd2640801140541i3cbb8a0i3f34b0903d7cb360@mail.gmail.com>
Message-ID: <200801141914.10423.stefan@codeweavers.com>

Am Montag, 14. Januar 2008 14:41:35 schrieb Reece Dunn:
> But if you fix a test failure in Wine that is failing on Windows, then
> you are introducing a bug in Wine.
Not necessarily. Some tests are too strict in what they expect, and sometimes 
the Windows behavior is "wrong", in the way that some application expects 
something different and wouldn't run on this Windows installation either.

An example for a too strict test is a test that hardcodes paths that are 
specific to english locales(These cases should be fixed by now). Examples 
of "broken" Windows installations are VMware installations with Direct3D 
support enabled. VMWare has a D3D driver that works similarly to Wine, but 
has a few bugs that our tests stumble uppon.


From hans at it.vu.nl  Mon Jan 14 12:47:07 2008
From: hans at it.vu.nl (Hans Leidekker)
Date: Mon, 14 Jan 2008 19:47:07 +0100
Subject: Improving Default Serial Port Configuration
In-Reply-To: <22821af30801140946w1bc3e15au671fc9da8fb0a858@mail.gmail.com>
References: <781397410801122119s5f5d3e48h7e2d0890242f16be@mail.gmail.com>
	<781397410801140717j78704799x4d994cba3fe79c1c@mail.gmail.com>
	<22821af30801140946w1bc3e15au671fc9da8fb0a858@mail.gmail.com>
Message-ID: <200801141947.08432.hans@it.vu.nl>

On Monday 14 January 2008 18:46:36 James Hawkins wrote:

> > Is there a time frame for the mountmgr.sys changes? Do I need to wait
> > until Alexandre makes those changes or could I start working on this
> > fix elsewhere and just move it later. I'm not really sure where to
> > start and would love a little direction to get started. I don't think
> > this is taking on too much for my first work on wine but I may be
> > wrong on that too. Thanks for the help.
> >
> 
> To be honest, you're greatly underestimating the difficulty of the
> task.  The fact that you have to ask such questions should alert you
> to this.

Yeah, the infrastructural problems are way beyond beginner level, but you
could simply ignore those and write some code that registers a serial device
i.e. writes registry keys below HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum

MSDN tells me there is something called the plug and play manager which is
responsible for registering devices. We have no equivalent in Wine but we may
get away with fake data for serial devices or find some other way to retrieve
it.

 -Hans


From jacek at codeweavers.com  Mon Jan 14 15:43:58 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Mon, 14 Jan 2008 22:43:58 +0100
Subject: [PATCH] check for This->frame
Message-ID: <478BD79E.9020206@codeweavers.com>

Hi Marcus,

Marcus Meissner wrote:
> Hi,
>
> Coverity 645 spotted missing This->frame
> checks.
>
> Ciao, Marcus
> ---
>  dlls/mshtml/olecmd.c |    5 +++--
>  1 files changed, 3 insertions(+), 2 deletions(-)
>
> diff --git a/dlls/mshtml/olecmd.c b/dlls/mshtml/olecmd.c
> index 326b0b0..02b5e83 100644
> --- a/dlls/mshtml/olecmd.c
> +++ b/dlls/mshtml/olecmd.c
> @@ -621,7 +621,7 @@ static HRESULT exec_editmode(HTMLDocument *This, DWORD cmdexecopt, VARIANT *in,
>          if(This->hostui)
>              IDocHostUIHandler_HideUI(This->hostui);
>  
> -        if(This->hostui)
> +        if(This->hostui && This->frame)
>              IDocHostUIHandler_ShowUI(This->hostui, DOCHOSTUITYPE_AUTHOR, ACTOBJ(This), CMDTARGET(This),
>                  This->frame, This->ip_window);
>   

There is no reason to test This->frame here (unless you have tested that 
native MSHTML doesn't call ShowUI with NULL frame). Coverity spotted an 
other bug, which you've fixed in other part of the patch.

Thanks,
    Jacek


From luis.busquets at ilidium.com  Mon Jan 14 15:45:02 2008
From: luis.busquets at ilidium.com (=?ISO-8859-1?Q?=22Luis_C=2E_Busquets_P=E9rez=22?=)
Date: Mon, 14 Jan 2008 22:45:02 +0100
Subject: GDI32.dll.NamedEscape
Message-ID: <478BD7DE.4000507@ilidium.com>

I am having problems with a bunch of three games that came together in 
the same pack. They all abort qhen asking for installation with the 
following line

wine: Call from 0x73ba1895 to unimplemented function 
GDI32.dll.NamedEscape, aborting

Does anybody know what GDI32.dll.NamedEscape does?

Does anybody intend to implement it in the near future?


From rob at codeweavers.com  Mon Jan 14 15:48:44 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 14 Jan 2008 21:48:44 +0000
Subject: GDI32.dll.NamedEscape
In-Reply-To: <478BD7DE.4000507@ilidium.com>
References: <478BD7DE.4000507@ilidium.com>
Message-ID: <478BD8BC.1020305@codeweavers.com>

Luis C. Busquets P?rez wrote:
> I am having problems with a bunch of three games that came together in 
> the same pack. They all abort qhen asking for installation with the 
> following line
>
> wine: Call from 0x73ba1895 to unimplemented function 
> GDI32.dll.NamedEscape, aborting
>
> Does anybody know what GDI32.dll.NamedEscape does?
>   

It appears to be undocumented. Are you using some native DLLs by any chance?

-- 
Rob Shearman



From juan.lang at gmail.com  Mon Jan 14 15:53:22 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Mon, 14 Jan 2008 13:53:22 -0800
Subject: GDI32.dll.NamedEscape
In-Reply-To: <478BD8BC.1020305@codeweavers.com>
References: <478BD7DE.4000507@ilidium.com> <478BD8BC.1020305@codeweavers.com>
Message-ID: <3a768c550801141353y350556baifee7eee742f443f8@mail.gmail.com>

> It appears to be undocumented. Are you using some native DLLs by any chance?

I've noticed it's called by some Adobe DLLs, e.g. atmlib.dll, so the
same crash can be triggered by installing an app with no native
overrides.
--Juan


From dank at kegel.com  Mon Jan 14 15:58:48 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 14 Jan 2008 13:58:48 -0800
Subject: [hlink] Skip tests if hlink couldn't be created
In-Reply-To: <478BD92C.4040308@codeweavers.com>
References: <a71bd89a0801131840y654e4121m482a132768344638@mail.gmail.com>
	<478BD92C.4040308@codeweavers.com>
Message-ID: <a71bd89a0801141358p3815e53cx2239c46698fa75ec@mail.gmail.com>

On Jan 14, 2008 1:50 PM, Robert Shearman <rob at codeweavers.com> wrote:
> Dan Kegel wrote:
> > This makes the test slightly more robust to operator error.
>
> If we're striving to get zero test failures then converting a crash to
> some failures isn't really much of an improvement.

The crash was in test code, and only happened for
me because I had done something stupid
(probably "wineserver -k" before wineprefixcreate's
server had flushed its registry cache).

Since that's the only situation I can think of this
crash would happen in, it's kind of a silly patch
all around, but it does have the virtue of trying
to give the confused developer a clue
(as in "you did something to screw up wineprefixcreate").
- Dan


From rob at codeweavers.com  Mon Jan 14 15:50:36 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Mon, 14 Jan 2008 21:50:36 +0000
Subject: [hlink] Skip tests if hlink couldn't be created
In-Reply-To: <a71bd89a0801131840y654e4121m482a132768344638@mail.gmail.com>
References: <a71bd89a0801131840y654e4121m482a132768344638@mail.gmail.com>
Message-ID: <478BD92C.4040308@codeweavers.com>

Dan Kegel wrote:
> This makes the test slightly more robust to operator error.
>   

If we're striving to get zero test failures then converting a crash to 
some failures isn't really much of an improvement.

-- 
Rob Shearman



From hverbeet at gmail.com  Mon Jan 14 16:57:39 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 14 Jan 2008 23:57:39 +0100
Subject: [PATCH] check for array index overflows
In-Reply-To: <478bdc1e.0254260a.08eb.701cSMTPIN_ADDED@mx.google.com>
References: <478bdc1e.0254260a.08eb.701cSMTPIN_ADDED@mx.google.com>
Message-ID: <d658b69e0801141457r2301243nf1d41390d23a8803@mail.gmail.com>

On 14/01/2008, Marcus Meissner <marcus at jet.franken.de> wrote:
> Hi,
>
> This checks for overflowing the fixed size arrays.
>
> spotted by Coverity.
>
> (Submitted some months ago already, but left in my queue.)
>
> Ciao, Marcus
> ---
IIRC last time we tested this it was allowed on Windows, and simply
causes memory corruption.
If we want to prevent this, we should probably just return WINED3D_OK.


From marcus at jet.franken.de  Tue Jan 15 01:08:36 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Tue, 15 Jan 2008 08:08:36 +0100
Subject: [PATCH] check for array index overflows
In-Reply-To: <d658b69e0801141457r2301243nf1d41390d23a8803@mail.gmail.com>
References: <478bdc1e.0254260a.08eb.701cSMTPIN_ADDED@mx.google.com>
	<d658b69e0801141457r2301243nf1d41390d23a8803@mail.gmail.com>
Message-ID: <20080115070836.GB6737@galeere>

On Mon, Jan 14, 2008 at 11:57:39PM +0100, H. Verbeet wrote:
> On 14/01/2008, Marcus Meissner <marcus at jet.franken.de> wrote:
> > Hi,
> >
> > This checks for overflowing the fixed size arrays.
> >
> > spotted by Coverity.
> >
> > (Submitted some months ago already, but left in my queue.)
> >
> > Ciao, Marcus
> > ---
> IIRC last time we tested this it was allowed on Windows, and simply
> causes memory corruption.
> If we want to prevent this, we should probably just return WINED3D_OK.

I don't like memory corruption or buffer overflows. ;)
Just sent another patch, returning WINED3D_OK but printing ERR().

Ciao, Marcus


From dmitry at codeweavers.com  Tue Jan 15 02:22:48 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 15 Jan 2008 16:22:48 +0800
Subject: user32,
	wined3d: move refresh rate fallback to catch all cases (resend)
References: <20080114220520.P49542@anduin.net>
Message-ID: <007101c8574f$d1ed93a0$a600fea9@DMITRY>

"Erik Inge Bols?" <knan-wine at anduin.net> wrote:

> If requesting a refresh rate that isn't available, but a better one is,
> ChangeDisplaySettings fails and some games fail to launch. This does
> not seem to match WinXP behaviour with the same graphics card + lcd
> monitor combination.

If that's not what Windows does then this patch can't be accepted. In any
case a test case showing Windows behaviour is required.

-- 
Dmitry. 



From dmitry at codeweavers.com  Tue Jan 15 02:39:44 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 15 Jan 2008 16:39:44 +0800
Subject: Good source for msvcr71?
References: <a71bd89a0801140822s75db446did3f9c8a1fa4e3ccf@mail.gmail.com>
Message-ID: <00bd01c85752$31cf67b0$a600fea9@DMITRY>

"Dan Kegel" <dank at kegel.com> wrote:

> I finally ran into an app that wanted msvcr71
> but didn't bundle it (supercopyright).
> After a few minutes of looking, I couldn't find it
> anywhere on microsoft.com.  The best source
> I could find was the installer for spambayes 1.1,
> but that's inconvenient.  Anyone know a better source,
> preferably at microsoft.com?
> I'd like to add it to winetricks.

http://msdn2.microsoft.com/en-us/library/abx4dbyh(VS.71).aspx

<quote>
What is the difference between msvcrt.dll and msvcr71.dll?

The msvcrt.dll is now a "known DLL," meaning that it is a system component
owned and built by Windows. It is intended for future use only by system-level
components. An application should use and redistribute msvcr71.dll, and
it should avoid placing a copy or using an existing copy of msvcr71.dll
in the system directory. Instead, the application should keep a copy of
msvcr71.dll in its application directory with the program executable.
</quote>

So, it seems like Microsoft suggests to always distribute its own copy of
msvcr71.dll with every application. That means that it's unlikely that
Microsoft will provide an installer for it on microsoft.com.

Just an idea, can we build our mozilla dlls so that the build includes
msvcr71.dll?

-- 
Dmitry.


From knan-wine at anduin.net  Tue Jan 15 03:21:28 2008
From: knan-wine at anduin.net (=?iso-8859-1?Q?Erik_Inge_Bols=F8?=)
Date: Tue, 15 Jan 2008 10:21:28 +0100 (CET)
Subject: user32,wined3d: move refresh rate fallback to catch all cases
	(resend)
In-Reply-To: <007101c8574f$d1ed93a0$a600fea9@DMITRY>
References: <20080114220520.P49542@anduin.net>
	<007101c8574f$d1ed93a0$a600fea9@DMITRY>
Message-ID: <20080115101319.C1800@anduin.net>

On Tue, 15 Jan 2008, Dmitry Timoshkov wrote:
> "Erik Inge Bols?" <knan-wine at anduin.net> wrote:
> > If requesting a refresh rate that isn't available, but a better one is,
> > ChangeDisplaySettings fails and some games fail to launch. This does
> > not seem to match WinXP behaviour with the same graphics card + lcd
> > monitor combination.
> 
> If that's not what Windows does then this patch can't be accepted. In any
> case a test case showing Windows behaviour is required.

This is a change to match windows behaviour, AFAICT.

How would I go about adding a testcase for this? I don't have a windows 
development environment set up, and only indirectly a windows install to 
test on. Can't mess around with it too much, it's not mine.

--
-erik	http://useofwords.blogspot.com/


From dmitry at codeweavers.com  Tue Jan 15 03:32:46 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 15 Jan 2008 17:32:46 +0800
Subject: user32,
	wined3d: move refresh rate fallback to catch all cases(resend)
References: <20080114220520.P49542@anduin.net><007101c8574f$d1ed93a0$a600fea9@DMITRY>
	<20080115101319.C1800@anduin.net>
Message-ID: <010a01c85759$97b18ac0$a600fea9@DMITRY>

"Erik Inge Bols?" <knan-wine at anduin.net> wrote:

> This is a change to match windows behaviour, AFAICT.

Based on what?

> How would I go about adding a testcase for this? I don't have a windows
> development environment set up, and only indirectly a windows install to
> test on. Can't mess around with it too much, it's not mine.

If you haven't tested this in Windows then I don't see how you could
claim that your patch makes Wine conform to Windows behaviour.

A test I'd think of would scan available video modes, choose one, change
its refresh rate so that the modes of the same resolution have different
values, and see what happens if you pass it to ChangeDisplaySettings.

-- 
Dmitry. 



From knan-wine at anduin.net  Tue Jan 15 04:11:23 2008
From: knan-wine at anduin.net (=?iso-8859-1?Q?Erik_Inge_Bols=F8?=)
Date: Tue, 15 Jan 2008 11:11:23 +0100 (CET)
Subject: user32,wined3d: move refresh rate fallback to catch all
	cases(resend)
In-Reply-To: <010a01c85759$97b18ac0$a600fea9@DMITRY>
References: <20080114220520.P49542@anduin.net><007101c8574f$d1ed93a0$a600fea9@DMITRY>
	<20080115101319.C1800@anduin.net>
	<010a01c85759$97b18ac0$a600fea9@DMITRY>
Message-ID: <20080115110236.T10962@anduin.net>

On Tue, 15 Jan 2008, Dmitry Timoshkov wrote:
> "Erik Inge Bols?" <knan-wine at anduin.net> wrote:
> > This is a change to match windows behaviour, AFAICT.
> 
> Based on what?
> 
> > How would I go about adding a testcase for this? I don't have a windows
> > development environment set up, and only indirectly a windows install to
> > test on. Can't mess around with it too much, it's not mine.
> 
> If you haven't tested this in Windows then I don't see how you could
> claim that your patch makes Wine conform to Windows behaviour.

As I said last time I tried to submit this, the game starts in Windows 
XP on an identical graphics card + lcd monitor combination. (50 Hz is 
not available there either.) It does not start in Wine. This allows it to 
start, but I'm not 100% certain it fixes it in the right place.

--
-erik	http://useofwords.blogspot.com/


From dmitry at codeweavers.com  Tue Jan 15 04:24:41 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 15 Jan 2008 18:24:41 +0800
Subject: user32,
	wined3d: move refresh rate fallback to catch allcases(resend)
References: <20080114220520.P49542@anduin.net><007101c8574f$d1ed93a0$a600fea9@DMITRY><20080115101319.C1800@anduin.net><010a01c85759$97b18ac0$a600fea9@DMITRY>
	<20080115110236.T10962@anduin.net>
Message-ID: <013101c85760$d8684c50$a600fea9@DMITRY>

"Erik Inge Bols?" <knan-wine at anduin.net> wrote:

> As I said last time I tried to submit this, the game starts in Windows
> XP on an identical graphics card + lcd monitor combination. (50 Hz is
> not available there either.) It does not start in Wine. This allows it to
> start, but I'm not 100% certain it fixes it in the right place.

It should be investigated first where an invalid refresh rate comes from,
i.e. you are fixing the real problem and not a subsequence of a bug somewhere
else.

-- 
Dmitry.



From rob at codeweavers.com  Tue Jan 15 04:33:30 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Tue, 15 Jan 2008 10:33:30 +0000
Subject: gdi32: Do not allow to create too large device dependent bitmaps
	like	Windows does
In-Reply-To: <E1JEive-0004mn-Nk@mail.codeweavers.com>
References: <E1JEive-0004mn-Nk@mail.codeweavers.com>
Message-ID: <478C8BFA.80005@codeweavers.com>

Dmitry Timoshkov wrote:
> +    SetLastError(0xdeadbeef);
> +    hbmp = CreateBitmap(0x7ffffff, 9, 1, 1, NULL);
> +    ok(!hbmp, "CreateBitmap should fail\n");
> +    ok(GetLastError() == ERROR_NOT_ENOUGH_MEMORY,
> +       "expected ERROR_INVALID_PARAMETER, got %u\n", GetLastError());
>   

The string here doesn't match the test.

-- 
Rob Shearman



From julliard at winehq.org  Tue Jan 15 06:08:02 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 15 Jan 2008 13:08:02 +0100
Subject: [take 2] shell32: Check if token references the current user
In-Reply-To: <200801101958.m0AJwmmx016744@mailhost.geldorp.nl> (ge@gse.nl's
	message of "Thu, 10 Jan 2008 21:01:17 +0100")
References: <200801101958.m0AJwmmx016744@mailhost.geldorp.nl>
Message-ID: <87tzlfgul9.fsf@wine.dyndns.org>

ge at gse.nl writes:

> Incorporates feedback by Juan Lang
>
> Changelog:
>   Ge van Geldorp <ge at thinstall.com>

Please either put your full name in the mail headers, or include the
full git headers in the body of your message, so that my commit script
can grab your name and email automatically.

> @@ -1382,14 +1476,15 @@ static HRESULT _SHGetUserProfilePath(HANDLE hToken, DWORD dwFlags, BYTE folder,
>          return E_INVALIDARG;
>  
>      /* Only the current user and the default user are supported right now
> -     * I'm afraid.
> +     * I'm afraid. We do handle the case where the token references the
> +     * current user.
>       * FIXME: should be able to call GetTokenInformation on the token,
>       * then call ConvertSidToStringSidW on it to get the user prefix.
>       * But Wine's registry doesn't store user info by sid, it stores it
>       * by user name (and I don't know how to convert from a token to a
>       * user name).

This comment is obsolete, we store the registry by sid now, so this is
what you should use to open the user's key.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Tue Jan 15 06:17:11 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 15 Jan 2008 13:17:11 +0100
Subject: [advapi32] QueryServiceConfig2 (2nd try)
In-Reply-To: <200801102234.56883.Stefan.Leichter@camline.com> (Stefan
	Leichter's message of "Thu, 10 Jan 2008 22:34:56 +0100")
References: <200801102234.56883.Stefan.Leichter@camline.com>
Message-ID: <87myr7gu60.fsf@wine.dyndns.org>

Stefan Leichter <Stefan.Leichter at camline.com> writes:

> + * Note
> + *   observed unter win2k:
> + *   1. when the function is called to get the required buffer size, the value of
> + *   the returned parameter needed is big enough to hold the strings as WCHARs(!)

It's not WCHARs, it's two A chars per W char to leave enough room for
the conversion. I don't see you doing that in the code.

> +        case SERVICE_CONFIG_DESCRIPTION:
> +            {   LPSERVICE_DESCRIPTIONA configA = (LPSERVICE_DESCRIPTIONA) buffer;
> +                LPSERVICE_DESCRIPTIONW configW = (LPSERVICE_DESCRIPTIONW) bufferW;
> +                *needed = sizeof(SERVICE_DESCRIPTIONA);
> +                if (configW->lpDescription) {
> +                    DWORD sz;
> +                    configA->lpDescription = (LPSTR)(configA + 1);
> +                    sz = WideCharToMultiByte( CP_ACP, 0, configW->lpDescription, -1,
> +                             configA->lpDescription, size - sizeof(SERVICE_DESCRIPTIONA), NULL, NULL );
> +                    if (!sz) {
> +                        FIXME("WideCharToMultiByte failed for configW->lpDescription\n");
> +                        ret = FALSE;
> +                        configA->lpDescription = NULL;
> +                        goto cleanup;

You need to update the needed size on buffer overflow.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Tue Jan 15 08:44:07 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 15 Jan 2008 06:44:07 -0800
Subject: Good source for msvcr71?
In-Reply-To: <00bd01c85752$31cf67b0$a600fea9@DMITRY>
References: <a71bd89a0801140822s75db446did3f9c8a1fa4e3ccf@mail.gmail.com>
	<00bd01c85752$31cf67b0$a600fea9@DMITRY>
Message-ID: <a71bd89a0801150644m385d5d8fvf9512fc04bbdfa03@mail.gmail.com>

On Jan 15, 2008 12:39 AM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> > Anyone know a better source [for msvcr71],
> > preferably at microsoft.com?
> > I'd like to add it to winetricks.
>
> ... it seems like Microsoft suggests to always distribute its own copy of
> msvcr71.dll with every application. That means that it's unlikely that
> Microsoft will provide an installer for it on microsoft.com.

Indeed.   But it means it's very likely that *some app* at microsoft.com
is bundled with it.

> Just an idea, can we build our mozilla dlls so that the build includes
> msvcr71.dll?

Sure, if we build gecko with visual studio 2003, it'll have to come with one.
We might also find ourselves needing to bundle a few more windows binaries
with Wine someday, and those might happen to require other redistributables
(e.g. mfc42).
- Dan


From dmitry at codeweavers.com  Tue Jan 15 08:55:23 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 15 Jan 2008 22:55:23 +0800
Subject: Good source for msvcr71?
References: <a71bd89a0801140822s75db446did3f9c8a1fa4e3ccf@mail.gmail.com><00bd01c85752$31cf67b0$a600fea9@DMITRY>
	<a71bd89a0801150644m385d5d8fvf9512fc04bbdfa03@mail.gmail.com>
Message-ID: <059c01c85786$a98bba40$a600fea9@DMITRY>

"Dan Kegel" <dank at kegel.com> wrote:

>> Just an idea, can we build our mozilla dlls so that the build includes
>> msvcr71.dll?
> 
> Sure, if we build gecko with visual studio 2003, it'll have to come with one.

cl.exe from the Vista PSDK produces .exe files with a MSVCR80.dll dependency,
perhaps a compiler bundled with one of older PSDKs created executables for
msvcr71.dll, or one of free microsoft compilers.

-- 
Dmitry.


From julliard at winehq.org  Tue Jan 15 09:26:55 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 15 Jan 2008 16:26:55 +0100
Subject: Good source for msvcr71?
In-Reply-To: <00bd01c85752$31cf67b0$a600fea9@DMITRY> (Dmitry Timoshkov's
	message of "Tue, 15 Jan 2008 16:39:44 +0800")
References: <a71bd89a0801140822s75db446did3f9c8a1fa4e3ccf@mail.gmail.com>
	<00bd01c85752$31cf67b0$a600fea9@DMITRY>
Message-ID: <87ir1vglds.fsf@wine.dyndns.org>

"Dmitry Timoshkov" <dmitry at codeweavers.com> writes:

> So, it seems like Microsoft suggests to always distribute its own copy of
> msvcr71.dll with every application. That means that it's unlikely that
> Microsoft will provide an installer for it on microsoft.com.
>
> Just an idea, can we build our mozilla dlls so that the build includes
> msvcr71.dll?

There's no need for that, it should be fairly easy to write a builtin
msvcr71.

-- 
Alexandre Julliard
julliard at winehq.org


From ian at ianmacfarlane.com  Tue Jan 15 08:58:45 2008
From: ian at ianmacfarlane.com (Ian Macfarlane)
Date: Tue, 15 Jan 2008 14:58:45 +0000
Subject: WWN license issue
Message-ID: <aac02a530801150658o2f335dfagcbf16a5dd8f6a43a@mail.gmail.com>

At the bottom of each WWN issue (for example, the latest
http://www.winehq.org/?issue=339) is the text:

"All Kernel Cousin issues and summaries are copyright their original
authors, and distributed under the terms of the GNU General Public
License, version 2.0. "

However, it links to http://www.gnu.org/licenses/gpl.txt which of
course is now the GPLv3 license text.

Perhaps the text should change to say version 3 (or perhaps version
2+), or to the old archived GPLv2 license (IMO the former two options
are preferable).


From tony.wasserka at freenet.de  Tue Jan 15 09:55:18 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Tue, 15 Jan 2008 16:55:18 +0100
Subject: d3dx9: Start implementation of d3dx9_36
Message-ID: <E1JEo8E-0005Gd-4H@www20.emo.freenet-rz.de>

What's wrong with it this time?
Thought that it was okay this time :D











From saulius2 at ar.fi.lt  Tue Jan 15 10:38:54 2008
From: saulius2 at ar.fi.lt (Saulius Krasuckas)
Date: Tue, 15 Jan 2008 18:38:54 +0200 (EET)
Subject: advpack: Skip some tests if not in interactive mode because they
	pop up dialogs.
In-Reply-To: <Pine.LNX.4.64.0711132049010.3923@amboise.dolphin>
References: <Pine.LNX.4.64.0711132049010.3923@amboise.dolphin>
Message-ID: <Pine.LNX.4.62.0801151836400.26019@tvarka.ar.fi.lt>

* On Tue, 13 Nov 2007, Francois Gouget wrote:
> 
> This was causing the advpack:install test to time out on my Win98, WinXP 
> and Win2003 VMs.

Would it be nice to create some closer-thread for closing poped up dialogs 
in places of code known for that behaviour?  (Probably, for non 
interactive mode only)


From dank at kegel.com  Tue Jan 15 12:32:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 15 Jan 2008 10:32:18 -0800
Subject: Tools: Spelling fixes
Message-ID: <a71bd89a0801151032t4da1109eo6298aa4256f1585b@mail.gmail.com>

Austin wrote:

>    only used for optimization, so just check for a very small set of
>-   criteria that guarantee the types are equivalent; assume every thing
>+   criteria that guarantees the types are equivalent; assume everything

The original was correct, please don't change that.
Firstly, it's not a spelling problem;
secondly, in England, it's correct to consider a set of something plural.

The rest of the changes in this patch seem ok.
- Dan


From zgold550 at gmail.com  Tue Jan 15 14:20:25 2008
From: zgold550 at gmail.com (Zachary Goldberg)
Date: Tue, 15 Jan 2008 15:20:25 -0500
Subject: WWN license issue
In-Reply-To: <aac02a530801150658o2f335dfagcbf16a5dd8f6a43a@mail.gmail.com>
References: <aac02a530801150658o2f335dfagcbf16a5dd8f6a43a@mail.gmail.com>
Message-ID: <b050a5e70801151220s6dcc3efpc379138fa63867ac@mail.gmail.com>

On Jan 15, 2008 9:58 AM, Ian Macfarlane <ian at ianmacfarlane.com> wrote:
> At the bottom of each WWN issue (for example, the latest
> http://www.winehq.org/?issue=339) is the text:
>
> "All Kernel Cousin issues and summaries are copyright their original
> authors, and distributed under the terms of the GNU General Public
> License, version 2.0. "
>
> However, it links to http://www.gnu.org/licenses/gpl.txt which of
> course is now the GPLv3 license text.
>
> Perhaps the text should change to say version 3 (or perhaps version
> 2+), or to the old archived GPLv2 license (IMO the former two options
> are preferable).
>
>
>

for the record: I have no personal preference on the license.
Whatever the WineHQ admins decide on the issue is fine with me.

-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From jnewman at codeweavers.com  Tue Jan 15 14:33:41 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Tue, 15 Jan 2008 14:33:41 -0600
Subject: WWN license issue
In-Reply-To: <b050a5e70801151220s6dcc3efpc379138fa63867ac@mail.gmail.com>
References: <aac02a530801150658o2f335dfagcbf16a5dd8f6a43a@mail.gmail.com>
	<b050a5e70801151220s6dcc3efpc379138fa63867ac@mail.gmail.com>
Message-ID: <478D18A5.9050006@codeweavers.com>

I'll patch it so it points to the GPL v2 licence, unless someone feels 
there is a reason it needs to be v3.

Zachary Goldberg wrote:
> On Jan 15, 2008 9:58 AM, Ian Macfarlane <ian at ianmacfarlane.com> wrote:
>> At the bottom of each WWN issue (for example, the latest
>> http://www.winehq.org/?issue=339) is the text:
>>
>> "All Kernel Cousin issues and summaries are copyright their original
>> authors, and distributed under the terms of the GNU General Public
>> License, version 2.0. "
>>
>> However, it links to http://www.gnu.org/licenses/gpl.txt which of
>> course is now the GPLv3 license text.
>>
>> Perhaps the text should change to say version 3 (or perhaps version
>> 2+), or to the old archived GPLv2 license (IMO the former two options
>> are preferable).
>>
>>
>>
> 
> for the record: I have no personal preference on the license.
> Whatever the WineHQ admins decide on the issue is fine with me.
> 


From fgouget at free.fr  Tue Jan 15 16:23:08 2008
From: fgouget at free.fr (Francois Gouget)
Date: Tue, 15 Jan 2008 23:23:08 +0100 (CET)
Subject: SVN usage for Wine
In-Reply-To: <478AAA86.9000902@sprintpcs.com>
References: <478977BA.6070302@earthlink.net> <478A53E1.8050002@codeweavers.com>
	<478AAA86.9000902@sprintpcs.com>
Message-ID: <alpine.DEB.0.999999.0801152320040.8935@amboise.dolphin>

On Sun, 13 Jan 2008, James McKenzie wrote:
[...]
> Where are you getting your git code from and does it require any patches 
> to make it compile and run on MacOSX 10.4?

Rob probably installed his Git from Fink.
I've installed mine using MacPorts. Here's the recipe in case you're 
interested:

---
MacPorts needs Xcode because it installs applications from the source. 
So make sure Xcode is installed first. Because it compiles applications 
from source it can take a bit.

Then grab the Mac OS X Package Installer from 
http://www.macports.org/install.php and follow the installation 
instructions on that page.

Once that's done you can install git with the following command:

$ sudo port -v install git-core

Because Git uses Ssh, MacPorts also installed its own Ssh version which 
unfortunately was buggy. If this happens to you, delete (or rename) scp, 
slogin and ssh in /opt/local/bin.
---

The part about ssh may be why you had stability problems with Git. As 
far as I can tell my workaround works just fine.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                           La terre est une b


From fgouget at free.fr  Tue Jan 15 17:03:06 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 16 Jan 2008 00:03:06 +0100 (CET)
Subject: Towards Zero Test Suite Failures
In-Reply-To: <200801141914.10423.stefan@codeweavers.com>
References: <a71bd89a0801131553k305c3cf8x655c7f0b1dbb8ff1@mail.gmail.com>
	<a71bd89a0801132150w71bfa479v27af0f20949d4f71@mail.gmail.com>
	<3f4fd2640801140541i3cbb8a0i3f34b0903d7cb360@mail.gmail.com>
	<200801141914.10423.stefan@codeweavers.com>
Message-ID: <alpine.DEB.0.999999.0801152327090.8935@amboise.dolphin>

On Mon, 14 Jan 2008, Stefan D?singer wrote:

> Am Montag, 14. Januar 2008 14:41:35 schrieb Reece Dunn:
> > But if you fix a test failure in Wine that is failing on Windows, then
> > you are introducing a bug in Wine.
> Not necessarily. Some tests are too strict in what they expect, and sometimes 
> the Windows behavior is "wrong", in the way that some application expects 
> something different and wouldn't run on this Windows installation either.

But the only way to know is to check the Windows results. So while 
you're doing that you can as well try to fix the test on Windows.


[...]
> This Examples of "broken" Windows installations are VMware 
> installations with Direct3D support enabled. VMWare has a D3D driver 
> that works similarly to Wine, but has a few bugs that our tests 
> stumble uppon.

<rant>

This gets mentioned *every single time*.

For what it's worth, as far as I know none of the tests I run (the 
'fg-xxx' ones) has that D3D driver you speak of.

They still have failures in the Direct3D tests but if you check the 
Windows XP results, you will see that my logs show only two Direct3D 
tests failing. That's very little compared to the 73 other tests that 
fail... for the Windows XP results alone.

So I'd like people to focus a little bit less on these two Direct3D 
failures and a little bit more on the 73 other failures. That the tests 
are being run in VMware is no excuse for not looking at them. If these 
73 failing tests were fixed that would be a huge step for the 
conformance test suite.

</rant>

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                 There are 10 types of people in the world...
               those who understand binary and those who don't.

From fgouget at free.fr  Tue Jan 15 17:10:36 2008
From: fgouget at free.fr (Francois Gouget)
Date: Wed, 16 Jan 2008 00:10:36 +0100 (CET)
Subject: advpack: Skip some tests if not in interactive mode because they
	pop up dialogs.
In-Reply-To: <Pine.LNX.4.62.0801151836400.26019@tvarka.ar.fi.lt>
References: <Pine.LNX.4.64.0711132049010.3923@amboise.dolphin>
	<Pine.LNX.4.62.0801151836400.26019@tvarka.ar.fi.lt>
Message-ID: <alpine.DEB.0.999999.0801160008220.8935@amboise.dolphin>

On Tue, 15 Jan 2008, Saulius Krasuckas wrote:

> * On Tue, 13 Nov 2007, Francois Gouget wrote:
> > 
> > This was causing the advpack:install test to time out on my Win98, WinXP 
> > and Win2003 VMs.
> 
> Would it be nice to create some closer-thread for closing poped up dialogs 
> in places of code known for that behaviour?  (Probably, for non 
> interactive mode only)

I'm not sure. It seems like it would be complex and probably quite 
fragile (e.g. wrt to language issues).

I'd rather have the tests not pop up any windows at all, though that's 
clearly a lost cause.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
             Research is the transformation of money to knowledge.
            Innovation is the transformation of knowledge to money.
                              -- Dr. Hans Meixner


From mark.hatsell at btinternet.com  Tue Jan 15 17:29:02 2008
From: mark.hatsell at btinternet.com (Mark Hatsell)
Date: Tue, 15 Jan 2008 23:29:02 -0000
Subject: Status of d3d in a child window?
Message-ID: <fmjfk1$1i4$1@ger.gmane.org>

Hello All

I was just wondering what the status was of D3D in a child window. Looking 
back at the release info it seems that the OpenGL in a child window has been 
sorted and that D3D has been converted to use WGL. Is this not enough to get 
D3D in a child window going?

I have tried the mfctex sample but it draws the D3D child window in slightly 
the wrong place and doesn't render anything at all. I have also tried a 
couple of other apps which also exhibit similar behaviour.

Just wondered what else needed fixing before this would work?

Thanks
Mark





From dank at kegel.com  Tue Jan 15 20:18:14 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 15 Jan 2008 18:18:14 -0800
Subject: Valgrinding large win32 app worked!
Message-ID: <a71bd89a0801151818n53c98b2i566afe3b0f94c166@mail.gmail.com>

This script,
http://kegel.com/wine/valgrind/valgrind-330-build.sh
builds a copy of valgrind-3.3.0 with
John Reiser's forward port of the Wine support patch.
With that, I can run Picasa for Windows under Wine under Valgrind.
It takes 40 seconds to start up on my 1.3GHz Athlon 64,
which is right in line with Valgrind's legendary ~10x overhead.

It seemed to find lots of little problems, but since there
were lots of numeric addresses without symbolic info in the
valgrind log, it wasn't directly useful to the Picasa developers.

The next step, I suppose, is to find a way to make the valgrind
log contain symbolic identifiers for the functions in the Windows app.
I looked at that for a few minutes; here are some notes that
might provide a starting point.

http://www.debuginfo.com/articles/gendebuginfo.html is the best
overview I've seen so far on how to tell Visual C++ to generate
debugging info; for most apps, the preferred debug info format will be .pdb.

http://www.debuginfo.com/articles/dbghelptypeinfo.html has an example
win32 app that will dump all public symbols from a win32 app.
It runs fine on Windows XP, and can dump symbols for Picasa
(generating a 9MB text file).  (I happen to have the .pdb file for Picasa
handy since I are an honorary Picasa developer.)
Sadly, that symbol dumper crashes on Wine, see
http://bugs.winehq.org/show_bug.cgi?id=11211

Also,  the unresolved error addresses in the valgrind trace were mostly
in the 0x400000 - 0x420000 range, whereas the symbols dumped
by that dumper app were all in the range 0x1000000 - 0x1080000...
maybe the base load address is different between the two OS's.
I haven't tried valgrinding a toy app yet, but that's probably the easiest
way to figure out how to match the symbols up.
- Dan


From winehacker at gmail.com  Tue Jan 15 23:08:26 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Wed, 16 Jan 2008 00:08:26 -0500
Subject: Towards Zero Test Suite Failures
In-Reply-To: <alpine.DEB.0.999999.0801152327090.8935@amboise.dolphin>
References: <a71bd89a0801131553k305c3cf8x655c7f0b1dbb8ff1@mail.gmail.com>
	<a71bd89a0801132150w71bfa479v27af0f20949d4f71@mail.gmail.com>
	<3f4fd2640801140541i3cbb8a0i3f34b0903d7cb360@mail.gmail.com>
	<200801141914.10423.stefan@codeweavers.com>
	<alpine.DEB.0.999999.0801152327090.8935@amboise.dolphin>
Message-ID: <19e31a080801152108y3122c9e8we6129628f4549b8@mail.gmail.com>

On Jan 15, 2008 6:03 PM, Francois Gouget <fgouget at free.fr> wrote:
> > This Examples of "broken" Windows installations are VMware
> > installations with Direct3D support enabled. VMWare has a D3D driver
> > that works similarly to Wine, but has a few bugs that our tests
> > stumble uppon.
>
> <rant>
>
> This gets mentioned *every single time*.
>
> For what it's worth, as far as I know none of the tests I run (the
> 'fg-xxx' ones) has that D3D driver you speak of.
>
> They still have failures in the Direct3D tests but if you check the
> Windows XP results, you will see that my logs show only two Direct3D
> tests failing. That's very little compared to the 73 other tests that
> fail... for the Windows XP results alone.
>
> So I'd like people to focus a little bit less on these two Direct3D
> failures and a little bit more on the 73 other failures. That the tests
> are being run in VMware is no excuse for not looking at them. If these
> 73 failing tests were fixed that would be a huge step for the
> conformance test suite.
>
> </rant>

+1

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Tue Jan 15 23:24:22 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 15 Jan 2008 21:24:22 -0800
Subject: Time to create a stub wmvcore.dll?
Message-ID: <a71bd89a0801152124y5f923f18r4ec41577aa7ca475@mail.gmail.com>

There seem to be a large number of apps that don't
start unless a wmvcore.dll is present:
 TVersity
 Phatnoise
 Lost Planet
 The Bard's Tale
 WMA Workshop
 MixMeister
 ...
So, how 'bout it?  Should we create a stub for wmvcore.dll and friends?
- Dan


From stefan at codeweavers.com  Wed Jan 16 01:17:57 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 16 Jan 2008 08:17:57 +0100
Subject: Status of d3d in a child window?
In-Reply-To: <fmjfk1$1i4$1@ger.gmane.org>
References: <fmjfk1$1i4$1@ger.gmane.org>
Message-ID: <200801160817.57209.stefan@codeweavers.com>

Am Mittwoch, 16. Januar 2008 00:29:02 schrieb Mark Hatsell:
> Hello All
>
> I was just wondering what the status was of D3D in a child window. Looking
> back at the release info it seems that the OpenGL in a child window has
> been sorted and that D3D has been converted to use WGL. Is this not enough
> to get D3D in a child window going?
Yes

> I have tried the mfctex sample but it draws the D3D child window in
> slightly the wrong place and doesn't render anything at all. I have also
> tried a couple of other apps which also exhibit similar behaviour.
>
> Just wondered what else needed fixing before this would work?
Which video card and driver do you have? The child window code has quite a few 
requirements, and it uses some AIGLX and Compositing features.


From luis.busquets at ilidium.com  Wed Jan 16 01:18:32 2008
From: luis.busquets at ilidium.com (luis.busquets at ilidium.com)
Date: Wed, 16 Jan 2008 08:18:32 +0100 (CET)
Subject: GDI32.dll.NamedEscape
In-Reply-To: <478BD8BC.1020305@codeweavers.com>
References: <478BD7DE.4000507@ilidium.com> <478BD8BC.1020305@codeweavers.com>
Message-ID: <41011.158.169.9.14.1200467912.squirrel@www.ilidium.com>

No. I am not using any native dll.

The program to install hangs the moment I pres the button "Install" and
aborts saying that:

wine: Call from 0x73ba1895 to unimplemented function
GDI32.dll.NamedEscape, aborting


> Luis C. Busquets P?rez wrote:
>> I am having problems with a bunch of three games that came together in
>> the same pack. They all abort qhen asking for installation with the
>> following line
>>
>> wine: Call from 0x73ba1895 to unimplemented function
>> GDI32.dll.NamedEscape, aborting
>>
>> Does anybody know what GDI32.dll.NamedEscape does?
>>
>
> It appears to be undocumented. Are you using some native DLLs by any
> chance?
>
> --
> Rob Shearman
>
>




From dmitry at codeweavers.com  Wed Jan 16 01:23:45 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 16 Jan 2008 15:23:45 +0800
Subject: GDI32.dll.NamedEscape
References: <478BD7DE.4000507@ilidium.com> <478BD8BC.1020305@codeweavers.com>
	<41011.158.169.9.14.1200467912.squirrel@www.ilidium.com>
Message-ID: <002b01c85810$bca30360$a600fea9@DMITRY>

<luis.busquets at ilidium.com> wrote:

> No. I am not using any native dll.
> 
> The program to install hangs the moment I pres the button "Install" and
> aborts saying that:
> 
> wine: Call from 0x73ba1895 to unimplemented function
> GDI32.dll.NamedEscape, aborting

I'd suggest to open a bug for this and attach there full output of an attempt
to run the application.

-- 
Dmitry.


From thunderbird2k at gmx.net  Wed Jan 16 04:20:13 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Wed, 16 Jan 2008 11:20:13 +0100
Subject: Status of d3d in a child window?
In-Reply-To: <200801160817.57209.stefan@codeweavers.com>
References: <fmjfk1$1i4$1@ger.gmane.org>
	<200801160817.57209.stefan@codeweavers.com>
Message-ID: <20080116102013.258840@gmx.net>

> Am Mittwoch, 16. Januar 2008 00:29:02 schrieb Mark Hatsell:
> > Hello All
> >
> > I was just wondering what the status was of D3D in a child window.
> Looking
> > back at the release info it seems that the OpenGL in a child window has
> > been sorted and that D3D has been converted to use WGL. Is this not
> enough
> > to get D3D in a child window going?
> Yes
> 
> > I have tried the mfctex sample but it draws the D3D child window in
> > slightly the wrong place and doesn't render anything at all. I have also
> > tried a couple of other apps which also exhibit similar behaviour.
> >
> > Just wondered what else needed fixing before this would work?
> Which video card and driver do you have? The child window code has quite a
> few 
> requirements, and it uses some AIGLX and Compositing features.
> 

Second not all 'child window rendering issues' are over. OpenGL/Direct3D apps that have a file menu and for the rest a 3D view, still don't work. I hope to fix those cases in the near future but the patch will affect ALL graphical programs on Wine, so that's why it requires a lot of testing (the patch is close but not yet done).

Roderick
-- 
GMX FreeMail: 1 GB Postfach, 5 E-Mail-Adressen, 10 Free SMS.
Alle Infos und kostenlose Anmeldung: http://www.gmx.net/de/go/freemail


From julliard at winehq.org  Wed Jan 16 06:24:39 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 16 Jan 2008 13:24:39 +0100
Subject: ntdll: Do not perform base relocation if an image is not a DLL
In-Reply-To: <E1JF0zL-0001qf-PD@mail.codeweavers.com> (Dmitry Timoshkov's
	message of "Wed, 16 Jan 2008 13:39:01 +0800")
References: <E1JF0zL-0001qf-PD@mail.codeweavers.com>
Message-ID: <87d4s23qm0.fsf@wine.dyndns.org>

Dmitry Timoshkov <dmitry at codeweavers.com> writes:

> Hello,
>
> this patch fixes the problem reported in the bug 11170. It appears that
> LoadLibrary in Windows doesn't attempt to relocate .exe files.
>
> Changelog:
>     ntdll: Do not perform base relocation if an image is not a DLL.

This will break the relocation of the main exe.

-- 
Alexandre Julliard
julliard at winehq.org


From kubrick at fgv6.net  Wed Jan 16 07:25:38 2008
From: kubrick at fgv6.net (kubrick at fgv6.net)
Date: Wed, 16 Jan 2008 14:25:38 +0100 (CET)
Subject: Suggestion to the list maintainer
Message-ID: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>

Hello.

I have many subscriptions to different mailing list with my email-address and I'd appreciate a lot to be able to identify a
message from this mailing list quickly by reading it's subject.
Could you please add a subject prefix like [WINE-DEVEL] in the mailman preferences ? It's very easy to do, so maybe there is a
good reason why you haven't done it yet...

Thanks.
Fran?ois.



From jnewman at codeweavers.com  Wed Jan 16 08:06:26 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Wed, 16 Jan 2008 08:06:26 -0600
Subject: Suggestion to the list maintainer
In-Reply-To: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
References: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
Message-ID: <478E0F62.8000902@codeweavers.com>

You can always filter the messages into a folder using the List-Id field 
in the message headers. It looks like this for the wine-devel list.

List-Id: Wine Developer's List <wine-devel.winehq.org>

kubrick at fgv6.net wrote:
> I have many subscriptions to different mailing list with my email-address and I'd appreciate a lot to be able to identify a
> message from this mailing list quickly by reading it's subject.
> Could you please add a subject prefix like [WINE-DEVEL] in the mailman preferences ? It's very easy to do, so maybe there is a
> good reason why you haven't done it yet...


From research at science.su  Wed Jan 16 08:12:08 2008
From: research at science.su (L. Rahyen)
Date: Wed, 16 Jan 2008 14:12:08 +0000
Subject: Suggestion to the list maintainer
In-Reply-To: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
References: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
Message-ID: <200801161412.08979.research@science.su>

On Wednesday January 16 2008 13:25:38 kubrick at fgv6.net wrote:
> Hello.
>
> I have many subscriptions to different mailing list with my email-address
> and I'd appreciate a lot to be able to identify a message from this mailing
> list quickly by reading it's subject.
> Could you please add a subject prefix like [WINE-DEVEL] in the mailman
> preferences ? It's very easy to do, so maybe there is a good reason why you
> haven't done it yet...

	Personally I detect messages for this list by searching for 
wine-devel at winehq.org in CC, From or To fields. That works perfectly. 
I use this method for all mailing lists and this always works.
	Adding a prefix is very ugly in my opinion and there is no good technical 
reason for that. Just set up your filters properly as I suggested and this 
will work without problems - for any mailing list.


From kubrick at fgv6.net  Wed Jan 16 08:28:07 2008
From: kubrick at fgv6.net (kubrick at fgv6.net)
Date: Wed, 16 Jan 2008 15:28:07 +0100 (CET)
Subject: Suggestion to the list maintainer
In-Reply-To: <200801161412.08979.research@science.su>
References: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
	<200801161412.08979.research@science.su>
Message-ID: <53806.195.6.79.173.1200493687.squirrel@www.fgv6.net>

Thanks for your answers.

I already use such filters in my mail client, which sorts my mails when I launch it at home, a few times a week :) My problem
was that the rest of the time (most of the time in fact) I read my mails for Squirrelmail, which can not do such sorting unless
I have server-side filtering plugins installed.
But looking deeper in the options I've just found that "Messages Highlighting" based on CC/TO is fitting my needs. So let's
close this topic which is off-topic :)
Sorry for the noise.

Bye.
Fran?ois.

PS : I do find Subject prefixes ugly too... Bu I hadn't found a more handy solution.

> On Wednesday January 16 2008 13:25:38 kubrick at fgv6.net wrote:
>> Hello.
>>
>> I have many subscriptions to different mailing list with my email-address
>> and I'd appreciate a lot to be able to identify a message from this mailing
>> list quickly by reading it's subject.
>> Could you please add a subject prefix like [WINE-DEVEL] in the mailman
>> preferences ? It's very easy to do, so maybe there is a good reason why you
>> haven't done it yet...
>
> 	Personally I detect messages for this list by searching for
> wine-devel at winehq.org in CC, From or To fields. That works perfectly.
> I use this method for all mailing lists and this always works.
> 	Adding a prefix is very ugly in my opinion and there is no good technical
> reason for that. Just set up your filters properly as I suggested and this
> will work without problems - for any mailing list.
>




From dmitry at codeweavers.com  Wed Jan 16 08:39:35 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 16 Jan 2008 22:39:35 +0800
Subject: Request for patch removal
References: <478DAA25.10900@gmx.net>
Message-ID: <004d01c8584d$9f3759b0$a600fea9@DMITRY>

"Federico Vecchiarelli" <fedev at gmx.net> wrote:

> Ok, to the point. The patch mentioned below prohibits wine from running 
> any application which is inside someone else's folder, even if you have 
> access to it. In my case, I wanted to make one unique installation 
> available to several users. Because of this patch, there is no 
> workaround that could be implemented, forcing me to either run a script 
> changing the owner of the folders for every user as they want to use the 
> application or I have to make several copies of the software which will 
> put me in a difficult legal situation.

All the details about this problem you can find here:

http://bugs.winehq.org/show_bug.cgi?id=11112

-- 
Dmitry.


From kde at graph-ix.net  Wed Jan 16 08:43:29 2008
From: kde at graph-ix.net (Markus)
Date: Wed, 16 Jan 2008 15:43:29 +0100
Subject: Shader compiler GL error
Message-ID: <200801161543.29454.kde@graph-ix.net>

Hi,

while trying to fix the bug I posted a few days ago, the game's developer 
pointed out on request that the ingame shader issues are not related to the 
graphics card detection but more likely to a failing shader compilation.

They are using d3d9_33.dll for development and recommended to try with this 
version. I've thus removed all other versions of the library and also deleted 
the game's cached shaders. The game now crashes on startup with the following 
error:
fixme:d3d_surface:flush_to_framebuffer_drawpixels >>>>>>>>>>>>>>>>> 
GL_INVALID_VALUE (0x501) from glDrawPixels @ surface.c / 1061

If I use d3d9_31.dll instead, the shaders are compiled and the game starts but 
the water is again looking like a low-end fallback.

Any ideas on this?

Regards,
-- 
Markus


From paul.vriens.wine at gmail.com  Wed Jan 16 08:46:11 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 16 Jan 2008 15:46:11 +0100
Subject: Towards Zero Test Suite Failures
In-Reply-To: <a71bd89a0801140813v677cd2a5i5a046fcdc881be7d@mail.gmail.com>
References: <a71bd89a0801131553k305c3cf8x655c7f0b1dbb8ff1@mail.gmail.com>	<b050a5e70801132030u25c2c7c4uaa7aa6dcdd0baba8@mail.gmail.com>	<a71bd89a0801132150w71bfa479v27af0f20949d4f71@mail.gmail.com>	<3f4fd2640801140541i3cbb8a0i3f34b0903d7cb360@mail.gmail.com>
	<a71bd89a0801140813v677cd2a5i5a046fcdc881be7d@mail.gmail.com>
Message-ID: <478E18B3.3030804@gmail.com>

Dan Kegel wrote:
> Yep.  And at some point we should indeed make Windows XP
> the default personality in Wine.  Seems like a 1.0 kind of thing.

But that should be done way before 1.0 to overcome any regressions.

-- 
Cheers,

Paul.


From dank at kegel.com  Wed Jan 16 09:58:41 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 16 Jan 2008 07:58:41 -0800
Subject: Request for patch removal
Message-ID: <a71bd89a0801160758v3fb371f3p522dcf90cadb3df5@mail.gmail.com>

"Federico Vecchiarelli" <fedev at gmx.net> wrote:
> ... I wanted to make one unique installation
> available to several users. Because of this patch, there is no
> workaround that could be implemented, forcing me to either run a script
> changing the owner of the folders for every user as they want to use the
> application or I have to make several copies of the software which will
> put me in a difficult legal situation.

Since it seems from your description that
the users don't need to share a copy of the registry,
the solution is probably to do what Picasa for Linux
does, and just put symlinks to the installed files
into each user's .wine directory.  You will need to
write a little script that starts the app after
creating these links.   You can see how to do this
by installing Picasa and looking at /opt/picasa/bin/wrapper,
it does exactly this.
- Dan


From sbrown7 at umbc.edu  Wed Jan 16 10:01:55 2008
From: sbrown7 at umbc.edu (Steve Brown)
Date: Wed, 16 Jan 2008 11:01:55 -0500 (EST)
Subject: Request for patch removal
In-Reply-To: <004d01c8584d$9f3759b0$a600fea9@DMITRY>
References: <478DAA25.10900@gmx.net> <004d01c8584d$9f3759b0$a600fea9@DMITRY>
Message-ID: <Pine.LNX.4.64.0801161045430.22239@linux2.gl.umbc.edu>

On Wed, 16 Jan 2008, Dmitry Timoshkov wrote:

> "Federico Vecchiarelli" <fedev at gmx.net> wrote:
>
>> Ok, to the point. The patch mentioned below prohibits wine from running
>> any application which is inside someone else's folder, even if you have
>> access to it. In my case, I wanted to make one unique installation
>> available to several users. Because of this patch, there is no
>> workaround that could be implemented, forcing me to either run a script
>> changing the owner of the folders for every user as they want to use the
>> application or I have to make several copies of the software which will
>> put me in a difficult legal situation.
>
> All the details about this problem you can find here:
>
> http://bugs.winehq.org/show_bug.cgi?id=11112
>
> -- 
> Dmitry.

Allow me to add my voice on this subject.  I also would like the Wine 
developers to consider how to allow for this use case.  In a centrally 
administered environment, most users do not have write access to much of 
the local disk, and the administrator of the machine (root) sets up the 
environment for them (and normal users should not be allowed to muck with 
it).  I am administrator for a small group of folks here, and would switch 
to Linux only -- but there are still Windows-only programs that are 
critical for my users.  Wine would be a wonderful solution, if only wine 
could be installed in a central location (say, /usr/local) and the wine 
"registry" files could be shared, somehow, by all users on the machine 
(maybe by doing a union of ~/.wine and /usr/local/wine/whatever).

I see in the comments on this bug, that the concern is with multiple 
instances of wineserver running on the machine at one time -- that's not a 
major issue in the use case I envision.  The multiple wineservers would 
not be running at the same time (unless the install is on what Windows 
would call a Terminal Services Server -- a normal multi-user *nix 
machine).  I think that even just allowing for multiple login users on a 
local machine at different times would be sufficient for a lot of us.  If, 
say, ~/.wine was used as a replacement for HKLM\Current User and, say, 
/usr/local/wine/whatever was for the other registry hives and group 
policies, I think wine would be a lot closer to being a solution for those 
of us maintaining multi-user machines.

Steve Brown
Systems Administrator
UMBC Imaging Research Center
sbrown7 at umbc.edu


From thunderbird2k at gmx.net  Wed Jan 16 11:41:46 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Wed, 16 Jan 2008 18:41:46 +0100
Subject: Shader compiler GL error
In-Reply-To: <200801161543.29454.kde@graph-ix.net>
References: <200801161543.29454.kde@graph-ix.net>
Message-ID: <20080116174146.283450@gmx.net>

> the game's cached shaders. The game now crashes on startup with the
> following 
> error:
> fixme:d3d_surface:flush_to_framebuffer_drawpixels >>>>>>>>>>>>>>>>> 
> GL_INVALID_VALUE (0x501) from glDrawPixels @ surface.c / 1061

You should try running the app with '+d3d_surface' on. The fixme you show indicates a GL_INVALID_VALUE, this crash is either from glDrawPixels or a call before it as we don't have glError calls around each function. Likely some parameter to the function is invalid.

Roderick
-- 
GMX FreeMail: 1 GB Postfach, 5 E-Mail-Adressen, 10 Free SMS.
Alle Infos und kostenlose Anmeldung: http://www.gmx.net/de/go/freemail


From mark.hatsell at btinternet.com  Wed Jan 16 12:01:49 2008
From: mark.hatsell at btinternet.com (Mark Hatsell)
Date: Wed, 16 Jan 2008 18:01:49 -0000
Subject: Status of d3d in a child window?
References: <fmjfk1$1i4$1@ger.gmane.org>
	<200801160817.57209.stefan@codeweavers.com>
Message-ID: <fmlgqg$ji7$1@ger.gmane.org>

Thanks Stefan. I thought it should be possible.

I upgraded my NVidia driver and things are a lot better now. Incidentally, 
is there a known minimum graphics hardware and driver level to get this 
child window stuff working?

mfctex.exe now works OK, although the D3D child window still seems to be in 
slightly the wrong place (see http://www.hatsell.com/mfctex_screenshot.png). 
I also tried an MDI app that has a separate MDI child for each D3D window. 
This worked perfectly for the first child window but crashed out when 
opening a second child. Is this expected behavior at the moment?

Thanks
Mark


"Stefan D?singer" <stefan at codeweavers.com> wrote in message 
news:200801160817.57209.stefan at codeweavers.com...
> Am Mittwoch, 16. Januar 2008 00:29:02 schrieb Mark Hatsell:
>> Hello All
>>
>> I was just wondering what the status was of D3D in a child window. 
>> Looking
>> back at the release info it seems that the OpenGL in a child window has
>> been sorted and that D3D has been converted to use WGL. Is this not 
>> enough
>> to get D3D in a child window going?
> Yes
>
>> I have tried the mfctex sample but it draws the D3D child window in
>> slightly the wrong place and doesn't render anything at all. I have also
>> tried a couple of other apps which also exhibit similar behaviour.
>>
>> Just wondered what else needed fixing before this would work?
> Which video card and driver do you have? The child window code has quite a 
> few
> requirements, and it uses some AIGLX and Compositing features.
>
>
> 





From kde at graph-ix.net  Wed Jan 16 12:12:31 2008
From: kde at graph-ix.net (Markus)
Date: Wed, 16 Jan 2008 19:12:31 +0100
Subject: Shader compiler GL error
In-Reply-To: <20080116174146.283450@gmx.net>
References: <200801161543.29454.kde@graph-ix.net>
	<20080116174146.283450@gmx.net>
Message-ID: <200801161912.31518.kde@graph-ix.net>

On Wednesday 16 January 2008 18:41:46 you wrote:
> > the game's cached shaders. The game now crashes on startup with the
> > following
> > error:
> > fixme:d3d_surface:flush_to_framebuffer_drawpixels >>>>>>>>>>>>>>>>>
> > GL_INVALID_VALUE (0x501) from glDrawPixels @ surface.c / 1061
>
> You should try running the app with '+d3d_surface' on.

Here is (hopefully relevant) output with +d3d_surface set:

trace:d3d_surface:IWineD3DSurfaceImpl_LoadLocation Surface 0x4e8fdf0 is an 
onscreen surface
trace:d3d_surface:IWineD3DSurfaceImpl_LoadLocation 
(0x4e8fdf0)->(SFLAG_INDRAWABLE, (nil))
trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetPitch (0x4e8fdf0)
trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetPitch (0x4e8fdf0) Returning 6400
trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetPitch (0x4e8fdf0)
trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetPitch (0x4e8fdf0) Returning 6400
trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetContainer (This 0x4e8fdf0, riid 
{34d01b10-6f30-11d9-c687-00046142c14f}, ppContainer 0x1a9daa8)
trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetContainer Relaying to 
QueryInterface
trace:d3d_surface:surface_get_gl_buffer (0x4e8fdf0) : swapchain 0x4e7cc58
trace:d3d_surface:surface_get_gl_buffer Returning GL_BACK
trace:d3d_surface:flush_to_framebuffer_drawpixels Unlocking 0x405 buffer
trace:d3d_surface:flush_to_framebuffer_drawpixels glDrawBuffer call ok 
surface.c / 1015
fixme:d3d_surface:flush_to_framebuffer_drawpixels >>>>>>>>>>>>>>>>> 
GL_INVALID_VALUE (0x501) from glDrawPixels @ surface.c / 1061
trace:d3d_surface:flush_to_framebuffer_drawpixels glDrawBuffer(GL_BACK) call 
ok surface.c / 1087
trace:d3d_surface:IWineD3DSurfaceImpl_ModifyLocation 
(0x4e8fdf0)->(SFLAG_INDRAWABLE, TRUE)
trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetContainer (This 0x4e8fdf0, riid 
{34d01b10-6f30-11d9-c687-00046142c14f}, ppContainer 0x1a9dbc0)


Let me know if more info is needed.

-- 
Markus


From research at science.su  Wed Jan 16 12:57:52 2008
From: research at science.su (L. Rahyen)
Date: Wed, 16 Jan 2008 18:57:52 +0000
Subject: Request for patch removal
In-Reply-To: <Pine.LNX.4.64.0801161045430.22239@linux2.gl.umbc.edu>
References: <478DAA25.10900@gmx.net> <004d01c8584d$9f3759b0$a600fea9@DMITRY>
	<Pine.LNX.4.64.0801161045430.22239@linux2.gl.umbc.edu>
Message-ID: <200801161857.53546.research@science.su>

On Wednesday January 16 2008 16:01:55 Steve Brown wrote:
> I see in the comments on this bug, that the concern is with multiple
> instances of wineserver running on the machine at one time -- that's not a
> major issue in the use case I envision.  The multiple wineservers would
> not be running at the same time (unless the install is on what Windows
> would call a Terminal Services Server -- a normal multi-user *nix
> machine).

	In practice even if you have multiple wineservers running this isn't too big 
problem (however, it *is* a problem). In fact I have used this for my 
multiuser setup for years and never know about possibility of registry 
curruption. I even thought that there is no problems at all with multiple 
wineservers (in fact *noticeable* registry-related problems are quite rare in 
my case). Now I know that multiple wineservers don't work perfectly together 
and what was the cause of some registry-related problems in my setup. BTW, in 
my setup 3 users share some of WINE prefixes and some Windows programs work 
for all users simultaneously in one WINE prefix.
	Don't think that above means you can forget and ignore that bug! You cannot! 
It needs to be fixed and while it isn't fixed you may (and probably will) face 
with problems like overwriting the registry with older version. For example, 
one user may install program and then correctly shutdown wineserver (for 
example by closing all programs). This will write out registry files to disk. 
Then other user will do that too (without installing anything) and you (or 
user who installed a program) will lose all new registry keys created by the 
installer. Depending on the setup, wineserver can write to the registry and 
possibly overwrite changes made by other users - generally this can happen at 
any time.
	Technically this is very bad, but in practice it is possible to live with it 
if you and your users do not use registry very intensively and do not store 
there very important information. Especially this is true if your users 
rarely run wineservers simultaneously.
	However, if you and your users need 100% reliable setup don't even try! 
There is no locks of any kind so even if you think that your users 
will not run wineservers in WINE prefix at the same time - they still can do 
that, and this can lead to some loses in the registry. Theoretically you can 
create a lock by writing a wrapper script but use of locks is just another 
hack and will not solve the main problem anyway (use of multiple 
wineservers), it needs to be fixed properly.
	You can bypass the check by using symlinks if you *really* 
need this; if you unsure you can just try this and see if it works good enough 
for you and your users (feel free to ask me if you need more instructions or 
help with such setup). And of course don't forget to backup registry before 
trying...
	But remember that this is *strongly discouraged* practice for obvious 
reasons! This is exactly why the patch in question was committed. Therefore 
bypassing the security check is not recommended!
	We really need to fix that bug to allow reliable multiuser setups...


From julliard at winehq.org  Wed Jan 16 13:19:07 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 16 Jan 2008 20:19:07 +0100
Subject: autorun perhaps dangerous (Was: Wine release 0.9.53)
In-Reply-To: <47889BD1.3050200@open-vote.org> (Scott Ritchie's message of
	"Sat, 12 Jan 2008 02:52:01 -0800")
References: <20080111163604.EFD881E7146@wine.dyndns.org>
	<20080111164805.GA32539@suse.de> <47889BD1.3050200@open-vote.org>
Message-ID: <871w8h4lzo.fsf@wine.dyndns.org>

Scott Ritchie <scott at open-vote.org> writes:

> We might want to add an option for only executing these on wineboot.
> Hell, we might want to make this the default unless the user has a new
> Wine installation made with wineprefixcreate.
>
> As it is, this change might break things.

Any change might break things, that has never stopped us before ;-)

I agree we need a way to configure the Run entries to be able to remove
worms and other nuisances, but if running a legitimate app causes
trouble we want to fix it, not just force users to disable it; and the
way to find out about it is by running these entries and seeing what
happens.

Still, we don't need to debug it all at once, so I've disabled the Run
entries for now. This way we can first concentrate on fixing trouble
caused by services and RunOnce entries; but once this is done we
definitely want to enable them again.

-- 
Alexandre Julliard
julliard at winehq.org


From thunderbird2k at gmx.net  Wed Jan 16 13:31:51 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Wed, 16 Jan 2008 20:31:51 +0100
Subject: Shader compiler GL error
In-Reply-To: <200801161912.31518.kde@graph-ix.net>
References: <200801161543.29454.kde@graph-ix.net>
	<20080116174146.283450@gmx.net> <200801161912.31518.kde@graph-ix.net>
Message-ID: <20080116193151.250730@gmx.net>


-------- Original-Nachricht --------
> Datum: Wed, 16 Jan 2008 19:12:31 +0100
> Von: Markus <kde at graph-ix.net>
> An: "Roderick Colenbrander" <thunderbird2k at gmx.net>, wine-devel at winehq.org
> Betreff: Re: Shader compiler GL error

> On Wednesday 16 January 2008 18:41:46 you wrote:
> > > the game's cached shaders. The game now crashes on startup with the
> > > following
> > > error:
> > > fixme:d3d_surface:flush_to_framebuffer_drawpixels >>>>>>>>>>>>>>>>>
> > > GL_INVALID_VALUE (0x501) from glDrawPixels @ surface.c / 1061
> >
> > You should try running the app with '+d3d_surface' on.
> 
> Here is (hopefully relevant) output with +d3d_surface set:
> 
> trace:d3d_surface:IWineD3DSurfaceImpl_LoadLocation Surface 0x4e8fdf0 is an
> onscreen surface
> trace:d3d_surface:IWineD3DSurfaceImpl_LoadLocation 
> (0x4e8fdf0)->(SFLAG_INDRAWABLE, (nil))
> trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetPitch (0x4e8fdf0)
> trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetPitch (0x4e8fdf0) Returning
> 6400
> trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetPitch (0x4e8fdf0)
> trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetPitch (0x4e8fdf0) Returning
> 6400
> trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetContainer (This 0x4e8fdf0,
> riid 
> {34d01b10-6f30-11d9-c687-00046142c14f}, ppContainer 0x1a9daa8)
> trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetContainer Relaying to 
> QueryInterface
> trace:d3d_surface:surface_get_gl_buffer (0x4e8fdf0) : swapchain 0x4e7cc58
> trace:d3d_surface:surface_get_gl_buffer Returning GL_BACK
> trace:d3d_surface:flush_to_framebuffer_drawpixels Unlocking 0x405 buffer
> trace:d3d_surface:flush_to_framebuffer_drawpixels glDrawBuffer call ok 
> surface.c / 1015
> fixme:d3d_surface:flush_to_framebuffer_drawpixels >>>>>>>>>>>>>>>>> 
> GL_INVALID_VALUE (0x501) from glDrawPixels @ surface.c / 1061
> trace:d3d_surface:flush_to_framebuffer_drawpixels glDrawBuffer(GL_BACK)
> call 
> ok surface.c / 1087
> trace:d3d_surface:IWineD3DSurfaceImpl_ModifyLocation 
> (0x4e8fdf0)->(SFLAG_INDRAWABLE, TRUE)
> trace:d3d_surface:IWineD3DBaseSurfaceImpl_GetContainer (This 0x4e8fdf0,
> riid 
> {34d01b10-6f30-11d9-c687-00046142c14f}, ppContainer 0x1a9dbc0)
> 

You should get see what gets passed to glDrawPixels. According to the opengl man pages GL_INVALID_VALUE can occur if e.g. the dimensions are invalid. If these are indeed invalid, you need to figure out why they are wrong (I see that the pitch is 6400, which could mean a width of 1600 assuming bpp=4)

Roderick
-- 
GMX FreeMail: 1 GB Postfach, 5 E-Mail-Adressen, 10 Free SMS.
Alle Infos und kostenlose Anmeldung: http://www.gmx.net/de/go/freemail


From stefandoesinger at gmx.at  Wed Jan 16 13:47:03 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 16 Jan 2008 20:47:03 +0100
Subject: Request for patch removal
In-Reply-To: <200801161857.53546.research@science.su>
References: <478DAA25.10900@gmx.net>
	<Pine.LNX.4.64.0801161045430.22239@linux2.gl.umbc.edu>
	<200801161857.53546.research@science.su>
Message-ID: <200801162047.03783.stefandoesinger@gmx.at>

Am Mittwoch, 16. Januar 2008 19:57:52 schrieb L. Rahyen:
> 	We really need to fix that bug to allow reliable multiuser setups...
Maybe the proper solution is one wineserver running globally, as a special 
user("wine", "root" or whatever), started at system boot. A global registry 
and dosdevice setup somewhere in /etc/, the fake C drive global, just the 
user.reg in every user's home. The wine instances started by the user connect 
to wineserver then, etc.

However, if we do this, we'll have to care for security. We need 
authentication, secure IPC, secure resource handle access, provide security 
updates, etc. Currently, we do not care much about security, and as a 
consequence, we do not give any code of wine any special privileges, so Wine 
is not a security thread(Other than allowing Viruses to run, but that is 
inherent to its functionality).

But dealing with security requires manpower. We have to implement all this, 
audit the code, etc. Wine is already a huge effort, and we're starving of 
manpower. I think the existing manpower is better spent at improving our 
Windows API implementation instead of diving into security hell. Patches are 
welcome though ;-)

*** snip ***

I once used the following setup:

*) A shared C drive(/opt/windows), owned by a special user wine
*) A shared ~/.wine in /etc/wine, owned by user wine.
*) A private ~/.wine in each user's home
*) dosdevices, system.reg and userdef.reg symlinked from /etc/wine to ~/.wine
*) A private user.reg for each user
*) C:\windows\profiles\($USER) symlinked to a folder in the user's home

The shared files(/opt/windows, /etc/wine) were read-only for everyone except 
wine. This way, each user had his own HKEY_CURRENT_USER, and I shared 
HKEY_LOCAL_MACHINE and the application installation directory among all 
users. HKEY_LOCAL_MACHINE was even write protected for all but by 
administrator wine user. Every user could modify it, but wineserver would 
fail to write the changes to system.reg, so the changes weren't persistent. 
No overwriting of registry files across accounts was possible because the 
shared files were write protected, and user.reg was private for each user.

For well-behaved apps this worked like a charm. Each user could safe his own 
preferences and was protected against accidentally messing up the 
installation. However, I eventually dropped that setup because it was a pain 
with games and many other apps, and I am in fact using my machines alone, so 
a multiuser setup was pointless. The catch compared to real multiuser support 
was that Windows processes belonging to different users could not see each 
other, and no IPC was possible across users. Furthermore the initial setting 
was tricky.


From kde at graph-ix.net  Wed Jan 16 14:20:30 2008
From: kde at graph-ix.net (Markus)
Date: Wed, 16 Jan 2008 21:20:30 +0100
Subject: Shader compiler GL error
In-Reply-To: <20080116193151.250730@gmx.net>
References: <200801161543.29454.kde@graph-ix.net>
	<200801161912.31518.kde@graph-ix.net>
	<20080116193151.250730@gmx.net>
Message-ID: <200801162120.30996.kde@graph-ix.net>

On Wednesday 16 January 2008 20:31:51 you wrote:
> > fixme:d3d_surface:flush_to_framebuffer_drawpixels >>>>>>>>>>>>>>>>>
> > GL_INVALID_VALUE (0x501) from glDrawPixels @ surface.c / 1061
>
> You should get see what gets passed to glDrawPixels. According to the
> opengl man pages GL_INVALID_VALUE can occur if e.g. the dimensions are
> invalid. If these are indeed invalid, you need to figure out why they are
> wrong (I see that the pitch is 6400, which could mean a width of 1600
> assuming bpp=4)

This is a trace of the variables used to create the glDrawPixels call:

trace:d3d_surface:flush_to_framebuffer_drawpixels right 0, left 0, bottom 0, 
top 0, mem 0x5db0040, bpp 4, pitch 6400

I assume GL is complaining because the rectangle passed to it has a size of 
(0,-1).

Adding a simple right>left and bottom>top condition at least resolves this 
error. However, whether that is correctly emulating D3D behavior, I don't 
know.

-- 
Markus


From eric.pouech at orange.fr  Wed Jan 16 14:25:43 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Wed, 16 Jan 2008 21:25:43 +0100
Subject: Valgrinding large win32 app worked!
In-Reply-To: <a71bd89a0801151818n53c98b2i566afe3b0f94c166@mail.gmail.com>
References: <a71bd89a0801151818n53c98b2i566afe3b0f94c166@mail.gmail.com>
Message-ID: <478E6847.7020809@orange.fr>

Dan Kegel a ?crit :
> This script,
> http://kegel.com/wine/valgrind/valgrind-330-build.sh
> builds a copy of valgrind-3.3.0 with
> John Reiser's forward port of the Wine support patch.
> With that, I can run Picasa for Windows under Wine under Valgrind.
> It takes 40 seconds to start up on my 1.3GHz Athlon 64,
> which is right in line with Valgrind's legendary ~10x overhead.
>
> It seemed to find lots of little problems, but since there
> were lots of numeric addresses without symbolic info in the
> valgrind log, it wasn't directly useful to the Picasa developers.
>
> The next step, I suppose, is to find a way to make the valgrind
> log contain symbolic identifiers for the functions in the Windows app.
> I looked at that for a few minutes; here are some notes that
> might provide a starting point.
>
> http://www.debuginfo.com/articles/gendebuginfo.html is the best
> overview I've seen so far on how to tell Visual C++ to generate
> debugging info; for most apps, the preferred debug info format will be .pdb.
>
> http://www.debuginfo.com/articles/dbghelptypeinfo.html has an example
> win32 app that will dump all public symbols from a win32 app.
> It runs fine on Windows XP, and can dump symbols for Picasa
> (generating a 9MB text file).  (I happen to have the .pdb file for Picasa
> handy since I are an honorary Picasa developer.)
> Sadly, that symbol dumper crashes on Wine, see
> http://bugs.winehq.org/show_bug.cgi?id=11211
>
> Also,  the unresolved error addresses in the valgrind trace were mostly
> in the 0x400000 - 0x420000 range, whereas the symbols dumped
> by that dumper app were all in the range 0x1000000 - 0x1080000...
> maybe the base load address is different between the two OS's.
> I haven't tried valgrinding a toy app yet, but that's probably the easiest
> way to figure out how to match the symbols up.
the hard part is not about understanding the .pdb format
our winedump already does it !!
and dbghelp supports coff and .pdb debug information (less tested than 
stabs and dwarf2 of course)

the hard part is to tell valgrind about information about modules it 
doesn't know of:
- it doesn't know about the loading of the module (it's seen by vg as a 
simple mmap)
- it doesn't know about the PE native debug information (whatever it is)

the simplest approach would be to somehow:
- use the --db-attach option in vg to hook to a debugger on every error 
(one hurdle is that valgrind doesn't allow both trace-children and 
db-attach)
- then use winedbg to get a backtrace (or similar info) from the running 
program (winedbg will be able to get to both .pdb and dwarf debug info)

the ultimate goal is rather to ask vg to support new messages about:
- loading / unloading modules
- having external .so files to understand more detailed information, and 
implement in them pdb and coff support

btw: the bug (11211) is rather strange. the crash occurs while loading 
dwarf information, not pdb. Does it occurs in every usage of winedbg ?

A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From research at science.su  Wed Jan 16 14:32:05 2008
From: research at science.su (L. Rahyen)
Date: Wed, 16 Jan 2008 20:32:05 +0000
Subject: Request for patch removal
In-Reply-To: <200801162047.03783.stefandoesinger@gmx.at>
References: <478DAA25.10900@gmx.net> <200801161857.53546.research@science.su>
	<200801162047.03783.stefandoesinger@gmx.at>
Message-ID: <200801162032.06088.research@science.su>

On Wednesday January 16 2008 19:47:03 Stefan D?singer wrote:
> Am Mittwoch, 16. Januar 2008 19:57:52 schrieb L. Rahyen:
> > 	We really need to fix that bug to allow reliable multiuser setups...
>
> Maybe the proper solution is one wineserver running globally, as a special
> user("wine", "root" or whatever), started at system boot. A global registry
> and dosdevice setup somewhere in /etc/, the fake C drive global, just the
> user.reg in every user's home. The wine instances started by the user
> connect to wineserver then, etc.

	This is probably good way to solve the problem. However it seems to me that 
it will require a lot of effort to implement this properly and reliably.

> However, if we do this, we'll have to care for security. We need
> authentication, secure IPC, secure resource handle access, provide security
> updates, etc. Currently, we do not care much about security, and as a
> consequence, we do not give any code of wine any special privileges, so
> Wine is not a security thread(Other than allowing Viruses to run, but that
> is inherent to its functionality).
>
> But dealing with security requires manpower. We have to implement all this,
> audit the code, etc. Wine is already a huge effort, and we're starving of
> manpower. I think the existing manpower is better spent at improving our
> Windows API implementation instead of diving into security hell. Patches
> are welcome though ;-)

	I agree with you here. In fact this isn't too big problem (at least for me). 
But this bug probably should be solved for version 1.1 (for 1.0 we already 
have a lot of other bugs to fix).


From dank at kegel.com  Wed Jan 16 15:53:52 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 16 Jan 2008 13:53:52 -0800
Subject: Valgrinding large win32 app worked!
In-Reply-To: <478E6847.7020809@orange.fr>
References: <a71bd89a0801151818n53c98b2i566afe3b0f94c166@mail.gmail.com>
	<478E6847.7020809@orange.fr>
Message-ID: <a71bd89a0801161353y70dfc4a4h75035ecf5c11f709@mail.gmail.com>

On Jan 16, 2008 12:25 PM, Eric Pouech <eric.pouech at orange.fr> wrote:
> btw: the bug (11211) is rather strange. the crash occurs while loading
> dwarf information, not pdb. Does it occurs in every usage of winedbg ?

I'm not sure.  It happens lots, not just on this app.
I haven't looked into it at all.
- Dan


From dank06 at kegel.com  Wed Jan 16 15:55:11 2008
From: dank06 at kegel.com (Dan Kegel)
Date: Wed, 16 Jan 2008 13:55:11 -0800
Subject: Valgrinding large win32 app worked!
In-Reply-To: <478E6847.7020809@orange.fr>
References: <a71bd89a0801151818n53c98b2i566afe3b0f94c166@mail.gmail.com>
	<478E6847.7020809@orange.fr>
Message-ID: <a71bd89a0801161355j55326df3ub73f707ea9e74b7d@mail.gmail.com>

On Jan 16, 2008 12:25 PM, Eric Pouech <eric.pouech at orange.fr> wrote:
> the hard part is not about understanding the .pdb format
> our winedump already does it !!
> and dbghelp supports coff and .pdb debug information (less tested than
> stabs and dwarf2 of course)

That's good to hear.  I must have blinked :-)

> the hard part is to tell valgrind about information about modules it
> doesn't know of:
> - it doesn't know about the loading of the module (it's seen by vg as a
> simple mmap)
> - it doesn't know about the PE native debug information (whatever it is)
>
> the simplest approach would be to somehow:
> - use the --db-attach option in vg to hook to a debugger on every error
> (one hurdle is that valgrind doesn't allow both trace-children and
> db-attach)
> - then use winedbg to get a backtrace (or similar info) from the running
> program (winedbg will be able to get to both .pdb and dwarf debug info)
>
> the ultimate goal is rather to ask vg to support new messages about:
> - loading / unloading modules
> - having external .so files to understand more detailed information, and
> implement in them pdb and coff support

Thanks for the tips.  I don't suppose you'd have time to look at any
of this?  :-)
- Dan


From kai.blin at gmail.com  Wed Jan 16 16:17:44 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Wed, 16 Jan 2008 23:17:44 +0100
Subject: Request for patch removal
In-Reply-To: <200801162047.03783.stefandoesinger@gmx.at>
References: <478DAA25.10900@gmx.net> <200801161857.53546.research@science.su>
	<200801162047.03783.stefandoesinger@gmx.at>
Message-ID: <200801162317.49790.kai.blin@gmail.com>

On Wednesday 16 January 2008 20:47:03 Stefan D?singer wrote:
> Am Mittwoch, 16. Januar 2008 19:57:52 schrieb L. Rahyen:
> > 	We really need to fix that bug to allow reliable multiuser setups...
>
> Maybe the proper solution is one wineserver running globally, as a special
> user("wine", "root" or whatever), started at system boot.

+1 :)

>
> However, if we do this, we'll have to care for security. We need
> authentication, secure IPC, secure resource handle access, provide security
> updates, etc. Currently, we do not care much about security, and as a
> consequence, we do not give any code of wine any special privileges, so
> Wine is not a security thread(Other than allowing Viruses to run, but that
> is inherent to its functionality).

We can probably do this similar to Windows. IIRC you get a token at log-in 
time to identify yourself with. I think running as a special user is 
sufficient, I doubt running as root is necessary.

I figure once Wine 1.0 is out, we'll have to provide security updates anyway.

> But dealing with security requires manpower. We have to implement all this,
> audit the code, etc. Wine is already a huge effort, and we're starving of
> manpower. I think the existing manpower is better spent at improving our
> Windows API implementation instead of diving into security hell. Patches
> are welcome though ;-)

+100 ;)

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080116/2110b268/attachment.pgp 

From raccoonone at procyongames.com  Wed Jan 16 16:37:45 2008
From: raccoonone at procyongames.com (Christopher)
Date: Wed, 16 Jan 2008 14:37:45 -0800
Subject: Getting Mozy to work
Message-ID: <478E8739.9090801@procyongames.com>

An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080116/a927d046/attachment.htm 

From stefandoesinger at gmx.at  Wed Jan 16 17:58:17 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 17 Jan 2008 00:58:17 +0100
Subject: Getting Mozy to work
In-Reply-To: <478E8739.9090801@procyongames.com>
References: <478E8739.9090801@procyongames.com>
Message-ID: <200801170058.18024.stefandoesinger@gmx.at>

Am Mittwoch, 16. Januar 2008 23:37:45 schrieb Christopher:
>  I'd like to get Mozy (online backup software, see mozy.com) working under
> Wine. I'm not sure I have all the skills, but I'm willing to try and write
> the necessary patches. In particular I need to fix bug 10932. This appears
> to be a problem with the fonts and/or the way text is rendered in general.
> Can anyone suggest a starting point for me? My programming experience has
> all been on Windows, so I don't know much about Wine and Linux. I tried
> looking through the output of +relay, but besides some WM_SETFONT messages
> there wasn't anything that looked very useful.
Try to look for things like ExtTextOut. Also, if the text is some custom font, 
the app might try to load it from images, or a custom font in its program 
folder.

One other hint: Please consider writing plain text mails instead of HTML 
messages to this mailing list. I almost trashed the mail without reading it 
because the combination of HTML + a superficial look at the sender address 
triggered my spam trigger...


From richie at entrian.com  Wed Jan 16 07:37:52 2008
From: richie at entrian.com (Richie Hindle)
Date: Wed, 16 Jan 2008 13:37:52 +0000
Subject: Suggestion to the list maintainer
In-Reply-To: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
References: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
Message-ID: <bt1so3t42iokdajvpaoan7mo5etahjrrmd@4ax.com>

Hi Fran?ois,

> [...] identify a message from this mailing list quickly by reading it's
> subject.  Could you please add a subject prefix like [WINE-DEVEL] [...]

I solve this by filtering messages To: wine-devel at winehq.org or CC:
wine-devel at winehq.org into a separate folder.  I see you're using
SquirrelMail - does this help:
http://its.uwrf.edu/support/squirrelmail/filter.php ?

-- 
Richie Hindle
richie at entrian.com


From ian at ianmacfarlane.com  Wed Jan 16 08:23:32 2008
From: ian at ianmacfarlane.com (Ian Macfarlane)
Date: Wed, 16 Jan 2008 14:23:32 +0000
Subject: WWN license issue
In-Reply-To: <478D18A5.9050006@codeweavers.com>
References: <aac02a530801150658o2f335dfagcbf16a5dd8f6a43a@mail.gmail.com>
	<b050a5e70801151220s6dcc3efpc379138fa63867ac@mail.gmail.com>
	<478D18A5.9050006@codeweavers.com>
Message-ID: <aac02a530801160623h2c5c5cbdm4595b7ff7ff4dbd9@mail.gmail.com>

For what it's worth, I would prefer, in general, if it were at least
GPLv2 or later, but considering that this is just a newsletter and not
source code, I don't care that much :)

To be honest, I think this it makes more sense under a Creative
Commons license (probably the simple Creative Commons Attribution
one).

All the old ones at least should be changed to point to the GPLv2
license however, even if it is GPL2+ rather than GPL2-only.

On 1/15/08, Jeremy Newman <jnewman at codeweavers.com> wrote:
> I'll patch it so it points to the GPL v2 licence, unless someone feels
> there is a reason it needs to be v3.
>
> Zachary Goldberg wrote:
> > On Jan 15, 2008 9:58 AM, Ian Macfarlane <ian at ianmacfarlane.com> wrote:
> >> At the bottom of each WWN issue (for example, the latest
> >> http://www.winehq.org/?issue=339) is the text:
> >>
> >> "All Kernel Cousin issues and summaries are copyright their original
> >> authors, and distributed under the terms of the GNU General Public
> >> License, version 2.0. "
> >>
> >> However, it links to http://www.gnu.org/licenses/gpl.txt which of
> >> course is now the GPLv3 license text.
> >>
> >> Perhaps the text should change to say version 3 (or perhaps version
> >> 2+), or to the old archived GPLv2 license (IMO the former two options
> >> are preferable).
> >>
> >>
> >>
> >
> > for the record: I have no personal preference on the license.
> > Whatever the WineHQ admins decide on the issue is fine with me.
> >
>


From radovan at skolnik.info  Wed Jan 16 08:46:31 2008
From: radovan at skolnik.info (Radovan Skolnik)
Date: Wed, 16 Jan 2008 15:46:31 +0100
Subject: Easy usage of native DLLs in Linux programs
Message-ID: <200801161546.31892.radovan@skolnik.info>

Hello!

I have found this old thread dealing exactly with what I need: 
http://www.winehq.org/pipermail/wine-devel/2006-April/046779.html

It basically proposes a work to be done to allow loading native Windows DLLs 
into Linux binaries (for example loading WinAmp plugins into 
xine/mplayer/gst/...).

I am in the need to use a small DLL (no GUI, just few APIs that are all 
already implemented) which I have no source code to.

Has this initiative progressed to something? If not can anybody advise on how 
I shoudl proceed wrapping native DLL into .so? I have looked over the mplayer 
code to load Windows codecs but I couldn't really grasp the idea - the are no 
comments with the code :-(

Thank you and best regards

	Radovan Skolnik


From jreiser at BitWagon.com  Wed Jan 16 16:28:09 2008
From: jreiser at BitWagon.com (John Reiser)
Date: Wed, 16 Jan 2008 14:28:09 -0800
Subject: Valgrinding large win32 app worked!
In-Reply-To: <478E6847.7020809@orange.fr>
References: <a71bd89a0801151818n53c98b2i566afe3b0f94c166@mail.gmail.com>
	<478E6847.7020809@orange.fr>
Message-ID: <478E84F9.30407@BitWagon.com>

Eric Pouech wrote:
> Dan Kegel a ?crit :

>> ... I can run Picasa for Windows under Wine under Valgrind.

>> It seemed to find lots of little problems, but since there
>> were lots of numeric addresses without symbolic info in the
>> valgrind log, it wasn't directly useful to the Picasa developers.

> the ultimate goal is rather to ask vg to support new messages about:
> - loading / unloading modules
> - having external .so files to understand more detailed information, and
> implement in them pdb and coff support

Yes, a new VALGRIND_USER_REQUEST which announces the load/unload,
supported by loadable shared libraries which generate symbols and
addresses to be added/removed from the currently-running valgrind,
is the way to go.

The only snag could be, does PE format allow a separate base address
for each "segment", or are all segments fixed relative to each other,
like the PT_LOAD in ET_DYN?

-- 
John Reiser, jreiser at BitWagon.com


From dank at kegel.com  Wed Jan 16 19:47:11 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 16 Jan 2008 17:47:11 -0800
Subject: valgrind and +heap not getting along?
Message-ID: <a71bd89a0801161747g162d892cmf1702cc9db41c43d@mail.gmail.com>

I'm seeing fun traces like

==17177== Invalid write of size 1
==17177==    at 0x4022D5A: memset (mc_replace_strmem.c:492)
==17177==    by 0x46E914A: mark_block_free (heap.c:148)
==17177==    by 0x46E6950: HEAP_CreateFreeBlock (heap.c:493)
==17177==    by 0x46E6B78: HEAP_ShrinkBlock (heap.c:575)
==17177==    by 0x46E7F47: RtlAllocateHeap (heap.c:1228)
==17177==    by 0x46EC10A: get_builtin_fullname (winnt.h:1989)
==17177==    by 0x46EC2B8: load_builtin_callback (loader.c:1320)
==17177==    by 0x402C3BF: wine_dll_set_callback (loader.c:480)
==17177==    by 0x46EF3A7: __wine_process_init (loader.c:2529)
==17177==    by 0x402C7D5: wine_init (loader.c:645)
==17177==    by 0x7BF01263: main (main.c:111)
==17177==  Address 0x7f000140 is not stack'd, malloc'd or (recently) free'd

when running with +heap under valgrind.  Is something off by one somewhere?
- Dan

-- 
Wine for Windows ISVs: http://kegel.com/wine/isv


From dank at kegel.com  Wed Jan 16 20:13:47 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 16 Jan 2008 18:13:47 -0800
Subject: Debugger unhappiness blocking valgrind runs
Message-ID: <a71bd89a0801161813t1d9d9a62sf52ec1df8b02227b@mail.gmail.com>

I just tried to do another daily valgrind run, but
it got blocked because it started up an infinite
number of copies of winedbg.  It seems that
a crash in the imagelist test in GetDibBits
triggered winedbg, and winedbg crashed trying
to generate a backtrace, which of course fired
up winedbg, which... was bad.  Some of the logs
are at
http://bugs.winehq.org/show_bug.cgi?id=11211

This seems to be very recent breakage, either today or yesterday.
- Dan

-- 
Wine for Windows ISVs: http://kegel.com/wine/isv


From jjmckenzie51 at sprintpcs.com  Wed Jan 16 21:04:58 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Wed, 16 Jan 2008 20:04:58 -0700
Subject: Getting Mozy to work
In-Reply-To: <478E8739.9090801@procyongames.com>
References: <478E8739.9090801@procyongames.com>
Message-ID: <478EC5DA.7080703@sprintpcs.com>

Christopher wrote:
> I'd like to get Mozy (online backup software, see mozy.com) working 
> under Wine. I'm not sure I have all the skills, but I'm willing to try 
> and write the necessary patches. In particular I need to fix bug 10932 
> <http://bugs.winehq.org/show_bug.cgi?id=10932>. This appears to be a 
> problem with the fonts and/or the way text is rendered in general. Can 
> anyone suggest a starting point for me? My programming experience has 
> all been on Windows, so I don't know much about Wine and Linux. I 
> tried looking through the output of +relay, but besides some 
> WM_SETFONT messages there wasn't anything that looked very useful.
>
Christopher:

This may be an extension of the same problem I am having with e-Sword 
and that is you have to use a native copy of riched20.dll.  Might I 
suggest getting a copy of this and placing it in the same directory as 
the Mozy software installs to.  Then use winecfg to create an entry for 
the main executable and then under libraries set riched20.dll to be 
native then builtin.  See if this makes the text visible.

James Mckenzie



From raccoonone at procyongames.com  Thu Jan 17 01:34:18 2008
From: raccoonone at procyongames.com (Christopher)
Date: Wed, 16 Jan 2008 23:34:18 -0800
Subject: Getting Mozy to work
In-Reply-To: <478EC5DA.7080703@sprintpcs.com>
References: <478E8739.9090801@procyongames.com>
	<478EC5DA.7080703@sprintpcs.com>
Message-ID: <478F04FA.5010205@procyongames.com>

James McKenzie wrote:
> Christopher wrote:
>> I'd like to get Mozy (online backup software, see mozy.com) working 
>> under Wine. I'm not sure I have all the skills, but I'm willing to 
>> try and write the necessary patches. In particular I need to fix bug 
>> 10932 <http://bugs.winehq.org/show_bug.cgi?id=10932>. This appears to 
>> be a problem with the fonts and/or the way text is rendered in 
>> general. Can anyone suggest a starting point for me? My programming 
>> experience has all been on Windows, so I don't know much about Wine 
>> and Linux. I tried looking through the output of +relay, but besides 
>> some WM_SETFONT messages there wasn't anything that looked very useful.
>>
> Christopher:
>
> This may be an extension of the same problem I am having with e-Sword 
> and that is you have to use a native copy of riched20.dll.  Might I 
> suggest getting a copy of this and placing it in the same directory as 
> the Mozy software installs to.  Then use winecfg to create an entry 
> for the main executable and then under libraries set riched20.dll to 
> be native then builtin.  See if this makes the text visible.
>
> James Mckenzie
>
>
Thanks for the suggestions everyone. I finally tracked the problem down 
to a flaw in user32.LoadStringW. I have sent in a patch, and will check 
user32.LoadStringA as it probably has the same flaw.


From truiken at gmail.com  Thu Jan 17 01:40:59 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 17 Jan 2008 01:40:59 -0600
Subject: Fix for LoadStringW
In-Reply-To: <478F0460.3050709@procyongames.com>
References: <478F0460.3050709@procyongames.com>
Message-ID: <22821af30801162340u7f0324a1k969f1599586bebc3@mail.gmail.com>

On Jan 17, 2008 1:31 AM, Christopher <raccoonone at procyongames.com> wrote:
> This patch fixes LoadStringW when 0 is passed for buflen. LoadStringW
> should now behave as described on MSDN:
> http://msdn2.microsoft.com/en-us/library/ms647486.aspx
>
> This patch also fixes bug #10932
>
> Christopher Berner
>
> From dfe1719df7e8cd12cc5819c647049d9f39978841 Mon Sep 17 00:00:00 2001
> From: Christopher Berner <raccoonone at procyongames.com>
> Date: Wed, 16 Jan 2008 23:21:23 -0800
> Subject: [PATCH] Patch to fix LoadStringW when buflen is 0
>
> ---
>  dlls/user32/resource.c |   11 +++++++++++
>  1 files changed, 11 insertions(+), 0 deletions(-)
>
> diff --git a/dlls/user32/resource.c b/dlls/user32/resource.c
> index b9a51ae..148e9d1 100644
> --- a/dlls/user32/resource.c
> +++ b/dlls/user32/resource.c
> @@ -363,6 +363,7 @@ INT WINAPI LoadStringW( HINSTANCE instance, UINT resource_id,
>      WCHAR *p;
>      int string_num;
>      int i;
> +    int strlen;
>
>      TRACE("instance = %p, id = %04x, buffer = %p, length = %d\n",
>            instance, resource_id, buffer, buflen);
> @@ -379,9 +380,19 @@ INT WINAPI LoadStringW( HINSTANCE instance, UINT resource_id,
>      for (i = 0; i < string_num; i++)
>         p += *p + 1;
>
> +    strlen = (int)*p;
>      TRACE("strlen = %d\n", (int)*p );
>
>      if (buffer == NULL) return *p;
> +
> +    //if buflen == 0, then return a read-only pointer to the resource itself in buffer
> +    //it is assumed that buffer is actually a LPWSTR *
> +    if(buflen == 0)
> +    {
> +        *((LPWSTR *)buffer) = p + 1;
> +        return strlen;
> +    }
> +
>      i = min(buflen - 1, *p);
>      if (i > 0) {
>         memcpy(buffer, p + 1, i * sizeof (WCHAR));

No c++ comments allowed.  Also, you need to add a test case for this change.

-- 
James Hawkins


From raccoonone at procyongames.com  Thu Jan 17 02:10:20 2008
From: raccoonone at procyongames.com (Christopher)
Date: Thu, 17 Jan 2008 00:10:20 -0800
Subject: Fix for LoadStringW
In-Reply-To: <22821af30801162340u7f0324a1k969f1599586bebc3@mail.gmail.com>
References: <478F0460.3050709@procyongames.com>
	<22821af30801162340u7f0324a1k969f1599586bebc3@mail.gmail.com>
Message-ID: <478F0D6C.3060106@procyongames.com>

James Hawkins wrote:
> On Jan 17, 2008 1:31 AM, Christopher <raccoonone at procyongames.com> wrote:
>   
>> This patch fixes LoadStringW when 0 is passed for buflen. LoadStringW
>> should now behave as described on MSDN:
>> http://msdn2.microsoft.com/en-us/library/ms647486.aspx
>>
>> This patch also fixes bug #10932
>>
>> Christopher Berner
>>
>> From dfe1719df7e8cd12cc5819c647049d9f39978841 Mon Sep 17 00:00:00 2001
>> From: Christopher Berner <raccoonone at procyongames.com>
>> Date: Wed, 16 Jan 2008 23:21:23 -0800
>> Subject: [PATCH] Patch to fix LoadStringW when buflen is 0
>>
>> ---
>>  dlls/user32/resource.c |   11 +++++++++++
>>  1 files changed, 11 insertions(+), 0 deletions(-)
>>
>> diff --git a/dlls/user32/resource.c b/dlls/user32/resource.c
>> index b9a51ae..148e9d1 100644
>> --- a/dlls/user32/resource.c
>> +++ b/dlls/user32/resource.c
>> @@ -363,6 +363,7 @@ INT WINAPI LoadStringW( HINSTANCE instance, UINT resource_id,
>>      WCHAR *p;
>>      int string_num;
>>      int i;
>> +    int strlen;
>>
>>      TRACE("instance = %p, id = %04x, buffer = %p, length = %d\n",
>>            instance, resource_id, buffer, buflen);
>> @@ -379,9 +380,19 @@ INT WINAPI LoadStringW( HINSTANCE instance, UINT resource_id,
>>      for (i = 0; i < string_num; i++)
>>         p += *p + 1;
>>
>> +    strlen = (int)*p;
>>      TRACE("strlen = %d\n", (int)*p );
>>
>>      if (buffer == NULL) return *p;
>> +
>> +    //if buflen == 0, then return a read-only pointer to the resource itself in buffer
>> +    //it is assumed that buffer is actually a LPWSTR *
>> +    if(buflen == 0)
>> +    {
>> +        *((LPWSTR *)buffer) = p + 1;
>> +        return strlen;
>> +    }
>> +
>>      i = min(buflen - 1, *p);
>>      if (i > 0) {
>>         memcpy(buffer, p + 1, i * sizeof (WCHAR));
>>     
>
> No c++ comments allowed.  Also, you need to add a test case for this change.
>
>   
Thanks for pointing that out! Am I suppose to attach a test case for all 
my patches to wine-patches? I had submitted a testcase under the bug 
report I filed, so I didn't attach it to the email.

Christopher Berner


From truiken at gmail.com  Thu Jan 17 02:20:02 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 17 Jan 2008 02:20:02 -0600
Subject: Fix for LoadStringW
In-Reply-To: <478F0D6C.3060106@procyongames.com>
References: <478F0460.3050709@procyongames.com>
	<22821af30801162340u7f0324a1k969f1599586bebc3@mail.gmail.com>
	<478F0D6C.3060106@procyongames.com>
Message-ID: <22821af30801170020r72740471w5f04b3464f04565a@mail.gmail.com>

On Jan 17, 2008 2:10 AM, Christopher <raccoonone at procyongames.com> wrote:
>
> James Hawkins wrote:
> > On Jan 17, 2008 1:31 AM, Christopher <raccoonone at procyongames.com> wrote:
> >
> >> This patch fixes LoadStringW when 0 is passed for buflen. LoadStringW
> >> should now behave as described on MSDN:
> >> http://msdn2.microsoft.com/en-us/library/ms647486.aspx
> >>
> >> This patch also fixes bug #10932
> >>
> >> Christopher Berner
> >>
> >> From dfe1719df7e8cd12cc5819c647049d9f39978841 Mon Sep 17 00:00:00 2001
> >> From: Christopher Berner <raccoonone at procyongames.com>
> >> Date: Wed, 16 Jan 2008 23:21:23 -0800
> >> Subject: [PATCH] Patch to fix LoadStringW when buflen is 0
> >>
> >> ---
> >>  dlls/user32/resource.c |   11 +++++++++++
> >>  1 files changed, 11 insertions(+), 0 deletions(-)
> >>
> >> diff --git a/dlls/user32/resource.c b/dlls/user32/resource.c
> >> index b9a51ae..148e9d1 100644
> >> --- a/dlls/user32/resource.c
> >> +++ b/dlls/user32/resource.c
> >> @@ -363,6 +363,7 @@ INT WINAPI LoadStringW( HINSTANCE instance, UINT resource_id,
> >>      WCHAR *p;
> >>      int string_num;
> >>      int i;
> >> +    int strlen;
> >>
> >>      TRACE("instance = %p, id = %04x, buffer = %p, length = %d\n",
> >>            instance, resource_id, buffer, buflen);
> >> @@ -379,9 +380,19 @@ INT WINAPI LoadStringW( HINSTANCE instance, UINT resource_id,
> >>      for (i = 0; i < string_num; i++)
> >>         p += *p + 1;
> >>
> >> +    strlen = (int)*p;
> >>      TRACE("strlen = %d\n", (int)*p );
> >>
> >>      if (buffer == NULL) return *p;
> >> +
> >> +    //if buflen == 0, then return a read-only pointer to the resource itself in buffer
> >> +    //it is assumed that buffer is actually a LPWSTR *
> >> +    if(buflen == 0)
> >> +    {
> >> +        *((LPWSTR *)buffer) = p + 1;
> >> +        return strlen;
> >> +    }
> >> +
> >>      i = min(buflen - 1, *p);
> >>      if (i > 0) {
> >>         memcpy(buffer, p + 1, i * sizeof (WCHAR));
> >>
> >
> > No c++ comments allowed.  Also, you need to add a test case for this change.
> >
> >
> Thanks for pointing that out! Am I suppose to attach a test case for all
> my patches to wine-patches? I had submitted a testcase under the bug
> report I filed, so I didn't attach it to the email.
>

Yes, for the fixes that can be tested, which is most of them.  Patches
in bugzilla bit-rot.

-- 
James Hawkins


From dmitry at codeweavers.com  Thu Jan 17 03:16:44 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 17 Jan 2008 17:16:44 +0800
Subject: Fix for LoadStringW
References: <478F0460.3050709@procyongames.com><22821af30801162340u7f0324a1k969f1599586bebc3@mail.gmail.com>
	<478F0D6C.3060106@procyongames.com>
Message-ID: <008601c858e9$b00a04d0$a600fea9@DMITRY>

"Christopher" <raccoonone at procyongames.com> wrote:

> Thanks for pointing that out! Am I suppose to attach a test case for all 
> my patches to wine-patches? I had submitted a testcase under the bug 
> report I filed, so I didn't attach it to the email.

You have to add the test to the exiting tests in dlls/kernel32/tests
not send an exe file. Also, you need to inspect and fix all places in
Wine which rely on old behaviour.

-- 
Dmitry.


From fedev at gmx.net  Wed Jan 16 22:06:28 2008
From: fedev at gmx.net (Federico Vecchiarelli)
Date: Thu, 17 Jan 2008 12:06:28 +0800
Subject: Request for patch removal
In-Reply-To: <Pine.LNX.4.64.0801161045430.22239@linux2.gl.umbc.edu>
References: <478DAA25.10900@gmx.net> <004d01c8584d$9f3759b0$a600fea9@DMITRY>
	<Pine.LNX.4.64.0801161045430.22239@linux2.gl.umbc.edu>
Message-ID: <478ED444.6040405@gmx.net>


As a workaround, I ended up creating an empty .wine folder on each of 
the users' home directory and then I did a symlink of the contents in my 
/home/wine/ but not of the folder itself.

I'm not deeply involved in wine and I don't know the reasons of this 
patch but it would seem reasonable for this behavior to be changed from 
a configuration file. Allowing the administrator to decide if he wants 
it On or Off. In the configuration file, the implications of that switch 
could be explained.

Maybe is not the best implementation but it might give you some ideas.


Fede


Steve Brown wrote:
> On Wed, 16 Jan 2008, Dmitry Timoshkov wrote:
>
>> "Federico Vecchiarelli" <fedev at gmx.net> wrote:
>>
>>> Ok, to the point. The patch mentioned below prohibits wine from running
>>> any application which is inside someone else's folder, even if you have
>>> access to it. In my case, I wanted to make one unique installation
>>> available to several users. Because of this patch, there is no
>>> workaround that could be implemented, forcing me to either run a script
>>> changing the owner of the folders for every user as they want to use 
>>> the
>>> application or I have to make several copies of the software which will
>>> put me in a difficult legal situation.
>>
>> All the details about this problem you can find here:
>>
>> http://bugs.winehq.org/show_bug.cgi?id=11112
>>
>> -- 
>> Dmitry.
>
> Allow me to add my voice on this subject.  I also would like the Wine 
> developers to consider how to allow for this use case.  In a centrally 
> administered environment, most users do not have write access to much 
> of the local disk, and the administrator of the machine (root) sets up 
> the environment for them (and normal users should not be allowed to 
> muck with it).  I am administrator for a small group of folks here, 
> and would switch to Linux only -- but there are still Windows-only 
> programs that are critical for my users.  Wine would be a wonderful 
> solution, if only wine could be installed in a central location (say, 
> /usr/local) and the wine "registry" files could be shared, somehow, by 
> all users on the machine (maybe by doing a union of ~/.wine and 
> /usr/local/wine/whatever).
>
> I see in the comments on this bug, that the concern is with multiple 
> instances of wineserver running on the machine at one time -- that's 
> not a major issue in the use case I envision.  The multiple 
> wineservers would not be running at the same time (unless the install 
> is on what Windows would call a Terminal Services Server -- a normal 
> multi-user *nix machine).  I think that even just allowing for 
> multiple login users on a local machine at different times would be 
> sufficient for a lot of us.  If, say, ~/.wine was used as a 
> replacement for HKLM\Current User and, say, /usr/local/wine/whatever 
> was for the other registry hives and group policies, I think wine 
> would be a lot closer to being a solution for those of us maintaining 
> multi-user machines.
>
> Steve Brown
> Systems Administrator
> UMBC Imaging Research Center
> sbrown7 at umbc.edu
>



From maarten at codeweavers.com  Thu Jan 17 05:06:31 2008
From: maarten at codeweavers.com (Maarten Lankhorst)
Date: Thu, 17 Jan 2008 12:06:31 +0100
Subject: Easy usage of native DLLs in Linux programs
In-Reply-To: <200801161546.31892.radovan@skolnik.info>
References: <200801161546.31892.radovan@skolnik.info>
Message-ID: <478F36B7.2000601@codeweavers.com>

Radovan Skolnik schreef:
> Hello!
>
> I have found this old thread dealing exactly with what I need: 
> http://www.winehq.org/pipermail/wine-devel/2006-April/046779.html
>
> It basically proposes a work to be done to allow loading native Windows DLLs 
> into Linux binaries (for example loading WinAmp plugins into 
> xine/mplayer/gst/...).
>
> I am in the need to use a small DLL (no GUI, just few APIs that are all 
> already implemented) which I have no source code to.
>   
Unfortunately it isn't easy, wine manages everything itself. As far as I
can tell, the easiest way is to compile your own program as a winelib
binary, then you can link to windows dll's. This is the most performance
effective way to do this.

If you really want to create a .so it wouldn't be impossible but just
harder:
- Create a winelib app that when it is run it calls the functions as
above, and listens on a socket, or has another way (except linking in
any way) to communicate.
- Make a shared library (.so) that will run the above program, then
communicates with it and uses that program for every dll call. The
winelib app will probably need its own WINEPREFIX so it can run
undisturbed by other influences.

While possible this isn't trivial.

Regards,
Maarten


From wferi at niif.hu  Thu Jan 17 05:34:59 2008
From: wferi at niif.hu (Ferenc Wagner)
Date: Thu, 17 Jan 2008 12:34:59 +0100
Subject: Fix for LoadStringW
In-Reply-To: <008601c858e9$b00a04d0$a600fea9@DMITRY> (Dmitry Timoshkov's
	message of "Thu, 17 Jan 2008 17:16:44 +0800")
References: <478F0460.3050709@procyongames.com>
	<22821af30801162340u7f0324a1k969f1599586bebc3@mail.gmail.com>
	<478F0D6C.3060106@procyongames.com>
	<008601c858e9$b00a04d0$a600fea9@DMITRY>
Message-ID: <877ii87kik.fsf@tac.ki.iif.hu>

"Dmitry Timoshkov" <dmitry at codeweavers.com> writes:

> "Christopher" <raccoonone at procyongames.com> wrote:
>
>> Thanks for pointing that out! Am I suppose to attach a test case for all 
>> my patches to wine-patches? I had submitted a testcase under the bug 
>> report I filed, so I didn't attach it to the email.
>
> You have to add the test to the exiting tests in dlls/kernel32/tests

Actually, there are LoadStringA tests in dlls/user32/tests/resource.c,
maybe it's best to team up with those (and possibly extend for the
same set of tests).
-- 
Regards,
Feri.


From julliard at winehq.org  Thu Jan 17 06:58:11 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 17 Jan 2008 13:58:11 +0100
Subject: kernel32: Intialise 16-bit stack to zero.
In-Reply-To: <478F4A20.1090703@codeweavers.com> (Robert Shearman's message of
	"Thu, 17 Jan 2008 12:29:20 +0000")
References: <478F4A20.1090703@codeweavers.com>
Message-ID: <87odbk38yk.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> ---
>  dlls/kernel32/kernel_main.c |    2 +-
>  1 files changed, 1 insertions(+), 1 deletions(-)
>
> Otherwise dbghelp could sometimes get confused and think it should
> switch to 16-bit mode.
> This results in messages such as the following when warn or tracing
> for the heap channel is turned on:
> fixme:dbghelp:Failed to linearize address ????:55555555 ...

Initializing the first frame should be enough.

-- 
Alexandre Julliard
julliard at winehq.org


From alex at thehandofagony.com  Thu Jan 17 07:51:06 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Thu, 17 Jan 2008 14:51:06 +0100
Subject: Time to create a stub wmvcore.dll?
In-Reply-To: <a71bd89a0801152124y5f923f18r4ec41577aa7ca475@mail.gmail.com>
References: <a71bd89a0801152124y5f923f18r4ec41577aa7ca475@mail.gmail.com>
Message-ID: <200801171451.06490.alex@thehandofagony.com>

On Wednesday 16 January 2008 06:24:22 Dan Kegel wrote:
> There seem to be a large number of apps that don't
> start unless a wmvcore.dll is present:
>  TVersity
>  Phatnoise
>  Lost Planet
>  The Bard's Tale
>  WMA Workshop
>  MixMeister
>  ...
> So, how 'bout it?  Should we create a stub for wmvcore.dll and friends?
> - Dan


Sounds like a great idea.  Also some games require a WMA  codec in order to 
play their music.

Oh, and it would be nice for Wine to have its own version of the Media Player, 
too. :)


Alexander N. S?rnes


From rob at codeweavers.com  Thu Jan 17 11:17:53 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 17 Jan 2008 17:17:53 +0000
Subject: kernel32: Intialise 16-bit stack to zero.
In-Reply-To: <87odbk38yk.fsf@wine.dyndns.org>
References: <478F4A20.1090703@codeweavers.com> <87odbk38yk.fsf@wine.dyndns.org>
Message-ID: <478F8DC1.2090408@codeweavers.com>

Alexandre Julliard wrote:
> Robert Shearman <rob at codeweavers.com> writes:
>   
>> Otherwise dbghelp could sometimes get confused and think it should
>> switch to 16-bit mode.
>> This results in messages such as the following when warn or tracing
>> for the heap channel is turned on:
>> fixme:dbghelp:Failed to linearize address ????:55555555 ...
>>     
>
> Initializing the first frame should be enough.

I can't work out what the size of the first frame is though. Is it 
sizeof(STACK16FRAME)?

-- 
Rob Shearman



From paulc at voip.null.ro  Thu Jan 17 12:35:51 2008
From: paulc at voip.null.ro (Paul Chitescu)
Date: Thu, 17 Jan 2008 20:35:51 +0200 (EET)
Subject: ntdll: Do not perform base relocation if an image is not a DLL.
	Take 2
In-Reply-To: <E1JFUQo-00069h-98@mail.codeweavers.com>
References: <E1JFUQo-00069h-98@mail.codeweavers.com>
Message-ID: <Pine.LNX.4.64.0801172030200.10308@dragoshel>

Dmitry,

IMHO it doesn't worth to the to relocate EXEs since virtually none are 
providing relocation records. Any operating system that can't allocate 
memory at low virtual addresses won't be able to run any Windows 
application newer than about 13 years (that is, all of interess).

EXEs were relocated only in Win32s where all applications were sharing a 
single address space. Since Visual C 4 the linker default is to not 
generate relocations for EXE files.

Paul Chitescu


On Thu, 17 Jan 2008, Dmitry Timoshkov wrote:
> Hello,
>
> this patch fixes the problem reported in the bug 11170. It appears that
> LoadLibrary in Windows doesn't attempt to relocate .exe files.
>
> Alexandre noticed that previous version of the patch may break relocation of
> the main exe. This version addresses that. However, this appears to be not
> compatible with what Windows (does not) do: in order to force a relocation
> of main under XP I set its base address to match the ntdll.dll (0x7c900000),
> and XP just refused to load the exe with an error message "The system cannot
> execute the specified program." But we may need to relocate main exe due to
> environment limitations (some native .so file may be mapped at that address).
>
> Changelog:
> [...]


From julliard at winehq.org  Thu Jan 17 12:39:56 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 17 Jan 2008 19:39:56 +0100
Subject: kernel32: Intialise 16-bit stack to zero.
In-Reply-To: <478F8DC1.2090408@codeweavers.com> (Robert Shearman's message of
	"Thu, 17 Jan 2008 17:17:53 +0000")
References: <478F4A20.1090703@codeweavers.com>
	<87odbk38yk.fsf@wine.dyndns.org> <478F8DC1.2090408@codeweavers.com>
Message-ID: <87k5m82t4z.fsf@wine.dyndns.org>

Robert Shearman <rob at codeweavers.com> writes:

> Alexandre Julliard wrote:
>> Initializing the first frame should be enough.
>
> I can't work out what the size of the first frame is though. Is it
> sizeof(STACK16FRAME)?

Yes; NtCurrentTeb()->WOW32Reserved is set to point to the initial stack
frame at the top of the stack, that's what you have to initialize.

-- 
Alexandre Julliard
julliard at winehq.org


From wine.dev at web.de  Thu Jan 17 13:56:26 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Thu, 17 Jan 2008 20:56:26 +0100
Subject: bugzilla component and keyword cleanup
In-Reply-To: <20080106165555.GA4687@crissy.swd.zerebecki.de>
References: <20080106165555.GA4687@crissy.swd.zerebecki.de>
Message-ID: <1200599786.7055.8.camel@p4>

On So, 2008-01-06 at 17:55 +0100, Jan Zerebecki wrote:
> I'm done with one step of the changes.

> Improvement suggestions are welcome.


Please add "printing" as keyword and "wineps" as component


Thanks


-- 
 
By by ... Detlef




From eric.pouech at orange.fr  Thu Jan 17 14:08:28 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Thu, 17 Jan 2008 21:08:28 +0100
Subject: Debugger unhappiness blocking valgrind runs
In-Reply-To: <a71bd89a0801161813t1d9d9a62sf52ec1df8b02227b@mail.gmail.com>
References: <a71bd89a0801161813t1d9d9a62sf52ec1df8b02227b@mail.gmail.com>
Message-ID: <478FB5BC.9000808@orange.fr>

Dan Kegel a ?crit :
> I just tried to do another daily valgrind run, but
> it got blocked because it started up an infinite
> number of copies of winedbg.  It seems that
> a crash in the imagelist test in GetDibBits
> triggered winedbg, and winedbg crashed trying
> to generate a backtrace, which of course fired
> up winedbg, which... was bad.  Some of the logs
> are at
> http://bugs.winehq.org/show_bug.cgi?id=11211
>
> This seems to be very recent breakage, either today or yesterday.
> - Dan
>
>   
you're likely running out of memory (just to be sure, if the test 
segfaults, but winedbg correctly starts, it's likely the cause)
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From eric.pouech at orange.fr  Thu Jan 17 14:09:25 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Thu, 17 Jan 2008 21:09:25 +0100
Subject: Valgrinding large win32 app worked!
In-Reply-To: <a71bd89a0801161355j55326df3ub73f707ea9e74b7d@mail.gmail.com>
References: <a71bd89a0801151818n53c98b2i566afe3b0f94c166@mail.gmail.com>	
	<478E6847.7020809@orange.fr>
	<a71bd89a0801161355j55326df3ub73f707ea9e74b7d@mail.gmail.com>
Message-ID: <478FB5F5.2040503@orange.fr>


>> the hard part is to tell valgrind about information about modules it
>> doesn't know of:
>> - it doesn't know about the loading of the module (it's seen by vg as a
>> simple mmap)
>> - it doesn't know about the PE native debug information (whatever it is)
>>
>> the simplest approach would be to somehow:
>> - use the --db-attach option in vg to hook to a debugger on every error
>> (one hurdle is that valgrind doesn't allow both trace-children and
>> db-attach)
>> - then use winedbg to get a backtrace (or similar info) from the running
>> program (winedbg will be able to get to both .pdb and dwarf debug info)
>>
>> the ultimate goal is rather to ask vg to support new messages about:
>> - loading / unloading modules
>> - having external .so files to understand more detailed information, and
>> implement in them pdb and coff support
>>     
>
> Thanks for the tips.  I don't suppose you'd have time to look at any
> of this?  :-)
> - Dan
>   
since you're asking, no ;-)
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From eric.pouech at orange.fr  Thu Jan 17 14:15:22 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Thu, 17 Jan 2008 21:15:22 +0100
Subject: Valgrinding large win32 app worked!
In-Reply-To: <478E84F9.30407@BitWagon.com>
References: <a71bd89a0801151818n53c98b2i566afe3b0f94c166@mail.gmail.com>
	<478E6847.7020809@orange.fr> <478E84F9.30407@BitWagon.com>
Message-ID: <478FB75A.2030205@orange.fr>


> The only snag could be, does PE format allow a separate base address
> for each "segment", or are all segments fixed relative to each other,
> like the PT_LOAD in ET_DYN?
>   
each segment is described as an offset to the module's base address, but 
the offset are fixed in the PE format (as well as in .pdb)
anyhow, this information is present both in the PE header and the debug info

A+


-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From dave at sr71.net  Thu Jan 17 14:19:02 2008
From: dave at sr71.net (Dave Hansen)
Date: Thu, 17 Jan 2008 12:19:02 -0800
Subject: [PATCH] support for synchronous and non-buffered I/O
In-Reply-To: <1200467437.22674.153.camel@localhost>
References: <1200467437.22674.153.camel@localhost>
Message-ID: <1200601143.5866.71.camel@localhost>

On Tue, 2008-01-15 at 23:10 -0800, Dave Hansen wrote:
> I have a little Eye-Fi card (http://www.eye.fi).  The software to
> control it is a windows application that writes to control files which
> appear in a DOS filesystem on the SD card.  (you can read more
> information here: http://dave-hansen.blogspot.com/)
> 
> However, the application does not quite work under wine.  The
> application writes to the card, but doesn't get the results it expects.
> It loops doing read()s of the files looking for results until it times
> out.

Do me a favor and don't apply this quite yet.  I'll repost when it's
ready.

-- Dave



From frick at sc-networks.de  Thu Jan 17 15:55:09 2008
From: frick at sc-networks.de (Christoph Frick)
Date: Thu, 17 Jan 2008 22:55:09 +0100
Subject: add HKLM/System/MountedDevices to be added by default
Message-ID: <20080117215509.GF11203@byleth.sc-networks.de>

this is suggested on quite some places in appdb to make seucrom based games come a litle further

---
 tools/wine.inf |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/tools/wine.inf b/tools/wine.inf
index c3cb89c..f63fb23 100644
--- a/tools/wine.inf
+++ b/tools/wine.inf
@@ -362,6 +362,8 @@ HKLM,SOFTWARE\Microsoft\Active Setup\Installed Components\{de5aed00-a4bf-11d1-99
 HKLM,SOFTWARE\Microsoft\Active Setup\Installed Components\{de5aed00-a4bf-11d1-9948-00c04f98bbc9},"IsInstalled",2,1
 HKLM,SOFTWARE\Microsoft\Active Setup\Installed Components\{de5aed00-a4bf-11d1-9948-00c04f98bbc9},"Locale",2,"*"
 HKLM,SOFTWARE\Microsoft\Active Setup\Installed Components\{de5aed00-a4bf-11d1-9948-00c04f98bbc9},"Version",2,"4,74,9273,0"
+; SecuROM needs this key
+HKLM,System\MountedDevices,,,""
 
 [Nls]
 HKLM,System\CurrentControlSet\Control\Nls\Codepage,"37",,""
-- 
1.5.3.7

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 163 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080117/809a9b15/attachment.pgp 

From thestig at google.com  Thu Jan 17 16:05:43 2008
From: thestig at google.com (Lei Zhang)
Date: Thu, 17 Jan 2008 14:05:43 -0800
Subject: add HKLM/System/MountedDevices to be added by default
In-Reply-To: <20080117215509.GF11203@byleth.sc-networks.de>
References: <20080117215509.GF11203@byleth.sc-networks.de>
Message-ID: <558b2f5c0801171405l2beb7ee6s6ad577d5fe9b5855@mail.gmail.com>

On Jan 17, 2008 1:55 PM, Christoph Frick <frick at sc-networks.de> wrote:
> this is suggested on quite some places in appdb to make seucrom based games come a litle further
>
> ---
>  tools/wine.inf |    2 ++
>  1 files changed, 2 insertions(+), 0 deletions(-)
>
> diff --git a/tools/wine.inf b/tools/wine.inf
> index c3cb89c..f63fb23 100644
> --- a/tools/wine.inf
> +++ b/tools/wine.inf
> @@ -362,6 +362,8 @@ HKLM,SOFTWARE\Microsoft\Active Setup\Installed Components\{de5aed00-a4bf-11d1-99
>  HKLM,SOFTWARE\Microsoft\Active Setup\Installed Components\{de5aed00-a4bf-11d1-9948-00c04f98bbc9},"IsInstalled",2,1
>  HKLM,SOFTWARE\Microsoft\Active Setup\Installed Components\{de5aed00-a4bf-11d1-9948-00c04f98bbc9},"Locale",2,"*"
>  HKLM,SOFTWARE\Microsoft\Active Setup\Installed Components\{de5aed00-a4bf-11d1-9948-00c04f98bbc9},"Version",2,"4,74,9273,0"
> +; SecuROM needs this key
> +HKLM,System\MountedDevices,,,""
>
>  [Nls]
>  HKLM,System\CurrentControlSet\Control\Nls\Codepage,"37",,""
> --
> 1.5.3.7
>
>
>
>
>

Patches should be sent to wine-patches at winehq.org.


From frick at sc-networks.de  Thu Jan 17 16:47:32 2008
From: frick at sc-networks.de (Christoph Frick)
Date: Thu, 17 Jan 2008 23:47:32 +0100
Subject: add HKLM/System/MountedDevices to be added by default
In-Reply-To: <558b2f5c0801171405l2beb7ee6s6ad577d5fe9b5855@mail.gmail.com>
References: <20080117215509.GF11203@byleth.sc-networks.de>
	<558b2f5c0801171405l2beb7ee6s6ad577d5fe9b5855@mail.gmail.com>
Message-ID: <20080117224732.GG11203@byleth.sc-networks.de>

On Thu, Jan 17, 2008 at 02:05:43PM -0800, Lei Zhang wrote:

> Patches should be sent to wine-patches at winehq.org.

i know - but it was too late once i pressed CTRL-X. so i convinced
myself, that this patch would not go through easy anyway because
somebody else would have done the same a long time ago and so it starts
at least an discussion...

-- 
cu
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 163 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080117/7231949b/attachment.pgp 

From dank at kegel.com  Thu Jan 17 16:59:20 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 17 Jan 2008 14:59:20 -0800
Subject: Debugger unhappiness blocking valgrind runs
In-Reply-To: <478FB5BC.9000808@orange.fr>
References: <a71bd89a0801161813t1d9d9a62sf52ec1df8b02227b@mail.gmail.com>
	<478FB5BC.9000808@orange.fr>
Message-ID: <a71bd89a0801171459y5d6aded2rd84cc7634d065ccb@mail.gmail.com>

On Jan 17, 2008 12:08 PM, Eric Pouech <eric.pouech at orange.fr> wrote:
> > http://bugs.winehq.org/show_bug.cgi?id=11211
>
> you're likely running out of memory (just to be sure, if the test
> segfaults, but winedbg correctly starts, it's likely the cause)

It doesn't seem like I'm running out of memory.
winedbg does not correctly start.
free shows lots of free swap space.

Amusingly, this shows up now on one of my machines when I run
Photoshop CS2 tryout.  File / Browse crashes, which
will bring up winedbg, which crashes, which brings up winedbg,
which crashes,... you have to do wineserver -k quick or you'll
have zillions of winedbg's all waiting to be debugged.


From dank at kegel.com  Thu Jan 17 20:20:55 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 17 Jan 2008 18:20:55 -0800
Subject: add HKLM/System/MountedDevices to be added by default
Message-ID: <a71bd89a0801171820m19c18a2jc01e0f7d72d26623@mail.gmail.com>

c.f. wrote:
> this is suggested on quite some places in appdb to make seucrom based games come a litle further

Discussed at http://bugs.winehq.org/show_bug.cgi?id=7065#c58
Looks like something of this sort is already in, you must have blinked :-)


From dank at kegel.com  Thu Jan 17 20:57:19 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 17 Jan 2008 18:57:19 -0800
Subject: GOM player
Message-ID: <a71bd89a0801171857n6eea25aco5bdd5e926756ccf0@mail.gmail.com>

http://www.guardian.co.uk/technology/2008/jan/17/linux.korea
says everyone in Korea uses the GOM player
instead of Windows Media Player.

It installs ok, but blew up when I tried to load
the Sony music stream from its playlist.

Free download
http://www.gomplayer.com/
supposedly comes with lots of codecs.
- Dan


From infyquest at gmail.com  Thu Jan 17 22:38:34 2008
From: infyquest at gmail.com (Vijay Kiran Kamuju)
Date: Thu, 17 Jan 2008 23:38:34 -0500
Subject: GOM player
In-Reply-To: <a71bd89a0801171857n6eea25aco5bdd5e926756ccf0@mail.gmail.com>
References: <a71bd89a0801171857n6eea25aco5bdd5e926756ccf0@mail.gmail.com>
Message-ID: <36bf289b0801172038w4b5a7879rbfac8b8f4cb4a218@mail.gmail.com>

It blew up in wine or windows.
Is it a problem with wine.
What about other media types.

--
VJ

On 1/17/08, Dan Kegel <dank at kegel.com> wrote:
> http://www.guardian.co.uk/technology/2008/jan/17/linux.korea
> says everyone in Korea uses the GOM player
> instead of Windows Media Player.
>
> It installs ok, but blew up when I tried to load
> the Sony music stream from its playlist.
>
> Free download
> http://www.gomplayer.com/
> supposedly comes with lots of codecs.
> - Dan
>
>
>


From dank at kegel.com  Thu Jan 17 22:49:21 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 17 Jan 2008 20:49:21 -0800
Subject: GOM player
In-Reply-To: <36bf289b0801172038w4b5a7879rbfac8b8f4cb4a218@mail.gmail.com>
References: <a71bd89a0801171857n6eea25aco5bdd5e926756ccf0@mail.gmail.com>
	<36bf289b0801172038w4b5a7879rbfac8b8f4cb4a218@mail.gmail.com>
Message-ID: <a71bd89a0801172049x3da45bcck4eda621bb47a380a@mail.gmail.com>

On Jan 17, 2008 8:38 PM, Vijay Kiran Kamuju <infyquest at gmail.com> wrote:
> On 1/17/08, Dan Kegel <dank at kegel.com> wrote:
> > http://www.guardian.co.uk/technology/2008/jan/17/linux.korea
> > says everyone in Korea uses the GOM player...
> > It installs ok, but blew up when I tried to load
> > the Sony music stream from its playlist. ...
> > http://www.gomplayer.com/
> > supposedly comes with lots of codecs.
>
> It blew up in wine or windows.
> Is it a problem with wine.

It blew up in wine, so I imagine it's a wine problem.

> What about other media types.

I didn't do much testing, just that one quick hit.
It deserves some real testing given its popularity in
Korea, I think.
- Dan


From dank at kegel.com  Fri Jan 18 02:08:19 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 18 Jan 2008 00:08:19 -0800
Subject: appdb hosed
Message-ID: <a71bd89a0801180008tf0a74e9m54d701e1a2b42931@mail.gmail.com>

The left nav bars are broken, can't approve any new test data.


From alex at thehandofagony.com  Fri Jan 18 02:57:15 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Fri, 18 Jan 2008 09:57:15 +0100
Subject: appdb hosed
In-Reply-To: <a71bd89a0801180008tf0a74e9m54d701e1a2b42931@mail.gmail.com>
References: <a71bd89a0801180008tf0a74e9m54d701e1a2b42931@mail.gmail.com>
Message-ID: <200801180957.15912.alex@thehandofagony.com>

On Friday 18 January 2008 09:08:19 Dan Kegel wrote:
> The left nav bars are broken, can't approve any new test data.


Does it work if you press 'refresh' a couple of times?


Alexander N. S?rnes


From dank at kegel.com  Fri Jan 18 03:04:00 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 18 Jan 2008 01:04:00 -0800
Subject: appdb hosed
In-Reply-To: <200801180957.15912.alex@thehandofagony.com>
References: <a71bd89a0801180008tf0a74e9m54d701e1a2b42931@mail.gmail.com>
	<200801180957.15912.alex@thehandofagony.com>
Message-ID: <a71bd89a0801180104i5e2b3e6di6299359318dde7d4@mail.gmail.com>

Alexander Nicolaysen S?rnes <alex at thehandofagony.com> wrote:
> > The left nav bars are broken, can't approve any new test data.
>
> Does it work if you press 'refresh' a couple of times?

Yes, thanks.

Hopefully not everybody has to do that...?


From alex at thehandofagony.com  Fri Jan 18 03:22:10 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Fri, 18 Jan 2008 10:22:10 +0100
Subject: appdb hosed
In-Reply-To: <a71bd89a0801180104i5e2b3e6di6299359318dde7d4@mail.gmail.com>
References: <a71bd89a0801180008tf0a74e9m54d701e1a2b42931@mail.gmail.com>
	<200801180957.15912.alex@thehandofagony.com>
	<a71bd89a0801180104i5e2b3e6di6299359318dde7d4@mail.gmail.com>
Message-ID: <200801181022.10145.alex@thehandofagony.com>

On Friday 18 January 2008 10:04:00 you wrote:
> Alexander Nicolaysen S?rnes <alex at thehandofagony.com> wrote:
> > > The left nav bars are broken, can't approve any new test data.
> >
> > Does it work if you press 'refresh' a couple of times?
>
> Yes, thanks.
>
> Hopefully not everybody has to do that...?


Unfortunately.

We changed the menus so that doing things like Ctrl + click for opening new 
tabs should work properly.



Alexander


From ivan at etersoft.ru  Fri Jan 18 03:21:46 2008
From: ivan at etersoft.ru (Ivan Sinitsin)
Date: Fri, 18 Jan 2008 12:21:46 +0300
Subject: problem with widl.
Message-ID: <200801181221.48708.ivan@etersoft.ru>

I have a question about widl.

tools\widl\header.c    function "write_method_macro"

      fprintf(header, "#define %s_", name);
      write_name(header,def);
      fprintf(header, "(p");
      for (c=0; c<argc; c++)
        fprintf(header, ",%c", c+'a');
      fprintf(header, ") ");

      fprintf(header, "(p)->lpVtbl->");
      write_name(header, def);
      fprintf(header, "(p");
      for (c=0; c<argc; c++)
        fprintf(header, ",%c", c+'a');
      fprintf(header, ")\n");

This code wrong, because if my function have more then 16 parameters I receive 
something like this:

     #define Imyinterface_Open(p,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q     
(p)->lpVtbl->Open(p,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q)

and the compiler gives out a mistake 

     library.h:1296:63: duplicate macro parameter "p"

I think that this code should be like this:
Variant 1.
      int p=0;
      for (c=0; c<argc; c++) {
        if (p==15) p++;
        fprintf(header, ",%c", p+'a');
        p++;
      }
      fprintf(header, ") ");

      fprintf(header, "(p)->lpVtbl->");
      write_name(header, def);
      fprintf(header, "(p");
      p=0;
      for (c=0; c<argc; c++) {
        if (p==15) p++;
        fprintf(header, ",%c", p+'a');
        p++;
      }
      fprintf(header, ")\n");

or
Variant 2. (Without cycles)
     char str[] = 
{'p',',','a',',','b',',','c',',','d',',','e',',','f',',','g',',','h',',','i',',','j',',','k',',','l',',','m',',','o',',','q',',','r',',','s',',','t',',','u',',','v',',','w',',','x',',','y',',','z',',',0};

      str[2*argc+1] = 0;
      fprintf(header, "#define %s_", name);
      write_name(header,def);
      fprintf(header,"(");
      fprintf(header,"%s",str);
      fprintf(header, ") ");

      fprintf(header, "(p)->lpVtbl->");
      write_name(header, def);
      fprintf(header,"(");
      fprintf(header,"%s",str);
      fprintf(header, ")\n");

What do you think about that?

---------------- 
Sinitsin Ivan


From julliard at winehq.org  Fri Jan 18 04:59:52 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 18 Jan 2008 11:59:52 +0100
Subject: qmgr [1/3]: Implement IClassFactory methods.
In-Reply-To: <20080117232624.GC30711@linux.ucla.edu> (Dan Hipschman's message
	of "Thu, 17 Jan 2008 15:26:24 -0800")
References: <20080117232624.GC30711@linux.ucla.edu>
Message-ID: <87ir1rbdqv.fsf@wine.dyndns.org>

Dan Hipschman <dsh at linux.ucla.edu> writes:

> I split the last patch into three.  This is essentially the same as the last
> one Roy sent, but cleaned up a bit.  This adds the IClassFactory methods for
> BITS.

When sending a patch written by someone else, please include a From:
line with the proper attribution in your message.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri Jan 18 05:37:13 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 18 Jan 2008 12:37:13 +0100
Subject: [dbghelp 4/10] Rewrite much of the symbol lookup method to work
	with Optimized PDB files as well
In-Reply-To: <df81031c0801171448u1d9c116bo1c3fb4d8efe88330@mail.gmail.com>
	(Jason Green's message of "Thu, 17 Jan 2008 17:48:48 -0500")
References: <df81031c0801171448u1d9c116bo1c3fb4d8efe88330@mail.gmail.com>
Message-ID: <87ejcfbc0m.fsf@wine.dyndns.org>

"Jason Green" <jave27 at gmail.com> writes:

> +
> +#ifdef TRACE_SYMBOL_LIST
> +    TRACE("\n\n***** sorting the table {count = %d}\n\n", module->num_sorttab);
> +#endif
> +
> +    qsort(module->addr_sorttab, module->num_sorttab, sizeof(struct symbol_entry), symt_cmp_addr_and_size);
> +
> +    generateSymbolChains(module);
> +
> +
> +#ifdef TRACE_SYMBOL_LIST
> +    if (0){
> +        ULONG64                 prevAddr = 0;

Please don't add ifdef'ed out code, it should either be compiled always,
or removed completely.

> +          sizeof(SYMBOL_INFO), Symbol->SizeOfStruct,
> +          (intptr_t)&Symbol->SizeOfStruct - (intptr_t)Symbol,
> +          (intptr_t)&Symbol->TypeIndex - (intptr_t)Symbol,
> +          (intptr_t)&Symbol->Reserved[0] - (intptr_t)Symbol,

Don't use stdint.h types, there are Win32 types for that.

-- 
Alexandre Julliard
julliard at winehq.org


From maarten at codeweavers.com  Fri Jan 18 05:51:07 2008
From: maarten at codeweavers.com (Maarten Lankhorst)
Date: Fri, 18 Jan 2008 12:51:07 +0100
Subject: Debugger unhappiness blocking valgrind runs
In-Reply-To: <a71bd89a0801171459y5d6aded2rd84cc7634d065ccb@mail.gmail.com>
References: <a71bd89a0801161813t1d9d9a62sf52ec1df8b02227b@mail.gmail.com>	<478FB5BC.9000808@orange.fr>
	<a71bd89a0801171459y5d6aded2rd84cc7634d065ccb@mail.gmail.com>
Message-ID: <479092AB.2020307@codeweavers.com>

Dan Kegel schreef:
> On Jan 17, 2008 12:08 PM, Eric Pouech <eric.pouech at orange.fr> wrote:
>   
>>> http://bugs.winehq.org/show_bug.cgi?id=11211
>>>       
>> you're likely running out of memory (just to be sure, if the test
>> segfaults, but winedbg correctly starts, it's likely the cause)
>>     
>
> It doesn't seem like I'm running out of memory.
> winedbg does not correctly start.
> free shows lots of free swap space.
>
> Amusingly, this shows up now on one of my machines when I run
> Photoshop CS2 tryout.  File / Browse crashes, which
> will bring up winedbg, which crashes, which brings up winedbg,
> which crashes,... you have to do wineserver -k quick or you'll
> have zillions of winedbg's all waiting to be debugged.
>   
A single application can only use 3 gb of memory, it doesn't have to be
actual memory, it can be 'virtual' as well. This means it's reserved,
but it doesn't necessarily have to be used. You can see this in top
under the virt column.



From julliard at winehq.org  Fri Jan 18 09:17:38 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 18 Jan 2008 16:17:38 +0100
Subject: problem with widl.
In-Reply-To: <200801181221.48708.ivan@etersoft.ru> (Ivan Sinitsin's message of
	"Fri, 18 Jan 2008 12:21:46 +0300")
References: <200801181221.48708.ivan@etersoft.ru>
Message-ID: <87abn3b1t9.fsf@wine.dyndns.org>

Ivan Sinitsin <ivan at etersoft.ru> writes:

> What do you think about that?

I put in a fix to use the real parameter names instead.

-- 
Alexandre Julliard
julliard at winehq.org


From alex at thehandofagony.com  Fri Jan 18 10:26:39 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Fri, 18 Jan 2008 17:26:39 +0100
Subject: WWN license issue
In-Reply-To: <478D18A5.9050006@codeweavers.com>
References: <aac02a530801150658o2f335dfagcbf16a5dd8f6a43a@mail.gmail.com>
	<b050a5e70801151220s6dcc3efpc379138fa63867ac@mail.gmail.com>
	<478D18A5.9050006@codeweavers.com>
Message-ID: <200801181726.40090.alex@thehandofagony.com>

On Tuesday 15 January 2008 21:33:41 Jeremy Newman wrote:
> I'll patch it so it points to the GPL v2 licence, unless someone feels
> there is a reason it needs to be v3.
>

Now that you mention it, since we are trying to move the AppDB to the Affero 
GPL v3, it would be nice to have the WWN covered by the similar GLP v3 :)


Alexander N. S?rnes

> Zachary Goldberg wrote:
> > On Jan 15, 2008 9:58 AM, Ian Macfarlane <ian at ianmacfarlane.com> wrote:
> >> At the bottom of each WWN issue (for example, the latest
> >> http://www.winehq.org/?issue=339) is the text:
> >>
> >> "All Kernel Cousin issues and summaries are copyright their original
> >> authors, and distributed under the terms of the GNU General Public
> >> License, version 2.0. "
> >>
> >> However, it links to http://www.gnu.org/licenses/gpl.txt which of
> >> course is now the GPLv3 license text.
> >>
> >> Perhaps the text should change to say version 3 (or perhaps version
> >> 2+), or to the old archived GPLv2 license (IMO the former two options
> >> are preferable).
> >
> > for the record: I have no personal preference on the license.
> > Whatever the WineHQ admins decide on the issue is fine with me.




From kuba at mareimbrium.org  Fri Jan 18 11:54:46 2008
From: kuba at mareimbrium.org (Kuba Ober)
Date: Fri, 18 Jan 2008 12:54:46 -0500
Subject: Suggestion to the list maintainer
In-Reply-To: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
References: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
Message-ID: <200801181254.47144.kuba@mareimbrium.org>

On Wednesday 16 January 2008, kubrick at fgv6.net wrote:
> Hello.
>
> I have many subscriptions to different mailing list with my email-address
> and I'd appreciate a lot to be able to identify a message from this mailing
> list quickly by reading it's subject.
> Could you please add a subject prefix like [WINE-DEVEL] in the mailman
> preferences ? It's very easy to do, so maybe there is a good reason why you
> haven't done it yet...

>
> Thanks.
> Fran?ois.
>
>
>
>
> !DSPAM:478e0614252561039011321!




From kuba at mareimbrium.org  Fri Jan 18 11:55:02 2008
From: kuba at mareimbrium.org (Kuba Ober)
Date: Fri, 18 Jan 2008 12:55:02 -0500
Subject: Suggestion to the list maintainer
In-Reply-To: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
References: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
Message-ID: <200801181255.02957.kuba@mareimbrium.org>

On Wednesday 16 January 2008, kubrick at fgv6.net wrote:
> Hello.
>
> I have many subscriptions to different mailing list with my email-address
> and I'd appreciate a lot to be able to identify a message from this mailing
> list quickly by reading it's subject.
> Could you please add a subject prefix like [WINE-DEVEL] in the mailman
> preferences ? It's very easy to do, so maybe there is a good reason why you
> haven't done it yet...

Just filter on List-Id: Wine Developer's List <wine-devel.winehq.org>

Cheers, Kuba


From kuba at mareimbrium.org  Fri Jan 18 11:56:13 2008
From: kuba at mareimbrium.org (Kuba Ober)
Date: Fri, 18 Jan 2008 12:56:13 -0500
Subject: Suggestion to the list maintainer
In-Reply-To: <53806.195.6.79.173.1200493687.squirrel@www.fgv6.net>
References: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
	<200801161412.08979.research@science.su>
	<53806.195.6.79.173.1200493687.squirrel@www.fgv6.net>
Message-ID: <200801181256.14044.kuba@mareimbrium.org>

> PS : I do find Subject prefixes ugly too... Bu I hadn't found a more handy
> solution.

Don't use squirrelmail, or better yet - fix it. I suggest you replace squirrel 
with Zimbra, it's much better. I'm just a happy user.

Cheers, Kuba


From tokul at users.sourceforge.net  Fri Jan 18 12:06:38 2008
From: tokul at users.sourceforge.net (Tomas Kuliavas)
Date: Fri, 18 Jan 2008 20:06:38 +0200 (EET)
Subject: Suggestion to the list maintainer
In-Reply-To: <200801181256.14044.kuba@mareimbrium.org>
References: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
	<200801161412.08979.research@science.su>
	<53806.195.6.79.173.1200493687.squirrel@www.fgv6.net>
	<200801181256.14044.kuba@mareimbrium.org>
Message-ID: <54607.78.61.224.253.1200679598.nsm@avilys.eik.lt>

>> PS : I do find Subject prefixes ugly too... Bu I hadn't found a more
>> handy solution.
>
> Don't use squirrelmail, or better yet - fix it. I suggest you replace
> squirrel with Zimbra, it's much better. I'm just a happy user.

Zimbra is commercial groupware suite. SquirrelMail is free webmail
application. You are suggesting to replace whole user's email system with
some proprietary locked product.

-- 
Tomas



From timschmidt at gmail.com  Fri Jan 18 13:28:08 2008
From: timschmidt at gmail.com (Tim Schmidt)
Date: Fri, 18 Jan 2008 14:28:08 -0500
Subject: Suggestion to the list maintainer
In-Reply-To: <54607.78.61.224.253.1200679598.nsm@avilys.eik.lt>
References: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
	<200801161412.08979.research@science.su>
	<53806.195.6.79.173.1200493687.squirrel@www.fgv6.net>
	<200801181256.14044.kuba@mareimbrium.org>
	<54607.78.61.224.253.1200679598.nsm@avilys.eik.lt>
Message-ID: <2c97fe9d0801181128n1ab7c4b8y6a62a3b62bb27080@mail.gmail.com>

On Jan 18, 2008 1:06 PM, Tomas Kuliavas <tokul at users.sourceforge.net> wrote:
> Zimbra is commercial groupware suite. SquirrelMail is free webmail
> application. You are suggesting to replace whole user's email system with
> some proprietary locked product.

There's an (at least in name) FOSS version of Zimbra...  but eeew.  I
am tasked with the unfortunate duty of admining a machine running
Zimbra and I can say it's not worth the trouble.  Unless you like Java
processes that gobble 2Gb of ram like cookies, that is.

--tim


From r.kalbermatter at hccnet.nl  Fri Jan 18 13:34:20 2008
From: r.kalbermatter at hccnet.nl (Rolf Kalbermatter)
Date: Fri, 18 Jan 2008 20:34:20 +0100
Subject: GOM player
In-Reply-To: <a71bd89a0801172049x3da45bcck4eda621bb47a380a@mail.gmail.com>
References: <a71bd89a0801171857n6eea25aco5bdd5e926756ccf0@mail.gmail.com><36bf289b0801172038w4b5a7879rbfac8b8f4cb4a218@mail.gmail.com>
	<a71bd89a0801172049x3da45bcck4eda621bb47a380a@mail.gmail.com>
Message-ID: <00c001c85a09$1f568af0$4001a8c0@NATERS>

On 1/17/08, Dan Kegel <dank at kegel.com> wrote:
> http://www.guardian.co.uk/technology/2008/jan/17/linux.korea
> says everyone in Korea uses the GOM player...
> It installs ok, but blew up when I tried to load the Sony music 
> stream from its playlist. ...
> http://www.gomplayer.com/
> supposedly comes with lots of codecs.

I tried it some time ago. On the pro side it supports just about any
media stream out of the box, well ok quite a lot. It's a one time stop
for RM, WMF and QT media.

On the con side I didn't like it's perseverance in trying to install all
kinds of additional "gadgets" that I wouldn't care of or wouldn't fully
trust with.

As nice as it seemed to be able to watch just about every common media
format out there, I deinstalled it after a short trial. Didn't test it
in Wine though as watching media in Linux itself although not as painless
isn't that difficult either.

For my Windows box I use Media Player Classic with QT and RM codec support
now and that works almost flawlessly.

Rolf Kalbermatter



From eric.pouech at orange.fr  Fri Jan 18 14:14:13 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Fri, 18 Jan 2008 21:14:13 +0100
Subject: [dbghelp 4/10] Rewrite much of the symbol lookup method to work
	with	Optimized PDB files as well
In-Reply-To: <df81031c0801171448u1d9c116bo1c3fb4d8efe88330@mail.gmail.com>
References: <df81031c0801171448u1d9c116bo1c3fb4d8efe88330@mail.gmail.com>
Message-ID: <47910895.5070709@orange.fr>

Jason Green a ?crit :
> ------------------------------------------------------------------------
>
> From 14d91ebd5974c8fc02f8b83d53e8eff0df7ad76d Mon Sep 17 00:00:00 2001
> From: Jason Green <jason at jave01.(none)>
> Date: Thu, 17 Jan 2008 16:41:11 -0500
> Subject: [PATCH] Rewrite much of the symbol lookup method to work with Optimized PDB files as well.
> Also, improves a number of TRACEs, and wraps strings in the debugstr() functions.
>   
what's the rationale of optimized pdb ?
the patch is already big enough not to mix code evolution with stuffing 
new trace:s all over the place
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From eric.pouech at orange.fr  Fri Jan 18 14:20:25 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Fri, 18 Jan 2008 21:20:25 +0100
Subject: [dbghelp 7/10] Fix file searching to search only listed
	directories instead of the whole HD
In-Reply-To: <df81031c0801171450l7c03511dke748ce0d5f7fd5c1@mail.gmail.com>
References: <df81031c0801171450l7c03511dke748ce0d5f7fd5c1@mail.gmail.com>
Message-ID: <47910A09.1090603@orange.fr>

Jason Green a ?crit :
> ------------------------------------------------------------------------
>
> From ad95ee9cad0df8b4e8ca35d2d5a280d755c7bf7f Mon Sep 17 00:00:00 2001
> From: Jason Green <jason at jave01.(none)>
> Date: Thu, 17 Jan 2008 17:21:00 -0500
> Subject: [PATCH] Fix file searching to search only listed directories instead of the whole HD.
> And, wrap some TRACE parameters in debugstr.
> From: Eric van Beurden (ericvb at transgaming.com)
> ---
>  dlls/dbghelp/path.c |   14 +++++++-------
>  1 files changed, 7 insertions(+), 7 deletions(-)
>
> diff --git a/dlls/dbghelp/path.c b/dlls/dbghelp/path.c
> index 2e191af..fac9dc0 100644
> --- a/dlls/dbghelp/path.c
> +++ b/dlls/dbghelp/path.c
> @@ -57,7 +57,7 @@ HANDLE WINAPI FindDebugInfoFile(PCSTR FileName, PCSTR SymbolPath, PSTR DebugFile
>  {
>      HANDLE      h;
>  
> -    h = CreateFileA(DebugFilePath, GENERIC_READ, FILE_SHARE_READ, NULL,
> +    h = CreateFileA(FileName, GENERIC_READ, FILE_SHARE_READ, NULL,
>                      OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
>   
you failed to set DebugFilePath to the desired value
again the rest of the patch has nothing to do with the first part of the 
patch
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From eric.pouech at orange.fr  Fri Jan 18 14:22:53 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Fri, 18 Jan 2008 21:22:53 +0100
Subject: [dbghelp 10/10] Clamp minidump memory blocks to 928KB
In-Reply-To: <df81031c0801171451t17cdacc1sf05e1e6759d10426@mail.gmail.com>
References: <df81031c0801171451t17cdacc1sf05e1e6759d10426@mail.gmail.com>
Message-ID: <47910A9D.9090708@orange.fr>

Jason Green a ?crit :
> ------------------------------------------------------------------------
>
> From 1127317807ec264541e2e03e6a633cefee8f697b Mon Sep 17 00:00:00 2001
> From: Jason Green <jason at jave01.(none)>
> Date: Thu, 17 Jan 2008 17:43:41 -0500
> Subject: [PATCH] Clamp minidump memory blocks to 928KB and improve TRACEs
> WinDbg can't read minidumps with memory blocks larger than this.
> From: Eric van Beurden (ericvb at transgaming.com)
> ---
>  dlls/dbghelp/minidump.c |   35 +++++++++++++++++++++++++++++++++--
>  1 files changed, 33 insertions(+), 2 deletions(-)
>
> diff --git a/dlls/dbghelp/minidump.c b/dlls/dbghelp/minidump.c
> index 564d824..f113728 100644
> --- a/dlls/dbghelp/minidump.c
> +++ b/dlls/dbghelp/minidump.c
> @@ -32,6 +32,13 @@
>  
>  WINE_DEFAULT_DEBUG_CHANNEL(dbghelp);
>  
> +
> +/* windbg isn't able to open minidump files if they contain a single memory block larger 
> +   than 928KB.  If a larger block is found, it simply reports that all following streams
> +   could not be loaded.  This is as of WinDbg version 6.7.0005.1. */
> +#define MINIDUMP_MEMORY_BLOCK_MAX   (928 * 1024)
> +
> +
>  struct dump_memory
>  {
>      ULONG                               base;
> @@ -640,8 +647,32 @@ static  void    dump_threads(struct dump_context* dc,
>              }
>              if (mdThd.Stack.Memory.DataSize && (flags_out & ThreadWriteStack))
>              {
> -                add_memory_block(dc, mdThd.Stack.StartOfMemoryRange,
> -                                 mdThd.Stack.Memory.DataSize,
> +                ULONG   size;
> +                ULONG64 base;
> +
> +
> +                /* windbg only supports memory blocks up to 928KB in size.  Not sure where that
> +                   specific amount comes from, but in testing it will completely fail to load
> +                   all minidump streams that follow a memory block that is larger than 928KB.
> +                   Because of this, we'll clamp all of the memory blocks that we add to the
> +                   file. */                   
> +                if (mdThd.Stack.Memory.DataSize > MINIDUMP_MEMORY_BLOCK_MAX){
> +                    size = MINIDUMP_MEMORY_BLOCK_MAX;
> +
> +                    /* since this is the thread stack we'll want to save this block top-down
> +                       instead of just clamping the buffer size */
> +                    base = mdThd.Stack.StartOfMemoryRange + (mdThd.Stack.Memory.DataSize - MINIDUMP_MEMORY_BLOCK_MAX);
> +
> +                    TRACE("    clamping the stack block starting at 0x%08llx {oldSize = %u bytes, newSize = %u bytes, newBase = 0x%08llx}\n",
> +                            mdThd.Stack.StartOfMemoryRange, mdThd.Stack.Memory.DataSize, size, base);
> +                }
> +
> +                else{
> +                    size = mdThd.Stack.Memory.DataSize;
> +                    base = mdThd.Stack.StartOfMemoryRange;
> +                }
> +
> +                add_memory_block(dc, base, size,
>                                   rva_base + sizeof(mdThdList.NumberOfThreads) +
>                                       mdThdList.NumberOfThreads * sizeof(mdThd) +
>                                       FIELD_OFFSET(MINIDUMP_THREAD, Stack.Memory.Rva));
>   
> ------------------------------------------------------------------------
>
>
>   
if that's really the case (and I'm even not sure we want to support this 
backward compatibility), a good fix would be to add several streams each 
up to 928k instead of clamping
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From xerox_xerox2000 at yahoo.co.uk  Fri Jan 18 14:44:55 2008
From: xerox_xerox2000 at yahoo.co.uk (Louis Lenders)
Date: Fri, 18 Jan 2008 20:44:55 +0000 (UTC)
Subject: GOM player
References: <a71bd89a0801171857n6eea25aco5bdd5e926756ccf0@mail.gmail.com><36bf289b0801172038w4b5a7879rbfac8b8f4cb4a218@mail.gmail.com>
	<a71bd89a0801172049x3da45bcck4eda621bb47a380a@mail.gmail.com>
	<00c001c85a09$1f568af0$4001a8c0@NATERS>
Message-ID: <loom.20080118T204103-978@post.gmane.org>



> 
> On 1/17/08, Dan Kegel <dank <at> kegel.com> wrote:
> > http://www.guardian.co.uk/technology/2008/jan/17/linux.korea
> > says everyone in Korea uses the GOM player...
> > It installs ok, but blew up when I tried to load the Sony music 
> > stream from its playlist. ...
> > http://www.gomplayer.com/
> > supposedly comes with lots of codecs.

> 
> 


Rolf Kalbermatter <r.kalbermatter <at> hccnet.nl> writes:

I tested it in wine, doesn't play anything in plain wine. With native quartz
(and installing some codecs with winetricks) it works , but there is still some
issues: window can't be moved, and it displays the movies just too bright.
Unfortunately I haven't seen any work on quartz latest months/years. For now i'd
give it a bronze rating.....



From brian.vincent at gmail.com  Fri Jan 18 20:11:20 2008
From: brian.vincent at gmail.com (Brian Vincent)
Date: Fri, 18 Jan 2008 19:11:20 -0700
Subject: WWN license issue
In-Reply-To: <200801181726.40090.alex@thehandofagony.com>
References: <aac02a530801150658o2f335dfagcbf16a5dd8f6a43a@mail.gmail.com>
	<b050a5e70801151220s6dcc3efpc379138fa63867ac@mail.gmail.com>
	<478D18A5.9050006@codeweavers.com>
	<200801181726.40090.alex@thehandofagony.com>
Message-ID: <3010968c0801181811x4e398431ie1f3301c43071ccf@mail.gmail.com>

On Jan 18, 2008 9:26 AM, Alexander Nicolaysen S?rnes <
alex at thehandofagony.com> wrote:

> Now that you mention it, since we are trying to move the AppDB to the
Affero
> GPL v3, it would be nice to have the WWN covered by the similar GLP v3 :)

Everything I wrote was GPL v2 and I'm quite happy with that.

-Brian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080118/72a50d29/attachment.htm 

From brian.vincent at gmail.com  Fri Jan 18 20:30:21 2008
From: brian.vincent at gmail.com (Brian Vincent)
Date: Fri, 18 Jan 2008 19:30:21 -0700
Subject: Wine font license
Message-ID: <3010968c0801181830u50dc9111n2c18573797c23ea5@mail.gmail.com>

Right now on our fonts we say they're LGPL.  (Look for the LangName
attribute in the .sfd file.)

We might want to make a modification to that.  Here's what the FSF has
to say about it:
http://www.fsf.org/licensing/licenses/gpl-faq.html#FontException

Or, to just copy and paste that info:
-----------------------8<-----------------
"How does the GPL apply to fonts?"

Font licensing is a complex issue which needs serious consideration.
The following license exception is experimental but approved for
general use. We welcome suggestions on this subject?please see this
this explanatory essay and write to licensing at gnu.org.

 To use this exception, add this text to the license notice of each
file in the package (to the extent possible), at the end of the text
that says the file is distributed under the GNU GPL:

 As a special exception, if you create a document which uses this
font, and embed this font or unaltered portions of this font into the
document, this font does not by itself cause the resulting document to
be covered by the GNU General Public License. This exception does not
however invalidate any other reasons why the document might be covered
by the GNU General Public License. If you modify this font, you may
extend this exception to your version of the font, but you are not
obligated to do so. If you do not wish to do so, delete this exception
statement from your version.

-Brian


From raccoonone at procyongames.com  Sat Jan 19 00:32:29 2008
From: raccoonone at procyongames.com (Christopher)
Date: Fri, 18 Jan 2008 22:32:29 -0800
Subject: Fix for LoadStringW
In-Reply-To: <877ii87kik.fsf@tac.ki.iif.hu>
References: <478F0460.3050709@procyongames.com>	<22821af30801162340u7f0324a1k969f1599586bebc3@mail.gmail.com>	<478F0D6C.3060106@procyongames.com>	<008601c858e9$b00a04d0$a600fea9@DMITRY>
	<877ii87kik.fsf@tac.ki.iif.hu>
Message-ID: <4791997D.9080002@procyongames.com>

Ferenc Wagner wrote:
> "Dmitry Timoshkov" <dmitry at codeweavers.com> writes:
>
>   
>> "Christopher" <raccoonone at procyongames.com> wrote:
>>
>>     
>>> Thanks for pointing that out! Am I suppose to attach a test case for all 
>>> my patches to wine-patches? I had submitted a testcase under the bug 
>>> report I filed, so I didn't attach it to the email.
>>>       
>> You have to add the test to the exiting tests in dlls/kernel32/tests
>>     
>
> Actually, there are LoadStringA tests in dlls/user32/tests/resource.c,
> maybe it's best to team up with those (and possibly extend for the
> same set of tests).
>   
I read the documentation on writing conformance tests. But is there a 
way for me to compile the tests under Linux to run on Windows? Having 
never written a conformance test before I would like to test it out on 
my own before I submit it. Also, once I write the test do I submit it at 
the same time as my patch, or do I need to submit the test first and 
wait for it to be accepted before sending in my patch?

Christopher


From Stefan.Leichter at camline.com  Sat Jan 19 02:35:16 2008
From: Stefan.Leichter at camline.com (Stefan Leichter)
Date: Sat, 19 Jan 2008 09:35:16 +0100
Subject: Fix for LoadStringW
In-Reply-To: <4791997D.9080002@procyongames.com>
References: <478F0460.3050709@procyongames.com> <877ii87kik.fsf@tac.ki.iif.hu>
	<4791997D.9080002@procyongames.com>
Message-ID: <200801190935.16229.Stefan.Leichter@camline.com>

Am Saturday 19 January 2008 07:32 schrieb Christopher:
> Ferenc Wagner wrote:
> > "Dmitry Timoshkov" <dmitry at codeweavers.com> writes:
> >> "Christopher" <raccoonone at procyongames.com> wrote:
> >>> Thanks for pointing that out! Am I suppose to attach a test case for
> >>> all my patches to wine-patches? I had submitted a testcase under the
> >>> bug report I filed, so I didn't attach it to the email.
> >>
> >> You have to add the test to the exiting tests in dlls/kernel32/tests
> >
> > Actually, there are LoadStringA tests in dlls/user32/tests/resource.c,
> > maybe it's best to team up with those (and possibly extend for the
> > same set of tests).
>
> I read the documentation on writing conformance tests. But is there a
> way for me to compile the tests under Linux to run on Windows? Having
> never written a conformance test before I would like to test it out on
> my own before I submit it. Also, once I write the test do I submit it at
> the same time as my patch, or do I need to submit the test first and
> wait for it to be accepted before sending in my patch?
>
> Christopher
To build your tests you can use mingw as cross compiler. See 
http://www.winehq.org/site/docs/winedev-guide/cross-compiling-tests
http://www.winehq.org/pipermail/wine-devel/2006-December/053069.html

You can send the tests and the fix for wine at the same time.

Bye Stefan


From alex at thehandofagony.com  Sat Jan 19 06:06:13 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?utf-8?q?S=C3=B8rnes?=)
Date: Sat, 19 Jan 2008 13:06:13 +0100
Subject: WWN license issue
In-Reply-To: <3010968c0801181811x4e398431ie1f3301c43071ccf@mail.gmail.com>
References: <aac02a530801150658o2f335dfagcbf16a5dd8f6a43a@mail.gmail.com>
	<200801181726.40090.alex@thehandofagony.com>
	<3010968c0801181811x4e398431ie1f3301c43071ccf@mail.gmail.com>
Message-ID: <200801191306.14404.alex@thehandofagony.com>

On Saturday 19 January 2008 03:11:20 Brian Vincent wrote:
> On Jan 18, 2008 9:26 AM, Alexander Nicolaysen S?rnes <
>
> alex at thehandofagony.com> wrote:
> > Now that you mention it, since we are trying to move the AppDB to the
>
> Affero
>
> > GPL v3, it would be nice to have the WWN covered by the similar GLP v3 :)
>
> Everything I wrote was GPL v2 and I'm quite happy with that.
>
> -Brian


Oh.  Which parts ddi you work on?  It might be a good idea to add author 
information to each file to allow for an easier overview of such issues.



Alexander N. S?rnes


From kuba at mareimbrium.org  Sat Jan 19 07:18:52 2008
From: kuba at mareimbrium.org (Kuba Ober)
Date: Sat, 19 Jan 2008 08:18:52 -0500
Subject: Suggestion to the list maintainer
In-Reply-To: <54607.78.61.224.253.1200679598.nsm@avilys.eik.lt>
References: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
	<200801181256.14044.kuba@mareimbrium.org>
	<54607.78.61.224.253.1200679598.nsm@avilys.eik.lt>
Message-ID: <200801190818.52609.kuba@mareimbrium.org>

On Friday 18 January 2008, Tomas Kuliavas wrote:
> >> PS : I do find Subject prefixes ugly too... Bu I hadn't found a more
> >> handy solution.
> >
> > Don't use squirrelmail, or better yet - fix it. I suggest you replace
> > squirrel with Zimbra, it's much better. I'm just a happy user.
>
> Zimbra is commercial groupware suite. SquirrelMail is free webmail
> application. You are suggesting to replace whole user's email system with
> some proprietary locked product.

It works pretty well, is free as in beer, and the only "closed" parts are its 
Java core. A lot of other stuff, such as the JavaScript framework, and reused 
OSS project, are still open-source.

I have been using it for a year and I really beats everything else out the 
hands down. IMHO of course.

Cheers, Kuba


From kuba at mareimbrium.org  Sat Jan 19 07:26:37 2008
From: kuba at mareimbrium.org (Kuba Ober)
Date: Sat, 19 Jan 2008 08:26:37 -0500
Subject: Suggestion to the list maintainer
In-Reply-To: <2c97fe9d0801181128n1ab7c4b8y6a62a3b62bb27080@mail.gmail.com>
References: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
	<54607.78.61.224.253.1200679598.nsm@avilys.eik.lt>
	<2c97fe9d0801181128n1ab7c4b8y6a62a3b62bb27080@mail.gmail.com>
Message-ID: <200801190826.37891.kuba@mareimbrium.org>

On Friday 18 January 2008, Tim Schmidt wrote:
> On Jan 18, 2008 1:06 PM, Tomas Kuliavas <tokul at users.sourceforge.net> wrote:
> > Zimbra is commercial groupware suite. SquirrelMail is free webmail
> > application. You are suggesting to replace whole user's email system with
> > some proprietary locked product.
>
> There's an (at least in name) FOSS version of Zimbra...  but eeew.  I
> am tasked with the unfortunate duty of admining a machine running
> Zimbra and I can say it's not worth the trouble.  Unless you like Java
> processes that gobble 2Gb of ram like cookies, that is.

On my server, the mysqld which runs the backend for Zimbra is taking up 0.4GB 
virtual, while Tomcat takes 1.1GB virtual. So don't bash Java just yet, as 
the "old school" DB server is taking up 1/4th of the system's virtual memory.

I don't really have much (or anything) in the way of problems with Zimbra. It 
uses the same ldap server for authentication as pam (ssh, etc) and samba, 
works pretty well with firefox, IE7 and IE6 with the service pack, and 
generally looks pleasant to the users.

There's no other equally functional solution out there that would be any 
better. I did my searching. Scalix took ages for me just to figure out how to 
set it up (they think that out-of-the-box functionality is an option, and 
that misleading or outright wrong documentation is OK), and besides those two 
there's really nothing else for a mostly OSS shop to deploy.

Having run squirrel for a 5+ years, and some of the most annoying bugs 
remaining unfixed (say support for national characters that actually works in 
real life), I just gave up.

Cheers, Kuba


From adamrimon at gmail.com  Sat Jan 19 07:58:14 2008
From: adamrimon at gmail.com (Adam Rimon)
Date: Sat, 19 Jan 2008 15:58:14 +0200
Subject: gdiplus: DEFINE_GUID
Message-ID: <479201F6.2080002@gmail.com>

Hi there,


I wanted to implement some gdiplus functions, but for this I need the 
GUIDs of some properties.

I took the GUIDs from 
http://www.reactos.org/generated/doxygen/db/de2/gdiplusimaging_8h-source.html,

but when I tried to compile gdiplus with the new gdiplusimaging.h with 
many DEFINE_GUID's,

the compiler kept complaining that "hidden symbol `FrameDimensionPage' 
isn't defined".


What did I do wrong?


-Adam




From tokul at users.sourceforge.net  Sat Jan 19 08:34:05 2008
From: tokul at users.sourceforge.net (Tomas Kuliavas)
Date: Sat, 19 Jan 2008 16:34:05 +0200 (EET)
Subject: Suggestion to the list maintainer
In-Reply-To: <200801190818.52609.kuba@mareimbrium.org>
References: <40546.195.6.79.173.1200489938.squirrel@www.fgv6.net>
	<200801181256.14044.kuba@mareimbrium.org>
	<54607.78.61.224.253.1200679598.nsm@avilys.eik.lt>
	<200801190818.52609.kuba@mareimbrium.org>
Message-ID: <50826.78.61.224.253.1200753245.nsm@avilys.eik.lt>


Sorry to other list readers about offtopic rant, but I can't stand when
people attack software that I like.

>> >> PS : I do find Subject prefixes ugly too... Bu I hadn't found a more
>> >> handy solution.
>> >
>> > Don't use squirrelmail, or better yet - fix it. I suggest you replace
>> > squirrel with Zimbra, it's much better. I'm just a happy user.
>>
>> Zimbra is commercial groupware suite. SquirrelMail is free webmail
>> application. You are suggesting to replace whole user's email system
>> with some proprietary locked product.
>
> It works pretty well, is free as in beer, and the only "closed" parts are
> its
> Java core. A lot of other stuff, such as the JavaScript framework, and
> reused OSS project, are still open-source.

Main Zimbra's product is not Open Source Edition. Zimbra sells its
products on annual/monthly subscription per seat basis.

Outlook, iSync, Blackberry, mobile connectors. Clustering. Backups. These
are not open.

Do Zimbra admins know how their email setup works or just click on
provided buttons? Can they change setup from default values without
breaking it completely? Do admins have option to revert their changes, if
something breaks? What happens if you deviate from standard OpenSource
Edition setup and see cryptic Java errors in your logs or Zimbra web
pages.

> I have been using it for a year and I really beats everything else out the
> hands down. IMHO of course.

I've been using SquirrelMail for more than 6 years.

You are comparing apples to oranges. Zimbra is not email client. It has
email client as part of whole server package. Zimbra's webmail client uses
AJAX, has better integration with email system (it is designed for Zimbra)
and it can't be compared with SquirrelMail. SquirrelMail is email system
agnostic. It works with any email setup that has good IMAP4rev1 service.
SquirrelMail has bundled client side filtering support, but use of server
side filtering with SquirrelMail is recommended. Client side filtering is
slow, because SquirrelMail is webmail client written in PHP without any
direct access to existing email setup.

Zimbra can't replace SquirrelMail, because it also replaces IMAP, SMTP and
POP services and other parts of email setup. Zimbra adds features that are
not needed for standard email client.

Suggestion to tag subject of mailing list emails is a good one. Mailman
can do that. I think some email clients (Outlook Express) can't filter
emails by custom headers.

from other email
> Having run squirrel for a 5+ years, and some of the most annoying bugs
> remaining unfixed (say support for national characters that actually works
> in real life)

Prove your claims. When these issues are related to broken MIME produced
by other software? When they are related to the fact that translations are
locked on charsets specific to selected language/country? When they are
related to big CJK charset tables that are hard to implement in pure PHP?

SquirrelMail does not use utf-8 for historical reasons, but you can always
change it to utf-8 if you want. Charset support was improved since 1.4.4.
It was 3-4 years ago.

I am former SquirrelMail i18n developer and I suspect that you are
spreading FUD about SquirrelMail. SquirrelMail has issues, but you and
others are free to fix them. If Zimbra has issues, you will have to wait
until Yahoo fixes it.

-- 
Tomas



From Andrew.Talbot at talbotville.com  Sat Jan 19 09:41:23 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 19 Jan 2008 15:41:23 +0000
Subject: shdocvw: Remove unneeded cast
References: <200801191456.43012.andrew.talbot@talbotville.com>
Message-ID: <fmt5n3$dsi$1@ger.gmane.org>

By coincidence, I've edited the same line as Jacek Caban in his
patch "shdocvw: Store URL in BindStatusCallback" but in a different way. So
if the two clash, please drop my patch: I shall revise it and try again
after you have considered his.

Thanks,

-- 
Andy.




From zgold550 at gmail.com  Sat Jan 19 10:32:58 2008
From: zgold550 at gmail.com (Zachary Goldberg)
Date: Sat, 19 Jan 2008 11:32:58 -0500
Subject: WWN license issue
In-Reply-To: <200801191306.14404.alex@thehandofagony.com>
References: <aac02a530801150658o2f335dfagcbf16a5dd8f6a43a@mail.gmail.com>
	<200801181726.40090.alex@thehandofagony.com>
	<3010968c0801181811x4e398431ie1f3301c43071ccf@mail.gmail.com>
	<200801191306.14404.alex@thehandofagony.com>
Message-ID: <b050a5e70801190832m5a5683besbbb9e2aba77ce94e@mail.gmail.com>

On Jan 19, 2008 7:06 AM, Alexander Nicolaysen S?rnes
<alex at thehandofagony.com> wrote:
>
> On Saturday 19 January 2008 03:11:20 Brian Vincent wrote:
> > On Jan 18, 2008 9:26 AM, Alexander Nicolaysen S?rnes <
> >
> > alex at thehandofagony.com> wrote:
> > > Now that you mention it, since we are trying to move the AppDB to the
> >
> > Affero
> >
> > > GPL v3, it would be nice to have the WWN covered by the similar GLP v3 :)
> >
> > Everything I wrote was GPL v2 and I'm quite happy with that.
> >
> > -Brian
>
>
> Oh.  Which parts ddi you work on?  It might be a good idea to add author
> information to each file to allow for an easier overview of such issues.
>
>
>
> Alexander N. S?rnes
>

There is an <author> tag at the top of each issue that I've written,
and I know Brian did the same thing.  I've only been writing since
333; Brian wrote for a long time before me.

-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From alex at thehandofagony.com  Sat Jan 19 10:47:28 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Sat, 19 Jan 2008 17:47:28 +0100
Subject: WWN license issue
In-Reply-To: <b050a5e70801190832m5a5683besbbb9e2aba77ce94e@mail.gmail.com>
References: <aac02a530801150658o2f335dfagcbf16a5dd8f6a43a@mail.gmail.com>
	<200801191306.14404.alex@thehandofagony.com>
	<b050a5e70801190832m5a5683besbbb9e2aba77ce94e@mail.gmail.com>
Message-ID: <200801191747.28802.alex@thehandofagony.com>

On Saturday 19 January 2008 17:32:58 Zachary Goldberg wrote:
> On Jan 19, 2008 7:06 AM, Alexander Nicolaysen S?rnes
>
> <alex at thehandofagony.com> wrote:
> > On Saturday 19 January 2008 03:11:20 Brian Vincent wrote:
> > > On Jan 18, 2008 9:26 AM, Alexander Nicolaysen S?rnes <
> > >
> > > alex at thehandofagony.com> wrote:
> > > > Now that you mention it, since we are trying to move the AppDB to the
> > >
> > > Affero
> > >
> > > > GPL v3, it would be nice to have the WWN covered by the similar GLP
> > > > v3 :)
> > >
> > > Everything I wrote was GPL v2 and I'm quite happy with that.
> > >
> > > -Brian
> >
> > Oh.  Which parts ddi you work on?  It might be a good idea to add author
> > information to each file to allow for an easier overview of such issues.
> >
> >
> >
> > Alexander N. S?rnes
>
> There is an <author> tag at the top of each issue that I've written,
> and I know Brian did the same thing.  I've only been writing since
> 333; Brian wrote for a long time before me.


Ah, my mistake.  I thought he meant the AppDB.  



Alexander


From eric.pouech at orange.fr  Sat Jan 19 10:50:35 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Sat, 19 Jan 2008 17:50:35 +0100
Subject: WWN license issue
In-Reply-To: <3010968c0801181811x4e398431ie1f3301c43071ccf@mail.gmail.com>
References: <aac02a530801150658o2f335dfagcbf16a5dd8f6a43a@mail.gmail.com>	<b050a5e70801151220s6dcc3efpc379138fa63867ac@mail.gmail.com>	<478D18A5.9050006@codeweavers.com>	<200801181726.40090.alex@thehandofagony.com>
	<3010968c0801181811x4e398431ie1f3301c43071ccf@mail.gmail.com>
Message-ID: <47922A5B.6060609@orange.fr>

Brian Vincent a ?crit :
> On Jan 18, 2008 9:26 AM, Alexander Nicolaysen S?rnes 
> <alex at thehandofagony.com <mailto:alex at thehandofagony.com>> wrote:
>
> > Now that you mention it, since we are trying to move the AppDB to 
> the Affero
> > GPL v3, it would be nice to have the WWN covered by the similar GLP 
> v3 :)
>
> Everything I wrote was GPL v2 and I'm quite happy with that.
>
> -Brian
> ------------------------------------------------------------------------
>
>
>   
same for me (regarding WWN)
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From jeremielapuree at yahoo.fr  Sat Jan 19 11:13:52 2008
From: jeremielapuree at yahoo.fr (paulo lesgaz)
Date: Sat, 19 Jan 2008 18:13:52 +0100 (CET)
Subject: d3dx9_24: first implementation
In-Reply-To: <47922A5B.6060609@orange.fr>
Message-ID: <10142.11843.qm@web26002.mail.ukl.yahoo.com>

Hello Tony

You need to forward all the functions of d3dx9_24 to these ones of d3dx9_36; not only these ones that are already implemented in d3dx9_36.

Moreover, when you create a new dll, you need to change plenty of files:
configure
configure.ac
Makefile.in
in the folder ~/wine-git/

You can take as example your d3dx9_36 implementation at this  following link: http://source.winehq.org/git/wine.git/?a=commitdiff;h=87fefc7ef4eabef2b5869d75c7

David

             
---------------------------------
 Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080119/9c8a5ea1/attachment.htm 

From truiken at gmail.com  Sat Jan 19 12:06:51 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 19 Jan 2008 12:06:51 -0600
Subject: gdiplus: DEFINE_GUID
In-Reply-To: <479201F6.2080002@gmail.com>
References: <479201F6.2080002@gmail.com>
Message-ID: <22821af30801191006g79c3e0fep5950f2c01ce8da0c@mail.gmail.com>

On Jan 19, 2008 7:58 AM, Adam Rimon <adamrimon at gmail.com> wrote:
> Hi there,
>
>
> I wanted to implement some gdiplus functions, but for this I need the
> GUIDs of some properties.
>
> I took the GUIDs from
> http://www.reactos.org/generated/doxygen/db/de2/gdiplusimaging_8h-source.html,
>
> but when I tried to compile gdiplus with the new gdiplusimaging.h with
> many DEFINE_GUID's,
>
> the compiler kept complaining that "hidden symbol `FrameDimensionPage'
> isn't defined".
>
>
> What did I do wrong?
>

Don't copy code from ReactOS and submit it to Wine.

-- 
James Hawkins


From truiken at gmail.com  Sat Jan 19 12:14:49 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 19 Jan 2008 12:14:49 -0600
Subject: d3dx9_24: first implementation
In-Reply-To: <10142.11843.qm@web26002.mail.ukl.yahoo.com>
References: <47922A5B.6060609@orange.fr>
	<10142.11843.qm@web26002.mail.ukl.yahoo.com>
Message-ID: <22821af30801191014i7ccbdb5fid2e452da2dce4402@mail.gmail.com>

On Jan 19, 2008 11:13 AM, paulo lesgaz <jeremielapuree at yahoo.fr> wrote:
> Hello Tony
>
> You need to forward all the functions of d3dx9_24 to these ones of d3dx9_36;
> not only these ones that are already implemented in d3dx9_36.
>
> Moreover, when you create a new dll, you need to change plenty of files:
> configure
> configure.ac
> Makefile.in
> in the folder ~/wine-git/
>

No, you don't need to include any autogenerated files in the patch.

-- 
James Hawkins


From jjmckenzie51 at sprintpcs.com  Sat Jan 19 12:24:04 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 19 Jan 2008 11:24:04 -0700
Subject: gdiplus: DEFINE_GUID
In-Reply-To: <22821af30801191006g79c3e0fep5950f2c01ce8da0c@mail.gmail.com>
References: <479201F6.2080002@gmail.com>
	<22821af30801191006g79c3e0fep5950f2c01ce8da0c@mail.gmail.com>
Message-ID: <47924044.40504@sprintpcs.com>

James Hawkins wrote:
> On Jan 19, 2008 7:58 AM, Adam Rimon <adamrimon at gmail.com> wrote:
>   
>> Hi there,
>>
>>
>> I wanted to implement some gdiplus functions, but for this I need the
>> GUIDs of some properties.
>>
>> I took the GUIDs from
>> http://www.reactos.org/generated/doxygen/db/de2/gdiplusimaging_8h-source.html,
>>
>> but when I tried to compile gdiplus with the new gdiplusimaging.h with
>> many DEFINE_GUID's,
>>
>> the compiler kept complaining that "hidden symbol `FrameDimensionPage'
>> isn't defined".
>>
>>
>> What did I do wrong?
>>
>>     
>
> Don't copy code from ReactOS and submit it to Wine.
>
>   
Adam:

It is not permitted (and I don't know or care to know the reason why), 
code from the ReactOS project and attempt to put it in the Wine project.

You will have to make, from the ground up, new code.  However, if you 
attempt to submit it, these changes may be rejected in the future.

James McKenzie
(I am not allowed to submit code because I have an active MSDN 
subscription which gives me access to Windows and Windows project source 
code.)



From tony.wasserka at freenet.de  Sat Jan 19 12:22:06 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Sat, 19 Jan 2008 19:22:06 +0100
Subject: d3dx9_24: first implementation
Message-ID: <E1JGIKU-0008LW-9f@www13.emo.freenet-rz.de>

> You need to forward all the functions of d3dx9_24 to these ones of d3dx9_36;
> not only these ones that are already implemented in d3dx9_36.
> 
> Moreover, when you create a new dll, you need to change plenty of files:
> configure
> configure.ac
> Makefile.in
> in the folder ~/wine-git/
> 
> You can take as example your d3dx9_36 implementation at this  following
> link:
> http://source.winehq.org/git/wine.git/?a=commitdiff;h=87fefc7ef4eabef2b5869d
> 75c7
> 
> David

Hm, seems like I acted a little bit too hectic again...
I will send a fix within the next two days.
However, the configure.ac, Makefile.in etc, are autogenerated files from tools/make_makefiles, aren't they?
That automatically changes these files and so I don't need to patch these manually as far as I understood.
Anyways, thanks for pointing to my mistake.











From dank at kegel.com  Sat Jan 19 12:34:00 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 19 Jan 2008 18:34:00 +0000
Subject: Need help getting alt key remapping tips right for Photoshop users
Message-ID: <a71bd89a0801191034t6bc9d39pc6115613c9c0f735@mail.gmail.com>

As of a few days ago, Photoshop CS2 activation works!
IMHO the announcement for wine-0.9.54 should
mention this prominently, and ask Photoshop users
to test it and report bugs.  In preparation for this,
I'm gathering tips for users at http://wiki.winehq.org/AdobePhotoshop
and will copy them into the appdb page for each version
of Photoshop once I've got them together.

The tough part is getting the instructions for alt key
remapping right (so the window manager doesn't
steal the key combinations normally used by photoshop's
clone tool).   I have instructions for a couple distributions
there (ubuntu and suse with KDE).

I'm looking for volunteers to check those instructions
and correct them if they're incorrect or incomplete.
Any takers?

Thanks,
Dan


From rob at codeweavers.com  Sat Jan 19 13:26:45 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Sat, 19 Jan 2008 19:26:45 +0000
Subject: Shared IDL Imports
Message-ID: <47924EF5.7070802@codeweavers.com>

Hi all,

I've got a patch pending in my tree that adds another IDL file in 
include/wine/ but it has a dependency on another new IDL file in the 
same directory. The trouble is that the patch in the import statement 
gets lost in the generated IDL file. The attached diff shows an example 
of this, which gives the following error:

~/Documents/wine/dlls/ole32 rob$ make
../../tools/widl/widl -I. -I. -I../../include -I../../include  
-D__WINESRC__ -D_OLE32_ -DCOM_NO_WINDOWS_H  -h -H irot.h irot.idl
gcc -c -I. -I. -I../../include -I../../include  -D__WINESRC__ -D_OLE32_ 
-DCOM_NO_WINDOWS_H -D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing 
-Wdeclaration-after-statement -Wwrite-strings -Wpointer-arith  -g -O2  
-o moniker.o moniker.c
In file included from moniker.c:48:
irot.h:11:18: error: test.h: No such file or directory

I see an number of options for fixing this, but they all have problems:

Solution 1: Fix the generation of include statements in header files 
generated from the IDL to include the path. This has the issue that it 
is not compatible with MIDL, so testing our IDL files with it becomes 
difficult (MIDL appears to only search in the current directory when it 
encounters an import statement with a path).
Solution 2: Include the dependent IDL file instead of importing it. This 
has the issue that the include needs to be guarded so that the 
definitions don't get declared if the dependent IDL file's header is 
imported before or after the first IDL file's header. This also has the 
trouble that it isn't compatible with MIDL as the guards are different 
between MIDL and widl.
Solution 3: Put the IDL files in another directory (e.g. include/idl) 
and add that to the -I statement in CFLAGS and not using a path in the 
import statment in the first IDL file. This has the issue of having to 
change the name of the IDL file in the DLL or program directory to avoid 
an infinite recursion of includes.

Which of these is the best solution or is there another solution?

Thanks,

-- 
Rob Shearman

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: import.diff
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080119/d9428ad6/attachment.txt 

From adamrimon at gmail.com  Sat Jan 19 15:03:01 2008
From: adamrimon at gmail.com (Adam Rimon)
Date: Sat, 19 Jan 2008 23:03:01 +0200
Subject: gdiplus: DEFINE_GUID
In-Reply-To: <47924044.40504@sprintpcs.com>
References: <479201F6.2080002@gmail.com>
	<22821af30801191006g79c3e0fep5950f2c01ce8da0c@mail.gmail.com>
	<47924044.40504@sprintpcs.com>
Message-ID: <47926585.50500@gmail.com>

On 01/19/2008 08:24 PM, James McKenzie wrote:
> James Hawkins wrote:
>> On Jan 19, 2008 7:58 AM, Adam Rimon <adamrimon at gmail.com> wrote:
>>  
>>> Hi there,
>>>
>>>
>>> I wanted to implement some gdiplus functions, but for this I need the
>>> GUIDs of some properties.
>>>
>>> I took the GUIDs from
>>> http://www.reactos.org/generated/doxygen/db/de2/gdiplusimaging_8h-source.html, 
>>>
>>>
>>> but when I tried to compile gdiplus with the new gdiplusimaging.h with
>>> many DEFINE_GUID's,
>>>
>>> the compiler kept complaining that "hidden symbol `FrameDimensionPage'
>>> isn't defined".
>>>
>>>
>>> What did I do wrong?
>>>
>>>     
>>
>> Don't copy code from ReactOS and submit it to Wine.
>>
>>   
> Adam:
>
> It is not permitted (and I don't know or care to know the reason why), 
> code from the ReactOS project and attempt to put it in the Wine project.
>
> You will have to make, from the ground up, new code.  However, if you 
> attempt to submit it, these changes may be rejected in the future.
>
> James McKenzie
> (I am not allowed to submit code because I have an active MSDN 
> subscription which gives me access to Windows and Windows project 
> source code.)
>
Well, right now I don't send it to Wine. I just want to define a GUID in 
gdiplusimaging.h.
My question is about adding a GUID to a header file and compile it, not 
about the GUIDs themselves.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080119/13859edb/attachment.htm 

From winehacker at gmail.com  Sat Jan 19 21:57:04 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sat, 19 Jan 2008 22:57:04 -0500
Subject: gdiplus: DEFINE_GUID
In-Reply-To: <47924044.40504@sprintpcs.com>
References: <479201F6.2080002@gmail.com>
	<22821af30801191006g79c3e0fep5950f2c01ce8da0c@mail.gmail.com>
	<47924044.40504@sprintpcs.com>
Message-ID: <19e31a080801191957n5063d0f6r5c5d314ae7ce7f7e@mail.gmail.com>

On Jan 19, 2008 1:24 PM, James McKenzie <jjmckenzie51 at sprintpcs.com> wrote:
> James McKenzie
> (I am not allowed to submit code because I have an active MSDN
> subscription which gives me access to Windows and Windows project source
> code.)

Now the real question I have is, are you not allowed to ever
contribute code to Wine ever again even if you cancel your MSDN
subscription and swear before King and Country that you no longer have
access to Windows code....

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sat Jan 19 22:33:28 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 20 Jan 2008 12:33:28 +0800
Subject: [PATCH] Wine's ChangeDisplaySettingsEx is too strict
References: <200801192327.01753.gyurco@freemail.hu>
Message-ID: <007c01c85b1d$9cd28280$a600fea9@DMITRY>

"Szombathelyi Gy?rgy" <gyurco at freemail.hu> wrote:

> The game changes display resolution with ChangeDisplaySettingsEx, but doesn't
> specify DM_PELSWIDTH and DM_PELSHEIGHT at devmode->dmFields, so it quits
> early with an error message. Of course, it works on windows. So I attached a
> patch which make wine WinXP compatible...Hope you accept it.

Please add a test case for this to dlls/user32/tests/monitor.c.

-- 
Dmitry. 



From dmitry at codeweavers.com  Sat Jan 19 23:43:22 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 20 Jan 2008 13:43:22 +0800
Subject: Fix makedep to work on windows again
References: <19e31a080801192120w637fd9e1rdb299d7ae48ceaf3@mail.gmail.com>
Message-ID: <00ee01c85b27$5fb44140$a600fea9@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> Make on mingw does not like mixed line endings. Don't do it, ever.
> diffed from a cvs checkout
> as MSYS git is slower than molasses flowing uphill on a Minnesota winter day.
> 
> Changelog: open makedep in binary mode when writing or appending, move
> the EOF marker

I guess that you just use the sources fetched in Linux? Don't do that,
get the source via cvs under Windows instead, in that case you don't
get mixed line endings. Or alternatively convert LF to CRLF before
building.

-- 
Dmitry.


From lats at yless4u.com.au  Sun Jan 20 03:17:43 2008
From: lats at yless4u.com.au (Jeff Latimer)
Date: Sun, 20 Jan 2008 20:17:43 +1100
Subject: [PATCH] Wine's ChangeDisplaySettingsEx is too strict
In-Reply-To: <200801192327.01753.gyurco@freemail.hu>
References: <200801192327.01753.gyurco@freemail.hu>
Message-ID: <479311B7.8010205@yless4u.com.au>

Szombathelyi Gy?rgy wrote:
>      if ((devmode->dmFields & (DM_PELSWIDTH | DM_PELSHEIGHT)) != (DM_PELSWIDTH | DM_PELSHEIGHT))
>      {
>          WARN("devmode doesn't specify the resolution: %04x\n", devmode->dmFields);
> -        return DISP_CHANGE_BADMODE;
>      } 
Is this warning still valid if this is valid Windows behaviour?

Jeff


From dmitry at codeweavers.com  Sun Jan 20 03:51:14 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 20 Jan 2008 17:51:14 +0800
Subject: [PATCH] Wine's ChangeDisplaySettingsEx is too strict
References: <200801192327.01753.gyurco@freemail.hu>
	<479311B7.8010205@yless4u.com.au>
Message-ID: <001301c85b4a$00b37e90$a600fea9@DMITRY>

"Jeff Latimer" <lats at yless4u.com.au> wrote:

> >      if ((devmode->dmFields & (DM_PELSWIDTH | DM_PELSHEIGHT)) != (DM_PELSWIDTH | DM_PELSHEIGHT))
> >      {
> >          WARN("devmode doesn't specify the resolution: %04x\n", devmode->dmFields);
> > -        return DISP_CHANGE_BADMODE;
> >      } 
> Is this warning still valid if this is valid Windows behaviour?

Yes it's still valid until there is a test case which shows that Windows
does something different in this case.

-- 
Dmitry.


From r.kalbermatter at hccnet.nl  Sun Jan 20 04:37:13 2008
From: r.kalbermatter at hccnet.nl (Rolf Kalbermatter)
Date: Sun, 20 Jan 2008 11:37:13 +0100
Subject: d3dx9_24: first implementation
In-Reply-To: <10142.11843.qm@web26002.mail.ukl.yahoo.com>
References: <47922A5B.6060609@orange.fr>
	<10142.11843.qm@web26002.mail.ukl.yahoo.com>
Message-ID: <009701c85b50$6b567a80$4001a8c0@NATERS>

paulo lesgaz wrote
	
> Moreover, when you create a new dll, you need to change plenty of files:
>	configure

Why would you want to change this? I thought autoconfigure will write this
automatically based on configure.ac. And I'm sure Alexandre runs
autoconfigure
whenever he changes something at the according files. 

>	configure.ac
>	Makefile.in
>	in the folder ~/wine-git/
	
Rolf Kalbermatter



From r.kalbermatter at hccnet.nl  Sun Jan 20 06:34:18 2008
From: r.kalbermatter at hccnet.nl (Rolf Kalbermatter)
Date: Sun, 20 Jan 2008 13:34:18 +0100
Subject: gdiplus: DEFINE_GUID
In-Reply-To: <47924044.40504@sprintpcs.com>
References: <479201F6.2080002@gmail.com><22821af30801191006g79c3e0fep5950f2c01ce8da0c@mail.gmail.com>
	<47924044.40504@sprintpcs.com>
Message-ID: <009801c85b60$c68bae10$4001a8c0@NATERS>

James McKenzie

> (I am not allowed to submit code because I have an active 
> MSDN subscription which gives me access to Windows and 
> Windows project source code.)

I haven't had an MSDN subscription in a while but I think it would be very
strange that it comes with Windows source code. The most I have seen is the
crt source code from the Visual Studio Development systems (and there would
be the MFC source code too I suppose, but I couldn't care about that less)
although I never really cared to dig into the crt and only ever really got
into it more by accident when deugging my own code and single stepping into
a runtime function, which is mostly more a pain than anything else.

My understanding is that the fact that I had the possibility to look at the
crt code would at most prevent me to submit patches to msvcrt and friends
but
not to Wine as a whole.

Why an MSDN subsciption should prevent someone from submitting any code to
Wine
is beyond me, but maybe they changed the EULA of it?? (Which I would suspect
would not hold in court because of antitrust concerns).

Or did they really start to ship source code with it? I simply can't believe
they would ship ntdll.dll or ntos.exe or other core DLL source code ever.

Rolf Kalbermatter







From gyurco at freemail.hu  Sun Jan 20 10:25:22 2008
From: gyurco at freemail.hu (Szombathelyi =?iso-8859-1?q?Gy=F6rgy?=)
Date: Sun, 20 Jan 2008 17:25:22 +0100
Subject: [PATCH] Wine's ChangeDisplaySettingsEx is too strict
In-Reply-To: <007c01c85b1d$9cd28280$a600fea9@DMITRY>
References: <200801192327.01753.gyurco@freemail.hu>
	<007c01c85b1d$9cd28280$a600fea9@DMITRY>
Message-ID: <200801201725.23168.gyurco@freemail.hu>

Ezzel a d?tummal: Sunday 20 January 2008 05.33.28 Dmitry Timoshkov ezt ?rta:
> "Szombathelyi Gy?rgy" <gyurco at freemail.hu> wrote:
> > The game changes display resolution with ChangeDisplaySettingsEx, but
> > doesn't specify DM_PELSWIDTH and DM_PELSHEIGHT at devmode->dmFields, so
> > it quits early with an error message. Of course, it works on windows. So
> > I attached a patch which make wine WinXP compatible...Hope you accept it.
>
> Please add a test case for this to dlls/user32/tests/monitor.c.


Here's the test (the game above uses similar parameters, only 
DM_DISPLAYFREQUENCY in dmFields, but all other dmxxx members are filled in). 
But now test 9 and 10 fails with my patch (the return code from 
ChangeDisplaySettingsEx now 0=OK). Are they really fails on Windows? The last 
test failed already in wine, without my patch.

Regards,
Gy?rgy
-------------- next part --------------
A non-text attachment was scrubbed...
Name: monitor_test.diff
Type: text/x-diff
Size: 690 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080120/8bb68e1c/attachment.diff 

From winehacker at gmail.com  Sun Jan 20 12:15:47 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 20 Jan 2008 13:15:47 -0500
Subject: Fix makedep to work on windows again
In-Reply-To: <00ee01c85b27$5fb44140$a600fea9@DMITRY>
References: <19e31a080801192120w637fd9e1rdb299d7ae48ceaf3@mail.gmail.com>
	<00ee01c85b27$5fb44140$a600fea9@DMITRY>
Message-ID: <19e31a080801201015u698bb022tc923a8ca2bb8697a@mail.gmail.com>

On Jan 20, 2008 12:43 AM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> I guess that you just use the sources fetched in Linux? Don't do that,
> get the source via cvs under Windows instead, in that case you don't
> get mixed line endings. Or alternatively convert LF to CRLF before
> building.

MSYS cvs does not set Windows style line endings.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Sun Jan 20 14:26:50 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 20 Jan 2008 15:26:50 -0500
Subject: gdiplus: DEFINE_GUID
In-Reply-To: <009801c85b60$c68bae10$4001a8c0@NATERS>
References: <479201F6.2080002@gmail.com>
	<22821af30801191006g79c3e0fep5950f2c01ce8da0c@mail.gmail.com>
	<47924044.40504@sprintpcs.com> <009801c85b60$c68bae10$4001a8c0@NATERS>
Message-ID: <19e31a080801201226s64d00c4frb50e2534a4e9d486@mail.gmail.com>

On Jan 20, 2008 7:34 AM, Rolf Kalbermatter <r.kalbermatter at hccnet.nl> wrote:

> Why an MSDN subsciption should prevent someone from submitting any code to
> Wine
> is beyond me, but maybe they changed the EULA of it?? (Which I would suspect
> would not hold in court because of antitrust concerns).
>
> Or did they really start to ship source code with it? I simply can't believe
> they would ship ntdll.dll or ntos.exe or other core DLL source code ever.

MSDNAA Subscriber downloads like for university students contain the
source for ntos. Microsoft hired Dave Probert to put together the
Windows Academic Program and University Source Licenses where they
give away like 90% of the core system to push universities to use it
to teach operating system design. As I don't have a MSDNAA account I
don't know how much of the system is really there but the source
license terms are very liberal. i.e. You can learn from it but not
copy any code from it, any ideas you take with you are not
restricted,etc. I have a friend in the program so I will ask him if it
includes any of the Win32 api, but I doubt it.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sun Jan 20 20:45:46 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 21 Jan 2008 10:45:46 +0800
Subject: Fix makedep to work on windows again
References: <19e31a080801192120w637fd9e1rdb299d7ae48ceaf3@mail.gmail.com><00ee01c85b27$5fb44140$a600fea9@DMITRY>
	<19e31a080801201015u698bb022tc923a8ca2bb8697a@mail.gmail.com>
Message-ID: <004401c85bd7$d54711c0$a600fea9@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> MSYS cvs does not set Windows style line endings.

Then this is a bug in MSYS CVS. My cvs.exe in Windows
produces correct Wine sources, with cr/lf EOLs.

-- 
Dmitry.


From winehacker at gmail.com  Sun Jan 20 21:12:15 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 20 Jan 2008 22:12:15 -0500
Subject: Fix makedep to work on windows again
In-Reply-To: <004401c85bd7$d54711c0$a600fea9@DMITRY>
References: <19e31a080801192120w637fd9e1rdb299d7ae48ceaf3@mail.gmail.com>
	<00ee01c85b27$5fb44140$a600fea9@DMITRY>
	<19e31a080801201015u698bb022tc923a8ca2bb8697a@mail.gmail.com>
	<004401c85bd7$d54711c0$a600fea9@DMITRY>
Message-ID: <19e31a080801201912t5b2ed74dn7bb3a20e2e88cf02@mail.gmail.com>

On Jan 20, 2008 9:45 PM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> Then this is a bug in MSYS CVS. My cvs.exe in Windows
> produces correct Wine sources, with cr/lf EOLs.

It also happens with MSYS git and git is the preferred method of
getting Winehq sources and there is no other GIT for windows so I say
it should still be applied...unless you think I should perster the
MSYS people to change the default line ending behavior for all
applications in their runtime...

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sun Jan 20 21:24:09 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 21 Jan 2008 11:24:09 +0800
Subject: Fix makedep to work on windows again
References: <19e31a080801192120w637fd9e1rdb299d7ae48ceaf3@mail.gmail.com><00ee01c85b27$5fb44140$a600fea9@DMITRY><19e31a080801201015u698bb022tc923a8ca2bb8697a@mail.gmail.com><004401c85bd7$d54711c0$a600fea9@DMITRY>
	<19e31a080801201912t5b2ed74dn7bb3a20e2e88cf02@mail.gmail.com>
Message-ID: <00e701c85bdd$17695c20$a600fea9@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> On Jan 20, 2008 9:45 PM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
>> Then this is a bug in MSYS CVS. My cvs.exe in Windows
>> produces correct Wine sources, with cr/lf EOLs.
> 
> It also happens with MSYS git and git is the preferred method of
> getting Winehq sources and there is no other GIT for windows so I say
> it should still be applied...unless you think I should perster the
> MSYS people to change the default line ending behavior for all
> applications in their runtime...

Fixing the bugs in MSYS would be preferrable IMO.

-- 
Dmitry.


From winehacker at gmail.com  Sun Jan 20 21:33:52 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 20 Jan 2008 22:33:52 -0500
Subject: Fix makedep to work on windows again
In-Reply-To: <00e701c85bdd$17695c20$a600fea9@DMITRY>
References: <19e31a080801192120w637fd9e1rdb299d7ae48ceaf3@mail.gmail.com>
	<00ee01c85b27$5fb44140$a600fea9@DMITRY>
	<19e31a080801201015u698bb022tc923a8ca2bb8697a@mail.gmail.com>
	<004401c85bd7$d54711c0$a600fea9@DMITRY>
	<19e31a080801201912t5b2ed74dn7bb3a20e2e88cf02@mail.gmail.com>
	<00e701c85bdd$17695c20$a600fea9@DMITRY>
Message-ID: <19e31a080801201933x6791cb65l3816e86eb75e9168@mail.gmail.com>

On Jan 20, 2008 10:24 PM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> Fixing the bugs in MSYS would be preferrable IMO.

I forgot that Cygwin setup has the ability at the end of the install
to set the default line endings, I assume msys being a derivative
might have this capability but not enabled or its something that would
be easy to rip from their sources. Maybe its an environmental variable
or something. If Julliard rejects the patch then I'll look in to it.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Mon Jan 21 02:29:07 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 21 Jan 2008 16:29:07 +0800
Subject: LoadStringW [1/2]
References: <4794545B.4000909@procyongames.com>
Message-ID: <005101c85c07$b280a180$a600fea9@DMITRY>

"Christopher" <raccoonone at procyongames.com> wrote:

> +static void test_LoadStringW(void)
> +{
> +    HINSTANCE hInst = GetModuleHandle(NULL);
> +    WCHAR copiedstring[128], returnedstring[128], *resourcepointer = NULL;
> +    int strlen, strlen2;
> +
> +    /* Check that the string which is returned by LoadStringW matches 
> +       the string at the pointer returned by Load StringW when called with buflen = 0 */
> +    strlen = LoadStringW(hInst, 2, (WCHAR *) &resourcepointer, 0); /* get pointer to resource. */
> +    ok(strlen > 0, "LoadStringW failed to get pointer to resource 2, ret %d, err %d \n", strlen, GetLastError());
> +    
> +    strlen2 = LoadStringW(hInst, 2, returnedstring, sizeof(returnedstring) /sizeof(WCHAR));
> +    ok(strlen == strlen2, "LoadStringW returned different values dependent on buflen. ret1 %d, ret2 %d \n", 
> +        strlen, strlen2);
> +    ok(strlen2 > 0, "LoadStringW failed to load resource 2, ret %d, err %d \n", strlen2, GetLastError());
> +    
> +    if(resourcepointer != NULL)
> +    {
> +        memcpy(copiedstring, resourcepointer, strlen * sizeof(WCHAR));
> +        copiedstring[strlen] = '\0';
> +    }
> +    /* check that strings match */
> +    ok(!memcmp(copiedstring, returnedstring, (strlen + 1)*sizeof(WCHAR)),
> +        "LoadStringW returned a string that does not match the string pointed to by the pointer it returned. \
> +         returnedstring = %ls, copiedstring = %ls", returnedstring, copiedstring);
> +}

It's not clear what this test is supposed to show. If the 1st call
to LoadStringW is supposed to set resourcepointer to not NULL, why
don't you test it? Then 'if(resourcepointer != NULL)' check and copying
to copiedstring are not needed.

Also, if the test depends on a later patch to not fail, the test should be
included in the patch.

-- 
Dmitry.


From dmitry at codeweavers.com  Mon Jan 21 02:38:00 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 21 Jan 2008 16:38:00 +0800
Subject: LoadStringW [1/2]
References: <4794545B.4000909@procyongames.com>
	<005101c85c07$b280a180$a600fea9@DMITRY>
Message-ID: <000601c85c08$f006a440$a600fea9@DMITRY>

"Dmitry Timoshkov" <dmitry at codeweavers.com> wrote:

> It's not clear what this test is supposed to show. If the 1st call
> to LoadStringW is supposed to set resourcepointer to not NULL, why
> don't you test it? Then 'if(resourcepointer != NULL)' check and copying
> to copiedstring are not needed.
> 
> Also, if the test depends on a later patch to not fail, the test should be
> included in the patch.

Also, you need to test LoadStringA, to see if it behaves similarly. It would be
also interesting to test LoadStringA/W with both buffer and buffer length set
to 0.

In addition, as I already pointed out you need to inspect Wine source and fix
the places which will be broken by your fix.

-- 
Dmitry.


