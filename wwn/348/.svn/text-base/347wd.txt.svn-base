From dank at kegel.com  Thu May  1 00:40:32 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 30 Apr 2008 22:40:32 -0700
Subject: Dan Kegel : winecfg: Restrict dpi slider to sane values.
In-Reply-To: <481935E9.7070101@sprintpcs.com>
References: <E1JoeZK-0004sh-4u@wine.codeweavers.com>
	<558b2f5c0804261040ka005018pcfb126d984a6f5e4@mail.gmail.com>
	<a71bd89a0804261622t1eda6132l8d174e924e5c5ee4@mail.gmail.com>
	<200804270254.42050.research@science.su>
	<a71bd89a0804262023t10db3f16xb336a1a5f8e6c80b@mail.gmail.com>
	<481935E9.7070101@sprintpcs.com>
Message-ID: <a71bd89a0804302240nfff93e6ma338617ca24a7e7f@mail.gmail.com>

James McKenzie <jjmckenzie51 at sprintpcs.com> wrote:
> Dan Kegel wrote:
> > And we can probably make high-res users happier still
> > by defaulting to Xft.dpi (used by Gnome and maybe KDE;
> > it's set by default to 96, but is increased by some users
> > of high-res displays).
> >
>  This will break Darwine.  Xft.dpi does not exist on Apple's X11
> implementation.

Wouldn't break Wine on MacOSX at all.   We wouldn't do it there.
- Dan


From stefan at codeweavers.com  Thu May  1 02:39:00 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 1 May 2008 09:39:00 +0200
Subject: RFC: detecting wine drivers in the audio tests
In-Reply-To: <4817F036.8050804@earthlink.net>
References: <4817F036.8050804@earthlink.net>
Message-ID: <200805010939.00308.stefan@codeweavers.com>

I just wanted to add that exactly the same problem exists with graphics 
drivers. There, we use approximately this scheme:

-> If there's a driver difference, and both driver behaviors are somewhat 
sane, then we accept both results. An application couldn't depend on a 
specific result either

-> If the behavior of one driver is not sane, and the functionality tested is 
somewhat exotic(e.g. fixed function vertex processing with non-standard 
attribute types), then we accept the failure as well if there is no known 
application that uses the feature

-> If a feature is obviously broken and it is a more common feature(e.g. 
texdepth or texkill on a Radeon 9000), then I just let the test fail on 
Windows; any game that uses those features will fail as well. (Luckily for 
the card no ps_1_4 game uses texdepth and texkill; only later ones do)

The reference rasterizer is just another "driver" for me. There are some 
behaviors in per-MSDN undefined cases where the refrast shows a behavior that 
is known to cause problems with a game. In that case we let it fail on the 
refrast as well. The Intel and VMware drivers aren't drivers I care for 
because many games are known to fail on them on Windows.

Whenever a test is known to fail I add a comment to the test implementation.


From julliard at winehq.org  Thu May  1 04:58:19 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 01 May 2008 11:58:19 +0200
Subject: [PATCH 4/5] kernel32: implement __wine_kernel_init_environment.
In-Reply-To: <558b2f5c0804302241q4ce47859k36dbedf4c984baef@mail.gmail.com>
	(Lei Zhang's message of "Wed, 30 Apr 2008 22:41:45 -0700")
References: <558b2f5c0804302241q4ce47859k36dbedf4c984baef@mail.gmail.com>
Message-ID: <87skx2z6pw.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> This makes several internal kernel32 process functions more flexible
> in order to accommodate __wine_kernel_init_environment.
> __wine_kernel_init_environment is needed for CreateEnvironmentBlock.

It's not appropriate to export that from kernel32; userenv should use
only standard APIs.

-- 
Alexandre Julliard
julliard at winehq.org


From hans at it.vu.nl  Thu May  1 05:12:54 2008
From: hans at it.vu.nl (Hans Leidekker)
Date: Thu, 1 May 2008 12:12:54 +0200
Subject: usp10: Fix a few tests that fail in win2k3
In-Reply-To: <22821af30804302330j53dab3cfuce4513fcdaded047@mail.gmail.com>
References: <22821af30804302330j53dab3cfuce4513fcdaded047@mail.gmail.com>
Message-ID: <200805011212.54710.hans@it.vu.nl>

On Thursday 01 May 2008 08:30:40 James Hawkins wrote:

> +            /* get new psc */
> +            hr = ScriptPlace(hdc, &psc, pwOutGlyphs1, pcGlyphs, psva, &pItem[0].a, piAdvance,
> +                             pGoffset, pABC);
> +            ok (hr == 0, "Should return 0 not (%08x)\n", hr);
> +            ok (psc != NULL, "psc should not be NULL\n");
>             /* Set that is gets a psc and that returns 0 status */
>             hr = ScriptTextOut(hdc, &psc, 0, 0, 0, NULL, &pItem[0].a, NULL, 0, pwOutGlyphs1, pcGlyphs,
>                                piAdvance, NULL, pGoffset);

test.winehq.org shows that this ScriptTextOut test fails on all versions
of Windows and succeeds on Wine, so a better fix would be to reverse the
check for psc and make Wine pass the test.

The fix depends on Guy Albertelli's recent fix for ScriptTextOut, I'll send
a patch after that one has been committed.

 -Hans


From julliard at winehq.org  Thu May  1 05:43:15 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 01 May 2008 12:43:15 +0200
Subject: winex11.drv: Avoid setting DIALOG type to windows,
	this imposes not expected limitations in functionality
In-Reply-To: <E1JrVyp-0002Qh-CZ@mail.codeweavers.com> (Dmitry Timoshkov's
	message of "Thu, 1 May 2008 19:25:40 +0900")
References: <E1JrVyp-0002Qh-CZ@mail.codeweavers.com>
Message-ID: <87od7qz4n0.fsf@wine.dyndns.org>

Dmitry Timoshkov <dmitry at codeweavers.com> writes:

> Metacity explicitly disables maximize, minimize and fullscreen capabilities
> for windows of type _NET_WM_WINDOW_TYPE_DIALOG. Since Windows applications
> don't expect such a restriction (dialogs can have maximize/minimize buttons
> under Windows) it's better to avoid setting DIALOG type to windows at all.

This will break z-order management, Metacity ignores the transient for
hint on TYPE_NORMAL windows. Maybe we should try to not set the type at
all?

-- 
Alexandre Julliard
julliard at winehq.org


From dmitry at codeweavers.com  Thu May  1 05:59:38 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 1 May 2008 19:59:38 +0900
Subject: winex11.drv: Avoid setting DIALOG type to windows,
	this imposes not expected limitations in functionality
References: <E1JrVyp-0002Qh-CZ@mail.codeweavers.com>
	<87od7qz4n0.fsf@wine.dyndns.org>
Message-ID: <003701c8ab7a$75b64b20$a600fea9@DMITRY>

"Alexandre Julliard" <julliard at winehq.org> wrote:

>> Metacity explicitly disables maximize, minimize and fullscreen capabilities
>> for windows of type _NET_WM_WINDOW_TYPE_DIALOG. Since Windows applications
>> don't expect such a restriction (dialogs can have maximize/minimize buttons
>> under Windows) it's better to avoid setting DIALOG type to windows at all.
> 
> This will break z-order management, Metacity ignores the transient for
> hint on TYPE_NORMAL windows. Maybe we should try to not set the type at
> all?

That's what we did before, and that's what the patch below tried to fix:

http://www.winehq.org/pipermail/wine-patches/2006-October/031522.html

Looks like the archives don't allow reading the contents of that message,
so here is what it says:

<quote>
Hello all

I've investigated the reason for troubles described in 
[Bug 1598] delphi 3 - managed - missing minimize/maximize buttons
http://bugs.winehq.org/show_bug.cgi?id=1598

When metacity window manager is notified about new window it tries to
guess it's window type. Since wine doesn't assign window type for all
windows, metacity applies heuristic and if window is transient for
another one, metacity counts it as a transient dialog and removes
minimize/maximize buttons.

So I propose to apply the attached patch to fix the problem. It also
reorders calls in X11DRV_set_wm_hints to make sequence more clear. It
fixes the problem for metacity and I hope for other window managers like
mwm or enlightment. 

I also wonder if it's possible to guess if window is a dialog and set
WM_TYPE_DIALOG for some windows. Window types also include dock windows,
popups, menu windows and so on. It would be nice to get information
about that from WS_STYLE.
</quote>

-- 
Dmitry.


From julliard at winehq.org  Thu May  1 06:08:48 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 01 May 2008 13:08:48 +0200
Subject: winex11.drv: Avoid setting DIALOG type to windows,
	this imposes not expected limitations in functionality
In-Reply-To: <003701c8ab7a$75b64b20$a600fea9@DMITRY> (Dmitry Timoshkov's
	message of "Thu, 1 May 2008 19:59:38 +0900")
References: <E1JrVyp-0002Qh-CZ@mail.codeweavers.com>
	<87od7qz4n0.fsf@wine.dyndns.org>
	<003701c8ab7a$75b64b20$a600fea9@DMITRY>
Message-ID: <87fxt2z3gf.fsf@wine.dyndns.org>

"Dmitry Timoshkov" <dmitry at codeweavers.com> writes:

> "Alexandre Julliard" <julliard at winehq.org> wrote:
>> This will break z-order management, Metacity ignores the transient for
>> hint on TYPE_NORMAL windows. Maybe we should try to not set the type at
>> all?
>
> That's what we did before, and that's what the patch below tried to fix:
>
> http://www.winehq.org/pipermail/wine-patches/2006-October/031522.html

It sounds like it's time to introduce some special handling for the
Delphi zero-size owner windows then...

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Thu May  1 06:51:05 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 01 May 2008 12:51:05 +0100
Subject: shlwapi: expose the IStream_Read and IStream_Write functions.
In-Reply-To: <3f4fd2640805010117w7e23a33agecdc377a35344c1e@mail.gmail.com>
References: <3f4fd2640805010117w7e23a33agecdc377a35344c1e@mail.gmail.com>
Message-ID: <4819AEA9.7010705@codeweavers.com>

Reece Dunn wrote:
> @@ -926,6 +926,13 @@ HRESULT WINAPI SHCreateStreamOnFileEx(LPCWSTR,DWORD,DWORD,BOOL,struct IStream*,s
>  
>  HRESULT WINAPI SHCreateStreamWrapper(LPBYTE,DWORD,DWORD,struct IStream**);
>  
> +#undef IStream_Read
> +#undef IStream_Write
> +
> +HRESULT WINAPI IStream_Read(struct IStream *, LPVOID, ULONG);
> +
> +HRESULT WINAPI IStream_Write(struct IStream *, LPCVOID, ULONG);
> +
>  #endif /* NO_SHLWAPI_STREAM */
>  
>  /* SHAutoComplete flags */
>   

You've put this in the section guarded by NO_SHLWAPI_STREAM, but in the 
PSDK header it isn't guarded by this define. If it were the case, then 
you could have fixed the issue in files that include shlwapi.h by 
defining this before including it.

However, I think having to work around not being able to use the 
IStream_Read and IStream_Write macros is a bit ugly.

-- 
Rob Shearman



From jnewman at codeweavers.com  Thu May  1 06:58:10 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Thu, 01 May 2008 06:58:10 -0500
Subject: Wine t-shirts?
In-Reply-To: <b130c85e0804301730m286189fbsf6a837ef97d335d3@mail.gmail.com>
References: <a71bd89a0804230443w3240caf7v46108219330713af@mail.gmail.com>	<480F2E38.7010506@winehq.org>
	<b130c85e0804301730m286189fbsf6a837ef97d335d3@mail.gmail.com>
Message-ID: <4819B052.3010808@codeweavers.com>

Sure, I will put up an archive of our Penguin EPS files later today 
somewhere. Probably on our FTP site.

With that, I should also put up the Wine logo EPS file for anyone who 
wants a high quality version.

Maarten Lankhorst wrote:
> Hi,
> 
> 2008/4/23 Jeremy White <jwhite at winehq.org>:
>>> http://kegel.com/wine/wine-penguin-corkscrew.png
>>  Jon Parshall is proud of his ability to draw those penguins,
>>  and we'd gladly send that artwork to anyone that wanted to make a T-shirt.
>>
>>  Note, though, that we felt we had to (very sadly) drop the penguin; it doesn't
>>  really work for Mac users.
> Or the bsd users. It seems it is increasingly popular to use wine in bsd also.
> 
> Still, can I have the artwork?
> 
> Cheers,
> Maarten.
> 
> 


From msclrhd at googlemail.com  Thu May  1 09:14:34 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Thu, 1 May 2008 15:14:34 +0100
Subject: shlwapi: expose the IStream_Read and IStream_Write functions.
In-Reply-To: <4819AEA9.7010705@codeweavers.com>
References: <3f4fd2640805010117w7e23a33agecdc377a35344c1e@mail.gmail.com>
	<4819AEA9.7010705@codeweavers.com>
Message-ID: <3f4fd2640805010714s2d4ea0eq859135458217dc9@mail.gmail.com>

2008/5/1 Robert Shearman <rob at codeweavers.com>:
> Reece Dunn wrote:
>
> > @@ -926,6 +926,13 @@ HRESULT WINAPI
> SHCreateStreamOnFileEx(LPCWSTR,DWORD,DWORD,BOOL,struct IStream*,s
> >   HRESULT WINAPI SHCreateStreamWrapper(LPBYTE,DWORD,DWORD,struct
> IStream**);
> >  +#undef IStream_Read
> > +#undef IStream_Write
> > +
> > +HRESULT WINAPI IStream_Read(struct IStream *, LPVOID, ULONG);
> > +
> > +HRESULT WINAPI IStream_Write(struct IStream *, LPCVOID, ULONG);
> > +
> >  #endif /* NO_SHLWAPI_STREAM */
> >   /* SHAutoComplete flags */
> >
> >
>
>  You've put this in the section guarded by NO_SHLWAPI_STREAM, but in the
> PSDK header it isn't guarded by this define. If it were the case, then you
> could have fixed the issue in files that include shlwapi.h by defining this
> before including it.

Ok, I'll move it outside the NO_SHLWAPI_STREAM declaration.

>  However, I think having to work around not being able to use the
> IStream_Read and IStream_Write macros is a bit ugly.

I agree, but that is what we are given so there is not a lot we can do.

I did think about tidying it up better, for example there are places
where I could have used the shlwapi IStream_Read/Write functions
instead, or used IStream_Copy. However, I thought that would be too
radical. I am open for suggestions, though.

- Reece


From thestig at google.com  Thu May  1 12:49:39 2008
From: thestig at google.com (Lei Zhang)
Date: Thu, 1 May 2008 10:49:39 -0700
Subject: [PATCH 4/5] kernel32: implement __wine_kernel_init_environment.
In-Reply-To: <87skx2z6pw.fsf@wine.dyndns.org>
References: <558b2f5c0804302241q4ce47859k36dbedf4c984baef@mail.gmail.com>
	<87skx2z6pw.fsf@wine.dyndns.org>
Message-ID: <558b2f5c0805011049g7a5f7d8avd6ea819c036ab758@mail.gmail.com>

On Thu, May 1, 2008 at 2:58 AM, Alexandre Julliard <julliard at winehq.org> wrote:
>
> "Lei Zhang" <thestig at google.com> writes:
>
>  > This makes several internal kernel32 process functions more flexible
>  > in order to accommodate __wine_kernel_init_environment.
>  > __wine_kernel_init_environment is needed for CreateEnvironmentBlock.
>
>  It's not appropriate to export that from kernel32; userenv should use
>  only standard APIs.
>
>  --
>  Alexandre Julliard
>  julliard at winehq.org
>

It seems I would end up duplicating a bit of code from kernel32. Is that ok?


From julliard at winehq.org  Thu May  1 13:00:07 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 01 May 2008 20:00:07 +0200
Subject: hhctrl.ocx: Fix for memory release problem in ReleaseWebBrowser
	(fixes bug #12767)
In-Reply-To: <1209553567.11345.5.camel@biuro> (Tefnet Developers's message of
	"Wed, 30 Apr 2008 13:06:07 +0200")
References: <1209034134.2379.2.camel@tefdemo> <1209553567.11345.5.camel@biuro>
Message-ID: <87bq3pzyzc.fsf@wine.dyndns.org>

Tefnet Developers <developers at tefnet.pl> writes:

> Dnia 24-04-2008, czw o godzinie 12:48 +0200, Tomasz Jezierski - Tefnet
> pisze:
>> For more information check bug report.
>> 
>
> Hi.. what's the status of this patch? I haven't found any comments on
> wine-devel about it.

It's not clear why changing the order would fix it, that looks more like
a refcounting bug that's just hidden by your patch.

-- 
Alexandre Julliard
julliard at winehq.org


From m.b.lankhorst at gmail.com  Thu May  1 23:54:44 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 1 May 2008 21:54:44 -0700
Subject: Wine t-shirts?
In-Reply-To: <4819B052.3010808@codeweavers.com>
References: <a71bd89a0804230443w3240caf7v46108219330713af@mail.gmail.com>
	<480F2E38.7010506@winehq.org>
	<b130c85e0804301730m286189fbsf6a837ef97d335d3@mail.gmail.com>
	<4819B052.3010808@codeweavers.com>
Message-ID: <b130c85e0805012154r59d66199qcfdfeb63df88b6ea@mail.gmail.com>

Hello Jeremy,

2008/5/1 Jeremy Newman <jnewman at codeweavers.com>:
> Sure, I will put up an archive of our Penguin EPS files later today
> somewhere. Probably on our FTP site.
Did you upload it yet?

Cheers,
Maarten.


From epssyis at gmail.com  Fri May  2 00:47:08 2008
From: epssyis at gmail.com (Edward Savage)
Date: Fri, 2 May 2008 15:47:08 +1000
Subject: Wine t-shirts?
In-Reply-To: <b130c85e0805012154r59d66199qcfdfeb63df88b6ea@mail.gmail.com>
References: <a71bd89a0804230443w3240caf7v46108219330713af@mail.gmail.com>
	<480F2E38.7010506@winehq.org>
	<b130c85e0804301730m286189fbsf6a837ef97d335d3@mail.gmail.com>
	<4819B052.3010808@codeweavers.com>
	<b130c85e0805012154r59d66199qcfdfeb63df88b6ea@mail.gmail.com>
Message-ID: <d6c5d7290805012247r6d591c77t710df7bf9e27f2d0@mail.gmail.com>

Please note the following rant was insighted from a long held thought
that the wine and crossover logos were old and boring:

I wouldn't put on a Wine tshit or a Crossover tshirt until both
projects get far better/sexier logos.

Codeweavers looks like it was done in 96 and wines is boring and looks
like it lacks any creative thought.

So I think I'll offer to help fix the situation.  Do we want a new
logo or at least a more polished version of the wine logo, and are
Codeweavers prepared to update theirs? Noting that wine 1.0 might be a
good time to do so.

If any one agrees this should probably spawn a new thread.

If this was fixed I'd buy and happily wear a wine shirt instead of
glaring at those who did unfashionably.


From eric.pouech at orange.fr  Fri May  2 01:38:37 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Fri, 02 May 2008 08:38:37 +0200
Subject: kernel32: Implementation of GetLargestConsoleWindowSize.
In-Reply-To: <200805010753.m417rS7L287254@sirppi.helsinki.fi>
References: <200805010753.m417rS7L287254@sirppi.helsinki.fi>
Message-ID: <481AB6ED.6070205@orange.fr>

Reijo T Sund a ?crit :
> >From e59f5ec4eaf6936b7ecb6e4d0a471d38622f22aa Mon Sep 17 00:00:00 2001
> From: Reijo Sund <reijo.sund at helsinki.fi>
> Date: Thu, 1 May 2008 10:20:19 +0300
> Subject: kernel32: Implementation of GetLargestConsoleWindowSize.
>
> The function should return the largest size instead of hard coded
> constants. A fix for the bug 10919.
>   
first of all, implementing twice the same function is a bad idea
you should wrap the two implementations into a single function, and have 
simple wrappers for handling the different return convention
in the other items:
- you never handle errors in return from server calls
- where do the 2 (resp 3) factors come from ?
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From m.b.lankhorst at gmail.com  Fri May  2 02:33:44 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 2 May 2008 00:33:44 -0700
Subject: Wine t-shirts?
In-Reply-To: <d6c5d7290805012247r6d591c77t710df7bf9e27f2d0@mail.gmail.com>
References: <a71bd89a0804230443w3240caf7v46108219330713af@mail.gmail.com>
	<480F2E38.7010506@winehq.org>
	<b130c85e0804301730m286189fbsf6a837ef97d335d3@mail.gmail.com>
	<4819B052.3010808@codeweavers.com>
	<b130c85e0805012154r59d66199qcfdfeb63df88b6ea@mail.gmail.com>
	<d6c5d7290805012247r6d591c77t710df7bf9e27f2d0@mail.gmail.com>
Message-ID: <b130c85e0805020033g3554428eua7c11a1911271bf7@mail.gmail.com>

Hello Edward,

2008/5/1 Edward Savage <epssyis at gmail.com>:
> Please note the following rant was insighted from a long held thought
>  that the wine and crossover logos were old and boring:
>
>  I wouldn't put on a Wine tshit or a Crossover tshirt until both
>  projects get far better/sexier logos.
>
>  Codeweavers looks like it was done in 96 and wines is boring and looks
>  like it lacks any creative thought.
>
>  So I think I'll offer to help fix the situation.  Do we want a new
>  logo or at least a more polished version of the wine logo, and are
>  Codeweavers prepared to update theirs? Noting that wine 1.0 might be a
>  good time to do so.
>
>  If any one agrees this should probably spawn a new thread.
>
>  If this was fixed I'd buy and happily wear a wine shirt instead of
>  glaring at those who did unfashionably.
Have you ever seen sun's logo? Or microsoft's logo. If you don't want
to wear a wine t-shirt you don't have to. :D

I'm open for suggestions though, it wouldn't be a bad idea to look at
the logo, to see if we can modernize it a little without getting
totally rid of it. A slightly modified higher quality version would
probably suffice.

Cheers,
Maarten.


From julliard at winehq.org  Fri May  2 03:04:25 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 02 May 2008 10:04:25 +0200
Subject: [PATCH 4/5] kernel32: implement __wine_kernel_init_environment.
In-Reply-To: <558b2f5c0805011049g7a5f7d8avd6ea819c036ab758@mail.gmail.com>
	(Lei Zhang's message of "Thu, 1 May 2008 10:49:39 -0700")
References: <558b2f5c0804302241q4ce47859k36dbedf4c984baef@mail.gmail.com>
	<87skx2z6pw.fsf@wine.dyndns.org>
	<558b2f5c0805011049g7a5f7d8avd6ea819c036ab758@mail.gmail.com>
Message-ID: <87skx1xhbq.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> It seems I would end up duplicating a bit of code from kernel32. Is that ok?

Yes.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Fri May  2 04:40:30 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 02 May 2008 11:40:30 +0200
Subject: [PATCH] user32: only send WM_SIZE if the window size actually
	changed.
In-Reply-To: <558b2f5c0805020120r5c540e05wc6335e50ad85fee1@mail.gmail.com>
	(Lei Zhang's message of "Fri, 2 May 2008 01:20:41 -0700")
References: <558b2f5c0805020120r5c540e05wc6335e50ad85fee1@mail.gmail.com>
Message-ID: <877iedf3ht.fsf@wine.dyndns.org>

"Lei Zhang" <thestig at google.com> writes:

> We shouldn't send WM_SIZE in response to WM_WINDOWPOSCHANGED unless
> the window size actually changed.

The client size can change even if the window size doesn't. What are you
trying to fix?

-- 
Alexandre Julliard
julliard at winehq.org


From lich at math.spbu.ru  Fri May  2 04:47:48 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Fri, 2 May 2008 13:47:48 +0400
Subject: kernel32: Implementation of GetLargestConsoleWindowSize.
Message-ID: <200805021347.49074.lich@math.spbu.ru>

Hi,

+
+    hWnd = GetConsoleWindow();
+
+    SERVER_START_REQ( get_window_rectangles )
+    {
+        req->handle = hWnd;
+        ret = !wine_server_call_err(req);
+        colpix = reply->client.right - reply->client.left;
+        linpix = reply->client.bottom - reply->client.top;
+        colext = (reply->window.right - reply->window.left) - colpix;
+        linext = (reply->window.bottom - reply->window.top) - linpix;
+    }
+    SERVER_END_REQ;

This piece of code does not checks for curses backend. Yes, right now it is 
broken in mainstream, but
1) it may resurrected some day
2) bug #8069 contains quick hack to make it working.

 Fortunately, since you do not check error codes (as Eric pointed out), all 
variables get initialized to somehow sane values and this does not fail for 
curses.

--
Kirill


From rob at codeweavers.com  Fri May  2 08:17:06 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 02 May 2008 14:17:06 +0100
Subject: Fix building tools/widl (for bison 1.75, among others)
In-Reply-To: <alpine.LSU.1.10.0805021358550.6827@acrux.dbai.tuwien.ac.at>
References: <alpine.LSU.1.10.0805021358550.6827@acrux.dbai.tuwien.ac.at>
Message-ID: <481B1452.2@codeweavers.com>

Gerald Pfeifer wrote:
> After the following change about a week ago
>
>   Rob Shearman <rob at codeweavers.com>
>   widl: Make the rules for parsing fields in structures, encapsulated unions 
>   and non-encapsulated unions more strict.
>
>   Move the rules in fields that handle empty union cases into separate
>   union rules so that they can't erroneously be accepted for structures or
>   other types of unions.
>
> I started seeing the following build failure on one older installation:
>
>   bison  -p parser_ -o parser.tab.c -d parser.y
>   parser.y:749.2-751.15: type clash (`var' `attr_list') on default action
>   parser.y:751.16: parse error, unexpected ":", expecting ";" or "|"
>   parser.y:752.35-59: $2 of `ne_union_field' has no declared type
>   parser.y:757.2-759.7: type clash (`var' `') on default action
>   parser.y:759.8: parse error, unexpected ":", expecting ";" or "|"
>   parser.y:759.45-760.50: $1 of `union_field' has no declared type
>   parser.y:759.45-761.23: $2 of `union_field' has no declared type
>   gmake: *** [parser.tab.h] Error 1
>
> It turns out that current versions of bison do not enforce the documented 
> grammer as strictly as older ones such as bison 1.75.  Fixed thusly.
>   

Oops, thanks for spotting it. Actually, I was developing on version 1.28 
and didn't get those errors so it doesn't appear to be a deliberate 
change by the bison developers.

> ChangeLog:
> Fix syntax to also work with older versions of bison.
>
> Index: tools/widl/parser.y
> ===================================================================
> RCS file: /home/wine/wine/tools/widl/parser.y,v
> retrieving revision 1.199
> diff -u -3 -p -r1.199 parser.y
> --- tools/widl/parser.y	1 May 2008 18:38:07 -0000	1.199
> +++ tools/widl/parser.y	2 May 2008 12:07:24 -0000
> @@ -747,6 +747,7 @@ field:	  m_attributes decl_spec declarat
>  ne_union_field:
>  	  s_field ';'				{ $$ = $1; }
>  	| attributes ';'			{ $$ = make_var(NULL); $$->attrs = $1; }
> +        ;
>  
>  ne_union_fields:				{ $$ = NULL; }
>  	| ne_union_fields ne_union_field	{ $$ = append_var( $1, $2 ); }
> @@ -755,6 +756,7 @@ ne_union_fields:				{ $$ = NULL; }
>  union_field:
>  	  s_field ';'				{ $$ = $1; }
>  	| ';'					{ $$ = NULL; }
> +        ;
>  
>  s_field:  m_attributes decl_spec declarator	{ $$ = $3->var;
>  						  $$->attrs = check_field_attrs($$->name, $1);
>
>   

Looks good. Please send to wine-patches.

-- 
Rob Shearman



From jnewman at codeweavers.com  Fri May  2 07:33:26 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Fri, 02 May 2008 07:33:26 -0500
Subject: Wine t-shirts?
In-Reply-To: <b130c85e0805012154r59d66199qcfdfeb63df88b6ea@mail.gmail.com>
References: <a71bd89a0804230443w3240caf7v46108219330713af@mail.gmail.com>	<480F2E38.7010506@winehq.org>	<b130c85e0804301730m286189fbsf6a837ef97d335d3@mail.gmail.com>	<4819B052.3010808@codeweavers.com>
	<b130c85e0805012154r59d66199qcfdfeb63df88b6ea@mail.gmail.com>
Message-ID: <481B0A16.1050409@codeweavers.com>

ftp://wine.codeweavers.com/pub/wine/logos/

Maarten Lankhorst wrote:
> Hello Jeremy,
> 
> 2008/5/1 Jeremy Newman <jnewman at codeweavers.com>:
>> Sure, I will put up an archive of our Penguin EPS files later today
>> somewhere. Probably on our FTP site.
> Did you upload it yet?
> 
> Cheers,
> Maarten.
> 
> 


From gerald at pfeifer.com  Fri May  2 07:14:01 2008
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Fri, 2 May 2008 14:14:01 +0200 (CEST)
Subject: Fix building tools/widl (for bison 1.75, among others)
Message-ID: <alpine.LSU.1.10.0805021358550.6827@acrux.dbai.tuwien.ac.at>

After the following change about a week ago

  Rob Shearman <rob at codeweavers.com>
  widl: Make the rules for parsing fields in structures, encapsulated unions 
  and non-encapsulated unions more strict.

  Move the rules in fields that handle empty union cases into separate
  union rules so that they can't erroneously be accepted for structures or
  other types of unions.

I started seeing the following build failure on one older installation:

  bison  -p parser_ -o parser.tab.c -d parser.y
  parser.y:749.2-751.15: type clash (`var' `attr_list') on default action
  parser.y:751.16: parse error, unexpected ":", expecting ";" or "|"
  parser.y:752.35-59: $2 of `ne_union_field' has no declared type
  parser.y:757.2-759.7: type clash (`var' `') on default action
  parser.y:759.8: parse error, unexpected ":", expecting ";" or "|"
  parser.y:759.45-760.50: $1 of `union_field' has no declared type
  parser.y:759.45-761.23: $2 of `union_field' has no declared type
  gmake: *** [parser.tab.h] Error 1

It turns out that current versions of bison do not enforce the documented 
grammer as strictly as older ones such as bison 1.75.  Fixed thusly.

Gerald

ChangeLog:
Fix syntax to also work with older versions of bison.

Index: tools/widl/parser.y
===================================================================
RCS file: /home/wine/wine/tools/widl/parser.y,v
retrieving revision 1.199
diff -u -3 -p -r1.199 parser.y
--- tools/widl/parser.y	1 May 2008 18:38:07 -0000	1.199
+++ tools/widl/parser.y	2 May 2008 12:07:24 -0000
@@ -747,6 +747,7 @@ field:	  m_attributes decl_spec declarat
 ne_union_field:
 	  s_field ';'				{ $$ = $1; }
 	| attributes ';'			{ $$ = make_var(NULL); $$->attrs = $1; }
+        ;
 
 ne_union_fields:				{ $$ = NULL; }
 	| ne_union_fields ne_union_field	{ $$ = append_var( $1, $2 ); }
@@ -755,6 +756,7 @@ ne_union_fields:				{ $$ = NULL; }
 union_field:
 	  s_field ';'				{ $$ = $1; }
 	| ';'					{ $$ = NULL; }
+        ;
 
 s_field:  m_attributes decl_spec declarator	{ $$ = $3->var;
 						  $$->attrs = check_field_attrs($$->name, $1);


From rob at codeweavers.com  Fri May  2 09:22:49 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Fri, 02 May 2008 15:22:49 +0100
Subject: widl: Add a framework for automated testing of IDL files that
	should succeed or fail to be parsed.
In-Reply-To: <878wyvlmkd.fsf@wine.dyndns.org>
References: <48162776.3010403@codeweavers.com>	<20080428205343.GS11580@linux.ucla.edu>	<481729B8.5010804@codeweavers.com>
	<878wyvlmkd.fsf@wine.dyndns.org>
Message-ID: <481B23B9.6060008@codeweavers.com>

Alexandre Julliard wrote:
> Robert Shearman <rob at codeweavers.com> writes:
>   
>> The way I see it, we have a choice between having a framework that uses 
>> the makefile to run individual tests of the parser without checking the 
>> content or a framework that runs every test in one go, but is capable of 
>> checking the output of the generated files. The only technical advantage 
>> that I can think of for the former is that it allows the tests to be 
>> performed in parallel, but I don't know how much of a benefit that is to 
>> Alexandre (who will be the one doing "make test" the most).
>>     
>
> We definitely have to be able to run tests individually from make, so
> there can't be just a single script to run them all.
>
> Still, it seems to me that most of these tests can just as well be done
> in the existing framework, as part of the rpcrt4 test for instance. This
> way we can not only make sure that the code compiles, but also that the
> generated code builds, and works the way it should.
>   

I don't really like the idea of mixing tests of two different components 
into the same file. Also, when developing and trying to debug a 
regression I prefer to work on simpler IDL files (i.e. testing a 
particular type of statement in a few ways) than everything being in one 
file and having to work out what statement broke what.

> The only thing that can't be tested that way is obviously the code that
> is expected to fail to build, and for this something like Rob's
> framework would work fine, even though I'm not quite convinced that we
> care that much about getting the failure cases exactly right.

I see the failure cases being important for two reasons:
1. That the line number is reported correctly.
2. That the error is being triggered by the right part of the statement 
and therefore makes sense to the user.

Of course the failures themselves are important in order for incorrect 
constructs to be detected before:
1. widl crashes during generation of output files.
2. widl generates files that can't be compiled or compile with warnings.
3. widl generates files that compile correctly but crash or raise an 
exception at runtime.

-- 
Rob Shearman



From patrol at sinus.cz  Fri May  2 09:25:07 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Fri, 2 May 2008 16:25:07 +0200
Subject: Problem with VoIP applications
Message-ID: <20080502142507.GA19799@tangens.sinus.cz>

Hi!
  I was trying to run FreeCall VoIP client, however, it detects a problem
and tries to contact its authors. I've done a bit of googling and I've found
that there are at least 3 similar programs (FreeCall, VoipCheap, VoipDiscount)
which behave exactly the same way, they are using probably the same client.
Also AppDb lists at least one of them, with identical symptoms. 
  There is the following report generated by wine:

patrol at arcus:~/.wine/drive_c/Program Files/FreeCall.com/FreeCall$ wine FreeCall.exe
preloader: Warning: failed to reserve range 00000000-00010000
preloader: Warning: failed to reserve range 00000000-00010000
preloader: Warning: failed to reserve range 00000000-00010000
preloader: Warning: failed to reserve range 00000000-00010000
err:alsa:ALSA_CheckSetVolume Could not find 'PCM Playback Volume' element
err:alsa:ALSA_CheckSetVolume Could not find 'PCM Playback Volume' element
preloader: Warning: failed to reserve range 00000000-00010000
err:ole:CoInitializeEx Attempt to change threading model of this apartment from apartment threaded to multi-threaded
err:ole:CoGetClassObject class {bcde0395-e52f-467c-8e3d-c4579291692e} not registered
err:ole:CoGetClassObject class {bcde0395-e52f-467c-8e3d-c4579291692e} not registered
err:ole:create_server class {bcde0395-e52f-467c-8e3d-c4579291692e} not registered
fixme:ole:CoGetClassObject CLSCTX_REMOTE_SERVER not supported
err:ole:CoGetClassObject no class object {bcde0395-e52f-467c-8e3d-c4579291692e} could be created for context 0x17
err:ole:CoInitializeEx Attempt to change threading model of this apartment from apartment threaded to multi-threaded
err:ole:CoGetClassObject class {bcde0395-e52f-467c-8e3d-c4579291692e} not registered
err:ole:CoGetClassObject class {bcde0395-e52f-467c-8e3d-c4579291692e} not registered
err:ole:create_server class {bcde0395-e52f-467c-8e3d-c4579291692e} not registered
fixme:ole:CoGetClassObject CLSCTX_REMOTE_SERVER not supported
err:ole:CoGetClassObject no class object {bcde0395-e52f-467c-8e3d-c4579291692e} could be created for context 0x17

  The preloader warnings are harmless in this case. I think the ole errors
are the real cause.
  I don't need to use the program for calling, just to make a registration to
FreeCall - they offer also the web-based registration, but then they don't
allow to pay with PayPal - "for better security" :-(.
  Any chance the program could be started at least to allow the registration ?
    With regards, Pavel Troller


From stefan at codeweavers.com  Fri May  2 09:32:45 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 2 May 2008 16:32:45 +0200
Subject: DDraw: enable EnableAutoDepthStencil to receive depth support
In-Reply-To: <20080501214632.274500@gmx.net>
References: <20080501214632.274500@gmx.net>
Message-ID: <200805021632.45396.stefan@codeweavers.com>

Actually, setting AutoDepthStencil to TRUE is technically wrong, but I am 
afraid the only option. DDraw doesn't create a depth stencil surface 
automatically. The app has to create it manually, then attach it to the 
primary. When the app creates the depth stencil, ddraw creates a wined3d 
depth stencil. When the app attaches the depth stencil, ddraw calls 
SetDepthStencilSurface. So the bug is in WineD3D, not ddraw.

We would have to fetch a depth stencil buffer from somewhere on 
SetDepthStencilSurface. In the very same way, a d3d9 application could set 
autodepthstencil = FALSE and create the depth stencil on its own.

Since we cannot attach a depth stencil surface in the d3d9 way without 
rendering to an FBO(if they are available at all), we have a problem. One 
option would be to always create an opengl depth stencil capable format, 
which would undo some of the gains from the pixel format support. Another 
option is this patch - we didn't have a manual d3d9 depth stencil creation 
yet. A third option is to change the opengl pixelformat in 
SetDepthStencilSurface(upwards only, UNKNOWN -> D16 -> D24X8 -> D24S8).


From juan.lang at gmail.com  Fri May  2 10:01:04 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 2 May 2008 08:01:04 -0700
Subject: Problem with VoIP applications
In-Reply-To: <20080502142507.GA19799@tangens.sinus.cz>
References: <20080502142507.GA19799@tangens.sinus.cz>
Message-ID: <3a768c550805020801j12d56e1bicf00bf85a340e716@mail.gmail.com>

Hi Pavel, really you should open a bug for this rather than asking here.
--Juan


From sund at cc.helsinki.fi  Fri May  2 10:28:51 2008
From: sund at cc.helsinki.fi (Reijo T Sund)
Date: Fri, 2 May 2008 18:28:51 +0300 (EEST)
Subject: kernel32: Implementation of GetLargestConsoleWindowSize.
Message-ID: <200805021528.m42FSql9412939@sirppi.helsinki.fi>

Eric Pouech (Fri May 2 01:38:37 CDT 2008):
> first of all, implementing twice the same function is a bad idea
> you should wrap the two implementations into a single function, and have
> simple wrappers for handling the different return convention
> in the other items:
> - you never handle errors in return from server calls
> - where do the 2 (resp 3) factors come from ?

Kirill K. Smirnov (Fri May 2 04:47:48 CDT 2008):
> Fortunately, since you do not check error codes (as Eric pointed out),
> all variables get initialized to somehow sane values and this does not fail
> for curses.

Thank you very much for your comments.

I have now revised the patch to have a single helper function and
similar simple wrappers as there were with the fixed constants.

I also added the error handling for the server calls, and initialized
all variables to have sensible values even if the server calls fail,
so that the code should not fail for curses.

The factors 2 and 3 come from the fact that the client area is smaller
than the desktop area, and in addition to window frames also the
scrollbars and desktopbar should be taken into account. Please check
out the test code attached to bug report 10919: 
http://bugs.winehq.org/show_bug.cgi?id=10919

I'll send the corrected version of the patch to the patches-list.

Reijo


From dank at kegel.com  Fri May  2 14:41:44 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 2 May 2008 12:41:44 -0700
Subject: Wine 1.0 code freeze! RC1 in 6 days!
Message-ID: <a71bd89a0805021241m6f76c173j8da8896f5a0f7fca@mail.gmail.com>

Bet you never thought it would happen!

The code freeze will be less rigid at first, but we're
serious about not destabilizing Wine at this point.
So go ahead and post your patches, but make sure
you've got your ducks in a row, and don't be surprised
if Alexandre pushes back.

A clickable version of the following info is at
  http://kegel.com/wine/countdown.html

Wine Release Countdown
Wine 1.0 now in code freeze. 6 days to first release candidate.

See WineReleasePlan for details.

wine-0.9.61 was released on Friday, May 2nd, 2008. Wine is now in a
code freeze in preparation for the 1.0 release.

According to http://wiki.winehq.org/WineReleasePlan, wine-1.0.0-rc1,
due out Friday, May 9, 2008, will be the first release candidate for
1.0.

During the code freeze, patches that

    * are simple
    * come with a conformance test
    * fix a regression
    * are low risk

are more likely to get in than other patches. (Heck, that's always
true, but it's even truer during a freeze.) We will actively
discourage patches that might endanger a June 1.0 release.
Bug Status
There are 45 open 1.0 bugs as of 2 May. Most of these will simply be
rolled over to be fixed for a later release; we only have time to fix
a few, and much as we'd like to fix the rest, most are not
showstoppers.

Changes since last week (with category and votes):

New (!):
10288       programs    0           wine_gecko download hangs sometimes
11584       directx-    0           Multiple games crash with stack
overflow error
12263       opengl      2           Sketchup Cannot initialize OpenGL
- ChoosePixelFormat fails
12730       gdi32       1           gdi32: some tests fail when X is
run in 16 bit mode, but not 32 bit
12914       tools       1           wineprefixcreate overrides custom
entries in Explorer\\Shell Folders

Fixed:
9039        kernel32    0           GS-Auftrag Professional SQL aborts
on startup
9959        -unknown    9           Make wine updates work even if the
registry changed
10984       winex11.    6           sun jre 5 update 10 installer
hangs in 0.9.52
11019       winex11.    4           matlab r14 and r16 (7.0.4 and
7.3.0) and WriteItNow3.1.0s hang if X in 24bpp mode
12666       -unknown    0           Wine should refuse to run if
pointed at a real Windows

Deferred:
556         build-en    1           Reconcile the Windows and Wine spec files
1114        comctl32    3           Winrar2.90/3.00: Comboex doesn't
trigger a event when you mouse-click in some value of it
1990        winex11.    1           modifier keys not released when
switching desktop
3297        winex11.    13          UpdateWindow() doesn't call XFlush()
3546        shdocvw     2           CLSID_InternetShortcut not available...
4372        comctl32    1           listview: cannot drag several items
5055        -unknown    5           Deleting files from a window in
wine doesn't send them to the Trash
5351        kernel32    11          Windows Installer 3.1 cannot
install because of non-standard drive labeling
5623        winex11.    4           GetAsyncKeyState wrong if querying
process doesn't have focus
5625        wininet     4           Wine does not handle internet
proxy settings conveniently
5828        winex11.    25          Command and Conquer Generals (Zero
Hour) doesn't change the mouse cursor from the default X mouse
7098        mscoree     1           RufzXP crashes on startup, needs
mscoree.dll.CorBindToRuntimeEx
8095        ole         0           PQ Teaching toy crashes
9030        directx-    0           army men hangs on black screen
9304        shdocvw     4           Temple of Elemental Evil demo
doesn't start - gui irresponsive
10815       -unknown    5           Cannot drag images into Adobe
Photoshop 7 from the web / desktop
10905       shell32     0           thinstall firefox demo requires
native msvcrt
11681       directx-    17          Add support for video overlay


Here's the full list of current bugs:

11420       advapi32    0           service control manager API
problem: name of named objects might differ (client vs. service
process)
2493        comctl32    2           Multi-select listview: Shift-arrow
up only selects top two items
11509       crypt32     0           Wordviewer 2003 is unable to open
documents encrypted with AES
5535        directx-    18          Planescape:Torment doesn't work
11584       directx-    0           Multiple games crash with stack
overflow error
3270        gdi32       16          Problem with minimized top-level windows
6519        gdi32       7           Wine blacks out rotated font bitmap
7571        gdi32       1           Accented character glyphs are
mixed up with TrueType fonts (affects e.g. Lotus Notes R5)
9771        gdi32       45          Steam Friends doesn't work (fails
to render correctly or refresh)
12730       gdi32       1           gdi32: some tests fail when X is
run in 16 bit mode, but not 32 bit
5024        kernel32    5           Thief: Deadly Shadows crashes:page
fault on read access to 0x0000040c
10147       msi         2           Word Viewer 2003 - Tab behavior
differs from Windows
8783        ntdll       14          USB serial ports do not work
9356        ntdll       11          Serial communication not working
since wine-0.9.33
9942        ole         3           Powerpoint Viewer 2007 crashes
opening .pptx files
12263       opengl      2           Sketchup Cannot initialize OpenGL
- ChoosePixelFormat fails
5926        programs    1           Wine does not provide an
implementation of winhlp32.exe
10288       programs    0           wine_gecko download hangs sometimes
5163        setupapi    14          Office XP 2002 crashes on installation
6095        shdocvw     16          MOTD in counter-strike 1.6 and
counter-strike source does not render
8898        shdocvw     1           Run Time Error "445": Object
doesn't support this action in Europa Knowledgebase
8439        shell32     9           Visual Studio .NET (7) install fails
11742       shlwapi     9           Small .net 1.1 app (FastMD5 1.3)
fails to start up
12074       testcase    2           The conformance tests fail on Windows
6604        tools       3           Ship icons for the wine-tools that
can be used in .desktop files
12914       tools       1           wineprefixcreate overrides custom
entries in Explorer\\Shell Folders
5061        -unknown    6           Copying from Windows Firefox in
Wine and pasting to Linux OpenOffice pastes metadata as data
5402        -unknown    0           Trying to run PhotoStitch 3.1
5844        -unknown    13          tray minimize
5948        -unknown    2           Star Trek: Armada does not install
7404        -unknown    3           ShowWindow(SW_MINIMIZE) should not
generate a WM_PAINT message
8125        -unknown    0           Marratech 6.1 crashes on start
9178        -unknown    8           "hello world" dos program hangs
9916        -unknown    6           "make test" usually fails
11281       -unknown    4           CJK input many issues
12097       -unknown    3           Wine 1.0 should not ship
out-of-sync resource translations
12246       -unknown    2           "make test" gives different
results with and without warn+heap
664         user32      7           The help menu functionality inside
programs is broken (messaging problem)
3023        user32      6           Orcad - "Place Part" never tries
to put down a part
4523        user32      5           Can't copy from Firefox 1.5 and
paste into OpenOffice 2 under Wine
124         wineserv    2           Review of Wine Server Protocol
2368        winex11.    7           Wine loses its X-Window when
switching to another virt. desktop in Fvwm
7372        winex11.    14          can't copy and paste between gnome
apps eg openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
9787        winsock     52          Warcraft3 Battle.net Doesn't work
(Needs AcceptEx)
12005       wintab32    1           Regression in pressure sensitivity
with wizardpen tablet driver and Photoshop 7


From truiken at gmail.com  Fri May  2 18:38:07 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 2 May 2008 18:38:07 -0500
Subject: winetest problems
Message-ID: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>

Hi,

I'm trying to fix the failing cross tests, but we haven't had a
winetest build on Paul Millar's server in a few days.  I'm not
familiar with Paul's build process, so my only guess is that a recent
commit has broken the build.  In the meantime, I've tried a few
things.

I used John Klehm's crossbuild_tricks script [1] to build winetest.
The build succeeded, but the submitted result [2] is empty or can't be
parsed.

I ran 'make crosstest' from the build directory which fails with:

make[2]: Entering directory `/home/truiken/mywine/wine-build/dlls/advpack/tests'
i586-mingw32msvc-gcc -c -I../../../../../wine/dlls/advpack/tests -I.
-I../../../../../wine/include -I../../../include   -D_REENTRANT -fPIC
-Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
-Wwrite-strings -Wpointer-arith  -g -O2  -o advpack.cross.o
../../../../../wine/dlls/advpack/tests/advpack.c
../../../../../wine/dlls/advpack/tests/advpack.c:1: warning: -fPIC
ignored for target (all code is position independent)
i586-mingw32msvc-gcc -c -I../../../../../wine/dlls/advpack/tests -I.
-I../../../../../wine/include -I../../../include   -D_REENTRANT -fPIC
-Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
-Wwrite-strings -Wpointer-arith  -g -O2  -o files.cross.o
../../../../../wine/dlls/advpack/tests/files.c
../../../../../wine/dlls/advpack/tests/files.c:1: warning: -fPIC
ignored for target (all code is position independent)
i586-mingw32msvc-gcc -c -I../../../../../wine/dlls/advpack/tests -I.
-I../../../../../wine/include -I../../../include   -D_REENTRANT -fPIC
-Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
-Wwrite-strings -Wpointer-arith  -g -O2  -o install.cross.o
../../../../../wine/dlls/advpack/tests/install.c
../../../../../wine/dlls/advpack/tests/install.c:1: warning: -fPIC
ignored for target (all code is position independent)
../../../tools/make_ctests -o testlist.c advpack.c files.c install.c
i586-mingw32msvc-gcc -c -I../../../../../wine/dlls/advpack/tests -I.
-I../../../../../wine/include -I../../../include   -D_REENTRANT -fPIC
-Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
-Wwrite-strings -Wpointer-arith  -g -O2  -o testlist.cross.o
testlist.c
testlist.c:1: warning: -fPIC ignored for target (all code is position
independent)
i586-mingw32msvc-gcc advpack.cross.o files.cross.o install.cross.o
testlist.cross.o -o advpack_crosstest.exe -lcabinet -ladvapi32
-lkernel32
/usr/lib/gcc/i586-mingw32msvc/4.2.1-sjlj/../../../../i586-mingw32msvc/bin/ld:
cannot find -lcabinet
collect2: ld returned 1 exit status
make[2]: *** [advpack_crosstest.exe] Error 1
make[2]: Leaving directory `/home/truiken/mywine/wine-build/dlls/advpack/tests'
make[1]: *** [advpack/tests/__crosstest__] Error 2
make[1]: Leaving directory `/home/truiken/mywine/wine-build/dlls'

Which (I assume) is usually fixed by Paul Millar's win32api custom
patches.  Any thoughts or ideas?

[1] http://klehm.net/wine/crossbuild_tricks.sh
[2] http://test.winehq.org/data/1a5aab0ddcc7a0dcde4403add73dbd80be746020/

-- 
James Hawkins


From xixsimplicityxix at gmail.com  Fri May  2 22:41:48 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 2 May 2008 22:41:48 -0500
Subject: winetest problems
In-Reply-To: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
References: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
Message-ID: <78a7dad00805022041v640e7d7awb02b27dc90b5676a@mail.gmail.com>

On Fri, May 2, 2008 at 6:38 PM, James Hawkins <truiken at gmail.com> wrote:
> Hi,
>
>  I'm trying to fix the failing cross tests, but we haven't had a
>  winetest build on Paul Millar's server in a few days.  I'm not
>  familiar with Paul's build process, so my only guess is that a recent
>  commit has broken the build.  In the meantime, I've tried a few
>  things.
>
>  I used John Klehm's crossbuild_tricks script [1] to build winetest.
>  The build succeeded, but the submitted result [2] is empty or can't be
>  parsed.
>
>  I ran 'make crosstest' from the build directory which fails with:

This is my fault.  My tree still has my no op exceptions patch for
mingw32 target that aj rejected, so the script reflects that.  I will
correct the script tonight.

--John


From slink3r at slinker.in  Sat May  3 01:20:30 2008
From: slink3r at slinker.in (Brian Fuller)
Date: Sat, 3 May 2008 02:20:30 -0400
Subject: Wine release 0.9.61
In-Reply-To: <20080502171418.CE4921E7147@wine.dyndns.org>
References: <20080502171418.CE4921E7147@wine.dyndns.org>
Message-ID: <64e3a9ad0805022320gbf5d7d1laba60eff8176a318@mail.gmail.com>

Sockets on an application (on a TV attached)


 These sockets have an API.


 It allows the televisions to work in a group to produce a 2d wall that
views 3d


 Milican/Thompson proved the electron exists


 I need this sizing to be emulated in code so to better analyze graphics in
linux.


 (Increasing DLL timing interactions)


 If I could generate interrupts from windows using the sun architecture
platform in an emulator to produce exception clouds that generated
interrupts, and to be able to capture all this information in a memory dump,
I could re-generate API.


 Now, once I get past that leap, I can open wine, and re-compile a C
compiler that's built for windows, and put my own windows ? for all intents
and purposes call it a POSIX regulated OS, and run TF2 on it.


 Now my own windows supports TF2 well, except the fonts (I'm going to fix it
real quick)


On Fri, May 2, 2008 at 1:14 PM, Alexandre Julliard <julliard at winehq.org>
wrote:

> This is release 0.9.61 of Wine, a free implementation of Windows on Unix.
> This release marks the beginning of the code freeze for the 1.0 release.
>
> What's new in this release (see below for details):
>  - Automatic updating of the WINEPREFIX directory.
>  - Winhelp now uses Richedit as display engine.
>  - Many RichEdit fixes.
>  - More improvements to IME support.
>  - More quartz fixes.
>  - Implementation for many more Gdiplus functions.
>  - Lots of bug fixes.
>
> Because of lags created by using mirrors, this message may reach you
> before the release is available at the public sites. The sources will
> be available from the following locations:
>
>  http://ibiblio.org/pub/linux/system/emulators/wine/wine-0.9.61.tar.bz2
>  http://prdownloads.sourceforge.net/wine/wine-0.9.61.tar.bz2
>
> Binary packages for various distributions will be available from:
>
>  http://www.winehq.org/site/download
>
> You will find documentation on
>
>  http://www.winehq.org/site/documentation
>
> You can also get the current source directly from the git or CVS
> repositories. Check respectively http://www.winehq.org/site/git or
> http://www.winehq.org/site/cvs for details.
>
> If you fix something, please submit a patch; instructions on how to do
> this can be found at http://www.winehq.org/site/sending_patches
>
> Wine is available thanks to the work of many people. See the file
> AUTHORS in the distribution for the complete list.
>
> ----------------------------------------------------------------
>
> Bugs fixed since 0.9.60:
>
>   3884  3DMark 2001 SE dies into debugger when trying to display about
> screen
>   4252  The Sting demo crashes
>   5130  Faststone Image Viewer crashes on exit
>   5159  Microphone xmit in Half Life and HL:S games very harsh and goes in
> and out of "focus"
>   6710  Mouse is invisible in Act of War : Direct Action
>   7111  D3D & Via seems to don't work fine together...
>   7157  MetaEditor Help Navigator Doesn't Work.
>   7398  lockon crashes with null pointer dereference during loading
>   7864  VobBlanker: Hangs when X-11 closes child window.
>   7867  drmMap Failes -- Multiple Monitors:
>   7881  JRE 1.3.1: RuntimeException in
> sun.awt.Win32GraphicsDevice.getDefaultPixIDImpl(Native Method)
>   8171  Strict Pasv response check should be modified.
>   8300  Title bar shown in window style that does not have one
>   8447  VobBlanker Crashes when openin some DVDs
>   8520  combobox dropdown area should be customisable
>   8720  Monopoly Tycoon demo crashes at startup
>   8790  Sea Dogs: infinite loop on startup
>   8960  lack of GLX causes wine to crash
>   9039  GS-Auftrag Professional SQL aborts on startup
>   9093  NexusTK crashes at start
>   9115  unable to run setup for Office 2003
>   9257  Day of Defeat (a Half-Life 1 mod) - Mouse & Graphic
>   9388  installer stuck for TRS 2006 Demo
>   9959  Make wine updates work even if the registry changed
>  10128  winecfg: not launching
>  10198  IE's writing-mode:tb-rl (CJK-style vertical text layout) renders
> fullwidth characters rotated when it should not
>  10411  Synergy HL2 mod crashes in IHTMLWindow2_Release
>  10676  Sega rally 2 crashes on start
>  10984  sun jre 5 update 10 installer hangs in 0.9.52
>  11019  matlab r14 and r16 (7.0.4 and 7.3.0) and WriteItNow3.1.0s hang if
> X in 24bpp mode
>  11191  Chief Architect refuses to install
>  11196  Adobe Acrobat Reader 3: Text of the Document is displayed as big
> black boxes
>  11402  Date selector not displayed in Lotus Notes 7.0.2
>  11647  mspaint: Multiple copy / paste operations will cause an exception
>  11656  FarCry InstallShield wizard cannot be completed
>  11741  ClocX installer has a z-order problem
>  11806  regedit creates bogus hex:(1) value instead of empty ""
>  11818  matlab r16 / 2006b / 7.3.0 hangs on startup with X in 16bpp mode
>  11830  oRipa MSN Webcam Recorder crashes with page fault, backtrace in
> user32
>  11875  Wine crashes and won't initialize any type of application
>  11900  Unimplemented function msftedit.dll.DllGetVersion preventing
> proper detection of richedit from Miranda IM History++ plugin
>  12054  D3D9: Device test fails
>  12127  Kai Power Tools filters z-order problem in Photoshop (7, CS2)
>  12149  winedbg crashes loading a .pdb file
>  12180  MSN Messenger 7.0 crash while configuring the Webcam
>  12191  X11DRV_ChoosePixelFormat fails (Wing Commander: Secret Ops)
>  12281  msxml3 test case fails
>  12416  Deus Ex and Syberia2 both have corrupted graphics in 0.9.59
>  12420  wine 0.59 and kyodai
>  12466  Chinese input method not working in DirectX game World of Warcraft
> with wine 0.9.59
>  12478  Palringo: Pressing shift-enter in a chat window closes it
>  12494  -lGLU flag not activated
>  12555  Battlefield 1942 crashes when having joysticks attached
>  12569  Window of PSPad is flashing, when new file is opened
>  12575  Photoshop CS2 installer crashes in msi:ACTION_CallDllFunction
>  12596  Picasa no longer starts maximized in KDE
>  12610  Ctrl and Alt do not work in Guild Wars
>  12621  Abilty to set virtual desktop on a per app basis
>  12640  Applications written in Delphi has got minimize, maximize and size
> controls disabled for its item in taskbar
>  12644  GTA 3 Liberty City: texture corruption on cards with
> GL_EXT_paletted_texture
>  12656  EVE Online light effects and some other objects are not blended
> correctly
>  12657  Bad textures/shading in Dream Aquarium (white fishes)
>  12666  Wine should refuse to run if pointed at a real Windows
>  12695  when calling wineprefixcreate from wine launcher, WINEPREFIX is
> ignored
>  12707  some winemenubuilder processes never exit
>  12712  OpenGL Application crashes with GLX error
>  12727  non-fatal crash accompanies every program start
>  12747  Trying to get Electric Quilt 6 working
>  12761  net start spooler results in an infinite loop
>  12763  Wineboot: Can't run wine cross test
>  12765  Regression in ResHacker in wine-0.9.60
>  12769  control + enter sending the wrong key code
>  12770  Build breaks
>  12772  imm32: imm32.ok test fails
>  12781  Dungeon Siege graphics problems since removing the pixel format
> limitation
>  12825  Xdrive Desktop Lite Crashes after login
>  12837  Stack trace in socket.c when starting Call of Duty multiplayer
>  12845  Mono 1.9.1 installer EULA is not rendered due to richedit
> regression
>  12855  opengl.ok test fails in PC-BSD but not Linux
>  12860  magic the gathering online v3 doesn't run
>  12898  EasyUO: disappears when reduced but still running
>  12904  Thief The Dark Project crashes on game start
>
> ----------------------------------------------------------------
>
> Changes since 0.9.60:
>
> Alam Arias (1):
>      include: Fix wingdi.h to define AW version of wglUseFontBitmaps and
> wglUseFontOutlines.
>
> Alex Villac?s Lasso (30):
>      riched20: Fix behavior of EM_REPLACESEL with painting disabled.
>      riched20: EM_SETTEXTEX supports RTF strings, with tests.
>      riched32: Add more todo tests for CR and LF behavior for richedit
> 1.0.
>      riched32: Implement a portion of suggested interpretation of CRLF
> handling for richedit 1.0 emulation.
>      richedit: EM_STREAMIN tests for richedit 1.0 emulation.
>      richedit: EM_STREAMIN tests for richedit 2.0.
>      richedit: Accept RTF stream that does not start with {\rtf1 in 1.0
> emulation.
>      uxtheme: Speed up UXTHEME_SizedBlt in the ST_TILE by building an
> appropriately-sized memory bitmap out of the tile instead of iterating with
> UXTHEME_Blt() directly.
>      uxtheme: Fix nasty regression with painting of themed progress bar.
>      uxtheme: Skip creation of temporary bitmap when painting a single
> tile.
>      riched20: Yet more tests for EM_STREAMIN.
>      riched20: Implement ignoring of last \par for EM_STREAMIN.
>      riched20: Implement ignoring of last \par for EM_STREAMIN - 1.0
> emulation.
>      riched20: Reject RTF that is recognized as invalid.
>      richedit: Add support for encoding number of CR and LF contained
> within a line break.
>      richedit: Fixups to move over to reliance on CR and LF counters.
>      richedit: Remove reliance on bEmulateVersion10 for end-of-line
> handling in ME_InternalDeleteText.
>      richedit: EM_GETLINE: honor CR and LF counters.
>      richedit: EM_LINELENGTH: honor CR and LF counters.
>      richedit: Modify ME_GetTextW() to honor CR and LF encodings.
>      richedit: Remove indication for bCRLF, now that ME_GetTextW() knows
> how to honor CR and LF counters.
>      richedit: Flip the big switch and encode actual CR and LF into
> end-of-paragraph runs.
>      richedit: Implement rule that in 1.0 emulation, a single CR that
> terminates the text is NOT a line break.
>      richedit: Only notify selection change when selection has actually
> changed from previous notification.
>      richedit: Fix modify step setting in EM_SETCHARFORMAT.
>      richedit: WM_SETTEXT - Clear modify step flag before any
> notifications can be sent.
>      richedit: Private movement of cursors in text insertion should not
> cause WM_NOTIFY to be sent.
>      richedit: Paragraph may have multiple rows, which should possibly
> update nHeight.
>      richedit: On failure to parse incoming text as RTF, EM_STREAMIN must
> set dwError to -16.
>      richedit: Add tests for EM_FINDTEXT in 1.0 emulation, make them pass
> under Wine.
>
> Alexander Dorofeyev (2):
>      wined3d: Add missing check for p8 primary in surface_download_data.
>      wined3d: Prevent console spamming in drawPrimitive.
>
> Alexander Morozov (1):
>      ntoskrnl.exe: Change calling conventions for Interlocked* functions.
>
> Alexander Nicolaysen S?rnes (2):
>      start: Update Norwegian Bokm?l resource.
>      xcopy: Add Norwegian Bokm?l resource.
>
> Alexandre Julliard (70):
>      gdi32: Return bitmask for 32-bit bitmaps too in GetDIBits.
>      user32: Remove redundant LocalUnlock calls.
>      ntdll: Automatically setup the dosdevices directory if it doesn't
> exist.
>      wineboot: Add an option to update the prefix directory by
> re-executing wine.inf.
>      wineboot: Automatically update the prefix directory if wine.inf
> changes.
>      wineprefixcreate: Use wineboot --update to run wine.inf.
>      libwine: Allow to specify a non-existing directory as WINEPREFIX.
>      winecfg: Don't allow editing the configuration of the C drive.
>      user32: Dump more SetWindowPos flags.
>      user32: Invalide DCEs also when resizing a hidden window, or when
> minimizing.
>      winex11: Use SetWindowPos to invalidate DCEs when changing the pixel
> format.
>      winex11: Set type to dialog for owned popup windows.
>      winex11: Get rid of the unnecessary opengl debug channel.
>      winemenubuilder: Process messages while waiting for the semaphore or
> the parent process.
>      winex11: Moved the ConfigureNotify handler to event.c.
>      msi: Avoid creating zero-length string values in the registry.
>      localspl: Avoid creating zero-length string values in the registry.
>      winex11: Moved the X11DRV_resize_desktop function to desktop.c.
>      winex11: Merged the contents of winpos.c into window.c.
>      winex11: Make sure that the window gravity is always set.
>      winex11: Don't allow changing the X11 size of a maximized window.
>      explorer: Convert the command line parsing to Unicode.
>      kernel32: If necessary reload the environment after wineboot has run.
>      user32: Make drivers non-const to avoid a compiler warning.
>      Make.rules: Move the all: target before the implicit rules to avoid
> confusing FreeBSD make.
>      services.exe: Make the changed status event an auto-reset event.
>      services.exe: Don't reject config changes if the display name
> corresponds to the service being changed.
>      wine.inf: Fix the service type of the spooler service.
>      explorer: Allow specifying a default size for each desktop using the
> HKCU\Software\Wine\Explorer\Desktops registry key.
>      explorer: Retrieve the default desktop name from the startup
> parameters or the registry.
>      user32: Allow the default desktop name to be specified on a per-app
> basis.
>      makefiles: Add support for generating correct dependencies for tlb
> files.
>      Add makedep magic comments for typelibs in resource files.
>      makedep: Don't try to open .tlb files.
>      oleaut32/tests: Store the test typelib in resources instead of
> depending on an external file.
>      winex11: Don't force tool windows to unmanaged mode.
>      winecfg: Add a couple of Unicode helper functions.
>      winecfg: Allow to configure the desktop separately for each
> application.
>      winex11: Check if IsXExtensionPointer is defined before using it.
>      shell32: Avoid traces that use size_t.
>      winex11: Merge the contents of clipping.c into graphics.c.
>      winex11: Don't put window manager decorations on shaped windows.
>      documentation: Remove PACKAGING, this is maintained on the wiki now.
>      winex11: Fix debug trace using the removed opengl channel.
>      ws2_32: Don't name a parameter errno.
>      ws2_32/tests: Fix the gethostname prototype.
>      gdiplus: Fix the GdipFillRectangles spec entries.
>      msvcrt: Rename a few functions to avoid conflicts with Windows
> headers.
>      Include wine/port.h everywhere we use exceptions.
>      loader: Add stub versions of the pthread functions.
>      itss: Fix function prototype now that widl does the right thing with
> const.
>      makefiles: List the static libraries as normal imports instead of
> extra libs.
>      dxerr8: Don't use Wine debugging macros in static libraries.
>      dxerr9: Don't use Wine debugging macros in static libraries.
>      winex11: Register IME classes only when needed.
>      ntdll: Make the exception handling functions inline.
>      exception.h: Only push the exception frame after sigsetjmp.
>      exception.h: Preserve registers when calling RtlUnwind.
>      winex11: Avoid printing traces without a \n.
>      configure: Improve the check for the GLU library.
>      msftedit: Export a few more IIDs.
>      opengl32: Dynamically load libGLU.
>      make_makefiles: Avoid duplicate rules for static import libs on PE
> builds.
>      winex11: Don't free the pixmap in X11DRV_DIB_CreateDIBFromPixmap
> since we don't own it.
>      winex11: Ignore the specified owner if it's a zero-size window.
>      winex11: Only unmap a window when explicitly hidden, not just when
> WS_VISIBLE is cleared.
>      user32: Add an exception handler around LB_GETTEXT to hide a Delphi
> bug.
>      richedit: Avoid strlen in traces.
>      urlmon: Avoid sizeof in traces.
>      Updated the authors list.
>
> Alistair Leslie-Hughes (9):
>      msxml3: Implement get_namespaceURI.
>      msxml3: Add tests for get_prefix and get_namespaceURI.
>      msxml3: Implement get_prefix.
>      msxml3: Corrected IXMLDOMComment appendData with a broken
> xmlTextConcat function.
>      msxml3: Corrected transformNode.
>      msxml3: Added IObjectWithSite support in IXMLDOMDocument2.
>      msxml3: Implement IDispatch for IXMLDOMNode.
>      msxml3: Implement IObjectSafety for IXMLDOMDocument2.
>      msxml3: Implement IXMLDOMComment insertData.
>
> Andrew Talbot (28):
>      kernel32: Remove unused variables.
>      mciseq: Remove unused variable.
>      mciavi32: Remove unused variables.
>      mcicda: Remove unused variable.
>      mciseq: Remove unused variable.
>      msi: Remove unused variables.
>      mshtml: Remove unused variable.
>      mpr: Remove unused variables.
>      msvfw32: Remove unused variable.
>      msvcrt: Remove unused variable.
>      oleaut32: Remove unused variables.
>      ntdll: Remove unused variables.
>      netapi32: Remove unused variable.
>      qcap: Remove unused variable.
>      riched20: Remove unused variables.
>      quartz: Remove unused variables.
>      rpcrt4: Remove unused variables.
>      shell32: Remove unused variables.
>      setupapi: Remove unused variables.
>      secur32: Remove unused variables.
>      comctl32: Dangling pointers fix.
>      shlwapi: Remove unused variables.
>      user32: Remove unused variables.
>      uxtheme: Remove unused variable.
>      wined3d: Remove unused variables.
>      advapi32: Use correct function pointer cast.
>      wineps.drv: Remove unused code.
>      winex11.drv: Remove unused variables.
>
> Aric Stewart (2):
>      comctl32: Fix an off-by-one error in toolbar TOOLBAR_SetHotItem.
>      hlink: Implement IExtensionServices.
>
> Austin English (4):
>      Spelling fixes.
>      Spelling fixes.
>      Spelling fixes.
>      shell32: Fix a typo.
>
> Bryan DeGrendel (1):
>      winex11: Rudimentary drawing support for display balloon tool tips in
> systray.
>
> ByeongSik Jeon (25):
>      winecfg: Update Korean translation.
>      start: Update Korean translation.
>      reg: Add Korean translation.
>      net: Update Korean translation.
>      shdoclc: Update Korean translation.
>      imm32: Add stub and header of ImmRequestMessage.
>      imm32: Add stub and header of Imm{Create|Show|Destroy}SoftKeyboard.
>      user32: Pass the WM_IME_NOTIFY message to the default IME window.
>      imm32: Examine whether the fOpen value differs with its old value.
>      imm32: Pass the old conversion status value to the IME.
>      imm32: More implementation of the ImmGetConversionStatus().
>      imm32: Reconstruct the ImmProcessKey, ImmTranslateMessage for the
> VK_PROCESSKEY.
>      imm32: ImmGetVirtualKey return orignal virtual key value.
>      imm32: Fix a typo.
>      imm32: Add the updated ImmTranslateMessage declaration.
>      user32: Set the vkey value to VK_PROCESSKEY when IME process key.
>      imm32: Implementation of the Imm{Get|Set}CandidateWindow.
>      imm32: Implementation of the Imm{Get|Set}StatusWindowPos.
>      imm32: Updated implementation of the
> Imm{Get|Set}CompositionFont{A|W}.
>      user32: Post the WM_KEY{DOWN|UP} message whenWM_IME_KEY{DOWN|UP}
> message is generated by IME.
>      imm32: Updated implementation of the ImmEnumRegisterWord{A|W}.
>      imm32: Updated implementation of the ImmGetCandidateList{A|W}.
>      imm32: Updated implementation of the ImmGetCandidateListCount{A|W}.
>      imm32: Updated implementation of the ImmGetConversionList{A|W}.
>      imm32: Implementation of the ImmRequestMessage{A|W}.
>
> Dan Hipschman (3):
>      wininet: Remove custom content-length/type headers from redirects.
>      wininet: Don't forget the INTERNET_STATUS_REDIRECT callback in
> HttpEndRequest.
>      gdi32: Add font faces to families in a specific order.
>
> Dan Kegel (2):
>      winecfg: Restrict dpi slider to sane values.
>      gdiplus: GdipLoadImageFromStream: initialize variable.
>
> David Adam (3):
>      wined3d: Fix a possible null dereference.
>      amstream: Fix the condition of existence of the IMediaStream
> interface.
>      amstream: Register CLSID_AMDirectDrawStream.
>
> Dmitry Timoshkov (12):
>      winedump: Print contents of EMR_INTERSECTCLIPRECT and
> EMR_EXTSELECTCLIPRGN.
>      gdi32: Add a test for ExtCreateRegion, make it pass under Wine.
>      gdi32: Add a test for EMR_EXTSELECTCLIPRGN, make it pass under Wine.
>      gdi32: Reselect objects into the DC only if scaling factors change.
>      fonts: Change encoding of tahomabd.sfd to unicode.
>      gdi32: Do not reselect objects while recording a metafile, that's
> done at the playing time.
>      gdi32: Save/restore internal EMF playing state on
> EMR_SAVEDC/EMR_RESTOREDC, add a test for this.
>      winecfg: Update Russian translation.
>      gdi32: Add SetPixel to the EMF DC functions.
>      gdi32: info->state.next is always NULL, there is no need to
> save/restore it.
>      gdi32: Make the bitmap test pass under Windows 2000.
>      winecfg: Add a font size preview, update all language resources to
> reflect this change.
>
> Dylan Smith (1):
>      richedit: Updated editor.h to reflect the contents of source files.
>
> Elias Benali (1):
>      winhelp: Check against a NULL pointer dereference.
>
> Eric Pouech (73):
>      winhelp: Add an (ugly) icon.
>      winhelp: Get rid of the WM_USER message.
>      winhelp: Moved all static data used when parsing HLP files into the
> internal structures.
>      winhelp: Removed no longer needed field (wStringTableOffset) in
> Globals.
>      winhelp: Fixed the parsing of a link containing both a .hlp file and
> a window name.
>      winhelp: Always create a main window, even for popups.
>      winhelp: No longer store the WINHELP_WINDOW* inside the button box.
>      winhelp: Removed a couple of internal windows' handle and replaced
> them with control IDs.
>      winhelp: Instead of loading all pages at once, allow to browse them
> one by one.
>      winhelp: When no help file is passed on command line,  we should open
> then file pickup dialog.
>      winhelp: Silencing the copyright system record entry while parsing
> help files.
>      winhelp: Get rid of the reuse concept for Windows and refactor the
> code a bit for window creation / deletion.
>      winhelp: Added the notion of WINHELP_WNDPAGE and use it to move the
> history to the global variables.
>      winhelp: Store the history in correct order.
>      winhelp: Present correctly the history when dealing with multiple
> files.
>      winhelp: Properly handle the back button (in multiple windows, in
> empty stack...).
>      winhelp: Fix window caption index in |SYSTEM.
>      winhelp: Fix the loading of a row in a table (especially, for
> multiple paragraphs in a single cell).
>      winhelp: Properly display the page title.
>      winhelp: Don't add a page to the history when using the back button.
>      winhelp: Replaced an erroneous FIXME by a TRACE in
> MACRO_DisableButton().
>      winhelp: Fixed JumpId and JumpKeyword with correct signature and
> implementation.
>      winhelp: Enable/Disable prev/next buttons if there's a prev/next
> page.
>      winhelp: Simplified message box handling.
>      winhelp: Now use the icon out of hlpfile if any.
>      winhelp: Added ability to locate information within a page (and to
> store it inside WNDPAGE).
>      winhelp: Also store the relative offsets of a page in the history and
> back information sets.
>      winhelp: Simplify most of the helpers dealing with window creation.
>      winhelp: Store reference to the popup (if any) as a WINHELP_WINDOW
> pointer.
>      winhelp: Popup's background color should be inherited from parent.
>      winhelp: Fix the link kind (and color) of the 0xEA-0xEF family.
>      winhelp: Be sure to raise a newly (re)created window in all cases.
>      winhelp: Added as an option, to use richedit to render the text
> window.
>      winhelp: Start feeding the richedit control with relevant RTF stream.
>      winhelp: Add proper support for charset from headers and escaped non
> ANSI characters in RTF stream.
>      winhelp: Added proper RTF conversion for non breakable space and
> hyphen.
>      winhelp: Implement the first round of support for links in RichEdit.
>      winhelp: Correctly compute the popup size and manage the popup when
> richedit is used.
>      winhelp: Create the shadow window also for popups handled by
> RichEdit.
>      winhelp: Allow links inside popups to work properly.
>      winhelp: Setup a better font size for the richedit rendering.
>      winhelp: Added support for richedit tabs in paragraph format.
>      winhelp: Added support for paragraph information.
>      winhelp: Set the alignment of paragraph in richedit.
>      winhelp: Set the borders of a paragraph in richedit.
>      winhelp: Properly decode the keep bit in paragraph style.
>      winhelp: Emit proper RTF tokens for a bitmap.
>      winhelp: Emit the proper RTF stream for a metafile to RichEdit.
>      richedit: Properly handle the background in case of border in
> paragraph.
>      richedit: Ensure wrapping is done all the time after inserting an RTF
> stream.
>      wordpad: Open the filename passed on command line if any.
>      msvcrt: Fixed symbol unmangling for template-parameter-?? form, as
> well as test.
>      msvcrt: undname: correctly handle multi-dimensional arrays.
>      msvcrt: Fixed space in type with double indirection.
>      winhelp: Make richedit the default for rendering.
>      winhelp: Generate the proper RTF data for a table formatting.
>      winhelp: Added support for transparent bitmaps.
>      msvcrt: Added __iob_func implementation.
>      janitorial: Prototype func() should be func(void).
>      winedump: Print more meaningful information about module list.
>      winedump: Added support for latest versions of Codeview (VC70).
>      winedbg: Try harder to locate a source file.
>      winedbg: Added implementation of qSupported request.
>      winedbg: Attach the source files to a given process, and unload them
> at process end.
>      dbghelp: Prevent debug overflow of internal buffer while tracing.
>      dbghelp: Revert commit ae1791b0b8d181e0d01f8db1cae4eba48edefbac and
> correctly fix what this patch was trying to do.
>      dbghelp: Some cleanup in dwarf include files.
>      winedbg: Added ability to print properly float/double values.
>      winhelp: Get rid of the old internal rendering.
>      winhelp: Remove the internal data used for the old rendering.
>      winhelp: We can now get rid of the tests about a NULL rtfData block.
>      winhelp: Added support for font scaling when using RichEdit.
>      winhelp: Added support for relative offsets in richedit rendered
> pages.
>
> Erik de Castro Lopo (5):
>      include: Fix "warning: cast from pointer to integer of different
> size".
>      user32/tests: Use SetWindowLongPtr instead of SetWindowLong.
>      crypt32: Use LOWORD on LPCSTR type instead of casting to int.
>      ntdll: Win64 fix for get_pointer_obfuscator.
>      dbghelp: Fix pointer cast.
>
> Frans Kool (2):
>      winecfg: Added missing Dutch translation.
>      start: Fixed Dutch translations.
>
> Gerald Pfeifer (1):
>      widl: Fix syntax to also work with older versions of bison.
>
> Guy Albertelli (4):
>      listview: Implement LVS_EX_GRIDLINES functionality.
>      listview: Implement 2 pixel decoration at top of report style with
> grid lines.
>      listview: Correct return value from LVM_GETORIGIN including tests for
> this.
>      usp10: Use passed hdc instead of cached one for ScriptTextOut with
> test to check.
>
> Hans Leidekker (2):
>      usp10: Remove redundant code from ScriptTextOut.
>      usp10: Fix a few failing tests and make them pass on Wine.
>
> Herve Chanal (1):
>      winhelp: A nicer icon.
>
> Huw Davies (3):
>      user32: Fix bitmap_info_size to take into account bit field masks.
>      gdi32: Rename DIB_BitmapInfoSize to bitmap_info_size and fix to take
> into account bit field masks.
>      winex11.drv: Rename X11DRV_DIB_BitmapInfoSize to bitmap_info_size and
> fix to take into account bit field masks.
>
> Hwang YunSong(???) (3):
>      reg: Updated Korean resource.
>      winhelp: Updated Korean resource.
>      start: Updated Korean resource.
>
> Jacek Caban (64):
>      mshtml: Parse and store onload attributes.
>      mshtml: Added load event support.
>      mshtml: Added IDispEx::GetDispID implementation.
>      mshtml: Added IDispatchEx::InvokeEx implementation.
>      mshtml: Added IDispatchEx::Invoke implementation.
>      mshtml: Added IDispatchEx::GetIDsOfNames implementation.
>      mshtml: Forward IOmNavigator's IDispatch method to IDispatchEx
> implementation.
>      mshtml: Added window IDispatchEx implementation.
>      mshtml: Forward window IDispatch methods.
>      mshtml: Added navigator's IDispatchEx test.
>      mshtml: Added IHTMLWindow2::get_document implementation.
>      mshtml: Forward IHTMLWindow2::setTimeout to IHTMLWindow3::setTimeout.
>      mshtml: Added setTimeout implementation.
>      mshtml: Make IHTMLDocument2 iterface offset independent.
>      mshtml: Added HTMLDocument's IDispatchEx implementation.
>      mshtml: Forward IHTMLDocument2's IDispatch methods to IDispatchEx
> implementation.
>      mshtml: Added IHTMLDocument3::getElementById implementation.
>      mshtml: Use heap_alloc_zero for allocating node objects.
>      mshtml.idl: Added DispHTMLUnknownElement declaration.
>      mshtml: Added elements IDispatchEx implementation.
>      urlmon: Ignore query and hash part in file protocol URL.
>      oleaut32: Properly clear VT_BSTR record.
>      oleaut32: Clear record in RecordDestroy.
>      oleaut32: Handle VT_R4 in RecordClear (spotted by Konrad Rzepecki).
>      mshtml: Fixed typo.
>      mshtml: Return S_OK in QueryContinue.
>      mshtml: Added more IDispatchEx tests.
>      mshtml: Return VT_NULL instead of empty string in getAttribute.
>      mshtml: Added IHTMLDOMNode2 stub implementation.
>      mshtml: Added IHTMLDOMNode2 to IDispatchEx support.
>      mshtml.idl: Added DispHTMLDOMText declaration.
>      mshtml.idl: Added IHTMLDOMTextNode declaration.
>      mshtml: Added get_firstChild implementation.
>      mshtml: Added IHTMLDOMTextNode stub implementation.
>      mshtml: Added IDispatchEx support to text node.
>      mshtml: Added get_nodeType implementation.
>      mshtml.idl: Added DispHTMLElementCollection declaration.
>      mshtml: Added IDispatchEx support to HTMLElementCollection object.
>      mshtml.idl: Added DispHTMLInputElement declaration.
>      mshtml: Added put_backgroundImage implementation.
>      mshtml: Added IHTMLInputElement::get_disabled implementation.
>      mshtml.idl: Added IHTMLDOMChildrenCollection and
> DispDOMChildrenCollection declaration.
>      mshtml.idl: Added DispHTMLOptionElement declaration.
>      mshtml: Added IHTMLCommentElement declaration.
>      mshtml: Added support for custom DISPIDs.
>      mshtml: Added indexed access to HTMLElementCollection object support.
>      mshtml: Added IDispatchEx support to HTMLInputElement.
>      mshtml: Added IDispatchEx support to HTMLOptionElement.
>      mshtml.idl: Added DispHTMLImg implementation.
>      mshtml.idl: Added DispHTMLStyle declaration.
>      mshtml: Added get_childNodes implementation.
>      mshtml: Added IHTMLDOMChildrenCollection::get_length implementation.
>      mshtml: Added IHTMLDOMChildrenCollection::item implementation.
>      mshtml: Added IDispatchEx support to HTMLDOMChildrenCollection.
>      mshtml: Moved IDispatchEx initialization to HTMLElement_Init.
>      mshtml: Don't assume that nselem is valid in HTMLElement.
>      mshtml: Handle COMMENT_NODE like ELEMENT_NODE in element collection.
>      mshtml: Added IHTMLCommentElement stub implementation.
>      mshtml: Added comment and childNodes test.
>      mshtml.idl: Added DispHTMLCommentElement declaration.
>      mshtml: Added IDispatchEx support to HTMLCommentElement.
>      mshtml: Added IDispatchEx support to HTMLStyle.
>      mshtml: Added IHTMLImgElement stub implementation.
>      mshtml: Added IDispatchEx support to HTMLImgElement.
>
> James Hawkins (39):
>      advpack: Remove a test that fails inconsistently on several
> platforms.
>      advapi32: Fix a test that fails on some versions of win2k.
>      advapi32: Remove a test that fails on some systems.
>      advpack: Fix a few failing tests in win95.
>      crypt32: Remove tests for properties not present on all systems.
>      inetcomm: Fix a test that fails on all systems.
>      kernel32: Skip the screen buffer tests if codepage 866 is not
> available.
>      msi: Fix a few tests that fail in win9x.
>      advapi32: Fix a test that fails in win2k3.
>      kernel32: Fix a test that fails in win9x.
>      kernel32: Fix two tests that fail in win9x.
>      imm32: Fix a test that fails on all systems.
>      shdocvw: Fix a test that fails on all platforms.
>      version: Fix tests that fail in win9x and win2k.
>      kernel32: Fix a test that fails on win9x.
>      pdh: Fix two tests that fail on win2k3.
>      riched20: Fix a few tests that fail in XP and up.
>      shell32: Fix a test that fails in win2k3.
>      uxtheme: Fix a test that fails in win2k3.
>      advapi32: Fix a test that fails in win2k3 SP2.
>      d3d8: Fix a few test failures in win2k3.
>      gdi32: Remove a dependence on the amount of available memory.
>      winspool.drv: Disable a test for capabilities not available on all
> printer drivers.
>      winmm: Remove a failing test that is driver-specific.
>      ddraw: Fix tests that fail with the reference rasterizer.
>      kernel32: Fix a test that fails in win2k3.
>      msi: Remove a debugging call.
>      cabinet: Revert "cabinet: Fix for FDICopy with an empty cabinet
> file.".
>      d3d9: Fix a few test failures in win2k3.
>      ddraw: Remove a test that fails in VMs.
>      schannel: Fix a test that fails in win2k3.
>      user32: Fix a test that fails on platforms without IME.
>      msi: Add initial implementation of MsiPublishAssemblies.
>      gdi32: Remove a dependency on the amount of available memory.
>      user32: Fix a test that fails in win2k3.
>      urlmon: Fix a test that fails in win2k3.
>      ntdll: Fix two tests that fail on all NT platforms.
>      msi: A progid who is its own parent cannot have a clsid.
>      itss: Remove a test that we expect to fail sometimes.
>
> Jeff Latimer (1):
>      user32/tests: Fix typedefs & function definitions so that the code
> compiles in visual C++ 2005.
>
> Jeff Zaroyko (3):
>      msadp32.acm: Use the same szShortName value as windows.
>      msacm32.drv: Increase the reported vDriverVersion.
>      wine.inf: Use lowercase for some drivers32 entries and remove
> trailing whitespace.
>
> Jens Albretsen (1):
>      ddraw: Fixed device name.
>
> Jeremy White (1):
>      gdi32: Shift default height used in EnumStructs to the standard em
> size of 2048.
>
> John Klehm (3):
>      winex11: Allow wintab devices with less than 5 axes.
>      winex11: Allow wizardpen to be detected as a stylus.
>      winex11: Add support for IsXExtensionPointer tablet devices.
>
> Joris Huizer (1):
>      mshtml: Fixed copy/paste mistake.
>
> Juan Lang (1):
>      cryptdlg: Implement GetFriendlyNameOfCertA/W.
>
> Kai Blin (3):
>      ws2_32: Work around the host name resolving to 127.x.x.x when using
> that for binding.
>      ws2_32: Handle gethostbyname call failure, add tests.
>      secur32: Don't call waitpid() in dispatcher.
>
> Kirill K. Smirnov (3):
>      winhelp: We can reference any page in HLPFILE_BrowsePage(). Perform
> similar change in HLPFILE_DoReadHlpFile() for the symmetry.
>      winhelp: Shift by 6 not 4 in case of old 3.0 file.
>      winhelp: Fix possible copy/paste error.
>
> Kusanagi Kouichi (8):
>      winex11.drv: Generate WM_IME_ENDCOMPOSITION when preedit ends.
>      winex11: Generate WM_IME_ENDCOMPOSITION when composition string is
> canceled.
>      imm32: Fix a meaningless test.
>      winex11: Destroy the handle to the composition string after it is
> cancelled.
>      imm32: Fix typos.
>      winex11: hCompStr should never be NULL because Wine expects it is not
> NULL.
>      winex11: Remove unnecessary #include.
>      winex11: Allow XIM server to be started after Wine.
>
> Lei Zhang (13):
>      gdiplus: Initialize variables in the graphics test.
>      gdiplus: Do not access freed memory in a test.
>      user32: Add a test for sending WM_KEYDOWN to a child edit control.
>      user32: Handle VK_RETURN WM_KEYDOWN events better in edit controls.
>      winex11: control + enter should generate '\n' instead of '\r'.
>      user32: Edit controls should ignore WM_KEYDOWN on control + enter.
>      advapi32: Replace UuidToStringW call with a sprintfW.
>      winmm: Do not unload drivers when the process is terminating.
>      userenv: Add initial tests for CreateEnvironmentBlock.
>      userenv: Initial implementation of CreateEnvironmentBlock.
>      userenv: Add tests for environment variables for
> CreateEnvironmentBlock.
>      userenv: Add more tests for environment variables for
> CreateEnvironmentBlock.
>      userenv: Add a test for variable inheritance for
> CreateEnvironmentBlock.
>
> Lionel Debroux (1):
>      dinput: joystick test: Improve reporting when enumerated
> axes/buttons/POVs don't match capabilities.
>
> Maarten Lankhorst (41):
>      dsound: Skip the sound checks on the primary module and change its
> driver module to "".
>      quartz: Make the video renderer drop preroll samples.
>      quartz: Fix theoretical memory leak.
>      quartz: Fix sample leak in file source on failure path.
>      quartz: Flux AsyncReader in PullPin_BeginFlush.
>      quartz: Make acmwrapper respect preroll samples.
>      quartz: Set media time in the file source.
>      quartz: No longer drop packets on discontinuities.
>      quartz: Drop preroll frames in directsound renderer too.
>      quartz: Only drop Preroll samples after obtaining its time.
>      quartz: Add more seek entries and fix a time continuity bug.
>      quartz: Change longlong printfs.
>      quartz: Add some more tests and fix wine to pass them.
>      explorer/mountmgr.sys: Move device hotplug code over to mount
> manager.
>      quartz: Optimize the processing thread to fetch one sample while
> processing another.
>      quartz: Fix error message names in tests.
>      quartz: Fix inverted logic in memallocator.
>      quartz: Copy discontinuity status in acmwrapper.
>      quartz: Add some sanity checks to file splitter.
>      quartz: Make wave parser and mpeg splitter zero copy by getting rid
> of the seperate allocator for the output pin.
>      quartz: Make the file source support multiple samples by
> preallocating enough handles.
>      dsound: Skip WAVE_FORMAT_EXTENSIBLE tests on directx < 8.
>      quartz: Add a vtable argument to Parser_Create that individual
> filters can override.
>      quartz: NotifyAllocator does not like a null argument.
>      quartz: Fix time discontinuities in the acm wrapper.
>      quartz: Make the EnumPins interface dynamic.
>      quartz: Optimize the file source to do its job better.
>      quartz: Make dwSamplesProcessed a longlong.
>      quartz: Add a function that can be called when stopping processing
> data.
>      quartz: Fix acmwrapper time regression.
>      quartz: Fix bug in memallocator with test.
>      quartz: Keep track of the time in the video renderer.
>      quartz: Handle failures better in acmwrapper.
>      quartz: Some state changes fixes.
>      Revert "quartz: Handle failures better in acmwrapper.".
>      quartz: More filesource fixes.
>      quartz: Clean up pullpin code.
>      quartz: Get rid of the sample holding code in the mpeg splitter.
>      quartz: Get rid of the sample holding code in the wave parser.
>      quartz: Silence a fixme that isn't.
>      headers: Add some extra defines to vfw.h.
>
> Markus Weiland (1):
>      dxdiagn: Implemented ullPhysicalMemory property for
> DXDiagSystemInfoContainer.
>
> Mathias Gottschlag (2):
>      winecfg: Fix some errors in the German translation.
>      taskmgr: Fix some German translation errors.
>
> Matthias Derer (1):
>      winejack: Re-added line which has been accidently deleted.
>
> Michael Stefaniuc (4):
>      winecfg: Fix typos in the En(US) resource.
>      winecfg: Update and fix the Romanian translation.
>      start: Update the German translation.
>      winecfg: Transform the set_advanced() driveui function to unicode.
>
> Nikolay Sivov (34):
>      gdiplus: Implemented GdipVectorTransformMatrixPointsI.
>      gdiplus: Implemented GdipAddPathLine.
>      gdiplus: Implemented GdipDrawRectangle.
>      gdiplus: GdipCreateLineBrushI implemented using float args version.
>      gdiplus: Implemented GdipCloneFont.
>      gdiplus: Implemented GdipTransformMatrixPointsI.
>      gdiplus: Implemented GdipDrawPieI.
>      gdiplus: Implemented GdipDrawRectanglesI.
>      gdiplus: Implemented GdipDrawPolygon/GdipDrawPolygonI.
>      gdiplus: Implemented GdipFillPieI.
>      gdiplus: Implemented GdipGetLineRect/GdipGetLineRectI.
>      gdiplus: Implemented GdipGetLineColors.
>      gdiplus: Implemented GdipSetLineColors.
>      gdiplus: Implemented GdipAddPathBezier.
>      gdiplus: Implemented GdipDrawImageRect/GdipDrawImageRectI.
>      gdiplus: Implemented GdipAddPathBeziersI.
>      gdiplus: Implemented GdipAddPathEllipseI.
>      gdiplus: Implemented GdipCreatePathGradientI.
>      gdiplus: Implemented GdipCreateLineBrushFromRect.
>      gdiplus: Implemented GdipDrawCurve2I.
>      gdiplus: Implemented GdipDrawCurve/GdipDrawCurveI.
>      gdiplus: Implemented GdipDrawImage.
>      gdiplus: Implemented GdipDrawImagePointsRectI.
>      gdiplus: Implemented GdipFillEllipse/GdipFillEllipseI.
>      gdiplus: Implemented GdipFillRectangles/GdipFillRectanglesI.
>      gdiplus: Implemented GdipGetDpiX/GdipGetDpiY.
>      gdiplus: Implemented GdipGetPathGradientCenterPointI.
>      gdiplus: Implemented GdipGetPathPointsI.
>      gdiplus: Implemented GdipGetPathWorldBoundsI.
>      gdiplus: Implemented GdipIsMatrixEqual.
>      gdiplus: Implemented GdipIsMatrixIdentity.
>      gdiplus: Implemented GdipMultiplyWorldTransform.
>      gdiplus: Implemented GdipSetPathGradientCenterPointI.
>      gdiplus: Implemented GdipCreateFontFromDC.
>
> Paul Vriens (10):
>      tools/wine.inf.in: Fix a typo.
>      gdi32/tests: Run tests on win9x again.
>      oleaut32/tests: Skip a test on win9x.
>      user32/tests: Skip tests if function is not implemented.
>      kernel32/tests: Fix tests on win9x.
>      urlmon/tests: Fix timeout for tests on win9x.
>      user32/tests: Run tests again on win95.
>      winecfg: Better alignment of text and combobox.
>      kernel32/tests: Don't run tests on win9x if we are out of memory.
>      kernel32/tests: Skip some tests on win98.
>
> Petr Sumbera (1):
>      port: Add alternative for isinf.
>
> Reece Dunn (3):
>      shlwapi/tests: Fix the return codes for Windows 2000 (without IE6
> installed).
>      shlwapi/tests: Improve the way that the UrlCanonicalize tests report
> failure.
>      shlwapi/tests: Add 'res:' protocol tests for UrlCanonicalize.
>
> Rico Sch?ller (1):
>      msftedit: Add DllGetVersion.
>
> Rob Shearman (54):
>      widl: Stop looping in check_remoting_args when a context_handle or
> wire_marshal type is found as they are in effect fundamental types.
>      widl: Check that fields in structures and unions referenced by
> non-local functions can be marshalled and that their attributes are
> consistent.
>      widl: The implicit_handle attribute is allowed with a handle
> explicitly specified in the function parameters.
>      widl: Automatically add "handle_t IDL_handle" parameter to functions
> with no explicit handle specified whose containing interface has the
> explicit_handle attribute.
>      widl: Issue an error instead of crashing for dividing by zero in a
> constant expression.
>      widl: Add support for "->" and "." operators in expressions.
>      widl: Add support for arrays in expressions.
>      widl: Add support for '%' operator in expressions.
>      widl: Fix operator precedence in expressions.
>      widl: Require a constant expression for case statements.
>      widl: Add support for comparison, exclusive or, logical not and
> positive operators in expressions.
>      widl: Remove EXPR_MEMBERPTR and implement it using EXPR_PPTR and
> EXPR_MEMBER instead.
>      widl: Don't free input_name in pop_import as we keep pointers to it
> in the var_t type now.
>      widl: Pass the actual type into check_remoting_fields and
> check_field_common instead of the type name.
>      widl: Check that expressions resolve so that expressions in generated
> code will compile.
>      widl: Move expression functions to a new file, expr.c.
>      widl: Use expr_resolve_type to get the type of the identifier in
> write_conf_or_var_desc.
>      widl: Remove duplicated code in the form of the write_struct_expr
> function by enhancing write_expr to allow toplevel identifiers to be
> prefixed by a string, if specified.
>      crypt32: Decode the message content on finishing in CDecodeMsg_Update
> for the streamed case as well as the non-streamed case.
>      wintrust: Implement WTHelperGetProvPrivateDataFromChain.
>      wintrust: Check that provider functions are not NULL before using
> them.
>      widl: Implement lcid property on library declarations.
>      widl: Construct the pointer chain while parsing pointers, rather than
> storing a ptr_level.
>      widl: Allow NULL to be used in expressions.
>      widl: Create a list of statements in the whole IDL file, instead of
> just a list of interfaces.
>      widl: Add typedef statements to the statement lists.
>      widl: Consolidate most of the inner loop of reg_typedefs into
> set_type.
>      widl: Rename pident to declarator and parse the array declarations as
> part of declarators.
>      widl: Make the rules for parsing fields in structures, encapsulated
> unions and non-encapsulated unions more strict.
>      widl: Add support for declaring multiple fields of a structure in one
> statement.
>      widl: Add support for string literals and wide-string literals in
> expressions.
>      widl: Create a statement object for import statements.
>      widl: Move the func_declarator rule entirely into direct_declarator.
>      rpcrt4: Use safe_copy_from_buffer instead of direct memory copy in
> NdrBaseTypeUnmarshall.
>      widl: Add typedefs to typelibs which have the public or uuid
> attributes, not any other attribute.
>      widl: Support hex digits that use an uppercase 0X prefix.
>      widl: Accept integer constant suffixes in the lexer.
>      ole32: Fix two comments about the running object table.
>      ole32: Add tests for registering a moniker more than once in the ROT
> and then using it.
>      ole32: Add a test for marshaling an object as table-weak and as
> normal and then unmarshaling and testing that the object is released on the
> final release.
>      ole32: Keep track of the number of weak references to an object.
>      rpcss: When registering a moniker that is already registered in the
> ROT another ROT entry should still be created and a distinct cookie
> returned.
>      widl: Keep const attributes applied to pointers when writing out the
> type.
>      widl: Add support for "inline" on function definitions.
>      widl: Make constdef and externdef take a declarator instead of an
> ident so that functions and arrays can be defined using the statements.
>      widl: Allow pointer attributes to be applied to function pointers.
>      widl: callback, code, comm_status and in_line are attribute names,
> not keywords.
>      widl: Prepare for supporting storage classes in declaration
> statements.
>      widl: Add the parsing of storage classes into declaration-specifiers.
>      cryptdlg: Add stubs for CertTrustInit, CertTrustCertPolicy,
> CertTrustCleanup and CertTrustFinalPolicy.
>      wininet: Don't crash in GetUrlCacheEntryInfoA/W if
> lpdwCacheEntryInfoBufferSize is NULL.
>      wininet: Add tests for GetUrlCacheEntryInfoExA.
>      advapi32: Make sure not to return a credential with a NULL UserName
> field when a Mac Keychain doesn't have an account name attribute.
>      widl: Consolidate writing of COM and dispatch interfaces into one
> function to remove duplicated code.
>
> Robert Reif (1):
>      winmm: Fix a test failure on Windows with Terminal Server.
>
> Roderick Colenbrander (16):
>      wined3d: Add palette re-upload support for cards with hardware
> palette support.
>      wgl: Put the core functionality of X11DRV_SetPixelFormat in a
> separate function.
>      wgl: Add a wine specific WGL extension which allows you to change the
> pixel format multiple times.
>      wined3d: Split WGL pixel format selection code off from
> CreateContext.
>      wined3d: Store more information about pixel formats. This is needed
> for some WineD3D_ChoosePixelFormat restructuring.
>      wined3d: Let WineD3D_ChoosePixelFormat operate on the pixel format
> database we store at WineD3D startup.
>      wined3d: Also use WineD3D_ChoosePixelFormat for pbuffers.
>      wined3d: Fix a few small bugs in WineD3D_ChoosePixelFormat.
>      wined3d: Add multisampling support.
>      wgl: We were already advertising GL_EXT_framebuffer_sRGB but not the
> corresponding WGL_FRAMEBUFFER_SRGB_CAPABLE_EXT.
>      opengl32: Drop the ChoosePixelFormat test as it is very unreliable.
>      opengl32: Get rid of X/GLX leftovers.
>      wined3d: Fix typo in pixel format trace.
>      wined3d: In window mode (!pbuffer) we want both a window drawable
> format and double buffering.
>      wined3d: We don't want double buffering in pbuffer mode.
>      ddraw: Enable EnableAutoDepthStencil to receive depth support.
>
> Stefan D?singer (11):
>      wined3d: Use the shader backend to enable / disable atifs and nvts.
>      wined3d: Support framebuffer reading from texture_rectangle sources.
>      d3d9: Add a test for NP2 stretchrect.
>      wined3d: Call activate_dimensions from the atifs code.
>      d3d9: Make the offscreen format test a bit more tolerant.
>      wined3d: More fglrx spam.
>      wined3d: Fix the GL_ATI_separate_stencil codepath.
>      wined3d: Fix DP2ADD in GLSL.
>      d3d9: Check textures for srgb writing, not surfaces.
>      d3d9: Dump the device information in the visual tests.
>      wined3d: Remove an unused variable.
>
> Stefan Leichter (1):
>      shell32: Implement SHGetFolderPathAndSubDirA/W.
>
> Steven Edwards (1):
>      rpcrt4: Correct the number of aguments for fill_method on unsupported
> architectures.
>
> Tijl Coosemans (2):
>      hhctrl.ocx: Plug memory leak.
>      hhctrl: Fix NULL pointer dereference in some failure cases.
>
> Tomasz Jezierski (1):
>      shell32: Secure filename copy to fixed size variable wfileName.
>
> Tomasz Nowi?ski (1):
>      Fixed typos in the Polish translations.
>
> Vitaliy Margolen (9):
>      shdoclc: Add Russian translation.
>      Update Russian translation.
>      dinput: Limit number of supported axis and buttons.
>      dinput: Explicitly set extended key flag for Right Shift.
>      winex11: Fix GetKeyNameText for Right Shift.
>      winex11: Use constants instead of magic numbers in GetKeyNameText.
>      winex11: Fix MapVirtualKeyEx to properly map left-right modifier
> keys.
>      dinput: Fix default axes mapping generation.
>      dinput: Fix typo.
>
> Vitaly Perov (2):
>      cabinet: Added a test for FDICopy with an empty cabinet file.
>      cabinet: Fix for FDICopy with an empty cabinet file.
>
> --
> Alexandre Julliard
> julliard at winehq.org
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080503/452a82dd/attachment-0001.htm 

From slink3r at slinker.in  Sat May  3 02:07:19 2008
From: slink3r at slinker.in (Brian Fuller)
Date: Sat, 3 May 2008 03:07:19 -0400
Subject: Explanation for HTWin32.dll (implications on WIneAPI=mormon thing)
Message-ID: <64e3a9ad0805030007v2a642314kae0629f22de16aaf@mail.gmail.com>

Hopefully I didn't offend anybody with the subject line.


3dMark 2001 SE (dies into a debugger) ?? trying to display "about" from
screen app?


 Use a space as a seperator


 One or more words to search for, so I'm stealing from a website the EMP bit
when it tripped and took it down.


 ": In this article I present a tool I wrote to extract trace evidence of
USB thumb drive activity from the Windows Registry. "


 Now if you're a wine developer, this makes sense.


 And the application interfacing with the DLLs is totally based off of
interrupts.in my version


 You just hope that you can get the timing of the interrupts right, I
suppose using the HT dll. The math in RSC is mathematically solved to be the
most efficient for object verification already?


 If that doesn't work easily, then beforehand I need a DLL to interface with
my DLL for wine (API pueposes)


 Once you find a spot for the object verification to be able to manage the
timing of an application that monitors accesses to particular files with
permissions, we can share the addressing issue of permissions with some Unix
commands more easily. (Hopefully using this step to encourage game
developers to write more POSIX specific games(think cell architecture))


 Well, object verification in my DLL set has been entirely mathematically
proven to be the most efficient method, so my DLL interfaces with another
DLL, but I have an API with 3 commands.


 2 command together lighted up means interrupt is about to occur on the
third light ?C when this happens, you only have so long before you die. The
timing between the 2 commands being activated and the interrupt light must
be carefully timed and analyzed to make sure this event occurs.


 The computer there saves the information, and just have to hope the EMP
doesn't blast away the data somehow.


 Windows Registry never notices you plugin a USB thumb drive, another
application does, crashing a CPU within your computer. I'm sorry to bore you
guys with the details, I just wanted to explain the whack way I worded my
letters the other day.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080503/b3097d86/attachment.htm 

From slink3r at slinker.in  Sat May  3 02:13:51 2008
From: slink3r at slinker.in (Brian Fuller)
Date: Sat, 3 May 2008 03:13:51 -0400
Subject: Freeze in effect?
Message-ID: <64e3a9ad0805030013y7a6395fdy6c068ce048556dd4@mail.gmail.com>

Gear = protein for all intents and purposes, as they stack, the cell grows.
DNA limits the stacking capabilities

All life starts from a cell (in atmosphere) mold first, water holds together
around the planet to allow this only time permitting, but luckily mold cares
just that much about the planet.

You really don't think I can finish my project before June so maybe it can
make it in 1.0?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080503/e963f67a/attachment.htm 

From slink3r at slinker.in  Sat May  3 02:15:55 2008
From: slink3r at slinker.in (Brian Fuller)
Date: Sat, 3 May 2008 03:15:55 -0400
Subject: Freeze in effect?
In-Reply-To: <64e3a9ad0805030013y7a6395fdy6c068ce048556dd4@mail.gmail.com>
References: <64e3a9ad0805030013y7a6395fdy6c068ce048556dd4@mail.gmail.com>
Message-ID: <64e3a9ad0805030015t585ce51ck46d4be61b3a2be69@mail.gmail.com>

My theory being that everytime an interrupt is generated at the point where
the skin-contact is breached, I need to collect these.

There's a cell with HIV in it. Instead of the traditional movement method of
cilius's it uses a rotor-like tail instead. Inside of the cell there is a
submarine. So luckily the white blood cell does not kill it.

I want to be able to analyze that white blood cell from a code level for
anybody who got past the cryptic talk and is still willing to give me a
chance :)

-BAF

On Sat, May 3, 2008 at 3:13 AM, Brian Fuller <slink3r at slinker.in> wrote:

>
> Gear = protein for all intents and purposes, as they stack, the cell
> grows. DNA limits the stacking capabilities
>
> All life starts from a cell (in atmosphere) mold first, water holds
> together around the planet to allow this only time permitting, but luckily
> mold cares just that much about the planet.
>
> You really don't think I can finish my project before June so maybe it can
> make it in 1.0?
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080503/05732b37/attachment.htm 

From paul.vriens.wine at gmail.com  Sat May  3 05:10:54 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Sat, 03 May 2008 12:10:54 +0200
Subject: winetest problems
In-Reply-To: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
References: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
Message-ID: <481C3A2E.40108@gmail.com>

James Hawkins wrote:
> Hi,
> 
> I'm trying to fix the failing cross tests, but we haven't had a
> winetest build on Paul Millar's server in a few days.  I'm not
> familiar with Paul's build process, so my only guess is that a recent
> commit has broken the build.  In the meantime, I've tried a few
> things.

I usually look at http://quisquiliae.physics.gla.ac.uk/cross/logs/ to see why a 
new winetest isn't there.

This time it's some additions to the mshtml tests that Mingw doesn't handle yet 
(I assume).

This is what I get on my local box:

i386-mingw32-gcc dom.cross.o htmldoc.cross.o misc.cross.o protocol.cross.o 
script.cross.o     testlist.cross.o -o mshtml_crosstest.exe -luuid -lole32 
-loleaut32 -luser32 -lurlmon -ladvapi32 -lkernel32
dom.cross.o:dom.c:(.text+0x19d0): undefined reference to 
`_DIID_DispHTMLElementCollection'
dom.cross.o:dom.c:(.text+0x4643): undefined reference to `_IID_IOmNavigator'
dom.cross.o:dom.c:(.text+0x4752): undefined reference to `_DIID_DispHTMLStyle'
dom.cross.o:dom.c:(.text+0x4fa7): undefined reference to `_DIID_DispHTMLWindow2'
dom.cross.o:dom.c:(.text+0x5e62): undefined reference to `_DIID_DispHTMLDOMTextNode'
dom.cross.o:dom.c:(.text+0x5f74): undefined reference to 
`_DIID_DispDOMChildrenCollection'
dom.cross.o:dom.c:(.rdata+0x5b0): undefined reference to 
`_DIID_DispHTMLInputElement'
dom.cross.o:dom.c:(.rdata+0x5d4): undefined reference to 
`_DIID_DispHTMLOptionElement'
dom.cross.o:dom.c:(.rdata+0x634): undefined reference to 
`_DIID_DispHTMLUnknownElement'
dom.cross.o:dom.c:(.rdata+0x640): undefined reference to 
`_DIID_DispHTMLCommentElement'
collect2: ld returned 1 exit status
make: *** [mshtml_crosstest.exe] Error 1

-- 
Cheers,

Paul.


From winehacker at gmail.com  Sat May  3 05:52:43 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sat, 3 May 2008 06:52:43 -0400
Subject: Possible Regression in 3Dmark 03 in win2000 mode
Message-ID: <19e31a080805030352k40601e14ne7028694ef61741c@mail.gmail.com>

Hi,
Sorry to spam wine-devel...I don't have the time to file a proper bug
report right now and I did not want to waste my time if the directx
guys were aware of it and working on it but 3DMark03 is crashing for
me in wn2000 mode while it functions in win98 mode. This is a
regression and a new bug, it would be nice to have as many benchmarks
as possible working so when 1.0 ships we can compare results to
windows.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From Andrew.Talbot at talbotville.com  Sat May  3 11:40:34 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 03 May 2008 17:40:34 +0100
Subject: Five functions that cannot handle a NULL parameter
Message-ID: <fvi4i2$jqd$1@ger.gmane.org>

In case anyone wishes to note or fix them, here are five functions that are
being called with a NULL parameter that they cannot yet properly handle,
and which they are passing down to a str...() or mem...() function. I may
be wrong, but I don't think these have been caught by Coverity. The number
in the brackets is, of course, the parameter affected.

advapi/security.c:LookupPrivilegeNameW(3)

dbghelp/stabs.c:stabs_pts_read_type_def(2)

gdi/freetype.c:WineEngGetOutlineTextMetrics(3)

msi/table:get_tablecolumns(3)

setupapi/devinst.c:SetupDiGetDeviceInstanceIdW(3)

Cheers,

-- 
Andy.




From stefan at codeweavers.com  Sat May  3 13:34:52 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 3 May 2008 20:34:52 +0200
Subject: WineD3D: RemoveContextFromArray fix (fixes bug 12924)
In-Reply-To: <20080503182317.155030@gmx.net>
References: <20080503182317.155030@gmx.net>
Message-ID: <200805032034.52698.stefan@codeweavers.com>

Am Samstag, 3. Mai 2008 20:23:17 schrieb Roderick Colenbrander:
> Hi,
>
> RemoveContextFromArray forgot to check the last element in the array. This
> led to memory corruption (bug 12924) where wined3d started removing a
> pbuffer where none was created at all. This patch fixes it. The original
> bug was spotted by Peter Oberndorfer and for him a similar fixed some other
> program not sure which.
Maybe a comment would be helpful, reminding the reader that This->numContexts 
was decremented already and thus the <= is used. It took me a while to figure 
that out when reading the patch


From stefandoesinger at gmx.at  Sat May  3 13:37:54 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 3 May 2008 20:37:54 +0200
Subject: Possible Regression in 3Dmark 03 in win2000 mode
In-Reply-To: <19e31a080805030352k40601e14ne7028694ef61741c@mail.gmail.com>
References: <19e31a080805030352k40601e14ne7028694ef61741c@mail.gmail.com>
Message-ID: <200805032037.54587.stefandoesinger@gmx.at>

Am Samstag, 3. Mai 2008 12:52:43 schrieb Steven Edwards:
> Hi,
> Sorry to spam wine-devel...I don't have the time to file a proper bug
> report right now and I did not want to waste my time if the directx
> guys were aware of it and working on it but 3DMark03 is crashing for
> me in wn2000 mode while it functions in win98 mode. This is a
> regression and a new bug, it would be nice to have as many benchmarks
> as possible working so when 1.0 ships we can compare results to
> windows.
I'm not really aware of this, and I currently have little time to work on 
this(University keeps me busy). A regression test would be helpful.


From Andrew.Talbot at talbotville.com  Sat May  3 16:35:07 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 03 May 2008 22:35:07 +0100
Subject: X_BOOL, X_BYTE, X_INT8, etc.?
Message-ID: <fvilqc$336$1@ger.gmane.org>

In xlldrv.h, various scalar types are redefined, for example

#define BOOL X_BOOL

If these "X" variants exist on my system, they are not being included in
xfont.c. Where should I find them, please?

Thanks,

-- 
Andy.




From selliott4 at austin.rr.com  Sat May  3 18:03:54 2008
From: selliott4 at austin.rr.com (Steven Elliott)
Date: Sat, 03 May 2008 18:03:54 -0500
Subject: wineserver socket file and DOS attacks
In-Reply-To: <48194AFA.9070604@arcticnet.no>
References: <1209565413.6570.27.camel@grey>
	<b130c85e0804301145n3bcafd70l6dde5e21e0409b13@mail.gmail.com>
	<4818C3B5.9000008@arcticnet.no>
	<b130c85e0804301745v7f2657bcv906f7b297d37260c@mail.gmail.com>
	<48194AFA.9070604@arcticnet.no>
Message-ID: <1209855834.7650.40.camel@grey>

On Thu, 2008-05-01 at 06:45 +0200, Ove Kaaven wrote: 
> Maarten Lankhorst skrev:
> > Wine checks ownership of the socket and directory, so race conditions
> > aren't really a problem. This means that despite being put in a public
> > directory there is no chance of a race condition. I don't see a
> > security risk here, if someone is evil they could create that
> > directory so wine wouldn't run, but that harm is only restricted to
> > 'wine does not start'.
> 
> Which is exactly what the OP was concerned about.

You are correct that that is my concern.

I just want to say a few additional things about this and then I'll
leave it be since I think I've made my point.

I've thought a little bit about how multiple directories could be used
as a way working around the DOS attack (as I mentioned in my initial
post).  I think it is really hard to address every possible race
condition (wineserver just starting up or shutting down as a new wine
process is trying do decide which directory to use and or whether to
start a new wineserver).  I think Maarten touched on these race
condition concerns with his "The latter won't work ..." email in this
thread.  To add to the confusion the /tmp directory on most Linux
systems is subject to a cron job that deletes old files.

I think the only perfectly robust way of doing this that isn't
vulnerable to either DOS attacks or race conditions is have a permanent
directory for each user that wants to use wine that is both owned by
that user and is writable so that the socket file can be placed in it.
At one time this was ~/.wine.  So, what if the socket file was moved
back under WINEPREFIX (defaults to ~/.wine) combined with the following
requirements for users that don't have writable home directories the
first time wine is run for that user:
  1) Some new directory is created for the user.
  2) The new writable directory is chown'd to the user.
  3) WINEPREFIX is set to point to the directory.
  4) wineperfixcreate is run.
/etc/rc.d/init.d provides various examples of services that are run as
users that don't have writable home directories but that do require a
one time setup.  For example, if "foo" is some service that uses wine
then /etc/rc.d/init.d/foo would create /var/lib/foos-wine-dir if it
didn't exist and then apply the above steps.

You can also consider the SSH example where the ssh-agent process
(analogous to wineserver) is started, some tempnam() like API is used to
pick a random place for the socket file and then an environment variable
(SSH_AUTH_SOCK) points to the socket file that must be inherited by each
shell where SSH clients that want to talk to ssh-agent are used.  But
I've always thought having to deal with SSH_AUTH_SOCK was a pain (I know
most distros set it for you when you are logged in at the console, which
helps).

Maybe I'm making some bad assumptions about why the socket file can't be
placed in ~/.wine (that not all users have a writable home directory).
I'm guessing based on the snippet from my original post that includes
"Since that might not be possible" in reference to placing the socket
file under ~/.wine.

This made me curious what happens when ~/.wine is not writable.  I did a
"chattr +i" on the ~/.wine directory of an ordinary user in order to
make every file immutable.  Things pretty much work except wineserver
complains when it exits that it can't write the registry changes to the
*.reg files.  And as one might expect the registry actually does not get
updated.  But other than that it kinda works.

-- 
-----------------------------------------------------------------------
|          Steven Elliott          |      selliott4 at austin.rr.com     |
-----------------------------------------------------------------------




From gerald at pfeifer.com  Sat May  3 12:49:25 2008
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Sat, 3 May 2008 19:49:25 +0200 (CEST)
Subject: Fix building tools/widl (for bison 1.75, among others)
In-Reply-To: <481B1452.2@codeweavers.com>
References: <alpine.LSU.1.10.0805021358550.6827@acrux.dbai.tuwien.ac.at>
	<481B1452.2@codeweavers.com>
Message-ID: <alpine.LSU.1.10.0805031944340.6827@acrux.dbai.tuwien.ac.at>

On Fri, 2 May 2008, Robert Shearman wrote:
>> It turns out that current versions of bison do not enforce the documented
>> grammer as strictly as older ones such as bison 1.75.  Fixed thusly.
> Oops, thanks for spotting it. Actually, I was developing on version 1.28
> and didn't get those errors so it doesn't appear to be a deliberate change
> by the bison developers.

This is interesting.  Possibly the bison developers got feedback that
the stricter checks in 1.75 caused to many troubles (even though they
were correct per se)?

> Looks good. Please send to wine-patches.

Oops.  Originally I wasn't sure how to address the problem, so I started
this e-mail to wine-devel and then failed to adjust the address once I
had an actual patch.  Thanks for spotting this -- the patch now made it
into this week's release. :-)

Gerald



From dmitry at codeweavers.com  Sat May  3 21:05:42 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 4 May 2008 11:05:42 +0900
Subject: [PATCH 1/3] headers: add CM_Reenumerate_DevNode,
	CM_Locate_DevNode prototypes
References: <200805032157.50706.lav@etersoft.ru>
Message-ID: <007001c8ad8b$5f6800d0$a600fea9@DMITRY>

From: "Vitaly Lipatov" <lav at etersoft.ru> wrote:

> +#ifdef UNICODE
> +typedef DEVNODEID_W DEVNODEID;
> +typedef DEVINSTID_W DEVINSTID;
> +#else
> +typedef DEVNODEID_A DEVNODEID;
> +typedef DEVINSTID_A DEVINSTID;
> +#endif

Wine headers do that differently.

> +CMAPI CONFIGRET WINAPI CM_Locate_DevNodeA(PDEVINST,DEVINSTID_A,ULONG);
> +CMAPI CONFIGRET WINAPI CM_Locate_DevNodeW(PDEVINST,DEVINSTID_W,ULONG);
> +#define     CM_Locate_DevNode WINELIB_NAME_AW(CM_Locate_DevNode)
> +
> +CMAPI CONFIGRET WINAPI CM_Reenumerate_DevNode(DEVINST,ULONG);
> +CMAPI CONFIGRET WINAPI CM_Reenumerate_DevNode_Ex(DEVINST,ULONG,HMACHINE);

You need to add the prototypes when you add implementations.


-- 
Dmitry.


From dmitry at codeweavers.com  Sat May  3 21:32:52 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 4 May 2008 11:32:52 +0900
Subject: [PATCH 1/3] headers: add CM_Reenumerate_DevNode,
	CM_Locate_DevNode prototypes
References: <200805032157.50706.lav@etersoft.ru>
	<007001c8ad8b$5f6800d0$a600fea9@DMITRY>
Message-ID: <011901c8ad8f$2865d4f0$a600fea9@DMITRY>

"Dmitry Timoshkov" <dmitry at codeweavers.com> wrote:

> From: "Vitaly Lipatov" <lav at etersoft.ru> wrote:
> 
>> +#ifdef UNICODE
>> +typedef DEVNODEID_W DEVNODEID;
>> +typedef DEVINSTID_W DEVINSTID;
>> +#else
>> +typedef DEVNODEID_A DEVNODEID;
>> +typedef DEVINSTID_A DEVINSTID;
>> +#endif
> 
> Wine headers do that differently.

Please ignore my comment, WINELIB_NAME_AW won't work properly in this
case.

-- 
Dmitry.


From xixsimplicityxix at gmail.com  Sun May  4 00:30:18 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Sun, 4 May 2008 00:30:18 -0500
Subject: winetest problems
In-Reply-To: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
References: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
Message-ID: <78a7dad00805032230m6d330608pd535b1983e520def@mail.gmail.com>

On Fri, May 2, 2008 at 6:38 PM, James Hawkins <truiken at gmail.com> wrote:
> Hi,
>
>  I'm trying to fix the failing cross tests, but we haven't had a
>  winetest build on Paul Millar's server in a few days.  I'm not
>  familiar with Paul's build process, so my only guess is that a recent
>  commit has broken the build.  In the meantime, I've tried a few
>  things.
>
>  I used John Klehm's crossbuild_tricks script [1] to build winetest.
>  The build succeeded, but the submitted result [2] is empty or can't be
>  parsed.

The script was errantly depending on my old exception noop patch. I've
updated it to work with a clean wine-git.

Updated script version 20080503:
http://klehm.net/wine/crossbuild_tricks.sh

Test results from 0.9.61 my winxp box:
http://test.winehq.org/data/c6da2a0b9daa8bdba045559b057ccf43ea2209c7/

Note for anyone testing on server 2k8:  test data will not submit to
winehq. winetest just aborts after clicking yes to "submit test
results".   Ideas anyone?

--John Klehm


From truiken at gmail.com  Sun May  4 01:15:32 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 4 May 2008 01:15:32 -0500
Subject: winetest problems
In-Reply-To: <78a7dad00805032230m6d330608pd535b1983e520def@mail.gmail.com>
References: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
	<78a7dad00805032230m6d330608pd535b1983e520def@mail.gmail.com>
Message-ID: <22821af30805032315q2c0ccd05ya7c1fa6b075001e@mail.gmail.com>

On Sun, May 4, 2008 at 12:30 AM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> On Fri, May 2, 2008 at 6:38 PM, James Hawkins <truiken at gmail.com> wrote:
>
> > Hi,
>  >
>  >  I'm trying to fix the failing cross tests, but we haven't had a
>  >  winetest build on Paul Millar's server in a few days.  I'm not
>  >  familiar with Paul's build process, so my only guess is that a recent
>  >  commit has broken the build.  In the meantime, I've tried a few
>  >  things.
>  >
>  >  I used John Klehm's crossbuild_tricks script [1] to build winetest.
>  >  The build succeeded, but the submitted result [2] is empty or can't be
>  >  parsed.
>
>  The script was errantly depending on my old exception noop patch. I've
>  updated it to work with a clean wine-git.
>
>  Updated script version 20080503:
>
> http://klehm.net/wine/crossbuild_tricks.sh
>
>  Test results from 0.9.61 my winxp box:
>  http://test.winehq.org/data/c6da2a0b9daa8bdba045559b057ccf43ea2209c7/
>
>  Note for anyone testing on server 2k8:  test data will not submit to
>  winehq. winetest just aborts after clicking yes to "submit test
>  results".   Ideas anyone?
>

I'm still not getting any results with the latest script.  I think
it's a problem with the version being queried:

Version 4
Tests from build 6d4dae17d27008f501ccc4cf3ec87b00c240dada
Archive: -
Tag: jh-win2k3-vm
Build info:
Operating system version:
    bRunningUnderWine=0
    bRunningOnVisibleDesktop=1
    dwMajorVersion=8589934597
    dwMinorVersion=8589938382
    dwBuildNumber=8639766056700935376
    PlatformId=9848344841461108
    szCSDVersion=C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\res2
    wServicePackMajor=2
    wServicePackMinor=0
    wSuiteMask=272
    wProductType=3
    wReserved=30

Notice the irregular versions.

-- 
James Hawkins


From couriousous at mandriva.org  Sun May  4 07:50:33 2008
From: couriousous at mandriva.org (Couriousous)
Date: Sun, 4 May 2008 14:50:33 +0200
Subject: [PATCH] Add SIO_KEEPALIVE_VALS support to winsock
Message-ID: <200805041450.33421.couriousous@mandriva.org>

Hello

When Altium 6 is used with a license server, it need the WSAIoctl() with 
SIO_KEEPALIVE_VALS control code to succeed, otherwise it cannot connect 
to the license server.

The following patch implement the missing parts and allow altium 6 to 
works perfectly with wine !

Regards,
Philippe

---

Index: dlls/ws2_32/socket.c
===================================================================
--- dlls/ws2_32/socket.c
+++ dlls/ws2_32/socket.c	2008-05-04 13:53:50.000000000 +0200
@@ -2292,6 +2292,48 @@
        WSASetLastError(WSAEOPNOTSUPP);
        return SOCKET_ERROR;
 
+   case WS_SIO_KEEPALIVE_VALS:
+       if(lpvInBuffer) {
+	       int fd;
+	       struct tcp_keepalive  *d = lpvInBuffer;
+	       int idle = d->keepalivetime / 1000;
+	       int interv = d->keepaliveinterval / 1000;
+	       int enable = d->onoff ? 1: 0;
+	       TRACE("socket %04lx, keepalivetime: %d, keepaliveinterval: %d\n", s, idle, interv);
+	       if(idle == 0 || interv == 0) {
+		       WSASetLastError(WSAEINVAL);
+		       return SOCKET_ERROR;
+	       }
+	       fd = get_sock_fd( s, 0, NULL );
+	       if(setsockopt(fd, SOL_SOCKET, SO_KEEPALIVE, (void *) &enable, sizeof(int)) == -1) {
+		       release_sock_fd( s, fd );
+		       WSASetLastError(WSAEINVAL);
+		       return SOCKET_ERROR;
+	       }
+#if (defined TCP_KEEPIDLE) && (defined TCP_KEEPINTVL)
+	       if(setsockopt(fd, IPPROTO_TCP, TCP_KEEPIDLE, (void *) &idle, sizeof(int)) == -1) {
+		       release_sock_fd( s, fd );
+		       WSASetLastError(WSAEINVAL);
+		       return SOCKET_ERROR;
+	       }
+
+	       if(setsockopt(fd, IPPROTO_TCP, TCP_KEEPINTVL, (void *) &interv, sizeof(int)) == -1) {
+		       release_sock_fd( s, fd );
+		       WSASetLastError(WSAEINVAL);
+		       return SOCKET_ERROR;
+	       }
+#else
+	       FIXME("Ignoreing keepalive interval and timeout");
+#endif
+	       release_sock_fd( s, fd );
+	       break;
+       } else {
+	       WSASetLastError(WSAEINVAL);
+               return SOCKET_ERROR;
+       }
+
+       break;
+
    default:
        FIXME("unsupported WS_IOCTL cmd (%08x)\n", dwIoControlCode);
        WSASetLastError(WSAEOPNOTSUPP);
Index: include/winsock2.h
===================================================================
--- include/winsock2.h
+++ include/winsock2.h	2008-05-03 22:45:08.000000000 +0200
@@ -142,6 +142,7 @@
 #define WS_SIO_ADDRESS_LIST_CHANGE            _WSAIO(WS_IOC_WS2,23)
 #define WS_SIO_QUERY_TARGET_PNP_HANDLE        _WSAIOR(WS_IOC_WS2,24)
 #define WS_SIO_GET_INTERFACE_LIST             WS__IOR('t', 127, WS_u_long)
+#define WS_SIO_KEEPALIVE_VALS 		      _WSAIOW(WS_IOC_VENDOR,4) 
 #else /* USE_WS_PREFIX */
 #undef IOC_VOID
 #undef IOC_IN
@@ -178,8 +179,16 @@
 #define SIO_ADDRESS_LIST_CHANGE    _WSAIO(IOC_WS2,23)
 #define SIO_QUERY_TARGET_PNP_HANDLE _WSAIOR(IOC_WS2,24)
 #define SIO_GET_INTERFACE_LIST     _IOR ('t', 127, u_long)
+#define SIO_KEEPALIVE_VALS 	   _WSAIOW(IOC_VENDOR,4) 
 #endif /* USE_WS_PREFIX */
 
+/* Argument structure for SIO_KEEPALIVE_VALS */
+struct tcp_keepalive {
+	u_long  onoff;
+	u_long  keepalivetime;
+	u_long  keepaliveinterval;
+};
+
 /* Constants for WSAIoctl() */
 #define WSA_FLAG_OVERLAPPED        0x01
 #define WSA_FLAG_MULTIPOINT_C_ROOT 0x02



From slink3r at slinker.in  Sun May  4 00:47:48 2008
From: slink3r at slinker.in (Brian Fuller)
Date: Sun, 4 May 2008 01:47:48 -0400
Subject: Steampowered.com has sent me ~10 e-mails
Message-ID: <64e3a9ad0805032247g60531b22lfc23d5ad4a9513af@mail.gmail.com>

I've gotten ~10 e-mails from steampowered.com regarding this issue.

Everyone of them is virtually nothing but quoted information.

I had TF2 crash on my computer, then I went back in, snagged the memory
dumps and submitted them to steampowered.com, told them I was on the wine
list and I needed better DLL support from Nvidia.

Once they established that I had the advanced guide for myself, and I
continued to procede by telling them:

After running Steam and opening TF2, download initializes from server
correctly, as connecting to server system goes down.

kern.log:
Apr 30 09:51:17 slinker-desktop kernel: [52605.857549]
totem-plugin-vi[20091]: segfault at 4 rip 411a15 rsp 7fff5f4cb3e0 error 4
Apr 30 09:51:17 slinker-desktop kernel: [52605.934792]
totem-plugin-vi[20089]: segfault at 4 rip 411a15 rsp 7fffaea1a930 error 4

Same two error messages in messages

-----------
Next: Brian,

Thank you for submitting these minidumps. If you continue to experience
problems with game crashes, please complete the steps in the link below.

Title: Troubleshooting Game Crashes
Link: http://support.steampowered.com/kb_article.php?ref=7169-TIAV-5361

-------------

I'm not sure if this helps, but I was working on WineHT.dll at the same
time, and maybe some sort of mis-interaction on the level of an application
running on my operating system with your product could've resulted in the
crash?

I was just hoping with the specific information on those memory locations
perhaps you could provide me some knowledge of the Windows/DirectX API that
deals with these particular switches, as to enlighten me towards my game not
crashing in the future.

Sorry to complicate the issue :\
-BAF

-----------

they responded with nothing but quotes

 Now I'm trying to differentiate on an iron curtain the color differences
being generated by heat being applied using nothing but a router. Figuring
out why it corrupted those packets would be accessed in the API, then put
into the CPU, calculating this. Once you've calculated the color
differentiations throughout the sheet, you could re-draw this sheet in 3d
with the right colors using OpenGL. That's the goal at least.


 The important part being the edges between the different colors.

They finally closed the ticket today.

-BAF

P.S. Just have a seat, I'll be right with you with valid code.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080504/d44d3fc7/attachment.htm 

From david.adam.cnrs at gmail.com  Sun May  4 07:35:37 2008
From: david.adam.cnrs at gmail.com (David Adam)
Date: Sun, 4 May 2008 14:35:37 +0200
Subject: winex11.drv: Set the size of returned DEVMODE to least common one as
	XP does
Message-ID: <5f9140a20805040535s63d31fc0ofeea05a753bbf867@mail.gmail.com>

Hello

>-    devmode->dmSize = sizeof(DEVMODEW);
>-    devmode->dmSpecVersion = MAKEWORD(1,4);
>-    devmode->dmDriverVersion = MAKEWORD(1,4);
>+    devmode->dmSize = FIELD_OFFSET(DEVMODEW, dmICMMethod);
>+    devmode->dmSpecVersion = DM_SPECVERSION;
>+    devmode->dmDriverVersion = DM_SPECVERSION;
Wouldn't it be better to write
  *devmode->dmDeviceName=*dev_name
instead of
>     memcpy(devmode->dmDeviceName, dev_name, sizeof(dev_name));


David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080504/85b11a54/attachment.htm 

From rob at codeweavers.com  Sun May  4 11:00:01 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Sun, 04 May 2008 17:00:01 +0100
Subject: winex11.drv: Set the size of returned DEVMODE to least common
	one as	XP does
In-Reply-To: <5f9140a20805040535s63d31fc0ofeea05a753bbf867@mail.gmail.com>
References: <5f9140a20805040535s63d31fc0ofeea05a753bbf867@mail.gmail.com>
Message-ID: <481DDD81.6090002@codeweavers.com>

David Adam wrote:
> Hello
>
> >-    devmode->dmSize = sizeof(DEVMODEW);
> >-    devmode->dmSpecVersion = MAKEWORD(1,4);
> >-    devmode->dmDriverVersion = MAKEWORD(1,4);
> >+    devmode->dmSize = FIELD_OFFSET(DEVMODEW, dmICMMethod);
>
> >+    devmode->dmSpecVersion = DM_SPECVERSION;
> >+    devmode->dmDriverVersion = DM_SPECVERSION;
> Wouldn't it be better to write 
>   *devmode->dmDeviceName=*dev_name
> instead of
>
> >     memcpy(devmode->dmDeviceName, dev_name, sizeof(dev_name));
>   

You can't copy whole arrays using one dereference operator. The reason 
for this is that the dereference operator only returns the contents of 
the first element in the array.

-- 
Rob Shearman



From rob at codeweavers.com  Sun May  4 11:03:49 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Sun, 04 May 2008 17:03:49 +0100
Subject: credui: Danish translation
In-Reply-To: <200805041728.21070.jens@albretsen.dk>
References: <200805041728.21070.jens@albretsen.dk>
Message-ID: <481DDE65.2030701@codeweavers.com>

Jens Albretsen wrote:
> Changelog:
> Danish translation of credui
>   
> +LANGUAGE LANG_DANISH, SUBLANG_DEFAULT
> +
> +IDD_CREDDIALOG DIALOG DISCARDABLE  0, 0, 213, 149
> +STYLE DS_MODALFRAME | DS_NOIDLEMSG | DS_CENTER | WS_POPUP | WS_CAPTION | WS_SYSMENU
> +CAPTION "IDS_TITLEFORMAT"
> +FONT 8, "MS Shell Dlg"
> +BEGIN
> +    CONTROL         IDB_BANNER,IDC_STATIC,"Statisk",SS_BITMAP | SS_CENTERIMAGE,0,
> +                    0,213,37

It's an easy mistake to make, but the third piece of data for the 
CONTROL statement is the name of a Windows class, so it shouldn't be 
translated.

BTW, you can test your translation of credui by running the credui tests 
with the WINETESTINTERACTIVE environment variable to "1".

-- 
Rob Shearman



From xixsimplicityxix at gmail.com  Sun May  4 12:42:37 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Sun, 4 May 2008 12:42:37 -0500
Subject: winetest problems
In-Reply-To: <22821af30805032315q2c0ccd05ya7c1fa6b075001e@mail.gmail.com>
References: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
	<78a7dad00805032230m6d330608pd535b1983e520def@mail.gmail.com>
	<22821af30805032315q2c0ccd05ya7c1fa6b075001e@mail.gmail.com>
Message-ID: <78a7dad00805041042n36634ef1na7acbcd22e69217b@mail.gmail.com>

On Sun, May 4, 2008 at 1:15 AM, James Hawkins <truiken at gmail.com> wrote:
>  I'm still not getting any results with the latest script.  I think
>  it's a problem with the version being queried:
>
>  Version 4
>  Tests from build 6d4dae17d27008f501ccc4cf3ec87b00c240dada
>  Archive: -
>  Tag: jh-win2k3-vm
>  Build info:
>  Operating system version:
>     bRunningUnderWine=0
>     bRunningOnVisibleDesktop=1
>     dwMajorVersion=8589934597
>     dwMinorVersion=8589938382
>     dwBuildNumber=8639766056700935376
>     PlatformId=9848344841461108
>     szCSDVersion=C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\res2
>     wServicePackMajor=2
>     wServicePackMinor=0
>     wSuiteMask=272
>     wProductType=3
>     wReserved=30
>
>  Notice the irregular versions.
>

When I run the exe you sent me I get similar but not the same results:

Version 4
Tests from build 1a5aab0ddcc7a0dcde4403add73dbd80be746020
Archive: -
Tag: hawkins
Build info:
Operating system version:
    bRunningUnderWine=0
    bRunningOnVisibleDesktop=1
    dwMajorVersion=6
    dwMinorVersion=8589940593
    dwBuildNumber=8601111290907393184
    PlatformId=9848138674030886
    szCSDVersion=C:\Users\ADMINI~1\AppData\Local\Temp\1\res5
    wServicePackMajor=1
    wServicePackMinor=0
    wSuiteMask=272
    wProductType=3
    wReserved=3



However from my own build I get sane versions:


Version 4
Tests from build c6da2a0b9daa8bdba045559b057ccf43ea2209c7
Archive: -
Tag: versiontest-jklehm
Build info:
Operating system version:
    bRunningUnderWine=0
    bRunningOnVisibleDesktop=1
    dwMajorVersion=6
    dwMinorVersion=0
    dwBuildNumber=6001
    PlatformId=2
    szCSDVersion=Service Pack 1
    wServicePackMajor=1
    wServicePackMinor=0
    wSuiteMask=272
    wProductType=3
    wReserved=3


From truiken at gmail.com  Sun May  4 13:32:07 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 4 May 2008 13:32:07 -0500
Subject: winetest problems
In-Reply-To: <78a7dad00805041042n36634ef1na7acbcd22e69217b@mail.gmail.com>
References: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
	<78a7dad00805032230m6d330608pd535b1983e520def@mail.gmail.com>
	<22821af30805032315q2c0ccd05ya7c1fa6b075001e@mail.gmail.com>
	<78a7dad00805041042n36634ef1na7acbcd22e69217b@mail.gmail.com>
Message-ID: <22821af30805041132j2199e5dfw58e9684ffad6027@mail.gmail.com>

On Sun, May 4, 2008 at 12:42 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> On Sun, May 4, 2008 at 1:15 AM, James Hawkins <truiken at gmail.com> wrote:
>  >  I'm still not getting any results with the latest script.  I think
>  >  it's a problem with the version being queried:
>  >
>  >  Version 4
>  >  Tests from build 6d4dae17d27008f501ccc4cf3ec87b00c240dada
>  >  Archive: -
>  >  Tag: jh-win2k3-vm
>  >  Build info:
>  >  Operating system version:
>  >     bRunningUnderWine=0
>  >     bRunningOnVisibleDesktop=1
>  >     dwMajorVersion=8589934597
>  >     dwMinorVersion=8589938382
>  >     dwBuildNumber=8639766056700935376
>  >     PlatformId=9848344841461108
>  >     szCSDVersion=C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\res2
>  >     wServicePackMajor=2
>  >     wServicePackMinor=0
>  >     wSuiteMask=272
>  >     wProductType=3
>  >     wReserved=30
>  >
>  >  Notice the irregular versions.
>  >
>
>  When I run the exe you sent me I get similar but not the same results:
>
>  Version 4
>  Tests from build 1a5aab0ddcc7a0dcde4403add73dbd80be746020
>  Archive: -
>  Tag: hawkins
>
> Build info:
>  Operating system version:
>     bRunningUnderWine=0
>     bRunningOnVisibleDesktop=1
>     dwMajorVersion=6
>     dwMinorVersion=8589940593
>     dwBuildNumber=8601111290907393184
>     PlatformId=9848138674030886
>     szCSDVersion=C:\Users\ADMINI~1\AppData\Local\Temp\1\res5
>     wServicePackMajor=1
>
>     wServicePackMinor=0
>     wSuiteMask=272
>     wProductType=3
>     wReserved=3
>
>
>
>  However from my own build I get sane versions:
>
>
>  Version 4
>  Tests from build c6da2a0b9daa8bdba045559b057ccf43ea2209c7
>  Archive: -
>  Tag: versiontest-jklehm
>
> Build info:
>  Operating system version:
>     bRunningUnderWine=0
>     bRunningOnVisibleDesktop=1
>     dwMajorVersion=6
>     dwMinorVersion=0
>     dwBuildNumber=6001
>     PlatformId=2
>     szCSDVersion=Service Pack 1
>     wServicePackMajor=1
>
>
>     wServicePackMinor=0
>     wSuiteMask=272
>     wProductType=3
>     wReserved=3
>

I usually use i586-mingw32msvc, so I tried mingw32 thinking that would
be the difference, but I get the same results.

-- 
James Hawkins


From juan.lang at gmail.com  Sun May  4 20:56:28 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Sun, 4 May 2008 18:56:28 -0700
Subject: [PATCH] Add SIO_KEEPALIVE_VALS support to winsock
In-Reply-To: <200805041450.33421.couriousous@mandriva.org>
References: <200805041450.33421.couriousous@mandriva.org>
Message-ID: <3a768c550805041856u7e1a8fean8ff0bbe99a19824a@mail.gmail.com>

Hi,

On Sun, May 4, 2008 at 5:50 AM, Couriousous <couriousous at mandriva.org> wrote:
> The following patch implement the missing parts and allow altium 6 to
> works perfectly with wine !

Patches without your full name are unlikely to get accepted.  Would
you mind resending with your full name?  Thanks,
--Juan


From dank at kegel.com  Sun May  4 22:13:16 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 4 May 2008 20:13:16 -0700
Subject: Time-based releases idea
Message-ID: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>

I just wrote up an idea related to release management for post-1.0
wine releases.  It's online at
  http://wiki.winehq.org/TimeBasedReleases
Essentially, the idea is to release in March and September,
in time for the April and October releases of Ubuntu.

For instance, following this strategy, we might plan to release
wine-1.2.0 in September 2008 or March 2009.

The alternative is to propose a set of criteria that wine-1.2
needs to meet, and working until they are met, which
is what we did for wine-0.9 and wine-1.0 (I think; it's kind
of hard to tell).

I look forward to discussing this idea... perhaps we shouldn't
bother to until after 1.0 is released, but I wanted to get it out
early so the discussion can begin in time for us to move on it
if we want to.
- Dan


From austinenglish at gmail.com  Sun May  4 22:28:39 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 4 May 2008 22:28:39 -0500
Subject: Time-based releases idea
In-Reply-To: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
Message-ID: <b6bb06270805042028m2a36646dpa7d2c87ea0e4c249@mail.gmail.com>

On Sun, May 4, 2008 at 10:13 PM, Dan Kegel <dank at kegel.com> wrote:
> I just wrote up an idea related to release management for post-1.0
>  wine releases.  It's online at
>   http://wiki.winehq.org/TimeBasedReleases
>  Essentially, the idea is to release in March and September,
>  in time for the April and October releases of Ubuntu.
>
>  For instance, following this strategy, we might plan to release
>  wine-1.2.0 in September 2008 or March 2009.
>
>  The alternative is to propose a set of criteria that wine-1.2
>  needs to meet, and working until they are met, which
>  is what we did for wine-0.9 and wine-1.0 (I think; it's kind
>  of hard to tell).
>
>  I look forward to discussing this idea... perhaps we shouldn't
>  bother to until after 1.0 is released, but I wanted to get it out
>  early so the discussion can begin in time for us to move on it
>  if we want to.
>  - Dan
>
>
>

I don't think we should schedule our release schedule around Ubuntu's.
Just because it's very popular (and possibly our most widely used
target), doesn't mean we need to revolve around it. I'd say let's look
at the 1.2 buglist (along with the 1.0's we can't fix), set a goal to
get 1/2 of those fixed, test our 'supported' apps for regressions, and
release then.

Also might consider waiting until 1.0's hit for a month or so and see
what the biggest complaints are, and focus on fixing those for 1.2.

-Austin


From winehacker at gmail.com  Sun May  4 23:41:08 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 5 May 2008 00:41:08 -0400
Subject: Time-based releases idea
In-Reply-To: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
Message-ID: <19e31a080805042141s6a12e3c3p44dc69e3ffed2efb@mail.gmail.com>

On Sun, May 4, 2008 at 11:13 PM, Dan Kegel <dank at kegel.com> wrote:
>  I look forward to discussing this idea... perhaps we shouldn't
>  bother to until after 1.0 is released, but I wanted to get it out
>  early so the discussion can begin in time for us to move on it
>  if we want to.

I think having semi-annual releases would be good but I don't think
they should be tied to any distro. Popularity of Linux distributions
shifts in the wind and with the ability for users to pull updates from
the internet, being tied to a release is largely irrelevant. Having
good criteria for semi-annual releases should be the topic at the next
wineconf though, unless that criteria falls to the benevolent dictator
in chief for life.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From fgouget at free.fr  Mon May  5 01:47:52 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 5 May 2008 08:47:52 +0200 (CEST)
Subject: wineserver socket file and DOS attacks
In-Reply-To: <1209565413.6570.27.camel@grey>
References: <1209565413.6570.27.camel@grey>
Message-ID: <alpine.DEB.1.10.0805050843450.10891@amboise.dolphin>

On Wed, 30 Apr 2008, Steven Elliott wrote:

> I have some concerns about the location of the socket file that
> wineserver uses.  Since by default the current location is in /tmp my
> concern is that anyone can stop anyone else from using wine just by
> creating a directory named /tmp/.wine-500.  
[...]

In /tmp I see the following:

   .X0-lock
   .X11-unix/
   fgouget/
   gconfd-fgouget/
   vmware-fgouget/
   xmms_fgouget.0

So it seems like if there is a malicious user Wine will not be the only 
application that will be affected. So the question is: are all these 
apps susceptible to DoS or do they avoid DoS somehow? And if they 
prevent DoS, how and is that technique applicable to Wine?


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
     You can have my guns when you pry them from my kids cold, dead hands.


From marcus at jet.franken.de  Mon May  5 02:11:44 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Mon, 5 May 2008 09:11:44 +0200
Subject: wineserver socket file and DOS attacks
In-Reply-To: <alpine.DEB.1.10.0805050843450.10891@amboise.dolphin>
References: <1209565413.6570.27.camel@grey>
	<alpine.DEB.1.10.0805050843450.10891@amboise.dolphin>
Message-ID: <20080505071144.GA22931@galeere>

On Mon, May 05, 2008 at 08:47:52AM +0200, Francois Gouget wrote:
> On Wed, 30 Apr 2008, Steven Elliott wrote:
> 
> > I have some concerns about the location of the socket file that
> > wineserver uses.  Since by default the current location is in /tmp my
> > concern is that anyone can stop anyone else from using wine just by
> > creating a directory named /tmp/.wine-500.  
> [...]
> 
> In /tmp I see the following:
> 
>    .X0-lock
>    .X11-unix/
>    fgouget/
>    gconfd-fgouget/
>    vmware-fgouget/
>    xmms_fgouget.0
> 
> So it seems like if there is a malicious user Wine will not be the only 
> application that will be affected. So the question is: are all these 
> apps susceptible to DoS or do they avoid DoS somehow? And if they 
> prevent DoS, how and is that technique applicable to Wine?

For gconfd-* gconfd2 creates secondary directories if one is present
(and checks if its there).

.X11-unix/ is on suse created during install at least, so no problem.

No idea about the others.

Ciao, Marcus


From kai.blin at gmail.com  Mon May  5 03:02:46 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 5 May 2008 10:02:46 +0200
Subject: Time-based releases idea
In-Reply-To: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
Message-ID: <200805051002.51178.kai.blin@gmail.com>

On Monday 05 May 2008 05:13:16 Dan Kegel wrote:
> I just wrote up an idea related to release management for post-1.0
> wine releases.  It's online at
>   http://wiki.winehq.org/TimeBasedReleases
> Essentially, the idea is to release in March and September,
> in time for the April and October releases of Ubuntu.
>
> For instance, following this strategy, we might plan to release
> wine-1.2.0 in September 2008 or March 2009.

I'm against September, as it means we'll go into code freeze _again_ just 
before Summer of Code finishes.

While I agree that bi-annual releases sound like a good thing, I'm opposed to 
forcing it just to make Ubuntu's 8.10 schedule with 1.2.

Also, I'm not really sure what this'll mean in terms of features and bug 
fixes. We certainly don't want to keep people hanging without fixes for bugs 
for half a year.

We also don't want to slow down development more than needed.

Now, as you state on the wiki page, a bi-weekly release schedule is good for 
early adopters and developers, as it's centered on "Get my new cool feature 
in!" rather than on "Will this break Photoshop?". But, and I see you mention 
that yourself, "Will this break Photoshop?" is a really hard question to 
answer, especially for developers who don't own photoshop.

Bi-annual releases are good for people who already have their apps working, as 
prior to a release we probably should make sure nothing breaks. But as fixing 
new bugs sometimes is a bit hit-and-miss, only being able to try for the 
wider public once every six months isn't too great.

So assuming we manage to get wine test failures down to 0 during this code 
freeze, I'm happy to make sure none of my patches breaks anything there. If I 
can get a similar website for the apps we really don't want to regress, I'll 
of course try the same for that. But before we don't have that, I don't think 
it's a good idea.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080505/1703ad8d/attachment.pgp 

From julliard at winehq.org  Mon May  5 05:16:34 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 05 May 2008 12:16:34 +0200
Subject: wineserver socket file and DOS attacks
In-Reply-To: <1209855834.7650.40.camel@grey> (Steven Elliott's message of
	"Sat, 03 May 2008 18:03:54 -0500")
References: <1209565413.6570.27.camel@grey>
	<b130c85e0804301145n3bcafd70l6dde5e21e0409b13@mail.gmail.com>
	<4818C3B5.9000008@arcticnet.no>
	<b130c85e0804301745v7f2657bcv906f7b297d37260c@mail.gmail.com>
	<48194AFA.9070604@arcticnet.no> <1209855834.7650.40.camel@grey>
Message-ID: <87prs1dpj1.fsf@wine.dyndns.org>

Steven Elliott <selliott4 at austin.rr.com> writes:

> Maybe I'm making some bad assumptions about why the socket file can't be
> placed in ~/.wine (that not all users have a writable home directory).
> I'm guessing based on the snippet from my original post that includes
> "Since that might not be possible" in reference to placing the socket
> file under ~/.wine.

No, the real problem with putting it under the home directory is that
many setups have the home directory on a networked file system, but the
socket needs to be local to the machine.

I don't think the DoS is a big issue, but if it is for you it's pretty
easy to have a script create the directories for all users at boot time.

-- 
Alexandre Julliard
julliard at winehq.org


From scott at open-vote.org  Mon May  5 06:12:52 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Mon, 05 May 2008 04:12:52 -0700
Subject: Time-based releases idea
In-Reply-To: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
Message-ID: <481EEBB4.4000104@open-vote.org>

Dan Kegel wrote:
> I just wrote up an idea related to release management for post-1.0
> wine releases.  It's online at
>   http://wiki.winehq.org/TimeBasedReleases
> Essentially, the idea is to release in March and September,
> in time for the April and October releases of Ubuntu.

You have my 120% support for this.  Although Ubuntu is certainly our
biggest distribution, I'd like to stress that by targeting March and
September, we're not just doing this for Ubuntu; we're doing it for
every distro that is timed to release shortly after the bi-annual Gnome
and X releases.

There is growing support for synchronizing distro release dates, not
only for the above reason, but also to make Linux as a whole look good.

> For instance, following this strategy, we might plan to release
> wine-1.2.0 in September 2008 or March 2009.
> 
> The alternative is to propose a set of criteria that wine-1.2
> needs to meet, and working until they are met, which
> is what we did for wine-0.9 and wine-1.0 (I think; it's kind
> of hard to tell).

The alternative, truthfully, is choosing between shipping Ubuntu with a
2+months out of date Wine version or an untested one.  Either option sucks.

Let's face it, we effectively have time-based releases now, since with
the features-based model 1.0 kept getting pushed back for years and
years.  Now, that we've finally set a date, we're actually going to have
one ;)  I could be wrong, but I don't see any better dates to use than
March and September, just in time for the release candidates to hit the
betas of the upcoming distro releases.

Thanks,
Scott Ritchie


From meissner at suse.de  Mon May  5 06:25:26 2008
From: meissner at suse.de (Marcus Meissner)
Date: Mon, 5 May 2008 13:25:26 +0200
Subject: Time-based releases idea
In-Reply-To: <481EEBB4.4000104@open-vote.org>
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
	<481EEBB4.4000104@open-vote.org>
Message-ID: <20080505112526.GB16418@suse.de>

On Mon, May 05, 2008 at 04:12:52AM -0700, Scott Ritchie wrote:
> Dan Kegel wrote:
> > I just wrote up an idea related to release management for post-1.0
> > wine releases.  It's online at
> >   http://wiki.winehq.org/TimeBasedReleases
> > Essentially, the idea is to release in March and September,
> > in time for the April and October releases of Ubuntu.
> 
> You have my 120% support for this.  Although Ubuntu is certainly our
> biggest distribution, I'd like to stress that by targeting March and
> September, we're not just doing this for Ubuntu; we're doing it for
> every distro that is timed to release shortly after the bi-annual Gnome
> and X releases.

There aren't any except Ubuntu that do this I guess.

At least SUSE releases in an 8 month cycle currently.
 
> There is growing support for synchronizing distro release dates, not
> only for the above reason, but also to make Linux as a whole look good.

No, this is mostly Ubuntu wishful thinking as far as I see.

> The alternative, truthfully, is choosing between shipping Ubuntu with a
> 2+months out of date Wine version or an untested one.  Either option sucks.

I would really like to see what Alexandre thinks and how the post-1.0 
things work out.

Or if we have to put a release dude in, just like Dan now. ;)

Ciao, Marcus


From julliard at winehq.org  Mon May  5 07:12:42 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 05 May 2008 14:12:42 +0200
Subject: Time-based releases idea
In-Reply-To: <481EEBB4.4000104@open-vote.org> (Scott Ritchie's message of
	"Mon, 05 May 2008 04:12:52 -0700")
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
	<481EEBB4.4000104@open-vote.org>
Message-ID: <87lk2pdk5h.fsf@wine.dyndns.org>

Scott Ritchie <scott at open-vote.org> writes:

> The alternative, truthfully, is choosing between shipping Ubuntu with a
> 2+months out of date Wine version or an untested one.  Either option sucks.

I don't see how we can possibly have a tested release ready every time
some distro decides to ship. On the contrary, since distros don't give a
damn about Wine and usually do their best to break it (page zero issue
anyone?), we are better off releasing after a major distro release so
that we have a chance to find and fix the latest breakages first.

> Let's face it, we effectively have time-based releases now, since with
> the features-based model 1.0 kept getting pushed back for years and
> years.  Now, that we've finally set a date, we're actually going to have
> one ;)

It's still very much a feature-based model, only of course the desirable
features have been shifting as Microsoft shipped new stuff and people
wanted to run new apps before we supported the old ones properly...  A
deadline is of course necessary at some point, but the date was only set
once we got to the point that a release looked within reach.

Of course our next releases hopefully won't take 15 years each, but I
think it's too early to say if the next release will take 6 months or 2
years.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Mon May  5 07:59:10 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 5 May 2008 05:59:10 -0700
Subject: Time-based releases idea
In-Reply-To: <87lk2pdk5h.fsf@wine.dyndns.org>
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
	<481EEBB4.4000104@open-vote.org> <87lk2pdk5h.fsf@wine.dyndns.org>
Message-ID: <a71bd89a0805050559s4074f6d0j39994af86ccf82c2@mail.gmail.com>

On Mon, May 5, 2008 at 5:12 AM, Alexandre Julliard <julliard at winehq.org> wrote:
>  I don't see how we can possibly have a tested release ready every time
>  some distro decides to ship.

That wasn't the proposal.  The proposal was to ship every 6 months, and
to pick a release date that made some sense relative to any emerging
rhythm in distro releases.

FWIW, Fedora also seems to be on a six month release schedule;
http://fedoraproject.org/wiki/Releases/9/Schedule
says 8 released in November, and 9 will release in May.

> On the contrary, since distros don't give a
>  damn about Wine and usually do their best to break it (page zero issue
>  anyone?)

That wasn't the distro; that was an upstream kernel vulnerability fix
announced in February,
http://kerneltrap.org/Linux/Patching_CVE-2008-0600_Local_Root_Exploit

> we are better off releasing after a major distro release so
> that we have a chance to find and fix the latest breakages first.

If we want to catch breakages like the recent one early, we shouldn't
wait for the distros; we should run Wine with each new release of
the Linux kernel.

>  It's still very much a feature-based model, only of course the desirable
>  features have been shifting as Microsoft shipped new stuff and people
>  wanted to run new apps before we supported the old ones properly...

You assert Wine's releases will be feature-based, but
I don't understand your reasoning yet.
- Dan


From scott at open-vote.org  Mon May  5 08:17:51 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Mon, 05 May 2008 06:17:51 -0700
Subject: Time-based releases idea
In-Reply-To: <87lk2pdk5h.fsf@wine.dyndns.org>
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>	<481EEBB4.4000104@open-vote.org>
	<87lk2pdk5h.fsf@wine.dyndns.org>
Message-ID: <481F08FF.60100@open-vote.org>

Alexandre Julliard wrote:
> Scott Ritchie <scott at open-vote.org> writes:
> 
>> The alternative, truthfully, is choosing between shipping Ubuntu with a
>> 2+months out of date Wine version or an untested one.  Either option sucks.
> 
> I don't see how we can possibly have a tested release ready every time
> some distro decides to ship. On the contrary, since distros don't give a
> damn about Wine and usually do their best to break it (page zero issue
> anyone?), we are better off releasing after a major distro release so
> that we have a chance to find and fix the latest breakages first.
> 

Why not target Wine around the beta release?  That way we still have
time to change and fix things that have to be done at the distro level.
 For instance, during the Ubuntu Hardy beta, I found a handful of bugs
that required changes in other packages than Wine, such as missing 32
bit versions of some of the libraries.

If we had committed Ubuntu to release with an older version of Wine that
didn't have those features, those bugs wouldn't have been found in time
for our dependencies to be fixed.  Users who managed to get the newer
release of Wine (such as from our website or with Ubuntu backports)
would have that feature permanently broken until the next Ubuntu
release, and in the meantime we'd likely get a bunch of bad bug reports.

>> Let's face it, we effectively have time-based releases now, since with
>> the features-based model 1.0 kept getting pushed back for years and
>> years.  Now, that we've finally set a date, we're actually going to have
>> one ;)
> 
> It's still very much a feature-based model, only of course the desirable
> features have been shifting as Microsoft shipped new stuff and people
> wanted to run new apps before we supported the old ones properly...  A
> deadline is of course necessary at some point, but the date was only set
> once we got to the point that a release looked within reach.
> 

Fair enough.  There really is nothing wrong with what happens in
practice: tons of ambitious new features are targeted for the next major
release, then after the date is set and begins to approach things get
more aggressively triaged.  You are, of course, free to delay a release
pending whatever feature you think is both doable and critical.

> Of course our next releases hopefully won't take 15 years each, but I
> think it's too early to say if the next release will take 6 months or 2
> years.
> 

We don't need to make a new major release every 6 months for things to
time well, just some multiple of it.  The main benefit is the same as
having the biweekly releases - more users with a newer Wine.

I can't say for sure as I haven't worked on Wine C code, but I don't
think even an ambitious 6 month release cycle puts us in danger of
having a dramatic amount of lost work.  The move to GIT has likely
helped a lot, as its relatively easy to maintain branches for a feature
that won't make it into the next release. If the stable release is at
the wrong time, a developer could practically ignore the release
entirely and simply have his changes merged in later.


The biweekly release has served us very well, and it seems reasonable to
extend this sort of regularity to stable releases. Wine obviously
shouldn't recommend a particular distro or anything, but my experience
with Ubuntu and Wine has taught me that there are some very real and
tangible benefits to timed releases.  March and September seem like as
good months as any.

Thanks,
Scott Ritchie


From dank at kegel.com  Mon May  5 09:03:22 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 5 May 2008 07:03:22 -0700
Subject: Time-based releases idea
In-Reply-To: <87hcdceu0h.fsf@wine.dyndns.org>
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
	<481EEBB4.4000104@open-vote.org> <87lk2pdk5h.fsf@wine.dyndns.org>
	<a71bd89a0805050559s4074f6d0j39994af86ccf82c2@mail.gmail.com>
	<87hcdceu0h.fsf@wine.dyndns.org>
Message-ID: <a71bd89a0805050703he695cdej23f719f85338573b@mail.gmail.com>

On Mon, May 5, 2008 at 6:54 AM, Alexandre Julliard <julliard at winehq.org> wrote:
>  It's the distro that changed the mmap config, not the kernel. I'm not
>  sure I understand their reasoning, apparently this was an attempt to
>  work around the vulnerability without fixing the kernel.

Oh, right.  I think they were using belt and suspenders, on the theory that
more such bugs may be lurking.

> My point is that if they cared about Wine they would have taken
> into account the fact that it got broken, and hopefully found a different
> way of addressing the issue.

Indeed, they don't care about Wine enough yet.  I suspect that this will
change once enough of the latest Adobe apps run.

>  Of all the breakages we've had over the years very
>  few were caused by the kernel; most were caused by distros shipping
>  unstable and untested packages, or broken default configs.

I stand corrected.

>  Making a stable release is a lot of work, particularly since given the
>  nature of Wine it's very hard to test it properly and make sure we are
>  not breaking things.

The QA argument is a good one.  I would not feel comfortable doing
quick releases until we had a better automated app QA story -- even though
automated app QA never finds many bugs, it would provide some
insurance against brown-paper-bag regressions.  We would also need
a fairly large army of early adopters willing to try release candidates.

> We don't want to go through the process unless we
>  have some significant features to release, and significant features
>  can't be developed on a fixed time frame.
>  For instance, one feature we'd want in 1.2 is the DIB engine; nobody can
>  guarantee that it will be ready, tested, and debugged properly by
>  September. I'd much prefer to ship 1.2 with a working DIB engine say in
>  December, than with a broken one in September.

There are other features we might want in 1.2, for instance, Photoshop
CS3 support.
But I would happily ship a 1.2 that had none of these features
if it contained significant bugfixes, or if it had only CS3 support
and not a DIB Engine,
or vice versa.
- Dan


From julliard at winehq.org  Mon May  5 08:54:22 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 05 May 2008 15:54:22 +0200
Subject: Time-based releases idea
In-Reply-To: <a71bd89a0805050559s4074f6d0j39994af86ccf82c2@mail.gmail.com>
	(Dan Kegel's message of "Mon, 5 May 2008 05:59:10 -0700")
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
	<481EEBB4.4000104@open-vote.org> <87lk2pdk5h.fsf@wine.dyndns.org>
	<a71bd89a0805050559s4074f6d0j39994af86ccf82c2@mail.gmail.com>
Message-ID: <87hcdceu0h.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> That wasn't the distro; that was an upstream kernel vulnerability fix
> announced in February,
> http://kerneltrap.org/Linux/Patching_CVE-2008-0600_Local_Root_Exploit

It's the distro that changed the mmap config, not the kernel. I'm not
sure I understand their reasoning, apparently this was an attempt to
work around the vulnerability without fixing the kernel. My point is
that if they cared about Wine they would have taken into account the
fact that it got broken, and hopefully found a different way of
addressing the issue.

>> we are better off releasing after a major distro release so
>> that we have a chance to find and fix the latest breakages first.
>
> If we want to catch breakages like the recent one early, we shouldn't
> wait for the distros; we should run Wine with each new release of
> the Linux kernel.

That doesn't help. Of all the breakages we've had over the years very
few were caused by the kernel; most were caused by distros shipping
unstable and untested packages, or broken default configs.

>>  It's still very much a feature-based model, only of course the desirable
>>  features have been shifting as Microsoft shipped new stuff and people
>>  wanted to run new apps before we supported the old ones properly...
>
> You assert Wine's releases will be feature-based, but
> I don't understand your reasoning yet.

Making a stable release is a lot of work, particularly since given the
nature of Wine it's very hard to test it properly and make sure we are
not breaking things. We don't want to go through the process unless we
have some significant features to release, and significant features
can't be developed on a fixed time frame.

For instance, one feature we'd want in 1.2 is the DIB engine; nobody can
guarantee that it will be ready, tested, and debugged properly by
September. I'd much prefer to ship 1.2 with a working DIB engine say in
December, than with a broken one in September.

-- 
Alexandre Julliard
julliard at winehq.org


From msclrhd at googlemail.com  Mon May  5 05:18:32 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Mon, 5 May 2008 11:18:32 +0100
Subject: Time-based releases idea
In-Reply-To: <200805051002.51178.kai.blin@gmail.com>
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
	<200805051002.51178.kai.blin@gmail.com>
Message-ID: <3f4fd2640805050318i72ae1ef1g50ea8df773afb9d9@mail.gmail.com>

2008/5/5 Kai Blin <kai.blin at gmail.com>:
> On Monday 05 May 2008 05:13:16 Dan Kegel wrote:
>  > I just wrote up an idea related to release management for post-1.0
>  > wine releases.  It's online at
>  >   http://wiki.winehq.org/TimeBasedReleases
>  > Essentially, the idea is to release in March and September,
>  > in time for the April and October releases of Ubuntu.
>  >
>  > For instance, following this strategy, we might plan to release
>  > wine-1.2.0 in September 2008 or March 2009.
>
>  I'm against September, as it means we'll go into code freeze _again_ just
>  before Summer of Code finishes.

It might be better to align with SoC, so that we have a release when
SoC is finished (with time to properly absorb the changes) and another
before it starts, both roughly 6 months apart. This would then make it
easier for SoC participants not being in the middle of a code freeze.

>  While I agree that bi-annual releases sound like a good thing, I'm opposed to
>  forcing it just to make Ubuntu's 8.10 schedule with 1.2.

I agree. If the Wine release schedule slips because of critical bugs,
or it is taking longer to apply a really cool SoC feature, then having
releases out-of-sync would increase the chance of getting that release
into Ubuntu. It also removes implied pressure that we have to release
on the specified dates. While the releases should not slip like Xorg
appears to be doing, likewise it should not ship if a critical app
does not work.

>  Also, I'm not really sure what this'll mean in terms of features and bug
>  fixes. We certainly don't want to keep people hanging without fixes for bugs
>  for half a year.
>
>  We also don't want to slow down development more than needed.
>
>  Now, as you state on the wiki page, a bi-weekly release schedule is good for
>  early adopters and developers, as it's centered on "Get my new cool feature
>  in!" rather than on "Will this break Photoshop?". But, and I see you mention
>  that yourself, "Will this break Photoshop?" is a really hard question to
>  answer, especially for developers who don't own photoshop.

I like the bi-weekly releases. These can be seen as bleeding edge test
builds (and later, betas and release candidates). They are
developmental snapshots that allow people to try the bleeding edge
out, where things may break. I highly recommend that we keep these.

>  Bi-annual releases are good for people who already have their apps working, as
>  prior to a release we probably should make sure nothing breaks. But as fixing
>  new bugs sometimes is a bit hit-and-miss, only being able to try for the
>  wider public once every six months isn't too great.

For people who don't have their apps working, who have a bug or bugs
that they are tracking, or who like to stay on the bleeding edge, we
should recommend that they try out the bi-weekly releases and continue
to file bug reports as is done currently.

For people who's app is working, we should recommend that they stick
to a stable release (unless they want to be on the bleeding edge, or
help out with testing).

Now, ideally, people should be moving with the bi-weekly releases to
pick up any regressions and to test bug fixes. Since Wine has fairly
aggressive development with the bi-weekly releases, it may be possible
to do quarterly stable releases.

The issue here is how to manage the stable releases. I would like to
see the aggressive bi-weekly development continue on wine.git. If we
have a wine-stable.git, or wine-1.x.y.git (like the Linux kernel),
that gets merged into with the bi-weekly release when code freeze
occurs, that can be stabilized to release. I don't know of a better
way that would not break either development model.

>  So assuming we manage to get wine test failures down to 0 during this code
>  freeze, I'm happy to make sure none of my patches breaks anything there. If I
>  can get a similar website for the apps we really don't want to regress, I'll
>  of course try the same for that. But before we don't have that, I don't think
>  it's a good idea.

With the tests, it is critical that the failure rate is as low as possible.

I would also add that the wine todo results are factored in here as
well (not for this release, as the window for major changes has
closed). This is because those todo items will show up as bugs in real
applications, or highlight behavioural differences from Windows. This
is assuming that those tests are passing on Windows as well.

I would also argue that any bug must have a corresponding regression
test before being fixed, unless there is a good reason for there not
being one (e.g. it is a bug in winecfg). This way, Wine is less likely
to regress in the future, and the affected app is more likely to
continue to work after the fix.

- Reece


From Andrew.Talbot at talbotville.com  Mon May  5 10:31:40 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Mon, 05 May 2008 16:31:40 +0100
Subject: Vehicle for minor bugs?
Message-ID: <fvn98s$1rt$1@ger.gmane.org>

Hi,

Frequently, I am finding minor bugs that I probably cannot fix myself, that
are probably not suitable for a Bugzilla bug report and that are likely to
be ignored if posted to wine-devel (witness my current postings: "XBOOL,
XBYTE, XINT8, etc." and "Five functions that cannot handle a NULL
parameter", and apologies if you are feverishly working on replies or
patches for either of these ;) ). For an explicit example - from the later
posting - I know that one should be able to call LookupPrivilegeNameW()
with its optional "lpName" parameter given a NULL pointer argument, as
indeed we do ourselves in advapi32/security:line 1760, but we pass this
down, within our rendition of this function, as the first argument to
strcpyW() (on line 1852). This is clearly a bug and it seems not to have
been spotted by Coverity. The patch I sent for this would appear to have
been inadequate, so it would be good if I could flag this bug up on a
janitorial page somewhere, perhaps categorized by dll, so that the advapi32
experts (in this case) could occasionally browse for such things. What do
people think?

Thanks,

-- 
Andy.




From stefan at codeweavers.com  Mon May  5 10:47:24 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 5 May 2008 17:47:24 +0200
Subject: d3d8: Dangling pointers fix
In-Reply-To: <200805051642.51513.andrew.talbot@talbotville.com>
References: <200805051642.51513.andrew.talbot@talbotville.com>
Message-ID: <200805051747.25105.stefan@codeweavers.com>

Am Montag, 5. Mai 2008 17:42:51 schrieb Andrew Talbot:
> I have moved the TRACEs to where I think they belong. Please give feedback
> if this patch is incorrect.
on a quick look it looks OK. Did you check if any output is written in the 
case of failures in those functions?


From Andrew.Talbot at talbotville.com  Mon May  5 11:31:00 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Mon, 05 May 2008 17:31:00 +0100
Subject: d3d8: Dangling pointers fix
References: <200805051642.51513.andrew.talbot@talbotville.com>
	<200805051747.25105.stefan@codeweavers.com>
Message-ID: <fvnco4$e7i$1@ger.gmane.org>

Stefan D?singer wrote:

> Am Montag, 5. Mai 2008 17:42:51 schrieb Andrew Talbot:
>> I have moved the TRACEs to where I think they belong. Please give
>> feedback if this patch is incorrect.
> on a quick look it looks OK. Did you check if any output is written in the
> case of failures in those functions?

Hi Stefan,

I only took a static look at the code for those functions and checked that
each code path that would lose its "TRACE" would still have a "WARN" or
a "FIXME". I just wasn't sure if this was acceptable, or whether we really
do need two debug message for such a case.

-- 
Andy.




From dank at kegel.com  Mon May  5 12:23:05 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 5 May 2008 10:23:05 -0700
Subject: Vehicle for minor bugs?
Message-ID: <a71bd89a0805051023j213b9eescaff44db24e3bdad@mail.gmail.com>

Andrew Talbot wrote:
> Frequently, I am finding minor bugs that I probably cannot fix myself, that
> are probably not suitable for a Bugzilla bug report and that are likely to
> be ignored if posted to wine-devel (witness my current postings: "XBOOL,
> XBYTE, XINT8, etc." and "Five functions that cannot handle a NULL
> parameter",

I haven't seen those posts, where are they?

I'd say a conformance test would be the right vehicle.


From paul.vriens.wine at gmail.com  Mon May  5 13:35:50 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 05 May 2008 20:35:50 +0200
Subject: d3dx8: Dynamically import d3dx8 in the tests so the tests can
	be	skipped if the dll is not found
In-Reply-To: <b130c85e0805051119la57bbf3i369657faa50f52a2@mail.gmail.com>
References: <b130c85e0805051119la57bbf3i369657faa50f52a2@mail.gmail.com>
Message-ID: <481F5386.8080706@gmail.com>

Maarten Lankhorst wrote:
> This is better then downright crashing on the missing dlls.
> 
> This patch was created using grep and sed. :-)
> ---
> 
> 
> ------------------------------------------------------------------------
> 
> 
Hi Maarten,

When do you see a crash? Winetest itself already checks if a dll is present. If 
it's not, the tests are skipped as can be seen on test.winehq.org..

-- 
Cheers,

Paul.


From Andrew.Talbot at talbotville.com  Mon May  5 13:43:39 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Mon, 05 May 2008 19:43:39 +0100
Subject: Vehicle for minor bugs?
References: <a71bd89a0805051023j213b9eescaff44db24e3bdad@mail.gmail.com>
Message-ID: <fvnkgr$dpo$1@ger.gmane.org>

Dan Kegel wrote:

> Andrew Talbot wrote:
>> witness my current
>> postings: "XBOOL, XBYTE, XINT8, etc." and "Five functions that cannot
>> handle a NULL parameter",
> 
> I haven't seen those posts, where are they?

Hi Dan,

I posted them to wine-devel on Saturday.

> I'd say a conformance test would be the right vehicle.

Often this is so. But some bugs may not be revealed by such a test. Also,
sometimes it would be useful to ask an expert what was intended by a bit of
code. For example, consider the following code (from
mshtml/mshtmloption.c), to pick something at random:

static HRESULT WINAPI HTMLOptionElementFactory_create(...)
{
    ...
    HRESULT hres;

    ...

    hres = IHTMLDOMNode_QueryInterface(...);

    '''

    return S_OK;
}

In this function, either "hres" is an unused variable, or the function
should really return "hres" at the end. I have no way of knowing, but I
would like to be able to bring this to the attention of the mshtml guys so
they can make a judgment from their knowledge of what this function is
about.

Thanks,

-- 
Andy.




From couriousous at mandriva.org  Mon May  5 14:43:38 2008
From: couriousous at mandriva.org (Philippe =?iso-8859-1?q?R=E9tornaz?=)
Date: Mon, 5 May 2008 21:43:38 +0200
Subject: [PATCH] Add SIO_KEEPALIVE_VALS support to winsock
In-Reply-To: <3a768c550805041856u7e1a8fean8ff0bbe99a19824a@mail.gmail.com>
References: <200805041450.33421.couriousous@mandriva.org>
	<3a768c550805041856u7e1a8fean8ff0bbe99a19824a@mail.gmail.com>
Message-ID: <200805052143.39083.couriousous@mandriva.org>

Le lundi 05 mai 2008, Juan Lang a ?crit?:
> Patches without your full name are unlikely to get accepted.  Would
> you mind resending with your full name?  Thanks,
> --Juan

Okay, here it is:

When Altium 6 is used with a license server, it need the WSAIoctl() with 
SIO_KEEPALIVE_VALS control code to succeed, otherwise it cannot connect 
to the license server.

The following patch implement the missing parts and allow altium 6 to 
works perfectly with wine.

Philippe R?tornaz

---

Index: dlls/ws2_32/socket.c
===================================================================
--- dlls/ws2_32/socket.c
+++ dlls/ws2_32/socket.c	2008-05-04 13:53:50.000000000 +0200
@@ -2292,6 +2292,48 @@
        WSASetLastError(WSAEOPNOTSUPP);
        return SOCKET_ERROR;
 
+   case WS_SIO_KEEPALIVE_VALS:
+       if(lpvInBuffer) {
+	       int fd;
+	       struct tcp_keepalive  *d = lpvInBuffer;
+	       int idle = d->keepalivetime / 1000;
+	       int interv = d->keepaliveinterval / 1000;
+	       int enable = d->onoff ? 1: 0;
+	       TRACE("socket %04lx, keepalivetime: %d, keepaliveinterval: %d\n", s, idle, interv);
+	       if(idle == 0 || interv == 0) {
+		       WSASetLastError(WSAEINVAL);
+		       return SOCKET_ERROR;
+	       }
+	       fd = get_sock_fd( s, 0, NULL );
+	       if(setsockopt(fd, SOL_SOCKET, SO_KEEPALIVE, (void *) &enable, sizeof(int)) == -1) {
+		       release_sock_fd( s, fd );
+		       WSASetLastError(WSAEINVAL);
+		       return SOCKET_ERROR;
+	       }
+#if (defined TCP_KEEPIDLE) && (defined TCP_KEEPINTVL)
+	       if(setsockopt(fd, IPPROTO_TCP, TCP_KEEPIDLE, (void *) &idle, sizeof(int)) == -1) {
+		       release_sock_fd( s, fd );
+		       WSASetLastError(WSAEINVAL);
+		       return SOCKET_ERROR;
+	       }
+
+	       if(setsockopt(fd, IPPROTO_TCP, TCP_KEEPINTVL, (void *) &interv, sizeof(int)) == -1) {
+		       release_sock_fd( s, fd );
+		       WSASetLastError(WSAEINVAL);
+		       return SOCKET_ERROR;
+	       }
+#else
+	       FIXME("Ignoreing keepalive interval and timeout");
+#endif
+	       release_sock_fd( s, fd );
+	       break;
+       } else {
+	       WSASetLastError(WSAEINVAL);
+               return SOCKET_ERROR;
+       }
+
+       break;
+
    default:
        FIXME("unsupported WS_IOCTL cmd (%08x)\n", dwIoControlCode);
        WSASetLastError(WSAEOPNOTSUPP);
Index: include/winsock2.h
===================================================================
--- include/winsock2.h
+++ include/winsock2.h	2008-05-03 22:45:08.000000000 +0200
@@ -142,6 +142,7 @@
 #define WS_SIO_ADDRESS_LIST_CHANGE            _WSAIO(WS_IOC_WS2,23)
 #define WS_SIO_QUERY_TARGET_PNP_HANDLE        _WSAIOR(WS_IOC_WS2,24)
 #define WS_SIO_GET_INTERFACE_LIST             WS__IOR('t', 127, WS_u_long)
+#define WS_SIO_KEEPALIVE_VALS 		      _WSAIOW(WS_IOC_VENDOR,4) 
 #else /* USE_WS_PREFIX */
 #undef IOC_VOID
 #undef IOC_IN
@@ -178,8 +179,16 @@
 #define SIO_ADDRESS_LIST_CHANGE    _WSAIO(IOC_WS2,23)
 #define SIO_QUERY_TARGET_PNP_HANDLE _WSAIOR(IOC_WS2,24)
 #define SIO_GET_INTERFACE_LIST     _IOR ('t', 127, u_long)
+#define SIO_KEEPALIVE_VALS 	   _WSAIOW(IOC_VENDOR,4) 
 #endif /* USE_WS_PREFIX */
 
+/* Argument structure for SIO_KEEPALIVE_VALS */
+struct tcp_keepalive {
+	u_long  onoff;
+	u_long  keepalivetime;
+	u_long  keepaliveinterval;
+};
+
 /* Constants for WSAIoctl() */
 #define WSA_FLAG_OVERLAPPED        0x01
 #define WSA_FLAG_MULTIPOINT_C_ROOT 0x02


From a_villacis at palosanto.com  Mon May  5 14:46:37 2008
From: a_villacis at palosanto.com (=?ISO-8859-1?Q?Alex_Villac=ED=ADs_Lasso?=)
Date: Mon, 05 May 2008 14:46:37 -0500
Subject: quartz: regression: Assertion failed at pin.c:1236
Message-ID: <481F641D.6020505@palosanto.com>

The patch:

3066116f76c0c44950fde3552485b37dce24d1f8
quartz: Clean up pullpin code.

causes a regression in a test application I have. I see the following 
message in the console:

pin.c:1236: PullPin_Init: La declaraci?n `pCustomRequest' no se cumple.

And I get an "Automation error" in a message box. This, every time I try 
to load an AVI file in a Windows Media Control. Reversing the patch gets 
rid of the error.

I believe this patch was to be followed by a cleanup of code to ensure 
that no users of PullPin_Init pass a NULL pCustomRequest. However, this 
parameter gets passed as NULL from parser.c:92, which in turn gets it 
from avisplit.c, mpegsplit.c and waveparser.c, all of them with NULL as 
the value for the parameter.

Was there supposed to be any follow-up patch for this? Why was it not 
committed?


-- 
perl -e '$x=2.4;print sprintf("%.0f + %.0f = %.0f\n",$x,$x,$x+$x);'



From m.b.lankhorst at gmail.com  Mon May  5 15:00:04 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 5 May 2008 13:00:04 -0700
Subject: d3dx8: Dynamically import d3dx8 in the tests so the tests can be
	skipped if the dll is not found
In-Reply-To: <481F5386.8080706@gmail.com>
References: <b130c85e0805051119la57bbf3i369657faa50f52a2@mail.gmail.com>
	<481F5386.8080706@gmail.com>
Message-ID: <b130c85e0805051300v6583efb3k829936d8ce5fcd6d@mail.gmail.com>

Hello Paul,

2008/5/5 Paul Vriens <paul.vriens.wine at gmail.com>:
> Maarten Lankhorst wrote:
>
> >
> > This is better then downright crashing on the missing dlls.
> >
> > This patch was created using grep and sed. :-)
> > ---
> >
> >
> > ------------------------------------------------------------------------
> >
> >
> >
>  Hi Maarten,
>
>  When do you see a crash? Winetest itself already checks if a dll is
> present. If it's not, the tests are skipped as can be seen on
> test.winehq.org..
It was crashing when I ran the test directly. But if that behavior is
ok I'll just modify my script that runs the test.

Cheers,
Maarten.


From zgs at seas.upenn.edu  Mon May  5 16:47:28 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Mon, 5 May 2008 17:47:28 -0400
Subject: Time-based releases idea
In-Reply-To: <3f4fd2640805050318i72ae1ef1g50ea8df773afb9d9@mail.gmail.com>
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
	<200805051002.51178.kai.blin@gmail.com>
	<3f4fd2640805050318i72ae1ef1g50ea8df773afb9d9@mail.gmail.com>
Message-ID: <b050a5e70805051447k319f5ef6n4e056468956791c1@mail.gmail.com>

I think that a missing factor in making this decision is the shape of
an automatic test suite.  Its been mentioned a dozen times and has the
potential to tip the scales in favor of the time-based releases
(making QA easier -> shorter freezes).  In the event that we are able
to maintain QA (by test suite or other) then +1 for time based
releases.  Its very convenient for users to know when releases will be
and makes following software much easier as a whole.

For those who don't mind the cutting edge though, I don't see a
problem with still keeping minor revisions every other week with major
revisions every 6 months, e.g: 1.x.y, incrementing y every 2 weeks
incrementing x every 6 months

-Zach


From fgouget at free.fr  Mon May  5 16:58:15 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 5 May 2008 23:58:15 +0200 (CEST)
Subject: d3dx8: Dynamically import d3dx8 in the tests so the tests can
	be skipped if the dll is not found
In-Reply-To: <b130c85e0805051300v6583efb3k829936d8ce5fcd6d@mail.gmail.com>
References: <b130c85e0805051119la57bbf3i369657faa50f52a2@mail.gmail.com>
	<481F5386.8080706@gmail.com>
	<b130c85e0805051300v6583efb3k829936d8ce5fcd6d@mail.gmail.com>
Message-ID: <alpine.DEB.1.10.0805052356310.635@amboise.dolphin>

On Mon, 5 May 2008, Maarten Lankhorst wrote:
[...]
> >  When do you see a crash? Winetest itself already checks if a dll is
> > present. If it's not, the tests are skipped as can be seen on
> > test.winehq.org..
> It was crashing when I ran the test directly. But if that behavior is
> ok I'll just modify my script that runs the test.

It's ok for the test to not run when the dll is missing. Some time 
ago (a few months?) there was a great cleanup to not load the dll to be 
tested dynamically in such cases...


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
            Before you criticize someone, walk a mile in his shoes.
       That way, if he gets angry, he'll be a mile away - and barefoot.


From m.b.lankhorst at gmail.com  Mon May  5 17:15:24 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 5 May 2008 15:15:24 -0700
Subject: quartz: regression: Assertion failed at pin.c:1236
In-Reply-To: <481F641D.6020505@palosanto.com>
References: <481F641D.6020505@palosanto.com>
Message-ID: <b130c85e0805051515r15c7a1ael2ce62e20aed9f23@mail.gmail.com>

Hello Alex,

2008/5/5 Alex Villac??s Lasso <a_villacis at palosanto.com>:
> The patch:
>
>  3066116f76c0c44950fde3552485b37dce24d1f8
>  quartz: Clean up pullpin code.
>
>  causes a regression in a test application I have. I see the following
>  message in the console:
>
>  pin.c:1236: PullPin_Init: La declaraci?n `pCustomRequest' no se cumple.
>
>  And I get an "Automation error" in a message box. This, every time I try
>  to load an AVI file in a Windows Media Control. Reversing the patch gets
>  rid of the error.
>
>  I believe this patch was to be followed by a cleanup of code to ensure
>  that no users of PullPin_Init pass a NULL pCustomRequest. However, this
>  parameter gets passed as NULL from parser.c:92, which in turn gets it
>  from avisplit.c, mpegsplit.c and waveparser.c, all of them with NULL as
>  the value for the parameter.
>
>  Was there supposed to be any follow-up patch for this? Why was it not
>  committed?
The followup patch is the avi splitter patch. It was rejected because
of the code freeze. Instead I asked AJ to revert the patch. Current
head should no longer have it.

Cheers,
Maarten.


From leslie_alistair at hotmail.com  Mon May  5 17:19:27 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Tue, 6 May 2008 08:19:27 +1000
Subject: Jacek Caban : mshtml: Added IMG element tests.
References: <E1Jszaj-0008Vx-SO@wine.codeweavers.com>
Message-ID: <fvo16r$s4m$1@ger.gmane.org>


"Alexandre Julliard" <julliard at winehq.org> wrote in message 
news:E1Jszaj-0008Vx-SO at wine.codeweavers.com...
> Module: wine
> Branch: master
> Commit: 29d8c366bb278a6b73c3669817063087d7cd080d
> URL: 
> http://source.winehq.org/git/wine.git/?a=commit;h=29d8c366bb278a6b73c3669817063087d7cd080d
>
> Author: Jacek Caban <jacek at codeweavers.com>
> Date:   Sun May  4 19:22:46 2008 +0200
>
> mshtml: Added IMG element tests.
>
> ---
>
> dlls/mshtml/tests/dom.c |   19 +++++++++++++++++--
> 1 files changed, 17 insertions(+), 2 deletions(-)
>
> diff --git a/dlls/mshtml/tests/dom.c b/dlls/mshtml/tests/dom.c
> index 1039ab5..a3d0701 100644
> --- a/dlls/mshtml/tests/dom.c
> +++ b/dlls/mshtml/tests/dom.c
> @@ -48,6 +48,7 @@ static const char elem_test_str[] =
>     "<table><tbody></tbody></table>"
>     "<script id=\"sc\" type=\"text/javascript\"></script>"
>     "<test />"
> +    "<img /"
                  ^^^
     Is this mssing a ending >

Best Regards
 Alistair Leslie-Hughes




From m.b.lankhorst at gmail.com  Mon May  5 17:22:07 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 5 May 2008 15:22:07 -0700
Subject: Time-based releases idea
In-Reply-To: <b050a5e70805051447k319f5ef6n4e056468956791c1@mail.gmail.com>
References: <a71bd89a0805042013u25964427nc7c1630a78964d27@mail.gmail.com>
	<200805051002.51178.kai.blin@gmail.com>
	<3f4fd2640805050318i72ae1ef1g50ea8df773afb9d9@mail.gmail.com>
	<b050a5e70805051447k319f5ef6n4e056468956791c1@mail.gmail.com>
Message-ID: <b130c85e0805051522q7f0a87a7rf766538d586c8cd4@mail.gmail.com>

Hello Zachary,

2008/5/5 Zachary Goldberg <zgs at seas.upenn.edu>:
> I think that a missing factor in making this decision is the shape of
>  an automatic test suite.  Its been mentioned a dozen times and has the
>  potential to tip the scales in favor of the time-based releases
>  (making QA easier -> shorter freezes).  In the event that we are able
>  to maintain QA (by test suite or other) then +1 for time based
>  releases.  Its very convenient for users to know when releases will be
>  and makes following software much easier as a whole.
>
>  For those who don't mind the cutting edge though, I don't see a
>  problem with still keeping minor revisions every other week with major
>  revisions every 6 months, e.g: 1.x.y, incrementing y every 2 weeks
>  incrementing x every 6 months
I've been playing with automated tests, building tests on wine then
running them on windows through cygwin+ interactive sshd service. But
it seems to be flaky at best. A lot of tests still crash right now if
I run them on my machine xp which sucks and shouldn't happen at all.
Main culprits are the rpcrt4 and the crypt tests, but there might be
others too (d3d9 does at the moment, might be a driver bug).

Cheers,
Maarten.


From jacek at codeweavers.com  Mon May  5 17:31:54 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Tue, 06 May 2008 00:31:54 +0200
Subject: Jacek Caban : mshtml: Added IMG element tests.
In-Reply-To: <fvo16r$s4m$1@ger.gmane.org>
References: <E1Jszaj-0008Vx-SO@wine.codeweavers.com>
	<fvo16r$s4m$1@ger.gmane.org>
Message-ID: <481F8ADA.10702@codeweavers.com>

Alistair Leslie-Hughes wrote:
> "Alexandre Julliard" <julliard at winehq.org> wrote in message 
> news:E1Jszaj-0008Vx-SO at wine.codeweavers.com...
>   
>> Module: wine
>> Branch: master
>> Commit: 29d8c366bb278a6b73c3669817063087d7cd080d
>> URL: 
>> http://source.winehq.org/git/wine.git/?a=commit;h=29d8c366bb278a6b73c3669817063087d7cd080d
>>
>> Author: Jacek Caban <jacek at codeweavers.com>
>> Date:   Sun May  4 19:22:46 2008 +0200
>>
>> mshtml: Added IMG element tests.
>>
>> ---
>>
>> dlls/mshtml/tests/dom.c |   19 +++++++++++++++++--
>> 1 files changed, 17 insertions(+), 2 deletions(-)
>>
>> diff --git a/dlls/mshtml/tests/dom.c b/dlls/mshtml/tests/dom.c
>> index 1039ab5..a3d0701 100644
>> --- a/dlls/mshtml/tests/dom.c
>> +++ b/dlls/mshtml/tests/dom.c
>> @@ -48,6 +48,7 @@ static const char elem_test_str[] =
>>     "<table><tbody></tbody></table>"
>>     "<script id=\"sc\" type=\"text/javascript\"></script>"
>>     "<test />"
>> +    "<img /"
>>     
>                   ^^^
>      Is this mssing a ending >
>   

Yes, it is, that's my mistake, but as long as tests work both on Wine 
and Windows, that's fine. We know that parsing wrong HTML is compatible.

Thanks,
    Jacek


From jacek at codeweavers.com  Mon May  5 17:47:49 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Tue, 06 May 2008 00:47:49 +0200
Subject: Vehicle for minor bugs?
In-Reply-To: <fvnkgr$dpo$1@ger.gmane.org>
References: <a71bd89a0805051023j213b9eescaff44db24e3bdad@mail.gmail.com>
	<fvnkgr$dpo$1@ger.gmane.org>
Message-ID: <481F8E95.4070103@codeweavers.com>

Hi Andrew,

Andrew Talbot wrote:
> Often this is so. But some bugs may not be revealed by such a test. Also,
> sometimes it would be useful to ask an expert what was intended by a bit of
> code. For example, consider the following code (from
> mshtml/mshtmloption.c), to pick something at random:
>
> static HRESULT WINAPI HTMLOptionElementFactory_create(...)
> {
>     ...
>     HRESULT hres;
>
>     ...
>
>     hres = IHTMLDOMNode_QueryInterface(...);
>
>     '''
>
>     return S_OK;
> }
>
> In this function, either "hres" is an unused variable, or the function
> should really return "hres" at the end. I have no way of knowing, but I
> would like to be able to bring this to the attention of the mshtml guys so
> they can make a judgment from their knowledge of what this function is
> about.
>   

IHTMLDOMNode_QueryInterface should never fail here. If it fails, there is something seriously wrong going on. But, anyway, to handle the failure correctly, we could add check hres after releasing nselem like:

if(FAILED(hres))
    return hres;


Jacek



From alexd4 at inbox.lv  Mon May  5 18:12:33 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Tue, 06 May 2008 02:12:33 +0300
Subject: bugzilla rights request
Message-ID: <481F9461.1000206@inbox.lv>

Hi.

I would like to have rights to change bug status. I fix some bugs myself and 
also occasionally do some bug-triaging, so it would be handy. Thanks.


From dank at kegel.com  Mon May  5 19:45:57 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 5 May 2008 17:45:57 -0700
Subject: draft Call for Testing
Message-ID: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>

So, what should we be asking wine users to be
doing once rc1 is out?  How about this:

--- snip ---
Calling all wine users!
Today, after 15 years of development, the first release
candidate for wine-1.0.0 was released.
Wine has been under heavy development in recent
months, and some applications that used to work well
no longer do.  But we don't know which ones!  Please
help us find them, so we can fix them.  Here's how:

0. Make sure your machine runs glxgears properly
(if it crashes, you may need to update your graphics drivers)

1. Install wine-1.0.0-rc1 (you can download it from
http://www.winehq.org/site/download ).
Make sure wine's notepad starts up ok and says
"wine 1.0.0 rc1" when you do Help / About Wine.

2. Visit the Wine application database at
http://appdb.winehq.org/browse_by_rating.php?sRating=Platinum
and pick out a few applications that supposedly work perfectly under Wine
but do not yet have any test reports with wine-1.0.0-rc1 or later.

3. Try installing and running those apps, one at a time.
Before installing each app, delete your .wine directory; that way
you get a clean run, uncontaminated by the previous app's settings.

4. For each app you test, add a test report into Wine's AppDB.

As a token of our thanks, we will pick one of the users who submits
a healthy set of useful test results  and send him or her a tasteful
Wine-themed goodie of some sort.

So fire up your keyboards and start testing!
Thanks, and good hunting!
--- snip ---

(Not sure how the goodie would be handled, but I'm willing to cover the
expenses myself, especially if I get to pick the winner :-)

How's that sound?


From ovek at arcticnet.no  Mon May  5 20:09:08 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Tue, 06 May 2008 03:09:08 +0200
Subject: Bug#479659: RFH: wine -- Windows API implementation
Message-ID: <20080506010908.8454.66959.reportbug@localhost>

Package: wnpp
Severity: normal

Since my time may be limited in the future, I am seeking comaintainers
for the Wine package in Debian, at least to ensure that new Wine releases
may continue to be uploaded in a timely fashion, and to keep the package's
bug count down. (And given that pretty much half the open bugs are "missing
manpage" bugs, documentation writers would also help...)

I have created a project for this on alioth.debian.org. I've loaded the
current packaging (all versions since etch) into a Git repository there, and
put up some instructions on http://pkg-wine.alioth.debian.org/

-- System Information:
Debian Release: lenny/sid
  APT prefers testing
  APT policy: (650, 'testing'), (600, 'unstable')
Architecture: i386 (i686)

Kernel: Linux 2.6.24-1-686 (SMP w/1 CPU core)
Locale: LANG=en_US.ISO-8859-1, LC_CTYPE=en_US.ISO-8859-1 (charmap=ISO-8859-1)
Shell: /bin/sh linked to /bin/bash






From winehacker at gmail.com  Mon May  5 20:41:48 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 5 May 2008 21:41:48 -0400
Subject: draft Call for Testing
In-Reply-To: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>
References: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>
Message-ID: <19e31a080805051841v1d5c03das2e7a424d60d1bb15@mail.gmail.com>

On Mon, May 5, 2008 at 8:45 PM, Dan Kegel <dank at kegel.com> wrote:
>  As a token of our thanks, we will pick one of the users who submits
>  a healthy set of useful test results  and send him or her a tasteful
>  Wine-themed goodie of some sort.

Maybe we should all pitch in or tap the Wine party fund and give out a
bunch of t-shirts to people that step up to confirm and triage new and
exiting bug reports also. Assuming a t-shirt is good motivation, maybe
a CD with 1.0 on it Autographed by Alexandre and a custom Wine bottle
for someone that goes above and beyond. I'd be willing to pitch in to
have a custom bottle/labled shipped.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From selliott4 at austin.rr.com  Mon May  5 22:20:15 2008
From: selliott4 at austin.rr.com (Steven Elliott)
Date: Mon, 05 May 2008 22:20:15 -0500
Subject: wineserver socket file and DOS attacks
In-Reply-To: <20080505071144.GA22931@galeere>
References: <1209565413.6570.27.camel@grey>
	<alpine.DEB.1.10.0805050843450.10891@amboise.dolphin>
	<20080505071144.GA22931@galeere>
Message-ID: <1210044015.22050.12.camel@grey>

On Mon, 2008-05-05 at 09:11 +0200, Marcus Meissner wrote:
> On Mon, May 05, 2008 at 08:47:52AM +0200, Francois Gouget wrote:
> > 
> > In /tmp I see the following:
> > 
> >    .X0-lock
> >    .X11-unix/
> >    fgouget/
> >    gconfd-fgouget/
> >    vmware-fgouget/
> >    xmms_fgouget.0
> > 
> > So it seems like if there is a malicious user Wine will not be the only 
> > application that will be affected. So the question is: are all these 
> > apps susceptible to DoS or do they avoid DoS somehow? And if they 
> > prevent DoS, how and is that technique applicable to Wine?
> 
> For gconfd-* gconfd2 creates secondary directories if one is present
> (and checks if its there).
> 
> .X11-unix/ is on suse created during install at least, so no problem.
> 
> No idea about the others.

Good question about other socket files.  I wasn't able to get gconfd to
create secondary files, so creating /tmp/gconfd-<user name> as another
user broke gconf-editor for me.

The .X* files should not be a problem if the X server is started when
the system boots.  But if the system boots up in text mode it's possible
to stop the X server from being started manually (startx) by creating
those directories and by putting bad files in them.

-- 
-----------------------------------------------------------------------
|          Steven Elliott          |      selliott4 at austin.rr.com     |
-----------------------------------------------------------------------




From selliott4 at austin.rr.com  Mon May  5 23:28:19 2008
From: selliott4 at austin.rr.com (Steven Elliott)
Date: Mon, 05 May 2008 23:28:19 -0500
Subject: wineserver socket file and DOS attacks
In-Reply-To: <87prs1dpj1.fsf@wine.dyndns.org>
References: <1209565413.6570.27.camel@grey>
	<b130c85e0804301145n3bcafd70l6dde5e21e0409b13@mail.gmail.com>
	<4818C3B5.9000008@arcticnet.no>
	<b130c85e0804301745v7f2657bcv906f7b297d37260c@mail.gmail.com>
	<48194AFA.9070604@arcticnet.no> <1209855834.7650.40.camel@grey>
	<87prs1dpj1.fsf@wine.dyndns.org>
Message-ID: <1210048099.22050.41.camel@grey>

On Mon, 2008-05-05 at 12:16 +0200, Alexandre Julliard wrote:
> Steven Elliott <selliott4 at austin.rr.com> writes:
> 
> > Maybe I'm making some bad assumptions about why the socket file can't be
> > placed in ~/.wine (that not all users have a writable home directory).
> > I'm guessing based on the snippet from my original post that includes
> > "Since that might not be possible" in reference to placing the socket
> > file under ~/.wine.
> 
> No, the real problem with putting it under the home directory is that
> many setups have the home directory on a networked file system, but the
> socket needs to be local to the machine.

Do you happen to know in what cases there are issues with socket files
and NFS directories?  With a small test program I wrote I was able to
work with a socket file on an NFS drive with both Fedora 8 and Red Hat
AS 4:
    http://selliott.org/c/socket-file.cpp
The test program just creates a socket file and listens on it in one
instance and then connects to it in another.

Maybe this works differently on non-Linux systems.

Since my assumption was wrong about home directories being read-only
then I'm curious if having a read-only WINEPREFIX directory is something
that Wine supports assuming the WINEPREFIX directory is setup initially.
As I mentioned in one of my other emails having a setup read-only
WINEPREFIX directory pretty much works other than wineserver complaining
that it can't write to the *.reg files when it exits.

If having a writeable WINEPREFIX directory is a reasonable requirement
then that suggests a solution that allows the socket file to be in /tmp
and not vulnerable to DoS attacks - something like mkdtemp() could first
securely create a unique directory in /tmp for the socket file and the
location could be stored somewhere in WINEPREFIX.  The location could be
protected with a lock file in WINEPREFIX, so I think that would be
pretty solid race condition and DoS wise.

> I don't think the DoS is a big issue, but if it is for you it's pretty
> easy to have a script create the directories for all users at boot time.

It may not be a big issue.  As Francois Gouget pointed out there seems
to be other applications with similar socket files.  So if you aren't
concerned about this I understand.  I imagine the upcoming 1.0 release
has given you plenty of things to think about.

That is a good suggestion about creating the directories on boot.
Although it's tricky to do that when the users aren't local (NIS, or
whatever) it's a good suggestion for most people.

-- 
-----------------------------------------------------------------------
|          Steven Elliott          |      selliott4 at austin.rr.com     |
-----------------------------------------------------------------------




From dank at kegel.com  Mon May  5 23:40:04 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 5 May 2008 21:40:04 -0700
Subject: draft Call for Testing
In-Reply-To: <19e31a080805051841v1d5c03das2e7a424d60d1bb15@mail.gmail.com>
References: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>
	<19e31a080805051841v1d5c03das2e7a424d60d1bb15@mail.gmail.com>
Message-ID: <a71bd89a0805052140t195eb628y606a79b9adf9d23f@mail.gmail.com>

On Mon, May 5, 2008 at 6:41 PM, Steven Edwards <winehacker at gmail.com> wrote:
> On Mon, May 5, 2008 at 8:45 PM, Dan Kegel <dank at kegel.com> wrote:
>  >  As a token of our thanks, we will pick one of the users who submits
>  >  a healthy set of useful test results  and send him or her a tasteful
>  >  Wine-themed goodie of some sort.
>
>  Maybe we should all pitch in or tap the Wine party fund and give out a
>  bunch of t-shirts to people that step up to confirm and triage new and
>  exiting bug reports also. Assuming a t-shirt is good motivation, maybe

Yeah, t-shirts sound right.  I think Maarten was going to try whipping
something together out of the drunken penguin artwork.

Maybe we should give out two per release candidate, or something.

>  a CD with 1.0 on it Autographed by Alexandre and a custom Wine bottle
>  for someone that goes above and beyond. I'd be willing to pitch in to
>  have a custom bottle/labled shipped.

No need, I think T-shirts would do nicely.  But we can always change our
mind after the fact...
- Dan


From austinenglish at gmail.com  Mon May  5 23:55:01 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 5 May 2008 23:55:01 -0500
Subject: Bison 2.1 / Solaris
Message-ID: <b6bb06270805052155v581a5340j48f8831749490950@mail.gmail.com>

Howdy,

Tried compiling wine on Nexenta (Opensolaris kernel with GNU
userland). Trying to test out the conformance test, but can't get it
to compile:

make[2]: Entering directory `/export/home/austin/wine/libs/wpp'
gcc -c -I. -I. -I../../include -I../../include    -Wall -pipe
-fno-strict-aliasing -Wdeclaration-after-statement -Wwrite-strings
-Wpointer-arith  -g -O2  -o preproc.o preproc.c
gcc -c -I. -I. -I../../include -I../../include    -Wall -pipe
-fno-strict-aliasing -Wdeclaration-after-statement -Wwrite-strings
-Wpointer-arith  -g -O2  -o wpp.o wpp.c
bison  -p ppy_ -o ppy.tab.c -d ppy.y
make[2]: *** [ppy.tab.h] Broken Pipe
make[2]: Leaving directory `/export/home/austin/wine/libs/wpp'
make[1]: *** [wpp] Error 2
make[1]: Leaving directory `/export/home/austin/wine/libs'
make: *** [libs] Error 2

austin at nexenta:~/wine$ bison --version
bison (GNU Bison) 2.1

Looking at my feisty box, looks like it's using 2.3. Anyone had
similar troubles getting wine to compile in 2.1? Google's not turning
up much, aside from saying get it precompiled...

-Austin


From patrol at sinus.cz  Tue May  6 00:31:18 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Tue, 6 May 2008 07:31:18 +0200
Subject: Serial port support in wine-1.0: What to do to make it working ?
Message-ID: <20080506053118.GA10501@tangens.sinus.cz>

Hi!
  I have really BIG problems running any application, which needs to comm over
a serial port:
  - My ham TCVR
  - My GPS
  - My multimeter
  - A lot of my mobiles
  - A lot of devices used in my work (special telco equipment, comms varying
    from simple AT-style commands up to complex proprietary binary protocols).
  In all the cases there are very similar problems - either the program doesn't
detect the device properly, or the device doesn't respond, or in some cases
the device does, what the program wants, but it then can't read it back.
  It looks that some archaic wine versions are better, for example I have to
use wine-0.9.40 to communicate with a device in my work (simple text-based
command-reply communication), any wine newer than say 0.9.50 doesn't work, the
communication times out.
  Because I'm a telco engineer and serial comm is my daily work, and there are
only windows versions of many tools I have to use, proper and mature serial
port support is essential for me.
  So, what can I do to help fixing these problems ? Should I open a bug for
every such a program ? Or just open one bug and state all the programs there ?
I think that bugzilla contains a lot of bugs related to serial port; is it
good to add a new ones ? 
  I'm afraid I can't bisect a problem between 0.9.40 and current wine, but I
can make a serial trace for both of them and look at the difference. Would it
help to find at least this one particular problem ? Or what more can I do
to make the serial port working ? I can code in C in the Linux environment, but
I know NOTHING about windows...
  With regards, Pavel Troller


From wine-devel at kievinfo.com  Tue May  6 01:24:41 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 06 May 2008 00:24:41 -0600
Subject: Serial port support in wine-1.0: What to do to make it working ?
In-Reply-To: <20080506053118.GA10501@tangens.sinus.cz>
References: <20080506053118.GA10501@tangens.sinus.cz>
Message-ID: <481FF9A9.10405@kievinfo.com>

Pavel Troller wrote:
>   So, what can I do to help fixing these problems ? Should I open a bug for
To solve most/all problems related to hardware one needs to have such 
hardware. It's nearly impossible to "simulate" the behavior while reading logs.

> every such a program ? Or just open one bug and state all the programs there ?
> I think that bugzilla contains a lot of bugs related to serial port; is it
> good to add a new ones ? 
No, creating duplicates never helps. You are correct there are already 
pliantly of bugs for serial communications.

>   I'm afraid I can't bisect a problem between 0.9.40 and current wine, but I
> can make a serial trace for both of them and look at the difference. Would it
> help to find at least this one particular problem ? Or what more can I do
> to make the serial port working ? I can code in C in the Linux environment, but

There are few bugs identified and are set as target for 1.0.0. You can look 
at those bugs. Few even list the commit that caused the regression. While 
those patches should have been no-ops.

So what you can do is to figure out what really changed and what part of the 
change broke the serial port functionality (in relation to each bug/patch). 
For this part you will need your hardware. Hopefully this will be enough to 
come up with a fix.

Vitaliy.


From jmayer at loplof.de  Tue May  6 01:40:03 2008
From: jmayer at loplof.de (Joerg Mayer)
Date: Tue, 6 May 2008 08:40:03 +0200
Subject: draft Call for Testing
In-Reply-To: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>
References: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>
Message-ID: <20080506064003.GZ21499@thot.informatik.uni-kl.de>

On Mon, May 05, 2008 at 05:45:57PM -0700, Dan Kegel wrote:
> 0. Make sure your machine runs glxgears properly
> (if it crashes, you may need to update your graphics drivers)

Why would I need working glxgears? Wine works fine for my every day work
and I haven't had working 3D acceleration for the past few months.

 Ciao
     Joerg
-- 
Joerg Mayer                                           <jmayer at loplof.de>
We are stuck with technology when what we really want is just stuff that
works. Some say that should read Microsoft instead of technology.


From austinenglish at gmail.com  Tue May  6 01:42:32 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 6 May 2008 01:42:32 -0500
Subject: draft Call for Testing
In-Reply-To: <20080506064003.GZ21499@thot.informatik.uni-kl.de>
References: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>
	<20080506064003.GZ21499@thot.informatik.uni-kl.de>
Message-ID: <b6bb06270805052342h4d2ab319o526153fc13cedab5@mail.gmail.com>

On Tue, May 6, 2008 at 1:40 AM, Joerg Mayer <jmayer at loplof.de> wrote:
> On Mon, May 05, 2008 at 05:45:57PM -0700, Dan Kegel wrote:
>  > 0. Make sure your machine runs glxgears properly
>  > (if it crashes, you may need to update your graphics drivers)
>
>  Why would I need working glxgears? Wine works fine for my every day work
>  and I haven't had working 3D acceleration for the past few months.

I think Dan is assuming (and is probably right) that many of the
tested apps will be games, which, without working glxgears will have
incorrect test data submitted.

Does the AppDB have any support for listing video hardware/drivers?
That would probably be pretty useful...


From truiken at gmail.com  Tue May  6 01:43:51 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 6 May 2008 01:43:51 -0500
Subject: netapi32: Fix test crash occuring when NetWkstaUserGetInfo fails,
	try 2
In-Reply-To: <b130c85e0805052336x55500a2fm732ed803b01c0377@mail.gmail.com>
References: <b130c85e0805052336x55500a2fm732ed803b01c0377@mail.gmail.com>
Message-ID: <22821af30805052343v2eb240bdl23b148186d43d9ac@mail.gmail.com>

On Tue, May 6, 2008 at 1:36 AM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Improved from James Hawkins suggestions.
>  ---
>

Just to clear my name, this is not what I suggested :-)

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Tue May  6 01:44:39 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 5 May 2008 23:44:39 -0700
Subject: draft Call for Testing
In-Reply-To: <a71bd89a0805052140t195eb628y606a79b9adf9d23f@mail.gmail.com>
References: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>
	<19e31a080805051841v1d5c03das2e7a424d60d1bb15@mail.gmail.com>
	<a71bd89a0805052140t195eb628y606a79b9adf9d23f@mail.gmail.com>
Message-ID: <b130c85e0805052344u69e03ef5vf187afaff3c09fe5@mail.gmail.com>

Hello,

2008/5/5 Dan Kegel <dank at kegel.com>:
> On Mon, May 5, 2008 at 6:41 PM, Steven Edwards <winehacker at gmail.com> wrote:
>  > On Mon, May 5, 2008 at 8:45 PM, Dan Kegel <dank at kegel.com> wrote:
>  >  >  As a token of our thanks, we will pick one of the users who submits
>  >  >  a healthy set of useful test results  and send him or her a tasteful
>  >  >  Wine-themed goodie of some sort.
>  >
>  >  Maybe we should all pitch in or tap the Wine party fund and give out a
>  >  bunch of t-shirts to people that step up to confirm and triage new and
>  >  exiting bug reports also. Assuming a t-shirt is good motivation, maybe
>
>  Yeah, t-shirts sound right.  I think Maarten was going to try whipping
>  something together out of the drunken penguin artwork.
>
>  Maybe we should give out two per release candidate, or something.
I'm really horribly at making artwork, so if there is someone who
wants to make artwork I can get it printed on t-shirt. Anyone willing
to go for it?
Bonus if you get the the artwork done using photoshop cs2 in wine.

Cheers,
Maarten.


From alex at thehandofagony.com  Tue May  6 03:06:34 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?utf-8?q?S=C3=B8rnes?=)
Date: Tue, 6 May 2008 10:06:34 +0200
Subject: AppDB: update the general help page and also make it valid html
In-Reply-To: <f5d9424f0805052004j364f9c58x22c208b455f95c87@mail.gmail.com>
References: <f5d9424f0805052004j364f9c58x22c208b455f95c87@mail.gmail.com>
Message-ID: <200805061006.34953.alex@thehandofagony.com>

> I've updated the general help page with links to git instead of cvs,
> updated building instructions and also changed the html a little so it
> validates, I've also removed a link to a cracks website and replaced
> it with a statement about third party software.
>
> before and after: http://img222.imageshack.us/img222/8647/baiz4.png

It's great that you're fixing up the help pages.  But i don't see why you are 
removing the link to MegaGames; I added it to make it easier for users to 
test games without a how-to; removing it would appear to do the opposite.




Alexander N. S?rnes


From stefan at codeweavers.com  Tue May  6 03:31:47 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 6 May 2008 10:31:47 +0200
Subject: [PATCH 3/3] ddraw/tests: Add tests for IDirect3DDevice7_Load.
In-Reply-To: <481F80EE.3020207@inbox.lv>
References: <481F80EE.3020207@inbox.lv>
Message-ID: <200805061031.47671.stefan@codeweavers.com>

Am Montag, 5. Mai 2008 23:49:34 schrieb Alexander Dorofeyev:
> + ? ?/* Freed in reverse order as native seems to dislike and crash on
> freeing top level surface first. */
just fyi, native ignores refcounts on sublevels(if they are created as complex 
surface, not attached). As long as the top level exists, you can release the 
sublevels into oblivion if you want to, they'll stay around. If the top level 
is destroyed, the sublevels are destroyed regardless of their refcounts. 
There are some tests for this behavior in dsurface.c, and Wine does the same 
essentially.

A very extensive test, wow!


From mstefani at redhat.com  Tue May  6 04:32:02 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Tue, 06 May 2008 11:32:02 +0200
Subject: draft Call for Testing
In-Reply-To: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>
References: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>
Message-ID: <48202592.8070208@redhat.com>

Dan Kegel wrote:
> So, what should we be asking wine users to be
> doing once rc1 is out?  How about this:
This has as subject "Call for Testing" but we could also need help with 
the translations http://wiki.winehq.org/Translating and 
http://pf128.krakow.sdi.tpnet.pl/wine-transl/

bye
	michael

> --- snip ---
> Calling all wine users!
> Today, after 15 years of development, the first release
> candidate for wine-1.0.0 was released.
> Wine has been under heavy development in recent
> months, and some applications that used to work well
> no longer do.  But we don't know which ones!  Please
> help us find them, so we can fix them.  Here's how:
> 
> 0. Make sure your machine runs glxgears properly
> (if it crashes, you may need to update your graphics drivers)
> 
> 1. Install wine-1.0.0-rc1 (you can download it from
> http://www.winehq.org/site/download ).
> Make sure wine's notepad starts up ok and says
> "wine 1.0.0 rc1" when you do Help / About Wine.
> 
> 2. Visit the Wine application database at
> http://appdb.winehq.org/browse_by_rating.php?sRating=Platinum
> and pick out a few applications that supposedly work perfectly under Wine
> but do not yet have any test reports with wine-1.0.0-rc1 or later.
> 
> 3. Try installing and running those apps, one at a time.
> Before installing each app, delete your .wine directory; that way
> you get a clean run, uncontaminated by the previous app's settings.
> 
> 4. For each app you test, add a test report into Wine's AppDB.
> 
> As a token of our thanks, we will pick one of the users who submits
> a healthy set of useful test results  and send him or her a tasteful
> Wine-themed goodie of some sort.
> 
> So fire up your keyboards and start testing!
> Thanks, and good hunting!
> --- snip ---
> 
> (Not sure how the goodie would be handled, but I'm willing to cover the
> expenses myself, especially if I get to pick the winner :-)
> 
> How's that sound?
> 
> 


-- 
Michael Stefaniuc                           Tel.: +49-711-96437-199
Consulting Communications Engineer          Fax.: +49-711-96437-111
--------------------------------------------------------------------
Reg. Adresse: Red Hat GmbH, Otto-Hahn-Strasse 20, 85609 Dornach bei Muenchen
Handelsregister: Amtsgericht Muenchen HRB 153243
Gesch?ftsf?hrer: Brendan Lane, Charlie Peters, Michael Cunningham,
                  Werner Knoblich


From wine-devel at kievinfo.com  Tue May  6 10:02:09 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 06 May 2008 09:02:09 -0600
Subject: [PATCH 1/3] dinput: Remove redundant variable.
In-Reply-To: <481CC8E8.3030902@kievinfo.com>
References: <481CC8E8.3030902@kievinfo.com>
Message-ID: <482072F1.7060601@kievinfo.com>

Vitaliy Margolen wrote:
> ---
>  dlls/dinput/joystick_linux.c |   16 +++++++---------
>  1 files changed, 7 insertions(+), 9 deletions(-)
> 

Forgot to add that this series of patches should finally address bugs 12052 
and 11644. Was there anything wrong with these patches?

Vitaliy.


From adam at tpetaccia.com  Tue May  6 10:19:14 2008
From: adam at tpetaccia.com (Adam Petaccia)
Date: Tue, 06 May 2008 11:19:14 -0400
Subject: draft Call for Testing
In-Reply-To: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>
References: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>
Message-ID: <1210087154.6066.2.camel@pimpmobile>


> 4. For each app you test, add a test report into Wine's AppDB.
> 
> As a token of our thanks, we will pick one of the users who submits
> a healthy set of useful test results  and send him or her a tasteful
> Wine-themed goodie of some sort.
> 
> So fire up your keyboards and start testing!
> Thanks, and good hunting!

I'd explicitly state something about reporting bugs for things that
don't work. It should be obvious, but being explicit rarely hurts. As I
tell my friends who refuse to file bugs: "They can't fix it if they
don't know its broke".
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080506/14e12be6/attachment.pgp 

From dank at kegel.com  Tue May  6 10:30:22 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 6 May 2008 08:30:22 -0700
Subject: draft Call for Testing
In-Reply-To: <1210087154.6066.2.camel@pimpmobile>
References: <a71bd89a0805051745p238d7a50t3053cb8c811e1cde@mail.gmail.com>
	<1210087154.6066.2.camel@pimpmobile>
Message-ID: <a71bd89a0805060830i4478d067nca1b6c59c22276c6@mail.gmail.com>

On Tue, May 6, 2008 at 8:19 AM, Adam Petaccia <adam at tpetaccia.com> wrote:
>  > 4. For each app you test, add a test report into Wine's AppDB.
>
>  I'd explicitly state something about reporting bugs for things that
>  don't work. It should be obvious, but being explicit rarely hurts. As I
>  tell my friends who refuse to file bugs: "They can't fix it if they
>  don't know its broke".

Yeah.   But I'd rather not scare them with bugzilla, so how about this:

4. For each app you test, add a test report into Wine's AppDB.
Since you're only testing apps that were rated as platinum,
it should work perfectly, even for people who don't know a
commandline from a kumquat.
If it doesn't work perfectly from start to finish, rate it no higher
than gold.  Now, if this was just a misrated application, you're
done.  But if you can verify that it actually worked great in an
earlier version of wine, you've found a regression!  In that
case, please post a message whose subject starts with 'regression:'
in the wine forum (or the wine-users mailing list), or file a bug
at bugs.winehq.org.

Now, that text is too long, but you get the idea.  How's it sound now?


From bon at elektron.ikp.physik.tu-darmstadt.de  Tue May  6 10:46:57 2008
From: bon at elektron.ikp.physik.tu-darmstadt.de (Uwe Bonnes)
Date: Tue, 6 May 2008 17:46:57 +0200
Subject: Serial port support in wine-1.0: What to do to make it working ?
In-Reply-To: <20080506053118.GA10501@tangens.sinus.cz>
References: <20080506053118.GA10501@tangens.sinus.cz>
Message-ID: <18464.32113.953487.858014@hertz.ikp.physik.tu-darmstadt.de>

>>>>> "Pavel" == Pavel Troller <patrol at sinus.cz> writes:

    Pavel> Hi!  I have really BIG problems running any application, which
    Pavel> needs to comm over a serial port: - My ham TCVR - My GPS - My
    Pavel> multimeter - A lot of my mobiles - A lot of devices used in my
    Pavel> work (special telco equipment, comms varying from simple AT-style
    Pavel> commands up to complex proprietary binary protocols).  In all the
    Pavel> cases there are very similar problems - either the program
    Pavel> doesn't detect the device properly, or the device doesn't
    Pavel> respond, or in some cases the device does, what the program
    Pavel> wants, but it then can't read it back.  It looks that some
    Pavel> archaic wine versions are better, for example I have to use
    Pavel> wine-0.9.40 to communicate with a device in my work (simple
    Pavel> text-based command-reply communication), any wine newer than say
    Pavel> 0.9.50 doesn't work, the communication times out.  Because I'm a
    Pavel> telco engineer and serial comm is my daily work, and there are
    Pavel> only windows versions of many tools I have to use, proper and
    Pavel> mature serial port support is essential for me.  So, what can I
    Pavel> do to help fixing these problems ? Should I open a bug for every
    Pavel> such a program ? Or just open one bug and state all the programs
    Pavel> there ?  I think that bugzilla contains a lot of bugs related to
    Pavel> serial port; is it good to add a new ones ?  I'm afraid I can't
    Pavel> bisect a problem between 0.9.40 and current wine, but I can make
    Pavel> a serial trace for both of them and look at the difference. Would
    Pavel> it help to find at least this one particular problem ? Or what
    Pavel> more can I do to make the serial port working ? I can code in C
    Pavel> in the Linux environment, but I know NOTHING about windows...
    Pavel> With regards, Pavel Troller

Pavel,

perhaps compile wine yourself and instrument the serial code with debugging
output. Try to see what's going wrong. Look at the codes where this happens
and read the old changelogs, where somebody fiddled witrh the code. Ask
about what people thought (or smoked) when implementing or offer a better
implementation.

There is a big problem with those special devices, as only few if any wine
developpers have it...

Bye
-- 
Uwe Bonnes                bon at elektron.ikp.physik.tu-darmstadt.de

Institut fuer Kernphysik  Schlossgartenstrasse 9  64289 Darmstadt
--------- Tel. 06151 162516 -------- Fax. 06151 164321 ----------


From wine-devel at kievinfo.com  Tue May  6 11:25:43 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 06 May 2008 10:25:43 -0600
Subject: [PATCH 1/3] dinput: Remove redundant variable.
In-Reply-To: <482072F1.7060601@kievinfo.com>
References: <481CC8E8.3030902@kievinfo.com> <482072F1.7060601@kievinfo.com>
Message-ID: <48208687.3040706@kievinfo.com>

Vitaliy Margolen wrote:
> Vitaliy Margolen wrote:
>> ---
>>  dlls/dinput/joystick_linux.c |   16 +++++++---------
>>  1 files changed, 7 insertions(+), 9 deletions(-)
>>
> 
> Forgot to add that this series of patches should finally address bugs 12052 
> and 11644. Was there anything wrong with these patches?
> 
> Vitaliy.
> 
> 
Uh sorry I guess I know the [PATCH 3/3] does not compiles. Sorry about it. 
I'm almost positive I've tested that patch.

New replacement on the way.

Vitaliy.


From wine-devel at kievinfo.com  Tue May  6 12:34:38 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 06 May 2008 11:34:38 -0600
Subject: [PATCH] cmd.exe: MSI packages execution implemented
In-Reply-To: <200805062114.26118.vitperov@etersoft.ru>
References: <200805062114.26118.vitperov@etersoft.ru>
Message-ID: <482096AE.5050004@kievinfo.com>

Vitaly Perov wrote:
> Changelog:  cmd.exe: MSI packages execution implemented
> 
> 
> 
That doesn't look right. You sure this information is hard-coded into 
cmd.exe and it's not coming from the registry CLASSES hive?

Vitaliy


From eric.pouech at orange.fr  Tue May  6 15:00:38 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Tue, 06 May 2008 22:00:38 +0200
Subject: [PATCH] fixed if check before strchr
Message-ID: <4820B8E6.3080409@orange.fr>

Marcus Meissner a ?crit :
> Hi,
>
> spotted by Coverity (CID 701), a if (!spath) should be if (spath).
>
> Ciao, Marcus
> ---
>  programs/winedbg/source.c |    2 +-
>  1 files changed, 1 insertions(+), 1 deletions(-)
>
> diff --git a/programs/winedbg/source.c b/programs/winedbg/source.c
> index 5519c57..1db7092 100644
> --- a/programs/winedbg/source.c
> +++ b/programs/winedbg/source.c
> @@ -128,7 +128,7 @@ static BOOL     source_locate_file(const char* srcfile, char* path)
>          while (!found)
>          {
>              spath = strchr(spath, '\\');
> -            if (!spath) spath = strchr(spath, '/');
> +            if (spath) spath = strchr(spath, '/');
>              if (!spath) break;
>              spath++;
>              found = SearchPathA(dbg_curr_process->search_path, spath, NULL, MAX_PATH, path, NULL);
>   
actually no
the code intends to find the first occurence of / or \
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From truiken at gmail.com  Tue May  6 15:05:18 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 6 May 2008 15:05:18 -0500
Subject: [PATCH] fixed if check before strchr
In-Reply-To: <4820B8E6.3080409@orange.fr>
References: <4820B8E6.3080409@orange.fr>
Message-ID: <22821af30805061305w4d019d6at89a93f9d213a261f@mail.gmail.com>

On Tue, May 6, 2008 at 3:00 PM, Eric Pouech <eric.pouech at orange.fr> wrote:
> Marcus Meissner a ?crit :
>
>
> > Hi,
>  >
>  > spotted by Coverity (CID 701), a if (!spath) should be if (spath).
>  >
>  > Ciao, Marcus
>  > ---
>  >  programs/winedbg/source.c |    2 +-
>  >  1 files changed, 1 insertions(+), 1 deletions(-)
>  >
>  > diff --git a/programs/winedbg/source.c b/programs/winedbg/source.c
>  > index 5519c57..1db7092 100644
>  > --- a/programs/winedbg/source.c
>  > +++ b/programs/winedbg/source.c
>  > @@ -128,7 +128,7 @@ static BOOL     source_locate_file(const char* srcfile, char* path)
>  >          while (!found)
>  >          {
>  >              spath = strchr(spath, '\\');
>  > -            if (!spath) spath = strchr(spath, '/');
>  > +            if (spath) spath = strchr(spath, '/');
>  >              if (!spath) break;
>  >              spath++;
>  >              found = SearchPathA(dbg_curr_process->search_path, spath, NULL, MAX_PATH, path, NULL);
>  >
>  actually no
>  the code intends to find the first occurence of / or \
>  A+
>

Then you have to use a different variable than spath.  If you don't
find '\\', then you'll pass NULL into the second strchr.

-- 
James Hawkins


From juan.lang at gmail.com  Tue May  6 15:06:34 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 6 May 2008 13:06:34 -0700
Subject: [PATCH] fixed if check before strchr
In-Reply-To: <4820B8E6.3080409@orange.fr>
References: <4820B8E6.3080409@orange.fr>
Message-ID: <3a768c550805061306q102f92bcw6de0b445f4b0a01b@mail.gmail.com>

On Tue, May 6, 2008 at 1:00 PM, Eric Pouech <eric.pouech at orange.fr> wrote:
> Marcus Meissner a ?crit :
>> Hi,
>>
>> spotted by Coverity (CID 701), a if (!spath) should be if (spath).
>>
>> Ciao, Marcus
>> ---
>>  programs/winedbg/source.c |    2 +-
>>  1 files changed, 1 insertions(+), 1 deletions(-)
>>
>> diff --git a/programs/winedbg/source.c b/programs/winedbg/source.c
>> index 5519c57..1db7092 100644
>> --- a/programs/winedbg/source.c
>> +++ b/programs/winedbg/source.c
>> @@ -128,7 +128,7 @@ static BOOL     source_locate_file(const char* srcfile, char* path)
>>          while (!found)
>>          {
>>              spath = strchr(spath, '\\');
>> -            if (!spath) spath = strchr(spath, '/');
>> +            if (spath) spath = strchr(spath, '/');
>>              if (!spath) break;
>>              spath++;
>>              found = SearchPathA(dbg_curr_process->search_path, spath, NULL, MAX_PATH, path, NULL);
>>
> actually no
> the code intends to find the first occurence of / or \

In that case, the code is still incorrect.  Perhaps it should be:
-            if (!spath) spath = strchr(spath, '/');
+            if (!spath) spath = strchr(srcfile, '/');
instead?
--Juan


From wine.dev at web.de  Tue May  6 16:02:15 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Tue, 06 May 2008 23:02:15 +0200
Subject: Bison 2.1 / Solaris
In-Reply-To: <b6bb06270805052155v581a5340j48f8831749490950@mail.gmail.com>
References: <b6bb06270805052155v581a5340j48f8831749490950@mail.gmail.com>
Message-ID: <1210107735.6306.12.camel@p4>

On Mo, 2008-05-05 at 23:55 -0500, Austin English wrote:

> austin at nexenta:~/wine$ bison --version
> bison (GNU Bison) 2.1

I used Wine ~2 Years on on Ubuntu Dapper without Problems.
Bison in Dapper was 2.1:
http://packages.ubuntu.com/dapper/devel/bison

?(I'm unable to verify the latest used bison-version: I switched 2 Weeks
ago)


-- 
 
By by ... Detlef




From paul at astro.gla.ac.uk  Tue May  6 16:20:11 2008
From: paul at astro.gla.ac.uk (Paul Millar)
Date: Tue, 6 May 2008 23:20:11 +0200
Subject: winetest problems
In-Reply-To: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
References: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
Message-ID: <200805062320.11195.paul@astro.gla.ac.uk>

Hi,

On Saturday 03 May 2008 01:38:07 James Hawkins wrote:
> I'm trying to fix the failing cross tests, but we haven't had a
> winetest build on Paul Millar's server in a few days.

Just to mention that gaps will appear if the winetest.exe builds but hasn't 
changed.  As Paul (Vriens) says, the log files should indicate if there's a 
problem:
	http://quisquiliae.physics.gla.ac.uk/cross/logs/

> [...] a recent commit has broken the build.

Yes.  It's the usual story: some new tests were added that test some functions 
that MinGW w32api doesn't support.  As it happens, the breakage coincided 
with my spending a long weekend without Internet access.

The problem appears to be fixed now and a new winetest.exe should be 
available.

[...]
> Which (I assume) is usually fixed by Paul Millar's win32api custom
> patches.

Yup.  I try to provide a tar-ball of these patches "every so often", see:
	http://www.astro.gla.ac.uk/users/paulm/Cross/

I must point out that there is a group of us who do this share the patches and 
the vast, vast majority of the patches are not by me.

Cheers,

Paul.


From truiken at gmail.com  Tue May  6 16:46:01 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 6 May 2008 16:46:01 -0500
Subject: winetest problems
In-Reply-To: <200805062320.11195.paul@astro.gla.ac.uk>
References: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
	<200805062320.11195.paul@astro.gla.ac.uk>
Message-ID: <22821af30805061446y68a5993br414846ece3cc14d4@mail.gmail.com>

On Tue, May 6, 2008 at 4:20 PM, Paul Millar <paul at astro.gla.ac.uk> wrote:
> Hi,
>
>
>  On Saturday 03 May 2008 01:38:07 James Hawkins wrote:
>  > I'm trying to fix the failing cross tests, but we haven't had a
>  > winetest build on Paul Millar's server in a few days.
>
>  Just to mention that gaps will appear if the winetest.exe builds but hasn't
>  changed.  As Paul (Vriens) says, the log files should indicate if there's a
>  problem:
>
>         http://quisquiliae.physics.gla.ac.uk/cross/logs/
>
>  > [...] a recent commit has broken the build.
>
>  Yes.  It's the usual story: some new tests were added that test some functions
>  that MinGW w32api doesn't support.  As it happens, the breakage coincided
>  with my spending a long weekend without Internet access.
>
>  The problem appears to be fixed now and a new winetest.exe should be
>  available.
>
>  [...]
>
> > Which (I assume) is usually fixed by Paul Millar's win32api custom
>  > patches.
>
>  Yup.  I try to provide a tar-ball of these patches "every so often", see:
>         http://www.astro.gla.ac.uk/users/paulm/Cross/
>
>  I must point out that there is a group of us who do this share the patches and
>  the vast, vast majority of the patches are not by me.
>

Thanks a lot Paul and everyone else who contributes to this!

-- 
James Hawkins


From jmayer at loplof.de  Tue May  6 16:56:38 2008
From: jmayer at loplof.de (Joerg Mayer)
Date: Tue, 6 May 2008 23:56:38 +0200
Subject: [PATCH] fixed if check before strchr
In-Reply-To: <4820B8E6.3080409@orange.fr>
References: <4820B8E6.3080409@orange.fr>
Message-ID: <20080506215638.GC21499@thot.informatik.uni-kl.de>

On Tue, May 06, 2008 at 10:00:38PM +0200, Eric Pouech wrote:
> >              spath = strchr(spath, '\\');
> > -            if (!spath) spath = strchr(spath, '/');
> > +            if (spath) spath = strchr(spath, '/');

So the correct solution would be something like

bpath=strchr(spath, '\\');
spath=strchr(spath, '/');
if (bpath && spath)
	spath=MIN(bpath, spath);
else
	spath=MAX(bpath,spath);

?
Btw, are Unix filenames that contain a '\' a problem?

 Ciao
       Joerg
-- 
Joerg Mayer                                           <jmayer at loplof.de>
We are stuck with technology when what we really want is just stuff that
works. Some say that should read Microsoft instead of technology.


From m.b.lankhorst at gmail.com  Tue May  6 17:16:29 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 6 May 2008 15:16:29 -0700
Subject: What happened to the ntdll rtlstr tests?
Message-ID: <b130c85e0805061516x4e30f984yeae2896e0a6ba80d@mail.gmail.com>

Hello Alexandre,

Why were the fixes for the ntdll rtlstr test failures on windows not accepted?

Cheers,
Maarten.


From wine.dev at web.de  Tue May  6 18:08:28 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Wed, 07 May 2008 01:08:28 +0200
Subject: winetest problems
In-Reply-To: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
References: <22821af30805021638v2c33ad19oa017d58538b9910f@mail.gmail.com>
Message-ID: <1210115308.6306.18.camel@p4>

On Fr, 2008-05-02 at 18:38 -0500, James Hawkins wrote:

> i586-mingw32msvc-gcc advpack.cross.o files.cross.o install.cross.o
> testlist.cross.o -o advpack_crosstest.exe -lcabinet -ladvapi32
> -lkernel32
> /usr/lib/gcc/i586-mingw32msvc/4.2.1-sjlj/../../../../i586-mingw32msvc/bin/ld:
> cannot find -lcabinet
> collect2: ld returned 1 exit status
> make[2]: *** [advpack_crosstest.exe] Error 1

mingw from mingw.org is to old for Wine.

> Which (I assume) is usually fixed by Paul Millar's win32api custom
> patches.  Any thoughts or ideas?

Hans Leidekker maintains patched mingw packages:

http://mirzam.it.vu.nl/mingw/


-- 
 
By by ... Detlef




From patrol at sinus.cz  Tue May  6 22:36:13 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Wed, 7 May 2008 05:36:13 +0200
Subject: Serial port support in wine-1.0: What to do to make it working ?
In-Reply-To: <18464.32113.953487.858014@hertz.ikp.physik.tu-darmstadt.de>
References: <20080506053118.GA10501@tangens.sinus.cz>
	<18464.32113.953487.858014@hertz.ikp.physik.tu-darmstadt.de>
Message-ID: <20080507033613.GA9452@tangens.sinus.cz>

Hi Uwe,

> Pavel,
> 
> perhaps compile wine yourself and instrument the serial code with debugging
> output. Try to see what's going wrong. Look at the codes where this happens
> and read the old changelogs, where somebody fiddled witrh the code. Ask
> about what people thought (or smoked) when implementing or offer a better
> implementation.

OK, will do. I'm always compiling wine from source, so I will try to dig into
the driver and search for the bugs there. One of the cases is I think simple,
the device uses normal ASCII protocol and I can talk to it using kermit or
minicom, but the windows program intended to control it simply stucks on the
first command and never gets a reply. I think there is a good place to start.

> 
> There is a big problem with those special devices, as only few if any wine
> developpers have it...

Yes, I know. I hope that there is just a limited number of bugs, but they
affect many such devices, so it looks that the driver is totally broken.

With regards, Pavel Troller


From julliard at winehq.org  Wed May  7 02:41:54 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 07 May 2008 09:41:54 +0200
Subject: What happened to the ntdll rtlstr tests?
In-Reply-To: <b130c85e0805061516x4e30f984yeae2896e0a6ba80d@mail.gmail.com>
	(Maarten Lankhorst's message of "Tue, 6 May 2008 15:16:29 -0700")
References: <b130c85e0805061516x4e30f984yeae2896e0a6ba80d@mail.gmail.com>
Message-ID: <87ej8emugt.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> Why were the fixes for the ntdll rtlstr test failures on windows not accepted?

They fail for me on Wine.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Wed May  7 03:10:34 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 07 May 2008 09:10:34 +0100
Subject: rpcrt4: Fix ndr_marshall test failures, try 2
In-Reply-To: <b130c85e0805061550k75db742cgea404d2fda22990d@mail.gmail.com>
References: <b130c85e0805061550k75db742cgea404d2fda22990d@mail.gmail.com>
Message-ID: <482163FA.5010204@codeweavers.com>

Maarten Lankhorst wrote:
> -    ok(RPC_S_OK == RpcServerUseProtseqEp(ncalrpc, 20, endpoint, NULL), "RpcServerUseProtseqEp\n");
> -    ok(RPC_S_OK == RpcServerRegisterIf(IFoo_v0_0_s_ifspec, NULL, NULL), "RpcServerRegisterIf\n");
> -    ok(RPC_S_OK == RpcServerListen(1, 20, TRUE), "RpcServerListen\n");
> +    status = RpcServerUseProtseqEp(ncalrpc, 20, endpoint, NULL);
> +    ok(RPC_S_OK == status, "RpcServerUseProtseqEp failed with status %08lx\n", status);
> +    status = RpcServerRegisterIf(IFoo_v0_0_s_ifspec, NULL, NULL);
> +    ok(RPC_S_OK == status, "RpcServerRegisterIf failed with status %08lx\n", status);
> +    status = RpcServerListen(1, 20, TRUE);
> +    ok(RPC_S_OK == status, "RpcServerListen failed with status %08lx\n", status);
>   

Since the RPC status values are in decimal in winerror.h, it is more 
user-friendly to output them in decimal in the failure messages.

-- 
Rob Shearman



From paul.vriens.wine at gmail.com  Wed May  7 04:05:53 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 07 May 2008 11:05:53 +0200
Subject: Should winedevice.exe in the end be able to load file system drivers
	as well?
Message-ID: <482170F1.3080404@gmail.com>

Hi,

The comment in winedevice.exe says "Service process to load a kernel driver".

But will winedevice.exe in the (far ?) future be the vehicle to load file system 
drivers as well.

-- 
Cheers,

Paul.


From rob at codeweavers.com  Wed May  7 05:17:02 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Wed, 07 May 2008 11:17:02 +0100
Subject: [PATCH] check for iface->ref to avoid crash
Message-ID: <4821819E.4020202@codeweavers.com>

Marcus Meissner wrote:
> @@ -742,6 +742,9 @@ static void write_c_method_def(FILE *header, const type_t *iface)
>  
>  static void write_c_disp_method_def(FILE *header, const type_t *iface)
>  {
> +  if (!iface->ref) {
> +    error_loc("write_c_disp_method_def: no reference on interface(%p)\n", iface);
> +  }
>    do_write_c_method_def(header, iface->ref, iface->name);
>  }
>   

This can't ever happen. dispinterfaces always derive from IDispatch:
> dispinterfacehdr: attributes dispinterface      { attr_t *attrs;
>                                                   is_in_interface = TRUE;
>                                                   is_object_interface 
> = TRUE;
>                                                   $$ = $2;
>                                                   if ($$->defined) 
> error_loc("multiple definition error\n");
>                                                   attrs = 
> make_attr(ATTR_DISPINTERFACE);
>                                                   $$->attrs = 
> append_attr( check_dispiface_attrs($2->name, $1), attrs );
>                                                   $$->ref = 
> find_type("IDispatch", 0);
>                                                   if (!$$->ref) 
> error_loc("IDispatch is undefined\n");
>                                                   $$->defined = TRUE;
>                                                   if (!parse_only && 
> do_header) write_forward($$);
>                                                 }


-- 
Rob Shearman



From meissner at suse.de  Wed May  7 06:33:42 2008
From: meissner at suse.de (Marcus Meissner)
Date: Wed, 7 May 2008 13:33:42 +0200
Subject: [PATCH] check for iface->ref to avoid crash
In-Reply-To: <4821819E.4020202@codeweavers.com>
References: <4821819E.4020202@codeweavers.com>
Message-ID: <20080507113342.GA15457@suse.de>

On Wed, May 07, 2008 at 11:17:02AM +0100, Robert Shearman wrote:
> Marcus Meissner wrote:
>> @@ -742,6 +742,9 @@ static void write_c_method_def(FILE *header, const 
>> type_t *iface)
>>   static void write_c_disp_method_def(FILE *header, const type_t *iface)
>>  {
>> +  if (!iface->ref) {
>> +    error_loc("write_c_disp_method_def: no reference on interface(%p)\n", 
>> iface);
>> +  }
>>    do_write_c_method_def(header, iface->ref, iface->name);
>>  }
>>   
>
> This can't ever happen. dispinterfaces always derive from IDispatch:
>> dispinterfacehdr: attributes dispinterface      { attr_t *attrs;

I marked it as FALSE in Coverity then.

Ciao, Marcus


From dank at kegel.com  Wed May  7 08:57:32 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 7 May 2008 06:57:32 -0700
Subject: Serial port support in wine-1.0: What to do to make it working ?
Message-ID: <a71bd89a0805070657n434448d7tdf02a84c73010b2b@mail.gmail.com>

Pavel wrote:
> I have to use wine-0.9.40 to communicate with a device
> in my work (simple text-based command-reply communication),
> any wine newer than say 0.9.50 doesn't work, the communication times out.
> ... I will try to dig into the driver and search for the bugs there.
> One of the cases is I think simple, the device uses normal ASCII protocol
> and I can talk to it using kermit or minicom, but the windows program
> intended to control it simply stucks on the first command and never
>  gets a reply. I think there is a good place to start.

Yep.  FWIW, the fix might be tiny.  Alexandre fixed a serial bug today,
http://bugs.winehq.org/show_bug.cgi?id=9356
with just a single assignment.

If you can come up with a simple way for others to reproduce
the problem, that might help, too.

Lessee... here are most of the existing serial bug reports;
some of them (eg. 4055, 8783, 9988, 10051, 10056, 11399, 11811) have
interesting info:
http://bugs.winehq.org/show_bug.cgi?id=1244 (big grab bag of apps,
some downloadable)
http://bugs.winehq.org/show_bug.cgi?id=1700 (putty, downloadable)
http://bugs.winehq.org/show_bug.cgi?id=4055 (interesting, points to kernel bug)
http://bugs.winehq.org/show_bug.cgi?id=4633 (Garmin)
http://bugs.winehq.org/show_bug.cgi?id=4753 (workaround, interesting,
mentions kernel problem)
http://bugs.winehq.org/show_bug.cgi?id=5154 (Siemens phone; 0.9.12 bad)
http://bugs.winehq.org/show_bug.cgi?id=6895 (0.9.27 bad; timeout control broken)
http://bugs.winehq.org/show_bug.cgi?id=5632  (Secure CRT behaves
funny, downloadable)
http://bugs.winehq.org/show_bug.cgi?id=8113 (0.27 good, 0.35 bad)
http://bugs.winehq.org/show_bug.cgi?id=8783 (pinpoints the very commit
that caused the problem in 0.9.23!)
http://bugs.winehq.org/show_bug.cgi?id=9988 (good analysis, example code, patch)
http://bugs.winehq.org/show_bug.cgi?id=10051 (HAL needs to create
entries for serial ports?)
http://bugs.winehq.org/show_bug.cgi?id=10056 (good source testcase!)
http://bugs.winehq.org/show_bug.cgi?id=10573 (wine's tests fail on
laptop with serial port; bisect)
http://bugs.winehq.org/show_bug.cgi?id=11077 (HAL needs to create
entries for serial ports)
http://bugs.winehq.org/show_bug.cgi?id=11339 (bugfix for serial.c)
http://bugs.winehq.org/show_bug.cgi?id=11811 (HAL support needs improvement)
http://bugs.winehq.org/show_bug.cgi?id=11829 (0.9.22 good, 0.9.56 bad)
http://bugs.winehq.org/show_bug.cgi?id=12479 (timeout problems?)

OMG that's a lot of bugs.   There has been a LOT of analysis done
by various folks; now it's time to grind through it all and fix the problems.
As I mentioned, Alexandre has fixed one already; perhaps
he has time to look at a few more of these.

FWIW, I have some win32 serial i/o example source code here, along with
an archive of comments about problems  (from back in the day when
multiplayer games talked to modems):
http://alumnus.caltech.edu/~dank/overlap.htm
- Dan


From cesar at ecuarock.net  Wed May  7 12:19:11 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Wed, 7 May 2008 12:19:11 -0500
Subject: winetricks missing MFC42
Message-ID: <e3d3ae8f0805071019m2a75035csc24399671644788d@mail.gmail.com>

I see that MFC42 is missing on wine tricks. There's a cab available from:

http://activex.microsoft.com/controls/vc/mfc42.cab

that contains an installer. It would be nice to add this to winetricks I guess.


From dank at kegel.com  Wed May  7 12:43:35 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 7 May 2008 10:43:35 -0700
Subject: winetricks missing MFC42
Message-ID: <a71bd89a0805071043q7c61caf2x2429f0d18f7a097c@mail.gmail.com>

Cesar wrote:
> I see that MFC42 is missing on wine tricks.

Nope!  It's installed by the vcrun6 verb:
    echo " vcrun6     vc6redist from VS6sp4 (mfc42, msvcp60, msvcrt)"
I've been considering making it more obvious.

> There's a cab available from:
> http://activex.microsoft.com/controls/vc/mfc42.cab

Thanks, nice to have an alternate source.


From dank at kegel.com  Wed May  7 13:11:54 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 7 May 2008 11:11:54 -0700
Subject: 2nd draft: 1.0 call for testing
Message-ID: <a71bd89a0805071111g2ad13131nd0c6298082d3cc96@mail.gmail.com>

How's this look?  It's on the wiki now:

http://wiki.winehq.org/PlatinumRegressionHunt


From zajec5polish at gmail.com  Wed May  7 13:49:34 2008
From: zajec5polish at gmail.com (=?UTF-8?Q?Rafa=C5=82_Mi=C5=82ecki?=)
Date: Wed, 7 May 2008 20:49:34 +0200
Subject: Review request: real async for GetAsyncKeyState (bug #5623)
Message-ID: <14b026160805071149m791a2c01x12ab65c08dc2573e@mail.gmail.com>

Hi,

This is my first wine patch and fix for bug #5623. This was tested and
works fine however I suspect this is not clean enought for commiting
to master.

Would be nice if you could review this and tell me what sould be done
better (and how?).

This patch adds new variable:
BYTE global_key_state_table[256];

to wineserver and two new entries in protocol:
/* Get global key state */
@REQ(get_global_key_state)
    int            key;           /* key */
@REPLY
    BYTE           value;         /* status of key */
@END

/* Set global key state */
@REQ(set_global_key_state)
    int            key;           /* key */
    BYTE           value;         /* status for key */
@END

That allows me to keep current *global* state of keyboard. Of course
this will works only for wine windows from current wineserver. This
was discussed in bug report and it is fine for reported applications.

The last think I done is using wineserver in
X11DRV_send_keyboard_input

-- 
Rafa? Mi?ecki
-------------- next part --------------
A non-text attachment was scrubbed...
Name: real.async.for.GetAsyncKeyState.patch
Type: application/octet-stream
Size: 9309 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080507/99b7f2c5/attachment.obj 

From zajec5polish at gmail.com  Wed May  7 13:50:17 2008
From: zajec5polish at gmail.com (=?UTF-8?Q?Rafa=C5=82_Mi=C5=82ecki?=)
Date: Wed, 7 May 2008 20:50:17 +0200
Subject: Review request: real async for GetAsyncKeyState (bug #5623)
In-Reply-To: <14b026160805071149m791a2c01x12ab65c08dc2573e@mail.gmail.com>
References: <14b026160805071149m791a2c01x12ab65c08dc2573e@mail.gmail.com>
Message-ID: <14b026160805071150u29f6e4c7je95478b24e37556@mail.gmail.com>

Direct link to bug report:

http://bugs.winehq.org/show_bug.cgi?id=5623

-- 
Rafa? Mi?ecki

From cesar at ecuarock.net  Wed May  7 14:32:38 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Wed, 7 May 2008 14:32:38 -0500
Subject: winetricks missing MFC42
In-Reply-To: <a71bd89a0805071043q7c61caf2x2429f0d18f7a097c@mail.gmail.com>
References: <a71bd89a0805071043q7c61caf2x2429f0d18f7a097c@mail.gmail.com>
Message-ID: <e3d3ae8f0805071232v99fd6c1u5d93a5a503cdc6ad@mail.gmail.com>

On Wed, May 7, 2008 at 12:43 PM, Dan Kegel <dank at kegel.com> wrote:
> Cesar wrote:
>  > I see that MFC42 is missing on wine tricks.
>
>  Nope!  It's installed by the vcrun6 verb:
>     echo " vcrun6     vc6redist from VS6sp4 (mfc42, msvcp60, msvcrt)"
>  I've been considering making it more obvious.
>
>
>  > There's a cab available from:
>  > http://activex.microsoft.com/controls/vc/mfc42.cab
>
>  Thanks, nice to have an alternate source.
>

Maybe it would be nice to have something like:

winetricks mfc42.dll

and have some sort of alias database with some dlls filenames there.
It would make end users life much more easier imho.


From dank at kegel.com  Wed May  7 14:34:24 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 7 May 2008 12:34:24 -0700
Subject: winetricks missing MFC42
In-Reply-To: <e3d3ae8f0805071232v99fd6c1u5d93a5a503cdc6ad@mail.gmail.com>
References: <a71bd89a0805071043q7c61caf2x2429f0d18f7a097c@mail.gmail.com>
	<e3d3ae8f0805071232v99fd6c1u5d93a5a503cdc6ad@mail.gmail.com>
Message-ID: <a71bd89a0805071234i5e9ed7eu63f85567d1f157a@mail.gmail.com>

On Wed, May 7, 2008 at 12:32 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
>  Maybe it would be nice to have something like:
>
>  winetricks mfc42.dll
>
>  and have some sort of alias database with some dlls filenames there.
>  It would make end users life much more easier imho.

Yes, exactly.  There is some question about how to present
a GUI for that, the list could be quite large.  So I'll probably
only add aliases for a few common DLLs, at least at first.


From dylan.ah.smith at gmail.com  Wed May  7 15:00:41 2008
From: dylan.ah.smith at gmail.com (Dylan Smith)
Date: Wed, 7 May 2008 16:00:41 -0400
Subject: SOC 2008 Projects Announced
Message-ID: <5c6ee3b70805071300x78531ebdwfa48f223548e4a58@mail.gmail.com>

Hello everyone,

My name is Dylan Smith, and I will be working on implementing tables in rich
edit controls as a Google Summer of Code project.  Any remaining time I have
will also be focused on rich edit controls for this summer.

Forgive me for taking so long to introduce myself on the developers mailing
list.  I ended up going straight for the code as soon as my exams finished. I
just finished my last year of Software Engineering at Carleton University which
is located in Ottawa, Canada.  I will be returning to Carleton University for
my Masters after the summer.

I am thrilled that I am getting this opportunity to work on Wine for the summer.

Happy coding to you all,
Dylan


From m.b.lankhorst at gmail.com  Wed May  7 16:59:26 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 7 May 2008 14:59:26 -0700
Subject: wininet: Deal with bogus accept types array passed into
	HttpOpenRequestA.
In-Reply-To: <200805071319.38746.hans@it.vu.nl>
References: <200805071319.38746.hans@it.vu.nl>
Message-ID: <b130c85e0805071459i3fb43a2t590b4cc42672e38d@mail.gmail.com>

Hoi Hans

2008/5/7 Hans Leidekker <hans at it.vu.nl>:
>
>  The bug reporting agent in Google Sketchup passes an accept types
>  array that includes a wild pointer and a pointer to an empty string,
>  both of which are ignored by Windows. Although the wild pointer changed
>  between a number of tries its high word remained unset, so we may get
>  away with a check on the high word instead of an exception handler.
>
>  Fixes http://bugs.winehq.org/show_bug.cgi?id=11954
>
>   -Hans
This test fails on xp for me, can you fix it?

http.c:1767: Test failed: got ', */*, %p, , */*' expected '*/*, %p, */*'

Cheers,
Maarten.


From wine-devel at kievinfo.com  Wed May  7 17:46:08 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 07 May 2008 16:46:08 -0600
Subject: winetricks missing MFC42
In-Reply-To: <a71bd89a0805071234i5e9ed7eu63f85567d1f157a@mail.gmail.com>
References: <a71bd89a0805071043q7c61caf2x2429f0d18f7a097c@mail.gmail.com>	<e3d3ae8f0805071232v99fd6c1u5d93a5a503cdc6ad@mail.gmail.com>
	<a71bd89a0805071234i5e9ed7eu63f85567d1f157a@mail.gmail.com>
Message-ID: <48223130.5030305@kievinfo.com>

Dan Kegel wrote:
> On Wed, May 7, 2008 at 12:32 PM, Cesar Izurieta <cesar at ecuarock.net> wrote:
>>  Maybe it would be nice to have something like:
>>
>>  winetricks mfc42.dll
>>
>>  and have some sort of alias database with some dlls filenames there.
>>  It would make end users life much more easier imho.
> 
> Yes, exactly.  There is some question about how to present
> a GUI for that, the list could be quite large.  So I'll probably
> only add aliases for a few common DLLs, at least at first.
> 
> 
Dan that's going way overboard. You creating another winedoors or worse 
winetools.

Original idea of having few dlls and registry changes in one place - was 
great. So no one would need to repeat those instructions over and over 
again. But having windows media player?! Now list of all windows dlls that 
some users will install just in case.

Please scale it back or split it into a separate tool.

Vitaliy.


From dank at kegel.com  Wed May  7 18:23:41 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 7 May 2008 16:23:41 -0700
Subject: winetricks missing MFC42
In-Reply-To: <48223130.5030305@kievinfo.com>
References: <a71bd89a0805071043q7c61caf2x2429f0d18f7a097c@mail.gmail.com>
	<e3d3ae8f0805071232v99fd6c1u5d93a5a503cdc6ad@mail.gmail.com>
	<a71bd89a0805071234i5e9ed7eu63f85567d1f157a@mail.gmail.com>
	<48223130.5030305@kievinfo.com>
Message-ID: <a71bd89a0805071623s32f0f2e9of96d465713c219a1@mail.gmail.com>

On Wed, May 7, 2008 at 3:46 PM, Vitaliy Margolen
<wine-devel at kievinfo.com> wrote:
>  Dan that's going way overboard. You creating another winedoors or worse
> winetools.
>
>  Original idea of having few dlls and registry changes in one place - was
> great. So no one would need to repeat those instructions over and over
> again. But having windows media player?! Now list of all windows dlls that
> some users will install just in case.

No, no, no.  Only mfc42 and other really common ones.
I promise I won't go crazy.

And it's not winedoors - it's just a shell script without any
delusions of grandeur.


From dmitry at codeweavers.com  Wed May  7 21:16:30 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 8 May 2008 11:16:30 +0900
Subject: mlang: Make mlang tests pass under windows
References: <b130c85e0805071422o4ebc7cfap769f05d66b44a087@mail.gmail.com>
Message-ID: <36C89DADE671440FB81E650A7EC7D62F@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

> +            /* Not all codepages can be converted to UTF-8 */
> +            if (cpinfo[i].uiCodePage == 20127 || cpinfo[i].uiCodePage == 28591 || cpinfo[i].uiCodePage == 28605)
> +                expected = S_FALSE;

The statement above is not true. The reason for mlang test failures is that
apparently mlang in Windows has its own idea of supported locales not connected
to real kernel32 implementation. I'd leave the tests as they are, there is
nothing wrong in them, we can't fix Windows bugs.

-- 
Dmitry.


From anssi.hannula at gmail.com  Wed May  7 21:32:15 2008
From: anssi.hannula at gmail.com (Anssi Hannula)
Date: Thu, 08 May 2008 05:32:15 +0300
Subject: Bison 2.1 / Solaris
In-Reply-To: <b6bb06270805052155v581a5340j48f8831749490950@mail.gmail.com>
References: <b6bb06270805052155v581a5340j48f8831749490950@mail.gmail.com>
Message-ID: <4822662F.1020104@gmail.com>

Austin English wrote:
> Howdy,
> 
> Tried compiling wine on Nexenta (Opensolaris kernel with GNU
> userland). Trying to test out the conformance test, but can't get it
> to compile:
> 
> make[2]: Entering directory `/export/home/austin/wine/libs/wpp'
> gcc -c -I. -I. -I../../include -I../../include    -Wall -pipe
> -fno-strict-aliasing -Wdeclaration-after-statement -Wwrite-strings
> -Wpointer-arith  -g -O2  -o preproc.o preproc.c
> gcc -c -I. -I. -I../../include -I../../include    -Wall -pipe
> -fno-strict-aliasing -Wdeclaration-after-statement -Wwrite-strings
> -Wpointer-arith  -g -O2  -o wpp.o wpp.c
> bison  -p ppy_ -o ppy.tab.c -d ppy.y
> make[2]: *** [ppy.tab.h] Broken Pipe
> make[2]: Leaving directory `/export/home/austin/wine/libs/wpp'
> make[1]: *** [wpp] Error 2
> make[1]: Leaving directory `/export/home/austin/wine/libs'
> make: *** [libs] Error 2
> 
> austin at nexenta:~/wine$ bison --version
> bison (GNU Bison) 2.1
> 
> Looking at my feisty box, looks like it's using 2.3. Anyone had
> similar troubles getting wine to compile in 2.1? Google's not turning
> up much, aside from saying get it precompiled...

Do you have m4 installed?

I had a similar problem in 2004, and the reason was bison package
incorrectly not requiring m4 package.

-- 
Anssi Hannula


From m.b.lankhorst at gmail.com  Wed May  7 21:44:49 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 7 May 2008 19:44:49 -0700
Subject: mlang: Make mlang tests pass under windows
In-Reply-To: <36C89DADE671440FB81E650A7EC7D62F@DMITRY>
References: <b130c85e0805071422o4ebc7cfap769f05d66b44a087@mail.gmail.com>
	<36C89DADE671440FB81E650A7EC7D62F@DMITRY>
Message-ID: <b130c85e0805071944k4e757483jef0a061e8cf6be83@mail.gmail.com>

Hello Dmitry,

2008/5/7 Dmitry Timoshkov <dmitry at codeweavers.com>:
> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:
>
>
> > +            /* Not all codepages can be converted to UTF-8 */
> > +            if (cpinfo[i].uiCodePage == 20127 || cpinfo[i].uiCodePage ==
> 28591 || cpinfo[i].uiCodePage == 28605)
> > +                expected = S_FALSE;
> >
>
>  The statement above is not true. The reason for mlang test failures is that
>  apparently mlang in Windows has its own idea of supported locales not
> connected
>  to real kernel32 implementation. I'd leave the tests as they are, there is
>  nothing wrong in them, we can't fix Windows bugs.
I thought the whole points of the tests was to test what wine does compared to
what windows does, if I look at
http://test.winehq.org/data/200805062030/ it fails for pretty much all
windows versions except xp without service pack. I don't see why the
test SHOULDN'T be allowed to return S_FALSE if all recent versions of
windows do.

Cheers,
Maarten.


From m.b.lankhorst at gmail.com  Wed May  7 21:52:45 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 7 May 2008 19:52:45 -0700
Subject: Should winedevice.exe in the end be able to load file system
	drivers as well?
In-Reply-To: <482170F1.3080404@gmail.com>
References: <482170F1.3080404@gmail.com>
Message-ID: <b130c85e0805071952w7093c9fak29066588fc8ed8dd@mail.gmail.com>

Hi Paul,

2008/5/7 Paul Vriens <paul.vriens.wine at gmail.com>:
> Hi,
>
>  The comment in winedevice.exe says "Service process to load a kernel driver".
>
>  But will winedevice.exe in the (far ?) future be the vehicle to load file system
>  drivers as well.
I think the idea of loading filesystem drivers is insane at best,
unless you plan to add a whole vfs layer, or modify the captive driver
(NTFS binary driver loader for the linux kernel) to work on wine. And
even that probably depends on the vfs layer. Feel free to correct me
if I'm wrong.

Cheers,
Maarten.


From dmitry at codeweavers.com  Wed May  7 21:59:15 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 8 May 2008 11:59:15 +0900
Subject: mlang: Make mlang tests pass under windows
References: <b130c85e0805071422o4ebc7cfap769f05d66b44a087@mail.gmail.com><36C89DADE671440FB81E650A7EC7D62F@DMITRY>
	<b130c85e0805071944k4e757483jef0a061e8cf6be83@mail.gmail.com>
Message-ID: <B518885744084E07B71BC333DD710E21@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

>>  The statement above is not true. The reason for mlang test failures is that
>>  apparently mlang in Windows has its own idea of supported locales not
>> connected
>>  to real kernel32 implementation. I'd leave the tests as they are, there is
>>  nothing wrong in them, we can't fix Windows bugs.
> I thought the whole points of the tests was to test what wine does compared to
> what windows does, if I look at
> http://test.winehq.org/data/200805062030/ it fails for pretty much all
> windows versions except xp without service pack. I don't see why the
> test SHOULDN'T be allowed to return S_FALSE if all recent versions of
> windows do.

Then at least try to fix this properly, not hacking the test to simply show
it has passed.

-- 
Dmitry.


From paul.vriens.wine at gmail.com  Thu May  8 01:03:01 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 08 May 2008 08:03:01 +0200
Subject: Should winedevice.exe in the end be able to load file system
	drivers as well?
In-Reply-To: <b130c85e0805071952w7093c9fak29066588fc8ed8dd@mail.gmail.com>
References: <482170F1.3080404@gmail.com>
	<b130c85e0805071952w7093c9fak29066588fc8ed8dd@mail.gmail.com>
Message-ID: <48229795.9080402@gmail.com>

Maarten Lankhorst wrote:
> Hi Paul,
> 
> 2008/5/7 Paul Vriens <paul.vriens.wine at gmail.com>:
>> Hi,
>>
>>  The comment in winedevice.exe says "Service process to load a kernel driver".
>>
>>  But will winedevice.exe in the (far ?) future be the vehicle to load file system
>>  drivers as well.
> I think the idea of loading filesystem drivers is insane at best,
> unless you plan to add a whole vfs layer, or modify the captive driver
> (NTFS binary driver loader for the linux kernel) to work on wine. And
> even that probably depends on the vfs layer. Feel free to correct me
> if I'm wrong.
> 
> Cheers,
> Maarten.
> 
It's not so much that I want the driver to actually work :-).

I was experimenting with Mozy backup (http://mozy.com/) with respect to bug 
12030 (http://bugs.winehq.org/show_bug.cgi?id=12030).

Installation stalls when the file system driver is installed. Changing 
services.exe to route this driver via winedevice makes the installer work 
"normal" but crashes (of course?) the driver.

When I then remove the patch from services.exe and try to start anything I see a 
1 minute delay in execution. This is due to us trying to launch the driver 
(without winedevice) and sending a start control to it. It looks like this 
introduces a timeout.

So again, I'm not trying to get this driver running but want to get rid of that 
timeout.

-- 
Cheers,

Paul.


From dmitry at codeweavers.com  Thu May  8 01:16:18 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 8 May 2008 15:16:18 +0900
Subject: mlang: Fix some more tests to pass under windows, try 2
References: <b130c85e0805072225t5815a5dckf45eed8620a71e6@mail.gmail.com>
Message-ID: <3A1DAED911894814AB75689BAEF5E88A@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

> It disallows certain conversions now.

Please don't commit this and other mlang related patches,
they are wrong.

Maarten, if your only intent is to show clean results under
test.winehq.org that's not worth an effort without at least
understanding why the test fails and what might be a proper
fix for each failure.

-- 
Dmitry.


From tehblunderbuss at gmail.com  Thu May  8 01:22:13 2008
From: tehblunderbuss at gmail.com (TheBlunderbuss)
Date: Thu, 08 May 2008 01:22:13 -0500
Subject: Deprecated sound functions
Message-ID: <48229C15.9030901@gmail.com>

During the day's compile, I noticed some functions were declared 
deprecated, mainly in sound components.
I logged more context, if anyone needs it.

alsa.c:738: warning: ?snd_pcm_hw_params_get_tick_time? is deprecated 
(declared at /usr/include/alsa/pcm.h:1108)
alsa.c:738: warning: ?snd_pcm_hw_params_get_tick_time_min? is deprecated 
(declared at /usr/include/alsa/pcm.h:1109)
alsa.c:738: warning: ?snd_pcm_hw_params_get_tick_time_max? is deprecated 
(declared at /usr/include/alsa/pcm.h:1110)
dscapture.c:451: warning: ?snd_pcm_sw_params_set_xrun_mode? is 
deprecated (declared at /usr/include/alsa/pcm.h:1101)
dsoutput.c:213: warning: ?snd_pcm_sw_params_set_xrun_mode? is deprecated 
(declared at /usr/include/alsa/pcm.h:1101)
wavein.c:486: warning: ?snd_pcm_sw_params_set_xfer_align? is deprecated 
(declared at /usr/include/alsa/pcm.h:1104)
waveout.c:762: warning: ?snd_pcm_sw_params_set_xfer_align? is deprecated 
(declared at /usr/include/alsa/pcm.h:1104)
waveout.c:764: warning: ?snd_pcm_sw_params_set_xrun_mode? is deprecated 
(declared at /usr/include/alsa/pcm.h:1101)


From julliard at winehq.org  Thu May  8 04:31:05 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 08 May 2008 11:31:05 +0200
Subject: ntdll: Fix RtlIntegerToUnicodeString so it won't overflow
In-Reply-To: <b130c85e0805071135g1381f39asffb0c57d49bf9239@mail.gmail.com>
	(Maarten Lankhorst's message of "Wed, 7 May 2008 11:35:32 -0700")
References: <b130c85e0805071135g1381f39asffb0c57d49bf9239@mail.gmail.com>
Message-ID: <87ve1pkuqu.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> @@ -1970,7 +1970,7 @@ NTSTATUS WINAPI RtlIntegerToUnicodeString(
>      } while (value != 0L);
>  
>      str->Length = (&buffer[32] - pos) * sizeof(WCHAR);
> -    if (str->Length >= str->MaximumLength) {
> +    if (str->Length + sizeof(WCHAR) >= str->MaximumLength) {
>  	return STATUS_BUFFER_OVERFLOW;
>      } else {
>  	memcpy(str->Buffer, pos, str->Length + sizeof(WCHAR));

There's no overflow here. The Windows implementation of
RtlIntegerToUnicodeString seems badly confused but I don't think
we need to replicate those bugs.

-- 
Alexandre Julliard
julliard at winehq.org


From mike.kronenberg at kronenberg.org  Thu May  8 04:17:28 2008
From: mike.kronenberg at kronenberg.org (Mike Kronenberg)
Date: Thu, 8 May 2008 11:17:28 +0200
Subject: winetricks missing MFC42
In-Reply-To: <a71bd89a0805071623s32f0f2e9of96d465713c219a1@mail.gmail.com>
References: <a71bd89a0805071043q7c61caf2x2429f0d18f7a097c@mail.gmail.com>
	<e3d3ae8f0805071232v99fd6c1u5d93a5a503cdc6ad@mail.gmail.com>
	<a71bd89a0805071234i5e9ed7eu63f85567d1f157a@mail.gmail.com>
	<48223130.5030305@kievinfo.com>
	<a71bd89a0805071623s32f0f2e9of96d465713c219a1@mail.gmail.com>
Message-ID: <EE718081-2BF4-4953-92EB-04FC86A20AEB@kronenberg.org>


On 08.05.2008, at 01:23, Dan Kegel wrote:

> On Wed, May 7, 2008 at 3:46 PM, Vitaliy Margolen
> <wine-devel at kievinfo.com> wrote:
>> Dan that's going way overboard. You creating another winedoors or  
>> worse
>> winetools.
>>
>> Original idea of having few dlls and registry changes in one place  
>> - was
>> great. So no one would need to repeat those instructions over and  
>> over
>> again. But having windows media player?! Now list of all windows  
>> dlls that
>> some users will install just in case.
>
> No, no, no.  Only mfc42 and other really common ones.
> I promise I won't go crazy.
>
> And it's not winedoors - it's just a shell script without any
> delusions of grandeur.

Why not having a little windows app/gui for the script, instead of  
having ten guis for all sorts of OS / Windowmanagers ?

Mike


From vitperov at etersoft.ru  Thu May  8 08:23:42 2008
From: vitperov at etersoft.ru (Vitaly Perov)
Date: Thu, 8 May 2008 17:23:42 +0400
Subject: [PATCH] cmd.exe: MSI packages execution implemented
In-Reply-To: <482096AE.5050004@kievinfo.com>
References: <200805062114.26118.vitperov@etersoft.ru>
	<482096AE.5050004@kievinfo.com>
Message-ID: <200805081723.43687.vitperov@etersoft.ru>

Vitaliy Margolen wrote:
> Vitaly Perov wrote:
> > Changelog:  cmd.exe: MSI packages execution implemented
>
> That doesn't look right. You sure this information is hard-coded into
> cmd.exe and it's not coming from the registry CLASSES hive?
>
> Vitaliy

I haven't found any information about how it implemented in Windows. I use the 
similar *.com and *.bat way of execution *.msi. I don't sure, that it is 
correct, but it works!
I'll be grateful if you have any information/links about how it should work


-- 
Best wishes,
Vitaly Perov
Russia, Saint-Petersburg. www.etersoft.ru


From paul.vriens.wine at gmail.com  Thu May  8 10:16:14 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 08 May 2008 17:16:14 +0200
Subject: winetest reports shows a lot of "debugger.c:185:debugger: done
	debugging..."
Message-ID: <4823193E.4040808@gmail.com>

Hi,

On test.winehq.org one can see that both the W98 and the NT4 reports show a lot 
of the mentioned lines.

For example : http://test.winehq.org/data/200805081000/95_W95/report

Any idea where these are coming from? They weren't there before (AFAIK).

-- 
Cheers,

Paul.


From pnilsson at nullref.se  Thu May  8 12:33:49 2008
From: pnilsson at nullref.se (Philip Nilsson)
Date: Thu, 8 May 2008 19:33:49 +0200
Subject: Review request: real async for GetAsyncKeyState (bug #5623)
In-Reply-To: <14b026160805071149m791a2c01x12ab65c08dc2573e@mail.gmail.com>
References: <14b026160805071149m791a2c01x12ab65c08dc2573e@mail.gmail.com>
Message-ID: <20080508173349.GA5963@zorkmid.localnetwork>

On Wed, May 07, 2008 at 08:49:34PM +0200, Rafa? Mi?ecki wrote:
> Hi,
> 
> This is my first wine patch and fix for bug #5623. This was tested and
> works fine however I suspect this is not clean enought for commiting
> to master.
> 
> -- 
> Rafa? Mi?ecki

Applying this patch causes my Wine to fail with: (the second time, as it
runs some font metric stuff once first)

	err:process:start_wineboot failed to create wineboot event, expect trouble
	err:font:WineEngInit Failed to create font mutex
	err:system:get_volatile_regkey Can't create wine registry branch
	err:system:get_volatile_regkey Can't create wine registry branch
	err:system:get_volatile_regkey Can't create wine registry branch
	err:system:get_volatile_regkey Can't create wine registry branch
	err:system:get_volatile_regkey Can't create wine registry branch
	err:system:get_volatile_regkey Can't create wine registry branch
	err:rpc:DllMain Failed to create master mutex
	err:winecfg:initialize RegOpenKey failed on wine config key (6)
	err:winecfg:WinMain initialization failed, aborting

I assumed this was due to something that didn't recompile, but I made
the tree clean and reconfigured it, and compiled again.  No change.

I will investigate a bit further as this patch might be useful for an
application I have some problems with (I think it uses GetAsyncKeyState
for modifiers).

-- 
Philip Nilsson


From m.b.lankhorst at gmail.com  Thu May  8 12:38:43 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 8 May 2008 10:38:43 -0700
Subject: winetest reports shows a lot of "debugger.c:185:debugger: done
	debugging..."
In-Reply-To: <4823193E.4040808@gmail.com>
References: <4823193E.4040808@gmail.com>
Message-ID: <b130c85e0805081038n4d7670f4g45e6e290e54f1ffa@mail.gmail.com>

Hello Paul,

2008/5/8 Paul Vriens <paul.vriens.wine at gmail.com>:
> Hi,
>
>  On test.winehq.org one can see that both the W98 and the NT4 reports show a lot
>  of the mentioned lines.
>
>  For example : http://test.winehq.org/data/200805081000/95_W95/report
>
>  Any idea where these are coming from? They weren't there before (AFAIK).
It means the test has crashed and the debugger was called. It looks
like the source of this is kernel32/tests/debugger.c

It wasn't there before because the test would hang while trying to
call that debugger.

Cheers,
Maarten.


From m.b.lankhorst at gmail.com  Thu May  8 13:00:25 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 8 May 2008 11:00:25 -0700
Subject: ntdll: Fix RtlIntegerToUnicodeString so it won't overflow
In-Reply-To: <87ve1pkuqu.fsf@wine.dyndns.org>
References: <b130c85e0805071135g1381f39asffb0c57d49bf9239@mail.gmail.com>
	<87ve1pkuqu.fsf@wine.dyndns.org>
Message-ID: <b130c85e0805081100g2b47f1c8w2fdc820f2692c908@mail.gmail.com>

Hello Alexandre,

2008/5/8 Alexandre Julliard <julliard at winehq.org>:
> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:
>
>  > @@ -1970,7 +1970,7 @@ NTSTATUS WINAPI RtlIntegerToUnicodeString(
>  >      } while (value != 0L);
>  >
>  >      str->Length = (&buffer[32] - pos) * sizeof(WCHAR);
>  > -    if (str->Length >= str->MaximumLength) {
>  > +    if (str->Length + sizeof(WCHAR) >= str->MaximumLength) {
>  >       return STATUS_BUFFER_OVERFLOW;
>  >      } else {
>  >       memcpy(str->Buffer, pos, str->Length + sizeof(WCHAR));
>
>  There's no overflow here. The Windows implementation of
>  RtlIntegerToUnicodeString seems badly confused but I don't think
>  we need to replicate those bugs.

It copies str->Length + sizeof(WCHAR) to the destination buffer
according to james' testcases. So it definitely looks like a bug to me
if it would copy data beyond MaximumLength, since only up to
MaximumLength is guaranteed to be allocated. Of course you're right
that my fix is likely wrong, the >= max should probablly be changed to
> max, otherwise it would return STATUS_BUFFER_OVERFLOW wrongly.

Cheers,
Maarten.


From truiken at gmail.com  Thu May  8 13:02:33 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 8 May 2008 13:02:33 -0500
Subject: ntdll: Fix RtlIntegerToUnicodeString so it won't overflow
In-Reply-To: <b130c85e0805081100g2b47f1c8w2fdc820f2692c908@mail.gmail.com>
References: <b130c85e0805071135g1381f39asffb0c57d49bf9239@mail.gmail.com>
	<87ve1pkuqu.fsf@wine.dyndns.org>
	<b130c85e0805081100g2b47f1c8w2fdc820f2692c908@mail.gmail.com>
Message-ID: <22821af30805081102m1a40bfc1y3cc2a86a51454668@mail.gmail.com>

On Thu, May 8, 2008 at 1:00 PM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Hello Alexandre,
>
> 2008/5/8 Alexandre Julliard <julliard at winehq.org>:
>> "Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:
>>
>>  > @@ -1970,7 +1970,7 @@ NTSTATUS WINAPI RtlIntegerToUnicodeString(
>>  >      } while (value != 0L);
>>  >
>>  >      str->Length = (&buffer[32] - pos) * sizeof(WCHAR);
>>  > -    if (str->Length >= str->MaximumLength) {
>>  > +    if (str->Length + sizeof(WCHAR) >= str->MaximumLength) {
>>  >       return STATUS_BUFFER_OVERFLOW;
>>  >      } else {
>>  >       memcpy(str->Buffer, pos, str->Length + sizeof(WCHAR));
>>
>>  There's no overflow here. The Windows implementation of
>>  RtlIntegerToUnicodeString seems badly confused but I don't think
>>  we need to replicate those bugs.
>
> It copies str->Length + sizeof(WCHAR) to the destination buffer
> according to james' testcases.

No, the length is indeterminate.

> So it definitely looks like a bugto me
> if it would copy data beyond MaximumLength, since only up to
> MaximumLength is guaranteed to be allocated. Of course you're right
> that my fix is likely wrong, the >= max should probablly be changed to
>> max, otherwise it would return STATUS_BUFFER_OVERFLOW wrongly.
>
> Cheers,
> Maarten.
>



-- 
James Hawkins


From r.kalbermatter at hccnet.nl  Thu May  8 13:07:55 2008
From: r.kalbermatter at hccnet.nl (Rolf Kalbermatter)
Date: Thu, 8 May 2008 20:07:55 +0200
Subject: [PATCH] cmd.exe: MSI packages execution implemented
In-Reply-To: <200805081723.43687.vitperov@etersoft.ru>
References: <200805062114.26118.vitperov@etersoft.ru><482096AE.5050004@kievinfo.com>
	<200805081723.43687.vitperov@etersoft.ru>
Message-ID: <927334F0F8D843ECB207AC57162D5E43@NATERS>

Vitaly Perov [mailto:vitperov at etersoft.ru] wrote:

> I haven't found any information about how it implemented in 
> Windows. I use the similar *.com and *.bat way of execution 
> *.msi. I don't sure, that it is correct, but it works!
> I'll be grateful if you have any information/links about how 
> it should work

What about the normal Windows file extension registry?

HKCR\.msi                            REG_SZ         Msi.Package
HKCR\Msi.Package                     REG_SZ         Windows Installer
Package
HKCR\Msi.Package EditFlags           REG_BINARY     00 00 00 01
HKCR\Msi.Package FriendlyTypeName    REG_EXPAND_SZ
@%SystemRoot%\System32\msi.dll,-34
HKCR\Msi.Package\DefaultIcon         REG_SZ
C:\WINDOWS\system32\msiexec.exe,0
HKCR\Msi.Package\shell               REG_SZ         Open,Repair,Uninstall

This for Install:

HKCR\Msi.Package\shell\Open          REG_SZ         &Install
HKCR\Msi.Package\shell\Open MUIVerb  REG_EXAPND_SZ
@%SystemRoot%\System32\msi.dll,-36
HKCR\Msi.Package\shell\Open\command  REG_EXPAND_SZ
"%SystemRoot%\System32\msiexec.exe" /i "%1" %*

And similar for Repair and Uninstall!

I would think that at some point cmd.exe just should call ShellExecuteEx for
file types
it doesn't know about and get the registry handling for free in that way.
Possibly the
import of shell32 would need to be done dynamically or delayed in that case.

Rolf Kalbermatter



From dank at kegel.com  Thu May  8 13:41:35 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 8 May 2008 11:41:35 -0700
Subject: ntdll: Fix RtlIntegerToUnicodeString so it won't overflow
Message-ID: <a71bd89a0805081141h5db151f7yf14d4a5bb750f89f@mail.gmail.com>

James wrote:
> > It copies str->Length + sizeof(WCHAR) to the destination buffer
> > according to james' testcases.
>
> No, the length is indeterminate.

Oh, is that the test that checks whether not double-null terminating
works?  I think that test needs rewriting to be determinate...
e.g. by putting in a list that has known bad (but properly terminated)
elements after the nominal end, and making sure the bad part
doesn't get processed... or something...


From truiken at gmail.com  Thu May  8 14:56:03 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 8 May 2008 14:56:03 -0500
Subject: ntdll: Fix RtlIntegerToUnicodeString so it won't overflow
In-Reply-To: <a71bd89a0805081141h5db151f7yf14d4a5bb750f89f@mail.gmail.com>
References: <a71bd89a0805081141h5db151f7yf14d4a5bb750f89f@mail.gmail.com>
Message-ID: <22821af30805081256s26d6dbbai78092b74a9be63bb@mail.gmail.com>

On Thu, May 8, 2008 at 1:41 PM, Dan Kegel <dank at kegel.com> wrote:
> James wrote:
>> > It copies str->Length + sizeof(WCHAR) to the destination buffer
>> > according to james' testcases.
>>
>> No, the length is indeterminate.
>
> Oh, is that the test that checks whether not double-null terminating
> works?  I think that test needs rewriting to be determinate...
> e.g. by putting in a list that has known bad (but properly terminated)
> elements after the nominal end, and making sure the bad part
> doesn't get processed... or something...
>

No, this is a different test.

-- 
James Hawkins


From julliard at winehq.org  Thu May  8 15:24:34 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 08 May 2008 22:24:34 +0200
Subject: ntdll: Fix RtlIntegerToUnicodeString so it won't overflow
In-Reply-To: <b130c85e0805081100g2b47f1c8w2fdc820f2692c908@mail.gmail.com>
	(Maarten Lankhorst's message of "Thu, 8 May 2008 11:00:25 -0700")
References: <b130c85e0805071135g1381f39asffb0c57d49bf9239@mail.gmail.com>
	<87ve1pkuqu.fsf@wine.dyndns.org>
	<b130c85e0805081100g2b47f1c8w2fdc820f2692c908@mail.gmail.com>
Message-ID: <87ej8clf25.fsf@wine.dyndns.org>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> writes:

> It copies str->Length + sizeof(WCHAR) to the destination buffer
> according to james' testcases. So it definitely looks like a bug to me
> if it would copy data beyond MaximumLength, since only up to
> MaximumLength is guaranteed to be allocated. Of course you're right
> that my fix is likely wrong, the >= max should probablly be changed to
>> max, otherwise it would return STATUS_BUFFER_OVERFLOW wrongly.

And that's exactly what the existing code is doing (except if
MaximumLength is odd but that makes no sense for a WCHAR buffer).

-- 
Alexandre Julliard
julliard at winehq.org


From m.b.lankhorst at gmail.com  Thu May  8 16:06:50 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 8 May 2008 14:06:50 -0700
Subject: Wine t-shirts?
In-Reply-To: <481B0A16.1050409@codeweavers.com>
References: <a71bd89a0804230443w3240caf7v46108219330713af@mail.gmail.com>
	<480F2E38.7010506@winehq.org>
	<b130c85e0804301730m286189fbsf6a837ef97d335d3@mail.gmail.com>
	<4819B052.3010808@codeweavers.com>
	<b130c85e0805012154r59d66199qcfdfeb63df88b6ea@mail.gmail.com>
	<481B0A16.1050409@codeweavers.com>
Message-ID: <b130c85e0805081406xf86434dj1cd20807748735ac@mail.gmail.com>

Hi all,

2008/5/2 Jeremy Newman <jnewman at codeweavers.com>:
> ftp://wine.codeweavers.com/pub/wine/logos/
>
> Maarten Lankhorst wrote:
>>
>> Hello Jeremy,
>>
>> 2008/5/1 Jeremy Newman <jnewman at codeweavers.com>:
>>>
>>> Sure, I will put up an archive of our Penguin EPS files later today
>>> somewhere. Probably on our FTP site.
>>
>> Did you upload it yet?
>>
>> Cheers,
>> Maarten.
>>
>>
>
I made some impression of how I want it to roughly look, my photoshop
skills aren't that great so if someone wants to tweak it slightly to
look better then it does now it would be greatly appreciated.

It's at: http://cross-lfs.org/~mlankhorst/t-shirt.png

I also would like to put a cork in front of the wine bottle, but I'll
work on that later. Just wondering what people think of this.

If you can make the wine bottle looking better it would be greatly appreciated!

Cheers,
Maarten.


From m.b.lankhorst at gmail.com  Thu May  8 16:17:51 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 8 May 2008 14:17:51 -0700
Subject: inetmib1(0/15)
In-Reply-To: <3a768c550805080813y399340a9pc691b31ce9b08f5@mail.gmail.com>
References: <3a768c550805080813y399340a9pc691b31ce9b08f5@mail.gmail.com>
Message-ID: <b130c85e0805081417o67b7fcdfg9bb3b6afa2e4dd86@mail.gmail.com>

Hello Juan,

2008/5/8 Juan Lang <juan.lang at gmail.com>:
> This series of patches implements the inetmib1 dll, mainly to fix bug 13004.

I don't see any testcases? With the code freeze I think it is best to
add them since it will have more chance of getting accepted. I don't
know if it's a good idea otherwise to add code at this point in code
freeze.

Cheers,
Maarten.


From juan.lang at gmail.com  Thu May  8 16:21:19 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 8 May 2008 14:21:19 -0700
Subject: inetmib1(0/15)
In-Reply-To: <b130c85e0805081417o67b7fcdfg9bb3b6afa2e4dd86@mail.gmail.com>
References: <3a768c550805080813y399340a9pc691b31ce9b08f5@mail.gmail.com>
	<b130c85e0805081417o67b7fcdfg9bb3b6afa2e4dd86@mail.gmail.com>
Message-ID: <3a768c550805081421i2d18ca67k143f7a0186cd9d73@mail.gmail.com>

Hi Maarten,

> I don't see any testcases? With the code freeze I think it is best to
> add them since it will have more chance of getting accepted. I don't
> know if it's a good idea otherwise to add code at this point in code
> freeze.

I know about the freeze, and I'll resend if I have to.  It didn't make
sense to me to have too many patches pile up in my tree, either.

Testcases:  yes, it needs some, though the coverage will necessarily
be rather poor, as we can't make any assumptions about the test
machine's network configuration.  So error condition checking needs to
be done, but "expected behavior" can't be tested with test cases.  I
tested the app, and it works with the patches.
--Juan


From juan.lang at gmail.com  Thu May  8 16:21:19 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 8 May 2008 14:21:19 -0700
Subject: inetmib1(0/15)
In-Reply-To: <b130c85e0805081417o67b7fcdfg9bb3b6afa2e4dd86@mail.gmail.com>
References: <3a768c550805080813y399340a9pc691b31ce9b08f5@mail.gmail.com>
	<b130c85e0805081417o67b7fcdfg9bb3b6afa2e4dd86@mail.gmail.com>
Message-ID: <3a768c550805081421i2d18ca67k143f7a0186cd9d73@mail.gmail.com>

Hi Maarten,

> I don't see any testcases? With the code freeze I think it is best to
> add them since it will have more chance of getting accepted. I don't
> know if it's a good idea otherwise to add code at this point in code
> freeze.

I know about the freeze, and I'll resend if I have to.  It didn't make
sense to me to have too many patches pile up in my tree, either.

Testcases:  yes, it needs some, though the coverage will necessarily
be rather poor, as we can't make any assumptions about the test
machine's network configuration.  So error condition checking needs to
be done, but "expected behavior" can't be tested with test cases.  I
tested the app, and it works with the patches.
--Juan


From mstefani at redhat.com  Thu May  8 16:21:46 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 08 May 2008 23:21:46 +0200
Subject: Deprecated sound functions
In-Reply-To: <48229C15.9030901@gmail.com>
References: <48229C15.9030901@gmail.com>
Message-ID: <48236EEA.3020004@redhat.com>

TheBlunderbuss wrote:
> During the day's compile, I noticed some functions were declared 
> deprecated, mainly in sound components.
> I logged more context, if anyone needs it.
This is known. But the ALSA functions were only recently deprecated,
e.g. Fedora 8 doesn't show them but F9 does.

> alsa.c:738: warning: ?snd_pcm_hw_params_get_tick_time? is deprecated 
> (declared at /usr/include/alsa/pcm.h:1108)
> alsa.c:738: warning: ?snd_pcm_hw_params_get_tick_time_min? is deprecated 
> (declared at /usr/include/alsa/pcm.h:1109)
> alsa.c:738: warning: ?snd_pcm_hw_params_get_tick_time_max? is deprecated 
> (declared at /usr/include/alsa/pcm.h:1110)
> dscapture.c:451: warning: ?snd_pcm_sw_params_set_xrun_mode? is 
> deprecated (declared at /usr/include/alsa/pcm.h:1101)
> dsoutput.c:213: warning: ?snd_pcm_sw_params_set_xrun_mode? is deprecated 
> (declared at /usr/include/alsa/pcm.h:1101)
> wavein.c:486: warning: ?snd_pcm_sw_params_set_xfer_align? is deprecated 
> (declared at /usr/include/alsa/pcm.h:1104)
> waveout.c:762: warning: ?snd_pcm_sw_params_set_xfer_align? is deprecated 
> (declared at /usr/include/alsa/pcm.h:1104)
> waveout.c:764: warning: ?snd_pcm_sw_params_set_xrun_mode? is deprecated 
> (declared at /usr/include/alsa/pcm.h:1101)
> 
> 

bye
	michael


From m.b.lankhorst at gmail.com  Thu May  8 16:31:35 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 8 May 2008 14:31:35 -0700
Subject: Wine t-shirts?
In-Reply-To: <33F6268AA99B6C448F07F03B2B6497D3093635@taz.CodeWeavers.local>
References: <a71bd89a0804230443w3240caf7v46108219330713af@mail.gmail.com>
	<480F2E38.7010506@winehq.org>
	<b130c85e0804301730m286189fbsf6a837ef97d335d3@mail.gmail.com>
	<4819B052.3010808@codeweavers.com>
	<b130c85e0805012154r59d66199qcfdfeb63df88b6ea@mail.gmail.com>
	<481B0A16.1050409@codeweavers.com>
	<b130c85e0805081406xf86434dj1cd20807748735ac@mail.gmail.com>
	<33F6268AA99B6C448F07F03B2B6497D3093635@taz.CodeWeavers.local>
Message-ID: <b130c85e0805081431m782693cape88140ae722ca50@mail.gmail.com>

Hello Jon,

2008/5/8 Jon Parshall <jparshall at codeweavers.com>:
> I've messed around with Wine Bottles for our installer artwork, and I have this version that I could gussy up for the shirts if you'd like.
I like the most left bottle, can you make one in the reddish color
wine uses? And put the label I created on it and get it roughly in the
same size? It would be perfect for the t-shirt.

Cheers,
Maarten.


From m.b.lankhorst at gmail.com  Thu May  8 16:32:16 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 8 May 2008 14:32:16 -0700
Subject: Wine t-shirts?
In-Reply-To: <b130c85e0805081431m782693cape88140ae722ca50@mail.gmail.com>
References: <a71bd89a0804230443w3240caf7v46108219330713af@mail.gmail.com>
	<480F2E38.7010506@winehq.org>
	<b130c85e0804301730m286189fbsf6a837ef97d335d3@mail.gmail.com>
	<4819B052.3010808@codeweavers.com>
	<b130c85e0805012154r59d66199qcfdfeb63df88b6ea@mail.gmail.com>
	<481B0A16.1050409@codeweavers.com>
	<b130c85e0805081406xf86434dj1cd20807748735ac@mail.gmail.com>
	<33F6268AA99B6C448F07F03B2B6497D3093635@taz.CodeWeavers.local>
	<b130c85e0805081431m782693cape88140ae722ca50@mail.gmail.com>
Message-ID: <b130c85e0805081432y5244a667n8494983ca0cc8bc2@mail.gmail.com>

2008/5/8 Maarten Lankhorst <m.b.lankhorst at gmail.com>:
> 2008/5/8 Jon Parshall <jparshall at codeweavers.com>:
>> I've messed around with Wine Bottles for our installer artwork, and I have this version that I could gussy up for the shirts if you'd like.
> I like the most left bottle, can you make one in the reddish color
> wine uses? And put the label I created on it and get it roughly in the
> same size? It would be perfect for the t-shirt.
Uncorked, since wine will be released. :D


From m.b.lankhorst at gmail.com  Thu May  8 17:28:39 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 8 May 2008 15:28:39 -0700
Subject: [1/3] gdiplus: GdipGetImageFlags (bug 12144)
In-Reply-To: <1210284917.2885.8.camel@debian.localdomain>
References: <1210284917.2885.8.camel@debian.localdomain>
Message-ID: <b130c85e0805081528n5995c37ctdae6e84e4a6c4eaf@mail.gmail.com>

Hello Nikolay,

2008/5/8 Nikolay Sivov <bunglehead at gmail.com>:
> Changelog:
>    - simple implementation of GdipGetImageFlags
>
> ---
>  dlls/gdiplus/gdiplus.spec      |    2 +-
>  dlls/gdiplus/gdiplus_private.h |    1 +
>  dlls/gdiplus/image.c           |   11 +++++++++++
>  include/gdiplusenums.h         |   25 ++++++++++++++++++++++---
>  include/gdiplusflat.h          |    1 +
>  5 files changed, 36 insertions(+), 4 deletions(-)
It's better to send changes to the wine headers in wine/include/
separately, and to add accompanying testcases when adding new
functions. This allows us to verify changes more easy. It's a bit more
work in the short run, but saves time in the long run.

Cheers,
Maarten.


From juan.lang at gmail.com  Thu May  8 17:39:48 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 8 May 2008 15:39:48 -0700
Subject: [3/3] gdiplus: GdipCreateFromHWNDICM (bug 12185)
Message-ID: <3a768c550805081539r7b58b76l5761ca55d2d5aeed@mail.gmail.com>

You appear to have sent the wrong patch for this one.
--Juan


From juan.lang at gmail.com  Thu May  8 17:39:48 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 8 May 2008 15:39:48 -0700
Subject: [3/3] gdiplus: GdipCreateFromHWNDICM (bug 12185)
Message-ID: <3a768c550805081539r7b58b76l5761ca55d2d5aeed@mail.gmail.com>

You appear to have sent the wrong patch for this one.
--Juan


From jparshall at codeweavers.com  Thu May  8 16:23:26 2008
From: jparshall at codeweavers.com (Jon Parshall)
Date: Thu, 8 May 2008 16:23:26 -0500
Subject: Wine t-shirts?
References: <a71bd89a0804230443w3240caf7v46108219330713af@mail.gmail.com>
	<480F2E38.7010506@winehq.org>
	<b130c85e0804301730m286189fbsf6a837ef97d335d3@mail.gmail.com>
	<4819B052.3010808@codeweavers.com>
	<b130c85e0805012154r59d66199qcfdfeb63df88b6ea@mail.gmail.com>
	<481B0A16.1050409@codeweavers.com>
	<b130c85e0805081406xf86434dj1cd20807748735ac@mail.gmail.com>
Message-ID: <33F6268AA99B6C448F07F03B2B6497D3093635@taz.CodeWeavers.local>

I've messed around with Wine Bottles for our installer artwork, and I have this version that I could gussy up for the shirts if you'd like.

Cheers,

-jon parshall-
COO
CodeWeavers

> -----Original Message-----
> From: Maarten Lankhorst [mailto:m.b.lankhorst at gmail.com]
> Sent: Thursday, May 08, 2008 4:07 PM
> To: Jeremy Newman
> Cc: Jeremy White; Wine Developers List; Dan Kegel
> Subject: Re: Wine t-shirts?
> 
> Hi all,
> 
> 2008/5/2 Jeremy Newman <jnewman at codeweavers.com>:
> > ftp://wine.codeweavers.com/pub/wine/logos/
> >
> > Maarten Lankhorst wrote:
> >>
> >> Hello Jeremy,
> >>
> >> 2008/5/1 Jeremy Newman <jnewman at codeweavers.com>:
> >>>
> >>> Sure, I will put up an archive of our Penguin EPS files later today
> >>> somewhere. Probably on our FTP site.
> >>
> >> Did you upload it yet?
> >>
> >> Cheers,
> >> Maarten.
> >>
> >>
> >
> I made some impression of how I want it to roughly look, my photoshop
> skills aren't that great so if someone wants to tweak it slightly to
> look better then it does now it would be greatly appreciated.
> 
> It's at: http://cross-lfs.org/~mlankhorst/t-shirt.png
> 
> I also would like to put a cork in front of the wine bottle, but I'll
> work on that later. Just wondering what people think of this.
> 
> If you can make the wine bottle looking better it would be greatly
> appreciated!
> 
> Cheers,
> Maarten.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: WineBottles.png
Type: image/png
Size: 171335 bytes
Desc: WineBottles.png
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080508/5cbd2829/attachment-0001.png 

From m.b.lankhorst at gmail.com  Thu May  8 17:49:25 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 8 May 2008 15:49:25 -0700
Subject: [1/3] gdiplus: GdipGetImageFlags (bug 12144)
In-Reply-To: <4823801D.1070008@gmail.com>
References: <1210284917.2885.8.camel@debian.localdomain>
	<b130c85e0805081528n5995c37ctdae6e84e4a6c4eaf@mail.gmail.com>
	<4823801D.1070008@gmail.com>
Message-ID: <b130c85e0805081549q5cca0d2fl163336b397ddc2a8@mail.gmail.com>

Hello Nikolay,

2008/5/8 Nikolay Sivov <bunglehead at gmail.com>:
> Maarten Lankhorst wrote:
>>
>> Hello Nikolay,
>>
>> 2008/5/8 Nikolay Sivov <bunglehead at gmail.com>:
>>
>>>
>>> Changelog:
>>>   - simple implementation of GdipGetImageFlags
>>>
>>> ---
>>>  dlls/gdiplus/gdiplus.spec      |    2 +-
>>>  dlls/gdiplus/gdiplus_private.h |    1 +
>>>  dlls/gdiplus/image.c           |   11 +++++++++++
>>>  include/gdiplusenums.h         |   25 ++++++++++++++++++++++---
>>>  include/gdiplusflat.h          |    1 +
>>>  5 files changed, 36 insertions(+), 4 deletions(-)
>>>
>>
>> It's better to send changes to the wine headers in wine/include/
>> separately, and to add accompanying testcases when adding new
>> functions. This allows us to verify changes more easy. It's a bit more
>> work in the short run, but saves time in the long run.
>>
>> Cheers,
>> Maarten.
>>
>>
>
> You're right of course (about tests). But it isn't that case:
> GdipGetImageFlags just get a member, no more than a return.
> So test for it is a redundant (at actual level of gdiplus.dll
> implementation).
You can still see what happens if you pass it null as argument, what
flags are invalid, etc.

Cheers,
Maarten.


From xixsimplicityxix at gmail.com  Fri May  9 00:50:30 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 9 May 2008 00:50:30 -0500
Subject: Fixing wintab window messaging, bug 11846. Requesting review
Message-ID: <78a7dad00805082250n4ed6963clda4aec60c0d8efdf@mail.gmail.com>

Hey,

Well I'm trying to nail down why sai paint tool isn't doing its
pressure stuff and I think this is starting down the right track but I
wanted to get some input from those more familiar with wine messaging
and x11 events.

Without the first patch sai can't find an x11 window to attach too and
doesn't have any shot at all at getting pressure events from x11.

After that patch is applied it attaches to an x11 window but then
doesn't pass the information back to the child window that the wintab
context was created in.  The second patch implements an
EnumChildWindows callback function in order to get it back to the
child window.

I'm asking for this review as while the above works to get the
pressure events flowing I'm not sure if its the appropriate way to go.
 I believe these patches are on the path to fix
http://bugs.winehq.org/show_bug.cgi?id=11846

Thanks,

John Klehm
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 0001-winex11.drv-Search-more-thoroughly-for-the-pare.patch.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080509/1478c31f/attachment.txt 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 0002-wintab32-Add-messaging-support-for-wintab-child.patch.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080509/1478c31f/attachment-0001.txt 

From dank at kegel.com  Fri May  9 05:18:26 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 9 May 2008 03:18:26 -0700
Subject: mono progress on mixed-mode assemblies...
Message-ID: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>

http://lists.ximian.com/pipermail/mono-devel-list/2008-May/027767.html
shows that P?l Korn?l is now working on supporting apps
that use msvcrt.

Go Pal go!


From kornelpal at gmail.com  Fri May  9 06:21:06 2008
From: kornelpal at gmail.com (=?iso-8859-1?B?S29ybulsIFDhbA==?=)
Date: Fri, 9 May 2008 13:21:06 +0200
Subject: mono progress on mixed-mode assemblies...
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
Message-ID: <002001c8b1c6$c6fa6a00$83666250@kornelpal.hu>

Hi,

I am working on it but seems to be a longer process because MSVCRT depends 
on a lot of undocumented characteristics of the MS implementation of .NET 
Framework and documented functionality that is not used outside of C++ (so 
isn't implementet by Mono).

If you know real world applications using mixed-mode assemblies please let 
me know because I am currently using only simple "Hello World"-like 
programs. Currently I only want to make them work with Mono but later I'll 
need real world apps for testing.

Currently it's very unlikely that Mono will have it's own MSVCRTs (I mean 
mixed-mode versions) in the near future. Do you know whether they are 
redistributable?

Note that my given name is Korn?l but in the Hungarian language we use first 
names and last names in reverse order.

Korn?l

----- Original Message ----- 
From: "Dan Kegel"
To: "Wine Developers List"
Sent: Friday, May 09, 2008 12:18 PM
Subject: mono progress on mixed-mode assemblies...


http://lists.ximian.com/pipermail/mono-devel-list/2008-May/027767.html
shows that P?l Korn?l is now working on supporting apps
that use msvcrt.

Go Pal go! 



From dank at kegel.com  Fri May  9 09:54:21 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 9 May 2008 07:54:21 -0700
Subject: mono progress on mixed-mode assemblies...
In-Reply-To: <002001c8b1c6$c6fa6a00$83666250@kornelpal.hu>
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
	<002001c8b1c6$c6fa6a00$83666250@kornelpal.hu>
Message-ID: <a71bd89a0805090754o34dca0cew9eabe1165e203169@mail.gmail.com>

On Fri, May 9, 2008 at 4:21 AM, Korn?l P?l <kornelpal at gmail.com> wrote:
> Currently it's very unlikely that Mono will have it's own MSVCRTs (I mean
> mixed-mode versions) in the near future. Do you know whether they are
> redistributable?

Yes, but the license is restrictive, and you can't redistribute them
with wine or mono,
only with applications.  When running apps that forgot to bundle them,
I often use this script to download them from microsoft:
http://kegel.com/wine/winetricks

But Wine has its own increasingly useful implementation of msvcrt,
at least the part that uses the C api.  (The C++ api is difficult for us
because it has to be written in C; g++ uses a different ABI than Microsoft C++.)

Perhaps, once we work the kinks out, Mono can rely on Wine once more
to get this and related functionality.
- Dan


From dank at kegel.com  Fri May  9 15:35:09 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 9 May 2008 13:35:09 -0700
Subject: Another app bundled with Wine: Navicat
Message-ID: <a71bd89a0805091335j35727f3cs73040133ed4003c@mail.gmail.com>

http://navicat.com ships a Linux version which is based
on Wine from late 2007 and the Picasa wrapper scripts.
One more case study for http://kegel.com/wine/isv ...

And users are, as usual, confused about whether they
need to install Wine to run navicat.  See e.g.
http://ubuntuforums.org/showthread.php?t=670282
(Installing Wine may actually helped there, because
he's on a 64 bit machine, and using aptitude to
install wine brought in dependencies that also
made Navicat's wine happy.)


From jacek at codeweavers.com  Fri May  9 19:58:59 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Sat, 10 May 2008 02:58:59 +0200
Subject: shdocvw: Use array syntax with array elements (Try 2)
In-Reply-To: <200805092342.42436.andrew.talbot@talbotville.com>
References: <200805092342.42436.andrew.talbot@talbotville.com>
Message-ID: <4824F353.4050106@codeweavers.com>

Andrew Talbot wrote:
> Including some instances that I left out, earlier.
>
> -- Andy.
> ---
> Changelog:
>     shdocvw: Use array syntax with array elements.
>   

Why? Both syntaxes are correct, so it's a matter of style preferences. I 
prefer the style I use and I don't see any reason to change it.

Jacek


From dank at kegel.com  Fri May  9 21:31:41 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 9 May 2008 19:31:41 -0700
Subject: Spec OpenGL benchmarks
Message-ID: <a71bd89a0805091931k6e91d0f5nfee3cf7042a8dbea@mail.gmail.com>

On a whim, I tried the oldest SPEC OpenGL benchmark, SPECviewperf 6.

SPECViewperf 6.1.2 lives here:
http://www.spec.org/gwpg/pastissues/Feb2_02/opc.static/opcview.htm
It's also downloadable from
ftp://spec.it.miami.edu/dist/gpc/opc/viewperf/specviewperf612is01.exe

So far, the two tests I've tried seem to run ok, though I don't
know if the rendering is correct.

On one machine,
$ cd ".wine/drive_c/Program Files/SPECopc/SPECviewperf 6.1.2"
$ wine cmd /c RunLight04.bat
produced a proud 3 frames per second, woot!

This is pretty slow compared to the published results from 2002,
http://www.spec.org/gwpg/pastissues/Feb2_02/opc.data/summary.html
even without thinking about how much faster today's CPUs are.

Still, it's nice that it runs.  Perhaps we can take some baseline data
and start looking for bottlenecks one of these days.
- Dan


From tomecek at cs.aau.dk  Sat May 10 02:04:28 2008
From: tomecek at cs.aau.dk (tomecek at cs.aau.dk)
Date: Sat, 10 May 2008 09:04:28 +0200
Subject: Bugs in Wine research
Message-ID: <20080510090428.msuirr3yk0ogog04@webmail.cs.aau.dk>

Hi,
we are students from Department of computer science at Aalborg  
university. During this semester we were working on project on static  
analysis using the Coccinelle tool  
(http://www.emn.fr/x-info/coccinelle/) and Flawfinder  
(http://en.wikipedia.org/wiki/Flawfinder). We decided to search for  
bugs in Wine source code.

Our aim was to find as many bugs in Wine source code as possible but  
on the other hand to find real and dangerous ones. We solved some of  
the Janitorial projects and beside that we searched for common bugs.

We decided to deal with 2 of Janitorial Projects: Ignored return  
values and Memory leaks. Beside that searched for memory allocation  
without NULL checking. Then we ran some more scripts searching for not  
unlocking memory objects after locking them and searching for untested  
file descriptors. We also ran two tests looking for not dangerous  
problems: searching for unused variables and searching for pointers  
comparison to 0 instead of NULL.

All the test were run on Wine 0.9.57 version.

In http://www.cs.aau.dk/~tomecek/scripts.tar.gz we present the list of  
the most obvious bugs in 'diff' format and Coccinelle 'cocci' scripts  
in Semantic Patch Language (SmPL) used for bug searching.

* Ignored return variables
We found 115 function callings without checking the returned value  
which we considered to be possibly dangerous. In many cases we think  
that the behaviour could be dangerous but we need some information  
about the code.

In 'ignored_return_values.diff' we present some examples of code where  
the returned value should not be ignored but it is so.

* Unused variables
This was one of the Janitorial Projects. This issue is not dangerous  
but it helps to clean the code and make it more readable. All of the  
variables could be removed using \textit{diff} file. We found 18  
matches and all of them were true positives.

Beside that we find some possible security bug with 'Flawfinder'. Here  
is the output:

wine-0.9.57/programs/taskmgr/perfdata.c:292:  [4] (access)  
ImpersonateLoggedOnUser:
   If this call fails, the program could fail to drop heightened
   privileges. Make sure the return value is checked, and do not continue if a
   failure is reported.

* NULL comparison
Sometimes developers use comparison of pointers to zero instead of  
NULL. This is not critical bug but the \textit{gcc} compiler warns  
against such using.

In this case we were able to change all the zero comparison to NULL  
variant using Coccinelle. We found 176 matches and all of them were  
corrected automatically.

* Memory allocation
Using both functions for memory allocation - 'malloc' and 'HeapAlloc'  
- requires NULL checking of the returned value to be sure that the  
allocation was done correctly. We matched 598 possible bugs.

In 'memAlloc.diff' we send to you 10 examples of bugs we have found.

* Memory leaks
This searching was part of one of the Janitorial Projects. We were  
looking for memory allocations where the pointer to the allocated  
memory is lost or forgotten without freeing the memory.

We matched 13 of them as true positives.

In 'memLeaks.diff' we send to you 5 examples of most obvious problems.

* Object locking
We were searching for locking object with 'GlobalLock()' without  
'GlobalUnLock()' for unlocking. If the object was locked then it has  
to be unlocked to prevent deadlocks when some process or thread is  
waiting for unlocking of this object. We have 2 true positives.

* Descriptors
In this test we were looking for unchecked descriptors returned by  
fopen(), fdopen(), freopen(), open(), creat() and pipe() or for wrong  
check of this descriptors. fopen(), fdopen() and freopen() functions  
return in the case of failure 0 but the rest of these functions return  
-1. Sometimes programmers use it in wrong way and sometimes they do  
not check it anyway.

We matched 3 wrong usings.

If you are interested in our work or if you want the full list of bugs  
we found let us know.

Regards,
Bertrand Dechoux,
Youenn Corre,
Jaroslav Tomecek

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.




From thunderbird2k at gmx.net  Sat May 10 02:46:17 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Sat, 10 May 2008 09:46:17 +0200
Subject: Spec OpenGL benchmarks
In-Reply-To: <a71bd89a0805091931k6e91d0f5nfee3cf7042a8dbea@mail.gmail.com>
References: <a71bd89a0805091931k6e91d0f5nfee3cf7042a8dbea@mail.gmail.com>
Message-ID: <20080510074617.14260@gmx.net>

> On a whim, I tried the oldest SPEC OpenGL benchmark, SPECviewperf 6.
> 
> SPECViewperf 6.1.2 lives here:
> http://www.spec.org/gwpg/pastissues/Feb2_02/opc.static/opcview.htm
> It's also downloadable from
> ftp://spec.it.miami.edu/dist/gpc/opc/viewperf/specviewperf612is01.exe
> 
> So far, the two tests I've tried seem to run ok, though I don't
> know if the rendering is correct.
> 
> On one machine,
> $ cd ".wine/drive_c/Program Files/SPECopc/SPECviewperf 6.1.2"
> $ wine cmd /c RunLight04.bat
> produced a proud 3 frames per second, woot!
> 
> This is pretty slow compared to the published results from 2002,
> http://www.spec.org/gwpg/pastissues/Feb2_02/opc.data/summary.html
> even without thinking about how much faster today's CPUs are.
> 
> Still, it's nice that it runs.  Perhaps we can take some baseline data
> and start looking for bottlenecks one of these days.
> - Dan
> 

First of all these tests should be performed on solid display drivers. The performance of most open source drivers is crap (in case of Intel an upgrade to the new i915tex branch can do miracles it easily doubles performance). For best results use ATI or Nvidia.

Second I expect the performance on a Geforce / Radeon card to reasonable to good. For the best performance you likely need a Quadro or FireGL the reason being that the drivers of those cards have been optimized for CAD-functionality which is basically what the Spec-tests test.

There are also some more consumer orientated OpenGL tests (something a bit like a 3dmark for opengl). Glmark is one though a bit old, much more recent is FurMark though I have never tried it.

Roderick
-- 
GMX startet ShortView.de. Hier findest Du Leute mit Deinen Interessen!
Jetzt dabei sein: http://www.shortview.de/?mc=sv_ext_mf at gmx


From n.escuder at intra-links.com  Sat May 10 05:17:46 2008
From: n.escuder at intra-links.com (Escuder Nicolas)
Date: Sat, 10 May 2008 12:17:46 +0200
Subject: CreateProcess and retrieving stdout and stderr from unix program
Message-ID: <620F1629663A4D20B67E25B1C236D584@yoshi>

Hello,

 

Is there a way to retrieve stdout and stderr when lauching unix program with
CreateProcess.

At this thime I can only get stdout / stderr from windows programs.

 

See You

 

 

Escuder Nicolas



 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080510/19071afd/attachment.htm 

From dank at kegel.com  Sat May 10 07:12:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 10 May 2008 05:12:18 -0700
Subject: Bugs in Wine research
Message-ID: <a71bd89a0805100512k14b21936qd379e33a80c35694@mail.gmail.com>

tomecek wrote:
> we are students from Department of computer science at Aalborg
> university. During this semester we were working on project on static
> analysis using the Coccinelle tool
> (http://www.emn.fr/x-info/coccinelle/) and Flawfinder
> (http://en.wikipedia.org/wiki/Flawfinder). We decided to search for
> bugs in Wine source code.

Great, thanks!  We didn't have a wiki page about static analysis and Wine yet,
so I created one,
  http://wiki.winehq.org/StaticAnalysis

At least a couple of the memory leaks you found seem like they might
be worth fixing.

If you could put your full results up somewhere, and link to them from
that wiki page, we'll take a look.


From n.escuder at intra-links.com  Fri May  9 14:08:36 2008
From: n.escuder at intra-links.com (Escuder Nicolas)
Date: Fri, 9 May 2008 21:08:36 +0200
Subject: VB6 and wine_get_unix_file_name 
Message-ID: <6534BEC616024CACBD1BDF7DC9625BD9@yoshi>

Hello,

 

I'm trying to make a function for using wine_get_unix_file_name in VB6
programs.

 

Private Declare Function lstrcpyA Lib "kernel32.dll" (ByVal lpString1 As
String, ByVal lpString2 As Long) As Long

Public Declare Function GetProcessHeap Lib "kernel32" () As Long

Public Declare Function HeapFree Lib "kernel32" (ByVal hHeap As Long, ByVal
dwFlags As Long, IpMem As Any) As Long

Public Declare Function wine_get_unix_file_name Lib "kernel32" (ByVal
lpszSrc As String) As Long

 

Public Function GetUnixPath(ByVal sPath As String) As String

    Dim ptr As Long

    Dim sBuffer As String * 255

    ptr = wine_get_unix_file_name(StrConv(sPath, vbUnicode))

    lstrcpyA sBuffer, ptr

    HeapFree GetProcessHeap(), 0, ByVal ptr

    GetUnixPath = sBuffer

End Function

 

Sub Main()

UnixPath = GetUnixPath()

MsgBox UnixPath

End usb

 

When running this code I got a blank msgbox can anyone help me please.

 

See you.

 

Escuder Nicolas



 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080509/4b1f3352/attachment-0001.htm 

From Andrew.Talbot at talbotville.com  Sat May 10 08:27:25 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 10 May 2008 14:27:25 +0100
Subject: shdocvw: Use array syntax with array elements (Try 2)
References: <200805092342.42436.andrew.talbot@talbotville.com>
	<4824F353.4050106@codeweavers.com>
Message-ID: <g047rt$ta8$1@ger.gmane.org>

Jacek Caban wrote:

> Why? Both syntaxes are correct, so it's a matter of style preferences. I
> prefer the style I use and I don't see any reason to change it.
> 
> Jacek

Speaking generally, there is one potential opportunity to create a
hard-to-find bug. If one has something like, say:

    struct tagS { int i; };
    ...
    struct tagS ar[N];

then it is possible for a programmer to subconsciously believe he or she is
accessing the nth element of the array, but to accidentally write

    ar->i = 3;

instead of

    (ar + n)->i = 3;

This would compile and run fine, but would write to the zero'th element
instead of the nth.

Whereas, if one adopts the array style

    ar[n].i = 3;

then it is impossible to have this accident, since the following is
syntactically incorrect.

    ar.i = 3; /* error: request for member ?i? in something
              /* not a structure or union

I suspect I am likely to be a bit irritating, from time to time, in
reporting static issues. But if I find that a genre of report gets
rejected - say, for example, that nobody cares if an enum list ends in a
trailing comma - then I shall just switch off that check. Hopefully, it is
better to be bothered 100 times by me than 100,000 times by a static
analyzer. :)

-- 
Andy.




From Andrew.Talbot at talbotville.com  Sat May 10 08:49:03 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 10 May 2008 14:49:03 +0100
Subject: Re bug #8132
Message-ID: <g0494f$2ef$1@ger.gmane.org>

I have marked this bug as fixed, because Alex has written some patches that,
indeed, fix it. But these will be held back until after the code freeze, so
the bug is still actually present in the current code. Would it be
preferable to reopen it, therefore, until the patches are actually applied?

Thanks,

-- 
Andy.




From kevin.krammer at gmx.at  Sat May 10 09:57:23 2008
From: kevin.krammer at gmx.at (Kevin Krammer)
Date: Sat, 10 May 2008 16:57:23 +0200
Subject: mono progress on mixed-mode assemblies...
In-Reply-To: <a71bd89a0805090754o34dca0cew9eabe1165e203169@mail.gmail.com>
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
	<002001c8b1c6$c6fa6a00$83666250@kornelpal.hu>
	<a71bd89a0805090754o34dca0cew9eabe1165e203169@mail.gmail.com>
Message-ID: <200805101657.40046.kevin.krammer@gmx.at>

On Friday 09 May 2008, Dan Kegel wrote:
> On Fri, May 9, 2008 at 4:21 AM, Korn?l P?l <kornelpal at gmail.com> wrote:
> > Currently it's very unlikely that Mono will have it's own MSVCRTs (I mean
> > mixed-mode versions) in the near future. Do you know whether they are
> > redistributable?
>
> Yes, but the license is restrictive, and you can't redistribute them
> with wine or mono,
> only with applications.  When running apps that forgot to bundle them,
> I often use this script to download them from microsoft:
> http://kegel.com/wine/winetricks
>
> But Wine has its own increasingly useful implementation of msvcrt,
> at least the part that uses the C api.  (The C++ api is difficult for us
> because it has to be written in C; g++ uses a different ABI than Microsoft
> C++.)

The GCC people might be working on that, e.g. to enable free software library 
developers on Windows to use their tool chain for providing binary packages.

Cheers,
Kevin

-- 
Kevin Krammer, KDE developer, xdg-utils developer
KDE user support, developer mentoring
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080510/66312898/attachment.pgp 

From research at science.su  Sat May 10 10:36:50 2008
From: research at science.su (L. Rahyen)
Date: Sat, 10 May 2008 15:36:50 +0000
Subject: Re bug #8132
In-Reply-To: <g0494f$2ef$1@ger.gmane.org>
References: <g0494f$2ef$1@ger.gmane.org>
Message-ID: <200805101536.50877.research@science.su>

On Saturday May 10 2008 13:49:03 Andrew Talbot wrote:
> I have marked this bug as fixed, because Alex has written some patches
> that, indeed, fix it. But these will be held back until after the code
> freeze, so the bug is still actually present in the current code. Would it
> be preferable to reopen it, therefore, until the patches are actually
> applied?

	Bug should be marked as fixed *only* after a fix has been committed. So if it 
isn't committed yet it should stay open.


From jjmckenzie51 at sprintpcs.com  Sat May 10 11:13:11 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 10 May 2008 09:13:11 -0700
Subject: Re bug #8132
In-Reply-To: <g0494f$2ef$1@ger.gmane.org>
References: <g0494f$2ef$1@ger.gmane.org>
Message-ID: <4825C997.4010906@sprintpcs.com>

Andrew Talbot wrote:
> I have marked this bug as fixed, because Alex has written some patches that,
> indeed, fix it. But these will be held back until after the code freeze, so
> the bug is still actually present in the current code. Would it be
> preferable to reopen it, therefore, until the patches are actually applied?
>
> Thanks,
>
>   
The bug should stay open and the fix patches be attached to the bug in 
case someone else wishes to incorporate them into a private build.

James McKenzie



From dank at kegel.com  Sat May 10 11:26:37 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 10 May 2008 09:26:37 -0700
Subject: Bugs in Wine research
In-Reply-To: <4825CA71.7080800@sprintpcs.com>
References: <a71bd89a0805100512k14b21936qd379e33a80c35694@mail.gmail.com>
	<4825CA71.7080800@sprintpcs.com>
Message-ID: <a71bd89a0805100926kdf9dc35xa8f74ef32160a05f@mail.gmail.com>

James McKenzie <jjmckenzie51 at sprintpcs.com> wrote:
>>> we are students from Department of computer science at Aalborg
>>> university. During this semester we were working on project on static
>>> analysis using the Coccinelle tool
>>  http://wiki.winehq.org/StaticAnalysis
>
> I was wondering if results from Wine 0.9.57 would continue to be valid?
> Maybe the effort could shift to RC1?

Sure, lots of the unused vars bugs in particular are probably
already fixed.   But the other issues have a pretty good
chance of still being valid.


From jjmckenzie51 at sprintpcs.com  Sat May 10 11:16:49 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 10 May 2008 09:16:49 -0700
Subject: Bugs in Wine research
In-Reply-To: <a71bd89a0805100512k14b21936qd379e33a80c35694@mail.gmail.com>
References: <a71bd89a0805100512k14b21936qd379e33a80c35694@mail.gmail.com>
Message-ID: <4825CA71.7080800@sprintpcs.com>

Dan Kegel wrote:
> tomecek wrote:
>   
>> we are students from Department of computer science at Aalborg
>> university. During this semester we were working on project on static
>> analysis using the Coccinelle tool
>> (http://www.emn.fr/x-info/coccinelle/) and Flawfinder
>> (http://en.wikipedia.org/wiki/Flawfinder). We decided to search for
>> bugs in Wine source code.
>>     
>
> Great, thanks!  We didn't have a wiki page about static analysis and Wine yet,
> so I created one,
>   http://wiki.winehq.org/StaticAnalysis
>
> At least a couple of the memory leaks you found seem like they might
> be worth fixing.
>
> If you could put your full results up somewhere, and link to them from
> that wiki page, we'll take a look.
>
>
>
>   
Dan:

I was wondering if results from Wine 0.9.57 would continue to be 
valid?   Maybe the effort could shift to RC1?

James McKenzie



From marcelotduarte at gmail.com  Sat May 10 11:56:56 2008
From: marcelotduarte at gmail.com (Marcelo Duarte)
Date: Sat, 10 May 2008 13:56:56 -0300
Subject: VB6 and wine_get_unix_file_name
In-Reply-To: <6534BEC616024CACBD1BDF7DC9625BD9@yoshi>
References: <6534BEC616024CACBD1BDF7DC9625BD9@yoshi>
Message-ID: <4825D3D8.6050004@gmail.com>

UnixPath = GetUnixPath() needs a parameter...

Escuder Nicolas escreveu:
>
> Hello,
>
> I?m trying to make a function for using wine_get_unix_file_name in VB6 
> programs.
>
> Private Declare Function lstrcpyA Lib "kernel32.dll" (ByVal lpString1 
> As String, ByVal lpString2 As Long) As Long
>
> Public Declare Function GetProcessHeap Lib "kernel32" () As Long
>
> Public Declare Function HeapFree Lib "kernel32" (ByVal hHeap As Long, 
> ByVal dwFlags As Long, IpMem As Any) As Long
>
> Public Declare Function wine_get_unix_file_name Lib "kernel32" (ByVal 
> lpszSrc As String) As Long
>
> Public Function GetUnixPath(ByVal sPath As String) As String
>
> Dim ptr As Long
>
> Dim sBuffer As String * 255
>
> ptr = wine_get_unix_file_name(StrConv(sPath, vbUnicode))
>
> lstrcpyA sBuffer, ptr
>
> HeapFree GetProcessHeap(), 0, ByVal ptr
>
> GetUnixPath = sBuffer
>
> End Function
>
> Sub Main()
>
> UnixPath = GetUnixPath()
>
> MsgBox UnixPath
>
> End usb
>
> When running this code I got a blank msgbox can anyone help me please.
>
> See you.
>
> *Escuder Nicolas*
>
> ------------------------------------------------------------------------
>
>
>   



From dank at kegel.com  Sat May 10 16:17:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 10 May 2008 14:17:30 -0700
Subject: Wine 1.0 status: rc2 in 12 days, 34 bugs left
Message-ID: <a71bd89a0805101417l745dea31i645e0408d9cbf4d8@mail.gmail.com>

Hell is starting to freeze over.

A clickable version of the following info is at
 http://kegel.com/wine/countdown.html

Wine is now in a code freeze in preparation for the 1.0 release.

According to http://wiki.winehq.org/WineReleasePlan, wine-1.0.0-rc2
will be due out Friday, May 23rd, 2008. It will be something like be
the next to last release candidate for 1.0.

During the code freeze, patches that

    * are simple
    * come with a conformance test
    * fix a regression
    * are low risk

are more likely to get in than other patches. (Heck, that's always
true, but it's even truer during a freeze.) We will actively
discourage patches that might endanger a June 1.0 release.

Bug Status

There are 34 open 1.0 bugs as of 10 May.  Most of these will simply be
rolled over to be fixed for a later release; we only have time to fix
a few, and much as we'd like to fix the rest, most are not
showstoppers.

Changes since last week (with category and votes):

New (!):
13071         quartz  0       Flashplayer crashes in a quartz bug
13115         advapi  0       .net 1.1 installer fails in ControlService()

Fixed:
8125    -unknown        0       Marratech 6.1 crashes on start
8783    ntdll   14      USB serial ports do not work
9178    -unknown        8       "hello world" dos program hangs
9356    ntdll   11      Serial communication not working since wine-0.9.33
11420   advapi32        0       service control manager API problem:
name of named objects might differ (client vs. service process)

Invalid:
12914   tools   1       wineprefixcreate overrides custom entries in
Explorer\\Shell Folders


Deferred:
2368    winex11.        7       Wine loses its X-Window when switching
to another virt. desktop in Fvwm
4523    user32  5       Can't copy from Firefox 1.5 and paste into
OpenOffice 2 under Wine
5061    -unknown        6       Copying from Windows Firefox in Wine
and pasting to Linux OpenOffice pastes metadata as data
6604    tools   3       Ship icons for the wine-tools that can be used
in .desktop files
7372    winex11.        14      can't copy and paste between gnome
apps eg openoffice or gimp and wine apps such as dreamweaver or adobe
photoshop
7571    gdi32   1       Accented character glyphs are mixed up with
TrueType fonts (affects e.g. Lotus Notes R5)
9942    ole     3       Powerpoint Viewer 2007 crashes opening .pptx files


Here's the full list of current bugs:

13115         advapi  0       .net 1.1 installer fails in ControlService()
2493        comctl32    2           Multi-select listview: Shift-arrow
up only selects top two items
11509       crypt32     0           Wordviewer 2003 is unable to open
documents encrypted with AES
5535        directx-    20          Planescape:Torment doesn't work
11584       directx-    2           Multiple games crash with stack
overflow error
3270        gdi32       16          Problem with minimized top-level windows
6519        gdi32       7           Wine blacks out rotated font bitmap
9771        gdi32       45          Steam Friends doesn't work (fails
to render correctly or refresh)
12730       gdi32       1           gdi32: some tests fail when X is
run in 16 bit mode, but not 32 bit
5024        kernel32    5           Thief: Deadly Shadows crashes:page
fault on read access to 0x0000040c
10147       msi         2           Word Viewer 2003 - Tab behavior
differs from Windows
12263       opengl      3           Sketchup Cannot initialize OpenGL
- ChoosePixelFormat fails
5926        programs    1           Wine does not provide an
implementation of winhlp32.exe
10288       programs    0           wine_gecko download hangs sometimes
13071       quartz      0           Flashplayer crashes in a quartz bug
5163        setupapi    14          Office XP 2002 crashes on installation
6095        shdocvw     16          MOTD in counter-strike 1.6 and
counter-strike source does not render
8898        shdocvw     1           Run Time Error "445": Object
doesn't support this action in Europa Knowledgebase
8439        shell32     10          Visual Studio .NET (7) install fails
11742       shlwapi     9           Small .net 1.1 app (FastMD5 1.3)
fails to start up
12074       testcase    3           The conformance tests fail on Windows
5402        -unknown    0           Trying to run PhotoStitch 3.1
5844        -unknown    16          tray minimize
5948        -unknown    2           Star Trek: Armada does not install
7404        -unknown    3           ShowWindow(SW_MINIMIZE) should not
generate a WM_PAINT message
9916        -unknown    6           "make test" usually fails
11281       -unknown    5           CJK input many issues
12097       -unknown    3           Wine 1.0 should not ship
out-of-sync resource translations
12246       -unknown    2           "make test" gives different
results with and without warn+heap
664         user32      8           The help menu functionality inside
programs is broken (messaging problem)
3023        user32      6           Orcad - "Place Part" never tries
to put down a part
124         wineserv    2           Review of Wine Server Protocol
9787        winsock     63          Warcraft3 Battle.net Doesn't work
(Needs AcceptEx)
12005       wintab32    2           Regression in pressure sensitivity
with wizardpen tablet driver and Photoshop 7


From mounir.idrassi at idrix.net  Sat May 10 17:30:00 2008
From: mounir.idrassi at idrix.net (Mounir IDRASSI)
Date: Sun, 11 May 2008 00:30:00 +0200
Subject: Concerning Bug 11509 (AES Provider Handling for Windows XP)
Message-ID: <867e1e4df2b836d68c731689cd2df3f4@idrix.fr>

Hi,


From infyquest at gmail.com  Sat May 10 18:04:32 2008
From: infyquest at gmail.com (Vijay Kiran Kamuju)
Date: Sat, 10 May 2008 19:04:32 -0400
Subject: Concerning Bug 11509 (AES Provider Handling for Windows XP)
In-Reply-To: <867e1e4df2b836d68c731689cd2df3f4@idrix.fr>
References: <867e1e4df2b836d68c731689cd2df3f4@idrix.fr>
Message-ID: <36bf289b0805101604lc352e25if6204a60c4b04cb8@mail.gmail.com>

Hi,

Modifying an existing key is not a good idea.
Julliard, is also against it, hence rejected my second try.
It will fail for 2003 and Vista.
I am working on a fix.
Having no time to test, my last days on my current project at work.
Pretty busy :(
Will send the new patch on monday.

Thanks,
VJ

On Sat, May 10, 2008 at 6:30 PM, Mounir IDRASSI
<mounir.idrassi at idrix.net> wrote:
> Hi,
>
> From what I see, the patch correcting this bug from Vijay has been refused
> because it modifies the name of the RSA and AES provider, which is wrong.
> However, this patch can be easily changed to keep the current name and
> simply add a new provider name. So, the declaration of the variable
> szRSAName should be changed to "static const WCHAR szRSAName[4][66]" and
> its value appended at the end with the new name of the provider for XP
> instead of modifying the last field. This way, I'm sure the patch will be
> accepted.
> Vijay : can you submit a modified version of your patch.
>
> Cheers,
> Mounir IDRASSI
> IDRIX - Cryptography And IT Security Experts
> http://www.idrix.fr
>
>


From wine-devel at kievinfo.com  Sat May 10 20:07:03 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 10 May 2008 19:07:03 -0600
Subject: Lots of regressions in games in last few versions
Message-ID: <482646B7.5010105@kievinfo.com>

Several latest releases introduced lots and lots of regressions to a point 
that no games run as-is. Considering that we are at the code freeze, I'd 
like to see all patches that cause regressions, and all patches that depend 
on them starting from wine-0.9.58 be reverted.

Also each patch to have a conformance test and statement which games where 
tested and what problems were fixed with each patch.

Bugs: 13120, 13110, 13101, 13086 and on and on and on.

Can some one explain what's the deal with games not working full screen? Why 
are there are of the sudden problems with pixel formats? Why lots of games 
crashing ActivatingContext? Why most games don't work anymore on ATI?

If the whole point of wine-1.0 is to have photoshop working - then we might 
as well call it 'wine-photoshop' get it into a separate tree and don't let 
any changes not related to photoshop there.

Vitaliy.


From wine-devel at kievinfo.com  Sat May 10 20:09:50 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 10 May 2008 19:09:50 -0600
Subject: [PATCH] ddraw: Fix some code unprotected by ddraw lock.
In-Reply-To: <4826116F.8010605@inbox.lv>
References: <4826116F.8010605@inbox.lv>
Message-ID: <4826475E.2040204@kievinfo.com>

Alexander Dorofeyev wrote:
> ---
>  dlls/ddraw/device.c |   24 ++++++++++++++----------
>  1 files changed, 14 insertions(+), 10 deletions(-)
> 
> 
What is this patch fixing? Do you have tests? Do you have a bug # showing 
the problem? Please explain why parts of the code needs to be protected?

Vitaliy.


From jjmckenzie51 at sprintpcs.com  Sat May 10 20:27:28 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 10 May 2008 18:27:28 -0700
Subject: Lots of regressions in games in last few versions
In-Reply-To: <482646B7.5010105@kievinfo.com>
References: <482646B7.5010105@kievinfo.com>
Message-ID: <48264B80.7080601@sprintpcs.com>

Vitaliy Margolen wrote:
> Several latest releases introduced lots and lots of regressions to a point 
> that no games run as-is. Considering that we are at the code freeze, I'd 
> like to see all patches that cause regressions, and all patches that depend 
> on them starting from wine-0.9.58 be reverted.
>
> Also each patch to have a conformance test and statement which games where 
> tested and what problems were fixed with each patch.
>
> Bugs: 13120, 13110, 13101, 13086 and on and on and on.
>
> Can some one explain what's the deal with games not working full screen? Why 
> are there are of the sudden problems with pixel formats? Why lots of games 
> crashing ActivatingContext? Why most games don't work anymore on ATI?
>
>   
Ya know there is a way to handle this.  Bashing developers is not one of 
them.  Regression testing is.  Some of our 'users' are not savvy enough 
to figure out how to do this.  We need to help them.  Since I run a Mac 
and don't have access to some of these games and don't want to introduce 
the world to Apple's 'broken' X11, I cannot fill this need.  However, 
others can and should.  Now, are you going to be a part of the problem, 
or are you going to go out and find the culprit and fix it?  Think about 
this and go forth and do great things.  I expect nothing less from a 
person of your experience and abilities.

In other word:  Quit whining, and fix it.

James McKenzie



From wine-devel at kievinfo.com  Sat May 10 20:38:21 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 10 May 2008 19:38:21 -0600
Subject: Lots of regressions in games in last few versions
In-Reply-To: <48264B80.7080601@sprintpcs.com>
References: <482646B7.5010105@kievinfo.com> <48264B80.7080601@sprintpcs.com>
Message-ID: <48264E0D.4000003@kievinfo.com>

James McKenzie wrote:
> Vitaliy Margolen wrote:
>> Several latest releases introduced lots and lots of regressions to a 
>> point that no games run as-is. Considering that we are at the code 
>> freeze, I'd like to see all patches that cause regressions, and all 
>> patches that depend on them starting from wine-0.9.58 be reverted.
>>
>> Also each patch to have a conformance test and statement which games 
>> where tested and what problems were fixed with each patch.
>>
>> Bugs: 13120, 13110, 13101, 13086 and on and on and on.
>>
>> Can some one explain what's the deal with games not working full 
>> screen? Why are there are of the sudden problems with pixel formats? 
>> Why lots of games crashing ActivatingContext? Why most games don't 
>> work anymore on ATI?
>>
>>   
> Ya know there is a way to handle this.  Bashing developers is not one of 
> them.  Regression testing is.  Some of our 'users' are not savvy enough 
Oh really? So how many regression testing do you need to fix say... bug 
11584 Multiple games crash with stack overflow error? 10? 20? 100 (look all 
the bugs marked as dups of it)? Unless some one actually starts fixing the 
bug, doing regression testing is pointless. Besides lots of new regressions 
have regression testing done on them.

> In other word:  Quit whining, and fix it.
I'd love to but I can't. I don't have free several months to understand how 
d3d works. All the shaders, surfaces, textures, pixel formats, all the rules 
for choosing all the pixel formats, etc.

I'd like to trust all developers to make right decisions about what patches 
are low risk and which have to be tested with loads of apps. But it seems I 
can't. And no one saying what might break if some patch gets committed. And 
of course I understand that most things can't be tested with conformance 
tests there. But at least a minimum of several major titles have to be 
tested for regressions.


Vitaliy.


From wine-devel at kievinfo.com  Sat May 10 21:32:16 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 10 May 2008 20:32:16 -0600
Subject: Lots of regressions in games in last few versions
In-Reply-To: <48265499.1070102@sprintpcs.com>
References: <482646B7.5010105@kievinfo.com> <48264B80.7080601@sprintpcs.com>
	<48264E0D.4000003@kievinfo.com> <48265499.1070102@sprintpcs.com>
Message-ID: <48265AB0.3040004@kievinfo.com>

James McKenzie wrote:
> Vitaliy Margolen wrote:
>> James McKenzie wrote:
>>> Vitaliy Margolen wrote:
>>>> Several latest releases introduced lots and lots of regressions to a 
>>>> point that no games run as-is. Considering that we are at the code 
>>>> freeze, I'd like to see all patches that cause regressions, and all 
>>>> patches that depend on them starting from wine-0.9.58 be reverted.
>>>>
>>>> Also each patch to have a conformance test and statement which games 
>>>> where tested and what problems were fixed with each patch.
>>>>
>>>> Bugs: 13120, 13110, 13101, 13086 and on and on and on.
>>>>
>>>> Can some one explain what's the deal with games not working full 
>>>> screen? Why are there are of the sudden problems with pixel formats? 
>>>> Why lots of games crashing ActivatingContext? Why most games don't 
>>>> work anymore on ATI?
>>>>
>>>>   
>>> Ya know there is a way to handle this.  Bashing developers is not one 
>>> of them.  Regression testing is.  Some of our 'users' are not savvy 
>>> enough 
>> Oh really? So how many regression testing do you need to fix say... 
>> bug 11584 Multiple games crash with stack overflow error? 10? 20? 100 
>> (look all the bugs marked as dups of it)? Unless some one actually 
>> starts fixing the bug, doing regression testing is pointless. Besides 
>> lots of new regressions have regression testing done on them.
>>
> There were several 'fixes' to this problem in the issue.  And Stephan 
> continues to troubleshoot the problem.  However, this is a VOLUNTEER 
> effort and most of us have 'real lives' to live.  I would gladly work on 
> rich edit problems as they directly affect a program that I use.  
> However, I don't have enough hours in the day to attempt to work on 
> them.  I picked up issue 6254, the lockup problem, and a patch proposed 
There are no patches that fix this problem (however hackish they might be). 
And it looks like a design problem. That's why someone with knowledge of the 
d3d needs to look at it.

>> I'd like to trust all developers to make right decisions about what 
>> patches are low risk and which have to be tested with loads of apps. 
>> But it seems I can't. And no one saying what might break if some patch 
>> gets committed. And of course I understand that most things can't be 
>> tested with conformance tests there. But at least a minimum of several 
>> major titles have to be tested for regressions.
>>
>>
> We need to do serious testing before any release.  I lived in the QA 
Yes everything have to be tested. The business of sending patches that do 
"the right thing" have to stop. We all know that m$ always does things 
backwards. And most apps relay on that.

> 'arena' for many years.  However, we do have limited time and we don't 
> have all of the resources we'd like to have.  Thus, some problems appear 
> in release code and we have to clean up the mess afterwards.  In the 
No one should be cleaning up mess. There shouldn't be one in the first 
place. Or if some one got it in, it should be his responsibility to fix it, 
or get the whole damn thing out.

> case of the issue you pointed out, the simple, but incorrect fix, was to 
> back out the change and then re-introduce it after some major work.  
> This would have delayed the improvement in framerates for many games and 
> productivity programs.

And I tend to disagree with you there. I can point to number of things that 
weren't right to begin with. And it was clear right from the start. Yet they 
still not fixed, because now it's not trivial to fix the introduced 
problems. Or the whole idea was flowed and have to be redone.

And I don't see what's so wrong with having 'git revert' as valid option for 
any problem patch? If problem is identified and it's not getting fixed 
before the next release - pull it out. This is the only option with our 
linear development where we don't have stable and development branches.

Vitaliy


From alexd4 at inbox.lv  Sat May 10 22:16:47 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Sun, 11 May 2008 06:16:47 +0300
Subject: [PATCH] ddraw: Fix some code unprotected by ddraw lock.
In-Reply-To: <4826475E.2040204@kievinfo.com>
References: <4826116F.8010605@inbox.lv> <4826475E.2040204@kievinfo.com>
Message-ID: <4826651F.4090009@inbox.lv>

Vitaliy Margolen wrote:
> Alexander Dorofeyev wrote:
>> ---
>>  dlls/ddraw/device.c |   24 ++++++++++++++----------
>>  1 files changed, 14 insertions(+), 10 deletions(-)
>>
>>
> What is this patch fixing? Do you have tests? Do you have a bug # showing 
> the problem? Please explain why parts of the code needs to be protected?

It is fixing an oversight on my part, when I moved these chunks of code few days 
ago to fix a bug. All ddraw code holds the lock for thread safety, except stubs.


From wine-devel at kievinfo.com  Sat May 10 23:11:03 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sat, 10 May 2008 22:11:03 -0600
Subject: [PATCH] ddraw: Fix some code unprotected by ddraw lock.
In-Reply-To: <4826651F.4090009@inbox.lv>
References: <4826116F.8010605@inbox.lv> <4826475E.2040204@kievinfo.com>
	<4826651F.4090009@inbox.lv>
Message-ID: <482671D7.5010902@kievinfo.com>

Alexander Dorofeyev wrote:
> Vitaliy Margolen wrote:
>> Alexander Dorofeyev wrote:
>>> ---
>>>  dlls/ddraw/device.c |   24 ++++++++++++++----------
>>>  1 files changed, 14 insertions(+), 10 deletions(-)
>>>
>>>
>> What is this patch fixing? Do you have tests? Do you have a bug # showing 
>> the problem? Please explain why parts of the code needs to be protected?
> 
> It is fixing an oversight on my part, when I moved these chunks of code few days 
> ago to fix a bug. All ddraw code holds the lock for thread safety, except stubs.
> 
> 
Ok sounds good and I see what you are fixing.

Vitaliy.


From twickline at gmail.com  Sun May 11 02:18:56 2008
From: twickline at gmail.com (Tom Wickline)
Date: Sun, 11 May 2008 03:18:56 -0400
Subject: Lots of regressions in games in last few versions
In-Reply-To: <482646B7.5010105@kievinfo.com>
References: <482646B7.5010105@kievinfo.com>
Message-ID: <53e3a9930805110018l52beb81are2efe0379d2a6ed8@mail.gmail.com>

Well its not only Games, if you install office 2007 NOTHING works with RC-1!
You have to revert back to 0.9.59 for it to work the best it ever did, then
it's all down hill from each release forward ......As it looks Wine
1.0 will be a huge POS......

Just my $0.02

Tom

On Sat, May 10, 2008 at 9:07 PM, Vitaliy Margolen
<wine-devel at kievinfo.com> wrote:
> Several latest releases introduced lots and lots of regressions to a point
> that no games run as-is. Considering that we are at the code freeze, I'd
> like to see all patches that cause regressions, and all patches that depend
> on them starting from wine-0.9.58 be reverted.
>
> Also each patch to have a conformance test and statement which games where
> tested and what problems were fixed with each patch.
>
> Bugs: 13120, 13110, 13101, 13086 and on and on and on.
>
> Can some one explain what's the deal with games not working full screen? Why
> are there are of the sudden problems with pixel formats? Why lots of games
> crashing ActivatingContext? Why most games don't work anymore on ATI?
>
> If the whole point of wine-1.0 is to have photoshop working - then we might
> as well call it 'wine-photoshop' get it into a separate tree and don't let
> any changes not related to photoshop there.
>
> Vitaliy.
>
>
>


From dank at kegel.com  Sun May 11 08:29:00 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 11 May 2008 06:29:00 -0700
Subject: New winetricks 20080511: dotnet11 working again, new verb fontfix
Message-ID: <a71bd89a0805110629y3e80ef08l39f62b5e85095000@mail.gmail.com>

Another week, another winetricks.

Changes since last week's annoucement:

- dotnet11 now works again.  Removed GAC kludge, added font kludges.

- new verb fontfix to install working versions of arphic fonts (bad
versions crash dotnet 1.1)


I haven't looked at whether dotnet20 also needs the font kludges...

Online as always at
  http://kegel.com/wine/winetricks
or
  http://winezeug.googlecode.com


From msclrhd at googlemail.com  Sun May 11 03:24:40 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 11 May 2008 09:24:40 +0100
Subject: Lots of regressions in games in last few versions
In-Reply-To: <53e3a9930805110018l52beb81are2efe0379d2a6ed8@mail.gmail.com>
References: <482646B7.5010105@kievinfo.com>
	<53e3a9930805110018l52beb81are2efe0379d2a6ed8@mail.gmail.com>
Message-ID: <3f4fd2640805110124o4eba85deq5e4cd64d244197b8@mail.gmail.com>

2008/5/11 Tom Wickline <twickline at gmail.com>:
> Well its not only Games, if you install office 2007 NOTHING works with RC-1!
> You have to revert back to 0.9.59 for it to work the best it ever did, then
> it's all down hill from each release forward ......As it looks Wine
> 1.0 will be a huge POS......

That's unfair.

To start with, the CodeWeavers team has been working on getting Office
2007 working, but that work is still *in progress*.

What would be bad is if older versions of Office stopped working, as
they have been working for a long time, and are part of CodeWeavers
core business model.

Also, Photoshop CS1 and CS2 were made to work on Wine. going further
back, there was the latest ITunes (current reports on the AppDB are
rating it Gold or Bronze, so it appears to still be functional with
recent Wine versions).

The problem is that as Wine gets closer to Windows, implementing more
functionality, applications running on it are going to start to try
and do new things (e.g. if they QueryInterface for an interface that
Wine adds stubs for, the application is going to start calling that
interface). Don't forget that as it stands, Wine is not (yet!) a
complete Windows clone.

Newer versions of applications tend to be more demanding on their API
requirements, needing .NET or GDIPlus, or some other MS API that is
not fully implemented by Wine. And the more recent a game is, the
higher the DirectX version it needs, and the more they push the
graphics card drivers.

Note also with the games that IIRC, bugs in graphics card drivers are
not being worked around, so some of the crashes may be due to driver
bugs. On Vista, I have had a bad experience with the NVidia drivers,
so that is not limited to Linux/Wine. As well as this, there are still
various fixmes that may (or may not) contribute to some of the game
crashes. DirectX is a complicated API which games can often abuse (I
remember Stephan mention that some games have DirectX bugs in them),
and the fact that games run *at all* is an incredible feat; Kudos to
the wined3d developers.

So while Wine is not perfect (it is definitely a work in progress) it
has a good set of features and is long overdue for a 1.0 release.

There is a balance between keeping code stable and improving it. This
is especially true when reworking code to better support new
functionality. I suspect that the improved DIB engine work will have a
few regressions, but that work still needs to be done for performance
reasons.

If something is not working for you, file a bug. That is the only way
to get the bugs fixed. Especially if something has regressed. Now is
the time to be testing and filing bug reports.

And to some extend, I agree with Vitality: every bug (unless there is
a really good reason not to) should have an associated regression test
so that it will not reappear in the future, but reverting any patch
going that far back is too drastic and may be reverting a patch (or
patches) that fix another bug.

- Reece


From alexd4 at inbox.lv  Sun May 11 09:58:10 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Sun, 11 May 2008 17:58:10 +0300
Subject: Lots of regressions in games in last few versions
In-Reply-To: <48264E0D.4000003@kievinfo.com>
References: <482646B7.5010105@kievinfo.com> <48264B80.7080601@sprintpcs.com>
	<48264E0D.4000003@kievinfo.com>
Message-ID: <48270982.5050507@inbox.lv>

Vitaliy Margolen wrote:
> James McKenzie wrote:
>> Vitaliy Margolen wrote:
>>> Several latest releases introduced lots and lots of regressions to a 
>>> point that no games run as-is. Considering that we are at the code 
>>> freeze, I'd like to see all patches that cause regressions, and all 
>>> patches that depend on them starting from wine-0.9.58 be reverted.
>>>
>>> Also each patch to have a conformance test and statement which games 
>>> where tested and what problems were fixed with each patch.
>>>
>>> Bugs: 13120, 13110, 13101, 13086 and on and on and on.
>>>
>>> Can some one explain what's the deal with games not working full 
>>> screen? Why are there are of the sudden problems with pixel formats? 
>>> Why lots of games crashing ActivatingContext? Why most games don't 
>>> work anymore on ATI?
>>>
>>>   
> 
> I'd like to trust all developers to make right decisions about what patches 
> are low risk and which have to be tested with loads of apps. But it seems I 
> can't. And no one saying what might break if some patch gets committed. And 
> of course I understand that most things can't be tested with conformance 
> tests there. But at least a minimum of several major titles have to be 
> tested for regressions.
> 
> 
> Vitaliy.

Vitaliy,

I mostly use wine for games, and I agree with you that regressions with games 
regularly appear (not that it's so different from any other area whenever 
there's active development) and it sucks. To some extent, tests may help, but, 
unfortunately, even with tests things are still rather fragile. One reason is 
many different codepaths and variables that affect how wined3d works. To give an 
example, with an old game like Starcraft, you would have this:

1) DirectDrawRenderer: gdi or opengl

if opengl, then

2) EXT_paletted_texture offered by driver or not
3) ARB_fragment_program offered or not
4) PBO available or not
5) various RenderTargetLockMode settings
6) various OffscreenRenderingMode settings

Running tests on one machine may miss many breakages because of so many 
variables. On top of that, add the hazard of buggy and broken drivers.

If we want to guarantee no regressions in major game titles, we must have a list 
of these titles and probably also volunteers who care about games to regularly 
test them with current git on different types of hardware and preferably also 
playing with the above mentioned settings while doing so. There is so much to 
test with these things a single person can't handle it, unless he has several 
computers with all kinds of popular hardware and many hours a day for this (and 
also many games, which nowadays tend to take gigabytes even for a demo). 
Basically this means making some titles part of either official or at least 
unofficial / "voluntary" release criteria. You are welcome to propose ideas 
about possible list of such titles. Regularly running conformance tests on 
specific hardware is also good, but in this case testers must be aware of known 
issues - failing tests sometimes mean known bugs in drivers, whereas if a game 
worked in the past but regressed it's definitely a wine problem.

As for low risk, it's unfortunately difficult to assess, as, for example, it 
often happens that a relatively obvious, simple and correct fix breaks things 
because it exposes previously hidden bugs.

Just my 0.02 ? :).


From zgs at seas.upenn.edu  Sun May 11 10:34:34 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Sun, 11 May 2008 11:34:34 -0400
Subject: Lots of regressions in games in last few versions
In-Reply-To: <48270982.5050507@inbox.lv>
References: <482646B7.5010105@kievinfo.com> <48264B80.7080601@sprintpcs.com>
	<48264E0D.4000003@kievinfo.com> <48270982.5050507@inbox.lv>
Message-ID: <b050a5e70805110834n71484c1aqf65ca9fbc1ed1336@mail.gmail.com>

On Sun, May 11, 2008 at 10:58 AM, Alexander Dorofeyev <alexd4 at inbox.lv> wrote:
> Vitaliy Margolen wrote:
>> James McKenzie wrote:
>>> Vitaliy Margolen wrote:
>>>> Several latest releases introduced lots and lots of regressions to a
>>>> point that no games run as-is. Considering that we are at the code
>>>> freeze, I'd like to see all patches that cause regressions, and all
>>>> patches that depend on them starting from wine-0.9.58 be reverted.
>>>>
>>>> Also each patch to have a conformance test and statement which games
>>>> where tested and what problems were fixed with each patch.
>>>>
>>>> Bugs: 13120, 13110, 13101, 13086 and on and on and on.
>>>>
>>>> Can some one explain what's the deal with games not working full
>>>> screen? Why are there are of the sudden problems with pixel formats?
>>>> Why lots of games crashing ActivatingContext? Why most games don't
>>>> work anymore on ATI?
>>>>
>>>>
>>
>> I'd like to trust all developers to make right decisions about what patches
>> are low risk and which have to be tested with loads of apps. But it seems I
>> can't. And no one saying what might break if some patch gets committed. And
>> of course I understand that most things can't be tested with conformance
>> tests there. But at least a minimum of several major titles have to be
>> tested for regressions.
>>
>>
>> Vitaliy.
>
> Vitaliy,
>
> I mostly use wine for games, and I agree with you that regressions with games
> regularly appear (not that it's so different from any other area whenever
> there's active development) and it sucks. To some extent, tests may help, but,
> unfortunately, even with tests things are still rather fragile. One reason is
> many different codepaths and variables that affect how wined3d works. To give an
> example, with an old game like Starcraft, you would have this:
>
> 1) DirectDrawRenderer: gdi or opengl
>
> if opengl, then
>
> 2) EXT_paletted_texture offered by driver or not
> 3) ARB_fragment_program offered or not
> 4) PBO available or not
> 5) various RenderTargetLockMode settings
> 6) various OffscreenRenderingMode settings
>
> Running tests on one machine may miss many breakages because of so many
> variables. On top of that, add the hazard of buggy and broken drivers.
>
> If we want to guarantee no regressions in major game titles, we must have a list
> of these titles and probably also volunteers who care about games to regularly
> test them with current git on different types of hardware and preferably also
> playing with the above mentioned settings while doing so. There is so much to
> test with these things a single person can't handle it, unless he has several
> computers with all kinds of popular hardware and many hours a day for this (and
> also many games, which nowadays tend to take gigabytes even for a demo).
> Basically this means making some titles part of either official or at least
> unofficial / "voluntary" release criteria. You are welcome to propose ideas
> about possible list of such titles. Regularly running conformance tests on
> specific hardware is also good, but in this case testers must be aware of known
> issues - failing tests sometimes mean known bugs in drivers, whereas if a game
> worked in the past but regressed it's definitely a wine problem.
>
> As for low risk, it's unfortunately difficult to assess, as, for example, it
> often happens that a relatively obvious, simple and correct fix breaks things
> because it exposes previously hidden bugs.
>
> Just my 0.02 ? :).
>
>
>


I think most of the participants in this thread thus far recognize the
complexity of Wine and the difficulty of the task at hand.  I do
believe however, that Vitaliy's original arguement still stands.  Are
we working to make Wine 1.0 be the best at running applications that
Wine has ever been?  If so then reverting recent patches which break
things is a good idea.  If we're _only_ concerned about those 4 listed
applications and those still work and the status of other regressions
isn't as important then we continue and leave in the regressions.

So it comes down to: Ship with known regressions, or ship with as few
regressions as possible, even if it means reverting patches which may
fix some things but break others.

I think for the sake of 1.0 we _should_ revert known breakages, and
reapply them after 1.0 and attempt to properly fix them.  I'd love to
see a Wine 1.0 that is, as Linus calls them, one of those 'magical
releases' that just works and has almost no regressions.

-Zach


From wine-devel at kievinfo.com  Sun May 11 10:34:56 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 11 May 2008 09:34:56 -0600
Subject: Lots of regressions in games in last few versions
In-Reply-To: <48270982.5050507@inbox.lv>
References: <482646B7.5010105@kievinfo.com>
	<48264B80.7080601@sprintpcs.com>	<48264E0D.4000003@kievinfo.com>
	<48270982.5050507@inbox.lv>
Message-ID: <48271220.5070502@kievinfo.com>

Alexander Dorofeyev wrote:
> Vitaliy Margolen wrote:
>> James McKenzie wrote:
>>> Vitaliy Margolen wrote:
>>>> Several latest releases introduced lots and lots of regressions to a 
>>>> point that no games run as-is. Considering that we are at the code 
>>>> freeze, I'd like to see all patches that cause regressions, and all 
>>>> patches that depend on them starting from wine-0.9.58 be reverted.
>>>>
>>>> Also each patch to have a conformance test and statement which games 
>>>> where tested and what problems were fixed with each patch.
>>>>
>>>> Bugs: 13120, 13110, 13101, 13086 and on and on and on.
>>>>
>>>> Can some one explain what's the deal with games not working full 
>>>> screen? Why are there are of the sudden problems with pixel formats? 
>>>> Why lots of games crashing ActivatingContext? Why most games don't 
>>>> work anymore on ATI?
>>>>
>>>>   
>> I'd like to trust all developers to make right decisions about what patches 
>> are low risk and which have to be tested with loads of apps. But it seems I 
>> can't. And no one saying what might break if some patch gets committed. And 
>> of course I understand that most things can't be tested with conformance 
>> tests there. But at least a minimum of several major titles have to be 
>> tested for regressions.
>>
>>
>> Vitaliy.
> 
> Vitaliy,
> 
> I mostly use wine for games, and I agree with you that regressions with games 
> regularly appear (not that it's so different from any other area whenever 
> there's active development) and it sucks. To some extent, tests may help, but, 
> unfortunately, even with tests things are still rather fragile. One reason is 
> many different codepaths and variables that affect how wined3d works. To give an 
> example, with an old game like Starcraft, you would have this:
> 
> 1) DirectDrawRenderer: gdi or opengl
> 
> if opengl, then
> 
> 2) EXT_paletted_texture offered by driver or not
> 3) ARB_fragment_program offered or not
> 4) PBO available or not
> 5) various RenderTargetLockMode settings
> 6) various OffscreenRenderingMode settings
> 
> Running tests on one machine may miss many breakages because of so many 
> variables. On top of that, add the hazard of buggy and broken drivers.

I understand that. However the person making a change should know which path 
is it. And have a hardware that can use this path. If not, then this patch 
should be tested by others with such hardware.

> If we want to guarantee no regressions in major game titles, we must have a list 
> of these titles and probably also volunteers who care about games to regularly 
We already have lots of people who using latest GIT. I'm talking about 
regressions that were introduced several versions ago and still not fixed.

> As for low risk, it's unfortunately difficult to assess, as, for example, it 
> often happens that a relatively obvious, simple and correct fix breaks things 
> because it exposes previously hidden bugs.
If developer can not tell if this is a hi risk or not, then such patch have 
to be marked as hi risk and should not be accepted while we are in the code 
freeze. Unless number of people test this patch on different hardware with 
different software and verify it's functionality.

We add more and more features to d3d which is wrong. This is exact point of 
code-freeze to accept low rusk fixes only.

Vitaliy


From julliard at winehq.org  Sun May 11 10:56:47 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sun, 11 May 2008 17:56:47 +0200
Subject: Lots of regressions in games in last few versions
In-Reply-To: <b050a5e70805110834n71484c1aqf65ca9fbc1ed1336@mail.gmail.com>
	(Zachary Goldberg's message of "Sun, 11 May 2008 11:34:34 -0400")
References: <482646B7.5010105@kievinfo.com> <48264B80.7080601@sprintpcs.com>
	<48264E0D.4000003@kievinfo.com> <48270982.5050507@inbox.lv>
	<b050a5e70805110834n71484c1aqf65ca9fbc1ed1336@mail.gmail.com>
Message-ID: <87lk2g96m8.fsf@wine.dyndns.org>

"Zachary Goldberg" <zgs at seas.upenn.edu> writes:

> I think most of the participants in this thread thus far recognize the
> complexity of Wine and the difficulty of the task at hand.  I do
> believe however, that Vitaliy's original arguement still stands.  Are
> we working to make Wine 1.0 be the best at running applications that
> Wine has ever been?  If so then reverting recent patches which break
> things is a good idea.  If we're _only_ concerned about those 4 listed
> applications and those still work and the status of other regressions
> isn't as important then we continue and leave in the regressions.

The goal is to ship with as few bugs as possible, whether they are
regressions or not doesn't matter for users affected by the bug. I see
no evidence that Wine as of two months ago was so wonderfully stable
that going back to it would magically yield a bug-free 1.0.

So yes, recent changes have caused regressions, just like about any
other change in Wine. That's what code freeze is all about: try to fix
the existing problems (including regressions) without introducing new
ones. We've been in a code freeze for only a week now, I think it's a
bit early to admit defeat and decide that we can't fix things without
blindly reverting patches.

-- 
Alexandre Julliard
julliard at winehq.org


From mpartap at gmx.net  Sun May 11 11:04:46 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Sun, 11 May 2008 18:04:46 +0200
Subject: Lots of regressions in games in last few versions
In-Reply-To: <53e3a9930805110018l52beb81are2efe0379d2a6ed8@mail.gmail.com>
References: <482646B7.5010105@kievinfo.com>
	<53e3a9930805110018l52beb81are2efe0379d2a6ed8@mail.gmail.com>
Message-ID: <4827191E.5050501@gmx.net>

Tom Wickline schrieb:
> Well its not only Games, if you install office 2007 NOTHING works with RC-1!
> You have to revert back to 0.9.59 for it to work the best it ever did, then
> it's all down hill from each release forward ......As it looks Wine
> 1.0 will be a huge POS......
i don't even see the point of a 1.0 release at this point in time. This project has been a work in 
progress since 15 years. Why the heck has it been decided to do a 'gold' release *now* anyways? This 
actually resembles microsoft's own release policy: set a target date and deliver at that time, 
whatever reasons might speak against that. Why rush 1.0 out of the door? Me personally does not see 
any advantages to name it 1.0 (instead of f.e. 0.9.71), except that development has 'stabilized' 
(i.e. slowed down) - which obviously has not resulted in a more stable product. Anyone in the knows, 
please enlighten me on the motivations behind a release date in June 2008 for v1.0, i simply don't 
get it.
regards marcel.


From alexd4 at inbox.lv  Sun May 11 11:03:05 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Sun, 11 May 2008 19:03:05 +0300
Subject: Lots of regressions in games in last few versions
In-Reply-To: <48271220.5070502@kievinfo.com>
References: <482646B7.5010105@kievinfo.com>
	<48264B80.7080601@sprintpcs.com>	<48264E0D.4000003@kievinfo.com>
	<48270982.5050507@inbox.lv> <48271220.5070502@kievinfo.com>
Message-ID: <482718B9.1040802@inbox.lv>

Vitaliy Margolen wrote:
> If developer can not tell if this is a hi risk or not, then such patch 
> have to be marked as hi risk and should not be accepted while we are in 
> the code freeze. Unless number of people test this patch on different 
> hardware with different software and verify it's functionality.
> 
> We add more and more features to d3d which is wrong. This is exact point 
> of code-freeze to accept low rusk fixes only.
Some of those changes that date back to 0.9.58 or so obviously happened before 
the commitment to code freeze.

But I think that testing and reverting any patches submitted during code freeze 
that cause d3d regressions and can't be fixed real quick is a good idea.


From wine-devel at kievinfo.com  Sun May 11 11:15:46 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 11 May 2008 10:15:46 -0600
Subject: Lots of regressions in games in last few versions
In-Reply-To: <482718B9.1040802@inbox.lv>
References: <482646B7.5010105@kievinfo.com>	<48264B80.7080601@sprintpcs.com>	<48264E0D.4000003@kievinfo.com>	<48270982.5050507@inbox.lv>
	<48271220.5070502@kievinfo.com> <482718B9.1040802@inbox.lv>
Message-ID: <48271BB2.4050101@kievinfo.com>

Alexander Dorofeyev wrote:
> Vitaliy Margolen wrote:
>> If developer can not tell if this is a hi risk or not, then such patch 
>> have to be marked as hi risk and should not be accepted while we are in 
>> the code freeze. Unless number of people test this patch on different 
>> hardware with different software and verify it's functionality.
>>
>> We add more and more features to d3d which is wrong. This is exact point 
>> of code-freeze to accept low rusk fixes only.
> Some of those changes that date back to 0.9.58 or so obviously happened before 
> the commitment to code freeze.
> 
> But I think that testing and reverting any patches submitted during code freeze 
> that cause d3d regressions and can't be fixed real quick is a good idea.
> 
They have to be fixed. That's the point. And if it takes big changes to fix 
it, then those patches have to be reverted.

Again I'm not talking about what should have been done or that some one 
missed something pretty big. That's the way development goes. I'm talking 
about the same thing Alexandre said - if we have a regression that can not 
be easily fixed the patch that caused the regression have to be taken out.

Also no more additional features that open up a can of worms! No more 
additional caps that all games starting to use! (until after 1.0)

Vitaliy.


From zgs at seas.upenn.edu  Sun May 11 11:21:55 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Sun, 11 May 2008 12:21:55 -0400
Subject: Lots of regressions in games in last few versions
In-Reply-To: <87lk2g96m8.fsf@wine.dyndns.org>
References: <482646B7.5010105@kievinfo.com> <48264B80.7080601@sprintpcs.com>
	<48264E0D.4000003@kievinfo.com> <48270982.5050507@inbox.lv>
	<b050a5e70805110834n71484c1aqf65ca9fbc1ed1336@mail.gmail.com>
	<87lk2g96m8.fsf@wine.dyndns.org>
Message-ID: <b050a5e70805110921u70effd8eidcbd4e06aba5cd87@mail.gmail.com>

Alexandre,

On Sun, May 11, 2008 at 11:56 AM, Alexandre Julliard
<julliard at winehq.org> wrote:
> "Zachary Goldberg" <zgs at seas.upenn.edu> writes:
>
>> I think most of the participants in this thread thus far recognize the
>> complexity of Wine and the difficulty of the task at hand.  I do
>> believe however, that Vitaliy's original arguement still stands.  Are
>> we working to make Wine 1.0 be the best at running applications that
>> Wine has ever been?  If so then reverting recent patches which break
>> things is a good idea.  If we're _only_ concerned about those 4 listed
>> applications and those still work and the status of other regressions
>> isn't as important then we continue and leave in the regressions.
>
> The goal is to ship with as few bugs as possible, whether they are
> regressions or not doesn't matter for users affected by the bug. I see
> no evidence that Wine as of two months ago was so wonderfully stable
> that going back to it would magically yield a bug-free 1.0.
>

I agree, and I'm of course not talking about reverting the entire
tree.  Vitaliy has mentioned a few specific patches though (mostly in
d3d I think) which have caused some noise in the gaming realm.  Those
kinds of things are what I'm talking about and...

> So yes, recent changes have caused regressions, just like about any
> other change in Wine. That's what code freeze is all about: try to fix
> the existing problems (including regressions) without introducing new
> ones. We've been in a code freeze for only a week now, I think it's a
> bit early to admit defeat and decide that we can't fix things without
> blindly reverting patches.
>

I think we're on the same page here.  If we can narrow down
regressions which require large changes (too large to go in during a
code freeze or not enough time before release) the proper course of
action for the sake of having as few bugs as possible in 1.0 is to
revert those specific regression-introducing patches.

You're right though, it has only been a week.  These kinds of things
may be best done in another week or two.

> --
> Alexandre Julliard
> julliard at winehq.org
>


--Zach


From dank at kegel.com  Sun May 11 11:51:53 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 11 May 2008 09:51:53 -0700
Subject: New winetricks 20080511: dotnet11 working again, new verb fontfix
In-Reply-To: <a71bd89a0805110629y3e80ef08l39f62b5e85095000@mail.gmail.com>
References: <a71bd89a0805110629y3e80ef08l39f62b5e85095000@mail.gmail.com>
Message-ID: <a71bd89a0805110951m6caebe5tb565c970c930f988@mail.gmail.com>

>  I haven't looked at whether dotnet20 also needs the font kludges...

Oh, ok, I fixed dotnet20, too.  And wsh56 no longer requires you to
run vcrun6 first (it does it for you).

Note:  dotnet11 and dotnet20 may crash on startup if you have
msttcorefonts installed outside of Wine!
(That's because corefonts does nothing if you already have those
fonts installed on the base Linux system; the font installers
just go "Oh, he already has this?  Shrug."   This is kind of nasty;
people shouldn't have to uninstall msttcorefonts to run winetricks.
But I don't have a good fix for it yet.)

Online as always at
  http://kegel.com/wine/winetricks
or
  http://winezeug.googlecode.com


From julliard at winehq.org  Sun May 11 12:15:31 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sun, 11 May 2008 19:15:31 +0200
Subject: Lots of regressions in games in last few versions
In-Reply-To: <b050a5e70805110921u70effd8eidcbd4e06aba5cd87@mail.gmail.com>
	(Zachary Goldberg's message of "Sun, 11 May 2008 12:21:55 -0400")
References: <482646B7.5010105@kievinfo.com> <48264B80.7080601@sprintpcs.com>
	<48264E0D.4000003@kievinfo.com> <48270982.5050507@inbox.lv>
	<b050a5e70805110834n71484c1aqf65ca9fbc1ed1336@mail.gmail.com>
	<87lk2g96m8.fsf@wine.dyndns.org>
	<b050a5e70805110921u70effd8eidcbd4e06aba5cd87@mail.gmail.com>
Message-ID: <87ej8892z0.fsf@wine.dyndns.org>

"Zachary Goldberg" <zgs at seas.upenn.edu> writes:

> I agree, and I'm of course not talking about reverting the entire
> tree.  Vitaliy has mentioned a few specific patches though (mostly in
> d3d I think) which have caused some noise in the gaming realm.

If Vitaliy or anybody else think a patch must be reverted, they need to
point out the exact patch, explain why it can't be fixed properly for
1.0, and what other bugs will be reintroduced by reverting it.

Reverting a patch is not a magical cure, and it can be just as risky as
adding one, so it's not something we can do during code freeze without a
detailed understanding of the consequences.

-- 
Alexandre Julliard
julliard at winehq.org


From zgs at seas.upenn.edu  Sun May 11 12:27:40 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Sun, 11 May 2008 13:27:40 -0400
Subject: Lots of regressions in games in last few versions
In-Reply-To: <87ej8892z0.fsf@wine.dyndns.org>
References: <482646B7.5010105@kievinfo.com> <48264B80.7080601@sprintpcs.com>
	<48264E0D.4000003@kievinfo.com> <48270982.5050507@inbox.lv>
	<b050a5e70805110834n71484c1aqf65ca9fbc1ed1336@mail.gmail.com>
	<87lk2g96m8.fsf@wine.dyndns.org>
	<b050a5e70805110921u70effd8eidcbd4e06aba5cd87@mail.gmail.com>
	<87ej8892z0.fsf@wine.dyndns.org>
Message-ID: <b050a5e70805111027j463a5f81ta666a5a41910c4f8@mail.gmail.com>

On Sun, May 11, 2008 at 1:15 PM, Alexandre Julliard <julliard at winehq.org> wrote:
> "Zachary Goldberg" <zgs at seas.upenn.edu> writes:
>
>> I agree, and I'm of course not talking about reverting the entire
>> tree.  Vitaliy has mentioned a few specific patches though (mostly in
>> d3d I think) which have caused some noise in the gaming realm.
>
> If Vitaliy or anybody else think a patch must be reverted, they need to
> point out the exact patch, explain why it can't be fixed properly for
> 1.0, and what other bugs will be reintroduced by reverting it.
>
> Reverting a patch is not a magical cure, and it can be just as risky as
> adding one, so it's not something we can do during code freeze without a
> detailed understanding of the consequences.
>
> --
> Alexandre Julliard
> julliard at winehq.org
>

Fair enough.  I'll go through bugzilla on Tuesday (when finals end)
and see if I can narrow down some problem patches.


-- 
Zachary Goldberg
Computer Science & Engineering
Electrical Captain of Penn Electric Race Team
School of Engineering at the University of Pennsylvania


From wine-devel at kievinfo.com  Sun May 11 14:43:19 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 11 May 2008 13:43:19 -0600
Subject: Stop flooding with EV_TXEMPTY and EV_RXCHAR
In-Reply-To: <1210523267.5135.6.camel@ip6-localhost>
References: <1210523267.5135.6.camel@ip6-localhost>
Message-ID: <48274C57.6030105@kievinfo.com>

Michael Karcher wrote:
> Do not generate an EV_TXEMPTY event if the transmitter is empty,
> but if it got empty. Do not generate a EV_RXCHAR event if some
> bytes are in the queue, but if some new bytes got into the queue.
> Handle a Linux quirk that TIOCGICOUNT might report characters that
> TIOCINQ does not yet report.
> 
> Add some further TRACE calls to aid debugging.

Please one change at a time (as a separate patch). In case of possible 
regressions it would be much easier to catch what was the cause.

Vitaliy.


From austinenglish at gmail.com  Sun May 11 18:52:44 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 11 May 2008 18:52:44 -0500
Subject: Lots of regressions in games in last few versions
In-Reply-To: <482646B7.5010105@kievinfo.com>
References: <482646B7.5010105@kievinfo.com>
Message-ID: <b6bb06270805111652pac0c3b1oc19cf53898b5b7e3@mail.gmail.com>

13120 - I'll run the test tomorrow if I can reproduce/no one has by then.
13110 - no one requested a regression test. I've requested it now.
13101 - not a regression
13086 - not sure if it's always existed or a regression. I asked for
clarification.

If anyone can identify regressions that haven't been bisected, shoot
me an e-mail. I've got plenty of CPU/time to kill.


From wine-devel at kievinfo.com  Sun May 11 19:26:52 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 11 May 2008 18:26:52 -0600
Subject: [PATCH 2/2] wined3d: Activate context for the right target in
	surface_blt_to_drawable.
In-Reply-To: <482776B6.1090106@inbox.lv>
References: <482776B6.1090106@inbox.lv>
Message-ID: <48278ECC.3090203@kievinfo.com>

Alexander Dorofeyev wrote:
> 
> Fixes http://bugs.winehq.org/show_bug.cgi?id=12890 that affects several 
> games locking front buffer when using readtex RT lock mode.
> ---

> -    ActivateContext(device, device->render_targets[0], CTXUSAGE_BLIT);
> +    ActivateContext(device, (IWineD3DSurface*)This, CTXUSAGE_BLIT);

I think Stefan said something about this not being correct. The blitting is 
going into the render target not the current surface. In your case if the 
surface is not the render target, then it's not being properly selected.

Vitaliy.


From dank at kegel.com  Sun May 11 19:37:16 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 11 May 2008 17:37:16 -0700
Subject: Lots of regressions in games in last few versions
Message-ID: <a71bd89a0805111737x79df01d3y121bf5dc89a2f29b@mail.gmail.com>

Marcel wrote:
> i don't even see the point of a 1.0 release at this point in time.
> This project has been a work in progress since 15 years.
> Why the heck has it been decided to do a 'gold' release *now* anyways?

To get lots more people to try it and report bugs, so it can improve faster.

And to get the word out about its rapid progress in the last two years.
Most people still think Wine can't wipe its nose.

Now, for some users, Wine still can't wipe its nose -- it all depends on the
app you try.  But it seems that "linux wine sucks" pulls only about
half as many hits as "linux wine amazing" in a web search, so we
must be doing something right lately.
- Dan


From jjmckenzie51 at sprintpcs.com  Sun May 11 21:19:14 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sun, 11 May 2008 19:19:14 -0700
Subject: Lots of regressions in games in last few versions
In-Reply-To: <a71bd89a0805111737x79df01d3y121bf5dc89a2f29b@mail.gmail.com>
References: <a71bd89a0805111737x79df01d3y121bf5dc89a2f29b@mail.gmail.com>
Message-ID: <4827A922.1070400@sprintpcs.com>

Dan Kegel wrote:
> Marcel wrote:
>   
>> i don't even see the point of a 1.0 release at this point in time.
>> This project has been a work in progress since 15 years.
>> Why the heck has it been decided to do a 'gold' release *now* anyways?
>>     
>
> To get lots more people to try it and report bugs, so it can improve faster.
>
>   
And to move the project forward.  The more it is used, the more problems 
that can be discovered and, hopefully, corrected.
> And to get the word out about its rapid progress in the last two years.
> Most people still think Wine can't wipe its nose.
>   
I agree.  I've seen a great deal of progress in the last few months that 
I have been here.
> Now, for some users, Wine still can't wipe its nose -- it all depends on the
> app you try.  But it seems that "linux wine sucks" pulls only about
> half as many hits as "linux wine amazing" in a web search, so we
> must be doing something right lately.
>   
This is true.  However, this may reverse as people attempt to use Wine.

James



From wine-devel at kievinfo.com  Sun May 11 22:00:29 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 11 May 2008 21:00:29 -0600
Subject: Lots of regressions in games in last few versions
In-Reply-To: <a71bd89a0805111737x79df01d3y121bf5dc89a2f29b@mail.gmail.com>
References: <a71bd89a0805111737x79df01d3y121bf5dc89a2f29b@mail.gmail.com>
Message-ID: <4827B2CD.200@kievinfo.com>

Dan Kegel wrote:
> Marcel wrote:
>> i don't even see the point of a 1.0 release at this point in time.
>> This project has been a work in progress since 15 years.
>> Why the heck has it been decided to do a 'gold' release *now* anyways?
> 
> To get lots more people to try it and report bugs, so it can improve faster.
This is questionable. I can point to several bug reports that have several 
dozen people reporting problems and that are still open for years. So just 
saying more bug reports results into better Wine is not true.

What it will do is put huge strain on people looking at bugzilla. And poor 
bug analysis. Just look at how many d3d related bugs and how much analysis 
in each. I'd say about 60% of all of those reports are duplicate, caused by 
system misconfiguration, conflicts with other software (compiz anyone?) or 
just plain invalid.

Not to take anything away from all the hard work d3d developers did and 
continue doing.

> And to get the word out about its rapid progress in the last two years.
> Most people still think Wine can't wipe its nose.
> 
> Now, for some users, Wine still can't wipe its nose -- it all depends on the
> app you try.  But it seems that "linux wine sucks" pulls only about
> half as many hits as "linux wine amazing" in a web search, so we
> must be doing something right lately.

For most people yeah it will be a surprise. Until they hit first major 
problem. Which will put them back into windows land. You see there are much 
more people out there that use PCs as ... tools. Those tools either work or 
they don't. Wine just does not cut it. It's a toy not a tool.

Even targeted apps don't work perfectly - have some problems here and there. 
People won't stand that. They already feed up with windows...

The only loyal public Wine can have is gamers. And we still ignoring this fact.

Oh and the whole point of wine-1.0 - and the way it's being presented seems 
like a joke to me. Give me a break 4 apps?! 3 of which being direct 
competitors to native Linux applications! And such an old versions [97] that 
no one even uses them anymore.

If anything we should be emphasizing that the code freeze is to stabilize 
Wine and fix bugs. ALL bugs regardless of the app.

Vitaliy


From jjmckenzie51 at sprintpcs.com  Sat May 10 22:35:15 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 10 May 2008 20:35:15 -0700
Subject: Lots of regressions in games in last few versions
In-Reply-To: <48265AB0.3040004@kievinfo.com>
References: <482646B7.5010105@kievinfo.com> <48264B80.7080601@sprintpcs.com>
	<48264E0D.4000003@kievinfo.com> <48265499.1070102@sprintpcs.com>
	<48265AB0.3040004@kievinfo.com>
Message-ID: <48266973.2030908@sprintpcs.com>

Vitaliy Margolen wrote:
> James McKenzie wrote:
>   
>> There were several 'fixes' to this problem in the issue.  And Stephan 
>> continues to troubleshoot the problem.  However, this is a VOLUNTEER 
>> effort and most of us have 'real lives' to live.  I would gladly work on 
>> rich edit problems as they directly affect a program that I use.  
>> However, I don't have enough hours in the day to attempt to work on 
>> them.  I picked up issue 6254, the lockup problem, and a patch proposed 
>>     
> There are no patches that fix this problem (however hackish they might be). 
> And it looks like a design problem. That's why someone with knowledge of the 
> d3d needs to look at it.
>
>   
I agree that a D3D expert needs to fix this problem, pronto.  However, 
I'm not one of them and it looks like at least one of them proposed a 
fix in the issue.
>> We need to do serious testing before any release.  I lived in the QA 
>>     
> Yes everything have to be tested. The business of sending patches that do 
> "the right thing" have to stop. We all know that m$ always does things 
> backwards. And most apps relay on that.
>
>   
Again, do we have enough time to test every combination of products in 
the short release to release schedule.  I would say NO.  However, this 
schedule is not of my doing.  My saying "Release no software before its 
time" applies in many cases.
>> 'arena' for many years.  However, we do have limited time and we don't 
>> have all of the resources we'd like to have.  Thus, some problems appear 
>> in release code and we have to clean up the mess afterwards.  In the 
>>     
> No one should be cleaning up mess. There shouldn't be one in the first 
> place. Or if some one got it in, it should be his responsibility to fix it, 
> or get the whole damn thing out.
>
>   
I agree.
>> case of the issue you pointed out, the simple, but incorrect fix, was to 
>> back out the change and then re-introduce it after some major work.  
>> This would have delayed the improvement in framerates for many games and 
>> productivity programs.
>>     
>
> And I tend to disagree with you there. I can point to number of things that 
> weren't right to begin with. And it was clear right from the start. Yet they 
> still not fixed, because now it's not trivial to fix the introduced 
> problems. Or the whole idea was flowed and have to be redone.
>
>   
Then we fix it or redesign/rebuild.  Our reputations depend on it.  The 
project depends on it.  And this is what killed Project Odin.
> And I don't see what's so wrong with having 'git revert' as valid option for 
> any problem patch? If problem is identified and it's not getting fixed 
> before the next release - pull it out. This is the only option with our 
> linear development where we don't have stable and development branches.
>
>   
I agree.  We need a stable and development branching.  We will need this 
so we can fix problems in 1.0 and to move towards 1.2.  This will make 
AJs job miserable, but this has to be done in order to keep what is what 
straight.  Would git be up to this task?

James McKenzie



From dmitry at codeweavers.com  Sun May 11 23:08:23 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 12 May 2008 13:08:23 +0900
Subject: Lots of regressions in games in last few versions
References: <a71bd89a0805111737x79df01d3y121bf5dc89a2f29b@mail.gmail.com>
	<4827B2CD.200@kievinfo.com>
Message-ID: <4B6C8A19939E43DBB8D78C30ED28E48A@DMITRY>

"Vitaliy Margolen" <wine-devel at kievinfo.com> wrote:

> For most people yeah it will be a surprise. Until they hit first major 
> problem. Which will put them back into windows land. You see there are much 
> more people out there that use PCs as ... tools. Those tools either work or 
> they don't. Wine just does not cut it. It's a toy not a tool.

Probably I'll tell you an esoteric thing, but believe it that thousands of
people are running Winword, Excel, Outlook, Visio, Quicken, Project, and many
other applications every doing their daily job.

-- 
Dmitry.


From wine-devel at kievinfo.com  Sun May 11 23:31:39 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 11 May 2008 22:31:39 -0600
Subject: Lots of regressions in games in last few versions
In-Reply-To: <b6bb06270805111652pac0c3b1oc19cf53898b5b7e3@mail.gmail.com>
References: <482646B7.5010105@kievinfo.com>
	<b6bb06270805111652pac0c3b1oc19cf53898b5b7e3@mail.gmail.com>
Message-ID: <4827C82B.5090401@kievinfo.com>

Austin English wrote:
> 13120 - I'll run the test tomorrow if I can reproduce/no one has by then.
> 13110 - no one requested a regression test. I've requested it now.
> 13101 - not a regression
> 13086 - not sure if it's always existed or a regression. I asked for
> clarification.
> 
> If anyone can identify regressions that haven't been bisected, shoot
> me an e-mail. I've got plenty of CPU/time to kill.
I'd appreciate it if you can do a regression testing for bug 12272? Game 
blood 2 with demo. Between wine-0.9.44 and wine-0.9.45. You will need to use 
native dinput.dll. Start the game (enter, enter, enter) and move the mouse 
around. You should see that with .45 it's really jumpy and in .44 it's nice 
and smooth.

I think it's either ddraw or d3d. But might be some other place.

Vitaliy


From wine-devel at kievinfo.com  Mon May 12 00:12:29 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 11 May 2008 23:12:29 -0600
Subject: Lots of regressions in games in last few versions
In-Reply-To: <4B6C8A19939E43DBB8D78C30ED28E48A@DMITRY>
References: <a71bd89a0805111737x79df01d3y121bf5dc89a2f29b@mail.gmail.com>
	<4827B2CD.200@kievinfo.com>
	<4B6C8A19939E43DBB8D78C30ED28E48A@DMITRY>
Message-ID: <4827D1BD.9020205@kievinfo.com>

Dmitry Timoshkov wrote:
> "Vitaliy Margolen" <wine-devel at kievinfo.com> wrote:
> 
>> For most people yeah it will be a surprise. Until they hit first major 
>> problem. Which will put them back into windows land. You see there are 
>> much more people out there that use PCs as ... tools. Those tools 
>> either work or they don't. Wine just does not cut it. It's a toy not a 
>> tool.
> 
> Probably I'll tell you an esoteric thing, but believe it that thousands of
> people are running Winword, Excel, Outlook, Visio, Quicken, Project, and 
> many
> other applications every doing their daily job.
> 
Oh yes they do, on windows that is. How can they be running them on Wine
of all the apps listed don't work?

Word    - gold    http://appdb.winehq.org/objectManager.php?sClass=application&iId=10
Excel   - no data http://appdb.winehq.org/objectManager.php?sClass=application&iId=11
Outlook - garbage http://appdb.winehq.org/objectManager.php?sClass=application&iId=34
Visio   - garbage http://appdb.winehq.org/appview.php?iAppId=119
Quicken - garbage/bronze http://appdb.winehq.org/appview.php?iAppId=107
Project - garbage http://appdb.winehq.org/objectManager.php?sClass=application&iId=446
Money   - garbage http://appdb.winehq.org/objectManager.php?sClass=application&iId=79

Where are you seeing people running them? Oh sorry Word sorta works. Or you
talking about something else not Wine? We are talking about vanilla Wine
here not Crossover Office no matter how wonderful it is.

Vitaliy.


From dank at kegel.com  Mon May 12 01:57:39 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 11 May 2008 23:57:39 -0700
Subject: Lots of regressions in games in last few versions
Message-ID: <a71bd89a0805112357k63076c90sc1a74f0fd8e0b953@mail.gmail.com>

Vitaliy wrote:
>> To get lots more people to try it and report bugs, so it can improve faster.
>This is questionable. I can point to several bug reports that have several
>dozen people reporting problems and that are still open for years. So just
>saying more bug reports results into better Wine is not true.

Sure, there are going to be hard bugs.
Doesn't matter; on the whole, if we don't know about a bug, we can't fix it.
And we need users to find the bugs for us, since only they really know
how to use the apps.

> Even targeted apps don't work perfectly - have some problems here and there.
> People won't stand that. They already feed up with windows...

When you get the bugs down below a certain point for
a particular app, something funny happens: people
start believing.  And at that point they are willing to
forgive a few issues.

> The only loyal public Wine can have is gamers. And we still ignoring this fact.

Because it's not a fact.  It's a subjective conclusion you reached,
but I do not share that opinion.  Gamers are just as finicky
as anyone else.

> Oh and the whole point of wine-1.0 - and the way it's being
> presented seems like a joke to me. Give me a break 4 apps?!
> 3 of which being direct competitors to native Linux applications!
> And such an old versions [97] that no one even uses them anymore.

The release criteria are more about managing people's
expectations.   Underpromising and overdelivering.
They're *supposed* to seem modest.  Doesn't mean we
don't care about other apps.

> If anything we should be emphasizing that the code freeze is
> to stabilize Wine and fix bugs. ALL bugs regardless of the app.

I rather thought we were.  That's the whole point of
http://wiki.winehq.org/PlatinumRegressionHunt

I'm not sure what you're angry about.
None of us have that much control over exactly
which way wine develops.  We all scratch our own itches,
and it improves at its own pace.
What more do you want?
- Dan


From dank at kegel.com  Mon May 12 02:13:02 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 12 May 2008 00:13:02 -0700
Subject: Coaxing appdb maintainers into testing their apps with rc1?
Message-ID: <a71bd89a0805120013k246f73a9pa3ce8fb00fe6b97@mail.gmail.com>

It doesn't look like many people are paying attention to
http://wiki.winehq.org/PlatinumRegressionHunt

Think it would be useful to email all the app maintainers and
ask them to pretty please test their apps with rc1?


From alexd4 at inbox.lv  Mon May 12 03:50:47 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Mon, 12 May 2008 11:50:47 +0300
Subject: [PATCH 2/2] wined3d: Activate context for the right target in
	surface_blt_to_drawable.
In-Reply-To: <48278ECC.3090203@kievinfo.com>
References: <482776B6.1090106@inbox.lv> <48278ECC.3090203@kievinfo.com>
Message-ID: <482804E7.2000800@inbox.lv>

Vitaliy Margolen wrote:
> Alexander Dorofeyev wrote:
>> Fixes http://bugs.winehq.org/show_bug.cgi?id=12890 that affects several 
>> games locking front buffer when using readtex RT lock mode.
>> ---
> 
>> -    ActivateContext(device, device->render_targets[0], CTXUSAGE_BLIT);
>> +    ActivateContext(device, (IWineD3DSurface*)This, CTXUSAGE_BLIT);
> 
> I think Stefan said something about this not being correct. The blitting is 
> going into the render target not the current surface. In your case if the 
> surface is not the render target, then it's not being properly selected.
> 
> Vitaliy.

Was it about blitting in general or surface_blt_to_drawable? Note that 
this routine isn't for blitting in the usual gdi or directx sense (as in 
from one bitmap or surface to another) - that code is in BltOverride. 
surface_blt_to_drawable is helper function for 
LoadLocation(...,INDRAWABLE,...) - which isn't supposed to be called for 
regular textures or offscreenplain surfaces.


From stefan at codeweavers.com  Mon May 12 04:30:45 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 12 May 2008 11:30:45 +0200
Subject: [PATCH 2/2] wined3d: Activate context for the right target in
	surface_blt_to_drawable.
In-Reply-To: <482804E7.2000800@inbox.lv>
References: <482776B6.1090106@inbox.lv> <48278ECC.3090203@kievinfo.com>
	<482804E7.2000800@inbox.lv>
Message-ID: <200805121130.45497.stefan@codeweavers.com>

Am Montag, 12. Mai 2008 10:50:47 schrieb Alexander Dorofeyev:
> Vitaliy Margolen wrote:
> > I think Stefan said something about this not being correct. The blitting
> > is going into the render target not the current surface. In your case if
> > the surface is not the render target, then it's not being properly
> > selected.
> Was it about blitting in general or surface_blt_to_drawable?
My comment was about the read-from-drawable code, this is writing to the 
drawable. The patch is correct as far as I can see.

(The patch that I said was wrong was doing about the opposite in the 
drawable->texture copy path)



From jeffzaroyko at gmail.com  Mon May 12 04:48:21 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Mon, 12 May 2008 09:48:21 +0000 (UTC)
Subject: Spec OpenGL benchmarks
References: <a71bd89a0805091931k6e91d0f5nfee3cf7042a8dbea@mail.gmail.com>
	<20080510074617.14260@gmx.net>
Message-ID: <loom.20080512T094414-506@post.gmane.org>

Roderick Colenbrander <thunderbird2k <at> gmx.net> writes:

> 
> > On a whim, I tried the oldest SPEC OpenGL benchmark, SPECviewperf 6.

> > On one machine,
> > $ cd ".wine/drive_c/Program Files/SPECopc/SPECviewperf 6.1.2"
> > $ wine cmd /c RunLight04.bat
> > produced a proud 3 frames per second, woot!
> > - Dan
> > 

> Second I expect the performance on a Geforce / Radeon card to reasonable to
good. For the best performance
> you likely need a Quadro or FireGL the reason being that the drivers of those
cards have been optimized for
> CAD-functionality which is basically what the Spec-tests test.
> 
> Roderick

Out of curiosity, I also tried Dan's test and I also get an average of 3 frames
per second with a GeForce 8800 GTS, 100.14.19.

Jeff





From contess at sancharnet.in  Mon May 12 03:02:52 2008
From: contess at sancharnet.in (Syam Babu.S)
Date: Mon, 12 May 2008 13:32:52 +0530
Subject: Where does richedit20.dll fit in the to-do list?
Message-ID: <000001c8b406$a4a06e40$ede14ac0$@in>

Dear Sir,

While installing an application the installation stops for a long while
copying ,Richedit20.dll, and finally I get the message cannot copy file may
be disk full.

I have more than 10 GB free.

Can you enlighten me please ?

Regards, Syam Babu

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080512/4ec6c888/attachment.htm 

From kgbricola at web.de  Mon May 12 05:54:45 2008
From: kgbricola at web.de (=?ISO-8859-1?Q?Rico_Sch=FCller?=)
Date: Mon, 12 May 2008 12:54:45 +0200
Subject: Spec OpenGL benchmarks
In-Reply-To: <loom.20080512T094414-506@post.gmane.org>
References: <a71bd89a0805091931k6e91d0f5nfee3cf7042a8dbea@mail.gmail.com>	<20080510074617.14260@gmx.net>
	<loom.20080512T094414-506@post.gmane.org>
Message-ID: <482821F5.5060508@web.de>

Jeff Zaroyko wrote:
> Roderick Colenbrander <thunderbird2k <at> gmx.net> writes:
> 
>>> On a whim, I tried the oldest SPEC OpenGL benchmark, SPECviewperf 6.
> 
>>> On one machine,
>>> $ cd ".wine/drive_c/Program Files/SPECopc/SPECviewperf 6.1.2"
>>> $ wine cmd /c RunLight04.bat
>>> produced a proud 3 frames per second, woot!
>>> - Dan
>>>
> 
>> Second I expect the performance on a Geforce / Radeon card to reasonable to
> good. For the best performance
>> you likely need a Quadro or FireGL the reason being that the drivers of those
> cards have been optimized for
>> CAD-functionality which is basically what the Spec-tests test.
>>
>> Roderick
> 
> Out of curiosity, I also tried Dan's test and I also get an average of 3 frames
> per second with a GeForce 8800 GTS, 100.14.19.
> 
> Jeff

I'll just confirm that with my GeForce 8800 GTS, too. I've attached the 
output from both runs. I'd like to run the native version, but I 
couldn't get it running, yet. So the difference between wine and windows 
in the light test is really big.

Rico
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: summary_windows.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080512/92c4615f/attachment.txt 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: summary_wine.txt
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080512/92c4615f/attachment-0001.txt 

From tony.wasserka at freenet.de  Mon May 12 07:16:15 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Mon, 12 May 2008 14:16:15 +0200
Subject: d3dx9: Texturing functions
Message-ID: <E1JvWwx-0000qh-DD@www14.emo.freenet-rz.de>

> > So, the first thing I want to make sure is that we redirect the function calls correctly in order
> > to reduce double coding.
> > This means on the one hand that we should call the Extended versions of each function
> > from inside of the simpler ones (most default parameters for the Ex functions are
> > on MSDN) and on the other hand that we unify all D3DXCreateTextureFromXXEx
> > functions somehow. I don't know how Resources are stored internally, but I guess
> > the simplest would be to redirect all of them to D3DXCreateTextureFromFileInMemory, i.e.
> > when D3DXCreateTextureFromFile is called we read the file into memory and call the
> > InMemory function. I hope this shouldn't be too hard to be applied to the resource function
> > either. Of course, this should also be done at the corresponding Surface, Volume and
> > cube texture functions.
> > Also, I haven't looked too much into it yet, but I guess we could go even a step further
> > and define the CreateTextuteFromXX calls like this:
> > 1. Redirect to the corresponding D3DXCreateXFromFileInMemoryEx call
> > 2. Call D3DXCheckXRequirements
> > 3. Call IDirect3DDevice9::CreateTexture
> > 4. Lock its surface
> > 5. Call LoadSurfaceFromFileEx with it
> > 
> > This would reduce most of our coding work on LoadSurfaceFromFileEx.
> > However, there are still plenty of formats supported by the texturing functions
> > and thus, plenty of work for us to do. IIRC we once came to the decision to
> > use libraries like libpng or so to reduce that work, too, so we'd just need
> > to implement formats like .dds.
> 
> I can't remember what the differences are between the CreateTexture and
> LoadSurface functions, but this is what I'd do for the LoadSurface functions:
> 
> LoadSurfaceFromMemory (read data with the specified pixel format)
>   LoadSurfaceFromFileInMemory (parse image format, read actual data into memory)
>     LoadSurfaceFromFile (open file, read contents into memory)
> 	LoadSurfaceFromResource (open resource, read contents into memory)
>   LoadSurfaceFromSurface (read image data from a surface)
> 
> This would mean two huge chunks of code: One which parses image formats
> (LoadSurfaceFromFileInMemory), and one which handles all the resizing,
> conversion, filtering and stuff (LoadSurfaceFromMemory).

Sorry that I'm replying that late, I was a bit busy when you wrote the reply and then nearly forgot about it.
I'd agree with that design and I'll soon prepare a stub-layout for texture.c for after-code-freeze.
However, have you finished the D3DXCheckTextureRequirements code meanwhile so we can start
implementing the other functions?

Best regards,
    Tony




Unbegrenzter Speicher, Top-Spamschutz, 120 SMS und eigene E-MailDomain inkl.
http://office.freenet.de/dienste/emailoffice/produktuebersicht/power/mail/index.html



From wine-devel at kievinfo.com  Mon May 12 07:29:40 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Mon, 12 May 2008 06:29:40 -0600
Subject: Lots of regressions in games in last few versions
In-Reply-To: <a71bd89a0805112357k63076c90sc1a74f0fd8e0b953@mail.gmail.com>
References: <a71bd89a0805112357k63076c90sc1a74f0fd8e0b953@mail.gmail.com>
Message-ID: <48283834.3010307@kievinfo.com>

Dan Kegel wrote:
> I'm not sure what you're angry about.
> None of us have that much control over exactly
> which way wine develops.  We all scratch our own itches,
> and it improves at its own pace.
> What more do you want?

Stability. For things to continue working once they get fixed. Which means 
more developers have to "support" their changes - promptly address all 
issues that result from their changes. IMHO this is the way project should 
be moving forward (past 1.0)

Vitaliy.


From alex at thehandofagony.com  Mon May 12 07:31:38 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Mon, 12 May 2008 14:31:38 +0200
Subject: Coaxing appdb maintainers into testing their apps with rc1?
In-Reply-To: <a71bd89a0805120013k246f73a9pa3ce8fb00fe6b97@mail.gmail.com>
References: <a71bd89a0805120013k246f73a9pa3ce8fb00fe6b97@mail.gmail.com>
Message-ID: <200805121431.38301.alex@thehandofagony.com>

> It doesn't look like many people are paying attention to
> http://wiki.winehq.org/PlatinumRegressionHunt
>
> Think it would be useful to email all the app maintainers and
> ask them to pretty please test their apps with rc1?

Sounds like a great idea (and looks like I have some work to do for the apps I 
maintain :)  )

The AppDB doesn't have such a feature, but it should be pretty easy to make.  
I'll  try to get it done to-day.



Alexander N. S?rnes


From wine-devel at kievinfo.com  Mon May 12 07:31:50 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Mon, 12 May 2008 06:31:50 -0600
Subject: [PATCH 2/2] wined3d: Activate context for the right target in
	surface_blt_to_drawable.
In-Reply-To: <200805121130.45497.stefan@codeweavers.com>
References: <482776B6.1090106@inbox.lv>
	<48278ECC.3090203@kievinfo.com>	<482804E7.2000800@inbox.lv>
	<200805121130.45497.stefan@codeweavers.com>
Message-ID: <482838B6.9030001@kievinfo.com>

Stefan D?singer wrote:
> Am Montag, 12. Mai 2008 10:50:47 schrieb Alexander Dorofeyev:
>> Vitaliy Margolen wrote:
>>> I think Stefan said something about this not being correct. The blitting
>>> is going into the render target not the current surface. In your case if
>>> the surface is not the render target, then it's not being properly
>>> selected.
>> Was it about blitting in general or surface_blt_to_drawable?
> My comment was about the read-from-drawable code, this is writing to the 
> drawable. The patch is correct as far as I can see.
> 
> (The patch that I said was wrong was doing about the opposite in the 
> drawable->texture copy path)
> 
Ok fair enough. Thank you for explanation.

Vitaliy,


From jeffzaroyko at gmail.com  Mon May 12 08:12:17 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Mon, 12 May 2008 13:12:17 +0000 (UTC)
Subject: Coaxing appdb maintainers into testing their apps with rc1?
References: <a71bd89a0805120013k246f73a9pa3ce8fb00fe6b97@mail.gmail.com>
Message-ID: <loom.20080512T125750-982@post.gmane.org>

Dan Kegel <dank <at> kegel.com> writes:

> 
> It doesn't look like many people are paying attention to
> http://wiki.winehq.org/PlatinumRegressionHunt
> 
> Think it would be useful to email all the app maintainers and
> ask them to pretty please test their apps with rc1?
> 
> 

I think a little typesetting goes a long way in keeping peoples attention.

I looked at the wiki entry to see if I could possibly make it slightly more
legible but I couldn't see a way to use plain old html.

Instead, I think something along these lines would be better suited,
http://jeffz.name/regressionhunt.html I feel it's has more of an attention 
getting feel to it.

Notifying maintainers by email sounds like a good idea.



From wine-devel at kievinfo.com  Mon May 12 08:20:08 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Mon, 12 May 2008 07:20:08 -0600
Subject: stub implementation of GdipImageGetFrameDimensionsCount and 
	GdipGetImageFlags
In-Reply-To: <op.ua0244zvcr5wbu@petr-laptop>
References: <op.ua0244zvcr5wbu@petr-laptop>
Message-ID: <48284408.2030902@kievinfo.com>

Petr Dlouh? wrote:
> This is fix for bug 13036 
> (http://bugs.winehq.org/show_bug.cgi?id=13036); It allows Faktury 4.1 to 
> start.
> 

> +GpStatus WINGDIPAPI GdipGetImageFlags(GpImage* image, UINT *flags)
> +{
> +    static int calls;
> +
> +    if(!image || !flags)
> +        return InvalidParameter;
> +
> +    if(!(calls++))
> +        FIXME("not implemented\n");
> +
> +    return Ok;
> +}
You need to print paramenters this function is called with. And don't forget 
include the "magic" word "stub" in the text of the fixme.

Also why are you limiting number of printed fixmes?


Vitaliy.


From bunglehead at gmail.com  Mon May 12 08:27:10 2008
From: bunglehead at gmail.com (Nikolay Sivov)
Date: Mon, 12 May 2008 17:27:10 +0400
Subject: stub implementation of GdipImageGetFrameDimensionsCount and
	GdipGetImageFlags
In-Reply-To: <op.ua0244zvcr5wbu@petr-laptop>
References: <op.ua0244zvcr5wbu@petr-laptop>
Message-ID: <db9c62d60805120627h5fb53a76i78d505545efa86af@mail.gmail.com>

GdipGetImageFlags is commited today.

2008/5/12 Petr Dlouh? <petr.dlouhy at email.cz>:
> This is fix for bug 13036 (http://bugs.winehq.org/show_bug.cgi?id=13036); It
> allows Faktury 4.1 to start.
>
>  --
>  Petr Dlouh?
>
>
>


From blackdrag at gmx.org  Mon May 12 05:05:21 2008
From: blackdrag at gmx.org (Jochen)
Date: Mon, 12 May 2008 12:05:21 +0200
Subject: Lots of regressions in games in last few versions
In-Reply-To: <48266973.2030908@sprintpcs.com>
References: <482646B7.5010105@kievinfo.com>
	<48264B80.7080601@sprintpcs.com>	<48264E0D.4000003@kievinfo.com>
	<48265499.1070102@sprintpcs.com>	<48265AB0.3040004@kievinfo.com>
	<48266973.2030908@sprintpcs.com>
Message-ID: <g094oq$jik$1@ger.gmane.org>

James McKenzie schrieb:
> Vitaliy Margolen wrote:
>> James McKenzie wrote:
[...]
> Again, do we have enough time to test every combination of products in 
> the short release to release schedule.  I would say NO.  However, this 
> schedule is not of my doing.  My saying "Release no software before its 
> time" applies in many cases.

basically I would agree with you, but many people do not take a look at 
it if it is not even 1.0 these days. for normal users it is most of the 
time not that important if it is 0.9.60 or 1.0, but for a company and 
decision makers it is. Doing a 1.0 will give popularity and with his 
comes attention from people wit money, money that they might spend in 
helping wine to develop faster. I have seen this pattern a few times 
now. Wine might not be ready to do an excellent job of emulating what 
windows does, but it is usable, even in production. Good enough for a 1.0.

Ah well.. I am no wine developer ;)


bye blackdrag




From wine-devel at kievinfo.com  Mon May 12 08:22:05 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Mon, 12 May 2008 07:22:05 -0600
Subject: Partial revert of c8bdebd... to fix bug #13093.
In-Reply-To: <3f4fd2640805120135n613e0ddfk50c902394a90470a@mail.gmail.com>
References: <3f4fd2640805120135n613e0ddfk50c902394a90470a@mail.gmail.com>
Message-ID: <4828447D.4080202@kievinfo.com>

Reece Dunn wrote:
> The patch "winealsa: Remove calls to deprecated functions." broke
> audio playback on Cepstral SwiftTalker [bug #13093] (may also affect
> other text-to-speech software like Dragon Naturally Speaking) when
> running on Ubuntu 8.04 with pulseaudio+alsa (but may break on other
> platforms).
> 
> This patch reverts two of those lines that are needed to fix this
> issue and generate clean WINEDEBUG=+wave,+dsalsa output.
> 
> - Reece
> 
> 
Wait a sec. Is the bug present without pulseaudio?

Vitaliy.


From stefan at codeweavers.com  Mon May 12 09:19:15 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 12 May 2008 16:19:15 +0200
Subject: Lots of regressions in games in last few versions
In-Reply-To: <48283834.3010307@kievinfo.com>
References: <a71bd89a0805112357k63076c90sc1a74f0fd8e0b953@mail.gmail.com>
	<48283834.3010307@kievinfo.com>
Message-ID: <200805121619.15223.stefan@codeweavers.com>

Am Montag, 12. Mai 2008 14:29:40 schrieb Vitaliy Margolen:
> Stability. For things to continue working once they get fixed. Which means
> more developers have to "support" their changes - promptly address all
> issues that result from their changes. IMHO this is the way project should
> be moving forward (past 1.0)
That's a noble intention, but not possible in practise.


From stefan at codeweavers.com  Mon May 12 09:25:25 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 12 May 2008 16:25:25 +0200
Subject: Lots of regressions in games in last few versions
In-Reply-To: <48266973.2030908@sprintpcs.com>
References: <482646B7.5010105@kievinfo.com> <48265AB0.3040004@kievinfo.com>
	<48266973.2030908@sprintpcs.com>
Message-ID: <200805121625.25692.stefan@codeweavers.com>

Am Sonntag, 11. Mai 2008 05:35:15 schrieb James McKenzie:
> I agree that a D3D expert needs to fix this problem, pronto.  However,
> I'm not one of them and it looks like at least one of them proposed a
> fix in the issue.
Fyi, I am terribly busy at the moment with university work, I have a bunch of 
deadlines and 5 exams the next weeks. Somewhen between mid-june and the begin 
of july I'll go to Mineapolis for a few months and will have time to work on 
Wine again, but I am afraid I won't have much time before that.

Maybe I can look into the ActivateContext recursion, but I can't promise that. 
It depends on how my other work is going. A start for fixing this issue would 
be implementing my two-liner change I described a while ago on wine-devel, 
and then testing it as good as possible to see if it triggers any other bugs. 
As a second step the tests proposed in the same mail should be implemented to 
see if all the issues are fixed.



From m.b.lankhorst at gmail.com  Mon May 12 12:04:03 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 12 May 2008 10:04:03 -0700
Subject: Partial revert of c8bdebd... to fix bug #13093.
In-Reply-To: <b130c85e0805121003y53d592cep32e7c4783a7bbb32@mail.gmail.com>
References: <3f4fd2640805120135n613e0ddfk50c902394a90470a@mail.gmail.com>
	<b130c85e0805121003y53d592cep32e7c4783a7bbb32@mail.gmail.com>
Message-ID: <b130c85e0805121004h460e2534of315c5e91f00c2e9@mail.gmail.com>

Hello Reece,

2008/5/12 Reece Dunn <msclrhd at googlemail.com>:
> The patch "winealsa: Remove calls to deprecated functions." broke
>  audio playback on Cepstral SwiftTalker [bug #13093] (may also affect
>  other text-to-speech software like Dragon Naturally Speaking) when
>  running on Ubuntu 8.04 with pulseaudio+alsa (but may break on other
>  platforms).
>
>  This patch reverts two of those lines that are needed to fix this
>  issue and generate clean WINEDEBUG=+wave,+dsalsa output.

It seems the winealsa patch had too much ill side effects I didn't
intend to happen, can you rather do a full revert?

Cheers,
Maarten.


From thestig at google.com  Mon May 12 12:24:54 2008
From: thestig at google.com (Lei Zhang)
Date: Mon, 12 May 2008 10:24:54 -0700
Subject: Where does richedit20.dll fit in the to-do list?
In-Reply-To: <000001c8b406$a4a06e40$ede14ac0$@in>
References: <000001c8b406$a4a06e40$ede14ac0$@in>
Message-ID: <558b2f5c0805121024i26aa9577s71c8784a62618460@mail.gmail.com>

On Mon, May 12, 2008 at 1:02 AM, Syam Babu.S <contess at sancharnet.in> wrote:
>
>
>
>
> Dear Sir,
>
> While installing an application the installation stops for a long while
> copying ,Richedit20.dll, and finally I get the message cannot copy file may
> be disk full.
>
> I have more than 10 GB free.
>
> Can you enlighten me please ?
>
> Regards, Syam Babu
>
>
>

Please file a bug for this problem on Wine's bugzilla: http://bugs.winehq.org/

You need to mention what application you are using and give details on
how to reproduce this problem. See: http://wiki.winehq.org/Bugs


From dank at kegel.com  Mon May 12 13:26:57 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 12 May 2008 11:26:57 -0700
Subject: Coaxing appdb maintainers into testing their apps with rc1?
In-Reply-To: <a71bd89a0805120013k246f73a9pa3ce8fb00fe6b97@mail.gmail.com>
References: <a71bd89a0805120013k246f73a9pa3ce8fb00fe6b97@mail.gmail.com>
Message-ID: <a71bd89a0805121126g4dba52d0h951ab2c4b101a9f6@mail.gmail.com>

Jeff wrote:
>> http://wiki.winehq.org/PlatinumRegressionHunt
> I think a little typesetting goes a long way in keeping peoples attention.
> [How about] http://jeffz.name/regressionhunt.html

Yeah, my original looked like a huge block of boring text.
I've added headings, I think it's a little better now.
Still too long.


From tehblunderbuss at gmail.com  Mon May 12 14:21:29 2008
From: tehblunderbuss at gmail.com (TheBlunderbuss)
Date: Mon, 12 May 2008 14:21:29 -0500
Subject: Deprecated sound functions
In-Reply-To: <48236EEA.3020004@redhat.com>
References: <48229C15.9030901@gmail.com> <48236EEA.3020004@redhat.com>
Message-ID: <482898B9.3080804@gmail.com>

I agree with AJ's reverts on the deprecated ALSA functions, since ALSA 
kept them for compatibility. Sorry I jumped the gun.


From zgold550 at gmail.com  Mon May 12 15:07:30 2008
From: zgold550 at gmail.com (Zachary Goldberg)
Date: Mon, 12 May 2008 16:07:30 -0400
Subject: Coaxing appdb maintainers into testing their apps with rc1?
In-Reply-To: <a71bd89a0805121126g4dba52d0h951ab2c4b101a9f6@mail.gmail.com>
References: <a71bd89a0805120013k246f73a9pa3ce8fb00fe6b97@mail.gmail.com>
	<a71bd89a0805121126g4dba52d0h951ab2c4b101a9f6@mail.gmail.com>
Message-ID: <b050a5e70805121307hbe56f1fhd99e4480844e8271@mail.gmail.com>

Dan,

On Mon, May 12, 2008 at 2:26 PM, Dan Kegel <dank at kegel.com> wrote:
> Jeff wrote:
>  >> http://wiki.winehq.org/PlatinumRegressionHunt
>
> > I think a little typesetting goes a long way in keeping peoples attention.
>  > [How about] http://jeffz.name/regressionhunt.html
>
>  Yeah, my original looked like a huge block of boring text.
>  I've added headings, I think it's a little better now.
>  Still too long.
>
>
>

I would say 2 and 4 could possibly be combined, as well 6,7.8 are all
almost the same and could perhaps be one.  Reducing the number of
major headings from 8 to 5.

-Zach


From dank at kegel.com  Mon May 12 15:18:44 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 12 May 2008 13:18:44 -0700
Subject: Coaxing appdb maintainers into testing their apps with rc1?
In-Reply-To: <b050a5e70805121307hbe56f1fhd99e4480844e8271@mail.gmail.com>
References: <a71bd89a0805120013k246f73a9pa3ce8fb00fe6b97@mail.gmail.com>
	<a71bd89a0805121126g4dba52d0h951ab2c4b101a9f6@mail.gmail.com>
	<b050a5e70805121307hbe56f1fhd99e4480844e8271@mail.gmail.com>
Message-ID: <a71bd89a0805121318g1dce500bi12abe6ea242d24b@mail.gmail.com>

On Mon, May 12, 2008 at 1:07 PM, Zachary Goldberg <zgold550 at gmail.com> wrote:
>  http://wiki.winehq.org/PlatinumRegressionHunt
>
>  I would say 2 and 4 could possibly be combined, as well 6,7.8 are all
>  almost the same and could perhaps be one.  Reducing the number of
>  major headings from 8 to 5.

I'm not sure how to do that well, but I did combine two headings,
it's a little better now, thanks.


From scott at open-vote.org  Mon May 12 18:18:18 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Mon, 12 May 2008 16:18:18 -0700
Subject: Bugs in Wine research
In-Reply-To: <a71bd89a0805100926kdf9dc35xa8f74ef32160a05f@mail.gmail.com>
References: <a71bd89a0805100512k14b21936qd379e33a80c35694@mail.gmail.com>	<4825CA71.7080800@sprintpcs.com>
	<a71bd89a0805100926kdf9dc35xa8f74ef32160a05f@mail.gmail.com>
Message-ID: <4828D03A.9020006@open-vote.org>

Dan Kegel wrote:
> James McKenzie <jjmckenzie51 at sprintpcs.com> wrote:
>>>> we are students from Department of computer science at Aalborg
>>>> university. During this semester we were working on project on static
>>>> analysis using the Coccinelle tool
>>>  http://wiki.winehq.org/StaticAnalysis
>> I was wondering if results from Wine 0.9.57 would continue to be valid?
>> Maybe the effort could shift to RC1?
> 
> Sure, lots of the unused vars bugs in particular are probably
> already fixed.   But the other issues have a pretty good
> chance of still being valid.
> 

Are there any volunteers to do this?

My experience with Wine C code is fairly minimal, but it shouldn't be
too hard to look at one of their changes and see if it applies to
current git, and if it does just forward-port it.

Thanks,
Scott Ritchie



From chris.kcat at gmail.com  Mon May 12 19:25:30 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Mon, 12 May 2008 17:25:30 -0700
Subject: winex11: Create a dummy parent window for composite child windows
	to avoid using the root.
Message-ID: <200805121725.30610.chris.kcat@gmail.com>

Alexandre Julliard wrote:
> -        attrib.override_redirect = True;
>          attrib.colormap = data->colormap;
>          XInstallColormap(gdi_display, attrib.colormap);
>
>          if(data->gl_drawable) XDestroyWindow(gdi_display, 
data->gl_drawable);
> -        data->gl_drawable = XCreateWindow(gdi_display, parent, -w, 0, w, h, 
0,
> +        data->gl_drawable = XCreateWindow(gdi_display, dummy_parent, -w, 0, 
w, h, 0,
>                                            vis->depth, InputOutput, 
vis->visual,
>                                            CWColormap | CWOverrideRedirect,
>                                            &attrib);

Did you mean to remove setting the override_redirect attribute? I remember 
having some alignment issues without it (the GL rendering was offset on the 
unseen window by the size of the decorations). But even if so, you'd need to 
remove the CWOverrideRedirect flag, because it's now taking the setting from 
the uninitialized override_redirect field.


From jjmckenzie51 at sprintpcs.com  Mon May 12 22:52:26 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Mon, 12 May 2008 20:52:26 -0700
Subject: Lots of regressions in games in last few versions
In-Reply-To: <48283834.3010307@kievinfo.com>
References: <a71bd89a0805112357k63076c90sc1a74f0fd8e0b953@mail.gmail.com>
	<48283834.3010307@kievinfo.com>
Message-ID: <4829107A.805@sprintpcs.com>

Vitaliy Margolen wrote:
> Dan Kegel wrote:
>   
>> I'm not sure what you're angry about.
>> None of us have that much control over exactly
>> which way wine develops.  We all scratch our own itches,
>> and it improves at its own pace.
>> What more do you want?
>>     
>
> Stability. For things to continue working once they get fixed. Which means 
> more developers have to "support" their changes - promptly address all 
> issues that result from their changes. IMHO this is the way project should 
> be moving forward (past 1.0)
>
>   
Then you must not be using Linux either.  Bugs HAPPEN.  Squashing them 
may not.  Sort of like the cockroach that runs all over your floor.  You 
can go on a stomping party and miss it every time and you may even 
attract more.  However, if you use bug spray, you might kill the roach, 
but you might kill yourself as well.   We need to do what you said, test 
Wine before releasing to the public.  However, this is not possible 
given the aggressive release schedule of the project.  So, we have to 
fix what we can and leave the rest until later.

If you have a better plan, tell us.

James McKenzie


From truiken at gmail.com  Mon May 12 23:23:22 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 12 May 2008 23:23:22 -0500
Subject: Lots of regressions in games in last few versions
In-Reply-To: <4829107A.805@sprintpcs.com>
References: <a71bd89a0805112357k63076c90sc1a74f0fd8e0b953@mail.gmail.com>
	<48283834.3010307@kievinfo.com> <4829107A.805@sprintpcs.com>
Message-ID: <22821af30805122123m5740c4cfrdc1ef3d611d9a8ae@mail.gmail.com>

On Mon, May 12, 2008 at 10:52 PM, James McKenzie
<jjmckenzie51 at sprintpcs.com> wrote:
>
> Vitaliy Margolen wrote:
>  > Dan Kegel wrote:
>  >
>  >> I'm not sure what you're angry about.
>  >> None of us have that much control over exactly
>  >> which way wine develops.  We all scratch our own itches,
>  >> and it improves at its own pace.
>  >> What more do you want?
>  >>
>  >
>  > Stability. For things to continue working once they get fixed. Which means
>  > more developers have to "support" their changes - promptly address all
>  > issues that result from their changes. IMHO this is the way project should
>  > be moving forward (past 1.0)
>  >
>  >
>  Then you must not be using Linux either.  Bugs HAPPEN.  Squashing them
>  may not.  Sort of like the cockroach that runs all over your floor.  You
>  can go on a stomping party and miss it every time and you may even
>  attract more.  However, if you use bug spray, you might kill the roach,
>  but you might kill yourself as well.   We need to do what you said, test
>  Wine before releasing to the public.  However, this is not possible
>  given the aggressive release schedule of the project.  So, we have to
>  fix what we can and leave the rest until later.
>

The purpose of the aggressive release schedule is exactly so that we
get more testing exposure and regressions are caught quicker.  Not
enough patches come with tests, and sometimes the tests aren't
comprehensive enough.  Just because a fix seems obvious doesn't mean
it can't surreptitiously create a regression somewhere else.  It's not
the job of the developer to foresee all these consequences, but it is
the job of the developer to write test cases to prevent this from
happening.  While  not all fixes are easy to test, you should put a
lot of effort into figuring out any way possible to write a test case.
 See my fusion tests for an example of a difficult test.  At the very
least, more developers need to be vocal about raising the priority of
regressions bugs they create, myself included.

-- 
James Hawkins


From mpartap at gmx.net  Mon May 12 23:48:42 2008
From: mpartap at gmx.net (Marcel Partap)
Date: Tue, 13 May 2008 06:48:42 +0200
Subject: Lots of regressions in games in last few versions
In-Reply-To: <4829107A.805@sprintpcs.com>
References: <a71bd89a0805112357k63076c90sc1a74f0fd8e0b953@mail.gmail.com>	<48283834.3010307@kievinfo.com>
	<4829107A.805@sprintpcs.com>
Message-ID: <48291DAA.1060203@gmx.net>

 > but you might kill yourself as well.   We need to do what you said, test
 > Wine before releasing to the public.  However, this is not possible
 > given the aggressive release schedule of the project.
Why is that so? I still do not see any benefit in calling it wine 1.0 at this time. What is the 
intention of this step? Attract more users? Well first, to use wine you have to use a *n*x system, 
which means either that you use a Mac (in which case you most probably are already using native 
versions of programs you could run under wine), a bsd/solaris system (in which case you already 
*know* wine because you definitly are not a newbie) or a linux distro (that has wine pre-installed 
almost with certainty..). So where is the market segment this is trying to reach? After all a 
version number IS a marketing argument, nothing more. Why a free & open source software project 
needs that - no clue. imho it is way cooler to have a fully fledged, functional and almost bug-free 
software with a pre-1.0-version...
Attracting users by promising a major step forward - a finished x.0 release - that don't already 
come to wine by other means may backfire - a zillion useless bug reports, fed up newbies, many 
'ruined' first-foss-contact chances ("uuuhh doesn't work on first try i'm going back to windows 
screw FOSS").
And I really don't think it is going to be of advantage to the code, too. ..more bug reports - what 
for? There's enough unfixed bugs, enough people involved hitting bugs, only too few people with the 
capability to fix them and i doubt calling wine 1.0 will attract more developers that are skilled 
enough to contribute code of a quality mr julliard is willing to commit.

 > So, we have to fix what we can and leave the rest until later.
 > If you have a better plan, tell us.
Relax the code freeze a bit and stay in RC phase for as many releases as the beta phase..?
regards marcel.


From dank at kegel.com  Tue May 13 01:01:36 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 12 May 2008 23:01:36 -0700
Subject: Lots of regressions in games in last few versions
In-Reply-To: <48291DAA.1060203@gmx.net>
References: <a71bd89a0805112357k63076c90sc1a74f0fd8e0b953@mail.gmail.com>
	<48283834.3010307@kievinfo.com> <4829107A.805@sprintpcs.com>
	<48291DAA.1060203@gmx.net>
Message-ID: <a71bd89a0805122301h50cb5619h198e4218dcdab01e@mail.gmail.com>

On Mon, May 12, 2008 at 9:48 PM, Marcel Partap <mpartap at gmx.net> wrote:
>  Attracting users by promising a major step forward - a finished x.0 release
> - that don't already come to wine by other means may backfire - a zillion
> useless bug reports, fed up newbies, many 'ruined' first-foss-contact
> chances

We should make it very clear in each and every announcement we
make that Wine 1.0 will NOT run most windows programs, and link
to the list of 1000 apps it probably runs well.  I've certainly tried
to emphasize its limitations every time I open my mouth in public.

>  And I really don't think it is going to be of advantage to the code, too.
> ..more bug reports - what for? There's enough unfixed bugs, enough people
> involved hitting bugs, only too few people with the capability to fix them
> and i doubt calling wine 1.0 will attract more developers that are skilled
> enough to contribute code of a quality mr julliard is willing to commit.

There are probably lots of bugs in, say, Photoshop CS2
that I'd get fixed right quick if I knew about them, but not
enough people are using it to know they're there.
And even bug reports that sit around unfixed can end up
useful when somebody finally takes an interest in a problem.

>  Relax the code freeze a bit and stay in RC phase for as many releases as
> the beta phase..?

That's like saying "don't do the 1.0 release yet, just keep doing
0.9.62, etc..."
Not going to happen.  Wine needs a release.  All good open source
projects need to release (not just make snapshots) periodically.
Our last one was several years ago, and by doing a release, we are
cleaning up a lot of bugs that have been lingering and annoying users
for years.  (Serial I/O, anyone?  DOS apps?)
- Dan


From julliard at winehq.org  Tue May 13 02:19:49 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 13 May 2008 09:19:49 +0200
Subject: winex11: Create a dummy parent window for composite child windows
	to avoid using the root.
In-Reply-To: <200805121725.30610.chris.kcat@gmail.com> (Chris Robinson's
	message of "Mon, 12 May 2008 17:25:30 -0700")
References: <200805121725.30610.chris.kcat@gmail.com>
Message-ID: <87wsly7jsa.fsf@wine.dyndns.org>

Chris Robinson <chris.kcat at gmail.com> writes:

> Alexandre Julliard wrote:
>> -        attrib.override_redirect = True;
>>          attrib.colormap = data->colormap;
>>          XInstallColormap(gdi_display, attrib.colormap);
>>
>>          if(data->gl_drawable) XDestroyWindow(gdi_display, 
> data->gl_drawable);
>> -        data->gl_drawable = XCreateWindow(gdi_display, parent, -w, 0, w, h, 
> 0,
>> +        data->gl_drawable = XCreateWindow(gdi_display, dummy_parent, -w, 0, 
> w, h, 0,
>>                                            vis->depth, InputOutput, 
> vis->visual,
>>                                            CWColormap | CWOverrideRedirect,
>>                                            &attrib);
>
> Did you mean to remove setting the override_redirect attribute? I remember 
> having some alignment issues without it (the GL rendering was offset on the 
> unseen window by the size of the decorations). But even if so, you'd need to 
> remove the CWOverrideRedirect flag, because it's now taking the setting from 
> the uninitialized override_redirect field.

It's not removed, just moved a little higher in the function so that it
can be used in both XCreateWindow calls.

-- 
Alexandre Julliard
julliard at winehq.org


From rob at codeweavers.com  Tue May 13 03:56:18 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Tue, 13 May 2008 09:56:18 +0100
Subject: includes: Add vmr9 header
In-Reply-To: <b130c85e0805121621g38e3a453j96b3529875f3deb9@mail.gmail.com>
References: <b130c85e0805121621g38e3a453j96b3529875f3deb9@mail.gmail.com>
Message-ID: <482957B2.9020603@codeweavers.com>

Maarten Lankhorst wrote:
> @@ -0,0 +1,525 @@
> +/*
> + * Copyright 2008 Maarten Lankhorst
> + *
> + * This library is free software; you can redistribute it and/or
> + * modify it under the terms of the GNU Lesser General Public
> + * License as published by the Free Software Foundation; either
> + * version 2.1 of the License, or (at your option) any later version.
> + *
> + * This library is distributed in the hope that it will be useful,
> + * but WITHOUT ANY WARRANTY; without even the implied warranty of
> + * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
> + * Lesser General Public License for more details.
> + *
> + * You should have received a copy of the GNU Lesser General Public
> + * License along with this library; if not, write to the Free Software
> + * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
> + */
> +
> +#include "unknwn.idl"

You should use import here, not #include.

-- 
Rob Shearman



From stefan at codeweavers.com  Tue May 13 06:59:38 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 13 May 2008 13:59:38 +0200
Subject: [d3d9] shademode_test: increase slop in color comparison
In-Reply-To: <a71bd89a0805121354ufd18390v4bfddf9e08ad6539@mail.gmail.com>
References: <a71bd89a0805121354ufd18390v4bfddf9e08ad6539@mail.gmail.com>
Message-ID: <200805131359.39149.stefan@codeweavers.com>

Am Montag, 12. Mai 2008 22:54:18 schrieb Dan Kegel:
> The test allowed for a slop of (-1,0) in the colors,
> but on my machine,
> nVidia Corporation NV17 [GeForce4 440 Go 64M]
> the colors were off by +1.  So change the code
> to allow for a slop of +-1, and switch to a more readable
> way of comparing colors.
Henri once said he had a universal patch for color slop he was going to send, 
I'm not sure what happened to it



From jwhite at winehq.org  Tue May 13 09:31:21 2008
From: jwhite at winehq.org (Jeremy White)
Date: Tue, 13 May 2008 09:31:21 -0500
Subject: Lots of regressions in games in last few versions
In-Reply-To: <a71bd89a0805122301h50cb5619h198e4218dcdab01e@mail.gmail.com>
References: <a71bd89a0805112357k63076c90sc1a74f0fd8e0b953@mail.gmail.com>	<48283834.3010307@kievinfo.com>
	<4829107A.805@sprintpcs.com>	<48291DAA.1060203@gmx.net>
	<a71bd89a0805122301h50cb5619h198e4218dcdab01e@mail.gmail.com>
Message-ID: <4829A639.5090000@winehq.org>

>>  Relax the code freeze a bit and stay in RC phase for as many releases as
>> the beta phase..?
> 
> That's like saying "don't do the 1.0 release yet, just keep doing
> 0.9.62, etc..."
> Not going to happen.  Wine needs a release.  All good open source
> projects need to release (not just make snapshots) periodically.
> Our last one was several years ago, and by doing a release, we are
> cleaning up a lot of bugs that have been lingering and annoying users
> for years.  (Serial I/O, anyone?  DOS apps?)


Sure, but doing a release on a unmovable schedule is also a mistake, imho;
you want to release when you feel you have something of solid value.
It should not be the case that a large block of conventional wisdom
has it that 0.9.58 is 'better' than 1.0.

Obvious and large blocks of regressions are a valid show stopper, again imho.

But isn't this all just normal and expected?  We had a big push by people to
get features in prior to the freeze, so a lot of new features went in right
before the freeze.  Now we have to shake out the regressions and fix them.
That process is a PITA, and usually takes a few weeks.  Isn't that what we're doing?

Cheers,

Jeremy


From rob at codeweavers.com  Tue May 13 12:57:18 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Tue, 13 May 2008 18:57:18 +0100
Subject: [PATCH] Cache localised number chars
In-Reply-To: <1210597562.4971.1.camel@ip6-localhost>
References: <1210597562.4971.1.camel@ip6-localhost>
Message-ID: <4829D67E.5080201@codeweavers.com>

Michael Karcher wrote:
> UDATE *lpUdate)
>  static void VARIANT_GetLocalisedNumberChars(VARIANT_NUMBER_CHARS *lpChars, LCID lcid, DWORD dwFlags)
>  {
>    static const VARIANT_NUMBER_CHARS defaultChars = { '-','+','.',',','$',0,'.',',' };
> +  static VARIANT_NUMBER_CHARS lastChars;
> +  static LCID lastLcid = -1;
> +  static DWORD lastFlags = 0;
>    LCTYPE lctype = dwFlags & LOCALE_NOUSEROVERRIDE;
>    WCHAR buff[4];
>  
> +  /* Asking for default locale entries is very expensive: It is a registry
> +     server call. So cache one localy, as Microsoft does it too */
> +  if(lcid == lastLcid && dwFlags == lastFlags)
> +  {
> +    memcpy(lpChars, &lastChars, sizeof(defaultChars));
> +    return;
> +  }
> +
>   

This introduces a race condition.

-- 
Rob Shearman



From m.b.lankhorst at gmail.com  Tue May 13 11:54:59 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 13 May 2008 09:54:59 -0700
Subject: includes: Add vmr9 header
In-Reply-To: <482957B2.9020603@codeweavers.com>
References: <b130c85e0805121621g38e3a453j96b3529875f3deb9@mail.gmail.com>
	<482957B2.9020603@codeweavers.com>
Message-ID: <b130c85e0805130954x657f8d95w1bd0b02e47911759@mail.gmail.com>

Hello Rob,

2008/5/13 Robert Shearman <rob at codeweavers.com>:
> Maarten Lankhorst wrote:
>
> > @@ -0,0 +1,525 @@
> > ....
> > +#include "unknwn.idl"
> >
>
>  You should use import here, not #include.
Yeah, I noticed it while I was trying to include it and got multiple
definitions errors, I'll send a fixed patch.

Cheers,
Maarten.


From wine at mkarcher.dialup.fu-berlin.de  Tue May 13 13:06:03 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Tue, 13 May 2008 20:06:03 +0200
Subject: [PATCH] Cache localised number chars
In-Reply-To: <4829D67E.5080201@codeweavers.com>
References: <1210597562.4971.1.camel@ip6-localhost>
	<4829D67E.5080201@codeweavers.com>
Message-ID: <1210701963.7112.16.camel@hermes2.karcher.local>


Am Dienstag, den 13.05.2008, 18:57 +0100 schrieb Robert Shearman:
> Michael Karcher wrote:
> > UDATE *lpUdate)
> >  static void VARIANT_GetLocalisedNumberChars(VARIANT_NUMBER_CHARS *lpChars, LCID lcid, DWORD dwFlags)
> >  {
> >    static const VARIANT_NUMBER_CHARS defaultChars = { '-','+','.',',','$',0,'.',',' };
> > +  static VARIANT_NUMBER_CHARS lastChars;
> > +  static LCID lastLcid = -1;
> > +  static DWORD lastFlags = 0;
> >    LCTYPE lctype = dwFlags & LOCALE_NOUSEROVERRIDE;
> >    WCHAR buff[4];
> >  
> > +  /* Asking for default locale entries is very expensive: It is a registry
> > +     server call. So cache one localy, as Microsoft does it too */
> > +  if(lcid == lastLcid && dwFlags == lastFlags)
> > +  {
> > +    memcpy(lpChars, &lastChars, sizeof(defaultChars));
> > +    return;
> > +  }
> > +
> >   
> 
> This introduces a race condition.

Oops, you seem to be right. Thanks for spotting it! I suppose wrapping
the whole code into a critical section will fix it. I will resubmit the
patch with a critical section (It still will help. Without the critical
section, I measured a 1000x speedup on VarI2FromBstr, so even with the
section, this patch will add a lot of performance to wine.)

Kind regards,
  Michael Karcher



From wine-devel at kievinfo.com  Tue May 13 14:42:53 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 13 May 2008 13:42:53 -0600
Subject: [PATCH] [cmd]: use correct codepage when outputing unicode text
	to an   ANSI stream
In-Reply-To: <20080513190420.14858.39926.stgit@localhost>
References: <20080513190420.14858.39926.stgit@localhost>
Message-ID: <4829EF3D.7010403@kievinfo.com>

Eric Pouech wrote:
> @@ -1437,7 +1437,7 @@ static void WCMD_output_asis_len(const WCHAR *message, int len, HANDLE device) {
>          }
>  
>          /* Convert to OEM, then output */
> -        convertedChars = WideCharToMultiByte(GetConsoleOutputCP(), 0, message,
> +        convertedChars = WideCharToMultiByte(CP_UNIXCP, 0, message,
>                              len, output_bufA, MAX_WRITECONSOLE_SIZE,
>                              "?", &usedDefaultChar);
>          WriteFile(device, output_bufA, convertedChars,
> 
> 
This doesn't look right. What if it's wineconsole with user backend 
(default) and OEM CP (which is different then UNIXCP)? Should probably hack 
GetConsoleOutputCP() instead.

Vitaliy.


From austinenglish at gmail.com  Tue May 13 14:51:11 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 13 May 2008 14:51:11 -0500
Subject: wine.inf: add a fake dll for sensapi.dll
In-Reply-To: <b6bb06270805112101k283439ferff255ecfa17c33c0@mail.gmail.com>
References: <b6bb06270805112101k283439ferff255ecfa17c33c0@mail.gmail.com>
Message-ID: <b6bb06270805131251r71e3c09dhcebc3062cb823d7c@mail.gmail.com>

Anything wrong with this patch?

http://www.winehq.org/pipermail/wine-patches/2008-May/054794.html


From wine-devel at kievinfo.com  Tue May 13 14:58:02 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 13 May 2008 13:58:02 -0600
Subject: Lots of regressions in games in last few versions
In-Reply-To: <b6bb06270805131241u17329cdes320facf2edbb77ee@mail.gmail.com>
References: <482646B7.5010105@kievinfo.com>	
	<b6bb06270805111652pac0c3b1oc19cf53898b5b7e3@mail.gmail.com>	
	<4827C82B.5090401@kievinfo.com>
	<b6bb06270805131241u17329cdes320facf2edbb77ee@mail.gmail.com>
Message-ID: <4829F2CA.80900@kievinfo.com>

Austin English wrote:
> On Sun, May 11, 2008 at 11:31 PM, Vitaliy Margolen
> <wine-devel at kievinfo.com> wrote:
>> Austin English wrote:
>>
>>> 13120 - I'll run the test tomorrow if I can reproduce/no one has by then.
>>> 13110 - no one requested a regression test. I've requested it now.
>>> 13101 - not a regression
>>> 13086 - not sure if it's always existed or a regression. I asked for
>>> clarification.
>>>
>>> If anyone can identify regressions that haven't been bisected, shoot
>>> me an e-mail. I've got plenty of CPU/time to kill.
>>>
>>  I'd appreciate it if you can do a regression testing for bug 12272? Game
>> blood 2 with demo. Between wine-0.9.44 and wine-0.9.45. You will need to use
>> native dinput.dll. Start the game (enter, enter, enter) and move the mouse
>> around. You should see that with .45 it's really jumpy and in .44 it's nice
>> and smooth.
>>
>>  I think it's either ddraw or d3d. But might be some other place.
>>
>>  Vitaliy
>>
> 
> Just got back from vacation this weekend, and right when I start, you
> had already done it :-P. Oh well, if you get more in the future
> Vitaliy or anyone else, send me an e-mail/cc me on the bug. Most of
> the regressions you pointed out have already been run.
> 
Was kind of interested in it myself and had some idle CPU cycles <g>

That bug is exactly the kind of problems we should try to avoid. I'm not 
entirely sure what it suppose to fix I can't see any difference with/without 
the patch. However it makes mouse pretty unusable - it gets really jerky 
like with < 5 FPS.

Vitaliy.


From eric.pouech at orange.fr  Tue May 13 15:02:12 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Tue, 13 May 2008 22:02:12 +0200
Subject: [PATCH] [cmd]: use correct codepage when outputing unicode text
	to an   ANSI stream
In-Reply-To: <4829EF3D.7010403@kievinfo.com>
References: <20080513190420.14858.39926.stgit@localhost>
	<4829EF3D.7010403@kievinfo.com>
Message-ID: <4829F3C4.9080401@orange.fr>

Vitaliy Margolen a ?crit :
> Eric Pouech wrote:
>   
>> @@ -1437,7 +1437,7 @@ static void WCMD_output_asis_len(const WCHAR *message, int len, HANDLE device) {
>>          }
>>  
>>          /* Convert to OEM, then output */
>> -        convertedChars = WideCharToMultiByte(GetConsoleOutputCP(), 0, message,
>> +        convertedChars = WideCharToMultiByte(CP_UNIXCP, 0, message,
>>                              len, output_bufA, MAX_WRITECONSOLE_SIZE,
>>                              "?", &usedDefaultChar);
>>          WriteFile(device, output_bufA, convertedChars,
>>
>>
>>     
> This doesn't look right. What if it's wineconsole with user backend 
> (default) and OEM CP (which is different then UNIXCP)? Should probably hack 
> GetConsoleOutputCP() instead.
>   
this code is only used when no wineconsole is attached, so unixcp is the 
right choice
however, it can be considered that GetConsoleOutputCP() should be 
changed to return the unixcp and not the oem cp when no console is attached
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From eric.pouech at orange.fr  Tue May 13 14:31:35 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Tue, 13 May 2008 21:31:35 +0200
Subject: richedit: empty text should result in a scroll range of 0. Tests
	for this behavior.
In-Reply-To: <4829CBB5.3090908@palosanto.com>
References: <4829CBB5.3090908@palosanto.com>
Message-ID: <4829EC97.6070209@orange.fr>

Alex Villac??s Lasso a ?crit :
> Even though the code freeze is still in effect, I post this so that it 
> will be reviewed. For more information, see bug #12311.
>
> Changelog:
> * richedit: empty text should result in a scroll range of 0.
> * Tests for this behavior.
>
> ------------------------------------------------------------------------
>
>
what I don't understand is why the height of an empty doc is not zero (I 
had similar issues with the height of a doc where we systematically get 
one row too much). I believe this root cause should be fixed instead of 
the band aid your patch is providing
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)



From lich at math.spbu.ru  Tue May 13 15:28:16 2008
From: lich at math.spbu.ru (Kirill K. Smirnov)
Date: Wed, 14 May 2008 00:28:16 +0400
Subject: [PATCH] [cmd]: use correct codepage when outputing unicode text
	to an ANSI stream
Message-ID: <200805140028.16672.lich@math.spbu.ru>

>> This doesn't look right. What if it's wineconsole with user backend 
>> (default) and OEM CP (which is different then UNIXCP)? Should probably hack 
>> GetConsoleOutputCP() instead.
>>   
>this code is only used when no wineconsole is attached, so unixcp is the 
>right choice
No, this is used in case of output redirection too.
E.g. even in wineconsole, command
c:>dir > list.txt
will create a list.txt file in UNIXCP, but ConsoleOutputCP is expected. In 
most cases it does not hurt, but who knows...

>however, it can be considered that GetConsoleOutputCP() should be 
>changed to return the unixcp and not the oem cp when no console is attached

--
Kirill


From austinenglish at gmail.com  Tue May 13 14:41:59 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 13 May 2008 14:41:59 -0500
Subject: Lots of regressions in games in last few versions
In-Reply-To: <4827C82B.5090401@kievinfo.com>
References: <482646B7.5010105@kievinfo.com>
	<b6bb06270805111652pac0c3b1oc19cf53898b5b7e3@mail.gmail.com>
	<4827C82B.5090401@kievinfo.com>
Message-ID: <b6bb06270805131241u17329cdes320facf2edbb77ee@mail.gmail.com>

On Sun, May 11, 2008 at 11:31 PM, Vitaliy Margolen
<wine-devel at kievinfo.com> wrote:
>
> Austin English wrote:
>
> > 13120 - I'll run the test tomorrow if I can reproduce/no one has by then.
> > 13110 - no one requested a regression test. I've requested it now.
> > 13101 - not a regression
> > 13086 - not sure if it's always existed or a regression. I asked for
> > clarification.
> >
> > If anyone can identify regressions that haven't been bisected, shoot
> > me an e-mail. I've got plenty of CPU/time to kill.
> >
>  I'd appreciate it if you can do a regression testing for bug 12272? Game
> blood 2 with demo. Between wine-0.9.44 and wine-0.9.45. You will need to use
> native dinput.dll. Start the game (enter, enter, enter) and move the mouse
> around. You should see that with .45 it's really jumpy and in .44 it's nice
> and smooth.
>
>  I think it's either ddraw or d3d. But might be some other place.
>
>  Vitaliy
>

Just got back from vacation this weekend, and right when I start, you
had already done it :-P. Oh well, if you get more in the future
Vitaliy or anyone else, send me an e-mail/cc me on the bug. Most of
the regressions you pointed out have already been run.

-Austin


From truiken at gmail.com  Tue May 13 20:06:28 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 13 May 2008 20:06:28 -0500
Subject: comctl32: Fix statusbar text alignment bug #12693
In-Reply-To: <2bcb95620805131759q3a7f3793n5721d60c911a9b6f@mail.gmail.com>
References: <2bcb95620805131759q3a7f3793n5721d60c911a9b6f@mail.gmail.com>
Message-ID: <22821af30805131806j59bf9328y58d7e7bfda1836bc@mail.gmail.com>

On Tue, May 13, 2008 at 7:59 PM, Igor Tarasov <tarasov.igor at gmail.com> wrote:
> MSDN regarding statusbar text alignment says that "By default, text is
>  left-aligned <...> Text to the right of a single tab character is
>  centered, and text to the right of a second tab character is
>  right-aligned.". Current implementation, however, could be described
>  as "if the first character is tab, center the text. Then check second
>  character, if it is tab too, left-align the text". This patch makes
>  wine behave more like MSDN says and fixes bug
>  http://bugs.winehq.org/show_bug.cgi?id=12693 .
>

Please add a test case to prove this change is correct.

-- 
James Hawkins


From dmitry at codeweavers.com  Tue May 13 20:35:18 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 14 May 2008 10:35:18 +0900
Subject: comctl32: Fix statusbar text alignment bug #12693
References: <2bcb95620805131759q3a7f3793n5721d60c911a9b6f@mail.gmail.com>
	<22821af30805131806j59bf9328y58d7e7bfda1836bc@mail.gmail.com>
Message-ID: <DAAB2AAD8291415BA9459C76FFD39459@DMITRY>

"James Hawkins" <truiken at gmail.com> wrote:

> On Tue, May 13, 2008 at 7:59 PM, Igor Tarasov <tarasov.igor at gmail.com> wrote:
>> MSDN regarding statusbar text alignment says that "By default, text is
>>  left-aligned <...> Text to the right of a single tab character is
>>  centered, and text to the right of a second tab character is
>>  right-aligned.". Current implementation, however, could be described
>>  as "if the first character is tab, center the text. Then check second
>>  character, if it is tab too, left-align the text". This patch makes
>>  wine behave more like MSDN says and fixes bug
>>  http://bugs.winehq.org/show_bug.cgi?id=12693 .
>>
> 
> Please add a test case to prove this change is correct.

Since I reviewed initial Igor's attempts, and helped a bit, I don't see
a way how this behaviour can possibly be tested, that's a pure visual
thing, and Igor says that he has been testing his patch extensively with
ControlSpy.

-- 
Dmitry.


From truiken at gmail.com  Tue May 13 20:36:42 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 13 May 2008 20:36:42 -0500
Subject: comctl32: Fix statusbar text alignment bug #12693
In-Reply-To: <DAAB2AAD8291415BA9459C76FFD39459@DMITRY>
References: <2bcb95620805131759q3a7f3793n5721d60c911a9b6f@mail.gmail.com>
	<22821af30805131806j59bf9328y58d7e7bfda1836bc@mail.gmail.com>
	<DAAB2AAD8291415BA9459C76FFD39459@DMITRY>
Message-ID: <22821af30805131836w4f3e6123pd22f651626c2ffdc@mail.gmail.com>

On Tue, May 13, 2008 at 8:35 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
>
> "James Hawkins" <truiken at gmail.com> wrote:
>
>
> > On Tue, May 13, 2008 at 7:59 PM, Igor Tarasov <tarasov.igor at gmail.com>
> wrote:
> >
> > > MSDN regarding statusbar text alignment says that "By default, text is
> > >  left-aligned <...> Text to the right of a single tab character is
> > >  centered, and text to the right of a second tab character is
> > >  right-aligned.". Current implementation, however, could be described
> > >  as "if the first character is tab, center the text. Then check second
> > >  character, if it is tab too, left-align the text". This patch makes
> > >  wine behave more like MSDN says and fixes bug
> > >  http://bugs.winehq.org/show_bug.cgi?id=12693 .
> > >
> > >
> >
> > Please add a test case to prove this change is correct.
> >
>
>  Since I reviewed initial Igor's attempts, and helped a bit, I don't see
>  a way how this behaviour can possibly be tested, that's a pure visual
>  thing, and Igor says that he has been testing his patch extensively with
>  ControlSpy.
>

Ok that's fair.  I wasn't sure if it was possible to test or not.

-- 
James Hawkins


From julliard at winehq.org  Wed May 14 04:29:56 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 14 May 2008 11:29:56 +0200
Subject: wine.inf: add a fake dll for sensapi.dll
In-Reply-To: <b6bb06270805131251r71e3c09dhcebc3062cb823d7c@mail.gmail.com>
	(Austin English's message of "Tue, 13 May 2008 14:51:11 -0500")
References: <b6bb06270805112101k283439ferff255ecfa17c33c0@mail.gmail.com>
	<b6bb06270805131251r71e3c09dhcebc3062cb823d7c@mail.gmail.com>
Message-ID: <87ej856xnv.fsf@wine.dyndns.org>

"Austin English" <austinenglish at gmail.com> writes:

> Anything wrong with this patch?
>
> http://www.winehq.org/pipermail/wine-patches/2008-May/054794.html

It's not a valid git patch.

-- 
Alexandre Julliard
julliard at winehq.org


From kornelpal at gmail.com  Wed May 14 04:37:04 2008
From: kornelpal at gmail.com (=?iso-8859-1?B?S29ybulsIFDhbA==?=)
Date: Wed, 14 May 2008 11:37:04 +0200
Subject: mono progress on mixed-mode assemblies...
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
	<002001c8b1c6$c6fa6a00$83666250@kornelpal.hu>
	<a71bd89a0805090754o34dca0cew9eabe1165e203169@mail.gmail.com>
Message-ID: <005201c8b5a6$12700930$83666250@kornelpal.hu>

Hi,

> From: Dan Kegel
> But Wine has its own increasingly useful implementation of msvcrt,
> at least the part that uses the C api.  (The C++ api is difficult for us
> because it has to be written in C; g++ uses a different ABI than Microsoft 
> C++.)
>
> Perhaps, once we work the kinks out, Mono can rely on Wine once more
> to get this and related functionality.

That would be great.

Because mixed-mode (there is no pure managed version) msvcrts require 
Managed C++ and C++/CLI and there is no open source compiler supporting any 
of these so MS compilers would be required.

Also note that Mono's Class Library is licensed under MIT/X11 because 
inlining (done by the runtime) may be incompatible with GPL that would not 
allow non-GPL programs to be executed within Mono. Would it be possible to 
have a MIT/X11 licensed msvcrt?

Korn?l 



From dank at kegel.com  Wed May 14 04:55:48 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 14 May 2008 02:55:48 -0700
Subject: mono progress on mixed-mode assemblies...
In-Reply-To: <005201c8b5a6$12700930$83666250@kornelpal.hu>
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
	<002001c8b1c6$c6fa6a00$83666250@kornelpal.hu>
	<a71bd89a0805090754o34dca0cew9eabe1165e203169@mail.gmail.com>
	<005201c8b5a6$12700930$83666250@kornelpal.hu>
Message-ID: <a71bd89a0805140255x2dd903ccrcd2beef12677c8f9@mail.gmail.com>

On Wed, May 14, 2008 at 2:37 AM, Korn?l P?l <kornelpal at gmail.com> wrote:
>  Because mixed-mode (there is no pure managed version) msvcrts require
> Managed C++ and C++/CLI and there is no open source compiler supporting any
> of these so MS compilers would be required.

Bleah.  Well, you gotta do what you gotta do!

>  Also note that Mono's Class Library is licensed under MIT/X11 because
> inlining (done by the runtime) may be incompatible with GPL that would not
> allow non-GPL programs to be executed within Mono. Would it be possible to
> have a MIT/X11 licensed msvcrt?

That's an interesting question.  If you start from scratch, and make
it part of Mono, sure.
If you start with Wine's source code, you would need to get
permission from the authors who have contributed to
Wine's msvcrt.  I don't know how many there are, but it would
probably only take an hour or so for somebody to write
a script that generated the list of authors...
- Dan


From dank at kegel.com  Wed May 14 05:46:51 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 14 May 2008 03:46:51 -0700
Subject: TrendyFlash Site Builder works!
Message-ID: <a71bd89a0805140346q276ea926tbe2a8272f5bfc07f@mail.gmail.com>

http://bugs.winehq.org/show_bug.cgi?id=9376

People who generate annoying cookiecutter Flash web sites
can now migrate to LInux with confidence :-)


From patrol at sinus.cz  Wed May 14 06:26:31 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Wed, 14 May 2008 13:26:31 +0200
Subject: Serial port support in wine-1.0: What to do to make it working ?
In-Reply-To: <a71bd89a0805070657n434448d7tdf02a84c73010b2b@mail.gmail.com>
References: <a71bd89a0805070657n434448d7tdf02a84c73010b2b@mail.gmail.com>
Message-ID: <20080514112631.GA22229@tangens.sinus.cz>

> Pavel wrote:
> > I have to use wine-0.9.40 to communicate with a device
> > in my work (simple text-based command-reply communication),
> > any wine newer than say 0.9.50 doesn't work, the communication times out.
> > ... I will try to dig into the driver and search for the bugs there.
> > One of the cases is I think simple, the device uses normal ASCII protocol
> > and I can talk to it using kermit or minicom, but the windows program
> > intended to control it simply stucks on the first command and never
> >  gets a reply. I think there is a good place to start.
> 
> Yep.  FWIW, the fix might be tiny.  Alexandre fixed a serial bug today,
> http://bugs.winehq.org/show_bug.cgi?id=9356
> with just a single assignment.
> 
> If you can come up with a simple way for others to reproduce
> the problem, that might help, too.
> 
Hi!
  I have a very good news today! I tested the current wine git and I've found
that it works again in the case of a device mentioned above! It's really good,
because it didn't work in 0.9.61 and using 0.9.40 was not good because of
another problems in this version. Even better, I've also found that today's
wine fixes the last graphics glitches remaining in the program GUI, so now
it works PERFECTLY under wine, and it seems that reading/writing the device
over the serial port is even FASTER than from windows! 
  I will try another devices soon, to help to debug serial port problems
as much as possible!
  With regards, Pavel Troller


From kornelpal at gmail.com  Wed May 14 07:37:38 2008
From: kornelpal at gmail.com (=?iso-8859-1?B?S29ybulsIFDhbA==?=)
Date: Wed, 14 May 2008 14:37:38 +0200
Subject: mono progress on mixed-mode assemblies...
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
	<002001c8b1c6$c6fa6a00$83666250@kornelpal.hu>
	<a71bd89a0805090754o34dca0cew9eabe1165e203169@mail.gmail.com>
	<005201c8b5a6$12700930$83666250@kornelpal.hu>
	<a71bd89a0805140255x2dd903ccrcd2beef12677c8f9@mail.gmail.com>
Message-ID: <002401c8b5bf$4c0d2510$83666250@kornelpal.hu>

> From: Dan Kegel
>> Also note that Mono's Class Library is licensed under MIT/X11 because
>> inlining (done by the runtime) may be incompatible with GPL that would 
>> not
>> allow non-GPL programs to be executed within Mono. Would it be possible 
>> to
>> have a MIT/X11 licensed msvcrt?
>
> That's an interesting question.  If you start from scratch, and make
> it part of Mono, sure.
> If you start with Wine's source code, you would need to get
> permission from the authors who have contributed to
> Wine's msvcrt.  I don't know how many there are, but it would
> probably only take an hour or so for somebody to write
> a script that generated the list of authors...

I think that the best idea would be to have two separate code bases because 
that would allow more freedom for an experimental managed C++ runtime.

On the other hand patches could be merged manually so both Wine and Mono 
could benefit the changes.

So the question is: If the current authors permit to make msvcrt MIX/X11 
licensed would it be possible to make Wine's msvcrt MIT/X11 licensed for 
future releases as well (no legal question but philosophical)?

Korn?l 



From winehacker at gmail.com  Wed May 14 07:42:39 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Wed, 14 May 2008 08:42:39 -0400
Subject: mono progress on mixed-mode assemblies...
In-Reply-To: <002401c8b5bf$4c0d2510$83666250@kornelpal.hu>
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
	<002001c8b1c6$c6fa6a00$83666250@kornelpal.hu>
	<a71bd89a0805090754o34dca0cew9eabe1165e203169@mail.gmail.com>
	<005201c8b5a6$12700930$83666250@kornelpal.hu>
	<a71bd89a0805140255x2dd903ccrcd2beef12677c8f9@mail.gmail.com>
	<002401c8b5bf$4c0d2510$83666250@kornelpal.hu>
Message-ID: <19e31a080805140542y6bb3d2id9228b9491b6a125@mail.gmail.com>

On Wed, May 14, 2008 at 8:37 AM, Korn?l P?l <kornelpal at gmail.com> wrote:
>  So the question is: If the current authors permit to make msvcrt MIX/X11
>  licensed would it be possible to make Wine's msvcrt MIT/X11 licensed for
>  future releases as well (no legal question but philosophical)?

You will need to review the git history and contact anyone that has
contributed to msvcrt since the Wine changeover to LGPL and get
permission.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From kornelpal at gmail.com  Wed May 14 07:48:53 2008
From: kornelpal at gmail.com (=?iso-8859-1?B?S29ybulsIFDhbA==?=)
Date: Wed, 14 May 2008 14:48:53 +0200
Subject: mono progress on mixed-mode assemblies...
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
	<002001c8b1c6$c6fa6a00$83666250@kornelpal.hu>
	<a71bd89a0805090754o34dca0cew9eabe1165e203169@mail.gmail.com>
	<005201c8b5a6$12700930$83666250@kornelpal.hu>
	<a71bd89a0805140255x2dd903ccrcd2beef12677c8f9@mail.gmail.com>
	<002401c8b5bf$4c0d2510$83666250@kornelpal.hu>
	<19e31a080805140542y6bb3d2id9228b9491b6a125@mail.gmail.com>
Message-ID: <003c01c8b5c0$de6b9580$83666250@kornelpal.hu>

> From: Steven Edwards
>>  So the question is: If the current authors permit to make msvcrt MIX/X11
>>  licensed would it be possible to make Wine's msvcrt MIT/X11 licensed for
>>  future releases as well (no legal question but philosophical)?
>
> You will need to review the git history and contact anyone that has
> contributed to msvcrt since the Wine changeover to LGPL and get
> permission.

Thanks for the information. This makes the list even shorter.

If contributors agree only the current version will be MIT/X11 licensed.

But I would like to know if the Wine community is willing to license msvcrt 
under MIT/X11 after that in the future in Wine's source repository to help 
Mono?

Korn?l 



From wine-devel at kievinfo.com  Wed May 14 09:01:54 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 14 May 2008 08:01:54 -0600
Subject: dinput: Convert keyboard buffer from internal data format to
	user data format
In-Reply-To: <48040CD6.2030105@kievinfo.com>
References: <4802384D.1090704@gmail.com>
	<48024BE1.1090008@kievinfo.com>	<4803AA89.3070806@gmail.com>
	<48040CD6.2030105@kievinfo.com>
Message-ID: <482AF0D2.3060407@kievinfo.com>

Vitaliy Margolen wrote:
> Sergey Khodych wrote:
>>> Any particular reason for this? Do you have a program that sets different 
>>> data format? The reason I ask - copying 256 bytes is much faster then 
>>> iterating over the whole data format and copying one byte at a time.
>>>
>> A possibility of using custom data format, for any type of devices, is
>> described in DirectX SDK documentation.
>> For example Monolith's  F.E.A.R. use this method.
> 
> That is not what I asked. If you read MSDN it tells lots of things that are 
> not true. Also I do not recall seeing any problems with FEAR game that were 
> related dinput. If you have that bug handle please point me to it.

To reply to myself. I've missed the fact that if the requested format is the
same as Wine's internal format it will be a simple memcpy. I did not want to
penalize most dinput applications that just use default keyboard format (array
of 256 bytes).

Sergey, please resend this patch. It might resolve few keyboard problems
applications having with Wine. At least I hope it might.

Vitaliy.


From austinenglish at gmail.com  Wed May 14 10:29:22 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 14 May 2008 10:29:22 -0500
Subject: Serial port support in wine-1.0: What to do to make it working ?
In-Reply-To: <20080514112631.GA22229@tangens.sinus.cz>
References: <a71bd89a0805070657n434448d7tdf02a84c73010b2b@mail.gmail.com>
	<20080514112631.GA22229@tangens.sinus.cz>
Message-ID: <b6bb06270805140829t38774e8fhbdcbaf3700dae684@mail.gmail.com>

On Wed, May 14, 2008 at 6:26 AM, Pavel Troller <patrol at sinus.cz> wrote:
> Hi!
>  I have a very good news today! I tested the current wine git and I've found
> that it works again in the case of a device mentioned above! It's really good,
> because it didn't work in 0.9.61 and using 0.9.40 was not good because of
> another problems in this version. Even better, I've also found that today's
> wine fixes the last graphics glitches remaining in the program GUI, so now
> it works PERFECTLY under wine, and it seems that reading/writing the device
> over the serial port is even FASTER than from windows!
>  I will try another devices soon, to help to debug serial port problems
> as much as possible!
>  With regards, Pavel Troller
>
>
>

Wonderful! Can you add this information to the AppDB?


From patrol at sinus.cz  Wed May 14 10:57:01 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Wed, 14 May 2008 17:57:01 +0200
Subject: Serial port support in wine-1.0: What to do to make it working ?
In-Reply-To: <b6bb06270805140829t38774e8fhbdcbaf3700dae684@mail.gmail.com>
References: <a71bd89a0805070657n434448d7tdf02a84c73010b2b@mail.gmail.com>
	<20080514112631.GA22229@tangens.sinus.cz>
	<b6bb06270805140829t38774e8fhbdcbaf3700dae684@mail.gmail.com>
Message-ID: <20080514155701.GB11344@tangens.sinus.cz>

> On Wed, May 14, 2008 at 6:26 AM, Pavel Troller <patrol at sinus.cz> wrote:
> > Hi!
> >  I have a very good news today! I tested the current wine git and I've found
> > that it works again in the case of a device mentioned above! It's really good,
> > because it didn't work in 0.9.61 and using 0.9.40 was not good because of
> > another problems in this version. Even better, I've also found that today's
> > wine fixes the last graphics glitches remaining in the program GUI, so now
> > it works PERFECTLY under wine, and it seems that reading/writing the device
> > over the serial port is even FASTER than from windows!
> >  I will try another devices soon, to help to debug serial port problems
> > as much as possible!
> >  With regards, Pavel Troller
> >
> >
> >
> 
> Wonderful! Can you add this information to the AppDB?
> 
To which app ? My one is a very special program, working just with a special
telecom device. It's not available publicly anywhere. It doesn't have any entry
in AppDB, it would be useless.
  I will add remarks to other apps, which I will verify later (i.e. MapSource
souftware for Garmin GPS etc.).

With regards, Pavel Troller


From austinenglish at gmail.com  Wed May 14 11:07:04 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 14 May 2008 11:07:04 -0500
Subject: wine.inf: add a fake dll for sensapi.dll
In-Reply-To: <87ej856xnv.fsf@wine.dyndns.org>
References: <b6bb06270805112101k283439ferff255ecfa17c33c0@mail.gmail.com>
	<b6bb06270805131251r71e3c09dhcebc3062cb823d7c@mail.gmail.com>
	<87ej856xnv.fsf@wine.dyndns.org>
Message-ID: <b6bb06270805140907g70833b94gf7e19dd88121a1f0@mail.gmail.com>

Ahh. Here you go.

-Austin

On Wed, May 14, 2008 at 4:29 AM, Alexandre Julliard <julliard at winehq.org> wrote:
> "Austin English" <austinenglish at gmail.com> writes:
>
>> Anything wrong with this patch?
>>
>> http://www.winehq.org/pipermail/wine-patches/2008-May/054794.html
>
> It's not a valid git patch.
>
> --
> Alexandre Julliard
> julliard at winehq.org
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-wine.inf-add-fake-dll-entry-for-sensapi.patch
Type: text/x-diff
Size: 651 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080514/83224a14/attachment.patch 

From dank at kegel.com  Wed May 14 11:37:56 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 14 May 2008 09:37:56 -0700
Subject: ws2_32: Test for invalid hostnames again.
Message-ID: <a71bd89a0805140937q1b263f41xd79b4c456058c9db@mail.gmail.com>

Kai,
that test will always fail on some systems.  How about this:
just test for whether that function completes at all, rather
than testing for success.
- Dan


From dank at kegel.com  Wed May 14 12:31:10 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 14 May 2008 10:31:10 -0700
Subject: mono progress on mixed-mode assemblies...
In-Reply-To: <003c01c8b5c0$de6b9580$83666250@kornelpal.hu>
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
	<002001c8b1c6$c6fa6a00$83666250@kornelpal.hu>
	<a71bd89a0805090754o34dca0cew9eabe1165e203169@mail.gmail.com>
	<005201c8b5a6$12700930$83666250@kornelpal.hu>
	<a71bd89a0805140255x2dd903ccrcd2beef12677c8f9@mail.gmail.com>
	<002401c8b5bf$4c0d2510$83666250@kornelpal.hu>
	<19e31a080805140542y6bb3d2id9228b9491b6a125@mail.gmail.com>
	<003c01c8b5c0$de6b9580$83666250@kornelpal.hu>
Message-ID: <a71bd89a0805141031g43b070en2e71e04ed1070470@mail.gmail.com>

On Wed, May 14, 2008 at 5:48 AM, Korn?l P?l <kornelpal at gmail.com> wrote:
> If contributors agree only the current version will be MIT/X11 licensed.
>
> But I would like to know if the Wine community is willing to license msvcrt
> under MIT/X11 after that in the future in Wine's source repository to help
> Mono?

We can certainly discuss it.
- Dan


From jwhite at codeweavers.com  Wed May 14 15:42:29 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Wed, 14 May 2008 15:42:29 -0500
Subject: Wineconf 2008
Message-ID: <482B4EB5.7020306@codeweavers.com>

Hi Folks,

We have provisionally set Wineconf for the weekend of September 27/28 in Saint Paul, Minnesota.

The Wine conference is open to all.  We host 2 days of informal sessions
to discuss technical issues related to Wine development.  We'll likely also
have a celebration of Wine 1.0, and other social activities.

If you're interested in Wineconf, please visit this web page:

   http://www.winehq.org/site/wineconf/survey

In particular, if you have given up on Wineconf because
of travel costs, please indicate that on the form.

I'll use the response data I get there to nail down the details.

I look forward to seeing you all, and to celebrating 1.0!

Cheers,

Jeremy


From khodych at gmail.com  Wed May 14 16:10:06 2008
From: khodych at gmail.com (Sergey Khodych)
Date: Thu, 15 May 2008 00:10:06 +0300
Subject: dinput: Convert keyboard buffer from internal data format to
	user data format
In-Reply-To: <482AF0D2.3060407@kievinfo.com>
References: <4802384D.1090704@gmail.com>
	<48024BE1.1090008@kievinfo.com>	<4803AA89.3070806@gmail.com>
	<48040CD6.2030105@kievinfo.com> <482AF0D2.3060407@kievinfo.com>
Message-ID: <482B552E.50102@gmail.com>

> To reply to myself. I've missed the fact that if the requested format is 
> the
> same as Wine's internal format it will be a simple memcpy. I did not 
> want to
> penalize most dinput applications that just use default keyboard format 
> (array
> of 256 bytes).
> 
What do you think about using common buffer for all types of devices and 
translating a new event direct to user's data format? In this case we 
just copy buffer of base device.


From a_villacis at palosanto.com  Wed May 14 16:35:25 2008
From: a_villacis at palosanto.com (=?ISO-8859-1?Q?Alex_Villac=ED=ADs_Lasso?=)
Date: Wed, 14 May 2008 16:35:25 -0500
Subject: richedit: text that does not need scrollbar should also result in
	a scroll range of 0. Tests for this behavior.
In-Reply-To: <4829EC97.6070209@orange.fr>
References: <4829CBB5.3090908@palosanto.com> <4829EC97.6070209@orange.fr>
Message-ID: <482B5B1D.9010206@palosanto.com>

Eric Pouech escribi?:
> Alex Villac??s Lasso a ?crit :
>   
>> Even though the code freeze is still in effect, I post this so that it 
>> will be reviewed. For more information, see bug #12311.
>>
>> Changelog:
>> * richedit: empty text should result in a scroll range of 0.
>> * Tests for this behavior.
>>
>> ------------------------------------------------------------------------
>>
>>
>>     
> what I don't understand is why the height of an empty doc is not zero (I 
> had similar issues with the height of a doc where we systematically get 
> one row too much). I believe this root cause should be fixed instead of 
> the band aid your patch is providing
> A+
>
>   
The height of the document is irrelevant. Instead, if the actual height 
is less than the height of the client area, the scrollbar should also be 
set to zero, as shown by tests included in the attached patch. Empty 
text is just one special case.

Changelog:
* Text that does not need to be scrolled should also result in a scroll 
range of zero
* Tests for this behavior

-- 
perl -e '$x=2.4;print sprintf("%.0f + %.0f = %.0f\n",$x,$x,$x+$x);'

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0011-richedit-nonscrolled-text.patch
Type: text/x-patch
Size: 1382 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080514/ba3d100b/attachment.bin 

From dank at kegel.com  Wed May 14 17:21:09 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 14 May 2008 15:21:09 -0700
Subject: regressions running Photoshop?
Message-ID: <a71bd89a0805141521t6a8aecb4re049e21ce63f9c1a@mail.gmail.com>

Hmm.  I just tried running Photoshop CS2 trial and Photoshop 5.5 trial,
and both failed on current wine.

CS2 complained "not enough DOS memory",
and 5.5 complained
lcms: Error #12288; Too many tags (2025813777)

PS6 works, though.


From kris at pcbsd.com  Wed May 14 15:03:35 2008
From: kris at pcbsd.com (Kris Moore)
Date: Wed, 14 May 2008 16:03:35 -0400
Subject: Configure question about Wine / HAL
Message-ID: <482B4597.2050805@pcbsd.com>


I'm trying to get Wine to compile with HAL support on FreeBSD, and 
running into this error:

  > checking dbus/dbus.h usability... yes
  > checking dbus/dbus.h presence... yes
  > checking for dbus/dbus.h... yes
  > checking hal/libhal.h usability... yes
  > checking hal/libhal.h presence... yes
  > checking for hal/libhal.h... yes
  > checking for dbus_connection_close in -ldbus-1... no
  > configure: error: libhal development files not found, no dynamic device
  > support.
  > This is an error since --with-hal was requested.


What exactly is -ldbus-1? Is there a way around this? Configure is 
finding the dbus and hal headers properly, and they both work properly 
on the system.


-- 

Kris Moore
PC-BSD Software
http://www.pcbsd.com


From dank at kegel.com  Wed May 14 18:03:52 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 14 May 2008 16:03:52 -0700
Subject: shell32 failures only under winetest, not make test?
Message-ID: <a71bd89a0805141603o257be329p62ed1e91e49f35ad@mail.gmail.com>

Oddly, I only see
shelllink.c:90: Test succeeded inside todo block: SHILCreateFromPath
failed (0x00000000)
shelllink.c:194: Test succeeded inside todo block: path_to_pidl
returned a NULL pidl
shelllink.c:214: Test failed: GetPath returned 'C:\nonexistent\file'
shelllink: 190 tests executed (2 marked as todo, 3 failures), 0 skipped.
when I run on wine with winetest-dist.

When I do 'make test', shelllink.ok gets created fine.

Anyone else see that?


From wine-devel at kievinfo.com  Wed May 14 20:32:33 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 14 May 2008 19:32:33 -0600
Subject: dinput: Convert keyboard buffer from internal data format to
	user data format
In-Reply-To: <482B552E.50102@gmail.com>
References: <4802384D.1090704@gmail.com>
	<48024BE1.1090008@kievinfo.com>	<4803AA89.3070806@gmail.com>
	<48040CD6.2030105@kievinfo.com> <482AF0D2.3060407@kievinfo.com>
	<482B552E.50102@gmail.com>
Message-ID: <482B92B1.1030209@kievinfo.com>

Sergey Khodych wrote:
>> To reply to myself. I've missed the fact that if the requested format 
>> is the
>> same as Wine's internal format it will be a simple memcpy. I did not 
>> want to
>> penalize most dinput applications that just use default keyboard 
>> format (array
>> of 256 bytes).
>>
> What do you think about using common buffer for all types of devices and 
> translating a new event direct to user's data format? In this case we 
> just copy buffer of base device.

It's hard to find something common for say keyboard and joystick. Former 
have lots of only buttons while later can have lots of axes and only few 
buttons. So still have to use some specialized data buffer.

Or you mean to use user data format internally? That will still require some 
mapping - from indexes to offset & size. But that gets really messy and 
still requires conversion (which we are doing anyway). Unless everything 
will be changed in one go. However when I'm thinking about it - it will 
require extra work while doing object enumeration.

For a time being (during the code freeze) I'd prefer not to change any core 
functions.

Vitaliy.


From m.b.lankhorst at gmail.com  Thu May 15 00:05:36 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 14 May 2008 22:05:36 -0700
Subject: Configure question about Wine / HAL
In-Reply-To: <482B4597.2050805@pcbsd.com>
References: <482B4597.2050805@pcbsd.com>
Message-ID: <b130c85e0805142205i1b829437u63027edc8997c83f@mail.gmail.com>

Hello Kris,

2008/5/14 Kris Moore <kris at pcbsd.com>:
>
> I'm trying to get Wine to compile with HAL support on FreeBSD, and
> running into this error:
>
>  > checking dbus/dbus.h usability... yes
>  > checking dbus/dbus.h presence... yes
>  > checking for dbus/dbus.h... yes
>  > checking hal/libhal.h usability... yes
>  > checking hal/libhal.h presence... yes
>  > checking for hal/libhal.h... yes
>  > checking for dbus_connection_close in -ldbus-1... no
>  > configure: error: libhal development files not found, no dynamic device
>  > support.
>  > This is an error since --with-hal was requested.
>
>
> What exactly is -ldbus-1? Is there a way around this? Configure is
> finding the dbus and hal headers properly, and they both work properly
> on the system.
How do you link to libhal on freebsd? And how do you link to libdbus?

Cheers,
Maarten.


From kai.blin at gmail.com  Thu May 15 02:38:07 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Thu, 15 May 2008 09:38:07 +0200
Subject: ws2_32: Test for invalid hostnames again.
In-Reply-To: <a71bd89a0805140937q1b263f41xd79b4c456058c9db@mail.gmail.com>
References: <a71bd89a0805140937q1b263f41xd79b4c456058c9db@mail.gmail.com>
Message-ID: <200805150938.11280.kai.blin@gmail.com>

On Wednesday 14 May 2008 18:37:56 Dan Kegel wrote:
> Kai,
> that test will always fail on some systems.  How about this:
> just test for whether that function completes at all, rather
> than testing for success.

Seriously, if an ISP gets you to a spam page for nonexistant.winehq.org, can't 
we sue them for abusing the winehq.org trade mark? This really seems like 
breaking a valid test just to work around broken ISPs.

I admit that I'm a bit miffed that I didn't catch this in the 1-hour window 
between you sending that patch and Alexandre committing it, as it's now my 
time that's wasted by having to try again and again for a patch that gets 
past the discussion the initial patch should have gotten.

But yeah, I agree removing the ok() is acceptable as I'm mostly checking for a 
crash bug. I'll send another patch.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080515/50f8fadc/attachment.pgp 

From kai.blin at gmail.com  Thu May 15 02:53:54 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Thu, 15 May 2008 09:53:54 +0200
Subject: mono progress on mixed-mode assemblies...
In-Reply-To: <003c01c8b5c0$de6b9580$83666250@kornelpal.hu>
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
	<19e31a080805140542y6bb3d2id9228b9491b6a125@mail.gmail.com>
	<003c01c8b5c0$de6b9580$83666250@kornelpal.hu>
Message-ID: <200805150953.54972.kai.blin@gmail.com>

On Wednesday 14 May 2008 14:48:53 Korn?l P?l wrote:

> But I would like to know if the Wine community is willing to license msvcrt
> under MIT/X11 after that in the future in Wine's source repository to help
> Mono?

I've learned the hard way that it doesn't make sense to discuss this stuff 
before you actually have the code. So I'd suggest you first go and see if you 
can get the authors of that dll to agree to relicense for you and once that's 
done, we can discuss what happens with Wine's copy.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080515/33676d9c/attachment.pgp 

From tijl at ulyssis.org  Thu May 15 03:59:44 2008
From: tijl at ulyssis.org (Tijl Coosemans)
Date: Thu, 15 May 2008 10:59:44 +0200
Subject: Configure question about Wine / HAL
In-Reply-To: <482B4597.2050805@pcbsd.com>
References: <482B4597.2050805@pcbsd.com>
Message-ID: <200805151059.45768.tijl@ulyssis.org>

On Wednesday 14 May 2008 22:03:35 Kris Moore wrote:
> I'm trying to get Wine to compile with HAL support on FreeBSD, and
> running into this error:
> 
>> checking dbus/dbus.h usability... yes
>> checking dbus/dbus.h presence... yes
>> checking for dbus/dbus.h... yes
>> checking hal/libhal.h usability... yes
>> checking hal/libhal.h presence... yes
>> checking for hal/libhal.h... yes
>> checking for dbus_connection_close in -ldbus-1... no
>> configure: error: libhal development files not found, no dynamic device
>> support.
>> This is an error since --with-hal was requested.
> 
> What exactly is -ldbus-1? Is there a way around this? Configure is
> finding the dbus and hal headers properly, and they both work
> properly on the system.

Are you building using the wine port? Because that should autodetect
HAL when it's installed. If you're not using the port and running
configure yourself you probably need to set LDFLAGS. Something like:

env CPPFLAGS="-I/usr/local/include" LDFLAGS="-L/usr/local/lib" ./configure --verbose --with-hal


From dmitry at codeweavers.com  Thu May 15 04:45:33 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 15 May 2008 18:45:33 +0900
Subject: regressions running Photoshop?
References: <a71bd89a0805141521t6a8aecb4re049e21ce63f9c1a@mail.gmail.com>
Message-ID: <EF32901091D4435698DEFEF97DF5CBCF@DMITRY>

"Dan Kegel" <dank at kegel.com> wrote:

> Hmm.  I just tried running Photoshop CS2 trial and Photoshop 5.5 trial,
> and both failed on current wine.
> 
> CS2 complained "not enough DOS memory",
> and 5.5 complained
> lcms: Error #12288; Too many tags (2025813777)
> 
> PS6 works, though.

This looks like an installer problem. Photoshop CS2 installed with rc1
works, the one installed with today's git doesn't.

-- 
Dmitry.


From dmitry at codeweavers.com  Thu May 15 05:33:50 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 15 May 2008 19:33:50 +0900
Subject: regressions running Photoshop?
References: <a71bd89a0805141521t6a8aecb4re049e21ce63f9c1a@mail.gmail.com>
	<EF32901091D4435698DEFEF97DF5CBCF@DMITRY>
Message-ID: <B2D5631105214652A404ED7F86C7041D@DMITRY>

"Dmitry Timoshkov" <dmitry at codeweavers.com> wrote:

> "Dan Kegel" <dank at kegel.com> wrote:
> 
>> Hmm.  I just tried running Photoshop CS2 trial and Photoshop 5.5 trial,
>> and both failed on current wine.
>> 
>> CS2 complained "not enough DOS memory",
>> and 5.5 complained
>> lcms: Error #12288; Too many tags (2025813777)
>> 
>> PS6 works, though.
> 
> This looks like an installer problem. Photoshop CS2 installed with rc1
> works, the one installed with today's git doesn't.

The culprit is:

4046075462c00f4479f185d1c0514584ff851223 is first bad commit
commit 4046075462c00f4479f185d1c0514584ff851223
Author: Andrew Talbot <andrew.talbot at talbotville.com>
Date:   Tue May 13 22:41:58 2008 +0100

    cabinet: Remove order-of-evaluation dependencies.

In particular the following change:

-        n -= (e = (e = ZIPWSIZE - ((d &= ZIPWSIZE-1) > w ? d : w)) > n ?n:e);
+        d = max(d & (ZIPWSIZE - 1), w);
+        e = min(ZIPWSIZE - d, n);
+        n -= e;

I'll send a patch.

-- 
Dmitry.


From dank at kegel.com  Thu May 15 09:20:32 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 15 May 2008 07:20:32 -0700
Subject: regressions running Photoshop?
In-Reply-To: <B2D5631105214652A404ED7F86C7041D@DMITRY>
References: <a71bd89a0805141521t6a8aecb4re049e21ce63f9c1a@mail.gmail.com>
	<EF32901091D4435698DEFEF97DF5CBCF@DMITRY>
	<B2D5631105214652A404ED7F86C7041D@DMITRY>
Message-ID: <a71bd89a0805150720x69142b62j7cf6407daeec2e60@mail.gmail.com>

On Thu, May 15, 2008 at 3:33 AM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> The culprit is:
>
> 4046075462c00f4479f185d1c0514584ff851223 is first bad commit
> commit 4046075462c00f4479f185d1c0514584ff851223
> Author: Andrew Talbot <andrew.talbot at talbotville.com>
> Date:   Tue May 13 22:41:58 2008 +0100
>
>   cabinet: Remove order-of-evaluation dependencies.
>
> In particular the following change:
>
> -        n -= (e = (e = ZIPWSIZE - ((d &= ZIPWSIZE-1) > w ? d : w)) > n
> ?n:e);
> +        d = max(d & (ZIPWSIZE - 1), w);
> +        e = min(ZIPWSIZE - d, n);
> +        n -= e;
>
> I'll send a patch.

Thanks!  I feel bad - Susan had identified that as the culprit for
a Dragon Naturally Speaking regression, and I emailed the author
rather than the list.  Might have saved you an hour if I had sent it
to the list.
- Dan


From juan.lang at gmail.com  Thu May 15 09:27:50 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 15 May 2008 07:27:50 -0700
Subject: mono progress on mixed-mode assemblies...
In-Reply-To: <200805150953.54972.kai.blin@gmail.com>
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
	<19e31a080805140542y6bb3d2id9228b9491b6a125@mail.gmail.com>
	<003c01c8b5c0$de6b9580$83666250@kornelpal.hu>
	<200805150953.54972.kai.blin@gmail.com>
Message-ID: <3a768c550805150727h45908dc1veb19b38875a87501@mail.gmail.com>

> I've learned the hard way that it doesn't make sense to discuss this stuff
> before you actually have the code. So I'd suggest you first go and see if you
> can get the authors of that dll to agree to relicense for you and once that's
> done, we can discuss what happens with Wine's copy.

I'll try to make this process a little easier for you.  The code was
MIT/X11 licensed prior to 2002, so you don't need explicit permission
from authors prior to that time.  Furthermore, some of the authors
since that time have explicitly licensed their contributions as LGPL
and MIT/X11.  At least Eric Pouch and I are in that set.  Transgaming
has a list somewhere, though I couldn't find it just now.

The main contributors that have not done so that I saw after a quick
perusal were Alexandre and Rob Shearman.  If you can't get their
permission, you'd have to start with the last MIT/X11 licensed
version, or get Transgaming's most recent ReWind version and start
from there.
--Juan


From rob at codeweavers.com  Thu May 15 09:34:20 2008
From: rob at codeweavers.com (Robert Shearman)
Date: Thu, 15 May 2008 15:34:20 +0100
Subject: mono progress on mixed-mode assemblies...
In-Reply-To: <005201c8b5a6$12700930$83666250@kornelpal.hu>
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>	<002001c8b1c6$c6fa6a00$83666250@kornelpal.hu>	<a71bd89a0805090754o34dca0cew9eabe1165e203169@mail.gmail.com>
	<005201c8b5a6$12700930$83666250@kornelpal.hu>
Message-ID: <482C49EC.2020306@codeweavers.com>

Korn?l P?l wrote:
> Also note that Mono's Class Library is licensed under MIT/X11 because 
> inlining (done by the runtime) may be incompatible with GPL that would not 
> allow non-GPL programs to be executed within Mono. Would it be possible to 
> have a MIT/X11 licensed msvcrt?

I'm not sure if you realise it, but Wine is licensed under the LGPL, not 
the GPL so I don't think using Wine's msvcrt code would be a problem 
with inlining and using non-GPL programs.

However, I understand that having a uniform license for Mono's Class 
Library is probably highly desirable.

-- 
Rob Shearman



From a_villacis at palosanto.com  Thu May 15 10:27:31 2008
From: a_villacis at palosanto.com (=?ISO-8859-1?Q?Alex_Villac=ED=ADs_Lasso?=)
Date: Thu, 15 May 2008 10:27:31 -0500
Subject: richedit: text that does not need scrollbar should also result in
	a scroll range of 0. Tests for this behavior. Try 2.
In-Reply-To: <482B5B1D.9010206@palosanto.com>
References: <4829CBB5.3090908@palosanto.com> <4829EC97.6070209@orange.fr>
	<482B5B1D.9010206@palosanto.com>
Message-ID: <482C5663.4030008@palosanto.com>

Alex Villac??s Lasso escribi?:
> Eric Pouech escribi?:
>> Alex Villac??s Lasso a ?crit :
>>  
>>> Even though the code freeze is still in effect, I post this so that 
>>> it will be reviewed. For more information, see bug #12311.
>>>
>>> Changelog:
>>> * richedit: empty text should result in a scroll range of 0.
>>> * Tests for this behavior.
>>>
>>> ------------------------------------------------------------------------ 
>>>
>>>
>>>
>>>     
>> what I don't understand is why the height of an empty doc is not zero 
>> (I had similar issues with the height of a doc where we 
>> systematically get one row too much). I believe this root cause 
>> should be fixed instead of the band aid your patch is providing
>> A+
>>
>>   
> The height of the document is irrelevant. Instead, if the actual 
> height is less than the height of the client area, the scrollbar 
> should also be set to zero, as shown by tests included in the attached 
> patch. Empty text is just one special case.
>
> Changelog:
> * Text that does not need to be scrolled should also result in a 
> scroll range of zero
> * Tests for this behavior

The previous version resulted in a misassignment of the range when scrollbars
forced visible but scroll range makes scrollbar visible. This version fixes it.

Changelog:
* Text that does not need to be scrolled should also result in a scroll 
range of zero
* Tests for this behavior

-- 
perl -e '$x=2.4;print sprintf("%.0f + %.0f = %.0f\n",$x,$x,$x+$x);'

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0011-richedit-nonscrolled-text-try2.patch
Type: text/x-patch
Size: 1524 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080515/612f99ba/attachment.bin 

From kris at pcbsd.com  Thu May 15 10:59:17 2008
From: kris at pcbsd.com (Kris Moore)
Date: Thu, 15 May 2008 11:59:17 -0400
Subject: Configure question about Wine / HAL
In-Reply-To: <200805151059.45768.tijl@ulyssis.org>
References: <482B4597.2050805@pcbsd.com> <200805151059.45768.tijl@ulyssis.org>
Message-ID: <482C5DD5.5010203@pcbsd.com>


I was building the port, and hal / dbus were both installed. The funny 
thing was that the first time I built the port, it didn't even get this 
far, it said :  "checking for hal/libhal.h... no", but if I checked in 
/usr/local/include/hal, libhal.h was in there. Then I made a link to 
/usr/include "ln -s /usr/local/include/hal /usr/include/hal" and was 
able to get this far now.

I will cvsup again tonight and recheck this to confirm my findings though.


-- 

Kris Moore
PC-BSD Software
http://www.pcbsd.com


Tijl Coosemans wrote:
> On Wednesday 14 May 2008 22:03:35 Kris Moore wrote:
>> I'm trying to get Wine to compile with HAL support on FreeBSD, and
>> running into this error:
>>
>>> checking dbus/dbus.h usability... yes
>>> checking dbus/dbus.h presence... yes
>>> checking for dbus/dbus.h... yes
>>> checking hal/libhal.h usability... yes
>>> checking hal/libhal.h presence... yes
>>> checking for hal/libhal.h... yes
>>> checking for dbus_connection_close in -ldbus-1... no
>>> configure: error: libhal development files not found, no dynamic device
>>> support.
>>> This is an error since --with-hal was requested.
>> What exactly is -ldbus-1? Is there a way around this? Configure is
>> finding the dbus and hal headers properly, and they both work
>> properly on the system.
> 
> Are you building using the wine port? Because that should autodetect
> HAL when it's installed. If you're not using the port and running
> configure yourself you probably need to set LDFLAGS. Something like:
> 
> env CPPFLAGS="-I/usr/local/include" LDFLAGS="-L/usr/local/lib" ./configure --verbose --with-hal
> 
> !DSPAM:1,482bfef620034310919711!
> 
> 


From kornelpal at gmail.com  Thu May 15 12:36:58 2008
From: kornelpal at gmail.com (=?ISO-8859-1?B?S29ybulsIFDhbA==?=)
Date: Thu, 15 May 2008 19:36:58 +0200
Subject: mono progress on mixed-mode assemblies...
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
	<19e31a080805140542y6bb3d2id9228b9491b6a125@mail.gmail.com>
	<003c01c8b5c0$de6b9580$83666250@kornelpal.hu>
	<200805150953.54972.kai.blin@gmail.com>
	<3a768c550805150727h45908dc1veb19b38875a87501@mail.gmail.com>
Message-ID: <006901c8b6b2$47e568f0$1cfe6250@kornelpal.hu>

> From: Juan Lang
> The main contributors that have not done so that I saw after a quick
> perusal were Alexandre and Rob Shearman.  If you can't get their
> permission, you'd have to start with the last MIT/X11 licensed
> version, or get Transgaming's most recent ReWind version and start
> from there.

I had a look at msvcrt of the latest ReWind that is quite old but should be 
enough as well for the reqired parts. After examining the mixed-mode msvcrt 
(just the metadata not the code) I found that it contains little if any 
managed code so I will most likely be able to forward calls to a native 
msvcrt.

As a conclusion I think that there will be no licensing problems.

> I'm not sure if you realise it, but Wine is licensed under the LGPL, not
> the GPL so I don't think using Wine's msvcrt code would be a problem
> with inlining and using non-GPL programs.

Inlining (done by the JIT at run time) is not just linking (that is 
permitted LGPL) and may not be permitted by LGPL.

Korn?l 



From jwhite at codeweavers.com  Thu May 15 12:47:04 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Thu, 15 May 2008 12:47:04 -0500
Subject: Call for help with Wine 1.0 testing
Message-ID: <482C7718.50509@codeweavers.com>

Hi Folks,

One key goal for Wine 1.0 is that all of its conformance
tests run successfully on nearly all systems.  We would really like
your help in figuring out how close we are to that goal.

To that end, if you are comfortable with checking Wine out via git,
could you please visit this page:
   http://wiki.winehq.org/MakeTestFailures
and follow the instructions there?  (It's really simple; build current
git Wine, download + run a script).

And, if you're a Wine developer, since Alexandre is away and the code freeze
is on, why not look for one of those failures in your own make test results and see
if you can fix it?

Thanks!

Jeremy


From xerox_xerox2000 at yahoo.co.uk  Thu May 15 16:11:16 2008
From: xerox_xerox2000 at yahoo.co.uk (Louis Lenders)
Date: Thu, 15 May 2008 21:11:16 +0000 (UTC)
Subject: Call for help with Wine 1.0 testing
References: <482C7718.50509@codeweavers.com>
Message-ID: <loom.20080515T210909-602@post.gmane.org>

Jeremy White <jwhite <at> codeweavers.com> writes:

> 
> Hi Folks,
> 
> One key goal for Wine 1.0 is that all of its conformance
> tests run successfully on nearly all systems.  We would really like
> your help in figuring out how close we are to that goal.
> 
> To that end, if you are comfortable with checking Wine out via git,
> could you please visit this page:
>    http://wiki.winehq.org/MakeTestFailures
> and follow the instructions there?  (It's really simple; build current
> git Wine, download + run a script).
> 
> And, if you're a Wine developer, since Alexandre is away and the code freeze
> is on, why not look for one of those failures in your own make test results
and see
> if you can fix it?
> 
> Thanks!
> 
> Jeremy
> 
> 


Unfortunately the test crashes here with:
 
Running: d3d8:volume (60 of 335)
fixme:d3d:IWineD3DImpl_FillGLCaps OpenGL implementation supports 32 vertex s
fixme:d3d:IWineD3DImpl_FillGLCaps Expected vertex samplers + MAX_TEXTURES(=8
fixme:win:EnumDisplayDevicesW ((null),0,0x33f7cc,0x00000000), stub!
Running: d3d9:d3d9ex (61 of 335)
fixme:d3d:IWineD3DImpl_FillGLCaps OpenGL implementation supports 32 vertex s   
                                            amplers and 32 total samplers
fixme:d3d:IWineD3DImpl_FillGLCaps Expected vertex samplers + MAX_TEXTURES(=8   
                                            ) > combined_samplers
fixme:win:EnumDisplayDevicesW ((null),0,0x33f8cc,0x00000000), stub!
X Error of failed request:  GLXBadDrawable
  Major opcode of failed request:  143 (GLX)
  Minor opcode of failed request:  5 (X_GLXMakeCurrent)
  Serial number of failed request:  263
  Current serial number in output stream:  263

Those tests in d3d8/d3d9 used to pass fine here a few weeks ago






From dank at kegel.com  Thu May 15 17:40:50 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 15 May 2008 15:40:50 -0700
Subject: [Wine] Call for help with Wine 1.0 testing
In-Reply-To: <482C7718.50509@codeweavers.com>
References: <482C7718.50509@codeweavers.com>
Message-ID: <a71bd89a0805151540g1773fd9fif6023520f90b212@mail.gmail.com>

On Thu, May 15, 2008 at 10:47 AM, Jeremy White <jwhite at codeweavers.com> wrote:
> One key goal for Wine 1.0 is that all of its conformance
> tests run successfully on nearly all systems.  We would really like
> your help in figuring out how close we are to that goal.
>
> To that end, if you are comfortable with checking Wine out via git,
> could you please visit this page:
>  http://wiki.winehq.org/MakeTestFailures

The results are pouring in at
http://test.winehq.org/data/2470b0b31605133ec046330dd79fdccaa7ba33fe/#group_Wine

Say, who maintains that web site?  It'd be handy to have an option to
suppress rows that have neither crashes nor failures; right now you have
to scroll vertically a whole lot to see all the failures.
- Dan


From jwhite at codeweavers.com  Thu May 15 18:52:48 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Thu, 15 May 2008 18:52:48 -0500
Subject: [Wine] Call for help with Wine 1.0 testing
In-Reply-To: <a71bd89a0805151540g1773fd9fif6023520f90b212@mail.gmail.com>
References: <482C7718.50509@codeweavers.com>
	<a71bd89a0805151540g1773fd9fif6023520f90b212@mail.gmail.com>
Message-ID: <482CCCD0.1090304@codeweavers.com>

> Say, who maintains that web site?  It'd be handy to have an option to
> suppress rows that have neither crashes nor failures; right now you have
> to scroll vertically a whole lot to see all the failures.

I'm not sure.  The source is in this git tree:

  http://source.winehq.org/git/tools.git

Cheers,

Jeremy


From dmitry at codeweavers.com  Thu May 15 21:19:23 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 16 May 2008 11:19:23 +0900
Subject: ALSA Midi port names
References: <1210865729.7680.24.camel@ubuntu>
Message-ID: <DF0093B506D84D34BB3D61EE04DFBF96@DMITRY>

"Free Ekanayaka" <free at 64studio.com> wrote:

> ?I attach an amended patch for this bug:
>
> http://bugs.winehq.org/show_bug.cgi?id=13241

As it's been said the first hunk of your patch looks incorrect and
seems not related. Also, please use your real name, Wine doesn't
accept anonymous patches.

-- 
Dmitry. 



From jwhite at codeweavers.com  Thu May 15 21:32:25 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Thu, 15 May 2008 21:32:25 -0500
Subject: Right way to cope with user error in make test?
Message-ID: <482CF239.7000207@codeweavers.com>

So...turns out that in this flood of new reporting, that one of the errors
only happened to me, and it further turns out to be entirely user error;
I didn't have libxslt.

So, the obvious first solution is for me to actually read my configure
results and deal with it.

But I think I serve nicely as an example of the sort of incompetent user
for whom it would still be nice to have make test work cleanly.

I didn't see any obvious standard way of coping with this situation.
Did I miss it?  I imagined that maybe we'd skip these cases, but I didn't
see evidence of that.  I could also imagine a facility whereby we note
that the configure was not clean, and then refuse to run make test
(or at least refuse to run the full winetest battery).  Should we make
libxslt non optional (or at least require an explicit --without-libxslt
in order to build without it)?

Cheers,

Jeremy


From leslie_alistair at hotmail.com  Thu May 15 23:48:51 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Fri, 16 May 2008 14:48:51 +1000
Subject: Right way to cope with user error in make test?
References: <482CF239.7000207@codeweavers.com>
Message-ID: <g0j3nl$dp8$1@ger.gmane.org>

"Jeremy White" <jwhite at codeweavers.com> wrote in message 
news:482CF239.7000207 at codeweavers.com...
> So...turns out that in this flood of new reporting, that one of the errors
> only happened to me, and it further turns out to be entirely user error;
> I didn't have libxslt.
>
> So, the obvious first solution is for me to actually read my configure
> results and deal with it.
>
> But I think I serve nicely as an example of the sort of incompetent user
> for whom it would still be nice to have make test work cleanly.
>
> I didn't see any obvious standard way of coping with this situation.
> Did I miss it?  I imagined that maybe we'd skip these cases, but I didn't
> see evidence of that.  I could also imagine a facility whereby we note
> that the configure was not clean, and then refuse to run make test
> (or at least refuse to run the full winetest battery).  Should we make
> libxslt non optional (or at least require an explicit --without-libxslt
> in order to build without it)?
Hi Jeremy,

This could be a good option.  libxslt should properly be non-optional
since msxml3 relys on it.


From dank at kegel.com  Fri May 16 00:33:08 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 15 May 2008 22:33:08 -0700
Subject: [Wine] Call for help with Wine 1.0 testing
In-Reply-To: <482CCCD0.1090304@codeweavers.com>
References: <482C7718.50509@codeweavers.com>
	<a71bd89a0805151540g1773fd9fif6023520f90b212@mail.gmail.com>
	<482CCCD0.1090304@codeweavers.com>
Message-ID: <a71bd89a0805152233q21c331b8g1c02c6ca35e47a07@mail.gmail.com>

On Thu, May 15, 2008 at 4:52 PM, Jeremy White <jwhite at codeweavers.com> wrote:
>> Say, who maintains that web site?  It'd be handy to have an option to
>> suppress rows that have neither crashes nor failures; right now you have
>> to scroll vertically a whole lot to see all the failures.
>
> I'm not sure.  The source is in this git tree:
>  http://source.winehq.org/git/tools.git

I wrote a postprocessor to do it.  It's at http://kegel.com/wine/skipgood.pl.txt
An example of its output is at http://kegel.com/wine/failing.html
It really does make it easier to see all the failures.


From jeroen.janssen at gmail.com  Fri May 16 02:43:24 2008
From: jeroen.janssen at gmail.com (Jeroen Janssen)
Date: Fri, 16 May 2008 07:43:24 +0000 (UTC)
Subject: Configure question about Wine / HAL
References: <482B4597.2050805@pcbsd.com> <200805151059.45768.tijl@ulyssis.org>
	<482C5DD5.5010203@pcbsd.com>
Message-ID: <loom.20080516T073741-492@post.gmane.org>

Kris Moore <kris <at> pcbsd.com> writes:
> 
> I was building the port, and hal / dbus were both installed. The funny 
> thing was that the first time I built the port, it didn't even get this 
> far, it said :  "checking for hal/libhal.h... no", but if I checked in 
> /usr/local/include/hal, libhal.h was in there. Then I made a link to 
> /usr/include "ln -s /usr/local/include/hal /usr/include/hal" and was 
> able to get this far now.
> 
> I will cvsup again tonight and recheck this to confirm my findings though.

You might want to try using --hal-includes=/usr/local/include and
--hal-libraries=/usr/local/lib/ (or something similar). 
At least that is what should be possible if I read configure --help correctly.

Maybe "checking for dbus_connection_close in -ldbus-1" requires to be able to
link to the hal libraries? (and only symlinking the hal include path doesn't
result in the libaries to be found).

Hope this helps,

Jeroen Janssen




From xixsimplicityxix at gmail.com  Fri May 16 00:43:22 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 16 May 2008 00:43:22 -0500
Subject: [Wine] Call for help with Wine 1.0 testing
In-Reply-To: <a71bd89a0805152233q21c331b8g1c02c6ca35e47a07@mail.gmail.com>
References: <482C7718.50509@codeweavers.com>
	<a71bd89a0805151540g1773fd9fif6023520f90b212@mail.gmail.com>
	<482CCCD0.1090304@codeweavers.com>
	<a71bd89a0805152233q21c331b8g1c02c6ca35e47a07@mail.gmail.com>
Message-ID: <78a7dad00805152243g618a96b3x6756fdd1938bb77e@mail.gmail.com>

On Fri, May 16, 2008 at 12:33 AM, Dan Kegel <dank at kegel.com> wrote:
> On Thu, May 15, 2008 at 4:52 PM, Jeremy White <jwhite at codeweavers.com> wrote:
> I wrote a postprocessor to do it.  It's at http://kegel.com/wine/skipgood.pl.txt
> An example of its output is at http://kegel.com/wine/failing.html
> It really does make it easier to see all the failures.
>
>
>

Your webserver doesn't like serving your skipgood.pl.txt file =/

--John


From msclrhd at googlemail.com  Fri May 16 02:37:17 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Fri, 16 May 2008 08:37:17 +0100
Subject: [Wine] Call for help with Wine 1.0 testing
In-Reply-To: <a71bd89a0805152233q21c331b8g1c02c6ca35e47a07@mail.gmail.com>
References: <482C7718.50509@codeweavers.com>
	<a71bd89a0805151540g1773fd9fif6023520f90b212@mail.gmail.com>
	<482CCCD0.1090304@codeweavers.com>
	<a71bd89a0805152233q21c331b8g1c02c6ca35e47a07@mail.gmail.com>
Message-ID: <3f4fd2640805160037rd687362w4a1ff69d9f2bada0@mail.gmail.com>

2008/5/16 Dan Kegel <dank at kegel.com>:
> On Thu, May 15, 2008 at 4:52 PM, Jeremy White <jwhite at codeweavers.com> wrote:
>>> Say, who maintains that web site?  It'd be handy to have an option to
>>> suppress rows that have neither crashes nor failures; right now you have
>>> to scroll vertically a whole lot to see all the failures.
>>
>> I'm not sure.  The source is in this git tree:
>>  http://source.winehq.org/git/tools.git
>
> I wrote a postprocessor to do it.  It's at http://kegel.com/wine/skipgood.pl.txt
> An example of its output is at http://kegel.com/wine/failing.html
> It really does make it easier to see all the failures.

Looks nice, but the original one is useful too as it shows the todo
and skipped results in there as well.

Is there a way to show how many tests are failing because they are
todo block successes. For example, the ntdll results can be ignored as
the error is a todo block success that seems to be triggered only on
certain machines (3/4 of the 17 results thus far); this would then
help focus the effort on the failures that are more important.

- Reece


From tijl at ulyssis.org  Fri May 16 05:58:18 2008
From: tijl at ulyssis.org (Tijl Coosemans)
Date: Fri, 16 May 2008 12:58:18 +0200
Subject: Configure question about Wine / HAL
In-Reply-To: <482C5DD5.5010203@pcbsd.com>
References: <482B4597.2050805@pcbsd.com> <200805151059.45768.tijl@ulyssis.org>
	<482C5DD5.5010203@pcbsd.com>
Message-ID: <200805161258.20138.tijl@ulyssis.org>

On Thursday 15 May 2008 17:59:17 Kris Moore wrote:
> I was building the port, and hal / dbus were both installed. The
> funny thing was that the first time I built the port, it didn't even
> get this far, it said :  "checking for hal/libhal.h... no", but if I
> checked in /usr/local/include/hal, libhal.h was in there. Then I made
> a link to /usr/include "ln -s /usr/local/include/hal
> /usr/include/hal" and was able to get this far now.

Can you upload the config.log file somewhere? Or mail it to me
privately.


From kornelpal at gmail.com  Fri May 16 06:04:47 2008
From: kornelpal at gmail.com (=?ISO-8859-1?B?S29ybulsIFDhbA==?=)
Date: Fri, 16 May 2008 13:04:47 +0200
Subject: mono progress on mixed-mode assemblies...
References: <a71bd89a0805090318v177de82cw55b90b72c0a20fab@mail.gmail.com>
	<002001c8b1c6$c6fa6a00$83666250@kornelpal.hu>
	<a71bd89a0805090754o34dca0cew9eabe1165e203169@mail.gmail.com>
	<005201c8b5a6$12700930$83666250@kornelpal.hu>
	<a71bd89a0805140255x2dd903ccrcd2beef12677c8f9@mail.gmail.com>
	<002401c8b5bf$4c0d2510$83666250@kornelpal.hu>
	<19e31a080805140542y6bb3d2id9228b9491b6a125@mail.gmail.com>
	<003c01c8b5c0$de6b9580$83666250@kornelpal.hu>
	<a71bd89a0805141031g43b070en2e71e04ed1070470@mail.gmail.com>
Message-ID: <001601c8b744$a8596870$1cfe6250@kornelpal.hu>

Hi,

I have spent some time to investigate the mixed-mode msvcrt issue.

There are three different runtime DLLs:
msvcm80/90.dll managed C++ runtime implemented using native code
msvcp80/90.dll C++ runtime
msvcr80/90.dll C runtime

The managed version does only have it's own functionaly while even managed 
executables created with MS VC++ import the usual C/C++ runtime 
functionality from msvcp80/90.dll and msvcr80/90.dll files.

So there is no need to duplicate C runtime functionality in msvcm80/90.dll.

msvcm80/90.dll files are part of MS VC++ redistributable files just as the 
other runtime files are so I think there is no need to duplicate this 
functionality because the original MS versions are redistributable with the 
applications.

I also have read the EULAs of MS VC++ 2005 and 2008 redistributables and 
none of the forbids the use on non-Microsoft operating systems:
http://www.microsoft.com/downloads/details.aspx?familyid=200B2FD9-AE1A-4A14-984D-389C36F85647&displaylang=en
http://www.microsoft.com/downloads/details.aspx?familyid=9B2DA534-3E03-4391-8A4D-074B9F2BC1BF&displaylang=en

Korn?l 



From fengyuning1984 at gmail.com  Fri May 16 03:30:19 2008
From: fengyuning1984 at gmail.com (FENG Yu Ning)
Date: Fri, 16 May 2008 16:30:19 +0800
Subject: A console screen buffer sync problem in kernel32/editline.c
Message-ID: <a505dc9d0805160130s18be6cdav2353f714ac665798@mail.gmail.com>

I have found a synchronization problem in kernel32/editline.c . The
problem appears when read and write operations to the console are in
different threads.

Detail information is here:

    http://bugs.winehq.org/show_bug.cgi?id=13188

Solution to it should not be difficult. Could any developers look into
this and fix it? Thanks very much!


From kris at pcbsd.com  Fri May 16 06:26:29 2008
From: kris at pcbsd.com (Kris Moore)
Date: Fri, 16 May 2008 07:26:29 -0400
Subject: Configure question about Wine / HAL
In-Reply-To: <200805161258.20138.tijl@ulyssis.org>
References: <482B4597.2050805@pcbsd.com> <200805151059.45768.tijl@ulyssis.org>
	<482C5DD5.5010203@pcbsd.com> <200805161258.20138.tijl@ulyssis.org>
Message-ID: <482D6F65.8050001@pcbsd.com>



I just rebuilt wine 0.9.61 from ports, and same problem:

checking dbus/dbus.h usability... yes
checking dbus/dbus.h presence... yes
checking for dbus/dbus.h... yes
checking hal/libhal.h usability... yes
checking hal/libhal.h presence... yes
checking for hal/libhal.h... yes
checking for dbus_connection_close in -ldbus-1... no

Here's the complete build.log:
http://www.pcbsd.org/~kris/build.log.gz

Here's the package list of this chroot environment
http://www.pcbsd.org/~kris/pkg_list

For the record, I'm building wine in a chroot environment for usage in 
our PBI format. However, as you can see from the pkg_list, I have built 
all the various packages that should be required. I also tried building 
the port on my desktop directly, and had the exact same error, so I'm 
sure its nothing about the chroot environment causing this problem.

Thanks!


Tijl Coosemans wrote:
> On Thursday 15 May 2008 17:59:17 Kris Moore wrote:
>> I was building the port, and hal / dbus were both installed. The
>> funny thing was that the first time I built the port, it didn't even
>> get this far, it said :  "checking for hal/libhal.h... no", but if I
>> checked in /usr/local/include/hal, libhal.h was in there. Then I made
>> a link to /usr/include "ln -s /usr/local/include/hal
>> /usr/include/hal" and was able to get this far now.
> 
> Can you upload the config.log file somewhere? Or mail it to me
> privately.
> 
> !DSPAM:1,482d67ef20031449582031!
> 
> 


From susancragin at earthlink.net  Fri May 16 06:44:28 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Fri, 16 May 2008 07:44:28 -0400 (GMT-04:00)
Subject: Right way to cope with user error in make test?
Message-ID: <2555168.1210938268859.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>

I have a string of crashes in my maketest. 
Distro Hardy UbuntuStudio, machine ASUS G1S. 
Several triaged Ubuntu bugs may be responsible. 
For instance, my video drivers don't work and I have defaulted to vesa.
My soundcard doesn't yet work properly, and there are two open bugs related to this, one to do with my motherboard.
HTH. 




From tijl at ulyssis.org  Fri May 16 07:29:06 2008
From: tijl at ulyssis.org (Tijl Coosemans)
Date: Fri, 16 May 2008 14:29:06 +0200
Subject: Configure question about Wine / HAL
In-Reply-To: <482D6F65.8050001@pcbsd.com>
References: <482B4597.2050805@pcbsd.com> <200805161258.20138.tijl@ulyssis.org>
	<482D6F65.8050001@pcbsd.com>
Message-ID: <200805161429.08158.tijl@ulyssis.org>

On Friday 16 May 2008 13:26:29 Kris Moore wrote:
> I just rebuilt wine 0.9.61 from ports, and same problem:
> 
> checking dbus/dbus.h usability... yes
> checking dbus/dbus.h presence... yes
> checking for dbus/dbus.h... yes
> checking hal/libhal.h usability... yes
> checking hal/libhal.h presence... yes
> checking for hal/libhal.h... yes
> checking for dbus_connection_close in -ldbus-1... no
> 
> Here's the complete build.log:
> http://www.pcbsd.org/~kris/build.log.gz
> 
> Here's the package list of this chroot environment
> http://www.pcbsd.org/~kris/pkg_list
> 
> For the record, I'm building wine in a chroot environment for usage
> in our PBI format. However, as you can see from the pkg_list, I have
> built all the various packages that should be required. I also tried
> building the port on my desktop directly, and had the exact same
> error, so I'm sure its nothing about the chroot environment causing
> this problem.

Thanks, but I still want to have a look at config.log because I suspect
/usr/local/include and /usr/local/lib aren't added to CPPFLAGS and
LDFLAGS properly and config.log contains more info about that. It
should be in the Wine build dir after running configure.


From dank at kegel.com  Fri May 16 09:58:03 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 16 May 2008 07:58:03 -0700
Subject: [Wine] Call for help with Wine 1.0 testing
In-Reply-To: <78a7dad00805152243g618a96b3x6756fdd1938bb77e@mail.gmail.com>
References: <482C7718.50509@codeweavers.com>
	<a71bd89a0805151540g1773fd9fif6023520f90b212@mail.gmail.com>
	<482CCCD0.1090304@codeweavers.com>
	<a71bd89a0805152233q21c331b8g1c02c6ca35e47a07@mail.gmail.com>
	<78a7dad00805152243g618a96b3x6756fdd1938bb77e@mail.gmail.com>
Message-ID: <a71bd89a0805160758r33c5a7f5ue3c593698d00fb87@mail.gmail.com>

On Thu, May 15, 2008 at 10:43 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>> I wrote a postprocessor to do it.  It's at http://kegel.com/wine/skipgood.pl.txt
>> An example of its output is at http://kegel.com/wine/failing.html
>> It really does make it easier to see all the failures.
>
> Your webserver doesn't like serving your skipgood.pl.txt file =/

Bleah.  I added a symlink, you can see it now at
http://kegel.com/wine/skipgood.txt

I also updated http://kegel.com/wine/failing.html
It's very interesting to see what's failing!

The d3d9/visual tests seemed to pass for Jeremy White, but only because
a skip() was missing.  Patch sent,
http://winehq.org/pipermail/wine-patches/2008-May/054930.html

The only tests that are failing for every system are shell32:shelllink
and d3d9/visual.
shelllink doesn't fail when run via make test,
so it might be a winetest artifact.

Do the d3d9/visual tests really pass for *anybody*?

The user32/msg tests pass if you have a good window manager, as noted
on http://wiki.winehq.org/MakeTestFailures

As Jeremy suggested, several of the remaining failures might
be missing packages at build time, and we could deal with some
of those by making them mandatory.
- Dan


From dank at kegel.com  Fri May 16 10:00:32 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 16 May 2008 08:00:32 -0700
Subject: [Wine] Call for help with Wine 1.0 testing
In-Reply-To: <3f4fd2640805160037rd687362w4a1ff69d9f2bada0@mail.gmail.com>
References: <482C7718.50509@codeweavers.com>
	<a71bd89a0805151540g1773fd9fif6023520f90b212@mail.gmail.com>
	<482CCCD0.1090304@codeweavers.com>
	<a71bd89a0805152233q21c331b8g1c02c6ca35e47a07@mail.gmail.com>
	<3f4fd2640805160037rd687362w4a1ff69d9f2bada0@mail.gmail.com>
Message-ID: <a71bd89a0805160800n31fdafbfjcab0cad64090b406@mail.gmail.com>

On Fri, May 16, 2008 at 12:37 AM, Reece Dunn <msclrhd at googlemail.com> wrote:
>> I wrote a postprocessor to do it.  It's at http://kegel.com/wine/skipgood.pl.txt
>> An example of its output is at http://kegel.com/wine/failing.html
>
> Looks nice, but the original one is useful too as it shows the todo
> and skipped results in there as well.

Yeah.  How 'bout this: provide both the original and the postprocessed
file.  People who want the postprocessed version will just have to
know to add /failing.html for now.  That will get us up and running quick.

> Is there a way to show how many tests are failing because they are
> todo block successes. For example, the ntdll results can be ignored as
> the error is a todo block success that seems to be triggered only on
> certain machines (3/4 of the 17 results thus far); this would then
> help focus the effort on the failures that are more important.

Not easy for the postprocessor given the current data, I think.
I wouldn't worry about that detail too much.


From jwhite at winehq.org  Fri May 16 10:49:37 2008
From: jwhite at winehq.org (Jeremy White)
Date: Fri, 16 May 2008 10:49:37 -0500
Subject: Right way to cope with user error in make test?
In-Reply-To: <g0j3nl$dp8$1@ger.gmane.org>
References: <482CF239.7000207@codeweavers.com> <g0j3nl$dp8$1@ger.gmane.org>
Message-ID: <482DAD11.6010802@winehq.org>

Hi Alistair,

> This could be a good option.  libxslt should properly be non-optional
> since msxml3 relys on it.
> 
> From the Makefile.in, its appears to have linked to libxslt for quite some 
> time,
> but was never an issue since it was never used.
> 
> Francois Gouget raised this bug,
> http://bugs.winehq.org/show_bug.cgi?id=13035
> that libslt should be dynamic, which could be another option.

I think in my case the problem is a bit different; I have the library -
what I don't have are the development headers.  Thus the linking all
works, but HAVE_LIBXSLT is not defined, so the transform function
ends up as a stub, and goes on to fail.

And I still don't know a right answer.

The attached patch is one approach - skip the tests in this case.

Does this seem like a reasonable approach to folks?

Cheers,

Jeremy


-------------- next part --------------
A non-text attachment was scrubbed...
Name: msxmltest.diff
Type: text/x-patch
Size: 681 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080516/9ca4ff3d/attachment.bin 

From dank at kegel.com  Fri May 16 13:57:04 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 16 May 2008 11:57:04 -0700
Subject: What graphics cards do the d3d9 tests pass on?
Message-ID: <a71bd89a0805161157n4865746co8eee28d61a062d6@mail.gmail.com>

Anyone know how to get the d3d9 tests to pass?
Are there a set of graphic cards that are known to work with them?

Right now, nobody who's reported test results under wine is seeing them pass:
http://test.winehq.org/data/2470b0b31605133ec046330dd79fdccaa7ba33fe/#group_Wine:d3d9:visual
And, come to think of it, ditto for Windows:
http://test.winehq.org/data/200804161000/#group_XP:d3d9:visual
(though the data's pretty thin there).
All the apparant successes are really just skipped tests.
- Dan


From dank at kegel.com  Fri May 16 14:05:41 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 16 May 2008 12:05:41 -0700
Subject: Right way to cope with user error in make test?
Message-ID: <a71bd89a0805161205n12aada90q41fe09f5b9eb2f37@mail.gmail.com>

jwhite wrote:
> The attached patch is one approach - skip the tests in this case.
> Does this seem like a reasonable approach to folks?

I like it.

I would also like to see us get a lot tougher about
letting people build wine without a full complement
of development headers.  Maybe our configure
should have a sanity check at the end, and abort
if something optional but very common is missing;
we could add a --no-sanity-check option to enable
configuring in that case if it's really intended.
- Dan


From xerox_xerox2000 at yahoo.co.uk  Fri May 16 14:17:26 2008
From: xerox_xerox2000 at yahoo.co.uk (Louis Lenders)
Date: Fri, 16 May 2008 19:17:26 +0000 (UTC)
Subject: What graphics cards do the d3d9 tests pass on?
References: <a71bd89a0805161157n4865746co8eee28d61a062d6@mail.gmail.com>
Message-ID: <loom.20080516T191344-491@post.gmane.org>

Dan Kegel <dank <at> kegel.com> writes:

> 
> Anyone know how to get the d3d9 tests to pass?
> Are there a set of graphic cards that are known to work with them?
> 
> Right now, nobody who's reported test results under wine is seeing them pass:
>
http://test.winehq.org/data/2470b0b31605133ec046330dd79fdccaa7ba33fe/#group_Wine:d3d9:visual
> And, come to think of it, ditto for Windows:
> http://test.winehq.org/data/200804161000/#group_XP:d3d9:visual
> (though the data's pretty thin there).
> All the apparant successes are really just skipped tests.
> - Dan
> 
> 

I think the tests also suffer from the d3d-regressions. When i ran the tests a
few weeks ago, o saw some fancy visual-tests carried out on my computer
(red/green/yellow rectangles etc).The tests took quite some time to finish.

 Right now i only see the screen flashing black a few times, and that's it.
Looks like most tests are really skipped. Maybe we should a regression test to
see what patch broke this




From stefan at codeweavers.com  Fri May 16 14:18:03 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 16 May 2008 21:18:03 +0200
Subject: What graphics cards do the d3d9 tests pass on?
In-Reply-To: <a71bd89a0805161157n4865746co8eee28d61a062d6@mail.gmail.com>
References: <a71bd89a0805161157n4865746co8eee28d61a062d6@mail.gmail.com>
Message-ID: <200805162118.03575.stefan@codeweavers.com>

Am Freitag, 16. Mai 2008 20:57:04 schrieb Dan Kegel:
> Anyone know how to get the d3d9 tests to pass?
> Are there a set of graphic cards that are known to work with them?
Nvidia gf6 and gf7 cards are confirmed. However, there's a rather strange bug 
in the instancing test. I do not see this failure, but Henri saw it, and it 
can be seen in some failures.

> Right now, nobody who's reported test results under wine is seeing them
> pass:
http://test.winehq.org/data/2470b0b31605133ec046330dd79fdccaa7ba33fe/wine_xp_ajackson-hardy-amd/d3d9%3Avisual.txt
http://test.winehq.org/data/2470b0b31605133ec046330dd79fdccaa7ba33fe/wine_xp_bmartin-gutsy32/d3d9%3Avisual.txt
http://test.winehq.org/data/2470b0b31605133ec046330dd79fdccaa7ba33fe/wine_xp_bratch-gentoo-amd64/d3d9%3Avisual.txt
http://test.winehq.org/data/2470b0b31605133ec046330dd79fdccaa7ba33fe/wine_xp_dank-hp/d3d9%3Avisual.txt
http://test.winehq.org/data/2470b0b31605133ec046330dd79fdccaa7ba33fe/wine_xp_dimesio-opensuse-32/d3d9%3Avisual.txt
http://test.winehq.org/data/2470b0b31605133ec046330dd79fdccaa7ba33fe/wine_xp_sritchie-hardy-64/d3d9%3Avisual.txt

Those pass the test without failures. There are 27 TODOs, but well, they're 
TODOs. There is no way to get "0 skipped" on the visual test, because some 
tests are only executed on cards which do *not* have a specific feature, like 
the conditional NP2 test(skipped if unconditional non power of two support 
exists)

Let me check the others(from left to right, hoping you have the same order):
-> I don't see why it writes "failed". Timeout maybe?
-> That's the instancing failure
-> success
-> success
-> success
-> I guess the gf3 failures you reported. Can you resend your patch? I think 
we should get it in, unless Henri sends his
-> ditto
-> ditto
-> ditto
-> success
-> gf3
-> success
-> no idea :-(
-> That one looks strange; It has the shademode failure, but the other failure 
looks odd
-> I've no idea what's wrong here; It is an nvidia card, but things like fog 
and pixel shaders look very messed up.
-> skip
-> skip
-> strange, no idea
-> ATI driver. See remarks below
-> broken GL setup?
-> success
-> skip
-> No idea

Wrt the ATI driver:
http://ati.cchtml.com/show_bug.cgi?id=1031
http://ati.cchtml.com/show_bug.cgi?id=1030
and others will probably kill the visual tests for a very long time. Matthew 
Tippet is happy to fix bugs which have a huge impact on gamers(once we get 
them isolated :-/), but he didn't sound as if he wants to invest any time in 
making our d3d9 test happy.


From htl10 at users.sourceforge.net  Fri May 16 14:38:53 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Fri, 16 May 2008 19:38:53 +0000 (GMT)
Subject: curious failure and messages running a well-known installer
Message-ID: <696888.41606.qm@web23104.mail.ird.yahoo.com>

I install the win32 version of ghostscript quite routinely under wine; just taken the old one off and put the new one in with wine rc1, the first time it bombed out with:

err:module:map_image Could not map section _winzip_, file probably truncated
err:module:map_image Could not map section _winzip_, file probably truncated
wine: could not load L"H:\\mirror.cs.wisc.edu\\pub\\mirrors\\ghost\\GPL\\current\\gs862w32.exe": Bad EXE format for 

and 2nd/3rd time it went to completion. This is the first time ever I have a 
failure installing ghostscript. There are some messages which I don't remember seeing
before also:

fixme:shell:IShellLinkA_fnGetPath (0x14a980): WIN32_FIND_DATA is not yet filled.
fixme:shell:IShellLinkA_fnGetPath (0x14aae8): WIN32_FIND_DATA is not yet filled.

I seem to recall the _winzip_ thing is a known and fixed problem? anyway, the installer
is at http://mirror.cs.wisc.edu/pub/mirrors/ghost/GPL/current/gs862w32.exe
and I'd be interested to hear if somebody else the _winzip_ failure message.



      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html


From wine-devel at kievinfo.com  Fri May 16 14:45:49 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Fri, 16 May 2008 13:45:49 -0600
Subject: What graphics cards do the d3d9 tests pass on?
In-Reply-To: <a71bd89a0805161157n4865746co8eee28d61a062d6@mail.gmail.com>
References: <a71bd89a0805161157n4865746co8eee28d61a062d6@mail.gmail.com>
Message-ID: <482DE46D.9060300@kievinfo.com>

Dan Kegel wrote:
> Anyone know how to get the d3d9 tests to pass?
> Are there a set of graphic cards that are known to work with them?
> 
> Right now, nobody who's reported test results under wine is seeing them pass:
> http://test.winehq.org/data/2470b0b31605133ec046330dd79fdccaa7ba33fe/#group_Wine:d3d9:visual
> And, come to think of it, ditto for Windows:
> http://test.winehq.org/data/200804161000/#group_XP:d3d9:visual
> (though the data's pretty thin there).
> All the apparant successes are really just skipped tests.
> - Dan
> 
> 
Pass here fine with current GIT - nVidia 6600GT 128MB. However you have to 
run it with default config (virtual desktop and XVidMode break some tests).

Vitaliy.


From dank at kegel.com  Fri May 16 14:48:04 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 16 May 2008 12:48:04 -0700
Subject: What graphics cards do the d3d9 tests pass on?
In-Reply-To: <200805162118.03575.stefan@codeweavers.com>
References: <a71bd89a0805161157n4865746co8eee28d61a062d6@mail.gmail.com>
	<200805162118.03575.stefan@codeweavers.com>
Message-ID: <a71bd89a0805161248r6758e0e6wafc8b94dce6d215@mail.gmail.com>

On Fri, May 16, 2008 at 12:18 PM, Stefan D?singer
<stefan at codeweavers.com> wrote:
> Nvidia gf6 and gf7 cards are confirmed.

OK.

> Those pass the test without failures. There are 27 TODOs, but well, they're
> TODOs. There is no way to get "0 skipped" on the visual test...

Ah, didn't realize that.  I was being too picky.  OK, the records you
listed have the
following graphics cards:

 nVidia Corporation G70 [GeForce 7600 GT] (rev a1)
 nVidia Corporation G80 [GeForce 8800 GTX] (rev a2)
 nVidia Corporation NV40 [GeForce 6800] (rev a1)
 nVidia Corporation NV41GL [Quadro FX 1400] (rev a2)
 nVidia Corporation Unknown device 0611 (rev a2)

so I guess you can add gf 8 to the list...

> Let me check the others(from left to right, hoping you have the same order):

More tests keep coming in, so I don't know which is which.  Best to stick
a url next to each interesting line.

> -> I guess the gf3 failures you reported. Can you resend your patch? I think
> we should get it in, unless Henri sends his

Sure, I'll resend it once AJ is back.

> Wrt the ATI driver:
> http://ati.cchtml.com/show_bug.cgi?id=1031
> http://ati.cchtml.com/show_bug.cgi?id=1030
> and others will probably kill the visual tests for a very long time. Matthew
> Tippet is happy to fix bugs which have a huge impact on gamers(once we get
> them isolated :-/), but he didn't sound as if he wants to invest any time in
> making our d3d9 test happy.

gaah
- Dan


From austinenglish at gmail.com  Fri May 16 14:54:36 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 16 May 2008 14:54:36 -0500
Subject: Right way to cope with user error in make test?
In-Reply-To: <a71bd89a0805161205n12aada90q41fe09f5b9eb2f37@mail.gmail.com>
References: <a71bd89a0805161205n12aada90q41fe09f5b9eb2f37@mail.gmail.com>
Message-ID: <b6bb06270805161254g2a6877deh5035d900fe686232@mail.gmail.com>

On Fri, May 16, 2008 at 2:05 PM, Dan Kegel <dank at kegel.com> wrote:
> jwhite wrote:
>> The attached patch is one approach - skip the tests in this case.
>> Does this seem like a reasonable approach to folks?
>
> I like it.
>
> I would also like to see us get a lot tougher about
> letting people build wine without a full complement
> of development headers.  Maybe our configure
> should have a sanity check at the end, and abort
> if something optional but very common is missing;
> we could add a --no-sanity-check option to enable
> configuring in that case if it's really intended.
> - Dan
>
>
>

We could have dotests check the config.log to see if there were any
dependencies missing, and warn/fail as appropriate.


From dank at kegel.com  Fri May 16 14:57:17 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 16 May 2008 12:57:17 -0700
Subject: Right way to cope with user error in make test?
In-Reply-To: <b6bb06270805161254g2a6877deh5035d900fe686232@mail.gmail.com>
References: <a71bd89a0805161205n12aada90q41fe09f5b9eb2f37@mail.gmail.com>
	<b6bb06270805161254g2a6877deh5035d900fe686232@mail.gmail.com>
Message-ID: <a71bd89a0805161257n6b65bfdey126199abde6540a9@mail.gmail.com>

On Fri, May 16, 2008 at 12:54 PM, Austin English
<austinenglish at gmail.com> wrote:
>> I would also like to see us get a lot tougher about
>> letting people build wine without a full complement
>> of development headers.  Maybe our configure
>> should have a sanity check at the end, and abort
>> if something optional but very common is missing;
>> we could add a --no-sanity-check option to enable
>> configuring in that case if it's really intended.
>
> We could have dotests check the config.log to see if there were any
> dependencies missing, and warn/fail as appropriate.

That only helps dotests.  I'm thinking we should increase
build quality of wine for other situations, too.


From austinenglish at gmail.com  Fri May 16 15:00:20 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 16 May 2008 15:00:20 -0500
Subject: Right way to cope with user error in make test?
In-Reply-To: <a71bd89a0805161257n6b65bfdey126199abde6540a9@mail.gmail.com>
References: <a71bd89a0805161205n12aada90q41fe09f5b9eb2f37@mail.gmail.com>
	<b6bb06270805161254g2a6877deh5035d900fe686232@mail.gmail.com>
	<a71bd89a0805161257n6b65bfdey126199abde6540a9@mail.gmail.com>
Message-ID: <b6bb06270805161300k1521d661o9c8264949c3f3902@mail.gmail.com>

On Fri, May 16, 2008 at 2:57 PM, Dan Kegel <dank at kegel.com> wrote:
>> We could have dotests check the config.log to see if there were any
>> dependencies missing, and warn/fail as appropriate.
>
> That only helps dotests.  I'm thinking we should increase
> build quality of wine for other situations, too.
>

True, but with Alexandre on vacation, you won't be able to fix
./configure now. Fixing it there is ideal, but if Alexandre won't
accept, at least we can get dotests better results.


From wine-devel at kievinfo.com  Fri May 16 15:19:36 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Fri, 16 May 2008 14:19:36 -0600
Subject: Right way to cope with user error in make test?
In-Reply-To: <a71bd89a0805161205n12aada90q41fe09f5b9eb2f37@mail.gmail.com>
References: <a71bd89a0805161205n12aada90q41fe09f5b9eb2f37@mail.gmail.com>
Message-ID: <482DEC58.4060807@kievinfo.com>

Dan Kegel wrote:
> jwhite wrote:
>> The attached patch is one approach - skip the tests in this case.
>> Does this seem like a reasonable approach to folks?
> 
> I like it.
> 
> I would also like to see us get a lot tougher about
> letting people build wine without a full complement
> of development headers.  Maybe our configure
> should have a sanity check at the end, and abort
> if something optional but very common is missing;
> we could add a --no-sanity-check option to enable
> configuring in that case if it's really intended.
> - Dan
> 
IMHO configure should abort if any of the required libraries are missing and 
'--without-<bar>' flag was not given. Pretty much anything that prints out 
warning if it was not found.

Hopefully this will prevent broken builds and invalid bug/problem reports.

Vitaliy.


From austinenglish at gmail.com  Fri May 16 16:56:40 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 16 May 2008 16:56:40 -0500
Subject: [Wine] Call for help with Wine 1.0 testing
In-Reply-To: <482C7718.50509@codeweavers.com>
References: <482C7718.50509@codeweavers.com>
Message-ID: <b6bb06270805161456s1119d930k35abb0ecffef9047@mail.gmail.com>

On Thu, May 15, 2008 at 12:47 PM, Jeremy White <jwhite at codeweavers.com> wrote:
> Hi Folks,
>
> One key goal for Wine 1.0 is that all of its conformance
> tests run successfully on nearly all systems.  We would really like
> your help in figuring out how close we are to that goal.
>
> To that end, if you are comfortable with checking Wine out via git,
> could you please visit this page:
>  http://wiki.winehq.org/MakeTestFailures
> and follow the instructions there?  (It's really simple; build current
> git Wine, download + run a script).
>
> And, if you're a Wine developer, since Alexandre is away and the code freeze
> is on, why not look for one of those failures in your own make test results
> and see
> if you can fix it?
>
> Thanks!
>
> Jeremy
>
>

I've updated http://wiki.winehq.org/MakeTestFailures a bit. I've added
more bug reports for test failures, and split them into generic and
specific bug reports.

@wine-devel:
I've tagged quite a few bugs that only occur on PC-BSD and/or
OpenSolaris, but not in Ubuntu Feisty (on a vm with the same
settings). Anyone with spare time might take a look at those bugs, and
see what is blocking our porting efforts. I'll work on getting those
two on real hardware sometime in the next week or two for better
testing.

@wine-users
Try testing this under as much hardware as you can. Just make sure
wine is compiling properly (check ./configure --verbose for any
warnings).

-Austin


From leslie_alistair at hotmail.com  Fri May 16 17:18:30 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Sat, 17 May 2008 08:18:30 +1000
Subject: Right way to cope with user error in make test?
In-Reply-To: <482DAD11.6010802@winehq.org>
References: <482CF239.7000207@codeweavers.com> <g0j3nl$dp8$1@ger.gmane.org>
	<482DAD11.6010802@winehq.org>
Message-ID: <BAY117-W18D17E8D61EFB789AB2B1293C80@phx.gbl>

Hi Jeremy,
  


> Date: Fri, 16 May 2008 10:49:37 -0500> From: jwhite at winehq.org> To: leslie_alistair at hotmail.com> CC: wine-devel at winehq.org> Subject: Re: Right way to cope with user error in make test?> > Hi Alistair,> > > This could be a good option. libxslt should properly be non-optional> > since msxml3 relys on it.> > > > From the Makefile.in, its appears to have linked to libxslt for quite some > > time,> > but was never an issue since it was never used.> > > > Francois Gouget raised this bug,> > http://bugs.winehq.org/show_bug.cgi?id=13035> > that libslt should be dynamic, which could be another option.> > I think in my case the problem is a bit different; I have the library -> what I don't have are the development headers. Thus the linking all> works, but HAVE_LIBXSLT is not defined, so the transform function> ends up as a stub, and goes on to fail.> > And I still don't know a right answer.> > The attached patch is one approach - skip the tests in this case.> > Does this seem like a reasonable approach to folks?> Looks good to me.
 
Best Regards
 Alistair Leslie-Hughes
_________________________________________________________________
Search for local singles online @ Lavalife - Click here
http://a.ninemsn.com.au/b.aspx?URL=http%3A%2F%2Flavalife9%2Eninemsn%2Ecom%2Eau%2Fclickthru%2Fclickthru%2Eact%3Fid%3Dninemsn%26context%3Dan99%26locale%3Den%5FAU%26a%3D30290&_t=764581033&_r=email_taglines_Search_OCT07&_m=EXT
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080517/2a30300b/attachment.htm 

From aeleneski at comcast.net  Fri May 16 18:01:15 2008
From: aeleneski at comcast.net (Andrew Eleneski)
Date: Fri, 16 May 2008 19:01:15 -0400
Subject: What graphics cards do the d3d9 tests pass on?
References: a71bd89a0805161157n4865746co8eee28d61a062d6@mail.gmail.com
Message-ID: <482E123B.40608@comcast.net>

For my box I am running Kubuntu Hardy with Ati driver version 8.4. I see 
I crashed on the d3d9:stateblock, and have quite a few failures in the 
d3d9:visual area.


From scott at open-vote.org  Fri May 16 18:39:15 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Fri, 16 May 2008 16:39:15 -0700
Subject: Right way to cope with user error in make test?
In-Reply-To: <482CF239.7000207@codeweavers.com>
References: <482CF239.7000207@codeweavers.com>
Message-ID: <482E1B23.7060505@open-vote.org>

On Ubuntu, doing something like apt-get build-dep wine will prevent
those kind of user errors.

Really we just need to improve the wiki page a bit rather than bother
with extra work on make test.

Thanks,
Scott Ritchie

Jeremy White wrote:
> So...turns out that in this flood of new reporting, that one of the errors
> only happened to me, and it further turns out to be entirely user error;
> I didn't have libxslt.
> 
> So, the obvious first solution is for me to actually read my configure
> results and deal with it.
> 
> But I think I serve nicely as an example of the sort of incompetent user
> for whom it would still be nice to have make test work cleanly.
> 
> I didn't see any obvious standard way of coping with this situation.
> Did I miss it?  I imagined that maybe we'd skip these cases, but I didn't
> see evidence of that.  I could also imagine a facility whereby we note
> that the configure was not clean, and then refuse to run make test
> (or at least refuse to run the full winetest battery).  Should we make
> libxslt non optional (or at least require an explicit --without-libxslt
> in order to build without it)?
> 
> Cheers,
> 
> Jeremy
> 
> 



From kris at pcbsd.com  Fri May 16 16:45:56 2008
From: kris at pcbsd.com (Kris Moore)
Date: Fri, 16 May 2008 17:45:56 -0400
Subject: Configure question about Wine / HAL
In-Reply-To: <200805161429.08158.tijl@ulyssis.org>
References: <482B4597.2050805@pcbsd.com> <200805161258.20138.tijl@ulyssis.org>
	<482D6F65.8050001@pcbsd.com> <200805161429.08158.tijl@ulyssis.org>
Message-ID: <482E0094.9020804@pcbsd.com>


Here you go!

http://www.pcbsd.org/~kris/config.log


Tijl Coosemans wrote:
> On Friday 16 May 2008 13:26:29 Kris Moore wrote:
>> I just rebuilt wine 0.9.61 from ports, and same problem:
>>
>> checking dbus/dbus.h usability... yes
>> checking dbus/dbus.h presence... yes
>> checking for dbus/dbus.h... yes
>> checking hal/libhal.h usability... yes
>> checking hal/libhal.h presence... yes
>> checking for hal/libhal.h... yes
>> checking for dbus_connection_close in -ldbus-1... no
>>
>> Here's the complete build.log:
>> http://www.pcbsd.org/~kris/build.log.gz
>>
>> Here's the package list of this chroot environment
>> http://www.pcbsd.org/~kris/pkg_list
>>
>> For the record, I'm building wine in a chroot environment for usage
>> in our PBI format. However, as you can see from the pkg_list, I have
>> built all the various packages that should be required. I also tried
>> building the port on my desktop directly, and had the exact same
>> error, so I'm sure its nothing about the chroot environment causing
>> this problem.
> 
> Thanks, but I still want to have a look at config.log because I suspect
> /usr/local/include and /usr/local/lib aren't added to CPPFLAGS and
> LDFLAGS properly and config.log contains more info about that. It
> should be in the Wine build dir after running configure.
> 
> !DSPAM:1,482d7d3a20034557112297!
> 
> 


From dank at kegel.com  Fri May 16 20:17:48 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 16 May 2008 18:17:48 -0700
Subject: Search data seems to show that each new product seems to raise Wine's
	profile a bit
Message-ID: <a71bd89a0805161817v2117064x24ecf3d5acd802aa@mail.gmail.com>

It's a small effect, and it's not really surprising,
but if you look at a graph of the relative search volume for the phrases
  linux wine
  linux photoshop
  linux warcraft
  linux steam
it seems that each time a new big app starts working on Linux
enough for people to start searching for it (photoshop, warcraft, steam),
the number of queries for linux wine goes up a little bit.

http://www.google.com/trends?q=linux+wine%2Clinux+photoshop%2C+linux+warcraft%2C+linux+steam&ctab=0&geo=all&date=all&sort=0

I'm just pleased to see that the effect is measurable, and not lost in
the noise...


From chmorgan at gmail.com  Fri May 16 21:43:22 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Fri, 16 May 2008 22:43:22 -0400
Subject: Right way to cope with user error in make test?
In-Reply-To: <482E1B23.7060505@open-vote.org>
References: <482CF239.7000207@codeweavers.com> <482E1B23.7060505@open-vote.org>
Message-ID: <f3f1b91a0805161943i5c88babfp1d71767282b8a5ec@mail.gmail.com>

On Fri, May 16, 2008 at 7:39 PM, Scott Ritchie <scott at open-vote.org> wrote:
> On Ubuntu, doing something like apt-get build-dep wine will prevent
> those kind of user errors.
>
> Really we just need to improve the wiki page a bit rather than bother
> with extra work on make test.
>
> Thanks,
> Scott Ritchie
>

The configure checks seem to make the most sense as they detect the
issue before the user runs into it. Improving the wiki page is a good
idea but doesn't help if you don't know you have a problem and/or
don't know which wiki page you should be looking at.

Chris


From dank at kegel.com  Fri May 16 22:54:28 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 16 May 2008 20:54:28 -0700
Subject: Wine 1.0 release status: 27 bugs left
Message-ID: <a71bd89a0805162054l42514d99kad54b1e6d84cb586@mail.gmail.com>

Clickable copy at http://kegel.com/wine/countdown.html

Wine Release Status

Wine 1.0rc1 released on May 9. 6 days to second release candidate.

wine-1.0rc1 was released on Friday, May 9th, 2008. Wine is now in a
code freeze in preparation for the 1.0 release.

According to http://wiki.winehq.org/WineReleasePlan, wine-1.0.0-rc2
will be due out Friday, May 23rd, 2008. It will be something like be
the next to last release candidate for 1.0.

Alexandre is on vacation, so git is a bit stale.
In particular, Photoshop CS2 and DNS 9 don't install properly due to a
regression introduced just before his vacation started; here's the
fix.

Some effort has been put into making it easy for people to
automatically report "make test" failures; see MakeTestFailures for
info and results.

Bug Status

There are 27 open 1.0 bugs as of 16 May. Most of these will simply be
rolled over to be fixed for a later release; we only have time to fix
a few, and much as we'd like to fix the rest, most are not
showstoppers.

Changes since last week (with category and votes):

New (!):
8783      ntdll     15   USB serial ports do not work
13168     -unknown  0    Update the README before the 1.0 release

Fixed:
3270      gdi32     16   Problem with minimized top-level windows
5844      -unknown  16   tray minimize
5926      programs  1    Wine does not provide an implementation of winhlp32.exe
5948      -unknown  2    Star Trek: Armada does not install
8898      shdocvw   1    Run Time Error "445": Object doesn't support
this action in Europa Knowledgebase
11742     shlwapi   9    Small .net 1.1 app (FastMD5 1.3) fails to start up
12263     opengl    3    Sketchup Cannot initialize OpenGL -
ChoosePixelFormat fails

Abandoned:
664       user32    8    The help menu functionality inside programs
is broken (messaging problem)

Here's the full list of current bugs:

2493      comctl32  2    Multi-select listview: Shift-arrow up only
selects top two items
11509     crypt32   0    Wordviewer 2003 is unable to open documents
encrypted with AES
5535      directx-  21   Planescape:Torment doesn't work
9916      directx-  7    "make test" usually fails
11584     directx-  4    Multiple games crash with stack overflow error
12246     directx-  2    "make test" gives different results with and
without warn+heap
12730     gdi32     1    gdi32: some tests fail when X is run in 16
bit mode, but not 32 bit
6519      gdi32     7    Wine blacks out rotated font bitmap
9771      gdi32     47   Steam Friends doesn't work (fails to render
correctly or refresh)
5024      kernel32  6    Thief: Deadly Shadows crashes:page fault on
read access to 0x0000040c
10147     msi       2    Word Viewer 2003 - Tab behavior differs from Windows
8783      ntdll     15   USB serial ports do not work
10288     programs  0    wine_gecko download hangs sometimes
13071     quartz    0    Flashplayer crashes in a quartz bug
5163      setupapi  15   Office XP 2002 crashes on installation
6095      shdocvw   17   MOTD in counter-strike 1.6 and counter-strike
source does not render
8439      shell32   10   Visual Studio .NET (7) install fails
12074     testcase  3    The conformance tests fail on Windows
5402      -unknown  0    Trying to run PhotoStitch 3.1
7404      -unknown  3    ShowWindow(SW_MINIMIZE) should not generate a
WM_PAINT message
11281     -unknown  5    CJK input many issues
12097     -unknown  3    Wine 1.0 should not ship out-of-sync resource
translations
13168     -unknown  0    Update the README before the 1.0 release
3023      user32    6    Orcad - "Place Part" never tries to put down a part
124       wineserv  2    Review of Wine Server Protocol
9787      winsock   67   Warcraft3 Battle.net Doesn't work (Needs AcceptEx)
12005     wintab32  2    Regression in pressure sensitivity with
wizardpen tablet driver and Photoshop 7


From lats at yless4u.com.au  Sat May 17 01:24:17 2008
From: lats at yless4u.com.au (Jeff Latimer)
Date: Sat, 17 May 2008 16:24:17 +1000
Subject: [PATCH 2/3] shell32: implement make new folder UI changes.
In-Reply-To: <558b2f5c0805152236k75195132s5ddd88ba73c5c62@mail.gmail.com>
References: <558b2f5c0805152236k75195132s5ddd88ba73c5c62@mail.gmail.com>
Message-ID: <482E7A11.20209@yless4u.com.au>

Lei Zhang wrote:
> Hi,
>
> This implements the treeview UI changes to show users the newly created folder.
>   
> ------------------------------------------------------------------------
>
>
I can't apply the patch.  Is there one missing?

Jeff Latimer


From thestig at google.com  Sat May 17 01:33:35 2008
From: thestig at google.com (Lei Zhang)
Date: Fri, 16 May 2008 23:33:35 -0700
Subject: [PATCH 2/3] shell32: implement make new folder UI changes.
In-Reply-To: <482E7A11.20209@yless4u.com.au>
References: <558b2f5c0805152236k75195132s5ddd88ba73c5c62@mail.gmail.com>
	<482E7A11.20209@yless4u.com.au>
Message-ID: <558b2f5c0805162333h2df0bc75h4c613437d726e56d@mail.gmail.com>

On Fri, May 16, 2008 at 11:24 PM, Jeff Latimer <lats at yless4u.com.au> wrote:
> Lei Zhang wrote:
>> Hi,
>>
>> This implements the treeview UI changes to show users the newly created folder.
>>
>> ------------------------------------------------------------------------
>>
>>
> I can't apply the patch.  Is there one missing?
>
> Jeff Latimer
>
>
>

Whoops, forgot the attachment on patch 1/3. Will resend in a bit.


From jacek at codeweavers.com  Sat May 17 02:46:09 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Sat, 17 May 2008 09:46:09 +0200
Subject: Right way to cope with user error in make test?
In-Reply-To: <482DAD11.6010802@winehq.org>
References: <482CF239.7000207@codeweavers.com> <g0j3nl$dp8$1@ger.gmane.org>
	<482DAD11.6010802@winehq.org>
Message-ID: <482E8D41.6070408@codeweavers.com>

Jeremy White wrote:
>
> I think in my case the problem is a bit different; I have the library -
> what I don't have are the development headers.  Thus the linking all
> works, but HAVE_LIBXSLT is not defined, so the transform function
> ends up as a stub, and goes on to fail.
>
> And I still don't know a right answer.
>
> The attached patch is one approach - skip the tests in this case.
>
> Does this seem like a reasonable approach to folks?
>

Such checks should be made in runtime and tests should depend only on 
WinAPI stuff. I'd suggest something like an attached patch.


Jacek
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: libxslt.diff
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080517/02bc9626/attachment-0001.txt 

From jeroen.janssen at gmail.com  Sat May 17 03:53:18 2008
From: jeroen.janssen at gmail.com (Jeroen Janssen)
Date: Sat, 17 May 2008 08:53:18 +0000 (UTC)
Subject: Configure question about Wine / HAL
References: <482B4597.2050805@pcbsd.com> <200805161258.20138.tijl@ulyssis.org>
	<482D6F65.8050001@pcbsd.com> <200805161429.08158.tijl@ulyssis.org>
	<482E0094.9020804@pcbsd.com>
Message-ID: <loom.20080517T084747-407@post.gmane.org>

Kris Moore <kris <at> pcbsd.com> writes:
> Here you go!
> 
> http://www.pcbsd.org/~kris/config.log

Hey Kris,

It seems something is wrong with your pthread library?

configure:12388: checking for dbus_connection_close in -ldbus-1
configure:12423: cc -o conftest -O2 -fno-strict-aliasing -pipe 
-I/usr/local/include -DDBUS_API_SUBJECT_TO_CHANGE -I/usr/local/include/hal
-I/usr/local/include/dbus-1.0 -I/usr/local/include/dbus-1.0/include  
-L/usr/local/lib conftest.c -ldbus-1 -L/usr/local/lib -lhal -ldbus-1    >&5
/usr/local/lib/libdbus-1.so: undefined reference to `pthread_equal'
/usr/local/lib/libdbus-1.so: undefined reference to `pthread_cond_timedwait'

and also:

configure:15254: checking for -ljack
configure:15289: cc -o conftest -O2 -fno-strict-aliasing -pipe 
-I/usr/local/include -L/usr/local/lib conftest.c -ljack   >&5
/usr/local/lib/libjack.so: undefined reference to `pthread_create'
/usr/local/lib/libjack.so: undefined reference to `pthread_attr_init'
/usr/local/lib/libjack.so: undefined reference to `pthread_exit'
/usr/local/lib/libjack.so: undefined reference to `pthread_cancel'
/usr/local/lib/libjack.so: undefined reference to `pthread_equal'
/usr/local/lib/libjack.so: undefined reference to `pthread_testcancel'
/usr/local/lib/libjack.so: undefined reference to `pthread_attr_setscope'
/usr/local/lib/libjack.so: undefined reference to `pthread_attr_setinheritsched'
/usr/local/lib/libjack.so: undefined reference to `pthread_setschedparam'
/usr/local/lib/libjack.so: undefined reference to `pthread_attr_setstacksize'
/usr/local/lib/libjack.so: undefined reference to `pthread_attr_setdetachstate'
/usr/local/lib/libjack.so: undefined reference to `pthread_join'

Can you check pthread is present in your /usr/local/lib?

Best regards,

Jeroen Janssen



From scott at open-vote.org  Sat May 17 04:09:01 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Sat, 17 May 2008 02:09:01 -0700
Subject: Search data seems to show that each new product seems to raise
	Wine's	profile a bit
In-Reply-To: <a71bd89a0805161817v2117064x24ecf3d5acd802aa@mail.gmail.com>
References: <a71bd89a0805161817v2117064x24ecf3d5acd802aa@mail.gmail.com>
Message-ID: <482EA0AD.5070605@open-vote.org>

Dan Kegel wrote:
> It's a small effect, and it's not really surprising,
> but if you look at a graph of the relative search volume for the phrases
>   linux wine
>   linux photoshop
>   linux warcraft
>   linux steam
> it seems that each time a new big app starts working on Linux
> enough for people to start searching for it (photoshop, warcraft, steam),
> the number of queries for linux wine goes up a little bit.
> 
> http://www.google.com/trends?q=linux+wine%2Clinux+photoshop%2C+linux+warcraft%2C+linux+steam&ctab=0&geo=all&date=all&sort=0
> 
> I'm just pleased to see that the effect is measurable, and not lost in
> the noise...
> 
This is a better graph:

http://www.google.com/trends?q=ubuntu+wine%2Cubuntu+photoshop%2Cubuntu+warcraft%2Cubuntu+steam&ctab=0&geo=all&date=all&sort=0

It's ubuntu specific, however over the past few years queries for Linux
Wine have been more or less flat and instead replaced with more specific
queries like Linux Ubuntu.  Searching for a particular distribution
eliminates the confounding effect.

Anyway, I don't quite see the trend you're talking about.  The little
blips for Ubuntu Warcraft, Ubuntu Steam, and Ubuntu Photoshop do
correspond with upticks in Ubuntu Wine, however they're all clustered
around Ubuntu releases.

It certainly seems reasonable that new big applications working would
drive interest in Wine and therefore search queries, but I'm not sure
how to separate that out from interest due to releases in general.

Thanks,
Scott Ritchie


From robertshearman at gmail.com  Sat May 17 05:36:08 2008
From: robertshearman at gmail.com (Rob Shearman)
Date: Sat, 17 May 2008 11:36:08 +0100
Subject: curious failure and messages running a well-known installer
In-Reply-To: <696888.41606.qm@web23104.mail.ird.yahoo.com>
References: <696888.41606.qm@web23104.mail.ird.yahoo.com>
Message-ID: <1096648c0805170336r5f42dd62nc9d7680b67eca3f8@mail.gmail.com>

On Fri, May 16, 2008 at 8:38 PM, Hin-Tak Leung
<htl10 at users.sourceforge.net> wrote:
>
> I install the win32 version of ghostscript quite routinely under wine; just taken the old one off and put the new one in with wine rc1, the first time it bombed out with:
>
> err:module:map_image Could not map section _winzip_, file probably truncated
> err:module:map_image Could not map section _winzip_, file probably truncated
> wine: could not load L"H:\\mirror.cs.wisc.edu\\pub\\mirrors\\ghost\\GPL\\current\\gs862w32.exe": Bad EXE format for
>
> and 2nd/3rd time it went to completion.

It appears to me that you are loading this file from a network mount
point and the first and second times you tried to load the file there
were some issues with the network that caused data of at least part of
the file not to be received by your machine and that was the reason
these messages were displayed.

> fixme:shell:IShellLinkA_fnGetPath (0x14a980): WIN32_FIND_DATA is not yet filled.
> fixme:shell:IShellLinkA_fnGetPath (0x14aae8): WIN32_FIND_DATA is not yet filled.

These are harmless in most cases.

-- 
Rob Shearman


From dimi at lattica.com  Sat May 17 05:44:29 2008
From: dimi at lattica.com (Dimi Paun)
Date: Sat, 17 May 2008 06:44:29 -0400
Subject: WIKI: Add forum link to wiki site
In-Reply-To: <482E96AD.8080902@web.de>
References: <482E96AD.8080902@web.de>
Message-ID: <1211021069.6534.31.camel@dimi.lattica.com>


On Sat, 2008-05-17 at 10:26 +0200, Rico Sch?ller wrote:
> Hi,
> 
> this patch adds the Wine Forum link to the WineHQ Menu in the wiki.

Thanks!

Now I'm just on my way out to New York, I'll get back in 3 days,
I'll look at it when I get back.

[If I don't commit it in 3-4 days, please ping me again, in case
it felt through the cracks]

-- 
Dimi Paun <dimi at lattica.com>
Lattica, Inc.



From robertshearman at gmail.com  Sat May 17 05:46:27 2008
From: robertshearman at gmail.com (Rob Shearman)
Date: Sat, 17 May 2008 11:46:27 +0100
Subject: Right way to cope with user error in make test?
In-Reply-To: <482DAD11.6010802@winehq.org>
References: <482CF239.7000207@codeweavers.com> <g0j3nl$dp8$1@ger.gmane.org>
	<482DAD11.6010802@winehq.org>
Message-ID: <1096648c0805170346l463b8d8ay69139e89f30f9114@mail.gmail.com>

On Fri, May 16, 2008 at 4:49 PM, Jeremy White <jwhite at winehq.org> wrote:
> I think in my case the problem is a bit different; I have the library -
> what I don't have are the development headers.  Thus the linking all
> works, but HAVE_LIBXSLT is not defined, so the transform function
> ends up as a stub, and goes on to fail.
>
> And I still don't know a right answer.
>
> The attached patch is one approach - skip the tests in this case.
>
> Does this seem like a reasonable approach to folks?

Alexandre has said in the past that test failures for an incorrectly
or incompletely built wine tree should result in test failures and I
agree with this.

Still, it would be nice to somehow say in an obvious way "you can
discard these results as the user didn't have the necessary packages
installed."

-- 
Rob Shearman


From tijl at ulyssis.org  Sat May 17 08:52:16 2008
From: tijl at ulyssis.org (Tijl Coosemans)
Date: Sat, 17 May 2008 15:52:16 +0200
Subject: Configure question about Wine / HAL
In-Reply-To: <loom.20080517T084747-407@post.gmane.org>
References: <482B4597.2050805@pcbsd.com> <482E0094.9020804@pcbsd.com>
	<loom.20080517T084747-407@post.gmane.org>
Message-ID: <200805171552.18269.tijl@ulyssis.org>

On Saturday 17 May 2008 10:53:18 Jeroen Janssen wrote:
> Kris Moore <kris <at> pcbsd.com> writes:
>> http://www.pcbsd.org/~kris/config.log
> 
> It seems something is wrong with your pthread library?
> 
> configure:12388: checking for dbus_connection_close in -ldbus-1
> configure:12423: cc -o conftest -O2 -fno-strict-aliasing -pipe 
> -I/usr/local/include -DDBUS_API_SUBJECT_TO_CHANGE -I/usr/local/include/hal
> -I/usr/local/include/dbus-1.0 -I/usr/local/include/dbus-1.0/include  
> -L/usr/local/lib conftest.c -ldbus-1 -L/usr/local/lib -lhal -ldbus-1    >&5
> /usr/local/lib/libdbus-1.so: undefined reference to `pthread_equal'
> /usr/local/lib/libdbus-1.so: undefined reference to `pthread_cond_timedwait'

This patch to the port Makefile should fix it. The problem exists only
on FreeBSD 6 because libs like libdbus-1 aren't linked to a pthread
library and so when you link an executable with libdbus-1 some
threading lib needs to be explicitly specified as well. Just to confirm
this, can you post the output of "ldd /usr/local/lib/libdbus-1.so" on
FreeBSD 6?
-------------- next part --------------
--- Makefile.orig	2008-05-17 15:33:49.000000000 +0200
+++ Makefile	2008-05-17 15:26:59.000000000 +0200
@@ -52,6 +52,7 @@
 .if ${OSVERSION} < 700041
 	${REINPLACE_CMD} 's/-lpthread/-lthr/g' ${WRKSRC}/configure
 .endif
+	${REINPLACE_CMD} '/ac_hal_libs=/s/"$$/ -lthr"/' ${WRKSRC}/configure
 
 pre-build:
 	cd ${WRKSRC} && make depend

From jwhite at winehq.org  Sat May 17 10:08:15 2008
From: jwhite at winehq.org (Jeremy White)
Date: Sat, 17 May 2008 10:08:15 -0500
Subject: Right way to cope with user error in make test?
In-Reply-To: <1096648c0805170346l463b8d8ay69139e89f30f9114@mail.gmail.com>
References: <482CF239.7000207@codeweavers.com>
	<g0j3nl$dp8$1@ger.gmane.org>	<482DAD11.6010802@winehq.org>
	<1096648c0805170346l463b8d8ay69139e89f30f9114@mail.gmail.com>
Message-ID: <482EF4DF.2020002@winehq.org>

> Alexandre has said in the past that test failures for an incorrectly
> or incompletely built wine tree should result in test failures and I
> agree with this.

Yah; I think to some extent we need to wait for Alexandre to express
an opinion on how, if at all, he'd like to address this.

We seem to have come up with about 4 approaches:
  1.  Skip the test.  Rob thinks Alexandre will reject this
  2.  Make WINE_NOTICE_WITH be default error; i.e. require
      an explicit --without in order to skip a package you lack
  3.  Create some sort of config record; a config.id if you will.
      This could then be read by dotests and/or winetests
      to not transmit the results.
      (As a side note, this might be handy place to put
      a git HEAD which might allow my winetest patches to go in,
      thereby eliminating the need for an out of tree dotests.  But no bias here <grin>).
  4.  Have dotests scan the existing config.log file.

Alexandre, do you have a preference?

Cheers,

Jeremy


From kris at pcbsd.com  Sat May 17 12:34:02 2008
From: kris at pcbsd.com (Kris Moore)
Date: Sat, 17 May 2008 13:34:02 -0400
Subject: Configure question about Wine / HAL
In-Reply-To: <200805171552.18269.tijl@ulyssis.org>
References: <482B4597.2050805@pcbsd.com> <482E0094.9020804@pcbsd.com>
	<loom.20080517T084747-407@post.gmane.org>
	<200805171552.18269.tijl@ulyssis.org>
Message-ID: <482F170A.2060503@pcbsd.com>



That Makefile patch fixed the issue!

However, the ldd command doesn't seem to return anything for this lib:

# ldd libdbus-1.so.3
libdbus-1.so.3:

Will you be able to add this patch to the port?


Thanks!



Tijl Coosemans wrote:
> On Saturday 17 May 2008 10:53:18 Jeroen Janssen wrote:
>> Kris Moore <kris <at> pcbsd.com> writes:
>>> http://www.pcbsd.org/~kris/config.log
>> It seems something is wrong with your pthread library?
>>
>> configure:12388: checking for dbus_connection_close in -ldbus-1
>> configure:12423: cc -o conftest -O2 -fno-strict-aliasing -pipe 
>> -I/usr/local/include -DDBUS_API_SUBJECT_TO_CHANGE -I/usr/local/include/hal
>> -I/usr/local/include/dbus-1.0 -I/usr/local/include/dbus-1.0/include  
>> -L/usr/local/lib conftest.c -ldbus-1 -L/usr/local/lib -lhal -ldbus-1    >&5
>> /usr/local/lib/libdbus-1.so: undefined reference to `pthread_equal'
>> /usr/local/lib/libdbus-1.so: undefined reference to `pthread_cond_timedwait'
> 
> This patch to the port Makefile should fix it. The problem exists only
> on FreeBSD 6 because libs like libdbus-1 aren't linked to a pthread
> library and so when you link an executable with libdbus-1 some
> threading lib needs to be explicitly specified as well. Just to confirm
> this, can you post the output of "ldd /usr/local/lib/libdbus-1.so" on
> FreeBSD 6?
> 
> 
> !DSPAM:1,482ee23020031175936439!
> 


From hintak_leung at yahoo.co.uk  Sat May 17 12:14:23 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Sat, 17 May 2008 18:14:23 +0100
Subject: curious failure and messages running a well-known installer
In-Reply-To: <1096648c0805170336r5f42dd62nc9d7680b67eca3f8@mail.gmail.com>
References: <696888.41606.qm@web23104.mail.ird.yahoo.com>
	<1096648c0805170336r5f42dd62nc9d7680b67eca3f8@mail.gmail.com>
Message-ID: <482F126F.5000604@yahoo.co.uk>

Rob Shearman wrote:
> On Fri, May 16, 2008 at 8:38 PM, Hin-Tak Leung
> <htl10 at users.sourceforge.net> wrote:
>> I install the win32 version of ghostscript quite routinely under wine; just taken the old one off and put the new one in with wine rc1, the first time it bombed out with:
>>
>> err:module:map_image Could not map section _winzip_, file probably truncated
>> err:module:map_image Could not map section _winzip_, file probably truncated
>> wine: could not load L"H:\\mirror.cs.wisc.edu\\pub\\mirrors\\ghost\\GPL\\current\\gs862w32.exe": Bad EXE format for
>>
>> and 2nd/3rd time it went to completion.
> 
> It appears to me that you are loading this file from a network mount
> point and the first and second times you tried to load the file there
> were some issues with the network that caused data of at least part of
> the file not to be received by your machine and that was the reason
> these messages were displayed.

It is a laptop and the file is on the local hard drive; there is no network
mount point at all on the machine.




From dank at kegel.com  Sat May 17 19:50:13 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 17 May 2008 17:50:13 -0700
Subject: Can someone get a Maximizer 8 trial CD for me?
Message-ID: <a71bd89a0805171750v44d2daf6yb06e1c5aef5a427@mail.gmail.com>

http://www.cabc.co.uk/maximizer8/trial_personal.htm
free cd, but only for people in the EU.

I'm interested because
http://www.mindstab.net/wordpress/archives/292
is a recent report some this being one of the two
"must have" apps for someone's dad.

Thanks,
Dan


From winehacker at gmail.com  Sat May 17 22:09:41 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sat, 17 May 2008 23:09:41 -0400
Subject: Right way to cope with user error in make test?
In-Reply-To: <482EF4DF.2020002@winehq.org>
References: <482CF239.7000207@codeweavers.com> <g0j3nl$dp8$1@ger.gmane.org>
	<482DAD11.6010802@winehq.org>
	<1096648c0805170346l463b8d8ay69139e89f30f9114@mail.gmail.com>
	<482EF4DF.2020002@winehq.org>
Message-ID: <19e31a080805172009v3628f957p3d9ea8c562ac4d39@mail.gmail.com>

On Sat, May 17, 2008 at 11:08 AM, Jeremy White <jwhite at winehq.org> wrote:
> Yah; I think to some extent we need to wait for Alexandre to express
> an opinion on how, if at all, he'd like to address this.
>
> We seem to have come up with about 4 approaches:
>  1.  Skip the test.  Rob thinks Alexandre will reject this
>  2.  Make WINE_NOTICE_WITH be default error; i.e. require
>      an explicit --without in order to skip a package you lack
>  3.  Create some sort of config record; a config.id if you will.
>      This could then be read by dotests and/or winetests
>      to not transmit the results.
>      (As a side note, this might be handy place to put
>      a git HEAD which might allow my winetest patches to go in,
>      thereby eliminating the need for an out of tree dotests.  But no bias here <grin>).
>  4.  Have dotests scan the existing config.log file.

1. really seems to me like the right method. including config.h in the
test and doing something like

START_TEST(foo_and_bar)
{
#ifdef HAVE_FOO
test_foo()
#endif
test_bar()
}

I don't see why we can't do this along with embedding the config.h
information the winetest transmission data. This will greatly help
with the number of false failures.

Thanks
-- 

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sun May 18 01:30:52 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 18 May 2008 15:30:52 +0900
Subject: Right way to cope with user error in make test?
References: <482CF239.7000207@codeweavers.com>
	<g0j3nl$dp8$1@ger.gmane.org><482DAD11.6010802@winehq.org><1096648c0805170346l463b8d8ay69139e89f30f9114@mail.gmail.com><482EF4DF.2020002@winehq.org>
	<19e31a080805172009v3628f957p3d9ea8c562ac4d39@mail.gmail.com>
Message-ID: <486AAE63F86C4A60A38EB2C680186E04@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> 1. really seems to me like the right method. including config.h in the
> test and doing something like
> 
> START_TEST(foo_and_bar)
> {
> #ifdef HAVE_FOO
> test_foo()
> #endif
> test_bar()
> }
> 
> I don't see why we can't do this along with embedding the config.h
> information the winetest transmission data. This will greatly help
> with the number of false failures.

That will make compiling tests under Windows even more cumbersome than
it is now, there is no such a thing as config.h under Windows.

-- 
Dmitry.


From kai.blin at gmail.com  Sun May 18 03:03:59 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Sun, 18 May 2008 10:03:59 +0200
Subject: What graphics cards do the d3d9 tests pass on?
In-Reply-To: <482E123B.40608@comcast.net>
References: <482E123B.40608@comcast.net>
Message-ID: <200805181004.04368.kai.blin@gmail.com>

On Saturday 17 May 2008 01:01:15 Andrew Eleneski wrote:
> For my box I am running Kubuntu Hardy with Ati driver version 8.4. I see
> I crashed on the d3d9:stateblock, and have quite a few failures in the
> d3d9:visual area.

See http://wiki.winehq.org/MakeTestFailures

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080518/59188ed4/attachment.pgp 

From winehacker at gmail.com  Sun May 18 12:30:18 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 18 May 2008 13:30:18 -0400
Subject: Right way to cope with user error in make test?
In-Reply-To: <486AAE63F86C4A60A38EB2C680186E04@DMITRY>
References: <482CF239.7000207@codeweavers.com> <g0j3nl$dp8$1@ger.gmane.org>
	<482DAD11.6010802@winehq.org>
	<1096648c0805170346l463b8d8ay69139e89f30f9114@mail.gmail.com>
	<482EF4DF.2020002@winehq.org>
	<19e31a080805172009v3628f957p3d9ea8c562ac4d39@mail.gmail.com>
	<486AAE63F86C4A60A38EB2C680186E04@DMITRY>
Message-ID: <19e31a080805181030n3c2eec76sec97638276771eed@mail.gmail.com>

On Sun, May 18, 2008 at 2:30 AM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> That will make compiling tests under Windows even more cumbersome than
> it is now, there is no such a thing as config.h under Windows.

What are you talking about? If you use mingw or msvc to build the
tests in tree there is a config.h


-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From kai.blin at gmail.com  Sun May 18 13:52:02 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Sun, 18 May 2008 20:52:02 +0200
Subject: Right way to cope with user error in make test?
In-Reply-To: <19e31a080805181030n3c2eec76sec97638276771eed@mail.gmail.com>
References: <482CF239.7000207@codeweavers.com>
	<486AAE63F86C4A60A38EB2C680186E04@DMITRY>
	<19e31a080805181030n3c2eec76sec97638276771eed@mail.gmail.com>
Message-ID: <200805182052.06598.kai.blin@gmail.com>

On Sunday 18 May 2008 19:30:18 Steven Edwards wrote:
> On Sun, May 18, 2008 at 2:30 AM, Dmitry Timoshkov
>
> <dmitry at codeweavers.com> wrote:
> > That will make compiling tests under Windows even more cumbersome than
> > it is now, there is no such a thing as config.h under Windows.
>
> What are you talking about? If you use mingw or msvc to build the
> tests in tree there is a config.h

He's probably talking about a standalone build. That's what I use, at least. 
As I do out of tree builds for wine, there's no config.h around.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080518/2c9292f3/attachment.pgp 

From stefan at codeweavers.com  Sun May 18 13:52:31 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 18 May 2008 20:52:31 +0200
Subject: WineD3D: workaround for lack of depth/stencil
In-Reply-To: <20080518161135.221670@gmx.net>
References: <20080518161135.221670@gmx.net>
Message-ID: <200805182052.31374.stefan@codeweavers.com>

Am Sonntag, 18. Mai 2008 18:11:35 schrieb Roderick Colenbrander:
> Hi,
>
> This patch is a workaround for a severe WineD3D issue which is too much
> work and to risky to fix properly during the code freeze. It fixes drawing
> issues in GTR2, Suppreme Commander, Call of Duty 2 Call of Duty 4 and
> likely dozens of other games.
Wouldn't it be better to write the FIXME only if the app requests a depth 
stencil format != D24S8?




From bugtrack at roumenpetrov.info  Sun May 18 16:15:19 2008
From: bugtrack at roumenpetrov.info (Roumen Petrov)
Date: Mon, 19 May 2008 00:15:19 +0300
Subject: is run-time path translation standard
Message-ID: <48309C67.2060605@roumenpetrov.info>

Dear Wine developers,

Starting from version 2.x the libtool would like the create an
environment where user to be able to run win32 programs.
The former version 1.5x has this capability, but with some limitation in
case of cross-compilation environment.
The current libtool HEAD revision contain code that create binary
executable (C-wrapper). This wrapper executable setup environment and
run the real executable. The development in case of cygwin/msys native
environment is finished and now on the road is cross-compilation.
Lest see recent libtool 2x discussion started here:
http://lists.gnu.org/archive/html/libtool-patches/2008-05/msg00044.html


The question if about translation at run time of items in PATH 
environment variable. My test show that we can add absolute paths from 
build system to the PATH and at run time those paths are translated to 
the paths in emulated environment. Is this translation documented, i.e. 
standard or it is just a "side-effect"?
If translation is non-standard, could Wine team confirm that will keep it ?

Note that Charles may is not subscribed to the list and please CC to him.

Roumen

P.S. Also, please consider a minor issue with winepath: 
http://bugs.winehq.org/show_bug.cgi?id=13265



From winehacker at gmail.com  Sun May 18 19:29:26 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 18 May 2008 20:29:26 -0400
Subject: Right way to cope with user error in make test?
In-Reply-To: <200805182052.06598.kai.blin@gmail.com>
References: <482CF239.7000207@codeweavers.com>
	<486AAE63F86C4A60A38EB2C680186E04@DMITRY>
	<19e31a080805181030n3c2eec76sec97638276771eed@mail.gmail.com>
	<200805182052.06598.kai.blin@gmail.com>
Message-ID: <19e31a080805181729y45fb5678ue89875a50451e23@mail.gmail.com>

On Sun, May 18, 2008 at 2:52 PM, Kai Blin <kai.blin at gmail.com> wrote:
>> <dmitry at codeweavers.com> wrote:
>> > That will make compiling tests under Windows even more cumbersome than
>> > it is now, there is no such a thing as config.h under Windows.
>>
>> What are you talking about? If you use mingw or msvc to build the
>> tests in tree there is a config.h
>
> He's probably talking about a standalone build. That's what I use, at least.
> As I do out of tree builds for wine, there's no config.h around.

Well it would not be too hard to add to the #ifdef STANDALONE block in
include/wine/test.h

#define HAVE_FOO

Whenever a HAVE_FOO check is added to a winetest as the standalone
builds are always going to HAVE_FOO on windows.

I just think its rather dumb to build tests on Wine that we know are
going to fail. If we remove those failures and make it possible for
everyone that compiles Wine to pass the suite for their build, then it
will be alot easier to develop a culture where everyone runs make
test. As it stands right now, because hardly anyone can pass make
test, no one can effectively use it to track regressions in their own
git tree. Now this is mainly the fault of the tests themselves. But
lets say I am developing an application for Winelib that never will
need D3D/GL and friends so I don't have the gl development libs, those
tests are going to bomb for me, it makes more sense to just have the
framework never run those tests on that target. If we are going to
ship and allow the framework to be built in a broken state then we
might as well just change configure and or the wine test sources to do
an #error prama if a required library is missing and stop treating
external libraries as soft dependencies.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sun May 18 21:02:06 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 19 May 2008 11:02:06 +0900
Subject: Right way to cope with user error in make test?
References: <482CF239.7000207@codeweavers.com><486AAE63F86C4A60A38EB2C680186E04@DMITRY><19e31a080805181030n3c2eec76sec97638276771eed@mail.gmail.com><200805182052.06598.kai.blin@gmail.com>
	<19e31a080805181729y45fb5678ue89875a50451e23@mail.gmail.com>
Message-ID: <A8251FBE06884FA49888A892CC2EBB1B@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> On Sun, May 18, 2008 at 2:52 PM, Kai Blin <kai.blin at gmail.com> wrote:
>>> <dmitry at codeweavers.com> wrote:
>>> > That will make compiling tests under Windows even more cumbersome than
>>> > it is now, there is no such a thing as config.h under Windows.
>>>
>>> What are you talking about? If you use mingw or msvc to build the
>>> tests in tree there is a config.h
>>
>> He's probably talking about a standalone build. That's what I use, at least.
>> As I do out of tree builds for wine, there's no config.h around.
> 
> Well it would not be too hard to add to the #ifdef STANDALONE block in
> include/wine/test.h
> 
> #define HAVE_FOO
> 
> Whenever a HAVE_FOO check is added to a winetest as the standalone
> builds are always going to HAVE_FOO on windows.

How much tests do you usually build, and how often? I do it routinely
almost every day on a separate Windows machine by copying single .c
files and compiling them as standalone tests. I don't see any rationale
behind your suggestion.

> I just think its rather dumb to build tests on Wine that we know are
> going to fail. If we remove those failures and make it possible for
> everyone that compiles Wine to pass the suite for their build, then it
> will be alot easier to develop a culture where everyone runs make
> test.

Not everyone supposed to run the Wine tests, only those do who *really*
can comprehend the results and able to do something with them.

> As it stands right now, because hardly anyone can pass make
> test, no one can effectively use it to track regressions in their own
> git tree. Now this is mainly the fault of the tests themselves.

Again, the tests do not target *anyone*, target audience of Wine tests
is Wine developers who is able to cope with the results. Anyone else
should play somewhere else.

> But
> lets say I am developing an application for Winelib that never will
> need D3D/GL and friends so I don't have the gl development libs, those
> tests are going to bomb for me, it makes more sense to just have the
> framework never run those tests on that target.

If you are deveoping a winelib application I don't think you want to run
the tests at all. I don't really matter whether the tests pass for you.

> If we are going to
> ship and allow the framework to be built in a broken state then we
> might as well just change configure and or the wine test sources to do
> an #error prama if a required library is missing and stop treating
> external libraries as soft dependencies.

It doesn't matter how hard we try to stop broken builds, there is not
way to stop creating them by an incompetent person. Same true for say
kernel builds, and any other project.

-- 
Dmitry.


From juan.lang at gmail.com  Sun May 18 21:37:00 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Sun, 18 May 2008 19:37:00 -0700
Subject: Bug in dlls/user32/edit.c
Message-ID: <3a768c550805181937n13ef3de3v793fde0555d306a7@mail.gmail.com>

Hi Bob,

could you open a bug at bugs.winehq.org, and put everything you wrote
in your email in the description?  You might have more luck getting
followup that way.

Thanks,
--Juan


From winehacker at gmail.com  Sun May 18 21:59:51 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 18 May 2008 22:59:51 -0400
Subject: Right way to cope with user error in make test?
In-Reply-To: <A8251FBE06884FA49888A892CC2EBB1B@DMITRY>
References: <482CF239.7000207@codeweavers.com>
	<486AAE63F86C4A60A38EB2C680186E04@DMITRY>
	<19e31a080805181030n3c2eec76sec97638276771eed@mail.gmail.com>
	<200805182052.06598.kai.blin@gmail.com>
	<19e31a080805181729y45fb5678ue89875a50451e23@mail.gmail.com>
	<A8251FBE06884FA49888A892CC2EBB1B@DMITRY>
Message-ID: <19e31a080805181959q12f9671ag2a7dfc08bc5f2d42@mail.gmail.com>

On Sun, May 18, 2008 at 10:02 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> How much tests do you usually build, and how often? I do it routinely
> almost every day on a separate Windows machine by copying single .c
> files and compiling them as standalone tests. I don't see any rationale
> behind your suggestion.

Every time I do a build I try make test. Thats often enough and every
time it fails and has for years. This should have been unacceptable 5
years ago and should unacceptable now. I don't care what causes the
failure, if its a broken third party application like metacity or a
soft dependency missing. This complacency has kept the framework from
passing 100% for anyone on anything other than Alexandre's box. At the
very least we should have targeted a certain version of Windows years
ago and said "It is unacceptable for the framework to ever fail here"
but I digress. To return to your question, as I am rejoining the
ReactOS project on June 1st I plan on doing a lot more work with
winetest as per Alexandre's statement years ago that ReactOS
contributions to the test suite would be allowed.

Let me try to make it more clear. If the person compiling Wine does
not have a certain library say libxml2, Wine will still build a stub
msxml3.dll and build tests but those tests are going to fail when that
person does make test. If msxml3 is broken by the lack of libxml2 then
the tests need to reflect this by skipping.

> Not everyone supposed to run the Wine tests, only those do who *really*
> can comprehend the results and able to do something with them.

NO. Everyone that builds Wine from source should run make test. It
should pass 100% for everyone everywhere. If does not then there is
something wrong. It does the world not 1 damn bit of good if passes on
your system and no one elses.

> Again, the tests do not target *anyone*, target audience of Wine tests
> is Wine developers who is able to cope with the results. Anyone else
> should play somewhere else.

Again, if they are building wine from source and smart enough to run
make, then they are smart enough to run make test or winetest and if
something fails, they or we need to know about it and know why. We
should not accept anything less than a 100% pass rate everywhere.

> If you are deveoping a winelib application I don't think you want to run
> the tests at all. I don't really matter whether the tests pass for you.

This is asinine. Everyone that has ever developed a Winelib
application has at some point or another needed to fix some area of
Wine. If they are working on Wine code then they are going to need to
run the framework.

> It doesn't matter how hard we try to stop broken builds, there is not
> way to stop creating them by an incompetent person. Same true for say
> kernel builds, and any other project.

If the build is broken by the result of a certain library then it
should be a hard dependency and the Wine build should fail. Not the
bloody testing framework.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sun May 18 22:36:13 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 19 May 2008 12:36:13 +0900
Subject: Right way to cope with user error in make test?
References: <482CF239.7000207@codeweavers.com><486AAE63F86C4A60A38EB2C680186E04@DMITRY><19e31a080805181030n3c2eec76sec97638276771eed@mail.gmail.com><200805182052.06598.kai.blin@gmail.com><19e31a080805181729y45fb5678ue89875a50451e23@mail.gmail.com><A8251FBE06884FA49888A892CC2EBB1B@DMITRY>
	<19e31a080805181959q12f9671ag2a7dfc08bc5f2d42@mail.gmail.com>
Message-ID: <E6C0EC2130B44C7FBA16F5D9627D1B2E@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> On Sun, May 18, 2008 at 10:02 PM, Dmitry Timoshkov
> <dmitry at codeweavers.com> wrote:
>> How much tests do you usually build, and how often? I do it routinely
>> almost every day on a separate Windows machine by copying single .c
>> files and compiling them as standalone tests. I don't see any rationale
>> behind your suggestion.
> 
> Every time I do a build I try make test.

For what purpose?

> Thats often enough and every
> time it fails and has for years. This should have been unacceptable 5
> years ago and should unacceptable now.

Go ahead and send the patches to fix that. If you can't or don't want to fix
it (for any reason) please stop bitching around, that's at least not productive.
For instance have a look how Dan is doing that.

> Let me try to make it more clear. If the person compiling Wine does
> not have a certain library say libxml2, Wine will still build a stub
> msxml3.dll and build tests but those tests are going to fail when that
> person does make test.

Again, why that person does need/want to run 'make test'? Does that person
run a test suit bundled with each package he/she is building from source?
If yes, for what purpose? Is he/she planning to fix the failures?

> If msxml3 is broken by the lack of libxml2 then
> the tests need to reflect this by skipping.

The person running the test should open his/her eyes and read all the FIXME
messages telling her/him that her/his build is broken. If he/she can't cope
with that, they should leave that job to somebody else, and use prebuilt
Wine binaries.

>> Not everyone supposed to run the Wine tests, only those do who *really*
>> can comprehend the results and able to do something with them.
> 
> NO. Everyone that builds Wine from source should run make test.

Why? Does it magically make something useful? Again, what about other packages
built from source?

> It
> should pass 100% for everyone everywhere. If does not then there is
> something wrong. It does the world not 1 damn bit of good if passes on
> your system and no one elses.

If the test doesn't pass for you, go ahead and fix it. I can't do that for you
if the test passes for me.

>> Again, the tests do not target *anyone*, target audience of Wine tests
>> is Wine developers who is able to cope with the results. Anyone else
>> should play somewhere else.
> 
> Again, if they are building wine from source and smart enough to run
> make, then they are smart enough to run make test or winetest and if
> something fails, they or we need to know about it and know why. We
> should not accept anything less than a 100% pass rate everywhere.

If we == Alexandre, that's a nice assumption. If we == Steven, I think you
should start from trying to do that for your system. This is a developer's
list, right?

>> If you are deveoping a winelib application I don't think you want to run
>> the tests at all. I don't really matter whether the tests pass for you.
> 
> This is asinine. Everyone that has ever developed a Winelib
> application has at some point or another needed to fix some area of
> Wine. If they are working on Wine code then they are going to need to
> run the framework.

That's a too generous assumption. In any case first thing to do is file
a bug report.

>> It doesn't matter how hard we try to stop broken builds, there is not
>> way to stop creating them by an incompetent person. Same true for say
>> kernel builds, and any other project.
> 
> If the build is broken by the result of a certain library then it
> should be a hard dependency and the Wine build should fail. Not the
> bloody testing framework.

If some test fails that doen't mean that the build is broken.

-- 
Dmitry.


From r.kalbermatter at hccnet.nl  Mon May 19 00:37:03 2008
From: r.kalbermatter at hccnet.nl (Rolf Kalbermatter)
Date: Mon, 19 May 2008 07:37:03 +0200
Subject: Right way to cope with user error in make test?
Message-ID: <2D5E5D48F840463796936E4C650435C2@NATERS>

Please both calm down a bit.

<dmitry at codeweavers.com> wrote:
>"Steven Edwards" <winehacker at gmail.com> wrote:
>><dmitry at codeweavers.com> wrote:
>>> Not everyone supposed to run the Wine tests, only those do who 
>>> *really* can comprehend the results and able to do something with them.
>> 
>> NO. Everyone that builds Wine from source should run make test.
>
>Why? Does it magically make something useful? Again, what about other
>packages built from source?

To limit running of the test frame work only to those that know exactly what
they are doing is a to strict limitation IMHO.

You should not forget that acceptance of a patch is based on the criteria
that it runs make test. Which in may case has been always a limited make
test in the directory itself only, since a whole make test seldom or never
even got so far as to run for the component I was working at.

While sending patches is of course the right thing to do, it has been and
still is rather discouraging to get wine sources, building them on ones own
box and finally run a make test and find that there are many areas where it
simply reports failures or crashes altogether especially in areas I do not
have the knowledge to do anything about and not the time to dig into much
deeper.

The fact that I couldn't get the whole make test to run out of the box on
my system without bad crashes and/or numerous test failures has not only
made me not run it anymore except in tree for the component I attempted
to create a fix for, but has actually discouraged me in the past from
working on more bug fixes or improvements other than what I have found
strictly necessary to make a specific app working.

>> It should pass 100% for everyone everywhere. If does not then there is 
>> something wrong. It does the world not 1 damn bit of good if passes on 
>> your system and no one elses.
>
>If the test doesn't pass for you, go ahead and fix it. I can't do that
>for you if the test passes for me.

But isn't that the crux of why this discussion started? Someone finding
that a soft dependency of Wine on a library should not create a failure
but a skip when that dependency was not satisifed and this was detectable
in a sane way. And getting shot down that this system should be considerd
broken.

If the missing soft dependency should be considered a broken system then
the dependency should be not soft and vice versa.

I personally don't mind a test failure in a library that depends on
something I know I don't use and consequently don't have installed but
if it's possible to skip the tests for that why not do it?

The test framework should not only help avoiding regressions for the
VERY active developers but allow anyone working on Wine in one way or
the other to have some confidence that he got it to build right. It's
what I usually do when installing any source package to see if I missed
something. Getting a long list of errors and sometimes crashes out
of the box really leaves a bad taste and also makes it much harder to
verify that my own modifications to it later on didn't break it in some
ways.

Rolf Kalbermatter



From winehacker at gmail.com  Mon May 19 00:45:10 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 19 May 2008 01:45:10 -0400
Subject: Right way to cope with user error in make test?
In-Reply-To: <E6C0EC2130B44C7FBA16F5D9627D1B2E@DMITRY>
References: <482CF239.7000207@codeweavers.com>
	<486AAE63F86C4A60A38EB2C680186E04@DMITRY>
	<19e31a080805181030n3c2eec76sec97638276771eed@mail.gmail.com>
	<200805182052.06598.kai.blin@gmail.com>
	<19e31a080805181729y45fb5678ue89875a50451e23@mail.gmail.com>
	<A8251FBE06884FA49888A892CC2EBB1B@DMITRY>
	<19e31a080805181959q12f9671ag2a7dfc08bc5f2d42@mail.gmail.com>
	<E6C0EC2130B44C7FBA16F5D9627D1B2E@DMITRY>
Message-ID: <19e31a080805182245s5ce81bcdobc314d659f7a99d4@mail.gmail.com>

Hey Dmitry,

I'd like to reply point by point but Rolf's message sums up the way I
feel about the framework. I've avoided using it more than I could have
and am going to be doing a lot more work with it in the future so I
have in interest in seeing it pass 100% on more than just Julliards
box. I did want to reply to one question you asked but I'll leave the
rest rather than just adding more noise to my original point on fixing
the tests for soft dependancies.

On Sun, May 18, 2008 at 11:36 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> Why? Does it magically make something useful? Again, what about other
> packages
> built from source?

Other packages built from source are not trying to run third party
closed source applications on a platform for which they were not even
designed. Its not like there is a whole suite of open source win32
applications out there that use Winelib and are constantly being
maintained where breakages are spotted quickly. If someone builds QT
or GTK and then builds an application using that, odds are they are
going to have much less trouble spotting the breakage because they
have the source for both the library and application. In essence the
existing poll of Free Software out there that is being constantly
built and repackaged (sometimes daily, see gentoo for example), acts
as a testing framework for those libraries. Your comparing apples to
oranges. We simply don't have the luxury of a large ecosystem catching
a regression the way most Linux libraries do. Accepting brokeness in
the test suite in any form is simply flawed IMHO.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Mon May 19 00:47:48 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 19 May 2008 14:47:48 +0900
Subject: Right way to cope with user error in make test?
References: <2D5E5D48F840463796936E4C650435C2@NATERS>
Message-ID: <6632E96AEBEA4FC0A6F91E9207B46335@DMITRY>

"Rolf Kalbermatter" <r.kalbermatter at hccnet.nl> wrote:

> The test framework should not only help avoiding regressions for the
> VERY active developers but allow anyone working on Wine in one way or
> the other to have some confidence that he got it to build right. It's
> what I usually do when installing any source package to see if I missed
> something. Getting a long list of errors and sometimes crashes out
> of the box really leaves a bad taste and also makes it much harder to
> verify that my own modifications to it later on didn't break it in some
> ways.

That's the whole reason behind http://wiki.winehq.org/MakeTestFailures

Carefully investigating each test failure one by one as Dan does is
the right approach IMO, flaming on wine-devel is not.

-- 
Dmitry.


From winehacker at gmail.com  Mon May 19 00:58:09 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 19 May 2008 01:58:09 -0400
Subject: Right way to cope with user error in make test?
In-Reply-To: <6632E96AEBEA4FC0A6F91E9207B46335@DMITRY>
References: <2D5E5D48F840463796936E4C650435C2@NATERS>
	<6632E96AEBEA4FC0A6F91E9207B46335@DMITRY>
Message-ID: <19e31a080805182258y3afc7889g42cb9a25fcdc4ec5@mail.gmail.com>

On Mon, May 19, 2008 at 1:47 AM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> Carefully investigating each test failure one by one as Dan does is
> the right approach IMO, flaming on wine-devel is not.

Sorry if I went a little too flamish in my reply earlier. I did not
mean to imply your point of view was stupid or used the word asinine
it was not addressed at you directly but the general concept that we
have allowed it to be broken for so long.

I offered a proposed solution to a whole class of failures and you
shot it down saying it was the wrong solution for standalone builds. I
addressed that, your answer is now "If some test fails that doen't
mean that the build is broken".  But I don't understand the logic. The
metric should be, if make test fails, the build cannot be assumed
safe. Maybe its not really broken but without a 100% pass rate there
is no way to assume anything other than brokenness. Even standalone is
not a safe test given the current framework as it has 10% failure rate
on Windows Server 2003. Maybe it passes for you on XP, maybe its
broken for me on Vista. Nothing is safe to assume while allow whole
classes of failures. If they really are failures and certain missing
librares makes a build "broken" then it should not be a soft
dependency.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Mon May 19 01:36:03 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 19 May 2008 15:36:03 +0900
Subject: Right way to cope with user error in make test?
References: <2D5E5D48F840463796936E4C650435C2@NATERS><6632E96AEBEA4FC0A6F91E9207B46335@DMITRY>
	<19e31a080805182258y3afc7889g42cb9a25fcdc4ec5@mail.gmail.com>
Message-ID: <9A9E28F01B1348CF826ABE05AAA3753F@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> I offered a proposed solution to a whole class of failures and you
> shot it down saying it was the wrong solution for standalone builds. I
> addressed that, your answer is now "If some test fails that doen't
> mean that the build is broken".  But I don't understand the logic. The
> metric should be, if make test fails, the build cannot be assumed
> safe.

The logic is that it's perfectly valid to build Wine without OpenGL or
XML libraries if the user is not intending to run applications depending
on them. If you need them, configure helpfully prints a warning. If you
ignore the warning, that's your problem.

> Maybe its not really broken but without a 100% pass rate there
> is no way to assume anything other than brokenness. Even standalone is
> not a safe test given the current framework as it has 10% failure rate
> on Windows Server 2003. Maybe it passes for you on XP, maybe its
> broken for me on Vista. Nothing is safe to assume while allow whole
> classes of failures. If they really are failures and certain missing
> librares makes a build "broken" then it should not be a soft
> dependency.

If you would closely followed wine-patches mailing list, you would notice
that *a lot* of efforts lately has been spent on making various Wine tests
pass cleanly on different Windows flavours. That very tedious and time
consuming work is being done without any fuss, flaming or self advertisement.

-- 
Dmitry.


From dmitry at codeweavers.com  Mon May 19 02:41:16 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 19 May 2008 16:41:16 +0900
Subject: kernel32: Add a few traces to help debug test failures [RESEND]
References: <22821af30805190021j2283c99cs861c6164c9ea11f2@mail.gmail.com>
Message-ID: <1CB59A92A4164ADFAB2FE26D7660CFB1@DMITRY>

"James Hawkins" <jhawkins at codeweavers.com> wrote:

>          if(detailed_info->lpRootManifestPath)
>              ok(!lstrcmpiW(detailed_info->lpRootManifestPath, exinfo->root_manifest_path),
> -               "unexpected detailed_info->lpRootManifestPath\n");
> +               "unexpected detailed_info->lpRootManifestPath: %s %s\n",
> +               strw(detailed_info->lpRootManifestPath), strw(exinfo->root_manifest_path));

As far as I can see strw() uses static buffer and is not able to handle
more than one string at once.

-- 
Dmitry.


From dmitry at codeweavers.com  Mon May 19 05:58:15 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 19 May 2008 19:58:15 +0900
Subject: [PATCH] Fix 16 bit StringFromGUID2 to not use wide characters
References: <1211182081.24124.1.camel@hermes2.karcher.local>
Message-ID: <B658D200F0D64597966D99ED577A1D7F@DMITRY>

"Michael Karcher" <wine at mkarcher.dialup.fu-berlin.de> wrote:

> +INT WINAPI StringFromGUID2_16(REFGUID id, LPSTR str, INT cmax)
> +{
> +  char xguid[80];
> +  int           len;
> +
> +  if (WINE_StringFromCLSID( id, xguid ))
> +  return 0;
> +  
> +  len = strlen( xguid ) + 1; /* The terminating zero counts */
> +  if (len > cmax)
> +        return 0;
> +        
> +  strcpy( str, xguid );
> +  return len;
> +}

This is not an equivalent of the old implementation, is it really
supposed to fail if the buffer length is shorter than the guid?

-- 
Dmitry.


From dmitry at codeweavers.com  Mon May 19 06:41:06 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 19 May 2008 20:41:06 +0900
Subject: [PATCH] Fix 16 bit StringFromGUID2 to not use wide characters
References: <1211182081.24124.1.camel@hermes2.karcher.local>
	<B658D200F0D64597966D99ED577A1D7F@DMITRY>
	<1211195554.25419.7.camel@hermes2.karcher.local>
Message-ID: <9B32EB39AAFB47D8B1D9962DC7C3019E@DMITRY>

"Michael Karcher" <wine at mkarcher.dialup.fu-berlin.de> wrote:

>> This is not an equivalent of the old implementation, is it really
>> supposed to fail if the buffer length is shorter than the guid?
> 
> http://msdn.microsoft.com/en-us/library/ms683893(VS.85).aspx
> says so. I will test Microsoft's native implementation when I get around
> to.

That's the description of 32-bit implementation, 16-bit one may differ.

> PS: is it possible to test 16 bit API function in the wine test suite? I
> suppose not, as it should be compilable in a 32 bit Windows environment,
> so we don't even have LoadLibrary16.

Of course Wine has LoadLibrary16, and a working 16-bit implementation.
Although there is no built-in support for 16-bit tests, there is a way
to build them:
http://www.winehq.org/pipermail/wine-devel/2008-February/062566.html

-- 
Dmitry.


From julliard at winehq.org  Mon May 19 06:55:14 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 19 May 2008 13:55:14 +0200
Subject: Right way to cope with user error in make test?
In-Reply-To: <19e31a080805181959q12f9671ag2a7dfc08bc5f2d42@mail.gmail.com>
	(Steven Edwards's message of "Sun, 18 May 2008 22:59:51 -0400")
References: <482CF239.7000207@codeweavers.com>
	<486AAE63F86C4A60A38EB2C680186E04@DMITRY>
	<19e31a080805181030n3c2eec76sec97638276771eed@mail.gmail.com>
	<200805182052.06598.kai.blin@gmail.com>
	<19e31a080805181729y45fb5678ue89875a50451e23@mail.gmail.com>
	<A8251FBE06884FA49888A892CC2EBB1B@DMITRY>
	<19e31a080805181959q12f9671ag2a7dfc08bc5f2d42@mail.gmail.com>
Message-ID: <8763tav78d.fsf@wine.dyndns.org>

"Steven Edwards" <winehacker at gmail.com> writes:

> On Sun, May 18, 2008 at 10:02 PM, Dmitry Timoshkov
> <dmitry at codeweavers.com> wrote:
>> Not everyone supposed to run the Wine tests, only those do who *really*
>> can comprehend the results and able to do something with them.
>
> NO. Everyone that builds Wine from source should run make test. It
> should pass 100% for everyone everywhere. If does not then there is
> something wrong.

Yes, and there is something wrong in this case, a library is missing, so
the test fails. That's the correct behavior, the test has done its job
of detecting that a part of Wine is not working properly.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Mon May 19 06:51:49 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 19 May 2008 13:51:49 +0200
Subject: Right way to cope with user error in make test?
In-Reply-To: <482EF4DF.2020002@winehq.org> (Jeremy White's message of "Sat, 17
	May 2008 10:08:15 -0500")
References: <482CF239.7000207@codeweavers.com> <g0j3nl$dp8$1@ger.gmane.org>
	<482DAD11.6010802@winehq.org>
	<1096648c0805170346l463b8d8ay69139e89f30f9114@mail.gmail.com>
	<482EF4DF.2020002@winehq.org>
Message-ID: <87abimv7e2.fsf@wine.dyndns.org>

Jeremy White <jwhite at winehq.org> writes:

>> Alexandre has said in the past that test failures for an incorrectly
>> or incompletely built wine tree should result in test failures and I
>> agree with this.
>
> Yah; I think to some extent we need to wait for Alexandre to express
> an opinion on how, if at all, he'd like to address this.
>
> We seem to have come up with about 4 approaches:
>   1.  Skip the test.  Rob thinks Alexandre will reject this
>   2.  Make WINE_NOTICE_WITH be default error; i.e. require
>       an explicit --without in order to skip a package you lack
>   3.  Create some sort of config record; a config.id if you will.
>       This could then be read by dotests and/or winetests
>       to not transmit the results.
>       (As a side note, this might be handy place to put
>       a git HEAD which might allow my winetest patches to go in,
>       thereby eliminating the need for an out of tree dotests.  But no bias here <grin>).
>   4.  Have dotests scan the existing config.log file.
>
> Alexandre, do you have a preference?

I don't like any of those. What I would expect is if a library is needed
for a given dll to work, that dll would fail to load when the library is
missing, and winetest should handle that the same way it does for
missing Win9x dlls. If it's only a small part of the dll that is broken,
then it's perfectly fine for the test to fail.

-- 
Alexandre Julliard
julliard at winehq.org


From wine at mkarcher.dialup.fu-berlin.de  Mon May 19 06:12:34 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Mon, 19 May 2008 13:12:34 +0200
Subject: [PATCH] Fix 16 bit StringFromGUID2 to not use wide characters
In-Reply-To: <B658D200F0D64597966D99ED577A1D7F@DMITRY>
References: <1211182081.24124.1.camel@hermes2.karcher.local>
	<B658D200F0D64597966D99ED577A1D7F@DMITRY>
Message-ID: <1211195554.25419.7.camel@hermes2.karcher.local>

Am Montag, den 19.05.2008, 19:58 +0900 schrieb Dmitry Timoshkov:
> > +INT WINAPI StringFromGUID2_16(REFGUID id, LPSTR str, INT cmax)
> > +{
> > +  char xguid[80];
> > +  int           len;
> > +
> > +  if (WINE_StringFromCLSID( id, xguid ))
> > +  return 0;
> > +  
> > +  len = strlen( xguid ) + 1; /* The terminating zero counts */
> > +  if (len > cmax)
> > +        return 0;
> > +        
> > +  strcpy( str, xguid );
> > +  return len;
> > +}
> 
> This is not an equivalent of the old implementation, is it really
> supposed to fail if the buffer length is shorter than the guid?

http://msdn.microsoft.com/en-us/library/ms683893(VS.85).aspx
says so. I will test Microsoft's native implementation when I get around
to.

Regards,
  Michael Karcher

PS: is it possible to test 16 bit API function in the wine test suite? I
suppose not, as it should be compilable in a 32 bit Windows environment,
so we don't even have LoadLibrary16.



From wine at mkarcher.dialup.fu-berlin.de  Mon May 19 07:06:25 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Mon, 19 May 2008 14:06:25 +0200
Subject: [PATCH] Fix 16 bit StringFromGUID2 to not use wide characters
In-Reply-To: <9B32EB39AAFB47D8B1D9962DC7C3019E@DMITRY>
References: <1211182081.24124.1.camel@hermes2.karcher.local>
	<B658D200F0D64597966D99ED577A1D7F@DMITRY>
	<1211195554.25419.7.camel@hermes2.karcher.local>
	<9B32EB39AAFB47D8B1D9962DC7C3019E@DMITRY>
Message-ID: <1211198785.25419.13.camel@hermes2.karcher.local>

Am Montag, den 19.05.2008, 20:41 +0900 schrieb Dmitry Timoshkov:
> "Michael Karcher" <wine at mkarcher.dialup.fu-berlin.de> wrote:
> > http://msdn.microsoft.com/en-us/library/ms683893(VS.85).aspx
> > says so. I will test Microsoft's native implementation when I get around
> > to.
> That's the description of 32-bit implementation, 16-bit one may differ.
Of course. That's why I am going to test.

> > PS: is it possible to test 16 bit API function in the wine test suite? I
> > suppose not, as it should be compilable in a 32 bit Windows environment,
> > so we don't even have LoadLibrary16.
> Of course Wine has LoadLibrary16, and a working 16-bit implementation.
I know. I already used it for a toy implementation of regsvr (16 bit
version). But the wine testsuite has the policy to be compilable with
MSVC too, so no wine specific code allowed, if I understand it
correctly. And *they* don't have LoadLibrary16 available in their
include files.

> Although there is no built-in support for 16-bit tests, there is a way
> to build them:
> http://www.winehq.org/pipermail/wine-devel/2008-February/062566.html
Thanks for the pointer. So openwatcom is the way to go to write real 16
bit tests. I wondered what open source compiler would compile 16 bit
code and started thinking of some embedded x86 compiler.

Regards,
  Michael Karcher



From mikolaj at zalewski.pl  Mon May 19 07:36:35 2008
From: mikolaj at zalewski.pl (=?UTF-8?B?TWlrb8WCYWogWmFsZXdza2k=?=)
Date: Mon, 19 May 2008 14:36:35 +0200
Subject: Can someone get a Maximizer 8 trial CD for me?
In-Reply-To: <a71bd89a0805171750v44d2daf6yb06e1c5aef5a427@mail.gmail.com>
References: <a71bd89a0805171750v44d2daf6yb06e1c5aef5a427@mail.gmail.com>
Message-ID: <48317453.2000605@zalewski.pl>

  I have filled the form but got error 404 after clicking "Request Trial 
CD".

Miko?aj Zalewski


From dank at kegel.com  Mon May 19 07:48:12 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 19 May 2008 05:48:12 -0700
Subject: Most common winetest failures on wine
Message-ID: <a71bd89a0805190548t29e28a30of70150b089466fda@mail.gmail.com>

Thanks to everybody who responded to Jeremy's call
to run winetest using the 'dotests' script at
   http://wiki.winehq.org/MakeTestFailures

We now have 35 reports, and have some good data on
which test failures are common.  See the
Most Common Failures section at the bottom.
Here's what it says right now:

The skipgood script above now also tallies tests by how many people
they fail for. Currently, it shows:

35 shell32:shelllink
32 user32:msg
16 user32:input
14 ntdll:info
13 d3d9:visual
10 user32:win
8 ddraw:visual
7 urlmon:protocol
5 gdi32:font
4 winmm:wave
3 d3d9:query urlmon:url wininet:url
2 comctl32:tooltips ddraw:dsurface msxml3:domdoc quartz:referenceclock
wininet:http
1 d3d8:visual d3d9:device dinput:device dsound:ds3d dsound:ds3d8
dsound:dsound ...

Let's ignore the tests that only fail for one person for the moment,
and look at the others.

shell32:shelllink fails on all winetest reports from all machines,
including on real Windows. Yet "make test" in shell32 succeeds on this
test. Could somebody have a look at why it reliably fails under
winetest? I filed this as bug 13311.

user32:msg and user32:input are probably people running non-blessed
window managers; Alexandre's position is that we can ignore these,
since upstream gnome's WM is fixed.

ntdll:info is a flaky test marked todo_wine that succeeds sometimes:
"info.c:822: Test succeeded inside todo block: Expected to read 0
bytes, got 0"

d3d9:visual failures are all from people not running an approved
graphics card, and can be ignored (though maybe we should tell users
we only support nvidia Geforce 6 and higher for 3d graphics...)

user32:win appears to be nearly all people running unapproved window
managers, though abraml-hardy-32 did get one failure "win.c:2555: Test
failed: wrong active window (nil)" with KDE3 which should be
investigated. [fixme: file bug?]

ddraw:visual has two kinds of errors. The most common is
"visual.c:2045: Test failed: Got color 00dcdde6, expected 0000ff00".
Less common is mstefani's failure, "visual.c:481: Test failed:
Untransformed vertex with linear vertex fog has color 00ff0000".
[fixme: file bugs?]

urlmon:protocol has three or so failure modes; most common is
"protocol.c:1597: Test failed: Read failed: 8000000a (0 bytes)".
[fixme: file bug?]

gdi32:font has several failure modes, not sure what's going on there.
[fixme: file bug?]

winemm:wave might actually be a problem, perhaps Maarten can take a
look. [fixme: file bug?]

I haven't looked at the failures that happen for only 2 or 3 people.


From jwhite at winehq.org  Mon May 19 08:49:29 2008
From: jwhite at winehq.org (Jeremy White)
Date: Mon, 19 May 2008 08:49:29 -0500
Subject: Most common winetest failures on wine
In-Reply-To: <a71bd89a0805190548t29e28a30of70150b089466fda@mail.gmail.com>
References: <a71bd89a0805190548t29e28a30of70150b089466fda@mail.gmail.com>
Message-ID: <48318569.5070208@winehq.org>

> ntdll:info is a flaky test marked todo_wine that succeeds sometimes:
> "info.c:822: Test succeeded inside todo block: Expected to read 0
> bytes, got 0"

Hardy seems to be the common variable for failures, and it seems as though
an actual failure reading from location 0x1234 is the trigger.
(The historically normal case, apparently, is that we succeed in
doing the read).

git-blame points at Peter as the last to touch this.
I've attached a potential patch, hopefully it'll be wrong and force
Peter to step up and fix it correctly <grin>.

Cheers,

Jeremy
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: info.diff
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080519/e7dda143/attachment.txt 

From dank at kegel.com  Mon May 19 11:45:51 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 19 May 2008 09:45:51 -0700
Subject: New winetricks-20080519: add synonym mfc42,
	show package descriptions in zenity
Message-ID: <a71bd89a0805190945y2b81870cv9b5b78e24730f4f0@mail.gmail.com>

Another week, another winetricks.

Changes since last week's annoucement:

- gnome users now see nice package descriptions
- mfc42 is now listed as a synonym for vcrun6

Online as always at
  http://kegel.com/wine/winetricks
or
  http://winezeug.googlecode.com


From paul.vriens.wine at gmail.com  Mon May 19 12:43:38 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 19 May 2008 19:43:38 +0200
Subject: Most common winetest failures on wine
In-Reply-To: <a71bd89a0805190548t29e28a30of70150b089466fda@mail.gmail.com>
References: <a71bd89a0805190548t29e28a30of70150b089466fda@mail.gmail.com>
Message-ID: <4831BC4A.6080703@gmail.com>

Dan Kegel wrote:
> Thanks to everybody who responded to Jeremy's call
> to run winetest using the 'dotests' script at
>    http://wiki.winehq.org/MakeTestFailures
> 
> We now have 35 reports, and have some good data on
> which test failures are common.  See the
> Most Common Failures section at the bottom.
> Here's what it says right now:
> 
> The skipgood script above now also tallies tests by how many people
> they fail for. Currently, it shows:
> 
> 35 shell32:shelllink
> 32 user32:msg
> 16 user32:input
> 14 ntdll:info
> 13 d3d9:visual
> 10 user32:win
> 8 ddraw:visual
> 7 urlmon:protocol
> 5 gdi32:font
> 4 winmm:wave
> 3 d3d9:query urlmon:url wininet:url
> 2 comctl32:tooltips ddraw:dsurface msxml3:domdoc quartz:referenceclock
> wininet:http
> 1 d3d8:visual d3d9:device dinput:device dsound:ds3d dsound:ds3d8
> dsound:dsound ...
> 
> Let's ignore the tests that only fail for one person for the moment,
> and look at the others.
> 
> shell32:shelllink fails on all winetest reports from all machines,
> including on real Windows. Yet "make test" in shell32 succeeds on this
> test. Could somebody have a look at why it reliably fails under
> winetest? I filed this as bug 13311.
> 

I had a look at this one.

The problem as far as I can see lies with the fact that when we run 'make 
shelllink.ok' we eventually end up in UNIXFS_build_shitemid (shfldr_unixfs.c) 
where the trace shows:

trace:shell:UNIXFS_build_shitemid 
(pszUnixPath="/wine/wine-git/dlls/shell32/tests/shell32_test.exe", pIDL=0x12793a)

This shell32_test.exe doesn't exist (it's shell32_test.exe.so).

So when you do (in the test directory):

ln -s shell32_test.exe.so shell32_test.exe
rm shelllink.ok
make shelllink.ok

You will see the exact same errors as with winetest.

Winetest unpacks all it's executables in a temp directory and in this case (for 
me on the last run) it's showing in the trace:

trace:shell:UNIXFS_build_shitemid 
(pszUnixPath="/tmp/wctSkl1EH/shell32_test.exe", pIDL=0x127712)

And that file really exists.

So I guess this issue is with this piece of code in shfldr_unixfs.c:

  509     /* We are only interested in regular files and directories. */
  510     if (stat(pszUnixPath, &fileStat)) return NULL;

Now we only need a solution :-)

-- 
Cheers,

Paul.


From kumbayo84 at arcor.de  Mon May 19 15:04:48 2008
From: kumbayo84 at arcor.de (Peter Oberndorfer)
Date: Mon, 19 May 2008 22:04:48 +0200
Subject: Most common winetest failures on wine
In-Reply-To: <48318569.5070208@winehq.org>
References: <a71bd89a0805190548t29e28a30of70150b089466fda@mail.gmail.com>
	<48318569.5070208@winehq.org>
Message-ID: <200805192204.48637.kumbayo84@arcor.de>

On Montag 19 Mai 2008, Jeremy White wrote:
> > ntdll:info is a flaky test marked todo_wine that succeeds sometimes:
> > "info.c:822: Test succeeded inside todo block: Expected to read 0
> > bytes, got 0"
> 
> Hardy seems to be the common variable for failures, and it seems as though
> an actual failure reading from location 0x1234 is the trigger.
> (The historically normal case, apparently, is that we succeed in
> doing the read).
> 
Yes wine normally allows you to read the memory even when it should fail
(because it is reserved by the preloader? + ntdll:reserve_dos_area +
kernel32:setup_dos_mem)
-> ptrace PTRACE_PEEKDATA succeeds

But on ubuntu wine probably fails to reserve the low memory because of 
http://wiki.winehq.org/PreloaderPageZeroProblem
-> ptrace PTRACE_PEEKDATA fails to read the memory
and the read count is 0.

> git-blame points at Peter as the last to touch this.
> I've attached a potential patch, hopefully it'll be wrong and force
> Peter to step up and fix it correctly <grin>.
The "fix" disables the readcount test for all targets running wine.
Another workaround would be to choose another userspace address which is not 
protected by the kernel (bigger than 65536) but still falling into the dos 
reserve area 0x110000.
I do not have ubuntu/mmap protection here, could you/somebody try with a 
address like 0x80000.

Additionally the standard 0xdeadbeef address won't work here as it results in 
a different error(STATUS_ACCESS_VIOLATION for kernel space addresses instead 
of STATUS_PARTIAL_COPY ?)
> 
> Cheers,
> 
> Jeremy
> 
Greetings Peter



From dank at kegel.com  Mon May 19 16:39:47 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 19 May 2008 14:39:47 -0700
Subject: Spec OpenGL benchmarks
In-Reply-To: <20080510074617.14260@gmx.net>
References: <a71bd89a0805091931k6e91d0f5nfee3cf7042a8dbea@mail.gmail.com>
	<20080510074617.14260@gmx.net>
Message-ID: <a71bd89a0805191439y3e7249b9l4c1b5c6885a2d420@mail.gmail.com>

On Sat, May 10, 2008 at 12:46 AM, Roderick Colenbrander
<thunderbird2k at gmx.net> wrote:
>> On a whim, I tried the oldest SPEC OpenGL benchmark, SPECviewperf 6.
>>
>> SPECViewperf 6.1.2 lives here:
>> http://www.spec.org/gwpg/pastissues/Feb2_02/opc.static/opcview.htm
>> It's also downloadable from
>> ftp://spec.it.miami.edu/dist/gpc/opc/viewperf/specviewperf612is01.exe
>
> First of all these tests should be performed on solid display drivers.
> Second I expect the performance on a Geforce / Radeon card to reasonable to good. For the best performance you likely need a Quadro or FireGL ...

Check and check.  My card is a Quadro FX 1400, and
/proc/driver/nvidia/version says
NVRM version: NVIDIA UNIX x86 Kernel Module  169.12  Thu Feb 14
17:53:07 PST 2008
I believe this is the current released driver.
And my workstation is fast enough; it's a 3.4 GHz Pentium 4
(running at 2800 MHz, according to /proc/cpuinfo)
with 2MB L2 cache.

Not all the tests are so horrible.
My workstation scores 64.5 on AWadvs-04, which according to
http://www.spec.org/gwpg/pastissues/Feb2_02/opc.data/summary.html
matches the performance of a
Dell Precision Workstation 340 2.0AGHz / nVIDIA Quadro2 EX
from 2002.
And on MCAD01, it scores 176, which is almost twice the hightest result in 2002
(though again I'm not sure we display everything properly).

Anyway, as I said earlier, I'm just jazzed this stuff runs at all.
- Dan


From ian at ianmacfarlane.com  Mon May 19 10:11:40 2008
From: ian at ianmacfarlane.com (Ian Macfarlane)
Date: Mon, 19 May 2008 16:11:40 +0100
Subject: Wine forums page links
Message-ID: <aac02a530805190811q40a2e0fcif79bd595b988ec47@mail.gmail.com>

The page http://www.winehq.org/site/forums needs to link to the new
forums at http://forum.winehq.org/ (it does, but just in the site-wide
sidebar not the page body).

Regards,

Ian


From bsmith at sudleyplace.com  Mon May 19 21:29:26 2008
From: bsmith at sudleyplace.com (Bob Smith)
Date: Mon, 19 May 2008 22:29:26 -0400
Subject: Bug in dlls/user32/edit.c
In-Reply-To: <3a768c550805181937n13ef3de3v793fde0555d306a7@mail.gmail.com>
References: <3a768c550805181937n13ef3de3v793fde0555d306a7@mail.gmail.com>
Message-ID: <48323786.3070604@sudleyplace.com>

Thanks -- I'll do that.

Juan Lang wrote:
> Hi Bob,
> 
> could you open a bug at bugs.winehq.org, and put everything you wrote
> in your email in the description?  You might have more luck getting
> followup that way.

-- 
_______________________________________________________________
Bob Smith - bsmith at sudleyplace.com - http://www.sudleyplace.com



From wine at mkarcher.dialup.fu-berlin.de  Tue May 20 02:19:40 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Tue, 20 May 2008 09:19:40 +0200
Subject: [PATCH] Fix 16 bit StringFromGUID2 to not use wide characters
In-Reply-To: <B658D200F0D64597966D99ED577A1D7F@DMITRY>
References: <1211182081.24124.1.camel@hermes2.karcher.local>
	<B658D200F0D64597966D99ED577A1D7F@DMITRY>
Message-ID: <1211267980.9165.5.camel@hermes2.karcher.local>

Am Montag, den 19.05.2008, 19:58 +0900 schrieb Dmitry Timoshkov:
> "Michael Karcher" <wine at mkarcher.dialup.fu-berlin.de> wrote:
> 
> > +INT WINAPI StringFromGUID2_16(REFGUID id, LPSTR str, INT cmax)
> > +{
> > +  char xguid[80];
> > +  int           len;
> > +
> > +  if (WINE_StringFromCLSID( id, xguid ))
> > +  return 0;
> > +  
> > +  len = strlen( xguid ) + 1; /* The terminating zero counts */
> > +  if (len > cmax)
> > +        return 0;
> > +        
> > +  strcpy( str, xguid );
> > +  return len;
> > +}
> 
> This is not an equivalent of the old implementation, is it really
> supposed to fail if the buffer length is shorter than the guid?

It is, in fact, an equivalent implementation of the old one.
MultiByteToWideChar is also failing (return value of zero) if the buffer
length is to short, exactly as the new implementation does. I am adding
that case to the 32 bit testsuite (but I also tested it on 16 bits)

Regards,
  Michael Karcher



From julliard at winehq.org  Tue May 20 08:17:58 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 20 May 2008 15:17:58 +0200
Subject: kernel32: Comment out the Esperanto locale definitions,
	they are incomplete, and cause the problems
In-Reply-To: <E1JyLUD-0005Oj-ND@mail.codeweavers.com> (Dmitry Timoshkov's
	message of "Tue, 20 May 2008 15:38:18 +0900")
References: <E1JyLUD-0005Oj-ND@mail.codeweavers.com>
Message-ID: <87od71t8qh.fsf@wine.dyndns.org>

Dmitry Timoshkov <dmitry at codeweavers.com> writes:

> this patch fixes the problem reported in the bug 12884.
>
> Changelog:
>     kernel32: Comment out the Esperanto locale definitions, they are
>     incomplete, and cause the problems.

This will only make Esperanto support even more incomplete and broken,
plus it breaks the tests. It should be possible to fix the definitions
by copying values from the Unix locale file.

-- 
Alexandre Julliard
julliard at winehq.org


From paul.vriens.wine at gmail.com  Tue May 20 08:31:48 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 20 May 2008 15:31:48 +0200
Subject: unknown device issues after running winetest
Message-ID: <4832D2C4.5060606@gmail.com>

Hi,

On several windows boxes (VMware) I receive this nice message that Windows will 
try to find a driver for an unknown device.

This device is added by the setupapi/devinst test and is not (or can't be?) 
properly removed after the tests.

On NT/W2K I'm able to delete all the relevant registry keys (regedt32.exe) but 
on Vista I don't seem to be able to delete them

Any idea? Do others have the same issue(s) ?

-- 
Cheers,

Paul.


From paul.vriens.wine at gmail.com  Tue May 20 08:48:06 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 20 May 2008 15:48:06 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <4832D2C4.5060606@gmail.com>
References: <4832D2C4.5060606@gmail.com>
Message-ID: <4832D696.2000203@gmail.com>

Paul Vriens wrote:
> Hi,
> 
> On several windows boxes (VMware) I receive this nice message that 
> Windows will try to find a driver for an unknown device.
> 
> This device is added by the setupapi/devinst test and is not (or can't 
> be?) properly removed after the tests.
> 
> On NT/W2K I'm able to delete all the relevant registry keys 
> (regedt32.exe) but on Vista I don't seem to be able to delete them
> 
> Any idea? Do others have the same issue(s) ?
> 
OK, I managed to remove the registry keys from Vista as well. Took only 75 
mouseclicks :-(

The issue about the leftover registry keys after the tests still stands though.

-- 
Cheers,

Paul.


From Michel_Jacques at softimage.com  Tue May 20 12:01:39 2008
From: Michel_Jacques at softimage.com (Michel Jacques)
Date: Tue, 20 May 2008 13:01:39 -0400
Subject: Bad stub ? GetEffectiveRightsFromAclA / GetEffectiveRightsFromAclW
In-Reply-To: <mailman.5.1211216400.8372.wine-devel@winehq.org>
References: <mailman.5.1211216400.8372.wine-devel@winehq.org>
Message-ID: <0BCB4AE868D8934A8B3DCE3A58126A8902151C36@tewk-mbpf3>


A quick question about stubs,

I think above mentioned functions are badly stubbed in
./dlls/advapi32/security.c
Current implementation outputs a message like "FIXME ... stub ..." but
functions are not stubbed in the ./dlls/advapi32/advapi32.spec file.

Is this wrong?

If not, how can I know for sure if a function is stubbed(unimplemented)?

Thanks,

Michel




From juan.lang at gmail.com  Tue May 20 15:22:53 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 20 May 2008 13:22:53 -0700
Subject: Bad stub ? GetEffectiveRightsFromAclA / GetEffectiveRightsFromAclW
In-Reply-To: <0BCB4AE868D8934A8B3DCE3A58126A8902151C36@tewk-mbpf3>
References: <mailman.5.1211216400.8372.wine-devel@winehq.org>
	<0BCB4AE868D8934A8B3DCE3A58126A8902151C36@tewk-mbpf3>
Message-ID: <3a768c550805201322m79721705m9f94be6bf8a23da9@mail.gmail.com>

> I think above mentioned functions are badly stubbed in
> ./dlls/advapi32/security.c
> Current implementation outputs a message like "FIXME ... stub ..." but
> functions are not stubbed in the ./dlls/advapi32/advapi32.spec file.

That's expected.  A "hard stub" has just a stub entry in the spec
file, and no implementation.  A "soft stub" has an implementation, and
a real entry in the spec file, but the implementation effectively does
nothing.

> If not, how can I know for sure if a function is stubbed(unimplemented)?

Test it under Windows and compare Wine's behavior.
--Juan


From m.b.lankhorst at gmail.com  Tue May 20 20:08:12 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 20 May 2008 18:08:12 -0700
Subject: unknown device issues after running winetest
In-Reply-To: <4832D696.2000203@gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>
Message-ID: <b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>

Hello Paul,

2008/5/20 Paul Vriens <paul.vriens.wine at gmail.com>:
> Paul Vriens wrote:
>> Hi,
>>
>> On several windows boxes (VMware) I receive this nice message that
>> Windows will try to find a driver for an unknown device.
>>
>> This device is added by the setupapi/devinst test and is not (or can't
>> be?) properly removed after the tests.
>>
>> On NT/W2K I'm able to delete all the relevant registry keys
>> (regedt32.exe) but on Vista I don't seem to be able to delete them
>>
>> Any idea? Do others have the same issue(s) ?
>>
> OK, I managed to remove the registry keys from Vista as well. Took only 75
> mouseclicks :-(
>
> The issue about the leftover registry keys after the tests still stands though.
I just keep hitting escape when booting, but it is a real problem that
should be addressed, anyone knows the exact testing causing the
creation of the dummy devices? Why 75 mouse clicks, uac in the way?

Cheers,
Maarten.


From juan.lang at gmail.com  Tue May 20 20:17:05 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 20 May 2008 18:17:05 -0700
Subject: unknown device issues after running winetest
In-Reply-To: <b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
Message-ID: <3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>

> anyone knows the exact testing causing the creation of the dummy devices?

I believe it's testRegisterDeviceInfo.  See my comment in it:
* FIXME: the key also becomes undeletable.  How to get rid of it?

--Juan


From truiken at gmail.com  Tue May 20 20:18:15 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 20 May 2008 20:18:15 -0500
Subject: unknown device issues after running winetest
In-Reply-To: <b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
Message-ID: <22821af30805201818u60f9da6cw2ed002dd4c675a07@mail.gmail.com>

On Tue, May 20, 2008 at 8:08 PM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Hello Paul,
>
> 2008/5/20 Paul Vriens <paul.vriens.wine at gmail.com>:
>> Paul Vriens wrote:
>>> Hi,
>>>
>>> On several windows boxes (VMware) I receive this nice message that
>>> Windows will try to find a driver for an unknown device.
>>>
>>> This device is added by the setupapi/devinst test and is not (or can't
>>> be?) properly removed after the tests.
>>>
>>> On NT/W2K I'm able to delete all the relevant registry keys
>>> (regedt32.exe) but on Vista I don't seem to be able to delete them
>>>
>>> Any idea? Do others have the same issue(s) ?
>>>
>> OK, I managed to remove the registry keys from Vista as well. Took only 75
>> mouseclicks :-(
>>
>> The issue about the leftover registry keys after the tests still stands though.
> I just keep hitting escape when booting, but it is a real problem that
> should be addressed, anyone knows the exact testing causing the
> creation of the dummy devices? Why 75 mouse clicks, uac in the way?
>

It should be mentioned that the setupapi:devinst tests fail miserably
on every platform.  I'm working through the failing win2k3 tests, but
it would be nice if someone could take a look at these, maybe even
those that contributed to or wrote the tests.

Thanks,
James Hawkins


From truiken at gmail.com  Tue May 20 20:31:07 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 20 May 2008 20:31:07 -0500
Subject: unknown device issues after running winetest
In-Reply-To: <3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
	<3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>
Message-ID: <22821af30805201831y6a337d59q59cfb972c4def8df@mail.gmail.com>

On Tue, May 20, 2008 at 8:17 PM, Juan Lang <juan.lang at gmail.com> wrote:
>> anyone knows the exact testing causing the creation of the dummy devices?
>
> I believe it's testRegisterDeviceInfo.  See my comment in it:
> * FIXME: the key also becomes undeletable.  How to get rid of it?
>

Another note: the tests can only be run successfully once (assuming no
other failures), but if the tests are run again without a reboot, we
get ~30 failures.  I'm assuming that has to do with the undeletability
(nice fake word) of the device keys.

-- 
James Hawkins


From paul.vriens.wine at gmail.com  Wed May 21 01:06:18 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 21 May 2008 08:06:18 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
Message-ID: <4833BBDA.9060504@gmail.com>

Maarten Lankhorst wrote:
>> The issue about the leftover registry keys after the tests still stands though.
> I just keep hitting escape when booting, but it is a real problem that
> should be addressed, anyone knows the exact testing causing the
> creation of the dummy devices? Why 75 mouse clicks, uac in the way?
>  
Yes, it 's UAC. You first have to make yourself owner of the regkey and then add 
  the proper permissions. In this particular case it turns out there are several 
hidden (not enough permissions to view) keys and you have do to the same thing 
again to those and the ones underneath and ......

-- 
Cheers,

Paul.


From paul.vriens.wine at gmail.com  Wed May 21 01:08:57 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 21 May 2008 08:08:57 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>	
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
	<3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>
Message-ID: <4833BC79.6040903@gmail.com>

Juan Lang wrote:
>> anyone knows the exact testing causing the creation of the dummy devices?
> 
> I believe it's testRegisterDeviceInfo.  See my comment in it:
> * FIXME: the key also becomes undeletable.  How to get rid of it?
> 
> --Juan
> 
Deleting is not an issue if you use the native GUI's. You first have to set the 
correct permissions though. In later version of regedit.exe you can do this from 
this gui, in older cases you have to use regedt32.exe

Not sure (yet) if we can do this in/from our code.

-- 
Cheers,

Paul.


From paul.vriens.wine at gmail.com  Wed May 21 01:11:25 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 21 May 2008 08:11:25 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <22821af30805201818u60f9da6cw2ed002dd4c675a07@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>	
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
	<22821af30805201818u60f9da6cw2ed002dd4c675a07@mail.gmail.com>
Message-ID: <4833BD0D.8080703@gmail.com>

James Hawkins wrote:
> It should be mentioned that the setupapi:devinst tests fail miserably
> on every platform.  I'm working through the failing win2k3 tests, but
> it would be nice if someone could take a look at these, maybe even
> those that contributed to or wrote the tests.
> 
> Thanks,
> James Hawkins
> 
I've been looking (every now and then) at these tests. One of the issues is that 
several of these tests act totally different on the different Windows version.

Now that I know I'm not the only once suffering from these 'unknown devices' I 
will have a closer look (if time permits).

And I second the call for the contributor(s) of the test to have a look as well.

-- 
Cheers,

Paul.


From dank at kegel.com  Wed May 21 00:18:19 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 20 May 2008 22:18:19 -0700
Subject: Adding d3d9x_xx dlls to winetricks?
Message-ID: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>

So... lots of people are going around installing
all of directx, and maybe all they needed was, say,
d3d9x_35.  That's not good.  This sounds like
a job for winetricks!
But I know nothing about direct3d.  Could somebody
have a look at this draft and see if it suffices?  All
I added was d3d9x_35 and d3d9x_36, is that
the right set?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: winetricks
Type: application/octet-stream
Size: 54112 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080520/29efbb30/attachment-0001.obj 

From hverbeet at gmail.com  Wed May 21 02:41:18 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Wed, 21 May 2008 09:41:18 +0200
Subject: Adding d3d9x_xx dlls to winetricks?
In-Reply-To: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
Message-ID: <d658b69e0805210041j1234c4b7y246f32435dafe29a@mail.gmail.com>

2008/5/21 Dan Kegel <dank at kegel.com>:
> So... lots of people are going around installing
> all of directx, and maybe all they needed was, say,
> d3d9x_35.  That's not good.  This sounds like
> a job for winetricks!
> But I know nothing about direct3d.  Could somebody
> have a look at this draft and see if it suffices?  All
> I added was d3d9x_35 and d3d9x_36, is that
> the right set?
>

They're the right dlls (although the packages should probably be
called d3d9x_35 and d3d9x_36 rather than d3d9_35 and d3d9_36), but the
trouble with these dlls is that there are quite a few different
versions, a new version is released every couple of months, and
applications just use whatever is current when they're
released/developed.


From twickline at gmail.com  Wed May 21 03:27:09 2008
From: twickline at gmail.com (Tom Wickline)
Date: Wed, 21 May 2008 04:27:09 -0400
Subject: Adding d3d9x_xx dlls to winetricks?
In-Reply-To: <d658b69e0805210041j1234c4b7y246f32435dafe29a@mail.gmail.com>
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
	<d658b69e0805210041j1234c4b7y246f32435dafe29a@mail.gmail.com>
Message-ID: <53e3a9930805210127r70391638l7434b624ed52f42f@mail.gmail.com>

You could update winetricks at each DX redistributable release
the last one was in March. Me myself I would add all the d3d9x_*
dlls rather then just two of them, there are older games and benchmark
software that needs the older ones as well.

-Tom

On Wed, May 21, 2008 at 3:41 AM, H. Verbeet <hverbeet at gmail.com> wrote:
> 2008/5/21 Dan Kegel <dank at kegel.com>:
>> So... lots of people are going around installing
>> all of directx, and maybe all they needed was, say,
>> d3d9x_35.  That's not good.  This sounds like
>> a job for winetricks!
>> But I know nothing about direct3d.  Could somebody
>> have a look at this draft and see if it suffices?  All
>> I added was d3d9x_35 and d3d9x_36, is that
>> the right set?
>>
>
> They're the right dlls (although the packages should probably be
> called d3d9x_35 and d3d9x_36 rather than d3d9_35 and d3d9_36), but the
> trouble with these dlls is that there are quite a few different
> versions, a new version is released every couple of months, and
> applications just use whatever is current when they're
> released/developed.
>
>
>


From stefandoesinger at gmx.at  Wed May 21 03:40:09 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 21 May 2008 10:40:09 +0200
Subject: Adding d3d9x_xx dlls to winetricks?
In-Reply-To: <53e3a9930805210127r70391638l7434b624ed52f42f@mail.gmail.com>
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
	<d658b69e0805210041j1234c4b7y246f32435dafe29a@mail.gmail.com>
	<53e3a9930805210127r70391638l7434b624ed52f42f@mail.gmail.com>
Message-ID: <200805211040.09714.stefandoesinger@gmx.at>

I think the proper thing to do is to install the DirectX runtime / 
redistributable. It installs all the DLLs and registers them in the registry 
etc.

http://www.microsoft.com/downloads/details.aspx?FamilyID=740AC79A-5B72-447D-84F9-EE6407ED1A91&displaylang=en

The newest redist is downloadable without issues, archived older ones need a 
WGA check. For installing the package, a mscoree="" override is needed, and 
wininet=builtin, as our wininet defaults to native, which doesn't work for 
this installer for some reason. You may also want to set ddraw, d3d8, d3d9, 
dsound, dinput etc. to native temporarily during the installation to have 
themselves register properly and create various registry entries apps may 
check. Don't forget to set them back to builtin afterwards...

Technically the application is required to install this, but many apps don't 
do this, or the installation fails.

Am Mittwoch, 21. Mai 2008 10:27:09 schrieb Tom Wickline:
> You could update winetricks at each DX redistributable release
> the last one was in March. Me myself I would add all the d3d9x_*
> dlls rather then just two of them, there are older games and benchmark
> software that needs the older ones as well.
>
> -Tom
>
> On Wed, May 21, 2008 at 3:41 AM, H. Verbeet <hverbeet at gmail.com> wrote:
> > 2008/5/21 Dan Kegel <dank at kegel.com>:
> >> So... lots of people are going around installing
> >> all of directx, and maybe all they needed was, say,
> >> d3d9x_35.  That's not good.  This sounds like
> >> a job for winetricks!
> >> But I know nothing about direct3d.  Could somebody
> >> have a look at this draft and see if it suffices?  All
> >> I added was d3d9x_35 and d3d9x_36, is that
> >> the right set?
> >
> > They're the right dlls (although the packages should probably be
> > called d3d9x_35 and d3d9x_36 rather than d3d9_35 and d3d9_36), but the
> > trouble with these dlls is that there are quite a few different
> > versions, a new version is released every couple of months, and
> > applications just use whatever is current when they're
> > released/developed.


From hverbeet at gmail.com  Wed May 21 03:45:50 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Wed, 21 May 2008 10:45:50 +0200
Subject: Adding d3d9x_xx dlls to winetricks?
In-Reply-To: <200805211040.09714.stefandoesinger@gmx.at>
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
	<d658b69e0805210041j1234c4b7y246f32435dafe29a@mail.gmail.com>
	<53e3a9930805210127r70391638l7434b624ed52f42f@mail.gmail.com>
	<200805211040.09714.stefandoesinger@gmx.at>
Message-ID: <d658b69e0805210145u515519aan6851d993b48b7d97@mail.gmail.com>

2008/5/21 Stefan D?singer <stefandoesinger at gmx.at>:
> I think the proper thing to do is to install the DirectX runtime /
> redistributable. It installs all the DLLs and registers them in the registry
> etc.
>
Isn't that what we're trying to avoid?


From paul.vriens.wine at gmail.com  Wed May 21 03:46:48 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 21 May 2008 10:46:48 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>	
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
	<3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>
Message-ID: <4833E178.9030407@gmail.com>

Juan Lang wrote:
>> anyone knows the exact testing causing the creation of the dummy devices?
> 
> I believe it's testRegisterDeviceInfo.  See my comment in it:
> * FIXME: the key also becomes undeletable.  How to get rid of it?
> 
> --Juan
> 
Hi Juan,

Are the tests in devinst.c supposed so be run in order? IOW are they supposed to 
bee cleaned up after each subtest or do they rely on each other?

-- 
Cheers,

Paul.


From twickline at gmail.com  Wed May 21 03:49:54 2008
From: twickline at gmail.com (Tom Wickline)
Date: Wed, 21 May 2008 04:49:54 -0400
Subject: Adding d3d9x_xx dlls to winetricks?
In-Reply-To: <200805211040.09714.stefandoesinger@gmx.at>
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
	<d658b69e0805210041j1234c4b7y246f32435dafe29a@mail.gmail.com>
	<53e3a9930805210127r70391638l7434b624ed52f42f@mail.gmail.com>
	<200805211040.09714.stefandoesinger@gmx.at>
Message-ID: <53e3a9930805210149l7cbb37dfv8839418d5c46477f@mail.gmail.com>

Me myself I install DX for these same reasons, but some people on IRC have
had objections to me telling people to do it........

http://wine-review.blogspot.com/2008/03/directx-90c-march-2008-redistributable.html

And they tell people it will fry their config if they install DX.
When in fact if you do it right it only helps!

You will want to set Wine to win2k or dxdiag.exe wont be installed also.

Tom

On Wed, May 21, 2008 at 4:40 AM, Stefan D?singer <stefandoesinger at gmx.at> wrote:
> I think the proper thing to do is to install the DirectX runtime /
> redistributable. It installs all the DLLs and registers them in the registry
> etc.
>
> http://www.microsoft.com/downloads/details.aspx?FamilyID=740AC79A-5B72-447D-84F9-EE6407ED1A91&displaylang=en
>
> The newest redist is downloadable without issues, archived older ones need a
> WGA check. For installing the package, a mscoree="" override is needed, and
> wininet=builtin, as our wininet defaults to native, which doesn't work for
> this installer for some reason. You may also want to set ddraw, d3d8, d3d9,
> dsound, dinput etc. to native temporarily during the installation to have
> themselves register properly and create various registry entries apps may
> check. Don't forget to set them back to builtin afterwards...
>
> Technically the application is required to install this, but many apps don't
> do this, or the installation fails.
>
> Am Mittwoch, 21. Mai 2008 10:27:09 schrieb Tom Wickline:
>> You could update winetricks at each DX redistributable release
>> the last one was in March. Me myself I would add all the d3d9x_*
>> dlls rather then just two of them, there are older games and benchmark
>> software that needs the older ones as well.
>>
>> -Tom
>>
>> On Wed, May 21, 2008 at 3:41 AM, H. Verbeet <hverbeet at gmail.com> wrote:
>> > 2008/5/21 Dan Kegel <dank at kegel.com>:
>> >> So... lots of people are going around installing
>> >> all of directx, and maybe all they needed was, say,
>> >> d3d9x_35.  That's not good.  This sounds like
>> >> a job for winetricks!
>> >> But I know nothing about direct3d.  Could somebody
>> >> have a look at this draft and see if it suffices?  All
>> >> I added was d3d9x_35 and d3d9x_36, is that
>> >> the right set?
>> >
>> > They're the right dlls (although the packages should probably be
>> > called d3d9x_35 and d3d9x_36 rather than d3d9_35 and d3d9_36), but the
>> > trouble with these dlls is that there are quite a few different
>> > versions, a new version is released every couple of months, and
>> > applications just use whatever is current when they're
>> > released/developed.
>


From twickline at gmail.com  Wed May 21 03:52:34 2008
From: twickline at gmail.com (Tom Wickline)
Date: Wed, 21 May 2008 04:52:34 -0400
Subject: Adding d3d9x_xx dlls to winetricks?
In-Reply-To: <d658b69e0805210145u515519aan6851d993b48b7d97@mail.gmail.com>
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
	<d658b69e0805210041j1234c4b7y246f32435dafe29a@mail.gmail.com>
	<53e3a9930805210127r70391638l7434b624ed52f42f@mail.gmail.com>
	<200805211040.09714.stefandoesinger@gmx.at>
	<d658b69e0805210145u515519aan6851d993b48b7d97@mail.gmail.com>
Message-ID: <53e3a9930805210152v2ace7b5cge0f3ce36894d440d@mail.gmail.com>

On Wed, May 21, 2008 at 4:45 AM, H. Verbeet <hverbeet at gmail.com> wrote:
> 2008/5/21 Stefan D?singer <stefandoesinger at gmx.at>:
>> I think the proper thing to do is to install the DirectX runtime /
>> redistributable. It installs all the DLLs and registers them in the registry
>> etc.
>>
> Isn't that what we're trying to avoid?
>


From wine at mkarcher.dialup.fu-berlin.de  Wed May 21 04:00:18 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Wed, 21 May 2008 11:00:18 +0200
Subject: crypt32: String resource IDs
Message-ID: <1211360419.9165.42.camel@hermes2.karcher.local>

Dear developers,

are the string resource IDs (IDS_*) in crypt32.dll supposed to be
compatible to the native Microsoft DLL? It looks like the strings wine
has starting at 1000 are based at 8000 in the crypt32.dll provided with
XP. Since SP2, crypt32.dll has extra strings (e.g. at 7501 and
following), which are not included in wine's version of the DLL.

The reason I am asking is that the native rsaenh.dll fails to load
because of failing GetStringW calls for crypt32.dll. It is supposed to
fail, or should wine be made more compatible.

In the latter case: How do we get string tables that are OK to use in
Wine? Surely it is not allowed to just copy them from the Microsoft
executable, but in the end, for 100% compatibility, we would have to
provide an exact copy. Is there any policy in Wine?

Regards,
  Michael Karcher



From stefandoesinger at gmx.at  Wed May 21 04:33:29 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 21 May 2008 11:33:29 +0200
Subject: Adding d3d9x_xx dlls to winetricks?
In-Reply-To: <d658b69e0805210145u515519aan6851d993b48b7d97@mail.gmail.com>
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
	<200805211040.09714.stefandoesinger@gmx.at>
	<d658b69e0805210145u515519aan6851d993b48b7d97@mail.gmail.com>
Message-ID: <200805211133.29294.stefandoesinger@gmx.at>

Am Mittwoch, 21. Mai 2008 10:45:50 schrieb H. Verbeet:
> 2008/5/21 Stefan D?singer <stefandoesinger at gmx.at>:
> > I think the proper thing to do is to install the DirectX runtime /
> > redistributable. It installs all the DLLs and registers them in the
> > registry etc.
>
> Isn't that what we're trying to avoid?
In the long run we probably want to write a replacement for all the DLLs, 
mostly for licensing reasons. While the DX runtime can be installed on 
Linux/OSX, it can't be bundled with any app intended to run on non-windows 
plattforms.

But I personally prefer installing the full runtime over copying the selected 
DLLs, because it provides a proper setup for the libraries, like 
self-registration, other libs like dplay, etc. Self-registration is 
especially important for directplay, some games check the registry keys(of 
some DLLs we do not implement yet, hence there's no point in setting them in 
the wine registry)

What we want to avoid is giving the impression that it is possible to use the 
native d3d9.dll library with Wine. That's why Roderick didn't like Tom's 
HOWTO. Tom mentiones that d3d9 will only work builtin, but it is easy to miss 
this.



From hverbeet at gmail.com  Wed May 21 05:40:05 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Wed, 21 May 2008 12:40:05 +0200
Subject: Adding d3d9x_xx dlls to winetricks?
In-Reply-To: <200805211133.29294.stefandoesinger@gmx.at>
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
	<200805211040.09714.stefandoesinger@gmx.at>
	<d658b69e0805210145u515519aan6851d993b48b7d97@mail.gmail.com>
	<200805211133.29294.stefandoesinger@gmx.at>
Message-ID: <d658b69e0805210340od6b5f8fo1e5c02efecdef906@mail.gmail.com>

2008/5/21 Stefan D?singer <stefandoesinger at gmx.at>:
> But I personally prefer installing the full runtime over copying the selected
> DLLs, because it provides a proper setup for the libraries, like
> self-registration, other libs like dplay, etc. Self-registration is
> especially important for directplay, some games check the registry keys(of
> some DLLs we do not implement yet, hence there's no point in setting them in
> the wine registry)
>
Sure, but I was under the impression we only care about d3dx9 here,
not dplay etc.


From tony.wasserka at freenet.de  Wed May 21 05:51:32 2008
From: tony.wasserka at freenet.de (tony.wasserka at freenet.de)
Date: Wed, 21 May 2008 12:51:32 +0200
Subject: Adding d3d9x_xx dlls to winetricks?
Message-ID: <E1Jyluu-0001B9-5h@www10.emo.freenet-rz.de>

> So... lots of people are going around installing
> all of directx, and maybe all they needed was, say,
> d3d9x_35.  That's not good.  This sounds like
> a job for winetricks!
> But I know nothing about direct3d.  Could somebody
> have a look at this draft and see if it suffices?  All
> I added was d3d9x_35 and d3d9x_36, is that
> the right set?

You'll need all d3dx dlls, i.e. all from d3dx9_24 to d3dx9_37, as they all (well, most of them) differ a little bit.











From paul.vriens.wine at gmail.com  Wed May 21 07:02:15 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 21 May 2008 14:02:15 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <22821af30805201831y6a337d59q59cfb972c4def8df@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>	
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>	
	<3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>
	<22821af30805201831y6a337d59q59cfb972c4def8df@mail.gmail.com>
Message-ID: <48340F47.6070602@gmail.com>

James Hawkins wrote:
> On Tue, May 20, 2008 at 8:17 PM, Juan Lang <juan.lang at gmail.com> wrote:
>>> anyone knows the exact testing causing the creation of the dummy devices?
>> I believe it's testRegisterDeviceInfo.  See my comment in it:
>> * FIXME: the key also becomes undeletable.  How to get rid of it?
>>
> 
> Another note: the tests can only be run successfully once (assuming no
> other failures), but if the tests are run again without a reboot, we
> get ~30 failures.  I'm assuming that has to do with the undeletability
> (nice fake word) of the device keys.
> 
It appears that the regsitry keys are owned by SYSTEM. On W2K3 it's services.exe 
(haven't checked the other OS's) that creates/modifies these registry keys. So 
they can't be deleted by simply doing a RegDeleteKey in the tests.

Any idea what the best approach is to programatically change the permissions (or 
owner) of these keys so we're able to delete them?

-- 
Cheers,

Paul.


From jwhite at winehq.org  Wed May 21 08:13:03 2008
From: jwhite at winehq.org (Jeremy White)
Date: Wed, 21 May 2008 08:13:03 -0500
Subject: Most common winetest failures on wine
In-Reply-To: <200805192204.48637.kumbayo84@arcor.de>
References: <a71bd89a0805190548t29e28a30of70150b089466fda@mail.gmail.com>	<48318569.5070208@winehq.org>
	<200805192204.48637.kumbayo84@arcor.de>
Message-ID: <48341FDF.6070100@winehq.org>

> I do not have ubuntu/mmap protection here, could you/somebody try with a 
> address like 0x80000.
> 

I've run the attached test program on Windows XP SP3, Hardy Heron 8.04, and
a Debian 'Lenny' system for the memory range of 0x0 through 0x110000.

The results were that on Windows XP, you get partial reads from 0x0 to 0x10000,
and then full reads thereafter.  On Lenny, you get full reads from 0x0 on up.

On Hardy, you get full reads from 0x10000, but no partial reads at 0x0.

Therefore I now believe my patch is correct.  Note that I do not
disable the probe for sub 0x10000 in my patch; I simply avoid checking
readcount if the status from the read is not what we expect.

I've submitted it now to wine-patches; this fixes that particular
make test result for me.

Cheers,

Jeremy
-------------- next part --------------
A non-text attachment was scrubbed...
Name: vm.c
Type: text/x-csrc
Size: 1428 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080521/2c52a9d6/attachment.c 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: vm.hardy
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080521/2c52a9d6/attachment.txt 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: vm.lenny
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080521/2c52a9d6/attachment-0001.txt 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: vm.xp3
Url: http://www.winehq.org/pipermail/wine-devel/attachments/20080521/2c52a9d6/attachment-0002.txt 

From stefandoesinger at gmx.at  Wed May 21 08:25:29 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Wed, 21 May 2008 15:25:29 +0200
Subject: Adding d3d9x_xx dlls to winetricks?
In-Reply-To: <d658b69e0805210340od6b5f8fo1e5c02efecdef906@mail.gmail.com>
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
	<200805211133.29294.stefandoesinger@gmx.at>
	<d658b69e0805210340od6b5f8fo1e5c02efecdef906@mail.gmail.com>
Message-ID: <200805211525.29984.stefandoesinger@gmx.at>

Am Mittwoch, 21. Mai 2008 12:40:05 schrieb H. Verbeet:
> Sure, but I was under the impression we only care about d3dx9 here,
> not dplay etc.

That's up to Dan. He's maintaining winetricks, so I won't interfere with his 
decisions.


From juan.lang at gmail.com  Wed May 21 10:14:11 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Wed, 21 May 2008 08:14:11 -0700
Subject: unknown device issues after running winetest
In-Reply-To: <4833E178.9030407@gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
	<3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>
	<4833E178.9030407@gmail.com>
Message-ID: <3a768c550805210814y51ea9665h59aa898d30a50062@mail.gmail.com>

Hi Paul,

> Are the tests in devinst.c supposed so be run in order? IOW are they
> supposed to bee cleaned up after each subtest or do they rely on each other?

I'm sure I didn't put that much thought into making the tests order
dependent.  I wrote them, ran them, made them into tests, and they
worked at least once for me.  I might not have tested running them
subsequent times on the same machine.

I don't think it's a general problem with the devinst.c tests.  There
are two problems with them:
1. Some of the last error checks fail on some versions of Windows.  I
only have Windows XP, so I couldn't have anticipated these.  James is
doing a nice job of cleaning them up (thanks James.)
2. The call to SetupDiRegisterDeviceInfo leaves keys around that are
hard to delete, and cause subsequent runs of the test to fail.

In my opinion it's probably okay to remove the
SetupDiRegisterDeviceInfo tests.  I don't know any apps that call this
API directly.
--Juan


From juan.lang at gmail.com  Wed May 21 10:18:10 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Wed, 21 May 2008 08:18:10 -0700
Subject: unknown device issues after running winetest
In-Reply-To: <48343D04.20002@gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
	<3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>
	<4833E178.9030407@gmail.com>
	<3a768c550805210814y51ea9665h59aa898d30a50062@mail.gmail.com>
	<48343D04.20002@gmail.com>
Message-ID: <3a768c550805210818r63af8001t17b5beb2e45be2fd@mail.gmail.com>

> Now you tell me :-).
>
> I've something in place already to get rid of the stray registry keys. Just
> needs some more thought and tweaking.

Well that's even better!  Feel free to send here for comments :)
--Juan


From paul.vriens.wine at gmail.com  Wed May 21 10:23:21 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 21 May 2008 17:23:21 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <3a768c550805210818r63af8001t17b5beb2e45be2fd@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>	
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>	
	<3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>	
	<4833E178.9030407@gmail.com>	
	<3a768c550805210814y51ea9665h59aa898d30a50062@mail.gmail.com>	
	<48343D04.20002@gmail.com>
	<3a768c550805210818r63af8001t17b5beb2e45be2fd@mail.gmail.com>
Message-ID: <48343E69.5060709@gmail.com>

Juan Lang wrote:
>> Now you tell me :-).
>>
>> I've something in place already to get rid of the stray registry keys. Just
>> needs some more thought and tweaking.
> 
> Well that's even better!  Feel free to send here for comments :)
> --Juan
> 
It's a new function that just changes the permissions:

static void change_reg_permissions(CHAR *regkey)
{
     HKEY hkey;
     SID_IDENTIFIER_AUTHORITY ident = { SECURITY_WORLD_SID_AUTHORITY };
     SECURITY_DESCRIPTOR sd;
     PSID EveryoneSid;
     PACL pacl = NULL;

     RegOpenKeyExA(HKEY_LOCAL_MACHINE, regkey, 0, WRITE_DAC, &hkey);

     /* Initialize the 'Everyone' sid */
     AllocateAndInitializeSid(&ident, 1, SECURITY_WORLD_RID, 0, 0, 0, 0, 0, 0, 
0, &EveryoneSid);

     pacl = HeapAlloc(GetProcessHeap(), 0, 256);
     InitializeAcl(pacl, 256, ACL_REVISION);

     /* Add 'Full Control' for 'Everyone' */
     AddAccessAllowedAce(pacl, ACL_REVISION, KEY_ALL_ACCESS, EveryoneSid);

     InitializeSecurityDescriptor(&sd, SECURITY_DESCRIPTOR_REVISION);

     SetSecurityDescriptorDacl(&sd, TRUE, pacl, FALSE);

     /* Set the new security on the registry key */
     RegSetKeySecurity(hkey, DACL_SECURITY_INFORMATION, &sd);

     RegCloseKey(hkey);

     HeapFree(GetProcessHeap(), 0, pacl);
     if (EveryoneSid)
         FreeSid(EveryoneSid);
}

Now we are able to remove the registry keys. Works fine on NT4, didn't test on 
Vista yet.

I didn't find a way yet (and didn't look to hard) to make the subkeys inherit 
these new permissions. Otherwise I have to do this for every key.

-- 
Cheers,

Paul.


From juan.lang at gmail.com  Wed May 21 10:33:02 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Wed, 21 May 2008 08:33:02 -0700
Subject: crypt32: String resource IDs
In-Reply-To: <1211360419.9165.42.camel@hermes2.karcher.local>
References: <1211360419.9165.42.camel@hermes2.karcher.local>
Message-ID: <3a768c550805210833q61b5cb2ei1afdb71d073fc254@mail.gmail.com>

> are the string resource IDs (IDS_*) in crypt32.dll supposed to be
> compatible to the native Microsoft DLL?

Only if an app depends on this.

> The reason I am asking is that the native rsaenh.dll fails to load
> because of failing GetStringW calls for crypt32.dll. It is supposed to
> fail, or should wine be made more compatible.

That's interesting.  We could probably change the string IDs to match
to get native rsaenh to load.  While we don't necessarily need to
provide compatibility for native rsaenh, it can't hurt.  A patch would
be welcome.

> In the latter case: How do we get string tables that are OK to use in
> Wine? Surely it is not allowed to just copy them from the Microsoft
> executable, but in the end, for 100% compatibility, we would have to
> provide an exact copy. Is there any policy in Wine?

IANAL, but I'll give my opinion based on a limited understanding of
the relevant cases.  It's not okay to copy them, as the strings
themselves are likely copyrighted material.  The IDs, however, are
part of the interface, and may be copied.  So, if all that's needed is
for e.g. IDS_AUTHORITY_KEY_ID to have value 8000, that's fine.  It's
not necessary to copy Microsoft's text to achieve that.
--Juan


From jwhite at codeweavers.com  Wed May 21 10:39:49 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Wed, 21 May 2008 10:39:49 -0500
Subject: Thunderbird warning repeat - use --attach
Message-ID: <48344245.5020408@codeweavers.com>

So it seems as though every month or so, some id10t is bit by
the Thunderbird bug where it mangles perfectly reasonable looking
git-format-patch drafts.

This month, I won the prize! :-)

I had always habitually done --attach, because that's what GitWine says to do.
But after scratching my head, reading man pages, and
checking my drafts, I decided that was lame; inline is always nicer, and
I dropped the --attach.  Big mistake; the draft may look okay, but the end result
is mangled somehow.

Thanks to Dmitry for alerting me.

I've filed a bug with Mozilla over this:
   https://bugzilla.mozilla.org/show_bug.cgi?id=435020

My sense is that its a subtle bug of some kind; I've had a hard
time articulating a strategy to reproduce it (which, by Occam's
razor, immediately suggests I'm just missing something :-/).

So if others are bit by this and can share any clues or tips
for the Mozilla devs on how to reproduce it, I'd appreciate it.

Cheers,

Jeremy


From juan.lang at gmail.com  Wed May 21 10:44:51 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Wed, 21 May 2008 08:44:51 -0700
Subject: unknown device issues after running winetest
In-Reply-To: <48343E69.5060709@gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
	<3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>
	<4833E178.9030407@gmail.com>
	<3a768c550805210814y51ea9665h59aa898d30a50062@mail.gmail.com>
	<48343D04.20002@gmail.com>
	<3a768c550805210818r63af8001t17b5beb2e45be2fd@mail.gmail.com>
	<48343E69.5060709@gmail.com>
Message-ID: <3a768c550805210844k32924f16qf4a7cc278fb459c9@mail.gmail.com>

> I didn't find a way yet (and didn't look to hard) to make the subkeys
> inherit these new permissions. Otherwise I have to do this for every key.

I don't think you can if you don't actually create the key.  The
caller of RegCreateKeyEx is able to set the default DACL for the key,
and subkeys will inherit this if they don't set their own DACL.  In
this case we expect that some system process is creating the key, so
we have to change the DACL after the fact.

In other words, I think your function looks fine :)
--Juan


From paul.vriens.wine at gmail.com  Wed May 21 10:17:24 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 21 May 2008 17:17:24 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <3a768c550805210814y51ea9665h59aa898d30a50062@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>	
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>	
	<3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>	
	<4833E178.9030407@gmail.com>
	<3a768c550805210814y51ea9665h59aa898d30a50062@mail.gmail.com>
Message-ID: <48343D04.20002@gmail.com>

Juan Lang wrote:
> Hi Paul,
> 
>> Are the tests in devinst.c supposed so be run in order? IOW are they
>> supposed to bee cleaned up after each subtest or do they rely on each other?
> 
> I'm sure I didn't put that much thought into making the tests order
> dependent.  I wrote them, ran them, made them into tests, and they
> worked at least once for me.  I might not have tested running them
> subsequent times on the same machine.
> 
> I don't think it's a general problem with the devinst.c tests.  There
> are two problems with them:
> 1. Some of the last error checks fail on some versions of Windows.  I
> only have Windows XP, so I couldn't have anticipated these.  James is
> doing a nice job of cleaning them up (thanks James.)
> 2. The call to SetupDiRegisterDeviceInfo leaves keys around that are
> hard to delete, and cause subsequent runs of the test to fail.
> 
> In my opinion it's probably okay to remove the
> SetupDiRegisterDeviceInfo tests.  I don't know any apps that call this
> API directly.
> --Juan
> 
Now you tell me :-).

I've something in place already to get rid of the stray registry keys. Just 
needs some more thought and tweaking.

-- 
Cheers,

Paul.


From winehacker at gmail.com  Wed May 21 11:28:57 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Wed, 21 May 2008 12:28:57 -0400
Subject: Thunderbird warning repeat - use --attach
In-Reply-To: <48344245.5020408@codeweavers.com>
References: <48344245.5020408@codeweavers.com>
Message-ID: <19e31a080805210928h3b246530m85015f6cd2357958@mail.gmail.com>

On Wed, May 21, 2008 at 11:39 AM, Jeremy White <jwhite at codeweavers.com> wrote:
> So it seems as though every month or so, some id10t is bit by
> the Thunderbird bug where it mangles perfectly reasonable looking
> git-format-patch drafts.
>
> This month, I won the prize! :-)

You mean your not using outlook for your email. =P

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From jwhite at codeweavers.com  Wed May 21 11:43:58 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Wed, 21 May 2008 11:43:58 -0500
Subject: Thunderbird warning repeat - use --attach
In-Reply-To: <19e31a080805210928h3b246530m85015f6cd2357958@mail.gmail.com>
References: <48344245.5020408@codeweavers.com>
	<19e31a080805210928h3b246530m85015f6cd2357958@mail.gmail.com>
Message-ID: <4834514E.8030709@codeweavers.com>

Steven Edwards wrote:
> On Wed, May 21, 2008 at 11:39 AM, Jeremy White <jwhite at codeweavers.com> wrote:
>> So it seems as though every month or so, some id10t is bit by
>> the Thunderbird bug where it mangles perfectly reasonable looking
>> git-format-patch drafts.
>>
>> This month, I won the prize! :-)
> 
> You mean your not using outlook for your email. =P
> 

Outlook 2007 (even on Windows) chokes on my (rather large) IMAP mail box :-(, else
I would be...



From htl10 at users.sourceforge.net  Wed May 21 11:47:48 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 21 May 2008 16:47:48 +0000 (GMT)
Subject: fedora 9/gcc 4.3 internal compiler error with wine 1.0 rc1
Message-ID: <528584.79407.qm@web23103.mail.ird.yahoo.com>

This is probably a bug with gcc 4.3, but just in case
there are some people who are knowledgeable with gcc
in wine-devel, who may want to fix gcc so that
wine can be built on f9:

https://bugzilla.redhat.com/show_bug.cgi?id=445494



      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html


From xixsimplicityxix at gmail.com  Wed May 21 11:56:54 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 21 May 2008 11:56:54 -0500
Subject: Patch against bug [13112]
In-Reply-To: <1211314474.4833312a314eb@imp3.online.net>
References: <1211314474.4833312a314eb@imp3.online.net>
Message-ID: <78a7dad00805210956y4bec20a2w7c19f7a154f3a87a@mail.gmail.com>

On Tue, May 20, 2008 at 3:14 PM, Josep Maria Antol?n Segura
<jaz at pastnotecut.org> wrote:
> Hello,
>
> I am resending here the patch attached to the bug # 13112 on bugzilla, regarding
> the trackbar control of the comctl32.dll file.

You forgot to attach the patch.

--John

From juan.lang at gmail.com  Wed May 21 12:01:17 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Wed, 21 May 2008 10:01:17 -0700
Subject: crypt32: String resource IDs
In-Reply-To: <1211388911.9165.71.camel@hermes2.karcher.local>
References: <1211360419.9165.42.camel@hermes2.karcher.local>
	<3a768c550805210833q61b5cb2ei1afdb71d073fc254@mail.gmail.com>
	<1211388911.9165.71.camel@hermes2.karcher.local>
Message-ID: <3a768c550805211001p139e0e29taa71801c0d8ffbd5@mail.gmail.com>

Don't forget to cc wine-devel on replies..

On Wed, May 21, 2008 at 9:55 AM, Michael Karcher
<wine at mkarcher.dialup.fu-berlin.de> wrote:
> do we define "rsaenh.dll" as "application"?

Not usually, as it's part of Windows and doesn't come with other applications.

> So we do not currently have the needed strings (they seem to decribe
> actions, for logging, error reporting or progress indication). The
> strings we do have are differently numbered, but up to now, I don't know
> about any code relying on those numbers.

In that case, we just need to add some strings for it.  The text
values of the strings don't have to match for now.

> Thats right. But for rsaenh.dll I need strings wine does not currently
> have. The question is how I legally get these strings into wine.

Now you're asking for advice I'm not qualified to give.  Perhaps
someone here can give better guidance.  In particular you might ask
Jeremy whether the SFLC has given any hints about the proper way to
add UI elements to Wine.
--Juan


From austinenglish at gmail.com  Wed May 21 12:11:39 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 21 May 2008 12:11:39 -0500
Subject: Crosstests - Too large of log files?
Message-ID: <b6bb06270805211011w45a0c53bu6145b78745c654d1@mail.gmail.com>

In the past 2 days, when running the cross tests on my work XP box, I
keep getting an error that the log file is too big (1.6 Mb > 1.5 Mb
max). Anyone else seeing this? It's submitting partial reports, which
may or may not be useful. Can we get some compression going, or
increase the max log size?

-Austin


From m.b.lankhorst at gmail.com  Wed May 21 12:27:38 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 21 May 2008 10:27:38 -0700
Subject: unknown device issues after running winetest
In-Reply-To: <3a768c550805210814y51ea9665h59aa898d30a50062@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>
	<3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>
	<4833E178.9030407@gmail.com>
	<3a768c550805210814y51ea9665h59aa898d30a50062@mail.gmail.com>
Message-ID: <b130c85e0805211027x945b03bg24f42ea808e3812d@mail.gmail.com>

Hello Juan,

2008/5/21 Juan Lang <juan.lang at gmail.com>:
>> Are the tests in devinst.c supposed so be run in order? IOW are they
>> supposed to bee cleaned up after each subtest or do they rely on each other?
>
> I'm sure I didn't put that much thought into making the tests order
> dependent.  I wrote them, ran them, made them into tests, and they
> worked at least once for me.  I might not have tested running them
> subsequent times on the same machine.
>
> I don't think it's a general problem with the devinst.c tests.  There
> are two problems with them:
> 1. Some of the last error checks fail on some versions of Windows.  I
> only have Windows XP, so I couldn't have anticipated these.  James is
> doing a nice job of cleaning them up (thanks James.)
> 2. The call to SetupDiRegisterDeviceInfo leaves keys around that are
> hard to delete, and cause subsequent runs of the test to fail.
>
> In my opinion it's probably okay to remove the
> SetupDiRegisterDeviceInfo tests.  I don't know any apps that call this
> API directly.
My ipod patches (if they ever make it in) use them to register the ipod device.

Cheers,
Maarten.


From paul.vriens.wine at gmail.com  Wed May 21 12:39:50 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Wed, 21 May 2008 19:39:50 +0200
Subject: Crosstests - Too large of log files?
In-Reply-To: <b6bb06270805211011w45a0c53bu6145b78745c654d1@mail.gmail.com>
References: <b6bb06270805211011w45a0c53bu6145b78745c654d1@mail.gmail.com>
Message-ID: <48345E66.2010705@gmail.com>

Austin English wrote:
> In the past 2 days, when running the cross tests on my work XP box, I
> keep getting an error that the log file is too big (1.6 Mb > 1.5 Mb
> max). Anyone else seeing this? It's submitting partial reports, which
> may or may not be useful. Can we get some compression going, or
> increase the max log size?
> 
> -Austin
> 
> 
> 
I guess in your particular case it's due to the shlwapi/istream test and the 
gdi32/font test.

When looking at http://test.winehq.org/data/200805201000/#group_XP you can see 
that your box has 26000 tests run for gdi32/font whereas the other XP ones have 
about 5000-8000 tests.

The shlwapi/istream just has a lot of failures.

Anyway, here you can see how big the individual tests are (but I guess you know 
that):

http://test.winehq.org/data/200805201000/xp_aenglish-xp/?C=S;O=D

FWIW we never had a complete Vista report.

I mentioned compression a few months ago and got some positive replies. We now 
only needs someone how implements this in winetest and at the backend.

-- 
Cheers,

Paul.


From austinenglish at gmail.com  Wed May 21 12:44:42 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 21 May 2008 12:44:42 -0500
Subject: Crosstests - Too large of log files?
In-Reply-To: <48345E66.2010705@gmail.com>
References: <b6bb06270805211011w45a0c53bu6145b78745c654d1@mail.gmail.com>
	<48345E66.2010705@gmail.com>
Message-ID: <b6bb06270805211044q68f2eeacwf8afcd281eb5e6ef@mail.gmail.com>

On Wed, May 21, 2008 at 12:39 PM, Paul Vriens
<paul.vriens.wine at gmail.com> wrote:
> Austin English wrote:
>>
>> In the past 2 days, when running the cross tests on my work XP box, I
>> keep getting an error that the log file is too big (1.6 Mb > 1.5 Mb
>> max). Anyone else seeing this? It's submitting partial reports, which
>> may or may not be useful. Can we get some compression going, or
>> increase the max log size?
>>
>> -Austin
>>
>>
>>
> I guess in your particular case it's due to the shlwapi/istream test and the
> gdi32/font test.
>
> When looking at http://test.winehq.org/data/200805201000/#group_XP you can
> see that your box has 26000 tests run for gdi32/font whereas the other XP
> ones have about 5000-8000 tests.
>
> The shlwapi/istream just has a lot of failures.
Thanks, hadn't investigated the reason yet. The question is why am I
the only XP box seeing this? Hmm. FWIW, IE6, SP2. I can upgrade
either, just haven't found a need for it...

> I mentioned compression a few months ago and got some positive replies. We
> now only needs someone how implements this in winetest and at the backend.
In the meantime, increasing the log size a little bit would help to
get complete reports in for Vista. Reece, how big are the Vista log
files?

-Austin


From xixsimplicityxix at gmail.com  Wed May 21 13:23:30 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Wed, 21 May 2008 13:23:30 -0500
Subject: Crosstests - Too large of log files?
In-Reply-To: <b6bb06270805211044q68f2eeacwf8afcd281eb5e6ef@mail.gmail.com>
References: <b6bb06270805211011w45a0c53bu6145b78745c654d1@mail.gmail.com>
	<48345E66.2010705@gmail.com>
	<b6bb06270805211044q68f2eeacwf8afcd281eb5e6ef@mail.gmail.com>
Message-ID: <78a7dad00805211123p4b6ce352uc01502948e5e654c@mail.gmail.com>

On Wed, May 21, 2008 at 12:44 PM, Austin English
<austinenglish at gmail.com> wrote:
>> I mentioned compression a few months ago and got some positive replies. We
>> now only needs someone how implements this in winetest and at the backend.
> In the meantime, increasing the log size a little bit would help to
> get complete reports in for Vista. Reece, how big are the Vista log
> files?
>

FWIW on Server 2008 the winetest log files were around 2.2 MB.

--John


From marcus at jet.franken.de  Wed May 21 15:46:43 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Wed, 21 May 2008 22:46:43 +0200
Subject: fedora 9/gcc 4.3 internal compiler error with wine 1.0 rc1
In-Reply-To: <528584.79407.qm@web23103.mail.ird.yahoo.com>
References: <528584.79407.qm@web23103.mail.ird.yahoo.com>
Message-ID: <20080521204643.GA4283@galeere>

On Wed, May 21, 2008 at 04:47:48PM +0000, Hin-Tak Leung wrote:
> This is probably a bug with gcc 4.3, but just in case
> there are some people who are knowledgeable with gcc
> in wine-devel, who may want to fix gcc so that
> wine can be built on f9:
> 
> https://bugzilla.redhat.com/show_bug.cgi?id=445494

This is a known and fixed problem.

You need to set memory?stack? size to unlimited, because
menu.c compilation needs quite some stackspace.

It is fixed in TRUNK and gcc 4.3 branch, and will be in
the next 4.3 release.

Ciao, Marcus


From truiken at gmail.com  Wed May 21 15:57:16 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 21 May 2008 15:57:16 -0500
Subject: wined3d: Remove unneeded "extern" from function definition
In-Reply-To: <200805212150.36859.andrew.talbot@talbotville.com>
References: <200805212150.36859.andrew.talbot@talbotville.com>
Message-ID: <22821af30805211357n3a120754w19e88da5d1d66d70@mail.gmail.com>

On Wed, May 21, 2008 at 3:50 PM, Andrew Talbot
<andrew.talbot at talbotville.com> wrote:
> Changelog:
>    wined3d: Remove unneeded "extern" from function definition.
>
> diff --git a/dlls/wined3d/surface.c b/dlls/wined3d/surface.c
> index 7a1a355..684690b 100644
> --- a/dlls/wined3d/surface.c
> +++ b/dlls/wined3d/surface.c
> @@ -2489,7 +2489,7 @@ HRESULT WINAPI IWineD3DSurfaceImpl_SaveSnapshot(IWineD3DSurface *iface, const ch
>  /**
>  *   Slightly inefficient way to handle multiple dirty rects but it works :)
>  */
> -extern HRESULT WINAPI IWineD3DSurfaceImpl_AddDirtyRect(IWineD3DSurface *iface, CONST RECT* pDirtyRect) {
> +HRESULT WINAPI IWineD3DSurfaceImpl_AddDirtyRect(IWineD3DSurface *iface, CONST RECT* pDirtyRect) {
>     IWineD3DSurfaceImpl *This = (IWineD3DSurfaceImpl *)iface;
>     IWineD3DBaseTexture *baseTexture = NULL;
>

These interface implementations could even be made static.

-- 
James Hawkins


From htl10 at users.sourceforge.net  Wed May 21 16:10:24 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 21 May 2008 21:10:24 +0000 (GMT)
Subject: fedora 9/gcc 4.3 internal compiler error with wine 1.0 rc1
In-Reply-To: <20080521204643.GA4283@galeere>
Message-ID: <765723.29809.qm@web23106.mail.ird.yahoo.com>

--- On Wed, 21/5/08, Marcus Meissner <marcus at jet.franken.de> wrote:

> From: Marcus Meissner <marcus at jet.franken.de>
> Subject: Re: fedora 9/gcc 4.3 internal compiler error with wine 1.0 rc1
> To: "Hin-Tak Leung" <htl10 at users.sourceforge.net>
> Cc: wine-devel at winehq.org
> Date: Wednesday, 21 May, 2008, 9:46 PM
> On Wed, May 21, 2008 at 04:47:48PM +0000, Hin-Tak Leung
> wrote:
> > This is probably a bug with gcc 4.3, but just in case
> > there are some people who are knowledgeable with gcc
> > in wine-devel, who may want to fix gcc so that
> > wine can be built on f9:
> > 
> > https://bugzilla.redhat.com/show_bug.cgi?id=445494
> 
> This is a known and fixed problem.
> 
> You need to set memory?stack? size to unlimited, because
> menu.c compilation needs quite some stackspace.
> 
> It is fixed in TRUNK and gcc 4.3 branch, and will be in
> the next 4.3 release.
> 
> Ciao, Marcus

I knew somebody know the answer :-). Thanks a lot!



      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html


From Andrew.Talbot at talbotville.com  Wed May 21 16:44:53 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Wed, 21 May 2008 22:44:53 +0100
Subject: wined3d: Remove unneeded "extern" from function definition
References: <200805212150.36859.andrew.talbot@talbotville.com>
	<22821af30805211357n3a120754w19e88da5d1d66d70@mail.gmail.com>
Message-ID: <g1254l$ge1$1@ger.gmane.org>

James Hawkins wrote:

> 
> These interface implementations could even be made static.
> 

That's true. I shall still leave this patch in for consideration, since I
don't have time, right now, to properly consider what can be made static in
this dll. I hope to do so another time.

Thanks,

-- 
Andy.




From truiken at gmail.com  Wed May 21 16:53:14 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 21 May 2008 16:53:14 -0500
Subject: wined3d: Remove unneeded "extern" from function definition
In-Reply-To: <g1254l$ge1$1@ger.gmane.org>
References: <200805212150.36859.andrew.talbot@talbotville.com>
	<22821af30805211357n3a120754w19e88da5d1d66d70@mail.gmail.com>
	<g1254l$ge1$1@ger.gmane.org>
Message-ID: <22821af30805211453u5bab511fy22e3e1cc5e3ac641@mail.gmail.com>

On Wed, May 21, 2008 at 4:44 PM, Andrew Talbot
<Andrew.Talbot at talbotville.com> wrote:
> James Hawkins wrote:
>
>>
>> These interface implementations could even be made static.
>>
>
> That's true. I shall still leave this patch in for consideration, since I
> don't have time, right now, to properly consider what can be made static in
> this dll. I hope to do so another time.
>

Sure.  It's a pretty easy decision for interface implementations:
since the functions are accessed through an instantiated object, the
actual functions shouldn't be needed outside the source file they
reside in, and that's the definition of which functions qualify for
'static'.

-- 
James Hawkins


From truiken at gmail.com  Wed May 21 18:33:19 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 21 May 2008 18:33:19 -0500
Subject: mlang: accept character set names like ISO8859-1
In-Reply-To: <a71bd89a0805211622v1658de53i853d5d17412429fe@mail.gmail.com>
References: <a71bd89a0805211622v1658de53i853d5d17412429fe@mail.gmail.com>
Message-ID: <22821af30805211633k73a565a3j435a2c5900187dad@mail.gmail.com>

On Wed, May 21, 2008 at 6:22 PM, Dan Kegel <dank at kegel.com> wrote:
> Accept names both with and without dash after ISO.
>
> Fixes http://bugs.winehq.org/show_bug.cgi?id=13340
>
> The ugly string comparison could be avoided by
> canonicalizing the input character set name,
> though that would mean making a copy.  Would
> you prefer it that way instead?
>
> This doesn't change the miserable status of the
> mlang tests on XP:
> http://test.winehq.org/data/200805211000/#group_XP:mlang:mlang
>

Those are fixed by this patch:

http://winehq.org/pipermail/wine-patches/2008-May/054961.html

Julliard is suspicious of the ZeroMemory I had to add, so I need to
add another test case to prove it.

-- 
James Hawkins


From austinenglish at gmail.com  Wed May 21 18:34:42 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 21 May 2008 18:34:42 -0500
Subject: Crosstests - Too large of log files?
In-Reply-To: <3f4fd2640805211145n7bace3d6wc67687d04d25c5d6@mail.gmail.com>
References: <b6bb06270805211011w45a0c53bu6145b78745c654d1@mail.gmail.com>
	<48345E66.2010705@gmail.com>
	<b6bb06270805211044q68f2eeacwf8afcd281eb5e6ef@mail.gmail.com>
	<3f4fd2640805211145n7bace3d6wc67687d04d25c5d6@mail.gmail.com>
Message-ID: <b6bb06270805211634m4afe8c3brbc66ec667a707af4@mail.gmail.com>

On Wed, May 21, 2008 at 1:45 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
> 2008/5/21 Austin English <austinenglish at gmail.com>:
>> On Wed, May 21, 2008 at 12:39 PM, Paul Vriens
>> <paul.vriens.wine at gmail.com> wrote:
>>> Austin English wrote:
>>>>
>>>> In the past 2 days, when running the cross tests on my work XP box, I
>>>> keep getting an error that the log file is too big (1.6 Mb > 1.5 Mb
>>>> max). Anyone else seeing this? It's submitting partial reports, which
>>>> may or may not be useful. Can we get some compression going, or
>>>> increase the max log size?
>>>>
>>>> -Austin
>>>>
>>>>
>>>>
>>> I guess in your particular case it's due to the shlwapi/istream test and the
>>> gdi32/font test.
>>>
>>> The shlwapi/istream just has a lot of failures.
>> Thanks, hadn't investigated the reason yet. The question is why am I
>> the only XP box seeing this? Hmm. FWIW, IE6, SP2. I can upgrade
>> either, just haven't found a need for it...
>
> Do you have the file "c:\test.txt" lying around on that machine? If
> so, could you delete it and rerun the shlwapi:istream tests?
>

http://test.winehq.org/data/200805211000/#group_XP

aenglish-xp - first run/bad
aenglish-xp-try2 - deleted C:\test.txt and also installed updated
nvidia drivers, though that only fixed a few ddraw:visuals...Computer
has a Nvidia 8800 GT...


From m.b.lankhorst at gmail.com  Wed May 21 19:29:48 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 21 May 2008 17:29:48 -0700
Subject: Thunderbird warning repeat - use --attach
In-Reply-To: <4834514E.8030709@codeweavers.com>
References: <48344245.5020408@codeweavers.com>
	<19e31a080805210928h3b246530m85015f6cd2357958@mail.gmail.com>
	<4834514E.8030709@codeweavers.com>
Message-ID: <b130c85e0805211729q672f76ddn851103994a6e7157@mail.gmail.com>

Hi Jeremy

2008/5/21 Jeremy White <jwhite at codeweavers.com>:
> Steven Edwards wrote:
>> On Wed, May 21, 2008 at 11:39 AM, Jeremy White <jwhite at codeweavers.com> wrote:
>>> So it seems as though every month or so, some id10t is bit by
>>> the Thunderbird bug where it mangles perfectly reasonable looking
>>> git-format-patch drafts.
>>>
>>> This month, I won the prize! :-)
>>
>> You mean your not using outlook for your email. =P
>>
>
> Outlook 2007 (even on Windows) chokes on my (rather large) IMAP mail box :-(, else
> I would be...

When I had to send in some kernel patches I used
http://www.linux-mips.org/wiki/Mailing-patches which has some nice
things about patch settings. Maybe it helps.

Cheers,
Maarten.


From dmitry at codeweavers.com  Wed May 21 21:41:38 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Thu, 22 May 2008 11:41:38 +0900
Subject: headers: Update aviriff header to use 1 byte alignment
References: <b130c85e0805211439l61057efo13806177e0ccfc8e@mail.gmail.com>
Message-ID: <DDBDEF76FF0A48F89B310F38E78B9609@DMITRY>

"Maarten Lankhorst" <m.b.lankhorst at gmail.com> wrote:

> These structures are on disk formats, so normal alignment rules don't
> apply here.

PSDK has a different idea about aviriff.h alignment.

-- 
Dmitry.


From dank at kegel.com  Thu May 22 00:39:01 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 21 May 2008 22:39:01 -0700
Subject: Take the Wine 1.0 Dogfood Challenge!
Message-ID: <a71bd89a0805212239n2e140c71rbf46c1cf483baa4e@mail.gmail.com>

As I wrote two years ago:
if we're expecting people to use Wine for real
work, maybe we should start doing that ourselves.

How's about everybody start using Wine for *everything*?

See http://wiki.winehq.org/DogfoodChallenge


From paul.vriens.wine at gmail.com  Thu May 22 03:01:09 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 22 May 2008 10:01:09 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <3a768c550805210844k32924f16qf4a7cc278fb459c9@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com> <4832D696.2000203@gmail.com>	
	<b130c85e0805201808j590bc2ffua753a50287dffae4@mail.gmail.com>	
	<3a768c550805201817i5b8b48f5v21935afb925cbf06@mail.gmail.com>	
	<4833E178.9030407@gmail.com>	
	<3a768c550805210814y51ea9665h59aa898d30a50062@mail.gmail.com>	
	<48343D04.20002@gmail.com>	
	<3a768c550805210818r63af8001t17b5beb2e45be2fd@mail.gmail.com>	
	<48343E69.5060709@gmail.com>
	<3a768c550805210844k32924f16qf4a7cc278fb459c9@mail.gmail.com>
Message-ID: <48352845.7070208@gmail.com>

Juan Lang wrote:
>> I didn't find a way yet (and didn't look to hard) to make the subkeys
>> inherit these new permissions. Otherwise I have to do this for every key.
> 
> I don't think you can if you don't actually create the key.  The
> caller of RegCreateKeyEx is able to set the default DACL for the key,
> and subkeys will inherit this if they don't set their own DACL.  In
> this case we expect that some system process is creating the key, so
> we have to change the DACL after the fact.
> 
> In other words, I think your function looks fine :)
> --Juan
> 
Ok, I will go ahead and start creating the patches to be able to delete the 
registry keys after each test (if there are leftovers of course).

Currently we will have loads of Windows boxes out there that have bogus registry 
keys. Should I first create a cleanup routine at the start of devinst.c ?

A problem I'm seeing is that more registry keys are added after reboots.
Running the tests on a clean machine adds bogus entries to 
HKLM/SYSTEM/CurrentControlSet and there are 'links' from ControlSet001 for 
example. When I delete them before a reboot the 'links' are gone as well. When I 
however first reboot I've seen occasions where the keys can also be found at 
ControlSet002 (or 003 even). Deleting the keys in CurrentControlSet now doesn't 
remove them from ControlSet002 (or 003).

Another approach is of course to only do the cleanup afterwards which means we 
will have 1 run of tests that will fail.

-- 
Cheers,

Paul.


From julliard at winehq.org  Thu May 22 04:37:19 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 22 May 2008 11:37:19 +0200
Subject: kernel32: Enumerate the Greek language group locales instead of
	Western Europe
In-Reply-To: <22821af30805212028g466c636fua88b5dd6133d8377@mail.gmail.com>
	(James Hawkins's message of "Wed, 21 May 2008 22:28:13 -0500")
References: <22821af30805212028g466c636fua88b5dd6133d8377@mail.gmail.com>
Message-ID: <87zlqismr4.fsf@wine.dyndns.org>

"James Hawkins" <jhawkins at codeweavers.com> writes:

> Any objections to this patch?  The point of the test is to enumerate
> locales of a language group, which still happens.  The failure in
> win2k3 can't easily be caught, so this works around that.

Looking at the test results it seems the failure is because it passes an
lcid of 0, that seems pretty trivial to catch. Did I miss something?

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Thu May 22 04:59:51 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 22 May 2008 11:59:51 +0200
Subject: Adding d3d9x_xx dlls to winetricks?
In-Reply-To: <a71bd89a0805211644s15650a30jd9b5a74ef5bae311@mail.gmail.com>
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
	<200805211040.09714.stefandoesinger@gmx.at>
	<a71bd89a0805211644s15650a30jd9b5a74ef5bae311@mail.gmail.com>
Message-ID: <200805221159.51665.stefan@codeweavers.com>

Am Donnerstag, 22. Mai 2008 01:44:33 schrieb Dan Kegel:
> On Wed, May 21, 2008 at 1:40 AM, Stefan D?singer <stefandoesinger at gmx.at> 
wrote:
> > I think the proper thing to do is to install the DirectX runtime /
> > redistributable. It installs all the DLLs and registers them in the
> > registry etc.
>
> Suits me.  How's this look?   I just threw in a guess at
> the dll overrides, I'm hoping you will have something to say there.
> - Dan
Don't set mscoree to n, disable it entirely. The installer doesn't need .NET, 
but some library it uses(msi?) tries to load it and fails if it is available.

I think I was wrong about wininet: wintrust is the DLL that has to be forced 
to builtin.


From fgouget at free.fr  Thu May 22 05:06:58 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 22 May 2008 12:06:58 +0200 (CEST)
Subject: Winetest broken on Win98
Message-ID: <alpine.DEB.1.10.0805221054470.20572@amboise.dolphin>


So if anyone has been wondering why I don't run the tests on Win98 
anymore... I still do! The problem is that since 2008/05/08 something 
prevents winetest from submitting the results.

The 200805062030 winetest build works fine so that leaves a two/three 
days window where things went wrong. Unfortunately I have been unable to 
pinpoint a specific test that causes the problem.

Here's a log I generated with the 200805211000 build:
http://fgouget.free.fr/tmp/winetest.log

I let winetest run for 90 minutes (normally it's over in about 15), then 
Windows was frozen, not responding to Ctrl-Alt-Del, using all the CPU 
and I had to hit VMware's reset button.

The last test that was run is setupapi:parser, but according to the log 
it completed fine, and I can run it by hand just fine. Still according 
to the log the next test did not even start.


Unfortunately the list of potential suspects is quite long. It would 
help if I could at least cross-build winetest but I always get errors 
(e.g. due to d3dx9_36). What happened to the resolution to get rid of 
the dependency on MinGW libraries? Alternatively, where's the lastest 
version of w32api with d3dx9_36?


commit 382ed33b7a770d532bcf4b7dc392ee929c987c7a
Author: Vitaliy Margolen <wine-patches at kievinfo.com>
Date:   Thu May 8 08:11:19 2008 -0600
    dinput: Default value for unassigned POVs should be -1.

commit b92d1c7fbef30114b3aa7f3197a5df3556c98b12
Author: Paul Vriens <paul.vriens.wine at gmail.com>
Date:   Thu May 8 15:06:53 2008 +0200
    crypt32/tests: Cleanup registry after tests.

commit 5714c4deee6f3c0cc30098d056fa4ce39a333878
Author: Alexandre Julliard <julliard at winehq.org>
Date:   Thu May 8 11:12:03 2008 +0200
    user32: The client rectangle is in screen coordinates for the 
    initial WM_NCCALCSIZE.

commit 09cb415109447c4be086f1c756f8a168628457f7
Author: Guy Albertelli <galberte at neo.rr.com>
Date:   Thu May 8 00:46:38 2008 -0400
    listview: Return correct value from WM_NOTIFYFORMAT with test.

commit 864e24d2e586b796c2069576ca6d8fe4e7b8cef7
Author: Maarten Lankhorst <m.b.lankhorst at gmail.com>
Date:   Wed May 7 16:31:02 2008 -0700
    kernel32: Fix temporary path test.

commit db8e63af27b75d098db6f9a61a6fb0ab7d70d83f
Author: Maarten Lankhorst <m.b.lankhorst at gmail.com>
Date:   Wed May 7 15:44:48 2008 -0700
    kernel32: Fix process tests to pass in Windows.

commit fd7b277d8ac23706b1c819d2ed1fd0ee9833fd06
Author: Maarten Lankhorst <m.b.lankhorst at gmail.com>
Date:   Tue May 6 15:06:17 2008 -0700
    rpcrt4: Fix ndr_marshall test failures.
    Created with help from Robert Shearman.

commit 51c28a1493c844eff4f4625d3398da5ee5d707fd
Author: Dmitry Timoshkov <dmitry at codeweavers.com>
Date:   Wed May 7 20:34:36 2008 +0900
    gdi32: More carefully compare EMF records in tests.

commit 3da466a9f75076f618a5440805cd211a98c7b628
Author: Kai Blin <kai.blin at gmail.com>
Date:   Wed May 7 12:35:06 2008 +0200
    secur32: Fix ntlm tests on Vista.

commit 02c66c2312d9bf98d0fc0d5d4ce56b8564718026
Author: Rob Shearman <rob at codeweavers.com>
Date:   Wed May 7 11:11:09 2008 +0100
    rpcrt4: Add better traces for the server test.
    Handle failure to use one or more protocol sequences more 
    gracefully, as ncacn_np servers aren't support on Win9x and 
    ncacn_ip_tcp fails on some machines.

commit 473717fefd06650e1e8d80c8dc0e16ab583cc673
Author: Detlef Riekenberg <wine.dev at web.de>
Date:   Tue May 6 20:26:05 2008 +0200
    winspool: Set PrinterPorts for win3.x/win9.x compatibility.

commit 7c051f13941b15bd0a399431e36cae16b8fe092e
Author: Maarten Lankhorst <m.b.lankhorst at gmail.com>
Date:   Tue May 6 14:14:56 2008 -0700
    winetest: Fix CreateProcess so that debugger tests run without 
    timing out.

commit deee97d9eaa7dfe28a9e39f288c3c7ed39f6e7c8
Author: Paul Vriens <paul.vriens.wine at gmail.com>
Date:   Tue May 6 18:08:09 2008 +0200
    advapi32/tests: Add another test.

commit 6477a1c1bfd7966ff75b6847156a765ec088b0b3
Author: Alexandre Julliard <julliard at winehq.org>
Date:   Tue May 6 15:54:07 2008 +0200
    kernel32: Set the USERPROFILE and ALLUSERSPROFILE environment 
    variables based on the ProfileList registry keys.

commit c4d75213abe21dcd7697d2f9151a186ebb3f8c8d
Author: Alexander Dorofeyev <alexd4 at inbox.lv>
Date:   Tue May 6 00:49:34 2008 +0300
    ddraw/tests: Add tests for IDirect3DDevice7_Load.


I'm ignoring wininet and ntdll changes because they don't run due to 
missing imports.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
          tcA thgirypoC muinelliM latigiD eht detaloiv tsuj evah uoY


From amorozov at etersoft.ru  Thu May 22 05:10:02 2008
From: amorozov at etersoft.ru (Alexander Morozov)
Date: Thu, 22 May 2008 14:10:02 +0400
Subject: unknown device issues after running winetest
In-Reply-To: <4832D2C4.5060606@gmail.com>
References: <4832D2C4.5060606@gmail.com>
Message-ID: <200805221410.02870.amorozov@etersoft.ru>

? ????????? ?? Tuesday 20 May 2008 17:31:48 Paul Vriens ???????(?):
> Hi,
>
> On several windows boxes (VMware) I receive this nice message that Windows
> will try to find a driver for an unknown device.
>
> This device is added by the setupapi/devinst test and is not (or can't be?)
> properly removed after the tests.
>
> On NT/W2K I'm able to delete all the relevant registry keys (regedt32.exe)
> but on Vista I don't seem to be able to delete them
>
> Any idea? Do others have the same issue(s) ?

Hi,

I added testRegisterAndGetDetail and testDeviceRegistryPropertyA/W. I am sorry 
for creating discussed problem. I tried to use SetupDiRemoveDeviceInterface, 
SetupDiRemoveDevice and SetupDiDeleteDevRegKey but this is not fixing this 
bug. SetupDiRemoveDevice and SetupDiDeleteDevRegKey do not delete 
Enum/ROOT/LEGACY_BOGUS key (on WinXP at least). Now I do not know the right 
way to delete created keys. May be should use something like Paul Vriens`s 
change_reg_permissions.


From amorozov at etersoft.ru  Thu May 22 05:49:33 2008
From: amorozov at etersoft.ru (Alexander Morozov)
Date: Thu, 22 May 2008 14:49:33 +0400
Subject: unknown device issues after running winetest
In-Reply-To: <200805221410.02870.amorozov@etersoft.ru>
References: <4832D2C4.5060606@gmail.com>
	<200805221410.02870.amorozov@etersoft.ru>
Message-ID: <200805221449.33430.amorozov@etersoft.ru>

I was mistaken. Enum/ROOT/LEGACY_BOGUS key can be deleted so:

SetLastError(0xdeadbeef);
set = pSetupDiGetClassDevsA(&guid, NULL, 0, 0);
ok(set != INVALID_HANDLE_VALUE, "SetupDiGetClassDevsA failed: %08x\n", 
GetLastError());
SetLastError(0xdeadbeef);
ret = pSetupDiEnumDeviceInfo(set, 0, &devInfo);
ok(ret, "SetupDiEnumDeviceInfo failed: %08x\n", GetLastError());
if (pSetupDiRemoveDevice)
{
    SetLastError(0xdeadbeef);
    ret = pSetupDiRemoveDevice(set, &devInfo);
    todo_wine
    ok(ret, "SetupDiRemoveDevice failed: %08x\n", GetLastError());
}
else
    skip("SetupDiRemoveDevice is not available\n");
pSetupDiDestroyDeviceInfoList(set);


From paul.vriens.wine at gmail.com  Thu May 22 05:52:30 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 22 May 2008 12:52:30 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <200805221410.02870.amorozov@etersoft.ru>
References: <4832D2C4.5060606@gmail.com>
	<200805221410.02870.amorozov@etersoft.ru>
Message-ID: <4835506E.20105@gmail.com>

Alexander Morozov wrote:
> ? ????????? ?? Tuesday 20 May 2008 17:31:48 Paul Vriens ???????(?):
>> Hi,
>>
>> On several windows boxes (VMware) I receive this nice message that Windows
>> will try to find a driver for an unknown device.
>>
>> This device is added by the setupapi/devinst test and is not (or can't be?)
>> properly removed after the tests.
>>
>> On NT/W2K I'm able to delete all the relevant registry keys (regedt32.exe)
>> but on Vista I don't seem to be able to delete them
>>
>> Any idea? Do others have the same issue(s) ?
> 
> Hi,
> 
> I added testRegisterAndGetDetail and testDeviceRegistryPropertyA/W. I am sorry 
> for creating discussed problem. I tried to use SetupDiRemoveDeviceInterface, 
> SetupDiRemoveDevice and SetupDiDeleteDevRegKey but this is not fixing this 
> bug. SetupDiRemoveDevice and SetupDiDeleteDevRegKey do not delete 
> Enum/ROOT/LEGACY_BOGUS key (on WinXP at least). Now I do not know the right 
> way to delete created keys. May be should use something like Paul Vriens`s 
> change_reg_permissions.
> 
> 
Can someone confirm that after running the devinst tests, the registry on Wine 
still shows these:

HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\ROOT\LEGACY_BOGUS (and stuff below)

HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\USB\BOGUS (and stuff below)

HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\DeviceClasses\{6A55B5A4-3F65-11DB-B704-0011955C2BDB} 
(and stuff below)

If I run 'make devinst.ok' on a clean .wine the tests succeed but leave the 
above registry keys behind.

As the new tests will include several checks about leftover registry keys this 
can be confusing.

If someone can confirm my 'findings' we probably first have to fix setupapi. I 
don't think we should mimic Windows by leaving these registry keys around as I 
think our tests don't do the 'normal' thing when adding devices.

-- 
Cheers,

Paul.


From paul.vriens.wine at gmail.com  Thu May 22 05:57:23 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 22 May 2008 12:57:23 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <200805221449.33430.amorozov@etersoft.ru>
References: <4832D2C4.5060606@gmail.com>	<200805221410.02870.amorozov@etersoft.ru>
	<200805221449.33430.amorozov@etersoft.ru>
Message-ID: <48355193.5010806@gmail.com>

Alexander Morozov wrote:
> I was mistaken. Enum/ROOT/LEGACY_BOGUS key can be deleted so:
> 
> SetLastError(0xdeadbeef);
> set = pSetupDiGetClassDevsA(&guid, NULL, 0, 0);
> ok(set != INVALID_HANDLE_VALUE, "SetupDiGetClassDevsA failed: %08x\n", 
> GetLastError());
> SetLastError(0xdeadbeef);
> ret = pSetupDiEnumDeviceInfo(set, 0, &devInfo);
> ok(ret, "SetupDiEnumDeviceInfo failed: %08x\n", GetLastError());
> if (pSetupDiRemoveDevice)
> {
>     SetLastError(0xdeadbeef);
>     ret = pSetupDiRemoveDevice(set, &devInfo);
>     todo_wine
>     ok(ret, "SetupDiRemoveDevice failed: %08x\n", GetLastError());
> }
> else
>     skip("SetupDiRemoveDevice is not available\n");
> pSetupDiDestroyDeviceInfoList(set);
> 
> 
> 
I agree that we should use the appropriate setupapi calls stuff to remove stuff.

I however already found some cases were that won't work. So in the end it will 
most likely be a mix of setupapi calls and manual registry key deletion.

-- 
Cheers,

Paul.


From julliard at winehq.org  Thu May 22 06:24:19 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 22 May 2008 13:24:19 +0200
Subject: kernel32:Fix a test that fails for all platforms
In-Reply-To: <22821af30805212016y5f9941d5l822dad4d19c8996@mail.gmail.com>
	(James Hawkins's message of "Wed, 21 May 2008 22:16:13 -0500")
References: <22821af30805212016y5f9941d5l822dad4d19c8996@mail.gmail.com>
Message-ID: <87ve16shss.fsf@wine.dyndns.org>

"James Hawkins" <jhawkins at codeweavers.com> writes:

> If you don't like this version, let me know.  The other option is to
> convert any forwards slashes in the result string to backslashes.

This should most likely be fixed in winetest.

-- 
Alexandre Julliard
julliard at winehq.org


From wine at mkarcher.dialup.fu-berlin.de  Thu May 22 07:52:14 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Thu, 22 May 2008 14:52:14 +0200
Subject: ole32/tests: Add a trailing '\n' to ok() calls.
In-Reply-To: <alpine.DEB.1.10.0805221037360.20572@amboise.dolphin>
References: <alpine.DEB.1.10.0805221037360.20572@amboise.dolphin>
Message-ID: <1211460734.9165.103.camel@hermes2.karcher.local>

Am Donnerstag, den 22.05.2008, 10:37 +0200 schrieb Francois Gouget:
> -  ok(len == 39, "len: %d (expected 39)",len);
> +  ok(len == 39, "len: %d (expected 39)\n", len);
[and so on]

You are right. This was missing from my patch that got applied. I sent
an updated version one hour later[1] (got through moderation 6 hours
later or so), which does
 - Include the missing "\n" characters
 - Makes this function indented like the others in ole32/tests/compobj.c
 - Test another case that wine gets wrong (with todo_wine)

In direct sucession[2], I sent a patch which corrects the problem in
wine and removes the todo_wine from the testcase again. I did it that
way to seperate the two patches, still preventing the testsuite to show
an additional failure.

Was something wrong with the way I handled the first not-that-good patch
(apart from sending it with the missing new lines at all, of course)?

Regards,
  Michael Karcher

[1]: <1211272286.9165.17.camel at hermes2.karcher.local>
[2]: <1211268226.9165.13.camel at hermes2.karcher.local>




From paul at astro.gla.ac.uk  Thu May 22 07:53:50 2008
From: paul at astro.gla.ac.uk (Paul Millar)
Date: Thu, 22 May 2008 14:53:50 +0200
Subject: Winetest broken on Win98
In-Reply-To: <alpine.DEB.1.10.0805221054470.20572@amboise.dolphin>
References: <alpine.DEB.1.10.0805221054470.20572@amboise.dolphin>
Message-ID: <200805221453.50837.paul@astro.gla.ac.uk>

On Thursday 22 May 2008 12:06:58 Francois Gouget wrote:
> Alternatively, where's the lastest version of w32api with d3dx9_36?

The patches (against w32api v3.8) are available here:
	
http://www.astro.gla.ac.uk/%7Epaulm/Cross/mingw-w32api-patches-2008-05-22.tar.gz

HTH,

Paul.


From julliard at winehq.org  Thu May 22 09:43:02 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 22 May 2008 16:43:02 +0200
Subject: Winetest broken on Win98
In-Reply-To: <alpine.DEB.1.10.0805221054470.20572@amboise.dolphin> (Francois
	Gouget's message of "Thu, 22 May 2008 12:06:58 +0200 (CEST)")
References: <alpine.DEB.1.10.0805221054470.20572@amboise.dolphin>
Message-ID: <87iqx6s8ll.fsf@wine.dyndns.org>

Francois Gouget <fgouget at free.fr> writes:

> Unfortunately the list of potential suspects is quite long. It would 
> help if I could at least cross-build winetest but I always get errors 
> (e.g. due to d3dx9_36). What happened to the resolution to get rid of 
> the dependency on MinGW libraries?

It's still the plan, but the obvious fix doesn't quite work because of
MinGW's broken atexit() handling. I need to spend some more time on
this.

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Thu May 22 09:55:31 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 22 May 2008 16:55:31 +0200
Subject: ddraw: Fixed last part of regression bug #13277
In-Reply-To: <200805221617.26275.jens@albretsen.dk>
References: <200805221617.26275.jens@albretsen.dk>
Message-ID: <200805221655.31552.stefan@codeweavers.com>

Am Donnerstag, 22. Mai 2008 16:17:26 schrieb Jens Albretsen:
> Changelog:
> d3d1-7 surfaces was not ref counting ddraw so if there was surface and
> ddraw was released, wine would kill everything. Now the Return to
> Mysterious Island works and does a clean exit afterwards.
I think the patch is wrong. There's a test that shows that this is not 
happening. If it doen't break any existing tests, please add a test to 
demonstrate that the change is correct


From jens at albretsen.dk  Thu May 22 12:17:34 2008
From: jens at albretsen.dk (Jens Albretsen)
Date: Thu, 22 May 2008 19:17:34 +0200
Subject: ddraw: Fixed last part of regression bug #13277
In-Reply-To: <200805221655.31552.stefan@codeweavers.com>
References: <200805221617.26275.jens@albretsen.dk>
	<200805221655.31552.stefan@codeweavers.com>
Message-ID: <200805221917.34441.jens@albretsen.dk>

On Thursday 22 May 2008 16:55:31 Stefan D?singer wrote:
> Am Donnerstag, 22. Mai 2008 16:17:26 schrieb Jens Albretsen:
> > Changelog:
> > d3d1-7 surfaces was not ref counting ddraw so if there was surface and
> > ddraw was released, wine would kill everything. Now the Return to
> > Mysterious Island works and does a clean exit afterwards.
>
> I think the patch is wrong. 
Well, as remember this the normal procedure of d3d, textures, surfaces and 
streams is to hold on to ddraw/d3d until everything is destroyed or the 
process is terminated.

Anyway I thought that the idea about fixing regressions is to fix them for 
1.0?

> There's a test that shows that this is not happening. 

Ehh, where?
I see no test doing the following
1. DirectDrawCreate
2. CreateSurface
3. Release DirectDrawObject from 1
4. Use the surface
5. Release surface to release ddraw

> If it doen't break any existing tests, please add a test to demonstrate 
> that the change is correct 

I will.




From stefandoesinger at gmx.at  Thu May 22 13:08:57 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Thu, 22 May 2008 20:08:57 +0200
Subject: ddraw: Fixed last part of regression bug #13277
In-Reply-To: <200805221917.34441.jens@albretsen.dk>
References: <200805221617.26275.jens@albretsen.dk>
	<200805221655.31552.stefan@codeweavers.com>
	<200805221917.34441.jens@albretsen.dk>
Message-ID: <200805222008.57466.stefandoesinger@gmx.at>

Am Donnerstag, 22. Mai 2008 19:17:34 schrieb Jens Albretsen:
> Well, as remember this the normal procedure of d3d, textures, surfaces and
> streams is to hold on to ddraw/d3d until everything is destroyed or the
> process is terminated.
DirectDraw 7 does this, but DirectDraw (1) doesn't

> Anyway I thought that the idea about fixing regressions is to fix them for
> 1.0?
Yes, but we can't fix them in an incorrect way. What happens to fix one app 
could break other apps

> Ehh, where?
> I see no test doing the following
> 1. DirectDrawCreate
> 2. CreateSurface
> 3. Release DirectDrawObject from 1
> 4. Use the surface
> 5. Release surface to release ddraw
I think I once wrote a test that does this:
DirectDrawCreate
CreateSurface
DirectDraw_AddRef
ref = DirectDraw_Release
ok(ref == 1)

of course even if CreateSurface doesn't addref the publically visible 
refcount, it could still hold some internal reference to prevent the ddraw 
object from beeing destroyed. If that's the case, we need an additional test 
showing that the ddraw object survives even though it has ref 0


From jens at albretsen.dk  Thu May 22 13:37:17 2008
From: jens at albretsen.dk (Jens Albretsen)
Date: Thu, 22 May 2008 20:37:17 +0200
Subject: ddraw: Fixed last part of regression bug #13277
In-Reply-To: <200805222008.57466.stefandoesinger@gmx.at>
References: <200805221617.26275.jens@albretsen.dk>
	<200805221917.34441.jens@albretsen.dk>
	<200805222008.57466.stefandoesinger@gmx.at>
Message-ID: <200805222037.17871.jens@albretsen.dk>

On Thursday 22 May 2008 20:08:57 you wrote:
> Am Donnerstag, 22. Mai 2008 19:17:34 schrieb Jens Albretsen:
> > Well, as remember this the normal procedure of d3d, textures, surfaces
> > and streams is to hold on to ddraw/d3d until everything is destroyed or
> > the process is terminated.
>
> DirectDraw 7 does this, but DirectDraw (1) doesn't
>
> > Anyway I thought that the idea about fixing regressions is to fix them
> > for 1.0?
>
> Yes, but we can't fix them in an incorrect way. What happens to fix one app
> could break other apps
>
> > Ehh, where?
> > I see no test doing the following
> > 1. DirectDrawCreate
ref=1, myref=1
> > 2. CreateSurface
ref=1. myref=2
> > 3. Release DirectDrawObject from step 1
ref=0(release ddraw), myref=1
> > 4. Use the surface
crash, myref=1
> > 5. Release surface to release ddraw
dead, myref=0(release ddraw)
You're sure this is not the correct ddraw behavior, I have no way of testing 
this at home, only got windows at work.

> I think I once wrote a test that does this:
> DirectDrawCreate		
ref=1, myref=1
> CreateSurface
ref=1, myref=2
> DirectDraw_AddRef
ref=2, myref=3
> ref = DirectDraw_Release
ref=1, myref=2
> ok(ref == 1)
So this does'nt really get directdraw object released

> of course even if CreateSurface doesn't addref the publically visible
> refcount, it could still hold some internal reference to prevent the ddraw
> object from beeing destroyed. If that's the case, we need an additional
> test showing that the ddraw object survives even though it has ref 0

So what you're saying I should not use the public visible refcount and add a 
internal AddRef/Release so surfaces can keep ddraw alive this way.



From jens at albretsen.dk  Thu May 22 13:56:15 2008
From: jens at albretsen.dk (Jens Albretsen)
Date: Thu, 22 May 2008 20:56:15 +0200
Subject: ddraw: Fixed last part of regression bug #13277
In-Reply-To: <200805222037.17871.jens@albretsen.dk>
References: <200805221617.26275.jens@albretsen.dk>
	<200805222008.57466.stefandoesinger@gmx.at>
	<200805222037.17871.jens@albretsen.dk>
Message-ID: <200805222056.15669.jens@albretsen.dk>

<< snip >>

> > of course even if CreateSurface doesn't addref the publically visible
> > refcount, it could still hold some internal reference to prevent the
> > ddraw object from beeing destroyed. If that's the case, we need an
> > additional test showing that the ddraw object survives even though it has
> > ref 0
>
> So what you're saying I should not use the public visible refcount and add
> a internal AddRef/Release so surfaces can keep ddraw alive this way.

Stefan can I use the numIfaces variable instead, it seems like an internal 
refcount for the directdraw interfaces and since directdrawsurface is a 
interface it would make sense or should I make yet another ref counter.

/Jens



From juan.lang at gmail.com  Thu May 22 14:48:14 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Thu, 22 May 2008 12:48:14 -0700
Subject: [rsaenh] don't throw error on salt with more that 128bit
Message-ID: <3a768c550805221248m6894995y4a480a40d17df6b1@mail.gmail.com>

-            /* salt length can't be greater than 128 bits = 16 bytes */
-            if (blob->cbData > 16)
-            {
-                SetLastError(ERROR_INVALID_PARAMETER);
-                return FALSE;
-            }
             memcpy(pCryptKey->abKeyValue + pCryptKey->dwKeyLen, blob->pbData,
                    blob->cbData);

You can't just remove the check, an app that passes in a bad blob will
overwrite memory.  If that's not allowed in Windows, it shouldn't be
in Wine, either.  You really need to write a test case that shows what
the correct limit for the salt length is, or show that Windows just
crashes if you pass in too much salt data.  That'll prevent future
regressions from cropping up, too.
--Juan


From alexd4 at inbox.lv  Thu May 22 14:46:03 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Thu, 22 May 2008 22:46:03 +0300
Subject: ddraw: Fixed in part regression bug #13277
In-Reply-To: <200805221534.12656.jens@albretsen.dk>
References: <200805221534.12656.jens@albretsen.dk>
Message-ID: <4835CD7B.8010801@inbox.lv>

Jens Albretsen wrote:
> Changelog:
> 
> Fixed Failure when texture was loading onto itself.
> Fixes in part d3d7 regression bug #13277.
> Still need to find a way to make d3d7 stay alive after the game releases the 
> interface.
> 

Did you check what native does when asked to Load texture from itself? Is it 
D3D_OK or maybe something like INVALIDCALL? There already should be a few tests 
for IDirect3DTexture_Load in ddraw/tests/d3d.c so you can add a few lines there 
that test this.


From jens at albretsen.dk  Thu May 22 16:42:01 2008
From: jens at albretsen.dk (Jens Albretsen)
Date: Thu, 22 May 2008 23:42:01 +0200
Subject: ddraw: Fixed in part regression bug #13277
In-Reply-To: <4835CD7B.8010801@inbox.lv>
References: <200805221534.12656.jens@albretsen.dk> <4835CD7B.8010801@inbox.lv>
Message-ID: <200805222342.01574.jens@albretsen.dk>

On Thursday 22 May 2008 21:46:03 Alexander Dorofeyev wrote:
> Jens Albretsen wrote:
> > Changelog:
> >
> > Fixed Failure when texture was loading onto itself.
> > Fixes in part d3d7 regression bug #13277.
> > Still need to find a way to make d3d7 stay alive after the game releases
> > the interface.
>
> Did you check what native does when asked to Load texture from itself? Is
> it D3D_OK or maybe something like INVALIDCALL? 

I have no way of testing what is does native? Only got windows at work. 
However I can see that the game expects to be allowed to copy the surface, so 
I must presume that windows is doing the same else the game would not run 
under windows. Anyway it makes sense that it is ok to load textureA into 
textureA, it would make no difference to textureA. 

> There already should be a few tests for IDirect3DTexture_Load in
> ddraw/tests/d3d.c so you can add a few lines there that test this. 

I've added a simple test

/Jens


From austinenglish at gmail.com  Thu May 22 16:39:33 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 22 May 2008 16:39:33 -0500
Subject: ddraw: Fixed in part regression bug #13277
In-Reply-To: <200805222342.01574.jens@albretsen.dk>
References: <200805221534.12656.jens@albretsen.dk> <4835CD7B.8010801@inbox.lv>
	<200805222342.01574.jens@albretsen.dk>
Message-ID: <b6bb06270805221439y45f05aabj28a50a7e91b24211@mail.gmail.com>

On 5/22/08, Jens Albretsen <jens at albretsen.dk> wrote:
> I have no way of testing what is does native? Only got windows at work.

If you need something tested on windows, or on a specific
version/locale you don't have access to, send a test app to wine-users
or wine-devel asking for testers. Odds are *someone* has the
configuration needed and time to do it.


From boaz at electrozaur.com  Wed May 21 11:11:43 2008
From: boaz at electrozaur.com (Boaz Harrosh)
Date: Wed, 21 May 2008 19:11:43 +0300
Subject: Thunderbird warning repeat - use --attach
In-Reply-To: <48344245.5020408@codeweavers.com>
References: <48344245.5020408@codeweavers.com>
Message-ID: <483449BF.100@electrozaur.com>

Jeremy White wrote:
> So it seems as though every month or so, some id10t is bit by
> the Thunderbird bug where it mangles perfectly reasonable looking
> git-format-patch drafts.
> 
> This month, I won the prize! :-)
> 
> I had always habitually done --attach, because that's what GitWine says to do.
> But after scratching my head, reading man pages, and
> checking my drafts, I decided that was lame; inline is always nicer, and
> I dropped the --attach.  Big mistake; the draft may look okay, but the end result
> is mangled somehow.
> 
> Thanks to Dmitry for alerting me.
> 
> I've filed a bug with Mozilla over this:
>    https://bugzilla.mozilla.org/show_bug.cgi?id=435020
> 
> My sense is that its a subtle bug of some kind; I've had a hard
> time articulating a strategy to reproduce it (which, by Occam's
> razor, immediately suggests I'm just missing something :-/).
> 
> So if others are bit by this and can share any clues or tips
> for the Mozilla devs on how to reproduce it, I'd appreciate it.
> 
> Cheers,
> 
> Jeremy
> 

It's a known issue with Thunderbird and git. you need to set
mailnews.send_plaintext_flowed = false
and 
mailnews.wraplength = 0

Cheers 
Boaz


From msclrhd at googlemail.com  Wed May 21 12:19:38 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 21 May 2008 18:19:38 +0100
Subject: Crosstests - Too large of log files?
In-Reply-To: <b6bb06270805211011w45a0c53bu6145b78745c654d1@mail.gmail.com>
References: <b6bb06270805211011w45a0c53bu6145b78745c654d1@mail.gmail.com>
Message-ID: <3f4fd2640805211019g1f09c45p8f5867e5622316c6@mail.gmail.com>

2008/5/21 Austin English <austinenglish at gmail.com>:
> In the past 2 days, when running the cross tests on my work XP box, I
> keep getting an error that the log file is too big (1.6 Mb > 1.5 Mb
> max). Anyone else seeing this? It's submitting partial reports, which
> may or may not be useful. Can we get some compression going, or
> increase the max log size?

The same thing has been happening for the Vista tests, ever since
Vista tests were being run.

It would be nice to have complete test results for these platforms!

Compression would be the best option, as this would improve network
data traffic.

- Reece


From msclrhd at googlemail.com  Wed May 21 13:45:30 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Wed, 21 May 2008 19:45:30 +0100
Subject: Crosstests - Too large of log files?
In-Reply-To: <b6bb06270805211044q68f2eeacwf8afcd281eb5e6ef@mail.gmail.com>
References: <b6bb06270805211011w45a0c53bu6145b78745c654d1@mail.gmail.com>
	<48345E66.2010705@gmail.com>
	<b6bb06270805211044q68f2eeacwf8afcd281eb5e6ef@mail.gmail.com>
Message-ID: <3f4fd2640805211145n7bace3d6wc67687d04d25c5d6@mail.gmail.com>

2008/5/21 Austin English <austinenglish at gmail.com>:
> On Wed, May 21, 2008 at 12:39 PM, Paul Vriens
> <paul.vriens.wine at gmail.com> wrote:
>> Austin English wrote:
>>>
>>> In the past 2 days, when running the cross tests on my work XP box, I
>>> keep getting an error that the log file is too big (1.6 Mb > 1.5 Mb
>>> max). Anyone else seeing this? It's submitting partial reports, which
>>> may or may not be useful. Can we get some compression going, or
>>> increase the max log size?
>>>
>>> -Austin
>>>
>>>
>>>
>> I guess in your particular case it's due to the shlwapi/istream test and the
>> gdi32/font test.
>>
>> The shlwapi/istream just has a lot of failures.
> Thanks, hadn't investigated the reason yet. The question is why am I
> the only XP box seeing this? Hmm. FWIW, IE6, SP2. I can upgrade
> either, just haven't found a need for it...

Do you have the file "c:\test.txt" lying around on that machine? If
so, could you delete it and rerun the shlwapi:istream tests?

>> I mentioned compression a few months ago and got some positive replies. We
>> now only needs someone how implements this in winetest and at the backend.
> In the meantime, increasing the log size a little bit would help to
> get complete reports in for Vista. Reece, how big are the Vista log
> files?

I don't currently have a test run on Vista to hand. From what I
remember, though, it was around 1.6/1.7M.

- Reece


From dank at kegel.com  Wed May 21 18:44:33 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 21 May 2008 16:44:33 -0700
Subject: Adding d3d9x_xx dlls to winetricks?
In-Reply-To: <200805211040.09714.stefandoesinger@gmx.at>
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
	<d658b69e0805210041j1234c4b7y246f32435dafe29a@mail.gmail.com>
	<53e3a9930805210127r70391638l7434b624ed52f42f@mail.gmail.com>
	<200805211040.09714.stefandoesinger@gmx.at>
Message-ID: <a71bd89a0805211644s15650a30jd9b5a74ef5bae311@mail.gmail.com>

On Wed, May 21, 2008 at 1:40 AM, Stefan D?singer <stefandoesinger at gmx.at> wrote:
> I think the proper thing to do is to install the DirectX runtime /
> redistributable. It installs all the DLLs and registers them in the registry
> etc.

Suits me.  How's this look?   I just threw in a guess at
the dll overrides, I'm hoping you will have something to say there.
- Dan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: winetricks
Type: application/octet-stream
Size: 53387 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080521/1cfda26f/attachment-0001.obj 

From petr.dlouhy at email.cz  Thu May 22 06:07:53 2008
From: petr.dlouhy at email.cz (=?iso-8859-2?Q?Petr_Dlouh=FD?=)
Date: Thu, 22 May 2008 13:07:53 +0200
Subject: stub implementation of GdipImageGetFrameDimensionsCount
Message-ID: <op.ubjyjfbfcr5wbu@petr>

Hello,

I want to ask, why my patch  
(http://www.winehq.org/pipermail/wine-patches/2008-May/054973.html) didn't  
get committed?

-- 
Petr Dlouh?


From jens at albretsen.dk  Thu May 22 17:16:39 2008
From: jens at albretsen.dk (Jens Albretsen)
Date: Fri, 23 May 2008 00:16:39 +0200
Subject: ddraw: Fixed in part regression bug #13277
In-Reply-To: <b6bb06270805221456j333e79ccqb9fcbdb2b858e3b1@mail.gmail.com>
References: <200805221534.12656.jens@albretsen.dk>
	<200805230001.28461.jens@albretsen.dk>
	<b6bb06270805221456j333e79ccqb9fcbdb2b858e3b1@mail.gmail.com>
Message-ID: <200805230016.39280.jens@albretsen.dk>

On Thursday 22 May 2008 23:56:42 you wrote:
> I don't have a compiler on my windows box, nor do I have cross
> development tools on my linux box, but if you get me an exe I can test
> on win xp (nvidia 7200 GT) or 2k (intel 865, or a variety of other
> boxes).
>
> -Austin
I have the same problem, I have absolutely no M$ stuff at home.
I'm pretty sure what I did is correct, since like I said the game works on 
windows and now it also does in wine. Before wine was crashing so it can only 
be better. And next time someone runs the test on the M$ platforms we'll see 
if the test fails or what? Anyway without the patch we just get a crash.

> On 5/22/08, Jens Albretsen <jens at albretsen.dk> wrote:
> > On Thursday 22 May 2008 23:39:33 you wrote:
> >> On 5/22/08, Jens Albretsen <jens at albretsen.dk> wrote:
> >> > I have no way of testing what is does native? Only got windows at
> >> > work.
> >>
> >> If you need something tested on windows, or on a specific
> >> version/locale you don't have access to, send a test app to wine-users
> >> or wine-devel asking for testers. Odds are *someone* has the
> >> configuration needed and time to do it.
> >
> > Anyone who want to apply the patches I did and do a "make test" of
> > dlls/ddraw
> > on windows?




From m.b.lankhorst at gmail.com  Thu May 22 17:14:35 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Thu, 22 May 2008 15:14:35 -0700
Subject: Winetest broken on Win98
In-Reply-To: <alpine.DEB.1.10.0805221054470.20572@amboise.dolphin>
References: <alpine.DEB.1.10.0805221054470.20572@amboise.dolphin>
Message-ID: <b130c85e0805221514w2d07c5a3pa90b315f51a4f77@mail.gmail.com>

Hello Francois,

2008/5/22 Francois Gouget <fgouget at free.fr>:
>
> So if anyone has been wondering why I don't run the tests on Win98
> anymore... I still do! The problem is that since 2008/05/08 something
> prevents winetest from submitting the results.
>
> The 200805062030 winetest build works fine so that leaves a two/three
> days window where things went wrong. Unfortunately I have been unable to
> pinpoint a specific test that causes the problem.
>
> Here's a log I generated with the 200805211000 build:
> http://fgouget.free.fr/tmp/winetest.log
>
> I let winetest run for 90 minutes (normally it's over in about 15), then
> Windows was frozen, not responding to Ctrl-Alt-Del, using all the CPU
> and I had to hit VMware's reset button.
>
> The last test that was run is setupapi:parser, but according to the log
> it completed fine, and I can run it by hand just fine. Still according
> to the log the next test did not even start.
>
>
> Unfortunately the list of potential suspects is quite long. It would
> help if I could at least cross-build winetest but I always get errors
> (e.g. due to d3dx9_36). What happened to the resolution to get rid of
> the dependency on MinGW libraries? Alternatively, where's the lastest
> version of w32api with d3dx9_36?

You can build mingw using wine headers.

If you have a ${GIT_TREE} with the sources, and a compiled ${LINUX_TREE} :

pwd to an empty directory (${MINGW_TREE}) to build mingw in:

Then do this:

cat > no_except.h << __EOF__
/* exceptions noop */
#define __try
#define __except(x) if (0)
#define __finally
#define _try
#define _except if (0)
#define _finally

__EOF__

"${GIT_TREE}/configure" --host=i586-mingw32msvc \
    --with-wine-tools="${LINUX_TREE}" --without-freetype --without-x

XCPPFLAGS="-include ${MINGW_TREE}/no_except.h -I$WINE_SRC/include "\
"-DUSE_COMPILER_EXCEPTIONS -DUSE_WIN32_OPENGL"

XLDFLAGS="-L ${MINGW_TREE}/libs -L ${MINGW_TREE}/libs/wine"

function imake {
    make LDFLAGS="${XLDFLAGS}" CPPFLAGS="${XCPPFLAGS}" $@
}

imake -C libs
imake -C include
imake -C dlls implib
cp -v dlls/*/*.a libs
rm -f libs/libmsvcrt.a # Use mingw msvcrt library

cd dlls
for testdir in */tests; do
    imake -C "${testdir}"
done
cd ..

imake -C programs/winetest

This was based on john klehm's script, but I had made some
modifcations to run it in an automated fashion with the rest of my
build scripts.

Cheers,
Maarten.


From dank at kegel.com  Thu May 22 17:16:17 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 22 May 2008 15:16:17 -0700
Subject: Alternate shell?
Message-ID: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>

For a maximal dogfood experience, I was looking around
for a way to use a replacement Windows shell with
Wine as my desktop environment instead of gnome
or kde.

So far, all the ones I've found are either broken, hard to use,
or just plain weird.

I've been working through the list at
http://www.dmoz.org/Computers/Software/Operating_Systems/Microsoft_Windows/Software/Alternate_Shells/

http://www.astonshell.com/aston/ - couldn't figure out how to run it?

http://www.emergedesktop.org/ - kind of works, but very minimal, no start menu

http://www.labyrinth.net.au/~mosses/rob/liteshell.html - works, but
very minimal, no start menu

http://purels.org - no help, just exits, saying "ha ha, you didn't
configure me".  Obviously not meant for me :-)

http://www.lighttek.com/talisman.htm - pretty, but no Programs menu?!
(Maybe that's there but broken, wine bug?)

http://www.sky.franken.de/explorer/download.html - ROS explorer -
prebuilt binary
there is 3 years out of date, doesn't work too well

Anyone have a favorite I should try?
- Dan


From alexd4 at inbox.lv  Thu May 22 17:15:40 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Fri, 23 May 2008 01:15:40 +0300
Subject: ddraw: Fixed in part regression bug #13277
In-Reply-To: <200805222342.01574.jens@albretsen.dk>
References: <200805221534.12656.jens@albretsen.dk> <4835CD7B.8010801@inbox.lv>
	<200805222342.01574.jens@albretsen.dk>
Message-ID: <4835F08C.1040102@inbox.lv>

Jens Albretsen wrote:
> I have no way of testing what is does native? Only got windows at work. 
> However I can see that the game expects to be allowed to copy the surface, so 
> I must presume that windows is doing the same else the game would not run 
> under windows. Anyway it makes sense that it is ok to load textureA into 
> textureA, it would make no difference to textureA. 
> 
>> There already should be a few tests for IDirect3DTexture_Load in
>> ddraw/tests/d3d.c so you can add a few lines there that test this. 
> 
> I've added a simple test

FWIW, the test seems to pass on native Windows XP for me.

Some games are sensetive to returned error values for all kinds of silly 
reasons, so it's best to double check these things.


From pgquiles at elpauer.org  Thu May 22 17:24:42 2008
From: pgquiles at elpauer.org (Pau Garcia i Quiles)
Date: Fri, 23 May 2008 00:24:42 +0200
Subject: Alternate shell?
In-Reply-To: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
Message-ID: <20080523002442.hnc8ffqn4g4k488g@www.elpauer.org>

Quoting Dan Kegel <dank at kegel.com>:

Wine + XPde (http://xpde.com) is probably the most Windows-resemblant  
environment I can think of. Sadly, XPde seems to be stalled.

> For a maximal dogfood experience, I was looking around
> for a way to use a replacement Windows shell with
> Wine as my desktop environment instead of gnome
> or kde.
>
> So far, all the ones I've found are either broken, hard to use,
> or just plain weird.
>
> I've been working through the list at
> http://www.dmoz.org/Computers/Software/Operating_Systems/Microsoft_Windows/Software/Alternate_Shells/
>
> http://www.astonshell.com/aston/ - couldn't figure out how to run it?
>
> http://www.emergedesktop.org/ - kind of works, but very minimal, no   
> start menu
>
> http://www.labyrinth.net.au/~mosses/rob/liteshell.html - works, but
> very minimal, no start menu
>
> http://purels.org - no help, just exits, saying "ha ha, you didn't
> configure me".  Obviously not meant for me :-)
>
> http://www.lighttek.com/talisman.htm - pretty, but no Programs menu?!
> (Maybe that's there but broken, wine bug?)
>
> http://www.sky.franken.de/explorer/download.html - ROS explorer -
> prebuilt binary
> there is 3 years out of date, doesn't work too well
>
> Anyone have a favorite I should try?
> - Dan
>
>
>



-- 
Pau Garcia i Quiles
http://www.elpauer.org
(Due to my workload, I may need 10 days to answer)



From austinenglish at gmail.com  Thu May 22 17:37:29 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 22 May 2008 17:37:29 -0500
Subject: Alternate shell?
In-Reply-To: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
Message-ID: <b6bb06270805221537k1a78dca7ka4c060ff13a6e02d@mail.gmail.com>

On Thu, May 22, 2008 at 5:16 PM, Dan Kegel <dank at kegel.com> wrote:
> For a maximal dogfood experience, I was looking around
> for a way to use a replacement Windows shell with
> Wine as my desktop environment instead of gnome
> or kde.
>
> So far, all the ones I've found are either broken, hard to use,
> or just plain weird.
>
> I've been working through the list at
> http://www.dmoz.org/Computers/Software/Operating_Systems/Microsoft_Windows/Software/Alternate_Shells/
>
> http://www.astonshell.com/aston/ - couldn't figure out how to run it?
>
> http://www.emergedesktop.org/ - kind of works, but very minimal, no start menu
>
> http://www.labyrinth.net.au/~mosses/rob/liteshell.html - works, but
> very minimal, no start menu
>
> http://purels.org - no help, just exits, saying "ha ha, you didn't
> configure me".  Obviously not meant for me :-)
>
> http://www.lighttek.com/talisman.htm - pretty, but no Programs menu?!
> (Maybe that's there but broken, wine bug?)
>
> http://www.sky.franken.de/explorer/download.html - ROS explorer -
> prebuilt binary
> there is 3 years out of date, doesn't work too well
>
> Anyone have a favorite I should try?
> - Dan
>
>
>

Could try Ulteo's Virtual desktop, to virtualize Linux inside Wine :-P
http://www.ulteo.com/home/en/virtualdesktop?autolang=en


From xixsimplicityxix at gmail.com  Thu May 22 18:02:22 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Thu, 22 May 2008 18:02:22 -0500
Subject: Alternate shell?
In-Reply-To: <b6bb06270805221537k1a78dca7ka4c060ff13a6e02d@mail.gmail.com>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
	<b6bb06270805221537k1a78dca7ka4c060ff13a6e02d@mail.gmail.com>
Message-ID: <78a7dad00805221602r73cdde16ie40cba07e6769f00@mail.gmail.com>

On Thu, May 22, 2008 at 5:37 PM, Austin English <austinenglish at gmail.com> wrote:
> On Thu, May 22, 2008 at 5:16 PM, Dan Kegel <dank at kegel.com> wrote:
>> For a maximal dogfood experience, I was looking around
>> for a way to use a replacement Windows shell with
>> Wine as my desktop environment instead of gnome
>> or kde.
>>
>> So far, all the ones I've found are either broken, hard to use,
>> or just plain weird.
>>
>> I've been working through the list at
>> http://www.dmoz.org/Computers/Software/Operating_Systems/Microsoft_Windows/Software/Alternate_Shells/
>>
>> http://www.astonshell.com/aston/ - couldn't figure out how to run it?
>>
>> http://www.emergedesktop.org/ - kind of works, but very minimal, no start menu
>>
>> http://www.labyrinth.net.au/~mosses/rob/liteshell.html - works, but
>> very minimal, no start menu
>>
>> http://purels.org - no help, just exits, saying "ha ha, you didn't
>> configure me".  Obviously not meant for me :-)
>>
>> http://www.lighttek.com/talisman.htm - pretty, but no Programs menu?!
>> (Maybe that's there but broken, wine bug?)
>>
>> http://www.sky.franken.de/explorer/download.html - ROS explorer -
>> prebuilt binary
>> there is 3 years out of date, doesn't work too well
>>
>> Anyone have a favorite I should try?
>> - Dan
>>
>>

I haven't tried these in awhile but they worked decently enough a
couple years ago on xp/2000

Blackbox window manager for windows
(dont worry desktop icon/system tray plugin is included by default)
http://www.bb4win.org/news.php

Litestep (highly customzieable, tons of plugins afterStep/NextStep clone)
http://www.lsdev.org/doku.php

--John


From dank at kegel.com  Thu May 22 18:16:27 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 22 May 2008 16:16:27 -0700
Subject: Alternate shell?
In-Reply-To: <78a7dad00805221602r73cdde16ie40cba07e6769f00@mail.gmail.com>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
	<b6bb06270805221537k1a78dca7ka4c060ff13a6e02d@mail.gmail.com>
	<78a7dad00805221602r73cdde16ie40cba07e6769f00@mail.gmail.com>
Message-ID: <a71bd89a0805221616n7bfff661v17e44d59ac363bc5@mail.gmail.com>

On Thu, May 22, 2008 at 4:02 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> Blackbox window manager for windows
> (dont worry desktop icon/system tray plugin is included by default)
> http://www.bb4win.org/news.php

Development stopped a couple years ago, even the forks look dormant

> Litestep (highly customzieable, tons of plugins afterStep/NextStep clone)
> http://www.lsdev.org/doku.php

LiteStep of any flavor just laughs at me, saying "Learn my language,
write a config file, then maybe I'll talk to you".

I did also just try SharpE, but it crashes and is just as inscrutable as any of
the others.
- Dan


From h.figge at gmx.de  Thu May 22 18:25:33 2008
From: h.figge at gmx.de (Hartmut Figge)
Date: Fri, 23 May 2008 01:25:33 +0200
Subject: Adding d3d9x_xx dlls to winetricks?
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>	<d658b69e0805210041j1234c4b7y246f32435dafe29a@mail.gmail.com>	<53e3a9930805210127r70391638l7434b624ed52f42f@mail.gmail.com>	<200805211040.09714.stefandoesinger@gmx.at>
	<a71bd89a0805211644s15650a30jd9b5a74ef5bae311@mail.gmail.com>
Message-ID: <483600ED.4020503@hfigge.myfqdn.de>

Dan Kegel:
>On Wed, May 21, 2008 at 1:40 AM, Stefan D?singer <stefandoesinger at gmx.at> wrote:

>> I think the proper thing to do is to install the DirectX runtime /
>> redistributable. It installs all the DLLs and registers them in the registry
>> etc.
>
>Suits me.  How's this look?

Well, my Seamonkey refuses to show the attachment. ;) Reason is
| Content-Type: application/octet-stream; name=winetricks

I have to copy the mail to another folder, close my SM and edit this
line manually to

Content-Type: text/plain; name=winetricks

After restarting my SM i am now able to read the attachment. Am i the
only one who suffers from application/octet-stream?

Hartmut



From xixsimplicityxix at gmail.com  Thu May 22 18:31:33 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Thu, 22 May 2008 18:31:33 -0500
Subject: Alternate shell?
In-Reply-To: <a71bd89a0805221616n7bfff661v17e44d59ac363bc5@mail.gmail.com>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
	<b6bb06270805221537k1a78dca7ka4c060ff13a6e02d@mail.gmail.com>
	<78a7dad00805221602r73cdde16ie40cba07e6769f00@mail.gmail.com>
	<a71bd89a0805221616n7bfff661v17e44d59ac363bc5@mail.gmail.com>
Message-ID: <78a7dad00805221631i5a49bae4jf59c2e0ae2415e22@mail.gmail.com>

On Thu, May 22, 2008 at 6:16 PM, Dan Kegel <dank at kegel.com> wrote:
> On Thu, May 22, 2008 at 4:02 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
>> Blackbox window manager for windows
>> (dont worry desktop icon/system tray plugin is included by default)
>> http://www.bb4win.org/news.php
>
> Development stopped a couple years ago, even the forks look dormant
>
>> Litestep (highly customzieable, tons of plugins afterStep/NextStep clone)
>> http://www.lsdev.org/doku.php
>
> LiteStep of any flavor just laughs at me, saying "Learn my language,
> write a config file, then maybe I'll talk to you".
>
> I did also just try SharpE, but it crashes and is just as inscrutable as any of
> the others.
> - Dan
>

I just tried the bb fork xoblite bb3 rc1 on server 2008 and it seems
to work alright.  The default menu generation looks a little off
(duplicate entries) but you can just edit the text file it makes
(listed right on the menu itself) other than that it seems to be
equivalent to start->programs.

No desktop icons by default though, Ill see if I can find a plugin
that does that.

--John


From susancragin at earthlink.net  Thu May 22 18:56:32 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Thu, 22 May 2008 19:56:32 -0400 (GMT-04:00)
Subject: Alternate shell?
Message-ID: <5404715.1211500593048.JavaMail.root@elwamui-polski.atl.sa.earthlink.net>

http://shellcity.net/cgi-bin/DB_Search/db_search.cgi?setup_file=topicpage.setup.cgi&submit_search=yes&topic=A
Don't forget this list.

-----Original Message-----
>From: Dan Kegel <dank at kegel.com>
>Sent: May 22, 2008 6:16 PM
>To: Wine Develop <wine-devel at winehq.org>
>Subject: Alternate shell?
>
>For a maximal dogfood experience, I was looking around
>for a way to use a replacement Windows shell with
>Wine as my desktop environment instead of gnome
>or kde.
>
>So far, all the ones I've found are either broken, hard to use,
>or just plain weird.
>
>I've been working through the list at
>http://www.dmoz.org/Computers/Software/Operating_Systems/Microsoft_Windows/Software/Alternate_Shells/
>
>http://www.astonshell.com/aston/ - couldn't figure out how to run it?
>
>http://www.emergedesktop.org/ - kind of works, but very minimal, no start menu
>
>http://www.labyrinth.net.au/~mosses/rob/liteshell.html - works, but
>very minimal, no start menu
>
>http://purels.org - no help, just exits, saying "ha ha, you didn't
>configure me".  Obviously not meant for me :-)
>
>http://www.lighttek.com/talisman.htm - pretty, but no Programs menu?!
>(Maybe that's there but broken, wine bug?)
>
>http://www.sky.franken.de/explorer/download.html - ROS explorer -
>prebuilt binary
>there is 3 years out of date, doesn't work too well
>
>Anyone have a favorite I should try?
>- Dan
>
>





From dank at kegel.com  Thu May 22 19:59:00 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 22 May 2008 17:59:00 -0700
Subject: Alternate shell?
In-Reply-To: <78a7dad00805221631i5a49bae4jf59c2e0ae2415e22@mail.gmail.com>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
	<b6bb06270805221537k1a78dca7ka4c060ff13a6e02d@mail.gmail.com>
	<78a7dad00805221602r73cdde16ie40cba07e6769f00@mail.gmail.com>
	<a71bd89a0805221616n7bfff661v17e44d59ac363bc5@mail.gmail.com>
	<78a7dad00805221631i5a49bae4jf59c2e0ae2415e22@mail.gmail.com>
Message-ID: <a71bd89a0805221759g3b6f567cwea27e4ea1c6a9859@mail.gmail.com>

On Thu, May 22, 2008 at 4:31 PM, John Klehm <xixsimplicityxix at gmail.com> wrote:
> I just tried the bb fork xoblite bb3 rc1 on server 2008 and it seems
> to work alright.

OK, now try it on Wine.  A recipe in the appdb would be nice.

I just built ROS explorer from source, and ran its explorer.exe.
It runs, and shows things like My Computer and desktop icons, and
shows a context menu on background.
Oddly, it doesn't show a Start menu.  Perhaps this is a bug in wine,
as the doc claims the start menu is there.

Here's the recipe, in case anyone else wants to try, adapted from
http://www.sky.franken.de/explorer/index.html#compile

sudo apt-get install mingw32
sudo ln -s i586-mingw32msvc-windres /usr/bin/windres
svn co svn://svn.reactos.org/reactos/trunk/reactos/base/shell/explorer
cd explorer
vi Makefile-MinGW
change three lines:
-CC = gcc
-CXX = g++
-LINK = g++
+CC = i586-mingw32msvc-gcc
+CXX = i586-mingw32msvc-g++
+LINK = i586-mingw32msvc-g++

make -f Makefile-MinGW

This fails because windres can't find windows.h.  I hacked around it like this:
 cd ~
 mkdir w32api
 cd w32api
 wget http://internap.dl.sourceforge.net/sourceforge/mingw/w32api-3.11.tar.gz
 tar -xzvf w32api-3.11.tar.gz
 cd ~/explorer
 windres -I ~/w32api/include/ -DWIN32 -D__WINDRES__ -DNDEBUG -DUNICODE
-o explorer.coff explorer_intres.r
 make -f Makefile-MinGW

And surprisingly, that built explorer.exe.

The menus are messed up (they contain garbage text), and
as I said earlier, there's no start menu.
- Dan


From winehacker at gmail.com  Thu May 22 20:09:49 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 22 May 2008 21:09:49 -0400
Subject: Alternate shell?
In-Reply-To: <a71bd89a0805221759g3b6f567cwea27e4ea1c6a9859@mail.gmail.com>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
	<b6bb06270805221537k1a78dca7ka4c060ff13a6e02d@mail.gmail.com>
	<78a7dad00805221602r73cdde16ie40cba07e6769f00@mail.gmail.com>
	<a71bd89a0805221616n7bfff661v17e44d59ac363bc5@mail.gmail.com>
	<78a7dad00805221631i5a49bae4jf59c2e0ae2415e22@mail.gmail.com>
	<a71bd89a0805221759g3b6f567cwea27e4ea1c6a9859@mail.gmail.com>
Message-ID: <19e31a080805221809s51d70e21k8b0acd757915260c@mail.gmail.com>

On Thu, May 22, 2008 at 8:59 PM, Dan Kegel <dank at kegel.com> wrote:
> The menus are messed up (they contain garbage text), and
> as I said earlier, there's no start menu.

You should look at explorer-new. Its in the ReactOS source tree and
being developed by Thomas Weidenmuller as a real Windows compatible
shell replacement. Unfortunately it does not work on Windows or
ReactOS at this time. The old ReactOS explorer will be removed when
explorer-new is ready.


-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Thu May 22 22:44:34 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 23 May 2008 12:44:34 +0900
Subject: Alternate shell?
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
Message-ID: <7F284A4B644D4B8C90ACEB594103CB21@DMITRY>

"Dan Kegel" <dank at kegel.com> wrote:

> For a maximal dogfood experience, I was looking around
> for a way to use a replacement Windows shell with
> Wine as my desktop environment instead of gnome
> or kde.

Built-in Wine explorer does a lot of things which the replacements
won't do, like desktop window management and HAL support.

-- 
Dmitry.


From dmitry at codeweavers.com  Thu May 22 22:51:14 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 23 May 2008 12:51:14 +0900
Subject: Cyrillic glyphs and bitmap fonts for Tahoma Bold
References: <2bcb95620805222039k3749cfaft3bc09bf296760fe4@mail.gmail.com>
Message-ID: <F6203733C56C43DBAAD3A1F9DFF78162@DMITRY>

"Igor Tarasov" <tarasov.igor at gmail.com> wrote:

> diff --git a/fonts/tahomabd.sfd b/fonts/tahomabd.sfd
> index b9fdfa0..e42678a 100644
> --- a/fonts/tahomabd.sfd
> +++ b/fonts/tahomabd.sfd
> @@ -1,4 +1,4 @@
> -SplineFontDB: 1.0
> +SplineFontDB: 2.0

As I pointed out many times this is a fatal change, please leave it at 1.0.

-- 
Dmitry.


From xixsimplicityxix at gmail.com  Thu May 22 22:55:32 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Thu, 22 May 2008 22:55:32 -0500
Subject: Alternate shell?
In-Reply-To: <19e31a080805221809s51d70e21k8b0acd757915260c@mail.gmail.com>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
	<b6bb06270805221537k1a78dca7ka4c060ff13a6e02d@mail.gmail.com>
	<78a7dad00805221602r73cdde16ie40cba07e6769f00@mail.gmail.com>
	<a71bd89a0805221616n7bfff661v17e44d59ac363bc5@mail.gmail.com>
	<78a7dad00805221631i5a49bae4jf59c2e0ae2415e22@mail.gmail.com>
	<a71bd89a0805221759g3b6f567cwea27e4ea1c6a9859@mail.gmail.com>
	<19e31a080805221809s51d70e21k8b0acd757915260c@mail.gmail.com>
Message-ID: <78a7dad00805222055s1ff50eb1ha9134d7651634e1a@mail.gmail.com>

On Thu, May 22, 2008 at 8:09 PM, Steven Edwards <winehacker at gmail.com> wrote:
> On Thu, May 22, 2008 at 8:59 PM, Dan Kegel <dank at kegel.com> wrote:
>> The menus are messed up (they contain garbage text), and
>> as I said earlier, there's no start menu.
>
> You should look at explorer-new. Its in the ReactOS source tree and
> being developed by Thomas Weidenmuller as a real Windows compatible
> shell replacement. Unfortunately it does not work on Windows or
> ReactOS at this time. The old ReactOS explorer will be removed when
> explorer-new is ready.
>
>
> --
> Steven Edwards
>
> "There is one thing stronger than all the armies in the world, and
> that is an idea whose time has come." - Victor Hugo
>

Just thought since I probably will be gone all weekend I'd report
before next week.

I'll try and write up something more useful after this but here's my
dogfood process so far:

wget "http://download.mozilla.org/?product=firefox-2.0.0.14&os=win&lang=en-US"
wget "http://www.xoblite.net/files/xoblite_bb3_rc1.zip"
mkdir xoblite && cd xoblite && unzip xoblite_bb3_rc1.zip

ubuntu logout and change session to failsafe terminal
bring up wifi
$wine ~/xoblite/Blackbox.exe
$wine ~/Firefox\ Setup\ 2.0.0.14.exe

The main problem seems to be lack of windowing and keyboard input,
nothing has a title bar.I wonder if that is because bb4win seems to
call RegisterShellHook which is a stub in wine?

On the upside I was able to launch firefox from bb4win and browse to
some sites fairly easily. =P


From dank at kegel.com  Thu May 22 23:12:38 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 22 May 2008 21:12:38 -0700
Subject: Alternate shell?
In-Reply-To: <7F284A4B644D4B8C90ACEB594103CB21@DMITRY>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
	<7F284A4B644D4B8C90ACEB594103CB21@DMITRY>
Message-ID: <a71bd89a0805222112y724a6502n256e210201742763@mail.gmail.com>

On Thu, May 22, 2008 at 8:44 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
>> For a maximal dogfood experience, I was looking around
>> for a way to use a replacement Windows shell with
>> Wine as my desktop environment instead of gnome
>> or kde.
>
> Built-in Wine explorer does a lot of things which the replacements
> won't do, like desktop window management and HAL support.

I think we're going to want to add a start button and taskbar
to our builtin explorer.   None of the replacements seem
to look anything like Windows XP, which is kind of what I'm
after.
- Dan


From winehacker at gmail.com  Thu May 22 23:23:35 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 23 May 2008 00:23:35 -0400
Subject: Alternate shell?
In-Reply-To: <a71bd89a0805222112y724a6502n256e210201742763@mail.gmail.com>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
	<7F284A4B644D4B8C90ACEB594103CB21@DMITRY>
	<a71bd89a0805222112y724a6502n256e210201742763@mail.gmail.com>
Message-ID: <19e31a080805222123va3a8166tcd6b31347eaec2ed@mail.gmail.com>

On Fri, May 23, 2008 at 12:12 AM, Dan Kegel <dank at kegel.com> wrote:
> I think we're going to want to add a start button and taskbar
> to our builtin explorer.   None of the replacements seem
> to look anything like Windows XP, which is kind of what I'm
> after.

Again, I think you should look at explorer-new. Its pretty close to
working, I think the StartMenu and friends work. It is designed for
Windows XP, does the Desktop, Start Menu, Taskbar, etc, is written in
C, is LGPL and is written by a ReactOS developer that has not been
blacklisted by Wine. I don't think it would be much trouble to merge
the two. Except of course shell32 is where most of the explorer really
lives and there is a lot of functionality missing in wine. Due to the
ReactOS embargo, shell32 has started to fork quite a bit on the
ReactOS side.

http://svn.reactos.org/svn/reactos/trunk/reactos/base/shell/explorer-new/

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From wine-devel at kievinfo.com  Thu May 22 23:35:22 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Thu, 22 May 2008 22:35:22 -0600
Subject: ddraw: Fixed in part regression bug #13277
In-Reply-To: <200805230016.39280.jens@albretsen.dk>
References: <200805221534.12656.jens@albretsen.dk>	<200805230001.28461.jens@albretsen.dk>	<b6bb06270805221456j333e79ccqb9fcbdb2b858e3b1@mail.gmail.com>
	<200805230016.39280.jens@albretsen.dk>
Message-ID: <4836498A.2040101@kievinfo.com>

Jens Albretsen wrote:
> On Thursday 22 May 2008 23:56:42 you wrote:
>> I don't have a compiler on my windows box, nor do I have cross
>> development tools on my linux box, but if you get me an exe I can test
>> on win xp (nvidia 7200 GT) or 2k (intel 865, or a variety of other
>> boxes).
>>
>> -Austin
> I have the same problem, I have absolutely no M$ stuff at home.
> I'm pretty sure what I did is correct, since like I said the game works on 
> windows and now it also does in wine. Before wine was crashing so it can only 
> be better. And next time someone runs the test on the M$ platforms we'll see 
> if the test fails or what? Anyway without the patch we just get a crash.

That's the part your have to prove with tests and test results. Just the 
fact that it fixes one program doesn't mean it's correct and won't break all 
other programs.

This is been the worst part about Wine and d3d in particular. That small 
"fixes" fix one game/problem yet break everything else.

Vitaliy.


From dmitry at codeweavers.com  Thu May 22 23:37:38 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 23 May 2008 13:37:38 +0900
Subject: Alternate shell?
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com><7F284A4B644D4B8C90ACEB594103CB21@DMITRY><a71bd89a0805222112y724a6502n256e210201742763@mail.gmail.com>
	<19e31a080805222123va3a8166tcd6b31347eaec2ed@mail.gmail.com>
Message-ID: <9275F22E51924175A759E8A4B75E10A5@DMITRY>

"Steven Edwards" <winehacker at gmail.com> wrote:

> Again, I think you should look at explorer-new. Its pretty close to
> working, I think the StartMenu and friends work. It is designed for
> Windows XP, does the Desktop, Start Menu, Taskbar, etc, is written in
> C, is LGPL and is written by a ReactOS developer that has not been
> blacklisted by Wine. I don't think it would be much trouble to merge
> the two. Except of course shell32 is where most of the explorer really
> lives and there is a lot of functionality missing in wine. Due to the
> ReactOS embargo, shell32 has started to fork quite a bit on the
> ReactOS side.
> 
> http://svn.reactos.org/svn/reactos/trunk/reactos/base/shell/explorer-new/

Since ros explorer uses an undocumented shell32.LogoffWindowsDialog as
reported in http://bugs.winehq.org/show_bug.cgi?id=10006 it should be
enough to blacklist its developer.

-- 
Dmitry.


From jens at albretsen.dk  Fri May 23 00:49:25 2008
From: jens at albretsen.dk (Jens Albretsen)
Date: Fri, 23 May 2008 07:49:25 +0200
Subject: ddraw: Fixed in part regression bug #13277
Message-ID: <200805230749.25797.jens@albretsen.dk>

On Friday 23 May 2008 06:35:22 you wrote:
> Jens Albretsen wrote:
> > On Thursday 22 May 2008 23:56:42 you wrote:
> >> I don't have a compiler on my windows box, nor do I have cross
> >> development tools on my linux box, but if you get me an exe I can test
> >> on win xp (nvidia 7200 GT) or 2k (intel 865, or a variety of other
> >> boxes).
> >>
> >> -Austin
> >
> > I have the same problem, I have absolutely no M$ stuff at home.
> > I'm pretty sure what I did is correct, since like I said the game works
> > on windows and now it also does in wine. Before wine was crashing so it
> > can only be better. And next time someone runs the test on the M$
> > platforms we'll see if the test fails or what? Anyway without the patch
> > we just get a crash.
>
> That's the part your have to prove with tests and test results. Just the
> fact that it fixes one program doesn't mean it's correct and won't break
> all other programs.
>
> This is been the worst part about Wine and d3d in particular. That small
> "fixes" fix one game/problem yet break everything else.
>
> Vitaliy.

In this case it was the function that did'nt check the arguments correctly, so 
it would break nothing only get more stable, but anyway I added a test, and 
It's been verified to work on windows XP. 
I can understand if it was like the other part I submitted where I was 
changing the public ref count and failing the tests.

/Jens



From winehacker at gmail.com  Fri May 23 00:59:04 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 23 May 2008 01:59:04 -0400
Subject: Alternate shell?
In-Reply-To: <9275F22E51924175A759E8A4B75E10A5@DMITRY>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
	<7F284A4B644D4B8C90ACEB594103CB21@DMITRY>
	<a71bd89a0805222112y724a6502n256e210201742763@mail.gmail.com>
	<19e31a080805222123va3a8166tcd6b31347eaec2ed@mail.gmail.com>
	<9275F22E51924175A759E8A4B75E10A5@DMITRY>
Message-ID: <19e31a080805222259m5b293bfcm8fb292dd89e284c1@mail.gmail.com>

On Fri, May 23, 2008 at 12:37 AM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> Since ros explorer uses an undocumented shell32.LogoffWindowsDialog as
> reported in http://bugs.winehq.org/show_bug.cgi?id=10006 it should be
> enough to blacklist its developer.

"ROS explorer doesn't count as a real world application that uses undocumented
Windows APIs. Besides the question remains where ROS explorer developers has
acquired a not published information."

Yes because we all know that developer had to work very hard to
reverse engineer that function with its many arguments and obfuscated
naming.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From amorozov at etersoft.ru  Fri May 23 02:49:27 2008
From: amorozov at etersoft.ru (Alexander Morozov)
Date: Fri, 23 May 2008 11:49:27 +0400
Subject: unknown device issues after running winetest
In-Reply-To: <4835506E.20105@gmail.com>
References: <4832D2C4.5060606@gmail.com>
	<200805221410.02870.amorozov@etersoft.ru>
	<4835506E.20105@gmail.com>
Message-ID: <200805231149.27785.amorozov@etersoft.ru>

> Can someone confirm that after running the devinst tests, the registry on
> Wine still shows these:
>
> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\ROOT\LEGACY_BOGUS (and
> stuff below)
>
> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\USB\BOGUS (and stuff
> below)
>
> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\DeviceClasses\{6A55B5A4
>-3F65-11DB-B704-0011955C2BDB} (and stuff below)

I can confirm this. Diff file with changes after running make devinst.ok is 
attached.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: devinst_reg.diff
Type: text/x-diff
Size: 3872 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080523/f372198f/attachment.diff 

From paul.vriens.wine at gmail.com  Fri May 23 02:59:49 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 23 May 2008 09:59:49 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <200805231149.27785.amorozov@etersoft.ru>
References: <4832D2C4.5060606@gmail.com>
	<200805221410.02870.amorozov@etersoft.ru>
	<4835506E.20105@gmail.com>
	<200805231149.27785.amorozov@etersoft.ru>
Message-ID: <48367975.8040704@gmail.com>

Alexander Morozov wrote:
>> Can someone confirm that after running the devinst tests, the registry on
>> Wine still shows these:
>>
>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\ROOT\LEGACY_BOGUS (and
>> stuff below)
>>
>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\USB\BOGUS (and stuff
>> below)
>>
>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\DeviceClasses\{6A55B5A4
>> -3F65-11DB-B704-0011955C2BDB} (and stuff below)
> 
> I can confirm this. Diff file with changes after running make devinst.ok is 
> attached.
> 
> 
Ok, so at least it looks we are compatible with Windows :-)

I will check out your suggestion about using SetupDiRemoveDevice (and maybe 
SetupDiRemoveDeviceInterface) to clean up the registry.

I already found that it doesn't work on NT4 for everything as we have a bogus 
bogus entry (missing the ClassGUID value). This means you can't even enumerate 
this one and it won't be covered by the remove calls.

So what about a cleanup_before function that gets rid of everything that's 
currently bogus in the registry? If we don't do this before we have to cater for 
existing keys in every test which will clutter the tests I think. If we really 
want to test existing keys we should do so a part of a normal test.

After that cleanup_before is working we can change the tests to clean up after 
themselves.

-- 
Cheers,

Paul.


From m.b.lankhorst at gmail.com  Fri May 23 03:01:36 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 23 May 2008 01:01:36 -0700
Subject: rpcrt4 test failures
Message-ID: <b130c85e0805230101nf69d10dxed78af9d6b2856b3@mail.gmail.com>

Hi Rob,

I roughly found the reason of the rpcrt4:server test crashing for me.
It crashes when it's trying to connect to localhost through the rpc
'tcp' transport.
The crash is likely caused because it can't connect to the locally
hosted test server the tcp way, and decides to bomb out instead.
However it won't say it failed to connect, instead it crashes on the
first test-case that uses rpc.

I would rather not have the test crash, that would also obscure the
possibility of running the other tests in that file. However I don't
know why it fails to connect over tcp (netbios works fine). I disabled
my firewall entirely, so it shouldn't be the cause of this failure.
Could there be other restrictions in place?

Cheers,
Maarten


From truiken at gmail.com  Fri May 23 03:03:27 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 23 May 2008 03:03:27 -0500
Subject: unknown device issues after running winetest
In-Reply-To: <48367975.8040704@gmail.com>
References: <4832D2C4.5060606@gmail.com>
	<200805221410.02870.amorozov@etersoft.ru> <4835506E.20105@gmail.com>
	<200805231149.27785.amorozov@etersoft.ru> <48367975.8040704@gmail.com>
Message-ID: <22821af30805230103o75e97a9cg534f91e7d6768584@mail.gmail.com>

On Fri, May 23, 2008 at 2:59 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Alexander Morozov wrote:
>>> Can someone confirm that after running the devinst tests, the registry on
>>> Wine still shows these:
>>>
>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\ROOT\LEGACY_BOGUS (and
>>> stuff below)
>>>
>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\USB\BOGUS (and stuff
>>> below)
>>>
>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\DeviceClasses\{6A55B5A4
>>> -3F65-11DB-B704-0011955C2BDB} (and stuff below)
>>
>> I can confirm this. Diff file with changes after running make devinst.ok is
>> attached.
>>
>>
> Ok, so at least it looks we are compatible with Windows :-)
>
> I will check out your suggestion about using SetupDiRemoveDevice (and maybe
> SetupDiRemoveDeviceInterface) to clean up the registry.
>
> I already found that it doesn't work on NT4 for everything as we have a bogus
> bogus entry (missing the ClassGUID value). This means you can't even enumerate
> this one and it won't be covered by the remove calls.
>
> So what about a cleanup_before function that gets rid of everything that's
> currently bogus in the registry? If we don't do this before we have to cater for
> existing keys in every test which will clutter the tests I think. If we really
> want to test existing keys we should do so a part of a normal test.
>
> After that cleanup_before is working we can change the tests to clean up after
> themselves.
>

Will the new 'cleanup after' code not delete these invalid entries?
One test run is fine to sacrifice for the sake of not cluttering up
the tests with temporary cleanup code.

-- 
James Hawkins


From paul.vriens.wine at gmail.com  Fri May 23 03:10:38 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 23 May 2008 10:10:38 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <22821af30805230103o75e97a9cg534f91e7d6768584@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com>	
	<200805221410.02870.amorozov@etersoft.ru>
	<4835506E.20105@gmail.com>	
	<200805231149.27785.amorozov@etersoft.ru>
	<48367975.8040704@gmail.com>
	<22821af30805230103o75e97a9cg534f91e7d6768584@mail.gmail.com>
Message-ID: <48367BFE.5090705@gmail.com>

James Hawkins wrote:
> On Fri, May 23, 2008 at 2:59 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> Alexander Morozov wrote:
>>>> Can someone confirm that after running the devinst tests, the registry on
>>>> Wine still shows these:
>>>>
>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\ROOT\LEGACY_BOGUS (and
>>>> stuff below)
>>>>
>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\USB\BOGUS (and stuff
>>>> below)
>>>>
>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\DeviceClasses\{6A55B5A4
>>>> -3F65-11DB-B704-0011955C2BDB} (and stuff below)
>>> I can confirm this. Diff file with changes after running make devinst.ok is
>>> attached.
>>>
>>>
>> Ok, so at least it looks we are compatible with Windows :-)
>>
>> I will check out your suggestion about using SetupDiRemoveDevice (and maybe
>> SetupDiRemoveDeviceInterface) to clean up the registry.
>>
>> I already found that it doesn't work on NT4 for everything as we have a bogus
>> bogus entry (missing the ClassGUID value). This means you can't even enumerate
>> this one and it won't be covered by the remove calls.
>>
>> So what about a cleanup_before function that gets rid of everything that's
>> currently bogus in the registry? If we don't do this before we have to cater for
>> existing keys in every test which will clutter the tests I think. If we really
>> want to test existing keys we should do so a part of a normal test.
>>
>> After that cleanup_before is working we can change the tests to clean up after
>> themselves.
>>
> 
> Will the new 'cleanup after' code not delete these invalid entries?
> One test run is fine to sacrifice for the sake of not cluttering up
> the tests with temporary cleanup code.
> 
The problem is that we could have failures because of existing keys and we have 
to cater for that in every test maybe.

I agree with you though and will first check if having the 'cleanup after' 
serves it's purpose (even if we have to run the test twice to actually see results).

Could take a while though as I have to check which tests leaves what keys 
around. Then how I can get rid of them on every platform. Wine doesn't have the 
SetupDiRemove stuff yet btw.

-- 
Cheers,

Paul.


From truiken at gmail.com  Fri May 23 03:12:39 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 23 May 2008 03:12:39 -0500
Subject: unknown device issues after running winetest
In-Reply-To: <48367BFE.5090705@gmail.com>
References: <4832D2C4.5060606@gmail.com>
	<200805221410.02870.amorozov@etersoft.ru> <4835506E.20105@gmail.com>
	<200805231149.27785.amorozov@etersoft.ru> <48367975.8040704@gmail.com>
	<22821af30805230103o75e97a9cg534f91e7d6768584@mail.gmail.com>
	<48367BFE.5090705@gmail.com>
Message-ID: <22821af30805230112i1f335a1eh2252448e5d7e8e94@mail.gmail.com>

On Fri, May 23, 2008 at 3:10 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> James Hawkins wrote:
>>
>> On Fri, May 23, 2008 at 2:59 AM, Paul Vriens <paul.vriens.wine at gmail.com>
>> wrote:
>>>
>>> Alexander Morozov wrote:
>>>>>
>>>>> Can someone confirm that after running the devinst tests, the registry
>>>>> on
>>>>> Wine still shows these:
>>>>>
>>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\ROOT\LEGACY_BOGUS (and
>>>>> stuff below)
>>>>>
>>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\USB\BOGUS (and stuff
>>>>> below)
>>>>>
>>>>>
>>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\DeviceClasses\{6A55B5A4
>>>>> -3F65-11DB-B704-0011955C2BDB} (and stuff below)
>>>>
>>>> I can confirm this. Diff file with changes after running make devinst.ok
>>>> is
>>>> attached.
>>>>
>>>>
>>> Ok, so at least it looks we are compatible with Windows :-)
>>>
>>> I will check out your suggestion about using SetupDiRemoveDevice (and
>>> maybe
>>> SetupDiRemoveDeviceInterface) to clean up the registry.
>>>
>>> I already found that it doesn't work on NT4 for everything as we have a
>>> bogus
>>> bogus entry (missing the ClassGUID value). This means you can't even
>>> enumerate
>>> this one and it won't be covered by the remove calls.
>>>
>>> So what about a cleanup_before function that gets rid of everything
>>> that's
>>> currently bogus in the registry? If we don't do this before we have to
>>> cater for
>>> existing keys in every test which will clutter the tests I think. If we
>>> really
>>> want to test existing keys we should do so a part of a normal test.
>>>
>>> After that cleanup_before is working we can change the tests to clean up
>>> after
>>> themselves.
>>>
>>
>> Will the new 'cleanup after' code not delete these invalid entries?
>> One test run is fine to sacrifice for the sake of not cluttering up
>> the tests with temporary cleanup code.
>>
> The problem is that we could have failures because of existing keys and we
> have to cater for that in every test maybe.
>
> I agree with you though and will first check if having the 'cleanup after'
> serves it's purpose (even if we have to run the test twice to actually see
> results).
>
> Could take a while though as I have to check which tests leaves what keys
> around. Then how I can get rid of them on every platform. Wine doesn't have
> the SetupDiRemove stuff yet btw.
>

All I'm saying is that there shouldn't be a reason to have a hacky
pre-cleanup.  All the cleanup that is needed for the tests should be
added, and after one round of failures, the next set of tests should
be clean.

-- 
James Hawkins


From paul.vriens.wine at gmail.com  Fri May 23 03:14:38 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 23 May 2008 10:14:38 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <22821af30805230112i1f335a1eh2252448e5d7e8e94@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com>	
	<200805221410.02870.amorozov@etersoft.ru>
	<4835506E.20105@gmail.com>	
	<200805231149.27785.amorozov@etersoft.ru>
	<48367975.8040704@gmail.com>	
	<22821af30805230103o75e97a9cg534f91e7d6768584@mail.gmail.com>	
	<48367BFE.5090705@gmail.com>
	<22821af30805230112i1f335a1eh2252448e5d7e8e94@mail.gmail.com>
Message-ID: <48367CEE.3030505@gmail.com>

James Hawkins wrote:
> On Fri, May 23, 2008 at 3:10 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> James Hawkins wrote:
>>> On Fri, May 23, 2008 at 2:59 AM, Paul Vriens <paul.vriens.wine at gmail.com>
>>> wrote:
>>>> Alexander Morozov wrote:
>>>>>> Can someone confirm that after running the devinst tests, the registry
>>>>>> on
>>>>>> Wine still shows these:
>>>>>>
>>>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\ROOT\LEGACY_BOGUS (and
>>>>>> stuff below)
>>>>>>
>>>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\USB\BOGUS (and stuff
>>>>>> below)
>>>>>>
>>>>>>
>>>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\DeviceClasses\{6A55B5A4
>>>>>> -3F65-11DB-B704-0011955C2BDB} (and stuff below)
>>>>> I can confirm this. Diff file with changes after running make devinst.ok
>>>>> is
>>>>> attached.
>>>>>
>>>>>
>>>> Ok, so at least it looks we are compatible with Windows :-)
>>>>
>>>> I will check out your suggestion about using SetupDiRemoveDevice (and
>>>> maybe
>>>> SetupDiRemoveDeviceInterface) to clean up the registry.
>>>>
>>>> I already found that it doesn't work on NT4 for everything as we have a
>>>> bogus
>>>> bogus entry (missing the ClassGUID value). This means you can't even
>>>> enumerate
>>>> this one and it won't be covered by the remove calls.
>>>>
>>>> So what about a cleanup_before function that gets rid of everything
>>>> that's
>>>> currently bogus in the registry? If we don't do this before we have to
>>>> cater for
>>>> existing keys in every test which will clutter the tests I think. If we
>>>> really
>>>> want to test existing keys we should do so a part of a normal test.
>>>>
>>>> After that cleanup_before is working we can change the tests to clean up
>>>> after
>>>> themselves.
>>>>
>>> Will the new 'cleanup after' code not delete these invalid entries?
>>> One test run is fine to sacrifice for the sake of not cluttering up
>>> the tests with temporary cleanup code.
>>>
>> The problem is that we could have failures because of existing keys and we
>> have to cater for that in every test maybe.
>>
>> I agree with you though and will first check if having the 'cleanup after'
>> serves it's purpose (even if we have to run the test twice to actually see
>> results).
>>
>> Could take a while though as I have to check which tests leaves what keys
>> around. Then how I can get rid of them on every platform. Wine doesn't have
>> the SetupDiRemove stuff yet btw.
>>
> 
> All I'm saying is that there shouldn't be a reason to have a hacky
> pre-cleanup.  All the cleanup that is needed for the tests should be
> added, and after one round of failures, the next set of tests should
> be clean.
> 
Agree

-- 
Cheers,

Paul.


From stefan at codeweavers.com  Fri May 23 03:40:27 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 23 May 2008 10:40:27 +0200
Subject: ddraw: Fixed in part regression bug #13277, retry
In-Reply-To: <200805222336.45231.jens@albretsen.dk>
References: <200805222336.45231.jens@albretsen.dk>
Message-ID: <200805231040.27617.stefan@codeweavers.com>

Please send test and patch in one patch file, or send them in different emails 
if a combined patch is too big(which surely isn't the case here)


From andrew.talbot at talbotville.com  Fri May 23 03:33:28 2008
From: andrew.talbot at talbotville.com (Andrew Talbot)
Date: Fri, 23 May 2008 09:33:28 +0100
Subject: Proposed indentation fixes
Message-ID: <200805230933.29718.andrew.talbot@talbotville.com>

Hi All,

I'm intending to "correct" some indentation anomalies, and I propose to do
this in an "indiscriminate" way. In other words, I would set the
indentation to match what the code does now, without any interpretation of
what may have been intended. This means that something like

    if (a)
        b;
        c;

would become

1)
    if (a)
        b;
    c;

rather than

2)
    if (a)
    {
        b;
        c;
    }

The advantages are that the code is "honest" and the existing behaviour is
preserved. The disadvantages are that if (2) were intended, it won't be
achieved here, and the corrected version will no longer "suggest" what was
really intended.

Is this "automatic" method still the way to go?

Thanks,

-- 
Andy.


From paul.vriens.wine at gmail.com  Fri May 23 04:27:51 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 23 May 2008 11:27:51 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <22821af30805230112i1f335a1eh2252448e5d7e8e94@mail.gmail.com>
References: <4832D2C4.5060606@gmail.com>	
	<200805221410.02870.amorozov@etersoft.ru>
	<4835506E.20105@gmail.com>	
	<200805231149.27785.amorozov@etersoft.ru>
	<48367975.8040704@gmail.com>	
	<22821af30805230103o75e97a9cg534f91e7d6768584@mail.gmail.com>	
	<48367BFE.5090705@gmail.com>
	<22821af30805230112i1f335a1eh2252448e5d7e8e94@mail.gmail.com>
Message-ID: <48368E17.8070301@gmail.com>

James Hawkins wrote:
> On Fri, May 23, 2008 at 3:10 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> James Hawkins wrote:
>>> On Fri, May 23, 2008 at 2:59 AM, Paul Vriens <paul.vriens.wine at gmail.com>
>>> wrote:
>>>> Alexander Morozov wrote:
>>>>>> Can someone confirm that after running the devinst tests, the registry
>>>>>> on
>>>>>> Wine still shows these:
>>>>>>
>>>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\ROOT\LEGACY_BOGUS (and
>>>>>> stuff below)
>>>>>>
>>>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\USB\BOGUS (and stuff
>>>>>> below)
>>>>>>
>>>>>>
>>>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\DeviceClasses\{6A55B5A4
>>>>>> -3F65-11DB-B704-0011955C2BDB} (and stuff below)
>>>>> I can confirm this. Diff file with changes after running make devinst.ok
>>>>> is
>>>>> attached.
>>>>>
>>>>>
>>>> Ok, so at least it looks we are compatible with Windows :-)
>>>>
>>>> I will check out your suggestion about using SetupDiRemoveDevice (and
>>>> maybe
>>>> SetupDiRemoveDeviceInterface) to clean up the registry.
>>>>
>>>> I already found that it doesn't work on NT4 for everything as we have a
>>>> bogus
>>>> bogus entry (missing the ClassGUID value). This means you can't even
>>>> enumerate
>>>> this one and it won't be covered by the remove calls.
>>>>
>>>> So what about a cleanup_before function that gets rid of everything
>>>> that's
>>>> currently bogus in the registry? If we don't do this before we have to
>>>> cater for
>>>> existing keys in every test which will clutter the tests I think. If we
>>>> really
>>>> want to test existing keys we should do so a part of a normal test.
>>>>
>>>> After that cleanup_before is working we can change the tests to clean up
>>>> after
>>>> themselves.
>>>>
>>> Will the new 'cleanup after' code not delete these invalid entries?
>>> One test run is fine to sacrifice for the sake of not cluttering up
>>> the tests with temporary cleanup code.
>>>
>> The problem is that we could have failures because of existing keys and we
>> have to cater for that in every test maybe.
>>
>> I agree with you though and will first check if having the 'cleanup after'
>> serves it's purpose (even if we have to run the test twice to actually see
>> results).
>>
>> Could take a while though as I have to check which tests leaves what keys
>> around. Then how I can get rid of them on every platform. Wine doesn't have
>> the SetupDiRemove stuff yet btw.
>>
> 
> All I'm saying is that there shouldn't be a reason to have a hacky
> pre-cleanup.  All the cleanup that is needed for the tests should be
> added, and after one round of failures, the next set of tests should
> be clean.
> 
I just had a check for the testRegisterAndGetDetail test on Vista (dunno about 
the other tests and platforms yet).

I added the SetupDiRemoveDevice (as was suggested by Alexander) at the end of 
this test.

On a clean registry this works out fine (one DeviceClasses key is left but that 
one can be deleted without having to fiddle with permissions).

When I however first run the old tests (with leftovers in the registry) and then 
run the new test again the registry keys are still present.
When I do the SetupDiRemoveDevice twice at the end of testRegisterAndGetDetail 
the registry keys get deleted again (not that DeviceClasses key again).

So what would be a good approach? Just doing 2 SetupDiRemoveDevice's at the end 
to make sure old stuff is gone as well?
Or doing one, check if the Enum keys is still present and then do a second 
SetupDiRemoveDevice (with a trace message for clarity)?

-- 
Cheers,

Paul.


From r.kalbermatter at hccnet.nl  Fri May 23 04:29:17 2008
From: r.kalbermatter at hccnet.nl (Rolf Kalbermatter)
Date: Fri, 23 May 2008 11:29:17 +0200
Subject: Alternate shell?
In-Reply-To: <9275F22E51924175A759E8A4B75E10A5@DMITRY>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com><7F284A4B644D4B8C90ACEB594103CB21@DMITRY><a71bd89a0805222112y724a6502n256e210201742763@mail.gmail.com><19e31a080805222123va3a8166tcd6b31347eaec2ed@mail.gmail.com>
	<9275F22E51924175A759E8A4B75E10A5@DMITRY>
Message-ID: <435E1FC8C35444C98F3DEA8AFF126A7B@NATERS>

Dmitry Timoshkov [mailto:dmitry at codeweavers.com] wrote:

> Since ros explorer uses an undocumented 
> shell32.LogoffWindowsDialog as reported in 
> http://bugs.winehq.org/show_bug.cgi?id=10006 it should be 
> enough to blacklist its developer.

If you google for LogoffWindowsDialog you find entries for a Wine hard stub
and then two patches to ROS, one implementing a soft stub in ROS and the
other
adding a call to ExitProcess to this stub so the shutdown process can
continue.

Is this reverse engineering?

Rolf Kalbermatter



From leslie_alistair at hotmail.com  Fri May 23 04:43:02 2008
From: leslie_alistair at hotmail.com (Alistair Leslie-Hughes)
Date: Fri, 23 May 2008 19:43:02 +1000
Subject: Proposed indentation fixes
References: <200805230933.29718.andrew.talbot@talbotville.com>
Message-ID: <g163kg$6gn$1@ger.gmane.org>

"Andrew Talbot" <andrew.talbot at talbotville.com> wrote in message 
news:200805230933.29718.andrew.talbot at talbotville.com...
> Hi All,
>
> I'm intending to "correct" some indentation anomalies, and I propose to do
> this in an "indiscriminate" way. In other words, I would set the
> indentation to match what the code does now, without any interpretation of
> what may have been intended. This means that something like
>
>    if (a)
>        b;
>        c;
>
> would become
>
> 1)
>    if (a)
>        b;
>    c;
>
Hi Andrew,
  I would do 1, and if you think that its wrong, add a comment email asking 
for double check.

Best Regards
 Alistair Leslie-Hughes 




From amorozov at etersoft.ru  Fri May 23 04:43:53 2008
From: amorozov at etersoft.ru (Alexander Morozov)
Date: Fri, 23 May 2008 13:43:53 +0400
Subject: unknown device issues after running winetest
In-Reply-To: <48368E17.8070301@gmail.com>
References: <4832D2C4.5060606@gmail.com>
	<22821af30805230112i1f335a1eh2252448e5d7e8e94@mail.gmail.com>
	<48368E17.8070301@gmail.com>
Message-ID: <200805231343.53794.amorozov@etersoft.ru>

> I just had a check for the testRegisterAndGetDetail test on Vista (dunno
> about the other tests and platforms yet).
>
> I added the SetupDiRemoveDevice (as was suggested by Alexander) at the end
> of this test.
>
> On a clean registry this works out fine (one DeviceClasses key is left but
> that one can be deleted without having to fiddle with permissions).
>
> When I however first run the old tests (with leftovers in the registry) and
> then run the new test again the registry keys are still present.
> When I do the SetupDiRemoveDevice twice at the end of
> testRegisterAndGetDetail the registry keys get deleted again (not that
> DeviceClasses key again).
>
> So what would be a good approach? Just doing 2 SetupDiRemoveDevice's at the
> end to make sure old stuff is gone as well?
> Or doing one, check if the Enum keys is still present and then do a second
> SetupDiRemoveDevice (with a trace message for clarity)?

I think the second way is better.
May be a number of Enum keys is equal a quantity of doing old test?


From martin at sky.franken.de  Fri May 23 01:42:01 2008
From: martin at sky.franken.de (Martin Fuchs)
Date: Fri, 23 May 2008 08:42:01 +0200
Subject: Alternate shell?
In-Reply-To: <9275F22E51924175A759E8A4B75E10A5@DMITRY>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com><7F284A4B644D4B8C90ACEB594103CB21@DMITRY><a71bd89a0805222112y724a6502n256e210201742763@mail.gmail.com>
	<19e31a080805222123va3a8166tcd6b31347eaec2ed@mail.gmail.com>
	<9275F22E51924175A759E8A4B75E10A5@DMITRY>
Message-ID: <C99F70EB-E521-4B97-9BC3-FBFD20DC3719@sky.franken.de>

Hello,

what about asking the developer where he got his information?  ;-)

If I remember correctly, I found this logoff dialog function using  
Google on one of those "undocumented Windows 95" web pages when adding  
it to the original ROS Explorer.

Regards,

    Martin


Am 23.05.2008 um 06:37 schrieb Dmitry Timoshkov:

> "Steven Edwards" <winehacker at gmail.com> wrote:
>
>> Again, I think you should look at explorer-new. Its pretty close to
>> working, I think the StartMenu and friends work. It is designed for
>> Windows XP, does the Desktop, Start Menu, Taskbar, etc, is written in
>> C, is LGPL and is written by a ReactOS developer that has not been
>> blacklisted by Wine. I don't think it would be much trouble to merge
>> the two. Except of course shell32 is where most of the explorer  
>> really
>> lives and there is a lot of functionality missing in wine. Due to the
>> ReactOS embargo, shell32 has started to fork quite a bit on the
>> ReactOS side.
>>
>> http://svn.reactos.org/svn/reactos/trunk/reactos/base/shell/explorer-new/
>
> Since ros explorer uses an undocumented shell32.LogoffWindowsDialog as
> reported in http://bugs.winehq.org/show_bug.cgi?id=10006 it should be
> enough to blacklist its developer.
>
> -- 
> Dmitry.


From ovek at arcticnet.no  Fri May 23 05:06:01 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Fri, 23 May 2008 12:06:01 +0200
Subject: Alternate shell?
In-Reply-To: <7F284A4B644D4B8C90ACEB594103CB21@DMITRY>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
	<7F284A4B644D4B8C90ACEB594103CB21@DMITRY>
Message-ID: <48369709.9070600@arcticnet.no>

Dmitry Timoshkov skrev:
> "Dan Kegel" <dank at kegel.com> wrote:
> 
>> For a maximal dogfood experience, I was looking around
>> for a way to use a replacement Windows shell with
>> Wine as my desktop environment instead of gnome
>> or kde.
> 
> Built-in Wine explorer does a lot of things which the replacements
> won't do, like desktop window management and HAL support.

Last time I checked, the HAL stuff was handled by mountmgr.sys


From paul.vriens.wine at gmail.com  Fri May 23 07:43:31 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 23 May 2008 14:43:31 +0200
Subject: unknown device issues after running winetest
In-Reply-To: <48368E17.8070301@gmail.com>
References: <4832D2C4.5060606@gmail.com>	
	<200805221410.02870.amorozov@etersoft.ru>
	<4835506E.20105@gmail.com>	
	<200805231149.27785.amorozov@etersoft.ru>
	<48367975.8040704@gmail.com>	
	<22821af30805230103o75e97a9cg534f91e7d6768584@mail.gmail.com>	
	<48367BFE.5090705@gmail.com>
	<22821af30805230112i1f335a1eh2252448e5d7e8e94@mail.gmail.com>
	<48368E17.8070301@gmail.com>
Message-ID: <4836BBF3.7010804@gmail.com>

Paul Vriens wrote:
> James Hawkins wrote:
>> On Fri, May 23, 2008 at 3:10 AM, Paul Vriens 
>> <paul.vriens.wine at gmail.com> wrote:
>>> James Hawkins wrote:
>>>> On Fri, May 23, 2008 at 2:59 AM, Paul Vriens 
>>>> <paul.vriens.wine at gmail.com>
>>>> wrote:
>>>>> Alexander Morozov wrote:
>>>>>>> Can someone confirm that after running the devinst tests, the 
>>>>>>> registry
>>>>>>> on
>>>>>>> Wine still shows these:
>>>>>>>
>>>>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\ROOT\LEGACY_BOGUS 
>>>>>>> (and
>>>>>>> stuff below)
>>>>>>>
>>>>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\USB\BOGUS (and 
>>>>>>> stuff
>>>>>>> below)
>>>>>>>
>>>>>>>
>>>>>>> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\DeviceClasses\{6A55B5A4 
>>>>>>>
>>>>>>> -3F65-11DB-B704-0011955C2BDB} (and stuff below)
>>>>>> I can confirm this. Diff file with changes after running make 
>>>>>> devinst.ok
>>>>>> is
>>>>>> attached.
>>>>>>
>>>>>>
>>>>> Ok, so at least it looks we are compatible with Windows :-)
>>>>>
>>>>> I will check out your suggestion about using SetupDiRemoveDevice (and
>>>>> maybe
>>>>> SetupDiRemoveDeviceInterface) to clean up the registry.
>>>>>
>>>>> I already found that it doesn't work on NT4 for everything as we 
>>>>> have a
>>>>> bogus
>>>>> bogus entry (missing the ClassGUID value). This means you can't even
>>>>> enumerate
>>>>> this one and it won't be covered by the remove calls.
>>>>>
>>>>> So what about a cleanup_before function that gets rid of everything
>>>>> that's
>>>>> currently bogus in the registry? If we don't do this before we have to
>>>>> cater for
>>>>> existing keys in every test which will clutter the tests I think. 
>>>>> If we
>>>>> really
>>>>> want to test existing keys we should do so a part of a normal test.
>>>>>
>>>>> After that cleanup_before is working we can change the tests to 
>>>>> clean up
>>>>> after
>>>>> themselves.
>>>>>
>>>> Will the new 'cleanup after' code not delete these invalid entries?
>>>> One test run is fine to sacrifice for the sake of not cluttering up
>>>> the tests with temporary cleanup code.
>>>>
>>> The problem is that we could have failures because of existing keys 
>>> and we
>>> have to cater for that in every test maybe.
>>>
>>> I agree with you though and will first check if having the 'cleanup 
>>> after'
>>> serves it's purpose (even if we have to run the test twice to 
>>> actually see
>>> results).
>>>
>>> Could take a while though as I have to check which tests leaves what 
>>> keys
>>> around. Then how I can get rid of them on every platform. Wine 
>>> doesn't have
>>> the SetupDiRemove stuff yet btw.
>>>
>>
>> All I'm saying is that there shouldn't be a reason to have a hacky
>> pre-cleanup.  All the cleanup that is needed for the tests should be
>> added, and after one round of failures, the next set of tests should
>> be clean.
>>
> I just had a check for the testRegisterAndGetDetail test on Vista (dunno 
> about the other tests and platforms yet).
> 
> I added the SetupDiRemoveDevice (as was suggested by Alexander) at the 
> end of this test.
> 
> On a clean registry this works out fine (one DeviceClasses key is left 
> but that one can be deleted without having to fiddle with permissions).
> 
> When I however first run the old tests (with leftovers in the registry) 
> and then run the new test again the registry keys are still present.
> When I do the SetupDiRemoveDevice twice at the end of 
> testRegisterAndGetDetail the registry keys get deleted again (not that 
> DeviceClasses key again).
> 
> So what would be a good approach? Just doing 2 SetupDiRemoveDevice's at 
> the end to make sure old stuff is gone as well?
> Or doing one, check if the Enum keys is still present and then do a 
> second SetupDiRemoveDevice (with a trace message for clarity)?
> 
This is not going to be an easy thing.

Just did a test on W2K3 for the testRegisterDeviceInfo test.

On a clean registry (after a reboot) I can remove the device nicely right after 
the test. Doing the tests again though fails unless I reboot. So some 
information is stored somewhere (services.exe?).

When the tests are run a second time (without a reboot) the following key 
structure is created:

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USB\BOGUS\0000\Control

After a reboot the Control key is gone. We can now just remove this by using 
SetupDiRemoveDevice.

So the scenarios:

After a reboot:

- clean registry
   - first tests will succeed and reg keys can be deleted afterwards
   - running the tests again will fail and create some regkeys that can't be 
deleted with SetupDiRemoveDevice in that same session (needs a reboot).
- USB\BOGUS\0000\Control is present
   - old tests have just been run and the system hasn't been rebooted since. Our 
new tests will fail.
- USB\BOGUS\0000 is present (but not the Control one)
   - we can remove the keys with SetupDiRemoveDevice
   - first tests will succeed and reg keys can be deleted afterwards
   - running the tests again will fail.

And this is just for W2K3, I haven't checked other OS's yet.

So on the one hand we can use this information to extends our tests. On the 
other hand it will mean a lot of checking and be prepared for different results. 
Different results in itself is not an issue of course as long as we know what's 
going on.

-- 
Cheers,

Paul.


From bcw1000 at yahoo.com  Fri May 23 08:17:42 2008
From: bcw1000 at yahoo.com (Bret Comstock Waldow)
Date: Fri, 23 May 2008 21:17:42 +0800
Subject: Can I do this in WINE?
Message-ID: <4836C3F6.6060008@yahoo.com>

I have a Tablet PC, running Kubuntu, and I have just released a project
on sourceforge to allow me to use the Microsoft hand writing
recognition. The current approach uses a .NET server in IIS running on
Tablet XP to provide the recognition. I would prefer to write a classic
Windows program that accepts the polyline ink strokes, accesses the
Tablet SDK & .dlls to recognize ink, and run that program in WINE
directly in Linux without IIS and network connections.

I'm thinking of my legal dual-boot installation, and reaching over with
WINE to run the app just as I run Notepad from the Windows install now.

I'm a Java programmer by day, and I haven't programmed Windows COM
before (much). I'd like comments and advice (even help) on doing this.

All of this message is written by hand in Linux using the SHIP project
(except copying and pasting this URL):
https://sourceforge.net/projects/ship-project/

Thanks in advance for information,
bret




From remco47 at gmail.com  Fri May 23 08:26:55 2008
From: remco47 at gmail.com (Remco)
Date: Fri, 23 May 2008 15:26:55 +0200
Subject: Alternate shell?
In-Reply-To: <a71bd89a0805222112y724a6502n256e210201742763@mail.gmail.com>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
	<7F284A4B644D4B8C90ACEB594103CB21@DMITRY>
	<a71bd89a0805222112y724a6502n256e210201742763@mail.gmail.com>
Message-ID: <36a11a3a0805230626h4e13b29em44dc491cf7143ce5@mail.gmail.com>

On Fri, May 23, 2008 at 6:12 AM, Dan Kegel <dank at kegel.com> wrote:
> I think we're going to want to add a start button and taskbar
> to our builtin explorer.   None of the replacements seem
> to look anything like Windows XP, which is kind of what I'm
> after.
> - Dan
>

This sounds a lot like my idea:
http://bugs.winehq.org/show_bug.cgi?id=11629

I first posted it on this list, and the consensus here was that Wine
should not have a "usable interface" as I called it, because the right
direction would be to strive for maximum integration. Then I was told
I should have instead posted it on BugZilla, which resulted in the bug
above.

Remco


From xixsimplicityxix at gmail.com  Fri May 23 09:14:21 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 23 May 2008 09:14:21 -0500
Subject: Can I do this in WINE?
In-Reply-To: <4836C3F6.6060008@yahoo.com>
References: <4836C3F6.6060008@yahoo.com>
Message-ID: <78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>

On Fri, May 23, 2008 at 8:17 AM, Bret Comstock Waldow <bcw1000 at yahoo.com> wrote:
> I have a Tablet PC, running Kubuntu, and I have just released a project
> on sourceforge to allow me to use the Microsoft hand writing
> recognition. The current approach uses a .NET server in IIS running on
> Tablet XP to provide the recognition. I would prefer to write a classic
> Windows program that accepts the polyline ink strokes, accesses the
> Tablet SDK & .dlls to recognize ink, and run that program in WINE
> directly in Linux without IIS and network connections.
>

There is the very tiniest skeleton of inkobj.dll which unfortunately
is no where near enough to even let an ms ink program run let alone do
handwriting recognition.  Also I'm unsure of how doable it is to run
.Net apps in wine yet.

wintab32 works alright though, so perhaps you would be able to write a
wintab app which integrated with one of the open source handwriting
recognition programs (ocropus and others ill try and dig up the links
later if you are interested).

--John


From Andrew.Talbot at talbotville.com  Fri May 23 10:53:22 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Fri, 23 May 2008 16:53:22 +0100
Subject: Proposed indentation fixes
References: <200805230933.29718.andrew.talbot@talbotville.com>
	<g163kg$6gn$1@ger.gmane.org>
Message-ID: <g16p9i$ovi$1@ger.gmane.org>

Alistair Leslie-Hughes wrote:

> Hi Andrew,
>   I would do 1, and if you think that its wrong, add a comment email
>   asking
> for double check.
> 
> Best Regards
>  Alistair Leslie-Hughes

Sounds good. Thanks, Alistair!

-- 
Andy.




From pgquiles at elpauer.org  Fri May 23 11:41:53 2008
From: pgquiles at elpauer.org (Pau Garcia i Quiles)
Date: Fri, 23 May 2008 18:41:53 +0200
Subject: Alternate shell?
In-Reply-To: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
References: <a71bd89a0805221516h78538fecu13febd1f7cc8e7e5@mail.gmail.com>
Message-ID: <20080523184153.lw5yjqac74wwsw4g@www.elpauer.org>

Quoting Dan Kegel <dank at kegel.com>:

Not exactly wine but quite close: some people are trying to use KDE4  
as the desktop for ReactOS:

http://kde-reactos.sourceforge.net/

... which mutates KDE into the "operating system", able to run with a  
Linux, BSD, Win32, Solaris, etc kernel.Crazy.

> For a maximal dogfood experience, I was looking around
> for a way to use a replacement Windows shell with
> Wine as my desktop environment instead of gnome
> or kde.
>
> So far, all the ones I've found are either broken, hard to use,
> or just plain weird.
>
> I've been working through the list at
> http://www.dmoz.org/Computers/Software/Operating_Systems/Microsoft_Windows/Software/Alternate_Shells/
>
> http://www.astonshell.com/aston/ - couldn't figure out how to run it?
>
> http://www.emergedesktop.org/ - kind of works, but very minimal, no   
> start menu
>
> http://www.labyrinth.net.au/~mosses/rob/liteshell.html - works, but
> very minimal, no start menu
>
> http://purels.org - no help, just exits, saying "ha ha, you didn't
> configure me".  Obviously not meant for me :-)
>
> http://www.lighttek.com/talisman.htm - pretty, but no Programs menu?!
> (Maybe that's there but broken, wine bug?)
>
> http://www.sky.franken.de/explorer/download.html - ROS explorer -
> prebuilt binary
> there is 3 years out of date, doesn't work too well
>
> Anyone have a favorite I should try?
> - Dan
>
>
>



-- 
Pau Garcia i Quiles
http://www.elpauer.org
(Due to my workload, I may need 10 days to answer)



From dank at kegel.com  Fri May 23 15:24:41 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 23 May 2008 13:24:41 -0700
Subject: New winetricks 20080523: directx9, bugfixes
Message-ID: <a71bd89a0805231324k49e97bfn6e271f5722b0bd55@mail.gmail.com>

Another week, another winetricks.

Changes since May 19's wine-devel annoucement:

r52:
- rotate sourceforge mirrors to avoid getting stuck on bad one
- cope with users who rename c:/windows/Fonts to c:/windows/fonts
- more conservative advice on sha1sum mismatches
- handle bad exit status from /usr/bin/which on mac
- cope with redhat.com sending decompressed files
- use win2K when installing directx9 so it installs more stuff

r50:
- Added directx9 verb

Online as always at
  http://kegel.com/wine/winetricks
or
  http://winezeug.googlecode.com


From austinenglish at gmail.com  Fri May 23 16:56:35 2008
From: austinenglish at gmail.com (Austin English)
Date: Fri, 23 May 2008 16:56:35 -0500
Subject: Readme: Updates needed
Message-ID: <b6bb06270805231456v6dd7d091gc28de1ed4f04dbaa@mail.gmail.com>

Alexandre committed a few fixed to the README today, but I still see a
few things that may need fixing:

./tool/wineinstall - Has been mentioned to be deprecated a few times
in bugzilla. If it's deprecated, we need to remove it. If not, we need
to fix whatever it's doing wrong and stop discouraging its use.

3. REQUIREMENTS
Linux version 2.0.36 or above
FreeBSD 6.2 or later
Solaris x86 2.5 or later
NetBSD-current
Mac OS X 10.4 or later

Need to check these versions. FreeBSD should be 6.3, with patches, or
preferably 7.0. Others, I don't know.

Lastly, the translated READMEs under /documentation likely need _a
lot_ of work. Those of you that are bilingual might take a stab at
it...

There were a couple other minor things that I've sent a patch for:
urls lacking trailing backslash, mentioning version .9 instead of 1.0,
using solitare as an example program (which we don't include, so I
replaced with notepad), etc.

-Austin


From mstefani at redhat.com  Fri May 23 17:21:55 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Fri, 23 May 2008 18:21:55 -0400
Subject: Readme: Updates needed
In-Reply-To: <b6bb06270805231456v6dd7d091gc28de1ed4f04dbaa@mail.gmail.com>
References: <b6bb06270805231456v6dd7d091gc28de1ed4f04dbaa@mail.gmail.com>
Message-ID: <48374383.8090906@redhat.com>

Austin English wrote:
> Alexandre committed a few fixed to the README today, but I still see a
> few things that may need fixing:
> 
> ./tool/wineinstall - Has been mentioned to be deprecated a few times
> in bugzilla. If it's deprecated, we need to remove it. If not, we need
> to fix whatever it's doing wrong and stop discouraging its use.
> 
> 3. REQUIREMENTS
> Linux version 2.0.36 or above
> FreeBSD 6.2 or later
> Solaris x86 2.5 or later
The last time I have asked about the supported Solaris version 
(free(NULL) == nop time; about 1.5 years ago) the answer was: it runs on 
Solaris 9 and 10 and could be made to compile on 8.

> NetBSD-current
> Mac OS X 10.4 or later
> 
> Need to check these versions. FreeBSD should be 6.3, with patches, or
> preferably 7.0. Others, I don't know.
> 
> Lastly, the translated READMEs under /documentation likely need _a
> lot_ of work. Those of you that are bilingual might take a stab at
> it...
> 
> There were a couple other minor things that I've sent a patch for:
> urls lacking trailing backslash, mentioning version .9 instead of 1.0,
> using solitare as an example program (which we don't include, so I
> replaced with notepad), etc.

bye
	michael


From kde at graph-ix.net  Fri May 23 18:55:48 2008
From: kde at graph-ix.net (Markus)
Date: Sat, 24 May 2008 01:55:48 +0200
Subject: Regression in wined3d: Add read_from_framebuffer_texture which
	combines code from read_from_framebuffer (drawpixels) and
	LoadLocation.
Message-ID: <200805240155.48802.kde@graph-ix.net>

Hi,

after investigating reports for the game 'World in Conflict', I identified the 
following patch to cause the game graphics to freeze (ambient sounds are 
still played though):

----
ba90a740beb9ce9a839cc843db8d87f5a37becdd is first bad commit
commit ba90a740beb9ce9a839cc843db8d87f5a37becdd
Author: Roderick Colenbrander <thunderbird2k at gmx.net>
Date:   Sun Feb 10 22:20:15 2008 +0100

    wined3d: Add read_from_framebuffer_texture which combines code from 
read_from_framebuffer (drawpixels) and LoadLocation.

    This makes the code easier to read and the pieces borrowed from
    read_from_framebuffer are more correct than the code in LoadLocation.

:040000 040000 74e4bdc73e367c8f38cd3d0818df0fc86eb788bf 
3e54409be7c9d2964efbf3d3c2f3d3b84a267047 M      dlls
----

The freezes only seem to occur if the native (Windows) dxdiagn.dll is used, as 
it lets the game properly detect the graphics card and thus enables 
additional graphics options (highend shaders, high-res textures, etc.). 
Apparently the freeze is only triggered with these options active.

The game uses events in its drawing code and ("always") hangs after the 
following output:
fixme:d3d9:D3DPERF_BeginEvent (color 0xffffffff, name L"Update verlet 
cloth") : stub
fixme:d3d9:D3DPERF_EndEvent (void) : stub

At one point, it was followed by this error:
err:d3d_surface:surface_prepare_system_memory Surface without memory or pbo 
has SFLAG_INSYSMEM set!

The point of the freeze appears to depend on many factors. If I move the 
camera around, it appears to freeze earlier than just letting the game run 
(e.g. a replay of a match). But once the patch is excluded, the game no 
longer freezes.

If more info is needed, please specify how I can obtain it.

-- 
Markus


From bcw1000 at yahoo.com  Fri May 23 20:58:52 2008
From: bcw1000 at yahoo.com (Bret Comstock Waldow)
Date: Sat, 24 May 2008 09:58:52 +0800
Subject: Can I do this in WINE?
In-Reply-To: <78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>
References: <4836C3F6.6060008@yahoo.com>
	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>
Message-ID: <4837765C.5030602@yahoo.com>

John Klehm wrote:
> On Fri, May 23, 2008 at 8:17 AM, Bret Comstock Waldow <bcw1000 at yahoo.com> wrote:
>   
>> I have a Tablet PC, running Kubuntu, and I have just released a project
>> on sourceforge to allow me to use the Microsoft hand writing
>> recognition. The current approach uses a .NET server in IIS running on
>> Tablet XP to provide the recognition. I would prefer to write a classic
>> Windows program that accepts the polyline ink strokes, accesses the
>> Tablet SDK & .dlls to recognize ink, and run that program in WINE
>> directly in Linux without IIS and network connections.
>>
>>     
>
> There is the very tiniest skeleton of inkobj.dll which unfortunately
> is no where near enough to even let an ms ink program run let alone do
> handwriting recognition.  Also I'm unsure of how doable it is to run
> .Net apps in wine yet.
>
> wintab32 works alright though, so perhaps you would be able to write a
> wintab app which integrated with one of the open source handwriting
> recognition programs (ocropus and others ill try and dig up the links
> later if you are interested).
>   
I will be very interested in looking at any open source handwriting
recognition programs you can point me at.

In order to be generally useful, the program must be able to recognize
cursive handwriting, as then it can be used with a general note-taking
application, such as the Tablet enabled PIMs (which is why I got
interested in the first place) or an open source equivalent of OneNote.

Xstroke uses the libstroke library to provide recognition of
single-stroke characters, and while many of those glyphs look like their
actual character, not all can.  A person could learn to write a page
full of individual glyphs (and read it), and then a program could use
libstroke later to interpret (and thus search through) such pages of
notes, but that's not the best solution.

We need cursive natural handwriting recognition, and I have that in the
licensed Tablet XP I have on my machine.  There are many examples of
"ink-on-the-web" published by Microsoft and their MVPs, and the license
states I can connect to my copy of XP over the network to consume
services provided by IIS, so I'm comfortable with my current solution.

But it's not the most useful - it requires a virtualized copy of Tablet
XP (or Vista) and that VM makes it cumbersome.

There is apparently a legal basis for me to use WINE to run Notepad off
my Windows partition.  I want to write a Windows COM (Automation) app -
no .NET - that I can install on my copy of Windows and then run via
WINE, just as I do Notepad or Solitaire.  The Tablet PC SDK appears at
first look to allow such.

If there is already a usable open source cursive handwriting recognition
program, I'll be happy to use that and ditch Windows entirely.

Otherwise, I need to know about the legality, and practicality, of a
scheme such as I am proposing above.  I'm hoping for comment, pointers,
and perhaps help about writing it.

Cheers,
Bret




From scott at open-vote.org  Fri May 23 21:41:43 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Fri, 23 May 2008 19:41:43 -0700
Subject: Time to cull the changelog file
Message-ID: <48378067.7020808@open-vote.org>

A while back, Alexandre promised to wipe the changelog file "when we hit
1.0 or when it hits 4 gigabytes, whichever comes first."

Well, it's about time.  I suggest removing all changes for entries
earlier than Wine 1.0-rc1, as having it completely empty would be a bit
silly.  As for where to archive the old changes online, I'm not sure.

Culling the changelog like this will reduce package size substantially.
 The text, even when compressed, is rather large.

Thanks,
Scott Ritchie


From xixsimplicityxix at gmail.com  Fri May 23 21:56:28 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Fri, 23 May 2008 21:56:28 -0500
Subject: Can I do this in WINE?
In-Reply-To: <4837765C.5030602@yahoo.com>
References: <4836C3F6.6060008@yahoo.com>
	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>
	<4837765C.5030602@yahoo.com>
Message-ID: <78a7dad00805231956t9a6a41bvdcf3ca3c85682915@mail.gmail.com>

On Fri, May 23, 2008 at 8:58 PM, Bret Comstock Waldow <bcw1000 at yahoo.com> wrote:
> I will be very interested in looking at any open source handwriting
> recognition programs you can point me at.
>

Here's what I was able to dig up awhile back in regards to open source
handwriting recog of any kind (not saying I found everything by any
means):

http://code.google.com/p/ocropus/ <= maybe the best handwriting recog engine?
http://www.dklevine.com/general/software/tc1000/jarnal.htm <= closest
thing to onenote
http://groundstate.ca/tabletsoft <= good summary of a bunch of programs
http://www.stressbunny.com/wayv/
http://www.handhelds.org/projects/xscribble.html
http://www.etla.net/libstroke/


I had been hoping to eventually get inkobj in wine to use ocopus as
the backend for handwriting but thats just a dream at this point.

> Otherwise, I need to know about the legality, and practicality, of a
> scheme such as I am proposing above.  I'm hoping for comment, pointers,
> and perhaps help about writing it.
>

If you are suggesting to use one copy of windows to serve
functionality for multiple users that might be on shaky legal ground,
IANAL though.

Hope this helps,
--John


From dmitry at codeweavers.com  Fri May 23 22:06:02 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 24 May 2008 12:06:02 +0900
Subject: avifil32/tests: [2/2] Add a test for AVISaveOptions and fix
	thedetected crash
References: <1211580824.25296.21.camel@p4>
Message-ID: <7945F3A65232412E87E28E5D8E809561@DMITRY>

"Detlef Riekenberg" <wine.dev at web.de> wrote:

> -  for (; nStreams > 0; nStreams--) {
> +  for (nStreams--; nStreams >= 0; nStreams--) {
>      if (ppOptions[nStreams] != NULL) {
>        ppOptions[nStreams]->dwFlags &= ~AVICOMPRESSF_VALID;

Shouldn't this be

for (nStreams - 1; nStreams >= 0; nStreams--) {

instead?

-- 
Dmitry.


From wine-devel at kievinfo.com  Fri May 23 22:29:03 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Fri, 23 May 2008 21:29:03 -0600
Subject: Can I do this in WINE?
In-Reply-To: <4837765C.5030602@yahoo.com>
References: <4836C3F6.6060008@yahoo.com>	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>
	<4837765C.5030602@yahoo.com>
Message-ID: <48378B7F.3040900@kievinfo.com>

Bret Comstock Waldow wrote:
> Otherwise, I need to know about the legality, and practicality, of a
> scheme such as I am proposing above.  I'm hoping for comment, pointers,
> and perhaps help about writing it.

You have to have valid _retail_ license of whatever windows version parts of 
which you want to use with Wine.

You can only use OEM version if you using the same hardware your license 
came with.

This makes completely impractical for anyone to use such a setup. Wine is 
made to avoid having windows all together, not requiring it.

Vitaliy.


From jjmckenzie51 at sprintpcs.com  Fri May 23 22:48:03 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Fri, 23 May 2008 20:48:03 -0700
Subject: Can I do this in WINE?
In-Reply-To: <48378B7F.3040900@kievinfo.com>
References: <4836C3F6.6060008@yahoo.com>
	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>
	<4837765C.5030602@yahoo.com> <48378B7F.3040900@kievinfo.com>
Message-ID: <48378FF3.50202@sprintpcs.com>

Vitaliy Margolen wrote:
> Bret Comstock Waldow wrote:
>   
>> Otherwise, I need to know about the legality, and practicality, of a
>> scheme such as I am proposing above.  I'm hoping for comment, pointers,
>> and perhaps help about writing it.
>>     
>
>   
Like Vitality said, the Wine project would like to avoid this, if 
possible.  However, the statements made about the 'parts' of Windows you 
are using.  If you are using a .dll that is available ONLY with a 
retail/OEM Windows package, you just might be violating the laws of your 
country.  Here it is best to consult a copyright attorney before DOING 
ANYTHING.  In the United States, copyright violations can be VERY 
expensive.  If you get several of the United States government entities 
involved, fines can be very high and you can end up with a lengthy stay 
in one of the country's finer prisons.
> You have to have valid _retail_ license of whatever windows version parts of 
> which you want to use with Wine.
>   
Depends on where you are living.  The European Union threw out most of 
the End User License Agreement as unenforceable.  In the United States 
of America, your statement is completely true.  However, it is best to 
avoid piracy if at all possible.
> You can only use OEM version if you using the same hardware your license 
> came with.
>   
Again, see above.  However, if you are using a re-destributiable and it 
does not have the 'new' EULA, you can use the package with Wine.  .NET 3 
has the new EULA that states it MUST be used with Microsoft Windows and 
thus the Genuine check.
> This makes completely impractical for anyone to use such a setup. Wine is 
> made to avoid having windows all together, not requiring it.
>
>   
Here, here.  Let's build into Wine the functionality to support most 
popular Windows programs and rid ourselves of the need to rely on 
Windows .dll code.


James McKenzie



From bcw1000 at yahoo.com  Fri May 23 22:51:29 2008
From: bcw1000 at yahoo.com (Bret Comstock Waldow)
Date: Sat, 24 May 2008 11:51:29 +0800
Subject: Can I do this in WINE?
In-Reply-To: <78a7dad00805231956t9a6a41bvdcf3ca3c85682915@mail.gmail.com>
References: <4836C3F6.6060008@yahoo.com>	
	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>	
	<4837765C.5030602@yahoo.com>
	<78a7dad00805231956t9a6a41bvdcf3ca3c85682915@mail.gmail.com>
Message-ID: <483790C1.8020205@yahoo.com>

John Klehm wrote:
> On Fri, May 23, 2008 at 8:58 PM, Bret Comstock Waldow <bcw1000 at yahoo.com> wrote:
>   
>> I will be very interested in looking at any open source handwriting
>> recognition programs you can point me at.
>>     

> Here's what I was able to dig up awhile back in regards to open source
> handwriting recog of any kind (not saying I found everything by any
> means):
>
> http://code.google.com/p/ocropus/ <= maybe the best handwriting recog engine?
>   
I've had a half-an-hour look at this.  I see the phrase "handwriting
recognition" a lot, but no examples or discussion yet.
> http://www.dklevine.com/general/software/tc1000/jarnal.htm <= closest
> thing to onenote
>   
Yes, and the handwriting recognition is entirely printed individual
characters, and it's not particularly good.  I don't think this is any
reflection on the authors - handwriting recognition is one of the "hard"
problems.

But it doesn't provide sufficient support.

> http://groundstate.ca/tabletsoft <= good summary of a bunch of programs
> http://www.stressbunny.com/wayv/
> http://www.handhelds.org/projects/xscribble.html
> http://www.etla.net/libstroke/
>   
All of these are printed individual character (or glyph) recognition
systems, and thus seriously compromise notetaking and post-recognition
tasks.

>> Otherwise, I need to know about the legality, and practicality, of a
>> scheme such as I am proposing above.  I'm hoping for comment, pointers,
>> and perhaps help about writing it.
>>     
> If you are suggesting to use one copy of windows to serve
> functionality for multiple users that might be on shaky legal ground,
> IANAL though.
>   
I don't know myself.  The web has many examples, published with
Microsoft's implicit (MVPs) or explicit consent (MS provides the
examples themselves) of ink-on-the-web, including handwriting
recognition.  They're largely .NET, but not all.

I'm not interested in providing this service for many users, however,
I'm only interested in using it for myself, on my own Tablet computer,
with my own licensed copy of Tablet XP.

Here is the language from the eula:

    1.4 Device Connections.  You may permit a maximum of
        ten (10) computers or other electronic devices (each a
        "Device") to connect to the COMPUTER to utilize one or
        more of the following services of the SOFTWARE:
        File Services, Print Services, Internet Information
        Services, Internet Connection Sharing and telephony
        services.  The ten connection maximum includes
        any indirect connections made through "multiplexing"
        or other software or hardware which pools or
        aggregates connections.  This ten connection maximum
        does not apply to other uses of the SOFTWARE, such
        as synchronizing data between a Device and the
        COMPUTER, provided only one user uses, accesses,
        displays or runs the SOFTWARE at any one time.
        This Section 1.4 does not grant you rights to access
        a COMPUTER Session from any Device.  A "Session"
        means any use of the SOFTWARE that enables
        functionality similar to that available to an end
        user who is interacting with the COMPUTER through
        any combination of input, output and display
        peripherals.

    1.5 Remote Desktop/Remote Assistance/NetMeeting.  The
        SOFTWARE contains Remote Desktop, Remote Assistance,
        and NetMeeting technologies that enable the SOFTWARE
        or applications installed on the COMPUTER (sometimes
        referred to as a host device) to be accessed remotely
        from other Devices.  You may use the SOFTWARE's
        Remote Desktop feature (or other software which
        provides similar functionality for a similar purpose)
        to access a COMPUTER Session from any Device provided
        you acquire a separate SOFTWARE license for that
        Device.  As an exception to this rule, the person
        who is the single primary user of the COMPUTER
        may access a Computer Session from any Device without
        acquiring an additional SOFTWARE license for that
        Device.  When you are using Remote Assistance or
        NetMeeting (or other software which provides similar
        functionality for a similar purpose) you may share
        a Session with other users without any limit on
        the number of Device connections and without acquiring
        additional licenses for the SOFTWARE.  For Microsoft
        and non-Microsoft applications, you should consult
        the license agreement accompanying the applicable
        software or contact the applicable licensor to
        determine whether use of the software with Remote
        Desktop, Remote Assistance, or NetMeeting is permitted
        without an additional license.  Except as otherwise
        permitted by the NetMeeting and Remote Assistance
        features described above, a license for the SOFTWARE
        may not be shared or used concurrently on different
        computers, such as a workstation, terminal or other
        device.

Note this phrase especially:
"As an exception to this rule, the person
who is the single primary user of the COMPUTER
may access a Computer Session from any Device without
acquiring an additional SOFTWARE license for that
Device."

I read this as saying I may use a running Tablet PC as a compute server,
processing polylines into characters just as the ink-on-the-web exmaples
Microsoft publishes do, but for my own use, on my own network.

And this:
"You may use the SOFTWARE's
Remote Desktop feature (or other software which
 provides similar functionality for a similar purpose)"

VMware provides similar functionality for a similar purpose - I can
remote my desktop with it.  It's still only running on the PC it's
licensed for - my Tablet computer.


So, for individual use by the licensee, I'm comfortable about my current
implementation (xmlrpc access to a compute server over the net by the
licensee).  I don't know about the legal grounds for running a program I
write that provides the functionality, which program is installed on the
actual copy of Tablet XP, and which program is accessed via the WINE
compatibility layer.

And I don't know if it's technically feasible, as I don't program MS
Windows COM applications (yet).  I know .NET won't work with WINE, but
the Tablet SDK does include COM support as well.

Any comments?

Cheers,
Bret




From bcw1000 at yahoo.com  Fri May 23 23:57:00 2008
From: bcw1000 at yahoo.com (Bret Comstock Waldow)
Date: Sat, 24 May 2008 12:57:00 +0800
Subject: Can I do this in WINE?
In-Reply-To: <48378B7F.3040900@kievinfo.com>
References: <4836C3F6.6060008@yahoo.com>	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>
	<4837765C.5030602@yahoo.com> <48378B7F.3040900@kievinfo.com>
Message-ID: <4837A01C.5090309@yahoo.com>

Vitaliy Margolen wrote:
> Bret Comstock Waldow wrote:
>> Otherwise, I need to know about the legality, and practicality, of a
>> scheme such as I am proposing above.  I'm hoping for comment, pointers,
>> and perhaps help about writing it.
>
> You have to have valid _retail_ license of whatever windows version
> parts of which you want to use with Wine.
>
> You can only use OEM version if you using the same hardware your
> license came with.
>
> This makes completely impractical for anyone to use such a setup. Wine
> is made to avoid having windows all together, not requiring it.
>

I ONLY want to write a Windows app I can install on my OWN copy of
Tablet XP on my OWN Tablet PC and then run from Linux via WINE.

There are Universities that mandate Tablet computers for Faculty and
Students, thus locking Linux from use in academic situations, which is
one of the best arenas for development of Free Software handwriting
recognition.   I want to make it practical for anyone to remain in Linux
(or Unix) all the time while using a Tablet computer.

This would allow an eco-system of tablet functionality to develop, which
in turn makes it more possible and more likely that someone will provide
a solution to the central problem of handwriting recognition free from
proprietary encumbrance.

If someone wants to avoid using Windows, they should avoid using Windows
programs, and instead use solutions that have no dependency on Windows,
to make it entirely irrelevant.

WINE is a compromise to allow people to use Windows programs without
(all of) Windows, but it's not a solution, it's a stepping stone. 
That's what I am intending as well, but specifically for Tablet computers.

I don't see an ethical difference between allowing the use of native
..dlls in WINE, and my own intentions, nor a legal one.  If you can load
native .dlls without running a full session of Windows in order to run a
Windows program, why can't I?  I would like an actual answer to that, as
it seems to be the crux of the question.

Or does WINE itself break the law by allowing the use of native .dlls
without loading a full copy of Windows?

Cheers,
Bret




From wine-devel at kievinfo.com  Sat May 24 00:15:42 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Fri, 23 May 2008 23:15:42 -0600
Subject: Can I do this in WINE?
In-Reply-To: <4837A01C.5090309@yahoo.com>
References: <4836C3F6.6060008@yahoo.com>	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>	<4837765C.5030602@yahoo.com>
	<48378B7F.3040900@kievinfo.com> <4837A01C.5090309@yahoo.com>
Message-ID: <4837A47E.8000707@kievinfo.com>

Bret Comstock Waldow wrote:
> I ONLY want to write a Windows app I can install on my OWN copy of
> Tablet XP on my OWN Tablet PC and then run from Linux via WINE.

So you want that everyone drop everything they are doing and start doing 
something that no one else can possibly use? Because it's either illegal, 
too costly or depends on hardware that non one has?  What a wonderful idea!

Vitaliy.


From bcw1000 at yahoo.com  Sat May 24 00:39:15 2008
From: bcw1000 at yahoo.com (Bret Comstock Waldow)
Date: Sat, 24 May 2008 13:39:15 +0800
Subject: Can I do this in WINE?
In-Reply-To: <4837A47E.8000707@kievinfo.com>
References: <4836C3F6.6060008@yahoo.com>	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>	<4837765C.5030602@yahoo.com>
	<48378B7F.3040900@kievinfo.com> <4837A01C.5090309@yahoo.com>
	<4837A47E.8000707@kievinfo.com>
Message-ID: <4837AA03.5040908@yahoo.com>

Vitaliy Margolen wrote:
> Bret Comstock Waldow wrote:
>> I ONLY want to write a Windows app I can install on my OWN copy of
>> Tablet XP on my OWN Tablet PC and then run from Linux via WINE.
>
> So you want that everyone drop everything they are doing and start
> doing something that no one else can possibly use? Because it's either
> illegal, too costly or depends on hardware that non one has?  What a
> wonderful idea!
No, I want to develop a solution that anyone who has a Tablet PC can use
to remain in Linux/Unix while using their OWN Tablet PC and the legal
copy of Tablet XP that is licensed for that actual PC, and I want to
tell others how to do it so they can for themselves.

If it's legal for me to release the actual binaries to do that under a
free license (I'm using the Modified BSD license for my current .NET
server), then I will.  If it's only legal to release the source code or
instructions under a free license then that's what I'll publish, and
people can write and compile their own, so they can use everything they
have paid for in a legal way.

And you didn't address why it's acceptable for the WINE project to tell
people to use native .dlls in WINE without loading a full session of
Windows, but not acceptable for me.

Can you speak to that, please?  Is WINE itself breaking the law, and
what is the difference to what I am thinking of  if the project is not?

Cheers,
Bret




From wine-devel at kievinfo.com  Sat May 24 00:55:48 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Fri, 23 May 2008 23:55:48 -0600
Subject: Can I do this in WINE?
In-Reply-To: <4837AA03.5040908@yahoo.com>
References: <4836C3F6.6060008@yahoo.com>	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>	<4837765C.5030602@yahoo.com>	<48378B7F.3040900@kievinfo.com>
	<4837A01C.5090309@yahoo.com>	<4837A47E.8000707@kievinfo.com>
	<4837AA03.5040908@yahoo.com>
Message-ID: <4837ADE4.6090909@kievinfo.com>

Bret Comstock Waldow wrote:
> Vitaliy Margolen wrote:
>> Bret Comstock Waldow wrote:
>>> I ONLY want to write a Windows app I can install on my OWN copy of
>>> Tablet XP on my OWN Tablet PC and then run from Linux via WINE.
>> So you want that everyone drop everything they are doing and start
>> doing something that no one else can possibly use? Because it's either
>> illegal, too costly or depends on hardware that non one has?  What a
>> wonderful idea!
> No, I want to develop a solution that anyone who has a Tablet PC can use
> to remain in Linux/Unix while using their OWN Tablet PC and the legal
> copy of Tablet XP that is licensed for that actual PC, and I want to
> tell others how to do it so they can for themselves.
In your solution you had 2 windows copies running at the same time. That you 
can't do with only one license.

> And you didn't address why it's acceptable for the WINE project to tell
> people to use native .dlls in WINE without loading a full session of
> Windows, but not acceptable for me.
That's up to people to decide what they do and legality of it. If you read 
some posts where people suggesting use of native dlls - that's not a 
_project_ telling everyone to use those dlls.

> Is WINE itself breaking the law, and what is the difference to what I am thinking of  if the project is not?
Wine itself DOES NOT break the law. Nor is it's intention to break the law 
in any way shape or form. What you proposing - does.

It seems you missing the whole point of the Wine project. Wine's objective 
is to run windows programs _WITHOUT_ windows. So no one is obligated to pay 
m$ tax on their hardware.

Designing something that runs on Wine and requires that windows is 
absolutely wrong.


Anyway. You are welcome to send patches that implement required 
functionality in Wine (after the wine-1.0 is out of course).

Vitaliy.


From truiken at gmail.com  Sat May 24 00:56:22 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 24 May 2008 00:56:22 -0500
Subject: Can I do this in WINE?
In-Reply-To: <4837AA03.5040908@yahoo.com>
References: <4836C3F6.6060008@yahoo.com>
	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>
	<4837765C.5030602@yahoo.com> <48378B7F.3040900@kievinfo.com>
	<4837A01C.5090309@yahoo.com> <4837A47E.8000707@kievinfo.com>
	<4837AA03.5040908@yahoo.com>
Message-ID: <22821af30805232256j1e400f9fy7e2a383dc021e004@mail.gmail.com>

On Sat, May 24, 2008 at 12:39 AM, Bret Comstock Waldow
<bcw1000 at yahoo.com> wrote:
> Vitaliy Margolen wrote:
>> Bret Comstock Waldow wrote:
>>> I ONLY want to write a Windows app I can install on my OWN copy of
>>> Tablet XP on my OWN Tablet PC and then run from Linux via WINE.
>>
>> So you want that everyone drop everything they are doing and start
>> doing something that no one else can possibly use? Because it's either
>> illegal, too costly or depends on hardware that non one has?  What a
>> wonderful idea!
> No, I want to develop a solution that anyone who has a Tablet PC can use
> to remain in Linux/Unix while using their OWN Tablet PC and the legal
> copy of Tablet XP that is licensed for that actual PC, and I want to
> tell others how to do it so they can for themselves.
>
> If it's legal for me to release the actual binaries to do that under a
> free license (I'm using the Modified BSD license for my current .NET
> server), then I will.  If it's only legal to release the source code or
> instructions under a free license then that's what I'll publish, and
> people can write and compile their own, so they can use everything they
> have paid for in a legal way.
>
> And you didn't address why it's acceptable for the WINE project to tell
> people to use native .dlls in WINE without loading a full session of
> Windows, but not acceptable for me.
>
> Can you speak to that, please?  Is WINE itself breaking the law, and
> what is the difference to what I am thinking of  if the project is not?
>

Wine is software...not sure how 'it' can break the law.  There's a
vast difference between a software project, developing for that
software, and using that software.  A person using native Windows DLLs
with Wine may be violating copyright law or the MS EULA if they don't
own a licensed copy of Windows.  We only advise licensed users of
Windows to use their DLLs in Wine, and even then its' only as a last
resort because it's detrimental in the long run to the project
(developmentally, not legally).

http://wiki.winehq.org/FAQ#head-d9796202650e186ec37698c0c8d2a18bebf6862c

-- 
James Hawkins


From bcw1000 at yahoo.com  Sat May 24 01:39:54 2008
From: bcw1000 at yahoo.com (Bret Comstock Waldow)
Date: Sat, 24 May 2008 14:39:54 +0800
Subject: Can I do this in WINE?
In-Reply-To: <4837ADE4.6090909@kievinfo.com>
References: <4836C3F6.6060008@yahoo.com>	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>	<4837765C.5030602@yahoo.com>	<48378B7F.3040900@kievinfo.com>
	<4837A01C.5090309@yahoo.com>	<4837A47E.8000707@kievinfo.com>
	<4837AA03.5040908@yahoo.com> <4837ADE4.6090909@kievinfo.com>
Message-ID: <4837B83A.70804@yahoo.com>

Vitaliy Margolen wrote:
> Bret Comstock Waldow wrote:
>> Vitaliy Margolen wrote:
>>> Bret Comstock Waldow wrote:
>>>> I ONLY want to write a Windows app I can install on my OWN copy of
>>>> Tablet XP on my OWN Tablet PC and then run from Linux via WINE.
>>> So you want that everyone drop everything they are doing and start
>>> doing something that no one else can possibly use? Because it's either
>>> illegal, too costly or depends on hardware that non one has?  What a
>>> wonderful idea!
>> No, I want to develop a solution that anyone who has a Tablet PC can use
>> to remain in Linux/Unix while using their OWN Tablet PC and the legal
>> copy of Tablet XP that is licensed for that actual PC, and I want to
>> tell others how to do it so they can for themselves.
> In your solution you had 2 windows copies running at the same time.
> That you can't do with only one license.
I most certainly do not have two copies of Windows running at the same
time with this new proposal, anymore than there are ANY copies of
Windows running if I run Notepad off my disk  in Linux via the WINE app.

I install a COM app I write on my Tablet XP, shut down Tablet XP, and
then boot Linux and run the app off the disk  from Linux, just like we
do when we run a copy of Notepad via WINE in Linux, or a game, or Word,
off the Windows install partition, without running the full copy of
Windows that is on the partition.

My CURRENT .NET server based solution DOES involve a running copy of
Tablet XP, on the hardware it's licensed to be installed on, accessible
on a network to the person who is legally entitled to access it over the
network, just as Microsoft's license says they may.  It is even possible
to load the local install of Windows right off it's partition in VMware,
although it is an advanced use of VMware - and only one copy is running,
and it's always running on the hardware it's actually licensed for -
never anywhere else.

Cheers,
Bret




From bcw1000 at yahoo.com  Sat May 24 02:02:14 2008
From: bcw1000 at yahoo.com (Bret Comstock Waldow)
Date: Sat, 24 May 2008 15:02:14 +0800
Subject: Can I do this in WINE?
In-Reply-To: <22821af30805232256j1e400f9fy7e2a383dc021e004@mail.gmail.com>
References: <4836C3F6.6060008@yahoo.com>	
	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>	
	<4837765C.5030602@yahoo.com> <48378B7F.3040900@kievinfo.com>	
	<4837A01C.5090309@yahoo.com> <4837A47E.8000707@kievinfo.com>	
	<4837AA03.5040908@yahoo.com>
	<22821af30805232256j1e400f9fy7e2a383dc021e004@mail.gmail.com>
Message-ID: <4837BD76.7080207@yahoo.com>

James Hawkins wrote:
> A person using native Windows DLLs
> with Wine may be violating copyright law or the MS EULA if they don't
> own a licensed copy of Windows.
That is of no concern with what I'm doing, as only the person who owns
the Tablet PC and has the license for the copy of Tablet XP that comes
with it will use the system, and only on the Tablet PC the Windows
software is licensed for.
>   We only advise licensed users of
> Windows to use their DLLs in Wine, and even then its' only as a last
> resort because it's detrimental in the long run to the project
> (developmentally, not legally).
>
> http://wiki.winehq.org/FAQ#head-d9796202650e186ec37698c0c8d2a18bebf6862c
>   
I understand it's detrimental in the long run.

As I mentioned, I'm hoping to jump-start the Tablet software eco-system
on Linux by making it (legally) possible to have functional handwriting
recognition now, with as much as possible of the surrounding software
written as Free or at least Open Source Software.

As the support springs up around it, eventually, only the actual
handwriting recognition engine itself need be replaced, and the ability
to use the Tablet in the meantime means more and more people will want
that, and more and more people (Graduate Students?) will have an
incentive, and supporting software, to write it for.

It's a hack, but then, isn't that what WINE is for?  To keep people
booted into Linux and off Windows?

I'll also look into getting some of the proprietary handwriting software
available as a module people can pay for and run on Linux with my
existing client (plus improvements) or other clients others may write. 
But right now I'm investigating whether the recognition I've already
paid for can be used in Linux via WINE, just as the Wordpad and
Solitaire and MineSweeper I've already paid for can be used in Linux via
WINE.

If you have a better proposal to solve the problem I'm addressing, I and
lots of other Tablet users I read on the Ubuntu forums and elsewhere
would love to hear it - people are crying for this, and the reason you
don't hear it a lot is that Tablets are not really usable AS TABLETS in
Linux - we can't really get started.  But telling us not do do it just
because you might have no need for it personally isn't really addressing
what we need.

The only reason to support Office is because people want it, and won't
get off Windows unless they can use it anyway.  That's what I'm trying
to do for Tablet users.

Cheers,
Bret




From kai.blin at gmail.com  Sat May 24 03:57:32 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Sat, 24 May 2008 10:57:32 +0200
Subject: Readme: Updates needed
In-Reply-To: <b6bb06270805231456v6dd7d091gc28de1ed4f04dbaa@mail.gmail.com>
References: <b6bb06270805231456v6dd7d091gc28de1ed4f04dbaa@mail.gmail.com>
Message-ID: <200805241057.35947.kai.blin@gmail.com>

On Friday 23 May 2008 23:56:35 Austin English wrote:
> Alexandre committed a few fixed to the README today, but I still see a
> few things that may need fixing:
>
> ./tool/wineinstall - Has been mentioned to be deprecated a few times
> in bugzilla. If it's deprecated, we need to remove it. If not, we need
> to fix whatever it's doing wrong and stop discouraging its use.

I think I've fixed this one quite some time ago. Is there anything wrong with 
it?

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080524/8c40fbf7/attachment.pgp 

From bcw1000 at yahoo.com  Sat May 24 04:11:11 2008
From: bcw1000 at yahoo.com (Bret Comstock Waldow)
Date: Sat, 24 May 2008 17:11:11 +0800
Subject: Can I do this in WINE?
In-Reply-To: <48378FF3.50202@sprintpcs.com>
References: <4836C3F6.6060008@yahoo.com>
	<78a7dad00805230714of43259ct20445bf920ccc348@mail.gmail.com>
	<4837765C.5030602@yahoo.com> <48378B7F.3040900@kievinfo.com>
	<48378FF3.50202@sprintpcs.com>
Message-ID: <4837DBAF.8040707@yahoo.com>

James McKenzie wrote:
> Vitaliy Margolen wrote:
>> Bret Comstock Waldow wrote:
>>  
>>> Otherwise, I need to know about the legality, and practicality, of a
>>> scheme such as I am proposing above.  I'm hoping for comment, pointers,
>>> and perhaps help about writing it.
>>>     
>>
>>   
> Like Vitality said, the Wine project would like to avoid this, if
> possible.
I understand, as I mention in another post.  I also specify my reasoning
more there - it is a case of "the end justifies the means", but I
believe WINE itself might fall into that category.  You are offering a
way for Windows users to boot and remain in Linux instead of booting
Windows - that's what I want, specifically for Tablet computer  users
that have a legal copy of Tablet XP.

You can tell me if you think I'm wrong about that - it would help me to
understand.

>   However, the statements made about the 'parts' of Windows you are
> using.  If you are using a .dll that is available ONLY with a
> retail/OEM Windows package, you just might be violating the laws of
> your country.
In my approach, only a person that has a Tablet PC (Microsoft's
definition) which therefore is bundled with Tablet XP (or Vista now, I
suppose) licensed for that machine will use the app, and they will
install it on their Windows copy, just as they do Word.

No Microsoft code is redistributed at all, unless it's part of the
re-distributables listed in the Visual C++ or Tablet SDK listings.

Keep in mind of course that this application doesn't exist yet, if it
ever will.

>   Here it is best to consult a copyright attorney before DOING
> ANYTHING.  In the United States, copyright violations can be VERY
> expensive.  If you get several of the United States government
> entities involved, fines can be very high and you can end up with a
> lengthy stay in one of the country's finer prisons.
Since I will only redistribute code I've written, or files listed as
re-distributable in the Visual C++ or Tablet XP lists, I think this
wouldn't apply - not copyright violation anyway.  I'll have to look at
the pertinent license terms for other aspects.

Let me know if you think I haven't understood, please.

>> You have to have valid _retail_ license of whatever windows version
>> parts of which you want to use with Wine.
>>   
> Depends on where you are living.  The European Union threw out most of
> the End User License Agreement as unenforceable.  In the United States
> of America, your statement is completely true.  However, it is best to
> avoid piracy if at all possible.
No piracy at all - the copy of Tablet XP is licensed for the machine
it's installed on.  It would get copied off the disk into RAM, but only
on the hardware it's licensed to.  Is that a violation?

>> You can only use OEM version if you using the same hardware your
>> license came with.
No problem.  I'm not targeting or assisting any other scenario.  The law
that protects Microsoft's rights is the same law that enforces the GPL. 
I'm for it - and I want to be sure I don't violate it.

> Here, here.
As an aside, the original phrase is "Hear, Hear!" - as in an exhortation
to everyone else to listen to what this man is saying.

>   Let's build into Wine the functionality to support most popular
> Windows programs and rid ourselves of the need to rely on Windows .dll
> code.
I'd love it.  I'm working on it as best I can myself.  I see this a a
martial arts trick - go with the opponent to guide their strength so it
doesn't confront me.

But do please tell me any ways you can see that I'm still not
understanding the legal issues.  I can do more out of prison myself,
even if it's not working on this idea.

By the way, I'm living in Perth, Australia.  There are nuances to all
legal situations, but it is legal to reverse engineer software that I
have a legal right to use in Australia in order to use it with hardware
or other software I have the legal right to use (unless they changed
that in the last few months when I wasn't looking).  I don't know that
that's pertinent in this case, as I'm proposing a Windows application
written to be installed and run on Windows.  And then possibly, accessed
via WINE.

I'd just as soon choose a solution that is legal (or at least not
obviously illegal) in the US, Europe, and New Zealand (my home) as well.

Cheers,
Bret




From andrew.talbot at talbotville.com  Sat May 24 04:22:44 2008
From: andrew.talbot at talbotville.com (Andrew Talbot)
Date: Sat, 24 May 2008 10:22:44 +0100
Subject: RFC: comctl32 indentations
Message-ID: <200805241022.44447.andrew.talbot@talbotville.com>

Hi,

In toolbar.c:TOOLBAR_Destroy(), should the "if" statement at line 5439 be 
compound to match the indentation, or should the three invocations of 
TOOLBAR_DeleteImageList() be outdented?

treeview.c:
In TREEVIEW_DeleteItem(), how conditional is the call of 
TREEVIEW_SetFirstVisible() at line 1539?

I'm guessing that the simple "if" statement at line 3045 just requires 
indenting(?)

If the forum is the wrong place to raise this sort of query, please forgive 
and advise. :)

Thanks,

-- 
Andy.


From Andrew.Talbot at talbotville.com  Sat May 24 04:33:18 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Sat, 24 May 2008 10:33:18 +0100
Subject: RFC: comctl32 indentations
References: <200805241022.44447.andrew.talbot@talbotville.com>
Message-ID: <g18ncv$k2m$1@ger.gmane.org>

Andrew Talbot wrote:

> If the forum is the wrong place to raise this sort of query, please
> forgive and advise. :)
> 

Actually, Alexandre suggested that I file bug reports for things I find but
can't fix myself. And I suppose an indentation anomaly is still a sort of
bug(?)

-- 
Andy.




From aurimas at gmail.com  Sat May 24 04:46:35 2008
From: aurimas at gmail.com (Aurimas Fischer)
Date: Sat, 24 May 2008 12:46:35 +0300
Subject: README: Few more updates
In-Reply-To: <b6bb06270805231455y187048fav630562d5ff584a7@mail.gmail.com>
References: <b6bb06270805231455y187048fav630562d5ff584a7@mail.gmail.com>
Message-ID: <4837E3FB.5050903@gmail.com>

Austin English wrote:
 > -	Go to http://www.winehq.org/site/git for more information.
 > +	Go to http://www.winehq.org/site/git/ for more information.

this is not correct, second link returns 404 page.


From julliard at winehq.org  Sat May 24 05:19:22 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 24 May 2008 12:19:22 +0200
Subject: Time to cull the changelog file
In-Reply-To: <48378067.7020808@open-vote.org> (Scott Ritchie's message of
	"Fri, 23 May 2008 19:41:43 -0700")
References: <48378067.7020808@open-vote.org>
Message-ID: <87y760qa1h.fsf@wine.dyndns.org>

Scott Ritchie <scott at open-vote.org> writes:

> A while back, Alexandre promised to wipe the changelog file "when we hit
> 1.0 or when it hits 4 gigabytes, whichever comes first."
>
> Well, it's about time.  I suggest removing all changes for entries
> earlier than Wine 1.0-rc1, as having it completely empty would be a bit
> silly.  As for where to archive the old changes online, I'm not sure.

Actually I was thinking of simply no longer maintaining a Changelog
file. It made sense in the days of CVS to store changeset information,
but now with git the same information and more can be retrieved
trivially with git-log, and the linear log format won't work so well
once we start having multiple branches.

Objections?  Does anybody feel a strong need for a Changelog file?

-- 
Alexandre Julliard
julliard at winehq.org


From stefan at codeweavers.com  Sat May 24 10:18:56 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 24 May 2008 17:18:56 +0200
Subject: Time to cull the changelog file
In-Reply-To: <87y760qa1h.fsf@wine.dyndns.org>
References: <48378067.7020808@open-vote.org> <87y760qa1h.fsf@wine.dyndns.org>
Message-ID: <200805241718.56329.stefan@codeweavers.com>

Am Samstag, 24. Mai 2008 12:19:22 schrieb Alexandre Julliard:
> Objections?  Does anybody feel a strong need for a Changelog file?
I'd say kill the changelog. I think I've never opened this file in my 4 years 
I've been messing with wine


From stefan at codeweavers.com  Sat May 24 10:30:47 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 24 May 2008 17:30:47 +0200
Subject: ddraw: [3/3] Fix for regression bug #13277
In-Reply-To: <200805240809.22162.jens@albretsen.dk>
References: <200805240809.22162.jens@albretsen.dk>
Message-ID: <200805241730.47986.stefan@codeweavers.com>

> +    ref = getRefcount(lpDD);
> +    ok(ref == 1, "Got refcount %ld, expected 2\n", ref);
> +    
> +    IDirectDraw_Release(lpDD);
> +    
> +    ref = getRefcount(lpDD);
> +    ok(ref == 0, "Got refcount %ld, expected 1\n", ref);
I think there's a copypaste error, it seems you forgot to adjust the error 
string.

Your test shows the correctness of the patch pretty well, although out of 
curiosity, can you try this: Between the IDirectDraw_Release(), which reduces 
the refcount to 0 and the ref = getRefcount(), can you try to HeapAlloc() 
small portions(e.g. 512 bytes) of memory with HEAP_ZERO_MEMORY until you get 
an out of memory error. This should make it less likely that the lpDD object 
survives by luck. It might be destroyed by windows, but the memory is not yet 
overwritten by something else, so the getRefcount works by luck. If this does 
not lead to a crash, try the memory allocation + getRefcount again after the 
Surface::Release call below, there it should cause a crash.

> @@ -1998,6 +2026,13 @@ IDirectDrawImpl_CreateNewSurface(IDirectDrawImpl 
*This,
>     InterlockedIncrement(&This->surfaces);
>     list_add_head(&This->surface_list, &(*ppSurf)->surface_list_entry);
>  
> +    IDirectDrawInternal_AddRef(This);

> @@ -424,6 +424,9 @@ IDirectDrawSurfaceImpl_Release(IDirectDrawSurface7 
*iface)
>          /* Reduce the ddraw refcount */
>          if(ifaceToRelease) IUnknown_Release(ifaceToRelease);
>          LeaveCriticalSection(&ddraw_cs);
> +        
> +        /* Surface does not need ddraw anymore, release it's reference */
> +        IDirectDrawInternal_Release(ddraw);
The counterpart to IDirectDrawImpl_CreateNewSurface is 
IDirectDrawSurfaceImpl_Destroy, not _Release. CreateNewSurface is called for 
each complex sublevel surface(e.g. front+backbuffer if they are created via 
DDSC_COMPLEX), while IDirectDrawSurface::Release must be called only for the 
root surface(ie, the pointer returned from IDirectDraw::CreateSurface). That 
means you have to move the IDirectDrawInternal_Release into 
IDirectDrawSurfaceImpl_Destroy, otherwise there's a reference leak.


From ovek at arcticnet.no  Sat May 24 11:27:29 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Sat, 24 May 2008 18:27:29 +0200
Subject: Time to cull the changelog file
In-Reply-To: <87y760qa1h.fsf@wine.dyndns.org>
References: <48378067.7020808@open-vote.org> <87y760qa1h.fsf@wine.dyndns.org>
Message-ID: <483841F1.9060808@arcticnet.no>

Alexandre Julliard skrev:
> Objections?  Does anybody feel a strong need for a Changelog file?

I've used it a lot to look up when stuff might have been fixed (or 
broken), and in general Debian packages are expected to ship a changelog 
if possible.


From robertshearman at gmail.com  Sat May 24 12:59:29 2008
From: robertshearman at gmail.com (Rob Shearman)
Date: Sat, 24 May 2008 18:59:29 +0100
Subject: rpcrt4: Skip client tests if the server isn't listening
In-Reply-To: <b130c85e0805230958h1baf5e6v1944a6d13f94951b@mail.gmail.com>
References: <b130c85e0805230958h1baf5e6v1944a6d13f94951b@mail.gmail.com>
Message-ID: <1096648c0805241059u3e096a7vc8e75bec3636ec94@mail.gmail.com>

2008/5/23 Maarten Lankhorst <m.b.lankhorst at gmail.com>:
> ---
>
> *Don't apply, breaks tests*
>
> Rob: Is there anything wrong with this patch apart from the fact it
> stops the tests from running in wine due to a failure? Would it
> prevent windows failures?
>
> Ideally I would make our RpcMgmtIsServerListening return RPC_S_OK, but
> I don't know the code so I'm afraid to make changes like this.

Please give me links to test data that shows this happening and I'll
try to figure out why the client isn't able to talk to the client.

Rob


From robertshearman at gmail.com  Sat May 24 13:04:14 2008
From: robertshearman at gmail.com (Rob Shearman)
Date: Sat, 24 May 2008 19:04:14 +0100
Subject: wininet: Make resolving hostnames thread safe.
In-Reply-To: <200805192121.40086.hans@it.vu.nl>
References: <200805192121.40086.hans@it.vu.nl>
Message-ID: <1096648c0805241104r738c817bu747fadd0e1686e5f@mail.gmail.com>

2008/5/19 Hans Leidekker <hans at it.vu.nl>:
> @@ -151,7 +158,21 @@ BOOL GetAddress(LPCWSTR lpszServerName, INTERNET_PORT nServerPort,
>      name = HeapAlloc(GetProcessHeap(), 0, sz+1);
>      WideCharToMultiByte( CP_UNIXCP, 0, lpszServerName, len, name, sz, NULL, NULL );
>      name[sz] = 0;
> +
> +#ifdef  HAVE_LINUX_GETHOSTBYNAME_R_6
> +    phe = NULL;
> +    buf = HeapAlloc(GetProcessHeap(), 0, bufsize);
> +    while (buf)
> +    {
> +        int res = gethostbyname_r(name, &hostentry, buf, bufsize, &phe, &locerr);
> +        if (res != ERANGE) break;
> +        bufsize *= 2;
> +        buf = HeapReAlloc(GetProcessHeap(), 0, buf, bufsize);
> +    }
> +    HeapFree(GetProcessHeap(), 0, buf);
> +#else
>      phe = gethostbyname(name);
> +#endif

In the long term it would be better to use getaddrinfo instead of
gethostbyname/gethostbyname_r, but that's too big a change for 1.0.

Rob


From jens at albretsen.dk  Sat May 24 14:37:44 2008
From: jens at albretsen.dk (Jens Albretsen)
Date: Sat, 24 May 2008 21:37:44 +0200
Subject: ddraw: [3/3] Fix for regression bug #13277
In-Reply-To: <200805241730.47986.stefan@codeweavers.com>
References: <200805240809.22162.jens@albretsen.dk>
	<200805241730.47986.stefan@codeweavers.com>
Message-ID: <200805242137.44722.jens@albretsen.dk>

On Saturday 24 May 2008 17:30:47 Stefan D?singer wrote:
> > +    ref = getRefcount(lpDD);
> > +    ok(ref == 1, "Got refcount %ld, expected 2\n", ref);
> > +
> > +    IDirectDraw_Release(lpDD);
> > +
> > +    ref = getRefcount(lpDD);
> > +    ok(ref == 0, "Got refcount %ld, expected 1\n", ref);
>
> I think there's a copypaste error, it seems you forgot to adjust the error
> string.
Correct.

> Your test shows the correctness of the patch pretty well, although out of
> curiosity, can you try this: Between the IDirectDraw_Release(), which
> reduces the refcount to 0 and the ref = getRefcount(), can you try to
> HeapAlloc() small portions(e.g. 512 bytes) of memory with HEAP_ZERO_MEMORY
> until you get an out of memory error. This should make it less likely that
> the lpDD object survives by luck. It might be destroyed by windows, but the
> memory is not yet overwritten by something else, so the getRefcount works
> by luck. If this does not lead to a crash, try the memory allocation +
> getRefcount again after the Surface::Release call below, there it should
> cause a crash.
I understand.
You want this in the patch or just test it?
Is there a implementation of allocate all memory/free all memory?
I have a issue with the last part of the test, would it be ok for the test to 
crash on purpose, I mean the last test.

> > @@ -1998,6 +2026,13 @@ IDirectDrawImpl_CreateNewSurface(IDirectDrawImpl
>
> *This,
>
> >     InterlockedIncrement(&This->surfaces);
> >     list_add_head(&This->surface_list, &(*ppSurf)->surface_list_entry);
> >
> > +    IDirectDrawInternal_AddRef(This);
> >
> > @@ -424,6 +424,9 @@ IDirectDrawSurfaceImpl_Release(IDirectDrawSurface7
>
> *iface)
>
> >          /* Reduce the ddraw refcount */
> >          if(ifaceToRelease) IUnknown_Release(ifaceToRelease);
> >          LeaveCriticalSection(&ddraw_cs);
> > +
> > +        /* Surface does not need ddraw anymore, release it's reference
> > */ +        IDirectDrawInternal_Release(ddraw);
>
> The counterpart to IDirectDrawImpl_CreateNewSurface is
> IDirectDrawSurfaceImpl_Destroy, not _Release. CreateNewSurface is called
> for each complex sublevel surface(e.g. front+backbuffer if they are created
> via DDSC_COMPLEX), while IDirectDrawSurface::Release must be called only
> for the root surface(ie, the pointer returned from
> IDirectDraw::CreateSurface). That means you have to move the
> IDirectDrawInternal_Release into
> IDirectDrawSurfaceImpl_Destroy, otherwise there's a reference leak.

Consider it fixed.

/JensA


From jjmckenzie51 at sprintpcs.com  Sat May 24 15:06:22 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 24 May 2008 13:06:22 -0700
Subject: Time to cull the changelog file
In-Reply-To: <483841F1.9060808@arcticnet.no>
References: <48378067.7020808@open-vote.org> <87y760qa1h.fsf@wine.dyndns.org>
	<483841F1.9060808@arcticnet.no>
Message-ID: <4838753E.3060906@sprintpcs.com>

Ove Kaaven wrote:
> Alexandre Julliard skrev:
>   
>> Objections?  Does anybody feel a strong need for a Changelog file?
>>     
>
> I've used it a lot to look up when stuff might have been fixed (or 
> broken), and in general Debian packages are expected to ship a changelog 
> if possible.
>
>
>   
I'm with you.  However, including it with the package may not be 
necessary.  I would include an URL in the readme and leave it at that.

James McKenzie



From hans at it.vu.nl  Sat May 24 15:52:32 2008
From: hans at it.vu.nl (Hans Leidekker)
Date: Sat, 24 May 2008 22:52:32 +0200
Subject: wininet: Make resolving hostnames thread safe.
In-Reply-To: <1096648c0805241104r738c817bu747fadd0e1686e5f@mail.gmail.com>
References: <200805192121.40086.hans@it.vu.nl>
	<1096648c0805241104r738c817bu747fadd0e1686e5f@mail.gmail.com>
Message-ID: <200805242252.32288.hans@it.vu.nl>

On Saturday 24 May 2008 20:04:14 Rob Shearman wrote:

> In the long term it would be better to use getaddrinfo instead of
> gethostbyname/gethostbyname_r, but that's too big a change for 1.0.

My thoughts exactly. I looked at getaddrinfo first but realized that
using it means writing new code, so I opted for copying a tried solution
from winsock.

 -Hans


From ovek at arcticnet.no  Sat May 24 16:18:27 2008
From: ovek at arcticnet.no (Ove Kaaven)
Date: Sat, 24 May 2008 23:18:27 +0200
Subject: Time to cull the changelog file
In-Reply-To: <4838753E.3060906@sprintpcs.com>
References: <48378067.7020808@open-vote.org> <87y760qa1h.fsf@wine.dyndns.org>
	<483841F1.9060808@arcticnet.no> <4838753E.3060906@sprintpcs.com>
Message-ID: <48388623.7050508@arcticnet.no>

James McKenzie skrev:
> Ove Kaaven wrote:
>> Alexandre Julliard skrev:
>>  
>>> Objections?  Does anybody feel a strong need for a Changelog file?
>>>     
>>
>> I've used it a lot to look up when stuff might have been fixed (or 
>> broken), and in general Debian packages are expected to ship a 
>> changelog if possible.
>>
>>
>>   
> I'm with you.  However, including it with the package may not be 
> necessary.  I would include an URL in the readme and leave it at that.

Actually, I think I'd rather have the old changelogs in the source 
package and leave it at that, and just include the current changelog in 
the binaries.

I wouldn't have anything against renaming the current changelog to 
ChangeLog.BETA or something and starting a new one for the 1.0 series.

Or, I suppose worst case (if the changelog is dropped completely), and I 
don't feel like generating the log myself, I could install the ANNOUNCE 
file as the upstream changelog...


From julliard at winehq.org  Sat May 24 16:43:56 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 24 May 2008 23:43:56 +0200
Subject: Time to cull the changelog file
In-Reply-To: <48388623.7050508@arcticnet.no> (Ove Kaaven's message of "Sat, 24
	May 2008 23:18:27 +0200")
References: <48378067.7020808@open-vote.org> <87y760qa1h.fsf@wine.dyndns.org>
	<483841F1.9060808@arcticnet.no> <4838753E.3060906@sprintpcs.com>
	<48388623.7050508@arcticnet.no>
Message-ID: <87tzgnqswz.fsf@wine.dyndns.org>

Ove Kaaven <ovek at arcticnet.no> writes:

> Actually, I think I'd rather have the old changelogs in the source
> package and leave it at that, and just include the current changelog
> in the binaries.

The old changelogs certainly won't be removed.

> Or, I suppose worst case (if the changelog is dropped completely), and
> I don't feel like generating the log myself, I could install the
> ANNOUNCE file as the upstream changelog...

If you want a changelog for your package all you'll have to do is
something like:

  git-log wine-1.0.. >ChangeLog

If you want it in the exact same format as the existing one you can use
the cg-log script from cogito (that's what I use currently).

-- 
Alexandre Julliard
julliard at winehq.org


From juan.lang at gmail.com  Sat May 24 16:35:31 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Sat, 24 May 2008 14:35:31 -0700
Subject: crypt32: CertComparePublicKeyInfo must ignore the leading zero
Message-ID: <3a768c550805241435o226ccd51y19b65b5e9e50cea3@mail.gmail.com>

This one's bugged me for ages, but I never tracked it down.  Thanks!
--Juan


From stefan at codeweavers.com  Sat May 24 16:57:00 2008
From: stefan at codeweavers.com (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sat, 24 May 2008 23:57:00 +0200
Subject: [5/5] d3d9: Test our texop implementation
In-Reply-To: <d658b69e0805240133i54c018bt721793bb0778ae1@mail.gmail.com>
References: <d658b69e0805240133i54c018bt721793bb0778ae1@mail.gmail.com>
Message-ID: <200805242357.00292.stefan@codeweavers.com>

Am Samstag, 24. Mai 2008 10:33:42 schrieb H. Verbeet:
> The color_match() function which this test introduces should be used
> for the other visual tests that require an approximate match as well,
> but doing this is outside the scope of this patch.
Dan recently added color_near() for this purpose. Is there any difference 
between the functions(I see that yours passes the hardcoded slop as a 
parameter). Do you have any preference towards any implementation? I'm 
inclined to use yours because of the additional parameter and the better 
checking with abs()


From hintak_leung at yahoo.co.uk  Sat May 24 12:13:12 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Sat, 24 May 2008 18:13:12 +0100
Subject: RFC: comctl32 indentations
In-Reply-To: <g18ncv$k2m$1@ger.gmane.org>
References: <200805241022.44447.andrew.talbot@talbotville.com>
	<g18ncv$k2m$1@ger.gmane.org>
Message-ID: <48384CA8.6000403@yahoo.co.uk>

Andrew Talbot wrote:
> Andrew Talbot wrote:
> 
>> If the forum is the wrong place to raise this sort of query, please
>> forgive and advise. :)
>>
> 
> Actually, Alexandre suggested that I file bug reports for things I find but
> can't fix myself. And I suppose an indentation anomaly is still a sort of
> bug(?)

Indentation is something you *can* fix yourself, *if* it bothers you that much
that some lines are out indented wrongly. The usual practice elsewhere
is to just generate a diff/patch, post it and hope that somebody who has commit 
rights to agree with your that the indentation needs fixing, and just commit
the change you have already generated properly as a diff/patch. The same with
typos in comments, for example.

Talking about it and whether to do it is wasting everybody's time.




From neil at skrypuch.com  Sat May 24 16:16:27 2008
From: neil at skrypuch.com (Neil Skrypuch)
Date: Sat, 24 May 2008 16:16:27 -0500
Subject: Adding d3d9x_xx dlls to winetricks?
In-Reply-To: <483600ED.4020503@hfigge.myfqdn.de>
References: <a71bd89a0805202218n7aaccfe0nad8ef7245a41f09c@mail.gmail.com>
	<a71bd89a0805211644s15650a30jd9b5a74ef5bae311@mail.gmail.com>
	<483600ED.4020503@hfigge.myfqdn.de>
Message-ID: <200805241616.28057.neil@skrypuch.com>

On Thursday 22 May 2008, Hartmut Figge wrote:
> Dan Kegel:
> >On Wed, May 21, 2008 at 1:40 AM, Stefan D?singer <stefandoesinger at gmx.at> 
wrote:
> >> I think the proper thing to do is to install the DirectX runtime /
> >> redistributable. It installs all the DLLs and registers them in the
> >> registry etc.
> >
> >Suits me.  How's this look?
>
> Well, my Seamonkey refuses to show the attachment. ;) Reason is
>
> | Content-Type: application/octet-stream; name=winetricks
>
> I have to copy the mail to another folder, close my SM and edit this
> line manually to
>
> Content-Type: text/plain; name=winetricks
>
> After restarting my SM i am now able to read the attachment. Am i the
> only one who suffers from application/octet-stream?
>
> Hartmut

Works for me in KMail. It offers to open it in KWrite or save it.

- Neil


From hverbeet at gmail.com  Sat May 24 17:25:47 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Sun, 25 May 2008 00:25:47 +0200
Subject: [5/5] d3d9: Test our texop implementation
In-Reply-To: <200805242357.00292.stefan@codeweavers.com>
References: <d658b69e0805240133i54c018bt721793bb0778ae1@mail.gmail.com>
	<200805242357.00292.stefan@codeweavers.com>
Message-ID: <d658b69e0805241525hbe8b7f7x4b591b627a01cb2c@mail.gmail.com>

2008/5/24 Stefan D?singer <stefan at codeweavers.com>:
> Am Samstag, 24. Mai 2008 10:33:42 schrieb H. Verbeet:
>> The color_match() function which this test introduces should be used
>> for the other visual tests that require an approximate match as well,
>> but doing this is outside the scope of this patch.
> Dan recently added color_near() for this purpose. Is there any difference
> between the functions(I see that yours passes the hardcoded slop as a
> parameter). Do you have any preference towards any implementation? I'm
> inclined to use yours because of the additional parameter and the better
> checking with abs()
>
I wrote this test some time ago already, but I do think having the
slop as parameter is useful, since the acceptable range of values
pretty much depends on the specific test. Another difference is that I
check the alpha channel as well, although in practice that doesn't
matter here.


From truiken at gmail.com  Sat May 24 19:32:41 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 24 May 2008 19:32:41 -0500
Subject: msi: fix tab order
In-Reply-To: <a71bd89a0805241710q938a174lc405cce8bff835ef@mail.gmail.com>
References: <a71bd89a0805241710q938a174lc405cce8bff835ef@mail.gmail.com>
Message-ID: <22821af30805241732pbf94e56u2ccc5d8b8c589d51@mail.gmail.com>

On Sat, May 24, 2008 at 7:10 PM, Dan Kegel <dank at kegel.com> wrote:
> When you press Tab in an msi dialog, focus moves the wrong way.
> You can confirm the correct tab order by viewing the msi
> file in Orca and looking at the Dialog and Control tables.
>
> It seems that tab order in user32 is equal to z order,
> and SetWindowPos() is the function used to control both.
> Our msi currently seems to get the first two args backwards;
> reversing them fixes http://bugs.winehq.org/show_bug.cgi?id=10147
> and at least superficially makes more sense.
>

This change is wrong and breaks tab order in (at least) the office installer.

-- 
James Hawkins


From m.b.lankhorst at gmail.com  Sat May 24 20:25:02 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sat, 24 May 2008 18:25:02 -0700
Subject: Readme: Updates needed
In-Reply-To: <200805241057.35947.kai.blin@gmail.com>
References: <b6bb06270805231456v6dd7d091gc28de1ed4f04dbaa@mail.gmail.com>
	<200805241057.35947.kai.blin@gmail.com>
Message-ID: <b130c85e0805241825o5405b18aj8e6978428270a78d@mail.gmail.com>

Hello,

2008/5/24 Kai Blin <kai.blin at gmail.com>:
> On Friday 23 May 2008 23:56:35 Austin English wrote:
>> Alexandre committed a few fixed to the README today, but I still see a
>> few things that may need fixing:
>>
>> ./tool/wineinstall - Has been mentioned to be deprecated a few times
>> in bugzilla. If it's deprecated, we need to remove it. If not, we need
>> to fix whatever it's doing wrong and stop discouraging its use.
>
> I think I've fixed this one quite some time ago. Is there anything wrong with
> it?
Why would we need to obscure the ./configure && make && su -c / sudo
"make install" ?

It's just useless and doesn't serve any purpose imho

Cheers,
Maarten


From dank at kegel.com  Sat May 24 21:41:40 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 24 May 2008 19:41:40 -0700
Subject: winetest failure summary for 1.0rc2
Message-ID: <a71bd89a0805241941k51a318e5ybde9997bf605c117@mail.gmail.com>

Wow, lots of people submitted test results for 1.0rc2 already!
I ran my skipgood filter on it, put the digested data up at
http://kegel.com/wine/failing-1.0-rc2.html
and added a little analysis to
http://wiki.winehq.org/MakeTestFailures
To wit:

-- snip ---

Tests that fail on most versions of Windows

As of 1.0-rc2, the following tests all fail on 2000, XP, 2003, and Vista:

comctl32:listview ddraw:d3d gdi32:metafile kernel32:toolhelp
mshtml:htmldoc oleaut32:olefont

and a bunch more fail on most of those versions of Windows. See
http://kegel.com/wine/failing-1.0-rc2.html for the full data.

Most Common Failures on XP

As of 1.0-rc2, the following tests fail on all machines running XP:

comctl32:listview ddraw:d3d gdi32:metafile kernel32:actctx
kernel32:toolhelp mshtml:htmldoc msvcrt:cpp oleaut32:olefont
urlmon:url user32:input user32:listbox user32:msg

and a whole mess fail for nearly all reporters. See
http://kegel.com/wine/failing-1.0-rc2.html for the full data.

Most Common Failures on Wine

As of 1.0-rc2, here are the tests that fail on some Wine systems, and
how many people they fail for:

14 user32:msg
12 user32:win
9 user32:input
6 dsound:ds3d dsound:ds3d8 kernel32:path user32:monitor
5 kernel32:process msi:install msi:package riched20:editor
4 comctl32:listview ddraw:visual dinput:device gdi32:font
gdi32:metafile kernel32:profile kernel32:sync kernel32:virtual
snmpapi:util urlmon:protocol user32:class wininet:internet
3 comctl32:monthcal ddraw:d3d kernel32:volume msi:msi setupapi:devinst
shell32:shlfolder user32:menu userenv:userenv
2 advapi32:registry advapi32:security advapi32:service
comctl32:tooltips d3d8:visual d3d9:visual ddraw:dsurface dsound:dsound
kernel32:version msvcrt:time ntdll:exception psapi:psapi_main
qedit:mediadet
1 advpack:advpack advpack:install ...[many deleted]... wininet:http
winmm:wave winspool.drv:info

Whew, that's a lot of data. I looked at all the ones that failed for
five or more people:

user32:msg, user32:win, and user32:input are probably people running
non-blessed window managers; Alexandre's position is that we can
ignore these, since upstream gnome's WM is fixed.

dsound:ds3d is mostly "ds3d.c:891: Test failed: The primary volume
changed from -27 to -960" (worrisome, random) plus "ds3d.c:896: Test
failed: The primary pan changed from -5594 to -5595" (rounding error,
just add slop of 1?). dsound:ds3d8 is the same.

kernel32:path is mostly
"path.c:899:TMP=c:\windows\temp"..."path.c:1178: Test failed: expected
buf[0] upper case letter got c", probably people whose ~/.wine is old
and has a windir that starts with a lowercase drive letter?! Has that
changed recently?

msi:install is mostly "install.c:4414: Test failed: File installed".

msi:package is mostly "package.c:1661: Test failed: wrong return val (0)"

riched20:editor has several failures.
--- snip ---


From jwhite at winehq.org  Sat May 24 21:49:07 2008
From: jwhite at winehq.org (Jeremy White)
Date: Sat, 24 May 2008 21:49:07 -0500
Subject: winetest failure summary for 1.0rc2
In-Reply-To: <a71bd89a0805241941k51a318e5ybde9997bf605c117@mail.gmail.com>
References: <a71bd89a0805241941k51a318e5ybde9997bf605c117@mail.gmail.com>
Message-ID: <4838D3A3.5010803@winehq.org>

> kernel32:path is mostly
> "path.c:899:TMP=c:\windows\temp"..."path.c:1178: Test failed: expected
> buf[0] upper case letter got c", probably people whose ~/.wine is old
> and has a windir that starts with a lowercase drive letter?! Has that
> changed recently?
> 

I don't think it can be a stale .wine; presuming those were all done with
dotests, it creates a new wineprefix for each run.

Cheers,

Jeremy



From truiken at gmail.com  Sat May 24 21:53:49 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 24 May 2008 21:53:49 -0500
Subject: winetest failure summary for 1.0rc2
In-Reply-To: <a71bd89a0805241941k51a318e5ybde9997bf605c117@mail.gmail.com>
References: <a71bd89a0805241941k51a318e5ybde9997bf605c117@mail.gmail.com>
Message-ID: <22821af30805241953u65bba4eeiea030aa841bd8e76@mail.gmail.com>

On Sat, May 24, 2008 at 9:41 PM, Dan Kegel <dank at kegel.com> wrote:
> Wow, lots of people submitted test results for 1.0rc2 already!
> I ran my skipgood filter on it, put the digested data up at
> http://kegel.com/wine/failing-1.0-rc2.html
> and added a little analysis to
> http://wiki.winehq.org/MakeTestFailures
> To wit:
>
> -- snip ---
>
> Tests that fail on most versions of Windows
>
> As of 1.0-rc2, the following tests all fail on 2000, XP, 2003, and Vista:
>
> comctl32:listview ddraw:d3d gdi32:metafile kernel32:toolhelp
> mshtml:htmldoc oleaut32:olefont
>

I'm gonna break this list up to make it easier to read:

comctl32:listview
* fixed by this patch,
http://winehq.org/pipermail/wine-patches/2008-May/055110.html

ddraw:d3d
* result of vmware driver bugs, most of which have been ferreted out,
but I'm leaving these up to Stefan D. for now

gdi32:metafile
* Dmitry's previous patch brought the number of test failures down
from ~10 to 1, so I'm hoping he can get this last one next

kernel32:toolhelp
* see the discussion at,
http://winehq.org/pipermail/wine-devel/2008-April/065040.html

mshtml:htmldoc
* I sent in a patch for a few failures in win2k3, have to ask Jacek C.
about the other two:
http://winehq.org/pipermail/wine-patches/2008-May/055087.html

oleaut32:olefont
* I've been in private discussion with Walt Ogburn about these tests.
He swears they passed when he wrote them, and he doesn't know why they
don't pass now.  If he or someone else can't find a fix, I think the
test should be removed because we're conforming to a behavior that
doesn't match any windows version.


> and a bunch more fail on most of those versions of Windows. See
> http://kegel.com/wine/failing-1.0-rc2.html for the full data.
>
> Most Common Failures on XP
>
> As of 1.0-rc2, the following tests fail on all machines running XP:
>
> comctl32:listview ddraw:d3d gdi32:metafile kernel32:actctx
> kernel32:toolhelp mshtml:htmldoc msvcrt:cpp oleaut32:olefont
> urlmon:url user32:input user32:listbox user32:msg
>

kernel32:actctx
* fixed by a patch I'm sending in Sunday night

user32:input
* had a private discussion with Vitaliy.  He said he wrote the tests
to pass in win2k, doesn't care that they don't pass for other
platforms


-- 
James Hawkins


From dank at kegel.com  Sat May 24 22:18:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 24 May 2008 20:18:18 -0700
Subject: winetest failure summary for 1.0rc2
In-Reply-To: <4838D3A3.5010803@winehq.org>
References: <a71bd89a0805241941k51a318e5ybde9997bf605c117@mail.gmail.com>
	<4838D3A3.5010803@winehq.org>
Message-ID: <a71bd89a0805242018u414c8de6uf8f49169e985d0a4@mail.gmail.com>

On Sat, May 24, 2008 at 7:49 PM, Jeremy White <jwhite at winehq.org> wrote:
>> kernel32:path is mostly
>> "path.c:899:TMP=c:\windows\temp"..."path.c:1178: Test failed: expected
>> buf[0] upper case letter got c", probably people whose ~/.wine is old
>> and has a windir that starts with a lowercase drive letter?! Has that
>> changed recently?
>
> I don't think it can be a stale .wine; presuming those were all done with
> dotests, it creates a new wineprefix for each run.

The guys with those failures aren't running dotest, darn it.

Figured out why so many people are running winetest on windows today:
http://linux.slashdot.org/comments.pl?sid=563226&cid=23530662

Added James' comments to the wiki page, thanks.


From dank at kegel.com  Sat May 24 22:21:24 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 24 May 2008 20:21:24 -0700
Subject: winetest failure summary for 1.0rc2
In-Reply-To: <a71bd89a0805242018u414c8de6uf8f49169e985d0a4@mail.gmail.com>
References: <a71bd89a0805241941k51a318e5ybde9997bf605c117@mail.gmail.com>
	<4838D3A3.5010803@winehq.org>
	<a71bd89a0805242018u414c8de6uf8f49169e985d0a4@mail.gmail.com>
Message-ID: <a71bd89a0805242021w75ef0b6fh4e0fbe7f4216736a@mail.gmail.com>

On Sat, May 24, 2008 at 8:18 PM, Dan Kegel <dank at kegel.com> wrote:
> Figured out why so many people are running winetest on windows today:
> http://linux.slashdot.org/comments.pl?sid=563226&cid=23530662

I wanted to reply to that post, but /. locked me out.
If anyone else wants to do it, here's what I was going to say:

--- snip ---

See also
<a href="http://wiki.winehq.org/ConformanceTests">http://wiki.winehq.org/ConformanceTests</a>
and
<a href="http://wiki.winehq.org/MakeTestFailures">http://wiki.winehq.org/MakeTestFailures</a>

For those wondering where the latest data is: in <a
href="http://test.winehq.org">http://test.winehq.org</a>, click on the
"Last Modified" column twice, that will bring the latest data to the
top.

Thanks to everyone who submitted data so far! We have enough reports
for XP now, but any other version of Windows would be handy.

Be sure to run this again when wine-1.0-rc3 comes out next week.


From jwhite at winehq.org  Sat May 24 22:39:22 2008
From: jwhite at winehq.org (Jeremy White)
Date: Sat, 24 May 2008 22:39:22 -0500
Subject: winetest failure summary for 1.0rc2
In-Reply-To: <a71bd89a0805242021w75ef0b6fh4e0fbe7f4216736a@mail.gmail.com>
References: <a71bd89a0805241941k51a318e5ybde9997bf605c117@mail.gmail.com>	<4838D3A3.5010803@winehq.org>	<a71bd89a0805242018u414c8de6uf8f49169e985d0a4@mail.gmail.com>
	<a71bd89a0805242021w75ef0b6fh4e0fbe7f4216736a@mail.gmail.com>
Message-ID: <4838DF6A.2030305@winehq.org>

> I wanted to reply to that post, but /. locked me out.
> If anyone else wants to do it, here's what I was going to say:

They shifted to new servers tonight, probably had something to do with it.

I plagiarized your post completely.

Cheers,

Jeremy


From marcus at jet.franken.de  Sun May 25 03:30:05 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Sun, 25 May 2008 10:30:05 +0200
Subject: winetest failure summary for 1.0rc2
In-Reply-To: <22821af30805241953u65bba4eeiea030aa841bd8e76@mail.gmail.com>
References: <a71bd89a0805241941k51a318e5ybde9997bf605c117@mail.gmail.com>
	<22821af30805241953u65bba4eeiea030aa841bd8e76@mail.gmail.com>
Message-ID: <20080525083005.GC19736@galeere>

> oleaut32:olefont
> * I've been in private discussion with Walt Ogburn about these tests.
> He swears they passed when he wrote them, and he doesn't know why they
> don't pass now.  If he or someone else can't find a fix, I think the
> test should be removed because we're conforming to a behavior that
> doesn't match any windows version.

You can test these ones easily on Linux with a native oleaut32.dll btw using

WINEDLLOVERRIDES=oleaut32=n wine oleaut32_test.exe.so olefont

Ciao, Marcus


From dank at kegel.com  Sun May 25 05:28:35 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 25 May 2008 03:28:35 -0700
Subject: How to phrase Wine's success rate
Message-ID: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>

When making announcements about Wine 1.0, it's useful
to include an objective measure of how well it works for
the average app, one that correctly conveys both
Wine's promise and its limitations.

Our current appdb stats are:

Platinum	1500
Gold    	1763
Silver  	1194
Bronze  	1071
Garbage 	2512

That's 19% platinum and 41% gold-or-platinum.
(Given rating inflation, we probably shouldn't claim that silver
or below means "working" for the average person.)

How about:
"Of the apps we have tested with Wine, about 20% work well,
and about another 20% work but have some glitches."

That assumes we don't have too many regressions.
It'd be nice if the appdb could give finer grained
summaries, e.g. counts of apps that had actually been
tested with wine-1.0rc*.
- Dan


From alex at thehandofagony.com  Sun May 25 05:43:18 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Sun, 25 May 2008 12:43:18 +0200
Subject: How to phrase Wine's success rate
In-Reply-To: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
References: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
Message-ID: <200805251243.18977.alex@thehandofagony.com>

> When making announcements about Wine 1.0, it's useful
> to include an objective measure of how well it works for
> the average app, one that correctly conveys both
> Wine's promise and its limitations.
>
> Our current appdb stats are:
>
> Platinum        1500
> Gold            1763
> Silver          1194
> Bronze          1071
> Garbage         2512
>
> That's 19% platinum and 41% gold-or-platinum.
> (Given rating inflation, we probably shouldn't claim that silver
> or below means "working" for the average person.)
>
> How about:
> "Of the apps we have tested with Wine, about 20% work well,
> and about another 20% work but have some glitches."
>
> That assumes we don't have too many regressions.
> It'd be nice if the appdb could give finer grained
> summaries, e.g. counts of apps that had actually been
> tested with wine-1.0rc*.
> - Dan

Great idea! Should be easy to do once the filtering system is in place.  I'm 
not sure when it will be applied to the appdb source, though.


Alexander N. S?rnes


From paul at astro.gla.ac.uk  Sun May 25 06:04:34 2008
From: paul at astro.gla.ac.uk (Paul Millar)
Date: Sun, 25 May 2008 13:04:34 +0200
Subject: winetest failure summary for 1.0rc2
In-Reply-To: <a71bd89a0805242018u414c8de6uf8f49169e985d0a4@mail.gmail.com>
References: <a71bd89a0805241941k51a318e5ybde9997bf605c117@mail.gmail.com>
	<4838D3A3.5010803@winehq.org>
	<a71bd89a0805242018u414c8de6uf8f49169e985d0a4@mail.gmail.com>
Message-ID: <200805251304.44911.paul@astro.gla.ac.uk>

On Sunday 25 May 2008 05:18:18 Dan Kegel wrote:
> Figured out why so many people are running winetest on windows today:
> http://linux.slashdot.org/comments.pl?sid=563226&cid=23530662

Yes, this was a surprise.

IIRC, these tests are considered slightly hazardous.  In the past we recommend 
that only developers (and others who understand the slight risk) run 
winetest.exe; although obviously the greater coverage is useful.

Before people run the tests, I feel we should give them the opportunity[1] to 
find out:
  a.	what the tests do and why it's useful,
  b.	who should help (e.g., answering the question: how about
	my Win. install inside VMWare?).
  c.	what might go wrong (e.g., stale Reg. entries, computer
	freezing), how likely these problems are to occur and
	how to fix them if they do happen,

I'd recommend we add a clearly worded link at the top of each results page, 
that directs the person to a wiki page with above information.  For example, 
this could be the existing ConformanceTests wiki; although, with the 
additional information, that wiki might be a bit too busy.

Also, it would be nice if we provided some way that end-users could verify the 
authenticity of winetest.exe.  I PGP/GPG sign the binaries, but currently 
those don't propagate to the test-result page, so people probably won't 
see 'em.

Also, detached PGP signatures aren't very handy.  I guess running codesign.exe 
(or equiv[2]) would be better, but I've not used it before and we'd have to 
think about the X509 setup.

Cheers,

Paul.

[1] -- also surprising was that one post to Slashdot and a legit-looking URI 
and many people downloaded and ran winetest.exe.  People's laissez-faire 
attitude towards downloading and running executable content off the Internet 
helps keep the anti-virus business going, I guess :-/

[2] -- A quick search found this: 
http://sourceforge.net/projects/osslsigncode/  I don't know how well it 
works.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080525/bf5989b5/attachment-0001.pgp 

From hintak_leung at yahoo.co.uk  Sat May 24 16:44:47 2008
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Sat, 24 May 2008 22:44:47 +0100
Subject: RFC: comctl32 indentations
In-Reply-To: <200805242150.02081.andrew.talbot@talbotville.com>
References: <200805241022.44447.andrew.talbot@talbotville.com>
	<g18ncv$k2m$1@ger.gmane.org> <48384CA8.6000403@yahoo.co.uk>
	<200805242150.02081.andrew.talbot@talbotville.com>
Message-ID: <48388C4F.1010603@yahoo.co.uk>

Andrew Talbot wrote:
<snipped>
> If, in this case, it turns out that the braces should be added, and doing so 
> would fix some longstanding bug with Photoshop CS2, say, then I doubt that 
> too many people would accuse me of having wasted their time.

This is still a waste of time - I am not going to talk about 'what if's'. Show
me the code and show you that you are right. Don't try to tell me that
you 'may be' right.



From neil at skrypuch.com  Sat May 24 19:06:39 2008
From: neil at skrypuch.com (Neil Skrypuch)
Date: Sat, 24 May 2008 19:06:39 -0500
Subject: Regression in wined3d: Add read_from_framebuffer_texture which
	combines code from read_from_framebuffer (drawpixels) and
	LoadLocation.
In-Reply-To: <200805240155.48802.kde@graph-ix.net>
References: <200805240155.48802.kde@graph-ix.net>
Message-ID: <200805241906.39261.neil@skrypuch.com>

On Friday 23 May 2008, Markus wrote:
> Hi,
>
> after investigating reports for the game 'World in Conflict', I identified
> the following patch to cause the game graphics to freeze (ambient sounds
> are still played though):
>
> ----
> ba90a740beb9ce9a839cc843db8d87f5a37becdd is first bad commit
> commit ba90a740beb9ce9a839cc843db8d87f5a37becdd
> Author: Roderick Colenbrander <thunderbird2k at gmx.net>
> Date:   Sun Feb 10 22:20:15 2008 +0100
>
>     wined3d: Add read_from_framebuffer_texture which combines code from
> read_from_framebuffer (drawpixels) and LoadLocation.
>
>     This makes the code easier to read and the pieces borrowed from
>     read_from_framebuffer are more correct than the code in LoadLocation.
>
> :040000 040000 74e4bdc73e367c8f38cd3d0818df0fc86eb788bf
>
> 3e54409be7c9d2964efbf3d3c2f3d3b84a267047 M      dlls
> ----
>
> The freezes only seem to occur if the native (Windows) dxdiagn.dll is used,
> as it lets the game properly detect the graphics card and thus enables
> additional graphics options (highend shaders, high-res textures, etc.).
> Apparently the freeze is only triggered with these options active.
>
> The game uses events in its drawing code and ("always") hangs after the
> following output:
> fixme:d3d9:D3DPERF_BeginEvent (color 0xffffffff, name L"Update verlet
> cloth") : stub
> fixme:d3d9:D3DPERF_EndEvent (void) : stub
>
> At one point, it was followed by this error:
> err:d3d_surface:surface_prepare_system_memory Surface without memory or pbo
> has SFLAG_INSYSMEM set!
>
> The point of the freeze appears to depend on many factors. If I move the
> camera around, it appears to freeze earlier than just letting the game run
> (e.g. a replay of a match). But once the patch is excluded, the game no
> longer freezes.
>
> If more info is needed, please specify how I can obtain it.

Could you file a bug with the above information? Otherwise it's likely to get 
lost/forgotten.

- Neil


From susancragin at earthlink.net  Sun May 25 06:17:18 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Sun, 25 May 2008 07:17:18 -0400 (GMT-04:00)
Subject: winetest for 1.0rc2 - small post-run error message
Message-ID: <1784299.1211714239006.JavaMail.root@elwamui-mouette.atl.sa.earthlink.net>

Network transfer: Done (1116026 of 1116026)
Finished
susan at ubuntu:~/wine-git/programs/winetest$ fixme:ntdll:RtlNtStatusToDosErrorNoTeb no mapping for 8000000a

susan at ubuntu:~/wine-git/programs/winetest$ 





From kgbricola at web.de  Sun May 25 06:45:48 2008
From: kgbricola at web.de (=?ISO-8859-1?Q?Rico_Sch=FCller?=)
Date: Sun, 25 May 2008 13:45:48 +0200
Subject: Regression in wined3d: Add read_from_framebuffer_texture which
	combines code from read_from_framebuffer (drawpixels) and	LoadLocation.
In-Reply-To: <200805241906.39261.neil@skrypuch.com>
References: <200805240155.48802.kde@graph-ix.net>
	<200805241906.39261.neil@skrypuch.com>
Message-ID: <4839516C.3020601@web.de>

Neil Skrypuch wrote:
> On Friday 23 May 2008, Markus wrote:
>> Hi,
>>
>> after investigating reports for the game 'World in Conflict', I identified
>> the following patch to cause the game graphics to freeze (ambient sounds
>> are still played though):
>>
>> ----
>> ba90a740beb9ce9a839cc843db8d87f5a37becdd is first bad commit
>> commit ba90a740beb9ce9a839cc843db8d87f5a37becdd
>> Author: Roderick Colenbrander <thunderbird2k at gmx.net>
>> Date:   Sun Feb 10 22:20:15 2008 +0100
>>
>>     wined3d: Add read_from_framebuffer_texture which combines code from
>> read_from_framebuffer (drawpixels) and LoadLocation.
>>
>>     This makes the code easier to read and the pieces borrowed from
>>     read_from_framebuffer are more correct than the code in LoadLocation.
>>
>> :040000 040000 74e4bdc73e367c8f38cd3d0818df0fc86eb788bf
>>
>> 3e54409be7c9d2964efbf3d3c2f3d3b84a267047 M      dlls
>> ----
>>
>> The freezes only seem to occur if the native (Windows) dxdiagn.dll is used,
>> as it lets the game properly detect the graphics card and thus enables
>> additional graphics options (highend shaders, high-res textures, etc.).
>> Apparently the freeze is only triggered with these options active.
>>
>> The game uses events in its drawing code and ("always") hangs after the
>> following output:
>> fixme:d3d9:D3DPERF_BeginEvent (color 0xffffffff, name L"Update verlet
>> cloth") : stub
>> fixme:d3d9:D3DPERF_EndEvent (void) : stub
>>
>> At one point, it was followed by this error:
>> err:d3d_surface:surface_prepare_system_memory Surface without memory or pbo
>> has SFLAG_INSYSMEM set!
>>
>> The point of the freeze appears to depend on many factors. If I move the
>> camera around, it appears to freeze earlier than just letting the game run
>> (e.g. a replay of a match). But once the patch is excluded, the game no
>> longer freezes.
>>
>> If more info is needed, please specify how I can obtain it.
> 
> Could you file a bug with the above information? Otherwise it's likely to get 
> lost/forgotten.
> 
> - Neil
> 
> 
> 
Please have a look at this bugs here before you file another one. 
Probably your problem is already reported.

http://bugs.winehq.org/show_bug.cgi?id=11584
http://bugs.winehq.org/show_bug.cgi?id=12550

There are a couple of bugs referred to this patch.

Cheers
Rico


From paul.vriens.wine at gmail.com  Sun May 25 08:17:57 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Sun, 25 May 2008 15:17:57 +0200
Subject: winetest failure summary for 1.0rc2
In-Reply-To: <a71bd89a0805242021w75ef0b6fh4e0fbe7f4216736a@mail.gmail.com>
References: <a71bd89a0805241941k51a318e5ybde9997bf605c117@mail.gmail.com>	<4838D3A3.5010803@winehq.org>	<a71bd89a0805242018u414c8de6uf8f49169e985d0a4@mail.gmail.com>
	<a71bd89a0805242021w75ef0b6fh4e0fbe7f4216736a@mail.gmail.com>
Message-ID: <48396705.60104@gmail.com>

Dan Kegel wrote:
> On Sat, May 24, 2008 at 8:18 PM, Dan Kegel <dank at kegel.com> wrote:
>> Figured out why so many people are running winetest on windows today:
>> http://linux.slashdot.org/comments.pl?sid=563226&cid=23530662
> 
> I wanted to reply to that post, but /. locked me out.
> If anyone else wants to do it, here's what I was going to say:
> 
> --- snip ---
> 
> See also
> <a href="http://wiki.winehq.org/ConformanceTests">http://wiki.winehq.org/ConformanceTests</a>
> and
> <a href="http://wiki.winehq.org/MakeTestFailures">http://wiki.winehq.org/MakeTestFailures</a>
> 
> For those wondering where the latest data is: in <a
> href="http://test.winehq.org">http://test.winehq.org</a>, click on the
> "Last Modified" column twice, that will bring the latest data to the
> top.
> 
There is no need to do the last modified thingy. Alexandre changed that a few 
week ago, it should be the default now to list the newest test results first.

-- 
Cheers,

Paul.


From jan.wine at zerebecki.de  Sun May 25 09:09:28 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sun, 25 May 2008 16:09:28 +0200
Subject: Removinig CVS/GIT version from bugzilla
In-Reply-To: <b130c85e0804230058h5b2fb5dcy74b6181fc52b24f8@mail.gmail.com>
References: <480DF730.6030006@kievinfo.com> <480E587E.3070209@open-vote.org>
	<b130c85e0804221653i1749fbd5i1633279dc015a805@mail.gmail.com>
	<480E84FB.4080700@kievinfo.com>
	<b130c85e0804230058h5b2fb5dcy74b6181fc52b24f8@mail.gmail.com>
Message-ID: <20080525140928.GZ3557@crissy.swd.zerebecki.de>

On Wed, Apr 23, 2008 at 12:58:44AM -0700, Maarten Lankhorst wrote:
> 2008/4/22 Vitaliy Margolen <wine-devel at kievinfo.com>:
> >  Well that will affect closed bugs - which is not good. However I don't have
> >  a strong objection here - whatever works. It would be even better if we can
> >  add the version automatically with release scripts.

Yea adding it's version on release by the scripts would be nice. The
scripts are in one of the git repos on winehq...

> If it is a true rename operation it will. However this will only occur
> once so I think we can live with that. Any bugzilla admins ok with
> this way of doing bug reports? It would make the version a whole lot
> more accurate in the longer run.

Yes versions can be renamed and any bugs that reference them then show
the new name of the version without beeing modified.

We could rename "CVS/GIT" to pre-1.0-git/cvs (or whatever the next
release is). And then for each release e.g. for 1.0.12 we would have
1.0.12 and post-1.0.12-git (for anything that occurs and is fixed before
the release after that).


Jan



From dmitry at codeweavers.com  Sun May 25 09:19:24 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 25 May 2008 23:19:24 +0900
Subject: ws2_32: Add support for FROM_PROTOCOL_INFO to WSASocket()
References: <200805251537.37207.kai@samba.org>
Message-ID: <255B7EDBE90F4509A723E65C35E9419E@DMITRY>

"Kai Blin" <kai.blin at gmail.com> wrote:

> +    {FROM_PROTOCOL_INFO, FROM_PROTOCOL_INFO},
>  };
>  
>  static const int ws_socktype_map[][2] =
> @@ -304,6 +305,7 @@ static const int ws_socktype_map[][2] =
>      MAP_OPTION( SOCK_DGRAM ),
>      MAP_OPTION( SOCK_STREAM ),
>      MAP_OPTION( SOCK_RAW ),
> +    {FROM_PROTOCOL_INFO, FROM_PROTOCOL_INFO},
>  };
>  
>  static const int ws_proto_map[][2] =
> @@ -314,6 +316,7 @@ static const int ws_proto_map[][2] =
>      MAP_OPTION( IPPROTO_ICMP ),
>      MAP_OPTION( IPPROTO_IGMP ),
>      MAP_OPTION( IPPROTO_RAW ),
> +    {FROM_PROTOCOL_INFO, FROM_PROTOCOL_INFO},
>  };

Although it was the case before, it's a mistake to have a comma after
the last struct member initializer.
 
> +    if (lpProtocolInfo) {
> +      if (af == FROM_PROTOCOL_INFO)
> +          af = lpProtocolInfo->iAddressFamily;
> +      if (type == FROM_PROTOCOL_INFO)
> +          type = lpProtocolInfo->iSocketType;
> +      if (protocol == FROM_PROTOCOL_INFO)
> +          protocol = lpProtocolInfo->iProtocol;

Please keep opening brace style/indentation consistent with code you have
removed.

> --- a/include/winsock.h
> +++ b/include/winsock.h
> @@ -146,6 +146,7 @@ extern "C" {
>  /* proper 4-byte packing */
>  #include <pshpack4.h>
>  
> +#define FROM_PROTOCOL_INFO (-1)

PSDK has it in winsock2.h


-- 
Dmitry.


From ivg231 at gmail.com  Sun May 25 11:03:05 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Sun, 25 May 2008 12:03:05 -0400
Subject: How to phrase Wine's success rate
In-Reply-To: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
References: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
Message-ID: <48398DB9.8060208@gmail.com>


> "Of the apps we have tested with Wine, about 20% work well,
> and about another 20% work but have some glitches."
>
>   
Just my opinion, but that's a terrible idea to put in the 1.0 
announcement. The impression I get after reading this is (1) wine is 
full of glitches, and (2)  it's being released with 80% of the apps not 
working well.

If you're trying to appeal to new users and/or sponsors you should put 
more focus on the positives. I don't see Fedora saying "Release features 
include X, Y and Z, but X has a bunch of bugs" (X might be full of bugs, 
but you don't point this out in your release announcement ).

Ivan










From leszek.hanusz at gmail.com  Sun May 25 11:49:24 2008
From: leszek.hanusz at gmail.com (leszek)
Date: Sun, 25 May 2008 18:49:24 +0200
Subject: How to phrase Wine's success rate
In-Reply-To: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
References: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
Message-ID: <1211734164.7575.2.camel@localhost>

Is there somewhere a graph showing the evolution of the appdb stats over
time ?

-Leszek

Le dimanche 25 mai 2008 ? 03:28 -0700, Dan Kegel a ?crit :
> When making announcements about Wine 1.0, it's useful
> to include an objective measure of how well it works for
> the average app, one that correctly conveys both
> Wine's promise and its limitations.
> 
> Our current appdb stats are:
> 
> Platinum	1500
> Gold    	1763
> Silver  	1194
> Bronze  	1071
> Garbage 	2512
> 
> That's 19% platinum and 41% gold-or-platinum.
> (Given rating inflation, we probably shouldn't claim that silver
> or below means "working" for the average person.)
> 
> How about:
> "Of the apps we have tested with Wine, about 20% work well,
> and about another 20% work but have some glitches."
> 
> That assumes we don't have too many regressions.
> It'd be nice if the appdb could give finer grained
> summaries, e.g. counts of apps that had actually been
> tested with wine-1.0rc*.
> - Dan
> 
> 



From dank at kegel.com  Sun May 25 11:55:51 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 25 May 2008 09:55:51 -0700
Subject: How to phrase Wine's success rate
In-Reply-To: <48398DB9.8060208@gmail.com>
References: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
	<48398DB9.8060208@gmail.com>
Message-ID: <a71bd89a0805250955t4deec15fleb8dfdcdf9512d2e@mail.gmail.com>

On Sun, May 25, 2008 at 9:03 AM, Ivan Gyurdiev <ivg231 at gmail.com> wrote:
>> "Of the apps we have tested with Wine, about 20% work well,
>> and about another 20% work but have some glitches."
>
> Just my opinion, but that's a terrible idea to put in the 1.0 announcement.
> The impression I get after reading this is (1) wine is full of glitches, and
> (2)  it's being released with 80% of the apps not working well.

But if we aren't realistic, we'll get lots of blowback saying
"Wine is full of glitches, and most things I try don't work!  Wine is crap!"
Better that they know the limitations ahead of time.

How about this for more positive yet realistic phrasing:
"Of the apps we have tested with Wine, about half work well
enough to try, and of those, half work well enough to use routinely.
In particular, Photoshop CS2, World of Warcraft, Firefox 2, and many
small apps run very well.  .NET based apps and Photoshop CS3
are not yet supported."

> If you're trying to appeal to new users and/or sponsors you should put more
> focus on the positives. I don't see Fedora saying "Release features include
> X, Y and Z, but X has a bunch of bugs"

That's because Fedora largely works far better than Wine does.
- Dan


From kai.blin at gmail.com  Sun May 25 13:00:34 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Sun, 25 May 2008 20:00:34 +0200
Subject: ws2_32: Add support for FROM_PROTOCOL_INFO to WSASocket()
In-Reply-To: <255B7EDBE90F4509A723E65C35E9419E@DMITRY>
References: <200805251537.37207.kai@samba.org>
	<255B7EDBE90F4509A723E65C35E9419E@DMITRY>
Message-ID: <200805252000.37341.kai.blin@gmail.com>

On Sunday 25 May 2008 16:19:24 Dmitry Timoshkov wrote:

> > @@ -314,6 +316,7 @@ static const int ws_proto_map[][2] =
> >      MAP_OPTION( IPPROTO_ICMP ),
> >      MAP_OPTION( IPPROTO_IGMP ),
> >      MAP_OPTION( IPPROTO_RAW ),
> > +    {FROM_PROTOCOL_INFO, FROM_PROTOCOL_INFO},
> >  };
>
> Although it was the case before, it's a mistake to have a comma after
> the last struct member initializer.

It is?  K&R seems to use both, so I preferred to keep it similar to all the 
other struct member initializers.

> > +    if (lpProtocolInfo) {
> > +      if (af == FROM_PROTOCOL_INFO)
> > +          af = lpProtocolInfo->iAddressFamily;
> > +      if (type == FROM_PROTOCOL_INFO)
> > +          type = lpProtocolInfo->iSocketType;
> > +      if (protocol == FROM_PROTOCOL_INFO)
> > +          protocol = lpProtocolInfo->iProtocol;
>
> Please keep opening brace style/indentation consistent with code you have
> removed.

The function is a mess with brace style and indentation. I've used the same 
indentaion as the if right above this one. The function wildly mixes 
two-space, three-space and four-space indents. In this case, I used two-space 
indents for the outer if and four-space indents for the inner ifs for better 
readability.

> > --- a/include/winsock.h
> > +++ b/include/winsock.h
> > @@ -146,6 +146,7 @@ extern "C" {
> >  /* proper 4-byte packing */
> >  #include <pshpack4.h>
> >
> > +#define FROM_PROTOCOL_INFO (-1)
>
> PSDK has it in winsock2.h

PSDK has the AF_*, PF_*, SOCK_* and IPPROTO_* defines in winsock2.h as well, 
Wine hasn't. I preferred to keep them together.

I don't fully understand why people suddenly start getting picky about stuff 
like this when noone previously gave a damn. As it's not acceptable to just 
go over this mess with indent, I don't see how conforming to one sort of 
messy indentation is preferrable to another sort of messy indentation.

Seriously, this patch fixes a bug, take it or leave it and fix it yourself.
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080525/fdf54b03/attachment.pgp 

From ivg231 at gmail.com  Sun May 25 13:24:29 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Sun, 25 May 2008 14:24:29 -0400
Subject: How to phrase Wine's success rate
In-Reply-To: <a71bd89a0805250955t4deec15fleb8dfdcdf9512d2e@mail.gmail.com>
References: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>	
	<48398DB9.8060208@gmail.com>
	<a71bd89a0805250955t4deec15fleb8dfdcdf9512d2e@mail.gmail.com>
Message-ID: <4839AEDD.4050403@gmail.com>


> How about this for more positive yet realistic phrasing:
> "Of the apps we have tested with Wine, about half work well
> enough to try, and of those, half work well enough to use routinely.
> In particular, Photoshop CS2, World of Warcraft, Firefox 2, and many
> small apps run very well.  .NET based apps and Photoshop CS3
> are not yet supported."
>   
That just sounds more confusing...

Is "percent of apps we tested" a formal release criterion for Wine 1.0 ?
If not, the stats seem irrelevant as far as this release is concerned.
If yes, why release with so many apps not working well ?

If you want to set realistic expectations - list major supported apps 
along with a link to appdb called "Will my app work under WINE?".  Then 
the users will have a realistic expectation of whether their individual 
apps work. Setting realistic expectations with a rather low percentage 
number just means a lot of people won't even bother trying.

Ivan



From ordocg at gmail.com  Sun May 25 11:02:07 2008
From: ordocg at gmail.com (doc)
Date: Sun, 25 May 2008 12:02:07 -0400
Subject: Suggestions for AppDB/comment system
Message-ID: <48398D7F.3030002@gmail.com>

Currently the replied comments require loading another page. I would 
like to suggest making the comment load in the same page using some 
javascript/ajax. I would submit a patch to do this, but I notice the 
appdb webpage is not being version controlled (as far as I can tell).

So another suggestion I have is to put AppDB code into git :) I am also 
forwarding this to appdb at winehq.org but would like other peoples input.



From dank at kegel.com  Sun May 25 13:41:51 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 25 May 2008 11:41:51 -0700
Subject: How to phrase Wine's success rate
In-Reply-To: <4839AEDD.4050403@gmail.com>
References: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
	<48398DB9.8060208@gmail.com>
	<a71bd89a0805250955t4deec15fleb8dfdcdf9512d2e@mail.gmail.com>
	<4839AEDD.4050403@gmail.com>
Message-ID: <a71bd89a0805251141j58aad0f5n2d30780085c5bd18@mail.gmail.com>

On 5/25/08, Ivan Gyurdiev <ivg231 at gmail.com> wrote:
> > How about this for more positive yet realistic phrasing:
> > "Of the apps we have tested with Wine, about half work well
> > enough to try, and of those, half work well enough to use routinely.
> > In particular, Photoshop CS2, World of Warcraft, Firefox 2, and many
> > small apps run very well.  .NET based apps and Photoshop CS3
> > are not yet supported."
>
> That just sounds more confusing...
>
> Is "percent of apps we tested" a formal release criterion for Wine 1.0 ?

No.

> If not, the stats seem irrelevant as far as this release is concerned.

Here's how it's relevant: if we just say "Wine 1.0 is great!  Try it!",
people will try it, find it doesn't work for three quarters of their apps,
and conclude that Wine sucks.  We want to avoid that by owning
the issue, and informing people in advance that not all apps work.

> If you want to set realistic expectations - list major supported apps along
> with a link to appdb called "Will my app work under WINE?".  Then the users
> will have a realistic expectation of whether their individual apps work.

The appdb does not have complete or accurate information, and
lots of people won't even bother to find their app in it.
While we should indeed link to it, we should also give people
an overall idea of how well Wine works.

> Setting realistic expectations with a rather low percentage number just
> means a lot of people won't even bother trying.

Better that than they try it and conclude that it sucks.

One more try:
"Wine 1.0 runs apps like Photoshop CS2, World of Warcraft, Firefox 2,
and a thousand other apps (see http://appdb.winehq.org) well.
Try it on your favorite app and see if it works for you; the smaller
the app, the more likely it is to work well.
Photoshop CS3 and .NET applications are not yet supported.
Wine is continually improving, and many apps that didn't work well last year
work well now.  Overall, about one in four apps tested work well as of
Wine 1.0.  See the Wine FAQ (http://wiki.winehq.org) for more info."

- Dan


From xixsimplicityxix at gmail.com  Sun May 25 13:44:27 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Sun, 25 May 2008 13:44:27 -0500
Subject: Suggestions for AppDB/comment system
In-Reply-To: <48398D7F.3030002@gmail.com>
References: <48398D7F.3030002@gmail.com>
Message-ID: <78a7dad00805251144y22cc975clb8255f21471bdc65@mail.gmail.com>

On Sun, May 25, 2008 at 11:02 AM, doc <ordocg at gmail.com> wrote:
> Currently the replied comments require loading another page. I would
> like to suggest making the comment load in the same page using some
> javascript/ajax. I would submit a patch to do this, but I notice the
> appdb webpage is not being version controlled (as far as I can tell).
>
> So another suggestion I have is to put AppDB code into git :) I am also
> forwarding this to appdb at winehq.org but would like other peoples input.
>

I would agree that we could have better documentation of where the
repo is but there is one and it is here:
http://source.winehq.org/git/appdb.git/

Other repos you may or may not be aware of are here:
http://source.winehq.org/git/


From adam at tpetaccia.com  Sun May 25 14:27:20 2008
From: adam at tpetaccia.com (Adam Petaccia)
Date: Sun, 25 May 2008 15:27:20 -0400
Subject: How to phrase Wine's success rate
In-Reply-To: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
References: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
Message-ID: <1211743640.10285.1.camel@pimpmobile>

While I'd like to stay positive, this report assumes that all users who
have an application that doesn't work immediately run out and report it
to the AppDB as garbage (and while I know the same is true for apps that
do work, I'd assume its a much higher proportion of the the former).

On Sun, 2008-05-25 at 03:28 -0700, Dan Kegel wrote:
> When making announcements about Wine 1.0, it's useful
> to include an objective measure of how well it works for
> the average app, one that correctly conveys both
> Wine's promise and its limitations.
> 
> Our current appdb stats are:
> 
> Platinum	1500
> Gold    	1763
> Silver  	1194
> Bronze  	1071
> Garbage 	2512
> 
> That's 19% platinum and 41% gold-or-platinum.
> (Given rating inflation, we probably shouldn't claim that silver
> or below means "working" for the average person.)
> 
> How about:
> "Of the apps we have tested with Wine, about 20% work well,
> and about another 20% work but have some glitches."
> 
> That assumes we don't have too many regressions.
> It'd be nice if the appdb could give finer grained
> summaries, e.g. counts of apps that had actually been
> tested with wine-1.0rc*.
> - Dan
> 
> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080525/2e48445c/attachment.pgp 

From kde at graph-ix.net  Sun May 25 14:33:26 2008
From: kde at graph-ix.net (Markus)
Date: Sun, 25 May 2008 21:33:26 +0200
Subject: How to phrase Wine's success rate
In-Reply-To: <a71bd89a0805251141j58aad0f5n2d30780085c5bd18@mail.gmail.com>
References: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
	<4839AEDD.4050403@gmail.com>
	<a71bd89a0805251141j58aad0f5n2d30780085c5bd18@mail.gmail.com>
Message-ID: <200805252133.26453.kde@graph-ix.net>

On Sunday 25 May 2008 20:41:51 Dan Kegel wrote:
> One more try:
> "Wine 1.0 runs apps like Photoshop CS2, World of Warcraft, Firefox 2,
> and a thousand other apps (see http://appdb.winehq.org) well.
> Try it on your favorite app and see if it works for you; the smaller
> the app, the more likely it is to work well.
> Photoshop CS3 and .NET applications are not yet supported.
> Wine is continually improving, and many apps that didn't work well last
> year work well now.  Overall, about one in four apps tested work well as of
> Wine 1.0.  See the Wine FAQ (http://wiki.winehq.org) for more info."

I think games are important to mention explicitly at least once. Therefore (+ 
a bit of restructuring):

"Wine 1.0 runs thousands of applications and games well, among them Photoshop 
CS2 and World of Warcraft. To find out if your favorite applications work, 
try them on Wine yourself or consult our application database under 
http://appdb.winehq.org. While some complex applications such as Photoshop 
CS3 and software written with .NET are not supported yet, you will find that 
many simple applications will work. In addition, Wine is continually 
improving and we expect to support even more applications in the future. 
Overall, about one in four tested applications work well as of Wine 1.0.  See 
the Wine FAQ (http://wiki.winehq.org) for more info."


-- 
Markus


From ordocg at gmail.com  Sun May 25 13:51:07 2008
From: ordocg at gmail.com (Doc)
Date: Sun, 25 May 2008 14:51:07 -0400
Subject: Suggestions for AppDB/comment system
In-Reply-To: <78a7dad00805251144y22cc975clb8255f21471bdc65@mail.gmail.com>
References: <48398D7F.3030002@gmail.com>
	<78a7dad00805251144y22cc975clb8255f21471bdc65@mail.gmail.com>
Message-ID: <1254a6030805251151s521074bcrc3eaca3605301eaa@mail.gmail.com>

On Sun, May 25, 2008 at 2:44 PM, John Klehm <xixsimplicityxix at gmail.com>
wrote:

>
> I would agree that we could have better documentation of where the
> repo is but there is one and it is here:
> http://source.winehq.org/git/appdb.git/
>
> Other repos you may or may not be aware of are here:
> http://source.winehq.org/git/
>

It was an oversight on my part, Chris also pointed me in the right
direction.

Thanks John
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080525/aed75700/attachment.htm 

From scott at open-vote.org  Sun May 25 16:53:51 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Sun, 25 May 2008 14:53:51 -0700
Subject: How to phrase Wine's success rate
In-Reply-To: <48398DB9.8060208@gmail.com>
References: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
	<48398DB9.8060208@gmail.com>
Message-ID: <4839DFEF.1050700@open-vote.org>

Ivan Gyurdiev wrote:
>> "Of the apps we have tested with Wine, about 20% work well,
>> and about another 20% work but have some glitches."
>>
>>   
> Just my opinion, but that's a terrible idea to put in the 1.0 
> announcement. The impression I get after reading this is (1) wine is 
> full of glitches, and (2)  it's being released with 80% of the apps not 
> working well.

Number of apps working is a bad measure anyway - who cares if 99% of
applications don't work if users only want the one that actually does?

This is in Wine's favor, as we've prioritized work on popular
applications, both intentionally through developer efforts and also
accidentally through receiving more bug reports.

Thanks,
Scott Ritchie


From xerox_xerox2000 at yahoo.co.uk  Sun May 25 16:58:46 2008
From: xerox_xerox2000 at yahoo.co.uk (Louis Lenders)
Date: Sun, 25 May 2008 21:58:46 +0000 (UTC)
Subject: How to phrase Wine's success rate
References: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
Message-ID: <loom.20080525T215148-848@post.gmane.org>

Dan Kegel <dank <at> kegel.com> writes:

> 
> When making announcements about Wine 1.0, it's useful
> to include an objective measure of how well it works for
> the average app, one that correctly conveys both
> Wine's promise and its limitations.
> 
> Our current appdb stats are:
> 
> Platinum	1500
> Gold    	1763
> Silver  	1194
> Bronze  	1071
> Garbage 	2512
> 


I think it's important to add a note for the user that wine needs a bunch of
tweaking. 


From wine.dev at web.de  Sun May 25 17:25:39 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Mon, 26 May 2008 00:25:39 +0200
Subject: avifil32/tests: [2/2] Add a test for AVISaveOptions and fix
	thedetected crash
In-Reply-To: <7945F3A65232412E87E28E5D8E809561@DMITRY>
References: <1211580824.25296.21.camel@p4>
	<7945F3A65232412E87E28E5D8E809561@DMITRY>
Message-ID: <1211754339.1807.8.camel@p4>

On Sa, 2008-05-24 at 12:06 +0900, Dmitry Timoshkov wrote:
> "Detlef Riekenberg" <wine.dev at web.de> wrote:
> 
> > -  for (; nStreams > 0; nStreams--) {
> > +  for (nStreams--; nStreams >= 0; nStreams--) {
> >      if (ppOptions[nStreams] != NULL) {
> >        ppOptions[nStreams]->dwFlags &= ~AVICOMPRESSF_VALID;
> 
> Shouldn't this be
> 
> for (nStreams - 1; nStreams >= 0; nStreams--) {
> 
> instead?

No.
You still read the memory after the array,
since nStreams is used as index.


-- 
 
By by ... Detlef




From dank at kegel.com  Sun May 25 18:05:24 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 25 May 2008 16:05:24 -0700
Subject: How to phrase Wine's success rate
In-Reply-To: <4839DFEF.1050700@open-vote.org>
References: <a71bd89a0805250328q674022efubf2a85e5de7cf5c7@mail.gmail.com>
	<48398DB9.8060208@gmail.com> <4839DFEF.1050700@open-vote.org>
Message-ID: <a71bd89a0805251605p5abb574fgb01dcc2ad698a164@mail.gmail.com>

Louis wrote:
> I think it's important to add a note for the user that wine needs a bunch of
> tweaking.

It shouldn't need any tweaking at all for platinum apps.

Any apps rated platinum that need tweaking are misrated,
and we should bop them down to gold.
- Dan


From msclrhd at googlemail.com  Sun May 25 18:11:37 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Mon, 26 May 2008 00:11:37 +0100
Subject: Best place for HOWTO documents for your favourite application?
Message-ID: <3f4fd2640805251611w2f81804j29a33a316e59dd69@mail.gmail.com>

Hi,

I have been trying our various Oberon Media games. The thing that is
holding this up from working is the hyperlinks on the intro screen (I
am going to enter a bug report later on).

I have worked out how to run and register the games (given a valid
registration key that you have purchased) so that they will work under
Wine. So this got me wondering... where do I put this?

This complements the appdb, but is in a way orthogonal to it (that is
there may be HOWTOs relating to individual games/applications, to
vendors or to other areas such as installing Windows themes like the
Zune theme). It will also help when more people start using Wine and
want to get their favorite application running.

My initial thoughts are that the wiki seems like a good place for
this. Thoughts? Comments?

- Reece


From austinenglish at gmail.com  Sun May 25 20:07:20 2008
From: austinenglish at gmail.com (Austin English)
Date: Sun, 25 May 2008 20:07:20 -0500
Subject: Best place for HOWTO documents for your favourite application?
In-Reply-To: <3f4fd2640805251611w2f81804j29a33a316e59dd69@mail.gmail.com>
References: <3f4fd2640805251611w2f81804j29a33a316e59dd69@mail.gmail.com>
Message-ID: <b6bb06270805251807s217c781fsd50829e0b07190c8@mail.gmail.com>

On Sun, May 25, 2008 at 6:11 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
> Hi,
>
> I have been trying our various Oberon Media games. The thing that is
> holding this up from working is the hyperlinks on the intro screen (I
> am going to enter a bug report later on).
>
> I have worked out how to run and register the games (given a valid
> registration key that you have purchased) so that they will work under
> Wine. So this got me wondering... where do I put this?
>
> This complements the appdb, but is in a way orthogonal to it (that is
> there may be HOWTOs relating to individual games/applications, to
> vendors or to other areas such as installing Windows themes like the
> Zune theme). It will also help when more people start using Wine and
> want to get their favorite application running.
>
> My initial thoughts are that the wiki seems like a good place for
> this. Thoughts? Comments?
>
> - Reece
>
>
>

I don't see why this shouldn't be put in the AppDB. The wiki may be
useful for installing themes, etc., but this seems to be related to a
particular app/vendor, and should be in the AppDB.


From truiken at gmail.com  Sun May 25 20:15:57 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 25 May 2008 20:15:57 -0500
Subject: [PATCH] - fall back to the main HWND when there is no IMM HWND
In-Reply-To: <20080525235920.GA21764@via.ecp.fr>
References: <20080525235920.GA21764@via.ecp.fr>
Message-ID: <22821af30805251815n37bb7796uaa6285abd1814fa1@mail.gmail.com>

On Sun, May 25, 2008 at 6:59 PM, Christopher GAUTIER <krys at via.ecp.fr> wrote:
>
> Description:
>
> It is apparently valid to call ImmGetDefaultIMEWnd() without first
> opening the IME with ImmSetOpenStatus(). In such cases,
> ImmGetDefaultIMEWnd returns NULL (the value of hwndDefault), which
> indicates a failure according to MSDN. As a result, some applications
> may report a IME failure. Fallbacking to the main window handle fixes
> this.
>
>
> Changelog:
>  - dlls/imm32/imm.c: fall back to the main HWND when there is no IMM
>    HWND in ImmGetDefaultIMEWnd()
>

Please add a test case to prove this behavior is correct.

-- 
James Hawkins


From dmitry at codeweavers.com  Sun May 25 22:08:46 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 26 May 2008 12:08:46 +0900
Subject: ws2_32: Add support for FROM_PROTOCOL_INFO to WSASocket()
References: <200805251537.37207.kai@samba.org><255B7EDBE90F4509A723E65C35E9419E@DMITRY>
	<200805252000.37341.kai.blin@gmail.com>
Message-ID: <703E678AF9AF477B9813D6B7C800C122@DMITRY>

"Kai Blin" <kai.blin at gmail.com> wrote:

> > > +    {FROM_PROTOCOL_INFO, FROM_PROTOCOL_INFO},
> > >  };
> >
> > Although it was the case before, it's a mistake to have a comma after
> > the last struct member initializer.
> 
> It is?  K&R seems to use both, so I preferred to keep it similar to all the 
> other struct member initializers.

I said "a mistake" not "an error". Although the compiler forgives this, what
the last comma is serving for?

> > > +    if (lpProtocolInfo) {
> > > +      if (af == FROM_PROTOCOL_INFO)
> > > +          af = lpProtocolInfo->iAddressFamily;
> > > +      if (type == FROM_PROTOCOL_INFO)
> > > +          type = lpProtocolInfo->iSocketType;
> > > +      if (protocol == FROM_PROTOCOL_INFO)
> > > +          protocol = lpProtocolInfo->iProtocol;
> >
> > Please keep opening brace style/indentation consistent with code you have
> > removed.
> 
> The function is a mess with brace style and indentation. I've used the same 
> indentaion as the if right above this one. The function wildly mixes 
> two-space, three-space and four-space indents. In this case, I used two-space 
> indents for the outer if and four-space indents for the inner ifs for better 
> readability.

Even if the overall style is a mess it's not a solution to add the code which
mixes 2 and 4 spaces indentation, and the code you have removed used a consistent
style.

> > --- a/include/winsock.h
> > +++ b/include/winsock.h
> > @@ -146,6 +146,7 @@ extern "C" {
> >  /* proper 4-byte packing */
> >  #include <pshpack4.h>
> >
> > +#define FROM_PROTOCOL_INFO (-1)
>
> PSDK has it in winsock2.h
> 
> PSDK has the AF_*, PF_*, SOCK_* and IPPROTO_* defines in winsock2.h as well, 
> Wine hasn't. I preferred to keep them together.

How much efforts would it take to put 1 line to a proper .h file?

> I don't fully understand why people suddenly start getting picky about stuff 
> like this when noone previously gave a damn. As it's not acceptable to just 
> go over this mess with indent, I don't see how conforming to one sort of 
> messy indentation is preferrable to another sort of messy indentation.
> 
> Seriously, this patch fixes a bug, take it or leave it and fix it yourself.

All the patches sent to wine-patches fix a bug, not of them are applied due
to different reasons. You are not a first timer, and know the rules.


-- 
Dmitry.


From khodych at gmail.com  Sun May 25 23:52:46 2008
From: khodych at gmail.com (Sergey Khodych)
Date: Mon, 26 May 2008 07:52:46 +0300
Subject: winex11: BitBlt returns TRUE when drawing outside of the clipping
	or visible region.
Message-ID: <483A421E.8040305@gmail.com>




-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-BitBlt-returns-TRUE-when-drawing-outside-of-the-clip.patch
Type: text/x-patch
Size: 1056 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080526/f1e2c96f/attachment.bin 

From wine-devel at kievinfo.com  Sun May 25 23:55:00 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 25 May 2008 22:55:00 -0600
Subject: winex11: BitBlt returns TRUE when drawing outside of the clipping
	or visible region.
In-Reply-To: <483A425F.8020600@gmail.com>
References: <483A425F.8020600@gmail.com>
Message-ID: <483A42A4.6000604@kievinfo.com>

Sergey Khodych wrote:
> 
> 
Please add a test for this.


From truiken at gmail.com  Sun May 25 23:55:58 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 25 May 2008 23:55:58 -0500
Subject: winex11: BitBlt returns TRUE when drawing outside of the clipping
	or visible region.
In-Reply-To: <483A425F.8020600@gmail.com>
References: <483A425F.8020600@gmail.com>
Message-ID: <22821af30805252155k3badadf2wa254ba54f3a7c1f0@mail.gmail.com>

On Sun, May 25, 2008 at 11:53 PM, Sergey Khodych <khodych at gmail.com> wrote:
>
>

Please add a test to prove that this behavior is correct.

-- 
James Hawkins


From dank at kegel.com  Mon May 26 00:13:22 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 25 May 2008 22:13:22 -0700
Subject: Ooodles of sexy new valgrind warnings
Message-ID: <a71bd89a0805252213w31f617c9k4f2c17ca8d508034@mail.gmail.com>

I updated to the latest valgrind from svn, and
it gives lots of nifty new warnings.  e.g. it
warns if you are using the wrong free for a
particular memory block, and it tells you
where uninitialized blocks came from.

http://kegel.com/wine/valgrind/logs-2008-05-25-summary.txt
is a roadmap of where the sexy new stuff is; the details
are in http://kegel.com/wine/valgrind/logs-2008-05-25/

For instance, it says

diff -u logs-2008-05-20/vg-winmm_capture.txt
logs-2008-05-25/vg-winmm_capture.txt
+  Uninitialised value was created by a client request
+ Mismatched free() / delete / delete []

Pulling up just that diff,
http://kegel.com/wine/valgrind/logs-2008-05-25/vg-winmm_capture-diff.txt
shows the latter error is
+ Mismatched free() / delete / delete []
+    at  RtlFreeHeap (heap.c:1287)
+    by  wave_in_test_device (capture.c:397)
+    by  func_capture (capture.c:716)
+    by  run_test (test.h:414)
+    by  main (test.h:463)
+  Address 0x440cc90 is 0 bytes inside a block of size 14 alloc'd
+    at  malloc (vg_replace_malloc.c:207)
+    by  wave_in_test_device (capture.c:388)
+    by  func_capture (capture.c:716)
+    by  run_test (test.h:414)
+    by  main (test.h:463)

Sure enough, memory is allocate with strdup() and freed with HeapFree(), tsk.

Anyway, there's plenty here for everybody.  Pile on!

Tomorrow I'll start running these without -O2;
Zac Brown reminded me that gives better stack tracebacks
(i.e. it inhibits inlining, which often causes small static
functions to disappear from the stack dumps in valgrind's error messages).
- Dan


From hverbeet at gmail.com  Mon May 26 01:45:19 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 26 May 2008 08:45:19 +0200
Subject: ws2_32: Add support for FROM_PROTOCOL_INFO to WSASocket()
In-Reply-To: <703E678AF9AF477B9813D6B7C800C122@DMITRY>
References: <200805251537.37207.kai@samba.org>
	<255B7EDBE90F4509A723E65C35E9419E@DMITRY>
	<200805252000.37341.kai.blin@gmail.com>
	<703E678AF9AF477B9813D6B7C800C122@DMITRY>
Message-ID: <d658b69e0805252345x68d69663y4863c1c45901fb5b@mail.gmail.com>

2008/5/26 Dmitry Timoshkov <dmitry at codeweavers.com>:
> "Kai Blin" <kai.blin at gmail.com> wrote:
>
>> > > +    {FROM_PROTOCOL_INFO, FROM_PROTOCOL_INFO},
>> > >  };
>> >
>> > Although it was the case before, it's a mistake to have a comma after
>> > the last struct member initializer.
>>
>> It is?  K&R seems to use both, so I preferred to keep it similar to all the
>> other struct member initializers.
>
> I said "a mistake" not "an error". Although the compiler forgives this, what
> the last comma is serving for?
>
The C standard explicitly allows the comma at the end of initializer
lists, this would be a style issue at best.


From dmitry at codeweavers.com  Mon May 26 01:54:28 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 26 May 2008 15:54:28 +0900
Subject: ws2_32: Add support for FROM_PROTOCOL_INFO to WSASocket()
References: <200805251537.37207.kai@samba.org><255B7EDBE90F4509A723E65C35E9419E@DMITRY><200805252000.37341.kai.blin@gmail.com><703E678AF9AF477B9813D6B7C800C122@DMITRY>
	<d658b69e0805252345x68d69663y4863c1c45901fb5b@mail.gmail.com>
Message-ID: <2D60E67B49EE409D9812A93DB955BA47@DMITRY>

"H. Verbeet" <hverbeet at gmail.com> wrote:

> The C standard explicitly allows the comma at the end of initializer
> lists, this would be a style issue at best.

I mentioned it in hope that it will be fixed in a following patch,
since the patch needs to be resent anyway.

-- 
Dmitry.


From kai.blin at gmail.com  Mon May 26 02:09:11 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 26 May 2008 09:09:11 +0200
Subject: ws2_32: Add support for FROM_PROTOCOL_INFO to WSASocket()
In-Reply-To: <703E678AF9AF477B9813D6B7C800C122@DMITRY>
References: <200805251537.37207.kai@samba.org>
	<200805252000.37341.kai.blin@gmail.com>
	<703E678AF9AF477B9813D6B7C800C122@DMITRY>
Message-ID: <200805260909.17546.kai.blin@gmail.com>

On Monday 26 May 2008 05:08:46 Dmitry Timoshkov wrote:
> "Kai Blin" <kai.blin at gmail.com> wrote:
> > > > +    {FROM_PROTOCOL_INFO, FROM_PROTOCOL_INFO},
> > > >  };
> > >
> > > Although it was the case before, it's a mistake to have a comma after
> > > the last struct member initializer.
> >
> > It is?  K&R seems to use both, so I preferred to keep it similar to all
> > the other struct member initializers.
>
> I said "a mistake" not "an error". Although the compiler forgives this,
> what the last comma is serving for?

The C grammar printed in my edition of K&R says the following about 
initializers

initializer:
	assignment-expression
	{ initializer-list }
	{ initializer-list , }

so it looks like it's in the C standard that both are perfectly valid. I used 
the perfectly valid form the rest of the file uses.

> > > > +    if (lpProtocolInfo) {
> > > > +      if (af == FROM_PROTOCOL_INFO)
> > > > +          af = lpProtocolInfo->iAddressFamily;
> > > > +      if (type == FROM_PROTOCOL_INFO)
> > > > +          type = lpProtocolInfo->iSocketType;
> > > > +      if (protocol == FROM_PROTOCOL_INFO)
> > > > +          protocol = lpProtocolInfo->iProtocol;
> > >
> > > Please keep opening brace style/indentation consistent with code you
> > > have removed.
> >
> > The function is a mess with brace style and indentation. I've used the
> > same indentaion as the if right above this one. The function wildly mixes
> > two-space, three-space and four-space indents. In this case, I used
> > two-space indents for the outer if and four-space indents for the inner
> > ifs for better readability.
>
> Even if the overall style is a mess it's not a solution to add the code
> which mixes 2 and 4 spaces indentation, and the code you have removed used
> a consistent style.

Ok. Fine. How about we finally agree on a coding standard, document that 
somewhere and require all new patches to conform to that? Then at least one 
wouldn't have to guess which broken indentation/braces to follow.

> > PSDK has the AF_*, PF_*, SOCK_* and IPPROTO_* defines in winsock2.h as
> > well, Wine hasn't. I preferred to keep them together.
>
> How much efforts would it take to put 1 line to a proper .h file?

You're not even looking at what I wrote, are you? FROM_PROTOCOL_INFO is used 
like an address family define, and I tried to keep all of them together.

> All the patches sent to wine-patches fix a bug, not of them are applied due
> to different reasons. You are not a first timer, and know the rules.

What rules are you referring to? The rule that says when adding code to a file 
that has no obvious dominating code style, I should pick the code style from 
below the code I add not the code style from above the code I add? I didn't 
know that one.

I welcome code review that points out errors in my code. Code review that 
alternates between requiring me to be "formally correct" and "consistent to 
the code" in a seemingly random fashion is different.

So you don't care about this patch because you don't have a customer who needs 
it, I don't care about this patch because I can spend my free time on other 
things. Let's just drop it then.

Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080526/392fd4be/attachment.pgp 

From kai.blin at gmail.com  Mon May 26 02:24:12 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Mon, 26 May 2008 09:24:12 +0200
Subject: ws2_32: Add support for FROM_PROTOCOL_INFO to WSASocket()
In-Reply-To: <2D60E67B49EE409D9812A93DB955BA47@DMITRY>
References: <200805251537.37207.kai@samba.org>
	<d658b69e0805252345x68d69663y4863c1c45901fb5b@mail.gmail.com>
	<2D60E67B49EE409D9812A93DB955BA47@DMITRY>
Message-ID: <200805260924.13165.kai.blin@gmail.com>

On Monday 26 May 2008 08:54:28 Dmitry Timoshkov wrote:
> "H. Verbeet" <hverbeet at gmail.com> wrote:
> > The C standard explicitly allows the comma at the end of initializer
> > lists, this would be a style issue at best.
>
> I mentioned it in hope that it will be fixed in a following patch,
> since the patch needs to be resent anyway.

The one thing I can't figure out is when it's appropriate to be consistent to 
the style already used in the file (which you complained about later in the 
patch) and when it's appropriate to follow a "correct" style. (I have to add 
that I never heard of that particular one before, and the Wine developer's 
guide talks about patch style, not about coding style.)

My issue is not that I need to change things in my patch. My issue is that I 
don't understand the reason for having to change things. It seems random. 
While it's trivial to fix this particular patch, I've learned nothing about 
how to initialize the pseudo-random generator that does the "consistency or 
correct style" decision for me next time.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080526/6b851b8d/attachment.pgp 

From dmitry at codeweavers.com  Mon May 26 02:40:07 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 26 May 2008 16:40:07 +0900
Subject: ws2_32: Add support for FROM_PROTOCOL_INFO to WSASocket()
References: <200805251537.37207.kai@samba.org><200805252000.37341.kai.blin@gmail.com><703E678AF9AF477B9813D6B7C800C122@DMITRY>
	<200805260909.17546.kai.blin@gmail.com>
Message-ID: <8DF24A28B60B438684F63314F4F24023@DMITRY>

"Kai Blin" <kai.blin at gmail.com> wrote:

> The C grammar printed in my edition of K&R says the following about 
> initializers
> 
> initializer:
>  assignment-expression
>  { initializer-list }
>  { initializer-list , }
> 
> so it looks like it's in the C standard that both are perfectly valid. I used 
> the perfectly valid form the rest of the file uses.

It's valid, and it's useful to avoid explicit structure members initializers, but
in the case of array initializers (which is the case) IMO it looks like a typo.

> > > The function is a mess with brace style and indentation. I've used the
> > > same indentaion as the if right above this one. The function wildly mixes
> > > two-space, three-space and four-space indents. In this case, I used
> > > two-space indents for the outer if and four-space indents for the inner
> > > ifs for better readability.
> >
> > Even if the overall style is a mess it's not a solution to add the code
> > which mixes 2 and 4 spaces indentation, and the code you have removed used
> > a consistent style.
> 
> Ok. Fine. How about we finally agree on a coding standard, document that 
> somewhere and require all new patches to conform to that? Then at least one 
> wouldn't have to guess which broken indentation/braces to follow.

It's silly IMO to demand a coding standard when somebody pointed out to
an obviously sloppy code style on your side.

> > > PSDK has the AF_*, PF_*, SOCK_* and IPPROTO_* defines in winsock2.h as
> > > well, Wine hasn't. I preferred to keep them together.
> >
> > How much efforts would it take to put 1 line to a proper .h file?
> 
> You're not even looking at what I wrote, are you? FROM_PROTOCOL_INFO is used 
> like an address family define, and I tried to keep all of them together.

All I say is that it's not OK to put the code at wrong place, even if there is
existing code which is at the wrong place already.

[skipped]

> So you don't care about this patch because you don't have a customer who needs 
> it,

I haven't said anything about customer needs, there is no need to speculate about it.

> I don't care about this patch because I can spend my free time on other 
> things. Let's just drop it then.

You already spent more time arguing than it would take to fix the patch, and
resend.

-- 
Dmitry.


From paulc at voip.null.ro  Mon May 26 03:41:40 2008
From: paulc at voip.null.ro (Paul Chitescu)
Date: Mon, 26 May 2008 11:41:40 +0300 (EEST)
Subject: ws2_32: Add support for FROM_PROTOCOL_INFO to WSASocket()
In-Reply-To: <255B7EDBE90F4509A723E65C35E9419E@DMITRY>
References: <200805251537.37207.kai@samba.org>
	<255B7EDBE90F4509A723E65C35E9419E@DMITRY>
Message-ID: <Pine.LNX.4.64.0805261134120.19907@dragoshel>

On Sun, 25 May 2008, Dmitry Timoshkov wrote:
> "Kai Blin" <kai.blin at gmail.com> wrote:
> [...]
>>      MAP_OPTION( IPPROTO_IGMP ),
>>      MAP_OPTION( IPPROTO_RAW ),
>> +    {FROM_PROTOCOL_INFO, FROM_PROTOCOL_INFO},
>>  };
>
> Although it was the case before, it's a mistake to have a comma after
> the last struct member initializer.
> [...]

Placing a comma should be OK if there are chances the struct or enum will 
ever grow. This prevents later patching the line to add the comma, 
possibly creating confusion about who is the author of that line.

On the other hand, no comma at the end of an enum or struct memeber that 
we want to always be the last one (COUNT_OF_WHATEVER_OPTIONS, 
custom_data_area[], etc.) helps avoiding trivial errors as it forces one 
to add that comma to compile the code.

Paul Chitescu


From fgouget at free.fr  Mon May 26 04:21:46 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 26 May 2008 11:21:46 +0200 (CEST)
Subject: Time to cull the changelog file
In-Reply-To: <87y760qa1h.fsf@wine.dyndns.org>
References: <48378067.7020808@open-vote.org> <87y760qa1h.fsf@wine.dyndns.org>
Message-ID: <alpine.DEB.1.10.0805261113220.1833@amboise.dolphin>

On Sat, 24 May 2008, Alexandre Julliard wrote:
[...]
> Actually I was thinking of simply no longer maintaining a Changelog
> file. It made sense in the days of CVS to store changeset information,
> but now with git the same information and more can be retrieved
> trivially with git-log, and the linear log format won't work so well
> once we start having multiple branches.
> 
> Objections?  Does anybody feel a strong need for a Changelog file?

Users who get Wine as a precompiled package, maybe through their 
distribution, won't be able to easily run git-log or git-whatchanged. I 
know I often check the changelog in /usr/share/doc/<packagename> when I 
have trouble with a Debian package. So I think a changelog should still 
be included in the Wine packages.

It does not have to, and probably shouldn't, list all changes made in 
the past 15 years though. I'll leave determining the best cutoff date to 
others. Also this could potentially be handled by the Wine packager 
rather than being part of the Wine sources. Finally, the individual 
commit messages may not be the easiest thing to understand for 
non-developpers either. I think this is more true of Wine than of other 
packages. That could argue for a changelog that's not just a collection 
of the commit messages. Maybe something culled from the ANNOUNCE 
messages, though these tend to be too terse, imho. Of course the trouble 
is that this would require quite a bit of work.


Anyway, these were just my 2 EuroCents.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
  Good judgment comes from experience, and experience comes from bad judgment
                               -- Barry LePatner


From Andrew.Talbot at talbotville.com  Mon May 26 05:08:21 2008
From: Andrew.Talbot at talbotville.com (Andrew Talbot)
Date: Mon, 26 May 2008 11:08:21 +0100
Subject: ws2_32: Add support for FROM_PROTOCOL_INFO to WSASocket()
References: <200805251537.37207.kai@samba.org>
	<255B7EDBE90F4509A723E65C35E9419E@DMITRY>
	<200805252000.37341.kai.blin@gmail.com>
	<703E678AF9AF477B9813D6B7C800C122@DMITRY>
	<d658b69e0805252345x68d69663y4863c1c45901fb5b@mail.gmail.com>
Message-ID: <g1e26l$o3h$1@ger.gmane.org>

H. Verbeet wrote:

> The C standard explicitly allows the comma at the end of initializer
> lists, this would be a style issue at best.

Not to contradict that, but, FWIW, I believe that a comma at the end of an
enum list - specifically - is incorrect in ANSI C. The following code,
compiled with -pedantic, produces a warning for the enum, alone.

int main()
{
    enum days { Sunday, Monday, Tuesday, };
    char s[] = { 'h', 'e', 'l', 'l', 'o', '\0', };
    struct st_tag {int i; int j;} st = { 1, 2, };

    return 0;
}

compiled with "gcc [-ansi] -pedantic -o test test.c"
produces "test.c:3: warning: comma at end of enumerator list".

I believe this exception has been removed in C99.

-- 
Andy.




From fgouget at free.fr  Mon May 26 05:14:03 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 26 May 2008 12:14:03 +0200 (CEST)
Subject: ws2_32: Add support for FROM_PROTOCOL_INFO to WSASocket()
In-Reply-To: <200805252000.37341.kai.blin@gmail.com>
References: <200805251537.37207.kai@samba.org>
	<255B7EDBE90F4509A723E65C35E9419E@DMITRY>
	<200805252000.37341.kai.blin@gmail.com>
Message-ID: <alpine.DEB.1.10.0805261200590.11834@amboise.dolphin>

On Sun, 25 May 2008, Kai Blin wrote:
[...]
> > > --- a/include/winsock.h
> > > +++ b/include/winsock.h
> > > @@ -146,6 +146,7 @@ extern "C" {
> > >  /* proper 4-byte packing */
> > >  #include <pshpack4.h>
> > >
> > > +#define FROM_PROTOCOL_INFO (-1)
> >
> > PSDK has it in winsock2.h
> 
> PSDK has the AF_*, PF_*, SOCK_* and IPPROTO_* defines in winsock2.h as well, 
> Wine hasn't.

That's because MS likes to duplicate things a lot. So in the PSDK AF_*, 
PF_*, SOCK_* and IPPROTO_* are defined in _both_ winsock.h and 
winsock2.h. In Wine we're defining them in winsock.h only, but we're 
then #including winsock.h in winsock2.h, using __WINE_WINSOCK2__ to 
solve the handful of incompatibilities.

But the PSDK defines FROM_PROTOCOL_INFO _only_ in winsock2.h so it's 
important to do the same in Wine.


> I preferred to keep them together.

It's important that the Wine headers match the PSDK ones as best as 
possible. Differences usually result in Windows code that does not 
compile with Wine, bad for Winelib, or in the Wine conformance tests 
that don't compile with the PSDK.


Anyway, I'm sending a patch to add FROM_PROTOCOL_INFO to winsock2.h...


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                     f u kn rd ts, ur wy 2 gky 4 ur wn gd.


From haukeh at pc-kiel.de  Mon May 26 07:24:26 2008
From: haukeh at pc-kiel.de (haukeh)
Date: Mon, 26 May 2008 14:24:26 +0200
Subject: Speaker for talk about wine in Kiel (north of Germany) wanted
Message-ID: <483AABFA.5080500@pc-kiel.de>

Hi there,

Alexandre said this would be the right place to ask for a speaker about a wine 
talk. So I'm asking here ;-)

Is there anybody who can hold a speech about wine in Kiel (north of Germany, 
http://maps.google.com/maps?f=q&hl=en&geocode=&q=kiel+deutschland&ie=UTF8&z=11)?

The audience would be interested in solutions for excuting windows applications 
under Linux. The speech would be part of the speeches before the Kiel Linux days 
(www.kieler-linuxtage.de (German only)). Maybe another speaker about VirtualBox 
would attend for a comparison between full virtualisation and an api emulation 
solution.

We would like to hear the speech this summer. A more precisely planning for a 
speach date will come when we have our speakers and when they have time.

So write me please (in German because the speech is required in German too) if 
you are interested in holding this speech.

Have a nice day,

  Hauke


From austinenglish at gmail.com  Mon May 26 10:52:21 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 26 May 2008 10:52:21 -0500
Subject: README: Few more updates
In-Reply-To: <4837E3FB.5050903@gmail.com>
References: <b6bb06270805231455y187048fav630562d5ff584a7@mail.gmail.com>
	<4837E3FB.5050903@gmail.com>
Message-ID: <b6bb06270805260852s234abedat3d8fe4ab8530c5d@mail.gmail.com>

Thanks for catching that!

I'll send an updated patch shortly.

On 5/24/08, Aurimas Fischer <aurimas at gmail.com> wrote:
> Austin English wrote:
>  > -	Go to http://www.winehq.org/site/git for more information.
>  > +	Go to http://www.winehq.org/site/git/ for more information.
>
> this is not correct, second link returns 404 page.
>
>
>


From msclrhd at googlemail.com  Mon May 26 08:14:45 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Mon, 26 May 2008 14:14:45 +0100
Subject: AppDB: how to handle the same application (specifically game) from
	different vendors.
Message-ID: <3f4fd2640805260614m4b658dckf164646b6dad778@mail.gmail.com>

Hi,

While testing various casual games and adding the information to the
AppDB, I have noticed something.

The various casual game websites (such as Oberon Media/MSN, PopCap
Games and Yahoo! Games) have several games that are the same (such as
Bejeweled 2, Dinner Dash 2 and Zuma), but are packaged using different
installers and have different splash screens. I haven't investigated
to see if this extends to the loading screen as well, or if they
behave differently.

The AppDB already supports different versions, but I believe these are
specific to one vendor. So the question is how to support the same
game published from different vendors?

- Reece


From msclrhd at googlemail.com  Mon May 26 08:20:07 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Mon, 26 May 2008 14:20:07 +0100
Subject: Best place for HOWTO documents for your favourite application?
In-Reply-To: <b6bb06270805251807s217c781fsd50829e0b07190c8@mail.gmail.com>
References: <3f4fd2640805251611w2f81804j29a33a316e59dd69@mail.gmail.com>
	<b6bb06270805251807s217c781fsd50829e0b07190c8@mail.gmail.com>
Message-ID: <3f4fd2640805260620sf185bfbyac277bb716d96e27@mail.gmail.com>

2008/5/26 Austin English <austinenglish at gmail.com>:
> On Sun, May 25, 2008 at 6:11 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
>> Hi,
>>
>> I have been trying our various Oberon Media games. The thing that is
>> holding this up from working is the hyperlinks on the intro screen (I
>> am going to enter a bug report later on).
>>
>> I have worked out how to run and register the games (given a valid
>> registration key that you have purchased) so that they will work under
>> Wine. So this got me wondering... where do I put this?
>>
>> This complements the appdb, but is in a way orthogonal to it (that is
>> there may be HOWTOs relating to individual games/applications, to
>> vendors or to other areas such as installing Windows themes like the
>> Zune theme). It will also help when more people start using Wine and
>> want to get their favorite application running.
>>
>> My initial thoughts are that the wiki seems like a good place for
>> this. Thoughts? Comments?
>
> I don't see why this shouldn't be put in the AppDB. The wiki may be
> useful for installing themes, etc., but this seems to be related to a
> particular app/vendor, and should be in the AppDB.

Ok. However, I don't see anything on the AppDB forms for entering
HOWTO information for a vendor or application and linking application
notes to the vendor version.

Do you mean these should be in the Application Comments section? If
so, what about having Vendor Comments as well? However, these feel
more like email discussions about applications and the HOWTO notes
could get lost in the noise; in addition to this, the HOWTO may evolve
and thus it would be harder to track down which is the right one.

- Reece


From krys at via.ecp.fr  Mon May 26 09:23:42 2008
From: krys at via.ecp.fr (Christopher GAUTIER)
Date: Mon, 26 May 2008 16:23:42 +0200
Subject: [PATCH] - fall back to the main HWND when there is no IMM HWND
In-Reply-To: <22821af30805251815n37bb7796uaa6285abd1814fa1@mail.gmail.com>
References: <20080525235920.GA21764@via.ecp.fr>
	<22821af30805251815n37bb7796uaa6285abd1814fa1@mail.gmail.com>
Message-ID: <20080526142342.GA17215@via.ecp.fr>

On Sun, May 25, 2008, James Hawkins wrote:
> On Sun, May 25, 2008 at 6:59 PM, Christopher GAUTIER <krys at via.ecp.fr> wrote:
> >  - dlls/imm32/imm.c: fall back to the main HWND when there is no IMM
> >    HWND in ImmGetDefaultIMEWnd()
> Please add a test case to prove this behavior is correct.

Good point. My test case proves that my patch is actually wrong. I will
continue to investigate the issue.

Cheers,
Christopher


From adam at tpetaccia.com  Mon May 26 11:25:32 2008
From: adam at tpetaccia.com (Adam Petaccia)
Date: Mon, 26 May 2008 12:25:32 -0400
Subject: Best place for HOWTO documents for your favourite application?
In-Reply-To: <3f4fd2640805251611w2f81804j29a33a316e59dd69@mail.gmail.com>
References: <3f4fd2640805251611w2f81804j29a33a316e59dd69@mail.gmail.com>
Message-ID: <1211819132.6560.8.camel@pimpmobile>

On Mon, 2008-05-26 at 00:11 +0100, Reece Dunn wrote:
> Hi,
> 
> I have been trying our various Oberon Media games. The thing that is
> holding this up from working is the hyperlinks on the intro screen (I
> am going to enter a bug report later on).
> 
> I have worked out how to run and register the games (given a valid
> registration key that you have purchased) so that they will work under
> Wine. So this got me wondering... where do I put this?
> 
> This complements the appdb, but is in a way orthogonal to it (that is
> there may be HOWTOs relating to individual games/applications, to
> vendors or to other areas such as installing Windows themes like the
> Zune theme). It will also help when more people start using Wine and
> want to get their favorite application running.
> 
> My initial thoughts are that the wiki seems like a good place for
> this. Thoughts? Comments?
The problem with wikis is that they don't expire unless someone actually
goes through the pages and updates them. So say AwesomeGame 1.0 doesn't
work with Wine 1.0-rc2, and some workarounds are written down. 6 months
later with AwesomeGame 1.6 is out, and so is Wine 1.2, the game now
works out of the box. But the workarounds are still listed on the Wiki.

AppDB deals with this rather well, because for most games you don't see
old-as-* work-arounds that may actually be potentially damaging (No-CD
cracks that aren't needed, etc). 

So I'd vote for AppDB.

> 
> - Reece
> 
> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080526/ab03f14b/attachment.pgp 

From dylan.ah.smith at gmail.com  Mon May 26 13:14:37 2008
From: dylan.ah.smith at gmail.com (Dylan Smith)
Date: Mon, 26 May 2008 14:14:37 -0400
Subject: user32: Increased area for scrolling via mouse drag outside
	scrollbar
In-Reply-To: <5c6ee3b70805260959p48c79c5fxee77387477754a6d@mail.gmail.com>
References: <5c6ee3b70805260959p48c79c5fxee77387477754a6d@mail.gmail.com>
Message-ID: <5c6ee3b70805261114p84f37d6l16cb6316c964acce@mail.gmail.com>

I just realized that the behaviour of Windows in this situation feels
buggy.  To me it would actually be more usable to allow the mouse to be
dragged anywhere on the screen, as long as the mouse button stays down,
instead of just within some area close to the scrollbar.  KDE and Gnome
applications that I am running all appear to allow the mouse to be dragged
anywhere on the screen to scroll.

Therefore, I would like to know what other people think.  Do we actually
want to copy Windows when it makes usability worse and doesn't affect
compatibility?  Wouldn't it be cool to have a better implementation of the
Windows platform?

I still think this patch is an improvement, just not the best solution.

On Mon, May 26, 2008 at 12:59 PM, Dylan Smith <dylan.ah.smith at gmail.com>
wrote:

> When dragging the scrollbar thumb with the mouse, the mouse is able to
> move away from the scrollbar and keep scrolling so long as it isn't too
> far away from the scrollbar.  This makes it easier to quickly scroll
> with the mouse.
>
> All that this patch changes is the distance that the mouse can be moved
> away from the scrollbar before it is consider outside of the scrollbar
> and returns to its original position.  The constants are only
> approximate, since I only tested visually against Windows XP SP3, so it
> should at least feel the same.
> ---
>  dlls/user32/scroll.c |   19 +++++++++++++++----
>  1 files changed, 15 insertions(+), 4 deletions(-)
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080526/8a423cd4/attachment.htm 

From truiken at gmail.com  Mon May 26 13:53:33 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 26 May 2008 13:53:33 -0500
Subject: user32: Allow scrolling via mouse drag outside scrollbar
In-Reply-To: <5c6ee3b70805261146w201a5b5eg675244c88378fafa@mail.gmail.com>
References: <5c6ee3b70805261146w201a5b5eg675244c88378fafa@mail.gmail.com>
Message-ID: <22821af30805261153t525237b4h7b5a47a12ad6aed@mail.gmail.com>

On Mon, May 26, 2008 at 1:46 PM, Dylan Smith <dylan.ah.smith at gmail.com> wrote:
> When dragging the scrollbar thumb with the mouse, the mouse is able to
> move away from the scrollbar and keep scrolling so long as it isn't too
> far away from the scrollbar.  This makes it easier to quickly scroll
> with the mouse.
>
> This patch is an alternative to the Windows approach of allowing the
> mouse to be dragged a certain distance from the scrollbar, and instead
> allows the mouse to be dragged any distance away and still scroll.
> Although this is different from Windows, it shouldn't result in any
> compatibility issues.
>
> It is my personal opinion that this is a simpler and more usable
> approach.
>

It doesn't matter if you think it's simpler and more usable.  We are
bug-for-bug compatible with Windows.

-- 
James Hawkins


From dylan.ah.smith at gmail.com  Mon May 26 14:22:13 2008
From: dylan.ah.smith at gmail.com (Dylan Smith)
Date: Mon, 26 May 2008 15:22:13 -0400
Subject: user32: Allow scrolling via mouse drag outside scrollbar
In-Reply-To: <22821af30805261153t525237b4h7b5a47a12ad6aed@mail.gmail.com>
References: <5c6ee3b70805261146w201a5b5eg675244c88378fafa@mail.gmail.com>
	<22821af30805261153t525237b4h7b5a47a12ad6aed@mail.gmail.com>
Message-ID: <5c6ee3b70805261222j679189c8ja6c62562317a17e6@mail.gmail.com>

Alright.  I thought bug for bug compatibility was just for compatibility.
In this case it didn't seem like it mattered, and could be implemented
differently between versions.

In that case, this patch can be ignored, and my previous patch can be used
that does attempt to be the same as Windows.

The previous patch that I am referring to is:
user32: Increased area for scrolling via mouse drag outside scrollbar
http://www.winehq.org/pipermail/wine-devel/2008-May/065944.html

On Mon, May 26, 2008 at 2:53 PM, James Hawkins <truiken at gmail.com> wrote:

> On Mon, May 26, 2008 at 1:46 PM, Dylan Smith <dylan.ah.smith at gmail.com>
> wrote:
> > When dragging the scrollbar thumb with the mouse, the mouse is able to
> > move away from the scrollbar and keep scrolling so long as it isn't too
> > far away from the scrollbar.  This makes it easier to quickly scroll
> > with the mouse.
> >
> > This patch is an alternative to the Windows approach of allowing the
> > mouse to be dragged a certain distance from the scrollbar, and instead
> > allows the mouse to be dragged any distance away and still scroll.
> > Although this is different from Windows, it shouldn't result in any
> > compatibility issues.
> >
> > It is my personal opinion that this is a simpler and more usable
> > approach.
> >
>
> It doesn't matter if you think it's simpler and more usable.  We are
> bug-for-bug compatible with Windows.
>
> --
> James Hawkins
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080526/25f94d92/attachment.htm 

From scott at open-vote.org  Mon May 26 13:40:48 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Mon, 26 May 2008 11:40:48 -0700
Subject: Best place for HOWTO documents for your favourite application?
In-Reply-To: <3f4fd2640805260620sf185bfbyac277bb716d96e27@mail.gmail.com>
References: <3f4fd2640805251611w2f81804j29a33a316e59dd69@mail.gmail.com>	<b6bb06270805251807s217c781fsd50829e0b07190c8@mail.gmail.com>
	<3f4fd2640805260620sf185bfbyac277bb716d96e27@mail.gmail.com>
Message-ID: <483B0430.30102@open-vote.org>

Reece Dunn wrote:
> 2008/5/26 Austin English <austinenglish at gmail.com>:
>> On Sun, May 25, 2008 at 6:11 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
>>> Hi,
>>>
>>> I have been trying our various Oberon Media games. The thing that is
>>> holding this up from working is the hyperlinks on the intro screen (I
>>> am going to enter a bug report later on).
>>>
>>> I have worked out how to run and register the games (given a valid
>>> registration key that you have purchased) so that they will work under
>>> Wine. So this got me wondering... where do I put this?
>>>
>>> This complements the appdb, but is in a way orthogonal to it (that is
>>> there may be HOWTOs relating to individual games/applications, to
>>> vendors or to other areas such as installing Windows themes like the
>>> Zune theme). It will also help when more people start using Wine and
>>> want to get their favorite application running.
>>>
>>> My initial thoughts are that the wiki seems like a good place for
>>> this. Thoughts? Comments?
>> I don't see why this shouldn't be put in the AppDB. The wiki may be
>> useful for installing themes, etc., but this seems to be related to a
>> particular app/vendor, and should be in the AppDB.
> 
> Ok. However, I don't see anything on the AppDB forms for entering
> HOWTO information for a vendor or application and linking application
> notes to the vendor version.
> 
> Do you mean these should be in the Application Comments section? If
> so, what about having Vendor Comments as well? However, these feel
> more like email discussions about applications and the HOWTO notes
> could get lost in the noise; in addition to this, the HOWTO may evolve
> and thus it would be harder to track down which is the right one.
> 

Hmm...with the current software you may have to be a maintainer and make
a Howto for each game then.  Alternatively you could put a link in each
howto to another AppDB (or wiki) page, if you want to keep the
instructions centralized.

Thanks,
Scott Ritchie


From truiken at gmail.com  Mon May 26 16:40:49 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 26 May 2008 16:40:49 -0500
Subject: fusion: use HeapAlloc, not strdup, to avoid malloc/HeapFree
	mismatch; don't test variable if not set
In-Reply-To: <a71bd89a0805261421u672854e1jc4db08c4546e70c2@mail.gmail.com>
References: <a71bd89a0805261421u672854e1jc4db08c4546e70c2@mail.gmail.com>
Message-ID: <22821af30805261440y602e8340y32fbc10022d3ef0d@mail.gmail.com>

On Mon, May 26, 2008 at 4:21 PM, Dan Kegel <dank at kegel.com> wrote:
> Can't mix strdup and HeapFree.
>
> Fixes three valgrind errors
> http://kegel.com/wine/valgrind/logs-2008-05-25/vg-fusion_asmcache.txt
>

diff --git a/dlls/fusion/tests/asmcache.c b/dlls/fusion/tests/asmcache.c
index a160b0a..dcf26a0 100644
--- a/dlls/fusion/tests/asmcache.c
+++ b/dlls/fusion/tests/asmcache.c
@@ -922,8 +922,10 @@ static void test_InstallAssembly(void)
     todo_wine
     {
         ok(hr == S_OK, "Expected S_OK, got %d\n", S_OK);
-        ok(disp == IASSEMBLYCACHE_UNINSTALL_DISPOSITION_UNINSTALLED,
-           "Expected
IASSEMBLYCACHE_UNINSTALL_DISPOSITION_UNINSTALLED, got %d\n", disp);
+        if (hr == S_OK) {
+           ok(disp == IASSEMBLYCACHE_UNINSTALL_DISPOSITION_UNINSTALLED,
+              "Expected
IASSEMBLYCACHE_UNINSTALL_DISPOSITION_UNINSTALLED, got %d\n", disp);
+        }
     }


Why did you add this change?  The value of disp is independent of the
value of hr.  Also, the style of the braces doesn't match the rest of
the file.

-- 
James Hawkins


From chris.kcat at gmail.com  Mon May 26 18:12:01 2008
From: chris.kcat at gmail.com (Chris Robinson)
Date: Mon, 26 May 2008 16:12:01 -0700
Subject: wined3d: Use higher precision to convert floats into text.
In-Reply-To: <483B1160.6070601@kievinfo.com>
References: <483B1160.6070601@kievinfo.com>
Message-ID: <200805261612.01558.chris.kcat@gmail.com>

On Monday 26 May 2008 12:37:04 pm Vitaliy Margolen wrote:
> - ? ? ? ? ? ?shader_addline(buffer, "PARAM srgb_mul_low = {%f, %f, %f,
> 1.0};\n",
> + ? ? ? ? ? ?shader_addline(buffer, "PARAM srgb_mul_low = {%.12f, 
> %.12f, %.12f, 1.0};\n",

I don't know if ARB shaders would except the notation (GLSL does), but 
would %.8e or somesuch work better than %.12f at maintaining accuracy?


From m.b.lankhorst at gmail.com  Mon May 26 19:15:20 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 26 May 2008 17:15:20 -0700
Subject: Ooodles of sexy new valgrind warnings
In-Reply-To: <a71bd89a0805252213w31f617c9k4f2c17ca8d508034@mail.gmail.com>
References: <a71bd89a0805252213w31f617c9k4f2c17ca8d508034@mail.gmail.com>
Message-ID: <b130c85e0805261715y25b21771kc635a3f74c8edf75@mail.gmail.com>

2008/5/25 Dan Kegel <dank at kegel.com>:
> I updated to the latest valgrind from svn, and
> it gives lots of nifty new warnings.  e.g. it
> warns if you are using the wrong free for a
> particular memory block, and it tells you
> where uninitialized blocks came from.

> http://kegel.com/wine/valgrind/logs-2008-05-25-summary.txt
> is a roadmap of where the sexy new stuff is; the details
> are in http://kegel.com/wine/valgrind/logs-2008-05-25/
>
> For instance, it says
>
> diff -u logs-2008-05-20/vg-winmm_capture.txt
> logs-2008-05-25/vg-winmm_capture.txt
> +  Uninitialised value was created by a client request
> + Mismatched free() / delete / delete []
>
> Pulling up just that diff,
> http://kegel.com/wine/valgrind/logs-2008-05-25/vg-winmm_capture-diff.txt
> shows the latter error is
> + Mismatched free() / delete / delete []
> +    at  RtlFreeHeap (heap.c:1287)
> +    by  wave_in_test_device (capture.c:397)
> +    by  func_capture (capture.c:716)
> +    by  run_test (test.h:414)
> +    by  main (test.h:463)
> +  Address 0x440cc90 is 0 bytes inside a block of size 14 alloc'd
> +    at  malloc (vg_replace_malloc.c:207)
> +    by  wave_in_test_device (capture.c:388)
> +    by  func_capture (capture.c:716)
> +    by  run_test (test.h:414)
> +    by  main (test.h:463)
This particular kind of bug happens when you use a string function
like strdup to allocate some memory, then try to free it with
HeapFree. The proper fix would be to use HeapAlloc.

None the less valgrind's new logs are very useful as it now reports
almost all invalid uses of Free() with a very low false positive
count. For those who haven't tried valgrind before: try it, it's great
for finding a lot of memory related bugs. You'll probably need the svn
version since the last stable release had some bugs that wine would be
affected by.

Cheers,
Maarten.


From wine-devel at kievinfo.com  Mon May 26 20:00:59 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Mon, 26 May 2008 19:00:59 -0600
Subject: wined3d: Use higher precision to convert floats into text.
In-Reply-To: <200805261612.01558.chris.kcat@gmail.com>
References: <483B1160.6070601@kievinfo.com>
	<200805261612.01558.chris.kcat@gmail.com>
Message-ID: <483B5D4B.60806@kievinfo.com>

Chris Robinson wrote:
> On Monday 26 May 2008 12:37:04 pm Vitaliy Margolen wrote:
>> -            shader_addline(buffer, "PARAM srgb_mul_low = {%f, %f, %f,
>> 1.0};\n",
>> +            shader_addline(buffer, "PARAM srgb_mul_low = {%.12f, 
>> %.12f, %.12f, 1.0};\n",
> 
> I don't know if ARB shaders would except the notation (GLSL does), but 
> would %.8e or somesuch work better than %.12f at maintaining accuracy?
> 
> 
I thought they were clamped? In either case .12 should be enough precision 
to avoid problems. Or the whole local constants needs to be rolled back. 
Translating binary -> text -> binary is IMHO wrong.

Vitaliy.


From dank at kegel.com  Mon May 26 20:58:02 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 26 May 2008 18:58:02 -0700
Subject: Ooodles of sexy new valgrind warnings
In-Reply-To: <b130c85e0805261715y25b21771kc635a3f74c8edf75@mail.gmail.com>
References: <a71bd89a0805252213w31f617c9k4f2c17ca8d508034@mail.gmail.com>
	<b130c85e0805261715y25b21771kc635a3f74c8edf75@mail.gmail.com>
Message-ID: <a71bd89a0805261858v79d2ac72u480ca129dc7b34eb@mail.gmail.com>

On Mon, May 26, 2008 at 5:15 PM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
>> + Mismatched free() / delete / delete []
>> +    at  RtlFreeHeap (heap.c:1287)
>> +    by  wave_in_test_device (capture.c:397)
> This particular kind of bug happens when you use a string function
> like strdup to allocate some memory, then try to free it with
> HeapFree. The proper fix would be to use HeapAlloc.

Yeah, I just copied what you did with the other one in that DLL the
other day; see
http://www.winehq.org/pipermail/wine-patches/2008-May/055219.html


From truiken at gmail.com  Mon May 26 21:56:41 2008
From: truiken at gmail.com (James Hawkins)
Date: Mon, 26 May 2008 21:56:41 -0500
Subject: fusion: improve UninstallAssembly stub slightly, fix typo in test
In-Reply-To: <a71bd89a0805261924x2d07da79tb8d50b69ee830ded@mail.gmail.com>
References: <a71bd89a0805261924x2d07da79tb8d50b69ee830ded@mail.gmail.com>
Message-ID: <22821af30805261956u62cdfea9u4063f444619b9d8e@mail.gmail.com>

On Mon, May 26, 2008 at 9:24 PM, Dan Kegel <dank at kegel.com> wrote:
> Improve stub slightly so callers (like our test) looking for a
> disposition find one.
> Also fix a minor typo in the test.
>

diff --git a/dlls/fusion/asmcache.c b/dlls/fusion/asmcache.c
index 7da79f4..5697433 100644
--- a/dlls/fusion/asmcache.c
+++ b/dlls/fusion/asmcache.c
@@ -151,6 +151,9 @@ static HRESULT WINAPI
IAssemblyCacheImpl_UninstallAssembly(IAssemblyCache *iface
 {
     FIXME("(%p, %d, %s, %p, %p) stub!\n", iface, dwFlags,
           debugstr_w(pszAssemblyName), pRefData, pulDisposition);
+    /* caller might test disposition to see why it failed, so come up
with some excuse... */
+    if (pulDisposition)
+       *pulDisposition = IASSEMBLYCACHE_UNINSTALL_DISPOSITION_STILL_IN_USE;

     return E_NOTIMPL;
 }


I disagree with this change.  If you want to fix the valgrind warning,
the test should set the disposition before calling UninstallAssembly.
This disposition is misleading anyway.  Hypothetically, a user of this
API could sit in a loop waiting for the assembly to not be in use.

-- 
James Hawkins


From dank at kegel.com  Tue May 27 00:16:07 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 26 May 2008 22:16:07 -0700
Subject: advpack.c must be compiled with optimization?
Message-ID: <a71bd89a0805262216u5e15b131va540cb8f1e566c0a@mail.gmail.com>

Oddly, if I compile the wine tree without -O2, the following
test fails:

../../../wine advpack_test.exe.so advpack.c
advpack.c:441: Test failed: Expected C:\Program Files, got C:\
advpack.c:443: Test failed: Expected size 17, got 4
make: *** [advpack.ok] Error 2

Compiling advpack/advpack.c with at least -O makes
the problem go away.


From dank at kegel.com  Tue May 27 00:43:02 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 26 May 2008 22:43:02 -0700
Subject: listview maintainer review, please...
Message-ID: <a71bd89a0805262243g7f0ddceeidc7c21c8b30cf72@mail.gmail.com>

The curious Valgrind error

+ Conditional jump or move depends on uninitialised value(s)
+    at  SetWindowPos (winpos.c:2034)
+    by  LISTVIEW_UpdateSize (listview.c:9380)
+    by  LISTVIEW_Size (listview.c:9320)
+    by  LISTVIEW_WindowProc (listview.c:9949)
+    by  (within /home/dank/wine-git/dlls/user32/user32.dll.so)
+    by  call_window_proc (winproc.c:457)
+    by  WINPROC_CallProcAtoW (winproc.c:901)
+    by  CallWindowProcA (winproc.c:2282)
+    by  listview_subclass_proc (listview.c:231)
+    by  (within /home/dank/wine-git/dlls/user32/user32.dll.so)
+    by  call_window_proc (winproc.c:457)
+    by  WINPROC_CallProcWtoA (winproc.c:1267)
+    by  WINPROC_call_window (winproc.c:2200)
+    by  call_window_proc (message.c:1610)
+    by  send_message (message.c:2434)
+    by  SendMessageW (message.c:2557)
+    by  DEFWND_DefWinProc (defwnd.c:746)
+    by  DefWindowProcW (defwnd.c:1037)
+    by  LISTVIEW_WindowProc (listview.c:9994)
+    by  (within /home/dank/wine-git/dlls/user32/user32.dll.so)
+  Uninitialised value was created by a stack allocation
+    at  LISTVIEW_UpdateSize (listview.c:9351)

started happening recently.  Looking at LISTVIEW_UpdateSize,
it seems clear that if
  SendMessageW( infoPtr->hwndHeader, HDM_LAYOUT, 0, (LPARAM)&hl );
fails for whatever reason, hl will be undefined, and that's
what Valgrind is complaining about.  Here's a patch that skips the
rest of the function if that line fails; it makes Valgrind happy, and
doesn't seem to hurt the conformance tests.  Can somebody familiar
with the code have a look at that function and explain what's going on here?
Thanks!
- Dan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: listview.patch
Type: text/x-diff
Size: 1419 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080526/f9b902b8/attachment.patch 

From dank at kegel.com  Tue May 27 01:01:37 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 26 May 2008 23:01:37 -0700
Subject: runtest: Add an option to run the tests with valgrind
Message-ID: <a71bd89a0805262301n5c3a0d1wfdced68b687cdafc@mail.gmail.com>

Maarten wrote:
> Usage: make test RUNTEST="$WINE_GIT/tools/runtest -V" VALGRIND_OPTS="..."

That seems clumsier offhand than how I've been doing it,

RUNTEST_USE_VALGRIND=1 make test


From m.b.lankhorst at gmail.com  Tue May 27 01:14:03 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 27 May 2008 02:14:03 -0400
Subject: advpack.c must be compiled with optimization?
In-Reply-To: <a71bd89a0805262216u5e15b131va540cb8f1e566c0a@mail.gmail.com>
References: <a71bd89a0805262216u5e15b131va540cb8f1e566c0a@mail.gmail.com>
Message-ID: <b130c85e0805262314g63d498e8q955602139a85f753@mail.gmail.com>

Hello Dan,

2008/5/27 Dan Kegel <dank at kegel.com>:
> Oddly, if I compile the wine tree without -O2, the following
> test fails:
>
> ../../../wine advpack_test.exe.so advpack.c
> advpack.c:441: Test failed: Expected C:\Program Files, got C:\
> advpack.c:443: Test failed: Expected size 17, got 4
> make: *** [advpack.ok] Error 2
>
> Compiling advpack/advpack.c with at least -O makes
> the problem go away.
Out of curiosity I tried to do the same, it doesn't fail for me,
however I do get an 'unexpected pass into todo block' in
fusion/asmcache.c Valgrinding it gives even different results. (And a
lot of warnings of heapfree being used on a malloc in strdup)

Cheers,
Maarten


From dank at kegel.com  Tue May 27 01:17:26 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 26 May 2008 23:17:26 -0700
Subject: advpack.c must be compiled with optimization?
In-Reply-To: <b130c85e0805262314g63d498e8q955602139a85f753@mail.gmail.com>
References: <a71bd89a0805262216u5e15b131va540cb8f1e566c0a@mail.gmail.com>
	<b130c85e0805262314g63d498e8q955602139a85f753@mail.gmail.com>
Message-ID: <a71bd89a0805262317j4a2cab27vb772e4bd4d0f1383@mail.gmail.com>

On Mon, May 26, 2008 at 11:14 PM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
>> Oddly, if I compile the wine tree without -O2, the following
>> test fails:
>>
>> ../../../wine advpack_test.exe.so advpack.c
>> advpack.c:441: Test failed: Expected C:\Program Files, got C:\
>
> Out of curiosity I tried to do the same, it doesn't fail for me,
> however I do get an 'unexpected pass into todo block' in
> fusion/asmcache.c Valgrinding it gives even different results. (And a
> lot of warnings of heapfree being used on a malloc in strdup)

I think http://www.winehq.org/pipermail/wine-patches/2008-May/055234.html
fixes the latter problem...


From dank at kegel.com  Tue May 27 02:02:56 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 27 May 2008 00:02:56 -0700
Subject: Why I think it's worth fixing Valgrind warnings
Message-ID: <a71bd89a0805270002q2f3e9f23v4e381e0e0cbd1010@mail.gmail.com>

If you're wondering whether it's worth fixing Valgrind
warnings (after all, they are just warnings, right?):

First, some of the valgrind errors that show up
when running the test suite might be real bugs.
That might be enough reason right there.

Second, clearing out the valgrind errors that show
up in the test suite make it a lot easier to
find Wine bugs when running real apps on wine on valgrind.
(The lower the background noise level, the easier it is
to see the real problem.)

Third, if valgrind works well on wine, windows developers
might start coming to Wine just to run Valgrind on
their apps to find app bugs.  (Don't laugh!  It could happen!)

This is why I hired John Reiser to improve Valgrind/Wine support,
why I've been fixing a few valgrind warnings lately, and
why I think it's important for other people to start doing
it, too.

That said, it's important when fixing Valgrind errors to
really understand the code you're changing, lest you
paper over a bug with another bug, or make things worse.
(Here would be a good place for me to thank James for
his code reviews :-)
- Dan


