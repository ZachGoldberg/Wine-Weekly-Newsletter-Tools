From truiken at gmail.com  Sun Jun  1 02:21:24 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 1 Jun 2008 02:21:24 -0500
Subject: try 2: shell32: fix SHFileOperation copying to an empty file list
In-Reply-To: <ced95fe0805312335x7573ece2x9cf0ea34ac65a5b8@mail.gmail.com>
References: <ced95fe0805312335x7573ece2x9cf0ea34ac65a5b8@mail.gmail.com>
Message-ID: <22821af30806010021x72d758bdt63593a6b9f88b12e@mail.gmail.com>

On Sun, Jun 1, 2008 at 1:35 AM, Vincent Povirk
<madewokherd+d41d at gmail.com> wrote:
> This partially fixex bug 13394.
>
> Apparently there are two separate issues involved in that bug, one
> with empty destination lists (which Windows seems to treat as a list
> containing one 0-length string), and one involving long filenames.
> This patch only addresses the empty lists.
>

This fix is wrong.  We already handle empty file lists in parse_file
list.  If the list is empty, dwNumFiles is 0.  Why did you add another
variable for that?  Also, you need to add a test case for multiple
source files and an empty dest list for the FO_MOVE operation.  You
will not get ERROR_ACCESS_DENIED (the test will fail with your
change).

-- 
James Hawkins


From dank at kegel.com  Sun Jun  1 02:29:25 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 1 Jun 2008 00:29:25 -0700
Subject: Two quick press mentions about Microsoft and Wine (the other one)
Message-ID: <a71bd89a0806010029u4afa4f6cl61bc5a58736559e1@mail.gmail.com>

Microsoft Wine (Sept '07):
http://www.sommelierindia.com/blog/2007/10/changing_the_world_with_a_micr.html

Microsoft bans searches for Wine in France (today):
http://www.sbpost.ie/post/pages/p/story.aspx-qqqt=MEDIA+AND+MARKETING-qqqs=mediaandmarketing-qqqid=33312-qqqx=1.asp

Not sinister, just funny.  And somewhat inconvenient...


From dank at kegel.com  Sun Jun  1 02:44:44 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 1 Jun 2008 00:44:44 -0700
Subject: How long does it take you to compile wine?
Message-ID: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>

Way back five years ago, we all compared notes on how
long it took to build Wine on our systems.
http://www.winehq.org/site/?issue=149#Compile%20Time%20Comparisons%20/%20Tips

Today I measured it on a new computer (with a spiffy
new Intel dual core e7200 processor with 2GB of RAM,
http://kegel.com/new-computer-2008.html ).

Result: ... it takes me a bit longer today on this machine (11 minutes)
to build as it did then on a dual cpu hot rod (8 minutes).
I guess Moore's Law isn't quite keeping up with Wine's code growth :-)


From truiken at gmail.com  Sun Jun  1 02:47:58 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 1 Jun 2008 02:47:58 -0500
Subject: How long does it take you to compile wine?
In-Reply-To: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
Message-ID: <22821af30806010047r4aa50fabq81336d69ab2c153b@mail.gmail.com>

On Sun, Jun 1, 2008 at 2:44 AM, Dan Kegel <dank at kegel.com> wrote:
> Way back five years ago, we all compared notes on how
> long it took to build Wine on our systems.
> http://www.winehq.org/site/?issue=149#Compile%20Time%20Comparisons%20/%20Tips
>
> Today I measured it on a new computer (with a spiffy
> new Intel dual core e7200 processor with 2GB of RAM,
> http://kegel.com/new-computer-2008.html ).
>
> Result: ... it takes me a bit longer today on this machine (11 minutes)
> to build as it did then on a dual cpu hot rod (8 minutes).
> I guess Moore's Law isn't quite keeping up with Wine's code growth :-)
>

What are your arguments to make?

-- 
James Hawkins


From dank at kegel.com  Sun Jun  1 03:16:19 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 1 Jun 2008 01:16:19 -0700
Subject: How long does it take you to compile wine?
In-Reply-To: <22821af30806010047r4aa50fabq81336d69ab2c153b@mail.gmail.com>
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
	<22821af30806010047r4aa50fabq81336d69ab2c153b@mail.gmail.com>
Message-ID: <a71bd89a0806010116w5b5fc6d7rc03fc2f8d40571bb@mail.gmail.com>

On Sun, Jun 1, 2008 at 12:47 AM, James Hawkins <truiken at gmail.com> wrote:
>> Today I measured it on a new computer (with a spiffy
>> new Intel dual core e7200 processor with 2GB of RAM,
>> http://kegel.com/new-computer-2008.html ).
>>
>> Result: ... it takes me a bit longer today on this machine (11 minutes)
>> to build as it did then on a dual cpu hot rod (8 minutes).
>> I guess Moore's Law isn't quite keeping up with Wine's code growth :-)
>
> What are your arguments to make?

Details are on buried that page, but it's "-j3" for the dual core /
dual CPU systems.

I found a nice graph of Wine's codebase size over time:
http://www.ohloh.net/projects/wine/analyses/latest
Looks like it's just about exactly doubled since that
last measurement in late 2002.

I suppose my e7200 is a budget performance system; a dual Xeon back then
was pretty special.  Probably have to compare it to something
heftier today?
- Dan


From wine at mkarcher.dialup.fu-berlin.de  Sun Jun  1 04:46:26 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Sun, 01 Jun 2008 11:46:26 +0200
Subject: [2/2] ddraw: Rename IDirectDraw functions (try 2)
In-Reply-To: <200806010047.02192.stefan@codeweavers.com>
References: <1212268262.4746.65.camel@hermes2.karcher.local>
	<4841CD82.2060601@wanadoo.fr>
	<200806010047.02192.stefan@codeweavers.com>
Message-ID: <1212313586.4746.80.camel@hermes2.karcher.local>

Am Sonntag, den 01.06.2008, 00:47 +0200 schrieb Stefan D?singer:
> Am Sonntag, 1. Juni 2008 00:13:22 schrieb Christian Costa:
> > Hi Michael,
> >
> > I think it would be better to fix function names in IDirectDraw7.
> The IDirectDraw7 functions are without a version number because they're the 
> common implementation for all ddraw versions. If there's a specific function 
> for IDirectDraw7 that is not called by older versions via thunk due to 
> behavior differences, it is already called IDirectDraw7Impl_XYZ

No, it isn't. Take a look at DirectDrawImpl_AddRef and
DirectDrawImpl_Release. I can submit an alternative patch that instead
of renaming the DirectDraw(1) functions renames these two DirectDraw7
functions, which also resolves the confusing debug logs. I know, if you
look carefully, you can distinguish them by the message "IDirectDraw7
refcount" or "IDirectDraw refcount", but even here it is non-obvious
that the IDirectDraw refcount is not connected to the interface in
ddraw.c where all the functions are called IDirectDrawImpl_Foo.

Another alternative would be to leave function naming as is, and make
sure that *all* functions in ddraw_thunk.c are reporting through the
ddraw_thunk channel, which my patch [1/2] removes. I still prefer
personally a solution that does rename functions to makes function names
unique. It helps for setting breakpoints.

Regards,
  Michael Karcher



From msclrhd at googlemail.com  Sun Jun  1 02:55:44 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sun, 1 Jun 2008 08:55:44 +0100
Subject: How long does it take you to compile wine?
In-Reply-To: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
Message-ID: <3f4fd2640806010055x73a1d2c3k2b435dad851a41f6@mail.gmail.com>

2008/6/1 Dan Kegel <dank at kegel.com>:
> Way back five years ago, we all compared notes on how
> long it took to build Wine on our systems.
> http://www.winehq.org/site/?issue=149#Compile%20Time%20Comparisons%20/%20Tips
>
> Today I measured it on a new computer (with a spiffy
> new Intel dual core e7200 processor with 2GB of RAM,
> http://kegel.com/new-computer-2008.html ).
>
> Result: ... it takes me a bit longer today on this machine (11 minutes)
> to build as it did then on a dual cpu hot rod (8 minutes).
> I guess Moore's Law isn't quite keeping up with Wine's code growth :-)

Have you checked how much Wine has grown in size since then and
factored that in as well?

Five years seems to be before CodeWeavers took the torch (I don't know
when they started contributing *big time* to Wine) with the MSI,
DirectX and other improvements.

A way to get a better idea would be to get the number of lines in the
make output and have a lines/second comparison. This is because Wine
could be twice as big as it was five years ago.

- Reece


From vit.hrachovy at sandbox.cz  Sun Jun  1 05:06:15 2008
From: vit.hrachovy at sandbox.cz (=?ISO-8859-2?Q?V=EDt_Hrachov=FD?=)
Date: Sun, 01 Jun 2008 12:06:15 +0200
Subject: How long does it take you to compile wine?
In-Reply-To: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
Message-ID: <48427497.4090209@sandbox.cz>

Hi Dan,
it's 31 minutes on  AMD Athlon(tm) 64 Processor 3700+, 2GB RAM.
Cheers
Vit

Dan Kegel wrote:
> Way back five years ago, we all compared notes on how
> long it took to build Wine on our systems.
> http://www.winehq.org/site/?issue=149#Compile%20Time%20Comparisons%20/%20Tips
> 
> Today I measured it on a new computer (with a spiffy
> new Intel dual core e7200 processor with 2GB of RAM,
> http://kegel.com/new-computer-2008.html ).
> 
> Result: ... it takes me a bit longer today on this machine (11 minutes)
> to build as it did then on a dual cpu hot rod (8 minutes).
> I guess Moore's Law isn't quite keeping up with Wine's code growth :-)
> 
> 



From eric.pouech at orange.fr  Sun Jun  1 06:50:58 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Sun, 01 Jun 2008 13:50:58 +0200
Subject: How long does it take you to compile wine?
In-Reply-To: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
Message-ID: <48428D22.9000403@orange.fr>

Dan Kegel a ?crit :
> Way back five years ago, we all compared notes on how
> long it took to build Wine on our systems.
> http://www.winehq.org/site/?issue=149#Compile%20Time%20Comparisons%20/%20Tips
>
> Today I measured it on a new computer (with a spiffy
> new Intel dual core e7200 processor with 2GB of RAM,
> http://kegel.com/new-computer-2008.html ).
>
> Result: ... it takes me a bit longer today on this machine (11 minutes)
> to build as it did then on a dual cpu hot rod (8 minutes).
> I guess Moore's Law isn't quite keeping up with Wine's code growth :-)
>
>
>
>
>   
I used to compiled it over 30minutes...
now I barely wait... 6mn26s

make -j5, Q6600 @ 2.4GHz
gcc version also matters (4.2.3 for me)
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From titan.costa at wanadoo.fr  Sun Jun  1 07:24:15 2008
From: titan.costa at wanadoo.fr (Christian Costa)
Date: Sun, 01 Jun 2008 14:24:15 +0200
Subject: [2/2] ddraw: Rename IDirectDraw functions (try 2)
In-Reply-To: <200806010047.02192.stefan@codeweavers.com>
References: <1212268262.4746.65.camel@hermes2.karcher.local>
	<4841CD82.2060601@wanadoo.fr>
	<200806010047.02192.stefan@codeweavers.com>
Message-ID: <484294EF.1090007@wanadoo.fr>

Stefan D?singer a ?crit :
> Am Sonntag, 1. Juni 2008 00:13:22 schrieb Christian Costa:
>   
>> Hi Michael,
>>
>> I think it would be better to fix function names in IDirectDraw7.
>>     
> The IDirectDraw7 functions are without a version number because they're the 
> common implementation for all ddraw versions. If there's a specific function 
> for IDirectDraw7 that is not called by older versions via thunk due to 
> behavior differences, it is already called IDirectDraw7Impl_XYZ
>
>
>   
The problem is that makes the confusion with version 1 even with 
Mickael's patch.
In Direct3D thunks, we avoided that by moving the number after the impl, 
setting the version 1 explicitely
and prefixing by Thunks (ex: Thunk_IDirect3DDeviceImpl_1_xxx).
So I suggest to use the same naming scheme.

Christian




From hans at it.vu.nl  Sun Jun  1 07:48:25 2008
From: hans at it.vu.nl (Hans Leidekker)
Date: Sun, 1 Jun 2008 14:48:25 +0200
Subject: How long does it take you to compile wine?
In-Reply-To: <a71bd89a0806010116w5b5fc6d7rc03fc2f8d40571bb@mail.gmail.com>
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
	<22821af30806010047r4aa50fabq81336d69ab2c153b@mail.gmail.com>
	<a71bd89a0806010116w5b5fc6d7rc03fc2f8d40571bb@mail.gmail.com>
Message-ID: <200806011448.25185.hans@it.vu.nl>

On Sunday 01 June 2008 10:16:19 Dan Kegel wrote:

> I suppose my e7200 is a budget performance system; a dual Xeon back then
> was pretty special.  Probably have to compare it to something
> heftier today?

It's 4m55s on a 2 way dual core Xeon machine (4 cores, 2 Ghz, 4MB cache each).
This is on a hot disk cache, i.e. I ran

$ make distclean && ./configure && time make -j5

twice and took the second measurement. Compiler is gcc 4.3.0.

 -Hans


From fgouget at free.fr  Sun Jun  1 08:14:21 2008
From: fgouget at free.fr (Francois Gouget)
Date: Sun, 1 Jun 2008 15:14:21 +0200 (CEST)
Subject: Winetest grrr...
In-Reply-To: <3a768c550805300751i5ceb1f5pd5b462d973a122b9@mail.gmail.com>
References: <3a768c550805300751i5ceb1f5pd5b462d973a122b9@mail.gmail.com>
Message-ID: <alpine.DEB.1.10.0806011510550.30909@amboise.dolphin>

On Fri, 30 May 2008, Juan Lang wrote:
[...]
> I thought I'd run winetest.exe from Paul Millar's site, just
> in case the compilation environment had something to do with it.
[...]
> How the ^$*@ am I supposed to produce a test when the existing ones
> fail/crash/burn for me?  Grrr...

I'm not saying that the it's ok for the tests to crash/freeze your 
system. But here's a workaround for 'extracting' the test executables 
from Paul Millar's exe. Start winetest, wait until the first test 
starts, and then kill winetest.exe (or close the winetest window). Then 
you can find the test binaries in c:\Windows\Temp\wct (or possibly 
c:\Documents and Settings\your account\Local Settings\Temp or something 
like that). Then you can run just the test you want. And yes, it would 
be nice if the winetest GUI was better and let you do that more cleanly.



-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
          Demander si un ordinateur peut penser revient ? demander
                         si un sous-marin peut nager.

From fgouget at free.fr  Sun Jun  1 08:29:05 2008
From: fgouget at free.fr (Francois Gouget)
Date: Sun, 1 Jun 2008 15:29:05 +0200 (CEST)
Subject: Fixing crashes in Tests (OS version check)
In-Reply-To: <3a768c550805311151h77f6a138y65a95e6716510f3e@mail.gmail.com>
References: <g1qjjf$bi6$1@ger.gmane.org> <48410A88.7010801@gmail.com>
	<48411E89.40106@hotmail.com>
	<3a768c550805311151h77f6a138y65a95e6716510f3e@mail.gmail.com>
Message-ID: <alpine.DEB.1.10.0806011523420.30909@amboise.dolphin>

On Sat, 31 May 2008, Juan Lang wrote:
[...]

> > An example of one that fails is
> > ret = SnmpUtilOidToA(NULL);
> > Under win98, this function is valid to call, but will crash if you call
> > it will a NULL parameter.  I don't think removing this test a good idea,
> > since we are setting XP as a base, at this passes.
> 
> I disagree that the test shouldn't be removed.  The tests are meant to
> show Windows behavior that apps are likely to expect.

The thing is that this evolves with time. Back in 2000 nobody would have 
called SnmpUtilOidToA with a NULL parameter as it would have meant 
crashing on a lot of the Windows install base. Nowadays every ISV 
expects you to have at least Windows XP and wouldn't care one bit if 
that call means crashing the application on NT4 or lower.

So you could say that nowadays applications are likely to expect 
SnmpUtilOidToA(NULL) not to crash which means keeping these tests. 
However I don't think our conformance tests should crash on older 
systems and that's what makes things tricky...


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
      Broadcast message : fin du monde dans cinq minutes, repentez vous !


From dank at kegel.com  Sun Jun  1 09:20:38 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 1 Jun 2008 07:20:38 -0700
Subject: How long does it take you to compile wine?
In-Reply-To: <48428D22.9000403@orange.fr>
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
	<48428D22.9000403@orange.fr>
Message-ID: <a71bd89a0806010720m73414bdfqae26fb1e46589c66@mail.gmail.com>

On Sun, Jun 1, 2008 at 4:50 AM, Eric Pouech <eric.pouech at orange.fr> wrote:
> I used to compiled it over 30minutes...
> now I barely wait... 6mn26s
>
> make -j5, Q6600 @ 2.4GHz

Ouch!  I almost chose a Q6600 for this machine!
Well, I suppose I should test it with the motherboard graphics
turned off, that saps a lot of performance.

> gcc version also matters (4.2.3 for me)

I'm using same version.

What graphics card, btw?
- Dan


From jens at albretsen.dk  Sun Jun  1 09:22:08 2008
From: jens at albretsen.dk (Jens Albretsen)
Date: Sun, 1 Jun 2008 16:22:08 +0200 (CEST)
Subject: ddraw: Don't release ddraw if a surface is still using it.
Message-ID: <63602.89.239.230.29.1212330128.squirrel@mail.albretsen.dk>

> Am Samstag, 31. Mai 2008 17:03:13 schrieb Michael Karcher:
>> > Anyway it makes wine stop crashing when programs tries to do something
>> > crazy like this. Stefan D??singer asked me to put a HeapAlloc all
>> memory
>> > between the two Release's to check if the memory of ddraw object would
>> be
>> > corrupt in Windows. It really doesn't matter if programs live by
>> chance
>> > in windows, if we can implement it so it's not by chance anymore.
>>
>> I agree on that point.
> Actually, that is dangerous. There may be situations in which this
> make-something-work has an unintended side effect, e.g. failure to restore
> the display mode because the ddraw object isn't destroyed(although it
> maybe
> should be - it's the test's job to find that out).

You're right, if we expect every program to behave.
I guess we need a hook for wined3d (if we not already have it) to restore
the state back at process termination, if there is stuff not freed,
changed video modes and such.
I believe d3d does this natively, if you change video and there is a
abnormal program termination it will restore the video mode and if you're
running with debug libraries it will tell you what you forgot to free, at
least in Windows XP.
I actually ran wine without virtual desktop at one point where program
crashed, had to hard reset because video wasn't restored,
CTRL+ALT+BACKSPACE didn't work, so now i'm running everything in a virtual
desktop, so I guess there isn't any hook and we expect all programs to
behave.
The hook could probably be put wined3d_main.c/DllMain() fdwReason ==
DLL_PROCESS_DETACH so it closes wined3d correctly, in the event of
abnormal program execution.

> Another possibility are apps that intend to cause an exception, like copy
> protection systems.

Anyway still need to know if the test fails or passes in Windows.




From eric.pouech at orange.fr  Sun Jun  1 09:49:41 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Sun, 01 Jun 2008 16:49:41 +0200
Subject: How long does it take you to compile wine?
In-Reply-To: <a71bd89a0806010720m73414bdfqae26fb1e46589c66@mail.gmail.com>
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>	
	<48428D22.9000403@orange.fr>
	<a71bd89a0806010720m73414bdfqae26fb1e46589c66@mail.gmail.com>
Message-ID: <4842B705.5090101@orange.fr>


> I'm using same version.
>
> What graphics card, btw?
ATI Radeon HD 2600 XT
A+



-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From winehacker at gmail.com  Sun Jun  1 12:10:05 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 1 Jun 2008 13:10:05 -0400
Subject: How long does it take you to compile wine?
In-Reply-To: <a71bd89a0806010720m73414bdfqae26fb1e46589c66@mail.gmail.com>
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
	<48428D22.9000403@orange.fr>
	<a71bd89a0806010720m73414bdfqae26fb1e46589c66@mail.gmail.com>
Message-ID: <19e31a080806011010p4176188v532cc8b92b52fa99@mail.gmail.com>

On Sun, Jun 1, 2008 at 10:20 AM, Dan Kegel <dank at kegel.com> wrote:
>> make -j5, Q6600 @ 2.4GHz

for comparison I have an older 2.4 ghz quad CPU single core build box
with gcc 4.1.x and Fiesty. make -j4

real	16m34.006s
user	56m54.569s
sys	3m26.561s

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From truiken at gmail.com  Sun Jun  1 13:26:02 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 1 Jun 2008 13:26:02 -0500
Subject: advapi32: RegEnumKeyEx() should return "ERROR_INVALID_PARAMETER"
	if name_len is NULL
In-Reply-To: <200806011728.17080.andrew.talbot@talbotville.com>
References: <200806011728.17080.andrew.talbot@talbotville.com>
Message-ID: <22821af30806011126p445f507er7df4f0ca7596a0fb@mail.gmail.com>

On Sun, Jun 1, 2008 at 11:28 AM, Andrew Talbot
<andrew.talbot at talbotville.com> wrote:
> Like native.
>
> -- Andy.
> ---
> Changelog:
>    advapi32: RegEnumKeyEx() should return "ERROR_INVALID_PARAMETER" if name_len is NULL.
>
> diff --git a/dlls/advapi32/registry.c b/dlls/advapi32/registry.c
> index 9ce3da0..41ef3bf 100644
> --- a/dlls/advapi32/registry.c
> +++ b/dlls/advapi32/registry.c
> @@ -473,7 +473,7 @@ LSTATUS WINAPI RegEnumKeyExW( HKEY hkey, DWORD index, LPWSTR name, LPDWORD name_
>     TRACE( "(%p,%d,%p,%p(%d),%p,%p,%p,%p)\n", hkey, index, name, name_len,
>            name_len ? *name_len : -1, reserved, class, class_len, ft );
>
> -    if (reserved) return ERROR_INVALID_PARAMETER;
> +    if (!name_len || reserved) return ERROR_INVALID_PARAMETER;
>     if (!(hkey = get_special_root_hkey( hkey ))) return ERROR_INVALID_HANDLE;
>
>     status = NtEnumerateKey( hkey, index, KeyNodeInformation,
> @@ -537,7 +537,7 @@ LSTATUS WINAPI RegEnumKeyExA( HKEY hkey, DWORD index, LPSTR name, LPDWORD name_l
>     TRACE( "(%p,%d,%p,%p(%d),%p,%p,%p,%p)\n", hkey, index, name, name_len,
>            name_len ? *name_len : -1, reserved, class, class_len, ft );
>
> -    if (reserved) return ERROR_INVALID_PARAMETER;
> +    if (!name_len || reserved) return ERROR_INVALID_PARAMETER;
>     if (!(hkey = get_special_root_hkey( hkey ))) return ERROR_INVALID_HANDLE;
>
>     status = NtEnumerateKey( hkey, index, KeyNodeInformation,
>

Please add a test.

-- 
James Hawkins


From winehacker at gmail.com  Sun Jun  1 15:39:48 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 1 Jun 2008 16:39:48 -0400
Subject: iexplore/gecko problems with recent builds
Message-ID: <19e31a080806011339u5ecb436drd3ea632ab877f6c@mail.gmail.com>

Hi,
I did not find anything about this in bugzilla. Is anyone else having
problems using builtin IE with gecko? I keep getting this error with
the tip

err:mshtml:before_async_open GetWineURL returned NULL

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From wine at eternaldusk.com  Sun Jun  1 18:09:40 2008
From: wine at eternaldusk.com (Evil Jay)
Date: Sun, 01 Jun 2008 18:09:40 -0500
Subject: How long does it take you to compile wine?
In-Reply-To: <19e31a080806011010p4176188v532cc8b92b52fa99@mail.gmail.com>
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>	<48428D22.9000403@orange.fr>	<a71bd89a0806010720m73414bdfqae26fb1e46589c66@mail.gmail.com>
	<19e31a080806011010p4176188v532cc8b92b52fa99@mail.gmail.com>
Message-ID: <48432C34.3040806@eternaldusk.com>

real    5m22.625s
user    17m16.993s
sys     1m1.336s

This is on Kubuntu 8.04 w/GCC 4.2.3.  The system uses a Q6600
overclocked to 2.9Ghz, 4GB of DDR2 RAM at 1066Mhz, and a 9600GT video
card.  I had Amarok and some other stuff going in the background, but
nothing that would make a huge diff.

-J


From truiken at gmail.com  Sun Jun  1 18:19:32 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 1 Jun 2008 18:19:32 -0500
Subject: [1/3] ddraw/tests: Detach surface if attaching worked by surprise
	(or refrast)
In-Reply-To: <1212360450.4746.93.camel@hermes2.karcher.local>
References: <1212360450.4746.93.camel@hermes2.karcher.local>
Message-ID: <22821af30806011619v14a4799euccf8485ee17e1a61@mail.gmail.com>

On Sun, Jun 1, 2008 at 5:47 PM, Michael Karcher
<wine at mkarcher.dialup.fu-berlin.de> wrote:
> ---
>  dlls/ddraw/tests/dsurface.c |    3 +++
>  1 files changed, 3 insertions(+), 0 deletions(-)
>

Patch already sent:

http://winehq.org/pipermail/wine-patches/2008-May/055424.html

-- 
James Hawkins


From truiken at gmail.com  Sun Jun  1 18:23:29 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 1 Jun 2008 18:23:29 -0500
Subject: [2/3] ddraw/tests: Add another refrast exception
In-Reply-To: <1212360491.4746.95.camel@hermes2.karcher.local>
References: <1212360491.4746.95.camel@hermes2.karcher.local>
Message-ID: <22821af30806011623s3e46f2e1p6dfb00ecda106cc2@mail.gmail.com>

On Sun, Jun 1, 2008 at 5:48 PM, Michael Karcher
<wine at mkarcher.dialup.fu-berlin.de> wrote:
> ---
>  dlls/ddraw/tests/dsurface.c |    5 ++++-
>  1 files changed, 4 insertions(+), 1 deletions(-)
>

I've gone through all the latest test results, and this failure isn't
happening anywhere that I've seen.  Please link to where you're seeing
this.

-- 
James Hawkins


From juan.lang at gmail.com  Sun Jun  1 19:14:19 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Sun, 1 Jun 2008 17:14:19 -0700
Subject: Winetest grrr...
In-Reply-To: <alpine.DEB.1.10.0806011510550.30909@amboise.dolphin>
References: <3a768c550805300751i5ceb1f5pd5b462d973a122b9@mail.gmail.com>
	<alpine.DEB.1.10.0806011510550.30909@amboise.dolphin>
Message-ID: <3a768c550806011714x7fbb7e18v9c88247cb2ffd163@mail.gmail.com>

> here's a workaround for 'extracting' the test executables
> from Paul Millar's exe. Start winetest, wait until the first test
> starts, and then kill winetest.exe (or close the winetest window). Then
> you can find the test binaries in c:\Windows\Temp\wct (or possibly
> c:\Documents and Settings\your account\Local Settings\Temp or something
> like that). Then you can run just the test you want.

Thanks, I'll do that!
--Juan


From juan.lang at gmail.com  Sun Jun  1 19:54:30 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Sun, 1 Jun 2008 17:54:30 -0700
Subject: Fixing crashes in Tests (OS version check)
In-Reply-To: <alpine.DEB.1.10.0806011523420.30909@amboise.dolphin>
References: <g1qjjf$bi6$1@ger.gmane.org> <48410A88.7010801@gmail.com>
	<48411E89.40106@hotmail.com>
	<3a768c550805311151h77f6a138y65a95e6716510f3e@mail.gmail.com>
	<alpine.DEB.1.10.0806011523420.30909@amboise.dolphin>
Message-ID: <3a768c550806011754k481aa8b0i5741e62b0c7167cd@mail.gmail.com>

> The thing is that this evolves with time. Back in 2000 nobody would have
> called SnmpUtilOidToA with a NULL parameter as it would have meant
> crashing on a lot of the Windows install base. Nowadays every ISV
> expects you to have at least Windows XP and wouldn't care one bit if
> that call means crashing the application on NT4 or lower.
>
> So you could say that nowadays applications are likely to expect
> SnmpUtilOidToA(NULL) not to crash which means keeping these tests.
> However I don't think our conformance tests should crash on older
> systems and that's what makes things tricky...

I agree with you that resolving issues like this can be subtle, since
there will always be specific examples when a general principle does
not apply.  They don't invalidate the general principle unless they
outnumber it or outweigh it in some way.  So, in my opinion, the
general principle is this:  if the behavior is very different on
different Windows versions, and if the behavior on some Windows
version is to crash, it seems reasonable to remove the test, as: 1) we
want our tests to reflect Windows behavior that applications count on,
and different behavior (especially crashing) often implies the
applications don't count on a particular behavior, and 2) having
regression tests crash is undesirable, as many other valid tests will
not be run on a platform.

This doesn't mean that we can't make Wine not crash given the bogus
input, it just means we may not be able to have a regression test for
this behavior.  And, of course, there may be specific instances in
which we wish to test potentially crashy behavior, but I'd argue that
they better be really important to override points 1) and 2).

And coming back to this test:  I still think it's easier just to
remove the test than to come up with a hacky way of avoiding it on a
crashy system.
--Juan


From wine-devel at kievinfo.com  Sun Jun  1 22:37:39 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 01 Jun 2008 21:37:39 -0600
Subject: Time to revert bad commits?
Message-ID: <48436B03.1080402@kievinfo.com>

I'm afraid we are out of time to fix bugs that introduces major d3d 
regressions. I've yet to see a single patch that addressed those issues.

It's time to start reverting bad commits and testing the results.

The bugs I'm talking about:
Bug 10580
Bug 11584
Bug 12794
Bug 13101

Vitaliy.


From wine at mkarcher.dialup.fu-berlin.de  Mon Jun  2 00:59:01 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Mon, 02 Jun 2008 07:59:01 +0200
Subject: [2/3] ddraw/tests: Add another refrast exception
In-Reply-To: <22821af30806011623s3e46f2e1p6dfb00ecda106cc2@mail.gmail.com>
References: <1212360491.4746.95.camel@hermes2.karcher.local>
	<22821af30806011623s3e46f2e1p6dfb00ecda106cc2@mail.gmail.com>
Message-ID: <1212386341.4746.108.camel@hermes2.karcher.local>

Am Sonntag, den 01.06.2008, 18:23 -0500 schrieb James Hawkins:
> On Sun, Jun 1, 2008 at 5:48 PM, Michael Karcher
> <wine at mkarcher.dialup.fu-berlin.de> wrote:
> > ---
> >  dlls/ddraw/tests/dsurface.c |    5 ++++-
> >  1 files changed, 4 insertions(+), 1 deletions(-)
> >
> I've gone through all the latest test results, and this failure isn't
> happening anywhere that I've seen.  Please link to where you're seeing
> this.

You are right. I also don't see it on the web. I have seen it on my own
system, in an virtual machine (kvm/qemu). It only happens on 16 bpp. On
24 bpp it fails in failure modes also seen on the test page, because
refrast doesn't support 24 bpp. (I get the typical "12 failures, 2
skipped" failure mode on 24 bpp)[1]. Probably no one runs the tests at
16 bpp. kvm/qemu's virtual card (Cirrus Logic 5446) does not support 32
bpp.

If you declare 16 bpp as generally unsupported, please ignore this
patch. If you declare virtual machines as unsupported, I can try that on
a real machine (with Win'98 instead of XP, though). I really have a real
hardware board of the card emulated by qemu, so I can try on that very
hardware (it runs on vga.dll, with a small addition for modesetting and
banking).

Regards
  Michael Karcher

[1]:
http://test.winehq.org/data/dae64e67fc9b1bf1b1950b86f7d58184a4b4c942/xp_XPproSP2-VB1.60/ddraw:dsurface.txt
http://test.winehq.org/data/dae64e67fc9b1bf1b1950b86f7d58184a4b4c942/xp_winxp-sp3/ddraw:dsurface.txt




From wine at mkarcher.dialup.fu-berlin.de  Mon Jun  2 01:00:48 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Mon, 02 Jun 2008 08:00:48 +0200
Subject: [1/3] ddraw/tests: Detach surface if attaching worked by
	surprise (or refrast)
In-Reply-To: <22821af30806011619v14a4799euccf8485ee17e1a61@mail.gmail.com>
References: <1212360450.4746.93.camel@hermes2.karcher.local>
	<22821af30806011619v14a4799euccf8485ee17e1a61@mail.gmail.com>
Message-ID: <1212386448.4746.110.camel@hermes2.karcher.local>

Am Sonntag, den 01.06.2008, 18:19 -0500 schrieb James Hawkins:
> On Sun, Jun 1, 2008 at 5:47 PM, Michael Karcher
> <wine at mkarcher.dialup.fu-berlin.de> wrote:
> > ---
> >  dlls/ddraw/tests/dsurface.c |    3 +++
> >  1 files changed, 3 insertions(+), 0 deletions(-)
> >
> Patch already sent:
> http://winehq.org/pipermail/wine-patches/2008-May/055424.html
Yes, right.

Sorry for the noise.

Regards,
  Michael Karcher



From thunderbird2k at gmx.net  Mon Jun  2 01:11:13 2008
From: thunderbird2k at gmx.net (Roderick Colenbrander)
Date: Mon, 02 Jun 2008 08:11:13 +0200
Subject: Time to revert bad commits?
In-Reply-To: <48436B03.1080402@kievinfo.com>
References: <48436B03.1080402@kievinfo.com>
Message-ID: <20080602061113.282120@gmx.net>

> I'm afraid we are out of time to fix bugs that introduces major d3d 
> regressions. I've yet to see a single patch that addressed those issues.
> 
> It's time to start reverting bad commits and testing the results.
> 
> The bugs I'm talking about:
> Bug 10580
> Bug 11584
> Bug 12794
> Bug 13101
> 
> Vitaliy.
> 

Regarding 13101 that bug is an Nvidia driver bug. The code itself is really correct and there are more cases in which the issue gets triggered (not just multisampling). I need more testers (I added comments to the bug) to reproduce it on different systems, games and driver versions so that I can create a good bug report to submit to Nvidia.

Roderick
-- 
GMX startet ShortView.de. Hier findest Du Leute mit Deinen Interessen!
Jetzt dabei sein: http://www.shortview.de/?mc=sv_ext_mf at gmx


From dmitry at codeweavers.com  Mon Jun  2 01:18:06 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 2 Jun 2008 15:18:06 +0900
Subject: [try 4] user32: Use correct buffer header for cursor
	inCURSORICON_LoadFromFile
References: <484385E7.70905@gmail.com>
Message-ID: <58C8F43F6E8A4660953B8460A35924A2@DMITRY>

"Sergey Khodych" <khodych at gmail.com> wrote:

> CreateIconFromResourceEx expects POINT16 at beginning of input buffer(
> for cursors ).
> Fixes bug #5031.

Please follow the indentation/braces style of the file you are changing.

-- 
Dmitry.


From hverbeet at gmail.com  Mon Jun  2 01:29:02 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 2 Jun 2008 08:29:02 +0200
Subject: Revert "wined3d: Put implicit surfaces into drawable on unload."
In-Reply-To: <48437192.3020805@kievinfo.com>
References: <48437192.3020805@kievinfo.com>
Message-ID: <d658b69e0806012329y5311107s1b91351f1c4cb2c9@mail.gmail.com>

2008/6/2 Vitaliy Margolen <wine-patches at kievinfo.com>:
> This reverts commit 0de167db9e2ef6c62ba48b050bc3d0ba2638467f.
> Fixes bug 12794 and probably others related to the black screen with enabled
> FBO.
> ---
>  dlls/wined3d/surface.c |   11 ++---------
>  1 files changed, 2 insertions(+), 9 deletions(-)
>
I've actually got a more correct fix for this, which I'll send in later today.


From stefandoesinger at gmx.at  Mon Jun  2 02:10:18 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 2 Jun 2008 09:10:18 +0200
Subject: Time to revert bad commits?
In-Reply-To: <20080602061113.282120@gmx.net>
References: <48436B03.1080402@kievinfo.com> <20080602061113.282120@gmx.net>
Message-ID: <200806020910.18527.stefandoesinger@gmx.at>

Am Montag, 2. Juni 2008 08:11:13 schrieb Roderick Colenbrander:
> > The bugs I'm talking about:
> > Bug 10580
Sorry that I did not have time yet to look into that, but instead of ranting 
you could also look at the GLSL docs and make a patch. Renaming the local 
constants from LC to LVC for vertex and LPC for pixel shaders, and then 
loading the uniforms after program linking should fix the issue for GLSL. In 
ARB, just read them from program local environment and load the constants 
after compiling the shader.


From stefandoesinger at gmx.at  Mon Jun  2 02:13:13 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 2 Jun 2008 09:13:13 +0200
Subject: Revert "wined3d: Preload target in ActivateContext() for
	ORM_BACKBUFFER/ORM_PBUFFER."
In-Reply-To: <48437C07.2010101@kievinfo.com>
References: <48437C07.2010101@kievinfo.com>
Message-ID: <200806020913.13429.stefandoesinger@gmx.at>

Am Montag, 2. Juni 2008 06:50:15 schrieb Vitaliy Margolen:
> This reverts commit 2d0016c5bc872afb562727278cfd341cea182600.
> Partially fixes bug 11584.
I think we can revert that patch(ie, apply this patch). I haven't had time to 
look over the code yet, but I can't think of any problems this would cause. 
If it does cause problems, there's a bug elsewhere.

I think this patch was needed to work around some surface management bugs 
before the ModifyLocation / LoadLocation methods were introduced


From wine at mkarcher.dialup.fu-berlin.de  Mon Jun  2 03:00:24 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Mon, 02 Jun 2008 10:00:24 +0200
Subject: Crash in test d3d9:stateblock with warn+heap is a wine bug
Message-ID: <1212393624.4746.143.camel@hermes2.karcher.local>

Hello developers (mostly direct3d hackers),

the infamous crash in d3d9:stateblock [1] is caused by a call sequence
that is forbidden according to the DirectX SDK documentation. The
switch_rendertarget test makes a new swap chain, and sets its backbuffer
as new rendering target, and then releases the swap chain. The
backbuffer is obtained by GetBackBuffer on the new swapchain. The SDK
tells states explicitly that you have to release all surfaces obtained
by GetBackBuffer before you release the swapchain itself. [2]

In Windows, this buggy behaviour seems to work nicely (no crash in the
d3d9:stateblock test and no errors with maximum debugging settings in
the debugging d3d9 runtime), whereas on wine, at releasing the
backbuffer finally, some access to the state is made which has already
been released with the swapchain.

So, we have two options:
  - Consider using backbuffer of released chains buggy:
      Fix the test to not release the swapchain
      Upgrade the FIXMEs in dlls/wined3d/swapchain.c, lines
         95 and 104 to ERR
  - Implement behaviour seemingly compatible to Windows:
      Have a hidden reference counter to the swap chain or
      for the contexts to prevent them from getting freed too
      early.

Does anyone knows whether the test has this been written buggy on
purpose (some app does this), or it is by accident?

Regards,
  Michael Karcher

[1]: Bugs 9916, 12246
[2]: http://msdn.microsoft.com/en-us/library/bb205902(VS.85).aspx




From winehacker at gmail.com  Mon Jun  2 03:02:08 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 2 Jun 2008 04:02:08 -0400
Subject: iexplore/gecko problems with recent builds
In-Reply-To: <19e31a080806011339u5ecb436drd3ea632ab877f6c@mail.gmail.com>
References: <19e31a080806011339u5ecb436drd3ea632ab877f6c@mail.gmail.com>
Message-ID: <19e31a080806020102p394543aep75b5f0c671d5ea44@mail.gmail.com>

On Sun, Jun 1, 2008 at 4:39 PM, Steven Edwards <winehacker at gmail.com> wrote:
> I did not find anything about this in bugzilla. Is anyone else having
> problems using builtin IE with gecko? I keep getting this error with
> the tip
>
> err:mshtml:before_async_open GetWineURL returned NULL

This issue seems to be restricted to Ubuntu 8.04 AMD64 Hardy, I found
a couple of theads where other users had this problem intermittently.
I'll pull some traces and file a bug report.

Thanks
-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From ivg231 at gmail.com  Mon Jun  2 04:57:21 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Mon, 02 Jun 2008 05:57:21 -0400
Subject: Time to revert bad commits?
In-Reply-To: <200806020910.18527.stefandoesinger@gmx.at>
References: <48436B03.1080402@kievinfo.com> <20080602061113.282120@gmx.net>
	<200806020910.18527.stefandoesinger@gmx.at>
Message-ID: <4843C401.4060709@gmail.com>

Stefan D?singer wrote:
> Am Montag, 2. Juni 2008 08:11:13 schrieb Roderick Colenbrander:
>   
>>> The bugs I'm talking about:
>>> Bug 10580
>>>       
> Sorry that I did not have time yet to look into that, but instead of ranting 
> you could also look at the GLSL docs and make a patch. 
I did see a precision patch by Vitaliy fixing this problem, which was 
not applied, presumably since there is a better way to fix this.
> Renaming the local 
> constants from LC to LVC for vertex and LPC for pixel shaders, and then 
> loading the uniforms after program linking should fix the issue for GLSL. In 
> ARB, just read them from program local environment and load the constants 
> after compiling the shader.
>   
The patch being reverted seems interesting - it basically undoes a prior 
effort to get local constants into the same namespace as global ones due 
to relative addressing. I assume this is done for performance reasons, 
is this correct ?  I see your patch is special-case disabled in the case 
of relative addressing. Do we really want to support multiple constant 
loading code paths for performance savings ?

Ivan





From stefandoesinger at gmx.at  Mon Jun  2 05:04:54 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 2 Jun 2008 12:04:54 +0200
Subject: Time to revert bad commits?
In-Reply-To: <4843C401.4060709@gmail.com>
References: <48436B03.1080402@kievinfo.com>
	<200806020910.18527.stefandoesinger@gmx.at>
	<4843C401.4060709@gmail.com>
Message-ID: <200806021204.54710.stefandoesinger@gmx.at>

Am Montag, 2. Juni 2008 11:57:21 schrieb Ivan Gyurdiev:
> The patch being reverted seems interesting - it basically undoes a prior
> effort to get local constants into the same namespace as global ones due
> to relative addressing. I assume this is done for performance reasons,
> is this correct ?  I see your patch is special-case disabled in the case
> of relative addressing. Do we really want to support multiple constant
> loading code paths for performance savings ?
Yes, it is for performance reasons, and yes, we want the multiple paths. It 
may be a small, non-algorithmic improvement, but those small improvements are 
where you get the performance from in 3D rendering.

The reason for this is not only avoiding reloading the local constants each 
shader change or constant change, but by moving the local constants away from 
the global constant space we don't have to reload unchanged global constants 
due to a local constant change.

On MacOS I achived a 5-15% performance gain with those constant loading 
optimizations, depending on the app, this is quite a lot. On the Linux Nvidia 
driver it was smaller, around 2-3% because the constant loading seems to be 
more efficient there.


From ivg231 at gmail.com  Mon Jun  2 05:11:23 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Mon, 02 Jun 2008 06:11:23 -0400
Subject: Crash in test d3d9:stateblock with warn+heap is a wine bug
In-Reply-To: <1212393624.4746.143.camel@hermes2.karcher.local>
References: <1212393624.4746.143.camel@hermes2.karcher.local>
Message-ID: <4843C74B.4090304@gmail.com>

Michael Karcher wrote:
> Does anyone knows whether the test has this been written buggy on
> purpose (some app does this), or it is by accident?
>
>   
Probably the first one - I wrote the test with rather limited 
understanding of how rendertargets work.
I don't think there was a specific application need driving this test.

The intention was to test how the stateblock behaves under different 
event sequences - for example if the rendertarget is changed.
I see the test is doing its job uncovering interesting behavior :)

Ivan




From ivg231 at gmail.com  Mon Jun  2 05:23:27 2008
From: ivg231 at gmail.com (Ivan Gyurdiev)
Date: Mon, 02 Jun 2008 06:23:27 -0400
Subject: Crash in test d3d9:stateblock with warn+heap is a wine bug
In-Reply-To: <4843C74B.4090304@gmail.com>
References: <1212393624.4746.143.camel@hermes2.karcher.local>
	<4843C74B.4090304@gmail.com>
Message-ID: <4843CA1F.7070504@gmail.com>

Ivan Gyurdiev wrote:
> Michael Karcher wrote:
>> Does anyone knows whether the test has this been written buggy on
>> purpose (some app does this), or it is by accident?
>>
>>   
> Probably the first one - I wrote the test with rather limited 
> understanding of how rendertargets work.
> I don't think there was a specific application need driving this test.
>
> The intention was to test how the stateblock behaves under different 
> event sequences - for example if the rendertarget is changed.
> I see the test is doing its job uncovering interesting behavior :)
>
>
s/ "first one"/"second one"/

I guess the reason why switching the render target was tested in 
particular was some weird code manipulating the stateblock when Wine was 
switching rendertargets, which I was interested in testing. The last 
event sequence should probably be dropped if it's invalid, but I would 
keep the rest, since the test has uncovered a number of bugs in the past.

Ivan



From julliard at winehq.org  Mon Jun  2 05:29:16 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 02 Jun 2008 12:29:16 +0200
Subject: winedbg: Fix 'winedbg --auto' so it does just one backtrace.
In-Reply-To: <alpine.DEB.1.10.0806021224050.29716@amboise.dolphin> (Francois
	Gouget's message of "Mon, 2 Jun 2008 12:25:28 +0200 (CEST)")
References: <alpine.DEB.1.10.0806021224050.29716@amboise.dolphin>
Message-ID: <87skvwb05f.fsf@wine.dyndns.org>

Francois Gouget <fgouget at codeweavers.com> writes:

> 'winedbg --auto' already prints a backtrace before the modules list. So 
> there is no need to print another one after everything else.

Actually there are cases where it doesn't, which is why I added
this. It's better to have two backtraces than none.

-- 
Alexandre Julliard
julliard at winehq.org


From xixsimplicityxix at gmail.com  Mon Jun  2 07:04:03 2008
From: xixsimplicityxix at gmail.com (John Klehm)
Date: Mon, 2 Jun 2008 07:04:03 -0500
Subject: [PATCH] winealsa: Raise ALSA minimum period size to sane value
In-Reply-To: <g1vd3g$392$1@ger.gmane.org>
References: <g1vd3g$392$1@ger.gmane.org>
Message-ID: <78a7dad00806020504y5c725032ofd86242969c096f5@mail.gmail.com>

On Sun, Jun 1, 2008 at 6:58 PM, Zephiris <zephiris at gmail.com> wrote:
> The ALSA period size can be set to rather odd values, and querying the
> minimum period size isn't always guaranteed to be sane. Use a safety net
> value. This fixes bug 13458.
>
> ---
>
>  dlls/winealsa.drv/dsoutput.c |    5 +++++
>  1 files changed, 5 insertions(+), 0 deletions(-)
>

Please use your real name, Wine doesn't accept anonymous patches.

--John


From paul.vriens.wine at gmail.com  Mon Jun  2 07:06:05 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 02 Jun 2008 14:06:05 +0200
Subject: snmpapi: Stop tests from crashing on win98
In-Reply-To: <g20mt2$ft3$1@ger.gmane.org>
References: <g20mt2$ft3$1@ger.gmane.org>
Message-ID: <4843E22D.8050409@gmail.com>

Alistair Leslie-Hughes wrote:
> Hi,
> 
> Changelog:
>     snmpapi: Stop tests from crashing on win98
> 
> Best Regards
>  Alistair Leslie-Hughes
> 
> 
> 
> 
> ------------------------------------------------------------------------
> 
> 
I still don't think they should be removed but that's my opinion.

If not running is preferable shouldn't we just if(0) them and add some comments?

-- 
Cheers,

Paul.


From wine at mkarcher.dialup.fu-berlin.de  Mon Jun  2 07:57:31 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Mon, 02 Jun 2008 14:57:31 +0200
Subject: Crash in test d3d9:stateblock with warn+heap is a wine bug
In-Reply-To: <4843CA1F.7070504@gmail.com>
References: <1212393624.4746.143.camel@hermes2.karcher.local>
	<4843C74B.4090304@gmail.com>  <4843CA1F.7070504@gmail.com>
Message-ID: <1212411451.4746.149.camel@hermes2.karcher.local>

Am Montag, den 02.06.2008, 06:23 -0400 schrieb Ivan Gyurdiev:
> Ivan Gyurdiev wrote:
> > Michael Karcher wrote:
> >> Does anyone knows whether the test has this been written buggy on
> >> purpose (some app does this), or it is by accident?
> >>
> I guess the reason why switching the render target was tested in 
> particular was some weird code manipulating the stateblock when Wine was 
> switching rendertargets, which I was interested in testing. The last 
> event sequence should probably be dropped if it's invalid, but I would 
> keep the rest, since the test has uncovered a number of bugs in the past.

Oh, everything is valid, except for the IUnknown_Release(swapchain) in
switch_render_target. It must not happen before the render target gets
reverted in revert_render_target. That means, a IDirect3DSwapchain9
variable has to be added to the event_data block to keep the pointer
between switch_render_target and revert_render_target.

Today, I am on high workload on my paid job, so don't expect a patch
until 23:00 CEST. Feel free to fix it yourself, if you want.

Regards,
  Michael Karcher



From juan.lang at gmail.com  Mon Jun  2 09:11:14 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Mon, 2 Jun 2008 07:11:14 -0700
Subject: snmpapi: Stop tests from crashing on win98
In-Reply-To: <4843E22D.8050409@gmail.com>
References: <g20mt2$ft3$1@ger.gmane.org> <4843E22D.8050409@gmail.com>
Message-ID: <3a768c550806020711g6fe2b170y3e648bdf8b7c3d2d@mail.gmail.com>

> If not running is preferable shouldn't we just if(0) them and add some comments?

Yes, I believe that's the preferred method of removing crashing tests.
--Juan


From fgouget at free.fr  Mon Jun  2 09:57:40 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 2 Jun 2008 16:57:40 +0200 (CEST)
Subject: Invalid '...' in resources
Message-ID: <alpine.DEB.1.10.0806021652400.21702@amboise.dolphin>


The files below contain ' . . .' instead of '...'. This is invalid 
typographically in at least English, French and Russian. Could someone 
check if it is valid for the relevant languages:

   Danish
   Dutch
   Hungarian
   Korean
   Norwegian
   Turkish


./programs/winefile/No.rc
./programs/oleview/No.rc
./programs/clock/No.rc
./programs/cmd/Da.rc
./programs/cmd/No.rc
./programs/taskmgr/No.rc
./programs/notepad/No.rc
./programs/winhlp32/No.rc
./programs/progman/No.rc
./programs/cmdlgtst/No.rc
./programs/wordpad/Ko.rc
./programs/wordpad/No.rc
./programs/wordpad/Tr.rc
./programs/wordpad/Nl.rc
./programs/wordpad/Hu.rc
./programs/winecfg/No.rc
./programs/regedit/Ko.rc
./programs/regedit/Da.rc
./programs/regedit/No.rc
./programs/regedit/Nl.rc
./dlls/setupapi/No.rc
./dlls/mshtml/No.rc
./dlls/gphoto2.ds/gphoto2_No.rc
./dlls/shell32/shell32_No.rc
./dlls/sane.ds/sane_No.rc
./dlls/msvfw32/msvfw32_No.rc
./dlls/msvfw32/msvfw32_Da.rc
./dlls/oledlg/oledlg_No.rc
./dlls/msacm32/msacm_Da.rc
./dlls/msacm32/msacm_No.rc
./dlls/comdlg32/cdlg_No.rc
./dlls/browseui/rsrc_No.rc
./dlls/shdoclc/Da.rc
./dlls/shdoclc/No.rc
./dlls/user32/resources/user32_No.rc


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                           La terre est une b?ta...

From tijl at ulyssis.org  Mon Jun  2 10:09:25 2008
From: tijl at ulyssis.org (Tijl Coosemans)
Date: Mon, 2 Jun 2008 17:09:25 +0200
Subject: Invalid '...' in resources
In-Reply-To: <alpine.DEB.1.10.0806021652400.21702@amboise.dolphin>
References: <alpine.DEB.1.10.0806021652400.21702@amboise.dolphin>
Message-ID: <200806021709.26143.tijl@ulyssis.org>

On Monday 02 June 2008 16:57:40 Francois Gouget wrote:
> The files below contain ' . . .' instead of '...'. This is invalid 
> typographically in at least English, French and Russian. Could someone 
> check if it is valid for the relevant languages:

>    Dutch

No.


From winehq.org at urbanec.net  Mon Jun  2 10:14:19 2008
From: winehq.org at urbanec.net (Peter Urbanec)
Date: Tue, 03 Jun 2008 01:14:19 +1000
Subject: winex11.drv: Add support for AlphaBlend with non-opaque
	SourceConstantAlpha values.
In-Reply-To: <82b2af8e0806020539p5ee43f9ew6278a0678b1d2c8@mail.gmail.com>
References: <4843D3DD.4030104@urbanec.net>
	<82b2af8e0806020539p5ee43f9ew6278a0678b1d2c8@mail.gmail.com>
Message-ID: <48440E4B.4050509@urbanec.net>

?ngel Guzm?n Maeso wrote:
> A small change:
> 
> +int x,y;
> +for (x = 0; x < widthSrc; x++, tmpBits += 4)
> +    for(y=0;y<4;y++)
> +        tmpBits[y] = tmpBits[y] * blendfn.SourceConstantAlpha / 255;

I'm not fussed one way or the other, but I can see at least two 
advantages in keeping the original code:

1) It's slightly more obvious that the data we are dealing with is four 
bytes of R, G, B and A - although a comment to that effect would be a 
better solution.

2) Compiler optimisers may do a slightly better job on the already 
unrolled loop.

I'll leave it to Alexandre and co. to pick and choose which version 
makes it in.



From paul.vriens.wine at gmail.com  Mon Jun  2 10:19:30 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Mon, 02 Jun 2008 17:19:30 +0200
Subject: Winetest grrr...
In-Reply-To: <200805301840.16097.stefan@codeweavers.com>
References: <3a768c550805300751i5ceb1f5pd5b462d973a122b9@mail.gmail.com>
	<200805301840.16097.stefan@codeweavers.com>
Message-ID: <48440F82.8010008@gmail.com>

Stefan D?singer wrote:
> Am Freitag, 30. Mai 2008 16:51:08 schrieb Juan Lang:
>> I know some video drivers are so broken we don't want to run on them.
>> I have an ATI Radeon Mobility 250.  I thought this was a fairly common
>> card.  Is locking up the machine really acceptable here?
> All we could do is blacklisting certain drivers or card IDs. If the system 
> hard crashes or has a bluescreen it's a driver bug for sure. It is plainly 
> impossible to make sure the tests do not crash anywhere, except by not having 
> any tests at all.
> 
> I have never heard the name "ATI Radeon Mobility 250". It could be an ATI 
> Radeon Mobility 9000, which has a rv250 chip in it. I have the same in my old 
> laptop, the tests run without crashing(Some are failing due to clear driver 
> bugs though, and I there aren't any newer laptop drivers available)
> 
> 
> 
We now have a bug report for the same issue:

http://bugs.winehq.org/show_bug.cgi?id=13608

 From looking at the attached res/report file, it crashes at that same test.
I'm not sure if this is the relevant info about his graphics card:

d3d9:visual start dlls/d3d9/tests/visual.c -
visual.c:181:Driver string: "ati2dvag.dll"
visual.c:182:Description string: "Radeon X1950 Series"
visual.c:183:Device name string: "\\.\DISPLAY1"
visual.c:184:Driver version 6.14.10.6783

It appears that at least 2 users are bitten by this issue. Not something we want 
to happen I guess, but I have no clue how to fix this.

-- 
Cheers,

Paul.


From stefandoesinger at gmx.at  Mon Jun  2 13:42:40 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 2 Jun 2008 20:42:40 +0200
Subject: Crash in test d3d9:stateblock with warn+heap is a wine bug
In-Reply-To: <1212411451.4746.149.camel@hermes2.karcher.local>
References: <1212393624.4746.143.camel@hermes2.karcher.local>
	<4843CA1F.7070504@gmail.com>
	<1212411451.4746.149.camel@hermes2.karcher.local>
Message-ID: <200806022042.40222.stefandoesinger@gmx.at>

With textures, the surface and the texture(the container) share one reference 
count. In the case of swapchains the swapchain is the container, so a 
GetBackBuffer would increment the swapchain's refcount to 2. So the swapchain 
wouldn't be destroyed before the backbuffer was released.

I am not sure if the texture refcounting applies to swapchains as well. Does 
the test test refcounts? If not, it might be worth adding a test. A fix would 
be in dlls/d3d9, not wined3d.


From eric.pouech at orange.fr  Mon Jun  2 14:21:40 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Mon, 02 Jun 2008 21:21:40 +0200
Subject: winedbg: Fix 'winedbg --auto' so it does just one backtrace.
In-Reply-To: <87skvwb05f.fsf@wine.dyndns.org>
References: <alpine.DEB.1.10.0806021224050.29716@amboise.dolphin>
	<87skvwb05f.fsf@wine.dyndns.org>
Message-ID: <48444844.4000000@orange.fr>

Alexandre Julliard a ?crit :
> Francois Gouget <fgouget at codeweavers.com> writes:
>
>   
>> 'winedbg --auto' already prints a backtrace before the modules list. So 
>> there is no need to print another one after everything else.
>>     
>
> Actually there are cases where it doesn't, which is why I added
> this. It's better to have two backtraces than none.
>
>   
can you reproduce those cases ? it may be even better to fix those cases 
instead of having two backtraces <g>
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From austinenglish at gmail.com  Mon Jun  2 14:22:05 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 2 Jun 2008 14:22:05 -0500
Subject: How to handle lack of internet connection in conformance tests
Message-ID: <b6bb06270806021222j389574a2y55d6577423fd1054@mail.gmail.com>

For curiousity's sake, I tested my work XP box today, first as usual,
then after a reboot and disabling the network connection:

http://test.winehq.org/data/b4bf3553c4071a2a6979f1df08ae75aadde94b4b/#group_XP

http://test.winehq.org/data/b4bf3553c4071a2a6979f1df08ae75aadde94b4b/xp_aenglish-xp-sp2/report
http://test.winehq.org/data/b4bf3553c4071a2a6979f1df08ae75aadde94b4b/xp_aenglish-xp-no-net/report

Most of the tests came out the same, with some spurious failures in
MSI/dinput/user32/etc. The interesting ones would be the
urlmon/wininet. Some of these tests timeout (urlmon: protocol/url,
wininet:http) , some failed (msxml3:domdoc), and some still passed(!)
(wininet:ftp, wininet:generated, wininet:internet, wininet:url,
wininet:urlcache, ws2_32:protocol, urlmon:misc).

I haven't tested wine yet, as I can't bring down the network
connection on any of the boxes I can currently test on, but I'll do so
when I next get a chance. Either way, seems some of this behavior
could be made more consistent (if network connection is down, either
skip or timeout, but don't fail). I may try later with leaving the
network connection up but removing the internet connection at the
router...

-Austin


From fatih at pardus.org.tr  Mon Jun  2 14:42:31 2008
From: fatih at pardus.org.tr (Fatih =?utf-8?q?A=C5=9F=C4=B1c=C4=B1?=)
Date: Mon, 2 Jun 2008 22:42:31 +0300
Subject: Invalid '...' in resources
In-Reply-To: <alpine.DEB.1.10.0806021652400.21702@amboise.dolphin>
References: <alpine.DEB.1.10.0806021652400.21702@amboise.dolphin>
Message-ID: <200806022242.32017.fatih@pardus.org.tr>

02 Haz 2008 Pts tarihinde, Francois Gouget ?unlar? yazm??t?: 
> The files below contain ' . . .' instead of '...'. This is invalid=20
> typographically in at least English, French and Russian. Could someone=20
> check if it is valid for the relevant languages:
>
> ? ?Danish
> ? ?Dutch
> ? ?Hungarian
> ? ?Korean
> ? ?Norwegian
> ? ?Turkish

Invalid in Turkish, too.


From stefandoesinger at gmx.at  Mon Jun  2 14:47:48 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 2 Jun 2008 21:47:48 +0200
Subject: [2/2] wined3d: Set the surface location to SFLAG_INSYSMEM for
	depth stencils on Reset
In-Reply-To: <d658b69e0806021212j4ebb4fddkc29e4d84d8e608c9@mail.gmail.com>
References: <d658b69e0806021212j4ebb4fddkc29e4d84d8e608c9@mail.gmail.com>
Message-ID: <200806022147.48266.stefandoesinger@gmx.at>

Am Montag, 2. Juni 2008 21:12:54 schrieb H. Verbeet:
> This fixes a rather major regression when using FBOs for offscreen
> rendering. Since we destroy the GL texture associated with the
> surface, and INDRAWABLE and INTEXTURE are the same for offscreen
> targets when using FBO ORM, the texture would never get recreated for
> the depth stencil. Depth stencils are special in this regard since
> they can switch between being onscreen and offscreen, for the other
> implicit surfaces this isn't an issue. This should also fix bug 12794.
> (This bug does expose issues with the surface management code, but I
> don't think those are fixable before 1.0)
updateSurfaceDesc releases the allocated system memory, so setting INSYSMEM is 
dangerous as well since allocatedMemory = NULL. depth stencils are't 
lockable, so we may get away with that, but it is still dangerous I think


From hverbeet at gmail.com  Mon Jun  2 15:12:46 2008
From: hverbeet at gmail.com (H. Verbeet)
Date: Mon, 2 Jun 2008 22:12:46 +0200
Subject: [2/2] wined3d: Set the surface location to SFLAG_INSYSMEM for
	depth stencils on Reset
In-Reply-To: <200806022147.48266.stefandoesinger@gmx.at>
References: <d658b69e0806021212j4ebb4fddkc29e4d84d8e608c9@mail.gmail.com>
	<200806022147.48266.stefandoesinger@gmx.at>
Message-ID: <d658b69e0806021312j4432a71fs6c4c1bad23ef74f@mail.gmail.com>

2008/6/2 Stefan D?singer <stefandoesinger at gmx.at>:
> Am Montag, 2. Juni 2008 21:12:54 schrieb H. Verbeet:
>> This fixes a rather major regression when using FBOs for offscreen
>> rendering. Since we destroy the GL texture associated with the
>> surface, and INDRAWABLE and INTEXTURE are the same for offscreen
>> targets when using FBO ORM, the texture would never get recreated for
>> the depth stencil. Depth stencils are special in this regard since
>> they can switch between being onscreen and offscreen, for the other
>> implicit surfaces this isn't an issue. This should also fix bug 12794.
>> (This bug does expose issues with the surface management code, but I
>> don't think those are fixable before 1.0)
> updateSurfaceDesc releases the allocated system memory, so setting INSYSMEM is
> dangerous as well since allocatedMemory = NULL. depth stencils are't
> lockable, so we may get away with that, but it is still dangerous I think
>
True, but unfortunately I think this is the best we can do without
making more extensive changes to the surface management code.


From stefandoesinger at gmx.at  Mon Jun  2 14:49:07 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Mon, 2 Jun 2008 21:49:07 +0200
Subject: [2/2] Wineshader: Hardcode local constants with glUniform4fvARB
In-Reply-To: <200806022145.07358.stefandoesinger@gmx.at>
References: <200806022145.07358.stefandoesinger@gmx.at>
Message-ID: <200806022149.07425.stefandoesinger@gmx.at>

Am Montag, 2. Juni 2008 21:45:07 schrieb Stefan D?singer:
Erm, the proper library is wined3d, not wineshader. "wineshader" is my current 
in-development HLSL compiler lib...


From julliard at winehq.org  Mon Jun  2 16:33:38 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 02 Jun 2008 23:33:38 +0200
Subject: winedbg: Fix 'winedbg --auto' so it does just one backtrace.
In-Reply-To: <48444844.4000000@orange.fr> (Eric Pouech's message of "Mon, 02
	Jun 2008 21:21:40 +0200")
References: <alpine.DEB.1.10.0806021224050.29716@amboise.dolphin>
	<87skvwb05f.fsf@wine.dyndns.org> <48444844.4000000@orange.fr>
Message-ID: <87d4mzbjyl.fsf@wine.dyndns.org>

Eric Pouech <eric.pouech at orange.fr> writes:

> Alexandre Julliard a ?crit :
>> Actually there are cases where it doesn't, which is why I added
>> this. It's better to have two backtraces than none.
>>
>>   
> can you reproduce those cases ? it may be even better to fix those
> cases instead of having two backtraces <g>

Yes, that would be better, but I'm afraid I don't remember where I ran
into that. I'll let you know if I see it again.

-- 
Alexandre Julliard
julliard at winehq.org


From shakaran at gmail.com  Mon Jun  2 17:34:59 2008
From: shakaran at gmail.com (=?ISO-8859-1?Q?=C1ngel_Guzm=E1n_Maeso?=)
Date: Tue, 3 Jun 2008 00:34:59 +0200
Subject: [website] Fix typo in Spanish translation of home.template
Message-ID: <82b2af8e0806021534h74ec44ccu31a1ed79b018376@mail.gmail.com>

Fix several typos
-- 
Shakaran
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080603/21e4e161/attachment.htm 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: home_fix_typo.diff
Type: text/x-diff
Size: 1780 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080603/21e4e161/attachment.diff 

From vitaliy at kievinfo.com  Mon Jun  2 07:57:32 2008
From: vitaliy at kievinfo.com (Vitaliy)
Date: Mon, 02 Jun 2008 06:57:32 -0600
Subject: user32: Fix input tests failing on WinXP+ (resend)
Message-ID: <4843EE3C.80201@kievinfo.com>

Vitaliy Margolen wrote:
> ---
>  dlls/user32/tests/input.c |   29 +++++++++++++++++------------
>  1 files changed, 17 insertions(+), 12 deletions(-)
> 



From karcher at physik.fu-berlin.de  Mon Jun  2 16:43:12 2008
From: karcher at physik.fu-berlin.de (Michael Karcher)
Date: Mon, 02 Jun 2008 23:43:12 +0200
Subject: Keep swapchain while its backbuffer is in use.
In-Reply-To: <1212439876.4746.163.camel@hermes2.karcher.local>
References: <1212439876.4746.163.camel@hermes2.karcher.local>
Message-ID: <1212442992.4746.176.camel@hermes2.karcher.local>

Am Montag, den 02.06.2008, 22:51 +0200 schrieb Michael Karcher:
> This fixes the warn+heap errors/crashes of d3d9:stateblock, and should
> close the bug about differences with warn+heap enabled.
Thats #12246, one of the 1.0 targeted bugs. I was offline while writing
the patch email, so I could not look up the number.

Regards,
  Michael Karcher
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Dies ist ein digital signierter Nachrichtenteil
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080602/5fcd99ef/attachment.pgp 

From juan.lang at gmail.com  Mon Jun  2 22:01:50 2008
From: juan.lang at gmail.com (Juan Lang)
Date: Mon, 2 Jun 2008 20:01:50 -0700
Subject: Failing tests: now what?
Message-ID: <3a768c550806022001t5c16949bs23e0bc1f0e613ea3@mail.gmail.com>

Following through with Francois's suggestion, I extracted the user32
tests.  They still fail for me:  81 failures in menu.c, all having to
do with the expected width of menu items [1], which is precisely what
I wanted to address.

So I'm stymied how I'm going to convince Alexandre that my little menu
patch [2] is correct.  Vim is clearly broken without the patch, and
looks correct with it.  The user32 tests pass for me (in Wine) with
and without the patch.  None of the apps I've tried appear changed by
the patch, though there's always the possibility.  I can't verify it's
correct in the usual way, by writing a test, because the existing
tests fail for me in Windows.  (Alexandre's never said he wants a
test, but then again he hasn't said anything yet, either.)

If anyone has any suggestions how I can get this accepted, I'm all
ears.  Thanks,
--Juan

[1] Typical failure:
menu.c:432: Test failed: menu width wrong, got 109 expected 102
[2] http://www.winehq.org/pipermail/wine-patches/2008-May/055101.html


From der.fabe at gmx.net  Tue Jun  3 03:02:26 2008
From: der.fabe at gmx.net (Fabian Bieler)
Date: Tue, 3 Jun 2008 10:02:26 +0200
Subject: Time to revert bad commits?
In-Reply-To: <200806021204.54710.stefandoesinger@gmx.at>
References: <48436B03.1080402@kievinfo.com> <4843C401.4060709@gmail.com>
	<200806021204.54710.stefandoesinger@gmx.at>
Message-ID: <200806031002.26462.der.fabe@gmx.net>

On Monday 02 June 2008 12:04:54 Stefan D?singer wrote:
> Am Montag, 2. Juni 2008 11:57:21 schrieb Ivan Gyurdiev:
> > The patch being reverted seems interesting - it basically undoes a prior
> > effort to get local constants into the same namespace as global ones due
> > to relative addressing. I assume this is done for performance reasons,
> > is this correct ?  I see your patch is special-case disabled in the case
> > of relative addressing. Do we really want to support multiple constant
> > loading code paths for performance savings ?
>
> Yes, it is for performance reasons, and yes, we want the multiple paths. It
> may be a small, non-algorithmic improvement, but those small improvements
> are where you get the performance from in 3D rendering.
>
> The reason for this is not only avoiding reloading the local constants each
> shader change or constant change, but by moving the local constants away
> from the global constant space we don't have to reload unchanged global
> constants due to a local constant change.
>
> On MacOS I achived a 5-15% performance gain with those constant loading
> optimizations, depending on the app, this is quite a lot. On the Linux
> Nvidia driver it was smaller, around 2-3% because the constant loading
> seems to be more efficient there.
The shader compiler can also do better optimization with hard-coded constants 
(particularly if the constants are 0 or 1). I've seen the nvidia-compiler 
remove entire code paths because of this in a hl2-shader.


From stefandoesinger at gmx.at  Tue Jun  3 03:42:39 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 3 Jun 2008 10:42:39 +0200
Subject: Time to revert bad commits?
In-Reply-To: <200806031002.26462.der.fabe@gmx.net>
References: <48436B03.1080402@kievinfo.com>
	<200806021204.54710.stefandoesinger@gmx.at>
	<200806031002.26462.der.fabe@gmx.net>
Message-ID: <200806031042.39419.stefandoesinger@gmx.at>

Am Dienstag, 3. Juni 2008 10:02:26 schrieb Fabian Bieler:
> The shader compiler can also do better optimization with hard-coded
> constants (particularly if the constants are 0 or 1). I've seen the
> nvidia-compiler remove entire code paths because of this in a hl2-shader.
Really? Do you have any evidence for this? In that case we might want to use 
Vitaliys original patch which just changed the precision of the printed 
float, since the patches I just sent break this ability. Henri and I 
considered them as theoretical, since the HLSL compiler or shader author 
would have removed those codepaths already



From stefandoesinger at gmx.at  Tue Jun  3 04:01:10 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 3 Jun 2008 11:01:10 +0200
Subject: ddraw: Don't release ddraw if a surface is still using it.
In-Reply-To: <63602.89.239.230.29.1212330128.squirrel@mail.albretsen.dk>
References: <63602.89.239.230.29.1212330128.squirrel@mail.albretsen.dk>
Message-ID: <200806031101.10501.stefandoesinger@gmx.at>

Am Sonntag, 1. Juni 2008 16:22:08 schrieb Jens Albretsen:
> You're right, if we expect every program to behave.
> I guess we need a hook for wined3d (if we not already have it) to restore
> the state back at process termination, if there is stuff not freed,
> changed video modes and such.
Nope, that doesn't work. I have a hack to do that in CrossOver, but it 
confuses Eve Online, since Eve gets some display mode change messages at 
shutdown, and crashes right before it would exit normally. It's not much of 
an issue, but in rare cases the debugger gets stuck and the process becomes 
zombie-ish.

I think on Windows this is done by some external app/module, maybe 
explorer.exe.


From julliard at winehq.org  Tue Jun  3 04:49:06 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 03 Jun 2008 11:49:06 +0200
Subject: Revert "wined3d: Preload target in ActivateContext() for
	ORM_BACKBUFFER/ORM_PBUFFER."
In-Reply-To: <200806020913.13429.stefandoesinger@gmx.at> ("Stefan
	=?utf-8?Q?D=C3=B6singer=22's?=
	message of "Mon, 2 Jun 2008 09:13:13 +0200")
References: <48437C07.2010101@kievinfo.com>
	<200806020913.13429.stefandoesinger@gmx.at>
Message-ID: <87ve0qalwt.fsf@wine.dyndns.org>

Stefan D?singer <stefandoesinger at gmx.at> writes:

> Am Montag, 2. Juni 2008 06:50:15 schrieb Vitaliy Margolen:
>> This reverts commit 2d0016c5bc872afb562727278cfd341cea182600.
>> Partially fixes bug 11584.
> I think we can revert that patch(ie, apply this patch). I haven't had time to 
> look over the code yet, but I can't think of any problems this would cause. 

It does cause problems:

../../../tools/runtest -q -P wine -M d3d8.dll -T ../../.. -p d3d8_test.exe.so visual.c && touch visual.ok
visual.c:709: Test failed: Offscreen failed: Got color 0x00000000, expected 0x00ffffff.
visual.c:712: Test failed: Offscreen failed: Got color 0x00000000, expected 0x00ff00ff.
visual.c:890: Test failed: SRCALPHA on texture returned color 00000000, expected bar
visual.c:897: Test failed: DSTALPHA on texture returned color 00000000, expected foo
make[2]: *** [visual.ok] Error 4

-- 
Alexandre Julliard
julliard at winehq.org


From der.fabe at gmx.net  Tue Jun  3 06:01:11 2008
From: der.fabe at gmx.net (Fabian Bieler)
Date: Tue, 3 Jun 2008 13:01:11 +0200
Subject: Time to revert bad commits?
In-Reply-To: <200806031042.39419.stefandoesinger@gmx.at>
References: <48436B03.1080402@kievinfo.com>
	<200806031002.26462.der.fabe@gmx.net>
	<200806031042.39419.stefandoesinger@gmx.at>
Message-ID: <200806031301.12337.der.fabe@gmx.net>

On Tuesday 03 June 2008 10:42:39 you wrote:
> Am Dienstag, 3. Juni 2008 10:02:26 schrieb Fabian Bieler:
> > The shader compiler can also do better optimization with hard-coded
> > constants (particularly if the constants are 0 or 1). I've seen the
> > nvidia-compiler remove entire code paths because of this in a hl2-shader.
>
> Really? Do you have any evidence for this? In that case we might want to
> use Vitaliys original patch which just changed the precision of the printed
> float, since the patches I just sent break this ability. Henri and I
> considered them as theoretical, since the HLSL compiler or shader author
> would have removed those codepaths already
I did some testing using the Half-Life 2 intro and outro (dxlevel 81). 
Attached is a spreadsheet with the instruction and register counts of the 
compiled shaders (aquired via __GL_WriteProgramObjectAssembly). The 
difference is not as big as I expected (I stumbled over one of the more 
significant cases (fasm_164_0.txt of the outro: 13 vs. 9 instructions) some 
time ago and made a wrong extrapolation ;-)).
-------------- next part --------------
A non-text attachment was scrubbed...
Name: half-life shader.ods
Type: application/vnd.oasis.opendocument.spreadsheet
Size: 18541 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080603/fa2d1630/attachment-0001.ods 

From stefandoesinger at gmx.at  Tue Jun  3 07:48:24 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 3 Jun 2008 14:48:24 +0200
Subject: Time to revert bad commits?
In-Reply-To: <200806031301.12337.der.fabe@gmx.net>
References: <48436B03.1080402@kievinfo.com>
	<200806031042.39419.stefandoesinger@gmx.at>
	<200806031301.12337.der.fabe@gmx.net>
Message-ID: <200806031448.24750.stefandoesinger@gmx.at>

Am Dienstag, 3. Juni 2008 13:01:11 schrieb Fabian Bieler:
> I did some testing using the Half-Life 2 intro and outro (dxlevel 81).
> Attached is a spreadsheet with the instruction and register counts of the
> compiled shaders (aquired via __GL_WriteProgramObjectAssembly). The
> difference is not as big as I expected (I stumbled over one of the more
> significant cases (fasm_164_0.txt of the outro: 13 vs. 9 instructions) some
> time ago and made a wrong extrapolation ;-)).
I guess it is worth investigating this further, but after Wine 1.0. It would 
be fairly easy to load the stringable floats into the program string and keep 
the ones where this would cause precision loss loaded via glUniform4f. All we 
have to do is to set a flag per local constant and test this flag in two 
places


From meissner at suse.de  Tue Jun  3 08:56:06 2008
From: meissner at suse.de (Marcus Meissner)
Date: Tue, 3 Jun 2008 15:56:06 +0200
Subject: Trip & Conference Report Linux Tag 2008
Message-ID: <20080603135606.GB21221@suse.de>

Hi,

I was at LinuxTag 2008, which is the largest Linux User fair in Germany.

The fair was from Wednesday to Saturday, however I was only there
Saturday. Saturday was openSUSE day and we (openSUSE) had a conference
track over the whole day. 

One of those talks in this track was my talk on "Wine - applications
and games on Linux". My talk was well received, the lecture hall was
about 80% full with around 180-200 people.

My german slides are at:
	http://files.opensuse.org/opensuse/en/0/08/Lt2008-wine.pdf
	http://files.opensuse.org/opensuse/en/6/66/Lt2008-wine.odp
2 smaller german online journals commented on it, mostly regarding
the 1.0 release part:
	http://www.golem.de/0806/60100.html
	http://www.oszine.de/node/9141
(There might even be a Video recording later on.)

I received totally unexpected applause on announcing that after 15 years
we finally come to 1.0 release (after over 200 alphas, and 60 betas).
After the talk I had 10 people around me asking questions, and one
specific problem with Adobe InDesign FileOpen Dialog on a laptop
brought to the openSUSE booth.



Interesting Wine related points:

- Kai Tietz of mingw64 told me that they have a GCC patch ready for
  gcc 4.4 which will support the Win64 calling convention attribute
  just like __attribute__(stdcall).

  Was committed to GCC TRUNK:
	  http://gcc.gnu.org/viewcvs?view=rev&sortby=date&revision=136311
  __attribute__(ms_abi)

  If we have more GCC requirements for Win64, he is willing to help.

  In general he would like to have Wine as a testbed for mingw64
  development (and we could use it as testbed the other way round).

  http://mingw-w64.sf.net/


- Avira (Antivirus vendor)

  They use Wine in house to at least get some info on Windows DLLs,
  using version.dll.GetFileVersionInformation. 

  While this works for Win32 DLLs, it stopped working/currently does not work
  for Win64 DLLs.


- scan.coverity.com

  Talked to Coverity folks, and also to David Maxell.
  The application will receive an update from Coverity 2.9 to 3.2 in
  the next days/weeks. Not sure if it brings new features.

  Also process issue: We have a large backlog of UNINSPECTED features.
  They suggested that in those cases we could just say "lets not look
  at this old cruft" and mark them somehow "PENDING" or similar. Not
  sure it helps us, but at least we could use "PENDING" for partially
  inspected issues.


- Booth or no Booth

  (We had no booth this year.)

  Since the question will likelay appear again, I thought about whether to
  have a Wine booth itself next year... Well, if we dont have at least 2
  people there over the whole 4 days it does not make sense and finding
  those 2+ people likely is difficult.

  I might be able to spare the time, but this year it was not possible due
  to overlapping schedule. Perhaps its also easier to have a demo-point on
  another larger booth (could ask openSUSE if they would have Wine there).

  At least the Saturday visitors got their knowledge on Wine increased
  by my talk at least.


I got the feeling that people are still quite unsure what works and what
not and expect clear and definitive statements from us.
I pointed to the AppDB several times in those cases and tried not to make
overly positive statements.

People are expectant on 1.0 and I think they are willing to be suprised.

Ciao, Marcus


From truiken at gmail.com  Tue Jun  3 10:55:33 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 3 Jun 2008 10:55:33 -0500
Subject: [programs/winetest] Put up a warning message before running
In-Reply-To: <484546D5.6020705@gmail.com>
References: <484546D5.6020705@gmail.com>
Message-ID: <22821af30806030855t2540dbc2q58748b1e79dd4f6b@mail.gmail.com>

On Tue, Jun 3, 2008 at 8:27 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> Hi,
>
> Due to the fact that we have several ordinary users trying out winetest I
> think
> it makes sense to put up this message.
>
> The message will not be shown in quiet mode and not in expert mode (new one
> '-x').
>
> Changelog
>  Put up a warning message before running
>

No this is a bad idea, mostly because winetest is not particularly
intended to be run by 'ordinary users', and anyone that does run
winetest should be well aware of the supposed 'dangers' of running it.
 On top of this, running winetest should not be dangerous in the first
place, and more effort should be put into fixing tests that crash the
tests or the system.

-- 
James Hawkins


From paul.vriens.wine at gmail.com  Tue Jun  3 10:59:53 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 03 Jun 2008 17:59:53 +0200
Subject: [programs/winetest] Put up a warning message before running
In-Reply-To: <22821af30806030855t2540dbc2q58748b1e79dd4f6b@mail.gmail.com>
References: <484546D5.6020705@gmail.com>
	<22821af30806030855t2540dbc2q58748b1e79dd4f6b@mail.gmail.com>
Message-ID: <48456A79.5080202@gmail.com>

James Hawkins wrote:
> On Tue, Jun 3, 2008 at 8:27 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
>> Hi,
>>
>> Due to the fact that we have several ordinary users trying out winetest I
>> think
>> it makes sense to put up this message.
>>
>> The message will not be shown in quiet mode and not in expert mode (new one
>> '-x').
>>
>> Changelog
>>  Put up a warning message before running
>>
> 
> No this is a bad idea, mostly because winetest is not particularly
> intended to be run by 'ordinary users', and anyone that does run
> winetest should be well aware of the supposed 'dangers' of running it.
>  On top of this, running winetest should not be dangerous in the first
> place, and more effort should be put into fixing tests that crash the
> tests or the system.
> 

The problem is that the 'go and run winetest to help the Wine guys' message is 
broadcasted all over the place. Most of those people don't have a clue about the 
impact.

I totally agree that we should make winetest as robust as possible. But please 
have a look at http://bugs.winehq.org/show_bug.cgi?id=13608 and tell me if you 
agree this bug is closed.

-- 
Cheers,

Paul.


From truiken at gmail.com  Tue Jun  3 11:20:22 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 3 Jun 2008 11:20:22 -0500
Subject: [programs/winetest] Put up a warning message before running
In-Reply-To: <48456A79.5080202@gmail.com>
References: <484546D5.6020705@gmail.com>
	<22821af30806030855t2540dbc2q58748b1e79dd4f6b@mail.gmail.com>
	<48456A79.5080202@gmail.com>
Message-ID: <22821af30806030920m74edbdcga563986c151e3bb9@mail.gmail.com>

On Tue, Jun 3, 2008 at 10:59 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> James Hawkins wrote:
>>
>> On Tue, Jun 3, 2008 at 8:27 AM, Paul Vriens <paul.vriens.wine at gmail.com>
>> wrote:
>>>
>>> Hi,
>>>
>>> Due to the fact that we have several ordinary users trying out winetest I
>>> think
>>> it makes sense to put up this message.
>>>
>>> The message will not be shown in quiet mode and not in expert mode (new
>>> one
>>> '-x').
>>>
>>> Changelog
>>>  Put up a warning message before running
>>>
>>
>> No this is a bad idea, mostly because winetest is not particularly
>> intended to be run by 'ordinary users', and anyone that does run
>> winetest should be well aware of the supposed 'dangers' of running it.
>>  On top of this, running winetest should not be dangerous in the first
>> place, and more effort should be put into fixing tests that crash the
>> tests or the system.
>>
>
> The problem is that the 'go and run winetest to help the Wine guys' message
> is broadcasted all over the place. Most of those people don't have a clue
> about the impact.
>
> I totally agree that we should make winetest as robust as possible. But
> please have a look at http://bugs.winehq.org/show_bug.cgi?id=13608 and tell
> me if you agree this bug is closed.
>

It's hard to say.  If it's a real machine run, and not run inside a
vm, then it should probably be reopened.  To me that means one of the
tests is too strict, doing something no games do, but then again I'm
really not familiar with that aspect of the project.

-- 
James Hawkins


From stefandoesinger at gmx.at  Tue Jun  3 13:44:05 2008
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Tue, 3 Jun 2008 20:44:05 +0200
Subject: Trip & Conference Report Linux Tag 2008
In-Reply-To: <20080603135606.GB21221@suse.de>
References: <20080603135606.GB21221@suse.de>
Message-ID: <200806032044.05942.stefandoesinger@gmx.at>

Hi,
A few corrections(I know it's too late, so just for the sake of it):

*) DirectDraw is Software emulated, and via OpenGL. Although the OpenGL 
implementation still has some way to go and will never be able to handle all 
corner cases

*) GameGuard does not work. It's one of the things that will probably never 
work


From dank at kegel.com  Tue Jun  3 15:07:23 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 3 Jun 2008 13:07:23 -0700
Subject: userenv: tests/userenv.c: fix buffer overrun
Message-ID: <a71bd89a0806031307u631de7f5hc5c93b752856e40f@mail.gmail.com>

Found via valgrind.  Fixes

 Use of uninitialised value of size 4
    at wine_cp_mbstowcs (mbtowc.c:79)
    by MultiByteToWideChar (locale.c:1846)
    by CompareStringA (locale.c:2722)
    by get_env (userenv.c:140)
    by func_userenv (userenv.c:218)
  Uninitialised value was created by a stack allocation
    at get_env (userenv.c:128)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: userenvtest.patch
Type: text/x-patch
Size: 643 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080603/a7de4763/attachment.bin 

From winehacker at gmail.com  Tue Jun  3 15:53:25 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 3 Jun 2008 16:53:25 -0400
Subject: msi:MsiSourceListEnumMediaDisksW: free original string,
	not substring
In-Reply-To: <a71bd89a0806030629m2583abcbg7ef957f42e27722c@mail.gmail.com>
References: <a71bd89a0806030629m2583abcbg7ef957f42e27722c@mail.gmail.com>
Message-ID: <19e31a080806031353p55503af1ne36ddb29812fb932@mail.gmail.com>

On Tue, Jun 3, 2008 at 9:29 AM, Dan Kegel <dank at kegel.com> wrote:
> Found via valgrind:
>
>  Invalid free() / delete / delete[]
>    by msi_free (msipriv.h:965)
>    by MsiSourceListEnumMediaDisksW (source.c:324)
>  Address 0x7f01b2ac is 12 bytes inside a block of size 54 alloc'd
>    by msi_alloc (msipriv.h:945)
>    by MsiSourceListEnumMediaDisksW (source.c:273)
>
> 'data' is freed later, so don't touch it.

I think I know of one application that might be affected by this. With
the Project 2003 installer it reports an error I believe in this
function.


-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Tue Jun  3 17:13:36 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 3 Jun 2008 15:13:36 -0700
Subject: Valgrind note
Message-ID: <a71bd89a0806031513w70869858g96a365dcd11dc3d3@mail.gmail.com>

For those of you using valgrind with --track-origins, make sure
you're using a tree with vex rev >= 1854; Julian Seward
says there was a problem that could cause segfaults.
If in doubt, grab a fresh valgrind tree from svn.


From dmitry at codeweavers.com  Tue Jun  3 20:08:36 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 4 Jun 2008 10:08:36 +0900
Subject: [programs/winetest] Put up a warning message before running
References: <484546D5.6020705@gmail.com><22821af30806030855t2540dbc2q58748b1e79dd4f6b@mail.gmail.com>
	<48456A79.5080202@gmail.com>
Message-ID: <F2AFBF66C71049D2BD65C60C3D3C2402@DMITRY>

"Paul Vriens" <paul.vriens.wine at gmail.com> wrote:

> I totally agree that we should make winetest as robust as possible. But please 
> have a look at http://bugs.winehq.org/show_bug.cgi?id=13608 and tell me if you 
> agree this bug is closed.

We tell to Linux users with kernel bugs to go and file a bug report
with their distro, and all the bugs of that kind are closed as invalid.
I don't see why we should behave differently in the case of Windows
kernel bugs. Obviously, debugging Linux or Windows kernel bugs is out
of scope of the Wine project.

-- 
Dmitry.


From dmitry at codeweavers.com  Tue Jun  3 20:52:43 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 4 Jun 2008 10:52:43 +0900
Subject: urlmon: Fix a test that fails on all platforms
References: <22821af30806031153la4bc750rb296c836045e0d5c@mail.gmail.com>
Message-ID: <E2149FD1D9D44E38AF4CE1AEA2F1B288@DMITRY>

"James Hawkins" <jhawkins at codeweavers.com> wrote:

> -        ok(IBindCtx_Release(bctx) == 0, "bctx should be destroyed here\n");
> +
> +        if(bindf & BINDF_ASYNCHRONOUS) {
> +            ok(IBindCtx_Release(bctx) == 1, "bctx should not be destroyed here\n");
> +            IBindCtx_Release(bctx); /* actually destroy it */
> +        }
> +        else
> +            ok(IBindCtx_Release(bctx) == 0, "bctx should be destroyed here\n");

Wouldn't it be better to change it this way:

if(bindf & BINDF_ASYNCHRONOUS)
    ok(IBindCtx_Release(bctx) == 1, "bctx should not be destroyed here\n");

ok(IBindCtx_Release(bctx) == 0, "bctx should be destroyed here\n");

-- 
Dmitry.


From dmitry at codeweavers.com  Tue Jun  3 20:57:19 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 4 Jun 2008 10:57:19 +0900
Subject: kernel32: avoid thread-unsafe function gmtime()
References: <a71bd89a0806031657w38cbe899gded1222e5c1694ae@mail.gmail.com>
Message-ID: <F835DFC2FBD54976A8EE3E2B7F91462C@DMITRY>

"Dan Kegel" <dank at kegel.com> wrote:

> Using gmtime() in a multithreaded program could
> result in invalid results.  So use the safer alternative
> gmtime_r() if it's available.

Most likely gmtime_r() should be used without #ifdefs and a replacement
put in libs/port.

-- 
Dmitry.


From truiken at gmail.com  Tue Jun  3 21:01:59 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 3 Jun 2008 21:01:59 -0500
Subject: advpack: fix a test failure on 9x
In-Reply-To: <b6bb06270806031717v7646ada5jf5975cd845f56565@mail.gmail.com>
References: <b6bb06270806031717v7646ada5jf5975cd845f56565@mail.gmail.com>
Message-ID: <22821af30806031901i5a83992axf9ee318ede51d27d@mail.gmail.com>

On Tue, Jun 3, 2008 at 7:17 PM, Austin English <austinenglish at gmail.com> wrote:
>

This isn't the right fix.  The RegisterOCX command doesn't work in
win9x, so it needs to be changed to another command.

-- 
James Hawkins


From truiken at gmail.com  Tue Jun  3 23:24:23 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 3 Jun 2008 23:24:23 -0500
Subject: urlmon: Fix a test that fails on all platforms
In-Reply-To: <E2149FD1D9D44E38AF4CE1AEA2F1B288@DMITRY>
References: <22821af30806031153la4bc750rb296c836045e0d5c@mail.gmail.com>
	<E2149FD1D9D44E38AF4CE1AEA2F1B288@DMITRY>
Message-ID: <22821af30806032124t455a6afatfcab22b7f59b5998@mail.gmail.com>

On Tue, Jun 3, 2008 at 8:52 PM, Dmitry Timoshkov <dmitry at codeweavers.com> wrote:
> "James Hawkins" <jhawkins at codeweavers.com> wrote:
>
>> -        ok(IBindCtx_Release(bctx) == 0, "bctx should be destroyed
>> here\n");
>> +
>> +        if(bindf & BINDF_ASYNCHRONOUS) {
>> +            ok(IBindCtx_Release(bctx) == 1, "bctx should not be destroyed
>> here\n");
>> +            IBindCtx_Release(bctx); /* actually destroy it */
>> +        }
>> +        else
>> +            ok(IBindCtx_Release(bctx) == 0, "bctx should be destroyed
>> here\n");
>
> Wouldn't it be better to change it this way:
>
> if(bindf & BINDF_ASYNCHRONOUS)
>   ok(IBindCtx_Release(bctx) == 1, "bctx should not be destroyed here\n");
>
> ok(IBindCtx_Release(bctx) == 0, "bctx should be destroyed here\n");
>

Yea that's simpler.  Unfortunately it crashes either way in wine.

-- 
James Hawkins


From alex at thehandofagony.com  Wed Jun  4 03:15:19 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Wed, 4 Jun 2008 10:15:19 +0200
Subject: [AppDB] Allow admins to remove their admin rights
In-Reply-To: <f3f1b91a0806031624j738cf125r5d4f8e2885d8e1da@mail.gmail.com>
References: <200806031234.52772.alex@thehandofagony.com>
	<f3f1b91a0806031624j738cf125r5d4f8e2885d8e1da@mail.gmail.com>
Message-ID: <200806041015.20190.alex@thehandofagony.com>

P? Onsdag 04 juni 2008 , 01:24:07 skrev Chris Morgan:
> What new policy on dissidents? ;-)
>
> How does this patch enable admins to remove themselves? I'm afraid I
> can't see how this change lets an admin remove their own admin status.
>
> Chris
>
>

Yea, that particular piece of code isn't very clear on what it's doing.  I 
found out that $aClean['iUserId'] would only be set when modifying another 
user, and it previously compared it to $oUser->iUserId before allowing the 
admin removal.  Now we only check for admin rights, and the oUser->iUserId == 
aClean['iUserId'] check is performed later to see if we should redirect back 
to the user admin page.



>
> On Tue, Jun 3, 2008 at 6:34 AM, Alexander Nicolaysen S?rnes
>
> <alex at thehandofagony.com> wrote:
> > This is in accordance with the AppDB's new policy on dissidents. :)
> >
> >
> > Alexander N. S?rnes




From frick at sc-networks.de  Wed Jun  4 07:41:35 2008
From: frick at sc-networks.de (Christoph Frick)
Date: Wed, 4 Jun 2008 14:41:35 +0200
Subject: mmio: Do not zero current file position whenever mmioSetBuffer
	is called
In-Reply-To: <4846047C.8030907@u.washington.edu>
References: <4846047C.8030907@u.washington.edu>
Message-ID: <20080604124135.GQ8687@byleth.sc-networks.de>

On Tue, Jun 03, 2008 at 07:57:00PM -0700, Matthew D'Asaro wrote:

> Instead I set wm->info.lBufOffset to wm->info.lDiskOffset because the
> buffer is flushed at the beginning of a call to mmioSetBuffer so
> wm->info.lDiskOffset is synchronized with wm->info.lBufOffset and so
> wm->info.lDiskOffset contains the correct current file position. The
> test for mmio still passes with this patch.

wouldn't that indicate, that the current patch does not cover that case?
can you add a test for it?

-- 
cu
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 163 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080604/2a46c197/attachment.pgp 

From m.b.lankhorst at gmail.com  Wed Jun  4 09:07:54 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 4 Jun 2008 16:07:54 +0200
Subject: Time to revert bad commits?
In-Reply-To: <48436B03.1080402@kievinfo.com>
References: <48436B03.1080402@kievinfo.com>
Message-ID: <b130c85e0806040707h68a485f3q5f7535e023aa49f9@mail.gmail.com>

Hello Vitaliy,

2008/6/2 Vitaliy Margolen <wine-devel at kievinfo.com>:
> I'm afraid we are out of time to fix bugs that introduces major d3d
> regressions. I've yet to see a single patch that addressed those issues.
>
> It's time to start reverting bad commits and testing the results.
>
> The bugs I'm talking about:
> Bug 10580
> Bug 11584
> Bug 12794
> Bug 13101
In general, you can't revert patches as that may have other side
effects. Usually while they can cause regressions they also might make
issues reoccur which the patch is trying to fix, blindly reverting is
not the answer.

Cheers,
Maarten.


From chmorgan at gmail.com  Wed Jun  4 10:37:15 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Wed, 4 Jun 2008 11:37:15 -0400
Subject: [AppDB] Allow admins to remove their admin rights
In-Reply-To: <200806041015.20190.alex@thehandofagony.com>
References: <200806031234.52772.alex@thehandofagony.com>
	<f3f1b91a0806031624j738cf125r5d4f8e2885d8e1da@mail.gmail.com>
	<200806041015.20190.alex@thehandofagony.com>
Message-ID: <f3f1b91a0806040837v46c633cfs72853c264c860990@mail.gmail.com>

On Wed, Jun 4, 2008 at 4:15 AM, Alexander Nicolaysen S?rnes
<alex at thehandofagony.com> wrote:
> P? Onsdag 04 juni 2008 , 01:24:07 skrev Chris Morgan:
>> What new policy on dissidents? ;-)
>>
>> How does this patch enable admins to remove themselves? I'm afraid I
>> can't see how this change lets an admin remove their own admin status.
>>
>> Chris
>>
>>
>
> Yea, that particular piece of code isn't very clear on what it's doing.  I
> found out that $aClean['iUserId'] would only be set when modifying another
> user, and it previously compared it to $oUser->iUserId before allowing the
> admin removal.  Now we only check for admin rights, and the oUser->iUserId ==
> aClean['iUserId'] check is performed later to see if we should redirect back
> to the user admin page.
>
>

So if the admin was removing their own admin status $aClean['iUserId']
wouldn't be set? If this is the case we should document it there
because otherwise the functionality is confusing.

How does the redirect relate to removing admin rights?

Chris


From alex at thehandofagony.com  Wed Jun  4 10:56:07 2008
From: alex at thehandofagony.com (Alexander Nicolaysen =?iso-8859-1?q?S=F8rnes?=)
Date: Wed, 4 Jun 2008 17:56:07 +0200
Subject: [AppDB] Allow admins to remove their admin rights
In-Reply-To: <f3f1b91a0806040837v46c633cfs72853c264c860990@mail.gmail.com>
References: <200806031234.52772.alex@thehandofagony.com>
	<200806041015.20190.alex@thehandofagony.com>
	<f3f1b91a0806040837v46c633cfs72853c264c860990@mail.gmail.com>
Message-ID: <200806041756.08599.alex@thehandofagony.com>

P? Onsdag 04 juni 2008 , 17:37:15 skrev Chris Morgan:
> On Wed, Jun 4, 2008 at 4:15 AM, Alexander Nicolaysen S?rnes
>
> <alex at thehandofagony.com> wrote:
> > P? Onsdag 04 juni 2008 , 01:24:07 skrev Chris Morgan:
> >> What new policy on dissidents? ;-)
> >>
> >> How does this patch enable admins to remove themselves? I'm afraid I
> >> can't see how this change lets an admin remove their own admin status.
> >>
> >> Chris
> >
> > Yea, that particular piece of code isn't very clear on what it's doing. 
> > I found out that $aClean['iUserId'] would only be set when modifying
> > another user, and it previously compared it to $oUser->iUserId before
> > allowing the admin removal.  Now we only check for admin rights, and the
> > oUser->iUserId == aClean['iUserId'] check is performed later to see if we
> > should redirect back to the user admin page.
>
> So if the admin was removing their own admin status $aClean['iUserId']
> wouldn't be set? If this is the case we should document it there
> because otherwise the functionality is confusing.
>
> How does the redirect relate to removing admin rights?
>
> Chris


If $aClean['iUserId'] isn't set, it is assumed the user is editing his own 
preferences.

As for the admin right remoal, I probably added it in the wrong place when I 
first introduced the feature.  It hadn't occured to me that anyone would want 
to do it, I guess :)


I can send a follow-up patch to add comments or clarify the code.


Alexander


From r.kalbermatter at hccnet.nl  Wed Jun  4 14:45:55 2008
From: r.kalbermatter at hccnet.nl (Rolf Kalbermatter)
Date: Wed, 4 Jun 2008 21:45:55 +0200
Subject: Fixing crashes in Tests (OS version check)
In-Reply-To: <3a768c550806011754k481aa8b0i5741e62b0c7167cd@mail.gmail.com>
References: <g1qjjf$bi6$1@ger.gmane.org>
	<48410A88.7010801@gmail.com><48411E89.40106@hotmail.com><3a768c550805311151h77f6a138y65a95e6716510f3e@mail.gmail.com><alpine.DEB.1.10.0806011523420.30909@amboise.dolphin>
	<3a768c550806011754k481aa8b0i5741e62b0c7167cd@mail.gmail.com>
Message-ID: <7F74EC1AE8384F188BEA454636B2BEEF@NATERS>

Juan Lang wrote:

> So, in my opinion, the general principle is this:  
> if the behavior is very different on different Windows 
> versions, and if the behavior on some Windows version is to 
> crash, it seems reasonable to remove the test, as: 1) we want 
> our tests to reflect Windows behavior that applications count 
> on, and different behavior (especially crashing) often 
> implies the applications don't count on a particular 
> behavior, and 2) having regression tests crash is 
> undesirable, as many other valid tests will not be run on a platform.

I don't think you can fully argument with this nowadays. There are
many applications out there that specifically state to not support
pre W2K or sometimes even XP and often refuse to even install on
older systems. So in this case they could be perfectly happy with
passing a NULL value to that function and since they never have
been tested on an older system the developer wouldn't even know
that there exists a potential problem.

So I would think it's useful to test that the Wine API does not
crash on a NULL parameter since newer Windows versions won't do
that either. 

> This doesn't mean that we can't make Wine not crash given the 
> bogus input, it just means we may not be able to have a 
> regression test for this behavior.  And, of course, there may 
> be specific instances in which we wish to test potentially 
> crashy behavior, but I'd argue that they better be really 
> important to override points 1) and 2).

This case seems fairly simple to me. As long as Wine strives to
provide support for Win9x and NT4 it needs to make efforts to
support both the newer and the older behaviour. For the API
itself this means allowing NULL values to be passed without
crashing and for the tests it means skipping that particular
test for those versions that do crash on it. And while a version
test seems the easiest I can also understand why the tests
should not have such artificial dependencies especially since
these tests would have to distinguish between running on
Windows or Wine set to emulate Win9x. 

But here it seems fairly easy to work around this problem. The
fact that certain Snmp APIs are not implemented or possibly return
an ERROR_UNIMPLEMENTED status on those platforms should be enough
to determine if this test should be skipped.

>And coming back to this test:  I still think it's easier just
>to remove the test than to come up with a hacky way of avoiding
>it on a crashy system.

No argument with the being easier part. But not writing tests at
all would be also easier, but I do not think that is a valid argument
to not do them. Typically to do a good test costs more time than an
actual implementation of a function and Wine development could
be sped up by not writing tests. But it would only implement more
functionality with a lot more errors (or should that be less bugs :-).

Rolf Kalbermatter



From chmorgan at gmail.com  Wed Jun  4 16:38:17 2008
From: chmorgan at gmail.com (Chris Morgan)
Date: Wed, 4 Jun 2008 17:38:17 -0400
Subject: [AppDB] Allow admins to remove their admin rights
In-Reply-To: <200806041756.08599.alex@thehandofagony.com>
References: <200806031234.52772.alex@thehandofagony.com>
	<200806041015.20190.alex@thehandofagony.com>
	<f3f1b91a0806040837v46c633cfs72853c264c860990@mail.gmail.com>
	<200806041756.08599.alex@thehandofagony.com>
Message-ID: <f3f1b91a0806041438o3028f170hce7b56b575c06fee@mail.gmail.com>

On Wed, Jun 4, 2008 at 11:56 AM, Alexander Nicolaysen S?rnes
<alex at thehandofagony.com> wrote:
> P? Onsdag 04 juni 2008 , 17:37:15 skrev Chris Morgan:
>> On Wed, Jun 4, 2008 at 4:15 AM, Alexander Nicolaysen S?rnes
>>
>> <alex at thehandofagony.com> wrote:
>> > P? Onsdag 04 juni 2008 , 01:24:07 skrev Chris Morgan:
>> >> What new policy on dissidents? ;-)
>> >>
>> >> How does this patch enable admins to remove themselves? I'm afraid I
>> >> can't see how this change lets an admin remove their own admin status.
>> >>
>> >> Chris
>> >
>> > Yea, that particular piece of code isn't very clear on what it's doing.
>> > I found out that $aClean['iUserId'] would only be set when modifying
>> > another user, and it previously compared it to $oUser->iUserId before
>> > allowing the admin removal.  Now we only check for admin rights, and the
>> > oUser->iUserId == aClean['iUserId'] check is performed later to see if we
>> > should redirect back to the user admin page.
>>
>> So if the admin was removing their own admin status $aClean['iUserId']
>> wouldn't be set? If this is the case we should document it there
>> because otherwise the functionality is confusing.
>>
>> How does the redirect relate to removing admin rights?
>>
>> Chris
>
>
> If $aClean['iUserId'] isn't set, it is assumed the user is editing his own
> preferences.
>
> As for the admin right remoal, I probably added it in the wrong place when I
> first introduced the feature.  It hadn't occured to me that anyone would want
> to do it, I guess :)
>
>
> I can send a follow-up patch to add comments or clarify the code.
>

A follow up patch would be useful. I don't want to leave that section
undocumented if we are making changes to it.

Chris


From dank at kegel.com  Wed Jun  4 18:38:56 2008
From: dank at kegel.com (Dan Kegel)
Date: Wed, 4 Jun 2008 16:38:56 -0700
Subject: [PATCH] oleaut32: Fix valgrind warnings in vatype.c test
Message-ID: <a71bd89a0806041638j4a26c42cq1da38553610efa0e@mail.gmail.com>

Hi Jon,
I guess
http://www.winehq.org/pipermail/wine-patches/2008-May/055352.html
must have been too scary to commit.
I independently sent in a fix for the easy part, and it was committed as
http://winehq.org/pipermail/wine-cvs/2008-June/043999.html

The last part of your patch, having to do with SysAllocStringByteLen(),
seems correct to me, offhand.  Maybe if you clean up the
comment a bit more, sprinkle sugar on it, and resend, it'll make
it in this time.  It's so gross, though, that it really should serve as
a reminder to us to switch to IMalloc...
- Dan


From paul.vriens.wine at gmail.com  Thu Jun  5 08:05:19 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 05 Jun 2008 15:05:19 +0200
Subject: gdi32/tests: Take into account several Win9x bugs in GetObject().
	(take 3)
In-Reply-To: <alpine.DEB.1.10.0806051457590.26854@amboise.dolphin>
References: <alpine.DEB.1.10.0806051457590.26854@amboise.dolphin>
Message-ID: <4847E48F.4020208@gmail.com>

Francois Gouget wrote:
> ---
> 
> This time without the bug that caused tests to fail in Wine and on 
> Windows XP.
> 
>  
> +    SetLastError(0xdeadbeef);
>      ret = GetBitmapBits(hbm, 0, NULL);
> -    ok(ret == bm.bmWidthBytes * bm.bmHeight, "%d != %d\n", ret, bm.bmWidthBytes * bm.bmHeight);
> +    gle=GetLastError();
> +    ok(ret == bm.bmWidthBytes * bm.bmHeight || (ret == 0 && gle == ERROR_INVALID_PARAMETER /* Win9x */), "%d != %d\n", ret, bm.bmWidthBytes * bm.bmHeight);

Any reason this one isn't put into a broken() for win9x (as you did with all the 
others).

-- 
Cheers,

Paul.


From fgouget at free.fr  Thu Jun  5 09:24:25 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 5 Jun 2008 16:24:25 +0200 (CEST)
Subject: gdi32/tests: Take into account several Win9x bugs in GetObject().
	(take 3)
In-Reply-To: <4847E48F.4020208@gmail.com>
References: <alpine.DEB.1.10.0806051457590.26854@amboise.dolphin>
	<4847E48F.4020208@gmail.com>
Message-ID: <alpine.DEB.1.10.0806051617360.2912@amboise.dolphin>

On Thu, 5 Jun 2008, Paul Vriens wrote:

> Francois Gouget wrote:
> > ---
> > 
> > This time without the bug that caused tests to fail in Wine and on Windows
> > XP.
> > 
> >  +    SetLastError(0xdeadbeef);
> >      ret = GetBitmapBits(hbm, 0, NULL);
> > -    ok(ret == bm.bmWidthBytes * bm.bmHeight, "%d != %d\n", ret,
> > bm.bmWidthBytes * bm.bmHeight);
> > +    gle=GetLastError();
> > +    ok(ret == bm.bmWidthBytes * bm.bmHeight || (ret == 0 && gle ==
> > ERROR_INVALID_PARAMETER /* Win9x */), "%d != %d\n", ret, bm.bmWidthBytes *
> > bm.bmHeight);
> 
> Any reason this one isn't put into a broken() for win9x (as you did with all
> the others).

Because the MSDN says:

   If the function succeeds, the return value is the number of bytes 
   copied to the buffer.
   If the function fails, the return value is zero. 

So according to that Win9x does the right thing and it even makes some 
sense. Thus it seems wrong to mark it as broken. Yet NT4 and greater 
always return the number of bytes that _would_ have been copied to the 
buffer...

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                  Hiroshima '45 - Czernobyl '86 - Windows '95


From jon_p_griffiths at yahoo.com  Thu Jun  5 06:55:52 2008
From: jon_p_griffiths at yahoo.com (Jon Griffiths)
Date: Thu, 5 Jun 2008 04:55:52 -0700 (PDT)
Subject: [PATCH] oleaut32: Fix valgrind warnings in vatype.c test
In-Reply-To: <a71bd89a0806041638j4a26c42cq1da38553610efa0e@mail.gmail.com>
Message-ID: <407261.9946.qm@web56602.mail.re3.yahoo.com>

Hi Dan,

> The last part of your patch, having to do with SysAllocStringByteLen(),
> seems correct to me, offhand.  Maybe if you clean up the comment a
> bit more, sprinkle sugar on it, and resend, it'll make it in this time.

I'll polish it and fire in again next week, there doesn't seem much point in spamming the patch queue with changes that aren't obviously correct  while the freeze is on (didn't stop me trying though!).

> It's so gross, though, that it really should serve as
> a reminder to us to switch to IMalloc...

Yeah, its nasty, but it does make valgrind happy :-) I think reworking the memory allocation is going to be pretty far down the list for this dll though, there seem to be quite a few VB failures that should probably be tackled first...

I have to say I think getting the tests to pass valginding is a great way to fix bugs. I can't see any other way the variant leaks would have been found, for example. Cheers for a very readable wiki page, it was trivial to get it set up.

Cheers
Jon



      


From truiken at gmail.com  Thu Jun  5 12:35:34 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 5 Jun 2008 12:35:34 -0500
Subject: Remove unused variable in dlls/mlang/tests/mlang.c
In-Reply-To: <alpine.LSU.1.10.0806051717510.6827@acrux.dbai.tuwien.ac.at>
References: <alpine.LSU.1.10.0806051717510.6827@acrux.dbai.tuwien.ac.at>
Message-ID: <22821af30806051035o1749e491s4e34dd1a4c505616@mail.gmail.com>

2008/6/5 Gerald Pfeifer <gerald at pfeifer.com>:
>
> ChangeLog:
> Remove unused variable in test_EnumScripts().
>
> Index: dlls/mlang/tests/mlang.c
> ===================================================================
> RCS file: /home/wine/wine/dlls/mlang/tests/mlang.c,v
> retrieving revision 1.24
> diff -u -3 -p -r1.24 mlang.c
> --- dlls/mlang/tests/mlang.c    4 Jun 2008 11:37:37 -0000       1.24
> +++ dlls/mlang/tests/mlang.c    5 Jun 2008 15:17:51 -0000
> @@ -594,7 +594,6 @@ static void test_EnumScripts(IMultiLangu
>
>     for (i = 0; pGetCPInfoExA && i < n; i++)
>     {
> -       CPINFOEXA cpinfoex;
>  #ifdef DUMP_SCRIPT_INFO
>        trace("SCRIPTINFO #%u:\n"
>              "ScriptId %08x\n"
>
>
>

http://winehq.org/pipermail/wine-cvs/2008-June/044013.html

-- 
James Hawkins


From truiken at gmail.com  Thu Jun  5 12:59:35 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 5 Jun 2008 12:59:35 -0500
Subject: kernel32: tests/path.c: Improve test for GetLongPathNameA
In-Reply-To: <4847438F.9020006@zacbrown.org>
References: <4847438F.9020006@zacbrown.org>
Message-ID: <22821af30806051059u24c9ddc8ob984e73445105c25@mail.gmail.com>

On Wed, Jun 4, 2008 at 8:38 PM, Zac Brown <zac at zacbrown.org> wrote:
> Add test to check for GetLongPathNameA on GetModuleFileNameA's returned
> string.
>
> Found via errors existing in shell32/tests/shelllink.c. Checked against
> Windows XP and Windows 2000.
>

+    pGetModuleFileNameA =
+        (void*)GetProcAddress( GetModuleHandleA("kernel32.dll"),
"GetModuleFileNameA" );

GetModuleFileNameA is available on all platforms, and besides, you use
it without checking if it's NULL.

+/* Try getting the long path of your module name */
+  if(pGetLongPathNameA) {
+    ok(pGetModuleFileNameA(NULL,tmpstr,sizeof(tmpstr)),"GetModuleFileNameA
failed %s\n",
+       tmpstr);
+    todo_wine ok(pGetLongPathNameA(tmpstr,tmpstr1,MAX_PATH),"GetLongPathNameA
failed %s\n",
+       tmpstr);
+  }

What is this testing?  Just that GetLongPathName doesn't fail in this
case (I'm not even sure what 'this case' is specifically)?  You should
be checking the return value and the value of the out variable.

-- 
James Hawkins


From dank at kegel.com  Thu Jun  5 20:07:36 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 5 Jun 2008 18:07:36 -0700
Subject: Double free error involving dsound and winealsa.drv
Message-ID: <a71bd89a0806051807j4397d564ja88ba4133e30490@mail.gmail.com>

Hmm, freeing a buffer that's already been freed is bad,
is it showstopper bad?

http://bugs.winehq.org/show_bug.cgi?id=13723


From dmitry at codeweavers.com  Thu Jun  5 22:22:49 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 6 Jun 2008 12:22:49 +0900
Subject: user32: EnumDisplaySettingsExA: fill in all of
	lpDevmode->dmDeviceName
References: <a71bd89a0806052014u63b2f025oe298038af399c25f@mail.gmail.com>
Message-ID: <5542F2660E8A4DC0ADB97AE63ED08C8E@DMITRY>

"Dan Kegel" <dank at kegel.com> wrote:

> 'Cause if we don't, code that expects it to be defined
> is mildly surprised to find that bytes after the string's
> terminating nul are undefined.
> Fixes 16 Valgrind warnings of the form:
> 
> Use of uninitialised value of size 4
>   at mbstowcs_sbcs (mbtowc.c:78)
>   by wine_cp_mbstowcs (mbtowc.c:266)
>   by MultiByteToWideChar (locale.c:1846)
>   by GdiConvertToDevmodeW (driver.c:434)
>   by ChangeDisplaySettingsExA (sysparams.c:3011)
>   by ChangeDisplaySettingsA (sysparams.c:2980)
>   by test_ChangeDisplaySettingsEx (monitor.c:161)
> Uninitialised value was created by a stack allocation
>   at test_ChangeDisplaySettingsEx (monitor.c:141)

GdiConvertToDevmodeW should be fixed instead.

-- 
Dmitry.


From m.b.lankhorst at gmail.com  Fri Jun  6 02:33:08 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Fri, 6 Jun 2008 09:33:08 +0200
Subject: Double free error involving dsound and winealsa.drv
In-Reply-To: <a71bd89a0806051807j4397d564ja88ba4133e30490@mail.gmail.com>
References: <a71bd89a0806051807j4397d564ja88ba4133e30490@mail.gmail.com>
Message-ID: <b130c85e0806060033h2ef7ed95x89f89cb7dac53c3b@mail.gmail.com>

Hi Dan,

2008/6/6 Dan Kegel <dank at kegel.com>:
> Hmm, freeing a buffer that's already been freed is bad,
> is it showstopper bad?

If it was created with USESYSTEMMEMORY, then dsound created the
buffer, if not, alsa owns it.

Cheers,
Maarten.


From whuang.ustc at gmail.com  Fri Jun  6 03:02:31 2008
From: whuang.ustc at gmail.com (Wen Huang)
Date: Fri, 6 Jun 2008 03:02:31 -0500
Subject: Compile wine on Red Hat 9
Message-ID: <5574F32F-4249-48BA-BE65-B8BCA48D51A8@gmail.com>

Hi everybody,

I was trying to compile a winehq on Red Hat 9 and I downloaded the  
source 0.9.60 from sourceforge.

When I tried to compile by

./configure
make depend
make

during the make step, it gave an error

.....
gcc -c -I. -I. -I../../include -I../../include -I/usr/include/ 
libxml2   -I/usr/include/libxml2   -D__WINESRC__ -DCOM_NO_WINDOWS_H - 
D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration-after- 
statement -Wwrite-strings -Wpointer-arith  -g -O2  -o cdata.o cdata.c
cdata.c: In function `domcdata_appendData':
cdata.c:601: void value not ignored as it ought to be
make[2]: *** [cdata.o] Error 1
make[2]: Leaving directory `/home/tus/wine-0.9.60/dlls/msxml3'
make[1]: *** [msxml3] Error 2
make[1]: Leaving directory `/home/tus/wine-0.9.60/dlls'
make: *** [dlls] Error 2

Can anybody kindly offer some help?

By the way, is there rpm package for wine I can use on Red Hat 9, I  
tried to use the script on Wine Red Hat wiki to generate a rpm, but it  
failed at the same step...

Thanks,
Wen



From mstefani at redhat.com  Fri Jun  6 03:42:24 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Fri, 06 Jun 2008 10:42:24 +0200
Subject: Compile wine on Red Hat 9
In-Reply-To: <5574F32F-4249-48BA-BE65-B8BCA48D51A8@gmail.com>
References: <5574F32F-4249-48BA-BE65-B8BCA48D51A8@gmail.com>
Message-ID: <4848F870.9040607@redhat.com>

Hello!

Wen Huang wrote:
> I was trying to compile a winehq on Red Hat 9 and I downloaded the  
> source 0.9.60 from sourceforge.
Do you really mean Red Hat Linux 9? Or Fedora 9? Red Hat Linux 9 is 
really old and unsupported for years now.

> When I tried to compile by
> 
> ./configure
> make depend
> make
> 
> during the make step, it gave an error
> 
> .....
> gcc -c -I. -I. -I../../include -I../../include -I/usr/include/ 
> libxml2   -I/usr/include/libxml2   -D__WINESRC__ -DCOM_NO_WINDOWS_H - 
> D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration-after- 
> statement -Wwrite-strings -Wpointer-arith  -g -O2  -o cdata.o cdata.c
> cdata.c: In function `domcdata_appendData':
> cdata.c:601: void value not ignored as it ought to be
> make[2]: *** [cdata.o] Error 1
> make[2]: Leaving directory `/home/tus/wine-0.9.60/dlls/msxml3'
> make[1]: *** [msxml3] Error 2
> make[1]: Leaving directory `/home/tus/wine-0.9.60/dlls'
> make: *** [dlls] Error 2
> 
> Can anybody kindly offer some help?
It really depends if you use Red Hat Linux 9 or Fedora 9. For RHL9 you 
can try to pass --without-xml to configure and see if that makes it 
work. But that will make the XML DLLs unusable.

> By the way, is there rpm package for wine I can use on Red Hat 9, I  
> tried to use the script on Wine Red Hat wiki to generate a rpm, but it  
> failed at the same step...

bye
	michael


From shakaran at gmail.com  Fri Jun  6 05:07:22 2008
From: shakaran at gmail.com (=?ISO-8859-1?Q?=C1ngel_Guzm=E1n_Maeso?=)
Date: Fri, 6 Jun 2008 12:07:22 +0200
Subject: [website] Fix typo in Spanish translation of home.template
In-Reply-To: <82b2af8e0806021534h74ec44ccu31a1ed79b018376@mail.gmail.com>
References: <82b2af8e0806021534h74ec44ccu31a1ed79b018376@mail.gmail.com>
Message-ID: <82b2af8e0806060307m43a16a60wa5262a70cda30351@mail.gmail.com>

I am still awaiting a response.
-- 
Shakaran
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080606/c96d5f9e/attachment.htm 

From robertshearman at gmail.com  Fri Jun  6 07:03:05 2008
From: robertshearman at gmail.com (Rob Shearman)
Date: Fri, 6 Jun 2008 13:03:05 +0100
Subject: [PATCH] GetUrlCacheEntryInfo*: Handle null dest pointer when
	length is given
In-Reply-To: <893656.45456.qm@web56614.mail.re3.yahoo.com>
References: <893656.45456.qm@web56614.mail.re3.yahoo.com>
Message-ID: <1096648c0806060503x4ddc0810la870008a70bfcf80@mail.gmail.com>

2008/6/6 Jon Griffiths <jon_p_griffiths at yahoo.com>:
> -    if (dwRequiredSize > *lpdwBufferSize)
> -    {
> -        *lpdwBufferSize = dwRequiredSize;
> +    ret = dwRequiredSize > *lpdwBufferSize? FALSE : TRUE;
> +    *lpdwBufferSize = dwRequiredSize;
> +
> +    if (!ret)
>          SetLastError(ERROR_INSUFFICIENT_BUFFER);
> -        return FALSE;
> +    else if (!lpCacheEntryInfo)
> +    {
> +        SetLastError(ERROR_INVALID_PARAMETER);
> +        ret = FALSE;
>      }
> -    *lpdwBufferSize = dwRequiredSize;
> -    return TRUE;
> +    return ret;
>  }

Internal functions should return an error code instead of calling
SetLastError. This avoids situations like this:

> @@ -1531,6 +1539,9 @@ BOOL WINAPI GetUrlCacheEntryInfoA(
>              FALSE /* ANSI */))
>          {
>              URLCacheContainer_UnlockIndex(pContainer, pHeader);
> +            /* This case is inconsistent w.r.t RetrieveUrlCacheEntryFile */
> +            if (!lpCacheEntryInfo && GetLastError() == ERROR_INVALID_PARAMETER)
> +                SetLastError(ERROR_INSUFFICIENT_BUFFER);
>              return FALSE;
>          }
>          TRACE("Local File Name: %s\n", debugstr_a(lpCacheEntryInfo->lpszLocalFileName));


-- 
Rob Shearman


From dank at kegel.com  Fri Jun  6 08:11:34 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 6 Jun 2008 06:11:34 -0700
Subject: Wine in the news
Message-ID: <a71bd89a0806060611g7341ee6dked3011d4c48238ec@mail.gmail.com>

http://www.australianit.news.com.au/story/0,24897,23797416-24169,00.html
The new president of Red Hat, when asked about desktop linux, said:
"My simple answer is until Apple's iTunes runs on consumer Linux
desktops, it's not going to take off. I know you can run Wine, which
runs Windows applications on Linux, so techies will beat me up on
that, but fundamentally there are some major device driver issues with
products that people like to use and this limits adoption. It's going
to be slow until these issues are solved."

http://news.zdnet.co.uk/software/0,1000000121,39429910,00.htm
http://economyaustria.at/Text/?id=3363378
Vienna migrates some Linux workstations to Vista because
a single app, Schlaum?use, crashes under Wine.
Looks like they send the software out upon request
to teachers; see http://www.schlaumaeuse.de/
(Can somebody send me a copy?)


From kai.blin at gmail.com  Fri Jun  6 08:44:30 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Fri, 6 Jun 2008 15:44:30 +0200
Subject: Wine in the news
In-Reply-To: <a71bd89a0806060611g7341ee6dked3011d4c48238ec@mail.gmail.com>
References: <a71bd89a0806060611g7341ee6dked3011d4c48238ec@mail.gmail.com>
Message-ID: <200806061544.30984.kai.blin@gmail.com>

On Friday 06 June 2008 15:11:34 Dan Kegel wrote:

> http://news.zdnet.co.uk/software/0,1000000121,39429910,00.htm
> http://economyaustria.at/Text/?id=3363378
> Vienna migrates some Linux workstations to Vista because
> a single app, Schlaum?use, crashes under Wine.
> Looks like they send the software out upon request
> to teachers; see http://www.schlaumaeuse.de/
> (Can somebody send me a copy?)

To quote from the zdnet report:

[quote]
The software maker behind the Schlaum?use software is planning a Firefox 
version for 2009, according to Ringler, who pointed out in the report that 
the city could have subsidised a Firefox version of the software for a 
fraction of the cost of the Windows Vista migration.
[/quote]

Given that they didn't even bother to file a bug report or add an appdb entry, 
that sounds pretty fishy. I know that there's been a couple of bug reports 
and requested changes to Samba when Munich migrated to Windows. I don't see 
why any real user of Wine wouldn't at least file a bug report.

Overall it seems like Vienna is looking for reasons to back out of the Linux 
migration, perhaps in exchange for some goodies some big companies would 
donate in that case. Things like this have happened before.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080606/300e5f34/attachment.pgp 

From dank at kegel.com  Fri Jun  6 09:07:05 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 6 Jun 2008 07:07:05 -0700
Subject: Wine in the news
In-Reply-To: <a71bd89a0806060611g7341ee6dked3011d4c48238ec@mail.gmail.com>
References: <a71bd89a0806060611g7341ee6dked3011d4c48238ec@mail.gmail.com>
Message-ID: <a71bd89a0806060707y666394c2if4285b4703001c55@mail.gmail.com>

Kai wrote:
>Given that they didn't even bother to file a bug report
>or add an appdb entry, that sounds pretty fishy.
> I know that there's been a couple of bug reports
>and requested changes to Samba when Munich
>migrated to Windows. I don't see why any real user
> of Wine wouldn't at least file a bug report.

You'd be surprised.   I've visited the Limux guys in
Munich, and although they did test and use Wine,
they had very little time to devote to it.  I helped
them file Wine bugs, don't know if they would have
without help.  I don't know much about the Vienna
effort.  I did make contact with them in 2006, but
they didn't seem that interested in Wine at the time.
I emailed them again today, perhaps they're more
interested now.

> Overall it seems like Vienna is looking for reasons
> to back out of the Linux migration, perhaps in exchange
> for some goodies some big companies would
>donate in that case. Things like this have happened before.

Vienna, like Munich, isn't monolithic.  There are people
and parties who support the migration in both cases,
and those who oppose it.   It's a continual tug-of-war.
- Dan


From jon_p_griffiths at yahoo.com  Fri Jun  6 07:55:38 2008
From: jon_p_griffiths at yahoo.com (Jon Griffiths)
Date: Fri, 6 Jun 2008 05:55:38 -0700 (PDT)
Subject: [PATCH] GetUrlCacheEntryInfo*: Handle null dest pointer when
	length is given
In-Reply-To: <1096648c0806060503x4ddc0810la870008a70bfcf80@mail.gmail.com>
Message-ID: <537323.39484.qm@web56601.mail.re3.yahoo.com>

> Internal functions should return an error code instead of
> calling SetLastError.

Perhaps in a general sense, but URLCache_CopyEntry already did SetLastError(ERROR_INSUFFICIENT_BUFFER): setting it there means the 4 places that call it don't need to the logic to set the 2 different errors themselves.

Having the inconsistent case marked out is also not a bad thing IMO - it wouldn't be as clear that its a special case if the SetLastError logic was after each call to URLCache_CopyEntry and one of four was subtly different.

J



      


From blackdrag at gmx.org  Fri Jun  6 09:13:22 2008
From: blackdrag at gmx.org (Jochen)
Date: Fri, 06 Jun 2008 16:13:22 +0200
Subject: Wine in the news
In-Reply-To: <200806061544.30984.kai.blin@gmail.com>
References: <a71bd89a0806060611g7341ee6dked3011d4c48238ec@mail.gmail.com>
	<200806061544.30984.kai.blin@gmail.com>
Message-ID: <g2bgln$drv$1@ger.gmane.org>

Kai Blin schrieb:
> On Friday 06 June 2008 15:11:34 Dan Kegel wrote:
> 
>> http://news.zdnet.co.uk/software/0,1000000121,39429910,00.htm
>> http://economyaustria.at/Text/?id=3363378
>> Vienna migrates some Linux workstations to Vista because
>> a single app, Schlaum?use, crashes under Wine.
>> Looks like they send the software out upon request
>> to teachers; see http://www.schlaumaeuse.de/
>> (Can somebody send me a copy?)
> 
> To quote from the zdnet report:
> 
> [quote]
> The software maker behind the Schlaum?use software is planning a Firefox 
> version for 2009, according to Ringler, who pointed out in the report that 
> the city could have subsidised a Firefox version of the software for a 
> fraction of the cost of the Windows Vista migration.
> [/quote]
> 
> Given that they didn't even bother to file a bug report or add an appdb entry, 
> that sounds pretty fishy. I know that there's been a couple of bug reports 
> and requested changes to Samba when Munich migrated to Windows. I don't see 
> why any real user of Wine wouldn't at least file a bug report.
> 
> Overall it seems like Vienna is looking for reasons to back out of the Linux 
> migration, perhaps in exchange for some goodies some big companies would 
> donate in that case. Things like this have happened before.

also if schlaum?use is only the lexicon, then I can say: it works with 
FF3. See http://www.schlaumaeuse.de/bildungsinitiative/lexikon.html 
click on the picture and a javascript will open a new window with the 
lexicon. It takes a while to load, but it seems to work.

bye Jochen



From kai.blin at gmail.com  Fri Jun  6 09:47:24 2008
From: kai.blin at gmail.com (Kai Blin)
Date: Fri, 6 Jun 2008 16:47:24 +0200
Subject: Wine in the news
In-Reply-To: <a71bd89a0806060707y666394c2if4285b4703001c55@mail.gmail.com>
References: <a71bd89a0806060611g7341ee6dked3011d4c48238ec@mail.gmail.com>
	<a71bd89a0806060707y666394c2if4285b4703001c55@mail.gmail.com>
Message-ID: <200806061647.24138.kai.blin@gmail.com>

On Friday 06 June 2008 16:07:05 Dan Kegel wrote:

> You'd be surprised.   I've visited the Limux guys in
> Munich, and although they did test and use Wine,
> they had very little time to devote to it.  I helped
> them file Wine bugs, don't know if they would have
> without help.  I don't know much about the Vienna
> effort.  I did make contact with them in 2006, but
> they didn't seem that interested in Wine at the time.
> I emailed them again today, perhaps they're more
> interested now.

So the issue is that Wine is still not regarded as a serious project. I know 
Munich contracted a company to fix their Samba issues. Why not do the same 
for Wine? I know there's German-language companies doing this, and 
Codeweavers has an Austrian native speaker.

> Vienna, like Munich, isn't monolithic.  There are people
> and parties who support the migration in both cases,
> and those who oppose it.   It's a continual tug-of-war.

Yes, my point is that "Our Kindergarden app doesn't work with Wine, let's roll 
out Vista instead" sounds very suspicious to me. This is a politics issue, 
not a technical issue.

Cheers,
Kai

-- 
Kai Blin
WorldForge developer  http://www.worldforge.org/
Wine developer        http://wiki.winehq.org/KaiBlin
Samba team member     http://www.samba.org/samba/team/
--
Will code for cotton.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080606/da2abc69/attachment.pgp 

From dank at kegel.com  Fri Jun  6 10:09:18 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 6 Jun 2008 08:09:18 -0700
Subject: Bad free error involving shdocvw and COM?
Message-ID: <a71bd89a0806060809p7cdedd1naf7fc50cb916168a@mail.gmail.com>

In shdocvw/tests/webbrowser.c, at the end of test_WebBrowser,
the call IUnknown_Release(unk) results in the following Valgrind error:

 Invalid free() / delete / delete[]
    at  notify_free (heap.c:199)
    by  RtlFreeHeap (heap.c:1284)
    by  SysFreeString (oleaut.c:196)
    by  DocHost_Release (dochost.c:550)
    by  WebBrowser_Release (webbrowser.c:153)
    by  test_WebBrowser (webbrowser.c:2028)
    by  func_webbrowser (webbrowser.c:2070)
    by  run_test (test.h:421)
    by  main (test.h:470)
  Address 0x7f01dc14 is 8 bytes after a block of size 28 alloc'd
    at  notify_alloc (heap.c:191)
    by  RtlAllocateHeap (heap.c:1231)
    by  COMPOBJ_DllList_Add (compobj.c:910)
    by  apartment_getclassobject (compobj.c:794)
    by  get_inproc_class_object (compobj.c:2138)
    by  CoGetClassObject (compobj.c:2238)
    by  get_protocol_cf (session.c:111)
    by  get_protocol_info (session.c:219)
    by  parse_canonicalize_url (internet.c:63)
    by  CoInternetParseUrl (internet.c:184)
    by  URLMonikerImpl_Construct (umon.c:1039)
    by  CreateURLMonikerEx (umon.c:1097)
    by  CreateURLMoniker (umon.c:1123)
    by  create_moniker (navigate.c:564)
    by  bind_to_object (navigate.c:600)
    by  navigate_bsc (navigate.c:657)
    by  navigate_bsc_proc (navigate.c:679)
    by  process_dochost_task (dochost.c:43)
    by  shell_embedding_proc (oleobject.c:65)
    by  ??? (library.h:163)

Seems like an important bug to fix, since it could conceivably
lead to heap corruption.  This is all our code, no gecko involved,
so we ought to be able to sort it, but it's beyond my ken.


From stefan at codeweavers.com  Fri Jun  6 11:18:05 2008
From: stefan at codeweavers.com (=?windows-1252?Q?Stefan_D=F6singer?=)
Date: Fri, 6 Jun 2008 18:18:05 +0200
Subject: AW: Wine in the news
In-Reply-To: <200806061544.30984.kai.blin@gmail.com>
References: <a71bd89a0806060611g7341ee6dked3011d4c48238ec@mail.gmail.com>
	<200806061544.30984.kai.blin@gmail.com>
Message-ID: <000001c8c7f0$e72836f0$b578a4d0$@com>


FYI, this is my first Outlook dogfooding mail. Please holler if there's
anything wrong, like HTML or strange attachments.

> Overall it seems like Vienna is looking for reasons to back out of the
> Linux migration, perhaps in exchange for some goodies some big
> companies would donate in that case. Things like this have happened
> before.
There was a small remark about this in the classic newspapers here as well,
and even my dad(non-technie as far as computers are concerned) had the
impression that the real reason for the switch is unofficial for legal or
ethic reasons...

As far as the price is concerned, it seems that they're buying 750 Vista
Ultimate licenses for the computers, otherwise they wouldn't spend 400.000
euro just for those boxes. What's especially embarrassing for me(as an
Austrian) is that the other days we're told that there is no money for
anything in education. Feels like a banana republic at times.

I guess someone should send Vienna an offer to write an IE replacement
capable of running that app for 1/4th of the 8 Millions, or maybe a
realistic price even, and see what happens, just for the amusement of the
political discussion. Jeremy?




From whuang.ustc at gmail.com  Fri Jun  6 10:38:24 2008
From: whuang.ustc at gmail.com (Wen Huang)
Date: Fri, 6 Jun 2008 10:38:24 -0500
Subject: Compile wine on Red Hat 9
In-Reply-To: <4848F870.9040607@redhat.com>
References: <5574F32F-4249-48BA-BE65-B8BCA48D51A8@gmail.com>
	<4848F870.9040607@redhat.com>
Message-ID: <D799A91E-DEF5-43B3-A78F-C8137AAE817B@gmail.com>

Thanks a lot Michael.

I tried and it worked! Just curious that whether this is going to  
affect many programs run through wine. I use wine to run WinBUGS, it  
worked fine.

Thanks,
Wen

On Jun 6, 2008, at 3:42 AM, Michael Stefaniuc wrote:

> Hello!
>
> Wen Huang wrote:
>> I was trying to compile a winehq on Red Hat 9 and I downloaded the   
>> source 0.9.60 from sourceforge.
> Do you really mean Red Hat Linux 9? Or Fedora 9? Red Hat Linux 9 is  
> really old and unsupported for years now.
>
>> When I tried to compile by
>> ./configure
>> make depend
>> make
>> during the make step, it gave an error
>> .....
>> gcc -c -I. -I. -I../../include -I../../include -I/usr/include/  
>> libxml2   -I/usr/include/libxml2   -D__WINESRC__ -DCOM_NO_WINDOWS_H  
>> - D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration- 
>> after- statement -Wwrite-strings -Wpointer-arith  -g -O2  -o  
>> cdata.o cdata.c
>> cdata.c: In function `domcdata_appendData':
>> cdata.c:601: void value not ignored as it ought to be
>> make[2]: *** [cdata.o] Error 1
>> make[2]: Leaving directory `/home/tus/wine-0.9.60/dlls/msxml3'
>> make[1]: *** [msxml3] Error 2
>> make[1]: Leaving directory `/home/tus/wine-0.9.60/dlls'
>> make: *** [dlls] Error 2
>> Can anybody kindly offer some help?
> It really depends if you use Red Hat Linux 9 or Fedora 9. For RHL9  
> you can try to pass --without-xml to configure and see if that makes  
> it work. But that will make the XML DLLs unusable.
>
>> By the way, is there rpm package for wine I can use on Red Hat 9,  
>> I  tried to use the script on Wine Red Hat wiki to generate a rpm,  
>> but it  failed at the same step...
>
> bye
> 	michael



From mstefani at redhat.com  Fri Jun  6 11:52:45 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Fri, 06 Jun 2008 18:52:45 +0200
Subject: Compile wine on Red Hat 9
In-Reply-To: <D799A91E-DEF5-43B3-A78F-C8137AAE817B@gmail.com>
References: <5574F32F-4249-48BA-BE65-B8BCA48D51A8@gmail.com>	<4848F870.9040607@redhat.com>
	<D799A91E-DEF5-43B3-A78F-C8137AAE817B@gmail.com>
Message-ID: <48496B5D.5060209@redhat.com>

Wen Huang wrote:
> Thanks a lot Michael.
> 
> I tried and it worked! Just curious that whether this is going to  
> affect many programs run through wine. I use wine to run WinBUGS, it  
> worked fine.
It will affect all those programs that use the Windows XML DLLs.
You could try to upgrade the libxml2 rpms on your Red Hat Linux 9 box by 
recompiling the libxml2 srpm from F9. No clue if that will work.

bye
	michael

> On Jun 6, 2008, at 3:42 AM, Michael Stefaniuc wrote:
> 
>> Hello!
>>
>> Wen Huang wrote:
>>> I was trying to compile a winehq on Red Hat 9 and I downloaded the   
>>> source 0.9.60 from sourceforge.
>> Do you really mean Red Hat Linux 9? Or Fedora 9? Red Hat Linux 9 is  
>> really old and unsupported for years now.
>>
>>> When I tried to compile by
>>> ./configure
>>> make depend
>>> make
>>> during the make step, it gave an error
>>> .....
>>> gcc -c -I. -I. -I../../include -I../../include -I/usr/include/  
>>> libxml2   -I/usr/include/libxml2   -D__WINESRC__ -DCOM_NO_WINDOWS_H  
>>> - D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration- 
>>> after- statement -Wwrite-strings -Wpointer-arith  -g -O2  -o  
>>> cdata.o cdata.c
>>> cdata.c: In function `domcdata_appendData':
>>> cdata.c:601: void value not ignored as it ought to be
>>> make[2]: *** [cdata.o] Error 1
>>> make[2]: Leaving directory `/home/tus/wine-0.9.60/dlls/msxml3'
>>> make[1]: *** [msxml3] Error 2
>>> make[1]: Leaving directory `/home/tus/wine-0.9.60/dlls'
>>> make: *** [dlls] Error 2
>>> Can anybody kindly offer some help?
>> It really depends if you use Red Hat Linux 9 or Fedora 9. For RHL9  
>> you can try to pass --without-xml to configure and see if that makes  
>> it work. But that will make the XML DLLs unusable.
>>
>>> By the way, is there rpm package for wine I can use on Red Hat 9,  
>>> I  tried to use the script on Wine Red Hat wiki to generate a rpm,  
>>> but it  failed at the same step...




From jacek at codeweavers.com  Fri Jun  6 12:55:54 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Fri, 06 Jun 2008 19:55:54 +0200
Subject: [urlmon/tests 2/2] Fix test on IE7 (Resend)
In-Reply-To: <48493076.4020800@gmail.com>
References: <48493076.4020800@gmail.com>
Message-ID: <48497A2A.1090809@codeweavers.com>

Hi Paul,

Paul Vriens wrote:
> Hi,
>
> This (together with number 1 of course) fixes the tests on IE7 boxes.
>
> Not sure if a patch for urlmon/protocol.c is needed as well. Let me 
> know and
> I'll sent one.
>
> Changelog
>   Fix test on IE7

While fixing such tests it's good to add FIXME in code so info about it 
won't be lost. It's not documented anywhere which protocol handles which 
options. I will send a patch.


Jacek


From jacek at codeweavers.com  Fri Jun  6 13:25:57 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Fri, 06 Jun 2008 20:25:57 +0200
Subject: urlmon: Fix a few failing tests in win2k3
In-Reply-To: <22821af30805311910h72da8eejd1d2d19b04ebe609@mail.gmail.com>
References: <22821af30805311910h72da8eejd1d2d19b04ebe609@mail.gmail.com>
Message-ID: <48498135.3060604@codeweavers.com>

James Hawkins wrote:
> Hi,
>
> Changelog:
> * Fix a few failing tests in win2k3. 

You've fixed tests on IE7, not only win2k3. It would be better to change 
Wine to behave like IE7. Also your patch lefts some variables in wrong 
state. I will send patches to fix it.


Jacek


From gerald at pfeifer.com  Fri Jun  6 12:26:53 2008
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Fri, 6 Jun 2008 19:26:53 +0200 (CEST)
Subject: Remove unused variable in dlls/mlang/tests/mlang.c
In-Reply-To: <22821af30806051035o1749e491s4e34dd1a4c505616@mail.gmail.com>
References: <alpine.LSU.1.10.0806051717510.6827@acrux.dbai.tuwien.ac.at>
	<22821af30806051035o1749e491s4e34dd1a4c505616@mail.gmail.com>
Message-ID: <alpine.LSU.1.10.0806061926380.6827@acrux.dbai.tuwien.ac.at>

On Thu, 5 Jun 2008, James Hawkins wrote:
> http://winehq.org/pipermail/wine-cvs/2008-June/044013.html

I'm getting old and slow, I guess. :-/

Gerald


From paul.vriens.wine at gmail.com  Fri Jun  6 13:54:36 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 06 Jun 2008 20:54:36 +0200
Subject: mshtml: Added FIXME about QUERY_USES_HISTORYFOLDER in about
	protocol.
In-Reply-To: <48497D69.6010104@codeweavers.com>
References: <48497D69.6010104@codeweavers.com>
Message-ID: <484987EC.4000709@gmail.com>

Jacek Caban wrote:
> ---
>  dlls/mshtml/protocol.c |    2 ++
>  1 files changed, 2 insertions(+), 0 deletions(-)
> 
> 
> ------------------------------------------------------------------------
> 
> 

Hi Jacek,


          return E_NOTIMPL;
+    case QUERY_USES_HISTORYFOLDER:
+        FIXME("Unsupported option QUERY_USES_HISTORYFOLDER\n");
      default:
          return E_FAIL;
      }

shouldn't there be a "return E_NOTIMPL" after the FIXME as we do with the others?

-- 
Cheers,

Paul.


From truiken at gmail.com  Fri Jun  6 13:54:38 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 6 Jun 2008 13:54:38 -0500
Subject: urlmon: Fix a few failing tests in win2k3
In-Reply-To: <48498135.3060604@codeweavers.com>
References: <22821af30805311910h72da8eejd1d2d19b04ebe609@mail.gmail.com>
	<48498135.3060604@codeweavers.com>
Message-ID: <22821af30806061154q285a9359gf2621fe9b62d6dfa@mail.gmail.com>

On Fri, Jun 6, 2008 at 1:25 PM, Jacek Caban <jacek at codeweavers.com> wrote:
> James Hawkins wrote:
>> Hi,
>>
>> Changelog:
>> * Fix a few failing tests in win2k3.
>
> You've fixed tests on IE7, not only win2k3. It would be better to change
> Wine to behave like IE7. Also your patch lefts some variables in wrong
> state. I will send patches to fix it.
>

Can you take a look at the urlmon:url tests as well?  I sent in a
patch for one of the failures recently, but failed to see that it
makes the tests crash in wine.

http://test.winehq.org/data/b483b680136944bdb59be89c27960906278c52b2/2003_jh-win2k3-vm/urlmon:url.txt

Thanks,
James Hawkins


From jacek at codeweavers.com  Fri Jun  6 13:53:39 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Fri, 06 Jun 2008 20:53:39 +0200
Subject: mshtml: Added FIXME about QUERY_USES_HISTORYFOLDER in about
	protocol.
In-Reply-To: <484987EC.4000709@gmail.com>
References: <48497D69.6010104@codeweavers.com> <484987EC.4000709@gmail.com>
Message-ID: <484987B3.5030903@codeweavers.com>

Hi Paul,

Paul Vriens wrote:
> Hi Jacek,
>
>
>          return E_NOTIMPL;
> +    case QUERY_USES_HISTORYFOLDER:
> +        FIXME("Unsupported option QUERY_USES_HISTORYFOLDER\n");
>      default:
>          return E_FAIL;
>      }
>
> shouldn't there be a "return E_NOTIMPL" after the FIXME as we do with 
> the others?

It doesn't really matter IMO, so I've made the patch no-op. This way 
Wine will behave like IE6 until we will have proper IE7 implementation.


Jacek


From jacek at codeweavers.com  Fri Jun  6 14:08:52 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Fri, 06 Jun 2008 21:08:52 +0200
Subject: urlmon: Fix a few failing tests in win2k3
In-Reply-To: <22821af30806061154q285a9359gf2621fe9b62d6dfa@mail.gmail.com>
References: <22821af30805311910h72da8eejd1d2d19b04ebe609@mail.gmail.com>	
	<48498135.3060604@codeweavers.com>
	<22821af30806061154q285a9359gf2621fe9b62d6dfa@mail.gmail.com>
Message-ID: <48498B44.4010603@codeweavers.com>

James Hawkins wrote:
> On Fri, Jun 6, 2008 at 1:25 PM, Jacek Caban <jacek at codeweavers.com> wrote:
>   
>> James Hawkins wrote:
>>     
>>> Hi,
>>>
>>> Changelog:
>>> * Fix a few failing tests in win2k3.
>>>       
>> You've fixed tests on IE7, not only win2k3. It would be better to change
>> Wine to behave like IE7. Also your patch lefts some variables in wrong
>> state. I will send patches to fix it.
>>
>>     
>
> Can you take a look at the urlmon:url tests as well?  I sent in a
> patch for one of the failures recently, but failed to see that it
> makes the tests crash in wine.
>
> http://test.winehq.org/data/b483b680136944bdb59be89c27960906278c52b2/2003_jh-win2k3-vm/urlmon:url.txt
>   

The way you tried to fix it looks good, but it has a serious problem:

>      }else todo_wine {
>          ok(IMoniker_Release(mon) == 0, "mon should be destroyed here\n");
> -        ok(IBindCtx_Release(bctx) == 0, "bctx should be destroyed here\n");
> +
> +        if(bindf & BINDF_ASYNCHRONOUS) {
> +            ok(IBindCtx_Release(bctx) == 1, "bctx should not be destroyed here\n");

It would be better to check if ref count is not 0 IMO.

> +            IBindCtx_Release(bctx); /* actually destroy it */


You can't do it! The remaining reference is not owned by us so we can't do anything with it (unless it's a leak on tests, but it's probably not). I guess urlmon will release this object after completing some async operations.

> +        }
> +        else
> +            ok(IBindCtx_Release(bctx) == 0, "bctx should be destroyed here\n");
>      }



Jacek


From truiken at gmail.com  Fri Jun  6 14:16:49 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 6 Jun 2008 14:16:49 -0500
Subject: urlmon: Fix a few failing tests in win2k3
In-Reply-To: <48498B44.4010603@codeweavers.com>
References: <22821af30805311910h72da8eejd1d2d19b04ebe609@mail.gmail.com>
	<48498135.3060604@codeweavers.com>
	<22821af30806061154q285a9359gf2621fe9b62d6dfa@mail.gmail.com>
	<48498B44.4010603@codeweavers.com>
Message-ID: <22821af30806061216p2508f88aic51603dae9fae302@mail.gmail.com>

On Fri, Jun 6, 2008 at 2:08 PM, Jacek Caban <jacek at codeweavers.com> wrote:
> James Hawkins wrote:
>>
>> On Fri, Jun 6, 2008 at 1:25 PM, Jacek Caban <jacek at codeweavers.com> wrote:
>>
>>>
>>> James Hawkins wrote:
>>>
>>>>
>>>> Hi,
>>>>
>>>> Changelog:
>>>> * Fix a few failing tests in win2k3.
>>>>
>>>
>>> You've fixed tests on IE7, not only win2k3. It would be better to change
>>> Wine to behave like IE7. Also your patch lefts some variables in wrong
>>> state. I will send patches to fix it.
>>>
>>>
>>
>> Can you take a look at the urlmon:url tests as well?  I sent in a
>> patch for one of the failures recently, but failed to see that it
>> makes the tests crash in wine.
>>
>>
>> http://test.winehq.org/data/b483b680136944bdb59be89c27960906278c52b2/2003_jh-win2k3-vm/urlmon:url.txt
>>
>
> The way you tried to fix it looks good, but it has a serious problem:
>
>>     }else todo_wine {
>>         ok(IMoniker_Release(mon) == 0, "mon should be destroyed here\n");
>> -        ok(IBindCtx_Release(bctx) == 0, "bctx should be destroyed
>> here\n");
>> +
>> +        if(bindf & BINDF_ASYNCHRONOUS) {
>> +            ok(IBindCtx_Release(bctx) == 1, "bctx should not be destroyed
>> here\n");
>
> It would be better to check if ref count is not 0 IMO.
>
>> +            IBindCtx_Release(bctx); /* actually destroy it */
>
>
> You can't do it! The remaining reference is not owned by us so we can't do
> anything with it (unless it's a leak on tests, but it's probably not). I
> guess urlmon will release this object after completing some async
> operations.
>
>> +        }
>> +        else
>> +            ok(IBindCtx_Release(bctx) == 0, "bctx should be destroyed
>> here\n");
>>     }
>

Do you want to send a better patch or should I resend?  There are some
other failures as well that I think you would know how to fix more
correctly.

-- 
James Hawkins


From jacek at codeweavers.com  Fri Jun  6 14:21:42 2008
From: jacek at codeweavers.com (Jacek Caban)
Date: Fri, 06 Jun 2008 21:21:42 +0200
Subject: urlmon: Fix a few failing tests in win2k3
In-Reply-To: <22821af30806061216p2508f88aic51603dae9fae302@mail.gmail.com>
References: <22821af30805311910h72da8eejd1d2d19b04ebe609@mail.gmail.com>	
	<48498135.3060604@codeweavers.com>	
	<22821af30806061154q285a9359gf2621fe9b62d6dfa@mail.gmail.com>	
	<48498B44.4010603@codeweavers.com>
	<22821af30806061216p2508f88aic51603dae9fae302@mail.gmail.com>
Message-ID: <48498E46.7020902@codeweavers.com>

James Hawkins wrote:
> Do you want to send a better patch or should I resend?

Please resend it.

> There are some other failures as well that I think you would know how to fix more correctly.
>   

Most failures are due to differences between IE6 and IE7. I occasionally 
fix them and change Wine to follow changes in IE. I will try to spend 
some time on tests soon.


Jacek


From frans.kool at gmail.com  Fri Jun  6 17:05:55 2008
From: frans.kool at gmail.com (Frans Kool)
Date: Sat, 7 Jun 2008 00:05:55 +0200
Subject: French translation only partial?
Message-ID: <30cea9c60806061505te604199ta561fc6e65d70f63@mail.gmail.com>

Hi,

I just had a look at the French translation of the
dlls/kernel32/nls/winerr_fra.mc file.
I noticed only the first 54 messages have been translated, whereas the other
1876 are still the English originals.

Was this on purpose? Or was this a partial translation which needs to be
finalized (the remaining 97.2%)?
I'm all for translating Wine in as many languages as possible, but I doubt this
is the way to get there. Is there some way to detect if the 'translation' of a
message is identical to the original (English) one and have it show up as
'partially translated' in the translation overview [1]?

As a side note, is there any review on translations or is the policy "any
translation is better than no translation"? When Wine 1.0 is going to be
released, how can we be sure that the application is actually
completely translated.
For example, if I really wanted to harm translations, I could make a copy of all
English resource files, just change the 'LANGUAGE LANG_ENGLISH, SUBLANG_DEFAULT'
to whatever language I would like to 'translate' and submit them.
As far as I know, there is no way of detecting this.

Anyone got ideas?

Frans.

[1] http://pf128.krakow.sdi.tpnet.pl/wine-transl/index.php


From stefandoesinger at gmx.at  Fri Jun  6 18:29:35 2008
From: stefandoesinger at gmx.at (=?windows-1252?Q?Stefan_D=F6singer?=)
Date: Sat, 7 Jun 2008 01:29:35 +0200
Subject: d3d8: Fix the null condition in ApplyStateBlock
In-Reply-To: <5f9140a20806061542o1901c29aydc37355c6ddb5709@mail.gmail.com>
References: <5f9140a20806061542o1901c29aydc37355c6ddb5709@mail.gmail.com>
Message-ID: <000d01c8c82d$2eea9c30$8cbfd490$@at>

What would be interesting to know is which effect this has on the states,
but not in this patch I'd say, and not before the 1.0 release. In the long
run it might be an idea to port the d3d9:stateblock test to d3d8 and see how
d3d8 behaves




From dmitry at codeweavers.com  Fri Jun  6 21:47:39 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 7 Jun 2008 11:47:39 +0900
Subject: mshtml: Added FIXME about QUERY_USES_HISTORYFOLDER in
	aboutprotocol.
References: <48497D69.6010104@codeweavers.com> <484987EC.4000709@gmail.com>
	<484987B3.5030903@codeweavers.com>
Message-ID: <C5DB87BB5D2A498E9661C05CD5BC9B35@DMITRY>

"Jacek Caban" <jacek at codeweavers.com> wrote:

>>          return E_NOTIMPL;
>> +    case QUERY_USES_HISTORYFOLDER:
>> +        FIXME("Unsupported option QUERY_USES_HISTORYFOLDER\n");
>>      default:
>>          return E_FAIL;
>>      }
>>
>> shouldn't there be a "return E_NOTIMPL" after the FIXME as we do with 
>> the others?
> 
> It doesn't really matter IMO, so I've made the patch no-op. This way 
> Wine will behave like IE6 until we will have proper IE7 implementation.

Then please add the explicit /* fall through */ comment indicating that
the behaviour is intentional, and not just an oversight.

-- 
Dmitry.


From patrol at sinus.cz  Sat Jun  7 03:25:39 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Sat, 7 Jun 2008 10:25:39 +0200
Subject: Regression in winebrowser found and identified
Message-ID: <20080607082539.GA13316@tangens.sinus.cz>

Hi!
  Today we've found that winebrowser gets invalid URL consisting of many
question marks instead of correct URL, in at least two cases:
  1) Attempt to buy a game in Steam (yes, we are regularly doing that)
  2) Trying to buy a program called CPT-Master from 3am systems, free demo
which shows the problem when "Buy now" button is pressed in its welcome
screen, can be downloaded at
http://www.3amsystems.com/products/CPT-Master.exe

The following commit has been identified as making the regression:

e547cf7043e36fecfe5e23d1d6f93a9c5ba89c46 is first bad commit
commit e547cf7043e36fecfe5e23d1d6f93a9c5ba89c46
Author: Hans Leidekker <hans at it.vu.nl>
Date:   Sun Apr 6 14:44:31 2008 +0200

    winebrowser: Convert to Unicode.

:040000 040000 4f3a034b18392677fc0dfd1ed6df7fefe843a10e 0ab8603a13e836a0b91dd2f146df8da59f7e79e4 M      programs

It really looks related to the problem which I'm reporting :-).
BTW, my system is NOT running in Unicode. Maybe is it related ? I hope it is
not yet mandatory. I'm using iso-8859-2 encoding, which works much better
in my normal working environment.

Please do your best to fix it before 1.0, I feel it really bad and I think
that many programs may be affected by it.

Should I submit a bug too ?

With regards, Pavel Troller


From jonathan at ernstfamily.ch  Sat Jun  7 03:48:01 2008
From: jonathan at ernstfamily.ch (Jonathan Ernst)
Date: Sat, 07 Jun 2008 10:48:01 +0200
Subject: French translation only partial?
In-Reply-To: <30cea9c60806061505te604199ta561fc6e65d70f63@mail.gmail.com>
References: <30cea9c60806061505te604199ta561fc6e65d70f63@mail.gmail.com>
Message-ID: <1212828481.6624.21.camel@jernst-desktop>

Hello,

Le samedi 07 juin 2008 ? 00:05 +0200, Frans Kool a ?crit :
[...]
> I just had a look at the French translation of the
> dlls/kernel32/nls/winerr_fra.mc file.
> I noticed only the first 54 messages have been translated, whereas the other
> 1876 are still the English originals.

Translations in Wine must be in sync for every languages (i.e. unlike
other projects that use msgfmt/.po/.mo files, if Wine translations miss
some ressources they won't appear at all). The case you are reporting
might be different though.

I have sent a patch for some more strings. I won't have time to finish
this file by the time Wine 1.0 is out. Please feel free to finish this
translation.

> Was this on purpose? Or was this a partial translation which needs to be
> finalized (the remaining 97.2%)?

The purpose was that the file stays in sync with its English
counterpart. I haven't put too much effort myself in this file as the
strings it contains are rarely visible to end users.
 
> I'm all for translating Wine in as many languages as possible, but I doubt this
> is the way to get there. Is there some way to detect if the 'translation' of a
> message is identical to the original (English) one and have it show up as
> 'partially translated' in the translation overview [1]?

This is not supported yet by Miko?aj tool. So that the files have to be
checked manually, see the last paragraph of
http://wiki.winehq.org/Translating

> 
> As a side note, is there any review on translations or is the policy "any
> translation is better than no translation"? When Wine 1.0 is going to be

The patches are publicly available, if anyone contests the quality of
one patch, it can be discussed on the mailing list. 

> released, how can we be sure that the application is actually
> completely translated.

You have to check manually.

> For example, if I really wanted to harm translations, I could make a copy of all
> English resource files, just change the 'LANGUAGE LANG_ENGLISH, SUBLANG_DEFAULT'
> to whatever language I would like to 'translate' and submit them.
> As far as I know, there is no way of detecting this.

Alexandre wouldn't commit such a patch I guess.

Best regards.

Jonathan



From jonathan at ernstfamily.ch  Sat Jun  7 03:48:20 2008
From: jonathan at ernstfamily.ch (Jonathan Ernst)
Date: Sat, 07 Jun 2008 10:48:20 +0200
Subject: French translation only partial?
In-Reply-To: <30cea9c60806061505te604199ta561fc6e65d70f63@mail.gmail.com>
References: <30cea9c60806061505te604199ta561fc6e65d70f63@mail.gmail.com>
Message-ID: <1212828481.6624.21.camel@jernst-desktop>

Hello,

Le samedi 07 juin 2008 ? 00:05 +0200, Frans Kool a ?crit :
[...]
> I just had a look at the French translation of the
> dlls/kernel32/nls/winerr_fra.mc file.
> I noticed only the first 54 messages have been translated, whereas the other
> 1876 are still the English originals.

Translations in Wine must be in sync for every languages (i.e. unlike
other projects that use msgfmt/.po/.mo files, if Wine translations miss
some ressources they won't appear at all). The case you are reporting
might be different though.

I have sent a patch for some more strings. I won't have time to finish
this file by the time Wine 1.0 is out. Please feel free to finish this
translation.

> Was this on purpose? Or was this a partial translation which needs to be
> finalized (the remaining 97.2%)?

The purpose was that the file stays in sync with its English
counterpart. I haven't put too much effort myself in this file as the
strings it contains are rarely visible to end users.
 
> I'm all for translating Wine in as many languages as possible, but I doubt this
> is the way to get there. Is there some way to detect if the 'translation' of a
> message is identical to the original (English) one and have it show up as
> 'partially translated' in the translation overview [1]?

This is not supported yet by Miko?aj tool. So that the files have to be
checked manually, see the last paragraph of
http://wiki.winehq.org/Translating

> 
> As a side note, is there any review on translations or is the policy "any
> translation is better than no translation"? When Wine 1.0 is going to be

The patches are publicly available, if anyone contests the quality of
one patch, it can be discussed on the mailing list. 

> released, how can we be sure that the application is actually
> completely translated.

You have to check manually.

> For example, if I really wanted to harm translations, I could make a copy of all
> English resource files, just change the 'LANGUAGE LANG_ENGLISH, SUBLANG_DEFAULT'
> to whatever language I would like to 'translate' and submit them.
> As far as I know, there is no way of detecting this.

Alexandre wouldn't commit such a patch I guess.

Best regards.

Jonathan




From laurent at vromman.org  Sat Jun  7 03:53:26 2008
From: laurent at vromman.org (Laurent Vromman)
Date: Sat, 07 Jun 2008 10:53:26 +0200
Subject: kernel: updated French translation
In-Reply-To: <1212827904.6624.9.camel@jernst-desktop>
References: <1212827904.6624.9.camel@jernst-desktop>
Message-ID: <484A4C86.7070109@vromman.org>

There are a few mistakes in your translations :

The right translation for "Overflow" is "D?passement", not "D?pacement"

You often use the word "Mauvais" as a translation for "Bad". Sometimes, 
it could be better not to translate literally. For example, I think 
"Niveau de pilote incorrect" is a better translation for "Bad driver 
level" than "Mauvais niveau de pilote". You should try to avoid 
"Mauvais" anytime you can.

Last thing : I'm not sure "S?maphore" is a female word in french : 
http://fr.wikipedia.org/wiki/S%C3%A9maphore_(informatique)

Laurent

Jonathan Ernst wrote:
> ------------------------------------------------------------------------
>
>
>   



From laurent at vromman.org  Sat Jun  7 03:57:28 2008
From: laurent at vromman.org (Laurent Vromman)
Date: Sat, 07 Jun 2008 10:57:28 +0200
Subject: notepad: updated French translation
In-Reply-To: <1212754712.6582.62.camel@jernst-desktop>
References: <1212754712.6582.62.camel@jernst-desktop>
Message-ID: <484A4D78.5000403@vromman.org>

Hi,

I don't know if it is important since the translation is grammatically 
correct, but in windows (I checked on XP SP2), the exact translation is

"? &propos du Bloc-notes..." and not "? &propos de Bloc-notes..."

Laurent

Jonathan Ernst wrote:
> ------------------------------------------------------------------------
>
>
>   



From kornelpal at gmail.com  Sat Jun  7 04:17:26 2008
From: kornelpal at gmail.com (=?ISO-8859-1?Q?Korn=E9l_P=E1l?=)
Date: Sat, 07 Jun 2008 11:17:26 +0200
Subject: kernel: updated French translation
In-Reply-To: <484A4C86.7070109@vromman.org>
References: <1212827904.6624.9.camel@jernst-desktop>
	<484A4C86.7070109@vromman.org>
Message-ID: <484A5226.8020003@gmail.com>


Hi,

Laurent Vromman wrote:
> You often use the word "Mauvais" as a translation for "Bad". Sometimes, 
> it could be better not to translate literally. For example, I think 
> "Niveau de pilote incorrect" is a better translation for "Bad driver 
> level" than "Mauvais niveau de pilote". You should try to avoid 
> "Mauvais" anytime you can.

I think that using "bad" should be avoided in English texts as well and 
the original English version should also be improved not just the French 
one.

Korn?l


From hans at it.vu.nl  Sat Jun  7 04:26:12 2008
From: hans at it.vu.nl (Hans Leidekker)
Date: Sat, 7 Jun 2008 11:26:12 +0200
Subject: Regression in winebrowser found and identified
In-Reply-To: <20080607082539.GA13316@tangens.sinus.cz>
References: <20080607082539.GA13316@tangens.sinus.cz>
Message-ID: <200806071126.13132.hans@it.vu.nl>

On Saturday 07 June 2008 10:25:39 Pavel Troller wrote:

> BTW, my system is NOT running in Unicode. Maybe is it related ? I hope it is
> not yet mandatory. I'm using iso-8859-2 encoding, which works much better
> in my normal working environment.

If the URL contains characters outside iso-8859-2 that may be the problem, yes.
Is it fixed when you switch to utf8?

Please file a bug and attach a +winebrowser trace.

 -Hans


From jonathan at ernstfamily.ch  Sat Jun  7 05:13:56 2008
From: jonathan at ernstfamily.ch (Jonathan Ernst)
Date: Sat, 07 Jun 2008 12:13:56 +0200
Subject: notepad: updated French translation
In-Reply-To: <484A4D78.5000403@vromman.org>
References: <1212754712.6582.62.camel@jernst-desktop>
	<484A4D78.5000403@vromman.org>
Message-ID: <1212833636.6624.40.camel@jernst-desktop>

Le samedi 07 juin 2008 ? 10:57 +0200, Laurent Vromman a ?crit :
> Hi,
> 
> I don't know if it is important since the translation is grammatically 
> correct, but in windows (I checked on XP SP2), the exact translation is
> 
> "? &propos du Bloc-notes..." and not "? &propos de Bloc-notes..."

I changed it and removed the extra ellipsis to conform to most HIGs (eg. Gnome's : http://developer.gnome.org/projects/gup/hig/hig-diff/menus-design.html)





From jonathan at ernstfamily.ch  Sat Jun  7 05:12:21 2008
From: jonathan at ernstfamily.ch (Jonathan Ernst)
Date: Sat, 07 Jun 2008 12:12:21 +0200
Subject: kernel: updated French translation
In-Reply-To: <484A4C86.7070109@vromman.org>
References: <1212827904.6624.9.camel@jernst-desktop>
	<484A4C86.7070109@vromman.org>
Message-ID: <1212833541.6624.37.camel@jernst-desktop>

Hello, 

Please use "reply to all" when replying to this mailing list messages.

Le samedi 07 juin 2008 ? 10:53 +0200, Laurent Vromman a ?crit :
> There are a few mistakes in your translations :
> 
> The right translation for "Overflow" is "D?passement", not "D?pacement"

Thanks for catching this, I must have been tired this morning.

> 
> You often use the word "Mauvais" as a translation for "Bad". Sometimes, 
> it could be better not to translate literally. For example, I think 
> "Niveau de pilote incorrect" is a better translation for "Bad driver 
> level" than "Mauvais niveau de pilote". You should try to avoid 
> "Mauvais" anytime you can.

Fixed in the new patch.

> 
> Last thing : I'm not sure "S?maphore" is a female word in french : 
> http://fr.wikipedia.org/wiki/S%C3%A9maphore_(informatique)

Fixed too, thanks.

Regards.



From jonathan at ernstfamily.ch  Sat Jun  7 05:12:23 2008
From: jonathan at ernstfamily.ch (Jonathan Ernst)
Date: Sat, 07 Jun 2008 12:12:23 +0200
Subject: kernel: updated French translation
In-Reply-To: <484A4C86.7070109@vromman.org>
References: <1212827904.6624.9.camel@jernst-desktop>
	<484A4C86.7070109@vromman.org>
Message-ID: <1212833541.6624.37.camel@jernst-desktop>

Hello, 

Please use "reply to all" when replying to this mailing list messages.

Le samedi 07 juin 2008 ? 10:53 +0200, Laurent Vromman a ?crit :
> There are a few mistakes in your translations :
> 
> The right translation for "Overflow" is "D?passement", not "D?pacement"

Thanks for catching this, I must have been tired this morning.

> 
> You often use the word "Mauvais" as a translation for "Bad". Sometimes, 
> it could be better not to translate literally. For example, I think 
> "Niveau de pilote incorrect" is a better translation for "Bad driver 
> level" than "Mauvais niveau de pilote". You should try to avoid 
> "Mauvais" anytime you can.

Fixed in the new patch.

> 
> Last thing : I'm not sure "S?maphore" is a female word in french : 
> http://fr.wikipedia.org/wiki/S%C3%A9maphore_(informatique)

Fixed too, thanks.

Regards.




From jon_p_griffiths at yahoo.com  Fri Jun  6 22:22:34 2008
From: jon_p_griffiths at yahoo.com (Jon Griffiths)
Date: Fri, 6 Jun 2008 20:22:34 -0700 (PDT)
Subject: [PATCH] GetUrlCacheEntryInfo*: Handle null dest pointer when
	length is given
In-Reply-To: <1096648c0806060503x4ddc0810la870008a70bfcf80@mail.gmail.com>
Message-ID: <77583.25036.qm@web56614.mail.re3.yahoo.com>

> Internal functions should return an error code instead of
> calling SetLastError.

Perhaps in a general sense, but URLCache_CopyEntry already did
SetLastError(ERROR_INSUFFICIENT_BUFFER): setting it there means the
4 places that call it don't need to ^ the logic to set the 2
different errors themselves.

^ "repeat" is probably the word I was looking for there :-)




      


From laurent at vromman.org  Sat Jun  7 05:28:19 2008
From: laurent at vromman.org (Laurent Vromman)
Date: Sat, 07 Jun 2008 12:28:19 +0200
Subject: kernel: updated French translation
In-Reply-To: <1212833397.6624.32.camel@jernst-desktop>
References: <1212833397.6624.32.camel@jernst-desktop>
Message-ID: <484A62C3.5060900@vromman.org>

Hi,

There is a mistake here :
"L'acqu?reur de le s?maphore est mort"

The right translation is :
"L'acqu?reur du s?maphore est mort"

The translation of "broken pipe" is not good too, but I can't find 
anything better on the internet.
You should maybe try something like "Tube indisponible (broken pipe)", 
if you think it is better.

Laurent

Jonathan Ernst wrote:
> ------------------------------------------------------------------------
>
>
>   



From jonathan at ernstfamily.ch  Sat Jun  7 05:38:06 2008
From: jonathan at ernstfamily.ch (Jonathan Ernst)
Date: Sat, 07 Jun 2008 12:38:06 +0200
Subject: kernel: updated French translation
In-Reply-To: <484A62C3.5060900@vromman.org>
References: <1212833397.6624.32.camel@jernst-desktop>
	<484A62C3.5060900@vromman.org>
Message-ID: <1212835086.6624.42.camel@jernst-desktop>

Hi again.


Le samedi 07 juin 2008 ? 12:28 +0200, Laurent Vromman a ?crit :
> 
> There is a mistake here :
> "L'acqu?reur de le s?maphore est mort"

Woops.

> 
> The translation of "broken pipe" is not good too, but I can't find 
> anything better on the internet.
> You should maybe try something like "Tube indisponible (broken pipe)", 
> if you think it is better.

http://glossaire.traduc.org/index.php?s=broken pipe

Sun's glossary says "tube interrompu", I'll use that.




From jonathan at ernstfamily.ch  Sat Jun  7 05:38:07 2008
From: jonathan at ernstfamily.ch (Jonathan Ernst)
Date: Sat, 07 Jun 2008 12:38:07 +0200
Subject: kernel: updated French translation
In-Reply-To: <484A62C3.5060900@vromman.org>
References: <1212833397.6624.32.camel@jernst-desktop>
	<484A62C3.5060900@vromman.org>
Message-ID: <1212835086.6624.42.camel@jernst-desktop>

Hi again.


Le samedi 07 juin 2008 ? 12:28 +0200, Laurent Vromman a ?crit :
> 
> There is a mistake here :
> "L'acqu?reur de le s?maphore est mort"

Woops.

> 
> The translation of "broken pipe" is not good too, but I can't find 
> anything better on the internet.
> You should maybe try something like "Tube indisponible (broken pipe)", 
> if you think it is better.

http://glossaire.traduc.org/index.php?s=broken pipe

Sun's glossary says "tube interrompu", I'll use that.





From patrol at sinus.cz  Sat Jun  7 06:07:30 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Sat, 7 Jun 2008 13:07:30 +0200
Subject: Regression in winebrowser found and identified
In-Reply-To: <200806071126.13132.hans@it.vu.nl>
References: <20080607082539.GA13316@tangens.sinus.cz>
	<200806071126.13132.hans@it.vu.nl>
Message-ID: <20080607110730.GA14437@tangens.sinus.cz>

> On Saturday 07 June 2008 10:25:39 Pavel Troller wrote:
> 
> > BTW, my system is NOT running in Unicode. Maybe is it related ? I hope it is
> > not yet mandatory. I'm using iso-8859-2 encoding, which works much better
> > in my normal working environment.
> 
> If the URL contains characters outside iso-8859-2 that may be the problem, yes.
> Is it fixed when you switch to utf8?

Hi!
  1) The URLs don't contain any special characters. They even don't need 8859-2,
US-ASCII should be enough for them :-).
  2) Switching to utf-8 caused that chinese characters and placeholders
(boxes with hex value of the character) were displayed instead of question
marks, and it didn't work either, of course.
> 
> Please file a bug and attach a +winebrowser trace.

Done. There are two traces, one with default setting and the other with
LC_ALL=cs_CZ.UTF-8.

> 
>  -Hans
> 

With regards, Pavel Troller


From kgbricola at web.de  Sat Jun  7 06:37:27 2008
From: kgbricola at web.de (Rico)
Date: Sat, 07 Jun 2008 13:37:27 +0200
Subject: Valgrind and COD4
Message-ID: <484A72F7.4080302@web.de>

Hi,

I'd like to run valgrind + wine + cod4. But there is a problem: The 
preloader problem. When I run valgrind --trace-children=yes 
~/Desktop/wine/native/wine iw3sp.exe, I got the preloader problem. When 
I run  ~/Desktop/wine/native/wine iw3sp.exe there is no preloader 
problem. Any hints on this? (The same applies for valgrind+wine+notepad.)

Attached is the output from the valgrind run.

Cheers
Rico



-------------- next part --------------
A non-text attachment was scrubbed...
Name: valgrind.log
Type: text/x-log
Size: 23594 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080607/cc6be33d/attachment-0001.bin 

From jjmckenzie51 at sprintpcs.com  Sat Jun  7 10:28:14 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 07 Jun 2008 08:28:14 -0700
Subject: kernel: updated French translation
In-Reply-To: <484A5226.8020003@gmail.com>
References: <1212827904.6624.9.camel@jernst-desktop>
	<484A4C86.7070109@vromman.org> <484A5226.8020003@gmail.com>
Message-ID: <484AA90E.4050202@sprintpcs.com>

Korn?l P?l wrote:
> Hi,
>
> Laurent Vromman wrote:
>   
>> You often use the word "Mauvais" as a translation for "Bad". Sometimes, 
>> it could be better not to translate literally. For example, I think 
>> "Niveau de pilote incorrect" is a better translation for "Bad driver 
>> level" than "Mauvais niveau de pilote". You should try to avoid 
>> "Mauvais" anytime you can.
>>     
>
> I think that using "bad" should be avoided in English texts as well and 
> the original English version should also be improved not just the French 
> one.
>   
Korn?l:

I agree with this.  The word in English 'bad' has many meanings.  
Improper, poor, broken are better words:

An improper response was received.
The program functions poorly.
The pipe is broken.  The program breaks (a form of broken) when you 
attempt to do that.  (Better than it is a bad program.)

The 'bad program driver level' could be replaced with 'Please install a 
driver with the appropriate level.  Your driver level is: xx.xx.xx'
It is a little wordy but gets the point across.

James McKenzie




From dank at kegel.com  Sat Jun  7 11:00:08 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 7 Jun 2008 09:00:08 -0700
Subject: Valgrind and COD4
Message-ID: <a71bd89a0806070900p7d0879e9x715b74e709474974@mail.gmail.com>

Rico schrieb:
> I'd like to run valgrind + wine + cod4.
> [But when I run valgrind on my game], I got the preloader problem.

That's a known problem, but it's not a serious one.
[Still, John Reiser is working on a fix for it.]

The real problem in your log is this:

Memcheck: mc_main.c:817 (get_sec_vbits8): Assertion 'n' failed.
Memcheck: get_sec_vbits8: no node for address 0x6032050 (0x6032054)

You're using an old version of Valgrind, and wine is blowing its little mind.
Please switch to building Valgrind out of svn; see
http://wiki.winehq.org/Wine_and_Valgrind

Good luck, and let me know how it goes!
- Dan


From kgbricola at web.de  Sat Jun  7 11:23:00 2008
From: kgbricola at web.de (Rico)
Date: Sat, 07 Jun 2008 18:23:00 +0200
Subject: Valgrind and COD4
In-Reply-To: <a71bd89a0806070900p7d0879e9x715b74e709474974@mail.gmail.com>
References: <a71bd89a0806070900p7d0879e9x715b74e709474974@mail.gmail.com>
Message-ID: <484AB5E4.4010806@web.de>

Dan Kegel wrote:
> That's a known problem, but it's not a serious one.
> [Still, John Reiser is working on a fix for it.]
>
> The real problem in your log is this:
>
> Memcheck: mc_main.c:817 (get_sec_vbits8): Assertion 'n' failed.
> Memcheck: get_sec_vbits8: no node for address 0x6032050 (0x6032054)
>
> You're using an old version of Valgrind, and wine is blowing its little mind.
> Please switch to building Valgrind out of svn; see
> http://wiki.winehq.org/Wine_and_Valgrind
>
> Good luck, and let me know how it goes!
> - Dan
>
>   
Oh, my fault. I built it from svn but started the version from the 
distro. With the svn version I'm able to run notepad with wine and 
valgrind. I'll try the game later.

Thanks for the hint.

Cheers
Rico


From shakaran at gmail.com  Sat Jun  7 12:52:18 2008
From: shakaran at gmail.com (=?ISO-8859-1?Q?=C1ngel_Guzm=E1n_Maeso?=)
Date: Sat, 7 Jun 2008 19:52:18 +0200
Subject: Some feedfack for string {\style} on msi
Message-ID: <82b2af8e0806071052n23c17ee2j7b10308bc5993e77@mail.gmail.com>

I am trying to fix the bug 13408 related with ActiveSync, but i need some
information of how and when appear the string {\style} on msi.
I need some specification or url for begin.
Cheers.
-- 
Shakaran
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080607/70217f24/attachment.htm 

From adam at tpetaccia.com  Sat Jun  7 13:01:18 2008
From: adam at tpetaccia.com (Adam Petaccia)
Date: Sat, 07 Jun 2008 14:01:18 -0400
Subject: Time to update Wine's status?
Message-ID: <1212861678.11761.3.camel@belthazor-saved>

http://winehq.org/site/status is the website showing Wine's status on
implementing various DLLs, but it hasn't been updated in almost a year!
The information is not only old, but Wine has added new DLLs that aren't
listed. With Wine approaching its 1.0 release, perhaps it should be
decided to update or remove the page.

My vote would be for updating, but I'm not sure where those stats come
from, and that may take away from time better spent on bug hunting.
-- 
Adam Petaccia <adam at tpetaccia.com>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080607/76e17d5e/attachment.pgp 

From eric.pouech at orange.fr  Sun Jun  8 03:15:46 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Sun, 08 Jun 2008 10:15:46 +0200
Subject: [2/2] gdi32/dib: Fix palette of 1bpp DIB in GetDIBits
In-Reply-To: <1212882549.4470.24.camel@hermes2.karcher.local>
References: <1212882549.4470.24.camel@hermes2.karcher.local>
Message-ID: <484B9532.8010402@orange.fr>

Michael Karcher a ?crit :
> Windows always generates a black/white palette for 1 bit DIBs
> generated from DDBs. Copying from the current palette only takes
> place for color DDBs (not explicitly mentioned in MSDN), and only
> if depth equal (MSDN states it, explicitly).
> ---
> As mentioned in [1/2], this series is intended to fix #6519, but a
> third patch is needed additionally to these two patches. The patch
> by Eric in the buglog does that job, but I think there is an "more
> obviously correct" solution to it. I let Eric submit a patch if he
> wants, as he tracked down the problem. If he tells me to go on, I
> will submit my version myself instead.
>   
I didn't retest after your two patches, but basically what my patch does is:
- ensure we convert non black pixels (from DIB) into white pixels (in 
monochrome bitmap) in all cases
- zero out the end of lines (after last pixel up to next dword aligned bit)

this bug (and the mentionned 3 patches) are IMO good candidates for 1.0
the last item of this patch is not mandatory here, and can be dropped 
before inclusion to 1.0 (if needed)

regarding this last patch and Michael comment: I'm only concerned with 
having the best fix in wine (who ever wrote it)
so what's your idea about the fix ?
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From paul.vriens.wine at gmail.com  Sun Jun  8 03:58:08 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Sun, 08 Jun 2008 10:58:08 +0200
Subject: kernel/debugger tests and win9x/winme
Message-ID: <484B9F20.4020309@gmail.com>

Hi,

I (once more) had a look at the registry on my win95 box and found :

HKLM\Software\Microsoft\Windows NT\CurrentVersion

This is because we create that key ourselves if it doesn't exist. "Windows NT" 
is of course not present on a (normal) win98/winme box so I was wondering how we 
could change this test.

It appears that win9x uses win.ini for the same purpose.

Should we change the test to:

1. check if "HKLM\Software\Microsoft\Windows NT" exist
2. if it exist do our normal thing
3. if it doesn't use win.ini ?

Or should we check for the "HKLM\Software\Microsoft\Windows NT" key and if 
doesn't exist skip all tests ? (We do have these keys lingering around after our 
winetest though).

-- 
Cheers,

Paul.


From xerox_xerox2000 at yahoo.co.uk  Sun Jun  8 04:30:25 2008
From: xerox_xerox2000 at yahoo.co.uk (Louis Lenders)
Date: Sun, 8 Jun 2008 09:30:25 +0000 (UTC)
Subject: AutoCad and wine
Message-ID: <loom.20080608T085835-255@post.gmane.org>

This seems to be a must have for many people. Would be nice if we could have
this running in near futurfe.
I found that you can download a few old trialversions from
http://www.brothersoft.com/autocad-download-78215.html
(this is autocad2006l on the right side you can see the downloadlinks for
2004/2007/2008 as well)

I'm currently testing AutoCAD 2004 and with a bit workarounds/tweaking it seems
to run but the main issues seem to be with the installer; I'll add some info to
the appdb; i'll test other versions lateron; if someone wants to join testing
feel welcom ;)



From wine at mkarcher.dialup.fu-berlin.de  Sun Jun  8 05:45:40 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Sun, 08 Jun 2008 12:45:40 +0200
Subject: [2/2] gdi32/dib: Fix palette of 1bpp DIB in GetDIBits
In-Reply-To: <484B9532.8010402@orange.fr>
References: <1212882549.4470.24.camel@hermes2.karcher.local>
	<484B9532.8010402@orange.fr>
Message-ID: <1212921940.4470.31.camel@hermes2.karcher.local>

Am Sonntag, den 08.06.2008, 10:15 +0200 schrieb Eric Pouech:
> > obviously correct" solution to it. I let Eric submit a patch if he
> > wants, as he tracked down the problem. If he tells me to go on, I
> > will submit my version myself instead.
> >   
> I didn't retest after your two patches, but basically what my patch does is:
> - ensure we convert non black pixels (from DIB) into white pixels (in 
> monochrome bitmap) in all cases
You probably mean non-black pixels (from DDB), as the XImage we are
getting the pixels from is a DDB, not a DIB. My suggestion to the fix
is, to attach the right color table to the DDB in the first place. 1-bit
monochrome DDBs seem to be black/white in windows. This is what my patch
does (attached), I also sent it to you by private mail.

> - zero out the end of lines (after last pixel up to next dword aligned bit)
I skipped this part, as you also suggest. There is no test currently
that tests for this behaviour, and it is not needed to fix Easy Grade
Pro. This should be a seperate patch, if needed.

> regarding this last patch and Michael comment: I'm only concerned with 
> having the best fix in wine (who ever wrote it)
> so what's your idea about the fix ?
See the attachment. That's the message ready to go to wine-patches.

Regards,
  Michael Karcher
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0003-winex11-dib-Fix-GetDIBits-of-1-bit-DDBs.patch
Type: application/mbox
Size: 0 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080608/cf75a97a/attachment.bin 

From wine at mkarcher.dialup.fu-berlin.de  Sat Jun  7 18:26:59 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Sun, 8 Jun 2008 01:26:59 +0200
Subject: winex11/dib: Fix GetDIBits of 1 bit DDBs
Message-ID: <mailman.623.1212921949.3731.wine-devel@winehq.org>

1 bpp DDBs seem to always carry an implicit palette of black and white,
regardless of what the DC says. Based on a patch from Eric Pouech,
available at <http://bugs.winehq.org/attachment.cgi?id=12492>.
---
 dlls/gdi32/tests/bitmap.c |    5 +----
 dlls/winex11.drv/dib.c    |   15 +++++++++++++--
 2 files changed, 14 insertions(+), 6 deletions(-)

diff --git a/dlls/gdi32/tests/bitmap.c b/dlls/gdi32/tests/bitmap.c
index 83bc498..a1c426f 100644
--- a/dlls/gdi32/tests/bitmap.c
+++ b/dlls/gdi32/tests/bitmap.c
@@ -1176,10 +1176,7 @@ static void test_GetDIBits_selected_DIB(UINT bpp)
             break;
         }
     }
-    if (bpp != 1)
-        ok(equalContents, "GetDIBits with %d bpp DIB selected in DC: Invalid DIB bits\n",bpp);
-    else
-        todo_wine ok(equalContents, "GetDIBits with %d bpp DIB selected in DC: Invalid DIB bits\n",bpp);
+    ok(equalContents, "GetDIBits with %d bpp DIB selected in DC: Invalid DIB bits\n",bpp);
 
     HeapFree(GetProcessHeap(), 0, bits2);
     DeleteDC(dc);
diff --git a/dlls/winex11.drv/dib.c b/dlls/winex11.drv/dib.c
index 4b287ea..ee21ad6 100644
--- a/dlls/winex11.drv/dib.c
+++ b/dlls/winex11.drv/dib.c
@@ -4031,13 +4031,24 @@ INT X11DRV_GetDIBits( X11DRV_PDEVICE *physDev, HBITMAP hbitmap, UINT startscan,
   int bitmap_type;
   BOOL core_header;
   void* colorPtr;
-
-  GetPaletteEntries( GetCurrentObject( physDev->hdc, OBJ_PAL ), 0, 256, palette );
+  const PALETTEENTRY peBlack = {0,0,0,0};
+  const PALETTEENTRY peWhite = {255,255,255,0};
 
   if (!physBitmap) return 0;
   if (!(obj_size = GetObjectW( hbitmap, sizeof(dib), &dib ))) return 0;
 
   bitmap_type = DIB_GetBitmapInfo( (BITMAPINFOHEADER*)info, &width, &tempHeight, &descr.infoBpp, &descr.compression);
+
+  if (physDev->depth > 1)
+  {
+    GetPaletteEntries( GetCurrentObject( physDev->hdc, OBJ_PAL ), 0, 256, palette );
+  }
+  else 
+  {
+    palette[0] = peBlack;
+    palette[1] = peWhite;
+  }
+  
   if (bitmap_type == -1)
   {
       ERR("Invalid bitmap\n");
-- 
1.5.5.1


--=-/Kl5kXam3PI3pe5o86hv--



From jan.wine at zerebecki.de  Sun Jun  8 07:09:05 2008
From: jan.wine at zerebecki.de (Jan Zerebecki)
Date: Sun, 8 Jun 2008 14:09:05 +0200
Subject: Bugzilla bugs.winehq.org and it's git out of sync
Message-ID: <20080608120905.GA5616@crissy.swd.zerebecki.de>

The git repository contains version 3.0.4 but bugs.winehq.org
still shows 3.0.2 . Can anyone who has access to it look after
that?

Thanks.


Jan



From kgbricola at web.de  Sun Jun  8 09:07:50 2008
From: kgbricola at web.de (Rico)
Date: Sun, 08 Jun 2008 16:07:50 +0200
Subject: Valgrind and COD4
In-Reply-To: <484AB5E4.4010806@web.de>
References: <a71bd89a0806070900p7d0879e9x715b74e709474974@mail.gmail.com>
	<484AB5E4.4010806@web.de>
Message-ID: <484BE7B6.4060504@web.de>

Hi,

I tried valgrind and wine with COD4 demo but I couldn't get the game 
running. I have to say that "~/Desktop/wine/native/wine iw3sp.exe" let 
run the game. With /usr/local/valgrind-svn/bin/valgrind 
--trace-children=yes ~/Desktop/wine/native/wine iw3sp.exe I got the 
attached log file. I was running both from the same location 
(/home/ricola/.wine/drive_c/Programme/cod4). The next thing is that 
other apps are working well (like CodeBlocks or notepad) with wine and 
valgrind. If I don't set the --trace-children=yes argument the app 
starts fine (but that's not what I like to do, isn't it?).

COD4 isn't the only app which isn't working. It also affects 3Dmark 2001 
and 03.

Any hints about this?

My goal is to check for memory leaks in wine, not in COD4. Because 
several apps crash with out of memory error.

Cheers
Rico
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cod4_valgrind.log
Type: text/x-log
Size: 5201 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080608/e3028756/attachment-0001.bin 

From julliard at winehq.org  Sun Jun  8 09:51:44 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Sun, 08 Jun 2008 16:51:44 +0200
Subject: Bugzilla bugs.winehq.org and it's git out of sync
In-Reply-To: <20080608120905.GA5616@crissy.swd.zerebecki.de> (Jan Zerebecki's
	message of "Sun, 8 Jun 2008 14:09:05 +0200")
References: <20080608120905.GA5616@crissy.swd.zerebecki.de>
Message-ID: <87r6b8getb.fsf@wine.dyndns.org>

Jan Zerebecki <jan.wine at zerebecki.de> writes:

> The git repository contains version 3.0.4 but bugs.winehq.org
> still shows 3.0.2 . Can anyone who has access to it look after
> that?

It should be fixed now.

-- 
Alexandre Julliard
julliard at winehq.org


From ge at gse.nl  Sun Jun  8 10:07:47 2008
From: ge at gse.nl (Ge van Geldorp)
Date: Sun, 8 Jun 2008 17:07:47 +0200
Subject: Some feedfack for string {\style} on msi
In-Reply-To: <mailman.17417.1212934097.3734.wine-devel@winehq.org>
References: <mailman.17417.1212934097.3734.wine-devel@winehq.org>
Message-ID: <5DA9F38458EE4EA28A5BE3E73C3AC6EE@gsep1>

> I am trying to fix the bug 13408 related with ActiveSync, but 
> i need some information of how and when appear the string 
> {\style} on msi.
> I need some specification or url for begin.

Try http://msdn.microsoft.com/en-us/library/aa367524(VS.85).aspx (or search
for "Adding Controls and Text").



From dank at kegel.com  Sun Jun  8 09:56:10 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 8 Jun 2008 07:56:10 -0700
Subject: Valgrind and COD4
In-Reply-To: <a71bd89a0806070900p7d0879e9x715b74e709474974@mail.gmail.com>
References: <a71bd89a0806070900p7d0879e9x715b74e709474974@mail.gmail.com>
Message-ID: <a71bd89a0806080756g46e30216t96f4b8a64219a0ea@mail.gmail.com>

Rico schrieb:
> wine: could not load L"C:\\Programme\\cod4\\iw3sp.exe": Ung?ltige Adresse

Hrmph.  Sounds like maybe John Reiser's fixes might be
needed for this app.

> My goal is to check for memory leaks in wine, not in COD4.
>Because  several apps crash with out of memory error.

OK.  What are the other apps?  And how quickly do they crash?

You might consider fixing memory leaks that show up when
running the wine conformance suite.
- Dan


From spedrosa at gmail.com  Sun Jun  8 13:23:39 2008
From: spedrosa at gmail.com (Stephen Eilert)
Date: Sun, 08 Jun 2008 15:23:39 -0300
Subject: Wine Profiling
Message-ID: <484C23AB.2010608@gmail.com>

Hi,

I'd like to know what's the procedure being used to profile Wine's code. 
More specifically, I want to try to track down slowdowns in some 
applcations, which requires profiling to identify where the bottlenecks are.

Are there any specific procedures or utilities to instrument and 
generate profiling reports?


Stephen


From stefandoesinger at gmx.at  Sun Jun  8 13:42:36 2008
From: stefandoesinger at gmx.at (=?windows-1252?Q?Stefan_D=F6singer?=)
Date: Sun, 8 Jun 2008 20:42:36 +0200
Subject: Wine Profiling
In-Reply-To: <484C23AB.2010608@gmail.com>
References: <484C23AB.2010608@gmail.com>
Message-ID: <001b01c8c997$6c2703c0$44750b40$@at>


> I'd like to know what's the procedure being used to profile Wine's code.
> More specifically, I want to try to track down slowdowns in some
> applcations, which requires profiling to identify where the bottlenecks
> are.
I am using oprofile every now and then to profile Games, but it is only of
limited use. It really depends on the sort of Application you want to
profile, and you should use specific tools for this. If your app mainly
utilizes the CPU, oprofile will be suitable. If it uses 3D graphics, you may
be more happy with things like the NVPerfkit or the MacOS OpenGL profiler(on
osx of course). Disk and Memory functionality may have their own profiler as
well.

The bottom line is that performance and efficiency isn't a linear scale, so
there is no ultimate tool for it.




From shakaran at gmail.com  Sun Jun  8 14:29:16 2008
From: shakaran at gmail.com (=?ISO-8859-1?Q?=C1ngel_Guzm=E1n_Maeso?=)
Date: Sun, 8 Jun 2008 21:29:16 +0200
Subject: Some feedfack for string {\style} on msi
In-Reply-To: <5DA9F38458EE4EA28A5BE3E73C3AC6EE@gsep1>
References: <mailman.17417.1212934097.3734.wine-devel@winehq.org>
	<5DA9F38458EE4EA28A5BE3E73C3AC6EE@gsep1>
Message-ID: <82b2af8e0806081229q2ebc1a71m3e26625668b2d378@mail.gmail.com>

> Try http://msdn.microsoft.com/en-us/library/aa367524(VS.85).aspx<http://msdn.microsoft.com/en-us/library/aa367524%28VS.85%29.aspx>(or search
> for "Adding Controls and Text").
>
> Thanks you. Very useful.

With this information I could see that the font_mask is empty when it calls
the string {\style} and why the installation is wrong.
To get the font mask is reading a MSI record called #ICM but I could not
find any information in the web.
The problem is this function with the record and package #ICM in the field
10:

    LPWSTR msi_get_deformatted_field( MSIPACKAGE *package, MSIRECORD *rec,
int field )

                                             Values are:  #ICM,
    #ICM,10
    font_mask = msi_get_deformatted_field( dialog->package, rec, 10 );

Someone could give me more information of package or record ICM?

Cheers.
-- 
Shakaran
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080608/6f99f08d/attachment.htm 

From dank at kegel.com  Sun Jun  8 15:13:59 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 8 Jun 2008 13:13:59 -0700
Subject: hey, small wine job on a rent-a-coder site
Message-ID: <a71bd89a0806081313j2b949495t5b95898e46513547@mail.gmail.com>

Anyone want to do a Picasa-like packaging of a commercial app?
I just saw
http://www.getacoder.com/projects/create_prm_deb_package_80623.html
The offered fee is about 10x too small, but
perhaps somebody would be interested in the challenge anyway.


From marcus at jet.franken.de  Sun Jun  8 16:29:25 2008
From: marcus at jet.franken.de (Marcus Meissner)
Date: Sun, 8 Jun 2008 23:29:25 +0200
Subject: Downgrade lack of libxslt from configure warning to notice
In-Reply-To: <alpine.LSU.1.10.0806082239070.6827@acrux.dbai.tuwien.ac.at>
References: <alpine.LSU.1.10.0806082239070.6827@acrux.dbai.tuwien.ac.at>
Message-ID: <20080608212924.GA21998@galeere>

On Sun, Jun 08, 2008 at 10:42:32PM +0200, Gerald Pfeifer wrote:
> On a test system of mine which does not feature too many packages I am
> getting the following:
> 
> configure: libsane development files not found, scanners won't be supported.
> configure: libgphoto2 development files not found, digital cameras won't be supported.
> configure: libldap (OpenLDAP) development files not found, LDAP won't be supported.
> configure: libcapi20 development files not found, ISDN won't be supported.
> configure: WARNING: libxslt development files not found, xslt won't be supported.
> 
> Looking that libxslt only seems to be used by msxml3, I am wondering
> whether this really is worth a warning?
> 
> How about the patch below?

It probably should be an error, since otherwise msxml3 is only
partial functional aka "broken".

Ciao, Marcus


From wine-devel at kievinfo.com  Sun Jun  8 16:57:55 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 08 Jun 2008 15:57:55 -0600
Subject: Downgrade lack of libxslt from configure warning to notice
In-Reply-To: <alpine.LSU.1.10.0806082239070.6827@acrux.dbai.tuwien.ac.at>
References: <alpine.LSU.1.10.0806082239070.6827@acrux.dbai.tuwien.ac.at>
Message-ID: <484C55E3.3060906@kievinfo.com>

Gerald Pfeifer wrote:
> On a test system of mine which does not feature too many packages I am
> getting the following:
> 
> configure: libsane development files not found, scanners won't be supported.
> configure: libgphoto2 development files not found, digital cameras won't be supported.
> configure: libldap (OpenLDAP) development files not found, LDAP won't be supported.
> configure: libcapi20 development files not found, ISDN won't be supported.
> configure: WARNING: libxslt development files not found, xslt won't be supported.
> 
> Looking that libxslt only seems to be used by msxml3, I am wondering
> whether this really is worth a warning?
> 
No, if anything any missing part should stop configure and exit with error. 
And if you force compiling without some feature Wine should be marked 
"tainted". So all bug reports and calls for help can be easily filtered and 
ignored.

In short NEVER ignore missing dependencies. You never know what windows app 
might use and why.

Vitaliy.


From robertshearman at gmail.com  Sun Jun  8 17:59:36 2008
From: robertshearman at gmail.com (Rob Shearman)
Date: Sun, 8 Jun 2008 23:59:36 +0100
Subject: notepad: updated French translation
In-Reply-To: <1212833636.6624.40.camel@jernst-desktop>
References: <1212754712.6582.62.camel@jernst-desktop>
	<484A4D78.5000403@vromman.org>
	<1212833636.6624.40.camel@jernst-desktop>
Message-ID: <1096648c0806081559g7ce548cawbe15b9be42c57ff5@mail.gmail.com>

2008/6/7 Jonathan Ernst <jonathan at ernstfamily.ch>:
> Le samedi 07 juin 2008 ? 10:57 +0200, Laurent Vromman a ?crit :
>> Hi,
>>
>> I don't know if it is important since the translation is grammatically
>> correct, but in windows (I checked on XP SP2), the exact translation is
>>
>> "? &propos du Bloc-notes..." and not "? &propos de Bloc-notes..."
>
> I changed it and removed the extra ellipsis to conform to most HIGs (eg. Gnome's : http://developer.gnome.org/projects/gup/hig/hig-diff/menus-design.html)
>

The Windows style is to include the ellipsis whenever a menu item will
normally result in a dialog box appearing, not just when further user
input is required. I think it is more important to be consistent with
what we already have in Wine and with native equivalents of our
programs than to conform with certain HIGs.

-- 
Rob Shearman

From tkho at tommykho.com  Sun Jun  8 22:09:22 2008
From: tkho at tommykho.com (Thomas Kho)
Date: Sun, 8 Jun 2008 20:09:22 -0700
Subject: Wine Profiling
In-Reply-To: <484C23AB.2010608@gmail.com>
References: <484C23AB.2010608@gmail.com>
Message-ID: <ad4ecd9f0806082009o261413d0ncbc17e4ea1ac7264@mail.gmail.com>

On Sun, Jun 8, 2008 at 11:23 AM, Stephen Eilert <spedrosa at gmail.com> wrote:
> Are there any specific procedures or utilities to instrument and
> generate profiling reports?

This is indirectly related to your question, but I'd really love to
see better DTrace support for Windows applications running in Wine.
Like Dan Kegel recently suggested about Valgrind, great analysis tools
might just be _the_ reason for Windows developers to develop/debug
using Wine ;) [1].

Here's some Wine + DTrace activity I dug up:

* Damian Wojs?aw recently suggested starting by adding function bounds probes
  http://www.winehq.org/pipermail/wine-devel/2007-December/061265.html

* DTrace providers for Wine are a long term goal for the OpenSolaris folks
  http://opensolaris.org/os/community/desktop/communities/wine/

* There's a bug report out there with DTrace output of wineserver attached
  http://bugs.winehq.org/show_bug.cgi?id=13227

-Tom

[1] The main point I took away from the OpenSolaris talk at the last
LugRadio Live conference was exactly this. Sun seriously thinks
Solaris niceties (think ZFS and DTrace up the application stack) +
friendly GNU userland is the key to attracting developers to
OpenSolaris. You could apply that same argument to Wine +
DTrace/Valgrind/OProfile/etc.

From dank at kegel.com  Sun Jun  8 23:50:12 2008
From: dank at kegel.com (Dan Kegel)
Date: Sun, 8 Jun 2008 21:50:12 -0700
Subject: Please have a look at the current Valgrind warnings
Message-ID: <a71bd89a0806082150i635f03cap435de7f63e5452fd@mail.gmail.com>

After a few days of cleaning up Valgrind warnings
in the Wine source tree, and adding suppressions
where it made sense. I've whittled the list of
Valgrind warnings down to 300 or so.

This list is short enough that a mortal can look upon it
without dispair, and even see a number of things
that might be real bugs.

The histogram of frequent errors is at
http://kegel.com/wine/valgrind/logs-2008-06-08.counts.txt
and shows one call stack per line (only top three locations
are represented for each call stack).

A few groups of warnings stand out:
10 of them are invalid calls to free() or friends,
30 of them involve WideCharToMultiByte,
50 of them are in ds3d or ds3d8, and
60 of them are in Gecko.
(Ooodles and oodles are caused by nvidia's libgl,
libfontconfig, libexpat, and libc; most of these are
suppressed, or you'd die of bordom or anger reading the logs.)

As before, the log broken out by directory is at
http://kegel.com/wine/valgrind/logs-2008-06-08/

The full log is at
http://kegel.com/wine/valgrind/logs-2008-06-08.log.gz

This is run with --track-origins=yes, so you get nifty
stack tracebacks for where the undefined values
got their initial, um, nonvalue.  This is often quite
helpful for narrowing down the cause.

The diff against CVS of the tree I ran this on is at
http://kegel.com/wine/valgrind/logs-2008-06-08-patch.txt
and is mostly the valgrind cleanup patches I've written
that have not yet been committed (plus one rough one
from Juan).  It's given for completeness; I'll resubmit
the individual patches once 1.0 is out.

Oh, and the suppressions file I use is rather bigger now.
As always, it's at
http://kegel.com/wine/valgrind/valgrind-suppressions

If you've read this far, congratulations and thanks.  Please consider
triaging one of these warnings.  Just pick one at random, and
if you really figure it out, please submit a fix; be sure
to include the valgrind warning in the description of the patch.
Even if all you figure out is how to improve the test
and thereby not generate Valgrind warnings, that's great,
please send in your patch.  Every test we make squeaky-clean
improves the signal-to-noise ratio for finding real problems.
(But please don't submit any change you don't really
understand, or that seems risky.  The goal is not to clean
up Valgrind warnings; it's to improve the quality of the test suite.)
- Dan


From zac at zacbrown.org  Mon Jun  9 00:04:28 2008
From: zac at zacbrown.org (Zac Brown)
Date: Sun, 08 Jun 2008 22:04:28 -0700
Subject: Please have a look at the current Valgrind warnings
In-Reply-To: <a71bd89a0806082150i635f03cap435de7f63e5452fd@mail.gmail.com>
References: <a71bd89a0806082150i635f03cap435de7f63e5452fd@mail.gmail.com>
Message-ID: <484CB9DC.6050707@zacbrown.org>

Looks good... guess I know what I'll be after tomorrow ;).

-Zac

Dan Kegel wrote:
> After a few days of cleaning up Valgrind warnings
> in the Wine source tree, and adding suppressions
> where it made sense. I've whittled the list of
> Valgrind warnings down to 300 or so.
> 
> This list is short enough that a mortal can look upon it
> without dispair, and even see a number of things
> that might be real bugs.
> 
> The histogram of frequent errors is at
> http://kegel.com/wine/valgrind/logs-2008-06-08.counts.txt
> and shows one call stack per line (only top three locations
> are represented for each call stack).
> 
> A few groups of warnings stand out:
> 10 of them are invalid calls to free() or friends,
> 30 of them involve WideCharToMultiByte,
> 50 of them are in ds3d or ds3d8, and
> 60 of them are in Gecko.
> (Ooodles and oodles are caused by nvidia's libgl,
> libfontconfig, libexpat, and libc; most of these are
> suppressed, or you'd die of bordom or anger reading the logs.)
> 
> As before, the log broken out by directory is at
> http://kegel.com/wine/valgrind/logs-2008-06-08/
> 
> The full log is at
> http://kegel.com/wine/valgrind/logs-2008-06-08.log.gz
> 
> This is run with --track-origins=yes, so you get nifty
> stack tracebacks for where the undefined values
> got their initial, um, nonvalue.  This is often quite
> helpful for narrowing down the cause.
> 
> The diff against CVS of the tree I ran this on is at
> http://kegel.com/wine/valgrind/logs-2008-06-08-patch.txt
> and is mostly the valgrind cleanup patches I've written
> that have not yet been committed (plus one rough one
> from Juan).  It's given for completeness; I'll resubmit
> the individual patches once 1.0 is out.
> 
> Oh, and the suppressions file I use is rather bigger now.
> As always, it's at
> http://kegel.com/wine/valgrind/valgrind-suppressions
> 
> If you've read this far, congratulations and thanks.  Please consider
> triaging one of these warnings.  Just pick one at random, and
> if you really figure it out, please submit a fix; be sure
> to include the valgrind warning in the description of the patch.
> Even if all you figure out is how to improve the test
> and thereby not generate Valgrind warnings, that's great,
> please send in your patch.  Every test we make squeaky-clean
> improves the signal-to-noise ratio for finding real problems.
> (But please don't submit any change you don't really
> understand, or that seems risky.  The goal is not to clean
> up Valgrind warnings; it's to improve the quality of the test suite.)
> - Dan
> 
> 


From jonathan at ernstfamily.ch  Mon Jun  9 01:23:07 2008
From: jonathan at ernstfamily.ch (Jonathan Ernst)
Date: Mon, 09 Jun 2008 08:23:07 +0200
Subject: notepad: updated French translation
In-Reply-To: <1096648c0806081559g7ce548cawbe15b9be42c57ff5@mail.gmail.com>
References: <1212754712.6582.62.camel@jernst-desktop>
	<484A4D78.5000403@vromman.org>
	<1212833636.6624.40.camel@jernst-desktop>
	<1096648c0806081559g7ce548cawbe15b9be42c57ff5@mail.gmail.com>
Message-ID: <1212992587.6601.7.camel@jernst-desktop>

Hello,

Le dimanche 08 juin 2008 ? 23:59 +0100, Rob Shearman a ?crit :
> 2008/6/7 Jonathan Ernst <jonathan at ernstfamily.ch>:
> > Le samedi 07 juin 2008 ? 10:57 +0200, Laurent Vromman a ?crit :
> [...]
> >> "? &propos du Bloc-notes..." and not "? &propos de Bloc-notes..."
> >
> > I changed it and removed the extra ellipsis to conform to most HIGs (eg. Gnome's : http://developer.gnome.org/projects/gup/hig/hig-diff/menus-design.html)
> >
> 
> The Windows style is to include the ellipsis whenever a menu item will
> normally result in a dialog box appearing, not just when further user
> input is required. I think it is more important to be consistent with
> what we already have in Wine and with native equivalents of our
> programs than to conform with certain HIGs.
> 

Do you have any reference for this Windows rule ?

I didn't find it and Firefox, Internet Explorer, Notepad, Paint and
OpenOffice on Windows (in French at least) do not have ellipsis in About
menu entry (altough Firefox has a special "?" Menu in Windows instead of
"Help").

As for what we already have in Wine, regedit and wordpad don't have
ellipsis in this place, so I think that notepad is inconsistent with the
rest of Wine.

Regards.

Jonathan



From robertshearman at gmail.com  Mon Jun  9 03:15:37 2008
From: robertshearman at gmail.com (Rob Shearman)
Date: Mon, 9 Jun 2008 09:15:37 +0100
Subject: notepad: updated French translation
In-Reply-To: <1212992587.6601.7.camel@jernst-desktop>
References: <1212754712.6582.62.camel@jernst-desktop>
	<484A4D78.5000403@vromman.org>
	<1212833636.6624.40.camel@jernst-desktop>
	<1096648c0806081559g7ce548cawbe15b9be42c57ff5@mail.gmail.com>
	<1212992587.6601.7.camel@jernst-desktop>
Message-ID: <1096648c0806090115s43c775a0y83ccbcda18fed702@mail.gmail.com>

2008/6/9 Jonathan Ernst <jonathan at ernstfamily.ch>:
>> The Windows style is to include the ellipsis whenever a menu item will
>> normally result in a dialog box appearing, not just when further user
>> input is required. I think it is more important to be consistent with
>> what we already have in Wine and with native equivalents of our
>> programs than to conform with certain HIGs.
>>
>
> Do you have any reference for this Windows rule ?
>
> I didn't find it and Firefox, Internet Explorer, Notepad, Paint and
> OpenOffice on Windows (in French at least) do not have ellipsis in About
> menu entry (altough Firefox has a special "?" Menu in Windows instead of
> "Help").
>
> As for what we already have in Wine, regedit and wordpad don't have
> ellipsis in this place, so I think that notepad is inconsistent with the
> rest of Wine.

Fair enough. Sorry for the noise.

-- 
Rob Shearma


From mstefani at redhat.com  Mon Jun  9 04:32:01 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Mon, 09 Jun 2008 11:32:01 +0200
Subject: msxml3: tests/xmlelem.c: VT_EMPTY is not a string
In-Reply-To: <a71bd89a0806061727h505501a7q5d17211949a2c05c@mail.gmail.com>
References: <a71bd89a0806061727h505501a7q5d17211949a2c05c@mail.gmail.com>
Message-ID: <484CF891.2090105@redhat.com>

Dan Kegel wrote:
> Casting a VT_EMPTY to a string gets you a null string.
> The test was doing that and taking the string length, then comparing to zero.
> Better to simply compare to null; that's a stronger test, and
> avoids generating a behind-the-scenes exception.
> 
> Passes on Wine and XP, and makes Valgrind output a bit easier on the eyes.
> 
> 
> ------------------------------------------------------------------------
> diff --git a/dlls/msxml3/tests/xmlelem.c b/dlls/msxml3/tests/xmlelem.c
> index 61a2300..229de78 100644
> --- a/dlls/msxml3/tests/xmlelem.c
> +++ b/dlls/msxml3/tests/xmlelem.c
> @@ -78,7 +78,7 @@ static void test_xmlelem(void)
>      hr = IXMLElement_getAttribute(element, str, &vValue);
>      ok(hr == S_FALSE, "Expected S_FALSE, got %d\n", hr);
>      ok(V_VT(&vValue) == VT_EMPTY, "Expected VT_EMPTY, got %d\n",
V_VT(&vValue));
> -    ok(lstrlenW(V_BSTR(&vValue)) == 0, "Expected empty value\n");
> +    ok(V_BSTR(&vValue) == (void *)0, "Expected null value\n");
Is there a problem with using NULL instead of (void *)0?

bye
	michael


From m.b.lankhorst at gmail.com  Mon Jun  9 05:12:24 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Mon, 9 Jun 2008 12:12:24 +0200
Subject: iPod patches
In-Reply-To: <b6bb06270806090229h17f08914i262e39cac48571fb@mail.gmail.com>
References: <b6bb06270806090229h17f08914i262e39cac48571fb@mail.gmail.com>
Message-ID: <b130c85e0806090312l1a309328kd5880e7034667d7@mail.gmail.com>

Hello Austin,

2008/6/9 Austin English <austinenglish at gmail.com>:
> Howdy Maarten,
>
> I'm trying to do some dogfood testing with iTunes, and am building a
> wine build with a few hacks to get around the ddraw blacking bug, iPod
> support, etc. I tried applying your patch for iPod support, but it
> seems that patch has a lot of conflicts with recent wine versions. I
> was about to go through and start settling them manually, but thought
> you may have a version laying around in your git tree that applies
> (relatively) cleanly to 1.0-rc4.

The most recent iteration is at:
http://www.winehq.org/pipermail/wine-patches/2008-May/054483.html

It should still apply cleanly, since the last patch touches
wineserver, you have to run tools/make_requests from the top of the
wine tree to update all wineserver related files.

I added wine-devel to CC since lots of people asked me about it.

The downside is that it still doesn't work 100%, for some reason there
is a huge delay every time the ipod is used.

How to use it:

Set windows version to vista
Install iTunes
Mount the ipod
'wine net start "ipod service"'
Wait 10 seconds or so
start itunes, it should take 3 minutes instead of instantly. (From the
delay above)

There is a race condition if the ipod service isn't started before
itunes is, resulting in the ipod not being found. Might be a wine bug,
but I'm not 100% sure.

Cheers,
Maarten.

Cheers,
Maarten


From stefandoesinger at gmx.at  Mon Jun  9 05:34:39 2008
From: stefandoesinger at gmx.at (=?windows-1252?Q?Stefan_D=F6singer?=)
Date: Mon, 9 Jun 2008 12:34:39 +0200
Subject: iPod patches
In-Reply-To: <b130c85e0806090312l1a309328kd5880e7034667d7@mail.gmail.com>
References: <b6bb06270806090229h17f08914i262e39cac48571fb@mail.gmail.com>
	<b130c85e0806090312l1a309328kd5880e7034667d7@mail.gmail.com>
Message-ID: <002101c8ca1c$6c8f8820$45ae9860$@at>

> > I'm trying to do some dogfood testing with iTunes, and am building a
> > wine build with a few hacks to get around the ddraw blacking bug,
Did you try setting winver = vista?




From xerox_xerox2000 at yahoo.co.uk  Mon Jun  9 05:41:33 2008
From: xerox_xerox2000 at yahoo.co.uk (Louis Lenders)
Date: Mon, 9 Jun 2008 10:41:33 +0000 (UTC)
Subject: Wine + Fedora
Message-ID: <loom.20080609T103515-438@post.gmane.org>

Hi, just thought dropping a note here so you'd know: the troubles reported for
wine+fedora 9, now also affect fedora 8. Last saturday i did a 'yum update', and
after that about all wine-applications froze my computer. Only a hard reboot
helped...

Solved it by reverting back to kernel 2.6.24.7-92.fc8

Just in case a new wine-1.0 release comes out, and fedora-users start whining
"wine 1.0 is really crap, it freezes my computer" , hope this will be fixed soon.




From austinenglish at gmail.com  Mon Jun  9 05:46:45 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 9 Jun 2008 05:46:45 -0500
Subject: iPod patches
In-Reply-To: <002101c8ca1c$6c8f8820$45ae9860$@at>
References: <b6bb06270806090229h17f08914i262e39cac48571fb@mail.gmail.com>
	<b130c85e0806090312l1a309328kd5880e7034667d7@mail.gmail.com>
	<002101c8ca1c$6c8f8820$45ae9860$@at>
Message-ID: <b6bb06270806090346s18c0827fm1cc8033281fb6e8@mail.gmail.com>

On Mon, Jun 9, 2008 at 5:34 AM, Stefan D?singer <stefandoesinger at gmx.at> wrote:
>> > I'm trying to do some dogfood testing with iTunes, and am building a
>> > wine build with a few hacks to get around the ddraw blacking bug,
> Did you try setting winver = vista?
>
>
>

Doesn't work for VLC.

From dmitry at codeweavers.com  Mon Jun  9 05:58:27 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 9 Jun 2008 19:58:27 +0900
Subject: Wine + Fedora
References: <loom.20080609T103515-438@post.gmane.org>
Message-ID: <5274B21A051D45B483E198FFD82D7DFF@DMITRY>

"Louis Lenders" <xerox_xerox2000 at yahoo.co.uk> wrote:

> Hi, just thought dropping a note here so you'd know: the troubles reported for
> wine+fedora 9, now also affect fedora 8. Last saturday i did a 'yum update', and
> after that about all wine-applications froze my computer. Only a hard reboot
> helped...
> 
> Solved it by reverting back to kernel 2.6.24.7-92.fc8
> 
> Just in case a new wine-1.0 release comes out, and fedora-users start whining
> "wine 1.0 is really crap, it freezes my computer" , hope this will be fixed soon.

I'd suggest to post the comments and requests here:

https://bugzilla.redhat.com/show_bug.cgi?id=443552


-- 
Dmitry.


From xerox_xerox2000 at yahoo.co.uk  Mon Jun  9 06:34:29 2008
From: xerox_xerox2000 at yahoo.co.uk (Louis Lenders)
Date: Mon, 9 Jun 2008 11:34:29 +0000 (UTC)
Subject: Wine + Fedora
References: <loom.20080609T103515-438@post.gmane.org>
	<5274B21A051D45B483E198FFD82D7DFF@DMITRY>
Message-ID: <loom.20080609T113340-22@post.gmane.org>

Dmitry Timoshkov <dmitry <at> codeweavers.com> writes:


> 
> I'd suggest to post the comments and requests here:
> 
> https://bugzilla.redhat.com/show_bug.cgi?id=443552
> 

Done. Hope it's fixed soon




From dmitry at codeweavers.com  Mon Jun  9 06:57:12 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 9 Jun 2008 20:57:12 +0900
Subject: Wine + Fedora
References: <loom.20080609T103515-438@post.gmane.org><5274B21A051D45B483E198FFD82D7DFF@DMITRY>
	<loom.20080609T113340-22@post.gmane.org>
Message-ID: <204062E865EA4BEAB6047D12D14FC9CE@DMITRY>

"Louis Lenders" <xerox_xerox2000 at yahoo.co.uk> wrote:

>> I'd suggest to post the comments and requests here:
>> 
>> https://bugzilla.redhat.com/show_bug.cgi?id=443552
>> 
> 
> Done. Hope it's fixed soon

Opened by Artemon 2008-04-22 03:03 EST
Priority low 
Severity urgent

Something tells me that if that bug persists since then and has been
reported for the rawhide kernel, and after that survived 2 releases to
*production* systems fc9 and now fc8 they don't care about it at all.

I haven't found a single mention of this bug on utrace-devel either.

-- 
Dmitry.


From dank at kegel.com  Mon Jun  9 08:18:47 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 9 Jun 2008 06:18:47 -0700
Subject: msxml3: tests/xmlelem.c: VT_EMPTY is not a string
In-Reply-To: <484CF891.2090105@redhat.com>
References: <a71bd89a0806061727h505501a7q5d17211949a2c05c@mail.gmail.com>
	<484CF891.2090105@redhat.com>
Message-ID: <a71bd89a0806090618t6246d1eanff2062e89de1e194@mail.gmail.com>

On Mon, Jun 9, 2008 at 2:32 AM, Michael Stefaniuc <mstefani at redhat.com> wrote:
>> -    ok(lstrlenW(V_BSTR(&vValue)) == 0, "Expected empty value\n");
>> +    ok(V_BSTR(&vValue) == (void *)0, "Expected null value\n");
>
> Is there a problem with using NULL instead of (void *)0?

NULL would probably be fine.  (I come from an era where NULL had to
be defined by hand, so sometimes I slip and don't use it.)
- Dan


From julliard at winehq.org  Mon Jun  9 10:09:52 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 09 Jun 2008 17:09:52 +0200
Subject: wininet: Make sure URL is terminated in InternetCrackUrlA.
In-Reply-To: <200806091355.08140.hans@it.vu.nl> (Hans Leidekker's message of
	"Mon, 9 Jun 2008 13:55:07 +0200")
References: <200806091355.08140.hans@it.vu.nl>
Message-ID: <87fxrmhcfz.fsf@wine.dyndns.org>

Hans Leidekker <hans at it.vu.nl> writes:

> Fixes http://bugs.winehq.org/show_bug.cgi?id=1968
> as well as a bunch of Valgrind warnings in the url test module.
>
>  -Hans
>
> Changelog
>  Make sure URL is terminated in InternetCrackUrlA.

The bug is in InternetCrackUrlW, it shouldn't require the string to be
null-terminated.

-- 
Alexandre Julliard
julliard at winehq.org


From theosib at gmail.com  Mon Jun  9 14:38:44 2008
From: theosib at gmail.com (Timothy Normand Miller)
Date: Mon, 9 Jun 2008 15:38:44 -0400
Subject: Trying to build rc4 for MacOS, having problems with libpng, libjpeg,
	etc.
In-Reply-To: <9871ee5f0806091229p45012883x8054b3655e24f35@mail.gmail.com>
References: <9871ee5f0806091229p45012883x8054b3655e24f35@mail.gmail.com>
Message-ID: <9871ee5f0806091238o66635adevbb86602e69285f72@mail.gmail.com>

Hi.  I'm trying to build rc4 for MacOS (Leopard),
and I'm running into some problems, and I hope I'm not a bother to ask
for some help.

When I do ./configure, I get the following messages:

onfigure: WARNING: libjpeg development files not found, JPEG won't be supported.

configure: WARNING: libpng development files not found, PNG won't be supported.

(and several other similar ones)

I know for a fact that these libraries are installed under /sw (via
Fink), along with the include files, but no matter what I do, I can't
get get configure to find them.  Here's how I'm trying to do it so
far:

export LDFLAGS=-L/sw/lib
export LIBS="-lpng -ljpeg"
./configure --prefix=/sw --exec-prefix=/sw

What am I missing?

Thanks!


-- 
Timothy Normand Miller
http://www.cse.ohio-state.edu/~millerti
Open Graphics Project


From tkho at tommykho.com  Mon Jun  9 16:26:30 2008
From: tkho at tommykho.com (Thomas Kho)
Date: Mon, 9 Jun 2008 14:26:30 -0700
Subject: Trying to build rc4 for MacOS, having problems with libpng,
	libjpeg, etc.
In-Reply-To: <9871ee5f0806091238o66635adevbb86602e69285f72@mail.gmail.com>
References: <9871ee5f0806091229p45012883x8054b3655e24f35@mail.gmail.com>
	<9871ee5f0806091238o66635adevbb86602e69285f72@mail.gmail.com>
Message-ID: <ad4ecd9f0806091426g366f1b45t32cedb202f2f807@mail.gmail.com>

On Mon, Jun 9, 2008 at 12:38 PM, Timothy Normand Miller
<theosib at gmail.com> wrote:
> Hi.  I'm trying to build rc4 for MacOS (Leopard),
> and I'm running into some problems, and I hope I'm not a bother to ask
> for some help.
>
> When I do ./configure, I get the following messages:
>
> onfigure: WARNING: libjpeg development files not found, JPEG won't be supported.
>
> configure: WARNING: libpng development files not found, PNG won't be supported.
>
> (and several other similar ones)
>
> I know for a fact that these libraries are installed under /sw (via
> Fink), along with the include files, but no matter what I do, I can't
> get get configure to find them.  Here's how I'm trying to do it so
> far:
>
> export LDFLAGS=-L/sw/lib
> export LIBS="-lpng -ljpeg"
> ./configure --prefix=/sw --exec-prefix=/sw
>
> What am I missing?

I actually tried to build it for the first time on OS X last night.
You need to point to the Fink headers:

CPPFLAGS=-I/sw/include

and if it barfs on xslt and you have pkg-config installed via Fink,
prepend another

PKG_CONFIG_PATH=/usr/lib/pkgconfig

configure.ac uses pkg-config output if it's available and falls back
on {xslt,xml2}-config if it's not. Without setting the
PKG_CONFIG_PATH, a system with Fink's pkg-config will look for .pc
files somewhere under /sw and miss the system ones in
/usr/lib/pkgconfig for libxml and libxslt.

What configure.ac should probably do is to first check pkg-config
output if pkg-config exists, and then try {xslt,xml2}-config if
pkg-config returns an empty string or if it doesn't exist.

-Tom


From theosib at gmail.com  Mon Jun  9 14:29:07 2008
From: theosib at gmail.com (Timothy Normand Miller)
Date: Mon, 9 Jun 2008 15:29:07 -0400
Subject: Trying to build rc4 for MacOS, having problems with libpng, libjpeg,
	etc.
Message-ID: <9871ee5f0806091229p45012883x8054b3655e24f35@mail.gmail.com>

Hi.  I'm not subscribed.  I'm trying to build rc4 for MacOS (Leopard),
and I'm running into some problems, and I hope I'm not a bother to ask
for some help.

When I do ./configure, I get the following messages:

onfigure: WARNING: libjpeg development files not found, JPEG won't be supported.

configure: WARNING: libpng development files not found, PNG won't be supported.

(and several other similar ones)

I know for a fact that these libraries are installed under /sw (via
Fink), along with the include files, but no matter what I do, I can't
get get configure to find them.  Here's how I'm trying to do it so
far:

export LDFLAGS=-L/sw/lib
export LIBS="-lpng -ljpeg"
./configure --prefix=/sw --exec-prefix=/sw

What am I missing?

Thanks!


-- 
Timothy Normand Miller
http://www.cse.ohio-state.edu/~millerti
Open Graphics Project


From m.b.lankhorst at gmail.com  Tue Jun 10 02:43:43 2008
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 10 Jun 2008 09:43:43 +0200
Subject: Wine + Fedora
In-Reply-To: <loom.20080609T103515-438@post.gmane.org>
References: <loom.20080609T103515-438@post.gmane.org>
Message-ID: <b130c85e0806100043mdcabe97yc34b0ef246e57a66@mail.gmail.com>

Hello Louis,

2008/6/9 Louis Lenders <xerox_xerox2000 at yahoo.co.uk>:
> Hi, just thought dropping a note here so you'd know: the troubles reported for
> wine+fedora 9, now also affect fedora 8. Last saturday i did a 'yum update', and
> after that about all wine-applications froze my computer. Only a hard reboot
> helped...
>
> Solved it by reverting back to kernel 2.6.24.7-92.fc8
>
> Just in case a new wine-1.0 release comes out, and fedora-users start whining
> "wine 1.0 is really crap, it freezes my computer" , hope this will be fixed soon.
I've encountered the same bug. The fix was to take out their 'utrace'
patch and recompile the kernel as the bug suggested. The crash is gone
after that.

Cheers,
Maarten


From dmitry at codeweavers.com  Tue Jun 10 02:54:46 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 10 Jun 2008 16:54:46 +0900
Subject: gdi32: Use 0xffff as a default character as Vista does
References: <E1K5yRm-0005wh-Ff@mail.codeweavers.com>
	<3f4fd2640806100048g3756806ej5650319e97a4b4f4@mail.gmail.com>
Message-ID: <394D0BBA8A53413691D27237163BA289@DMITRY>

"Reece Dunn" <msclrhd at googlemail.com> wrote:

>> +        TM.tmDefaultChar = pOS2->usDefaultChar ? pOS2->usDefaultChar : 0xffff;
> 
> There is a UNICODE_NOCHAR constant for this.

UNICODE_NOCHAR is defined in winuser.h, we can't use it in gdi32.

-- 
Dmitry.


From hans at it.vu.nl  Tue Jun 10 05:07:37 2008
From: hans at it.vu.nl (Hans Leidekker)
Date: Tue, 10 Jun 2008 12:07:37 +0200
Subject: wininet: Make sure URL is terminated in InternetCrackUrlA.
In-Reply-To: <87fxrmhcfz.fsf@wine.dyndns.org>
References: <200806091355.08140.hans@it.vu.nl> <87fxrmhcfz.fsf@wine.dyndns.org>
Message-ID: <200806101207.38217.hans@it.vu.nl>

On Monday 09 June 2008 17:09:52 Alexandre Julliard wrote:

> The bug is in InternetCrackUrlW, it shouldn't require the string to be
> null-terminated.

Right, but I guess fixing that is no 1.0 material since there's at least
4 places where it assumes a null-terminated string, including a call to
InternetCanonicalizeUrlW.

 -Hans



From paul.vriens.wine at gmail.com  Tue Jun 10 05:46:26 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 10 Jun 2008 12:46:26 +0200
Subject: shell32: stop shlfolder tests crashing under win98
In-Reply-To: <g2lkr4$kei$1@ger.gmane.org>
References: <g2lkr4$kei$1@ger.gmane.org>
Message-ID: <484E5B82.3000901@gmail.com>

Alistair Leslie-Hughes wrote:
> Hi,
>     Moved the null pointer checker to before it's first used.
> 
> Changelog:
>     shell32: stop shlfolder tests crashing under win98
> 
> Best Regards
>  Alistair Leslie-Hughes
> 
> 
> ------------------------------------------------------------------------
> 
> 
While your at it, could you add a skip message?

-- 
Cheers,

Paul.


From stefandoesinger at gmx.at  Tue Jun 10 05:49:03 2008
From: stefandoesinger at gmx.at (=?windows-1252?Q?Stefan_D=F6singer?=)
Date: Tue, 10 Jun 2008 12:49:03 +0200
Subject: ddraw: modify Direct3D device name
In-Reply-To: <f5d9424f0806100035j44365694j3c1c6e6b92d2067c@mail.gmail.com>
References: <f5d9424f0806100035j44365694j3c1c6e6b92d2067c@mail.gmail.com>
Message-ID: <004001c8cae7$9a12ab30$ce380190$@at>

> Descent FreeSpace: The Great War and Descent FreeSpace 2 fail to detect
> hardware acceleration through Direct3D when enumerating devices, they
> expect the device name string to begin with "Direct3D - "
> 
> This patch enables the Direct3D mode to be used.
I am not entirely sure about this. I think there were other apps(Quicktime?)
which depend on some other name.

I think the best is to see which name Windows uses, make ddraw.dll read the
name from WineD3D, and make WineD3D return the same name Windows does for
the detected card.




From msclrhd at googlemail.com  Tue Jun 10 02:48:11 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 10 Jun 2008 08:48:11 +0100
Subject: gdi32: Use 0xffff as a default character as Vista does
In-Reply-To: <E1K5yRm-0005wh-Ff@mail.codeweavers.com>
References: <E1K5yRm-0005wh-Ff@mail.codeweavers.com>
Message-ID: <3f4fd2640806100048g3756806ej5650319e97a4b4f4@mail.gmail.com>

2008/6/10 Dmitry Timoshkov <dmitry at codeweavers.com>:
> Hello,
>
> this patch fixes the problem reported in the bug 12305. In Wine Tahoma
> character ':' is mapped to glyph index 0x1f, and that seems to be confusing
> Firefox.

> +        TM.tmDefaultChar = pOS2->usDefaultChar ? pOS2->usDefaultChar : 0xffff;

There is a UNICODE_NOCHAR constant for this.

- Reece


From dank at kegel.com  Tue Jun 10 07:13:02 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 10 Jun 2008 05:13:02 -0700
Subject: Stop shlfileop tests crashing under win98
Message-ID: <a71bd89a0806100513n4440266cr23a297148df8a38c@mail.gmail.com>

Alistair wrote:
>-    /* try an invalid list, only one null terminator */
>-    init_shfo_tests();
>-    shfo.pFrom = "";
>-    shfo.wFunc = FO_DELETE;
>-    ret = SHFileOperation(&shfo);
>-    ok(ret == ERROR_ACCESS_DENIED, "Expected ERROR_ACCESS_DENIED, got %d\n", ret);
>-    ok(file_exists("test1.txt"), "Expected test1.txt to exist\n");
>+    /* This crashes under win98 */
>+    if(0)
>+    {
>+        /* try an invalid list, only one null terminator */

Hey Allistair,
that paragraph looks like it was buggy - it should have had
test1.txt followed by a single nul and then twice MAXPATH
nonnulls and then a double nul, like the similar tests I fixed in
http://www.winehq.org/pipermail/wine-patches/2008-May/055371.html
As it is, there's no way FO_DELETE could see test1.txt to maybe
delete it.

James, do you agree?

Perhaps you could leave it enabled if you fixed it like the
ones I fixed.  (Or tried to fix; sadly, Alexandre hasn't
committed it yet. Why?)
- Dan


From paul.vriens.wine at gmail.com  Tue Jun 10 07:05:30 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 10 Jun 2008 14:05:30 +0200
Subject: [ole32/tests 2/2] Fix crash on NT4 and below
In-Reply-To: <1096648c0806100502q376f0d70v6f5573d9f57b03f7@mail.gmail.com>
References: <484E3A11.1000908@gmail.com>
	<1096648c0806100502q376f0d70v6f5573d9f57b03f7@mail.gmail.com>
Message-ID: <484E6E0A.80905@gmail.com>

Rob Shearman wrote:
> 2008/6/10 Paul Vriens <paul.vriens.wine at gmail.com>:
>> This 'fixes' the crash on win9x and NT4.
>>
>> @@ -1130,11 +1130,15 @@ static void test_data_cache(void)
>>      hr = IOleCache_Uncache(pOleCache, 0xdeadbeef);
>>      ok(hr == OLE_E_NOCONNECTION, "IOleCache_Uncache with invalid value should return OLE_E_NOCONNECTION instead of 0x%x\n", hr);
>>
>> -    hr = IOleCache_Cache(pOleCache, NULL, 0, &dwConnection);
>> -    ok(hr == E_INVALIDARG, "IOleCache_Cache with NULL fmtetc should have returned E_INVALIDARG instead of 0x%08x\n", hr);
>> +    /* Both tests crash on NT4 and below */
>> +    if (0)
>> +    {
>> +        hr = IOleCache_Cache(pOleCache, NULL, 0, &dwConnection);
>> +        ok(hr == E_INVALIDARG, "IOleCache_Cache with NULL fmtetc should have returned E_INVALIDARG instead of 0x%08x\n", hr);
>>
>> -    hr = IOleCache_Cache(pOleCache, NULL, 0, NULL);
>> -    ok(hr == E_INVALIDARG, "IOleCache_Cache with NULL pdwConnection should have returned E_INVALIDARG instead of 0x%08x\n", hr);
>> +        hr = IOleCache_Cache(pOleCache, NULL, 0, NULL);
>> +        ok(hr == E_INVALIDARG, "IOleCache_Cache with NULL pdwConnection should have returned E_INVALIDARG instead of 0x%08x\n", hr);
>> +    }
>>
>>      for (fmtetc.cfFormat = CF_TEXT; fmtetc.cfFormat < CF_MAX; fmtetc.cfFormat++)
>>      {
> 
> This test was added in response to a real application doing exactly
> this, so I think the test does have value when run on Win 2000+.
> Therefore, I think a version check would be better than "if (0)".
> 
Let me check (later) whether it's possible to have some logic in that decides 
whether we are on W2K and up.

If not, all remains is of course a real version check.

-- 
Cheers,

Paul.


From julliard at winehq.org  Tue Jun 10 07:24:14 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 10 Jun 2008 14:24:14 +0200
Subject: Stop shlfileop tests crashing under win98
In-Reply-To: <a71bd89a0806100513n4440266cr23a297148df8a38c@mail.gmail.com>
	(Dan Kegel's message of "Tue, 10 Jun 2008 05:13:02 -0700")
References: <a71bd89a0806100513n4440266cr23a297148df8a38c@mail.gmail.com>
Message-ID: <873anlh40h.fsf@wine.dyndns.org>

"Dan Kegel" <dank at kegel.com> writes:

> Perhaps you could leave it enabled if you fixed it like the
> ones I fixed.  (Or tried to fix; sadly, Alexandre hasn't
> committed it yet. Why?)

Because your patch was also making unrelated and incorrect changes to
the code. If you resubmit just the test changes they'd probably go in.

-- 
Alexandre Julliard
julliard at winehq.org


From wine-devel at kievinfo.com  Tue Jun 10 07:30:00 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 10 Jun 2008 06:30:00 -0600
Subject: ddraw: Fix Setmaterial with a test
In-Reply-To: <5f9140a20806100247p75dda846xcadf4f159a88059b@mail.gmail.com>
References: <5f9140a20806100247p75dda846xcadf4f159a88059b@mail.gmail.com>
Message-ID: <484E73C8.2010705@kievinfo.com>

David Adam wrote:
> The test succeded in my windows XP box.
> 
You have only ddraw test and no d3d test.

Vitaliy.


From jeffzaroyko at gmail.com  Tue Jun 10 07:24:39 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Tue, 10 Jun 2008 22:24:39 +1000
Subject: ddraw: modify Direct3D device name
In-Reply-To: <004001c8cae7$9a12ab30$ce380190$@at>
References: <f5d9424f0806100035j44365694j3c1c6e6b92d2067c@mail.gmail.com>
	<004001c8cae7$9a12ab30$ce380190$@at>
Message-ID: <f5d9424f0806100524v7380fd79i209da8578a81ed37@mail.gmail.com>

On Tue, Jun 10, 2008 at 8:49 PM, Stefan D?singer <stefandoesinger at gmx.at> wrote:
>> Descent FreeSpace: The Great War and Descent FreeSpace 2 fail to detect
>> hardware acceleration through Direct3D when enumerating devices, they
>> expect the device name string to begin with "Direct3D - "
>>
>> This patch enables the Direct3D mode to be used.
> I am not entirely sure about this. I think there were other apps(Quicktime?)
> which depend on some other name.
>
> I think the best is to see which name Windows uses, make ddraw.dll read the
> name from WineD3D, and make WineD3D return the same name Windows does for
> the detected card.
>

I think you're thinking of DirectDraw HAL which there is specific
mention of quicktime
in ddraw/main.c, my patch doesn't touch this, it corrects the string
for Direct3D HAL


From truiken at gmail.com  Tue Jun 10 07:50:31 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 10 Jun 2008 07:50:31 -0500
Subject: Stop shlfileop tests crashing under win98
In-Reply-To: <a71bd89a0806100513n4440266cr23a297148df8a38c@mail.gmail.com>
References: <a71bd89a0806100513n4440266cr23a297148df8a38c@mail.gmail.com>
Message-ID: <22821af30806100550u14920dd4h1a01c5ae81541d75@mail.gmail.com>

On Tue, Jun 10, 2008 at 7:13 AM, Dan Kegel <dank at kegel.com> wrote:
> Alistair wrote:
>>-    /* try an invalid list, only one null terminator */
>>-    init_shfo_tests();
>>-    shfo.pFrom = "";
>>-    shfo.wFunc = FO_DELETE;
>>-    ret = SHFileOperation(&shfo);
>>-    ok(ret == ERROR_ACCESS_DENIED, "Expected ERROR_ACCESS_DENIED, got %d\n", ret);
>>-    ok(file_exists("test1.txt"), "Expected test1.txt to exist\n");
>>+    /* This crashes under win98 */
>>+    if(0)
>>+    {
>>+        /* try an invalid list, only one null terminator */
>
> Hey Allistair,
> that paragraph looks like it was buggy - it should have had
> test1.txt followed by a single nul and then twice MAXPATH
> nonnulls and then a double nul, like the similar tests I fixed in
> http://www.winehq.org/pipermail/wine-patches/2008-May/055371.html
> As it is, there's no way FO_DELETE could see test1.txt to maybe
> delete it.
>
> James, do you agree?
>

No, the test is exactly what the comment says: invalid list (empty)
with one NULL terminator.  I'm fine with it being if-def'ed out if it
crashes in win98.

-- 
James Hawkins


From dank at kegel.com  Tue Jun 10 07:55:59 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 10 Jun 2008 05:55:59 -0700
Subject: Stop shlfileop tests crashing under win98
In-Reply-To: <22821af30806100550u14920dd4h1a01c5ae81541d75@mail.gmail.com>
References: <a71bd89a0806100513n4440266cr23a297148df8a38c@mail.gmail.com>
	<22821af30806100550u14920dd4h1a01c5ae81541d75@mail.gmail.com>
Message-ID: <a71bd89a0806100555j4ef26844l9157c0ce9758495c@mail.gmail.com>

On Tue, Jun 10, 2008 at 5:50 AM, James Hawkins <truiken at gmail.com> wrote:
> No, the test is exactly what the comment says: invalid list (empty)
> with one NULL terminator.  I'm fine with it being if-def'ed out if it
> crashes in win98.

I guess I was fooled by the line
 ok(file_exists("test1.txt"), "Expected test1.txt to exist\n");
Since you didn't feed test1.txt to FO_DELETE, you shouldn't
be testing whether it's present.


From robertshearman at gmail.com  Tue Jun 10 07:02:48 2008
From: robertshearman at gmail.com (Rob Shearman)
Date: Tue, 10 Jun 2008 13:02:48 +0100
Subject: [ole32/tests 2/2] Fix crash on NT4 and below
In-Reply-To: <484E3A11.1000908@gmail.com>
References: <484E3A11.1000908@gmail.com>
Message-ID: <1096648c0806100502q376f0d70v6f5573d9f57b03f7@mail.gmail.com>

2008/6/10 Paul Vriens <paul.vriens.wine at gmail.com>:
> This 'fixes' the crash on win9x and NT4.
>
> @@ -1130,11 +1130,15 @@ static void test_data_cache(void)
>      hr = IOleCache_Uncache(pOleCache, 0xdeadbeef);
>      ok(hr == OLE_E_NOCONNECTION, "IOleCache_Uncache with invalid value should return OLE_E_NOCONNECTION instead of 0x%x\n", hr);
>
> -    hr = IOleCache_Cache(pOleCache, NULL, 0, &dwConnection);
> -    ok(hr == E_INVALIDARG, "IOleCache_Cache with NULL fmtetc should have returned E_INVALIDARG instead of 0x%08x\n", hr);
> +    /* Both tests crash on NT4 and below */
> +    if (0)
> +    {
> +        hr = IOleCache_Cache(pOleCache, NULL, 0, &dwConnection);
> +        ok(hr == E_INVALIDARG, "IOleCache_Cache with NULL fmtetc should have returned E_INVALIDARG instead of 0x%08x\n", hr);
>
> -    hr = IOleCache_Cache(pOleCache, NULL, 0, NULL);
> -    ok(hr == E_INVALIDARG, "IOleCache_Cache with NULL pdwConnection should have returned E_INVALIDARG instead of 0x%08x\n", hr);
> +        hr = IOleCache_Cache(pOleCache, NULL, 0, NULL);
> +        ok(hr == E_INVALIDARG, "IOleCache_Cache with NULL pdwConnection should have returned E_INVALIDARG instead of 0x%08x\n", hr);
> +    }
>
>      for (fmtetc.cfFormat = CF_TEXT; fmtetc.cfFormat < CF_MAX; fmtetc.cfFormat++)
>      {

This test was added in response to a real application doing exactly
this, so I think the test does have value when run on Win 2000+.
Therefore, I think a version check would be better than "if (0)".

-- 
Rob Shearman


From julliard at winehq.org  Tue Jun 10 09:15:26 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 10 Jun 2008 16:15:26 +0200
Subject: winex11.drv: Do not crash if UploadGlyph failed
In-Reply-To: <E1K64Jo-0005hq-IZ@mail.codeweavers.com> (Dmitry Timoshkov's
	message of "Tue, 10 Jun 2008 22:55:41 +0900")
References: <E1K64Jo-0005hq-IZ@mail.codeweavers.com>
Message-ID: <87prqpfkap.fsf@wine.dyndns.org>

Dmitry Timoshkov <dmitry at codeweavers.com> writes:

> this patch fixes the Firefox crashes reported in the bugs 4762 and 12307.
>
> Changelog:
>     winex11.drv: Do not crash if UploadGlyph failed.

I don't think that's correct, it should still display the valid glyphs
and use a replacement char for the invalid ones.

-- 
Alexandre Julliard
julliard at winehq.org


From dmitry at codeweavers.com  Tue Jun 10 09:16:25 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Tue, 10 Jun 2008 23:16:25 +0900
Subject: gdi32: stop gdi font test crashing under win98
References: <g2lrl8$c69$1@ger.gmane.org>
Message-ID: <7E3908EB5C4144498BD2BFF66E83088E@DMITRY>

"Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote:

>     if (!*font_name && font_charset == DEFAULT_CHARSET) /* do it only once */
>     {
> +        LOGFONT lf;
> +        memset(&lf, 0, sizeof(LOGFONT));
> +        
>         efd.total = 0;
>         SetLastError(0xdeadbeef);
>         ret = EnumFontFamilies(hdc, NULL, arial_enum_proc, (LPARAM)&efd);
> @@ -1333,7 +1336,7 @@ static void test_EnumFontFamilies(const char *font_name, INT font_charset)
> 
>         efd.total = 0;
>         SetLastError(0xdeadbeef);
> -        ret = EnumFontFamiliesEx(hdc, NULL, arial_enum_proc, (LPARAM)&efd, 0);
> +        ret = EnumFontFamiliesEx(hdc, &lf, arial_enum_proc, (LPARAM)&efd, 0);

The test must use NULL in order to match the EnumFontFamilies results
above. If it causes the crash under Win9x the test should be explicitly
skipped on that platform.

-- 
Dmitry.


From theosib at gmail.com  Tue Jun 10 10:09:02 2008
From: theosib at gmail.com (Timothy Normand Miller)
Date: Tue, 10 Jun 2008 11:09:02 -0400
Subject: Trying to build rc4 for MacOS, having problems with libpng,
	libjpeg, etc.
In-Reply-To: <9871ee5f0806091229p45012883x8054b3655e24f35@mail.gmail.com>
References: <9871ee5f0806091229p45012883x8054b3655e24f35@mail.gmail.com>
Message-ID: <9871ee5f0806100809s5d479c70w892e806cefa8f45@mail.gmail.com>

I've made some progress, with the help of Thomas Kho, but now I'm
having another issue.  Every time I start WINE, it spends about a
minute going through some font stuff, then when the app finally comes
up, there is no text.  Dan says that I'm missing a dependency on the
RENDER extension.  I definitely have the RENDER extension, so what am
I doing wrong this time?

Also, when I do configure, one of the complaints I get is about
missing fontconfig, but Fink reports that I do have fontconfig.
What's going wrong there?

Thanks!


From fgouget at free.fr  Tue Jun 10 10:16:02 2008
From: fgouget at free.fr (Francois Gouget)
Date: Tue, 10 Jun 2008 17:16:02 +0200 (CEST)
Subject: wininet: Make sure URL is terminated in InternetCrackUrlA.
In-Reply-To: <200806101207.38217.hans@it.vu.nl>
References: <200806091355.08140.hans@it.vu.nl> <87fxrmhcfz.fsf@wine.dyndns.org>
	<200806101207.38217.hans@it.vu.nl>
Message-ID: <alpine.DEB.1.10.0806101705490.23002@amboise.dolphin>

On Tue, 10 Jun 2008, Hans Leidekker wrote:

> On Monday 09 June 2008 17:09:52 Alexandre Julliard wrote:
> 
> > The bug is in InternetCrackUrlW, it shouldn't require the string to be
> > null-terminated.
> 
> Right, but I guess fixing that is no 1.0 material since there's at least
> 4 places where it assumes a null-terminated string, including a call to
> InternetCanonicalizeUrlW.

Why not? It's a bug fix and four places to fix sounds quite reasonable 
(>100 may not be). Maybe it's just me but I didn't feel like 1.0 would 
entail a deep deep freeze period where only critical/security bugs would 
be fixed.

Also I don't feel that the current state of Wine (or of the future Wine 
1.0) is such a marvel of perfection that it justifies a deep freeze to 
make sure it's not going to get a tiny little scratch here or there.

So my understanding is that yeah, we're not going to introduce any big 
new functionality (DirectX 10 is out), or rewrite core parts of Wine 
(the DIB engine is out), or put the code through a prettifier, or switch 
to a new version control system (we're using Git already anyway). But 
this sounds like pretty regular bug fixing to me (unless I got the scope 
wrong).


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
May your Tongue stick to the Roof of your Mouth with the Force of a Thousand Caramels.


From david.adam.cnrs at gmail.com  Tue Jun 10 08:26:32 2008
From: david.adam.cnrs at gmail.com (David Adam)
Date: Tue, 10 Jun 2008 15:26:32 +0200
Subject: ddraw: Fix Setmaterial with a test
Message-ID: <5f9140a20806100626jb88e6b7x311dbaa3b8601028@mail.gmail.com>

>David Adam wrote:
>>* The test succeded in my windows XP box.
*>>*
*>You have only ddraw test and no d3d test.
>
>Vitaliy.

Giving a NULL value to SetMaterial in d3d9 or d3d8 makes Windows crashes.
It is a forbidden value (see bug 13646). So, no test can be performed
for d3d8 and d3d9.

I sent a patch to removed these test earlier.

David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080610/7784939e/attachment.htm 

From julliard at winehq.org  Tue Jun 10 13:17:20 2008
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 10 Jun 2008 20:17:20 +0200
Subject: wininet: Make sure URL is terminated in InternetCrackUrlA.
In-Reply-To: <alpine.DEB.1.10.0806101705490.23002@amboise.dolphin> (Francois
	Gouget's message of "Tue, 10 Jun 2008 17:16:02 +0200 (CEST)")
References: <200806091355.08140.hans@it.vu.nl>
	<87fxrmhcfz.fsf@wine.dyndns.org> <200806101207.38217.hans@it.vu.nl>
	<alpine.DEB.1.10.0806101705490.23002@amboise.dolphin>
Message-ID: <87lk1df93j.fsf@wine.dyndns.org>

Francois Gouget <fgouget at free.fr> writes:

> Why not? It's a bug fix and four places to fix sounds quite reasonable 
> (>100 may not be). Maybe it's just me but I didn't feel like 1.0 would 
> entail a deep deep freeze period where only critical/security bugs would 
> be fixed.

At this point the freeze is pretty strict, since the plan is to release
next week.

> Also I don't feel that the current state of Wine (or of the future Wine 
> 1.0) is such a marvel of perfection that it justifies a deep freeze to 
> make sure it's not going to get a tiny little scratch here or there.

Tiny scratches are not a problem, the problem is that in many cases you
can't really know if a patch is going to cause only a tiny scratch or a
major failure; the only way to know is to put it in and wait for the
users' screams, and that's not a risk we want to take at this point.

So patches that are not obviously safe will have to wait; that sort of
fix is certainly a candidate for inclusion in 1.0.1, once it has cooked
for a bit in the post-1.0 devel branch.

-- 
Alexandre Julliard
julliard at winehq.org


From truiken at gmail.com  Tue Jun 10 19:15:07 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 10 Jun 2008 19:15:07 -0500
Subject: user32: Allow a NULL foreground window in the tests
In-Reply-To: <1BA927F352D3457BBB7BEDA210AFEE73@DMITRY>
References: <22821af30805290755i3c0ef390w34f946abd1199670@mail.gmail.com>
	<300C02AB64C44487B18D6E5CC9E31489@DMITRY>
	<22821af30805290813k727e0ebl451b0e92208aa378@mail.gmail.com>
	<1566C26A35024168AE429ED197788C4B@DMITRY>
	<22821af30805290835v45618ec7h1e80b4d985112aee@mail.gmail.com>
	<1BA927F352D3457BBB7BEDA210AFEE73@DMITRY>
Message-ID: <22821af30806101715t4e84dfeft65dffd4c76728b5b@mail.gmail.com>

On Thu, May 29, 2008 at 8:24 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> "James Hawkins" <truiken at gmail.com> wrote:
>
>> Passing 0 for the foreground window essentially disables the test,
>> whereas allowing a NULL window is testing another variation of what
>> can happen with the foreground window, just like if a last error is,
>> e.g.,  ERROR_FILE_NOT_FOUND on one platform instead of
>> ERROR_PATH_NOT_FOUND.  Your method disables the test completely.
>
> Yes, passing foreground == 0 disables the foreground window test. That
> should be done very carefully for the tests that always fail. I'd expect
> for instance test_SetActiveWindow() and test_SetForegroundWindow() not
> need to disable it.
>

I've debugged this a bit more, and when running the user32:win test
within the winetest.exe program, all checked calls to
GetForegroundWindow return NULL.  When running the user32:win test by
itself from the command line, only 7 tests fail the
GetForegroundWindow call (compared to 40).  This makes me wonder about
the behavior of GetForegroundWindow in a child process window, but I'm
not really sure where to go from here.

-- 
James Hawkins


From truiken at gmail.com  Tue Jun 10 19:28:20 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 10 Jun 2008 19:28:20 -0500
Subject: user32: Allow a NULL foreground window in the tests
In-Reply-To: <22821af30806101715t4e84dfeft65dffd4c76728b5b@mail.gmail.com>
References: <22821af30805290755i3c0ef390w34f946abd1199670@mail.gmail.com>
	<300C02AB64C44487B18D6E5CC9E31489@DMITRY>
	<22821af30805290813k727e0ebl451b0e92208aa378@mail.gmail.com>
	<1566C26A35024168AE429ED197788C4B@DMITRY>
	<22821af30805290835v45618ec7h1e80b4d985112aee@mail.gmail.com>
	<1BA927F352D3457BBB7BEDA210AFEE73@DMITRY>
	<22821af30806101715t4e84dfeft65dffd4c76728b5b@mail.gmail.com>
Message-ID: <22821af30806101728i73f1d6fdx9a16cce37de4faed@mail.gmail.com>

On Tue, Jun 10, 2008 at 7:15 PM, James Hawkins <truiken at gmail.com> wrote:
> On Thu, May 29, 2008 at 8:24 PM, Dmitry Timoshkov
> <dmitry at codeweavers.com> wrote:
>> "James Hawkins" <truiken at gmail.com> wrote:
>>
>>> Passing 0 for the foreground window essentially disables the test,
>>> whereas allowing a NULL window is testing another variation of what
>>> can happen with the foreground window, just like if a last error is,
>>> e.g.,  ERROR_FILE_NOT_FOUND on one platform instead of
>>> ERROR_PATH_NOT_FOUND.  Your method disables the test completely.
>>
>> Yes, passing foreground == 0 disables the foreground window test. That
>> should be done very carefully for the tests that always fail. I'd expect
>> for instance test_SetActiveWindow() and test_SetForegroundWindow() not
>> need to disable it.
>>
>
> I've debugged this a bit more, and when running the user32:win test
> within the winetest.exe program, all checked calls to
> GetForegroundWindow return NULL.  When running the user32:win test by
> itself from the command line, only 7 tests fail the
> GetForegroundWindow call (compared to 40).  This makes me wonder about
> the behavior of GetForegroundWindow in a child process window, but I'm
> not really sure where to go from here.
>

Some more information: these 40 GetForegroundWindow failures occur on
all platforms >= win2k.

-- 
James Hawkins


From dmitry at codeweavers.com  Tue Jun 10 21:36:07 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 11 Jun 2008 11:36:07 +0900
Subject: user32: Allow a NULL foreground window in the tests
References: <22821af30805290755i3c0ef390w34f946abd1199670@mail.gmail.com><300C02AB64C44487B18D6E5CC9E31489@DMITRY><22821af30805290813k727e0ebl451b0e92208aa378@mail.gmail.com><1566C26A35024168AE429ED197788C4B@DMITRY><22821af30805290835v45618ec7h1e80b4d985112aee@mail.gmail.com><1BA927F352D3457BBB7BEDA210AFEE73@DMITRY>
	<22821af30806101715t4e84dfeft65dffd4c76728b5b@mail.gmail.com>
Message-ID: <05AEBB1202DB4DC187B74107ECCD96C4@DMITRY>

"James Hawkins" <truiken at gmail.com> wrote:

> I've debugged this a bit more, and when running the user32:win test
> within the winetest.exe program, all checked calls to
> GetForegroundWindow return NULL.  When running the user32:win test by
> itself from the command line, only 7 tests fail the
> GetForegroundWindow call (compared to 40).  This makes me wonder about
> the behavior of GetForegroundWindow in a child process window, but I'm
> not really sure where to go from here.

I'd suggest to make winetest minimize itself before running the tests.

-- 
Dmitry.


From wine-devel at kievinfo.com  Tue Jun 10 22:09:28 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 10 Jun 2008 21:09:28 -0600
Subject: ddraw: Fix Setmaterial with a test
In-Reply-To: <5f9140a20806100626jb88e6b7x311dbaa3b8601028@mail.gmail.com>
References: <5f9140a20806100626jb88e6b7x311dbaa3b8601028@mail.gmail.com>
Message-ID: <484F41E8.3060706@kievinfo.com>

David Adam wrote:
>>David Adam wrote:
>>>/ The test succeded in my windows XP box.
> />>/ 
> />You have only ddraw test and no d3d test.
>>
>>Vitaliy.
> 
> Giving a NULL value to SetMaterial in d3d9 or d3d8 makes Windows crashes. 
> 
> It is a forbidden value (see bug 13646). So, no test can be performed for d3d8 and d3d9.
> 
> I sent a patch to removed these test earlier.
> 
So why are you adding the check that is not present on windows? What are th 
reasoning to have this if it clearly absent in native implementation?

Vitaliy.


From jeffzaroyko at gmail.com  Wed Jun 11 02:16:48 2008
From: jeffzaroyko at gmail.com (Jeff Zaroyko)
Date: Wed, 11 Jun 2008 17:16:48 +1000
Subject: ddraw: modify Direct3D device name
In-Reply-To: <f5d9424f0806100524v7380fd79i209da8578a81ed37@mail.gmail.com>
References: <f5d9424f0806100035j44365694j3c1c6e6b92d2067c@mail.gmail.com>
	<004001c8cae7$9a12ab30$ce380190$@at>
	<f5d9424f0806100524v7380fd79i209da8578a81ed37@mail.gmail.com>
Message-ID: <f5d9424f0806110016i4642663cl152ccda284571946@mail.gmail.com>

On Tue, Jun 10, 2008 at 10:24 PM, Jeff Zaroyko <jeffzaroyko at gmail.com> wrote:
> On Tue, Jun 10, 2008 at 8:49 PM, Stefan D?singer <stefandoesinger at gmx.at> wrote:
>>> Descent FreeSpace: The Great War and Descent FreeSpace 2 fail to detect
>>> hardware acceleration through Direct3D when enumerating devices, they
>>> expect the device name string to begin with "Direct3D - "
>>>
>>> This patch enables the Direct3D mode to be used.
>> I am not entirely sure about this. I think there were other apps(Quicktime?)
>> which depend on some other name.
>>
>> I think the best is to see which name Windows uses, make ddraw.dll read the
>> name from WineD3D, and make WineD3D return the same name Windows does for
>> the detected card.
>>
>
> I think you're thinking of DirectDraw HAL which there is specific
> mention of quicktime
> in ddraw/main.c, my patch doesn't touch this, it corrects the string
> for Direct3D HAL
>

It appears I was mistaken, I confused two different programs by the
same name, one which used Direct3D and another which did not, so my
patch is incorrect.

I created some new ddraw tests that print out these various strings to
help understand what was what on Windows vs Wine.

For those who are curious, I've published a colourful diff between
what Wine returns vs Windows.

Wine vs Windows 98 with nvidia fx 5200 -
http://jeffz.name/wine/enum/wine-vs-win98-nvidia.html
Wine vs Windows XP with ati 9600 -
http://jeffz.name/wine/enum/wine-vs-winxp-ati9600.html


From david.adam.cnrs at gmail.com  Wed Jun 11 02:26:22 2008
From: david.adam.cnrs at gmail.com (David Adam)
Date: Wed, 11 Jun 2008 09:26:22 +0200
Subject: ddraw: Fix Setmaterial with a test
In-Reply-To: <484F41E8.3060706@kievinfo.com>
References: <5f9140a20806100626jb88e6b7x311dbaa3b8601028@mail.gmail.com>
	<484F41E8.3060706@kievinfo.com>
Message-ID: <5f9140a20806110026td6e01e4ybc0b9ab16bb3a87c@mail.gmail.com>

I sent a patch to removed these test earlier.

>
>>  So why are you adding the check that is not present on windows? What are
> th reasoning to have this if it clearly absent in native implementation?


That's why I removed it form wined3d. I set the check in ddraw, since only
ddraw checks it.

David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080611/26f26938/attachment.htm 

From dmitry at codeweavers.com  Wed Jun 11 07:55:44 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 11 Jun 2008 21:55:44 +0900
Subject: Wine + Fedora
References: <loom.20080609T103515-438@post.gmane.org>
	<5274B21A051D45B483E198FFD82D7DFF@DMITRY>
Message-ID: <CE9ED0397EB944DB9B1B4BEDFF7EC22B@DMITRY>

"Dmitry Timoshkov" <dmitry at codeweavers.com> wrote:

> "Louis Lenders" <xerox_xerox2000 at yahoo.co.uk> wrote:
> 
>> Hi, just thought dropping a note here so you'd know: the troubles reported for
>> wine+fedora 9, now also affect fedora 8. Last saturday i did a 'yum update', and
>> after that about all wine-applications froze my computer. Only a hard reboot
>> helped...
>> 
>> Solved it by reverting back to kernel 2.6.24.7-92.fc8
>> 
>> Just in case a new wine-1.0 release comes out, and fedora-users start whining
>> "wine 1.0 is really crap, it freezes my computer" , hope this will be fixed soon.
> 
> I'd suggest to post the comments and requests here:
> 
> https://bugzilla.redhat.com/show_bug.cgi?id=443552

According to the above link the bug should be fixed in 2.6.25.6-54,
can somebody conform that?

-- 
Dmitry.


From wine-devel at kievinfo.com  Wed Jun 11 08:43:02 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 11 Jun 2008 07:43:02 -0600
Subject: ddraw: Fix Setmaterial with a test
In-Reply-To: <5f9140a20806110026td6e01e4ybc0b9ab16bb3a87c@mail.gmail.com>
References: <5f9140a20806100626jb88e6b7x311dbaa3b8601028@mail.gmail.com>	
	<484F41E8.3060706@kievinfo.com>
	<5f9140a20806110026td6e01e4ybc0b9ab16bb3a87c@mail.gmail.com>
Message-ID: <484FD666.3040604@kievinfo.com>

David Adam wrote:
> I sent a patch to removed these test earlier.
> 
> 
>     So why are you adding the check that is not present on windows? What
>     are th reasoning to have this if it clearly absent in native
>     implementation?
> 
> 
> That's why I removed it form wined3d. I set the check in ddraw, since 
> only ddraw checks it.
> 
> David
> 
Ok makes sense.

Vitaliy.


From wine-devel at kievinfo.com  Wed Jun 11 08:58:35 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 11 Jun 2008 07:58:35 -0600
Subject: dsound: notification order
In-Reply-To: <200806111401.31112.uli@suse.de>
References: <200806111401.31112.uli@suse.de>
Message-ID: <484FDA0B.5060802@kievinfo.com>

Ulrich Hecht wrote:
> Hi!
> 
> This fixes sound in Ootake (http://www.ouma.jp/ootake/). Looks like 
> DSBPN_OFFSETSTOP is not always the last element.
> 
> -		/* DSBPN_OFFSETSTOP has to be the last element. So this is */
> -		/* OK. [Inside DirectX, p274] */
> -		/*  */
> -		/* This also means we can't sort the entries by offset, */
> -		/* because DSBPN_OFFSETSTOP == -1 */
> +		/* DSBPN_OFFSETSTOP is not necessarily the last element. */
Don't remove all the comments. They are still mostly valid. Just add that it's
not always true for some broken apps.

>  		if (offset == DSBPN_OFFSETSTOP) {
>  			if (dsb->state == STATE_STOPPED) {
>  				SetEvent(event->hEventNotify);
>  				TRACE("signalled event %p (%d)\n", event->hEventNotify, i);
> -				return;
> -			} else
> -				return;


Much better fix and easier to understand would be replacing "returns" for "continue".
Then you won't need to reformat the whole block. Something like:

@@ -247,9 +247,8 @@ void DSOUND_CheckEvent(const IDirectSoundBufferImpl *dsb, DWORD playpos, int len
                        if (dsb->state == STATE_STOPPED) {
                                SetEvent(event->hEventNotify);
                                TRACE("signalled event %p (%d)\n", event->hEventNotify, i);
-                               return;
-                       } else
-                               return;
+                       }
+                       continue;


Vitaliy.


From alantbox at gmail.com  Wed Jun 11 09:44:55 2008
From: alantbox at gmail.com (Alexandrov Anton)
Date: Wed, 11 Jun 2008 18:44:55 +0400
Subject: Compiling wine-1.0-rc3
Message-ID: <484FE4E7.1060600@gmail.com>

Good afternoon.

I tried to compile wine-1.0-rc3 and got this message:
------
../../tools/winegcc/winegcc -B../../tools/winebuild -shared 
./acledit.spec    main.o       -o acledit.dll.so  -lkernel32   
../../libs/port/libwine_port.a
winebuild: Cannot read main.o
winegcc: ../../tools/winebuild/winebuild failed
------
I hadn't use any special options (only "./configure", "make depend && 
make").

gcc version: 4.1.2
linux kernel: 2.6.24

-- 
All the best, Alexandrov Anton.



From stefandoesinger at gmx.at  Wed Jun 11 11:16:45 2008
From: stefandoesinger at gmx.at (=?windows-1252?Q?Stefan_D=F6singer?=)
Date: Wed, 11 Jun 2008 18:16:45 +0200
Subject: ddraw: Fix Setmaterial with a test
In-Reply-To: <484F41E8.3060706@kievinfo.com>
References: <5f9140a20806100626jb88e6b7x311dbaa3b8601028@mail.gmail.com>
	<484F41E8.3060706@kievinfo.com>
Message-ID: <000001c8cbde$8c454fb0$a4cfef10$@at>

> So why are you adding the check that is not present on windows? What
> are th
> reasoning to have this if it clearly absent in native implementation?
As I understand it, native ddraw.dll(d3d7) has the check, while d3d8/d3d9 do
not. Thus he removed it from WineD3D to have the same behavior as native in
d3d8 and d3d9, and added it to ddraw to check it there(as native does)




From kgbricola at web.de  Wed Jun 11 11:33:15 2008
From: kgbricola at web.de (=?ISO-8859-1?Q?Rico_Sch=FCller?=)
Date: Wed, 11 Jun 2008 18:33:15 +0200
Subject: Add German translation for xcopy
In-Reply-To: <1213118416.4470.59.camel@hermes2.karcher.local>
References: <1213118416.4470.59.camel@hermes2.karcher.local>
Message-ID: <484FFE4B.5010102@web.de>

Michael Karcher wrote:
> ---
>  programs/xcopy/De.rc   |   79 ++++++++++++++++++++++++++++++++++++++++++++++++
>  programs/xcopy/rsrc.rc |    1 +
>  2 files changed, 80 insertions(+), 0 deletions(-)
>  create mode 100644 programs/xcopy/De.rc
> 
> 
> ------------------------------------------------------------------------
> 
> 
Does this work for you? When I apply the attached patch and run

wine xcopy /?

I get garbled German umlauts in the output (also tried with 
SUBLANG_NEUTRAL) . Is it the same for you?

I think you forgot something to translate:
STRING_INVPARM,  "Unbekannter Parameter '%s' -  Use xcopy /? for help\n"
should be something like
STRING_INVPARM,  "Unbekannter Parameter '%s' -  xcopy /? zeigt Hilfe an\n"

Cheers
Rico


From mikolaj at zalewski.pl  Wed Jun 11 11:45:23 2008
From: mikolaj at zalewski.pl (=?UTF-8?B?TWlrb8WCYWogWmFsZXdza2k=?=)
Date: Wed, 11 Jun 2008 18:45:23 +0200
Subject: Add German translation for xcopy
In-Reply-To: <484FFE4B.5010102@web.de>
References: <1213118416.4470.59.camel@hermes2.karcher.local>
	<484FFE4B.5010102@web.de>
Message-ID: <48500123.7070009@zalewski.pl>


>Does this work for you? When I apply the attached patch and run
>
>wine xcopy /?
>
>I get garbled German umlauts in the output (also tried with 
>SUBLANG_NEUTRAL) . Is it the same for you?
>  
>
  Wine console applications output in the OEMCP (i.e. the DOS codepage 
for the given locale) that is usually different from the Unix console 
charset. It works if you run the program in a wine console (`wineconsole 
cmd` and run 'xcopy /?' there). I think, Wine should detect if the 
output is a Unix tty and do a conversion from OEMCP to UNIXCP, but 
that's not something that could be done before Wine 1.0.

Miko?aj Zalewski


From truiken at gmail.com  Wed Jun 11 12:20:47 2008
From: truiken at gmail.com (James Hawkins)
Date: Wed, 11 Jun 2008 12:20:47 -0500
Subject: [PATCH] shell32: SHFileOperation: test added
In-Reply-To: <200806112101.28808.vitperov@etersoft.ru>
References: <200806112101.28808.vitperov@etersoft.ru>
Message-ID: <22821af30806111020p35639838rbc53319b99714e04@mail.gmail.com>

On Wed, Jun 11, 2008 at 12:01 PM, Vitaly Perov <vitperov at etersoft.ru> wrote:
> Changelog:
>  - shell32: test added. It check whether SHFileOperation could correctly work
> with input files mask '*.*'
>

+    retval = SHFileOperationA(&shfo);
+        ok(retval == ERROR_SUCCESS, "Expected ERROR_SUCCESS, got
%d\n", retval);
+    ok(!file_exists("testdir2\\one.txt"), "Expected one.txt to not exist\n");

Please don't add more of the weird spacing for the ok's.  That is a
byproduct of a huge patch that I sent to reduce the number of changes,
and it just hasn't been fixed yet.

-- 
James Hawkins


From thestig at google.com  Wed Jun 11 16:20:44 2008
From: thestig at google.com (Lei Zhang)
Date: Wed, 11 Jun 2008 14:20:44 -0700
Subject: unhide .update-timestamp
Message-ID: <558b2f5c0806111420l20df2baepc1c882effc85d528@mail.gmail.com>

Hi,

Can we rename $WINEPREFIX/.update-timestamp to
$WINEPREFIX/update-timestamp? There's been times when I cleaned my
$WINEPREFIX directory by going into that directory and running rm
-Rf... except .update-timestamp didn't get removed. Then I run wine,
but wineboot is a bit confused and does not invoke
InstallHinfSectionW(), thus creating a $WINEPREFIX/drive_c with lots
of missing files.


From wine-devel at kievinfo.com  Wed Jun 11 17:56:27 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 11 Jun 2008 16:56:27 -0600
Subject: Wine-1.0 release notes
Message-ID: <4850581B.2080708@kievinfo.com>

Since all of the 1.0 blocker bugs being pushed back, wine-1.0 release notes 
should list all of those as major known problems. Otherwise people will get 
a bad impression that wine-1.0 means more then less working release.

Also release notes should mention that wine-1.0 is not suitable for most 
games (new or old) for numerous reasons, including video driver bugs, sound 
and video conflicts with default system setups, unavailability of required 
features from X server etc.

And that wine-1.0 will not work at all for majority of people using other 
then default input methods.


In short - that after everyone's hard work and 15 years of development 
wine-1.0 is just a release tag nothing more.

Vitaliy.


From zgs at seas.upenn.edu  Wed Jun 11 17:59:07 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Wed, 11 Jun 2008 18:59:07 -0400
Subject: Revert "wined3d: Preload target in ActivateContext() for
	ORM_BACKBUFFER/ORM_PBUFFER."
In-Reply-To: <87ve0qalwt.fsf@wine.dyndns.org>
References: <48437C07.2010101@kievinfo.com>
	<200806020913.13429.stefandoesinger@gmx.at>
	<87ve0qalwt.fsf@wine.dyndns.org>
Message-ID: <b050a5e70806111559l44fd4b3ra8cd5da2a8f4cd21@mail.gmail.com>

On Tue, Jun 3, 2008 at 5:49 AM, Alexandre Julliard <julliard at winehq.org> wrote:
> Stefan D?singer <stefandoesinger at gmx.at> writes:
>
>> Am Montag, 2. Juni 2008 06:50:15 schrieb Vitaliy Margolen:
>>> This reverts commit 2d0016c5bc872afb562727278cfd341cea182600.
>>> Partially fixes bug 11584.
>> I think we can revert that patch(ie, apply this patch). I haven't had time to
>> look over the code yet, but I can't think of any problems this would cause.
>
> It does cause problems:
>
> ../../../tools/runtest -q -P wine -M d3d8.dll -T ../../.. -p d3d8_test.exe.so visual.c && touch visual.ok
> visual.c:709: Test failed: Offscreen failed: Got color 0x00000000, expected 0x00ffffff.
> visual.c:712: Test failed: Offscreen failed: Got color 0x00000000, expected 0x00ff00ff.
> visual.c:890: Test failed: SRCALPHA on texture returned color 00000000, expected bar
> visual.c:897: Test failed: DSTALPHA on texture returned color 00000000, expected foo
> make[2]: *** [visual.ok] Error 4
>
> --
> Alexandre Julliard
> julliard at winehq.org
>
>
>


Proposal: Revert the commit referenced in bug #11584 before this
Friday, so it can be tested in rc5.  I think the weight of the
following is greater than breaking a test (making the test a todo for
now would be a good idea I think).  Also, there's no reason to keep
the patch reverted post 1.0 as devs continue to make progress towards
a proper solution.

First, the list of applications thought to be broken by the patch as
documented in bugzilla (more may exist):

Call of Duty 4 (11584 itself)
Psychonauts  (11630)
Fifa 2006 world
Supreme Commander
Oblivion (Maybe?)

So why not wait for 1.0.1?  Of the remaining 1.0 bugs this is the
biggest one known to have broken a large number of *popular* games.
In addition as soon as 1.0 is released the floodgates will open for
patches and wine may not be stable enough to release again for a few
weeks.  This leaves all of the gamers who downloaded 1.0 [for these
games] out in the cold without a package which includes a fix and a
sour taste in their mouths.

Steve D. has been making good progress towards finding a proper fix
for this bug; however by no means should we put pressure on him to
have this bug fixed by Friday.  Thus I propose we revert the initial
commit for now, test it during rc5 to make sure things work again, and
then allow Steve to properly fix the bug post 1.0.

-Zach


From austinenglish at gmail.com  Wed Jun 11 18:21:37 2008
From: austinenglish at gmail.com (Austin English)
Date: Wed, 11 Jun 2008 18:21:37 -0500
Subject: Revert "wined3d: Preload target in ActivateContext() for
	ORM_BACKBUFFER/ORM_PBUFFER."
In-Reply-To: <b050a5e70806111559l44fd4b3ra8cd5da2a8f4cd21@mail.gmail.com>
References: <48437C07.2010101@kievinfo.com>
	<200806020913.13429.stefandoesinger@gmx.at>
	<87ve0qalwt.fsf@wine.dyndns.org>
	<b050a5e70806111559l44fd4b3ra8cd5da2a8f4cd21@mail.gmail.com>
Message-ID: <b6bb06270806111621t521f5af9h185a308aa85954e8@mail.gmail.com>

On Wed, Jun 11, 2008 at 5:59 PM, Zachary Goldberg <zgs at seas.upenn.edu> wrote:
> Proposal: Revert the commit referenced in bug #11584 before this
> Friday, so it can be tested in rc5.  I think the weight of the
> following is greater than breaking a test (making the test a todo for
> now would be a good idea I think).  Also, there's no reason to keep
> the patch reverted post 1.0 as devs continue to make progress towards
> a proper solution.
>
> First, the list of applications thought to be broken by the patch as
> documented in bugzilla (more may exist):
>
> Call of Duty 4 (11584 itself)
> Psychonauts  (11630)
> Fifa 2006 world
> Supreme Commander
> Oblivion (Maybe?)
>
> So why not wait for 1.0.1?  Of the remaining 1.0 bugs this is the
> biggest one known to have broken a large number of *popular* games.
> In addition as soon as 1.0 is released the floodgates will open for
> patches and wine may not be stable enough to release again for a few
> weeks.  This leaves all of the gamers who downloaded 1.0 [for these
> games] out in the cold without a package which includes a fix and a
> sour taste in their mouths.
>
> Steve D. has been making good progress towards finding a proper fix
> for this bug; however by no means should we put pressure on him to
> have this bug fixed by Friday.  Thus I propose we revert the initial
> commit for now, test it during rc5 to make sure things work again, and
> then allow Steve to properly fix the bug post 1.0.
>
> -Zach
>
>
>

+1

Stefan/Roderick, any idea how long a patch would take to write to
either fix this properly or revert the broken parts of the patch and
adjust the tests accordingly?


From winehacker at gmail.com  Wed Jun 11 18:24:05 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Wed, 11 Jun 2008 19:24:05 -0400
Subject: Wine-1.0 release notes
In-Reply-To: <4850581B.2080708@kievinfo.com>
References: <4850581B.2080708@kievinfo.com>
Message-ID: <19e31a080806111624q68c386b1vc7ace67a5823c3ca@mail.gmail.com>

On Wed, Jun 11, 2008 at 6:56 PM, Vitaliy Margolen
<wine-devel at kievinfo.com> wrote:
> In short - that after everyone's hard work and 15 years of development
> wine-1.0 is just a release tag nothing more.

I think this deserves more discussion but I am not quite ready. I'll
post a reply on Monday as an RFC to be addressed at wineconf.

Thanks
-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From stefandoesinger at gmx.at  Wed Jun 11 18:31:32 2008
From: stefandoesinger at gmx.at (=?windows-1252?Q?Stefan_D=F6singer?=)
Date: Thu, 12 Jun 2008 01:31:32 +0200
Subject: Revert "wined3d: Preload target in ActivateContext()
	for	ORM_BACKBUFFER/ORM_PBUFFER."
In-Reply-To: <b050a5e70806111559l44fd4b3ra8cd5da2a8f4cd21@mail.gmail.com>
References: <48437C07.2010101@kievinfo.com>	<200806020913.13429.stefandoesinger@gmx.at>	<87ve0qalwt.fsf@wine.dyndns.org>
	<b050a5e70806111559l44fd4b3ra8cd5da2a8f4cd21@mail.gmail.com>
Message-ID: <000601c8cc1b$48aa4200$d9fec600$@at>

> Proposal: Revert the commit referenced in bug #11584 before this
> Friday, so it can be tested in rc5.  I think the weight of the
> following is greater than breaking a test (making the test a todo for
> now would be a good idea I think).
The problem is that I added this broken PreLoad line(without understanding
that it was broken) because some game needed it. So its not just the test
that is broken. Reverting it will just trade broken app A against broken app
B.

I have one exam and one excersise done now, and I may have a bit of free
time the next days. Maybe I can find out something more about this problem,
but I can't promise. And if I find the real issue, the fix may be too
invasive for committing.

What I am a bit annoyed about this issue is that many people talked about
how important it is to get this fixed, or talked about reverting patch XYZ,
but nobody tried to find the real issue. Vitaliy did a lot of testing and
experimenting, which was very helpful to understand the bug better, and to
understand what is not a right fix. But all in all I think everybody waited
for one of the main d3d devs to magically fix this.

The bottom line: The next time don't release in June. Many Wine developers,
especially in the game area, are students, and May/June is exam season.
 



From scott at open-vote.org  Wed Jun 11 18:32:46 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Wed, 11 Jun 2008 16:32:46 -0700
Subject: Wine-1.0 release notes
In-Reply-To: <4850581B.2080708@kievinfo.com>
References: <4850581B.2080708@kievinfo.com>
Message-ID: <4850609E.1040509@open-vote.org>

Vitaliy Margolen wrote:
> Since all of the 1.0 blocker bugs being pushed back, wine-1.0 release notes 
> should list all of those as major known problems. Otherwise people will get 
> a bad impression that wine-1.0 means more then less working release.
> 
> Also release notes should mention that wine-1.0 is not suitable for most 
> games (new or old) for numerous reasons, including video driver bugs, sound 
> and video conflicts with default system setups, unavailability of required 
> features from X server etc.
> 
> And that wine-1.0 will not work at all for majority of people using other 
> then default input methods.
> 
> 
> In short - that after everyone's hard work and 15 years of development 
> wine-1.0 is just a release tag nothing more.
> 
> Vitaliy.
> 
> 

In any case, we should note why we're making a release in the first
place, and make it very clear that we believe Wine 1.0 to be the best
version of Wine yet in all cases (ie, no regressions).

Thanks,
Scott Ritchie


From scott at open-vote.org  Wed Jun 11 18:35:01 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Wed, 11 Jun 2008 16:35:01 -0700
Subject: Time to update Wine's status?
In-Reply-To: <1212861678.11761.3.camel@belthazor-saved>
References: <1212861678.11761.3.camel@belthazor-saved>
Message-ID: <48506125.6060202@open-vote.org>

Adam Petaccia wrote:
> http://winehq.org/site/status is the website showing Wine's status on
> implementing various DLLs, but it hasn't been updated in almost a year!
> The information is not only old, but Wine has added new DLLs that aren't
> listed. With Wine approaching its 1.0 release, perhaps it should be
> decided to update or remove the page.
> 
> My vote would be for updating, but I'm not sure where those stats come
> from, and that may take away from time better spent on bug hunting.
> 

I propose we get rid of the page altogether, it's pretty much useless
for figuring out how good Wine is.  This is unfortunate, since it's
often the first place people click.

Thanks,
Scott Ritchie


From alantbox at gmail.com  Wed Jun 11 14:14:52 2008
From: alantbox at gmail.com (Alexandrov Anton)
Date: Wed, 11 Jun 2008 23:14:52 +0400
Subject: Compiling wine-1.0-rc3 (2)
Message-ID: <4850242C.5030400@gmail.com>

Hello.

I solved this problem. In my case wine couldn't be compiled with 
"-malign-double" option. I compiled it successfully after I had removed 
this option in my $CFLAGS and $CXXFLAGS.

-- 
All the best, Alexandrov Anton.




From vitaliy at kievinfo.com  Wed Jun 11 18:27:58 2008
From: vitaliy at kievinfo.com (Vitaliy)
Date: Wed, 11 Jun 2008 17:27:58 -0600
Subject: Revert "wined3d: Preload target in ActivateContext() for
	ORM_BACKBUFFER/ORM_PBUFFER."
In-Reply-To: <b6bb06270806111621t521f5af9h185a308aa85954e8@mail.gmail.com>
References: <48437C07.2010101@kievinfo.com>	<200806020913.13429.stefandoesinger@gmx.at>	<87ve0qalwt.fsf@wine.dyndns.org>	<b050a5e70806111559l44fd4b3ra8cd5da2a8f4cd21@mail.gmail.com>
	<b6bb06270806111621t521f5af9h185a308aa85954e8@mail.gmail.com>
Message-ID: <48505F7E.6060506@kievinfo.com>

Austin English wrote:
> On Wed, Jun 11, 2008 at 5:59 PM, Zachary Goldberg <zgs at seas.upenn.edu> wrote:
>> Proposal: Revert the commit referenced in bug #11584 before this
>> Friday, so it can be tested in rc5.  I think the weight of the
>> following is greater than breaking a test (making the test a todo for
>> now would be a good idea I think).  Also, there's no reason to keep
>> the patch reverted post 1.0 as devs continue to make progress towards
>> a proper solution.
>>
>> First, the list of applications thought to be broken by the patch as
>> documented in bugzilla (more may exist):
>>
>> Call of Duty 4 (11584 itself)
>> Psychonauts  (11630)
>> Fifa 2006 world
>> Supreme Commander
>> Oblivion (Maybe?)
>>
>> So why not wait for 1.0.1?  Of the remaining 1.0 bugs this is the
>> biggest one known to have broken a large number of *popular* games.
>> In addition as soon as 1.0 is released the floodgates will open for
>> patches and wine may not be stable enough to release again for a few
>> weeks.  This leaves all of the gamers who downloaded 1.0 [for these
>> games] out in the cold without a package which includes a fix and a
>> sour taste in their mouths.
>>
>> Steve D. has been making good progress towards finding a proper fix
>> for this bug; however by no means should we put pressure on him to
>> have this bug fixed by Friday.  Thus I propose we revert the initial
>> commit for now, test it during rc5 to make sure things work again, and
>> then allow Steve to properly fix the bug post 1.0.
>>
>> -Zach
>>
>>
>>
> 
> +1
> 
> Stefan/Roderick, any idea how long a patch would take to write to
> either fix this properly or revert the broken parts of the patch and
> adjust the tests accordingly?
> 
> 
IMHO this is too little too late. There are at least 2 more calls to Preload 
that have exactly the same affect on some of my test games. It sure would be 
nice to "fix" at least one case which looks to be common for number of games.

Vitaliy.


From msclrhd at googlemail.com  Wed Jun 11 19:02:39 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Thu, 12 Jun 2008 01:02:39 +0100
Subject: Wine-1.0 release notes
In-Reply-To: <4850581B.2080708@kievinfo.com>
References: <4850581B.2080708@kievinfo.com>
Message-ID: <3f4fd2640806111702w20f99b77s21d4aa1f8197515c@mail.gmail.com>

2008/6/11 Vitaliy Margolen <wine-devel at kievinfo.com>:
> In short - that after everyone's hard work and 15 years of development
> wine-1.0 is just a release tag nothing more.

I think that this is overly harsh. It's like saying that you should
not celebrate a birthday, as that is just you aging just a day,
nothing more.

Wine is in a strange position as it is trying to make any Windows
application (ultimately) run on any suitable posix system with a
suitable X server. Given that a new version of Windows is usually
released every 2-3 years, with new features, APIs and functionality,
the landscape is constantly changing. Couple this with each successive
release of an application supporting newer technologies and APIs - the
set of which differs from application to application, makes it harder
to support.

Yes, regressions will happen. Yes, applications will crash/fail to
work. But think of all the applications that *do* work; given what
Wine is working against, this is an amasing achievement. Wine can and
does run Office, Photoshop, ITunes, Oblivion, Peggle and a myriad
other applications (some better than others).

So yes, highlight the known issues in the release notes, list the
major applications (with corresponding version numbers) that are known
to work and refer the user to the AppDB for more information. However,
don't sell it short either.

I am personally using Wine to run the Cepstral SwiftTalker
text-to-speech program, play Oberon/PopCap/casual games like Peggle,
Bejeweled 2 and Bloom on my Ubuntu laptop. I'm sure that other people
have other success stories as well, such as Susan Cragin, who uses
Dragon Naturally Speaking 9.

Maybe what we need is a "What I use Wine for" set of documents or
mini-articles where people describe what Windows applications they are
running, what works/does not work for them. Dan's Spouse test is also
a good idea. Perhaps we can get some feedback on the Spouses
experiences of using the applications under Wine.

NOTE: I have been testing various casual games from Oberon with the
various RC releases and have found that over 50% of those tested
(around 14 at the moment) worked out of the box when ran directly from
their install directory. While this does not seem a lot, given what
Wine is developing against, I think this is a huge success.

NOTE: I am not saying Wine is perfect, I'm saying that the message
should be positive and realistic instead of unduly negative.

- Reece


From epssyis at gmail.com  Wed Jun 11 19:27:36 2008
From: epssyis at gmail.com (Edward Savage)
Date: Thu, 12 Jun 2008 10:27:36 +1000
Subject: Time to update Wine's status?
In-Reply-To: <48506125.6060202@open-vote.org>
References: <1212861678.11761.3.camel@belthazor-saved>
	<48506125.6060202@open-vote.org>
Message-ID: <d6c5d7290806111727o4e524aa0w40eaa7543295c292@mail.gmail.com>

>
> I propose we get rid of the page altogether, it's pretty much useless
> for figuring out how good Wine is.  This is unfortunate, since it's
> often the first place people click.
>
> Thanks,
> Scott Ritchie
>
>
>

I found it very handy to track down details on mswsock the other day.

I suggest if it is to be removed instead dull it down by turning it in
to a list of dlls wine has and all available information in the form
of links for each dll is listed so that people can speedily find say
the msdn page or relevant wiki pages.  That way it would still be a
handy resource without being a pain to answer to users why a dll is
only 96.23% complete on an out dated page.


From wine-devel at kievinfo.com  Wed Jun 11 20:46:14 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 11 Jun 2008 19:46:14 -0600
Subject: Wine-1.0 release notes
In-Reply-To: <3f4fd2640806111702w20f99b77s21d4aa1f8197515c@mail.gmail.com>
References: <4850581B.2080708@kievinfo.com>
	<3f4fd2640806111702w20f99b77s21d4aa1f8197515c@mail.gmail.com>
Message-ID: <48507FE6.6040102@kievinfo.com>

Reece Dunn wrote:
> 2008/6/11 Vitaliy Margolen <wine-devel at kievinfo.com>:
>> In short - that after everyone's hard work and 15 years of development
>> wine-1.0 is just a release tag nothing more.
> 
> I think that this is overly harsh. It's like saying that you should
> not celebrate a birthday, as that is just you aging just a day,
> nothing more.

If birthdays would start coming every 2 weeks after about 100's you will 
loose track and won't care anymore which one it is.

> Wine is in a strange position as it is trying to make any Windows
> application (ultimately) run on any suitable posix system with a
> suitable X server. Given that a new version of Windows is usually
> released every 2-3 years, with new features, APIs and functionality,
I wouldn't go that far. Win2k was released in ... 2000. XP (which has some 
number of additions over win2k) was release in 2003 with minor additions in 
2004 and 2005. And no one in their right mind makes Vista only versions. 
That gives us what? 8 years.

No this argument don't fly - not much is changing in the win32api world, or 
MS would risk killing all their legacy stuff - which is the only reason 
windows is still being used.

> Yes, regressions will happen. Yes, applications will crash/fail to
> work. But think of all the applications that *do* work; given what
That's the problem. After identifying a regression it should be fixed. 
During the code freeze, the changes should be reverted, especially if this 
is new functionality that's having issues. And where were are with those? We 
have a big list of regressions introduced by major changes to different 
parts of Wine either right before the code freeze or during(!) the code 
freeze. And most of those regressions are still not dealt with.

I'm not blaming anyone as I'm guilty creating regressions in the past. 
However the goal needs to shift from getting new features in, to stabilizing 
and bug fixing. And ~1 month for that is not enough, considering that it 
takes so long to fix some of the problems. I was really surprised to see 
_ANY_ new features getting into Wine in the last 2 months. Let alone major 
ones like XIM, child X windows, pixel formats.


> NOTE: I am not saying Wine is perfect, I'm saying that the message
> should be positive and realistic instead of unduly negative.

I did not meant to make it sound that negative. After all each new version 
of Wine had number of important features and loads of bug fixes. Which is 
great on it's own. Just don't make wine-1.0 anything more then it really is 
- new release with bug fixes and no new features.


Vitaliy


From susancragin at earthlink.net  Wed Jun 11 20:51:42 2008
From: susancragin at earthlink.net (Susan Cragin)
Date: Wed, 11 Jun 2008 21:51:42 -0400 (GMT-04:00)
Subject: Wine-1.0 release notes
Message-ID: <30349742.1213235502839.JavaMail.root@elwamui-polski.atl.sa.earthlink.net>

I would agree and go further. 
Wine has made Linux handicapped-accessible for a great number of people, including me, who have mild repetitive-motion difficulties that make typing for any length of time uncomfortable. 
Many of the people who use Linux are programmers and are technically proficient, and they seem to want a lot from their computer, but here I sit, comfortably churning out text at the rate of almost the spoken word. I transcribe interviews, write letters, complain to my congresspeople, and am writing this, with no effort (and sometimes, not much thought either, because you see, it's not an effort to type).
Dragon NaturallySpeaking is a tremendously complex program, and it is a miracle that it has been made to run on Linux. Now, it runs in basic form. Many of its "special features" don't work. But on the other hand, if it were being sold as simply a text recognition medium, it would still sell. That's what it does well. It recognizes spoken words and writes them down, fast. 
In addition, I expect that soon wine and Linux will run Dragon NaturallySpeaking faster than Windows will. Windows Vista will run it better, because more of its features will be enabled, but Linux will run it faster.
And faster means better, means more words PLUS more accurate recognition. As soon as some of the bugs get worked out Ubuntu and ALSA sound, and I get better accuracy scores from my microphone, I expect Dragon NaturallySpeaking to recognize text better on Linux than it does on Windows. 
What that means for transcription services, for court reporting, etc., is anybody's guess. But I plan to find out when I take a speed test on the last day of July.
Dragon NaturallySpeaking is a unique program. Just ask those folks at IBM who worked on ViaVoice. That program was abandoned. Ask the people at Carnegie Mellon who worked on Sphinx for Linux. Ask Microsoft, which is trying to develop its own. Dragon NaturallySpeaking is the type of program that isn't going to have a rival for 10 years.

Now that I've gotten that particular rant off my chest -- and don't worry about my fingers, it only took me a minute to do it -- I'd like to mention another very useful program that wine runs flawlessly. This is keynote, a note-taking program used by academic researchers.

Here is another little thought to ponder. Massachusetts USA developed a state requirement for "open document format" but it has been delayed because, as one lobbyist put it, "there are no office applications with native ODF support that provide accessibility for persons who use assistive technology devices."

I mean, how proud do we need to be about not running everything? 

Susan

-----Original Message-----
>From: Reece Dunn <msclrhd at googlemail.com>
>Sent: Jun 11, 2008 8:02 PM
>To: Vitaliy Margolen <wine-devel at kievinfo.com>
>Cc: Wine Develop <wine-devel at winehq.org>
>Subject: Re: Wine-1.0 release notes
>
>2008/6/11 Vitaliy Margolen <wine-devel at kievinfo.com>:
>> In short - that after everyone's hard work and 15 years of development
>> wine-1.0 is just a release tag nothing more.
>
>I think that this is overly harsh. It's like saying that you should
>not celebrate a birthday, as that is just you aging just a day,
>nothing more.
>
>Wine is in a strange position as it is trying to make any Windows
>application (ultimately) run on any suitable posix system with a
>suitable X server. Given that a new version of Windows is usually
>released every 2-3 years, with new features, APIs and functionality,
>the landscape is constantly changing. Couple this with each successive
>release of an application supporting newer technologies and APIs - the
>set of which differs from application to application, makes it harder
>to support.
>
>Yes, regressions will happen. Yes, applications will crash/fail to
>work. But think of all the applications that *do* work; given what
>Wine is working against, this is an amasing achievement. Wine can and
>does run Office, Photoshop, ITunes, Oblivion, Peggle and a myriad
>other applications (some better than others).
>
>So yes, highlight the known issues in the release notes, list the
>major applications (with corresponding version numbers) that are known
>to work and refer the user to the AppDB for more information. However,
>don't sell it short either.
>
>I am personally using Wine to run the Cepstral SwiftTalker
>text-to-speech program, play Oberon/PopCap/casual games like Peggle,
>Bejeweled 2 and Bloom on my Ubuntu laptop. I'm sure that other people
>have other success stories as well, such as Susan Cragin, who uses
>Dragon Naturally Speaking 9.
>
>Maybe what we need is a "What I use Wine for" set of documents or
>mini-articles where people describe what Windows applications they are
>running, what works/does not work for them. Dan's Spouse test is also
>a good idea. Perhaps we can get some feedback on the Spouses
>experiences of using the applications under Wine.
>
>NOTE: I have been testing various casual games from Oberon with the
>various RC releases and have found that over 50% of those tested
>(around 14 at the moment) worked out of the box when ran directly from
>their install directory. While this does not seem a lot, given what
>Wine is developing against, I think this is a huge success.
>
>NOTE: I am not saying Wine is perfect, I'm saying that the message
>should be positive and realistic instead of unduly negative.
>
>- Reece
>
>





From wine-devel at kievinfo.com  Wed Jun 11 20:52:41 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 11 Jun 2008 19:52:41 -0600
Subject: Wine-1.0 release notes
In-Reply-To: <4850609E.1040509@open-vote.org>
References: <4850581B.2080708@kievinfo.com> <4850609E.1040509@open-vote.org>
Message-ID: <48508169.2090407@kievinfo.com>

Scott Ritchie wrote:
> In any case, we should note why we're making a release in the first
> place, and make it very clear that we believe Wine 1.0 to be the best
> version of Wine yet in all cases (ie, no regressions).

I'd disagree on "the best" part. Looking at bugzilla and forum people thing 
that 0.9.58 and possibly older would qualify more.

In fact, if we would have taken some old version, say 0.9.46 and backported 
bug fixes and known well working features - we would had a winer!

Vitaliy.


From wine-devel at kievinfo.com  Wed Jun 11 23:25:12 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 11 Jun 2008 22:25:12 -0600
Subject: Wine-1.0 release notes
In-Reply-To: <4850581B.2080708@kievinfo.com>
References: <4850581B.2080708@kievinfo.com>
Message-ID: <4850A528.6000904@kievinfo.com>

Vitaliy Margolen wrote:
> Since all of the 1.0 blocker bugs being pushed back, wine-1.0 release notes 
> should list all of those as major known problems. Otherwise people will get 
> a bad impression that wine-1.0 means more then less working release.
> 
> Also release notes should mention that wine-1.0 is not suitable for most 
> games (new or old) for numerous reasons, including video driver bugs, sound 
> and video conflicts with default system setups, unavailability of required 
> features from X server etc.
> 
Should also add that most users of ATI cards should not expect _anything 3D_ 
running at all because of driver bugs exposed by Wine or just plain Wine 
problems.

Vitaliy.


From fgouget at free.fr  Thu Jun 12 04:45:10 2008
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 12 Jun 2008 11:45:10 +0200 (CEST)
Subject: Add German translation for xcopy
In-Reply-To: <48500123.7070009@zalewski.pl>
References: <1213118416.4470.59.camel@hermes2.karcher.local>
	<484FFE4B.5010102@web.de> <48500123.7070009@zalewski.pl>
Message-ID: <alpine.DEB.1.10.0806121139200.12601@amboise.dolphin>

On Wed, 11 Jun 2008, Miko?aj Zalewski wrote:

> 
> >Does this work for you? When I apply the attached patch and run
> >
> >wine xcopy /?
> >
> >I get garbled German umlauts in the output (also tried with 
> >SUBLANG_NEUTRAL) . Is it the same for you?
> >  
> >
>   Wine console applications output in the OEMCP (i.e. the DOS codepage 
> for the given locale) that is usually different from the Unix console 
> charset. It works if you run the program in a wine console (`wineconsole 
> cmd` and run 'xcopy /?' there). I think, Wine should detect if the 
> output is a Unix tty and do a conversion from OEMCP to UNIXCP, but 
> that's not something that could be done before Wine 1.0.

I hit the same problem recently created a bug report for it:
13819 - Wrong codepage used for console output
http://bugs.winehq.org/show_bug.cgi?id=13819

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                 There are 10 types of people in the world...
               those who understand binary and those who don't.

From twickline at gmail.com  Thu Jun 12 05:04:57 2008
From: twickline at gmail.com (Tom Wickline)
Date: Thu, 12 Jun 2008 06:04:57 -0400
Subject: Wine-1.0 release notes
In-Reply-To: <48508169.2090407@kievinfo.com>
References: <4850581B.2080708@kievinfo.com> <4850609E.1040509@open-vote.org>
	<48508169.2090407@kievinfo.com>
Message-ID: <53e3a9930806120304xf0ad2d3t37f473b1deb82cb2@mail.gmail.com>

On Wed, Jun 11, 2008 at 9:52 PM, Vitaliy Margolen
<wine-devel at kievinfo.com> wrote:
> Scott Ritchie wrote:
>> In any case, we should note why we're making a release in the first
>> place, and make it very clear that we believe Wine 1.0 to be the best
>> version of Wine yet in all cases (ie, no regressions).
>
> I'd disagree on "the best" part. Looking at bugzilla and forum people thing
> that 0.9.58 and possibly older would qualify more.
>

0.9.58 is the best release to date! Office 2007 will run it's best in
this release,
and has been broke in every release after this. Their are other apps
and games that have regressed as well...

-Tom


From mstefani at redhat.com  Thu Jun 12 05:16:03 2008
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 12 Jun 2008 12:16:03 +0200
Subject: [website] wine 1.0 update
In-Reply-To: <a71bd89a0806111542p4125b629m1e2fc57dfbfba647@mail.gmail.com>
References: <a71bd89a0806111542p4125b629m1e2fc57dfbfba647@mail.gmail.com>
Message-ID: <4850F763.5020005@redhat.com>

Dan Kegel wrote:
> The penultimate update?
> 
> 
> ------------------------------------------------------------------------

> 1.0 bugs deferred to 1.0.1 since May 27th:
 > +<li><a href="http://bugs.winehq.org/show_bug.cgi?id=12097">12097</a> 
Wine 1.0 should not ship out-of-sync resource translations
This bug is fixed as soon as Alexandre commits the patch from 
http://www.winehq.org/pipermail/wine-patches/2008-June/055761.html .

http://pf128.krakow.sdi.tpnet.pl/wine-transl/ shows an other "error" in 
the Japanese user32 translation but that's only an extra FONT element in 
DIALOG MSGBOX. I think the FONT element can be removed but i need to 
cross check that. Anyway, the resource/dialog is not broken at all for 
Japanese and thus the bug #12097 can be considered fixed after todays 
commit round.

bye
	michael


From stefandoesinger at gmx.at  Thu Jun 12 05:38:31 2008
From: stefandoesinger at gmx.at (=?windows-1252?Q?Stefan_D=F6singer?=)
Date: Thu, 12 Jun 2008 12:38:31 +0200
Subject: Revert "wined3d: Preload target in ActivateContext()
	for	ORM_BACKBUFFER/ORM_PBUFFER."
In-Reply-To: <48505F7E.6060506@kievinfo.com>
References: <48437C07.2010101@kievinfo.com>	<200806020913.13429.stefandoesinger@gmx.at>	<87ve0qalwt.fsf@wine.dyndns.org>	<b050a5e70806111559l44fd4b3ra8cd5da2a8f4cd21@mail.gmail.com>	<b6bb06270806111621t521f5af9h185a308aa85954e8@mail.gmail.com>
	<48505F7E.6060506@kievinfo.com>
Message-ID: <007501c8cc78$763fbe90$62bf3bb0$@at>

> IMHO this is too little too late. There are at least 2 more calls to
> Preload
> that have exactly the same affect on some of my test games. It sure
> would be
> nice to "fix" at least one case which looks to be common for number of
> games.
I am aware of one. Where is the other one?




From zgs at seas.upenn.edu  Thu Jun 12 07:01:31 2008
From: zgs at seas.upenn.edu (Zachary Goldberg)
Date: Thu, 12 Jun 2008 08:01:31 -0400
Subject: Wine-1.0 release notes
In-Reply-To: <53e3a9930806120304xf0ad2d3t37f473b1deb82cb2@mail.gmail.com>
References: <4850581B.2080708@kievinfo.com> <4850609E.1040509@open-vote.org>
	<48508169.2090407@kievinfo.com>
	<53e3a9930806120304xf0ad2d3t37f473b1deb82cb2@mail.gmail.com>
Message-ID: <b050a5e70806120501lfc4eb0n19f763093e3b4ffa@mail.gmail.com>

On Thu, Jun 12, 2008 at 6:04 AM, Tom Wickline <twickline at gmail.com> wrote:
> On Wed, Jun 11, 2008 at 9:52 PM, Vitaliy Margolen
> <wine-devel at kievinfo.com> wrote:
>> Scott Ritchie wrote:
>>> In any case, we should note why we're making a release in the first
>>> place, and make it very clear that we believe Wine 1.0 to be the best
>>> version of Wine yet in all cases (ie, no regressions).
>>
>> I'd disagree on "the best" part. Looking at bugzilla and forum people thing
>> that 0.9.58 and possibly older would qualify more.
>>
>
> 0.9.58 is the best release to date! Office 2007 will run it's best in
> this release,
> and has been broke in every release after this. Their are other apps
> and games that have regressed as well...
>
> -Tom
>
>
>

If you know of such cases why didn't you file any regressions in the
past month during the regression hunt?

-Zach


From austinenglish at gmail.com  Thu Jun 12 07:32:31 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 12 Jun 2008 07:32:31 -0500
Subject: Fwd: [Wine] Wine 1.0 release date to clash with Firefox 3
In-Reply-To: <1213270329.m2f.7707@forum.winehq.org>
References: <1213270329.m2f.7707@forum.winehq.org>
Message-ID: <b6bb06270806120532x1c1a88eflcf8cc09094cbc54@mail.gmail.com>

---------- Forwarded message ----------
From: Bamm <wineforum-user at winehq.org>
Date: Thu, Jun 12, 2008 at 6:32 AM
Subject: [Wine]  Wine 1.0 release date to clash with Firefox 3
To: wine-users at winehq.org


According to http://wiki.winehq.org/WineReleasePlan the new release
date for Wine 1.0 is set to June 17.

However the Firefox 3.0 release date is also set to June 17.

http://developer.mozilla.org/devnews/index.php/2008/06/11/coming-tuesday-june-17th-firefox-3/

Their release is planned to be high profile and they even plan to set
a Guinness world record for downloads in a single day!

http://www.tuaw.com/2008/05/30/help-firefox-set-a-guinness-world-record/

With this, I fear that the Wine release would be drowned out in the
euphoria and excitement for Firefox 3.

I respectfully suggest, therefore, that we move the Wine 1.0 release
date to another date besides June 17.

This way we can attract more press and attention.

I hope others agree with my observation.

Regards,
Bamm


From austinenglish at gmail.com  Thu Jun 12 07:34:36 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 12 Jun 2008 07:34:36 -0500
Subject: Wine-1.0 release notes
In-Reply-To: <53e3a9930806120304xf0ad2d3t37f473b1deb82cb2@mail.gmail.com>
References: <4850581B.2080708@kievinfo.com> <4850609E.1040509@open-vote.org>
	<48508169.2090407@kievinfo.com>
	<53e3a9930806120304xf0ad2d3t37f473b1deb82cb2@mail.gmail.com>
Message-ID: <b6bb06270806120534v610e59a2rfe2a7638c6dd282a@mail.gmail.com>

On Thu, Jun 12, 2008 at 5:04 AM, Tom Wickline <twickline at gmail.com> wrote:
> On Wed, Jun 11, 2008 at 9:52 PM, Vitaliy Margolen
> <wine-devel at kievinfo.com> wrote:
>> Scott Ritchie wrote:
>>> In any case, we should note why we're making a release in the first
>>> place, and make it very clear that we believe Wine 1.0 to be the best
>>> version of Wine yet in all cases (ie, no regressions).
>>
>> I'd disagree on "the best" part. Looking at bugzilla and forum people thing
>> that 0.9.58 and possibly older would qualify more.
>>
>
> 0.9.58 is the best release to date! Office 2007 will run it's best in
> this release,
> and has been broke in every release after this. Their are other apps
> and games that have regressed as well...
>
> -Tom
>
>
>

Where are the regression bugs for this? I don't recall having seen any
filed in bugzilla...


From theosib at gmail.com  Thu Jun 12 07:37:16 2008
From: theosib at gmail.com (Timothy Normand Miller)
Date: Thu, 12 Jun 2008 08:37:16 -0400
Subject: [Wine] Wine 1.0 release date to clash with Firefox 3
In-Reply-To: <b6bb06270806120532x1c1a88eflcf8cc09094cbc54@mail.gmail.com>
References: <1213270329.m2f.7707@forum.winehq.org>
	<b6bb06270806120532x1c1a88eflcf8cc09094cbc54@mail.gmail.com>
Message-ID: <9871ee5f0806120537h1cbda789p23146118a3bf5c74@mail.gmail.com>

On Thu, Jun 12, 2008 at 8:32 AM, Austin English <austinenglish at gmail.com> wrote:
> I respectfully suggest, therefore, that we move the Wine 1.0 release
> date to another date besides June 17.

Maybe this is a dumb idea, but could the Firefox developers be asked
to provide a link to the WINE release?  "And don't miss
[today|tomorrow] the release of WINE 1.0" or whatever.


-- 
Timothy Normand Miller
http://www.cse.ohio-state.edu/~millerti
Open Graphics Project


From twickline at gmail.com  Thu Jun 12 07:51:13 2008
From: twickline at gmail.com (Tom Wickline)
Date: Thu, 12 Jun 2008 08:51:13 -0400
Subject: Wine-1.0 release notes
In-Reply-To: <b050a5e70806120501lfc4eb0n19f763093e3b4ffa@mail.gmail.com>
References: <4850581B.2080708@kievinfo.com> <4850609E.1040509@open-vote.org>
	<48508169.2090407@kievinfo.com>
	<53e3a9930806120304xf0ad2d3t37f473b1deb82cb2@mail.gmail.com>
	<b050a5e70806120501lfc4eb0n19f763093e3b4ffa@mail.gmail.com>
Message-ID: <53e3a9930806120551s4d5bfac3h7d1e38f127b50e85@mail.gmail.com>

On Thu, Jun 12, 2008 at 8:01 AM, Zachary Goldberg <zgs at seas.upenn.edu> wrote:
> On Thu, Jun 12, 2008 at 6:04 AM, Tom Wickline <twickline at gmail.com> wrote:
>> On Wed, Jun 11, 2008 at 9:52 PM, Vitaliy Margolen
>> <wine-devel at kievinfo.com> wrote:
>>> Scott Ritchie wrote:
>>>> In any case, we should note why we're making a release in the first
>>>> place, and make it very clear that we believe Wine 1.0 to be the best
>>>> version of Wine yet in all cases (ie, no regressions).
>>>
>>> I'd disagree on "the best" part. Looking at bugzilla and forum people thing
>>> that 0.9.58 and possibly older would qualify more.
>>>
>>
>> 0.9.58 is the best release to date! Office 2007 will run it's best in
>> this release,
>> and has been broke in every release after this. Their are other apps
>> and games that have regressed as well...
>>
>> -Tom
>>
>>
>>
>
> If you know of such cases why didn't you file any regressions in the
> past month during the regression hunt?
>
> -Zach
>

Why, so they could be differed? I would hope most of the full
time hackers here test against Office 07.. so im 100% sure
the regressions are known. And if for some reason their not,
its a hopeless case... and me filing a report or two isn't going to
help very much.

-Tom


From austinenglish at gmail.com  Thu Jun 12 08:32:58 2008
From: austinenglish at gmail.com (Austin English)
Date: Thu, 12 Jun 2008 08:32:58 -0500
Subject: Wine-1.0 release notes
In-Reply-To: <53e3a9930806120551s4d5bfac3h7d1e38f127b50e85@mail.gmail.com>
References: <4850581B.2080708@kievinfo.com> <4850609E.1040509@open-vote.org>
	<48508169.2090407@kievinfo.com>
	<53e3a9930806120304xf0ad2d3t37f473b1deb82cb2@mail.gmail.com>
	<b050a5e70806120501lfc4eb0n19f763093e3b4ffa@mail.gmail.com>
	<53e3a9930806120551s4d5bfac3h7d1e38f127b50e85@mail.gmail.com>
Message-ID: <b6bb06270806120632j4652964dudfaab66e2ff49797@mail.gmail.com>

On Thu, Jun 12, 2008 at 7:51 AM, Tom Wickline <twickline at gmail.com> wrote:
> On Thu, Jun 12, 2008 at 8:01 AM, Zachary Goldberg <zgs at seas.upenn.edu> wrote:
>> On Thu, Jun 12, 2008 at 6:04 AM, Tom Wickline <twickline at gmail.com> wrote:
>>> On Wed, Jun 11, 2008 at 9:52 PM, Vitaliy Margolen
>>> <wine-devel at kievinfo.com> wrote:
>>>> Scott Ritchie wrote:
>>>>> In any case, we should note why we're making a release in the first
>>>>> place, and make it very clear that we believe Wine 1.0 to be the best
>>>>> version of Wine yet in all cases (ie, no regressions).
>>>>
>>>> I'd disagree on "the best" part. Looking at bugzilla and forum people thing
>>>> that 0.9.58 and possibly older would qualify more.
>>>>
>>>
>>> 0.9.58 is the best release to date! Office 2007 will run it's best in
>>> this release,
>>> and has been broke in every release after this. Their are other apps
>>> and games that have regressed as well...
>>>
>>> -Tom
>>>
>>>
>>>
>>
>> If you know of such cases why didn't you file any regressions in the
>> past month during the regression hunt?
>>
>> -Zach
>>
>
> Why, so they could be differed? I would hope most of the full
> time hackers here test against Office 07.. so im 100% sure
> the regressions are known. And if for some reason their not,
> its a hopeless case... and me filing a report or two isn't going to
> help very much.
>
> -Tom
>
>
>

The bugs may be deferred, but if the bugs aren't reported, no one
knows to fix them, albeit not likely until after 1.0.

Not reporting bugs is the software equivalent of people who don't vote
and expect politicians to change, get better, or do any damn bit of
good.

-Austin


From twickline at gmail.com  Thu Jun 12 08:46:41 2008
From: twickline at gmail.com (Tom Wickline)
Date: Thu, 12 Jun 2008 09:46:41 -0400
Subject: Wine-1.0 release notes
In-Reply-To: <b6bb06270806120632j4652964dudfaab66e2ff49797@mail.gmail.com>
References: <4850581B.2080708@kievinfo.com> <4850609E.1040509@open-vote.org>
	<48508169.2090407@kievinfo.com>
	<53e3a9930806120304xf0ad2d3t37f473b1deb82cb2@mail.gmail.com>
	<b050a5e70806120501lfc4eb0n19f763093e3b4ffa@mail.gmail.com>
	<53e3a9930806120551s4d5bfac3h7d1e38f127b50e85@mail.gmail.com>
	<b6bb06270806120632j4652964dudfaab66e2ff49797@mail.gmail.com>
Message-ID: <53e3a9930806120646m5a3a312ua53015d4b62a8995@mail.gmail.com>

On Thu, Jun 12, 2008 at 9:32 AM, Austin English <austinenglish at gmail.com> wrote:
>
> The bugs may be deferred, but if the bugs aren't reported, no one
> knows to fix them, albeit not likely until after 1.0.
>
> Not reporting bugs is the software equivalent of people who don't vote
> and expect politicians to change, get better, or do any damn bit of
> good.
>
> -Austin
>

point taken


From truiken at gmail.com  Thu Jun 12 09:15:31 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 12 Jun 2008 09:15:31 -0500
Subject: gdi32: GetCharacterPlacement should accept NULL lpResults (fixes
	bug 13094)
In-Reply-To: <1213259949.8512.2.camel@debian.localdomain>
References: <1213259949.8512.2.camel@debian.localdomain>
Message-ID: <22821af30806120715s154946e2r3d5ea6d414d9de53@mail.gmail.com>

On Thu, Jun 12, 2008 at 3:39 AM, Nikolay Sivov <bunglehead at gmail.com> wrote:
> Changelog:
>    - Fixes GetCharacterPlacement with NULL lpResults argument (fix for bug 13094)
>
> ---
>  dlls/gdi32/font.c |   34 ++++++++++++++++++++++++----------
>  1 files changed, 24 insertions(+), 10 deletions(-)
>
> diff --git a/dlls/gdi32/font.c b/dlls/gdi32/font.c
> index 1bfd97a..34aabd1 100644
> --- a/dlls/gdi32/font.c
> +++ b/dlls/gdi32/font.c
> @@ -2709,27 +2709,35 @@ GetCharacterPlacementA(HDC hdc, LPCSTR lpString, INT uCount,
>     WCHAR *lpStringW;
>     INT uCountW;
>     GCP_RESULTSW resultsW;
> +    GCP_RESULTSW *presults = NULL;
>     DWORD ret;
>     UINT font_cp;
>
>     TRACE("%s, %d, %d, 0x%08x\n",
>           debugstr_an(lpString, uCount), uCount, nMaxExtent, dwFlags);
>
> -    /* both structs are equal in size */
> -    memcpy(&resultsW, lpResults, sizeof(resultsW));
> +    if(lpResults){
> +        /* both structs are equal in size */
> +        memcpy(&resultsW, lpResults, sizeof(resultsW));
> +
> +        if(lpResults->lpOutString)
> +            resultsW.lpOutString = HeapAlloc(GetProcessHeap(), 0, sizeof(WCHAR)*uCountW);
> +
> +        presults = &resultsW;
> +    }
>
>     lpStringW = FONT_mbtowc(hdc, lpString, uCount, &uCountW, &font_cp);
> -    if(lpResults->lpOutString)
> -        resultsW.lpOutString = HeapAlloc(GetProcessHeap(), 0, sizeof(WCHAR)*uCountW);
>
> -    ret = GetCharacterPlacementW(hdc, lpStringW, uCountW, nMaxExtent, &resultsW, dwFlags);
> +    ret = GetCharacterPlacementW(hdc, lpStringW, uCountW, nMaxExtent, presults, dwFlags);
>
> -    lpResults->nGlyphs = resultsW.nGlyphs;
> -    lpResults->nMaxFit = resultsW.nMaxFit;
> +    if(lpResults){
> +        lpResults->nGlyphs = resultsW.nGlyphs;
> +        lpResults->nMaxFit = resultsW.nMaxFit;
>
> -    if(lpResults->lpOutString) {
> -        WideCharToMultiByte(font_cp, 0, resultsW.lpOutString, uCountW,
> -                            lpResults->lpOutString, uCount, NULL, NULL );
> +        if(lpResults->lpOutString) {
> +            WideCharToMultiByte(font_cp, 0, resultsW.lpOutString, uCountW,
> +                                lpResults->lpOutString, uCount, NULL, NULL );
> +        }
>     }
>
>     HeapFree(GetProcessHeap(), 0, lpStringW);
> @@ -2780,6 +2788,10 @@ GetCharacterPlacementW(
>            lpResults->lpGlyphs, lpResults->nGlyphs, lpResults->nMaxFit);
>
>     if(dwFlags&(~GCP_REORDER))                 FIXME("flags 0x%08x ignored\n", dwFlags);
> +
> +    /* with NULL lpResults return GetTextExtentPoint32 result */
> +    if(!lpResults)  goto nullres;
> +
>     if(lpResults->lpClass)     FIXME("classes not implemented\n");
>     if (lpResults->lpCaretPos && (dwFlags & GCP_REORDER))
>         FIXME("Caret positions for complex scripts not implemented\n");
> @@ -2833,6 +2845,8 @@ GetCharacterPlacementW(
>     if(lpResults->lpGlyphs)
>        GetGlyphIndicesW(hdc, lpString, nSet, lpResults->lpGlyphs, 0);
>
> +nullres:
> +
>     if (GetTextExtentPoint32W(hdc, lpString, uCount, &size))
>       ret = MAKELONG(size.cx, size.cy);
>

You need to write a test for this behavior, especially this close to a release.

-- 
James Hawkins


From wine-devel at kievinfo.com  Thu Jun 12 09:25:07 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Thu, 12 Jun 2008 08:25:07 -0600
Subject: Revert "wined3d: Preload target in
	ActivateContext()	for	ORM_BACKBUFFER/ORM_PBUFFER."
In-Reply-To: <007501c8cc78$763fbe90$62bf3bb0$@at>
References: <48437C07.2010101@kievinfo.com>	<200806020913.13429.stefandoesinger@gmx.at>	<87ve0qalwt.fsf@wine.dyndns.org>	<b050a5e70806111559l44fd4b3ra8cd5da2a8f4cd21@mail.gmail.com>	<b6bb06270806111621t521f5af9h185a308aa85954e8@mail.gmail.com>	<48505F7E.6060506@kievinfo.com>
	<007501c8cc78$763fbe90$62bf3bb0$@at>
Message-ID: <485131C3.6060309@kievinfo.com>

Stefan D?singer wrote:
>> IMHO this is too little too late. There are at least 2 more calls to
>> Preload
>> that have exactly the same affect on some of my test games. It sure
>> would be
>> nice to "fix" at least one case which looks to be common for number of
>> games.
> I am aware of one. Where is the other one?
> 

Two Preload calls in FindContext. And bug 13079: 
http://bugs.winehq.org/show_bug.cgi?id=13079

Vitaliy.


From truiken at gmail.com  Thu Jun 12 09:35:51 2008
From: truiken at gmail.com (James Hawkins)
Date: Thu, 12 Jun 2008 09:35:51 -0500
Subject: advapi32: fix a test failure on NT4
In-Reply-To: <b6bb06270806120729m2ba16d8bn6012f53a8ad7f0eb@mail.gmail.com>
References: <b6bb06270806120729m2ba16d8bn6012f53a8ad7f0eb@mail.gmail.com>
Message-ID: <22821af30806120735x4ff95956j920875b252f519fe@mail.gmail.com>

On Thu, Jun 12, 2008 at 9:29 AM, Austin English <austinenglish at gmail.com> wrote:
>

+    ok(GetLastError() == ERROR_SERVICE_DOES_NOT_EXIST ||
+	   GetLastError() == ERROR_INSUFFICIENT_BUFFER /* NT 4 */,
+	   "Expected ERROR_SERVICE_DOES_NOT_EXIST or
ERROR_INSUFFICIENT_BUFFER, got %d\n", GetLastError());

You can't see it with this paste, but it looks like you used tabs
instead of spaces, or at least the indentation is off.

-- 
James Hawkins


From stefandoesinger at gmx.at  Thu Jun 12 09:43:55 2008
From: stefandoesinger at gmx.at (=?windows-1252?Q?Stefan_D=F6singer?=)
Date: Thu, 12 Jun 2008 16:43:55 +0200
Subject: Revert "wined3d: Preload target
	in	ActivateContext()	for	ORM_BACKBUFFER/ORM_PBUFFER."
In-Reply-To: <485131C3.6060309@kievinfo.com>
References: <48437C07.2010101@kievinfo.com>	<200806020913.13429.stefandoesinger@gmx.at>	<87ve0qalwt.fsf@wine.dyndns.org>	<b050a5e70806111559l44fd4b3ra8cd5da2a8f4cd21@mail.gmail.com>	<b6bb06270806111621t521f5af9h185a308aa85954e8@mail.gmail.com>	<48505F7E.6060506@kievinfo.com>	<007501c8cc78$763fbe90$62bf3bb0$@at>
	<485131C3.6060309@kievinfo.com>
Message-ID: <001501c8cc9a$be5db020$3b191060$@at>

> Two Preload calls in FindContext. And bug 13079:
> http://bugs.winehq.org/show_bug.cgi?id=13079
Ah, I think 13079 is an entirely different bug. Vertex buffers aren't
involved in offscreen rendering readback, nor in render target selection.
(Currently. D3D10 changes that)





From paul.vriens.wine at gmail.com  Thu Jun 12 10:01:06 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 12 Jun 2008 17:01:06 +0200
Subject: advapi32: fix a test failure on NT4
In-Reply-To: <48513779.1000802@gmail.com>
References: <b6bb06270806120729m2ba16d8bn6012f53a8ad7f0eb@mail.gmail.com>
	<48513779.1000802@gmail.com>
Message-ID: <48513A32.1050900@gmail.com>

Paul Vriens wrote:
> Austin English wrote:
>>
>> ------------------------------------------------------------------------
>>
>>
> Hi,
> 
> This patch is not correct. That last error actually came from the first 
> of the two GetServiceDisplayNameA's just before that and wasn't reset by 
> NT4.
> 
> I'll sent a more correct one.
> 
Btw. the reason it's different on NT4 is because the Spooler service doesn't 
have a displayname so the GetServiceDisplayNameA returns the service name which 
is exactly what we (I) didn't want to test here.

-- 
Cheers,

Paul.


From wine-devel at kievinfo.com  Thu Jun 12 10:08:28 2008
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Thu, 12 Jun 2008 09:08:28 -0600
Subject: Revert "wined3d: Preload target in	ActivateContext() for
	ORM_BACKBUFFER/ORM_PBUFFER."
In-Reply-To: <001501c8cc9a$be5db020$3b191060$@at>
References: <48437C07.2010101@kievinfo.com>	<200806020913.13429.stefandoesinger@gmx.at>	<87ve0qalwt.fsf@wine.dyndns.org>	<b050a5e70806111559l44fd4b3ra8cd5da2a8f4cd21@mail.gmail.com>	<b6bb06270806111621t521f5af9h185a308aa85954e8@mail.gmail.com>	<48505F7E.6060506@kievinfo.com>	<007501c8cc78$763fbe90$62bf3bb0$@at>
	<485131C3.6060309@kievinfo.com>
	<001501c8cc9a$be5db020$3b191060$@at>
Message-ID: <48513BEC.6020500@kievinfo.com>

Stefan D?singer wrote:
>> Two Preload calls in FindContext. And bug 13079:
>> http://bugs.winehq.org/show_bug.cgi?id=13079
> Ah, I think 13079 is an entirely different bug. Vertex buffers aren't
> involved in offscreen rendering readback, nor in render target selection.
> (Currently. D3D10 changes that)

It could be different - I can't tell for sure. This game doesn't produce any 
reasonable crash dump, just a message that it crashed (so not even winedbg's 
output). However the problems start with call to... Preload.

Vitaliy.


From stefandoesinger at gmx.at  Thu Jun 12 10:39:09 2008
From: stefandoesinger at gmx.at (=?windows-1252?Q?Stefan_D=F6singer?=)
Date: Thu, 12 Jun 2008 17:39:09 +0200
Subject: Revert "wined3d: Preload target in	ActivateContext() for
	ORM_BACKBUFFER/ORM_PBUFFER."
In-Reply-To: <48513BEC.6020500@kievinfo.com>
References: <48437C07.2010101@kievinfo.com>	<200806020913.13429.stefandoesinger@gmx.at>	<87ve0qalwt.fsf@wine.dyndns.org>	<b050a5e70806111559l44fd4b3ra8cd5da2a8f4cd21@mail.gmail.com>	<b6bb06270806111621t521f5af9h185a308aa85954e8@mail.gmail.com>	<48505F7E.6060506@kievinfo.com>	<007501c8cc78$763fbe90$62bf3bb0$@at>
	<485131C3.6060309@kievinfo.com>
	<001501c8cc9a$be5db020$3b191060$@at>
	<48513BEC.6020500@kievinfo.com>
Message-ID: <001701c8cca2$75593d10$600bb730$@at>

> It could be different - I can't tell for sure. This game doesn't
> produce any
> reasonable crash dump, just a message that it crashed (so not even
> winedbg's
> output). However the problems start with call to... Preload.
Vertexbuffer::PreLoad has nothing in common with Surface::PreLoad or
Texture::PreLoad, other than that the name(since they inherit from
Resource::PreLoad, which is a No-op)




From paul.vriens.wine at gmail.com  Thu Jun 12 09:49:29 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 12 Jun 2008 16:49:29 +0200
Subject: advapi32: fix a test failure on NT4
In-Reply-To: <b6bb06270806120729m2ba16d8bn6012f53a8ad7f0eb@mail.gmail.com>
References: <b6bb06270806120729m2ba16d8bn6012f53a8ad7f0eb@mail.gmail.com>
Message-ID: <48513779.1000802@gmail.com>

Austin English wrote:
> 
> ------------------------------------------------------------------------
> 
> 
Hi,

This patch is not correct. That last error actually came from the first of the 
two GetServiceDisplayNameA's just before that and wasn't reset by NT4.

I'll sent a more correct one.

-- 
Cheers,

Paul.


From winehacker at gmail.com  Thu Jun 12 11:41:13 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 12 Jun 2008 12:41:13 -0400
Subject: Wine-1.0 release notes
In-Reply-To: <b6bb06270806120632j4652964dudfaab66e2ff49797@mail.gmail.com>
References: <4850581B.2080708@kievinfo.com> <4850609E.1040509@open-vote.org>
	<48508169.2090407@kievinfo.com>
	<53e3a9930806120304xf0ad2d3t37f473b1deb82cb2@mail.gmail.com>
	<b050a5e70806120501lfc4eb0n19f763093e3b4ffa@mail.gmail.com>
	<53e3a9930806120551s4d5bfac3h7d1e38f127b50e85@mail.gmail.com>
	<b6bb06270806120632j4652964dudfaab66e2ff49797@mail.gmail.com>
Message-ID: <19e31a080806120941s2f913517v4cb10090f270452a@mail.gmail.com>

On Thu, Jun 12, 2008 at 9:32 AM, Austin English <austinenglish at gmail.com> wrote:
> The bugs may be deferred, but if the bugs aren't reported, no one
> knows to fix them, albeit not likely until after 1.0.

If I recall correctly the criteria for target applications was that
they be freely accessible such as a the Office viewers. That and my
lack of free time prevented me from working on the bugs that I know to
exist with office versions. I view the whole 1.0 process as flawed at
this point. IMHO Wine should be able to run some versions of Office
out of the box. This is just my personal view. One of the core Wintel
Monopoly supporting pillars is Microsoft Office. If Wine does not run
some versions even in a somewhat limited manner out of the box, then I
view the whole thing as flawed.

Before someone says CrossOver.....Every other free software package
even with commercial backing works as expected out of the box even if
it requires configuration tweaks. Current it runs none. You download
Apache, it runs web pages out of the box, Samba, it can share out of
the box, MySQL, databases out of the box. As it stands right now, even
with dlloverride changes no version of Office that even sort of
half-assed runs out of the box. Your lucky if you can get Winword 2003
to run out of the box after installing Office 2003. The only version
that installs without tweaks.

I'll save the rest of my rant for Monday when I have more time.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Thu Jun 12 11:57:55 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 12 Jun 2008 09:57:55 -0700
Subject: Nominating bugs for 1.0.1
Message-ID: <a71bd89a0806120957x46f2cda1o1417f786c6d84cf3@mail.gmail.com>

Since Alexandre is now planning to do a 1.0.1 release,
I created a 1.0.1 target in bugzilla, and have targeted
a very few high priority and/or fixed-but-not-in-time bugs
to it.
Many of the bugs currently targeted for 1.2 are
not good candidates for targeting to 1.0.1 because
the bug is not yet well understood and/or a fix is not yet known.

I think the rule of thumb for further nominations should be
something like "if it's already fixed in trunk, and the fix is easy to
backport to 1.0, then it should be nominated for 1.0.1."


From eric.pouech at orange.fr  Thu Jun 12 14:00:24 2008
From: eric.pouech at orange.fr (Eric Pouech)
Date: Thu, 12 Jun 2008 21:00:24 +0200
Subject: winedbg: Add support for printing c++ bool values
In-Reply-To: <215751.93321.qm@web56602.mail.re3.yahoo.com>
References: <215751.93321.qm@web56602.mail.re3.yahoo.com>
Message-ID: <48517248.5050806@orange.fr>

Jon Griffiths a ?crit :
> Hi,
>
> Subject says it all.
>   
>
+            dbg_printf("%s", val_int ? "true" : "false");
what about the simpler:
+            dbg_printf(val_int ? "true" : "false");

A+


-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)




From stefandoesinger at gmx.at  Thu Jun 12 14:24:41 2008
From: stefandoesinger at gmx.at (=?windows-1252?Q?Stefan_D=F6singer?=)
Date: Thu, 12 Jun 2008 21:24:41 +0200
Subject: Revert "wined3d: Preload target
	in	ActivateContext()	for	ORM_BACKBUFFER/ORM_PBUFFER."
In-Reply-To: <485131C3.6060309@kievinfo.com>
References: <48437C07.2010101@kievinfo.com>	<200806020913.13429.stefandoesinger@gmx.at>	<87ve0qalwt.fsf@wine.dyndns.org>	<b050a5e70806111559l44fd4b3ra8cd5da2a8f4cd21@mail.gmail.com>	<b6bb06270806111621t521f5af9h185a308aa85954e8@mail.gmail.com>	<48505F7E.6060506@kievinfo.com>	<007501c8cc78$763fbe90$62bf3bb0$@at>
	<485131C3.6060309@kievinfo.com>
Message-ID: <000401c8ccc1$f707ff30$e517fd90$@at>

> Two Preload calls in FindContext
I just sent 3 patches in an attempt to fix the bug. Please give them a try.
The tests work for me, and I'll test my other games for regressions. Please
also see if you see the ERR("Wine 1.0 safety path hit\n"); error message.

Stefan

PS: Does Outlook set the In-Reply-To tags properly? Are my mails readable
properly in any client that supports a threaded mail view?

PS2: Are the patches sent properly?




From scott at open-vote.org  Thu Jun 12 15:56:25 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Thu, 12 Jun 2008 13:56:25 -0700
Subject: Time to update Wine's status?
In-Reply-To: <d6c5d7290806111727o4e524aa0w40eaa7543295c292@mail.gmail.com>
References: <1212861678.11761.3.camel@belthazor-saved>	
	<48506125.6060202@open-vote.org>
	<d6c5d7290806111727o4e524aa0w40eaa7543295c292@mail.gmail.com>
Message-ID: <48518D79.8010605@open-vote.org>

Edward Savage wrote:
>> I propose we get rid of the page altogether, it's pretty much useless
>> for figuring out how good Wine is.  This is unfortunate, since it's
>> often the first place people click.
>>
>> Thanks,
>> Scott Ritchie
>>
>>
>>
> 
> I found it very handy to track down details on mswsock the other day.
> 
> I suggest if it is to be removed instead dull it down by turning it in
> to a list of dlls wine has and all available information in the form
> of links for each dll is listed so that people can speedily find say
> the msdn page or relevant wiki pages.  That way it would still be a
> handy resource without being a pain to answer to users why a dll is
> only 96.23% complete on an out dated page.

Why not just move the whole thing into the wiki then?

Thanks,
Scott Ritchie


From dank at kegel.com  Thu Jun 12 15:59:29 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 12 Jun 2008 13:59:29 -0700
Subject: Nice 1.0 article by Steven J. Vaughan-Nichols
Message-ID: <a71bd89a0806121359g77663236x55498ab4ce6f22b7@mail.gmail.com>

http://www.linux.com/feature/138160

It puts the release date at June 20th, but otherwise seems accurate.

I was tickled by Jeremy's quote about my impact, but the real story is:

Wine's lucky that

a) Google happened to need Picasa on Linux, and the Picasa team was shorthanded
b) I raised my hand at the right time, and said "I know a
contractor that can get Picasa running on Linux..."

and is even more lucky that

c) Google is so open-source-friendly
d) Chris DiBona works at Google
e) my bosses believed me when I said a couple interns could make a big
difference

All in all a fortuitous coincidence.
- Dan


From paul.vriens.wine at gmail.com  Thu Jun 12 16:25:19 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 12 Jun 2008 23:25:19 +0200
Subject: Time to update Wine's status?
In-Reply-To: <48518D79.8010605@open-vote.org>
References: <1212861678.11761.3.camel@belthazor-saved>		<48506125.6060202@open-vote.org>	<d6c5d7290806111727o4e524aa0w40eaa7543295c292@mail.gmail.com>
	<48518D79.8010605@open-vote.org>
Message-ID: <4851943F.8050101@gmail.com>

Scott Ritchie wrote:
> Edward Savage wrote:
>>> I propose we get rid of the page altogether, it's pretty much useless
>>> for figuring out how good Wine is.  This is unfortunate, since it's
>>> often the first place people click.
>>>
>>> Thanks,
>>> Scott Ritchie
>>>
>>>
>>>
>> I found it very handy to track down details on mswsock the other day.
>>
>> I suggest if it is to be removed instead dull it down by turning it in
>> to a list of dlls wine has and all available information in the form
>> of links for each dll is listed so that people can speedily find say
>> the msdn page or relevant wiki pages.  That way it would still be a
>> handy resource without being a pain to answer to users why a dll is
>> only 96.23% complete on an out dated page.
> 
> Why not just move the whole thing into the wiki then?
> 
> Thanks,
> Scott Ritchie
> 
> 
> 
That still leaves the question, who decides how 'good' a dll is?

Can't we come up with some guesstimate? We know how many functions there are for 
a given dll, we know how much is implemented, we (could) know how much is tested 
and we know how much of those tests are todo's.

Asking a developer to give the status of a dll is possible but that's against 
the current knowledge. If a new app comes out tomorrow and it uses a whole new 
set of (not 100% implemented) API's the status drops.

-- 
Cheers,

Paul.


From ps.praveenkr at gmail.com  Thu Jun 12 19:08:40 2008
From: ps.praveenkr at gmail.com (Praveenkumar Ponnusamy)
Date: Thu, 12 Jun 2008 17:08:40 -0700
Subject: msvcrt and gcc-c++ header conflicts
Message-ID: <7a13f6640806121708t1a76ddf9wd9225fbfdbe0461@mail.gmail.com>

Hello Wine Developers-

I am trying to compile a windows project on Linux using winemaker and
I'm stuck with a problem and was wondering if any of you have
encountered it before or have any suggestions.

In some of the compilation units in my project, I am using
std::ofstream that is defined in the "fstream" header file and
included as #include <fstream>. Since wine does not provide this
header file, the one provided by gcc is used by the wine compiler --
which in turn includes quite a few headers of its own. A number of
symbols defined in these headers conflict with the ones provided by
wine and produce compiler errors such as these:

In file included from
/usr/lib/gcc/i386-redhat-linux/4.3.0/../../../../include/c++/4.3.0/cwchar:52,
                 from
/usr/lib/gcc/i386-redhat-linux/4.3.0/../../../../include/c++/4.3.0/bits/postypes.h:47,
                 from
/usr/lib/gcc/i386-redhat-linux/4.3.0/../../../../include/c++/4.3.0/iosfwd:47,
                 from
/usr/lib/gcc/i386-redhat-linux/4.3.0/../../../../include/c++/4.3.0/ios:44,
                 from
/usr/lib/gcc/i386-redhat-linux/4.3.0/../../../../include/c++/4.3.0/istream:45,
                 from
/usr/lib/gcc/i386-redhat-linux/4.3.0/../../../../include/c++/4.3.0/fstream:45,
                 from /home/praveen/wine-projects/myProject/tengine.h:25,
                 from /home/praveen/wine-projects/myProject/teassembly.h:19,
                 from teassembly.cpp:17:
/usr/include/wchar.h: At global scope:
/usr/include/wchar.h:62: error: conflicting declaration 'typedef
unsigned int wint_t'
/usr/local/include/wine/msvcrt/ctype.h:30: error: 'wint_t' has a
previous declaration as 'typedef short unsigned int wint_t'

In file included from
/usr/lib/gcc/i386-redhat-linux/4.3.0/../../../../include/c++/4.3.0/cwchar:52,
                 from
/usr/lib/gcc/i386-redhat-linux/4.3.0/../../../../include/c++/4.3.0/bits/postypes.h:47,
                 from
/usr/lib/gcc/i386-redhat-linux/4.3.0/../../../../include/c++/4.3.0/iosfwd:47,
                 from
/usr/lib/gcc/i386-redhat-linux/4.3.0/../../../../include/c++/4.3.0/ios:44,
                 from
/usr/lib/gcc/i386-redhat-linux/4.3.0/../../../../include/c++/4.3.0/istream:45,
                 from
/usr/lib/gcc/i386-redhat-linux/4.3.0/../../../../include/c++/4.3.0/fstream:45,
                 from /home/praveen/wine-projects/myProject/tengine.h:25,
                 from /home/praveen/wine-projects/myProject/teassembly.h:19,
                 from teassembly.cpp:17:
/usr/include/wchar.h:246: error: declaration of C function 'wchar_t*
wcstok(wchar_t*, const wchar_t*, wchar_t**)' conflicts with
/usr/local/include/wine/msvcrt/string.h:122: error: previous
declaration 'wchar_t* wcstok(wchar_t*, const wchar_t*)' here

My understanding is that Wine has implemented msvcrt and provides the
associated header files but not the c++ headers. Am I right? What
could be the solution here?
I would greatly appreciate any help. I am using wine-1.0-rc4 on Fedora 9.
Thanks in advance.

-Praveen


From edwin.smulders at gmail.com  Thu Jun 12 19:31:25 2008
From: edwin.smulders at gmail.com (Edwin Smulders)
Date: Fri, 13 Jun 2008 02:31:25 +0200
Subject: [AppDB] application: Only show 'submitter' column when processing
	queued entries
In-Reply-To: <200806130013.50339.alex@thehandofagony.com>
References: <200806130013.50339.alex@thehandofagony.com>
Message-ID: <9a85a1550806121731j4f82ba9fm98ab89dfa51d5d0a@mail.gmail.com>

I'm not exactly sure where this removes the submitter column, but if
this is on the test results page, please keep it as it is, I find it
useful info, in multiple ways. One way is as a maintainer, being able
to sort through the results, and one is as a user, being able to see
which test results came from the maintainer of the app himself (i
usually find these more accurate).

Just a thought, and disregard this if it is not about this column but
some other column :)

On Fri, Jun 13, 2008 at 12:13 AM, Alexander Nicolaysen S?rnes
<alex at thehandofagony.com> wrote:
> That info is not very interesting for people browsing the database.
>
>
> Alexander N. S?rnes
>
>
>
>

From dank at kegel.com  Fri Jun 13 00:07:44 2008
From: dank at kegel.com (Dan Kegel)
Date: Thu, 12 Jun 2008 22:07:44 -0700
Subject: -O0 nearly twice as fast to build as -O2
Message-ID: <a71bd89a0806122207m158483b1w73bea36dd64559bb@mail.gmail.com>

OK, this was confusing.  I was getting repeatable five minute
builds, i.e. "make clean; reboot; time make -j3" (more or less :-)
was reliably showing five minutes wall clock time.

Then I did "make distclean; ./configure; make depend".

After that, I got repeatable nine minute builds, i.e.
make clean; reboot; time make -j3
was showing nine minute wall clock time.

Turns out, the difference was... I had been building without
optimization.  So configuring with CFLAGS="-g -O0" is
almost a 2x speedup!

This is with gcc-4.2.3.

Might be handy to know when doing regressions.


From adam at tpetaccia.com  Fri Jun 13 00:10:25 2008
From: adam at tpetaccia.com (Adam Petaccia)
Date: Fri, 13 Jun 2008 01:10:25 -0400
Subject: Time to update Wine's status?
In-Reply-To: <48518D79.8010605@open-vote.org>
References: <1212861678.11761.3.camel@belthazor-saved>
	<48506125.6060202@open-vote.org>
	<d6c5d7290806111727o4e524aa0w40eaa7543295c292@mail.gmail.com>
	<48518D79.8010605@open-vote.org>
Message-ID: <1213333825.9152.6.camel@belthazor-saved>

On Thu, 2008-06-12 at 13:56 -0700, Scott Ritchie wrote:
> > I found it very handy to track down details on mswsock the other day.
> > 
> > I suggest if it is to be removed instead dull it down by turning it in
> > to a list of dlls wine has and all available information in the form
> > of links for each dll is listed so that people can speedily find say
> > the msdn page or relevant wiki pages.  That way it would still be a
> > handy resource without being a pain to answer to users why a dll is
> > only 96.23% complete on an out dated page.
> 
> Why not just move the whole thing into the wiki then?

I don't really think its wiki material, but could probably be run from a
script for each Wine release. Unless I misunderstand, the numbers are
available from http://source.winehq.org/WineAPI/  (like GdiPlus is 46%
implemented with no documentation, see
http://source.winehq.org/WineAPI/gdiplus.html ). Of course this would
over state our progress as functions that just print a FIXME and return
would be included, but that seems like the more reasonable option.

> 
> Thanks,
> Scott Ritchie
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080613/892ecc36/attachment.pgp 

From patrol at sinus.cz  Fri Jun 13 00:43:31 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Fri, 13 Jun 2008 07:43:31 +0200
Subject: -O0 nearly twice as fast to build as -O2
In-Reply-To: <a71bd89a0806122207m158483b1w73bea36dd64559bb@mail.gmail.com>
References: <a71bd89a0806122207m158483b1w73bea36dd64559bb@mail.gmail.com>
Message-ID: <20080613054331.GA5826@tangens.sinus.cz>

> OK, this was confusing.  I was getting repeatable five minute
> builds, i.e. "make clean; reboot; time make -j3" (more or less :-)
> was reliably showing five minutes wall clock time.
> 
> Then I did "make distclean; ./configure; make depend".
> 
> After that, I got repeatable nine minute builds, i.e.
> make clean; reboot; time make -j3
> was showing nine minute wall clock time.
> 
> Turns out, the difference was... I had been building without
> optimization.  So configuring with CFLAGS="-g -O0" is
> almost a 2x speedup!
> 
Hi!
  Yes, you are right, turning optimization off speeds up the compilation
substantially.
  HOWEVER, it changes the generated code and due to various features of the
compiler (like inlining or another) being present/absent, the code can,
in rare cases, behave differently. I have many experiences that for example
a program was repeatedly crashing, when compiled by default way, i.e. with
optimalization, and when I compiled it without optimalization and with -g
for debugging, it never crashed and worked perfectly under the debugger.
I had to debug the optimized version, which is harder, because the generated
code doesn't track the source exactly anymore.
  With regards, Pavel Troller


From scott at open-vote.org  Fri Jun 13 00:57:02 2008
From: scott at open-vote.org (Scott Ritchie)
Date: Thu, 12 Jun 2008 22:57:02 -0700
Subject: -O0 nearly twice as fast to build as -O2
In-Reply-To: <20080613054331.GA5826@tangens.sinus.cz>
References: <a71bd89a0806122207m158483b1w73bea36dd64559bb@mail.gmail.com>
	<20080613054331.GA5826@tangens.sinus.cz>
Message-ID: <48520C2E.4000001@open-vote.org>

Pavel Troller wrote:
>> OK, this was confusing.  I was getting repeatable five minute
>> builds, i.e. "make clean; reboot; time make -j3" (more or less :-)
>> was reliably showing five minutes wall clock time.
>>
>> Then I did "make distclean; ./configure; make depend".
>>
>> After that, I got repeatable nine minute builds, i.e.
>> make clean; reboot; time make -j3
>> was showing nine minute wall clock time.
>>
>> Turns out, the difference was... I had been building without
>> optimization.  So configuring with CFLAGS="-g -O0" is
>> almost a 2x speedup!
>>
> Hi!
>   Yes, you are right, turning optimization off speeds up the compilation
> substantially.
>   HOWEVER, it changes the generated code and due to various features of the
> compiler (like inlining or another) being present/absent, the code can,
> in rare cases, behave differently. I have many experiences that for example
> a program was repeatedly crashing, when compiled by default way, i.e. with
> optimalization, and when I compiled it without optimalization and with -g
> for debugging, it never crashed and worked perfectly under the debugger.
> I had to debug the optimized version, which is harder, because the generated
> code doesn't track the source exactly anymore.
>   With regards, Pavel Troller
> 
> 
Is that a GCC bug then?  And, more importantly, was that with a recent
GCC version?

Thanks,
Scott Ritchie


From patrol at sinus.cz  Fri Jun 13 01:08:08 2008
From: patrol at sinus.cz (Pavel Troller)
Date: Fri, 13 Jun 2008 08:08:08 +0200
Subject: -O0 nearly twice as fast to build as -O2
In-Reply-To: <48520C2E.4000001@open-vote.org>
References: <a71bd89a0806122207m158483b1w73bea36dd64559bb@mail.gmail.com>
	<20080613054331.GA5826@tangens.sinus.cz>
	<48520C2E.4000001@open-vote.org>
Message-ID: <20080613060808.GA7781@tangens.sinus.cz>

> Pavel Troller wrote:
> >> OK, this was confusing.  I was getting repeatable five minute
> >> builds, i.e. "make clean; reboot; time make -j3" (more or less :-)
> >> was reliably showing five minutes wall clock time.
> >>
> >> Then I did "make distclean; ./configure; make depend".
> >>
> >> After that, I got repeatable nine minute builds, i.e.
> >> make clean; reboot; time make -j3
> >> was showing nine minute wall clock time.
> >>
> >> Turns out, the difference was... I had been building without
> >> optimization.  So configuring with CFLAGS="-g -O0" is
> >> almost a 2x speedup!
> >>
> > Hi!
> >   Yes, you are right, turning optimization off speeds up the compilation
> > substantially.
> >   HOWEVER, it changes the generated code and due to various features of the
> > compiler (like inlining or another) being present/absent, the code can,
> > in rare cases, behave differently. I have many experiences that for example
> > a program was repeatedly crashing, when compiled by default way, i.e. with
> > optimalization, and when I compiled it without optimalization and with -g
> > for debugging, it never crashed and worked perfectly under the debugger.
> > I had to debug the optimized version, which is harder, because the generated
> > code doesn't track the source exactly anymore.
> >   With regards, Pavel Troller
> > 
> > 
> Is that a GCC bug then?  And, more importantly, was that with a recent
> GCC version?
> 
Hi!
 It cannot be clearly said. Some nuances of the C language are "implementation
dependent" and it's perfectly OK to compile them differently with or without
optimization. Sometimes the programmer incorrectly relies on such a nuance and
then using the different set of options can cause his program to behave
incorrectly. However, yes, there were, and maybe still are, GCC bugs regarding
optimisation, but in recent versions they are very rare.
  And my experiences mentioned above don't count only for wine, there are many
other programs, which do this.
  With regards, Pavel Troller


From wine at mkarcher.dialup.fu-berlin.de  Fri Jun 13 01:54:27 2008
From: wine at mkarcher.dialup.fu-berlin.de (Michael Karcher)
Date: Fri, 13 Jun 2008 08:54:27 +0200
Subject: -O0 nearly twice as fast to build as -O2
In-Reply-To: <20080613060808.GA7781@tangens.sinus.cz>
References: <a71bd89a0806122207m158483b1w73bea36dd64559bb@mail.gmail.com>
	<20080613054331.GA5826@tangens.sinus.cz>
	<48520C2E.4000001@open-vote.org>
	<20080613060808.GA7781@tangens.sinus.cz>
Message-ID: <1213340067.2248.7.camel@hermes2.karcher.local>

Am Freitag, den 13.06.2008, 08:08 +0200 schrieb Pavel Troller:
> > > and when I compiled it without optimalization and with -g
> > > for debugging, it never crashed and worked perfectly under the debugger.
> > > I had to debug the optimized version, which is harder, because the generated
> > > code doesn't track the source exactly anymore.
> > >   With regards, Pavel Troller
> > > 
> > > 
> > Is that a GCC bug then?  And, more importantly, was that with a recent
> > GCC version?
> > 
> Hi!
>  It cannot be clearly said. Some nuances of the C language are "implementation
> dependent" and it's perfectly OK to compile them differently with or without
> optimization. Sometimes the programmer incorrectly relies on such a nuance and
> then using the different set of options can cause his program to behave
> incorrectly.

Even more probable than encountering "implementation defined" behavior
is encountering "undefined" behavior. In that case, the same program
compiled with the same options might crash one day and not the other. A
typical case of undefined behavior is using an uninitialized pointer.
Due to address space randomization it could happen that the value in the
uninitialized pointer sometimes points to valid memory and sometimes
faults.

In the case of optimization dependent behavior, the most common source
is a buffer overflow on a local (stack-contained) array. gcc -O0 puts
all declared variables onto the stack, in the order they were declared.
gcc -O2 sometimes elides variables completely or reuses the same space
for different variables, so you get a totally different stack layout.
This means you are overwriting different data depending on optimization,
and the chance to hit a location that is currently not in use is higher
without optimization. This is of course not a gcc bug. The program
always does a forbidden access out of array bounds, you just don't
notice without optimization, or put in other words: Without optimization
the program is as wrong as with optimization, it just happens to do the
right thing anyways.

Regards,
  Michael Karcher



From dank at kegel.com  Fri Jun 13 06:27:51 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 13 Jun 2008 04:27:51 -0700
Subject: -O0 nearly twice as fast to build as -O2
In-Reply-To: <20080613054331.GA5826@tangens.sinus.cz>
References: <a71bd89a0806122207m158483b1w73bea36dd64559bb@mail.gmail.com>
	<20080613054331.GA5826@tangens.sinus.cz>
Message-ID: <a71bd89a0806130427y68b3c9f3r27be115bce5698d6@mail.gmail.com>

On Thu, Jun 12, 2008 at 10:43 PM, Pavel Troller <patrol at sinus.cz> wrote:
>  Yes, you are right, turning optimization off speeds up the compilation
> substantially.
>  HOWEVER, it changes the generated code and due to various features of the
> compiler (like inlining or another) being present/absent, the code can,
> in rare cases, behave differently. I have many experiences that for example
> a program was repeatedly crashing, when compiled by default way, i.e. with
> optimalization, and when I compiled it without optimalization and with -g
> for debugging, it never crashed and worked perfectly under the debugger.

Indeed.  I think I've had a case where it worked properly
with optimization, but crashed with -O0, too.
Every once in a while we should make sure that Wine
passes its tests when compiled without optimization.

(Incidentally, Valgrind gives somewhat better info with -O0, and it
catches some of the problems you're describing.)

But the main point of my post was to suggest a way to
speed up regression testing.  I've add a note about it
to http://wiki.winehq.org/RegressionTesting
- Dan


From fgouget at free.fr  Fri Jun 13 08:40:40 2008
From: fgouget at free.fr (Francois Gouget)
Date: Fri, 13 Jun 2008 15:40:40 +0200 (CEST)
Subject: 'Interactive' tests on Windows 2003
Message-ID: <alpine.DEB.1.10.0806111326350.31308@amboise.dolphin>


Someone asked to check which tests require interaction when running in 
my Windows 2003 VM. However I cannot find the corresponding email (it 
might have been on irc), so I'm sending this data to the list.

So the only interaction that was needed was caused by this IE 
security dialog:

    Content within this application coming from the Web site listed 
    below is being blocked by Internet Explorer Enhanced Security 
    Configuration.


Only three tests were impacted:
 * mshtml_test dom
   -> 1508 tests run but 0 failures happened when just closing the 
      dialog.

 * mshtml_test script  (about:security_mshtml_test.exe)
   -> 21 tests run and 13 failures if the dialog is just closed, and 0 
      failures if mshtml_test is manually added to the 'allowed' list.

 * urlmon_test misc
   -> 923 tests run but 0 failures if the dialog is just closed.


When run by winetest these tests just time out though.

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                            1 + e ^ ( i * pi ) = 0


From fgouget at free.fr  Fri Jun 13 09:49:57 2008
From: fgouget at free.fr (Francois Gouget)
Date: Fri, 13 Jun 2008 16:49:57 +0200 (CEST)
Subject: How long does it take you to compile wine?
In-Reply-To: <48427497.4090209@sandbox.cz>
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
	<48427497.4090209@sandbox.cz>
Message-ID: <alpine.DEB.1.10.0806032353530.23130@amboise.dolphin>

On Sun, 1 Jun 2008, V?t Hrachov? wrote:

> Hi Dan,
> it's 31 minutes on  AMD Athlon(tm) 64 Processor 3700+, 2GB RAM.

He he, I think I hold the record.

Wall clock  | CPU              | RAM   | gcc   | Machine
------------+------------------+-------+-------+--------------------
145m38.115s | P3 600MHz        | 192MB | 4.2.4 | Debian Laptop
------------+------------------+-------+-------+--------------------
 39m30.058s | Pentium M 1.5GHz | 768MB | 4.2.3 | Ubuntu Laptop (1)
------------+------------------+-------+-------+--------------------
 53m12.450s | Athlon XP 2600+  |   1GB | 4.2.4 | Debian Desktop (2)
            | (2.1GHz)         |       |       |
 12m34.218s |                  |       |       | 100% ccache hitrate
------------+------------------+-------+-------+--------------------
 50m58.424s | Athlon XP 1800+  |   1GB | 4.2.4 | Debian Desktop
            | (1.53GHz)        |       |       |
------------+------------------+-------+-------+--------------------
 29m30.277s | Distcc           |       |       | (3)
------------+------------------+-------+-------+--------------------


(1) This one is missing Esd, NAS, Jack and Valgrind (memcheck.h) 
support. However in other tests this does not seem to make much 
difference. It's also the only one with a different distribution and gcc 
version which makes comparisons tricky.

(2) This is actually my main development machine. And damn, it's slow! I 
hope to retire it soon but it still hurts. I guess part of the reason 
for it being so slow is that it's never really idle. There's always half 
a dozen Firefox windows around, gkrellm, xmms, a bunch of background 
processes like MythTV, MySQL, software RAID 1, 90% full disks, etc.

(3) This is with 1 job on the Athlon 2600+ and 2 on the Athlon 1800+.


I tried getting Wine 2002 to compile but even in my Debian 3.1 chroot 
and with gcc 2.95 it wouldn't. So we don't have a good point of 
comparison.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
           If it stinks, it's chemistry. If it moves, it's biology.
                  If it does not work, It's computer science.

From brian.vincent at gmail.com  Fri Jun 13 10:54:10 2008
From: brian.vincent at gmail.com (Brian Vincent)
Date: Fri, 13 Jun 2008 09:54:10 -0600
Subject: How long does it take you to compile wine?
In-Reply-To: <a71bd89a0806010116w5b5fc6d7rc03fc2f8d40571bb@mail.gmail.com>
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
	<22821af30806010047r4aa50fabq81336d69ab2c153b@mail.gmail.com>
	<a71bd89a0806010116w5b5fc6d7rc03fc2f8d40571bb@mail.gmail.com>
Message-ID: <3010968c0806130854x2fc3d34x75e3aa4cdf69cc95@mail.gmail.com>

On Sun, Jun 1, 2008 at 2:16 AM, Dan Kegel <dank at kegel.com> wrote:

> I found a nice graph of Wine's codebase size over time:
> http://www.ohloh.net/projects/wine/analyses/latest
> Looks like it's just about exactly doubled since that
> last measurement in late 2002.


Anyone else notice that link shows we have some license inconsistencies?
There could be a legitimate reason for that, I didn't have time to look.
Anyway, it's showing 5 files with LGPL v2.1 (huh?  shouldn't all the files
be showing as LGPL v2.1?), 3 files BSD (X11?), and 2 files GPL.

-Brian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080613/244ee8a3/attachment.htm 

From dank at kegel.com  Fri Jun 13 10:59:29 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 13 Jun 2008 08:59:29 -0700
Subject: Handy valgrind tips
Message-ID: <a71bd89a0806130859w729c1bccx719c3fce5cda5d2a@mail.gmail.com>

I've started collecting tips about how to
track down wine bugs using valgrind;
they're at the bottom of
http://wiki.winehq.org/Wine_and_Valgrind

There are two right now (about building
wine with -O0, and about using WINEDEBUG to
flush out undefined values into the open).
Share and enjoy...


From cesar at ecuarock.net  Fri Jun 13 11:16:10 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Fri, 13 Jun 2008 11:16:10 -0500
Subject: Unhandled page fault on prefix creation on osx 10.5
Message-ID: <e3d3ae8f0806130916s4e42552dwf940605a65754f4d@mail.gmail.com>

I just deleted my .wine directory and run wineboot. The .wine
directory is recreated but I get:

wine: created the configuration directory '/Users/cesar/.wine'
wine: Unhandled page fault on read access to 0x008cc65f at address
0xffff0eb8 (thread 000b), starting debugger...
couldn't load main module (2)
Unhandled exception: page fault on read access to 0x008cc65f in 32-bit
code (0xffff0eb8).

And a lot of dumps and backtraces. I did a regression testing and
found out that 58913b439b797462a70794774b87e63283109617 commit is what
is causing this problem. Reverting this commit everything works
perfectly. More information about the commit (from git bisect):

58913b439b797462a70794774b87e63283109617 is first bad commit
commit 58913b439b797462a70794774b87e63283109617
Author: Alexandre Julliard <julliard at winehq.org>
Date:   Fri Feb 15 12:07:56 2008 +0100

    kernel32: On Mac OS, recompose the Unicode strings we get from the OS.

:040000 040000 f3d03f060068424b166b0ce68169c5a3eddab96e
f1a567176edfd42947239dbacff3cc8ad469a497 M	dlls

I'm using osx 10.5.3 in spanish on a macbook pro. Does anybody know about this?


From dank at kegel.com  Fri Jun 13 12:33:03 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 13 Jun 2008 10:33:03 -0700
Subject: twinview and user32/tests/monitor.c
Message-ID: <a71bd89a0806131033r10ddb30dk9e8096e35256f4ba@mail.gmail.com>

My workstation was failing a test because it didn't have a 640x480 display mode.
Turned out it was how the dual monitor support was configured,
and changing a line in /etc/X11/xorg.conf from
        Option          "MetaModes" "2560x1600,2560x1600;
1920x1200,1920x1200; 1600x1200,1600x1200; 1280x1024,1280x1024"
to
        Option          "MetaModes" "2560x1600,2560x1600;
1920x1200,1920x1200; 1600x1200,1600x1200; 1280x1024,1280x1024;
640x480,NULL"
made the test happy.

Probably not worth worrying about changing the test to expect crazy
configurations like this...


From dank at kegel.com  Fri Jun 13 13:04:41 2008
From: dank at kegel.com (Dan Kegel)
Date: Fri, 13 Jun 2008 11:04:41 -0700
Subject: twinview and user32/tests/monitor.c
In-Reply-To: <a71bd89a0806131033r10ddb30dk9e8096e35256f4ba@mail.gmail.com>
References: <a71bd89a0806131033r10ddb30dk9e8096e35256f4ba@mail.gmail.com>
Message-ID: <a71bd89a0806131104q243a5b61k376af599d21b781a@mail.gmail.com>

On Fri, Jun 13, 2008 at 10:33 AM, Dan Kegel <dank at kegel.com> wrote:
> My workstation was failing a test because it didn't have a 640x480 display mode.
> Turned out it was how the dual monitor support was configured,
> and changing a line in /etc/X11/xorg.conf ... made the test happy.
>
> Probably not worth worrying about changing the test to expect crazy
> configurations like this...

On second thought,
http://test.winehq.org/data/3c1c6172779510a7ed693d922fb3061948999ea1/#group_XP:user32:monitor
shows three windows systems that make me wonder whether
there are windows systems in the wild which don't have
a 640x480 mode... maybe we should make that test output the
list of valid modes...


From truiken at gmail.com  Fri Jun 13 13:04:12 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 13 Jun 2008 13:04:12 -0500
Subject: 'Interactive' tests on Windows 2003
In-Reply-To: <alpine.DEB.1.10.0806111326350.31308@amboise.dolphin>
References: <alpine.DEB.1.10.0806111326350.31308@amboise.dolphin>
Message-ID: <22821af30806131104n285609ahe93ecd6de3174c45@mail.gmail.com>

On Fri, Jun 13, 2008 at 8:40 AM, Francois Gouget <fgouget at free.fr> wrote:
>
> Someone asked to check which tests require interaction when running in
> my Windows 2003 VM. However I cannot find the corresponding email (it
> might have been on irc), so I'm sending this data to the list.
>
> So the only interaction that was needed was caused by this IE
> security dialog:
>
>    Content within this application coming from the Web site listed
>    below is being blocked by Internet Explorer Enhanced Security
>    Configuration.
>
>
> Only three tests were impacted:
>  * mshtml_test dom
>   -> 1508 tests run but 0 failures happened when just closing the
>      dialog.
>
>  * mshtml_test script  (about:security_mshtml_test.exe)
>   -> 21 tests run and 13 failures if the dialog is just closed, and 0
>      failures if mshtml_test is manually added to the 'allowed' list.
>
>  * urlmon_test misc
>   -> 923 tests run but 0 failures if the dialog is just closed.
>
>
> When run by winetest these tests just time out though.
>

Thanks Francois (I asked on IRC a while back).  I get these dialogs in
2k3 as well.  Do you think we should add a check for
winetest_interactive before the calls that bring up the permission
dialog?  If anyone else knows of a better way, let us know.

-- 
James Hawkins


From truiken at gmail.com  Fri Jun 13 17:59:01 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 13 Jun 2008 17:59:01 -0500
Subject: user32: Allow a NULL foreground window in the tests
In-Reply-To: <05AEBB1202DB4DC187B74107ECCD96C4@DMITRY>
References: <22821af30805290755i3c0ef390w34f946abd1199670@mail.gmail.com>
	<300C02AB64C44487B18D6E5CC9E31489@DMITRY>
	<22821af30805290813k727e0ebl451b0e92208aa378@mail.gmail.com>
	<1566C26A35024168AE429ED197788C4B@DMITRY>
	<22821af30805290835v45618ec7h1e80b4d985112aee@mail.gmail.com>
	<1BA927F352D3457BBB7BEDA210AFEE73@DMITRY>
	<22821af30806101715t4e84dfeft65dffd4c76728b5b@mail.gmail.com>
	<05AEBB1202DB4DC187B74107ECCD96C4@DMITRY>
Message-ID: <22821af30806131559r4b61f0aan885dea7dda1b56c4@mail.gmail.com>

On Tue, Jun 10, 2008 at 9:36 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> "James Hawkins" <truiken at gmail.com> wrote:
>
>> I've debugged this a bit more, and when running the user32:win test
>> within the winetest.exe program, all checked calls to
>> GetForegroundWindow return NULL.  When running the user32:win test by
>> itself from the command line, only 7 tests fail the
>> GetForegroundWindow call (compared to 40).  This makes me wonder about
>> the behavior of GetForegroundWindow in a child process window, but I'm
>> not really sure where to go from here.
>
> I'd suggest to make winetest minimize itself before running the tests.
>

I added the minimize call to winetest, but the win failures are still
happening.  Now I'm wondering if it has to do with the fact that
explorer either gets restarted, or disappears or something right
before the win tests and if that affects the win tests.  You can see
it happening during the tests.  The desktop and taskbar disappear
about the same time the win tests are run.  That's just a guess
though.

-- 
James Hawkins


From msclrhd at googlemail.com  Thu Jun 12 02:20:00 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Thu, 12 Jun 2008 08:20:00 +0100
Subject: Wine-1.0 release notes
In-Reply-To: <48507FE6.6040102@kievinfo.com>
References: <4850581B.2080708@kievinfo.com>
	<3f4fd2640806111702w20f99b77s21d4aa1f8197515c@mail.gmail.com>
	<48507FE6.6040102@kievinfo.com>
Message-ID: <3f4fd2640806120020l1f9afb0v1f46f3fcfc309684@mail.gmail.com>

2008/6/12 Vitaliy Margolen <wine-devel at kievinfo.com>:
> Reece Dunn wrote:
>>
>> 2008/6/11 Vitaliy Margolen <wine-devel at kievinfo.com>:
>>>
>>> In short - that after everyone's hard work and 15 years of development
>>> wine-1.0 is just a release tag nothing more.
>>
>> I think that this is overly harsh. It's like saying that you should
>> not celebrate a birthday, as that is just you aging just a day,
>> nothing more.
>
> If birthdays would start coming every 2 weeks after about 100's you will
> loose track and won't care anymore which one it is.

But those releases are beta releases. The issue here is not that Wine
does not have frequent releases - which it does - but that those
releases are beta. The perception and reception is different. Just
look at all the countless beta releases that Vista had and who was
using them; the majority of users didn't start using it until release.

>> Wine is in a strange position as it is trying to make any Windows
>> application (ultimately) run on any suitable posix system with a
>> suitable X server. Given that a new version of Windows is usually
>> released every 2-3 years, with new features, APIs and functionality,
>
> I wouldn't go that far. Win2k was released in ... 2000. XP (which has some
> number of additions over win2k) was release in 2003 with minor additions in
> 2004 and 2005. And no one in their right mind makes Vista only versions.
> That gives us what? 8 years.

2007 (Vista) - 2002 (XP release) = 5 years, not 8. Vista was an
exception to the release cycle that Microsoft had built since Win95.
Windows 7 is scheduled for 2009, which makes that another 2 years.
Excluding Vista, my statement holds.

> No this argument don't fly - not much is changing in the win32api world, or
> MS would risk killing all their legacy stuff - which is the only reason
> windows is still being used.

I was told that MS has added thousands of new native APIs. There are
the changes made to the theming code; the Desktop Window Manager (DWM)
API; the new hyperlink control; the extension of buttons to support
buttons with menus; the new file open/save API (which also has changes
to the way the Win2K-style open/save dialogs are detected, I believe);
the new enhanced message boxes; .... So saying that not much has
changed in Win32 (and COM) is wrong.

Also, look at the Wine test results to see that a fair amount of the
Win32 API have changed behaviour.

>> Yes, regressions will happen. Yes, applications will crash/fail to
>> work. But think of all the applications that *do* work; given what
>
> That's the problem. After identifying a regression it should be fixed.
> During the code freeze, the changes should be reverted, especially if this
> is new functionality that's having issues. And where were are with those? We
> have a big list of regressions introduced by major changes to different
> parts of Wine either right before the code freeze or during(!) the code
> freeze. And most of those regressions are still not dealt with.

So, like CodeWeavers, we need to pick a set of applications that we
can say "Yes, these *will* work with 1.0." Other applications *may*
work with 1.0 (and you'll need to look in the AppDB for your
particular application), but if they regress it will not block the
release of 1.0. Otherwise, you may as well not do a release, as the
mountain is impossibly steep.

> I'm not blaming anyone as I'm guilty creating regressions in the past.
> However the goal needs to shift from getting new features in, to stabilizing
> and bug fixing. And ~1 month for that is not enough, considering that it
> takes so long to fix some of the problems. I was really surprised to see
> _ANY_ new features getting into Wine in the last 2 months. Let alone major
> ones like XIM, child X windows, pixel formats.

So what new features have gone into RC1-4 (~2 months going on a 2 week
release cycle)?

The major features you mentioned went in before the freeze, IIRC, so
where is the problem? The regression that happened recently happened
because of a fix introduced to fix a game. Yes, it broke other games
(which I'd argue are good candidates for 1.0, so that particular
commit should be reverted cleanly), but we need to figure out which
games are important for 1.0. Another regression was the result of
cleaning up deprecated alsa calls that broke older alsa drivers on
various distributions (which I happened to spot - I thought it might
have been the pulseaudio adapter, but my machine is currently using a
real alsa driver).

Regressions happen. If they are in applications that we are going to
support in 1.0, they should be fixed, otherwise they should be in the
release notes if relevant

>> NOTE: I am not saying Wine is perfect, I'm saying that the message
>> should be positive and realistic instead of unduly negative.
>
> I did not meant to make it sound that negative. After all each new version
> of Wine had number of important features and loads of bug fixes. Which is
> great on it's own. Just don't make wine-1.0 anything more then it really is
> - new release with bug fixes and no new features.

The point of the freeze is *not* to add any new features. The point is
to address as many outstanding issues as possible, with minimal
regression. Unless (and until) Wine has a full and complete
implementation of the Windows API, then it does not stand a chance of
running every application flawlessly. So the release needs to be
pragmatic: which bugs are showstoppers, which applications does Wine
need to run.

Does anyone know what the state of installing/running Office 2003 is,
because I seem to recall there being a regression in this area. That
is something that I would consider a blocker.

- Reece


From mark.farnell at gmail.com  Fri Jun 13 18:54:44 2008
From: mark.farnell at gmail.com (Mark Farnell)
Date: Sat, 14 Jun 2008 11:54:44 +1200
Subject: [legal] eligibility for contributing code to wine for students /
	graduates of a course derived from the Microsoft Windows
	Acadamic Program
Message-ID: <aaf549e0806131654i1d816d69qa4f26429118a8a36@mail.gmail.com>

If a student is currently taking, or has previously taken a course
derived from the Microsoft Windows Academic Program

http://www.microsoft.com/resources/sharedsource/windowsacademic/default.mspx

which contains the curriculum resource kit, Windows Research Kernel
(containing Windows XP x64 amd Server 2003 SP1 kernel sources) and
Project OZ,

will they become *ineligible* to contribute code to the wine
project in the future?

Thanks!

Mark


From winehacker at gmail.com  Fri Jun 13 19:15:50 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 13 Jun 2008 20:15:50 -0400
Subject: Wine-1.0 release notes
In-Reply-To: <3f4fd2640806120020l1f9afb0v1f46f3fcfc309684@mail.gmail.com>
References: <4850581B.2080708@kievinfo.com>
	<3f4fd2640806111702w20f99b77s21d4aa1f8197515c@mail.gmail.com>
	<48507FE6.6040102@kievinfo.com>
	<3f4fd2640806120020l1f9afb0v1f46f3fcfc309684@mail.gmail.com>
Message-ID: <19e31a080806131715kdf05a9ah2341c0bec6da70fa@mail.gmail.com>

On Thu, Jun 12, 2008 at 3:20 AM, Reece Dunn <msclrhd at googlemail.com> wrote:
> Does anyone know what the state of installing/running Office 2003 is,
> because I seem to recall there being a regression in this area. That
> is something that I would consider a blocker.

It installs fine, however almost nothing works well the last time I
looked. This would not bother me so much if some version of Office
worked better like Office 2000 or hell even Office 97 but none of them
work well enough to write home about.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Fri Jun 13 19:27:54 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 13 Jun 2008 20:27:54 -0400
Subject: [legal] eligibility for contributing code to wine for students /
	graduates of a course derived from the Microsoft Windows
	Acadamic Program
In-Reply-To: <aaf549e0806131654i1d816d69qa4f26429118a8a36@mail.gmail.com>
References: <aaf549e0806131654i1d816d69qa4f26429118a8a36@mail.gmail.com>
Message-ID: <19e31a080806131727o76334820n9bf7d12491aead0e@mail.gmail.com>

On Fri, Jun 13, 2008 at 7:54 PM, Mark Farnell <mark.farnell at gmail.com> wrote:
> If a student is currently taking, or has previously taken a course
> derived from the Microsoft Windows Academic Program
>
> http://www.microsoft.com/resources/sharedsource/windowsacademic/default.mspx
>
> which contains the curriculum resource kit, Windows Research Kernel
> (containing Windows XP x64 amd Server 2003 SP1 kernel sources) and
> Project OZ,
>
> will they become *ineligible* to contribute code to the wine
> project in the future?

Yes, forever seems to be the curse you are stuck with. So goes what I
have heard over the years. Its a bummer too as I know a number of
people this affects. This question gets asked more and more these days
and we don't seem to have a clear answer for when if ever your taint
will wear off. You might want to ask the Samba project how they feel
about this and also check with the Software Freedom Law Center. I am
curious what they say.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From truiken at gmail.com  Fri Jun 13 19:57:20 2008
From: truiken at gmail.com (James Hawkins)
Date: Fri, 13 Jun 2008 19:57:20 -0500
Subject: [legal] eligibility for contributing code to wine for students /
	graduates of a course derived from the Microsoft Windows
	Acadamic Program
In-Reply-To: <19e31a080806131727o76334820n9bf7d12491aead0e@mail.gmail.com>
References: <aaf549e0806131654i1d816d69qa4f26429118a8a36@mail.gmail.com>
	<19e31a080806131727o76334820n9bf7d12491aead0e@mail.gmail.com>
Message-ID: <22821af30806131757j4cb44371n17ec4eb9245ddfe1@mail.gmail.com>

On Fri, Jun 13, 2008 at 7:27 PM, Steven Edwards <winehacker at gmail.com> wrote:
> On Fri, Jun 13, 2008 at 7:54 PM, Mark Farnell <mark.farnell at gmail.com> wrote:
>> If a student is currently taking, or has previously taken a course
>> derived from the Microsoft Windows Academic Program
>>
>> http://www.microsoft.com/resources/sharedsource/windowsacademic/default.mspx
>>
>> which contains the curriculum resource kit, Windows Research Kernel
>> (containing Windows XP x64 amd Server 2003 SP1 kernel sources) and
>> Project OZ,
>>
>> will they become *ineligible* to contribute code to the wine
>> project in the future?
>
> Yes, forever seems to be the curse you are stuck with. So goes what I
> have heard over the years. Its a bummer too as I know a number of
> people this affects. This question gets asked more and more these days
> and we don't seem to have a clear answer for when if ever your taint
> will wear off. You might want to ask the Samba project how they feel
> about this and also check with the Software Freedom Law Center. I am
> curious what they say.
>

They can also read the NDA I'm sure they had to sign before
participating in the program.

-- 
James Hawkins


From winehacker at gmail.com  Fri Jun 13 21:14:15 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 13 Jun 2008 22:14:15 -0400
Subject: [legal] eligibility for contributing code to wine for students /
	graduates of a course derived from the Microsoft Windows
	Acadamic Program
In-Reply-To: <22821af30806131757j4cb44371n17ec4eb9245ddfe1@mail.gmail.com>
References: <aaf549e0806131654i1d816d69qa4f26429118a8a36@mail.gmail.com>
	<19e31a080806131727o76334820n9bf7d12491aead0e@mail.gmail.com>
	<22821af30806131757j4cb44371n17ec4eb9245ddfe1@mail.gmail.com>
Message-ID: <19e31a080806131914m5a7d561agb304d10c3c91a972@mail.gmail.com>

On Fri, Jun 13, 2008 at 8:57 PM, James Hawkins <truiken at gmail.com> wrote:
> They can also read the NDA I'm sure they had to sign before
> participating in the program.

There is no NDA as far as I am aware. The license restrictions are
that you can't copy and paste anything but your free to take what
learn. They want to spawn a whole generation of Windows Kernel
developers that know the internals of the OS so they can write device
drivers and the like and supplant using Linux/Unix as a learning tool
in the university.

"You may use any information in intangible form that you remember
after accessing the software. However, this right does not grant you a
license to any of Microsoft's copyrights or patents for anything you
might create using such information."

http://www.microsoft.com/resources/sharedsource/licensing/basics/wrklicense.mspx

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Fri Jun 13 23:40:58 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 14 Jun 2008 13:40:58 +0900
Subject: user32: Allow a NULL foreground window in the tests
References: <22821af30805290755i3c0ef390w34f946abd1199670@mail.gmail.com><300C02AB64C44487B18D6E5CC9E31489@DMITRY><22821af30805290813k727e0ebl451b0e92208aa378@mail.gmail.com><1566C26A35024168AE429ED197788C4B@DMITRY><22821af30805290835v45618ec7h1e80b4d985112aee@mail.gmail.com><1BA927F352D3457BBB7BEDA210AFEE73@DMITRY><22821af30806101715t4e84dfeft65dffd4c76728b5b@mail.gmail.com><05AEBB1202DB4DC187B74107ECCD96C4@DMITRY>
	<22821af30806131559r4b61f0aan885dea7dda1b56c4@mail.gmail.com>
Message-ID: <D75D7871A2DB4FE0A00750779B755895@DMITRY>

"James Hawkins" <truiken at gmail.com> wrote:

> I added the minimize call to winetest, but the win failures are still
> happening.  Now I'm wondering if it has to do with the fact that
> explorer either gets restarted, or disappears or something right
> before the win tests and if that affects the win tests.  You can see
> it happening during the tests.  The desktop and taskbar disappear
> about the same time the win tests are run.  That's just a guess
> though.

Does it help if you comment out test_shell_window(), or make it
the very last test?

-- 
Dmitry.


From dmitry at codeweavers.com  Fri Jun 13 23:53:11 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 14 Jun 2008 13:53:11 +0900
Subject: user32: Handle GetTextMetricsW failure in get_text_metr_size
References: <bb6a273e0806131353u37c86fercfe46335348671d0@mail.gmail.com>
Message-ID: <36B79AB218ED4DF3A43AA7965DC24638@DMITRY>

"Roy Shea" <royshea at gmail.com> wrote:

> Initializes the tmHeight field of the TEXTMETRICW used by callers of
> get_text_metr_size, even when calls to GetTextMetricsW fail.  This fix
> remedies the Valgrind errors of the form "normalize_nonclientmetrics
> (sysparams.c:1043)" found throughout the advpack test suite.

GetTextMetricsW should never fail. You need to find a reason of a failure.

-- 
Dmitry.


From truiken at gmail.com  Sat Jun 14 02:14:16 2008
From: truiken at gmail.com (James Hawkins)
Date: Sat, 14 Jun 2008 02:14:16 -0500
Subject: user32: Allow a NULL foreground window in the tests
In-Reply-To: <D75D7871A2DB4FE0A00750779B755895@DMITRY>
References: <22821af30805290755i3c0ef390w34f946abd1199670@mail.gmail.com>
	<300C02AB64C44487B18D6E5CC9E31489@DMITRY>
	<22821af30805290813k727e0ebl451b0e92208aa378@mail.gmail.com>
	<1566C26A35024168AE429ED197788C4B@DMITRY>
	<22821af30805290835v45618ec7h1e80b4d985112aee@mail.gmail.com>
	<1BA927F352D3457BBB7BEDA210AFEE73@DMITRY>
	<22821af30806101715t4e84dfeft65dffd4c76728b5b@mail.gmail.com>
	<05AEBB1202DB4DC187B74107ECCD96C4@DMITRY>
	<22821af30806131559r4b61f0aan885dea7dda1b56c4@mail.gmail.com>
	<D75D7871A2DB4FE0A00750779B755895@DMITRY>
Message-ID: <22821af30806140014u727cd84am211ed0b1c339e9b6@mail.gmail.com>

On Fri, Jun 13, 2008 at 11:40 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> "James Hawkins" <truiken at gmail.com> wrote:
>
>> I added the minimize call to winetest, but the win failures are still
>> happening.  Now I'm wondering if it has to do with the fact that
>> explorer either gets restarted, or disappears or something right
>> before the win tests and if that affects the win tests.  You can see
>> it happening during the tests.  The desktop and taskbar disappear
>> about the same time the win tests are run.  That's just a guess
>> though.
>
> Does it help if you comment out test_shell_window(), or make it
> the very last test?
>

Commenting the test out doesn't help.

-- 
James Hawkins


From dmitry at codeweavers.com  Sat Jun 14 02:26:25 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 14 Jun 2008 16:26:25 +0900
Subject: user32: Allow a NULL foreground window in the tests
References: <22821af30805290755i3c0ef390w34f946abd1199670@mail.gmail.com><300C02AB64C44487B18D6E5CC9E31489@DMITRY><22821af30805290813k727e0ebl451b0e92208aa378@mail.gmail.com><1566C26A35024168AE429ED197788C4B@DMITRY><22821af30805290835v45618ec7h1e80b4d985112aee@mail.gmail.com><1BA927F352D3457BBB7BEDA210AFEE73@DMITRY><22821af30806101715t4e84dfeft65dffd4c76728b5b@mail.gmail.com><05AEBB1202DB4DC187B74107ECCD96C4@DMITRY><22821af30806131559r4b61f0aan885dea7dda1b56c4@mail.gmail.com><D75D7871A2DB4FE0A00750779B755895@DMITRY>
	<22821af30806140014u727cd84am211ed0b1c339e9b6@mail.gmail.com>
Message-ID: <40DEF46BD0954BBA8F42C1FDA8C7A451@DMITRY>

"James Hawkins" <truiken at gmail.com> wrote:

> Commenting the test out doesn't help.

Then I'm out of ideas, but it's clear to me that it's winetest who screws
the things up.

-- 
Dmitry.


From jjmckenzie51 at sprintpcs.com  Sat Jun 14 06:33:26 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 14 Jun 2008 04:33:26 -0700
Subject: [legal] eligibility for contributing code to wine for students
	/	graduates of a course derived from the Microsoft Windows	Acadamic
	Program
In-Reply-To: <19e31a080806131914m5a7d561agb304d10c3c91a972@mail.gmail.com>
References: <aaf549e0806131654i1d816d69qa4f26429118a8a36@mail.gmail.com>
	<19e31a080806131727o76334820n9bf7d12491aead0e@mail.gmail.com>
	<22821af30806131757j4cb44371n17ec4eb9245ddfe1@mail.gmail.com>
	<19e31a080806131914m5a7d561agb304d10c3c91a972@mail.gmail.com>
Message-ID: <4853AC86.600@sprintpcs.com>

Steven Edwards wrote:
> On Fri, Jun 13, 2008 at 8:57 PM, James Hawkins <truiken at gmail.com> wrote:
>   
>> They can also read the NDA I'm sure they had to sign before
>> participating in the program.
>>     
>
> There is no NDA as far as I am aware. The license restrictions are
> that you can't copy and paste anything but your free to take what
> learn. They want to spawn a whole generation of Windows Kernel
> developers that know the internals of the OS so they can write device
> drivers and the like and supplant using Linux/Unix as a learning tool
> in the university.
>
> "You may use any information in intangible form that you remember
> after accessing the software. However, this right does not grant you a
> license to any of Microsoft's copyrights or patents for anything you
> might create using such information."
>
>   
That's about as simple as it gets.  They cannot contribute to Wine 
without breaking this. 

James McKenzie



From stefandoesinger at gmx.at  Sat Jun 14 06:23:39 2008
From: stefandoesinger at gmx.at (=?windows-1252?Q?Stefan_D=F6singer?=)
Date: Sat, 14 Jun 2008 13:23:39 +0200
Subject: ddraw: Fix Setmaterial with a test
In-Reply-To: <5f9140a20806140259g7ad07a26ke3afd615a209eab7@mail.gmail.com>
References: <5f9140a20806100626jb88e6b7x311dbaa3b8601028@mail.gmail.com>	
	<484F41E8.3060706@kievinfo.com>
	<000001c8cbde$8c454fb0$a4cfef10$@at>
	<5f9140a20806140259g7ad07a26ke3afd615a209eab7@mail.gmail.com>
Message-ID: <001201c8ce11$18da8880$4a8f9980$@at>

Maybe you have to resubmit them after the discussion, or maybe Alexandre
didn't commit them due to the code freeze if they do not explicitly fix a
1.0.0 bug

 

From: David Adam [mailto:david.adam.cnrs at gmail.com] 
Sent: Saturday, June 14, 2008 12:00 PM
To: Stefan D?singer
Cc: Vitaliy Margolen; wine-devel
Subject: Re: ddraw: Fix Setmaterial with a test

 

Yes, it is exactly that. So, I wonder why the patches were not committed.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080614/7af6eea8/attachment.htm 

From jjmckenzie51 at sprintpcs.com  Sat Jun 14 06:31:19 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 14 Jun 2008 04:31:19 -0700
Subject: Unhandled page fault on prefix creation on osx 10.5
In-Reply-To: <e3d3ae8f0806130916s4e42552dwf940605a65754f4d@mail.gmail.com>
References: <e3d3ae8f0806130916s4e42552dwf940605a65754f4d@mail.gmail.com>
Message-ID: <4853AC07.2010507@sprintpcs.com>

Cesar Izurieta wrote:
> I just deleted my .wine directory and run wineboot. The .wine
> directory is recreated but I get:
>
> wine: created the configuration directory '/Users/cesar/.wine'
> wine: Unhandled page fault on read access to 0x008cc65f at address
> 0xffff0eb8 (thread 000b), starting debugger...
> couldn't load main module (2)
> Unhandled exception: page fault on read access to 0x008cc65f in 32-bit
> code (0xffff0eb8).
>
> And a lot of dumps and backtraces. I did a regression testing and
> found out that 58913b439b797462a70794774b87e63283109617 commit is what
> is causing this problem. Reverting this commit everything works
> perfectly. More information about the commit (from git bisect):
>
> 58913b439b797462a70794774b87e63283109617 is first bad commit
> commit 58913b439b797462a70794774b87e63283109617
> Author: Alexandre Julliard <julliard at winehq.org>
> Date:   Fri Feb 15 12:07:56 2008 +0100
>
>     kernel32: On Mac OS, recompose the Unicode strings we get from the OS.
>
> :040000 040000 f3d03f060068424b166b0ce68169c5a3eddab96e
> f1a567176edfd42947239dbacff3cc8ad469a497 M	dlls
>
> I'm using osx 10.5.3 in spanish on a macbook pro. Does anybody know about this?
>
>
>   
Please open a bug report with all of the details from the dumps and 
backtraces as an attached file.

Also, please include the source of the Darwine build in the bug report.

Thank you.

James McKenzie


From winehacker at gmail.com  Sat Jun 14 06:28:32 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sat, 14 Jun 2008 07:28:32 -0400
Subject: [legal] eligibility for contributing code to wine for students /
	graduates of a course derived from the Microsoft Windows
	Acadamic Program
In-Reply-To: <3f4fd2640806140213s4aeeaf3hc79951c9cec26fb1@mail.gmail.com>
References: <aaf549e0806131654i1d816d69qa4f26429118a8a36@mail.gmail.com>
	<19e31a080806131727o76334820n9bf7d12491aead0e@mail.gmail.com>
	<3f4fd2640806140213s4aeeaf3hc79951c9cec26fb1@mail.gmail.com>
Message-ID: <19e31a080806140428g7eaac1cauf84493fffff7ae70@mail.gmail.com>

On Sat, Jun 14, 2008 at 5:13 AM, Reece Dunn <msclrhd at googlemail.com> wrote:
> IANAL, but the sources are for the kernel only. This does not include
> the UI and other DLLs built on top of the kernel. If we know what DLLs
> the sources correspond to, shouldn't the students be restricted to not
> contributing to those DLLs only (just like if you use Visual Studio
> you can't contribute to the ATL or the C/C++ runtime libraries)?
>
> Also, this shouldn't prevent those people contributing to the Wine tests.

This is the way I feel it should be done, with some sort of reasonable
timeframe but Its up to Alexandre or the SFLC to decide. I mean Wine
is 15 years old, lets assume it lives another 15 years, is someone
that has a license at the university now, unable to write ntoskrnl 15
years from now. Hell even Linus had a copy of the Lyons book that
contained a rip off of Unix sources...

> Am I correct in this, or does the taint impact all of Wine?

Its up to Alexandre and the SFLC to clear this issue up. Its starting
to get raised often enough that I think clarification is warranted.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sat Jun 14 07:35:16 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 14 Jun 2008 21:35:16 +0900
Subject: [legal] eligibility for contributing code to wine for students
	/graduates of a course derived from the Microsoft
	WindowsAcadamic Program
References: <aaf549e0806131654i1d816d69qa4f26429118a8a36@mail.gmail.com>
Message-ID: <B84FFB6056A34353895D1DB758AB2CD2@DMITRY>

"Mark Farnell" <mark.farnell at gmail.com> wrote:

> If a student is currently taking, or has previously taken a course
> derived from the Microsoft Windows Academic Program
> 
> http://www.microsoft.com/resources/sharedsource/windowsacademic/default.mspx
> 
> which contains the curriculum resource kit, Windows Research Kernel
> (containing Windows XP x64 amd Server 2003 SP1 kernel sources) and
> Project OZ,
> 
> will they become *ineligible* to contribute code to the wine
> project in the future?

According to Windows Research Kernel (WRK) description at
http://www.microsoft.com/resources/sharedsource/windowsacademic/researchkernelkit.mspx

The WRK includes the source for:
Processes 
Threads 
LPC 
Virtual memory 
Scheduler 
Object manager 
I/O manager 
Synchronization 
Worker threads 
Kernel heap manager 
Other core Windows (NTOS) kernel functionality

So, to me it looks like anything outside of ntdll/kernel32/wineserver (excluding user32
backend) has no any relation to WRK.

-- 
Dmitry.


From wine.dev at web.de  Sat Jun 14 07:36:13 2008
From: wine.dev at web.de (Detlef Riekenberg)
Date: Sat, 14 Jun 2008 14:36:13 +0200
Subject: Bugs in Wine research
In-Reply-To: <20080527151136.ltstw9dr4k8wggoc@webmail.cs.aau.dk>
References: <20080527151136.ltstw9dr4k8wggoc@webmail.cs.aau.dk>
Message-ID: <1213446973.15317.12.camel@p4>

On Di, 2008-05-27 at 15:11 +0200, tomecek at cs.aau.dk wrote:

> the complete results are available at
> http://www.cs.aau.dk/~dechouxb/results/complete/, 

The requested URL /~dechouxb/results/complete/ was not found on this
server.

Thanks for helping Wine


-- 
 
By by ... Detlef




From winehacker at gmail.com  Sat Jun 14 07:37:03 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Sat, 14 Jun 2008 08:37:03 -0400
Subject: [legal] eligibility for contributing code to wine for students /
	graduates of a course derived from the Microsoft Windows
	Acadamic Program
In-Reply-To: <4853AC86.600@sprintpcs.com>
References: <aaf549e0806131654i1d816d69qa4f26429118a8a36@mail.gmail.com>
	<19e31a080806131727o76334820n9bf7d12491aead0e@mail.gmail.com>
	<22821af30806131757j4cb44371n17ec4eb9245ddfe1@mail.gmail.com>
	<19e31a080806131914m5a7d561agb304d10c3c91a972@mail.gmail.com>
	<4853AC86.600@sprintpcs.com>
Message-ID: <19e31a080806140537m5f6fe683te99dc51d598a16a8@mail.gmail.com>

On Sat, Jun 14, 2008 at 7:33 AM, James McKenzie
<jjmckenzie51 at sprintpcs.com> wrote:
>> "You may use any information in intangible form that you remember
>> after accessing the software. However, this right does not grant you a
>> license to any of Microsoft's copyrights or patents for anything you
>> might create using such information."
>>
> That's about as simple as it gets.  They cannot contribute to Wine without
> breaking this.
> James McKenzie

I don't follow. No one that contributes to Wine has a license for
Microsoft Copyright or patent. IANAL but It seems to me that it means
something like the following in layman's terms.

You can use whatever you remember afterward, but you can't copy and
paste source code, and accepting this license or remembering something
from it does not exempt you from patent litigation. (which no one is
exempt from anyway)

I'll email Microsoft licensing for clarification, but again it seems
pretty cut and dry to me. What part is not clear?

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From paul.vriens.wine at gmail.com  Sat Jun 14 09:53:26 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Sat, 14 Jun 2008 16:53:26 +0200
Subject: Bugs in Wine research
In-Reply-To: <1213446973.15317.12.camel@p4>
References: <20080527151136.ltstw9dr4k8wggoc@webmail.cs.aau.dk>
	<1213446973.15317.12.camel@p4>
Message-ID: <4853DB66.2020405@gmail.com>

Detlef Riekenberg wrote:
> On Di, 2008-05-27 at 15:11 +0200, tomecek at cs.aau.dk wrote:
> 
>> the complete results are available at
>> http://www.cs.aau.dk/~dechouxb/results/complete/, 
> 
> The requested URL /~dechouxb/results/complete/ was not found on this
> server.
> 
> Thanks for helping Wine
> 
> 
Try http://www.cs.aau.dk/~dechouxb/cocci_results/complete/

-- 
Cheers,

Paul.


From dank at kegel.com  Sat Jun 14 10:00:50 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 14 Jun 2008 08:00:50 -0700
Subject: Bugs in Wine research
In-Reply-To: <a71bd89a0805100512k14b21936qd379e33a80c35694@mail.gmail.com>
References: <a71bd89a0805100512k14b21936qd379e33a80c35694@mail.gmail.com>
Message-ID: <a71bd89a0806140800q46f06a1s2ddf162d2123c230@mail.gmail.com>

On Sat, May 10, 2008 at 5:12 AM, Dan Kegel <dank at kegel.com> wrote:
> tomecek wrote:
>> we are students from Department of computer science at Aalborg
>> university. During this semester we were working on project on static
>> analysis using the Coccinelle tool
>
>  http://wiki.winehq.org/StaticAnalysis

Detlef wrote:
> The requested URL /~dechouxb/results/complete/ was not found

I've updated the wiki page to have the new URL (they just changed
results to cocchi_results, I think).


From paul.vriens.wine at gmail.com  Sat Jun 14 09:51:40 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Sat, 14 Jun 2008 16:51:40 +0200
Subject: test.winehq.org doesn't always show the download link for the
	executable
Message-ID: <4853DAFC.4080500@gmail.com>

Hi,

I was just reading a Dutch site were somebody mentioned to help Wine and 
referred to:

http://test.winehq.com/data/062d61a5a4ba2d7972a0011387ceda64c79dd4e3/

(with a remark about possible reboots of your system).

The current page however doesn't have a link to the winetest executable. This is 
because the last report that is picked up by the 'gather' script fills in this 
executable. If the last report came from somebody running it's own winetest on 
Wine (instead of the Paul Millars one) there will be 'N/A' (I also saw '-') 
instead of a proper executable.

How could we improve this?

- if the last report mentions 'N/A' use a link to 
http://www.astro.gla.ac.uk/users/paulm/WRT/CrossBuilt/winetest-latest.exe? The 
problem is however that this doesn't have to be the same winetest 'version'.
- if any of the reports contains a link to Paul Millars executable, use that.
- if none of the reports refer to a proper executable use that winetest-latest 
again.

Any ideas, suggestions?

-- 
Cheers,

Paul.


From dank at kegel.com  Sat Jun 14 12:55:01 2008
From: dank at kegel.com (Dan Kegel)
Date: Sat, 14 Jun 2008 10:55:01 -0700
Subject: new winetricks: new verbs comctl32.ocx, autohotkey
Message-ID: <a71bd89a0806141055x37951f23mdf3e001a602dfdcc@mail.gmail.com>

Can somebody who needs comctl32.ocx or mscomctl.ocx test
this?  I added this at the suggestion of a comment on
http://mike.kronenberg.org, but don't have an app handy to test with.

Changes:
Use "MS" uniformly in front of choices that are Microsoft downloads.
Add comctl32.ocx
Add comctl32 as alias for cc580
Added autohotkey
Cosmetic changes to menu: make 1st column wider, make gui window wide enough
Restore winversion on dotnet20 (Austin)

As always, the latest winetricks is online at
  http://kegel.com/wine/winetricks
and the change history is online at
  http://winezeug.googlecode.com/
- Dan


From jjmckenzie51 at sprintpcs.com  Sat Jun 14 20:26:31 2008
From: jjmckenzie51 at sprintpcs.com (James McKenzie)
Date: Sat, 14 Jun 2008 18:26:31 -0700
Subject: Unhandled page fault on prefix creation on osx 10.5
In-Reply-To: <4853AC07.2010507@sprintpcs.com>
References: <e3d3ae8f0806130916s4e42552dwf940605a65754f4d@mail.gmail.com>
	<4853AC07.2010507@sprintpcs.com>
Message-ID: <48546FC7.9010603@sprintpcs.com>

James McKenzie wrote:
> Cesar Izurieta wrote:
>   
>> I just deleted my .wine directory and run wineboot. The .wine
>> directory is recreated but I get:
>>
>> wine: created the configuration directory '/Users/cesar/.wine'
>> wine: Unhandled page fault on read access to 0x008cc65f at address
>> 0xffff0eb8 (thread 000b), starting debugger...
>> couldn't load main module (2)
>> Unhandled exception: page fault on read access to 0x008cc65f in 32-bit
>> code (0xffff0eb8).
>>
>> And a lot of dumps and backtraces. I did a regression testing and
>> found out that 58913b439b797462a70794774b87e63283109617 commit is what
>> is causing this problem. Reverting this commit everything works
>> perfectly. More information about the commit (from git bisect):
>>
>> 58913b439b797462a70794774b87e63283109617 is first bad commit
>> commit 58913b439b797462a70794774b87e63283109617
>> Author: Alexandre Julliard <julliard at winehq.org>
>> Date:   Fri Feb 15 12:07:56 2008 +0100
>>
>>     kernel32: On Mac OS, recompose the Unicode strings we get from the OS.
>>
>> :040000 040000 f3d03f060068424b166b0ce68169c5a3eddab96e
>> f1a567176edfd42947239dbacff3cc8ad469a497 M	dlls
>>
>> I'm using osx 10.5.3 in spanish on a macbook pro. Does anybody know about this?
>>
>>
>>   
>>     
> Please open a bug report with all of the details from the dumps and 
> backtraces as an attached file.
>
> Also, please include the source of the Darwine build in the bug report.
>   
Please do not DO THIS.  What I meant to say is:  Please include in your 
bug report where you got Darwine from and which version.

Thank you

James McKenzie



From cesar at ecuarock.net  Sun Jun 15 01:21:55 2008
From: cesar at ecuarock.net (Cesar Izurieta)
Date: Sun, 15 Jun 2008 01:21:55 -0500
Subject: Unhandled page fault on prefix creation on osx 10.5
In-Reply-To: <48546FC7.9010603@sprintpcs.com>
References: <e3d3ae8f0806130916s4e42552dwf940605a65754f4d@mail.gmail.com>
	<4853AC07.2010507@sprintpcs.com> <48546FC7.9010603@sprintpcs.com>
Message-ID: <e3d3ae8f0806142321y34e1a9eeg9715a8d9f9d54a0e@mail.gmail.com>

Thanks. I'm just building wine from git. I'm actually not using darwine.

On Sat, Jun 14, 2008 at 8:26 PM, James McKenzie
<jjmckenzie51 at sprintpcs.com> wrote:
> James McKenzie wrote:
>>
>> Cesar Izurieta wrote:
>>
>>>
>>> I just deleted my .wine directory and run wineboot. The .wine
>>> directory is recreated but I get:
>>>
>>> wine: created the configuration directory '/Users/cesar/.wine'
>>> wine: Unhandled page fault on read access to 0x008cc65f at address
>>> 0xffff0eb8 (thread 000b), starting debugger...
>>> couldn't load main module (2)
>>> Unhandled exception: page fault on read access to 0x008cc65f in 32-bit
>>> code (0xffff0eb8).
>>>
>>> And a lot of dumps and backtraces. I did a regression testing and
>>> found out that 58913b439b797462a70794774b87e63283109617 commit is what
>>> is causing this problem. Reverting this commit everything works
>>> perfectly. More information about the commit (from git bisect):
>>>
>>> 58913b439b797462a70794774b87e63283109617 is first bad commit
>>> commit 58913b439b797462a70794774b87e63283109617
>>> Author: Alexandre Julliard <julliard at winehq.org>
>>> Date:   Fri Feb 15 12:07:56 2008 +0100
>>>
>>>    kernel32: On Mac OS, recompose the Unicode strings we get from the OS.
>>>
>>> :040000 040000 f3d03f060068424b166b0ce68169c5a3eddab96e
>>> f1a567176edfd42947239dbacff3cc8ad469a497 M      dlls
>>>
>>> I'm using osx 10.5.3 in spanish on a macbook pro. Does anybody know about
>>> this?
>>>
>>>
>>>
>>
>> Please open a bug report with all of the details from the dumps and
>> backtraces as an attached file.
>>
>> Also, please include the source of the Darwine build in the bug report.
>>
>
> Please do not DO THIS.  What I meant to say is:  Please include in your bug
> report where you got Darwine from and which version.
>
> Thank you
>
> James McKenzie
>
>


From paul.vriens.wine at gmail.com  Sun Jun 15 07:08:55 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Sun, 15 Jun 2008 14:08:55 +0200
Subject: ddraw: Reset the viewport data before each test
In-Reply-To: <22821af30806141531v512e00d4t51317d0e48f996aa@mail.gmail.com>
References: <22821af30806141531v512e00d4t51317d0e48f996aa@mail.gmail.com>
Message-ID: <48550657.5050701@gmail.com>

James Hawkins wrote:
> Hi,
> 
> Fixes bug 13643 and the ddraw:d3d tests.
> 
> Changelog:
> * Reset the viewport data before each test.
> 
>  dlls/ddraw/tests/d3d.c |   31 +++++++++++++++++++++------------
>  1 files changed, 20 insertions(+), 11 deletions(-)
> 
> 
> 
> ------------------------------------------------------------------------
> 
> 
Can you explain why we have to do this? The fact that only Paul Millar's 
winetest seems to suffer from this is a bit odd, isn't it?

I'm just wondering if there are more issues like this that introduces failures 
in the tests or even worse lets tests succeed.

-- 
Cheers,

Paul.


From alexd4 at inbox.lv  Sun Jun 15 09:21:43 2008
From: alexd4 at inbox.lv (Alexander Dorofeyev)
Date: Sun, 15 Jun 2008 17:21:43 +0300
Subject: ddraw: Reset the viewport data before each test
In-Reply-To: <48550657.5050701@gmail.com>
References: <22821af30806141531v512e00d4t51317d0e48f996aa@mail.gmail.com>
	<48550657.5050701@gmail.com>
Message-ID: <48552577.5020701@inbox.lv>

I have seen this too, on a real XP machine with nvidia card. But it doesn't 
happen on some others, like a win98 machine I tried it on.

If I remember it correctly from the time I tried to debug it, one of the calls 
to TransformVertices there seemed to overflow the buffer on the stack it writes 
to, and it corrupts other things on the stack like the viewport data structure. 
Initializing viewport every time may work around that. As for the corruption 
itself, it may be a driver or native directx bug (that it works on some machines 
supports it). OTOH, it could be Wine doing something undefined that usually just 
works by luck, but, from what little documentation there is about this method in 
the sdk, I couldn't find what could that be.

Paul Vriens wrote:
> James Hawkins wrote:
>> Hi,
>>
>> Fixes bug 13643 and the ddraw:d3d tests.
>>
>> Changelog:
>> * Reset the viewport data before each test.
>>
>>  dlls/ddraw/tests/d3d.c |   31 +++++++++++++++++++++------------
>>  1 files changed, 20 insertions(+), 11 deletions(-)
>>
>>
>>
>> ------------------------------------------------------------------------
>>
>>
> Can you explain why we have to do this? The fact that only Paul Millar's 
> winetest seems to suffer from this is a bit odd, isn't it?
> 
> I'm just wondering if there are more issues like this that introduces failures 
> in the tests or even worse lets tests succeed.
> 



From truiken at gmail.com  Sun Jun 15 11:25:44 2008
From: truiken at gmail.com (James Hawkins)
Date: Sun, 15 Jun 2008 11:25:44 -0500
Subject: ddraw: Reset the viewport data before each test
In-Reply-To: <48550657.5050701@gmail.com>
References: <22821af30806141531v512e00d4t51317d0e48f996aa@mail.gmail.com>
	<48550657.5050701@gmail.com>
Message-ID: <22821af30806150925g7cb90b8sd7fd6434f00e9fd5@mail.gmail.com>

On Sun, Jun 15, 2008 at 7:08 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> James Hawkins wrote:
>>
>> Hi,
>>
>> Fixes bug 13643 and the ddraw:d3d tests.
>>
>> Changelog:
>> * Reset the viewport data before each test.
>>
>>  dlls/ddraw/tests/d3d.c |   31 +++++++++++++++++++++------------
>>  1 files changed, 20 insertions(+), 11 deletions(-)
>>
>>
>>
>> ------------------------------------------------------------------------
>>
>>
> Can you explain why we have to do this? The fact that only Paul Millar's
> winetest seems to suffer from this is a bit odd, isn't it?
>
> I'm just wondering if there are more issues like this that introduces
> failures in the tests or even worse lets tests succeed.
>

It's a driver bug, and I don't think we really need to worry about
explaining that too much.  Read Alexander's comments below, minus the
part about this having anything to do with Wine.

-- 
James Hawkins


From fgouget at free.fr  Mon Jun 16 03:53:39 2008
From: fgouget at free.fr (Francois Gouget)
Date: Mon, 16 Jun 2008 10:53:39 +0200 (CEST)
Subject: 'Interactive' tests on Windows 2003
In-Reply-To: <22821af30806131104n285609ahe93ecd6de3174c45@mail.gmail.com>
References: <alpine.DEB.1.10.0806111326350.31308@amboise.dolphin>
	<22821af30806131104n285609ahe93ecd6de3174c45@mail.gmail.com>
Message-ID: <alpine.DEB.1.10.0806161052180.27121@amboise.dolphin>

On Fri, 13 Jun 2008, James Hawkins wrote:
[...]
> Thanks Francois (I asked on IRC a while back).  I get these dialogs in
> 2k3 as well.  Do you think we should add a check for
> winetest_interactive before the calls that bring up the permission
> dialog?  If anyone else knows of a better way, let us know.

I we can avoid the pop ups altogether that would be better but I don't 
know if that's possible. Otherwise checking for winetest_interactive 
would at least let us get some checks going rather than the whole test 
being a writeoff.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
 Advice is what we ask for when we already know the answer but wish we didn't
                                 -- Eric Jong


From leslieviljoen at gmail.com  Mon Jun 16 07:46:18 2008
From: leslieviljoen at gmail.com (Leslie Viljoen)
Date: Mon, 16 Jun 2008 14:46:18 +0200
Subject: Appdb has no rc5 choice
Message-ID: <f204810a0806160546m3814c1e7qf20c10a973d4a511@mail.gmail.com>

Hi people

I am testing some games with Rc5 and wish to submit results in the
AppDb but there is no Rc5 choice.

Les


From vit.hrachovy at sandbox.cz  Mon Jun 16 07:56:13 2008
From: vit.hrachovy at sandbox.cz (Vit Hrachovy)
Date: Mon, 16 Jun 2008 14:56:13 +0200
Subject: Appdb has no rc5 choice
In-Reply-To: <f204810a0806160546m3814c1e7qf20c10a973d4a511@mail.gmail.com>
References: <f204810a0806160546m3814c1e7qf20c10a973d4a511@mail.gmail.com>
Message-ID: <485662ED.5090300@sandbox.cz>

Hi,
this is never ending story.

Can we automate adding the new release AppDB entry along with new 
release announcement?

Cheers
Vit

Leslie Viljoen wrote:
> Hi people
> 
> I am testing some games with Rc5 and wish to submit results in the
> AppDb but there is no Rc5 choice.
> 
> Les
> 
> 



From austinenglish at gmail.com  Mon Jun 16 08:06:48 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 16 Jun 2008 08:06:48 -0500
Subject: Appdb has no rc5 choice
In-Reply-To: <485662ED.5090300@sandbox.cz>
References: <f204810a0806160546m3814c1e7qf20c10a973d4a511@mail.gmail.com>
	<485662ED.5090300@sandbox.cz>
Message-ID: <b6bb06270806160606n32578f9bvaf67ee33f49aac10@mail.gmail.com>

On Mon, Jun 16, 2008 at 7:56 AM, Vit Hrachovy <vit.hrachovy at sandbox.cz> wrote:
> Hi,
> this is never ending story.
>
> Can we automate adding the new release AppDB entry along with new
> release announcement?
>
> Cheers
> Vit
>
> Leslie Viljoen wrote:
>> Hi people
>>
>> I am testing some games with Rc5 and wish to submit results in the
>> AppDb but there is no Rc5 choice.
>>
>> Les
>>
>>
>
>
>
>

http://bugs.winehq.org/show_bug.cgi?id=13912


From Ben.Engbers at BrouwerCP.nl  Fri Jun 13 19:08:12 2008
From: Ben.Engbers at BrouwerCP.nl (Ben Engbers)
Date: Sat, 14 Jun 2008 02:08:12 +0200
Subject: iTunes ipod support
Message-ID: <1213402092.8070.10.camel@localhost.localdomain>

Hi,

A few days ago, I bought an iPod classic.
When I connect it to my laptop (running FC7) the iPod shows up on the
desktop.
I downloaded iTunessetup.exe from the Apple site and it installed under
Wine without problems.
iTunes looks good, scanned my system and found all the MP3's, but it
doesn't detect the iPod.
(Amarok recognizes the iPod but every time I try to synchronize, the
iPod database gets corrupted and I have to ask my daughter to
reinitialize the iPod :-( so I cant't use that either)

How I can I figure out why iTunes does not detect the iPod?
Ben



From msclrhd at googlemail.com  Sat Jun 14 04:13:12 2008
From: msclrhd at googlemail.com (Reece Dunn)
Date: Sat, 14 Jun 2008 10:13:12 +0100
Subject: [legal] eligibility for contributing code to wine for students /
	graduates of a course derived from the Microsoft Windows
	Acadamic Program
In-Reply-To: <19e31a080806131727o76334820n9bf7d12491aead0e@mail.gmail.com>
References: <aaf549e0806131654i1d816d69qa4f26429118a8a36@mail.gmail.com>
	<19e31a080806131727o76334820n9bf7d12491aead0e@mail.gmail.com>
Message-ID: <3f4fd2640806140213s4aeeaf3hc79951c9cec26fb1@mail.gmail.com>

2008/6/14 Steven Edwards <winehacker at gmail.com>:
> On Fri, Jun 13, 2008 at 7:54 PM, Mark Farnell <mark.farnell at gmail.com> wrote:
>> If a student is currently taking, or has previously taken a course
>> derived from the Microsoft Windows Academic Program
>> ...
>> will they become *ineligible* to contribute code to the wine
>> project in the future?
>
> Yes, forever seems to be the curse you are stuck with. So goes what I
> have heard over the years. Its a bummer too as I know a number of
> people this affects. This question gets asked more and more these days
> and we don't seem to have a clear answer for when if ever your taint
> will wear off. You might want to ask the Samba project how they feel
> about this and also check with the Software Freedom Law Center. I am
> curious what they say.

IANAL, but the sources are for the kernel only. This does not include
the UI and other DLLs built on top of the kernel. If we know what DLLs
the sources correspond to, shouldn't the students be restricted to not
contributing to those DLLs only (just like if you use Visual Studio
you can't contribute to the ATL or the C/C++ runtime libraries)?

Also, this shouldn't prevent those people contributing to the Wine tests.

Am I correct in this, or does the taint impact all of Wine?

We also need a position on .NET participation, because I believe that
the sources come with the MSDN version of Visual Studio 2008. I don't
know how far that goes as I only have upto 2005.

- Reece


From david.adam.cnrs at gmail.com  Sat Jun 14 04:59:59 2008
From: david.adam.cnrs at gmail.com (David Adam)
Date: Sat, 14 Jun 2008 11:59:59 +0200
Subject: ddraw: Fix Setmaterial with a test
In-Reply-To: <000001c8cbde$8c454fb0$a4cfef10$@at>
References: <5f9140a20806100626jb88e6b7x311dbaa3b8601028@mail.gmail.com>
	<484F41E8.3060706@kievinfo.com> <000001c8cbde$8c454fb0$a4cfef10$@at>
Message-ID: <5f9140a20806140259g7ad07a26ke3afd615a209eab7@mail.gmail.com>

Yes, it is exactly that. So, I wonder why the patches were not committed.

David

2008/6/11 Stefan D?singer <stefandoesinger at gmx.at>:

> > So why are you adding the check that is not present on windows? What
> > are th
> > reasoning to have this if it clearly absent in native implementation?
> As I understand it, native ddraw.dll(d3d7) has the check, while d3d8/d3d9
> do
> not. Thus he removed it from WineD3D to have the same behavior as native in
> d3d8 and d3d9, and added it to ddraw to check it there(as native does)
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080614/dc8ebf5a/attachment.htm 

From jon_p_griffiths at yahoo.com  Sat Jun 14 11:09:20 2008
From: jon_p_griffiths at yahoo.com (Jon Griffiths)
Date: Sat, 14 Jun 2008 09:09:20 -0700 (PDT)
Subject: winedbg: Add support for printing c++ bool values
In-Reply-To: <48517248.5050806@orange.fr>
Message-ID: <80170.69379.qm@web56605.mail.re3.yahoo.com>


> what about the simpler:
> +            dbg_printf(val_int ? "true" : "false");

Works for me. I've re-sent the patch.

Cheers
Jon


      


From david.adam.cnrs at gmail.com  Sun Jun 15 02:17:59 2008
From: david.adam.cnrs at gmail.com (David Adam)
Date: Sun, 15 Jun 2008 09:17:59 +0200
Subject: d3dx9_28: add version resource
Message-ID: <5f9140a20806150017k5f039815v7acf20a11dba602f@mail.gmail.com>

Hello,

maybe you should do this for every d3dx9_xx dll, not only the d3dx9_28 one.

David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080615/e49b15e3/attachment.htm 

From dmitry at codeweavers.com  Mon Jun 16 08:28:29 2008
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 16 Jun 2008 22:28:29 +0900
Subject: gdi32: stop font tests crashing under win98
References: <g35mgk$4pk$1@ger.gmane.org>
Message-ID: <AF69C0069FB34426A6BF91971087CFF2@DMITRY>

"Alistair Leslie-Hughes" <leslie_alistair at hotmail.com> wrote:

> Changelog:
> gdi32: stop font tests crashing under win98

> -    if (!*font_name && font_charset == DEFAULT_CHARSET) /* do it only once */
> +    /* EnumFontFamilies with the NULL parameter crashs win98 */
> +    if (pGetFontUnicodeRanges && !*font_name && font_charset == DEFAULT_CHARSET) /* do it only once */

Why you are testing for pGetFontUnicodeRanges here since it has nothing
to do with the test, and disables NT4 as well? There should be a better
way to avoid Win9x, for instance using unicode APIs in this, and only
this case.

-- 
Dmitry.


From austinenglish at gmail.com  Mon Jun 16 08:44:40 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 16 Jun 2008 08:44:40 -0500
Subject: iTunes ipod support
In-Reply-To: <1213402092.8070.10.camel@localhost.localdomain>
References: <1213402092.8070.10.camel@localhost.localdomain>
Message-ID: <b6bb06270806160644m5f98baa4y446f40a1b23a6e43@mail.gmail.com>

On Fri, Jun 13, 2008 at 7:08 PM, Ben Engbers <Ben.Engbers at brouwercp.nl> wrote:
> Hi,
>
> A few days ago, I bought an iPod classic.
> When I connect it to my laptop (running FC7) the iPod shows up on the
> desktop.
> I downloaded iTunessetup.exe from the Apple site and it installed under
> Wine without problems.
> iTunes looks good, scanned my system and found all the MP3's, but it
> doesn't detect the iPod.
> (Amarok recognizes the iPod but every time I try to synchronize, the
> iPod database gets corrupted and I have to ask my daughter to
> reinitialize the iPod :-( so I cant't use that either)
>
> How I can I figure out why iTunes does not detect the iPod?
> Ben
>
>
>
>

http://www.nabble.com/Re:-iPod-patches-td17729911.html

You'll have to compile wine yourself. Hopefully support will be in
wine once out of code freeze.


From dank at kegel.com  Mon Jun 16 08:53:14 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 16 Jun 2008 06:53:14 -0700
Subject: Appdb has no rc5 choice
Message-ID: <a71bd89a0806160653q563c79eaiede764e3cc9181c@mail.gmail.com>

I added the version to bugzilla just now, so the appdb should have it too.


From winehacker at gmail.com  Mon Jun 16 08:21:45 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 16 Jun 2008 09:21:45 -0400
Subject: The upcoming 1.0 and announcing Bordeaux for Linux
Message-ID: <19e31a080806160621o515e1fc1qe5eb37e402ee2688@mail.gmail.com>

Hello All,
I mentioned the other day in the noise about the upcoming 1.0 and the
short comings I felt it had. Others have commented quite a bit on the
subject already and so I'll be pretty brief. I think the 1.0 process
while its been slow has been a good even with its shortcomings. Like
with everything its a learning process and hopefully we will be able
to tweak the process further for 1.x releases.

On the positive side, I think that Dan has done a great job as release
manager, maintaining the bug lists, working on winetest, staying on
top of all the tips and tricks needed to make Valgrind really useful
and maintaining winetricks. I'm also really glad that Alexandre did a
lot of refinement to the winetest infrastructure, everything he has
done with the Wine infrastructure leading up to this point and frankly
for everything he's done for Wine for the past 15 years has been
awesome. Though I will be glad when the freeze is over so we can get
back to having our patches just silently ignored when he does not like
something rather than him having an excuse of the code freeze. =)

One of the shortcomings I see as I stated in my email the other day, I
think we really missed the target on. I think some Office versions
should have been a core requirement of 1.0. Even if it was Office 97
and 2000 working in 98 mode I think we should have been able to
provide a nearly perfect experience out of the box. Or nearly out of
the box as it were, with a little version tweaking. Office is a core
pillar of Microsoft's monopoly and not making this a priority I feel
misses the point of Wine for a lot of users.

Also I think the process can be refined a bit more for subsequent
releases. Some of the developers I spoke with offline were unhappy
about not having a public experimental branch that was blessed to
continue development in. While they could privately do development and
push and pull changes with git, not having a sanctioned experimental
branch, I think slowed the overall processes of development down and
did not really help with bug fixes enough to be warranted. Perhaps in
the future we can maintain parallel lines of development before major
releases. A good example is the Samba guys, they've been working on
Samba 4 for ever, but the stable branch is still being constantly
improved, better, newer stuff is being back ported and development
continues on both tracks.

Finally I am still not really happy with the results of Winetest. I
think we should have had dozens of people that could pass all of the
tests months or even years before 1.0 shipped rather than just
Alexandre's system being the only one that could do a perfect test
run. Maybe we should have just asked him to mirror his setup and
provide a list of every package and configuration option he uses so we
could base target systems on that. Also I think we should have done
something to insure new Wine tests always passed on a fixed version of
Windows a lot sooner. James has done a lot of work to make all of the
tests pass on Windows 2003 but I think we should have done this back
in 2003 and said "every new test has to pass on Windows 2003" as well
as Alexandre's box before it gets merged.

As far as 1.0 goes, its not perfect but its not horrible and I think
we've learned quite a bit and Wine is better now than its ever been. I expect
1.1 or 1.2 whatever number Alexandre wants to call it, will be an
exponential improvement given the experience we've gained.

And lastly I'd like to announce I am starting a new Free Software
company with a long term goal of providing Products and Services
around Wine and ReactOS. The Bordeaux Group has today released
Bordeaux for Linux which builds on the infrastructure laid out in Wine
1.0, Winetricks, IES4Linux and other tools and tries to wrap them all
together in a kind of CrossOver Lite type of environment. The ultimate
goal is to help refine Wine more and aide in ReactOS development to
create a platform that is generic so that users wanting to migrate
away from Windows will have a more broad range of choices, be it Wine
on Linux and the Mac, ReactOS, or even CrossOver,
PlayOnLinux,WineDoors or some other Wine package.

Some of the (limited) work we've already done we hope to be able to
fold back in to Winehq. If your interested check it out
http://www.bordeauxgroup.com

Thanks

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dank at kegel.com  Mon Jun 16 09:34:30 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 16 Jun 2008 07:34:30 -0700
Subject: Valgrind error status on the eve of Wine 1.0
Message-ID: <a71bd89a0806160734v2a7f5b3cpfbf83e936d5ebe72@mail.gmail.com>

I've added suppressions for gecko and a few other things,
added six more patches of my own and eight patches
from Hans, Jon Griffiths, Roy Shea, and Zac Brown.
As a result, the error count today (not counting memory leaks)
is down 33% from last week; we're down to 218 unique-ish
valgrind warnings when running the wine test suite!

If you've submitted a patch to fix a warning reported by
Valgrind, please check to make sure I've included it.

If you have a spare hour or two, please grab
one of the remaining errors and see if you can come up with a
good fix (i.e. one that doesn't just paper over a problem
without understanding it).   Once we're down to near zero
valgrind warnings, it'll be a lot easier for the average
wine developer to check their own patches with valgrind
before submission.

(Why am I ignoring memory leak warnings?  Because I
had to focus on something first.  Once I get those in
shape, I'll focus on memory leaks.)

Report showing unique nonleak errors:
http://kegel.com/wine/valgrind/logs-2008-06-15.counts.txt

Logs:
http://kegel.com/wine/valgrind/logs-2008-06-15.log.gz
http://kegel.com/wine/valgrind/logs-2008-06-15/

Pending wine patches:
http://kegel.com/wine/valgrind/logs-2008-06-15-patches/
http://kegel.com/wine/valgrind/logs-2008-06-15-patches.tgz
http://kegel.com/wine/valgrind/logs-2008-06-15-patch.txt

Suppression file:
http://kegel.com/wine/valgrind/valgrind-suppressions


From austinenglish at gmail.com  Mon Jun 16 09:40:52 2008
From: austinenglish at gmail.com (Austin English)
Date: Mon, 16 Jun 2008 09:40:52 -0500
Subject: The upcoming 1.0 and announcing Bordeaux for Linux
In-Reply-To: <19e31a080806160621o515e1fc1qe5eb37e402ee2688@mail.gmail.com>
References: <19e31a080806160621o515e1fc1qe5eb37e402ee2688@mail.gmail.com>
Message-ID: <b6bb06270806160740i3e6851edx4461814123a1da31@mail.gmail.com>

On Mon, Jun 16, 2008 at 8:21 AM, Steven Edwards <winehacker at gmail.com> wrote:
> And lastly I'd like to announce I am starting a new Free Software
> company with a long term goal of providing Products and Services
> around Wine and ReactOS. The Bordeaux Group has today released
> Bordeaux for Linux which builds on the infrastructure laid out in Wine
> 1.0, Winetricks, IES4Linux and other tools and tries to wrap them all
> together in a kind of CrossOver Lite type of environment. The ultimate
> goal is to help refine Wine more and aide in ReactOS development to
> create a platform that is generic so that users wanting to migrate
> away from Windows will have a more broad range of choices, be it Wine
> on Linux and the Mac, ReactOS, or even CrossOver,
> PlayOnLinux,WineDoors or some other Wine package.
>
> Some of the (limited) work we've already done we hope to be able to
> fold back in to Winehq. If your interested check it out
> http://www.bordeauxgroup.com


I was looking at some of the source code, and some of your files don't
have any copyright. Are the (L)GPL licensed?

-Austin


From kornelpal at gmail.com  Mon Jun 16 10:46:18 2008
From: kornelpal at gmail.com (=?ISO-8859-1?Q?Korn=E9l_P=E1l?=)
Date: Mon, 16 Jun 2008 17:46:18 +0200
Subject: [legal] eligibility for contributing code to wine for students
	/	graduates of a course derived from the Microsoft Windows	Acadamic
	Program
In-Reply-To: <3f4fd2640806140213s4aeeaf3hc79951c9cec26fb1@mail.gmail.com>
References: <aaf549e0806131654i1d816d69qa4f26429118a8a36@mail.gmail.com>	<19e31a080806131727o76334820n9bf7d12491aead0e@mail.gmail.com>
	<3f4fd2640806140213s4aeeaf3hc79951c9cec26fb1@mail.gmail.com>
Message-ID: <48568ACA.6020706@gmail.com>

Hi,

> IANAL, but the sources are for the kernel only. This does not include
> the UI and other DLLs built on top of the kernel. If we know what DLLs
> the sources correspond to, shouldn't the students be restricted to not
> contributing to those DLLs only (just like if you use Visual Studio
> you can't contribute to the ATL or the C/C++ runtime libraries)?

I believe that we shouldn't go this far:
"if you use Visual Studio you can't contribute to the ATL or the C/C++ 
runtime libraries"

Visual Studio is an IDE, compiler and documentation suite. If you use 
Visual Studio, you will not see any source code, unless you install it, 
and look at it at your own will.

> We also need a position on .NET participation, because I believe that
> the sources come with the MSDN version of Visual Studio 2008. I don't
> know how far that goes as I only have upto 2005.

.NET Framework source code is not included in Visual Studio but Visual 
Studio can download it.

Source of information: 
http://www.microsoft.com/resources/sharedsource/rscc.mspx

Visual Studio is a development platform rather than a source code 
collection.

I see banning people from contributing to Wine being only one step from 
banning people from contributing to Wine who use Microsoft Windows.

I hope this is not the "official" point of view.

Korn?l


From winehacker at gmail.com  Mon Jun 16 12:25:17 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 16 Jun 2008 13:25:17 -0400
Subject: The upcoming 1.0 and announcing Bordeaux for Linux
In-Reply-To: <b6bb06270806160740i3e6851edx4461814123a1da31@mail.gmail.com>
References: <19e31a080806160621o515e1fc1qe5eb37e402ee2688@mail.gmail.com>
	<b6bb06270806160740i3e6851edx4461814123a1da31@mail.gmail.com>
Message-ID: <19e31a080806161025s4cbe999dueca73ab14bc6f28b@mail.gmail.com>

On Mon, Jun 16, 2008 at 10:40 AM, Austin English
<austinenglish at gmail.com> wrote:
> I was looking at some of the source code, and some of your files don't
> have any copyright. Are the (L)GPL licensed?

Yes if its something I've written then its LGPL, unless its something
borrowed from another author, in that case, any patch remains under
the terms of the orginal authors license which should be LGPL or GPL
compatible. I'll try to fix the license headers and provide a detailed
map of what software falls under what license in the next few days.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From ben at atomnet.co.uk  Mon Jun 16 13:11:54 2008
From: ben at atomnet.co.uk (Ben Hodgetts (Enverex))
Date: Mon, 16 Jun 2008 19:11:54 +0100
Subject: Wine compiler options benchmarks
Message-ID: <4856ACEA.9090007@atomnet.co.uk>

Just in-case anyone was ever curious about how well Wine performs with
different C/XXFLAGs I did a test today with RC5 to see how much of a
difference it makes with 3DMark 2001 SE, nothing major but if someone
can think of a better benchmark to try, please let me know (I had hoped
to try Oblivion or some such but it has no benchmark feature).

Core2Quad Q9450 @ 3.4Ghz || 4GB PC8500 5-5-5-15 || GCC 4.3.1 || Linux 2.6.25
3DMark 2001 SE B300. Wine 1.0-rc5.

28576		-march=native -O3 -pipe -fomit-frame-pointer
28522		-march=native -O3 -pipe -fomit-frame-pointer -mfpmath=sse,387
28511		-march=native -O2 -pipe -fomit-frame-pointer
28427		-march=native -O3  -fomit-frame-pointer -ffast-math
-funroll-loops -Wall -pipe
28426		-march=native -O2 -pipe -mfpmath=sse,387
28311		-march=native -O2 -pipe
28270		-march=native -Os -pipe -fomit-frame-pointer
28126		-O3 -pipe -fomit-frame-pointer
28072		Wine Default (-g -O2)
27984		-march=native -O3 -pipe
27646		-march=native -Os -pipe


For reference I tried the same with Lame just to show how it would
affect other programs:

Core2Quad Q9450 @ 3.4Ghz || 4GB PC8500 5-5-5-15 || GCC 4.3.1 || Linux 2.6.25
~30 minute stereo wave file encoded in Lame Lame-3.97 64bit.

real	1m28.739s	-O3 -ffast-math -funroll-loops -Wall -pipe (Lame defaults)
real	1m29.168s	-march=native -O3 -ffast-math -funroll-loops -Wall -pipe
real	1m35.633s	-march=native -O3 -pipe -ffast-math
real	1m35.923s	-march=native -O3 -pipe -ftracer -ffast-math
real	1m36.346s	-march=native -O3 -pipe -ffast-math -falign-functions=64
real	1m36.768s	-march=native -O2 -pipe -ftracer -ffast-math
real	1m37.242s	-march=native -O3 -pipe -ftracer
real	1m38.127s	-march=native -O3 -pipe -fomit-frame-pointer
real	1m38.235s	-march=native -O3 -pipe -fvect-cost-model
real	1m38.243s	-march=native -O2 -pipe -mfpmath=sse,387
real	1m38.278s	-march=native -O2 -pipe
real	1m38.423s	-march=native -O2 -pipe -falign-functions=64
real	1m38.527s	-march=native -O2 -pipe -ffast-math
real	1m38.573s	-march=native -O2 -pipe -falign-functions=128
real	1m38.575s	-march=native -O2 -pipe -mfpmath=sse
real	1m39.241s	-march=native -O2 -pipe -ftracer
real	1m39.261s	-march=native -O2 -pipe -fomit-frame-pointer
real	1m40.946s	-march=native -Os -pipe -ffast-math
real	1m41.385s	-march=native -Os -pipe
real	1m41.513s	-march=native -Os -pipe -fomit-frame-pointer
real	1m41.602s	-march=native -Os -pipe -fomit-frame-pointer -mfpmath=sse,387
real	1m46.577s	-march=native -O2 -pipe -mfpmath=387

Slightly more influential there.
Ben H.



From robertshearman at gmail.com  Mon Jun 16 14:20:24 2008
From: robertshearman at gmail.com (Rob Shearman)
Date: Mon, 16 Jun 2008 20:20:24 +0100
Subject: rpcrt4/tests: Eliminate the test_simple_struct_marshal valgrind
	error.
In-Reply-To: <20080616182606.GA21444@linux.ucla.edu>
References: <20080616182606.GA21444@linux.ucla.edu>
Message-ID: <1096648c0806161220k66b054f4r60c20d677f338328@mail.gmail.com>

2008/6/16 Dan Hipschman <dsh at linux.ucla.edu>:
>
> Eliminates eight of these (and similar) from the ndr_marshall test:
>
>  Conditional jump or move depends on uninitialised value(s)
>    at 0x4AEF05E: test_simple_struct_marshal (ndr_marshall.c:668)
>    by 0x4AEFD91: test_simple_struct (ndr_marshall.c:889)
>    by 0x4AF6B9A: func_ndr_marshall (ndr_marshall.c:1829)
>    by 0x4B08FF2: run_test (test.h:449)
>    by 0x4B09332: __wine_spec_exe_entry (exe_entry.c:36)
>    by 0x7B870810: start_process (process.c:904)
>    by 0x47EE4B6: (within /usr/local/google/work/wine/libs/wine/libwine.so.1.0)
>
> The warning comes from memcmp-ing a struct with padding in it that is not
> initialized.

http://www.winehq.org/pipermail/wine-patches/2008-June/055831.html

-- 
Rob Shearman


From dsh at linux.ucla.edu  Mon Jun 16 14:47:48 2008
From: dsh at linux.ucla.edu (Dan Hipschman)
Date: Mon, 16 Jun 2008 12:47:48 -0700
Subject: rpcrt4/tests: Eliminate the test_simple_struct_marshal valgrind
	error.
In-Reply-To: <1096648c0806161220k66b054f4r60c20d677f338328@mail.gmail.com>
References: <20080616182606.GA21444@linux.ucla.edu>
	<1096648c0806161220k66b054f4r60c20d677f338328@mail.gmail.com>
Message-ID: <20080616194748.GB21444@linux.ucla.edu>

On Mon, Jun 16, 2008 at 08:20:24PM +0100, Rob Shearman wrote:
> http://www.winehq.org/pipermail/wine-patches/2008-June/055831.html

Ha, oops, sorry.


From edwin.smulders at gmail.com  Mon Jun 16 14:58:24 2008
From: edwin.smulders at gmail.com (Edwin Smulders)
Date: Mon, 16 Jun 2008 21:58:24 +0200
Subject: Wine compiler options benchmarks
In-Reply-To: <4856ACEA.9090007@atomnet.co.uk>
References: <4856ACEA.9090007@atomnet.co.uk>
Message-ID: <9a85a1550806161258j504dc527i810425a1a0448485@mail.gmail.com>

As you mentioned using oblivion, i suppose you want to try it with a
game? Trackmania Nations Forever is free and has a bench feature (all
it does is record average fps).

On Mon, Jun 16, 2008 at 8:11 PM, Ben Hodgetts (Enverex)
<ben at atomnet.co.uk> wrote:
> Just in-case anyone was ever curious about how well Wine performs with
> different C/XXFLAGs I did a test today with RC5 to see how much of a
> difference it makes with 3DMark 2001 SE, nothing major but if someone
> can think of a better benchmark to try, please let me know (I had hoped
> to try Oblivion or some such but it has no benchmark feature).
>
> Core2Quad Q9450 @ 3.4Ghz || 4GB PC8500 5-5-5-15 || GCC 4.3.1 || Linux 2.6.25
> 3DMark 2001 SE B300. Wine 1.0-rc5.
>
> 28576           -march=native -O3 -pipe -fomit-frame-pointer
> 28522           -march=native -O3 -pipe -fomit-frame-pointer -mfpmath=sse,387
> 28511           -march=native -O2 -pipe -fomit-frame-pointer
> 28427           -march=native -O3  -fomit-frame-pointer -ffast-math
> -funroll-loops -Wall -pipe
> 28426           -march=native -O2 -pipe -mfpmath=sse,387
> 28311           -march=native -O2 -pipe
> 28270           -march=native -Os -pipe -fomit-frame-pointer
> 28126           -O3 -pipe -fomit-frame-pointer
> 28072           Wine Default (-g -O2)
> 27984           -march=native -O3 -pipe
> 27646           -march=native -Os -pipe
>
>
> For reference I tried the same with Lame just to show how it would
> affect other programs:
>
> Core2Quad Q9450 @ 3.4Ghz || 4GB PC8500 5-5-5-15 || GCC 4.3.1 || Linux 2.6.25
> ~30 minute stereo wave file encoded in Lame Lame-3.97 64bit.
>
> real    1m28.739s       -O3 -ffast-math -funroll-loops -Wall -pipe (Lame defaults)
> real    1m29.168s       -march=native -O3 -ffast-math -funroll-loops -Wall -pipe
> real    1m35.633s       -march=native -O3 -pipe -ffast-math
> real    1m35.923s       -march=native -O3 -pipe -ftracer -ffast-math
> real    1m36.346s       -march=native -O3 -pipe -ffast-math -falign-functions=64
> real    1m36.768s       -march=native -O2 -pipe -ftracer -ffast-math
> real    1m37.242s       -march=native -O3 -pipe -ftracer
> real    1m38.127s       -march=native -O3 -pipe -fomit-frame-pointer
> real    1m38.235s       -march=native -O3 -pipe -fvect-cost-model
> real    1m38.243s       -march=native -O2 -pipe -mfpmath=sse,387
> real    1m38.278s       -march=native -O2 -pipe
> real    1m38.423s       -march=native -O2 -pipe -falign-functions=64
> real    1m38.527s       -march=native -O2 -pipe -ffast-math
> real    1m38.573s       -march=native -O2 -pipe -falign-functions=128
> real    1m38.575s       -march=native -O2 -pipe -mfpmath=sse
> real    1m39.241s       -march=native -O2 -pipe -ftracer
> real    1m39.261s       -march=native -O2 -pipe -fomit-frame-pointer
> real    1m40.946s       -march=native -Os -pipe -ffast-math
> real    1m41.385s       -march=native -Os -pipe
> real    1m41.513s       -march=native -Os -pipe -fomit-frame-pointer
> real    1m41.602s       -march=native -Os -pipe -fomit-frame-pointer -mfpmath=sse,387
> real    1m46.577s       -march=native -O2 -pipe -mfpmath=387
>
> Slightly more influential there.
> Ben H.
>
>
>
>


From ben at atomnet.co.uk  Mon Jun 16 12:59:22 2008
From: ben at atomnet.co.uk (Ben Hodgetts (Enverex))
Date: Mon, 16 Jun 2008 18:59:22 +0100
Subject: Wine compiler options benchmarks
Message-ID: <4856A9FA.7000305@atomnet.co.uk>

Just in-case anyone was ever curious about how well Wine performs with 
different C/XXFLAGs I did a test today with RC5 to see how much of a 
difference it makes with 3DMark 2001 SE, nothing major but if someone 
can think of a better benchmark to try, please let me know (I had hoped 
to try Oblivion or some such but it has no benchmark feature).

Core2Quad Q9450 @ 3.4Ghz || 4GB PC8500 5-5-5-15 || GCC 4.3.1 || Linux 2.6.25
3DMark 2001 SE B300. Wine 1.0-rc5.

28576		-march=native -O3 -pipe -fomit-frame-pointer
28522		-march=native -O3 -pipe -fomit-frame-pointer -mfpmath=sse,387
28511		-march=native -O2 -pipe -fomit-frame-pointer
28427		-march=native -O3  -fomit-frame-pointer -ffast-math 
-funroll-loops -Wall -pipe
28426		-march=native -O2 -pipe -mfpmath=sse,387
28311		-march=native -O2 -pipe
28270		-march=native -Os -pipe -fomit-frame-pointer
28126		-O3 -pipe -fomit-frame-pointer
28072		Wine Default (-g -O2)
27984		-march=native -O3 -pipe
27646		-march=native -Os -pipe


For reference I tried the same with Lame just to show how it would 
affect other programs:

Core2Quad Q9450 @ 3.4Ghz || 4GB PC8500 5-5-5-15 || GCC 4.3.1 || Linux 2.6.25
~30 minute stereo wave file encoded in Lame Lame-3.97 64bit.

real	1m28.739s	-O3 -ffast-math -funroll-loops -Wall -pipe (Lame defaults)
real	1m29.168s	-march=native -O3 -ffast-math -funroll-loops -Wall -pipe
real	1m35.633s	-march=native -O3 -pipe -ffast-math
real	1m35.923s	-march=native -O3 -pipe -ftracer -ffast-math
real	1m36.346s	-march=native -O3 -pipe -ffast-math -falign-functions=64
real	1m36.768s	-march=native -O2 -pipe -ftracer -ffast-math
real	1m37.242s	-march=native -O3 -pipe -ftracer
real	1m38.127s	-march=native -O3 -pipe -fomit-frame-pointer
real	1m38.235s	-march=native -O3 -pipe -fvect-cost-model
real	1m38.243s	-march=native -O2 -pipe -mfpmath=sse,387
real	1m38.278s	-march=native -O2 -pipe
real	1m38.423s	-march=native -O2 -pipe -falign-functions=64
real	1m38.527s	-march=native -O2 -pipe -ffast-math
real	1m38.573s	-march=native -O2 -pipe -falign-functions=128
real	1m38.575s	-march=native -O2 -pipe -mfpmath=sse
real	1m39.241s	-march=native -O2 -pipe -ftracer
real	1m39.261s	-march=native -O2 -pipe -fomit-frame-pointer
real	1m40.946s	-march=native -Os -pipe -ffast-math
real	1m41.385s	-march=native -Os -pipe
real	1m41.513s	-march=native -Os -pipe -fomit-frame-pointer
real	1m41.602s	-march=native -Os -pipe -fomit-frame-pointer -mfpmath=sse,387
real	1m46.577s	-march=native -O2 -pipe -mfpmath=387

Slightly more influential there.
Ben H.


From anssi.hannula at gmail.com  Mon Jun 16 17:11:05 2008
From: anssi.hannula at gmail.com (Anssi Hannula)
Date: Tue, 17 Jun 2008 01:11:05 +0300
Subject: Wine compiler options benchmarks
In-Reply-To: <4856ACEA.9090007@atomnet.co.uk>
References: <4856ACEA.9090007@atomnet.co.uk>
Message-ID: <4856E4F9.6070308@gmail.com>

Ben Hodgetts (Enverex) wrote:
> Just in-case anyone was ever curious about how well Wine performs with
> different C/XXFLAGs I did a test today with RC5 to see how much of a
> difference it makes with 3DMark 2001 SE, nothing major but if someone
> can think of a better benchmark to try, please let me know (I had hoped
> to try Oblivion or some such but it has no benchmark feature).
> 
> Core2Quad Q9450 @ 3.4Ghz || 4GB PC8500 5-5-5-15 || GCC 4.3.1 || Linux 2.6.25
> 3DMark 2001 SE B300. Wine 1.0-rc5.
> 
> 28576		-march=native -O3 -pipe -fomit-frame-pointer
> 28522		-march=native -O3 -pipe -fomit-frame-pointer -mfpmath=sse,387
> 28511		-march=native -O2 -pipe -fomit-frame-pointer
> 28427		-march=native -O3  -fomit-frame-pointer -ffast-math
> -funroll-loops -Wall -pipe
> 28426		-march=native -O2 -pipe -mfpmath=sse,387
> 28311		-march=native -O2 -pipe
> 28270		-march=native -Os -pipe -fomit-frame-pointer
> 28126		-O3 -pipe -fomit-frame-pointer
> 28072		Wine Default (-g -O2)
> 27984		-march=native -O3 -pipe
> 27646		-march=native -Os -pipe

Just for the record, at least on Mandriva we had to disable the use of
-fomit-frame-pointer as it caused problems with some protection systems
("debugger detected" pop-up error).

https://qa.mandriva.com/show_bug.cgi?id=40034

-- 
Anssi Hannula


From ben at atomnet.co.uk  Mon Jun 16 17:38:48 2008
From: ben at atomnet.co.uk (Ben Hodgetts)
Date: Mon, 16 Jun 2008 22:38:48 +0000 (UTC)
Subject: How long does it take you to compile wine?
References: <a71bd89a0806010044i51abf0a1h4a64acf750691b96@mail.gmail.com>
Message-ID: <loom.20080616T223643-541@post.gmane.org>

Dan Kegel <dank <at> kegel.com> writes:

> 
> Way back five years ago, we all compared notes on how
> long it took to build Wine on our systems.
> http://www.winehq.org/site/?issue=149#Compile%20Time%20Comparisons%20/%20Tips
> 
> Today I measured it on a new computer (with a spiffy
> new Intel dual core e7200 processor with 2GB of RAM,
> http://kegel.com/new-computer-2008.html ).
> 
> Result: ... it takes me a bit longer today on this machine (11 minutes)
> to build as it did then on a dual cpu hot rod (8 minutes).
> I guess Moore's Law isn't quite keeping up with Wine's code growth 
> 
> 


Depends on the machines, on my new PC I just built it is... rather fast and 
very useful for regression testing. Doing a configure, build and install
from a completely clean setup, without ccache on my machine takes
3 minutes :) Quite nice.

Ben H



From tom at dbservice.com  Mon Jun 16 17:58:20 2008
From: tom at dbservice.com (Tomas Carnecky)
Date: Tue, 17 Jun 2008 00:58:20 +0200
Subject: Wine compiler options benchmarks
In-Reply-To: <4856A9FA.7000305@atomnet.co.uk>
References: <4856A9FA.7000305@atomnet.co.uk>
Message-ID: <4856F00C.3010200@dbservice.com>

Ben Hodgetts (Enverex) wrote:
> Just in-case anyone was ever curious about how well Wine performs with 
> different C/XXFLAGs I did a test today with RC5 to see how much of a 
> difference it makes with 3DMark 2001 SE, nothing major but if someone 
> can think of a better benchmark to try, please let me know (I had hoped 
> to try Oblivion or some such but it has no benchmark feature).
> 
> Core2Quad Q9450 @ 3.4Ghz || 4GB PC8500 5-5-5-15 || GCC 4.3.1 || Linux 2.6.25
> 3DMark 2001 SE B300. Wine 1.0-rc5.
> 
> 28576		-march=native -O3 -pipe -fomit-frame-pointer
> 28522		-march=native -O3 -pipe -fomit-frame-pointer -mfpmath=sse,387
> 28511		-march=native -O2 -pipe -fomit-frame-pointer
> 28427		-march=native -O3  -fomit-frame-pointer -ffast-math 
> -funroll-loops -Wall -pipe
> 28426		-march=native -O2 -pipe -mfpmath=sse,387
> 28311		-march=native -O2 -pipe
> 28270		-march=native -Os -pipe -fomit-frame-pointer
> 28126		-O3 -pipe -fomit-frame-pointer
> 28072		Wine Default (-g -O2)
> 27984		-march=native -O3 -pipe
> 27646		-march=native -Os -pipe


-pipe only speeds up compilation, not the resulting machine code.
-Wall makes gcc show more warnings about the code and again, it does not 
speed up the code.

tom


From ben at atomnet.co.uk  Mon Jun 16 18:01:50 2008
From: ben at atomnet.co.uk (Ben Hodgetts)
Date: Tue, 17 Jun 2008 00:01:50 +0100
Subject: Wine compiler options benchmarks
In-Reply-To: <4856F00C.3010200@dbservice.com>
References: <4856A9FA.7000305@atomnet.co.uk> <4856F00C.3010200@dbservice.com>
Message-ID: <4856F0DE.1010806@atomnet.co.uk>

Tomas Carnecky wrote:
> Ben Hodgetts (Enverex) wrote:
>> Just in-case anyone was ever curious about how well Wine performs 
>> with different C/XXFLAGs I did a test today with RC5 to see how much 
>> of a difference it makes with 3DMark 2001 SE, nothing major but if 
>> someone can think of a better benchmark to try, please let me know (I 
>> had hoped to try Oblivion or some such but it has no benchmark feature).
>>
>> Core2Quad Q9450 @ 3.4Ghz || 4GB PC8500 5-5-5-15 || GCC 4.3.1 || Linux 
>> 2.6.25
>> 3DMark 2001 SE B300. Wine 1.0-rc5.
>>
>> 28576        -march=native -O3 -pipe -fomit-frame-pointer
>> 28522        -march=native -O3 -pipe -fomit-frame-pointer 
>> -mfpmath=sse,387
>> 28511        -march=native -O2 -pipe -fomit-frame-pointer
>> 28427        -march=native -O3  -fomit-frame-pointer -ffast-math 
>> -funroll-loops -Wall -pipe
>> 28426        -march=native -O2 -pipe -mfpmath=sse,387
>> 28311        -march=native -O2 -pipe
>> 28270        -march=native -Os -pipe -fomit-frame-pointer
>> 28126        -O3 -pipe -fomit-frame-pointer
>> 28072        Wine Default (-g -O2)
>> 27984        -march=native -O3 -pipe
>> 27646        -march=native -Os -pipe
>
>
> -pipe only speeds up compilation, not the resulting machine code.
> -Wall makes gcc show more warnings about the code and again, it does 
> not speed up the code.
>
> tom

I know, I was just listing "all" the flags I was using. Wall was only in 
there because I copied the CFLAGs from Lame which got a massive boost 
using a certain set which I copied over entirely.

Ben H.


From dank at kegel.com  Mon Jun 16 21:40:09 2008
From: dank at kegel.com (Dan Kegel)
Date: Mon, 16 Jun 2008 19:40:09 -0700
Subject: When submitting valgrind patches...
Message-ID: <a71bd89a0806161940n72774719l4a59b2447dd1e7fd@mail.gmail.com>

... please include the magic phrase

Fixes valgrind warnings like:

in the body, followed by an example of the valgrind warnings
in question, with addresses and boring parts removed.
For example, see

http://www.winehq.org/pipermail/wine-patches/2008-June/055658.html

That will make it a lot easier to search for the patches.

Thanks!


From paul.vriens.wine at gmail.com  Tue Jun 17 00:55:30 2008
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 17 Jun 2008 07:55:30 +0200
Subject: Update generated packing tests using current headers.
In-Reply-To: <1096648c0806161522v5290ca19v69ba9fed93b9ecf9@mail.gmail.com>
References: <1096648c0806161522v5290ca19v69ba9fed93b9ecf9@mail.gmail.com>
Message-ID: <485751D2.1010804@gmail.com>

Rob Shearman wrote:
> ---
>  dlls/rpcrt4/tests/generated.c  |   47 ++++++++++++++++++++++++++-------------
>  dlls/wininet/tests/generated.c |    4 +-
>  2 files changed, 33 insertions(+), 18 deletions(-)
> 
> 
> ------------------------------------------------------------------------
> 
> 
Aren't these files generated (as apart from the name, the first line in those 
files tells us)?

So does this patch miss the tools/winapi/tests.dat part?
-- 
Cheers,

Paul.


From robertshearman at gmail.com  Tue Jun 17 01:30:44 2008
From: robertshearman at gmail.com (Rob Shearman)
Date: Tue, 17 Jun 2008 07:30:44 +0100
Subject: Update generated packing tests using current headers.
In-Reply-To: <485751D2.1010804@gmail.com>
References: <1096648c0806161522v5290ca19v69ba9fed93b9ecf9@mail.gmail.com>
	<485751D2.1010804@gmail.com>
Message-ID: <1096648c0806162330r6736ad45v520ce86305b3541c@mail.gmail.com>

2008/6/17 Paul Vriens <paul.vriens.wine at gmail.com>:
> Rob Shearman wrote:
>>
>> ---
>>  dlls/rpcrt4/tests/generated.c  |   47
>> ++++++++++++++++++++++++++-------------
>>  dlls/wininet/tests/generated.c |    4 +-
>>  2 files changed, 33 insertions(+), 18 deletions(-)
>>
> Aren't these files generated (as apart from the name, the first line in
> those files tells us)?

Yes.

> So does this patch miss the tools/winapi/tests.dat part?

No, the changes are due to past changes in header files.

-- 
Rob Shearman


From dank at kegel.com  Tue Jun 17 08:12:14 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 17 Jun 2008 06:12:14 -0700
Subject: Only 205 nonleak valgrind errors left!
Message-ID: <a71bd89a0806170612q7eee1758w5c5f7aaa0701565a@mail.gmail.com>

Changes since yesterday:
- added suppression for glibc bug in if_nameindex
- added two patches by Huw, one by Rob, one by Jon, one by Roy
- fixed split script; broken out error files now more complete

This gets us down from 218 to 205 or so.

(Please join the party!  We can use all the help we can get
getting rid of these bugs; though many are innocuous to users,
a few aren't, and they're all annoying to anyone using valgrind.
It remains to be seen how many of these patches Alexandre will
accept after 1.0 is out, but I'm hopeful we can get most of them
up to his standards.)

Report showing unique nonleak errors:
http://kegel.com/wine/valgrind/logs-2008-06-16.counts.txt

Logs:
http://kegel.com/wine/valgrind/logs-2008-06-16.log.gz
http://kegel.com/wine/valgrind/logs-2008-06-16/

Pending wine patches:
http://kegel.com/wine/valgrind/logs-2008-06-16-patches/
http://kegel.com/wine/valgrind/logs-2008-06-16-patches.tgz
http://kegel.com/wine/valgrind/logs-2008-06-16-patch.txt

Suppression file:
http://kegel.com/wine/valgrind/valgrind-suppressions


From hzhrong at gmail.com  Tue Jun 17 09:53:59 2008
From: hzhrong at gmail.com (Huang, Zhangrong)
Date: Tue, 17 Jun 2008 22:53:59 +0800
Subject: ole32: Fix a failed call to DllGetClassObject while retrieving
	class object interface pointer.
In-Reply-To: <47810025.3030209@codeweavers.com>
References: <b4cc5a3d0712200653t738a43c4rcbd00ff8e779e128@mail.gmail.com>
	<476ABF8B.1080509@codeweavers.com>
	<b4cc5a3d0712220746y4a883afau649a5f22aec8a59@mail.gmail.com>
	<47810025.3030209@codeweavers.com>
Message-ID: <b4cc5a3d0806170753h300f3f28p83349e7091efb460@mail.gmail.com>

Hi,

> ole32: get_moniker_for_progid_display_name should fallback to using IClassFactory to get IParseDisplayName if getting it directly fails.

This fix looks OK, but still gets lots of error messages:

err:ole:apartment_getclassobject DllGetClassObject returned error 0x80004002
err:ole:create_server class {228d9a81-c302-11cf-9aa4-00aa004a5691} not
registered
fixme:ole:CoGetClassObject CLSCTX_REMOTE_SERVER not supported
err:ole:CoGetClassObject no class object
{228d9a81-c302-11cf-9aa4-00aa004a5691} could be created for context
0x15


2008/1/7 Robert Shearman <rob at codeweavers.com>:
>> Then run the test:
>> $ ../../../wine ole32_test.exe.so moniker
>> err:ole:apartment_getclassobject DllGetClassObject returned error
>> 0x80004002
>> err:ole:create_server class {228d9a81-c302-11cf-9aa4-00aa004a5691} not
>> registered
>> fixme:ole:CoGetClassObject CLSCTX_REMOTE_SERVER not supported
>> err:ole:CoGetClassObject no class object
>> {228d9a81-c302-11cf-9aa4-00aa004a5691} could be created for context
>> 0x15
>> moniker.c:783: Test failed: ****************LDAP**************
>> moniker: 2 tests executed (0 marked as todo, 1 failure), 0 skipped.
>>
>> after my patch:
>> $ ../../../wine ole32_test.exe.so moniker
>> moniker.c:783: Test failed: ****************LDAP**************
>> moniker: 2 tests executed (0 marked as todo, 1 failure), 0 skipped.
>>
>> Although the test failed, but loading class
>> {228d9a81-c302-11cf-9aa4-00aa004a5691} success.
>>
>
> I've just sent a patch for this. Thanks for reporting it and going to the
> trouble of describing how to reproduce it and proposing a patch.
>
> --
> Rob Shearman
>
>



-- 
$ apt-get moo
 (__)
 (oo)
 /------\/
 / | ||
 * /\---/\
 ~~ ~~
...."Have you mooed today?"...


From jwhite at codeweavers.com  Tue Jun 17 09:55:39 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Tue, 17 Jun 2008 09:55:39 -0500
Subject: Celebrating Wine 1.0
Message-ID: <4857D06B.2000608@codeweavers.com>

Woohoo!!!!

Alexandre just posted the Wine 1.0 commit!  I eagerly did my git
update and enjoyed running 'wine --version'.  Ooo.  I'm going to do it again...

Let us all have a moment of silence to mourn the passing of
the Wine 1.0 jokes <grin>.

Seriously, this is a major milestone for the Wine project.
It is no small undertaking to create a complex Free Software
project, and to bring it to a state of general usefulness.
There are literally millions - if not more - people using
this software we have built.  This is a great accomplishment,
and we all should be deeply proud of what we've accomplished.

I think it's particularly important to thank each and
every one of the 1076 AUTHORS and to recognize the support
and work of the many people that have contributed to Wine
without having their name in that file.

I also think we should particularly take a moment to recognize
the incredible work of our fearless leader - Alexandre Julliard -
without whom none of this would have been possible.

And then we should celebrate!

I realize that any real large communal celebration will have
to wait until we can gather for Wineconf.  But I intend to
gather up a gang of folks and go out for a meal to celebrate.
I will lift a glass of Wine in toast to Alexandre and the
many people that have worked on Wine, and I encourage everyone
else to do the same.

Ideally, people will become sufficiently happy to wax maudlin
and we can capture all kinds of embarrassing stories on #winehackers
<grin>.

Cheers,

Jeremy


From dimi at lattica.com  Tue Jun 17 11:26:19 2008
From: dimi at lattica.com (Dimi Paun)
Date: Tue, 17 Jun 2008 12:26:19 -0400
Subject: Celebrating Wine 1.0
In-Reply-To: <4857D06B.2000608@codeweavers.com>
References: <4857D06B.2000608@codeweavers.com>
Message-ID: <1213719979.20650.6.camel@dimi.lattica.com>


On Tue, 2008-06-17 at 09:55 -0500, Jeremy White wrote:
> Woohoo!!!!
> 
> Alexandre just posted the Wine 1.0 commit!  I eagerly did my git
> update and enjoyed running 'wine --version'.  Ooo.  I'm going to do it
> again...

Wow, this is the moment we've all been waiting for!

Congratulations everybody, this is way cool indeed.

And I must say, this would not have been possible
without Alexandre's amazing contribution. Kudos!

-- 
Dimi Paun <dimi at lattica.com>
Lattica, Inc.



From a_villacis at palosanto.com  Tue Jun 17 10:30:12 2008
From: a_villacis at palosanto.com (=?ISO-8859-1?Q?Alex_Villac=ED=ADs_Lasso?=)
Date: Tue, 17 Jun 2008 10:30:12 -0500
Subject: About code freeze...
Message-ID: <4857D884.3090109@palosanto.com>

Wine 1.0 is out! Great!

Does this mean we are now out of code freeze? I have a bunch of richedit 
patches I submitted previously but were held up because of the code 
freeze. Is it time to submit them again?

-- 
perl -e '$x=2.4;print sprintf("%.0f + %.0f = %.0f\n",$x,$x,$x+$x);'



From winehacker at gmail.com  Tue Jun 17 12:46:26 2008
From: winehacker at gmail.com (Steven Edwards)
Date: Tue, 17 Jun 2008 13:46:26 -0400
Subject: ole32: Fix a failed call to DllGetClassObject while retrieving
	class object interface pointer.
In-Reply-To: <22821af30712221912y3643fc30y607ae67de6cb0f68@mail.gmail.com>
References: <b4cc5a3d0712200653t738a43c4rcbd00ff8e779e128@mail.gmail.com>
	<476ABF8B.1080509@codeweavers.com>
	<b4cc5a3d0712220746y4a883afau649a5f22aec8a59@mail.gmail.com>
	<22821af30712220906o2b313fe6oc1fbea0657f92f58@mail.gmail.com>
	<b4cc5a3d0712221025g3ba44bcay14f02396813c62a1@mail.gmail.com>
	<22821af30712221255h4778df15v9d714eae492d8ef5@mail.gmail.com>
	<476DB25C.8080200@codeweavers.com>
	<22821af30712221912y3643fc30y607ae67de6cb0f68@mail.gmail.com>
Message-ID: <19e31a080806171046w1a5cf4cbt3cfc6ea2afc7499e@mail.gmail.com>

On Sat, Dec 22, 2007 at 11:12 PM, James Hawkins <truiken at gmail.com> wrote:
> You could paste it all over winehq.org and the docs and it'll still happen.

I think this argument is totally bogus. Whats viewed as illegal
reverse engineering in Canada is not the same as in the United States.
Having this unwritten standard just means people end up wasting more
time. Lets just codify the standard practices and be done with it,
then when someone violates it, send them the URL so we don't have to
keep having this discussion every three months.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From remco47 at gmail.com  Tue Jun 17 12:23:13 2008
From: remco47 at gmail.com (Remco)
Date: Tue, 17 Jun 2008 19:23:13 +0200
Subject: Celebrating Wine 1.0
In-Reply-To: <1213719979.20650.6.camel@dimi.lattica.com>
References: <4857D06B.2000608@codeweavers.com>
	<1213719979.20650.6.camel@dimi.lattica.com>
Message-ID: <36a11a3a0806171023i55f623acmd9385f6ebaa6ca09@mail.gmail.com>

And it's DOWN! The web server couldn't handle the excitement I guess.

As a user, I want to thank all the developers for all their hard work
in the past 15 years. I was 5 years old when you guys started, and
because of you I could switch to Linux, about 10 years later. I like
to play a video game now and then, and Wine makes it possible. I just
take a look at the AppDB before I decide to buy a game, and usually I
can. Thanks again!

Remco

On Tue, Jun 17, 2008 at 6:26 PM, Dimi Paun <dimi at lattica.com> wrote:
>
> On Tue, 2008-06-17 at 09:55 -0500, Jeremy White wrote:
>> Woohoo!!!!
>>
>> Alexandre just posted the Wine 1.0 commit!  I eagerly did my git
>> update and enjoyed running 'wine --version'.  Ooo.  I'm going to do it
>> again...
>
> Wow, this is the moment we've all been waiting for!
>
> Congratulations everybody, this is way cool indeed.
>
> And I must say, this would not have been possible
> without Alexandre's amazing contribution. Kudos!
>
> --
> Dimi Paun <dimi at lattica.com>
> Lattica, Inc.
>
>
>
>


From austinenglish at gmail.com  Tue Jun 17 13:46:19 2008
From: austinenglish at gmail.com (Austin English)
Date: Tue, 17 Jun 2008 13:46:19 -0500
Subject: Website down
Message-ID: <b6bb06270806171146v48832c63od842add4ac39e9ca@mail.gmail.com>

Did we get slashdotted/dugg to death?

-Austin


From jwhite at codeweavers.com  Tue Jun 17 14:29:22 2008
From: jwhite at codeweavers.com (Jeremy White)
Date: Tue, 17 Jun 2008 14:29:22 -0500
Subject: Website down
In-Reply-To: <b6bb06270806171146v48832c63od842add4ac39e9ca@mail.gmail.com>
References: <b6bb06270806171146v48832c63od842add4ac39e9ca@mail.gmail.com>
Message-ID: <48581092.2@codeweavers.com>

Austin English wrote:
> Did we get slashdotted/dugg to death?

Not quite death, but it's pretty tough sailing right now.

I think we could have handled one or the other, but both
together are apparently more than our current systems can handle.

We've stopped mysqld for the moment to try to ride through this;
still trying to figure out if there is a simple way to get it through
this hump.  (Both Digg and /. have really short curves; the demand will
be down within hours, and we can go back to business as usual).

Cheers,

Jeremy


From dank at kegel.com  Tue Jun 17 16:21:35 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 17 Jun 2008 14:21:35 -0700
Subject: Fix DirectSound's primary buffer Volume and Pan handling
Message-ID: <a71bd89a0806171421h6651c8e7qb9574fb19a7b01fa@mail.gmail.com>

On Jul 23, 2004, Francois Gouget wrote:
> The patch removes the primary buffer's 'volpan' variable and instead
> uses waveOutGetVolume() on dsound->hwo to get the current volume.

This seems to be failing for me here on three different machines
during the primary part of test_secondary() in dsound/tests/ds3d.c.

You can see evidence of this in valgrind logs, e.g.
http://kegel.com/wine/valgrind/logs-2007-12-06/vg-dsound_ds3d.txt
or
http://kegel.com/wine/valgrind/logs-2008-06-16/vg-dsound_ds3d.txt
you can see valgrind getting annoyed that waveOutGetVolume
didn't actually retrieve anything:
 Conditional jump or move depends on uninitialised value(s)
    at  DSOUND_AmpFactorToVolPan (mixer.c:66)
    by  PrimaryBufferImpl_GetVolume (primary.c:646)
    by  test_secondary (ds3d.c:864)
    by  dsenum_callback (ds3d.c:1303)
    by  DirectSoundEnumerateA (dsound_main.c:315)
    by  ds3d_tests (ds3d.c:1324)
    by  func_ds3d (ds3d.c:1344)
    by  run_test (test.h:449)
    by  main (test.h:498)
  Uninitialised value was created by a stack allocation
    at  PrimaryBufferImpl_GetVolume (primary.c:627)

The test nevertheless happens to succeed on some machines,
but not others.  One machine it fails on (even without valgrind) says
ds3d.c:896: Test failed: The primary pan changed from 673 to 656
because, I think, it's calculating the pan based on random
values on the stack.

A +dsound,+alsa,+wave log (and a few extra trace statements) shows

trace:dsound:PrimaryBufferImpl_GetPan (0x132258,0x32fa48)
trace:wave:ALSA_wodMessage (0, WODM_GETVOLUME, 00000000, 0032F8E4, 00000000);
trace:wave:wodGetVolume (0, 0x32f8e4);
trace:wave:wodGetVolume wDevId 0, hctl (nil)
trace:alsa:ALSA_CheckSetVolume line 470; hctl (nil)
trace:wave:wodGetVolume CheckSetVolume failed; rc 8
trace:dsound:DSOUND_AmpFactorToVolPan (0x32f8c8)
trace:dsound:DSOUND_AmpFactorToVolPan left=3b34, right=7e59
trace:dsound:DSOUND_AmpFactorToVolPan Vol=-611 Pan=656
ds3d.c:896: Test failed: The primary pan changed from 673 to 656

ALSA_CheckSetVolume returns right early because hctl is NULL.

I threw together a small test illustrating the problem;
see the attached patch and log from problem machine.
(Note that sound works on this machine, and running the main
ds3d tests with WINETEST_INTERACTIVE=1 yields many tones
in the headphones.)
Could somebody who knows this code have a look?  Thanks!
- Dan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: volumetest.patch
Type: text/x-patch
Size: 4888 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080617/45dfa7a7/attachment-0002.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: volumetest.log
Type: text/x-log
Size: 14318 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080617/45dfa7a7/attachment-0003.bin 

From ben at atomnet.co.uk  Tue Jun 17 15:11:37 2008
From: ben at atomnet.co.uk (Ben Hodgetts (Enverex))
Date: Tue, 17 Jun 2008 21:11:37 +0100
Subject: About code freeze...
In-Reply-To: <4857D884.3090109@palosanto.com>
References: <4857D884.3090109@palosanto.com>
Message-ID: <48581A79.6030103@atomnet.co.uk>

Alex Villac??s Lasso wrote:
> Wine 1.0 is out! Great!
> 
> Does this mean we are now out of code freeze? I have a bunch of richedit 
> patches I submitted previously but were held up because of the code 
> freeze. Is it time to submit them again?
> 

AJ said earlier in IRC that the Code Freeze is now over so I would 
assume everyone is ok to continue sending as usual.

Ben H.


From dank at kegel.com  Tue Jun 17 16:21:35 2008
From: dank at kegel.com (Dan Kegel)
Date: Tue, 17 Jun 2008 14:21:35 -0700
Subject: Fix DirectSound's primary buffer Volume and Pan handling
Message-ID: <a71bd89a0806171421h6651c8e7qb9574fb19a7b01fa@mail.gmail.com>

On Jul 23, 2004, Francois Gouget wrote:
> The patch removes the primary buffer's 'volpan' variable and instead
> uses waveOutGetVolume() on dsound->hwo to get the current volume.

This seems to be failing for me here on three different machines
during the primary part of test_secondary() in dsound/tests/ds3d.c.

You can see evidence of this in valgrind logs, e.g.
http://kegel.com/wine/valgrind/logs-2007-12-06/vg-dsound_ds3d.txt
or
http://kegel.com/wine/valgrind/logs-2008-06-16/vg-dsound_ds3d.txt
you can see valgrind getting annoyed that waveOutGetVolume
didn't actually retrieve anything:
 Conditional jump or move depends on uninitialised value(s)
    at  DSOUND_AmpFactorToVolPan (mixer.c:66)
    by  PrimaryBufferImpl_GetVolume (primary.c:646)
    by  test_secondary (ds3d.c:864)
    by  dsenum_callback (ds3d.c:1303)
    by  DirectSoundEnumerateA (dsound_main.c:315)
    by  ds3d_tests (ds3d.c:1324)
    by  func_ds3d (ds3d.c:1344)
    by  run_test (test.h:449)
    by  main (test.h:498)
  Uninitialised value was created by a stack allocation
    at  PrimaryBufferImpl_GetVolume (primary.c:627)

The test nevertheless happens to succeed on some machines,
but not others.  One machine it fails on (even without valgrind) says
ds3d.c:896: Test failed: The primary pan changed from 673 to 656
because, I think, it's calculating the pan based on random
values on the stack.

A +dsound,+alsa,+wave log (and a few extra trace statements) shows

trace:dsound:PrimaryBufferImpl_GetPan (0x132258,0x32fa48)
trace:wave:ALSA_wodMessage (0, WODM_GETVOLUME, 00000000, 0032F8E4, 00000000);
trace:wave:wodGetVolume (0, 0x32f8e4);
trace:wave:wodGetVolume wDevId 0, hctl (nil)
trace:alsa:ALSA_CheckSetVolume line 470; hctl (nil)
trace:wave:wodGetVolume CheckSetVolume failed; rc 8
trace:dsound:DSOUND_AmpFactorToVolPan (0x32f8c8)
trace:dsound:DSOUND_AmpFactorToVolPan left=3b34, right=7e59
trace:dsound:DSOUND_AmpFactorToVolPan Vol=-611 Pan=656
ds3d.c:896: Test failed: The primary pan changed from 673 to 656

ALSA_CheckSetVolume returns right early because hctl is NULL.

I threw together a small test illustrating the problem;
see the attached patch and log from problem machine.
(Note that sound works on this machine, and running the main
ds3d tests with WINETEST_INTERACTIVE=1 yields many tones
in the headphones.)
Could somebody who knows this code have a look?  Thanks!
- Dan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: volumetest.patch
Type: text/x-patch
Size: 4888 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080617/45dfa7a7/attachment-0006.bin 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: volumetest.log
Type: text/x-log
Size: 14318 bytes
Desc: not available
Url : http://www.winehq.org/pipermail/wine-devel/attachments/20080617/45dfa7a7/attachment-0007.bin 

From remco47 at gmail.com  Tue Jun 17 16:57:56 2008
From: remco47 at gmail.com (Remco)
Date: Tue, 17 Jun 2008 23:57:56 +0200
Subject: Celebrating Wine 1.0
In-Reply-To: <36a11a3a0806171023i55f623acmd9385f6ebaa6ca09@mail.gmail.com>
References: <4857D06B.2000608@codeweavers.com>
	<1213719979.20650.6.camel@dimi.lattica.com>
	<36a11a3a0806171023i55f623acmd9385f6ebaa6ca09@mail.gmail.com>
Message-ID: <36a11a3a0806171457w66b3e035s44ee9cfff80f0341@mail.gmail.com>

The site was slashdotted a few hours ago, but it seems to be stable
now. /dev/null took my words of praise in the WineHQ outage though:

On Tue, Jun 17, 2008 at 7:23 PM, Remco <remco47 at gmail.com> wrote:
> And it's DOWN! The web server couldn't handle the excitement I guess.
>
> As a user, I want to thank all the developers for all their hard work
> in the past 15 years. I was 5 years old when you guys started, and
> because of you I could switch to Linux, about 10 years later. I like
> to play a video game now and then, and Wine makes it possible. I just
> take a look at the AppDB before I decide to buy a game, and usually I
> can. Thanks again!
>
> Remco
>
> On Tue, Jun 17, 2008 at 6:26 PM, Dimi Paun <dimi at lattica.com> wrote:
>>
>> On Tue, 2008-06-17 at 09:55 -0500, Jeremy White wrote:
>>> Woohoo!!!!
>>>
>>> Alexandre just posted the Wine 1.0 commit!  I eagerly did my git
>>> update and enjoyed running 'wine --version'.  Ooo.  I'm going to do it
>>> again...
>>
>> Wow, this is the moment we've all been waiting for!
>>
>> Congratulations everybody, this is way cool indeed.
>>
>> And I must say, this would not have been possible
>> without Alexandre's amazing contribution. Kudos!
>>
>> --
>> Dimi Paun <dimi at lattica.com>
>> Lattica, Inc.
>>
>>
>>
>>
>


From jnewman at codeweavers.com  Tue Jun 17 16:48:30 2008
From: jnewman at codeweavers.com (Jeremy Newman)
Date: Tue, 17 Jun 2008 16:48:30 -0500
Subject: Website down
In-Reply-To: <b6bb06270806171146v48832c63od842add4ac39e9ca@mail.gmail.com>
References: <b6bb06270806171146v48832c63od842add4ac39e9ca@mail.gmail.com>
Message-ID: <4858312E.9090801@codeweavers.com>

Yep, front page of Digg can be a website killer. We seem to be coming 
out of it now.

At least the server didn't completely melt. *knock on wood*

-Newan

Austin English wrote:
> Did we get slashdotted/dugg to death?
> 
> -Austin
> 
> 


From okg at johnfreed.com  Tue Jun 17 17:37:58 2008
From: okg at johnfreed.com (John Freed)
Date: Wed, 18 Jun 2008 00:37:58 +0200
Subject: Wine release 1.0
In-Reply-To: <20080617142007.2E1631E715A@wine.dyndns.org>
References: <20080617142007.2E1631E715A@wine.dyndns.org>
Message-ID: <de644be70806171537n7b426631m30d5f1a0a0a541e9@mail.gmail.com>

Congratulations!!!!!!!!!


On Tue, Jun 17, 2008 at 4:20 PM, Alexandre Julliard <julliard at winehq.org>
wrote:

> The Wine team is proud to announce that Wine 1.0 is now available.
> This is the first stable release of Wine after 15 years of development
> and beta testing. Many thanks to everybody who helped us along that
> long road!
>
> While compatibility is not perfect yet, thousands of applications have
> been reported to work very well. Check http://appdb.winehq.org to see
> the details for your favorite applications.
>
> The source is available from the following locations:
>
>  http://ibiblio.org/pub/linux/system/emulators/wine/wine-1.0.tar.bz2
>  http://prdownloads.sourceforge.net/wine/wine-1.0.tar.bz2
>
> Binary packages for various distributions will be available from:
>
>  http://www.winehq.org/site/download
>
> You will find documentation on http://www.winehq.org/site/documentation
>
> You can also get the current source directly from the git
> repository. Check http://www.winehq.org/site/git for details.
>
> Wine is available thanks to the work of many people. See the file
> AUTHORS in the distribution for the complete list.
>
> ----------------------------------------------------------------
>
> Bugs fixed in 1.0:
>
>   3838  The Punisher demo crashes after the introduction movies
>   3898  Counter-Strike 1.6 performance issue
>   4755  X Error of failed request:  BadDrawable (X_PolyFillRectangle) when
> switching to Virtual Desktop
>   6315  Starlancer draws ships as white when direct3d is enabled
>   7268  Oni not opening after install
>   8185  can't login in Skype 3.1 on wine/kubuntu 7
>   8634  antialiasing disabled in gtasa menu
>   9555  Wine crash when I click help in Stata 10
>   9589  Static / Scratchy Sound with OSS in Call of Duty
>   9903  WinRAR with NXServer  - black icons
>  10009  QIP: window z-order is still wrong
>  10268  Robot Wars: Arena of Destruction crashes while quitting (causing
> resolution to stay 640 x 480)
>  10322  Eve-online (video memory misaddressed?)
>  10700  Dragon Naturally Speaking 9 needs gdiplus.GdipDrawArcI,
> gdiplus.GdipCreatePen2, ...
>  11011  Call of Duty 1.0 doesn't run after install.
>  11104  Dance Praise 2: Does not respond to input
>  12415  Can not leave fullscreen Warcraft 3x (Regression)
>  12963  Moto Racer 2 works with wine 0.9.60 and crashes with wine 0.9.61
>  13271  The demo of the punisher fails to install
>  13740  winebrowser gets wrong URL, problem with unicode
>
> ----------------------------------------------------------------
>
> Changes since 1.0-rc5:
>
> Alexandre Julliard (1):
>      Updated the authors list.
>
> Francois Gouget (3):
>      Remove spaces before '...' in the Danish resources.
>      regedit: Remove spaces before '...'.
>      winecfg: Remove spaces before '...'.
>
> Jaime Rave (1):
>      wineconsole: Update Spanish translation.
>
> Matthias Kupfer (1):
>      wordpad: Small typo fix for German translation.
>
> --
> Alexandre Julliard
> julliard at winehq.org
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.winehq.org/pipermail/wine-devel/attachments/20080618/3c4b8705/attachment.htm 

From htl10 at users.sourceforge.net  Tue Jun 17 20:30:19 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 18 Jun 2008 01:30:19 +0000 (GMT)
Subject: winetrick, dotnet2 and vc80
In-Reply-To: <a71bd89a0806171421h6651c8e7qb9574fb19a7b01fa@mail.gmail.com>
Message-ID: <10001.58142.qm@web23104.mail.ird.yahoo.com>

I just had the misfortune of needing a new wineprefix to try out something 
- and found that dotnet20 (through winetrick at least) doesn't check for vc80
runtime, but once it gets into wineprefix, things go rather bad with any 
wine commands - including winetricks itself - which makes it painful to install vc80 runtime afterwards. 

Please make some vc80 check in winetrick, or make vc80 a dependency
automatic install if dotnet20 is asked for?

BTW, well done everybody for wine 1.0 - still on rc5 but upgrading in the next hour or two!

Cheers...
Hin-Tak


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html


From truiken at gmail.com  Tue Jun 17 20:20:14 2008
From: truiken at gmail.com (James Hawkins)
Date: Tue, 17 Jun 2008 20:20:14 -0500
Subject: [PATCH] shell32: SHFileOperation can move several files into one
	directory
In-Reply-To: <200806172225.31269.vitperov@etersoft.ru>
References: <200806172225.31269.vitperov@etersoft.ru>
Message-ID: <22821af30806171820g710ed39dhb8c81c445ff95295@mail.gmail.com>

2008/6/17 Vitaly Perov <vitperov at etersoft.ru>:
> The test was sent 2 hours ago
> If FOF_MULTIDESTFILES flag is set it's not olny mean that pTo contains
> multiple destination files, it also can contain one folder.
>
> Changelog:
> - shell32: SHFileOperation can move several files into one directory
>

--- a/dlls/shell32/shlfileop.c
+++ b/dlls/shell32/shlfileop.c
@@ -1426,7 +1426,8 @@ static HRESULT move_files(LPSHFILEOPSTRUCTW
lpFileOp, const FILE_LIST *flFrom, c
         return ERROR_CANCELLED;

     if ((lpFileOp->fFlags & FOF_MULTIDESTFILES) &&
-        flFrom->dwNumFiles != flTo->dwNumFiles)
+        flFrom->dwNumFiles != flTo->dwNumFiles  &&
+        !IsAttribDir(fileDest->attributes))
     {
         return ERROR_CANCELLED;
     }

There is a glaring error right here.  For one, you should heed
compiler warnings:

wine/dlls/shell32/shlfileop.c: In function 'SHFileOperationW':
wine/dlls/shell32/shlfileop.c:1428: warning: 'fileDest' is used
uninitialized in this function
wine/dlls/shell32/shlfileop.c:1407: note: 'fileDest' was declared here

You're using fileDest when it hasn't been initialized (as the warning
says).  Second, the tests fail:

shlfileop.c:1132: Test failed: The file is not moved - many files are
specified as a target
shlfileop.c:1206: Test failed: Expected d.txt to not exist
make: *** [shlfileop.ok] Error 2

-- 
James Hawkins


From htl10 at users.sourceforge.net  Tue Jun 17 21:27:28 2008
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 18 Jun 2008 02:27:28 +0000 (GMT)
Subject: Website down
In-Reply-To: <4858312E.9090801@codeweavers.com>
Message-ID: <598461.50032.qm@web23105.mail.ird.yahoo.com>

Just for "geek value", is it possible to have a graph of how the slashdot effect look like? I mean a graph of the hourly web hit statistics or something.

Be very glad that a lot of people are finding wine interesting...


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html


From thestig at google.com  Tue Jun 17 22:52:04 2008
From: thestig at google.com (Lei Zhang)
Date: Tue, 17 Jun 2008 20:52:04 -0700
Subject: Remove LATER and REMIND bug resolutions
Message-ID: <558b2f5c0806172052x3f7b5e06jc0952b10ae8519c2@mail.gmail.com>

Hi,

It's been a week and nobody has responded to Dmitry's bug report [1]
yet, so I'm going to bring it up here. I am all for it, does anyone
have objections?

- Lei

[1] http://bugs.winehq.org/show_bug.cgi?id=13794


From robertshearman at gmail.com  Wed Jun 18 01:43:02 2008
From: robertshearman at gmail.com (Rob Shearman)
Date: Wed, 18 Jun 2008 07:43:02 +0100
Subject: [19/44] user32: Increased area for scrolling via mouse drag
	outside scrollbar
In-Reply-To: <5c6ee3b70806171819t7244530y3d552b0743e7356e@mail.gmail.com>
References: <5c6ee3b70806171819t7244530y3d552b0743e7356e@mail.gmail.com>
Message-ID: <1096648c0806172343m73a730e9r21a823b10e767b9f@mail.gmail.com>

Dylan Smith wrote:
> +  /* Distance beside or past the ends the scrollbar for the mouse can be dragged
> +   * away from scrollbar and still be considered in the scrollbar. */
> +#define SCROLL_DRAG_ZONE_PADDING_BESIDE    138
> +#define SCROLL_DRAG_ZONE_PADDING_PAST_END  34

This should be a proportion of the scrollbar width/height instead of
absolute values in pixels.

-- 
Rob Shearman


From robertshearman at gmail.com  Wed Jun 18 01:41:55 2008
From: robertshearman at gmail.com (Rob Shearman)
Date: Wed, 18 Jun 2008 07:41:55 +0100
Subject: [31/44] richedit: Set error codes and stop parsing for some rtf
	syntax errors.
In-Reply-To: <5c6ee3b70806171820q1c381363t293e778bcea7d6fa@mail.gmail.com>
References: <5c6ee3b70806171820q1c381363t293e778bcea7d6fa@mail.gmail.com>
Message-ID: <1096648c0806172341i3e85e398yd932aa8f1d90a37e@mail.gmail.com>

Dylan Smith wrote:
> +      if (!inStream.editstream->dwError && parser.stackTop > 0)
> +        inStream.editstream->dwError = -2147024858;

This should be HRESULT_FROM_WIN32(ERROR_HANDLE_EOF).

-- 
Rob Shearman


