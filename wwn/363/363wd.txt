From kai.blin at gmail.com  Sat May  1 01:56:57 2010
From: kai.blin at gmail.com (Kai Blin)
Date: Sat, 01 May 2010 08:56:57 +0200
Subject: LinuxTag Berlin - call for projects
In-Reply-To: <201004291012.50208.gerrit.moeltgen@itomig.de>
References: <201002251212.41721.gerrit.moeltgen@itomig.de>
	<201004291012.50208.gerrit.moeltgen@itomig.de>
Message-ID: <1272697017.4639.26.camel@rumo>

On Thu, 2010-04-29 at 10:12 +0200, Jan Gerrit M?ltgen wrote:
> Hello together,
> 
> the Wine project is accepted for LinuxTag. I'm verry sorry, in the period of 
> the day linux I have no time unexpectedly and at this moment my time looks 
> bad, too. Is anyone here, who can manage the Wine on LinuxTag and would be at 
> this time in Berlin.
> If no one is there, I will discard the stand unfortunately.

Until when do you need to know?

Cheers,
Kai




From nsivov at codeweavers.com  Sat May  1 03:43:38 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Sat, 01 May 2010 12:43:38 +0400
Subject: Minor dlls/mshtml/htmlbody.c simplification (RESEND)
In-Reply-To: <alpine.LSU.1.99.1005010043400.3481@pulcherrima.dbai.tuwien.ac.at>
References: <alpine.LSU.1.99.1004281201460.19366@acrux.dbai.tuwien.ac.at>
	<4BD82207.5040404@codeweavers.com>
	<alpine.LSU.1.99.1005010043400.3481@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <4BDBE9BA.6030402@codeweavers.com>

On 5/1/2010 04:04, Gerald Pfeifer wrote:
> On Wed, 28 Apr 2010, Nikolay Sivov wrote:
>    
>> Please follow wine-devel comments:
>>
>> http://www.winehq.org/pipermail/wine-devel/2010-April/083175.html
>>      
> Ouch, I had missed this message -- certainly did not mean to ignore
> the good feedback.
>
> Is the following what you had in mind?
>
> Gerald
>
>
> ChangeLog:
> Fix return value for HTMLBodyElement_get_text.
>
> ---
>   dlls/mshtml/htmlbody.c |    4 ++--
>   1 files changed, 2 insertions(+), 2 deletions(-)
>
> diff --git a/dlls/mshtml/htmlbody.c b/dlls/mshtml/htmlbody.c
> index 5c66e65..65aa549 100644
> --- a/dlls/mshtml/htmlbody.c
> +++ b/dlls/mshtml/htmlbody.c
> @@ -443,7 +443,7 @@ static HRESULT WINAPI HTMLBodyElement_get_text(IHTMLBodyElement *iface, VARIANT
>       HTMLBodyElement *This = HTMLBODY_THIS(iface);
>       nsAString text;
>       nsresult nsres;
> -    HRESULT hres;
> +    HRESULT hres = S_OK;
>
>       TRACE("(%p)->(%p)\n", This, p);
>
> @@ -462,7 +462,7 @@ static HRESULT WINAPI HTMLBodyElement_get_text(IHTMLBodyElement *iface, VARIANT
>
>       nsAString_Finish(&text);
>
> -    return S_OK;
> +    return hres;
>   }
>
>   static HRESULT WINAPI HTMLBodyElement_put_link(IHTMLBodyElement *iface, VARIANT v)
>    
Yes, but you don't have to initialize it to S_OK.


From bunglehead at gmail.com  Sat May  1 13:02:45 2010
From: bunglehead at gmail.com (Nikolay Sivov)
Date: Sat, 01 May 2010 22:02:45 +0400
Subject: Minor dlls/localspl/tests/localmon.c simplificiation
In-Reply-To: <alpine.LSU.1.99.1005011928450.18670@pulcherrima.dbai.tuwien.ac.at>
References: <alpine.LSU.1.99.1004231448010.24624@acrux.dbai.tuwien.ac.at>
	<4BD2EB37.4040009@gmail.com>
	<alpine.LSU.1.99.1005011928450.18670@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <4BDC6CC5.30407@gmail.com>

On 5/1/2010 21:52, Gerald Pfeifer wrote:
> On Sat, 24 Apr 2010, Nikolay Sivov wrote:
>    
>>> ChangeLog:
>>> Remove variable res which is not really used from test_XcvClosePort.
>>>        
>> We should better test for return value than remove it.
>>      
> Okay.  Is this something you can look into (or do you have a hint
> on how you'd like such a test to look like)?  It would be great
> could you make this change, but if you have guidance I will do my
> best to give it a try, too.
>
> Gerald
>    
This is a primitive thing, try it if you didn't before.
All you need is to add some lines like:
---
ok(res == ERROR_SUCCESS /*a proper code here*/, "expected ERROR_SUCCESS, 
got %d\n", res);
---
After that run a test on Windows and Wine (using a bot for example) and 
make corrections if needed.



From dank at kegel.com  Sat May  1 13:08:46 2010
From: dank at kegel.com (Dan Kegel)
Date: Sat, 1 May 2010 11:08:46 -0700
Subject: 3dmark2000, 3dmark06 results on both Wine and Vista
Message-ID: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com>

I did some apples-to-apples 3d benchmarking today on a dual boot system.
It looks offhand like Windows is about twice as fast as Wine on these
benchmarks on my system.

 cpu:  e8400
 ram: 4GB
 video card: nvidia GT 240
 Ubuntu 32 10.04 video drivers: 195.36.15
 Vista 64 video drivers: 8.17.11.9713

Test procedure:

On Ubuntu, grab latest wine from git, apply patch from
http://bugs.winehq.org/show_bug.cgi?id=9210
so 3dmark06 will run.
On Windows, install cygwin and a few of its packages (cabextract,
wget, svn, etc.)
Then on both systems do
  svn checkout http://winezeug.googlecode.com/svn/trunk/ winezeug
  sh winezeug
  sh yagmarktest

That will run the tests in a loop and save a report for each run in
the current directory.

Results at http://kegel.com/wine/yagmarkdata/e8400/

Summary:
Ubuntu: 6 runs
3dmark2000:  min 4145, median 4154, max 4170
3dmark2001:  min 18884, median 19261, max 19520
3dmark2006:  min 17315, median 18154, max 18498

Vista: 2 runs:
3dmark2000:  8206,  8219
3dmark2006:  30278, 32384

Notes:
1) 3dmark2001 hangs for me on vista 64 bits, so no results for that
test on that OS, I had to
edit yagmarktest to remove it from the loop.  Does it work for anyone else?
2) nvidia drivers occasionally crash X when running or quitting
3dmark2000 or 3dmark06; it's happened to me three times.
3) test script is fragile, don't touch the mouse or keyboard while it's running
4) shadows appear to be missing on wine in firefly forest in 3dmark06
and giant mecha truck test in 3dmark01?
5) format of my log files is ugly and will change.


From paul.vriens.wine at gmail.com  Sat May  1 13:49:12 2010
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Sat, 01 May 2010 20:49:12 +0200
Subject: user32: Focus editboxes when the context menu is opened. (try 3)
In-Reply-To: <33F6268AA99B6C448F07F03B2B6497D34C0962@taz.CodeWeavers.local>
References: <33F6268AA99B6C448F07F03B2B6497D34C0962@taz.CodeWeavers.local>
Message-ID: <4BDC77A8.60003@gmail.com>

On 04/24/2010 10:08 PM, Vincent Povirk wrote:
> +        case WM_CAPTURECHANGED:
> +            if (hWnd != (HWND)lParam)
> +            {
> +                got_wm_capturechanged = 1;
> +                EndMenu();
> +            }
> +            break;

Hi Vincent,

EndMenu is not available on Win95 so no user32 tests are run on that 
platform at the moment.

Can we skip just this call to EndMenu on Win95, should we skip this 
whole new test (test_contextmenu_focus) on Win95 or is there an alternative?

-- 
Cheers,

Paul.


From madewokherd at gmail.com  Sat May  1 13:52:43 2010
From: madewokherd at gmail.com (Vincent Povirk)
Date: Sat, 1 May 2010 13:52:43 -0500
Subject: user32: Focus editboxes when the context menu is opened. (try 3)
In-Reply-To: <4BDC77A8.60003@gmail.com>
References: <33F6268AA99B6C448F07F03B2B6497D34C0962@taz.CodeWeavers.local>
	<4BDC77A8.60003@gmail.com>
Message-ID: <x2lced95fe1005011152nd1777628zd44bb57fa328119a@mail.gmail.com>

We can't skip the EndMenu call because that would cause the test to
hang waiting for the menu to finish.

Unless there's some other way we can programmatically close the popup
menu on win95, I think we'll have to skip the whole test.

On Sat, May 1, 2010 at 1:49 PM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> On 04/24/2010 10:08 PM, Vincent Povirk wrote:
>>
>> + ? ? ? ?case WM_CAPTURECHANGED:
>> + ? ? ? ? ? ?if (hWnd != (HWND)lParam)
>> + ? ? ? ? ? ?{
>> + ? ? ? ? ? ? ? ?got_wm_capturechanged = 1;
>> + ? ? ? ? ? ? ? ?EndMenu();
>> + ? ? ? ? ? ?}
>> + ? ? ? ? ? ?break;
>
> Hi Vincent,
>
> EndMenu is not available on Win95 so no user32 tests are run on that
> platform at the moment.
>
> Can we skip just this call to EndMenu on Win95, should we skip this whole
> new test (test_contextmenu_focus) on Win95 or is there an alternative?
>
> --
> Cheers,
>
> Paul.
>
>
>


From paul.vriens.wine at gmail.com  Sat May  1 13:56:22 2010
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Sat, 01 May 2010 20:56:22 +0200
Subject: user32: Focus editboxes when the context menu is opened. (try 3)
In-Reply-To: <x2lced95fe1005011152nd1777628zd44bb57fa328119a@mail.gmail.com>
References: <33F6268AA99B6C448F07F03B2B6497D34C0962@taz.CodeWeavers.local>	
	<4BDC77A8.60003@gmail.com>
	<x2lced95fe1005011152nd1777628zd44bb57fa328119a@mail.gmail.com>
Message-ID: <4BDC7956.6000503@gmail.com>

On 05/01/2010 08:52 PM, Vincent Povirk wrote:
> We can't skip the EndMenu call because that would cause the test to
> hang waiting for the menu to finish.
>
> Unless there's some other way we can programmatically close the popup
> menu on win95, I think we'll have to skip the whole test.

I'll give the MSDN suggestion a try:

"If a platform does not support EndMenu, send the owner of the active 
menu a WM_CANCELMODE message."

-- 
Cheers,

Paul.


From scott at open-vote.org  Sat May  1 17:26:48 2010
From: scott at open-vote.org (Scott Ritchie)
Date: Sat, 01 May 2010 15:26:48 -0700
Subject: 3dmark2000, 3dmark06 results on both Wine and Vista
In-Reply-To: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com>
References: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com>
Message-ID: <4BDCAAA8.4090406@open-vote.org>

One note of caution is that video card manufacturers have been known to
blatantly cheat on these tests by rigging their drivers with special
hacks when they detect 3dmark is running.  As far as I know the code may
still be there.

Since the Linux drivers probably don't have these hacks, if they are
indeed still enabled you wouldn't get an Apples:Apples comparison even
on the same hardware.

Thanks,
Scott Ritchie

On 05/01/2010 11:08 AM, Dan Kegel wrote:
> I did some apples-to-apples 3d benchmarking today on a dual boot system.
> It looks offhand like Windows is about twice as fast as Wine on these
> benchmarks on my system.
> 
>  cpu:  e8400
>  ram: 4GB
>  video card: nvidia GT 240
>  Ubuntu 32 10.04 video drivers: 195.36.15
>  Vista 64 video drivers: 8.17.11.9713
> 
> Test procedure:
> 
> On Ubuntu, grab latest wine from git, apply patch from
> http://bugs.winehq.org/show_bug.cgi?id=9210
> so 3dmark06 will run.
> On Windows, install cygwin and a few of its packages (cabextract,
> wget, svn, etc.)
> Then on both systems do
>   svn checkout http://winezeug.googlecode.com/svn/trunk/ winezeug
>   sh winezeug
>   sh yagmarktest
> 
> That will run the tests in a loop and save a report for each run in
> the current directory.
> 
> Results at http://kegel.com/wine/yagmarkdata/e8400/
> 
> Summary:
> Ubuntu: 6 runs
> 3dmark2000:  min 4145, median 4154, max 4170
> 3dmark2001:  min 18884, median 19261, max 19520
> 3dmark2006:  min 17315, median 18154, max 18498
> 
> Vista: 2 runs:
> 3dmark2000:  8206,  8219
> 3dmark2006:  30278, 32384
> 
> Notes:
> 1) 3dmark2001 hangs for me on vista 64 bits, so no results for that
> test on that OS, I had to
> edit yagmarktest to remove it from the loop.  Does it work for anyone else?
> 2) nvidia drivers occasionally crash X when running or quitting
> 3dmark2000 or 3dmark06; it's happened to me three times.
> 3) test script is fragile, don't touch the mouse or keyboard while it's running
> 4) shadows appear to be missing on wine in firefly forest in 3dmark06
> and giant mecha truck test in 3dmark01?
> 5) format of my log files is ugly and will change.
> 
> 



From gerald at pfeifer.com  Sat May  1 12:52:45 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Sat, 1 May 2010 19:52:45 +0200 (CEST)
Subject: Minor dlls/localspl/tests/localmon.c simplificiation
In-Reply-To: <4BD2EB37.4040009@gmail.com>
References: <alpine.LSU.1.99.1004231448010.24624@acrux.dbai.tuwien.ac.at>
	<4BD2EB37.4040009@gmail.com>
Message-ID: <alpine.LSU.1.99.1005011928450.18670@pulcherrima.dbai.tuwien.ac.at>

On Sat, 24 Apr 2010, Nikolay Sivov wrote:
>> ChangeLog:
>> Remove variable res which is not really used from test_XcvClosePort.
> We should better test for return value than remove it.

Okay.  Is this something you can look into (or do you have a hint
on how you'd like such a test to look like)?  It would be great
could you make this change, but if you have guidance I will do my
best to give it a try, too.

Gerald


From nsivov at codeweavers.com  Sat May  1 18:47:07 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Sun, 02 May 2010 03:47:07 +0400
Subject: Remove variable doRecursive which is not really used from
	WCMD_for.
In-Reply-To: <20100501142446.127D494332@pulcherrima.dbai.tuwien.ac.at>
References: <20100501142446.127D494332@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <4BDCBD7B.4080303@codeweavers.com>

On 5/1/2010 18:24, Gerald Pfeifer wrote:
> ---
>   programs/cmd/builtins.c |    5 ++---
>   1 files changed, 2 insertions(+), 3 deletions(-)
>    
Please use consistent naming for patches and mail subjects. It's 
described in http://wiki.winehq.org/SubmittingPatches.

I'm not sure it makes sense to resend all these, but GERALD: as a start 
word is unacceptable of course.



From testbot at testbot.winehq.org  Sat May  1 19:08:33 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sun, 2 May 2010 02:08:33 +0200
Subject: Destroy the window we created at the end of wait_idle_thread. 
Message-ID: <201005020008.o4208Xab000624@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1857

Your paranoid android.


=== W7PROX64 (64 bit msg) ===
Timeout


From austinenglish at gmail.com  Sun May  2 02:48:22 2010
From: austinenglish at gmail.com (Austin English)
Date: Sun, 2 May 2010 02:48:22 -0500
Subject: 3dmark2000, 3dmark06 results on both Wine and Vista
In-Reply-To: <4BDCAAA8.4090406@open-vote.org>
References: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com> 
	<4BDCAAA8.4090406@open-vote.org>
Message-ID: <n2pb6bb06271005020048p661aff9fn24568dfa84939196@mail.gmail.com>

On Sat, May 1, 2010 at 5:26 PM, Scott Ritchie <scott at open-vote.org> wrote:
> One note of caution is that video card manufacturers have been known to
> blatantly cheat on these tests by rigging their drivers with special
> hacks when they detect 3dmark is running. ?As far as I know the code may
> still be there.
>
> Since the Linux drivers probably don't have these hacks, if they are
> indeed still enabled you wouldn't get an Apples:Apples comparison even
> on the same hardware.

Scott, please bottom post on wine mailing lists.

As for the driver hacks, you might try renaming the executable (e.g.,
3dmark.exe ->3dmarktest.exe). Some of those hacks only check the
executable name, and renaming the executable restores the 'real'
behavior. Quake 3 was well known for this..

-- 
-Austin


From epssyis at gmail.com  Sun May  2 03:03:48 2010
From: epssyis at gmail.com (Edward Savage)
Date: Sun, 2 May 2010 18:03:48 +1000
Subject: 3dmark2000, 3dmark06 results on both Wine and Vista
In-Reply-To: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com>
References: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com>
Message-ID: <n2od6c5d7291005020103g853d0339y40fdcb161dd3fb36@mail.gmail.com>

On Sun, May 2, 2010 at 4:08 AM, Dan Kegel <dank at kegel.com> wrote:
> I did some apples-to-apples 3d benchmarking today on a dual boot system.
> It looks offhand like Windows is about twice as fast as Wine on these
> benchmarks on my system.
>
> ?cpu: ?e8400
> ?ram: 4GB
> ?video card: nvidia GT 240
> ?Ubuntu 32 10.04 video drivers: 195.36.15
> ?Vista 64 video drivers: 8.17.11.9713
>

Do you happen to have a 4k/5k series ATI card to attempt this test set
with as well?

I'd find it interesting to see their relative performance as well as
the notable short comings (things not rendered) ATI still have under
Wine. Some one asked me the other day how well they'd fair with a new
ATI card under Wine and Linux and I had no idea about an answer.


From thunderbird2k at gmail.com  Sun May  2 04:07:01 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Sun, 2 May 2010 11:07:01 +0200
Subject: 3dmark2000, 3dmark06 results on both Wine and Vista
In-Reply-To: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com>
References: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com>
Message-ID: <q2lc8485d471005020207z380b9f10v24fb7da24bf9a18b@mail.gmail.com>

When doing such benchmarks also try to write down the frame rates of
the individual tests. The 3dmark score is some sort of weighted
average (the result of the cpu test in it is also quite important).

From dank at kegel.com  Sun May  2 09:46:17 2010
From: dank at kegel.com (Dan Kegel)
Date: Sun, 2 May 2010 07:46:17 -0700
Subject: 3dmark2000, 3dmark06 results on both Wine and Vista
In-Reply-To: <n2od6c5d7291005020103g853d0339y40fdcb161dd3fb36@mail.gmail.com>
References: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com>
	<n2od6c5d7291005020103g853d0339y40fdcb161dd3fb36@mail.gmail.com>
Message-ID: <y2ia71bd89a1005020746n47a16dddn9a68b8d94a01c32c@mail.gmail.com>

On Sun, May 2, 2010 at 1:03 AM, Edward Savage <epssyis at gmail.com> wrote:
>> ?video card: nvidia GT 240
>
> Do you happen to have a 4k/5k series ATI card to attempt this test set
> with as well?

I have three nvidia cards: 8500gt, gt220, gt240.
(I also have an old ati rage pro which probably isn't worth testing.)

> I'd find it interesting to see their relative performance as well as
> the notable short comings (things not rendered) ATI still have under
> Wine. Some one asked me the other day how well they'd fair with a new
> ATI card under Wine and Linux and I had no idea about an answer.

Maybe someone with current ATI hardware can run yagmark following
the steps I gave.  It's pretty easy.
- Dan


From dank at kegel.com  Sun May  2 09:46:40 2010
From: dank at kegel.com (Dan Kegel)
Date: Sun, 2 May 2010 07:46:40 -0700
Subject: 3dmark2000, 3dmark06 results on both Wine and Vista
In-Reply-To: <q2lc8485d471005020207z380b9f10v24fb7da24bf9a18b@mail.gmail.com>
References: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com>
	<q2lc8485d471005020207z380b9f10v24fb7da24bf9a18b@mail.gmail.com>
Message-ID: <s2la71bd89a1005020746o5a1b6282zed966ebd530c5b41@mail.gmail.com>

On Sun, May 2, 2010 at 2:07 AM, Roderick Colenbrander
<thunderbird2k at gmail.com> wrote:
> When doing such benchmarks also try to write down the frame rates of
> the individual tests. The 3dmark score is some sort of weighted
> average (the result of the cpu test in it is also quite important).
> From what I remember the scores in 2000/2001/2003 were actually good
> but 2005/2006 used to be quite slow for some reason.

OK, I'll try to parse out the subscores.
- Dan


From kgbricola at web.de  Sun May  2 09:48:32 2010
From: kgbricola at web.de (=?ISO-8859-1?Q?Rico_Sch=FCller?=)
Date: Sun, 02 May 2010 16:48:32 +0200
Subject: 3dmark2000, 3dmark06 results on both Wine and Vista
In-Reply-To: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com>
References: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com>
Message-ID: <4BDD90C0.1010403@web.de>

Am 01.05.2010 20:08, schrieb Dan Kegel:
> Results at http://kegel.com/wine/yagmarkdata/e8400/
>
> Summary:
> Ubuntu: 6 runs
> 3dmark2000:  min 4145, median 4154, max 4170
> 3dmark2001:  min 18884, median 19261, max 19520
> 3dmark2006:  min 17315, median 18154, max 18498
>
> Vista: 2 runs:
> 3dmark2000:  8206,  8219
> 3dmark2006:  30278, 32384
>
>    
It looks like you've mixed up the results somewhere. The score should be 
higher on the lower 3Dmark version. (3dmark 2000 on vista has 30278 
points - 
http://kegel.com/wine/yagmarkdata/e8400/gt240/vista/yagmark-e8400-Vista-2010-04-30-18:30.txt)

Cheers
Rico


From dank at kegel.com  Sun May  2 10:04:39 2010
From: dank at kegel.com (Dan Kegel)
Date: Sun, 2 May 2010 08:04:39 -0700
Subject: 3dmark2000, 3dmark06 results on both Wine and Vista
In-Reply-To: <4BDD90C0.1010403@web.de>
References: <n2ka71bd89a1005011108z8d764a2bodc6f8d9398971e45@mail.gmail.com>
	<4BDD90C0.1010403@web.de>
Message-ID: <v2wa71bd89a1005020804kf86c2cfal509c195768b9291a@mail.gmail.com>

2010/5/2 Rico Sch?ller <kgbricola at web.de>:
> It looks like you've mixed up the results somewhere. The score should be
> higher on the lower 3Dmark version. (3dmark 2000 on vista has 30278 points -
> http://kegel.com/wine/yagmarkdata/e8400/gt240/vista/yagmark-e8400-Vista-2010-04-30-18:30.txt)

That'll teach me to edit data tables manually.  Next one will be
automatically generated.
- Dan


From johann at myrkraverk.com  Sun May  2 11:55:54 2010
From: johann at myrkraverk.com (Johann "Myrkraverk" Oskarsson)
Date: Sun, 2 May 2010 16:55:54 +0000
Subject: Unable to start WoW from git 1.1.29 while 1.1.29 tarball works.
Message-ID: <n2ocb59c2d11005020955l21dc9d6foed17b6ae7f04344a@mail.gmail.com>

Hello all.

I am unable to start WoW when I compile release 1.1.29 from the git
repo, while compiling the 1.1.29 release tarball allows me to play
WoW.

System info:

% uname -a; isainfo -k
SunOS asuka 5.11 snv_115 i86pc i386 i86pc
amd64

Git compile steps taken:

git checkout wine-1.1.29
git clean -x -f
./configure --prefix=/opt/myrkraverk/wine-git && gmake depend && gmake

WoW now fails to start with some console output like:

[johann at asuka]~/src/external/git/wine/wine% Can't attach process 0011: error 6
wine: Call from 7fd69d43 to unimplemented function
user32.dll.UserRegisterWowHandlers, aborting
fixme:ntdll:RtlNtStatusToDosErrorNoTeb no mapping for 80000100
err:module:DelayLoadFailureHook failed to delay load user32.dll.LoadStringW

More pastes here: http://paste.lisp.org/display/98679

I did not use any special flags or environment variables to compile
the tarball, apart from the prefix.

This is my showstopper to regression test bug 22033:

http://bugs.winehq.org/show_bug.cgi?id=22033

Any help apreciated.


Johann


From plr.vincent at gmail.com  Sun May  2 12:13:26 2010
From: plr.vincent at gmail.com (Vincent Pelletier)
Date: Sun, 2 May 2010 19:13:26 +0200
Subject: new wisotool 20100424: new verbs 3dmark2000, 3dmark2001, 3dmark03,
	3dmark05, 3dmark06, baldursgate2, gta_vc, pcmark04, pcmark05,
	unigine_heaven
In-Reply-To: <201005010040.09808.plr.vincent@gmail.com>
References: <o2ta71bd89a1004241644ob600e000jdd54aecd281a3db4@mail.gmail.com>
	<201004291257.51000.plr.vincent@gmail.com>
	<201005010040.09808.plr.vincent@gmail.com>
Message-ID: <201005021913.28278.plr.vincent@gmail.com>

Patch updated.

Notes:
- Download urls and AHK scripts are *all* tested as of this patch (~5 hours to
  install everything).
- BAT scripts are *not* tested.

Remaining issues:
- url escaping when posting login & password (I'll work on this next)
- possibly BAT scripting mistakes (verb definition)
- possibly a yet unidentified auth bug which affected Dan Kegel
- missing BAT scripts for bundles (not sure what to do for those)

Changelog:
- add cookie support in "download" (required as GOG.com requires auth
  to download games)
- add download support for gog verbs
- Refresh against current svn head
- _load_gog: added install_dir parameter (needed by a few games)
- double all "\" meant to be literal backslashes
- fix download path for verbs:
  ut2004_gog
  abes_oddysee_gog
  abes_exoddus_gog
  descent_1_2_gog
- add verbs:
  descent_3_gog
  psychonauts_gog
  ut_goty_gog
  unreal_gold_gog
  unreal_2_se_gog
  battle_chess_gog
  earth_2150_trilogy_gog
  earth_2160_gog
  empire_earth_gold_gog
  earthworm_jim_1_2_gog
  shogo_gog
  settlers_2_gold_gog
  robinson_requiem_collection_gog
  redneck_rampage_gog
  praetorians_gog
  perimeter_gog
  painkiller_black_gog
  operation_flashpoint_goty_gog
  neighbours_from_hell_compilation_gog
  mdk_gog
  mdk2_gog
  ground_control_2_gog
  ghost_master_gog
  freespace_gog
  freespace_2_gog
  flatout_gog
  earthworm_jim_3d_gog
  fallout_gog
  fallout_2_gog
  fallout_tactics_gog

-- 
Vincent Pelletier
-------------- next part --------------
A non-text attachment was scrubbed...
Name: gog_support_2.diff
Type: text/x-patch
Size: 15005 bytes
Desc: not available
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100502/f1881031/attachment.bin>

From johann at myrkraverk.com  Sun May  2 13:09:55 2010
From: johann at myrkraverk.com (Johann "Myrkraverk" Oskarsson)
Date: Sun, 2 May 2010 18:09:55 +0000
Subject: Unable to start WoW from git 1.1.29 while 1.1.29 tarball works.
In-Reply-To: <n2ocb59c2d11005020955l21dc9d6foed17b6ae7f04344a@mail.gmail.com>
References: <n2ocb59c2d11005020955l21dc9d6foed17b6ae7f04344a@mail.gmail.com>
Message-ID: <t2pcb59c2d11005021109yf43a5ec9sbfb12863f2105dce@mail.gmail.com>

Hi all,

On Sun, May 2, 2010 at 4:55 PM, Johann "Myrkraverk" Oskarsson
<johann at myrkraverk.com> wrote:

> I am unable to start WoW when I compile release 1.1.29 from the git
> repo, while compiling the 1.1.29 release tarball allows me to play
> WoW.

With help from #winehq: An out of tree build works.


Johann


From ehoover at mines.edu  Sun May  2 15:39:14 2010
From: ehoover at mines.edu (Erich Hoover)
Date: Sun, 2 May 2010 14:39:14 -0600
Subject: Fullscreen Borderlands at Desktop Resolution
Message-ID: <z2g4c1ac96d1005021339w25a56f5fv51c6be1187af95b8@mail.gmail.com>

I've been playing the game Borderlands at less than my desktop resolution
due to a strange bug and finally decided to try and track it down.  The
issue is that whenever the resolution of Borderlands is set to the same
resolution as the desktop then the game window does not appear in the upper
left hand corner and the size of the window is about 1/2 of the display size
for both the width and the height.  After some exploration, this appears to
be two separate issues with the Wine's X11 driver.
1) sync_window_position() will not move an iconified managed window, so the
window is never repositioned to the upper left corner.
2) set_size_hints() checks to see if a window is the size of the display (or
larger) and does not resize the window if that is the case.

Another interesting point is that these issues only occur when using compiz,
when using metacity the following warnings are displayed:
---
Window manager warning: Window 0x4200005 (Borderland) sets an MWM hint
indicating it isn't resizable, but sets min size 1 x 1 and max size
2147483647 x 2147483647; this doesn't make much sense.
Window manager warning: Treating resize request of legacy application
0x4200005 (Borderland) as a fullscreen request
---

I've attached a patch that overcomes these issues, but I'm suspicious that
there are unintended consequences.  I would appreciate it if someone could
take a look.

Erich Hoover
ehoover at mines.edu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100502/ba3b6078/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: borderlands-fullscreen.diff
Type: text/x-diff
Size: 1374 bytes
Desc: not available
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100502/ba3b6078/attachment.diff>

From fgouget at free.fr  Sun May  2 16:48:41 2010
From: fgouget at free.fr (Francois Gouget)
Date: Sun, 2 May 2010 23:48:41 +0200 (CEST)
Subject: Francois Gouget : winedbg: Fix compilation with gcc 2. 95 and
	non-GNU compilers.
In-Reply-To: <4BCF540B.1010800@orange.fr>
References: <E1NwGPW-0006pO-0Y@wine.codeweavers.com>
	<4BC95AB6.9050007@orange.fr>
	<alpine.DEB.2.00.1004171343550.17941@amboise.dolphin>
	<4BCF540B.1010800@orange.fr>
Message-ID: <alpine.DEB.2.00.1005022345030.308@amboise.dolphin>

On Wed, 21 Apr 2010, Eric Pouech wrote:

> Francois Gouget a ?crit :
> > There were two problems:
> >  * the semi-colon was missing for non-GNUC compilers as you mentioned
> >  * gcc 2.95 does not support __attribute__() on function pointers
> > 
> > Unfortunately your patch does not fix the second issue. A solution that
> > would not require dbg_vprintf() would be to check the gcc version before
> > trying to use __attribute__().
[...]
> does the attached patch works better ? (I tried your suggestion starting at
> gcc 3.0)

Yes, that works. It means that we won't get the benefit of printf format 
checking on gcc 2.95 but that does not matter since pretty much everyone 
will do these checks already. And your patch is simpler than mine (and 
more importantly works).

-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                         Stolen from an Internet user:
              "f u cn rd ths, u cn gt a gd jb n cmptr prgrmmng !"

From nsivov at codeweavers.com  Sun May  2 17:21:30 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Mon, 03 May 2010 02:21:30 +0400
Subject: quartz: Properly return E_POINTER when ppFilters is null
In-Reply-To: <h2x41eceb531005021517k69622245t53fa8893f9acbacf@mail.gmail.com>
References: <h2x41eceb531005021517k69622245t53fa8893f9acbacf@mail.gmail.com>
Message-ID: <4BDDFAEA.6080301@codeweavers.com>

On 5/3/2010 02:17, Jerome Leclanche wrote:
> Fixes bug 22563. Also fix broken indent right below.
>
> J. Leclanche
>    
Please, add a test for this, it looks trivial to test.


From gerald at pfeifer.com  Sun May  2 15:07:44 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Sun, 2 May 2010 22:07:44 +0200 (CEST)
Subject: Minor dlls/dbghelp/dwarf.c simplification
In-Reply-To: <alpine.LSU.1.99.1004232039410.24624@acrux.dbai.tuwien.ac.at>
References: <alpine.LSU.1.99.1004232039410.24624@acrux.dbai.tuwien.ac.at>
Message-ID: <alpine.LSU.1.99.1005022201100.18670@pulcherrima.dbai.tuwien.ac.at>

Eric Pouech wrote:
> this is wrong: dwarf_parse family set makes the pointer in the cxt 
> advance by the size of the object which is being parse

You're right.  I had, in fact, checked this very question, but doing
so just again I see where I missed the += in the code.  Thanks for
catching this, Eric!

> and actually, the correct fix would be to make use of those variables 
> (like checking if the version is a known one), instead of throwing 
> things away

Are you planning to go into that direction?  If not, I'd suggest the
patch below.  (I'm not sure whether checking for the DWARF version is
going to help -- do we want to abort for newer versions when these
actually should be compatible?)


Gerald



From: Gerald Pfeifer <gerald at pfeifer.com>
Date: Sun, 2 May 2010 22:05:20
Subject: dbghelp: Remove two variables which are not really used in dwarf2_parse_line_numbers.

---
 dlls/dbghelp/dwarf.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/dlls/dbghelp/dwarf.c b/dlls/dbghelp/dwarf.c
index 4be0f6a..99960d8 100644
--- a/dlls/dbghelp/dwarf.c
+++ b/dlls/dbghelp/dwarf.c
@@ -1920,7 +1920,7 @@ static BOOL dwarf2_parse_line_numbers(const dwarf2_section_t* sections,
 {
     dwarf2_traverse_context_t   traverse;
     unsigned long               length;
-    unsigned                    version, header_len, insn_size, default_stmt;
+    unsigned                    insn_size, default_stmt;
     unsigned                    line_range, opcode_base;
     int                         line_base;
     const unsigned char*        opcode_len;
@@ -1939,8 +1939,8 @@ static BOOL dwarf2_parse_line_numbers(const dwarf2_section_t* sections,
     length = dwarf2_parse_u4(&traverse);
     traverse.end_data = sections[section_line].address + offset + length;
 
-    version = dwarf2_parse_u2(&traverse);
-    header_len = dwarf2_parse_u4(&traverse);
+    dwarf2_parse_u2(&traverse);
+    dwarf2_parse_u4(&traverse);
     insn_size = dwarf2_parse_byte(&traverse);
     default_stmt = dwarf2_parse_byte(&traverse);
     line_base = (signed char)dwarf2_parse_byte(&traverse);
-- 
1.6.6.2




From gerald at pfeifer.com  Sun May  2 15:31:13 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Sun, 2 May 2010 22:31:13 +0200 (CEST)
Subject: Remove variable doRecursive which is not really used from
	WCMD_for.
In-Reply-To: <4BDCBD7B.4080303@codeweavers.com>
References: <20100501142446.127D494332@pulcherrima.dbai.tuwien.ac.at>
	<4BDCBD7B.4080303@codeweavers.com>
Message-ID: <alpine.LSU.1.99.1005022054560.18670@pulcherrima.dbai.tuwien.ac.at>

On Sun, 2 May 2010, Nikolay Sivov wrote:
> Please use consistent naming for patches and mail subjects. It's 
> described in http://wiki.winehq.org/SubmittingPatches.
> 
> I'm not sure it makes sense to resend all these, but GERALD: as a
> start word is unacceptable of course.

Indeed, four or so patches with that in the Subject sneaked through.
This simply was a mistake on my side last month (and Alexandre was
so kind to fix it up).

As for prepending what basically seems to be `pwd | xargs basename`
(but not exactly), I updated my script to take that into account.

Thanks for the advise!

Gerald

PS: It's somewhat funny that after contributing for elven years,
the first time someone complains about my mail subjects is a week
or two _after_ I switch over to using git format-patch. ;-)


From gerald at pfeifer.com  Sun May  2 17:17:29 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Mon, 3 May 2010 00:17:29 +0200 (CEST)
Subject: Minor dlls/comctl32/tests/listview.c simplification
In-Reply-To: <4BD01D00.2070406@codeweavers.com>
References: <alpine.LSU.1.99.1004211931350.24624@acrux.dbai.tuwien.ac.at>
	<4BD01D00.2070406@codeweavers.com>
Message-ID: <alpine.LSU.1.99.1005030015560.18670@pulcherrima.dbai.tuwien.ac.at>

On Thu, 22 Apr 2010, Nikolay Sivov wrote:
> You can't do this, subclassing is important thing here. And you will see 
> it if you run a test (that you should do before sending patch actually).

Thanks, Nikolay.  You're perfectly right, that was a silly mistake of
mine, no way to put this differently.  I've had problems running the
tests on my machine I primarily use for Wine work, but now managed to
address this (which involved patching mmap.c, but seems to work now).

Gerald


From gerald at pfeifer.com  Sun May  2 18:43:11 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Mon, 3 May 2010 01:43:11 +0200 (CEST)
Subject: Minor dlls/localspl/tests/localmon.c simplificiation
In-Reply-To: <4BDC6CC5.30407@gmail.com>
References: <alpine.LSU.1.99.1004231448010.24624@acrux.dbai.tuwien.ac.at>
	<4BD2EB37.4040009@gmail.com>
	<alpine.LSU.1.99.1005011928450.18670@pulcherrima.dbai.tuwien.ac.at>
	<4BDC6CC5.30407@gmail.com>
Message-ID: <alpine.LSU.1.99.1005030127440.18670@pulcherrima.dbai.tuwien.ac.at>

On Sat, 1 May 2010, Nikolay Sivov wrote:
>>>> ChangeLog:
>>>> Remove variable res which is not really used from test_XcvClosePort.
>>> We should better test for return value than remove it.
> This is a primitive thing, try it if you didn't before.
> All you need is to add some lines like:
> ---
> ok(res == ERROR_SUCCESS /*a proper code here*/, "expected ERROR_SUCCESS, got
> %d\n", res);
> ---
> After that run a test on Windows and Wine (using a bot for example) and make
> corrections if needed.

Aaactually, now that I was going to look into this, I recall why I didn't 
consider this originally:  The entire code in that function is inside an
if (0) { }... :-o

But, since you asked for it, I added such tests across the board, made one 
simplification, verified that it actually (if enabled) passes properly on 
Wine and will submit this in a minute.  Then we have things in place when 
the FIXME is addressed.  Plus a learned a thing or two in the process. ;-)

Thanks for your continous feedbac, Nikolay!

Gerlald


From testbot at testbot.winehq.org  Sun May  2 23:40:23 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Mon, 3 May 2010 06:40:23 +0200
Subject: localspl/tests: Improve the tests in test_XcvDataPort_AddPort by
	properly checking return values and avoiding a duplicat
Message-ID: <201005030440.o434eNTn031195@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1881

Your paranoid android.


=== WINEBUILD (build) ===
Patch failed


From dmitry at codeweavers.com  Mon May  3 03:45:47 2010
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 3 May 2010 17:45:47 +0900
Subject: [PATCH] Fix Unicode escape string occurring when calling 
	GetClipboardData(CF_TEXT).
In-Reply-To: <p2rf02f616e1005010032m9b3031c0t3f6e84bc6e76537c@mail.gmail.com>
References: <p2rf02f616e1005010032m9b3031c0t3f6e84bc6e76537c@mail.gmail.com>
Message-ID: <20100503174547.237b6737.dmitry@codeweavers.com>

Sin-ta Hsiea <ibmibmibm.tw at gmail.com> wrote:

> Here's a patch that fetch UTF8 string, and convert to local codepage.

> +            count = WideCharToMultiByte(CP_OEMCP, 0, lpwstr, -1, NULL, 0, NULL, NULL);
> +            hText = GlobalAlloc(GMEM_MOVEABLE | GMEM_DDESHARE, count);
> +
> +            if (hText)
> +            {
> +                CHAR *text = GlobalLock(hText);
> +                WideCharToMultiByte(CP_OEMCP, 0, lpwstr, -1, text, -1, NULL, NULL);
> +                GlobalUnlock(hText);
> +            }

CP_OEMCP is not a local codepage.

-- 
Dmitry.


From nsivov at codeweavers.com  Mon May  3 03:46:26 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Mon, 03 May 2010 12:46:26 +0400
Subject: gdi32/tests: Remove two variables which are not really used from
	test_clipping.
In-Reply-To: <20100502234810.E9E7394332@pulcherrima.dbai.tuwien.ac.at>
References: <20100502234810.E9E7394332@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <4BDE8D62.5090206@codeweavers.com>

On 5/3/2010 03:48, Gerald Pfeifer wrote:
> ---
>   dlls/gdi32/tests/bitmap.c |    4 ----
>   1 files changed, 0 insertions(+), 4 deletions(-)
>
> diff --git a/dlls/gdi32/tests/bitmap.c b/dlls/gdi32/tests/bitmap.c
> index 882d548..b570a8a 100644
> --- a/dlls/gdi32/tests/bitmap.c
> +++ b/dlls/gdi32/tests/bitmap.c
> @@ -2810,9 +2810,7 @@ static void test_GdiAlphaBlend(void)
>   static void test_clipping(void)
>   {
>       HBITMAP bmpDst;
> -    HBITMAP oldDst;
>       HBITMAP bmpSrc;
> -    HBITMAP oldSrc;
>       HRGN hRgn;
>       LPVOID bits;
>       BOOL result;
> @@ -2830,11 +2828,9 @@ static void test_clipping(void)
>
>       bmpDst = CreateDIBSection( hdcDst,&bmpinfo, DIB_RGB_COLORS,&bits, NULL, 0 );
>       ok(bmpDst != NULL, "Couldn't create destination bitmap\n");
> -    oldDst = SelectObject( hdcDst, bmpDst );
>
>       bmpSrc = CreateDIBSection( hdcSrc,&bmpinfo, DIB_RGB_COLORS,&bits, NULL, 0 );
>       ok(bmpSrc != NULL, "Couldn't create source bitmap\n");
> -    oldSrc = SelectObject( hdcSrc, bmpSrc );
>
>       result = BitBlt( hdcDst, 0, 0, 100, 100, hdcSrc, 100, 100, SRCCOPY );
>       ok(result, "BitBlt failed\n");
>    
Bitmap are useless after this change.


From joakim.tjernlund at transmode.se  Mon May  3 02:15:29 2010
From: joakim.tjernlund at transmode.se (Joakim Tjernlund)
Date: Mon, 3 May 2010 09:15:29 +0200
Subject: [Wine] Potential bug in RtlRegisterWait()
In-Reply-To: <4BDE0841.7050502@mymail.mines.edu>
References: <OFFB08212D.C1671B49-ONC1257717.00729C31-C1257717.0073913E@transmode.se>
	<4BDE0841.7050502@mymail.mines.edu>
Message-ID: <OFE3236711.C2BC695B-ONC1257718.002799D4-C1257718.0027DED6@transmode.se>

Charles Davis <cdavis at mymail.mines.edu> wrote on 2010/05/03 01:18:25:
>
> On 5/2/10 3:02 PM, Joakim Tjernlund wrote:
> >
> > Noticed that RtlRegisterWait() will approve a zero timeout value(Milliseconds == 0)
> >
> > This makes ies4linux spin the CPU 100% when visiting a
> > https page. The below crude patch fixes it:
> >
> > --- dlls/ntdll/threadpool.c.org   2010-05-02 22:37:08.000000000 +0200
> > +++ dlls/ntdll/threadpool.c   2010-05-02 22:46:45.000000000 +0200
> > @@ -427,6 +427,9 @@
> >
> >      TRACE( "(%p, %p, %p, %p, %d, 0x%x)\n", NewWaitObject, Object, Callback,
> Context, Milliseconds, Flags );
> >
> > +    if (!Milliseconds)
> > +   return RPC_NT_INVALID_TIMEOUT;
> > +
> >      wait_work_item = RtlAllocateHeap( GetProcessHeap(), 0, sizeof(*wait_work_item) );
> >      if (!wait_work_item)
> >          return STATUS_NO_MEMORY;
> >
> > On a related note, whitout this patch wineserver also goes into an endless
> > loop, doing brk() calls over and over until memory is exausted. Seems
> > like a bug that too.
> This looks like something you should post to wine-devel.

Right, posting there but with a new patch. I think the orginal fix was wrong.
Here is a new one:


From Joakim.Tjernlund at transmode.se  Mon May  3 02:03:09 2010
From: Joakim.Tjernlund at transmode.se (Joakim Tjernlund)
Date: Mon, 3 May 2010 09:03:09 +0200
Subject: [PATCH] RegisterWaitForSingleObjectX(), fix tmo == 0
Message-ID: <mailman.391.1272883091.27605.wine-devel@winehq.org>

Timeout == 0 is special, from the manual:
The time-out interval, in milliseconds. The function returns if the interval
elapses, even if the object's state is nonsignaled. If dwMilliseconds is zero,
the function tests the object's state and returns immediately. If
dwMilliseconds is INFINITE, the function's time-out interval never elapses.

1) Only call Callback iff signaled
2) Implies WT_EXECUTEONLYONCE.
3) Callback should be called before returning.

This is a crude fix not impl. 3) but is enough to get
ies4linux around the 100% CPU problem.
Not sure tmo == 0 implies returning a NULL ptr for phNewWaitObject too.
---
 dlls/ntdll/threadpool.c |   14 ++++++++++----
 1 files changed, 10 insertions(+), 4 deletions(-)

diff --git a/dlls/ntdll/threadpool.c b/dlls/ntdll/threadpool.c
index 44afb01..159baee 100644
--- a/dlls/ntdll/threadpool.c
+++ b/dlls/ntdll/threadpool.c
@@ -373,11 +373,17 @@ static DWORD CALLBACK wait_thread_proc(LPVOID Arg)
                     wait_work_item->Context );
                 TimerOrWaitFired = TRUE;
             }
-            wait_work_item->CallbackInProgress = TRUE;
-            wait_work_item->Callback( wait_work_item->Context, TimerOrWaitFired );
-            wait_work_item->CallbackInProgress = FALSE;
+            /* Milliseconds == 0 is special, only call Callback iff
+               signaled and treat as WT_EXECUTEONLYONCE */
+            if (wait_work_item->Milliseconds || !TimerOrWaitFired)
+            {
+        	wait_work_item->CallbackInProgress = TRUE;
+        	wait_work_item->Callback( wait_work_item->Context, TimerOrWaitFired );
+        	wait_work_item->CallbackInProgress = FALSE;
+            }

-            if (wait_work_item->Flags & WT_EXECUTEONLYONCE)
+            if (!wait_work_item->Milliseconds ||
+        	wait_work_item->Flags & WT_EXECUTEONLYONCE)
                 break;
         }
         else
--
1.6.4.4



From gerald at pfeifer.com  Mon May  3 04:29:23 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Mon, 3 May 2010 11:29:23 +0200 (CEST)
Subject: gdi32/tests: Remove two variables which are not really used from
	test_clipping.
In-Reply-To: <4BDE8D62.5090206@codeweavers.com>
References: <20100502234810.E9E7394332@pulcherrima.dbai.tuwien.ac.at>
	<4BDE8D62.5090206@codeweavers.com>
Message-ID: <alpine.LSU.1.99.1005031127510.18670@pulcherrima.dbai.tuwien.ac.at>

On Mon, 3 May 2010, Nikolay Sivov wrote:
> Bitmap are useless after this change.

Darn, I may have sent the wrong version of the patch.  Let me look
into this tonight or tomorrow. 

You have sharp eyes, Nikolay! :-)

Gerald


From jacek at codeweavers.com  Mon May  3 06:12:36 2010
From: jacek at codeweavers.com (Jacek Caban)
Date: Mon, 03 May 2010 13:12:36 +0200
Subject: mshtml/tests: Fix return value of ActiveScript_SetScriptState.
In-Reply-To: <20100502191606.920AC94332@pulcherrima.dbai.tuwien.ac.at>
References: <20100502191606.920AC94332@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <4BDEAFA4.1030101@codeweavers.com>

Hi Gerald,

On 5/2/10 9:16 PM, Gerald Pfeifer wrote:
> IActiveScriptSite_OnStateChange is described to return S_OK upon
> success, so instead of ignoring its return value and unconditionally
> returning S_OK it strikes me that we should return its result instead.
>    

In this case returning S_OK is fine, but there is missing test for 
OnStateChange return value.

Jacek


From stefandoesinger at gmx.at  Mon May  3 06:36:39 2010
From: stefandoesinger at gmx.at (=?iso-8859-1?Q?Stefan_D=F6singer?=)
Date: Mon, 3 May 2010 13:36:39 +0200
Subject: [ddraw] Fix discrepancy in alpha mask for
	WINED3DFMT_B2G3R3A8_UNORM.
In-Reply-To: <201005020826.21640.plr.vincent@gmail.com>
References: <201005020826.21640.plr.vincent@gmail.com>
Message-ID: <E1356679-DF68-468D-9FB3-836D77CA7F85@gmx.at>


Am 02.05.2010 um 08:26 schrieb Vincent Pelletier:

> 
> PixelFormat_DD2WineD3D returns WINED3DFMT_B2G3R3A8_UNORM when alpha mask
> is 0xFF00, which is consistent with constant name (A8).
The patch looks ok to me.



From stefandoesinger at gmx.at  Mon May  3 06:39:07 2010
From: stefandoesinger at gmx.at (=?iso-8859-1?Q?Stefan_D=F6singer?=)
Date: Mon, 3 May 2010 13:39:07 +0200
Subject: ddraw: Fix missing D3D misc caps
In-Reply-To: <4BDDDB67.2050507@gmail.com>
References: <4BDDDB67.2050507@gmail.com>
Message-ID: <DD41ED60-5921-45C2-96C3-29E051267957@gmx.at>


Am 02.05.2010 um 22:07 schrieb Ri?ardas Barkauskas:

> Fixes missing D3D misc caps needed by Independence War 2: Edge Of Chaos (bug 7012)
The patch seems ok



From Joerg-Cyril.Hoehle at t-systems.com  Mon May  3 06:52:27 2010
From: Joerg-Cyril.Hoehle at t-systems.com (Joerg-Cyril.Hoehle at t-systems.com)
Date: Mon, 3 May 2010 13:52:27 +0200
Subject: Valgrind's wine_cp_wcstombs warnings
Message-ID: <47CC5ABB01651443A88DB8EC5B4D657B740352@S4DE8PSAANK.mitte.t-com.de>

Hi,

running the MCI tests with Valgrind generates a lot of output like follows

==13170== Use of uninitialised value of size 4
==13170==    at 0x4035369: wine_cp_wcstombs (wctomb.c:147)
...[every line from 148 to 161]
==13170== Use of uninitialised value of size 4
==13170==    at 0x403550A: wine_cp_wcstombs (wctomb.c:162)

I suspect the A<->W mapping is still not fully correct (I know at
least one more case, but I'm not sure it gets triggered by the tests)
but perhaps it's also the W->UNIX.UTF-8 conversions internal to Wine
which cause these hits.  How do I tell?

Is there any way to get more precise reporting for the above messages
(e.g. a backtrace)?  The present output is not helpful at identifying
the origin of the uninitialised read.

Perhaps Valgrind is broken? Why does it mention "size 4" when all
access in the offending function is either "char *" or "short *"
according to the source
http://source.winehq.org/source/libs/wine/wctomb.c#L145 ?

Thanks for your help,
	J?rg H?hle


From dank at kegel.com  Mon May  3 08:32:19 2010
From: dank at kegel.com (Dan Kegel)
Date: Mon, 3 May 2010 06:32:19 -0700
Subject: Valgrind's wine_cp_wcstombs warnings
Message-ID: <u2ya71bd89a1005030632ndf33566g749325adb9a7da8e@mail.gmail.com>

Hi Joerg,
did you try the --track-origins option?  That can sometimes give more detail
(see e.g. the traces in this old message):

On Thu, Jul 31, 2008 at 10:14 AM, Dan Kegel <dank at kegel.com> wrote:
> Hi Colin,
> your change
> http://source.winehq.org/git/wine.git/?a=commitdiff;h=c2c1a55f1c08f35ae02b811d1141acd6ec76fca6
> seems to have triggered some valgrind warnings,
> http://kegel.com/wine/valgrind/logs/2008-07-31-07.46/vg-kernel32_codepage-diff.txt
> e.g.
>
> + Use of uninitialised value of size 4
> + ? ?at ?wcstombs_sbcs (wctomb.c:186)
> + ? ?by ?wine_cp_wcstombs (wctomb.c:457)
> + ? ?by ?WideCharToMultiByte (locale.c:1936)
> + ? ?by ?test_string_conversion (codepage.c:288)
> + ? ?by ?func_codepage (codepage.c:351)
> + ? ?by ?run_test (test.h:488)
> + ? ?by ?main (test.h:537)
> + ?Uninitialised value was created by a stack allocation
> + ? ?at ?test_string_conversion (codepage.c:216)
>
> + Use of uninitialised value of size 4
> + ? ?at ?wcstombs_sbcs_slow (wctomb.c:246)
> + ? ?by ?wine_cp_wcstombs (wctomb.c:453)
> + ? ?by ?WideCharToMultiByte (locale.c:1936)
> + ? ?by ?test_string_conversion (codepage.c:288)
> + ? ?by ?func_codepage (codepage.c:352)
> + ? ?by ?run_test (test.h:488)
> + ? ?by ?main (test.h:537)
> + ?Uninitialised value was created by a stack allocation
> + ? ?at ?test_string_conversion (codepage.c:216)
>
> Could you have a look?
>


From julliard at winehq.org  Mon May  3 10:19:05 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 03 May 2010 17:19:05 +0200
Subject: [2/5] rundll32: Fail if a rundll32 window cannot be created.
In-Reply-To: <4BDCFAB2.8030109@codeweavers.com> (Andrew Nguyen's message of
	"Sat, 01 May 2010 23:08:18 -0500")
References: <4BDCFAB2.8030109@codeweavers.com>
Message-ID: <87mxwhypw6.fsf@wine.dyndns.org>

Andrew Nguyen <anguyen at codeweavers.com> writes:

> ---
>   programs/rundll32/rundll32.c |   16 +++++++++++++---
>   1 files changed, 13 insertions(+), 3 deletions(-)

This will prevent initializing the prefix without an X display. Why do
you need this?

-- 
Alexandre Julliard
julliard at winehq.org


From johann at myrkraverk.com  Mon May  3 12:10:40 2010
From: johann at myrkraverk.com (Johann "Myrkraverk" Oskarsson)
Date: Mon, 3 May 2010 17:10:40 +0000
Subject: Why reserve space below 2G without preloader? wrt. patch 1aa749d & 
	bug 22033
Message-ID: <y2jcb59c2d11005031010hecfcef93y4e3acb4ab812b575@mail.gmail.com>

Hi all,

Out of sheer curiousity, why is it important to reserve space below 2G
when there is no preloader?

Patch 1aa749d, is

    libwine: Reserve some low memory space even without a preloader.

has the comment:

/* if we don't have a preloader, try to reserve some space below 2Gb */

and is the regression for bug 22033.

http://bugs.winehq.org/show_bug.cgi?id=22033


I will be trying to determine the excact cause of the bug later.


Johann


From epssyis at gmail.com  Mon May  3 12:51:23 2010
From: epssyis at gmail.com (Edward Savage)
Date: Tue, 4 May 2010 03:51:23 +1000
Subject: Why reserve space below 2G without preloader? wrt. patch 1aa749d 
	& bug 22033
In-Reply-To: <y2jcb59c2d11005031010hecfcef93y4e3acb4ab812b575@mail.gmail.com>
References: <y2jcb59c2d11005031010hecfcef93y4e3acb4ab812b575@mail.gmail.com>
Message-ID: <r2ld6c5d7291005031051wa34d1199n5f78ef6710237725@mail.gmail.com>

On Tue, May 4, 2010 at 3:10 AM, Johann "Myrkraverk" Oskarsson
<johann at myrkraverk.com> wrote:
>
> Out of sheer curiousity, why is it important to reserve space below 2G
> when there is no preloader?
>

Have to keep the Llamas some where...


From julliard at winehq.org  Mon May  3 13:22:03 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 03 May 2010 20:22:03 +0200
Subject: Why reserve space below 2G without preloader? wrt. patch 1aa749d
	& bug 22033
In-Reply-To: <y2jcb59c2d11005031010hecfcef93y4e3acb4ab812b575@mail.gmail.com>
	(Johann Oskarsson's message of "Mon, 3 May 2010 17:10:40 +0000")
References: <y2jcb59c2d11005031010hecfcef93y4e3acb4ab812b575@mail.gmail.com>
Message-ID: <87iq74zvzo.fsf@wine.dyndns.org>

"Johann \"Myrkraverk\" Oskarsson" <johann at myrkraverk.com> writes:

> Hi all,
>
> Out of sheer curiousity, why is it important to reserve space below 2G
> when there is no preloader?
>
> Patch 1aa749d, is
>
>     libwine: Reserve some low memory space even without a preloader.
>
> has the comment:
>
> /* if we don't have a preloader, try to reserve some space below 2Gb */
>
> and is the regression for bug 22033.
>
> http://bugs.winehq.org/show_bug.cgi?id=22033
>
>
> I will be trying to determine the excact cause of the bug later.

It's needed for apps that look for free space before allocating, instead
of simply accepting the VirtualAlloc return value. .NET is the main
offender.

-- 
Alexandre Julliard
julliard at winehq.org


From philippe.casgrain at transgaming.com  Mon May  3 14:01:10 2010
From: philippe.casgrain at transgaming.com (Philippe Casgrain)
Date: Mon, 3 May 2010 15:01:10 -0400
Subject: [1/2] dlls/crypt32: implement PFXImportCertStore()
In-Reply-To: <3a768c551003251134j7c62fb2k6e4e258c1e6c7eb@mail.gmail.com>
References: <3a768c551003221140w1dc9aa60hef85cb6e43226400@mail.gmail.com>
	<7F39E826-56AE-4A6F-8AD3-0CEFF77F51E2@transgaming.com>
	<3a768c551003250914x533e2673gb0db181da256eda2@mail.gmail.com>
	<D2114FE9-C293-4FDA-AEB8-11EA47B16A49@transgaming.com>
	<3a768c551003251134j7c62fb2k6e4e258c1e6c7eb@mail.gmail.com>
Message-ID: <06F0A0A9-F7C7-44B8-B7B1-99562943A043@transgaming.com>

[Finally have a little bit of downtime, can turn my attention back to this...]

On 2010-03-25, at 2:34 PM, Juan Lang wrote:

>> I don't have any password-protected certificates to test with, so I can't add such a test (it was not required for our implementation).
> 
> You can if you create one (on Windows.)

I do not know how to do that. The motivation behind this patch is to get something of value inside WineHQ so that the implementation of this function can be started. It is possible that we may implement password-protection and private key extraction in the future, or someone else may do it. This would be great for the community. But it's not something that I can do right now.

>> So what you want is to import two new functions (sk_X509_new_null() and sk_X509_free()) and use them to create a STACK_OF(X509) whose sole purpose is to detect if there are more certificates, and then ERR or TRACE if there are, and then dispose?
> 
> No, I suppose not.  A test marked todo_wine would be better.

I don't disagree that this implementation is incomplete. It is, however, much less incomplete than what was there before in the sense of 
> 
>> Ah. In that case, it does not really matter what the string is, right? I can remove it if you don't want it.
> 
> Please do ;)

Unnecessary strings will be removed in the next submission.

The motivation behind this patch is/was to get *something* into WineHQ so that the next time we or someone else needs to work on this, there is a basic skeleton in place. As a bonus, this skeleton actually does something useful (get the certificate using OpenSSL). We know it works and is useful because a now-shipping game is using it.

If the WineHQ community feels that an incomplete implementation is not good enough for a patch submission, that is entirely their prerogative. I would obviously prefer that my patch be (eventually) incorporated, but I understand the reasoning.

Philippe Casgrain
[Again, apologies for the delay, things are just crazy-busy around here...]

From testbot at testbot.winehq.org  Mon May  3 17:25:39 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Tue, 4 May 2010 00:25:39 +0200
Subject: [PATCH 4/5] d3d9/tests: Allow D3DFMT_A2R10G10B10 as supported
	adapter mode. 
Message-ID: <201005032225.o43MPdLq025142@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1890

Your paranoid android.


=== W7PRO (32 bit device) ===
device.c:2442: Test failed: Expected foreground window 00020142, got 00010040.
device.c:2578: Test failed: Expected foreground window 00030142, got 00010040.


From hverbeet at gmail.com  Tue May  4 02:28:03 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Tue, 4 May 2010 09:28:03 +0200
Subject: wined3d: Fix some complaints in d3d9 texture test
In-Reply-To: <4BDFCAFE.9060403@gmail.com>
References: <4BDFCAFE.9060403@gmail.com>
Message-ID: <t2jd658b69e1005040028r747f80a1w5d3a88b9eb33d8b7@mail.gmail.com>

2010/5/4 Ri?ardas Barkauskas <miegalius at gmail.com>:
> Fixes some GL_INVALID_ENUM fixmes in d3d9 texture tests and bug 11167.
>
Why are you setting GL_GENERATE_MIPMAP_SGIS?


From miegalius at gmail.com  Tue May  4 03:25:32 2010
From: miegalius at gmail.com (=?UTF-8?B?UmnEjWFyZGFzIEJhcmthdXNrYXM=?=)
Date: Tue, 04 May 2010 11:25:32 +0300
Subject: wined3d: Fix some complaints in d3d9 texture test
In-Reply-To: <t2jd658b69e1005040028r747f80a1w5d3a88b9eb33d8b7@mail.gmail.com>
References: <4BDFCAFE.9060403@gmail.com>
	<t2jd658b69e1005040028r747f80a1w5d3a88b9eb33d8b7@mail.gmail.com>
Message-ID: <4BDFD9FC.7040708@gmail.com>

On 05/04/2010 10:28 AM, Henri Verbeet wrote:
> 2010/5/4 Ri?ardas Barkauskas<miegalius at gmail.com>:
>> Fixes some GL_INVALID_ENUM fixmes in d3d9 texture tests and bug 11167.
>>
> Why are you setting GL_GENERATE_MIPMAP_SGIS?
>
>

Sorry for spam. Reading bug now gives completely new meaning than in a 
middle of the night (and also enables finding old mails about it). Will 
try to make it this evening to just set the hint and output fixme if app 
sets two different modes. Doing this nicely with glGenerateMipmapEXT 
will most likely be outside my ability.

REalm


From love.nystrom at gmail.com  Tue May  4 04:59:00 2010
From: love.nystrom at gmail.com (Love Nystrom)
Date: Tue, 04 May 2010 16:59:00 +0700
Subject: A revision for common PageSetup dialog
Message-ID: <4BDFEFE4.5020002@gmail.com>

File: dlls\comdlg32\printdlg.c
Function: static void subclass_margin_edits(HWND hDlg)

Hi WineDevs,
I have a revision for the common page setup dialog for You.

I'm not a Wine dev, but a participant in ReactOS, and we synchronize
ComDlg32 with You regularly, so this revision _should_ go to You.
I'll submit the full function, not a patch, since I don't work in
the Wine source tree. The ReactOS sync has a different path, and
most likely line numbers too, so a patch merge would go astray.
I've registered with the wine-patches and wine-devel mailing lists
so You can notify in case You need something else from me.

Since this is not a straight 'diff' mail-body I'll post it here on
wine-devel first, as I'm unsure how You handle wine-patches mail.

Now to the small revision:

This revision adds an error check on the winproc pointer returned
by SetWindowLongPtr(.. GWLP_WNDPROC ..) and fixes a build warning
issued because GCC thinks 'old_proc' is computed but never used..

I assume the reason for repeating the attempt to set 'edit_proc' is
because we're not certain which editors will be present, so there
_should_ be a fail-check on 'old_proc' anyway.

If you _know_ 'edt4' will always be present, it would be better to
move the assign for 'edit_proc' out of the loop, and avoid the
repeated conditional assign.  Both variants are #if'ed in the patch.
Just remove the variant you don't want.

--- code begin ---
static void subclass_margin_edits(HWND hDlg)
{
    int id;
    WNDPROC old_proc;
#if 1
    for(id = edt4; id <= edt7; id++)
    {
        old_proc = (WNDPROC)SetWindowLongPtrW(GetDlgItem(hDlg, id),
                                              GWLP_WNDPROC,
                                              
(ULONG_PTR)pagesetup_margin_editproc);
        /* InterlockedCompareExchangePointer((void**)&edit_wndproc, 
old_proc, NULL); */
        if ((edit_wndproc == NULL) && (old_proc != NULL))
            edit_wndproc = old_proc;
    }
#else
    old_proc = (WNDPROC)
        SetWindowLongPtrW (
            GetDlgItem( hDlg, edt4 ),
            GWLP_WNDPROC, (ULONG_PTR) pagesetup_margin_editproc
            );
    if ((edit_wndproc == NULL) && (old_proc != NULL))
        edit_wndproc = old_proc;

    for( id = edt5; id <= edt7; id++ )
        SetWindowLongPtrW (
            GetDlgItem( hDlg, id ),
            GWLP_WNDPROC, (ULONG_PTR) pagesetup_margin_editproc
            );
#endif
}
--- code end ---

The reason for the build warning is that the definition
of InterlockedCompareExchangePointer() confuses GCC.
It thinks 'old_proc' is computed but never used,
and issues an over-sensitive, even misleading, warning.
It seems like GCC doesn't realize that an intrinsic uses the value.
It would be good to fix InterlockedCompareExchangePointer, or GCC.
Sadly, I can't figure out how to do that.

Best Regards
  Love N



From julliard at winehq.org  Tue May  4 05:56:48 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 04 May 2010 12:56:48 +0200
Subject: [3/3] rundll32: Recognize entry points passed as ordinal numbers.
	(try 2)
In-Reply-To: <4BDF2277.5000108@codeweavers.com> (Andrew Nguyen's message of
	"Mon, 03 May 2010 14:22:31 -0500")
References: <4BDF2277.5000108@codeweavers.com>
Message-ID: <87hbmodjf3.fsf@wine.dyndns.org>

Andrew Nguyen <anguyen at codeweavers.com> writes:

> @@ -119,30 +119,43 @@ static FARPROC16 get_entry_point16( HINSTANCE16 inst, LPCWSTR entry )
>  static void *get_entry_point32( HMODULE module, LPCWSTR entry, BOOL *unicode )
>  {
>      void *ret;
> -    DWORD len = WideCharToMultiByte( CP_ACP, 0, entry, -1, NULL, 0, NULL, NULL );
> -    char *entryA = HeapAlloc( GetProcessHeap(), 0, len + 1 );
> -
> -    if (!entryA)
> -        return NULL;
>  
> -    WideCharToMultiByte( CP_ACP, 0, entry, -1, entryA, len, NULL, NULL );
> +    /* determine if the entry point is an ordinal */
> +    if (entry[0] == '#')
> +    {
> +        int ordinal = atoiW( entry + 1 );
> +        if (ordinal <= 0)
> +            return NULL;

You don't set the unicode flag in this case.

-- 
Alexandre Julliard
julliard at winehq.org


From jordan.ayers at gmail.com  Tue May  4 08:23:30 2010
From: jordan.ayers at gmail.com (Jordan Ayers)
Date: Tue, 4 May 2010 08:23:30 -0500
Subject: Valgrind's wine_cp_wcstombs warnings
Message-ID: <w2v43830d551005040623mb0642af5m5702552a9032e5a8@mail.gmail.com>

> Hi,
>
> running the MCI tests with Valgrind generates a lot of output like follows
>
> ==13170== Use of uninitialised value of size 4
> ==13170==    at 0x4035369: wine_cp_wcstombs (wctomb.c:147)
> ...[every line from 148 to 161]
> ==13170== Use of uninitialised value of size 4
> ==13170==    at 0x403550A: wine_cp_wcstombs (wctomb.c:162)
>
> I suspect the A<->W mapping is still not fully correct (I know at
> least one more case, but I'm not sure it gets triggered by the tests)
> but perhaps it's also the W->UNIX.UTF-8 conversions internal to Wine
> which cause these hits.  How do I tell?
>
> Is there any way to get more precise reporting for the above messages
> (e.g. a backtrace)?  The present output is not helpful at identifying
> the origin of the uninitialised read.
>
> Perhaps Valgrind is broken? Why does it mention "size 4" when all
> access in the offending function is either "char *" or "short *"
> according to the source
> http://source.winehq.org/source/libs/wine/wctomb.c#L145 ?
>
> Thanks for your help,
> 	J?rg H?hle

Joerg,
    If you're on a 32-bit system, your pointers would be where the
'size 4' is coming from.  It looks like Valgrind thinks a pointer
being dereferenced isn't initialized.  (maybe src?)

Jordan Ayers


From Joerg-Cyril.Hoehle at t-systems.com  Tue May  4 08:34:49 2010
From: Joerg-Cyril.Hoehle at t-systems.com (Joerg-Cyril.Hoehle at t-systems.com)
Date: Tue, 4 May 2010 15:34:49 +0200
Subject: Valgrind's wine_cp_wcstombs warnings
References: <u2ya71bd89a1005030632ndf33566g749325adb9a7da8e@mail.gmail.com>
Message-ID: <47CC5ABB01651443A88DB8EC5B4D657B740354@S4DE8PSAANK.mitte.t-com.de>

Hi,

Dan Kegel wrote:
>did you try the --track-origins option?
That looks like an exact fit, thank you.

Well, this option is not present in Ubuntu Intrepid's Valgrind.
In Ubuntu Lucid, the option is present but Valgrind does not
 complain about wine_cp_wcstombs there.
I conclude it was likely a false alarm due to a bug in old Valgrind.

Regards,
 J?rg H?hle


From johann at myrkraverk.com  Tue May  4 11:17:55 2010
From: johann at myrkraverk.com (Johann "Myrkraverk" Oskarsson)
Date: Tue, 4 May 2010 16:17:55 +0000
Subject: What is the point of mincore() in reserve_area() in libs/wine/mmap.c?
Message-ID: <s2gcb59c2d11005040917u62432f8fvd49167bc4fbbe225@mail.gmail.com>

Hi all,

In the Solaris/BSD implementation of reserve_area() in libs/wine/mmap.c there is

        for (i = 0; i < size; i += pagesize)
            if (mincore( (caddr_t)addr + i, pagesize, &vec ) != -1) break;

&vec is never used again in that function.  What is the point of mincore() ?

I'm looking at this in reference to bug 22033.


Johann


From cdavis at mymail.mines.edu  Tue May  4 11:22:44 2010
From: cdavis at mymail.mines.edu (Charles Davis)
Date: Tue, 04 May 2010 10:22:44 -0600
Subject: What is the point of mincore() in reserve_area() in
	libs/wine/mmap.c?
In-Reply-To: <s2gcb59c2d11005040917u62432f8fvd49167bc4fbbe225@mail.gmail.com>
References: <s2gcb59c2d11005040917u62432f8fvd49167bc4fbbe225@mail.gmail.com>
Message-ID: <4BE049D4.7010803@mymail.mines.edu>

On 5/4/10 10:17 AM, Johann "Myrkraverk" Oskarsson wrote:
> Hi all,
> 
> In the Solaris/BSD implementation of reserve_area() in libs/wine/mmap.c there is
> 
>         for (i = 0; i < size; i += pagesize)
>             if (mincore( (caddr_t)addr + i, pagesize, &vec ) != -1) break;
> 
> &vec is never used again in that function.  What is the point of mincore() ?
It's trying to see if the address is valid. From the manpage:

RETURN VALUES
     Upon successful completion, a value of 0 is returned.  Otherwise,
     a value of -1 is returned and errno is set to indicate the error.

ERRORS
     [EINVAL]           addr is not a valid address for user mode.

     [EFAULT]           an error occurred trying to copy to the output
                        character array vec.

vec is to make sure it failed because the address was invalid, not
because it couldn't write the flags out.

Chip


From julliard at winehq.org  Tue May  4 11:34:41 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 04 May 2010 18:34:41 +0200
Subject: gdi32: Fix underline and strikeout for clipped to the rectangle
	text
In-Reply-To: <201004301438.18022.shpigor@etersoft.ru> (Ilya Shpigor's message
	of "Fri, 30 Apr 2010 14:38:17 +0400")
References: <201004301438.18022.shpigor@etersoft.ru>
Message-ID: <87r5lrd3ry.fsf@wine.dyndns.org>

Ilya Shpigor <shpigor at etersoft.ru> writes:

> There is bug with underline and strikeout font in ExtTextOutW.
>
> The text is clipped if the ETO_CLIPPED flag have been set and rectangle 
> smaller then needed for text. But underline and strikeout lines is drawed 
> same as when text fit in the rectangle.
>
> The problem screenshot (wine below):
> http://bugs.etersoft.ru/attachment.cgi?id=1678
>
> I suggest to check if the y coordinate of line is smaller then text rectangle 
> bottom.

That's of course not sufficient for correct clipping.

-- 
Alexandre Julliard
julliard at winehq.org


From austinenglish at gmail.com  Tue May  4 13:52:45 2010
From: austinenglish at gmail.com (Austin English)
Date: Tue, 4 May 2010 13:52:45 -0500
Subject: [12/13]docs/wineusr: unix paths are supported
In-Reply-To: <4BE06BE0.9060303@dawncrow.de>
References: <4BE06BE0.9060303@dawncrow.de>
Message-ID: <t2gb6bb06271005041152v12820c49y81000c1128c80735@mail.gmail.com>

2010/5/4 Andr? Hentschel <nerv at dawncrow.de>:
> ---
> ?en/wineusr-running.sgml | ? ?8 ++++++--
> ?1 files changed, 6 insertions(+), 2 deletions(-)
>
> diff --git a/en/wineusr-running.sgml b/en/wineusr-running.sgml
> index f36383f..106be37 100644
> --- a/en/wineusr-running.sgml
> +++ b/en/wineusr-running.sgml
> @@ -90,8 +90,8 @@ Usage: wine PROGRAM [ARGUMENTS...] ? Run the specified program
> ? ? ? ? in the <parameter>Path</parameter> environment variable, you can
> ? ? ? ? simply give the executable file name. However, if the executable
> ? ? ? ? is not in <parameter>Path</parameter>, you must give the full path to
> - ? ? ? ?the executable (in Windows format, not UNIX format!). ?For
> - ? ? ? ?example, given a <parameter>Path</parameter> of the following:
> + ? ? ? ?the executable. ?For example, given a <parameter>Path</parameter>
> + ? ? ? ?of the following:
> ? ? ? </para>
> ? ? ? <screen>
> ?Path="c:\windows;c:\windows\system;e:\;e:\test;f:\"
> @@ -112,7 +112,11 @@ Path="c:\windows;c:\windows\system;e:\;e:\test;f:\"
> ? ? ? </screen>
> ? ? ? <para>
> ? ? ? (note the backslash-escaped "\" !)
> + ? ? ?or:
> ? ? ? </para>
> + ? ? ?<screen>
> +<prompt>$</prompt> <userinput>wine ~/.wine/drive_c/myapps/foo.exe</userinput>
> + ? ? ?</screen>
> ? ? ? <para>
> ? ? ? ?For details on running text mode (CUI) executables, read the
> ? ? ? ?<link linkend="CUI-programs">section</link> below.
> --

A lot of programs break when using Unix paths. I don't think we should
encourage it.

Perhaps instead put an example using wine start /unix.

-- 
-Austin


From julliard at winehq.org  Tue May  4 14:16:52 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 04 May 2010 21:16:52 +0200
Subject: [12/13]docs/wineusr: unix paths are supported
In-Reply-To: <t2gb6bb06271005041152v12820c49y81000c1128c80735@mail.gmail.com>
	(Austin English's message of "Tue, 4 May 2010 13:52:45 -0500")
References: <4BE06BE0.9060303@dawncrow.de>
	<t2gb6bb06271005041152v12820c49y81000c1128c80735@mail.gmail.com>
Message-ID: <87k4rjcw9n.fsf@wine.dyndns.org>

Austin English <austinenglish at gmail.com> writes:

>> diff --git a/en/wineusr-running.sgml b/en/wineusr-running.sgml
>> index f36383f..106be37 100644
>> --- a/en/wineusr-running.sgml
>> +++ b/en/wineusr-running.sgml
>> @@ -90,8 +90,8 @@ Usage: wine PROGRAM [ARGUMENTS...] ? Run the specified program
>> ? ? ? ? in the <parameter>Path</parameter> environment variable, you can
>> ? ? ? ? simply give the executable file name. However, if the executable
>> ? ? ? ? is not in <parameter>Path</parameter>, you must give the full path to
>> - ? ? ? ?the executable (in Windows format, not UNIX format!). ?For
>> - ? ? ? ?example, given a <parameter>Path</parameter> of the following:
>> + ? ? ? ?the executable. ?For example, given a <parameter>Path</parameter>
>> + ? ? ? ?of the following:
>> ? ? ? </para>
>> ? ? ? <screen>
>> ?Path="c:\windows;c:\windows\system;e:\;e:\test;f:\"
>> @@ -112,7 +112,11 @@ Path="c:\windows;c:\windows\system;e:\;e:\test;f:\"
>> ? ? ? </screen>
>> ? ? ? <para>
>> ? ? ? (note the backslash-escaped "\" !)
>> + ? ? ?or:
>> ? ? ? </para>
>> + ? ? ?<screen>
>> +<prompt>$</prompt> <userinput>wine ~/.wine/drive_c/myapps/foo.exe</userinput>
>> + ? ? ?</screen>
>> ? ? ? <para>
>> ? ? ? ?For details on running text mode (CUI) executables, read the
>> ? ? ? ?<link linkend="CUI-programs">section</link> below.
>> --
>
> A lot of programs break when using Unix paths. I don't think we should
> encourage it.

There's no difference between specifying the path in Windows or Unix
format. The current directory may be an issue, but that's true in both
cases.

-- 
Alexandre Julliard
julliard at winehq.org


From elanz1615 at yahoo.com  Tue May  4 14:30:19 2010
From: elanz1615 at yahoo.com (eric lanz)
Date: Tue, 4 May 2010 12:30:19 -0700 (PDT)
Subject: Winebuild b0rken on Mac OS X?
In-Reply-To: <4BCDFED4.40102@mymail.mines.edu>
References: <4BCDFED4.40102@mymail.mines.edu>
Message-ID: <521385.75257.qm@web63705.mail.re1.yahoo.com>

FYI wine can be built again with the iphone sdk beta 3 that came out today.




________________________________
From: Charles Davis <cdavis at mymail.mines.edu>
To: wine-devel <wine-devel at winehq.org>
Sent: Tue, April 20, 2010 3:21:56 PM
Subject: Winebuild b0rken on Mac OS X?

While building Wine (latest git) on Mac OS X, I noticed this:

/usr/bin/nm: object: amstream_test.MDsdpi.o malformed object (LC_SEGMENT
command 0 filesize field greater than vmsize field)
Undefined symbols:
  "_GetDesktopWindow", referenced from:
      _func_amstream in amstream.o
  "_TlsGetValue", referenced from:
      _get_tls_data in testlist.o
  "_MultiByteToWideChar", referenced from:
      _func_amstream in amstream.o
      _func_amstream in amstream.o
  "_CloseHandle", referenced from:
      _func_amstream in amstream.o
  "_TlsSetValue", referenced from:
      _get_tls_data in testlist.o
  "_DirectDrawCreate", referenced from:
      _func_amstream in amstream.o
  "_CoCreateInstance", referenced from:
      _create_ammultimediastream in amstream.o
  "_WaitForSingleObject", referenced from:
      _winetest_wait_child_process in testlist.o
  "_CoInitializeEx", referenced from:
      _func_amstream in amstream.o
  "_HeapAlloc", referenced from:
      _get_tls_data in testlist.o
  "_CoUninitialize", referenced from:
      _func_amstream in amstream.o
      _func_amstream in amstream.o
  "_GetExitCodeProcess", referenced from:
      _winetest_wait_child_process in testlist.o
  "_GetEnvironmentVariableA", referenced from:
      _main in testlist.o
      _main in testlist.o
      _main in testlist.o
      _main in testlist.o
  "_ExitProcess", referenced from:
      _exit_process in testlist.o
      ___wine_spec_exe_entry in libwinecrt0.a(exe_entry.o)
  "_CreateFileA", referenced from:
      _func_amstream in amstream.o
      _func_amstream in amstream.o
  "_TlsAlloc", referenced from:
      _run_test in testlist.o
ld: symbol(s) not found
collect2: ld returned 1 exit status
winegcc: gcc failed
make[1]: *** [amstream_test.exe.so] Error 2
make: *** [dlls/amstream/tests] Error 2

Something's gone horribly wrong. Winebuild shouldn't be generating
b0rken Mach-O files. What gives?


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100504/783e30fe/attachment.htm>

From julliard at winehq.org  Tue May  4 14:50:46 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 04 May 2010 21:50:46 +0200
Subject: [PATCH 1/2] tools: Added a script to build BMPs from SVGs
In-Reply-To: <1273001113.30755.9.camel@joel-desktop> (Joel Holdsworth's
	message of "Tue, 04 May 2010 20:25:13 +0100")
References: <1273001113.30755.9.camel@joel-desktop>
Message-ID: <87eihrcup5.fsf@wine.dyndns.org>

Joel Holdsworth <joel at airwebreathe.org.uk> writes:

> Signed-off-by: Joel Holdsworth <joel at airwebreathe.org.uk>
> ---
>  Make.rules.in     |    5 +--
>  tools/buildbitmap |   90 +++++++++++++++++++++++++++++++++++++++++++++++++++++
>  2 files changed, 92 insertions(+), 3 deletions(-)
>  create mode 100755 tools/buildbitmap

This could go in the buildicon script, most of the code is the same.

-- 
Alexandre Julliard
julliard at winehq.org


From dank at kegel.com  Tue May  4 17:01:49 2010
From: dank at kegel.com (Dan Kegel)
Date: Tue, 4 May 2010 15:01:49 -0700
Subject: More benchmarks of 3d performance comparing windows and linux
Message-ID: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>

http://kegel.com/wine/yagmarkdata/ now has data from 3dmark2000, 2001, and
06
running on a beefy i7 960 with an equally beefy Nvidia GTX 295 with either
Windows 7 or Linux+Wine
(all tests run at 1024x768).

Here are the results of one run for each plucked at random (sorry, no
breakdown of 3dmark06 results yet):


Win 7                Wine        units
3dmark2000_3DMark_Result:                        39587       26278   3Dmarks
3dmark2000_CPU_Speed:                            1269        1276
CPU_3Dmarks
3dmark2000_Game_1_Helicopter_Low_Detail:         689.7       415.2   FPS
3dmark2000_Game_1_Helicopter_Medium_Detail:      526.8       319.4   FPS
3dmark2000_Game_1_Helicopter_High_Detail:        412.1       260.1   FPS
3dmark2000_Game_2_Adventure_Low_Detail:          981.2       648.4   FPS
3dmark2000_Game_2_Adventure_Medium_Detail:       429.0       334.9   FPS
3dmark2000_Game_2_Adventure_High_Detail:         260.2       211.8   FPS

3dmark2001_3DMark_Score                          46297       28194   3DMarks
3dmark2001_Game_1_Car_Chase_Low_Detail           551.3       314.6   fps
3dmark2001_Game_1_Car_Chase_High_Detail          111.5       133.0   fps
3dmark2001_Game_2_Dragothic_Low_Detail           678.0       462.2   fps
3dmark2001_Game_2_Dragothic_High_Detail          399.6       184.2   fps
3dmark2001_Game_3_Lobby_Low_Detail               602.7       371.5   fps
3dmark2001_Game_3_Lobby_High_Detail              294.0       135.5   fps
3dmark2001_Game_4_Nature                         593.9       382.9   fps

3DMark06_result:                                 21519       6038    3dmarks

This might not be all that useful on its own, but once I have daily
automatic runs going,
it ought to be helpful in looking for performance regressions.

These results are probably only accurate to +- 5%.  Later on I'll do
multiple runs
and compute the median to reduce the noise level.

Notes:

On really big screens, at least under wine, 3dmark2000 seems to lose its
mind and put up a warning
dialog behind the main window (thus hanging the test).  I had to set the
screen size down to something
closer to 1024x768 for it to calm down and run the benchmark.

3dmark2000 and 3dmark2001 need to be run in xp compatibility mode
on Windows 7, or they complain of insufficient memory.

Again, this was done by running
http://code.google.com/p/winezeug/source/browse/trunk/yagmark
- Dan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100504/cd38f762/attachment.htm>

From anguyen at codeweavers.com  Mon May  3 10:48:24 2010
From: anguyen at codeweavers.com (Andrew Nguyen)
Date: Mon, 03 May 2010 10:48:24 -0500
Subject: [2/5] rundll32: Fail if a rundll32 window cannot be created.
In-Reply-To: <87mxwhypw6.fsf@wine.dyndns.org>
References: <4BDCFAB2.8030109@codeweavers.com> <87mxwhypw6.fsf@wine.dyndns.org>
Message-ID: <4BDEF048.9000609@codeweavers.com>

On 05/03/2010 10:19 AM, Alexandre Julliard wrote:
> Andrew Nguyen<anguyen at codeweavers.com>  writes:
>
>> ---
>>    programs/rundll32/rundll32.c |   16 +++++++++++++---
>>    1 files changed, 13 insertions(+), 3 deletions(-)
>
> This will prevent initializing the prefix without an X display. Why do
> you need this?
>

I simply wrote this in the interest of "error checking"; there wasn't 
any particular reason for this patch. You're right, I'll re-send the 
series with this patch dropped.


From Joakim.Tjernlund at transmode.se  Mon May  3 13:44:33 2010
From: Joakim.Tjernlund at transmode.se (Joakim Tjernlund)
Date: Mon, 3 May 2010 20:44:33 +0200
Subject: [PATCH] RegisterWaitForSingleObject() fix special tmo == 0 case.
Message-ID: <1272912273-29615-1-git-send-email-Joakim.Tjernlund@transmode.se>

At http://msdn.microsoft.com/en-us/library/aa332406%28VS.71%29.aspx one
can read:
"If the timeOutInterval parameter is not zero (0) and the executeOnlyOnce
parameter is false, the timer is reset every time the event is signaled
or the time-out interval elapses."

timeOutInterval == 0 makes the above false and the timer should NOT
be reset, fix that.

Signed-off-by: Joakim Tjernlund <Joakim.Tjernlund at transmode.se>
---

 Forget the earlier patches, this feels like the right fix.

 dlls/ntdll/threadpool.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/dlls/ntdll/threadpool.c b/dlls/ntdll/threadpool.c
index 44afb01..f6c9fb4 100644
--- a/dlls/ntdll/threadpool.c
+++ b/dlls/ntdll/threadpool.c
@@ -377,7 +377,8 @@ static DWORD CALLBACK wait_thread_proc(LPVOID Arg)
             wait_work_item->Callback( wait_work_item->Context, TimerOrWaitFired );
             wait_work_item->CallbackInProgress = FALSE;
 
-            if (wait_work_item->Flags & WT_EXECUTEONLYONCE)
+            if (!wait_work_item->Milliseconds ||
+                wait_work_item->Flags & WT_EXECUTEONLYONCE)
                 break;
         }
         else
-- 
1.6.4.4



From joakim.tjernlund at transmode.se  Tue May  4 05:09:44 2010
From: joakim.tjernlund at transmode.se (Joakim Tjernlund)
Date: Tue, 4 May 2010 12:09:44 +0200
Subject: Trying again
Message-ID: <OF8016F421.1FD40BF2-ONC1257719.0037A2DF-C1257719.0037D2AA@transmode.se>


This didn't show up in the archives, so trying again.


From Joakim.Tjernlund at transmode.se  Mon May  3 13:30:32 2010
From: Joakim.Tjernlund at transmode.se (Joakim Tjernlund)
Date: Mon, 3 May 2010 20:30:32 +0200
Subject: [PATCH] RegisterWaitForSingleObject() fix special tmo == 0 case.
Message-ID: <mailman.403.1273012205.27605.wine-devel@winehq.org>

At http://msdn.microsoft.com/en-us/library/aa332406%28VS.71%29.aspx one
can read:
"If the timeOutInterval parameter is not zero (0) and the executeOnlyOnce
parameter is false, the timer is reset every time the event is signaled
or the time-out interval elapses."

timeOutInterval == 0 makes the above false and the timer should NOT
be reset, fix that.

Signed-off-by: Joakim Tjernlund <Joakim.Tjernlund at transmode.se>
---
 dlls/ntdll/threadpool.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/dlls/ntdll/threadpool.c b/dlls/ntdll/threadpool.c
index 44afb01..f6c9fb4 100644
--- a/dlls/ntdll/threadpool.c
+++ b/dlls/ntdll/threadpool.c
@@ -377,7 +377,8 @@ static DWORD CALLBACK wait_thread_proc(LPVOID Arg)
             wait_work_item->Callback( wait_work_item->Context, TimerOrWaitFired );
             wait_work_item->CallbackInProgress = FALSE;

-            if (wait_work_item->Flags & WT_EXECUTEONLYONCE)
+            if (!wait_work_item->Milliseconds ||
+                wait_work_item->Flags & WT_EXECUTEONLYONCE)
                 break;
         }
         else
--
1.6.4.4




From wylda at volny.cz  Tue May  4 13:12:05 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Tue, 04 May 2010 20:12:05 +0200 (CEST)
Subject: Stack corruption in dsound.c
Message-ID: <c30677fe3726c78303c3ac764b9c8bb7@www3-mail.volny.cz>

Hi, for those of readers who don't know yet, i'm a "Hello word" programmer,
so sorry for bad wording or speculation etc.

I decided to look into a regression since wine 1.1.30, who nobody apparently
not know what to do, otherwise it would be solved ;)

The game freezes during sound initialization and i tracked it down by
printf debugging to heap allocation in DirectSoundDevice_Create(). Game
goes:

...
DirectSoundDevice_Create() //HeapAlloc OK
...
OpenAL Init
...
DirectSoundDevice_Create() //HeapAlloc returns insane values
...
fixme:dbghelp:validate_addr64 Unsupported address ffffffffb5e70000
fixme:dbghelp:validate_addr64 Unsupported address ffffffffb5a60000
fixme:dbghelp:validate_addr64 Unsupported address ffffffffb5a40000
fixme:dbghelp:validate_addr64 Unsupported address ffffffffb5950000
fixme:dbghelp:validate_addr64 Unsupported address ffffffffb5940000
fixme:dbghelp:validate_addr64 Unsupported address ffffffffb5920000
Frozen

This happens only when builtin OpenAL is used. In this case HeapAlloc
gives values always beginning with 0x234vwxyz.

Builtin OpenAL example (*** BAD - Game freezes ***):
device = HeapAlloc(GetProcessHeap(),HEAP_ZERO_MEMORY,sizeof(DirectSoundDevice));

First call of DirectSoundDevice_Create():
0x0014f908 = HeapAlloc(0x00110000, 0x00000008, 0x000003d4)

Second call of DirectSoundDevice_Create():
0x234228e0 = HeapAlloc(0x00110000, 0x00000008, 0x000003d4)



Native OpenAL example(*** OK - Game runs***):

First call of DirectSoundDevice_Create():
0x0014fa30 = HeapAlloc(0x00110000, 0x00000008, 0x000003d4)

Second call of DirectSoundDevice_Create():
0x001566c0 = HeapAlloc(0x00110000, 0x00000008, 0x000003d4)


So how do i find out, why HeapAlloc does not return sane values like
in first call of DirectSoundDevice_Create()?




From cdavis at mymail.mines.edu  Tue May  4 17:31:22 2010
From: cdavis at mymail.mines.edu (Charles Davis)
Date: Tue, 04 May 2010 16:31:22 -0600
Subject: RegisterWaitForSingleObject() fix special tmo == 0 case.
In-Reply-To: <OF3E9548ED.26808B7B-ONC1257719.002123B6-C1257719.0021965B@transmode.se>
References: <OF3E9548ED.26808B7B-ONC1257719.002123B6-C1257719.0021965B@transmode.se>
Message-ID: <4BE0A03A.6050103@mymail.mines.edu>

On 5/4/10 12:06 AM, Joakim Tjernlund wrote:
> 
> Here are two versions 
Generally, it's a bad idea to put two patches in one mail. You should
instead have two separate emails, one for each patch.

Chip


From juan.lang at gmail.com  Tue May  4 17:35:55 2010
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 4 May 2010 15:35:55 -0700
Subject: Stack corruption in dsound.c
In-Reply-To: <c30677fe3726c78303c3ac764b9c8bb7@www3-mail.volny.cz>
References: <c30677fe3726c78303c3ac764b9c8bb7@www3-mail.volny.cz>
Message-ID: <u2h3a768c551005041535ic7275578rcf6d4421a31e82c4@mail.gmail.com>

> So how do i find out, why HeapAlloc does not return sane values like
> in first call of DirectSoundDevice_Create()?

Sounds like heap corruption.  Try using valgrind to see if there are
memory errors before the second call to DirectSoundDevice_Create().
--Juan


From testbot at testbot.winehq.org  Tue May  4 19:06:16 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Wed, 5 May 2010 02:06:16 +0200
Subject: kernel32/tests: Remove variable len which is not really used from
	test_CommandLine. 
Message-ID: <201005050006.o4506GEx028264@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1901

Your paranoid android.


=== W98SE (32 bit process) ===
Failure running script in VM: Exceeded timeout limit of 315 sec


From testbot at testbot.winehq.org  Tue May  4 19:17:14 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Wed, 5 May 2010 02:17:14 +0200
Subject: user32/tests: Remove variable hdata which is not really used from
	test_initialisation. 
Message-ID: <201005050017.o450HE1j028502@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1902

Your paranoid android.


=== W98SE (32 bit dde) ===
dde.c:586: Test failed: Expected TestDDEServer(, got TestDDEServer:(04dc)
dde.c:588: Test failed: Got size 20 for TestDDEServer:(04dc)
dde.c:934: Test failed: Expected 0, got 0000c1ae
dde.c:737: Test failed: Expected '[BadCommand(Var)]', got [Command-2(Var)]
dde.c:738: Test failed: Expected 18, got 32
dde.c:714: Test failed: Expected 9 or 11, got 12
dde.c:939: Test failed: Expected item atom, got 00000000
dde.c:939: Test failed: Expected item atom, got 008307f4
dde.c:812: Test failed: client failed with 14 error(s)
dde.c:2040: Test failed: Expected 0xdeadbeef, got 00000083


From jjmckenzie51 at earthlink.net  Tue May  4 22:41:20 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Tue, 04 May 2010 20:41:20 -0700
Subject: Trying again
In-Reply-To: <OF8016F421.1FD40BF2-ONC1257719.0037A2DF-C1257719.0037D2AA@transmode.se>
References: <OF8016F421.1FD40BF2-ONC1257719.0037A2DF-C1257719.0037D2AA@transmode.se>
Message-ID: <4BE0E8E0.8070903@earthlink.net>

Joakim Tjernlund wrote:
> This didn't show up in the archives, so trying again.
>
> >From 7882df972ec827f0e7b7b622c01be2644e54d122 Mon Sep 17 00:00:00 2001
> From: Joakim Tjernlund <Joakim.Tjernlund at transmode.se>
> Date: Mon, 3 May 2010 20:30:32 +0200
> Subject: [PATCH] RegisterWaitForSingleObject() fix special tmo == 0 case.
>
> At http://msdn.microsoft.com/en-us/library/aa332406%28VS.71%29.aspx one
> can read:
> "If the timeOutInterval parameter is not zero (0) and the executeOnlyOnce
> parameter is false, the timer is reset every time the event is signaled
> or the time-out interval elapses."
>
> timeOutInterval == 0 makes the above false and the timer should NOT
> be reset, fix that.
>
> Signed-off-by: Joakim Tjernlund <Joakim.Tjernlund at transmode.se>
>
>   
[Patch removed ]

Joakim:

Do you want comments on your patch or do you want it incorporated into 
the Wine base code?

If you want it incorporated into the Wine base code, it needs to go to 
Wine-Patches, not Wine-Devel.

If you want comments on it, you should prefix the title with [RFC] and 
in your message ask for comments.

James McKenzie
>
>   



From wylda at volny.cz  Tue May  4 18:39:42 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Wed, 05 May 2010 01:39:42 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_Stack_corruption_in_dsound.c?=
In-Reply-To: <u2h3a768c551005041535ic7275578rcf6d4421a31e82c4@mail.gmail.com>
References: <c30677fe3726c78303c3ac764b9c8bb7@www3-mail.volny.cz>
	<u2h3a768c551005041535ic7275578rcf6d4421a31e82c4@mail.gmail.com>
Message-ID: <18d56ae9d31b56cd812448e48b5fcee6@www3-mail.volny.cz>


So after next few hours of "debuging my way" (HeapAlloc + printf + HeapFree)
and bisecting where HeapAlloc is OK and where isn't i come to conclusion,
that there is someting bad with wined3d_mutex_unlock(), i.e. it looks
like pure luck, that the game runs with native openal32 and freezes
with builtin openal32.

void WINAPI wined3d_mutex_unlock(void)
{
"HeapAlloc + printf_before + HeapFree"

LeaveCriticalSection(&wined3d_cs);

"HeapAlloc + printf_after + HeapFree" <--- ** BAD in #274 **
}

During the initialization, the game enters wined3d_mutex_unlock() a lot
of time, but when the number of entering reaches 274, print_before says
allocated OK, but printf_after shows the insane address.

To be precise:

#271 before wined3d_mutex_lock(), 0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0
#271 after wined3d_mutex_lock(),  0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0

#270 before wined3d_mutex_unlock(), 0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0
#270 after wined3d_mutex_unlock(),  0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0

#271 before wined3d_mutex_unlock(), 0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0
#271 after wined3d_mutex_unlock(),  0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0

#272 before wined3d_mutex_lock(), 0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0
#272 after wined3d_mutex_lock(),  0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0

#272 before wined3d_mutex_unlock(), 0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0
#272 after wined3d_mutex_unlock(),  0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0

#273 before wined3d_mutex_lock(), 0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0
#273 after wined3d_mutex_lock(),  0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0

#273 before wined3d_mutex_unlock(), 0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0
#273 after wined3d_mutex_unlock(),  0x0020a118=HeapAlloc(), &wined3d_cs=0x7e22fda0

#274 before wined3d_mutex_lock(), 0x0020a130=HeapAlloc(), &wined3d_cs=0x7e22fda0
#274 after wined3d_mutex_lock(),  0x0020a130=HeapAlloc(), &wined3d_cs=0x7e22fda0

#275 before wined3d_mutex_lock(), 0x0020a2b0=HeapAlloc(), &wined3d_cs=0x7e22fda0
#275 after wined3d_mutex_lock(),  0x0020a2b0=HeapAlloc(), &wined3d_cs=0x7e22fda0

#274 before wined3d_mutex_unlock(), 0x0020a3f0=HeapAlloc(), &wined3d_cs=0x7e22fda0
#274 after wined3d_mutex_unlock(),  0x18fa7048=HeapAlloc(), &wined3d_cs=0x7e22fda0
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Any suggestion?

> Juan Lang:
> 
> Sounds like heap corruption.  Try using valgrind to see if there are
> > memory errors before the second call to DirectSoundDevice_Create().
> > --Juan

It's bug 20799. I already attached several valgrind logs there, but unfortunately
valgrind does not survives and dies under Mirror's Edge.




From trisk at opensolaris.org  Tue May  4 19:20:55 2010
From: trisk at opensolaris.org (Albert Lee)
Date: Tue, 04 May 2010 20:20:55 -0400
Subject: What is the point of mincore() in =?UTF-8?Q?reserve=5Farea=28?=
	=?UTF-8?Q?=29=20in=20libs/wine/mmap=2Ec=3F?=
In-Reply-To: <4BE049D4.7010803@mymail.mines.edu>
References: <s2gcb59c2d11005040917u62432f8fvd49167bc4fbbe225@mail.gmail.com>
	<4BE049D4.7010803@mymail.mines.edu>
Message-ID: <b727fe55a3815e7f81d6b1efa0628ca3@quasarnet.org>

On Tue, 04 May 2010 10:22:44 -0600, Charles Davis
<cdavis at mymail.mines.edu> wrote:
> On 5/4/10 10:17 AM, Johann "Myrkraverk" Oskarsson wrote:
>> Hi all,
>> 
>> In the Solaris/BSD implementation of reserve_area() in libs/wine/mmap.c
>> there is
>> 
>>         for (i = 0; i < size; i += pagesize)
>>             if (mincore( (caddr_t)addr + i, pagesize, &vec ) != -1)
>>             break;
>> 
>> &vec is never used again in that function.  What is the point of
>> mincore() ?
> It's trying to see if the address is valid. From the manpage:
> 
> RETURN VALUES
>      Upon successful completion, a value of 0 is returned.  Otherwise,
>      a value of -1 is returned and errno is set to indicate the error.
> 
> ERRORS
>      [EINVAL]           addr is not a valid address for user mode.
> 
>      [EFAULT]           an error occurred trying to copy to the output
>                         character array vec.
> 
> vec is to make sure it failed because the address was invalid, not
> because it couldn't write the flags out.
> 
> Chip

It's a clever, though stop-the-world expensive way to determine which
areas of the address space already have mappings present so MAP_FIXED can
be used without accidentally clobbering another mapping. The strategy
probably should be revisited for OpenSolaris since mmap now accepts an
address hint.

-Albert



From hverbeet at gmail.com  Wed May  5 03:26:47 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Wed, 5 May 2010 10:26:47 +0200
Subject: wined3d: Remove variable blue_shift which is not really used from
	IWineGDISurfaceImpl_SaveSnapshot. (RESEND)
In-Reply-To: <alpine.LSU.1.99.1005041715120.18670@pulcherrima.dbai.tuwien.ac.at>
References: <alpine.LSU.1.99.1005041715120.18670@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <k2kd658b69e1005050126zf250b984qd88b37554ebfe6ce@mail.gmail.com>

On 5 May 2010 00:24, Gerald Pfeifer <gerald at pfeifer.com> wrote:
> I didn't see any response, directly or on wine-devel, so I assume
> this one just fell through the cracks; thus resending (now in git
> format-patch format and proper Subject).
>
It probably should be used. At first sight it looks like that's not
the only issue with that function though.


From julliard at winehq.org  Wed May  5 03:56:08 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 05 May 2010 10:56:08 +0200
Subject: wined3d: Remove variable blue_shift which is not really used from
	IWineGDISurfaceImpl_SaveSnapshot. (RESEND)
In-Reply-To: <alpine.LSU.1.99.1005041715120.18670@pulcherrima.dbai.tuwien.ac.at>
	(Gerald Pfeifer's message of "Wed, 5 May 2010 00:24:14 +0200 (CEST)")
References: <alpine.LSU.1.99.1005041715120.18670@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <8739y6n2vr.fsf@wine.dyndns.org>

Gerald Pfeifer <gerald at pfeifer.com> writes:

> I didn't see any response, directly or on wine-devel, so I assume
> this one just fell through the cracks; thus resending (now in git
> format-patch format and proper Subject).

It's very unlikely that we'd want to use red and green but not blue...

-- 
Alexandre Julliard
julliard at winehq.org


From m.b.lankhorst at gmail.com  Wed May  5 08:44:44 2010
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Wed, 5 May 2010 15:44:44 +0200
Subject: [rfc] server: Use rtkit to set realtime priority, try 3
Message-ID: <p2yb130c85e1005050644j6e126e1fwfe5aa94faa25eef1@mail.gmail.com>

---

Hi gus,

Thought I'd try again :) This is a cleaned up version. The license on
rtkit.c will still have to change, but since it's so heavily modified
to get it into a shape for wine, that only a few lines in
make_realtime are still original, so it would be easy to rewrite the
remainder of that function to get it fully lgplv2.1.

See also https://tango.0pointer.de/pipermail/pulseaudio-discuss/2010-May/007058.html

Are there any issues left, or shall I submit this one to wine-patches
after the patch linked above is merged into rtkit.git ?

Cheers,
Maarten
-------------- next part --------------
From 9e494e4a1587cc07752897a787f626b99f711756 Mon Sep 17 00:00:00 2001
From: Maarten Lankhorst <m.b.lankhorst at gmail.com>
Date: Fri, 23 Apr 2010 23:21:37 +0200
Subject: [PATCH 03/10] server: Use rtkit to set realtime priority, try 3

---
 configure           |  117 ++++++++++++++++++++++++--------
 configure.ac        |   41 +++++++++---
 include/config.h.in |    3 +
 libs/wine/loader.c  |   27 +++++++
 server/Makefile.in  |    2 +
 server/rtkit.c      |  187 +++++++++++++++++++++++++++++++++++++++++++++++++++
 server/thread.c     |   16 +++++
 7 files changed, 354 insertions(+), 39 deletions(-)
 create mode 100644 server/rtkit.c

diff --git a/configure b/configure
index 52410fb..d732d9d 100755
--- a/configure
+++ b/configure
@@ -634,6 +634,7 @@ gphoto2_devel
 SANEINCL
 sane_devel
 GNUTLSINCL
+DBUSINCL
 HALINCL
 XSLTINCL
 XML2INCL
@@ -772,6 +773,7 @@ with_cms
 with_coreaudio
 with_cups
 with_curses
+with_dbus
 with_esd
 with_fontconfig
 with_freetype
@@ -1459,6 +1461,7 @@ Optional Packages:
   --without-coreaudio     do not use the CoreAudio sound support
   --without-cups          do not use CUPS
   --without-curses        do not use (n)curses
+  --without-dbus          do not use dbus (will also disable HAL support)
   --without-esd           do not use the EsounD sound support
   --without-fontconfig    do not use fontconfig
   --without-freetype      do not use the FreeType library
@@ -2539,6 +2542,12 @@ if test "${with_curses+set}" = set; then :
 fi
 
 
+# Check whether --with-dbus was given.
+if test "${with_dbus+set}" = set; then :
+  withval=$with_dbus;
+fi
+
+
 # Check whether --with-esd was given.
 if test "${with_esd+set}" = set; then :
   withval=$with_esd;
@@ -9260,39 +9269,40 @@ fi
 
 HALINCL=""
 
-if test "x$with_hal" != "xno"
+DBUSINCL=""
+
+
+if test "x$with_dbus" != "xno"
 then
     ac_save_CPPFLAGS="$CPPFLAGS"
     if test "$PKG_CONFIG" != "false"
     then
-        ac_hal_libs="`$PKG_CONFIG --libs hal 2>/dev/null`"
-        ac_hal_cflags="`$PKG_CONFIG --cflags hal 2>/dev/null`"
-        CPPFLAGS="$CPPFLAGS $ac_hal_cflags"
+        ac_dbus_libs="`$PKG_CONFIG --libs dbus-1 2>/dev/null`"
+        ac_dbus_cflags="`$PKG_CONFIG --cflags dbus-1 2>/dev/null`"
+        CPPFLAGS="$CPPFLAGS $ac_dbus_cflags"
     fi
-    for ac_header in dbus/dbus.h hal/libhal.h
+    for ac_header in dbus/dbus.h
 do :
-  as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
-ac_fn_c_check_header_mongrel "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default"
-eval as_val=\$$as_ac_Header
-   if test "x$as_val" = x""yes; then :
+  ac_fn_c_check_header_mongrel "$LINENO" "dbus/dbus.h" "ac_cv_header_dbus_dbus_h" "$ac_includes_default"
+if test "x$ac_cv_header_dbus_dbus_h" = x""yes; then :
   cat >>confdefs.h <<_ACEOF
-#define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
+#define HAVE_DBUS_DBUS_H 1
 _ACEOF
 
 fi
 
 done
 
-    if test "$ac_cv_header_dbus_dbus_h" = "yes" -a "$ac_cv_header_hal_libhal_h" = "yes"
+    if test "$ac_cv_header_dbus_dbus_h" = "yes"
     then
-        { $as_echo "$as_me:${as_lineno-$LINENO}: checking for dbus_connection_close in -ldbus-1" >&5
-$as_echo_n "checking for dbus_connection_close in -ldbus-1... " >&6; }
-if test "${ac_cv_lib_dbus_1_dbus_connection_close+set}" = set; then :
+        { $as_echo "$as_me:${as_lineno-$LINENO}: checking for -ldbus-1" >&5
+$as_echo_n "checking for -ldbus-1... " >&6; }
+if test "${ac_cv_lib_soname_dbus_1+set}" = set; then :
   $as_echo_n "(cached) " >&6
 else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldbus-1 $ac_hal_libs $LIBS"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+  ac_check_soname_save_LIBS=$LIBS
+LIBS="-ldbus-1 $ac_dbus_libs $LIBS"
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
@@ -9311,18 +9321,67 @@ return dbus_connection_close ();
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_dbus_1_dbus_connection_close=yes
-else
-  ac_cv_lib_dbus_1_dbus_connection_close=no
+  case "$LIBEXT" in
+    dll) ac_cv_lib_soname_dbus_1=`$ac_cv_path_LDD conftest.exe | grep "dbus-1" | sed -e "s/dll.*/dll/"';2,$d'` ;;
+    dylib) ac_cv_lib_soname_dbus_1=`otool -L conftest$ac_exeext | grep "libdbus-1\\.[0-9A-Za-z.]*dylib" | sed -e "s/^.*\/\(libdbus-1\.[0-9A-Za-z.]*dylib\).*$/\1/"';2,$d'` ;;
+    *) ac_cv_lib_soname_dbus_1=`$ac_cv_path_LDD conftest$ac_exeext | grep "libdbus-1\\.$LIBEXT" | sed -e "s/^.*\(libdbus-1\.$LIBEXT[^	 ]*\).*$/\1/"';2,$d'` ;;
+  esac
 fi
 rm -f core conftest.err conftest.$ac_objext \
     conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+  LIBS=$ac_check_soname_save_LIBS
+fi
+if test "x$ac_cv_lib_soname_dbus_1" = "x"; then :
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: not found" >&5
+$as_echo "not found" >&6; }
+
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_soname_dbus_1" >&5
+$as_echo "$ac_cv_lib_soname_dbus_1" >&6; }
+
+cat >>confdefs.h <<_ACEOF
+#define SONAME_LIBDBUS_1 "$ac_cv_lib_soname_dbus_1"
+_ACEOF
+
+       DBUSINCL="$ac_dbus_cflags"
+fi
+    fi
+
+    CPPFLAGS="$ac_save_CPPFLAGS"
 fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_dbus_1_dbus_connection_close" >&5
-$as_echo "$ac_cv_lib_dbus_1_dbus_connection_close" >&6; }
-if test "x$ac_cv_lib_dbus_1_dbus_connection_close" = x""yes; then :
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for -lhal" >&5
+if test "x$ac_cv_lib_soname_dbus_1" = "x" -a "x$ac_cv_header_DiskArbitration_DiskArbitration_h" != "xyes"; then :
+  case "x$with_dbus" in
+  x)   as_fn_append wine_notices "|libdbus and libhal ${notice_platform}development files not found, HAL and rtkit support disabled" ;;
+  xno) ;;
+  *)   as_fn_error "libdbus and libhal ${notice_platform}development files not found, HAL and rtkit support disabled
+This is an error since --with-dbus was requested." "$LINENO" 5 ;;
+esac
+fi
+
+if test "x$with_hal" != "xno" -a "x$ac_cv_lib_soname_dbus_1" != "x"
+then
+    ac_save_CPPFLAGS="$CPPFLAGS"
+    if test "$PKG_CONFIG" != "false"
+    then
+        ac_hal_libs="`$PKG_CONFIG --libs hal 2>/dev/null`"
+        ac_hal_cflags="`$PKG_CONFIG --cflags hal 2>/dev/null`"
+        CPPFLAGS="$CPPFLAGS $ac_hal_cflags"
+    fi
+    for ac_header in hal/libhal.h
+do :
+  ac_fn_c_check_header_mongrel "$LINENO" "hal/libhal.h" "ac_cv_header_hal_libhal_h" "$ac_includes_default"
+if test "x$ac_cv_header_hal_libhal_h" = x""yes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_HAL_LIBHAL_H 1
+_ACEOF
+
+fi
+
+done
+
+    if test "$ac_cv_header_hal_libhal_h" = "yes"
+    then
+        { $as_echo "$as_me:${as_lineno-$LINENO}: checking for -lhal" >&5
 $as_echo_n "checking for -lhal... " >&6; }
 if test "${ac_cv_lib_soname_hal+set}" = set; then :
   $as_echo_n "(cached) " >&6
@@ -9372,16 +9431,14 @@ _ACEOF
 
        HALINCL="$ac_hal_cflags"
 fi
-fi
-
     fi
     CPPFLAGS="$ac_save_CPPFLAGS"
 fi
-if test "x$ac_cv_lib_soname_hal" = "x" -a "x$ac_cv_header_DiskArbitration_DiskArbitration_h" != "xyes"; then :
+if test "x$ac_cv_lib_soname_hal" = "x" -a "x$ac_cv_header_DiskArbitration_DiskArbitration_h" != "xyes" -a "x$ac_cv_lib_soname_dbus_1" != "x"; then :
   case "x$with_hal" in
-  x)   as_fn_append wine_notices "|libhal/libdbus ${notice_platform}development files not found, no dynamic device support." ;;
+  x)   as_fn_append wine_notices "|libhal ${notice_platform}development files not found, no dynamic device support." ;;
   xno) ;;
-  *)   as_fn_error "libhal/libdbus ${notice_platform}development files not found, no dynamic device support.
+  *)   as_fn_error "libhal ${notice_platform}development files not found, no dynamic device support.
 This is an error since --with-hal was requested." "$LINENO" 5 ;;
 esac
 fi
diff --git a/configure.ac b/configure.ac
index 227dee5..179bcc3 100644
--- a/configure.ac
+++ b/configure.ac
@@ -36,6 +36,7 @@ AC_ARG_WITH(coreaudio, AS_HELP_STRING([--without-coreaudio],[do not use the Core
 AC_ARG_WITH(cups,      AS_HELP_STRING([--without-cups],[do not use CUPS]))
 AC_ARG_WITH(curses,    AS_HELP_STRING([--without-curses],[do not use (n)curses]),
             [if test "x$withval" = "xno"; then ac_cv_header_ncurses_h=no; ac_cv_header_curses_h=no; fi])
+AC_ARG_WITH(dbus,      AS_HELP_STRING([--without-dbus],[do not use dbus (will also disable HAL support)]))
 AC_ARG_WITH(esd,       AS_HELP_STRING([--without-esd],[do not use the EsounD sound support]))
 AC_ARG_WITH(fontconfig,AS_HELP_STRING([--without-fontconfig],[do not use fontconfig]),
             [if test "x$withval" = "xno"; then ac_cv_header_fontconfig_fontconfig_h=no; fi])
@@ -1113,9 +1114,32 @@ fi
 WINE_WARNING_WITH(xslt,[test "x$ac_cv_lib_soname_xslt" = "x"],
                  [libxslt ${notice_platform}development files not found, xslt won't be supported.])
 
-dnl **** Check for libhal ****
+dnl **** Check for libdbus-1 and libhal ****
 AC_SUBST(HALINCL,"")
-if test "x$with_hal" != "xno"
+AC_SUBST(DBUSINCL,"")
+
+if test "x$with_dbus" != "xno"
+then
+    ac_save_CPPFLAGS="$CPPFLAGS"
+    if test "$PKG_CONFIG" != "false"
+    then
+        ac_dbus_libs="`$PKG_CONFIG --libs dbus-1 2>/dev/null`"
+        ac_dbus_cflags="`$PKG_CONFIG --cflags dbus-1 2>/dev/null`"
+        CPPFLAGS="$CPPFLAGS $ac_dbus_cflags"
+    fi
+    AC_CHECK_HEADERS([dbus/dbus.h])
+    if test "$ac_cv_header_dbus_dbus_h" = "yes"
+    then
+        WINE_CHECK_SONAME(dbus-1, dbus_connection_close,
+            [DBUSINCL="$ac_dbus_cflags"],,[$ac_dbus_libs])
+    fi
+
+    CPPFLAGS="$ac_save_CPPFLAGS"
+fi
+WINE_NOTICE_WITH(dbus,[test "x$ac_cv_lib_soname_dbus_1" = "x" -a "x$ac_cv_header_DiskArbitration_DiskArbitration_h" != "xyes"],
+                 [libdbus and libhal ${notice_platform}development files not found, HAL and rtkit support disabled])
+
+if test "x$with_hal" != "xno" -a "x$ac_cv_lib_soname_dbus_1" != "x"
 then
     ac_save_CPPFLAGS="$CPPFLAGS"
     if test "$PKG_CONFIG" != "false"
@@ -1124,17 +1148,16 @@ then
         ac_hal_cflags="`$PKG_CONFIG --cflags hal 2>/dev/null`"
         CPPFLAGS="$CPPFLAGS $ac_hal_cflags"
     fi
-    AC_CHECK_HEADERS([dbus/dbus.h hal/libhal.h])
-    if test "$ac_cv_header_dbus_dbus_h" = "yes" -a "$ac_cv_header_hal_libhal_h" = "yes"
+    AC_CHECK_HEADERS([hal/libhal.h])
+    if test "$ac_cv_header_hal_libhal_h" = "yes"
     then
-        AC_CHECK_LIB(dbus-1, dbus_connection_close,
-          [WINE_CHECK_SONAME(hal, libhal_ctx_new,
-            [HALINCL="$ac_hal_cflags"],,[$ac_hal_libs])],,[$ac_hal_libs])
+        WINE_CHECK_SONAME(hal, libhal_ctx_new,
+            [HALINCL="$ac_hal_cflags"],,[$ac_hal_libs])
     fi
     CPPFLAGS="$ac_save_CPPFLAGS"
 fi
-WINE_NOTICE_WITH(hal,[test "x$ac_cv_lib_soname_hal" = "x" -a "x$ac_cv_header_DiskArbitration_DiskArbitration_h" != "xyes"],
-                 [libhal/libdbus ${notice_platform}development files not found, no dynamic device support.])
+WINE_NOTICE_WITH(hal,[test "x$ac_cv_lib_soname_hal" = "x" -a "x$ac_cv_header_DiskArbitration_DiskArbitration_h" != "xyes" -a "x$ac_cv_lib_soname_dbus_1" != "x"],
+                 [libhal ${notice_platform}development files not found, no dynamic device support.])
 
 dnl **** Check for libgnutls ****
 if test "x$with_gnutls" != "xno"
diff --git a/include/config.h.in b/include/config.h.in
index 0faf127..60e12a4 100644
--- a/include/config.h.in
+++ b/include/config.h.in
@@ -1181,6 +1181,9 @@
 /* Define to the soname of the libcurses library. */
 #undef SONAME_LIBCURSES
 
+/* Define to the soname of the libdbus-1 library. */
+#undef SONAME_LIBDBUS_1
+
 /* Define to the soname of the libfontconfig library. */
 #undef SONAME_LIBFONTCONFIG
 
diff --git a/libs/wine/loader.c b/libs/wine/loader.c
index 37c603e..69a9292 100644
--- a/libs/wine/loader.c
+++ b/libs/wine/loader.c
@@ -669,6 +669,32 @@ static void set_max_limit( int limit )
 
 
 /***********************************************************************
+ *           set_rttime_limit
+ *
+ * set a limit on the cpu time used
+ */
+static void set_rttime_limit(void)
+{
+#if defined(HAVE_SETRLIMIT) && defined(__linux__)
+#ifndef RLIMIT_RTTIME
+#define RLIMIT_RTTIME 15
+#endif
+    struct rlimit rlimit;
+
+    if (!getrlimit( RLIMIT_RTTIME, &rlimit ))
+    {
+        /* 50 ms realtime, then 10 ms to undo realtime */
+        if (rlimit.rlim_max > 60000000ULL)
+            rlimit.rlim_max = 60000000ULL;
+        rlimit.rlim_cur = rlimit.rlim_max - 10000000ULL;
+
+        setrlimit( RLIMIT_RTTIME, &rlimit );
+    }
+#endif
+}
+
+
+/***********************************************************************
  *           wine_init
  *
  * Main Wine initialisation.
@@ -687,6 +713,7 @@ void wine_init( int argc, char *argv[], char *error, int error_size )
 #ifdef RLIMIT_AS
     set_max_limit( RLIMIT_AS );
 #endif
+    set_rttime_limit();
 
     wine_init_argv0_path( argv[0] );
     build_dll_path();
diff --git a/server/Makefile.in b/server/Makefile.in
index 7a67707..1197066 100644
--- a/server/Makefile.in
+++ b/server/Makefile.in
@@ -5,6 +5,7 @@ SRCDIR    = @srcdir@
 VPATH     = @srcdir@
 MODULE    = none
 EXTRALIBS = @LIBPOLL@
+MODCFLAGS = @DBUSINCL@
 
 C_SRCS = \
 	async.c \
@@ -36,6 +37,7 @@ C_SRCS = \
 	region.c \
 	registry.c \
 	request.c \
+	rtkit.c \
 	semaphore.c \
 	serial.c \
 	signal.c \
diff --git a/server/rtkit.c b/server/rtkit.c
new file mode 100644
index 0000000..890c8a6
--- /dev/null
+++ b/server/rtkit.c
@@ -0,0 +1,187 @@
+/*-*- Mode: C; c-basic-offset: 8 -*-*/
+
+/***
+  Copyright 2009 Lennart Poettering
+
+  Permission is hereby granted, free of charge, to any person
+  obtaining a copy of this software and associated documentation files
+  (the "Software"), to deal in the Software without restriction,
+  including without limitation the rights to use, copy, modify, merge,
+  publish, distribute, sublicense, and/or sell copies of the Software,
+  and to permit persons to whom the Software is furnished to do so,
+  subject to the following conditions:
+
+  The above copyright notice and this permission notice shall be
+  included in all copies or substantial portions of the Software.
+
+  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
+  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
+  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
+  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
+  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+  SOFTWARE.
+***/
+
+#include "config.h"
+#include "wine/port.h"
+#include "wine/library.h"
+
+#include <errno.h>
+#include <sys/types.h>
+#ifdef HAVE_SYS_SCHED_H
+#include <sys/sched.h>
+#endif
+#include <sys/resource.h>
+
+#if defined(HAVE_SETRLIMIT) && defined(__linux__) && defined(SONAME_LIBDBUS_1)
+
+#include <sched.h>
+#include <string.h>
+#include <unistd.h>
+#include <dbus/dbus.h>
+#include <sys/syscall.h>
+
+#ifndef RLIMIT_RTTIME
+#define RLIMIT_RTTIME 15
+#endif
+
+#define RTKIT_SERVICE_NAME "org.freedesktop.RealtimeKit1"
+#define RTKIT_OBJECT_PATH "/org/freedesktop/RealtimeKit1"
+
+#define FUNCPTR(fn) static typeof(fn) *p ##fn
+
+FUNCPTR(dbus_error_init);
+FUNCPTR(dbus_error_free);
+FUNCPTR(dbus_bus_get);
+FUNCPTR(dbus_message_new_method_call);
+FUNCPTR(dbus_message_append_args);
+FUNCPTR(dbus_connection_send_with_reply_and_block);
+FUNCPTR(dbus_message_unref);
+FUNCPTR(dbus_set_error_from_message);
+#undef FUNCPTR
+
+static int translate_error(const char *name) {
+    if (strcmp(name, DBUS_ERROR_NO_MEMORY) == 0)
+        return -ENOMEM;
+    if (strcmp(name, DBUS_ERROR_SERVICE_UNKNOWN) == 0 ||
+        strcmp(name, DBUS_ERROR_NAME_HAS_NO_OWNER) == 0)
+        return -ENOENT;
+    if (strcmp(name, DBUS_ERROR_ACCESS_DENIED) == 0 ||
+        strcmp(name, DBUS_ERROR_AUTH_FAILED) == 0)
+        return -EACCES;
+
+    return -EIO;
+}
+
+static void init_dbus(void) {
+#define FUNCPTR(fn) p ##fn = wine_dlsym(libdbus, #fn, NULL, 0);
+    char error[512];
+    void *libdbus = wine_dlopen(SONAME_LIBDBUS_1, RTLD_NOW, error, sizeof(error));
+    FUNCPTR(dbus_error_init);
+    FUNCPTR(dbus_error_free);
+    FUNCPTR(dbus_bus_get);
+    FUNCPTR(dbus_message_new_method_call);
+    FUNCPTR(dbus_message_append_args);
+    FUNCPTR(dbus_connection_send_with_reply_and_block);
+    FUNCPTR(dbus_message_unref);
+    FUNCPTR(dbus_set_error_from_message);
+#undef FUNCPTR
+}
+
+static DBusConnection *get_dbus(void) {
+    static DBusConnection *bus;
+    DBusError error;
+
+    if (bus)
+        return bus;
+    init_dbus();
+    pdbus_error_init(&error);
+
+    bus = pdbus_bus_get(DBUS_BUS_SYSTEM, &error);
+    return bus;
+}
+
+int rtkit_make_realtime(pid_t process, pid_t thread, int priority) {
+    DBusConnection *bus = get_dbus();
+    DBusMessage *m = NULL, *r = NULL;
+    dbus_uint64_t pid, tid;
+    dbus_uint32_t u32;
+    DBusError error;
+    int ret;
+
+    if (!bus)
+        return -ENOTSUP;
+
+    pdbus_error_init(&error);
+
+    if (!(m = pdbus_message_new_method_call(
+                          RTKIT_SERVICE_NAME,
+                          RTKIT_OBJECT_PATH,
+                          "org.freedesktop.RealtimeKit1",
+                          "MakeThreadRealtimeWithPID"))) {
+            ret = -ENOMEM;
+            goto finish;
+    }
+
+    pid = (dbus_uint64_t) process;
+    tid = (dbus_uint64_t) thread;
+    u32 = (dbus_uint32_t) priority;
+
+    if (!pdbus_message_append_args(m, DBUS_TYPE_UINT64, &pid,
+                                   DBUS_TYPE_UINT64, &tid,
+                                   DBUS_TYPE_UINT32, &u32,
+                                   DBUS_TYPE_INVALID)) {
+        ret = -ENOMEM;
+        goto finish;
+    }
+
+    if (!(r = pdbus_connection_send_with_reply_and_block(bus, m, -1, &error))) {
+        ret = translate_error(error.name);
+        goto finish;
+    }
+
+
+    if (pdbus_set_error_from_message(&error, r)) {
+        ret = translate_error(error.name);
+        goto finish;
+    }
+
+    ret = 0;
+
+finish:
+
+    if (m)
+        pdbus_message_unref(m);
+
+    if (r)
+        pdbus_message_unref(r);
+
+    pdbus_error_free(&error);
+
+    return ret;
+}
+
+int rtkit_undo_realtime(pid_t thread) {
+    struct sched_param parm;
+    int ret;
+    memset(&parm, 0, sizeof(parm));
+    ret = sched_setscheduler(thread, SCHED_OTHER, &parm);
+    if (ret < 0)
+        return -errno;
+    return ret;
+}
+
+#else
+
+int rtkit_make_realtime(pid_t process, pid_t thread, int priority) {
+        return -ENOTSUP;
+}
+
+int rtkit_undo_realtime(pid_t thread) {
+        return -ENOTSUP;
+}
+
+#endif
+
diff --git a/server/thread.c b/server/thread.c
index a6bc55a..40dd6f0 100644
--- a/server/thread.c
+++ b/server/thread.c
@@ -52,6 +52,8 @@
 #include "user.h"
 #include "security.h"
 
+extern int rtkit_make_realtime(pid_t process, pid_t thread, int priority);
+extern int rtkit_undo_realtime(pid_t thread);
 
 #define CPU_FLAG(cpu) (1 << (cpu))
 #ifdef __i386__
@@ -455,7 +457,17 @@ static void set_thread_info( struct thread *thread,
         if ((req->priority >= min && req->priority <= max) ||
             req->priority == THREAD_PRIORITY_IDLE ||
             req->priority == THREAD_PRIORITY_TIME_CRITICAL)
+        {
+            if (thread->unix_tid == -1)
+                {}
+            else if (thread->priority == THREAD_PRIORITY_TIME_CRITICAL &&
+                     req->priority != THREAD_PRIORITY_TIME_CRITICAL)
+                rtkit_undo_realtime(thread->unix_tid);
+            else if (thread->priority != THREAD_PRIORITY_TIME_CRITICAL &&
+                     req->priority == THREAD_PRIORITY_TIME_CRITICAL)
+                rtkit_make_realtime(thread->unix_pid, thread->unix_tid, 1);
             thread->priority = req->priority;
+        }
         else
             set_error( STATUS_INVALID_PARAMETER );
     }
@@ -1167,6 +1179,10 @@ DECL_HANDLER(init_thread)
     debug_level = max( debug_level, req->debug_level );
     set_thread_affinity( current, current->affinity );
 
+    /* Raced with SetThreadPriority */
+    if (current->priority == THREAD_PRIORITY_TIME_CRITICAL)
+        rtkit_make_realtime(current->unix_pid, current->unix_tid, 1);
+
     reply->pid     = get_process_id( process );
     reply->tid     = get_thread_id( current );
     reply->version = SERVER_PROTOCOL_VERSION;
-- 
1.7.0.4

From wine-devel at kievinfo.com  Wed May  5 14:20:14 2010
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Wed, 05 May 2010 13:20:14 -0600
Subject: A revision for common PageSetup dialog
In-Reply-To: <4BDFEFE4.5020002@gmail.com>
References: <4BDFEFE4.5020002@gmail.com>
Message-ID: <4BE1C4EE.1090300@kievinfo.com>

On 05/04/2010 03:59 AM, Love Nystrom wrote:
> Since this is not a straight 'diff' mail-body I'll post it here on
> wine-devel first, as I'm unsure how You handle wine-patches mail.
Send all patches in git format to wine-patches mailing list. Plain text
source file (not in diff format) is not a patch and won't be accepted.

This is of course after you get an Ok from THE boss. Last time this topic
came up (merging changes from ReactOS into Wine) the answer was "no without
exceptions".

Vitaliy.


From nerv at dawncrow.de  Wed May  5 14:34:34 2010
From: nerv at dawncrow.de (=?ISO-8859-15?Q?Andr=E9_Hentschel?=)
Date: Wed, 05 May 2010 21:34:34 +0200
Subject: Wine looses a bit gaming and wins mobility?
Message-ID: <4BE1C84A.8030201@dawncrow.de>

Hi Folks,
Steam seems to add a Linux client in the near future, so maybe Wine will not be needed anymore for that. or did i get something wrong?
That might reduce our "market share" a bit as i guess that many Wineusers play steam games.
On the other hand Intel presented its Z600, which is basically x86 but without IDE, SATA or a BIOS. Thats the reason that it cant run Windows.
So Linux runs and so should Wine i guess. So we might see some mobil advantures in the near future?
-- 

Best Regards, Andr? Hentschel


From austinenglish at gmail.com  Wed May  5 14:42:00 2010
From: austinenglish at gmail.com (Austin English)
Date: Wed, 5 May 2010 14:42:00 -0500
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <4BE1C84A.8030201@dawncrow.de>
References: <4BE1C84A.8030201@dawncrow.de>
Message-ID: <z2xb6bb06271005051242ye77ea7dcuc2a5a48f4ebce9c8@mail.gmail.com>

2010/5/5 Andr? Hentschel <nerv at dawncrow.de>:
> Hi Folks,
> Steam seems to add a Linux client in the near future, so maybe Wine will not be needed anymore for that. or did i get something wrong?
> That might reduce our "market share" a bit as i guess that many Wineusers play steam games.

The rumor is that Valve is porting the Source Engine and the Steam
client. Not all games that come on Steam use the Source engine, and
until their developers port to Linux natively, there will still be a
need for Wine.

And don't forget about Solaris/BSD users ;-).

-- 
-Austin


From gerald at pfeifer.com  Wed May  5 07:02:15 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Wed, 5 May 2010 14:02:15 +0200 (CEST)
Subject: kernel32/tests: Remove variable len which is not really used
	from test_CommandLine. 
In-Reply-To: <201005050006.o4506GEx028264@v1.gse.nl>
References: <201005050006.o4506GEx028264@v1.gse.nl>
Message-ID: <alpine.LSU.1.99.1005051400330.18670@pulcherrima.dbai.tuwien.ac.at>

On Wed, 5 May 2010, testbot at testbot.winehq.org wrote:
> While running your changed tests on Windows, I think I found new failures.
> Being a bot and all I'm not very good at pattern recognition, so I might be
> wrong, but could you please double-check?
> Full results can be found at
> http://testbot.winehq.org/JobDetails.pl?Key=1901
> 
> Your paranoid android.
> 
> 
> === W98SE (32 bit process) ===
> Failure running script in VM: Exceeded timeout limit of 315 sec

There is really no way this patch can have caused this test failure.
So, I double-checked. :-) 

What is the proper way to remark such a false positive?  Follow up
here, on wine-devel as I am doing now?  Retrigger the test somehow?

Gerald

PS: I'm sorry if I missed something on the Wiki, I did check for it.


From nsivov at codeweavers.com  Wed May  5 18:08:58 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Thu, 06 May 2010 03:08:58 +0400
Subject: comctl32/tests: Remove variable res which is not really used
	from	test_monthcal_size.
In-Reply-To: <20100505221106.097F394333@pulcherrima.dbai.tuwien.ac.at>
References: <20100505221106.097F394333@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <4BE1FA8A.4070205@codeweavers.com>

On 5/6/2010 02:11, Gerald Pfeifer wrote:
> Also in other places don't we check the result of SendMessage, and that's
> not really what we want to test here, either, from what I can tell.
>
>    

> -    res = SendMessage(hwnd, MCM_GETMINREQRECT, 0, (LPARAM)&r1);
> +    SendMessage(hwnd, MCM_GETMINREQRECT, 0, (LPARAM)&r1);
>
>    
Actually it won't hurt to test for it here.


From wine at eternaldusk.com  Wed May  5 19:01:43 2010
From: wine at eternaldusk.com (Evil Jay)
Date: Wed, 05 May 2010 19:01:43 -0500
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <4BE1C84A.8030201@dawncrow.de>
References: <4BE1C84A.8030201@dawncrow.de>
Message-ID: <4BE206E7.3000703@eternaldusk.com>

On 05/05/2010 02:34 PM, Andr? Hentschel wrote:
> Hi Folks,
> Steam seems to add a Linux client in the near future, so maybe Wine will not be needed anymore for that. or did i get something wrong?
> That might reduce our "market share" a bit as i guess that many Wineusers play steam games.
> On the other hand Intel presented its Z600, which is basically x86 but without IDE, SATA or a BIOS. Thats the reason that it cant run Windows.
> So Linux runs and so should Wine i guess. So we might see some mobil advantures in the near future?
>   

I would not hold my breath waiting for that Steam client, there's still
been no official announcement and it could just as well be something
they just play around with as a side project for the next half decade.

Phoronix has been claiming Steam for Linux was imminent for 2 years...
but for how many years did they (and even the developers) say that UT3
was right around the corner?  A few 32-bit god-awfully incomplete
binaries that can't even launch the actual GUI is not near enough to
start me waiting in a virtual line.

To take the Devil's advocacy a step farther:  For all we know, Steam for
Linux is not even being actively developed;  They may have started it
with the Mac port and abandoned it as too resource intensive for the
expected payoff.  The few updates that we've seen (before the Linux
build was pulled) may well be the result of of the automated package
builder recompiling the Linux files due to changes in some shared
upstream code (being changed for the benefit of the Mac or Windows client).

Now, personally I am hoping like crazy that Steam for Linux does
materialize in the next year or two.  But, if it does, it will hardly
put a dent in Wine's use for gaming.  Steam's not a game, so naturally
we must assume that Valve will port the Source engine too, so that they
will have some games to sell.  That's great, but how many games in the
AppDB are using the Source engine?  How many games sold through Steam
even use it, and will the non-Valve developers take the time to build
Linux packages?  Wine has plenty of gaming left in its future.

-J


From shacklein at gmail.com  Wed May  5 19:07:03 2010
From: shacklein at gmail.com (Ben Klein)
Date: Thu, 6 May 2010 10:07:03 +1000
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <4BE206E7.3000703@eternaldusk.com>
References: <4BE1C84A.8030201@dawncrow.de> <4BE206E7.3000703@eternaldusk.com>
Message-ID: <h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com>

On 6 May 2010 10:01, Evil Jay <wine at eternaldusk.com> wrote:
> On 05/05/2010 02:34 PM, Andr? Hentschel wrote:
>> Hi Folks,
>> Steam seems to add a Linux client in the near future, so maybe Wine will not be needed anymore for that. or did i get something wrong?
>> That might reduce our "market share" a bit as i guess that many Wineusers play steam games.
>> On the other hand Intel presented its Z600, which is basically x86 but without IDE, SATA or a BIOS. Thats the reason that it cant run Windows.
>> So Linux runs and so should Wine i guess. So we might see some mobil advantures in the near future?
>>
>
> I would not hold my breath waiting for that Steam client, there's still
> been no official announcement and it could just as well be something
> they just play around with as a side project for the next half decade.
>
> Phoronix has been claiming Steam for Linux was imminent for 2 years...
> but for how many years did they (and even the developers) say that UT3
> was right around the corner? ?A few 32-bit god-awfully incomplete
> binaries that can't even launch the actual GUI is not near enough to
> start me waiting in a virtual line.
>
> To take the Devil's advocacy a step farther: ?For all we know, Steam for
> Linux is not even being actively developed; ?They may have started it
> with the Mac port and abandoned it as too resource intensive for the
> expected payoff. ?The few updates that we've seen (before the Linux
> build was pulled) may well be the result of of the automated package
> builder recompiling the Linux files due to changes in some shared
> upstream code (being changed for the benefit of the Mac or Windows client).
>
> Now, personally I am hoping like crazy that Steam for Linux does
> materialize in the next year or two. ?But, if it does, it will hardly
> put a dent in Wine's use for gaming. ?Steam's not a game, so naturally
> we must assume that Valve will port the Source engine too, so that they
> will have some games to sell. ?That's great, but how many games in the
> AppDB are using the Source engine? ?How many games sold through Steam
> even use it, and will the non-Valve developers take the time to build
> Linux packages? ?Wine has plenty of gaming left in its future.

The other solution is they pull a Picasa/Google Earth manoeuvre and
bundle Wine with Steam (or rely on Wine to play the games).

> -J
>
>
>


From adys.wh at gmail.com  Wed May  5 21:56:51 2010
From: adys.wh at gmail.com (Jerome Leclanche)
Date: Thu, 6 May 2010 05:56:51 +0300
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com>
References: <4BE1C84A.8030201@dawncrow.de> <4BE206E7.3000703@eternaldusk.com> 
	<h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com>
Message-ID: <q2g41eceb531005051956p2c644e83u2dba4c2c2d874076@mail.gmail.com>

Knowing that they are developing an opengl version of their engines
(for mac os), I'm guessing porting it to linux will be trivial.


J. Leclanche


On Thu, May 6, 2010 at 3:07 AM, Ben Klein <shacklein at gmail.com> wrote:
> On 6 May 2010 10:01, Evil Jay <wine at eternaldusk.com> wrote:
>> On 05/05/2010 02:34 PM, Andr? Hentschel wrote:
>>> Hi Folks,
>>> Steam seems to add a Linux client in the near future, so maybe Wine will not be needed anymore for that. or did i get something wrong?
>>> That might reduce our "market share" a bit as i guess that many Wineusers play steam games.
>>> On the other hand Intel presented its Z600, which is basically x86 but without IDE, SATA or a BIOS. Thats the reason that it cant run Windows.
>>> So Linux runs and so should Wine i guess. So we might see some mobil advantures in the near future?
>>>
>>
>> I would not hold my breath waiting for that Steam client, there's still
>> been no official announcement and it could just as well be something
>> they just play around with as a side project for the next half decade.
>>
>> Phoronix has been claiming Steam for Linux was imminent for 2 years...
>> but for how many years did they (and even the developers) say that UT3
>> was right around the corner? ?A few 32-bit god-awfully incomplete
>> binaries that can't even launch the actual GUI is not near enough to
>> start me waiting in a virtual line.
>>
>> To take the Devil's advocacy a step farther: ?For all we know, Steam for
>> Linux is not even being actively developed; ?They may have started it
>> with the Mac port and abandoned it as too resource intensive for the
>> expected payoff. ?The few updates that we've seen (before the Linux
>> build was pulled) may well be the result of of the automated package
>> builder recompiling the Linux files due to changes in some shared
>> upstream code (being changed for the benefit of the Mac or Windows client).
>>
>> Now, personally I am hoping like crazy that Steam for Linux does
>> materialize in the next year or two. ?But, if it does, it will hardly
>> put a dent in Wine's use for gaming. ?Steam's not a game, so naturally
>> we must assume that Valve will port the Source engine too, so that they
>> will have some games to sell. ?That's great, but how many games in the
>> AppDB are using the Source engine? ?How many games sold through Steam
>> even use it, and will the non-Valve developers take the time to build
>> Linux packages? ?Wine has plenty of gaming left in its future.
>
> The other solution is they pull a Picasa/Google Earth manoeuvre and
> bundle Wine with Steam (or rely on Wine to play the games).
>
>> -J
>>
>>
>>
>
>
>


From hverbeet at gmail.com  Thu May  6 01:33:03 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Thu, 6 May 2010 08:33:03 +0200
Subject: Stack corruption in dsound.c
In-Reply-To: <18d56ae9d31b56cd812448e48b5fcee6@www3-mail.volny.cz>
References: <c30677fe3726c78303c3ac764b9c8bb7@www3-mail.volny.cz>
	<u2h3a768c551005041535ic7275578rcf6d4421a31e82c4@mail.gmail.com>
	<18d56ae9d31b56cd812448e48b5fcee6@www3-mail.volny.cz>
Message-ID: <w2zd658b69e1005052333oeb19614ay678e2c3307bf064c@mail.gmail.com>

On 5 May 2010 01:39,  <wylda at volny.cz> wrote:
> #274 before wined3d_mutex_unlock(), 0x0020a3f0=HeapAlloc(), &wined3d_cs=0x7e22fda0
> #274 after wined3d_mutex_unlock(), ?0x18fa7048=HeapAlloc(), &wined3d_cs=0x7e22fda0
> ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> Any suggestion?
>
What exactly is wrong with that address?


From epssyis at gmail.com  Thu May  6 02:24:04 2010
From: epssyis at gmail.com (Edward Savage)
Date: Thu, 6 May 2010 17:24:04 +1000
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <q2g41eceb531005051956p2c644e83u2dba4c2c2d874076@mail.gmail.com>
References: <4BE1C84A.8030201@dawncrow.de> <4BE206E7.3000703@eternaldusk.com>
	<h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com>
	<q2g41eceb531005051956p2c644e83u2dba4c2c2d874076@mail.gmail.com>
Message-ID: <k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com>

It is a shame that it is just a rumor but really that's all it's been
for the last half decade.  Plus, Phoronix refuses to release this
binary their meant to have found which I tend to think means they
don't have it.  Steam for Linux would really be a huge win for native
gaming but from Valves point of view it might be too risky?

A better solution which you'd hope they'd approach Codeweavers or the
likes of Ubuntu about would be integrating Wine into a native Steam to
run Win32 binaries of non-native games.  On top of native Source games
that is.  This would be pretty easy, and using the Steam
first-time-run script system we could actually make a native version
support Win32 binaries via Wine ourselves (if it agreed to download
and install them!).

On the Steam topic I should note that Steam is now at the point where
you can run it in the background 24/7.  There is a patch that allows
you to buy things via the Steam store and using the latest Beta Client
update from the opt-in menu removes the last couple of CPU intensive
problems with running it (this is distinct from the new UI update).

I've had it open for the last week just like a native program and it's
great to catch up with friends playing various games instead of them
having to tell you to login and join!


From gerrit.moeltgen at itomig.de  Thu May  6 03:28:29 2010
From: gerrit.moeltgen at itomig.de (Jan Gerrit =?utf-8?q?M=C3=B6ltgen?=)
Date: Thu, 6 May 2010 10:28:29 +0200
Subject: LinuxTag Berlin - call for projects
In-Reply-To: <1272697017.4639.26.camel@rumo>
References: <201002251212.41721.gerrit.moeltgen@itomig.de>
	<201004291012.50208.gerrit.moeltgen@itomig.de>
	<1272697017.4639.26.camel@rumo>
Message-ID: <201005061028.29715.gerrit.moeltgen@itomig.de>

Hello Kai,

I've discard the stand already, but if someone would go to Berlin we could be 
reaccepted for LinuxTag. However, if we want, we schould act as soon as 
possible.

A part of Mail from projects at linuxtag.org (06.05.'10):
Falls doch noch die M?glichkeit besteht, jemand 
anderes aus eurem Projekt zu mobilisieren, gib uns bitte baldm?glichst 
Bescheid. Wir finden dann eine M?glichkeit.

Greetings,
Jan Gerrit


Am Samstag, 1. Mai 2010, um 08:56:57 schrieb Kai Blin:
>
> Until when do you need to know?
> 
> Cheers,
> Kai


-- 
Dipl.-Wirt.-Inf. Jan Gerrit M?ltgen . . . . . .gerrit.moeltgen at itomig.de
ITOMIG GmbH . . . . . . . . . . . . . . . . . . Tel.: +49 7031 389 25 06
Otto-Lilienthal-Str. 36 . . . . . . . . . . . . . . http://www.itomig.de 
D-71034 B?blingen . . . . . . . . . . . . . . .  http://www.itomig.de/fr
Gesch?ftsf?hrer: David G?mbel . . . . . HRB 728519 Amtsgericht Stuttgart
Sitz der Gesellschaft: B?blingen . . . . . . . . . . . . . . . . . . . .


From hverbeet at gmail.com  Thu May  6 03:34:05 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Thu, 6 May 2010 10:34:05 +0200
Subject: Stack corruption in dsound.c
In-Reply-To: <dd73892f2b6f703019080a8c2f510aea@www3-mail.volny.cz>
References: <c30677fe3726c78303c3ac764b9c8bb7@www3-mail.volny.cz>
	<u2h3a768c551005041535ic7275578rcf6d4421a31e82c4@mail.gmail.com>
	<18d56ae9d31b56cd812448e48b5fcee6@www3-mail.volny.cz>
	<w2zd658b69e1005052333oeb19614ay678e2c3307bf064c@mail.gmail.com>
	<dd73892f2b6f703019080a8c2f510aea@www3-mail.volny.cz>
Message-ID: <n2nd658b69e1005060134h5ab00cdcvbb8c218cea104e3a@mail.gmail.com>

2010/5/6  <wylda at volny.cz>:
>> What exactly is wrong with that address?
>
> Hi Henri, to my understending, when i take real values:
>
> adr1 = HeapAlloc(0x00110000, 0x00000008, 0x000003d4);
> HeapFree (0x00110000, 0, adr1);
>
> adr2 = HeapAlloc(0x00110000, 0x00000008, 0x000003d4);
> HeapFree (0x00110000, 0, adr2);
>
> Allocates me 3E0 (rounded 3d4) bytes filled with zeros, begining at adr1
> and this:
> a) adr1 should be "relatively close" to the 0x00110000
> b) adr1 should be same as adr2
>
You can't really make those assumptions, though I guess they may
sometimes be true in practice.

>> Stefan D?singer:
>> There's HeapValidate which may be better than Alloc+Free in spotting
>> > bugs.
>
> Hi, this kind of help i'm looking for... Furhter googling lead me to
> nice articles about memory damage.
>
WINEDEBUG="warn+heap" also does some basic validation.

> BTW: why it takes so long (cca 6 hours) a post to appear, when i send
> mail to wine-devel? Some kind of mail graylist?
>
If you're not subscribed to wine-devel your mails will go through
moderation, which means they won't come through until a moderator
looks at them. If you *are* subscribed mail should generally arrive
within a couple of minutes, if it doesn't something is wrong
somewhere.


From wylda at volny.cz  Thu May  6 02:57:55 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Thu, 06 May 2010 09:57:55 +0200 (CEST)
Subject: Stack corruption in dsound.c
In-Reply-To: <w2zd658b69e1005052333oeb19614ay678e2c3307bf064c@mail.gmail.com>
References: <c30677fe3726c78303c3ac764b9c8bb7@www3-mail.volny.cz>
	<u2h3a768c551005041535ic7275578rcf6d4421a31e82c4@mail.gmail.com>
	<18d56ae9d31b56cd812448e48b5fcee6@www3-mail.volny.cz>
	<w2zd658b69e1005052333oeb19614ay678e2c3307bf064c@mail.gmail.com>
Message-ID: <dd73892f2b6f703019080a8c2f510aea@www3-mail.volny.cz>

> > #274 before wined3d_mutex_unlock(), 0x0020a3f0=HeapAlloc(),
> > #274 after wined3d_mutex_unlock(), ?0x18fa7048=HeapAlloc()
> > ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> >
> What exactly is wrong with that address?

Hi Henri, to my understending, when i take real values:

adr1 = HeapAlloc(0x00110000, 0x00000008, 0x000003d4);
HeapFree (0x00110000, 0, adr1);

adr2 = HeapAlloc(0x00110000, 0x00000008, 0x000003d4);
HeapFree (0x00110000, 0, adr2);

Allocates me 3E0 (rounded 3d4) bytes filled with zeros, begining at adr1
and this:
a) adr1 should be "relatively close" to the 0x00110000
b) adr1 should be same as adr2

Both these a) and b) perfectly works 273 times, when injected in funtion
wined3d_mutex_unlock(). So that makes me believe, that there is memory
on 274 entrance when calling LeaveCriticalSection(&wined3d_cs) inside
wined3d_mutex_unlock().

> Stefan D?singer:
> There's HeapValidate which may be better than Alloc+Free in spotting
> > bugs.

Hi, this kind of help i'm looking for... Furhter googling lead me to
nice articles about memory damage.

BTW: why it takes so long (cca 6 hours) a post to appear, when i send
mail to wine-devel? Some kind of mail graylist?




From cdavis at mymail.mines.edu  Thu May  6 03:58:16 2010
From: cdavis at mymail.mines.edu (Charles Davis)
Date: Thu, 06 May 2010 02:58:16 -0600
Subject: Stack corruption in dsound.c
In-Reply-To: <dd73892f2b6f703019080a8c2f510aea@www3-mail.volny.cz>
References: <c30677fe3726c78303c3ac764b9c8bb7@www3-mail.volny.cz>	<u2h3a768c551005041535ic7275578rcf6d4421a31e82c4@mail.gmail.com>	<18d56ae9d31b56cd812448e48b5fcee6@www3-mail.volny.cz>	<w2zd658b69e1005052333oeb19614ay678e2c3307bf064c@mail.gmail.com>
	<dd73892f2b6f703019080a8c2f510aea@www3-mail.volny.cz>
Message-ID: <4BE284A8.80109@mymail.mines.edu>

On 5/6/10 1:57 AM, wylda at volny.cz wrote:
> BTW: why it takes so long (cca 6 hours) a post to appear, when i send
> mail to wine-devel? Some kind of mail graylist?
If you're not subscribed to wine-devel, your messages are subject to
moderation.

Chip


From wylda at volny.cz  Thu May  6 04:18:12 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Thu, 06 May 2010 11:18:12 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_Stack_corruption_in_dsound.c?=
In-Reply-To: <n2nd658b69e1005060134h5ab00cdcvbb8c218cea104e3a@mail.gmail.com>
References: <c30677fe3726c78303c3ac764b9c8bb7@www3-mail.volny.cz>
	<u2h3a768c551005041535ic7275578rcf6d4421a31e82c4@mail.gmail.com>
	<18d56ae9d31b56cd812448e48b5fcee6@www3-mail.volny.cz>
	<w2zd658b69e1005052333oeb19614ay678e2c3307bf064c@mail.gmail.com>
	<dd73892f2b6f703019080a8c2f510aea@www3-mail.volny.cz>
	<n2nd658b69e1005060134h5ab00cdcvbb8c218cea104e3a@mail.gmail.com>
Message-ID: <023778f18717425f609e61be0f5f8687@www3-mail.volny.cz>


> > Allocates me 3E0 (rounded 3d4) bytes filled with
> > zeros, begining at adr1 and this:
> > a) adr1 should be "relatively close" to the 0x00110000
> > b) adr1 should be same as adr2
> >

> You can't really make those assumptions, though I guess
> they may
> sometimes be true in practice.
> 

OK, i lets start from the beginning. I did +relay,+heap and found:

trace:heap:RtlAllocateHeap (0x4df4000,70000062,00000413): returning 0x4edded0
0018:Ret  ntdll.RtlAllocateHeap() retval=04edded0 ret=78134d83
0023:Ret  KERNEL32.GetCurrentThreadId() retval=00000023 ret=016633ec
0023:Call KERNEL32.GetTickCount() ret=016669e8
0023:Ret  KERNEL32.GetTickCount() retval=00051289 ret=016669e8
0023:Call KERNEL32.GetCurrentThreadId() ret=0166342f
0023:Ret  KERNEL32.GetCurrentThreadId() retval=00000023 ret=0166342f
0023:Call KERNEL32.InterlockedExchange(020876a8,00000001) ret=0166343b
0023:Ret  KERNEL32.InterlockedExchange() retval=00000000 ret=0166343b
0023:Call KERNEL32.GetCurrentThreadId() ret=01663472
0023:Ret  KERNEL32.GetCurrentThreadId() retval=00000023 ret=01663472
0023:Call KERNEL32.Sleep(00000032) ret=016632f9
trace:heap:RtlAllocateHeap (0x4df4000,70000062,00000047): returning 0x4e93558
0018:Ret  ntdll.RtlAllocateHeap() retval=04e93558 ret=78134d83
0018:Call ntdll.RtlAllocateHeap(04df4000,00000000,00000113) ret=78134d83
trace:heap:RtlAllocateHeap (0x4df4000,70000062,00000113): returning 0x4e744f8
0018:Ret  ntdll.RtlAllocateHeap() retval=04e744f8 ret=78134d83
0018:Call ntdll.RtlAllocateHeap(04df4000,00000000,00000047) ret=78134d83
trace:heap:RtlFreeHeap (0x110000,70000062,0x164740): returning TRUE
0022:Ret  ntdll.RtlFreeHeap() retval=00000001 ret=7e1d68e8
0022:Call user32.WindowFromDC(00000534) ret=7e0f9ee7
0022:Ret  user32.WindowFromDC() retval=00040056 ret=7e0f9ee7
0022:Call KERNEL32.TlsGetValue(00000008) ret=7e0fa801
0022:Ret  KERNEL32.TlsGetValue() retval=19dfcfe0 ret=7e0fa801
0022:Call gdi32.wglGetCurrentContext() ret=7e0faeea
0022:Ret  gdi32.wglGetCurrentContext() retval=19a66a00 ret=7e0faeea
0022:Call KERNEL32.TlsGetValue(00000008) ret=7e0fa801
0022:Ret  KERNEL32.TlsGetValue() retval=19dfcfe0 ret=7e0fa801
trace:heap:RtlAllocateHeap (0x4df4000,70000062,00000047): returning 0x4e997d0
0018:Ret  ntdll.RtlAllocateHeap() retval=04e997d0 ret=78134d83

0018:Call ntdll.RtlAllocateHeap(04df4000,00000000,00000213) ret=78134d83
err:heap:HEAP_ValidateInUseArena Heap 0x110000: block 0x19543568 tail
overwritten at 0x1954356d (byte 0/19 == 0xcf)

trace:heap:RtlAllocateHeap (0x110000,70000062,00000100): returning 0x19008c58
err:heap:HEAP_ValidateInUseArena Heap 0x110000: block 0x19543568 tail
overwritten at 0x1954356d (byte 0/19 == 0xcf)

* The first 0022: and 0018: are thread numbers?
* Can be the problem in 0018: be caused by different thread?
* What is that 0/19?
* Can i make assumption, that it was overwritten by gdi32.wglGetCurrentContext()?




From hverbeet at gmail.com  Thu May  6 04:47:58 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Thu, 6 May 2010 11:47:58 +0200
Subject: Stack corruption in dsound.c
In-Reply-To: <023778f18717425f609e61be0f5f8687@www3-mail.volny.cz>
References: <c30677fe3726c78303c3ac764b9c8bb7@www3-mail.volny.cz>
	<u2h3a768c551005041535ic7275578rcf6d4421a31e82c4@mail.gmail.com>
	<18d56ae9d31b56cd812448e48b5fcee6@www3-mail.volny.cz>
	<w2zd658b69e1005052333oeb19614ay678e2c3307bf064c@mail.gmail.com>
	<dd73892f2b6f703019080a8c2f510aea@www3-mail.volny.cz>
	<n2nd658b69e1005060134h5ab00cdcvbb8c218cea104e3a@mail.gmail.com>
	<023778f18717425f609e61be0f5f8687@www3-mail.volny.cz>
Message-ID: <k2sd658b69e1005060247tf4266e8fi306ef1af5fba2d7c@mail.gmail.com>

On 6 May 2010 11:18,  <wylda at volny.cz> wrote:
> * The first 0022: and 0018: are thread numbers?
Yes

> * Can be the problem in 0018: be caused by different thread?
Yes

> * What is that 0/19?
That means the first of 19 tail bytes was overwritten. The message as
a whole means that there's a block of memory at 0x19543568, 5 bytes
large (which is pretty small for something allocated on the heap,
actually), and something wrote past the end of that block. Finding out
where that block was allocated may help with identifying where it was
corrupted.

> * Can i make assumption, that it was overwritten by gdi32.wglGetCurrentContext()?
No, not necessarily.


From julius.schwartzenberg at gmail.com  Thu May  6 05:04:00 2010
From: julius.schwartzenberg at gmail.com (Julius Schwartzenberg)
Date: Thu, 06 May 2010 12:04:00 +0200
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com>
References: <4BE1C84A.8030201@dawncrow.de>
	<4BE206E7.3000703@eternaldusk.com>	<h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com>	<q2g41eceb531005051956p2c644e83u2dba4c2c2d874076@mail.gmail.com>
	<k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com>
Message-ID: <4BE29410.5070500@gmail.com>

Edward Savage wrote:
> It is a shame that it is just a rumor but really that's all it's been
> for the last half decade.  Plus, Phoronix refuses to release this
> binary their meant to have found which I tend to think means they
> don't have it.

It is just a rumor and the binaries there were available were for the 
dedicated servers of some games. I made a copy here in case you're 
really interested:
http://haar.student.utwente.nl/~julius/steam_linux/


From epssyis at gmail.com  Thu May  6 05:22:51 2010
From: epssyis at gmail.com (Edward Savage)
Date: Thu, 6 May 2010 20:22:51 +1000
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <4BE29410.5070500@gmail.com>
References: <4BE1C84A.8030201@dawncrow.de> <4BE206E7.3000703@eternaldusk.com>
	<h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com>
	<q2g41eceb531005051956p2c644e83u2dba4c2c2d874076@mail.gmail.com>
	<k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com>
	<4BE29410.5070500@gmail.com>
Message-ID: <v2gd6c5d7291005060322y94b85b79pea58864b1c06958c@mail.gmail.com>

On Thu, May 6, 2010 at 8:04 PM, Julius Schwartzenberg
<julius.schwartzenberg at gmail.com> wrote:
>
> It is just a rumor and the binaries there were available were for the
> dedicated servers of some games. I made a copy here in case you're really
> interested:
> http://haar.student.utwente.nl/~julius/steam_linux/
>
>
>

I had wondered what was in those.

Dedicated servers is nothing new though, most HL servers of all types
have been running on Linux for a decade now.


From remco47 at gmail.com  Thu May  6 05:40:35 2010
From: remco47 at gmail.com (Remco)
Date: Thu, 6 May 2010 12:40:35 +0200
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com>
References: <4BE1C84A.8030201@dawncrow.de> <4BE206E7.3000703@eternaldusk.com> 
	<h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com> 
	<q2g41eceb531005051956p2c644e83u2dba4c2c2d874076@mail.gmail.com> 
	<k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com>
Message-ID: <o2t36a11a3a1005060340xf2c70c9iff7822b82c50481f@mail.gmail.com>

On Thu, May 6, 2010 at 09:24, Edward Savage <epssyis at gmail.com> wrote:
> It is a shame that it is just a rumor but really that's all it's been
> for the last half decade. ?Plus, Phoronix refuses to release this
> binary their meant to have found which I tend to think means they
> don't have it. ?Steam for Linux would really be a huge win for native
> gaming but from Valves point of view it might be too risky?

The binary was not given to Phoronix. They found a link to the Linux
version in a shell script for the Mac version. It is still available,
and the binaries are periodically updated by Valve.

http://store.steampowered.com/public/client/steam_client_linux

If you run the following shell code in an empty directory, it will
download and fix a bug the Linux Steam client so that it will actually
show a (nonworking) GUI. You'll need bspatch installed for this to
work.

http://pastie.org/private/4ryiocqxbea8uq8dgexg

All of this clearly shows that Valve is working on a Linux GUI of the
Steam store, and not a Linux server tool. I ask that you don't do any
further hacking on these binaries, nor host them yourself, because
this is not free software. You can't just redistribute it. Besides,
the goal was to investigate whether Valve was working on Steam for
Linux, there's nothing more to see here.

-- 
Remco


From remco47 at gmail.com  Thu May  6 05:47:52 2010
From: remco47 at gmail.com (Remco)
Date: Thu, 6 May 2010 12:47:52 +0200
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <o2t36a11a3a1005060340xf2c70c9iff7822b82c50481f@mail.gmail.com>
References: <4BE1C84A.8030201@dawncrow.de> <4BE206E7.3000703@eternaldusk.com> 
	<h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com> 
	<q2g41eceb531005051956p2c644e83u2dba4c2c2d874076@mail.gmail.com> 
	<k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com> 
	<o2t36a11a3a1005060340xf2c70c9iff7822b82c50481f@mail.gmail.com>
Message-ID: <q2k36a11a3a1005060347l34dd673bx102580514406e7e5@mail.gmail.com>

On Thu, May 6, 2010 at 12:40, Remco <remco47 at gmail.com> wrote:
> If you run the following shell code in an empty directory, it will
> download and fix a bug the Linux Steam client so that it will actually
> show a (nonworking) GUI. You'll need bspatch installed for this to
> work.
>
> http://pastie.org/private/4ryiocqxbea8uq8dgexg

I'm sorry, that's the wrong (old) shell script. The following will do
what you want:

http://pastebay.com/96489

-- 
Remco


From epssyis at gmail.com  Thu May  6 05:54:42 2010
From: epssyis at gmail.com (Edward Savage)
Date: Thu, 6 May 2010 20:54:42 +1000
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <o2t36a11a3a1005060340xf2c70c9iff7822b82c50481f@mail.gmail.com>
References: <4BE1C84A.8030201@dawncrow.de> <4BE206E7.3000703@eternaldusk.com>
	<h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com>
	<q2g41eceb531005051956p2c644e83u2dba4c2c2d874076@mail.gmail.com>
	<k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com>
	<o2t36a11a3a1005060340xf2c70c9iff7822b82c50481f@mail.gmail.com>
Message-ID: <s2kd6c5d7291005060354g877132b3wf7c212ef3d90f200@mail.gmail.com>

On Thu, May 6, 2010 at 8:40 PM, Remco <remco47 at gmail.com> wrote:
> The binary was not given to Phoronix. They found a link to the Linux
> version in a shell script for the Mac version. It is still available,
> and the binaries are periodically updated by Valve.
>
> http://store.steampowered.com/public/client/steam_client_linux
>
> If you run the following shell code in an empty directory, it will
> download and fix a bug the Linux Steam client so that it will actually
> show a (nonworking) GUI. You'll need bspatch installed for this to
> work.
>
> http://pastie.org/private/4ryiocqxbea8uq8dgexg
>
> All of this clearly shows that Valve is working on a Linux GUI of the
> Steam store, and not a Linux server tool. I ask that you don't do any
> further hacking on these binaries, nor host them yourself, because
> this is not free software. You can't just redistribute it. Besides,
> the goal was to investigate whether Valve was working on Steam for
> Linux, there's nothing more to see here.
>

Again, this is nothing new.  Valve ran a closed trial of a native
Steam client back in 05 (iirc) and all this time there have been
strings and Linux compiled object files included with the Win32 Steam.
 It would be silly to assume they haven't had a hobby project of Steam
natively on Linux since then as they have the team with the skills
(for the server work).  Now that they have a client that works with
Mac you can be sure they have one for Linux.  How ever a hobby and an
actual release are two very different things.

Phoronix has been on this dead horse so long there is no point getting
our hopes up until Valve speak.

As for your doom and gloom 'don't touch this golden goose' rubbish.
The binaries are freely distributed under license and completely
unrestricted to download and redistribute (without modification).  We
can do what ever we want as long as there EULA isn't broken.  I can
host it if I wish as can any one else.  Plus, for some reason you
assume it's okay to 'hack' on these to take a sneak peak but after
that you draw the line? Your morality is out of whack.


From remco47 at gmail.com  Thu May  6 06:09:51 2010
From: remco47 at gmail.com (Remco)
Date: Thu, 6 May 2010 13:09:51 +0200
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <s2kd6c5d7291005060354g877132b3wf7c212ef3d90f200@mail.gmail.com>
References: <4BE1C84A.8030201@dawncrow.de> <4BE206E7.3000703@eternaldusk.com> 
	<h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com> 
	<q2g41eceb531005051956p2c644e83u2dba4c2c2d874076@mail.gmail.com> 
	<k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com> 
	<o2t36a11a3a1005060340xf2c70c9iff7822b82c50481f@mail.gmail.com> 
	<s2kd6c5d7291005060354g877132b3wf7c212ef3d90f200@mail.gmail.com>
Message-ID: <x2l36a11a3a1005060409m1f07f411t79b649d42b3c1578@mail.gmail.com>

On Thu, May 6, 2010 at 12:54, Edward Savage <epssyis at gmail.com> wrote:
> On Thu, May 6, 2010 at 8:40 PM, Remco <remco47 at gmail.com> wrote:
>> The binary was not given to Phoronix. They found a link to the Linux
>> version in a shell script for the Mac version. It is still available,
>> and the binaries are periodically updated by Valve.
>>
>> http://store.steampowered.com/public/client/steam_client_linux
>>
>> If you run the following shell code in an empty directory, it will
>> download and fix a bug the Linux Steam client so that it will actually
>> show a (nonworking) GUI. You'll need bspatch installed for this to
>> work.
>>
>> http://pastie.org/private/4ryiocqxbea8uq8dgexg
>>
>> All of this clearly shows that Valve is working on a Linux GUI of the
>> Steam store, and not a Linux server tool. I ask that you don't do any
>> further hacking on these binaries, nor host them yourself, because
>> this is not free software. You can't just redistribute it. Besides,
>> the goal was to investigate whether Valve was working on Steam for
>> Linux, there's nothing more to see here.
>>
>
> Again, this is nothing new. ?Valve ran a closed trial of a native
> Steam client back in 05 (iirc) and all this time there have been
> strings and Linux compiled object files included with the Win32 Steam.
> ?It would be silly to assume they haven't had a hobby project of Steam
> natively on Linux since then as they have the team with the skills
> (for the server work). ?Now that they have a client that works with
> Mac you can be sure they have one for Linux. ?How ever a hobby and an
> actual release are two very different things.

Since Steam was built around Internet Explorer, I very much doubt that
it ran on Linux. Today, it clearly does. It may take a while before
Valve decides on a release, but the emergence of the actual software
makes this much more likely.

> As for your doom and gloom 'don't touch this golden goose' rubbish.
> The binaries are freely distributed under license and completely
> unrestricted to download and redistribute (without modification). ?We
> can do what ever we want as long as there EULA isn't broken. ?I can
> host it if I wish as can any one else. ?Plus, for some reason you
> assume it's okay to 'hack' on these to take a sneak peak but after
> that you draw the line? Your morality is out of whack.

All I'm saying is, don't go hacking the binaries or Valve is forced to
take them down. My morality has been out of whack ever since some
chick ate an apple.

-- 
Remco


From wine at eternaldusk.com  Thu May  6 07:33:07 2010
From: wine at eternaldusk.com (Evil Jay)
Date: Thu, 06 May 2010 07:33:07 -0500
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com>
References: <4BE1C84A.8030201@dawncrow.de> <4BE206E7.3000703@eternaldusk.com>
	<h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com>
Message-ID: <4BE2B703.7060704@eternaldusk.com>

On 05/05/2010 07:07 PM, Ben Klein wrote:
> On 6 May 2010 10:01, Evil Jay <wine at eternaldusk.com> wrote:
>   
>> On 05/05/2010 02:34 PM, Andr? Hentschel wrote:
>>     
>>> Hi Folks,
>>> Steam seems to add a Linux client in the near future, so maybe Wine will not be needed anymore for that. or did i get something wrong?
>>> That might reduce our "market share" a bit as i guess that many Wineusers play steam games.
>>> On the other hand Intel presented its Z600, which is basically x86 but without IDE, SATA or a BIOS. Thats the reason that it cant run Windows.
>>> So Linux runs and so should Wine i guess. So we might see some mobil advantures in the near future?
>>>
>>>       
>> I would not hold my breath waiting for that Steam client, there's still
>> been no official announcement and it could just as well be something
>> they just play around with as a side project for the next half decade.
>>
>> Phoronix has been claiming Steam for Linux was imminent for 2 years...
>> but for how many years did they (and even the developers) say that UT3
>> was right around the corner?  A few 32-bit god-awfully incomplete
>> binaries that can't even launch the actual GUI is not near enough to
>> start me waiting in a virtual line.
>>
>> To take the Devil's advocacy a step farther:  For all we know, Steam for
>> Linux is not even being actively developed;  They may have started it
>> with the Mac port and abandoned it as too resource intensive for the
>> expected payoff.  The few updates that we've seen (before the Linux
>> build was pulled) may well be the result of of the automated package
>> builder recompiling the Linux files due to changes in some shared
>> upstream code (being changed for the benefit of the Mac or Windows client).
>>
>> Now, personally I am hoping like crazy that Steam for Linux does
>> materialize in the next year or two.  But, if it does, it will hardly
>> put a dent in Wine's use for gaming.  Steam's not a game, so naturally
>> we must assume that Valve will port the Source engine too, so that they
>> will have some games to sell.  That's great, but how many games in the
>> AppDB are using the Source engine?  How many games sold through Steam
>> even use it, and will the non-Valve developers take the time to build
>> Linux packages?  Wine has plenty of gaming left in its future.
>>     
> The other solution is they pull a Picasa/Google Earth manoeuvre and
> bundle Wine with Steam (or rely on Wine to play the games).
>   

They didn't want that hassle with the Mac ports (they're native), so why
would they do it for Linux?

-J


From wine at eternaldusk.com  Thu May  6 07:39:46 2010
From: wine at eternaldusk.com (Evil Jay)
Date: Thu, 06 May 2010 07:39:46 -0500
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com>
References: <4BE1C84A.8030201@dawncrow.de>
	<4BE206E7.3000703@eternaldusk.com>	<h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com>	<q2g41eceb531005051956p2c644e83u2dba4c2c2d874076@mail.gmail.com>
	<k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com>
Message-ID: <4BE2B892.3040004@eternaldusk.com>

On 05/06/2010 02:24 AM, Edward Savage wrote:
> ...Plus, Phoronix refuses to release this binary their meant to have found which I tend to think means they don't have it.  
>   

What are you on about?  The binaries were up on Valve's servers for
several days, and lots of us downloaded them.  They exist, they were
just in an unusable pre-alpha state (when run, they fail connecting to
the servers).  Someone on the Phoronix boards posted a binary patch that
would allow it to bring up a single broken dialog.

> A better solution which you'd hope they'd approach Codeweavers or the
> likes of Ubuntu about would be integrating Wine into a native Steam to
> run Win32 binaries of non-native games.
>   

I think you mean "slower" solution, that doesn't fix any of our problems
like in-game chat.  Native is always the better solution when you're
talking about something where performance is everything.

-J


From testbot at testbot.winehq.org  Thu May  6 08:10:31 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Thu, 6 May 2010 15:10:31 +0200
Subject: usp10: implement mirroring for bidi support 
Message-ID: <201005061310.o46DAVxr013955@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1920

Your paranoid android.


=== WINEBUILD (build) ===
Patch failed


From austinenglish at gmail.com  Thu May  6 08:44:05 2010
From: austinenglish at gmail.com (Austin English)
Date: Thu, 6 May 2010 08:44:05 -0500
Subject: Stack corruption in dsound.c
In-Reply-To: <dd73892f2b6f703019080a8c2f510aea@www3-mail.volny.cz>
References: <c30677fe3726c78303c3ac764b9c8bb7@www3-mail.volny.cz> 
	<u2h3a768c551005041535ic7275578rcf6d4421a31e82c4@mail.gmail.com> 
	<18d56ae9d31b56cd812448e48b5fcee6@www3-mail.volny.cz>
	<w2zd658b69e1005052333oeb19614ay678e2c3307bf064c@mail.gmail.com>
	<dd73892f2b6f703019080a8c2f510aea@www3-mail.volny.cz>
Message-ID: <y2ub6bb06271005060644t5ecd1b0dpea438ea9234618cd@mail.gmail.com>

2010/5/6  <wylda at volny.cz>:
> BTW: why it takes so long (cca 6 hours) a post to appear, when i send
> mail to wine-devel? Some kind of mail graylist?

If you are not subscribe to wine-devel, an administrator must approve
your email before it is sent to the list.
-- 
-Austin


From marco at mandrivaclub.nl  Thu May  6 09:48:37 2010
From: marco at mandrivaclub.nl (Marco Meijer)
Date: Thu, 06 May 2010 16:48:37 +0200
Subject: How to change text on winehq.org ?
Message-ID: <4BE2D6C5.7070307@mandrivaclub.nl>

Hi WineDevs,

If make the packages for mandriva on sourceforge. And the text on the 
download page on the website (winehq,org) for mandriva is getting old.
Who can I write a mail to change the text ? I already tried web-admin ad 
winehq.org some weeks ago but no reaction so far.

greetings

Marco



From Paul.Hampson at Pobox.com  Thu May  6 10:02:36 2010
From: Paul.Hampson at Pobox.com (Paul "TBBle" Hampson)
Date: Fri, 7 May 2010 01:02:36 +1000
Subject: Wine looses a bit gaming and wins mobility?
In-Reply-To: <k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com>
References: <4BE1C84A.8030201@dawncrow.de> <4BE206E7.3000703@eternaldusk.com>
	<h2kd7e40be31005051707gdcbcc244h2a97d45acf9ac09@mail.gmail.com>
	<q2g41eceb531005051956p2c644e83u2dba4c2c2d874076@mail.gmail.com>
	<k2jd6c5d7291005060024gb3f81a4ene2af7b41481a2e21@mail.gmail.com>
Message-ID: <p2s297c1a111005060802w187cf56fk2d98a58d63183af5@mail.gmail.com>

On 6 May 2010 17:24, Edward Savage <epssyis at gmail.com> wrote:
> A better solution which you'd hope they'd approach Codeweavers or the
> likes of Ubuntu about would be integrating Wine into a native Steam to
> run Win32 binaries of non-native games. ?On top of native Source games
> that is. ?This would be pretty easy, and using the Steam
> first-time-run script system we could actually make a native version
> support Win32 binaries via Wine ourselves (if it agreed to download
> and install them!).

It's worth noting on this point that they already do roughly this for
older games with DOSBox, and I think they bundle ScummVM too.

So a native Linux Steam client would get both the ported Source engine
games, and any other games that are emulated using a cross-platform
backend, even before they look at integrating Wine for other games.

Then again, I don't know if it's Valve doing the emulation
integration, or the content owners...

-- 
Paul "TBBle" Hampson, Paul.Hampson at Pobox.com


From andrew at brightnightgames.com  Thu May  6 10:54:50 2010
From: andrew at brightnightgames.com (Andrew Eikum)
Date: Thu, 06 May 2010 10:54:50 -0500
Subject: How to change text on winehq.org ?
In-Reply-To: <4BE2D6C5.7070307@mandrivaclub.nl>
References: <4BE2D6C5.7070307@mandrivaclub.nl>
Message-ID: <4BE2E64A.6040908@brightnightgames.com>

On 05/06/2010 09:48 AM, Marco Meijer wrote:
> If make the packages for mandriva on sourceforge. And the text on the
> download page on the website (winehq,org) for mandriva is getting old.
> Who can I write a mail to change the text ? I already tried web-admin ad
> winehq.org some weeks ago but no reaction so far.

I think you'll want to make a patch against the website git repository. 
  See <http://source.winehq.org/git/website.git/>.  You can send the 
patch to wine-patches as usual.  The file you probably want to edit is 
templates/en/download.template.  I'm not sure how translation changes 
get propagated.

Make sure to note in the subject that it is for the [website] project. 
That will help the maintainer pick it out of the patch stream.

Andrew


From wylda at volny.cz  Thu May  6 11:52:36 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Thu, 06 May 2010 18:52:36 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_Stack_corruption_in_dsound.c?=
In-Reply-To: <k2sd658b69e1005060247tf4266e8fi306ef1af5fba2d7c@mail.gmail.com>
References: <c30677fe3726c78303c3ac764b9c8bb7@www3-mail.volny.cz>
	<u2h3a768c551005041535ic7275578rcf6d4421a31e82c4@mail.gmail.com>
	<18d56ae9d31b56cd812448e48b5fcee6@www3-mail.volny.cz>
	<w2zd658b69e1005052333oeb19614ay678e2c3307bf064c@mail.gmail.com>
	<dd73892f2b6f703019080a8c2f510aea@www3-mail.volny.cz>
	<n2nd658b69e1005060134h5ab00cdcvbb8c218cea104e3a@mail.gmail.com>
	<023778f18717425f609e61be0f5f8687@www3-mail.volny.cz>
	<k2sd658b69e1005060247tf4266e8fi306ef1af5fba2d7c@mail.gmail.com>
Message-ID: <241901ddba20a9759d32ebbc5fe8a6bf@www3-mail.volny.cz>


Thanks Henri... I think i got "heap headache" :-/

* Can i make assumption, that log produced by wine is not buffered anywhere
and is written to console sequentially and immediately when that event
happened? (in other words log output doesn't outrun each other lines)

* Is HEAP_ValidateInUseArena called automatically when HeapAlloc() or
HeapFree() is called? Or where it comes from in the log?

* If i have a log:

0018:Call ntdll.RtlAllocateHeap(04df4000,00000000,00002813) ret=78134d83
0022:trace:heap:RtlFreeHeap (0x110000,70000062,0x1f8aa0): returning TRUE
0022:Ret  ntdll.RtlFreeHeap() retval=00000001 ret=7e1de8e8
0022:Call user32.WindowFromDC(0000053c) ret=7e101ee7
0009:err:heap:HEAP_ValidateInUseArena Heap 0x110000: block 0x190f3468
tail overwritten at 0x190f346d (byte 0/19 == 0x8b)
0018:trace:heap:RtlAllocateHeap (0x4df4000,70000062,00002813): returning
0x4e53a08
0018:Ret  ntdll.RtlAllocateHeap() retval=04e53a08 ret=78134d83
0009:trace:heap:RtlAllocateHeap (0x110000,70000062,00000100): returning
0x191d9648
0018:Call ntdll.RtlAllocateHeap(04df4000,00000000,00001013) ret=78134d83
0022:err:heap:HEAP_ValidateInUseArena Heap 0x110000: block 0x190f3468
tail overwritten at 0x190f346d (byte 0/19 == 0x8b)
0022:trace:heap:RtlAllocateHeap (0x110000,7000006a,00000040): returning
0x191d9758

I see corruption "0009:err:heap:HEAP_ValidateInUseArena..." which is
caused by just calling the WindowFromDC()?? Otherwise two line above
the WindowFromDC() would "0022:trace:heap:RtlFreeHeap" complained about
corruption, because that FreeHeap has same heap handle (0x110000) like
complaining HEAP_ValidateInUseArena.





From dank at kegel.com  Thu May  6 12:47:59 2010
From: dank at kegel.com (Dan Kegel)
Date: Thu, 6 May 2010 10:47:59 -0700
Subject: Stack corruption in dsound.c
Message-ID: <r2va71bd89a1005061047k4310d72aj6963cf1091cddd3f@mail.gmail.com>

>* Can i make assumption, that log produced by wine is not buffered anywhere
>and is written to console sequentially and immediately when that event
>happened? (in other words log output doesn't outrun each other lines)

Sadly, not in a multithreaded program.

>* Is HEAP_ValidateInUseArena called automatically when HeapAlloc() or
>HeapFree() is called?

When WINEDEBUG=+heap, it's called on HeapFree, HeapReAlloc, or HeapSize.  See
http://source.winehq.org/ident?i=HEAP_ValidateInUseArena
http://source.winehq.org/ident?i=validate_block_pointer

Now that you know there is heap corruption, you may be able to
pinpoint the line of code that causes it using Valgrind.
See http://wiki.winehq.org/Wine_and_Valgrind
(It's slow and uses lots of memory, so it's not practical for all apps,
but when it works it's great.)


From dylan.ah.smith at gmail.com  Thu May  6 13:26:02 2010
From: dylan.ah.smith at gmail.com (Dylan Smith)
Date: Thu, 6 May 2010 14:26:02 -0400
Subject: [PATCH] wordpad: add units (in/inch/pt)
In-Reply-To: <m2p342661341005051640mcf5665bbsc53728736cc8ce9b@mail.gmail.com>
References: <m2p342661341005051640mcf5665bbsc53728736cc8ce9b@mail.gmail.com>
Message-ID: <r2o5c6ee3b71005061126z822987b3zed58e510b3357b3@mail.gmail.com>

>-    /* FIXME: Allow other units and convert between them */
>     if(!lstrcmpA(endptr, units_cmA))
>+    {
>+        if (punit != NULL) *punit = UNIT_CM;
>+        endptr += 2;
>+    }
>+    else if (!lstrcmpA(endptr, units_inA))
>+    {
>+        if (punit != NULL) *punit = UNIT_INCH;
>+        endptr += 2;
>+    }
>+    else if (!lstrcmpA(endptr, units_inchA))
>+    {
>+        if (punit != NULL) *punit = UNIT_INCH;
>+        endptr += 4;
>+    }
>+    else if (!lstrcmpA(endptr, units_ptA))
>+    {
>+        if (punit != NULL) *punit = UNIT_PT;
>         endptr += 2;
>+    }
>
>     return *endptr == '\0';
> }

You should really use strlen(units_*A) instead of a constant for
incrementing endptr since these strings may be different lengths once
localized.  For instance I believe inch in French is "pouce" which is
5 characters so the null byte would truncate it to "pouc".

This should have already been done with "cm" units even though no
translation has made it different from 2 characters in length.


From studiosg at giustetti.net  Thu May  6 13:49:14 2010
From: studiosg at giustetti.net (Ing. Simone. Giustetti)
Date: Thu, 06 May 2010 20:49:14 +0200
Subject: How to change text on winehq.org ?
In-Reply-To: <4BE2E64A.6040908@brightnightgames.com>
References: <4BE2D6C5.7070307@mandrivaclub.nl>
	<4BE2E64A.6040908@brightnightgames.com>
Message-ID: <1273171754.4be30f2a46c5d@www.giustetti.net>

Hi,

There are 3 translation template files for the download page:
(From the root directory of your local git repository)
./templates/de/download.template
./templates/pl/download.template
./templates/en/download.template
I think You should update all of them (That's what I did for the Slackware
package description anyway ;) ).
http://wiki.winehq.org/GitWine details how to create a local clone of the git
repository and how to generate and format the patch.

Simone


> On 05/06/2010 09:48 AM, Marco Meijer wrote:
> > If make the packages for mandriva on sourceforge. And the text on the
> > download page on the website (winehq,org) for mandriva is getting old.
> > Who can I write a mail to change the text ? I already tried web-admin ad
> > winehq.org some weeks ago but no reaction so far.
> 
> I think you'll want to make a patch against the website git repository. 
>   See <http://source.winehq.org/git/website.git/>.  You can send the 
> patch to wine-patches as usual.  The file you probably want to edit is 
> templates/en/download.template.  I'm not sure how translation changes 
> get propagated.
> 
> Make sure to note in the subject that it is for the [website] project. 
> That will help the maintainer pick it out of the patch stream.
> 
> Andrew
> 
> 
> 


-- 
Ing. Simone Giustetti
Tel: 340-3425647
e-mail: studiosg at giustetti.net

-------------------------------------------------
This mail sent through IMP: http://horde.org/imp/



From scott at open-vote.org  Thu May  6 19:27:18 2010
From: scott at open-vote.org (Scott Ritchie)
Date: Thu, 06 May 2010 17:27:18 -0700
Subject: How to change text on winehq.org ?
In-Reply-To: <1273171754.4be30f2a46c5d@www.giustetti.net>
References: <4BE2D6C5.7070307@mandrivaclub.nl>	<4BE2E64A.6040908@brightnightgames.com>
	<1273171754.4be30f2a46c5d@www.giustetti.net>
Message-ID: <4BE35E66.5030302@open-vote.org>

On 05/06/2010 11:49 AM, Ing. Simone. Giustetti wrote:
> Hi,
> 
> There are 3 translation template files for the download page:
> (From the root directory of your local git repository)
> ./templates/de/download.template
> ./templates/pl/download.template
> ./templates/en/download.template
> I think You should update all of them (That's what I did for the Slackware
> package description anyway ;) ).
> http://wiki.winehq.org/GitWine details how to create a local clone of the git
> repository and how to generate and format the patch.

It would be much nicer if the website knew when a translation became out
of date.  As it is sometimes the translations get much older than the
English version and become less useful than an untranslated document.

Thanks,
Scott Ritchie


From Joerg-Cyril.Hoehle at t-systems.com  Fri May  7 07:07:16 2010
From: Joerg-Cyril.Hoehle at t-systems.com (Joerg-Cyril.Hoehle at t-systems.com)
Date: Fri, 7 May 2010 14:07:16 +0200
Subject: Valgrind memory leaks in winmm + mciwave
References: <u2ya71bd89a1005030632ndf33566g749325adb9a7da8e@mail.gmail.com>
	<47CC5ABB01651443A88DB8EC5B4D657B740354@S4DE8PSAANK.mitte.t-com.de>
Message-ID: <47CC5ABB01651443A88DB8EC5B4D657B74035F@S4DE8PSAANK.mitte.t-com.de>

Hi,

By mistake, I ran Valgrind in Ubuntu Lucid (prerelease) upon an old
version of Wine (1.1.35) that does not perform as much WINMM tests as
nowadays.  Yet that old version reveals several memory leaks still
present, one of them shown below in MMIO, repeated for every failing
MMIO_Open(no_such_file).  The 8KB buffer is then lost (log below).
One is in mciwave, others in winmm/mci.c.  They are not false alarms.

Why did I never see winmm/mci in Dan Kegel's Valgrind logs?
Looking at the wrong place? E.g. nothing in
http://kegel.com/wine/valgrind/logs/2010-03-18-21.54/


BTW, Valgrind with Wine is currently in a sad state:

Why does Valgrind with 1.1.43 insist on updating .wine with every run?
VALGRIND_OPTS="--trace-children=yes --log-file=/dev/shm/v%p.log --leak-check=full --malloc-fill=A5 --free-fill=DE --track-origins=yes" WINETEST_WRAPPER=valgrind make mci.ok

What crashes while doing so, causing an infinite loop by crashing
winedbg, causing yet another winedbg to be started, crashing and
causing yet another winedbg...?   Wine should prevent this loop.
The main process (running the tests) nevertheless runs!

What commit made Valgrind loose its ability to correctly report
backtraces? The same one that broke winedbg's "bt all" command?

Backtraces were fine in wine-1.1.35:
==4521== 8,192 bytes in 1 blocks are definitely lost in loss record 597 of 612
==4521==  RtlAllocateHeap (heap.c:1423)
==4521==  MMIO_SetBuffer (mmio.c:561)
==4521==  MMIO_Open (mmio.c:653)
==4521==  mmioOpenW (mmio.c:697)
==4521==  WAVE_mciOpenFile (mciwave.c:473)
==4521==  MCIWAVE_DriverProc (mciwave.c:551)
==4521==  SendDriverMessage (driver.c:136)
==4521==  MCI_SendCommandFrom32 (mci.c:903)
==4521==  MCI_FinishOpen (mci.c:926)
==4521==  mciSendStringW (mci.c:1393)
==4521==  mciSendStringA (mci.c:1432)
==4521==  test_openCloseWAVE (mci.c:217)

With 1.1.43+git as of 2010-05-01
==4325== 8,192 bytes in 1 blocks are definitely lost in loss record 648 of 660
==4325==  RtlAllocateHeap (heap.c:254)
==4325==  MMIO_SetBuffer (mmio.c:561)
==4325==  MMIO_Open (mmio.c:654)
==4325==  mmioOpenW (mmio.c:703)
==4325==  ??? (in /.../dlls/winealsa.drv/winealsa.drv.so)
==4325==  ??? (in /.../dlls/winealsa.drv/winealsa.drv.so)
==4325==  SendDriverMessage (driver.c:136)
==4325==  MCI_SendCommandFrom32 (mci.c:892)
==4325==  MCI_FinishOpen (mci.c:915)
==4325==  mciSendStringW (mci.c:1416)
==4325==  mciSendStringA (mci.c:1455)
==4325==  test_openCloseWAVE (mci.c:271)

Regards,
 J?rg H?hle


From dank at kegel.com  Fri May  7 07:22:44 2010
From: dank at kegel.com (Dan Kegel)
Date: Fri, 7 May 2010 05:22:44 -0700
Subject: Valgrind memory leaks in winmm + mciwave
In-Reply-To: <47CC5ABB01651443A88DB8EC5B4D657B74035F@S4DE8PSAANK.mitte.t-com.de>
References: <u2ya71bd89a1005030632ndf33566g749325adb9a7da8e@mail.gmail.com>
	<47CC5ABB01651443A88DB8EC5B4D657B740354@S4DE8PSAANK.mitte.t-com.de>
	<47CC5ABB01651443A88DB8EC5B4D657B74035F@S4DE8PSAANK.mitte.t-com.de>
Message-ID: <k2la71bd89a1005070522pe55e3badj448bc54c7ccac93f@mail.gmail.com>

On Fri, May 7, 2010 at 5:07 AM,  <Joerg-Cyril.Hoehle at t-systems.com> wrote:
> Why did I never see winmm/mci in Dan Kegel's Valgrind logs?

You've just run into http://bugs.winehq.org/show_bug.cgi?id=20919

See http://code.google.com/p/winezeug/source/browse/trunk/valgrind/valgrind-daily.sh#53
...
# Disable any tests known to hang reliably
# http://bugs.winehq.org/show_bug.cgi?id=20919
touch dlls/kernel32/tests/process.ok
touch dlls/ole32/tests/marshal.ok
touch dlls/shdocvw/tests/webbrowser.ok
touch dlls/urlmon/tests/url.ok
touch dlls/winmm/tests/mci.ok
touch dlls/winmm/tests/wave.ok

It would be good to get those cleaned up.

(Stack frames like
==4325==  ??? (in /.../dlls/winealsa.drv/winealsa.drv.so)
probably mean that the dll has been unloaded before the stack frame was
printed.)
- Dan


From Joerg-Cyril.Hoehle at t-systems.com  Fri May  7 10:11:27 2010
From: Joerg-Cyril.Hoehle at t-systems.com (Joerg-Cyril.Hoehle at t-systems.com)
Date: Fri, 7 May 2010 17:11:27 +0200
Subject: winemmaudio.drv: Add support for wavein
References: <47CC5ABB01651443A88DB8EC5B4D657B7402C1@S4DE8PSAANK.mitte.t-com.de><47CC5ABB01651443A88DB8EC5B4D657B74032C@S4DE8PSAANK.mitte.t-com.de>
	<r2zb130c85e1004150500x5f6a533cx853f846cb3fb42c@mail.gmail.com>
Message-ID: <47CC5ABB01651443A88DB8EC5B4D657B740363@S4DE8PSAANK.mitte.t-com.de>

Maarten,

I looked at part of these two patches about winmm->mmdevapi bridge
and they looked very clean to me.

+    caps.dwSupport = WAVECAPS_SAMPLEACCURATE|WAVECAPS_LRVOLUME|WAVECAPS_DIRECTSOUND;
AFAIK WAVECAPS_LRVOLUME never occurs alone, _VOLUME is missing.

+    if (wfx->wFormatTag == WAVE_FORMAT_EXTENSIBLE)
+        extra = sizeof(WAVEFORMATEXTENSIBLE)-sizeof(WAVEFORMATEX);
+    else
+        extra = 0;
This seems to depend on some assumption that IAudioClient_IsFormatSupported
will reject anything but WAVE_FORMAT_EXTENSIBLE and WAVE_FORMAT_PCM.
You may not want to not depend on this.

+        wwo->wfx->nBlockAlign = wfx->nChannels*wfx->wBitsPerSample/8;
+        wwo->wfx->nAvgBytesPerSec = wfx->nSamplesPerSec*wfx->nBlockAlign;
This only applies to WAVE_FORMAT_PCM (and PCM encapsulated in EXTENSIBLE).


I've attached tests that you may want to try out.  I've never
submitted them because they cause weird behaviour in Wine
(both incorrect duration and frequencies).
On native, they work fine, which shows that native ignores broken
nAvgBytesPerSec and nBlockAlign.

How does your OpenAL bridge behave with them?
You need WINETEST_INTERACTIVE=1 because it's essential to hear the sound.

Regards,
	J?rg H?hle


-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-winmm-tests-test-some-inconsistent-WAVEFORMAT-descr.patch
Type: application/octet-stream
Size: 5003 bytes
Desc: 0001-winmm-tests-test-some-inconsistent-WAVEFORMAT-descr.patch
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100507/d6d226a8/attachment-0001.obj>

From testbot at testbot.winehq.org  Sat May  8 06:19:29 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sat, 8 May 2010 13:19:29 +0200
Subject: Add tests for ImageGetDigestStream 
Message-ID: <201005081119.o48BJTDm021647@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1950

Your paranoid android.


=== W7PROX64 (64 bit image) ===
image.c:324: Test failed: ImageGetDigestStream failed: 87
image.c:187: Test failed: flags = 0: expected 7 updates, got 3
image.c:194: Test failed: flags = 0, update 2: unexpected value
image.c:187: Test failed: flags = CERT_PE_IMAGE_DIGEST_ALL_IMPORT_INFO: expected 5 updates, got 3
image.c:194: Test failed: flags = CERT_PE_IMAGE_DIGEST_ALL_IMPORT_INFO, update 2: unexpected value


From jacek at codeweavers.com  Sat May  8 06:45:07 2010
From: jacek at codeweavers.com (Jacek Caban)
Date: Sat, 08 May 2010 13:45:07 +0200
Subject: mshtml: Fix return type value for HTMLBodyElement_put_text.
In-Reply-To: <20100508110749.D5CD094333@pulcherrima.dbai.tuwien.ac.at>
References: <20100508110749.D5CD094333@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <4BE54EC3.5040509@codeweavers.com>

On 5/8/10 1:07 PM, Gerald Pfeifer wrote:
> The current code does not handle an error coming out of
> nsIDOMHTMLBodyElement_SetText and actually discards whatever nsres
> is set to.
>
> Jacek, is a patch like this okay, should we just remove nsres, or
> is it more complicated than that?
>    

We can't mix nsresult with HRESULT. We should check for failure and 
return something like E_FAIL (and preferably print an error, there is 
something seriously wrong if SetText fails).

Thanks,
     Jacek


From wylda at volny.cz  Sat May  8 07:33:28 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Sat, 08 May 2010 14:33:28 +0200 (CEST)
Subject: Compilation failure in wine-1.1.44
Message-ID: <43cb336733c0187434c4c5af96f6e20a@www3-mail.volny.cz>


Hi guys, i can't compile wine-1.1.44 (1.1.43 is OK here like all the
ones before)... As i guess you would not release a wine, which can't
be compiled, than i suspect there could be a trouble in my system (Debian
Lenny 32bit). For this reason, i did not bother to fill a bug ;) as
it would be marked invalid...

Any suggestion? I wanted to give some bugs a retest, but i'm stuck ;)

...
make[2]: Leaving directory `/home/pavel/install/wine/src/wine-1.1.44/tools'

gcc -c -I. -I. -I../../include -I../../include  -D__WINESRC__ -DWINE_UNICODE_API=""
-D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
-Wstrict-prototypes -Wtype-limits -Wwrite-strings -Wpointer-arith  -g
-O0  -o config.o ./config.c -DBINDIR='"/usr/local/bin"' -DDLLDIR='"/usr/local/lib/wine"'
-DLIB_TO_BINDIR=\"`../../tools/relpath /usr/local/lib /usr/local/bin`\"
-DLIB_TO_DLLDIR=\"`../../tools/relpath /usr/local/lib /usr/local/lib/wine`\"
-DBIN_TO_DLLDIR=\"`../../tools/relpath /usr/local/bin /usr/local/lib/wine`\"
-DBIN_TO_DATADIR=\"`../../tools/relpath /usr/local/bin /usr/local/share/wine`\"

gcc -c -I. -I. -I../../include -I../../include  -D__WINESRC__ -DWINE_UNICODE_API=""
-D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
-Wstrict-prototypes -Wtype-limits -Wwrite-strings -Wpointer-arith  -g
-O0  -o cptable.o cptable.c

gcc -c -I. -I. -I../../include -I../../include  -D__WINESRC__ -DWINE_UNICODE_API=""
-D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
-Wstrict-prototypes -Wtype-limits -Wwrite-strings -Wpointer-arith  -g
-O0  -o debug.o debug.c

gcc -c -I. -I. -I../../include -I../../include  -D__WINESRC__ -DWINE_UNICODE_API=""
-D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
-Wstrict-prototypes -Wtype-limits -Wwrite-strings -Wpointer-arith  -g
-O0  -o fold.o fold.c

gcc -c -I. -I. -I../../include -I../../include  -D__WINESRC__ -DWINE_UNICODE_API=""
-D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
-Wstrict-prototypes -Wtype-limits -Wwrite-strings -Wpointer-arith  -g
-O0  -o ldt.o ldt.c
{standard input}: Assembler messages:
{standard input}:1472: Error: symbol `wine_get_fs' is already defined
{standard input}:1502: Error: symbol `wine_set_fs' is already defined
make[1]: *** [ldt.o] Error 1
make[1]: Leaving directory `/home/pavel/install/wine/src/wine-1.1.44/libs/wine'
make: *** [libs/wine] Error 2




From thunderbird2k at gmail.com  Sat May  8 07:46:41 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Sat, 8 May 2010 14:46:41 +0200
Subject: Compilation failure in wine-1.1.44
In-Reply-To: <43cb336733c0187434c4c5af96f6e20a@www3-mail.volny.cz>
References: <43cb336733c0187434c4c5af96f6e20a@www3-mail.volny.cz>
Message-ID: <AANLkTil_VJPIW2nLLs6gkYp5IynsXjDDFOm5__Y_HFXQ@mail.gmail.com>

Yeah the -O0 bug was reported on #winehackers yesterday and will
likely be fixed soon. Compiling using -O2 (which is what you should
use by default anyway unless you have very good reasons not to) should
work fine.

Roderick

On Sat, May 8, 2010 at 2:33 PM,  <wylda at volny.cz> wrote:
>
> Hi guys, i can't compile wine-1.1.44 (1.1.43 is OK here like all the
> ones before)... As i guess you would not release a wine, which can't
> be compiled, than i suspect there could be a trouble in my system (Debian
> Lenny 32bit). For this reason, i did not bother to fill a bug ;) as
> it would be marked invalid...
>
> Any suggestion? I wanted to give some bugs a retest, but i'm stuck ;)
>
> ...
> make[2]: Leaving directory `/home/pavel/install/wine/src/wine-1.1.44/tools'
>
> gcc -c -I. -I. -I../../include -I../../include ?-D__WINESRC__ -DWINE_UNICODE_API=""
> -D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
> -Wstrict-prototypes -Wtype-limits -Wwrite-strings -Wpointer-arith ?-g
> -O0 ?-o config.o ./config.c -DBINDIR='"/usr/local/bin"' -DDLLDIR='"/usr/local/lib/wine"'
> -DLIB_TO_BINDIR=\"`../../tools/relpath /usr/local/lib /usr/local/bin`\"
> -DLIB_TO_DLLDIR=\"`../../tools/relpath /usr/local/lib /usr/local/lib/wine`\"
> -DBIN_TO_DLLDIR=\"`../../tools/relpath /usr/local/bin /usr/local/lib/wine`\"
> -DBIN_TO_DATADIR=\"`../../tools/relpath /usr/local/bin /usr/local/share/wine`\"
>
> gcc -c -I. -I. -I../../include -I../../include ?-D__WINESRC__ -DWINE_UNICODE_API=""
> -D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
> -Wstrict-prototypes -Wtype-limits -Wwrite-strings -Wpointer-arith ?-g
> -O0 ?-o cptable.o cptable.c
>
> gcc -c -I. -I. -I../../include -I../../include ?-D__WINESRC__ -DWINE_UNICODE_API=""
> -D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
> -Wstrict-prototypes -Wtype-limits -Wwrite-strings -Wpointer-arith ?-g
> -O0 ?-o debug.o debug.c
>
> gcc -c -I. -I. -I../../include -I../../include ?-D__WINESRC__ -DWINE_UNICODE_API=""
> -D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
> -Wstrict-prototypes -Wtype-limits -Wwrite-strings -Wpointer-arith ?-g
> -O0 ?-o fold.o fold.c
>
> gcc -c -I. -I. -I../../include -I../../include ?-D__WINESRC__ -DWINE_UNICODE_API=""
> -D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing -Wdeclaration-after-statement
> -Wstrict-prototypes -Wtype-limits -Wwrite-strings -Wpointer-arith ?-g
> -O0 ?-o ldt.o ldt.c
> {standard input}: Assembler messages:
> {standard input}:1472: Error: symbol `wine_get_fs' is already defined
> {standard input}:1502: Error: symbol `wine_set_fs' is already defined
> make[1]: *** [ldt.o] Error 1
> make[1]: Leaving directory `/home/pavel/install/wine/src/wine-1.1.44/libs/wine'
> make: *** [libs/wine] Error 2
>
>
>
>
>


From wylda at volny.cz  Sat May  8 08:02:48 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Sat, 08 May 2010 15:02:48 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_Compilation_failure_in_wine-1.1.44?=
In-Reply-To: <AANLkTil_VJPIW2nLLs6gkYp5IynsXjDDFOm5__Y_HFXQ@mail.gmail.com>
References: <43cb336733c0187434c4c5af96f6e20a@www3-mail.volny.cz>
	<AANLkTil_VJPIW2nLLs6gkYp5IynsXjDDFOm5__Y_HFXQ@mail.gmail.com>
Message-ID: <828950cbe9ae1d29c829ef08f56fd3ea@www3-mail.volny.cz>


> Roderick:
> Yeah the -O0 bug was reported on #winehackers yesterday
> and will likely be fixed soon.

Ah, ok :) I know you already test nearly everythink, but what about adding
another test -O{0,1,2,s,...}
a] before official release or
b] evening wine git update

> Compiling using -O2 (which is what you should use by default anyway
> > unless you have very good reasons not to) should work fine.

I quickly thing of these reasons why -O0
* better backtraces for bug reports
* faster compilation during bisection
* recommended for Valgrind
* my brain makes best optimalization, no need for buggy gcc :-D




From plr.vincent at gmail.com  Sat May  8 11:14:49 2010
From: plr.vincent at gmail.com (Vincent Pelletier)
Date: Sat, 8 May 2010 18:14:49 +0200
Subject: RFC kernel32: add test for FindFirstFileA with a path ending with "/>"
Message-ID: <201005081814.50817.plr.vincent@gmail.com>


This test passes on win2k & winxp, fails on wine.
That failure causes cdkey verification problems in "Earth 2160" as sold on 
GOG.com:
Once the installation is finished, the installers generates a registry key
value based (among other things) on the ctime of installed directory.
Looked-up path has trailing "/>", causing the registry key to be incorrect and 
the game rejects it.

I have no idea how to solve this error at the moment, nor the whole set of 
acceptable path trails. Please advise me if you have insight on this, and I'll 
see if I can fix it. This is the reason why I didn't add a todo_wine in the 
test.

---
 dlls/kernel32/tests/file.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-kernel32-add-test-for-FindFirstFileA-with-a-path-end.patch
Type: text/x-patch
Size: 800 bytes
Desc: not available
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100508/e62e8c07/attachment.bin>

From jacek at codeweavers.com  Sat May  8 11:36:20 2010
From: jacek at codeweavers.com (Jacek Caban)
Date: Sat, 08 May 2010 18:36:20 +0200
Subject: mshtml/tests: Fix return value of ActiveScript_SetScriptState.
In-Reply-To: <alpine.LSU.1.99.1005072344390.18670@pulcherrima.dbai.tuwien.ac.at>
References: <20100502191606.920AC94332@pulcherrima.dbai.tuwien.ac.at>
	<4BDEAFA4.1030101@codeweavers.com>
	<alpine.LSU.1.99.1005072344390.18670@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <4BE59304.9070007@codeweavers.com>

On 5/7/10 11:47 PM, Gerald Pfeifer wrote:
> On Mon, 3 May 2010, Jacek Caban wrote:
>    
>> On 5/2/10 9:16 PM, Gerald Pfeifer wrote:
>>      
>>> IActiveScriptSite_OnStateChange is described to return S_OK upon
>>> success, so instead of ignoring its return value and unconditionally
>>> returning S_OK it strikes me that we should return its result instead.
>>>        
>> In this case returning S_OK is fine, but there is missing test for
>> OnStateChange return value.
>>      
> Hmm, but if you look at the patch, in those cases we call OnStateChange,
> we actually pass on it's return value:
>
>      hres = IActiveScriptSite_OnStateChange(site, (state = ss));
>      return hres;
>
> And that is "S_OK if successful" according to MSDN.

It's a test, not a real script engine, we don't have to handle error 
paths, but test correct behavior instead.

> Perhaps you could follow up with a patch to refine what we have now?
>    

Sure, I've sent a patch.


Jacek


From marcus at jet.franken.de  Sat May  8 11:48:23 2010
From: marcus at jet.franken.de (Marcus Meissner)
Date: Sat, 8 May 2010 18:48:23 +0200
Subject: Compilation failure in wine-1.1.44
In-Reply-To: <828950cbe9ae1d29c829ef08f56fd3ea@www3-mail.volny.cz>
References: <43cb336733c0187434c4c5af96f6e20a@www3-mail.volny.cz>
	<AANLkTil_VJPIW2nLLs6gkYp5IynsXjDDFOm5__Y_HFXQ@mail.gmail.com>
	<828950cbe9ae1d29c829ef08f56fd3ea@www3-mail.volny.cz>
Message-ID: <20100508164822.GA28496@galeere.jet.franken.de>

On Sat, May 08, 2010 at 03:02:48PM +0200, wylda at volny.cz wrote:
> 
> > Roderick:
> > Yeah the -O0 bug was reported on #winehackers yesterday
> > and will likely be fixed soon.
> 
> Ah, ok :) I know you already test nearly everythink, but what about adding
> another test -O{0,1,2,s,...}
> a] before official release or
> b] evening wine git update
> 
> > Compiling using -O2 (which is what you should use by default anyway
> > > unless you have very good reasons not to) should work fine.
> 
> I quickly thing of these reasons why -O0
> * better backtraces for bug reports

-O2 works like a charm there too, at least for me.

> * faster compilation during bisection
> * recommended for Valgrind

-O2 works like a charm there too.

> * my brain makes best optimalization, no need for buggy gcc :-D

Also:
* Not testing the code under Release conditions.
* Slow code.

Ciao, Marcus


From testbot at testbot.winehq.org  Sat May  8 12:39:59 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sat, 8 May 2010 19:39:59 +0200
Subject: gdiplus: Implement bitmap color keying. 
Message-ID: <201005081739.o48HdxYf001227@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1955

Your paranoid android.


=== W2K3R2SESP2 (32 bit image) ===
No test summary line found

=== WVISTAADM (32 bit image) ===
Timeout


From nsivov at codeweavers.com  Sat May  8 13:31:02 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Sat, 08 May 2010 22:31:02 +0400
Subject: user32: Fix selected brush color for caret bitmap creation
In-Reply-To: <1273342825.22210.3.camel@nsivov.localdomain>
References: <1273342825.22210.3.camel@nsivov.localdomain>
Message-ID: <4BE5ADE6.9030706@codeweavers.com>

On 5/8/2010 22:20, Nikolay Sivov wrote:
> Fixes bug 1733.
>
> Selected brush color should depend on current window color or other system settings, it just inverts hdc colors.
(should -> shouldn't)



From julliard at winehq.org  Sat May  8 13:42:44 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Sat, 08 May 2010 20:42:44 +0200
Subject: Release plans
Message-ID: <87hbmii6aj.fsf@wine.dyndns.org>

Folks,

The 64-bit support is now more or less complete, and we have most of the
fancy new icons, so it's time to think about the next stable release.

Unless some major problems come up, 1.1.44 will be the last of the 1.1.x
series. The next release will be 1.2-rc1, which will mark the beginning
of the code freeze. This should result in a 1.2 final sometime in June.

As usual the code freeze will become more and more drastic as we get
closer to release, so if you have major changes to make, now is pretty
much the last minute.

I'd encourage everyone to look through the list of nominated 1.2 bugs,
and also to check the regression reports for anything that might be in
your area. We should strive to have as few regressions from 1.0 as
possible, so regressions fixes will have priority during code
freeze. And of course changes that don't impact the code, like
translations or test fixes, can go in until quite late.

-- 
Alexandre Julliard
julliard at winehq.org


From ngompa13 at gmail.com  Sat May  8 14:11:55 2010
From: ngompa13 at gmail.com (=?ISO-2022-JP?B?U2lyIEdhbGxhbnRtb24gKBskQiVLITwlayEmJTQlcyVRGyhCKQ==?=)
Date: Sat, 8 May 2010 14:11:55 -0500
Subject: Release plans
In-Reply-To: <87hbmii6aj.fsf@wine.dyndns.org>
References: <87hbmii6aj.fsf@wine.dyndns.org>
Message-ID: <AANLkTimKVbcc60Qz9dOfomnV1lPJCqBZdx9YOD66ObKs@mail.gmail.com>

On Sat, May 8, 2010 at 1:42 PM, Alexandre Julliard <julliard at winehq.org>wrote:

> Folks,
>
> The 64-bit support is now more or less complete, and we have most of the
> fancy new icons, so it's time to think about the next stable release.
>
> Unless some major problems come up, 1.1.44 will be the last of the 1.1.x
> series. The next release will be 1.2-rc1, which will mark the beginning
> of the code freeze. This should result in a 1.2 final sometime in June.
>
> As usual the code freeze will become more and more drastic as we get
> closer to release, so if you have major changes to make, now is pretty
> much the last minute.
>
> I'd encourage everyone to look through the list of nominated 1.2 bugs,
> and also to check the regression reports for anything that might be in
> your area. We should strive to have as few regressions from 1.0 as
> possible, so regressions fixes will have priority during code
> freeze. And of course changes that don't impact the code, like
> translations or test fixes, can go in until quite late.
>
> --
> Alexandre Julliard
> julliard at winehq.org
>
>
>
What do you mean by the 64-bit support being "more or less complete"?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100508/90ae02e4/attachment.htm>

From wylda at volny.cz  Sat May  8 15:21:04 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Sat, 08 May 2010 22:21:04 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_Compilation_failure_in_wine-1.1.44?=
In-Reply-To: <20100508164822.GA28496@galeere.jet.franken.de>
References: <43cb336733c0187434c4c5af96f6e20a@www3-mail.volny.cz>
	<AANLkTil_VJPIW2nLLs6gkYp5IynsXjDDFOm5__Y_HFXQ@mail.gmail.com>
	<828950cbe9ae1d29c829ef08f56fd3ea@www3-mail.volny.cz>
	<20100508164822.GA28496@galeere.jet.franken.de>
Message-ID: <4c8ee683aef0319ee143bd76a62bfc9a@www3-mail.volny.cz>

Hi Marcus,

> > * better backtraces for bug reports
>
> -O2 works like a charm there too, at least for me.

I think i read that somewhere and if i understood that correctly, my
conclusion at that time was, that -02 optimizes the code, so it can
"omit some" part of code and replace them by faster alternative. But
the debuging symbols then don't correspond such optimized code... And
even if i usually don't understand those backtraces, i want to provide
them as much readable for developer as possible.


> * Not testing the code under Release conditions.

I guess, that running Word2007 under linux/wine also does not meet release
conditions by Microsoft ;-) Anyway, i hope that if i run Win program
calculating PI on 4 decimal place, both -O0 and -02 will give me 3.1415


> * Slow code.

This line caused all this replay :) Because it does not says "How much".
So i did some benchmarking which maybe some others find useful.

Compilation of 1.1.43 -O0:
* real 1m 58sec

Compilation of 1.1.43 -O2:
* real 3m 29sec

i.e. -02 is 77% slower. So 10 round of regression test (with in-between
make distclean) is slower in case of -02 cca about 15m 10sec. That's
a lot especially if i want to take bug testing seriously.

Quake 3 1600x1200:
-O0: 215.0 FPS
-O2: 220.1 FPS (2% faster)

Quake 3 640x480:
-O0: 548.3 FPS
-O2: 581.0 FPS (6% faster)

As i'm not pro-gamer anymore and the -O2 results aren't convincing i'll
stay at -O0. Of course everyone has different needs and can find -O2
useful.

BTW: In case of game tests, i did at least five tests for each scenario.




From jjmckenzie51 at earthlink.net  Sat May  8 15:31:57 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Sat, 08 May 2010 13:31:57 -0700
Subject: Release plans
In-Reply-To: <87hbmii6aj.fsf@wine.dyndns.org>
References: <87hbmii6aj.fsf@wine.dyndns.org>
Message-ID: <4BE5CA3D.5030805@earthlink.net>

Alexandre Julliard wrote:
> Folks,
>
> The 64-bit support is now more or less complete, and we have most of the
> fancy new icons, so it's time to think about the next stable release.
>
> Unless some major problems come up, 1.1.44 will be the last of the 1.1.x
> series. The next release will be 1.2-rc1, which will mark the beginning
> of the code freeze. This should result in a 1.2 final sometime in June.
>
> As usual the code freeze will become more and more drastic as we get
> closer to release, so if you have major changes to make, now is pretty
> much the last minute.
>
> I'd encourage everyone to look through the list of nominated 1.2 bugs,
> and also to check the regression reports for anything that might be in
> your area. We should strive to have as few regressions from 1.0 as
> possible, so regressions fixes will have priority during code
> freeze. And of course changes that don't impact the code, like
> translations or test fixes, can go in until quite late.
>
>   
AJ:

I would be nice to include the URL as well for the 1.2 buglist.

James McKenzie



From austinenglish at gmail.com  Sat May  8 15:34:07 2010
From: austinenglish at gmail.com (Austin English)
Date: Sat, 8 May 2010 15:34:07 -0500
Subject: Release plans
In-Reply-To: <4BE5CA3D.5030805@earthlink.net>
References: <87hbmii6aj.fsf@wine.dyndns.org> <4BE5CA3D.5030805@earthlink.net>
Message-ID: <AANLkTimya2FkqM-y7KuGIG1TvoPlrTZZSKKMJmwwNa1X@mail.gmail.com>

On Sat, May 8, 2010 at 3:31 PM, James McKenzie
<jjmckenzie51 at earthlink.net> wrote:
> Alexandre Julliard wrote:
>>
>> Folks,
>>
>> The 64-bit support is now more or less complete, and we have most of the
>> fancy new icons, so it's time to think about the next stable release.
>>
>> Unless some major problems come up, 1.1.44 will be the last of the 1.1.x
>> series. The next release will be 1.2-rc1, which will mark the beginning
>> of the code freeze. This should result in a 1.2 final sometime in June.
>>
>> As usual the code freeze will become more and more drastic as we get
>> closer to release, so if you have major changes to make, now is pretty
>> much the last minute.
>>
>> I'd encourage everyone to look through the list of nominated 1.2 bugs,
>> and also to check the regression reports for anything that might be in
>> your area. We should strive to have as few regressions from 1.0 as
>> possible, so regressions fixes will have priority during code
>> freeze. And of course changes that don't impact the code, like
>> translations or test fixes, can go in until quite late.
>>
>>
>
> AJ:
>
> I would be nice to include the URL as well for the 1.2 buglist.

It's the first link on the tasklist in bugzilla:
http://bugs.winehq.org/buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&product=Wine&target_milestone=1.2.0&order=bugs.bug_severity

-- 
-Austin


From nsivov at codeweavers.com  Sat May  8 15:37:45 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Sun, 09 May 2010 00:37:45 +0400
Subject: Compilation failure in wine-1.1.44
In-Reply-To: <4c8ee683aef0319ee143bd76a62bfc9a@www3-mail.volny.cz>
References: <43cb336733c0187434c4c5af96f6e20a@www3-mail.volny.cz>	<AANLkTil_VJPIW2nLLs6gkYp5IynsXjDDFOm5__Y_HFXQ@mail.gmail.com>	<828950cbe9ae1d29c829ef08f56fd3ea@www3-mail.volny.cz>	<20100508164822.GA28496@galeere.jet.franken.de>
	<4c8ee683aef0319ee143bd76a62bfc9a@www3-mail.volny.cz>
Message-ID: <4BE5CB99.9060300@codeweavers.com>

On 5/9/2010 00:21, wylda at volny.cz wrote:
> Hi Marcus,
>
>    
>>> * better backtraces for bug reports
>>>        
>> -O2 works like a charm there too, at least for me.
>>      
> I think i read that somewhere and if i understood that correctly, my
> conclusion at that time was, that -02 optimizes the code, so it can
> "omit some" part of code and replace them by faster alternative. But
> the debuging symbols then don't correspond such optimized code... And
> even if i usually don't understand those backtraces, i want to provide
> them as much readable for developer as possible.
>    
It's mostly about a parameters printed in backtraces, with -O2 you'll 
see sometimes missed register
values replaced with <register EDI not in topmost frame> for example. 
Don't know about inline things,
probably it could be inlined anyway with -O0 too, but I'm not sure.





From twickline at gmail.com  Sat May  8 15:46:40 2010
From: twickline at gmail.com (Tom Wickline)
Date: Sun, 9 May 2010 04:46:40 +0800
Subject: Release plans
In-Reply-To: <AANLkTimya2FkqM-y7KuGIG1TvoPlrTZZSKKMJmwwNa1X@mail.gmail.com>
References: <87hbmii6aj.fsf@wine.dyndns.org> <4BE5CA3D.5030805@earthlink.net>
	<AANLkTimya2FkqM-y7KuGIG1TvoPlrTZZSKKMJmwwNa1X@mail.gmail.com>
Message-ID: <AANLkTilAyd_0KxURNvFtRDYEygCVJ-uF1eM6hK5u2so7@mail.gmail.com>

On Sun, May 9, 2010 at 4:34 AM, Austin English <austinenglish at gmail.com>wrote:

>
> It's the first link on the tasklist in bugzilla:
>
> http://bugs.winehq.org/buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&product=Wine&target_milestone=1.2.0&order=bugs.bug_severity
>
> --
> -Austin
>
>
>
Three releases to fix 88 nasty bugs?

--
Tom
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100509/f58c1ef8/attachment.htm>

From eric.pouech at orange.fr  Sat May  8 16:00:02 2010
From: eric.pouech at orange.fr (Eric Pouech)
Date: Sat, 08 May 2010 23:00:02 +0200
Subject: Compilation failure in wine-1.1.44
In-Reply-To: <4BE5CB99.9060300@codeweavers.com>
References: <43cb336733c0187434c4c5af96f6e20a@www3-mail.volny.cz>	<AANLkTil_VJPIW2nLLs6gkYp5IynsXjDDFOm5__Y_HFXQ@mail.gmail.com>	<828950cbe9ae1d29c829ef08f56fd3ea@www3-mail.volny.cz>	<20100508164822.GA28496@galeere.jet.franken.de>	<4c8ee683aef0319ee143bd76a62bfc9a@www3-mail.volny.cz>
	<4BE5CB99.9060300@codeweavers.com>
Message-ID: <4BE5D0D2.5030202@orange.fr>

Le 08/05/2010 22:37, Nikolay Sivov a ?crit :
>
> On 5/9/2010 00:21, wylda at volny.cz wrote:
>> Hi Marcus,
>>
>>>> * better backtraces for bug reports
>>> -O2 works like a charm there too, at least for me.
>> I think i read that somewhere and if i understood that correctly, my
>> conclusion at that time was, that -02 optimizes the code, so it can
>> "omit some" part of code and replace them by faster alternative. But
>> the debuging symbols then don't correspond such optimized code... And
>> even if i usually don't understand those backtraces, i want to provide
>> them as much readable for developer as possible.
> It's mostly about a parameters printed in backtraces, with -O2 you'll 
> see sometimes missed register
> values replaced with <register EDI not in topmost frame> for example. 
> Don't know about inline things,
> probably it could be inlined anyway with -O0 too, but I'm not sure.
>
>
this behavior is fixed with current git (except if gcc really optimizes 
things out, but wine now behaves as gcc, so you should be way less 
hindered by debugging with -O2 as you were)
A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)





From dank at kegel.com  Sat May  8 18:02:28 2010
From: dank at kegel.com (Dan Kegel)
Date: Sat, 8 May 2010 16:02:28 -0700
Subject: Release plans
Message-ID: <n2ja71bd89a1005081602n5b3068d3zd4d6ee7158667716@mail.gmail.com>

Tom Wickline wrote:
>> http://bugs.winehq.org/buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&product=Wine&target_milestone=1.2.0
>
> Three releases to fix 88 nasty bugs?

The sad fact is that it would take a lot more than that to fix them
all, and it probably doesn't make sense to hold up the release until
it's perfect.

We probably want to update
http://wiki.winehq.org/WineReleaseCriteria
with the current release criteria.

Some other interesting searches:

Bugs marked as 'regression' (340!):
http://bugs.winehq.org/buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&keywords_type=allwords&keywords=regression

Bugs marked 'bisected':
http://bugs.winehq.org/buglist.cgi?quicksearch=bisected

Anything A.F. has analyzed :
http://bugs.winehq.org/buglist.cgi?product=Wine&bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&emaillongdesc2=1&emailtype2=substring&email2=focht
- Dan


From twickline at gmail.com  Sat May  8 18:12:26 2010
From: twickline at gmail.com (Tom Wickline)
Date: Sun, 9 May 2010 07:12:26 +0800
Subject: Release plans
In-Reply-To: <n2ja71bd89a1005081602n5b3068d3zd4d6ee7158667716@mail.gmail.com>
References: <n2ja71bd89a1005081602n5b3068d3zd4d6ee7158667716@mail.gmail.com>
Message-ID: <AANLkTimWgfmKvRqrty4A1bCwwvWB74-HPLXbTcY9d2QC@mail.gmail.com>

On Sun, May 9, 2010 at 7:02 AM, Dan Kegel <dank at kegel.com> wrote:

> Tom Wickline wrote:
> >>
> http://bugs.winehq.org/buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&product=Wine&target_milestone=1.2.0
> >
> > Three releases to fix 88 nasty bugs?
>
> The sad fact is that it would take a lot more than that to fix them
> all, and it probably doesn't make sense to hold up the release until
> it's perfect.
>
> We probably want to update
> http://wiki.winehq.org/WineReleaseCriteria
> with the current release criteria.
>
> Some other interesting searches:
>
> Bugs marked as 'regression' (340!):
>
> http://bugs.winehq.org/buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&keywords_type=allwords&keywords=regression
>
> Bugs marked 'bisected':
> http://bugs.winehq.org/buglist.cgi?quicksearch=bisected
>
> Anything A.F. has analyzed :
>
> http://bugs.winehq.org/buglist.cgi?product=Wine&bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&emaillongdesc2=1&emailtype2=substring&email2=focht
> - Dan
>
>
> I thought the code freeze, RC cycle would be more like three months not
three releases, e.g six weeks.
But I'm 100% sure AJ knows best. :)

--
Tom
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100509/075e6658/attachment.htm>

From testbot at testbot.winehq.org  Sat May  8 19:27:24 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sun, 9 May 2010 02:27:24 +0200
Subject: [1/2] gdiplus: Add test for GdipGetImageThumbnail. 
Message-ID: <201005090027.o490ROhc029800@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1959

Your paranoid android.


=== W2K3R2SESP2 (32 bit image) ===
No test summary line found

=== WVISTAADM (32 bit image) ===
Timeout


From testbot at testbot.winehq.org  Sat May  8 19:38:15 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sun, 9 May 2010 02:38:15 +0200
Subject: [2/2] gdiplus: Implement GdipGetImageThumbnail. 
Message-ID: <201005090038.o490cFdF030069@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1960

Your paranoid android.


=== W2K3R2SESP2 (32 bit image) ===
No test summary line found

=== WVISTAADM (32 bit image) ===
Timeout


From madewokherd at gmail.com  Sat May  8 20:16:57 2010
From: madewokherd at gmail.com (Vincent Povirk)
Date: Sat, 8 May 2010 20:16:57 -0500
Subject: Release plans
In-Reply-To: <n2ja71bd89a1005081602n5b3068d3zd4d6ee7158667716@mail.gmail.com>
References: <n2ja71bd89a1005081602n5b3068d3zd4d6ee7158667716@mail.gmail.com>
Message-ID: <j2rced95fe1005081816s1d7cb7c4x205d884ba617404c@mail.gmail.com>

While we're linking to bug lists, this one seems most interesting to me:
http://bit.ly/bfOHK5

That's the list of major regressions introduced since 1.0-rc1.

Bug 13891 in particular will make us look bad if it's not fixed before
1.2. A lot of apps (as I understand it, any app that does it properly)
can't open url's anymore in the native browser, and this worked in
1.0.


From jjmckenzie51 at earthlink.net  Sat May  8 20:27:53 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Sat, 08 May 2010 18:27:53 -0700
Subject: Release plans
In-Reply-To: <j2rced95fe1005081816s1d7cb7c4x205d884ba617404c@mail.gmail.com>
References: <n2ja71bd89a1005081602n5b3068d3zd4d6ee7158667716@mail.gmail.com>
	<j2rced95fe1005081816s1d7cb7c4x205d884ba617404c@mail.gmail.com>
Message-ID: <4BE60F99.6090408@earthlink.net>

Vincent Povirk wrote:
> While we're linking to bug lists, this one seems most interesting to me:
> http://bit.ly/bfOHK5
>
> That's the list of major regressions introduced since 1.0-rc1.
>
> Bug 13891 in particular will make us look bad if it's not fixed before
> 1.2. A lot of apps (as I understand it, any app that does it properly)
> can't open url's anymore in the native browser, and this worked in
> 1.0.
>
>
>
>   
Vincent:

+1.  This is will be reported again and again. 

James McKenzie



From jjmckenzie51 at earthlink.net  Sat May  8 20:30:53 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Sat, 08 May 2010 18:30:53 -0700
Subject: Release plans
In-Reply-To: <j2rced95fe1005081816s1d7cb7c4x205d884ba617404c@mail.gmail.com>
References: <n2ja71bd89a1005081602n5b3068d3zd4d6ee7158667716@mail.gmail.com>
	<j2rced95fe1005081816s1d7cb7c4x205d884ba617404c@mail.gmail.com>
Message-ID: <4BE6104D.4010101@earthlink.net>

Vincent Povirk wrote:
> While we're linking to bug lists, this one seems most interesting to me:
> http://bit.ly/bfOHK5
>
> That's the list of major regressions introduced since 1.0-rc1.
>
> Bug 13891 in particular will make us look bad if it's not fixed before
> 1.2. A lot of apps (as I understand it, any app that does it properly)
> can't open url's anymore in the native browser, and this worked in
> 1.0.
>   
Actually, when I read through the report, it broke in 1.0-rc4 but worked 
in 0.9.52.  That is one old bug and aggravating too.

James McKenzie



From madewokherd at gmail.com  Sat May  8 20:32:13 2010
From: madewokherd at gmail.com (Vincent Povirk)
Date: Sat, 8 May 2010 20:32:13 -0500
Subject: Release plans
In-Reply-To: <4BE6104D.4010101@earthlink.net>
References: <n2ja71bd89a1005081602n5b3068d3zd4d6ee7158667716@mail.gmail.com>
	<j2rced95fe1005081816s1d7cb7c4x205d884ba617404c@mail.gmail.com>
	<4BE6104D.4010101@earthlink.net>
Message-ID: <m2wced95fe1005081832l6e1338c2z5ac608fba1b0a63c@mail.gmail.com>

> Actually, when I read through the report, it broke in 1.0-rc4 but worked in
> 0.9.52. ?That is one old bug and aggravating too.

You're right, so it didn't work in 1.0.

That's.. that might actually be worse.


From ehoover at mines.edu  Sat May  8 20:43:22 2010
From: ehoover at mines.edu (Erich Hoover)
Date: Sat, 8 May 2010 19:43:22 -0600
Subject: Release plans
In-Reply-To: <j2rced95fe1005081816s1d7cb7c4x205d884ba617404c@mail.gmail.com>
References: <n2ja71bd89a1005081602n5b3068d3zd4d6ee7158667716@mail.gmail.com>
	<j2rced95fe1005081816s1d7cb7c4x205d884ba617404c@mail.gmail.com>
Message-ID: <AANLkTina6UMwzfD7KyURwpeY4xHlJGWzUG5GmFImC5X-@mail.gmail.com>

On Sat, May 8, 2010 at 7:16 PM, Vincent Povirk <madewokherd at gmail.com>wrote:

> While we're linking to bug lists, this one seems most interesting to me:
> http://bit.ly/bfOHK5
>
> That's the list of major regressions introduced since 1.0-rc1.
> ...
>

What criteria did you use to build that list?  There's a bunch of recent
breakage in cursor support that make a lot of games very difficult to use.

Erich Hoover
ehoover at mines.edu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100508/295a64a5/attachment.htm>

From madewokherd at gmail.com  Sat May  8 21:04:42 2010
From: madewokherd at gmail.com (Vincent Povirk)
Date: Sat, 8 May 2010 21:04:42 -0500
Subject: Release plans
In-Reply-To: <AANLkTina6UMwzfD7KyURwpeY4xHlJGWzUG5GmFImC5X-@mail.gmail.com>
References: <n2ja71bd89a1005081602n5b3068d3zd4d6ee7158667716@mail.gmail.com>
	<j2rced95fe1005081816s1d7cb7c4x205d884ba617404c@mail.gmail.com>
	<AANLkTina6UMwzfD7KyURwpeY4xHlJGWzUG5GmFImC5X-@mail.gmail.com>
Message-ID: <g2uced95fe1005081904zde3bb967s978b704af5395c24@mail.gmail.com>

On Sat, May 8, 2010 at 8:43 PM, Erich Hoover <ehoover at mines.edu> wrote:
> On Sat, May 8, 2010 at 7:16 PM, Vincent Povirk <madewokherd at gmail.com>
> wrote:
>>
>> While we're linking to bug lists, this one seems most interesting to me:
>> http://bit.ly/bfOHK5
>>
>> That's the list of major regressions introduced since 1.0-rc1.
>> ...
>
> What criteria did you use to build that list? ?There's?a bunch of recent
> breakage in cursor support that make a lot of games very difficult to use.

Version >= 1.0-rc1
Severity >= major
Keywords include "regression"


From jjmckenzie51 at earthlink.net  Sat May  8 21:04:51 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Sat, 08 May 2010 19:04:51 -0700
Subject: Release plans
In-Reply-To: <m2wced95fe1005081832l6e1338c2z5ac608fba1b0a63c@mail.gmail.com>
References: <n2ja71bd89a1005081602n5b3068d3zd4d6ee7158667716@mail.gmail.com>	
	<j2rced95fe1005081816s1d7cb7c4x205d884ba617404c@mail.gmail.com>	
	<4BE6104D.4010101@earthlink.net>
	<m2wced95fe1005081832l6e1338c2z5ac608fba1b0a63c@mail.gmail.com>
Message-ID: <4BE61843.7050900@earthlink.net>

Vincent Povirk wrote:
>> Actually, when I read through the report, it broke in 1.0-rc4 but worked in
>> 0.9.52.  That is one old bug and aggravating too.
>>     
>
> You're right, so it didn't work in 1.0.
>
> That's.. that might actually be worse.
>
>   
Vincent:

This should be on the 1.2 todo list.  This really needs to be fixed and 
is/was the topic of a thread on the Wine-Users list recently.

James McKenzie



From shacklein at gmail.com  Sat May  8 22:09:12 2010
From: shacklein at gmail.com (Ben Klein)
Date: Sun, 9 May 2010 13:09:12 +1000
Subject: Compilation failure in wine-1.1.44
In-Reply-To: <4c8ee683aef0319ee143bd76a62bfc9a@www3-mail.volny.cz>
References: <43cb336733c0187434c4c5af96f6e20a@www3-mail.volny.cz> 
	<AANLkTil_VJPIW2nLLs6gkYp5IynsXjDDFOm5__Y_HFXQ@mail.gmail.com> 
	<828950cbe9ae1d29c829ef08f56fd3ea@www3-mail.volny.cz>
	<20100508164822.GA28496@galeere.jet.franken.de> 
	<4c8ee683aef0319ee143bd76a62bfc9a@www3-mail.volny.cz>
Message-ID: <AANLkTimi6q0mP5lxsikUt0Wc63UxS6b_P2lZODknO5yJ@mail.gmail.com>

On 9 May 2010 06:21,  <wylda at volny.cz> wrote:
> Hi Marcus,
>
>> > * better backtraces for bug reports
>>
>> -O2 works like a charm there too, at least for me.
>
> I think i read that somewhere and if i understood that correctly, my
> conclusion at that time was, that -02 optimizes the code, so it can
> "omit some" part of code and replace them by faster alternative. But
> the debuging symbols then don't correspond such optimized code... And
> even if i usually don't understand those backtraces, i want to provide
> them as much readable for developer as possible.

The debugging symbols do match to the optimised code, and refer you
back to the unoptimised line of source. Any cases where -O0 and -O2
give different results for backtraces are bugs in the gcc optimisation
code, not in Wine.

>> * Not testing the code under Release conditions.
>
> I guess, that running Word2007 under linux/wine also does not meet release
> conditions by Microsoft ;-) Anyway, i hope that if i run Win program
> calculating PI on 4 decimal place, both -O0 and -02 will give me 3.1415

The point is that Wine's code for releases is not compiled with -O0.
We don't want Word2007 bugs on bugs.winehq.org.

GCC's optimisation has nothing to do with accuracy; it's all to do
with speed. Speed of code execution is an issue primarily with latency
and race condition issues and/or bugs.

>> * Slow code.
>
> This line caused all this replay :) Because it does not says "How much".
> So i did some benchmarking which maybe some others find useful.
>
> Compilation of 1.1.43 -O0:
> * real 1m 58sec
>
> Compilation of 1.1.43 -O2:
> * real 3m 29sec
>
> i.e. -02 is 77% slower. So 10 round of regression test (with in-between
> make distclean) is slower in case of -02 cca about 15m 10sec. That's
> a lot especially if i want to take bug testing seriously.

"Slow code" and "slow compilation" are very different concerns.

For regression testing, make distclean is generally a bad idea as it
really does take a long time. Either way, ccache mitigates increases
in time, and -O0 may theoretically produce false positives for bug
testing where the issue is latency or race condition related.

> Quake 3 1600x1200:
> -O0: 215.0 FPS
> -O2: 220.1 FPS (2% faster)
>
> Quake 3 640x480:
> -O0: 548.3 FPS
> -O2: 581.0 FPS (6% faster)
>
> As i'm not pro-gamer anymore and the -O2 results aren't convincing i'll
> stay at -O0. Of course everyone has different needs and can find -O2
> useful.

I don't think Quake 3 counts as number-crunching. I imagine heavy
number-crunching apps would suffer significantly more with -O0.


From shacklein at gmail.com  Sun May  9 00:28:06 2010
From: shacklein at gmail.com (Ben Klein)
Date: Sun, 9 May 2010 15:28:06 +1000
Subject: Release plans
In-Reply-To: <AANLkTimKVbcc60Qz9dOfomnV1lPJCqBZdx9YOD66ObKs@mail.gmail.com>
References: <87hbmii6aj.fsf@wine.dyndns.org>
	<AANLkTimKVbcc60Qz9dOfomnV1lPJCqBZdx9YOD66ObKs@mail.gmail.com>
Message-ID: <AANLkTilN-CLOrqUFzyUNImWy8hzFesXFPeScC0UDjr7y@mail.gmail.com>

2010/5/9 Sir Gallantmon (???????) <ngompa13 at gmail.com>:
> On Sat, May 8, 2010 at 1:42 PM, Alexandre Julliard <julliard at winehq.org>
> wrote:
>>
>> Folks,
>>
>> The 64-bit support is now more or less complete, and we have most of the
>> fancy new icons, so it's time to think about the next stable release.
>
> What do you mean by the 64-bit support being "more or less complete"?

I'm more interested to know in the status of WoW64 in Wine. Can 64bit
and 32bit Wine be installed sensibly and concurrently?


From gerald at pfeifer.com  Fri May  7 15:49:31 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Fri, 7 May 2010 22:49:31 +0200 (CEST)
Subject: gdi32/tests: Remove two variables which are not really used from
	test_clipping.
In-Reply-To: <4BDE8D62.5090206@codeweavers.com>
References: <20100502234810.E9E7394332@pulcherrima.dbai.tuwien.ac.at>
	<4BDE8D62.5090206@codeweavers.com>
Message-ID: <alpine.LSU.1.99.1005072248460.18670@pulcherrima.dbai.tuwien.ac.at>

On Mon, 3 May 2010, Nikolay Sivov wrote:
> Bitmap are useless after this change.

I'll submit a patch which has this fixed.  Interestingly, at least on
my FreeBSD-based tester, test results did _not_ regress either way.

Gerald


From gerald at pfeifer.com  Fri May  7 16:47:33 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Fri, 7 May 2010 23:47:33 +0200 (CEST)
Subject: mshtml/tests: Fix return value of ActiveScript_SetScriptState.
In-Reply-To: <4BDEAFA4.1030101@codeweavers.com>
References: <20100502191606.920AC94332@pulcherrima.dbai.tuwien.ac.at>
	<4BDEAFA4.1030101@codeweavers.com>
Message-ID: <alpine.LSU.1.99.1005072344390.18670@pulcherrima.dbai.tuwien.ac.at>

On Mon, 3 May 2010, Jacek Caban wrote:
> On 5/2/10 9:16 PM, Gerald Pfeifer wrote:
>> IActiveScriptSite_OnStateChange is described to return S_OK upon
>> success, so instead of ignoring its return value and unconditionally
>> returning S_OK it strikes me that we should return its result instead.
> In this case returning S_OK is fine, but there is missing test for
> OnStateChange return value.

Hmm, but if you look at the patch, in those cases we call OnStateChange,
we actually pass on it's return value:

    hres = IActiveScriptSite_OnStateChange(site, (state = ss));
    return hres;

And that is "S_OK if successful" according to MSDN.  Perhaps you could
follow up with a patch to refine what we have now?

Gerald


From cdavis at mymail.mines.edu  Sun May  9 00:45:41 2010
From: cdavis at mymail.mines.edu (Charles Davis)
Date: Sat, 08 May 2010 23:45:41 -0600
Subject: Added check for PROCESS_VM_WRITE, without which, some programs
	go into an infinite loop Henry Blum <henry.blum@gmail.com>
In-Reply-To: <4BE4F24D.6030604@gmail.com>
References: <4BE4F24D.6030604@gmail.com>
Message-ID: <4BE64C05.2030707@mymail.mines.edu>

On 5/7/10 11:10 PM, Henry Blum wrote:
> -    if (status != STATUS_SUCCESS)
> +    if (status != STATUS_SUCCESS || (access & PROCESS_VM_WRITE))
According to this, opening a process and specifying the PROCESS_VM_WRITE
access right causes OpenProcess() to fail.

Why do you need this? And what about programs that legitimately need to
write to another process's VM?

Chip



From andrey.turkin at gmail.com  Sun May  9 00:51:09 2010
From: andrey.turkin at gmail.com (Andrey Turkin)
Date: Sun, 09 May 2010 09:51:09 +0400
Subject: Added check for PROCESS_VM_WRITE, without which, some programs
	go	into an infinite loop Henry Blum <henry.blum@gmail.com>
In-Reply-To: <4BE4F24D.6030604@gmail.com>
References: <4BE4F24D.6030604@gmail.com>
Message-ID: <4BE64D4D.7070804@gmail.com>

08.05.2010 9:10, Henry Blum wrote:
> ---
>  dlls/kernel32/process.c |    2 +-
>  1 files changed, 1 insertions(+), 1 deletions(-)
>
> diff --git a/dlls/kernel32/process.c b/dlls/kernel32/process.c
> index 9a1f2f5..6dcad8f 100644
> --- a/dlls/kernel32/process.c
> +++ b/dlls/kernel32/process.c
> @@ -2657,7 +2657,7 @@ HANDLE WINAPI OpenProcess( DWORD access, BOOL 
> inherit, DWORD id )
>      if (GetVersion() & 0x80000000) access = PROCESS_ALL_ACCESS;
>       status = NtOpenProcess(&handle, access, &attr, &cid);
> -    if (status != STATUS_SUCCESS)
> +    if (status != STATUS_SUCCESS || (access & PROCESS_VM_WRITE))
>      {
>          SetLastError( RtlNtStatusToDosError(status) );
>          return NULL;

Wouldn't this pretend operation failed for every request with 
PROCESS_VM_WRITE, even if NtOpenProcess succeeded, and leak a handle? 
Which bug should it fix?


From testbot at testbot.winehq.org  Sun May  9 01:26:56 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sun, 9 May 2010 08:26:56 +0200
Subject: localspl/tests: Improve the tests in test_XcvDataPort_AddPort by
	properly checking return values and avoiding a duplicat
Message-ID: <201005090626.o496QuwV006957@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1970

Your paranoid android.


=== WINEBUILD (build) ===
Patch failed


From testbot at testbot.winehq.org  Sun May  9 01:35:03 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sun, 9 May 2010 08:35:03 +0200
Subject: kernel32/tests: Remove variable ret which is not really used from
	load_blackbox. (RESEND) 
Message-ID: <201005090635.o496Z3Q5007667@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1969

Your paranoid android.


=== W7PROX64 (64 bit debugger) ===
debugger.c:299: Test failed: Timed out waiting for the child to crash
debugger.c:313: Test failed: wrong exit code : 00000103
debugger.c:324: Test failed: Timed out waiting for the debugger
debugger.c:146: Test failed: wrong size for 'C:\Users\winetest\AppData\Local\Temp\wt5825.tmp': read=0
debugger.c:329: Test failed: wrong debugger argument count: -28562032
debugger.c:330: Test failed: the child and debugged pids don't match: 660 != 2046
debugger.c:299: Test failed: Timed out waiting for the child to crash
debugger.c:306: Test failed: wrong exit code : 00000103
debugger.c:324: Test failed: Timed out waiting for the debugger
debugger.c:146: Test failed: wrong size for 'C:\Users\winetest\AppData\Local\Temp\wt2D25.tmp': read=0
debugger.c:329: Test failed: wrong debugger argument count: -28562032
debugger.c:330: Test failed: the child and debugged pids don't match: 1368 != 2046
Timeout


From wylda at volny.cz  Sun May  9 01:41:34 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Sun, 09 May 2010 08:41:34 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_Compilation_failure_in_wine-1.1.44?=
In-Reply-To: <AANLkTimi6q0mP5lxsikUt0Wc63UxS6b_P2lZODknO5yJ@mail.gmail.com>
References: <43cb336733c0187434c4c5af96f6e20a@www3-mail.volny.cz>
	<AANLkTil_VJPIW2nLLs6gkYp5IynsXjDDFOm5__Y_HFXQ@mail.gmail.com>
	<828950cbe9ae1d29c829ef08f56fd3ea@www3-mail.volny.cz>
	<20100508164822.GA28496@galeere.jet.franken.de>
	<4c8ee683aef0319ee143bd76a62bfc9a@www3-mail.volny.cz>
	<AANLkTimi6q0mP5lxsikUt0Wc63UxS6b_P2lZODknO5yJ@mail.gmail.com>
Message-ID: <03a84c17a0309d237fd4ef3494ff20bc@www3-mail.volny.cz>

Ben Klein:
> Any cases where -O0 and -O2 give different results for backtraces are
> > bugs in the gcc optimisation code, not in Wine.

And this was excatly one of the reasons, why use -O0. I do not want to
report gcc bugs in wine's bugzilla.

> Speed of code execution is an issue primarily with latency and race
> > condition issues and/or bugs.

Correct me, if i'm wrong, but these kind of wine bugs aren't "100%",
because they can be influenced by other thing. Can singlecore vs multicore
CPU has any impact for reproducibility??

Anyway, i'm only able to bisect bugs, which are always reproducible the
same way, so i can easily suite that results into bisect good/bad. Anything
beyond causes, that i leave such bug report (i'm mostly interested in
looking for some other's reported regression and their retest).

So as other people are reporting problem (99% ?? with default -02) and
i join such bug report with regression report from -O0, i shouldn't
mess bugzilla with rubbish.

> For regression testing, make distclean is generally
> a bad idea as it really does take a long time.

This is generally not true for example in between 1.1.30~.31 (if i remember
correctly). I was not able to find any game regression this way. I had
always "git bisect bad". Fixed by in between "make distclean".

> Either way, ccache mitigates increases in time, and -O0 may
> theoretically produce false positives for bug testing where the
> issue is latency or race condition related.

As i wrote above, i would probably avoid such bug report retest. And
also compare this (rare??) case with number of FP in bugzilla (all those
marked as INVALID, etc.). Hopefully bugzilla state is not getting worse
with my -O0 ;-)

> I don't think Quake 3 counts as number-crunching. I imagine heavy
> number-crunching apps would suffer significantly more with -O0.

Agree.




From testbot at testbot.winehq.org  Sun May  9 01:52:20 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sun, 9 May 2010 08:52:20 +0200
Subject: shell32/tests: Remove variable res which is not really used from
	init_strings. 
Message-ID: <201005090652.o496qKb6008718@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1972

Your paranoid android.


=== W2KPROSP4 (32 bit progman_dde) ===
progman_dde.c:442: Test failed: CreateGroup Group1: Expected Error DMLERR_NO_ERROR, received DMLERR_EXECACKTIMEOUT.  [C_G:2]

=== W2K3R2SESP2 (32 bit progman_dde) ===
progman_dde.c:507: Test failed: DeleteGroup Group1: Expected Error DMLERR_NO_ERROR, received DMLERR_EXECACKTIMEOUT.  [D_G:13]
progman_dde.c:587: Test failed: Compound String [CreateGroup(Group3)][AddItem(C:\WINDOWS\TEMP\dde14.tmp,f1g3Name)][AddItem(C:\WINDOWS\TEMP\dde15.tmp,f2g3Name)]: Expected Error DMLERR_NO_ERROR, received DMLERR_EXECACKTIMEOUT.  [CPD:14]
progman_dde.c:507: Test failed: DeleteGroup Group3: Expected Error DMLERR_NO_ERROR, received DMLERR_EXECACKTIMEOUT.  [D_G:15]

=== W7PRO (32 bit progman_dde) ===
progman_dde.c:369: Test failed: Window "Group1" was not created in 45 seconds - assumed failure.  [S_G:12]


From testbot at testbot.winehq.org  Sun May  9 02:14:42 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sun, 9 May 2010 09:14:42 +0200
Subject: user32/tests: Remove SetShellWindowEx from test_shell_window. 
Message-ID: <201005090714.o497EgqA010071@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1974

Your paranoid android.


=== W7PRO (32 bit win) ===
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 006C0178 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 006E0178 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00060138 fg 00010040 in hook HCBT_SETFOCUS
win.c:2664: Test failed: GetActiveWindow() = 00000000
win.c:2664: Test failed: GetFocus() = 00000000
win.c:2690: Test failed: GetActiveWindow() = 00000000
win.c:2690: Test failed: GetFocus() = 00000000
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 006F0178 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00080138 fg 00010040 in hook HCBT_SETFOCUS
win.c:2749: Test failed: GetActiveWindow() = 00000000
win.c:2749: Test failed: GetFocus() = 00000000
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 000B012C fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00310138 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00320138 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00060136 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 000A0136 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 000B0136 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00810178 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00020142 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 000B012C fg 00010040 in hook HCBT_SETFOCUS


From nsivov at codeweavers.com  Sun May  9 03:06:27 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Sun, 09 May 2010 12:06:27 +0400
Subject: wineps.drv: Remove variables scale_xx, scale_xy, scale_yx, and
	scale_yy and two dozen lines of dead code from append_complex_glyph.
In-Reply-To: <20100507213608.448C894333@pulcherrima.dbai.tuwien.ac.at>
References: <20100507213608.448C894333@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <4BE66D03.4090702@codeweavers.com>

On 5/8/2010 01:36, Gerald Pfeifer wrote:
> This one felt a bit like peeling an onion, but indeed while we have been
> setting those three variables, we're never using them.  And also ptr is
> not used beyond this point, so we can remove a bunch of dead code.
>    
I don't think it's dead. Variable ptr is used in a cycle.


From plr.vincent at gmail.com  Sun May  9 03:26:07 2010
From: plr.vincent at gmail.com (Vincent Pelletier)
Date: Sun, 9 May 2010 10:26:07 +0200
Subject: RFC kernel32: add test for FindFirstFileA with a path ending with
	"/>"
In-Reply-To: <201005081814.50817.plr.vincent@gmail.com>
References: <201005081814.50817.plr.vincent@gmail.com>
Message-ID: <201005091026.08354.plr.vincent@gmail.com>

Le samedi 08 mai 2010 18:14:49, Vincent Pelletier a ?crit :
> This test passes on win2k & winxp, fails on wine.

Bug opened for this issue:
http://bugs.winehq.org/show_bug.cgi?id=22635

Updated patch, with (too ?) many more test cases.
Interesting URLs:

http://msdn.microsoft.com/en-
us/library/aa365247%28VS.85%29.aspx#naming_conventions

http://msdn.microsoft.com/en-us/library/aa364418%28VS.85%29.aspx
  (especially "Bug?!" comment)

-- 
Vincent Pelletier
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-kernel32-add-test-for-FindFirstFileA-with-a-path-end.patch
Type: text/x-patch
Size: 5648 bytes
Desc: not available
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100509/e4884a1b/attachment.bin>

From Stefan.Leichter at camline.com  Sun May  9 04:05:55 2010
From: Stefan.Leichter at camline.com (Stefan Leichter)
Date: Sun, 9 May 2010 11:05:55 +0200
Subject: RFC kernel32: add test for FindFirstFileA with a path ending with
	"/>"
In-Reply-To: <201005091026.08354.plr.vincent@gmail.com>
References: <201005081814.50817.plr.vincent@gmail.com>
	<201005091026.08354.plr.vincent@gmail.com>
Message-ID: <201005091105.56042.Stefan.Leichter@camline.com>

Am Sunday 09 May 2010 10:26:07 schrieb Vincent Pelletier:
> This test passes on win2k & winxp, fails on wine.
>

Failing tests on wine needs to be marked with the todo_wine macro see 
http://www.winehq.org/site/docs/winedev-guide/testing-platforms and 
http://www.winehq.org/pipermail/wine-devel/2008-October/069721.html


From julliard at winehq.org  Sun May  9 04:26:41 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Sun, 09 May 2010 11:26:41 +0200
Subject: Release plans
In-Reply-To: <AANLkTilN-CLOrqUFzyUNImWy8hzFesXFPeScC0UDjr7y@mail.gmail.com>
	(Ben Klein's message of "Sun, 9 May 2010 15:28:06 +1000")
References: <87hbmii6aj.fsf@wine.dyndns.org>
	<AANLkTimKVbcc60Qz9dOfomnV1lPJCqBZdx9YOD66ObKs@mail.gmail.com>
	<AANLkTilN-CLOrqUFzyUNImWy8hzFesXFPeScC0UDjr7y@mail.gmail.com>
Message-ID: <877hndifxq.fsf@wine.dyndns.org>

Ben Klein <shacklein at gmail.com> writes:

> I'm more interested to know in the status of WoW64 in Wine. Can 64bit
> and 32bit Wine be installed sensibly and concurrently?

Yes, everything should work as expected now. Please test it.

-- 
Alexandre Julliard
julliard at winehq.org


From plr.vincent at gmail.com  Sun May  9 04:43:06 2010
From: plr.vincent at gmail.com (Vincent Pelletier)
Date: Sun, 9 May 2010 11:43:06 +0200
Subject: RFC kernel32: add test for FindFirstFileA with a path ending with
	"/>"
In-Reply-To: <201005091105.56042.Stefan.Leichter@camline.com>
References: <201005081814.50817.plr.vincent@gmail.com>
	<201005091026.08354.plr.vincent@gmail.com>
	<201005091105.56042.Stefan.Leichter@camline.com>
Message-ID: <201005091143.07081.plr.vincent@gmail.com>

Le dimanche 09 mai 2010 11:05:55, Stefan Leichter a ?crit :
> Failing tests on wine needs to be marked with the todo_wine macro

Yes, but as I said in my first mail I would prefer to get hints on how this 
should be fixed. I know nothing about path handling in wine, if it turns out 
to be trivial to fix I would like to include it in the patch.

-- 
Vincent Pelletier


From julliard at winehq.org  Sun May  9 04:43:41 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Sun, 09 May 2010 11:43:41 +0200
Subject: Release plans
In-Reply-To: <AANLkTimWgfmKvRqrty4A1bCwwvWB74-HPLXbTcY9d2QC@mail.gmail.com>
	(Tom Wickline's message of "Sun, 9 May 2010 07:12:26 +0800")
References: <n2ja71bd89a1005081602n5b3068d3zd4d6ee7158667716@mail.gmail.com>
	<AANLkTimWgfmKvRqrty4A1bCwwvWB74-HPLXbTcY9d2QC@mail.gmail.com>
Message-ID: <87vdaxh0ky.fsf@wine.dyndns.org>

Tom Wickline <twickline at gmail.com> writes:

> I thought the code freeze, RC cycle would be more like three months not
> three releases, e.g six weeks.
> But I'm 100% sure AJ knows best. :)

Nobody said it can't be three months. It will last as long as good fixes
keep pouring in. In practice after 1-2 months we usually run out of bugs
that can be reasonably fixed; at that point it wouldn't make sense to
hold the release for another month to get 3 extra fixes.

And like last time, I'm planning to make rc releases on a weekly
schedule, so we should get plenty of them.

-- 
Alexandre Julliard
julliard at winehq.org


From octavian.voicu at gmail.com  Sun May  9 07:17:43 2010
From: octavian.voicu at gmail.com (Octavian Voicu)
Date: Sun, 9 May 2010 15:17:43 +0300
Subject: Wine should warn when ulimit -n needs raising
Message-ID: <AANLkTimua7F3ioyacnmK9cJFfT4J2BBkHmPw-GDrMI94@mail.gmail.com>

I was looking at http://bugs.winehq.org/show_bug.cgi?id=19861 and it
seemed pretty easy to fix.

In my opinion, the warning should either go in server/file.c -
file_set_error() or in server/fd.c - open_fd().

open_fd() is pretty much the only place where open() is called, so
it's a good candidate.

On the other hand, having the check in file_set_error() might detect
the condition in more instances, but it might also impact performance
(file_set_error() is called really often; having lots of code in one
branch might make the compiler generate slower code).

The warning would go on the ENFILE/EMFILE branches, and maybe also
print the value of getrlimit(RLIMIT_NOFILE) and suggest a fix (editing
/etc/security/limits.conf).

Octavian


From eric.pouech at orange.fr  Sun May  9 07:52:12 2010
From: eric.pouech at orange.fr (Eric Pouech)
Date: Sun, 09 May 2010 14:52:12 +0200
Subject: RFC on console management
Message-ID: <4BE6AFFC.10609@orange.fr>

There are a couple of shortcomings in our current console
implementation. To name a few:
- the "bare console handles" concept has very short limitations (see
   bug reports #5541, or #13189). Globally, bare handles are actually
   handles to files, whereas lots of programs expect them to behave
   like console handles. Among the known shortcomings:
   + A1: GetFileType() returns wrong value,
   + A2: the console functions should return correct/default values,
     starting with codepage (in your xterm locale if UTF.8 for example,
     cmd output is bogus).
   + A3: no line edition is supported on bare handles

There are also issues with the wineconsole back-ends:
- B1: wineconsole --backend=curses mypgm.exe doesn't support the
   redirection of unix default handles (ie.
           wineconsole --backend=curses mypgm.exe > foo
   sends all ANSI escapes to the foo file, which isn't what we expect.
- B2: in Windows, a GUI program doesn't inherit the console of its
   parent (it only does if it's a CUI program)
- B3: when being nasty, one could create several wineconsole instances
   for the same TTY, whereas popular wisdom would claim that one is
   (more than) sufficient
- B4: console allocation and inheritance is not properly managed.
   Let's take the following example:
   + we have two exes (Cui and CuiChild), CuiChild being started by
     Cui. Cui is started from command line.
   + Cui does, in this order:
     FreeConsole
     AllocConsole
     CreateProcess("CuiChild")
     ExitProcess
   + AllocConsole spawns an instance of wineconsole, inheriting the
     Unix fd:s from Cui.
   + CuiChild inherits the wine console from it's parent
   + when Cui dies, it also, from the Unix standpoint detaches from the
     Unix console, and wineconsole loses access to the TTY as it's Unix
     parent has died. And we lose all input/output for all apps tied to
     this wineconsole.
- B5: job control. We poorly interact with unix console job control

I'd like to get feedback on the best way to go in order to put console
management on a reliable architecture.

Scenario I (aka Client side)
----------------------------
Create simple wineserver objects (ie not linked to wineconsole) for
bare console handles. All the management would be done in kernel32, by
distinguishing bare console handles from wineserver console handles.

Scenario II (aka Wineconsole side)
----------------------------------
Extend the current console objects in wineserver and wineconsole to
support a line oriented mode (instead of current mode which takes
control of the full screen for both curses and user backends).

Comparison (for each criteria, scenarios are ranked best to worse):
Size of changes:  I,II
ScI will require less changes

Maintainability:  II,I
- for ScII, in kernel32, we only deal with console objects, we all
   behave the same
- for ScII all term/termcap support is centralized in wineconsole (A3
   would require term/termcap to get the correct keys)

Speed:            I,II
- ScII will require app <=> wineserver <=> wineconsole messages in
   order to work (ScI will read all fd:s directly). ScII could be
   enhanced by having messages directly managed between app and
   wineconsole and bypassing wineserver, but still would be slower

Inheritance:      II,I
- all required mechanisms (except B4) would be similar
- for B4, ScI will be hard to implement, as we don't have an app that
will keep the control on the unix terminal until all children have
died. The most viable solutions (in the wording of B4 above):
       + don't exit Cui until all its children, grand children... have
         died. Possible to do, but we may want at some point to hide
         this running (Unix) app from the list of running (Windows)
         app, and this will be tricky
       + create a (Unix) wrapper app that will be kept open until all
         children have died. Possible but will hinder a lot the
         tracking/debugging tools (gdb, valgrind)
- it may be a bit simpler for ScII, as wineconsole could play the role
   of the controling app (but with potentially the same limitations)

Functionalities:  II,I
- ScII will ease the job control integration, as wineconsole would
   gain control of the unix terminal, and hence convert properly the
   unix events to the windows one.

I'd rather favor ScII, but the differences are not that big, so your
comments are welcome.

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)





From plr.vincent at gmail.com  Sun May  9 07:55:22 2010
From: plr.vincent at gmail.com (Vincent Pelletier)
Date: Sun, 9 May 2010 14:55:22 +0200
Subject: [PATCH] ntdll: Reimplement qsort() using generic mergesort
In-Reply-To: <4be6a9da.8680dc0a.47d3.3309SMTPIN_ADDED@mx.google.com>
References: <4be6a9da.8680dc0a.47d3.3309SMTPIN_ADDED@mx.google.com>
Message-ID: <201005091455.23807.plr.vincent@gmail.com>

Le dimanche 09 mai 2010 13:09:47, Marcus Meissner a ?crit :
> As __cdecl (for the compare function) is not the UNIX cdecl in Win64
> anymore, we need to reimplement sort to call the right comparator
> functions.

Not that it's important, but that reminded me of this:
  http://docs.python.org/library/ctypes.html#callback-functions
(scroll a bit for qsort example on windows vs. linux)

It would be interesting (though probably futile) to see how this code behaves.

-- 
Vincent Pelletier


From epssyis at gmail.com  Sun May  9 09:33:38 2010
From: epssyis at gmail.com (Edward Savage)
Date: Mon, 10 May 2010 00:33:38 +1000
Subject: Release plans
In-Reply-To: <87hbmii6aj.fsf@wine.dyndns.org>
References: <87hbmii6aj.fsf@wine.dyndns.org>
Message-ID: <n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>

On Sun, May 9, 2010 at 4:42 AM, Alexandre Julliard <julliard at winehq.org> wrote:
>
> Unless some major problems come up, 1.1.44 will be the last of the 1.1.x
> series. The next release will be 1.2-rc1, which will mark the beginning
> of the code freeze. This should result in a 1.2 final sometime in June.
>

Would it be worthwhile to put together some sort of release
announcement detailing changes and improvements in Wine between 1 and
1.2? Some thing similar to what other projects release that tech sites
can pickup and talk about.  Maybe even a more formal press release
style document.

If not I feel it might be good to have a page, nicely formatted with
graphics, that listed some applications that run as-native that people
not using Wine can try so that they become familiar with the
application.  We could easily compile a list of 10-15 popular platinum
applications that those who discredit Wine would be surprised run
well.  A small blurb and some nice screen shots of each application
with links to their respective Appdb and Wikipedia entries would be
good.

I am volunteering to organise some thing like this if wanted but it'd
have to be some thing people were comfortable with and like the idea
of.


From julliard at winehq.org  Sun May  9 10:00:36 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Sun, 09 May 2010 17:00:36 +0200
Subject: Release plans
In-Reply-To: <n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>
	(Edward Savage's message of "Mon, 10 May 2010 00:33:38 +1000")
References: <87hbmii6aj.fsf@wine.dyndns.org>
	<n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>
Message-ID: <87pr15glwr.fsf@wine.dyndns.org>

Edward Savage <epssyis at gmail.com> writes:

> On Sun, May 9, 2010 at 4:42 AM, Alexandre Julliard <julliard at winehq.org> wrote:
>>
>> Unless some major problems come up, 1.1.44 will be the last of the 1.1.x
>> series. The next release will be 1.2-rc1, which will mark the beginning
>> of the code freeze. This should result in a 1.2 final sometime in June.
>>
>
> Would it be worthwhile to put together some sort of release
> announcement detailing changes and improvements in Wine between 1 and
> 1.2? Some thing similar to what other projects release that tech sites
> can pickup and talk about.  Maybe even a more formal press release
> style document.

We definitely need a release changelog, yes.

-- 
Alexandre Julliard
julliard at winehq.org


From stefandoesinger at gmx.at  Sun May  9 11:34:18 2010
From: stefandoesinger at gmx.at (=?iso-8859-1?Q?Stefan_D=F6singer?=)
Date: Sun, 9 May 2010 18:34:18 +0200
Subject: wined3d: Make forced reading of a byte in
	flush_to_framebuffer_drawpixels more reliable.
In-Reply-To: <20100507212042.0817994333@pulcherrima.dbai.tuwien.ac.at>
References: <20100507212042.0817994333@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <FE572084-C33A-4475-A0C7-AA934257CE99@gmx.at>

I think this should be removed entirely. I added it in 2005 because Mesa back then choked on our protected memory(X server freeze or kernel panic). Around 2008 I checked if this bug still exists, and it seems to be fixed.

If anyone still runs into this bug he should seriously consider upgrading his Mesa installation...

Am 07.05.2010 um 23:20 schrieb Gerald Pfeifer:

> Looking at the current code in flush_to_framebuffer_drawpixels it occurs 
> to me that we really need to mark the memory we want to _read_ volatile, 
> not the local variable that is used to "force" reading said memory.
> 
> That is more direct, more logical, and even more efficient.
> 
> Looking at the generated code of all of dlls/wined3d/surface.c the
> only material difference is
> 
>  movb    %al, -25(%ebp)
> 
> which is saving the byte we are trying to read onto the stack and into
> the local variable.  And that is the part that indeed is not necessary.
> 
> Gerald
> 
> ---
> dlls/wined3d/surface.c |    3 +--
> 1 files changed, 1 insertions(+), 2 deletions(-)
> 
> diff --git a/dlls/wined3d/surface.c b/dlls/wined3d/surface.c
> index bb18b95..199a1bd 100644
> --- a/dlls/wined3d/surface.c
> +++ b/dlls/wined3d/surface.c
> @@ -1839,8 +1839,7 @@ static void flush_to_framebuffer_drawpixels(IWineD3DSurfaceImpl *This, GLenum fm
>      * ReleaseDC, and the app won't use the dc any more afterwards.
>      */
>     if((This->Flags & SFLAG_DIBSECTION) && !(This->Flags & SFLAG_PBO)) {
> -        volatile BYTE read;
> -        read = This->resource.allocatedMemory[0];
> +        *(volatile BYTE*)This->resource.allocatedMemory;
>     }
> 
>     if(This->Flags & SFLAG_PBO) {
> -- 
> 1.6.6.2
> 



From julliard at winehq.org  Sun May  9 12:23:00 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Sun, 09 May 2010 19:23:00 +0200
Subject: Wine should warn when ulimit -n needs raising
In-Reply-To: <AANLkTimua7F3ioyacnmK9cJFfT4J2BBkHmPw-GDrMI94@mail.gmail.com>
	(Octavian Voicu's message of "Sun, 9 May 2010 15:17:43 +0300")
References: <AANLkTimua7F3ioyacnmK9cJFfT4J2BBkHmPw-GDrMI94@mail.gmail.com>
Message-ID: <87d3x5gfbf.fsf@wine.dyndns.org>

Octavian Voicu <octavian.voicu at gmail.com> writes:

> I was looking at http://bugs.winehq.org/show_bug.cgi?id=19861 and it
> seemed pretty easy to fix.
>
> In my opinion, the warning should either go in server/file.c -
> file_set_error() or in server/fd.c - open_fd().

You can't print warnings from the server, they usually won't go where
you want them to.

-- 
Alexandre Julliard
julliard at winehq.org


From testbot at testbot.winehq.org  Sun May  9 14:44:20 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sun, 9 May 2010 21:44:20 +0200
Subject: shdocvw: implement IWebBrowser2::get_LocationName 
Message-ID: <201005091944.o49JiKt6015484@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1977

Your paranoid android.


=== W98SE (32 bit webbrowser) ===
webbrowser.c:1236: Test failed: unexpected call UpdateUI
webbrowser.c:315: Test failed: unexpected nsCmdID 21
webbrowser.c:259: Test failed: unexpected call QueryStatus_STOP

=== WNT4WSSP6 (32 bit webbrowser) ===
webbrowser.c:2497: Test failed: CoCreateInterface failed: 80040154
webbrowser.c:2497: Test failed: CoCreateInterface failed: 80040154


From octavian.voicu at gmail.com  Sun May  9 15:43:21 2010
From: octavian.voicu at gmail.com (Octavian Voicu)
Date: Sun, 9 May 2010 23:43:21 +0300
Subject: Wine should warn when ulimit -n needs raising
In-Reply-To: <87d3x5gfbf.fsf@wine.dyndns.org>
References: <AANLkTimua7F3ioyacnmK9cJFfT4J2BBkHmPw-GDrMI94@mail.gmail.com> 
	<87d3x5gfbf.fsf@wine.dyndns.org>
Message-ID: <AANLkTinBjCSiFmnJC0PAf-67bbWs9ZVioSKrUyRuSyt4@mail.gmail.com>

On Sun, May 9, 2010 at 8:23 PM, Alexandre Julliard <julliard at winehq.org> wrote:
> You can't print warnings from the server, they usually won't go where
> you want them to.

That's unfortunate. The only remaining place to do that is in
ntdll/FILE_CreateFile and check for status code
STATUS_TOO_MANY_OPENED_FILES.

We can't differentiate between ENFILE (the global open file limit was
reached, given by fs.file-max sysctl) and EMFILE (RLIMIT_NOFILE was
reached), but that wouldn't be a problem since ENFILE should be rare
enough and there's also a KERN_INFO message to inform of that).

Also, would it be ok to call getrlimit from ntdll, wrapped in a
HAVE_SETRLIMIT ifdef (which is already used in libs/wine/loader.c)?

Octavian


From gerald at pfeifer.com  Sun May  9 07:25:17 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Sun, 9 May 2010 14:25:17 +0200 (CEST)
Subject: Error handling in RpcBindingVectorFree (dlls/rpcrt4/rpc_binding.c)
Message-ID: <alpine.LSU.1.99.1005091421050.18670@pulcherrima.dbai.tuwien.ac.at>

Looking at 

  RPC_STATUS WINAPI RpcBindingVectorFree( RPC_BINDING_VECTOR** BindingVector )
  {
    RPC_STATUS status;
    ULONG c;

    TRACE("(%p)\n", BindingVector);
    for (c=0; c<(*BindingVector)->Count; c++) {
      status = RpcBindingFree(&(*BindingVector)->BindingH[c]);
    }
    HeapFree(GetProcessHeap(), 0, *BindingVector);
    *BindingVector = NULL;
    return RPC_S_OK;
  }

we currently always ignore the outcome of RpcBindingFree and return 
RPC_S_OK.

However, there is one case where RpcBindingFree returns something 
different (which is if *Binding is null when RPC_S_INVALID_BINDING
is returned).

What is the proper way of handling this?  Just keeping the code as
is and removing the unused status variable?  Breaking the loop once
RpcBindingFree returns something different from RPC_S_OK?  Continuing
and returning the first / the last status different from RPC_S_OK?

Gerald


From gerald at pfeifer.com  Sun May  9 09:12:49 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Sun, 9 May 2010 16:12:49 +0200 (CEST)
Subject: localspl/tests: Improve the tests in test_XcvDataPort_AddPort
	by properly checking return values and avoiding a duplicat
In-Reply-To: <201005090626.o496QuwV006957@v1.gse.nl>
References: <201005090626.o496QuwV006957@v1.gse.nl>
Message-ID: <alpine.LSU.1.99.1005091611340.18670@pulcherrima.dbai.tuwien.ac.at>

On Sun, 9 May 2010, testbot at testbot.winehq.org wrote:
> === WINEBUILD (build) === Patch failed

The issue was that a previous patch of mine (which got accepted)
conflicted and my local tree was not right.  Fixed and resubmitted,
testing at Wine Test Bot went well now:

  https://testbot.winehq.org/JobDetails.pl?Key=1975

Gerald


From henry.blum at gmail.com  Sun May  9 14:12:56 2010
From: henry.blum at gmail.com (Henry Blum)
Date: Sun, 09 May 2010 15:12:56 -0400
Subject: Added check for PROCESS_VM_WRITE, without which, some programs
	go	into an infinite loop Henry Blum <henry.blum@gmail.com>
In-Reply-To: <4BE64D4D.7070804@gmail.com>
References: <4BE4F24D.6030604@gmail.com>  <4BE64D4D.7070804@gmail.com>
Message-ID: <1273432376.3342.6.camel@Nokia-N900-42-11>

I looked further into the problem I set out to fix, and realize that this patch is pretty terrible. The real bug is 22006 http://bugs.winehq.org/show_bug.cgi?id=22006 and affects the game Continuum http://appdb.winehq.org/appview.php?iVersionId=3703 basically, OpenProcess doesn't enfore ACLs

I am a user of the game, and the instructions that other users have provided involve a patch which allow the game to function. I was applying the patch from the git source, and wanted to try my hand at submitting a patch. The patch provided is described in the appdb page, and I thought I would improve it. 

That patch (not the one I submitted) wouldn't leak any handles, since it returns null before attempting NtOpenProcess when (access & PROCESS_VM_WRITE). I'm not sure if that is proper behavior, but it still seems dangerous to me.

Long story short, please disregard this patch, and while I will continue my efforts, any suggestions on how to approach bug 22006 would be greatly appreciated.

Many thanks,
Henry Blum

----- Original message -----
> 08.05.2010 9:10, Henry Blum wrote:
> > ---
> >? dlls/kernel32/process.c |? ? ? 2 +-
> >? 1 files changed, 1 insertions(+), 1 deletions(-)
> >
> > diff --git a/dlls/kernel32/process.c b/dlls/kernel32/process.c
> > index 9a1f2f5..6dcad8f 100644
> > --- a/dlls/kernel32/process.c
> > +++ b/dlls/kernel32/process.c
> > @@ -2657,7 +2657,7 @@ HANDLE WINAPI OpenProcess( DWORD access, BOOL
> > inherit, DWORD id )
> >? ? ? ? ? if (GetVersion() & 0x80000000) access = PROCESS_ALL_ACCESS;
> >? ? ? ? ? ? status = NtOpenProcess(&handle, access, &attr, &cid);
> > -? ? ? if (status != STATUS_SUCCESS)
> > +? ? ? if (status != STATUS_SUCCESS || (access & PROCESS_VM_WRITE))
> >? ? ? ? ? {
> >? ? ? ? ? ? ? ? ? SetLastError( RtlNtStatusToDosError(status) );
> >? ? ? ? ? ? ? ? ? return NULL;
>
> Wouldn't this pretend operation failed for every request with
> PROCESS_VM_WRITE, even if NtOpenProcess succeeded, and leak a handle?
> Which bug should it fix?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100509/89624ae7/attachment.htm>

From testbot at testbot.winehq.org  Sun May  9 16:13:52 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sun, 9 May 2010 23:13:52 +0200
Subject: gdi32/tests: Add a test to check for ERROR_NOACCESS when passing
	an invalid buffer to GetObject 
Message-ID: <201005092113.o49LDqMt018249@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1981

Your paranoid android.


=== W98SE (32 bit gdiobj) ===
gdiobj.c:68: Test failed: GetObject(invalid buff), expected 0, ERROR_NOACCESS, got 0, 3735928559

=== WNT4WSSP6 (32 bit gdiobj) ===
gdiobj.c:68: Test failed: GetObject(invalid buff), expected 0, ERROR_NOACCESS, got 0, 3735928559

=== W2KPROSP4 (32 bit gdiobj) ===
gdiobj.c:68: Test failed: GetObject(invalid buff), expected 0, ERROR_NOACCESS, got 0, 3735928559

=== WXPPROSP3 (32 bit gdiobj) ===
gdiobj.c:68: Test failed: GetObject(invalid buff), expected 0, ERROR_NOACCESS, got 0, 3735928559

=== W2K3R2SESP2 (32 bit gdiobj) ===
gdiobj.c:68: Test failed: GetObject(invalid buff), expected 0, ERROR_NOACCESS, got 0, 3735928559

=== WVISTAADM (32 bit gdiobj) ===
gdiobj.c:68: Test failed: GetObject(invalid buff), expected 0, ERROR_NOACCESS, got 0, 3735928559

=== W2K8SE (32 bit gdiobj) ===
gdiobj.c:68: Test failed: GetObject(invalid buff), expected 0, ERROR_NOACCESS, got 0, 3735928559

=== W7PRO (32 bit gdiobj) ===
gdiobj.c:68: Test failed: GetObject(invalid buff), expected 0, ERROR_NOACCESS, got 0, 3735928559

=== W7PROX64 (64 bit gdiobj) ===
gdiobj.c:68: Test failed: GetObject(invalid buff), expected 0, ERROR_NOACCESS, got 0, 3735928559


From adys.wh at gmail.com  Sun May  9 16:15:03 2010
From: adys.wh at gmail.com (Jerome Leclanche)
Date: Mon, 10 May 2010 00:15:03 +0300
Subject: gdi32/tests: Add a test to check for ERROR_NOACCESS when passing 
	an invalid buffer to GetObject
In-Reply-To: <AANLkTinwazwDlIRiTxzKMaxG7TK5mY1uLB-IolorYohY@mail.gmail.com>
References: <AANLkTinwazwDlIRiTxzKMaxG7TK5mY1uLB-IolorYohY@mail.gmail.com>
Message-ID: <AANLkTikoXydPRLYuonRewkdiMkUmYnFBjbytN6KVgnRv@mail.gmail.com>

On Sun, May 9, 2010 at 11:55 PM, Jerome Leclanche <adys.wh at gmail.com> wrote:
> Testcase for bug 18864.
>
> J. Leclanche
>

This patch reveals a crash in GetObject in wine which I'm unsure how
to fix. Someone proposed using IsBadWritePtr(), but from what I
understand, this is not a recommended solution. Any idea?


From adys.wh at gmail.com  Sun May  9 16:18:53 2010
From: adys.wh at gmail.com (Jerome Leclanche)
Date: Mon, 10 May 2010 00:18:53 +0300
Subject: gdi32/tests: Add a test to check for ERROR_NOACCESS when passing 
	an invalid buffer to GetObject
In-Reply-To: <AANLkTikoXydPRLYuonRewkdiMkUmYnFBjbytN6KVgnRv@mail.gmail.com>
References: <AANLkTinwazwDlIRiTxzKMaxG7TK5mY1uLB-IolorYohY@mail.gmail.com> 
	<AANLkTikoXydPRLYuonRewkdiMkUmYnFBjbytN6KVgnRv@mail.gmail.com>
Message-ID: <AANLkTikmX3XfAhxHxC6WnyjLkwfrM4FGYNk1ykbkSoak@mail.gmail.com>

PS, please don't commit, the check is wrong. I'll resend it later.


J. Leclanche / Adys



On Mon, May 10, 2010 at 12:15 AM, Jerome Leclanche <adys.wh at gmail.com> wrote:
> On Sun, May 9, 2010 at 11:55 PM, Jerome Leclanche <adys.wh at gmail.com> wrote:
>> Testcase for bug 18864.
>>
>> J. Leclanche
>>
>
> This patch reveals a crash in GetObject in wine which I'm unsure how
> to fix. Someone proposed using IsBadWritePtr(), but from what I
> understand, this is not a recommended solution. Any idea?
>


From nsivov at codeweavers.com  Sun May  9 16:24:41 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Mon, 10 May 2010 01:24:41 +0400
Subject: comctl32: Simplify is_textT by omitting isW.
In-Reply-To: <20100509124349.8EA8294333@pulcherrima.dbai.tuwien.ac.at>
References: <20100509124349.8EA8294333@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <4BE72819.10201@codeweavers.com>

On 5/9/2010 16:43, Gerald Pfeifer wrote:
> isW is not actually used by is_textT, so we can simplify listview.c a
> bit by omitting the useless parameter.
>
>    

>
> -static inline BOOL is_textT(LPCWSTR text, BOOL isW)
> +static inline BOOL is_textT(LPCWSTR text)
>
>    
There's no reason to keep this helper then. It's better to rename 
is_textW() to is_text() and remove is_textT().


From testbot at testbot.winehq.org  Sun May  9 16:35:32 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sun, 9 May 2010 23:35:32 +0200
Subject: user32/tests: Remove variable atom which is not really used from
	test_Expose. 
Message-ID: <201005092135.o49LZWB6018925@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1983

Your paranoid android.


=== W7PRO (32 bit win) ===
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 006C0178 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 006E0178 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00060138 fg 00010040 in hook HCBT_SETFOCUS
win.c:2666: Test failed: GetActiveWindow() = 00000000
win.c:2666: Test failed: GetFocus() = 00000000
win.c:2692: Test failed: GetActiveWindow() = 00000000
win.c:2692: Test failed: GetFocus() = 00000000
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00070138 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00070136 fg 00010040 in hook HCBT_SETFOCUS
win.c:2751: Test failed: GetActiveWindow() = 00000000
win.c:2751: Test failed: GetFocus() = 00000000
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 0003015A fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00300136 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00310136 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 000301A0 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 000701A0 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 000801A0 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00190138 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00020142 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 0003015A fg 00010040 in hook HCBT_SETFOCUS


From fgouget at free.fr  Sun May  9 16:35:55 2010
From: fgouget at free.fr (Francois Gouget)
Date: Sun, 9 May 2010 23:35:55 +0200 (CEST)
Subject: Compilation failure in wine-1.1.44
In-Reply-To: <4c8ee683aef0319ee143bd76a62bfc9a@www3-mail.volny.cz>
References: <43cb336733c0187434c4c5af96f6e20a@www3-mail.volny.cz>
	<AANLkTil_VJPIW2nLLs6gkYp5IynsXjDDFOm5__Y_HFXQ@mail.gmail.com>
	<828950cbe9ae1d29c829ef08f56fd3ea@www3-mail.volny.cz>
	<20100508164822.GA28496@galeere.jet.franken.de>
	<4c8ee683aef0319ee143bd76a62bfc9a@www3-mail.volny.cz>
Message-ID: <alpine.DEB.2.00.1005092333530.11442@amboise.dolphin>

On Sat, 8 May 2010, wylda at volny.cz wrote:
[...]
> > * Not testing the code under Release conditions.
> 
> I guess, that running Word2007 under linux/wine also does not meet release
> conditions by Microsoft ;-) Anyway, i hope that if i run Win program
> calculating PI on 4 decimal place, both -O0 and -02 will give me 3.1415

It would be better if both gave 3.1416...


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                     Avoid the Gates of Hell - use Linux.


From marco at mandrivaclub.nl  Sun May  9 16:50:58 2010
From: marco at mandrivaclub.nl (marco)
Date: Sun, 09 May 2010 23:50:58 +0200
Subject: How to change text on winehq.org ?
In-Reply-To: <31283914.1273161466627.JavaMail.root@elwamui-muscovy.atl.sa.earthlink.net>
References: <31283914.1273161466627.JavaMail.root@elwamui-muscovy.atl.sa.earthlink.net>
Message-ID: <4BE72E42.9090105@mandrivaclub.nl>

Thank you all for your reply,

I'm not familiar with this process , but I will try to find out how this 
works.
Do I have to install git en download the complete source of the website, 
or can I only download the download.template change that and submit that 
somewhere ?

Marco


On 06-05-10 17:57, James Mckenzie wrote:
>> Hi WineDevs,
>>
>> If make the packages for mandriva on sourceforge. And the text on the
>> download page on the website (winehq,org) for mandriva is getting old.
>> Who can I write a mail to change the text ? I already tried web-admin ad
>> winehq.org some weeks ago but no reaction so far.
>>
>>      
> The source code for winehq is available.  You then make the changes you feel are necessary to the source code, create a difference file and submit this to wine-patches.
>
> Are you familiar with this process?
>
> James McKenzie
>
>
>    



From dank at kegel.com  Sun May  9 18:14:12 2010
From: dank at kegel.com (Dan Kegel)
Date: Sun, 9 May 2010 16:14:12 -0700
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
Message-ID: <o2ma71bd89a1005091614vd3dc6612s699904ae795c55e6@mail.gmail.com>

http://kegel.com/wine/yagmarkdata now has data from five different
benchmarks:
3dmark{2000, 2001, 06} and heaven2_{opengl, d3d9}, and running on a
semi-whimpy
e8400 dual core box with an nvidia gt 220 card, on both Vista and
Ubuntu+Wine.

First, the good news:
the OpenGL version of the Heaven benchmark achieved 99%
of the expected framerate on Wine, not bad, and it looks good, too.
The 3dmark* demos look good in general.

And now the bad news:
in general, Wine's D3D version achieves only half to three-quarters the
performance
of Vista's.
The Heaven D3D benchmark doesn't look right in quite a few ways (and
one regression is very recent), requires more video
ram than on Windows, and hangs at the end.
3dmark2001 has a strange water problem in the nature test at 30 seconds.
3dmark06 lacks shadows in the firefly forest.
Related bugs:
http://bugs.winehq.org/show_bug.cgi?id=5776
http://bugs.winehq.org/show_bug.cgi?id=20777
http://bugs.winehq.org/show_bug.cgi?id=22404
http://bugs.winehq.org/show_bug.cgi?id=22614
http://bugs.winehq.org/show_bug.cgi?id=22623

Yagmark is now in fairly good shape, please try it yourself; see
http://wiki.winehq.org/yagmark

The file http://kegel.com/wine/yagmarkdata/vista-vs-wine-1.1.44-19.txt
shows how wine does vs. vista.  Here's an excerpt (values given are
medians from six to ten runs):

From: dank at kegel.com; CPU: E8400; GPU: GT220
benchmark_variable                   Vista          wine-1.1.44-19 ratio
3dmark06_3DMark_Score                4868.00        3385.00        0.70
3dmark06_CPU1_Red_Valley             0.86           0.86           0.99
3dmark06_CPU_Score                   2740.00        2705.00        0.99
3dmark06_GT1_Return_To_Proxycon      17.43          13.28          0.76
3dmark06_GT2_Firefly_Forest          14.35          10.64          0.74
3dmark06_HDR1_Canyon_Flight          16.80          9.73           0.58
3dmark06_HDR2_Deep_Freeze            19.19          11.35          0.59
3dmark06_HDR_SM3_0_Score             1800.00        1053.00        0.58
3dmark06_SM2_0_Score                 1906.00        1433.00        0.75
3dmark2000_3DMark_Result             30262.00       17197.00       0.57
3dmark2000_CPU_Speed                 1227.00        1082.00        0.88
3dmark2000_Game_1_Helicopter_High    283.60         151.60         0.53
3dmark2000_Game_2_Adventure_High     215.10         142.20         0.66
3dmark2001_3DMark_Score              28289.00       15634.00       0.55
3dmark2001_Game_1_Car_Chase_High     78.80          38.20          0.48
3dmark2001_Game_2_Dragothic_High     321.30         159.10         0.50
3dmark2001_Game_3_Lobby_High         231.10         109.60         0.47
3dmark2001_Game_4_Nature             114.00         106.70         0.94
heaven2_d3d9_FPS                     18.38          9.30           0.51
heaven2_d3d9_Min_FPS                 9.73           5.74           0.59
heaven2_d3d9_Scores                  462.92         234.37         0.51
heaven2_gl_FPS                       16.20          16.12          0.99
heaven2_gl_Min_FPS                   10.16          9.33           0.92
heaven2_gl_Scores                    408.19         406.08         0.99

- Dan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100509/8acbd1a1/attachment.htm>

From dank at kegel.com  Sun May  9 19:46:37 2010
From: dank at kegel.com (Dan Kegel)
Date: Sun, 9 May 2010 17:46:37 -0700
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <o2ma71bd89a1005091614vd3dc6612s699904ae795c55e6@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
	<o2ma71bd89a1005091614vd3dc6612s699904ae795c55e6@mail.gmail.com>
Message-ID: <l2za71bd89a1005091746g66e4518bh5e5463261f60b5fd@mail.gmail.com>

On Sun, May 9, 2010 at 4:14 PM, Dan Kegel <dank at kegel.com> wrote:
> in general, Wine's D3D version achieves only half to three-quarters the performance
> of Vista's.

I just tried 'winetricks glsl-disable' on heaven2_d3d9.  It sped it up
about 8% (to 16.0 fps), but added some fun problems (e.g. scenes
7, 10, and 12 have a black sky).


From testbot at testbot.winehq.org  Sun May  9 21:23:53 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Mon, 10 May 2010 04:23:53 +0200
Subject: urlmon/tests: Added a new test file for testing the IUri
	interface 
Message-ID: <201005100223.o4A2Nr2G010928@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1987

Your paranoid android.


=== W98SE (32 bit uri) ===
Failure running script in VM: Exceeded timeout limit of 315 sec

=== W2KPROSP4 (32 bit uri) ===
Timeout

=== W2K3R2SESP2 (32 bit uri) ===
Timeout


From wine-devel at kievinfo.com  Sun May  9 22:22:21 2010
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 09 May 2010 21:22:21 -0600
Subject: How to change text on winehq.org ?
In-Reply-To: <4BE72E42.9090105@mandrivaclub.nl>
References: <31283914.1273161466627.JavaMail.root@elwamui-muscovy.atl.sa.earthlink.net>
	<4BE72E42.9090105@mandrivaclub.nl>
Message-ID: <4BE77BED.8050509@kievinfo.com>

On 05/09/2010 03:50 PM, marco wrote:
> Thank you all for your reply,
> 
> Do I have to install git en download the complete source of the website?
Yes and yes. Here is the page with lots of details:
http://wiki.winehq.org/GitWine

All you really need to do is:
1. Install git
2. Get WineHQ's source (assuming you want to put it into your home directory):
   $ cd ~
   $ git clone git://source.winehq.org/git/website.git
   $ cd website.git
3. Set your complete name and e-mail address as it would appear on all your
patches:
   $ git config --global user.name "Your Name"
   $ git config --global user.email "me at example.com"
4. Edit files as required
5. Make sure everything works.
6. Commit changes with:
   $ git commit -a
7. Create a patch to be sent to wine-patches mailing list:
   $ git format-patch --keep-subject HEAD^


Vitaliy.



From wine-devel at kievinfo.com  Sun May  9 22:28:00 2010
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 09 May 2010 21:28:00 -0600
Subject: Added check for PROCESS_VM_WRITE, without which, some programs
	go	into an infinite loop Henry Blum <henry.blum@gmail.com>
In-Reply-To: <1273432376.3342.6.camel@Nokia-N900-42-11>
References: <4BE4F24D.6030604@gmail.com> <4BE64D4D.7070804@gmail.com>
	<1273432376.3342.6.camel@Nokia-N900-42-11>
Message-ID: <4BE77D40.9000306@kievinfo.com>

On 05/09/2010 01:12 PM, Henry Blum wrote:
> I'm not sure if that is proper behavior
It's not. That patch is an outright hack specifically for your game.

The proper way to fix it is to send correct ACLs to the server when new
process is created. Wine still doesn't do it.

Vitaliy.


From wine-devel at kievinfo.com  Sun May  9 22:31:50 2010
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 09 May 2010 21:31:50 -0600
Subject: gdi32/tests: Add a test to check for ERROR_NOACCESS when passing
	an invalid buffer to GetObject
In-Reply-To: <AANLkTikoXydPRLYuonRewkdiMkUmYnFBjbytN6KVgnRv@mail.gmail.com>
References: <AANLkTinwazwDlIRiTxzKMaxG7TK5mY1uLB-IolorYohY@mail.gmail.com>
	<AANLkTikoXydPRLYuonRewkdiMkUmYnFBjbytN6KVgnRv@mail.gmail.com>
Message-ID: <4BE77E26.1050008@kievinfo.com>

On 05/09/2010 03:15 PM, Jerome Leclanche wrote:
> On Sun, May 9, 2010 at 11:55 PM, Jerome Leclanche <adys.wh at gmail.com> wrote:
>> Testcase for bug 18864.
>>
> This patch reveals a crash in GetObject in wine which I'm unsure how
> to fix. Someone proposed using IsBadWritePtr(), but from what I
> understand, this is not a recommended solution. Any idea?
If it doesn't crash on windows and you have a program that depends on broken
behavior - wrap the entire function with exception handler block. For
example see lstrcatA & co.

Vitaliy.


From wine-devel at kievinfo.com  Sun May  9 22:44:45 2010
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 09 May 2010 21:44:45 -0600
Subject: gdi32/tests: Remove variable oldPen which is not really used
	from test_widenpath.
In-Reply-To: <20100507190658.90E3194333@pulcherrima.dbai.tuwien.ac.at>
References: <20100507190658.90E3194333@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <4BE7812D.20504@kievinfo.com>

On 05/07/2010 01:06 PM, Gerald Pfeifer wrote:
> -    oldPen = SelectObject(hdc, greenPen);
> +    SelectObject(hdc, greenPen);
If it's not used it's a bug. Everything should be reset to original state to
prevent influence on following tests. There are number of such places in
Wine's test suite that makes it impossible to isolate the problem.

Vitaliy


From wine-devel at kievinfo.com  Sun May  9 22:54:13 2010
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Sun, 09 May 2010 21:54:13 -0600
Subject: comctl32: Remove unused parameter bEnable from LISTVIEW_Enable.
In-Reply-To: <20100509130602.F1D6694333@pulcherrima.dbai.tuwien.ac.at>
References: <20100509130602.F1D6694333@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <4BE78365.1090100@kievinfo.com>

On 05/09/2010 07:06 AM, Gerald Pfeifer wrote:
> ---
>    case WM_ENABLE:
> -    return LISTVIEW_Enable(infoPtr, (BOOL)wParam);
> +    return LISTVIEW_Enable(infoPtr);
This indicates a bug. The parameter should really be used by LISTVIEW_Enable().

Vitaliy.


From twickline at gmail.com  Mon May 10 02:49:44 2010
From: twickline at gmail.com (Tom Wickline)
Date: Mon, 10 May 2010 15:49:44 +0800
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <l2za71bd89a1005091746g66e4518bh5e5463261f60b5fd@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
	<o2ma71bd89a1005091614vd3dc6612s699904ae795c55e6@mail.gmail.com>
	<l2za71bd89a1005091746g66e4518bh5e5463261f60b5fd@mail.gmail.com>
Message-ID: <AANLkTil1uF0nd8UfIrR3yR99Kg-Q1L7Uqq5VMwZWXi0Z@mail.gmail.com>

On Mon, May 10, 2010 at 8:46 AM, Dan Kegel <dank at kegel.com> wrote:

> On Sun, May 9, 2010 at 4:14 PM, Dan Kegel <dank at kegel.com> wrote:
> > in general, Wine's D3D version achieves only half to three-quarters the
> performance
> > of Vista's.
>
> I just tried 'winetricks glsl-disable' on heaven2_d3d9.  It sped it up
> about 8% (to 16.0 fps), but added some fun problems (e.g. scenes
> 7, 10, and 12 have a black sky).
>
>
> Hello Dan,

May I ask why no 3Dmark 03 or 05 benchmark results?
Sorry if I missed a previous answer to this question.

Tom
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100510/b99dadad/attachment.htm>

From adys.wh at gmail.com  Mon May 10 02:59:45 2010
From: adys.wh at gmail.com (Jerome Leclanche)
Date: Mon, 10 May 2010 10:59:45 +0300
Subject: gdi32/tests: Add a test to check for ERROR_NOACCESS when passing 
	an invalid buffer to GetObject
In-Reply-To: <4BE77E26.1050008@kievinfo.com>
References: <AANLkTinwazwDlIRiTxzKMaxG7TK5mY1uLB-IolorYohY@mail.gmail.com> 
	<AANLkTikoXydPRLYuonRewkdiMkUmYnFBjbytN6KVgnRv@mail.gmail.com> 
	<4BE77E26.1050008@kievinfo.com>
Message-ID: <AANLkTikNYRY_StgjU4PAMw41ozOhRTY00XMu-7g0Mspz@mail.gmail.com>

I just tried messing around with it, but all I can get is a timeout
like this in the tests:
err:ntdll:RtlpWaitForCriticalSection section 0x688add20 "gdiobj.c:
gdi_section" wait timed out in thread 0024, blocked by 0023, retrying
(60 sec)

Or worse, a crash in the app:
err:gdi:GDI_CheckNotLock BUG: holding GDI lock
wine: Unhandled exception 0x80000003 at address 0x7edebb63 (thread
0009), starting debugger...
DebugBreak () at /home/adys/src/wine/dlls/kernel32/../../include/winternl.h:1957
0x7edebb63 DebugBreak+0x3
[/home/adys/src/wine/dlls/kernel32/../../include/winternl.h:1957] in
kernel32: int    $3
1957    static inline void WINAPI DbgBreakPoint(void) { __asm__
__volatile__("int3"); }

What am I missing?


J. Leclanche



On Mon, May 10, 2010 at 6:31 AM, Vitaliy Margolen
<wine-devel at kievinfo.com> wrote:
> On 05/09/2010 03:15 PM, Jerome Leclanche wrote:
>> On Sun, May 9, 2010 at 11:55 PM, Jerome Leclanche <adys.wh at gmail.com> wrote:
>>> Testcase for bug 18864.
>>>
>> This patch reveals a crash in GetObject in wine which I'm unsure how
>> to fix. Someone proposed using IsBadWritePtr(), but from what I
>> understand, this is not a recommended solution. Any idea?
> If it doesn't crash on windows and you have a program that depends on broken
> behavior - wrap the entire function with exception handler block. For
> example see lstrcatA & co.
>
> Vitaliy.
>


From julliard at winehq.org  Mon May 10 03:56:34 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 10 May 2010 10:56:34 +0200
Subject: Release plans
In-Reply-To: <4BE79408.9010106@yahoo.co.uk> (Hin-Tak Leung's message of "Mon, 
	10 May 2010 06:05:12 +0100")
References: <87hbmii6aj.fsf@wine.dyndns.org>
	<AANLkTimKVbcc60Qz9dOfomnV1lPJCqBZdx9YOD66ObKs@mail.gmail.com>
	<AANLkTilN-CLOrqUFzyUNImWy8hzFesXFPeScC0UDjr7y@mail.gmail.com>
	<877hndifxq.fsf@wine.dyndns.org> <4BE79408.9010106@yahoo.co.uk>
Message-ID: <877hncgmnx.fsf@wine.dyndns.org>

Hin-Tak Leung <hintak_leung at yahoo.co.uk> writes:

> Alexandre Julliard wrote:
>> Ben Klein <shacklein at gmail.com> writes:
>>
>>> I'm more interested to know in the status of WoW64 in Wine. Can 64bit
>>> and 32bit Wine be installed sensibly and concurrently?
>>
>> Yes, everything should work as expected now. Please test it.
>
> The last time I checked it was possible to re-use an old wineprefix
> (created by 32-bit wine under x86_64 platform) with 64-bit wine - is
> it still the case? My .wine is a bit big and I'd hate to have to
> re-create it... :-(.

You can use a 32-bit prefix with 64-bit Wine, but of course only in
32-bit mode, you won't be able to run 64-bit apps with it.

-- 
Alexandre Julliard
julliard at winehq.org


From paulc at voip.null.ro  Mon May 10 04:10:03 2010
From: paulc at voip.null.ro (Paul Chitescu)
Date: Mon, 10 May 2010 12:10:03 +0300
Subject: CVS repository problem
Message-ID: <201005101210.04061.paulc@voip.null.ro>

Hi!

Something is - again - wrong with CVS. Although I fetched a wine with git I 
tried to verify some patches I had in the CVS tree.

cvs -z3 -q up -APd

cvs update: failed to create lock directory for `/home/wine/wine/dlls/acledit' 
(/home/wine/wine/dlls/acledit/#cvs.lock): Permission denied
cvs update: failed to obtain dir lock in repository 
`/home/wine/wine/dlls/acledit'
cvs [update aborted]: read lock failed - giving up

Maybe a chown -R would help?


Paul Chitescu


From julliard at winehq.org  Mon May 10 04:50:56 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 10 May 2010 11:50:56 +0200
Subject: CVS repository problem
In-Reply-To: <201005101210.04061.paulc@voip.null.ro> (Paul Chitescu's message
	of "Mon, 10 May 2010 12:10:03 +0300")
References: <201005101210.04061.paulc@voip.null.ro>
Message-ID: <87y6fsf5kv.fsf@wine.dyndns.org>

Paul Chitescu <paulc at voip.null.ro> writes:

> Something is - again - wrong with CVS. Although I fetched a wine with git I 
> tried to verify some patches I had in the CVS tree.
>
> cvs -z3 -q up -APd
>
> cvs update: failed to create lock directory for `/home/wine/wine/dlls/acledit' 
> (/home/wine/wine/dlls/acledit/#cvs.lock): Permission denied
> cvs update: failed to obtain dir lock in repository 
> `/home/wine/wine/dlls/acledit'
> cvs [update aborted]: read lock failed - giving up
>
> Maybe a chown -R would help?

I tried to fix the CVS gateway this weekend, but apparently it doesn't
quite work yet. I tried to fix the permissions now, we'll see. If it
still doesn't work I'm going to pull the plug on it, I don't want to
waste more time maintaining that stuff.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Mon May 10 05:06:07 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 10 May 2010 12:06:07 +0200
Subject: RFC on console management
In-Reply-To: <4BE6AFFC.10609@orange.fr> (Eric Pouech's message of "Sun, 09 May
	2010 14:52:12 +0200")
References: <4BE6AFFC.10609@orange.fr>
Message-ID: <87tyqgf4vk.fsf@wine.dyndns.org>

Eric Pouech <eric.pouech at orange.fr> writes:

> Scenario I (aka Client side)
> ----------------------------
> Create simple wineserver objects (ie not linked to wineconsole) for
> bare console handles. All the management would be done in kernel32, by
> distinguishing bare console handles from wineserver console handles.

This seems preferable, if it can be done without making the kernel32
code too ugly.

-- 
Alexandre Julliard
julliard at winehq.org


From gerald at pfeifer.com  Sun May  9 16:42:34 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Sun, 9 May 2010 23:42:34 +0200 (CEST)
Subject: user32/tests: Remove SetShellWindowEx from test_shell_window. 
In-Reply-To: <201005090714.o497EgqA010071@v1.gse.nl>
References: <201005090714.o497EgqA010071@v1.gse.nl>
Message-ID: <alpine.LSU.1.99.1005092341340.26362@acrux.dbai.tuwien.ac.at>

On Sun, 9 May 2010, testbot at testbot.winehq.org wrote:
> While running your changed tests on Windows, I think I found new 
> failures. Being a bot and all I'm not very good at pattern recognition, 
> so I might be wrong, but could you please double-check? Full results can 
> be found at http://testbot.winehq.org/JobDetails.pl?Key=1974

That really cannot be related to my test (unless there is some most
subtle timing issue involved, perhaps, which is completel unrelated).

It appears as if these tests all run into problems on the W7 flavor,
regardless and independently of my patch.

Gerald


From gerald at pfeifer.com  Sun May  9 16:43:41 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Sun, 9 May 2010 23:43:41 +0200 (CEST)
Subject: user32/tests: Remove variable atom which is not really used from
	test_Expose. 
In-Reply-To: <201005092135.o49LZWB6018925@v1.gse.nl>
References: <201005092135.o49LZWB6018925@v1.gse.nl>
Message-ID: <alpine.LSU.1.99.1005092343100.26362@acrux.dbai.tuwien.ac.at>

On Sun, 9 May 2010, testbot at testbot.winehq.org wrote:
> Full results can be found at
> http://testbot.winehq.org/JobDetails.pl?Key=1983

Another false positive.

  W7PRO                completed 39
  W7PROX64             completed 19
  W7PROX64             completed 19

...is the same before and after this patch of mine.

Gerald


From hintak_leung at yahoo.co.uk  Mon May 10 00:05:12 2010
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Mon, 10 May 2010 06:05:12 +0100
Subject: Release plans
In-Reply-To: <877hndifxq.fsf@wine.dyndns.org>
References: <87hbmii6aj.fsf@wine.dyndns.org>	<AANLkTimKVbcc60Qz9dOfomnV1lPJCqBZdx9YOD66ObKs@mail.gmail.com>	<AANLkTilN-CLOrqUFzyUNImWy8hzFesXFPeScC0UDjr7y@mail.gmail.com>
	<877hndifxq.fsf@wine.dyndns.org>
Message-ID: <4BE79408.9010106@yahoo.co.uk>

Alexandre Julliard wrote:
> Ben Klein <shacklein at gmail.com> writes:
> 
>> I'm more interested to know in the status of WoW64 in Wine. Can 64bit
>> and 32bit Wine be installed sensibly and concurrently?
> 
> Yes, everything should work as expected now. Please test it.

The last time I checked it was possible to re-use an old wineprefix (created by 
32-bit wine under x86_64 platform) with 64-bit wine - is it still the case? My 
.wine is a bit big and I'd hate to have to re-create it... :-(.

Hin-Tak



From paulc at voip.null.ro  Mon May 10 05:40:43 2010
From: paulc at voip.null.ro (Paul Chitescu)
Date: Mon, 10 May 2010 13:40:43 +0300
Subject: CVS repository problem
In-Reply-To: <87y6fsf5kv.fsf@wine.dyndns.org>
References: <201005101210.04061.paulc@voip.null.ro>
	<87y6fsf5kv.fsf@wine.dyndns.org>
Message-ID: <201005101340.44087.paulc@voip.null.ro>

On Monday 10 May 2010 12:50:56 pm Alexandre Julliard wrote:
> Paul Chitescu <paulc at voip.null.ro> writes:
> 
> > Something is - again - wrong with CVS. Although I fetched a wine with git 
I 
> > tried to verify some patches I had in the CVS tree.
> >
> > cvs -z3 -q up -APd
> >
> > cvs update: failed to create lock directory for 
`/home/wine/wine/dlls/acledit' 
> > (/home/wine/wine/dlls/acledit/#cvs.lock): Permission denied
> > cvs update: failed to obtain dir lock in repository 
> > `/home/wine/wine/dlls/acledit'
> > cvs [update aborted]: read lock failed - giving up
> >
> > Maybe a chown -R would help?
> 
> I tried to fix the CVS gateway this weekend, but apparently it doesn't
> quite work yet. I tried to fix the permissions now, we'll see. If it
> still doesn't work I'm going to pull the plug on it, I don't want to
> waste more time maintaining that stuff.
> 
> -- 
> Alexandre Julliard
> julliard at winehq.org

Seems fixed now, thanks.

Paul



From jacek at codeweavers.com  Mon May 10 06:02:17 2010
From: jacek at codeweavers.com (Jacek Caban)
Date: Mon, 10 May 2010 13:02:17 +0200
Subject: shdocvw: implement IWebBrowser2::get_LocationName
In-Reply-To: <4BE70D5D.2000700@gmail.com>
References: <4BE70D5D.2000700@gmail.com>
Message-ID: <4BE7E7B9.3020305@codeweavers.com>

Hi Andrey,

On 5/9/10 9:30 PM, Andrey Turkin wrote:
> ---
>  dlls/shdocvw/tests/webbrowser.c |   27 ++++++++++++++++++++++++---
>  dlls/shdocvw/webbrowser.c       |   24 ++++++++++++++++++++++--
>  2 files changed, 46 insertions(+), 5 deletions(-)

+    if (This->doc_host.document&&  SUCCEEDED(IUnknown_QueryInterface(
+            This->doc_host.document,&IID_IHTMLDocument2, (void**)&doc))) {
+        hres = IHTMLDocument2_get_title(doc, LocationName);
+        IHTMLDocument2_Release(doc);


There is no reason to make this MSHTML-specific by using IHTMLDocument2 
here.

Jacek


From andrey.turkin at gmail.com  Mon May 10 06:48:06 2010
From: andrey.turkin at gmail.com (Andrey Turkin)
Date: Mon, 10 May 2010 15:48:06 +0400
Subject: shdocvw: implement IWebBrowser2::get_LocationName
In-Reply-To: <4BE7E7B9.3020305@codeweavers.com>
References: <4BE70D5D.2000700@gmail.com> <4BE7E7B9.3020305@codeweavers.com>
Message-ID: <4BE7F276.6030608@gmail.com>

10.05.2010 15:02, Jacek Caban wrote:
> Hi Andrey,
>
> On 5/9/10 9:30 PM, Andrey Turkin wrote:
>> ---
>>  dlls/shdocvw/tests/webbrowser.c |   27 ++++++++++++++++++++++++---
>>  dlls/shdocvw/webbrowser.c       |   24 ++++++++++++++++++++++--
>>  2 files changed, 46 insertions(+), 5 deletions(-)
>
> +    if (This->doc_host.document&&  SUCCEEDED(IUnknown_QueryInterface(
> +            This->doc_host.document,&IID_IHTMLDocument2, 
> (void**)&doc))) {
> +        hres = IHTMLDocument2_get_title(doc, LocationName);
> +        IHTMLDocument2_Release(doc);
>
>
> There is no reason to make this MSHTML-specific by using 
> IHTMLDocument2 here.
>
> Jacek
>
If there is more generic way to get HTML title for the document then it 
certainly can be used instead; I just don't know any - hints/suggestions 
would be welcome.


From dank at kegel.com  Mon May 10 07:49:23 2010
From: dank at kegel.com (Dan Kegel)
Date: Mon, 10 May 2010 05:49:23 -0700
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <AANLkTil1uF0nd8UfIrR3yR99Kg-Q1L7Uqq5VMwZWXi0Z@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
	<o2ma71bd89a1005091614vd3dc6612s699904ae795c55e6@mail.gmail.com>
	<l2za71bd89a1005091746g66e4518bh5e5463261f60b5fd@mail.gmail.com>
	<AANLkTil1uF0nd8UfIrR3yR99Kg-Q1L7Uqq5VMwZWXi0Z@mail.gmail.com>
Message-ID: <s2ha71bd89a1005100549y9fc47a1cyef665a4befcf8a86@mail.gmail.com>

On Mon, May 10, 2010 at 12:49 AM, Tom Wickline <twickline at gmail.com> wrote:
> May I ask why no 3Dmark 03 or 05 benchmark results?

I'm trying to take care of Henri and Stefan's wishes/needs:

http://www.winehq.org/pipermail/wine-devel/2010-April/083083.html
http://www.winehq.org/pipermail/wine-devel/2010-April/083091.html

and figured that before I added too many more benchmarks,
I should get the automated daily report going.  Adding
wine3d3-on-windows tests, and ut2004, halflife2 and team fortress 2,
and maybe Resident Evil 5 benchmark,
are also on the to-do list.  (Though that last one might require
OCR; anyone know how to get FPS out of it into a text file on Windows?)

Patches to add support for more benchmarks would be welcome.
(I hesitate to use Steam or Battle.net for any of these benchmarks
because autoupdates and login problems make games hard to
script.)
I'm looking forward to the windows version of Phoronix Test Suite,
will probably add it when it's ready.
Are there any other benchmarks we should consider adding?
- Dan


From marco at mandrivaclub.nl  Mon May 10 08:53:42 2010
From: marco at mandrivaclub.nl (Marco Meijer)
Date: Mon, 10 May 2010 15:53:42 +0200
Subject: How to change text on winehq.org ?
In-Reply-To: <4BE77BED.8050509@kievinfo.com>
References: <31283914.1273161466627.JavaMail.root@elwamui-muscovy.atl.sa.earthlink.net>
	<4BE72E42.9090105@mandrivaclub.nl> <4BE77BED.8050509@kievinfo.com>
Message-ID: <4BE80FE6.9010307@mandrivaclub.nl>

Thank you,

That looks not very difficult. I think I can do it.

Marco

Op 10-5-10 5:22, Vitaliy Margolen schreef:
> On 05/09/2010 03:50 PM, marco wrote:
>    
>> Thank you all for your reply,
>>
>> Do I have to install git en download the complete source of the website?
>>      
> Yes and yes. Here is the page with lots of details:
> http://wiki.winehq.org/GitWine
>
> All you really need to do is:
> 1. Install git
> 2. Get WineHQ's source (assuming you want to put it into your home directory):
>     $ cd ~
>     $ git clone git://source.winehq.org/git/website.git
>     $ cd website.git
> 3. Set your complete name and e-mail address as it would appear on all your
> patches:
>     $ git config --global user.name "Your Name"
>     $ git config --global user.email "me at example.com"
> 4. Edit files as required
> 5. Make sure everything works.
> 6. Commit changes with:
>     $ git commit -a
> 7. Create a patch to be sent to wine-patches mailing list:
>     $ git format-patch --keep-subject HEAD^
>
>
> Vitaliy.
>
>
>    



From stefandoesinger at gmx.at  Mon May 10 10:24:47 2010
From: stefandoesinger at gmx.at (=?iso-8859-1?Q?Stefan_D=F6singer?=)
Date: Mon, 10 May 2010 17:24:47 +0200
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <s2ha71bd89a1005100549y9fc47a1cyef665a4befcf8a86@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
	<o2ma71bd89a1005091614vd3dc6612s699904ae795c55e6@mail.gmail.com>
	<l2za71bd89a1005091746g66e4518bh5e5463261f60b5fd@mail.gmail.com>
	<AANLkTil1uF0nd8UfIrR3yR99Kg-Q1L7Uqq5VMwZWXi0Z@mail.gmail.com>
	<s2ha71bd89a1005100549y9fc47a1cyef665a4befcf8a86@mail.gmail.com>
Message-ID: <70933D02-FD8E-44C1-B3AF-299B81556353@gmx.at>


Am 10.05.2010 um 14:49 schrieb Dan Kegel:
> (I hesitate to use Steam or Battle.net for any of these benchmarks
> because autoupdates and login problems make games hard to
> script.)
Steam is pretty nice in this regard. Everything you need can be controlled via Command line, e.g.

Steam.exe -login <user> <pass> -applaunch 220 -novid -console -window -w 1024 -h 768 -dxlevel 90 +timedemo mytimedemo

Everything after -applaunch 220 is a game argument. With Source engine games you can pass anything you can enter on the console via "+command". You can't make the game quit that way though, because if you pass "+timedemo xxx +quit" it will quit right after starting the timedemo - the timedemo command doesn't block.

For killing Steam I'm using "killall Steam.exe".

This page has the game appids: http://developer.valvesoftware.com/wiki/Steam_Application_IDs

However, this won't fix any issues caused by autoupdates. The updates might have an impact on performance, and especially with the newer games(TF2, L4D) the timedemo format changes, and your recorded demo becomes useless. This didn't happen recently with TF2 though, I am still using my timedemo from 2006

Also, there's an add popup after the game quits, which can be annoying if you run multiple tests without restarting Steam. It can be disabled via a Steam setting(or registry key)



From julliard at winehq.org  Mon May 10 10:56:22 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 10 May 2010 17:56:22 +0200
Subject: Remove variable hFont which is not really used from
	MF_PlayMetaFile. (RESEND)
In-Reply-To: <alpine.LSU.1.99.1005092350480.26362@acrux.dbai.tuwien.ac.at>
	(Gerald Pfeifer's message of "Sun, 9 May 2010 23:51:16 +0200 (CEST)")
References: <alpine.LSU.1.99.1005092350480.26362@acrux.dbai.tuwien.ac.at>
Message-ID: <87k4rbg389.fsf@wine.dyndns.org>

Gerald Pfeifer <gerald at pfeifer.com> writes:

> ---
>  dlls/gdi32/metafile.c |    2 --
>  1 files changed, 0 insertions(+), 2 deletions(-)

It seems pretty clear that it should be used, not removed.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Mon May 10 10:59:05 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 10 May 2010 17:59:05 +0200
Subject: advpack: Remove two variables which are not really used and two
	extraneous invocations of get_parameter from RegisterOCX. (RESEND)
In-Reply-To: <20100507202258.1986194333@pulcherrima.dbai.tuwien.ac.at> (Gerald
	Pfeifer's message of "Fri, 7 May 2010 22:22:57 +0200 (CEST)")
References: <20100507202258.1986194333@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <87fx1zg33q.fsf@wine.dyndns.org>

Gerald Pfeifer <gerald at pfeifer.com> writes:

> This passes testing fine for me and there are no further invocations of
> get_parameter in this function (which operates on a copy), so this also
> looks like an optimization?

They should be used, as the comment above indicates.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Mon May 10 11:00:33 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 10 May 2010 18:00:33 +0200
Subject: Improve error handling in scmdatabase_autostart_services. (RESEND)
In-Reply-To: <alpine.LSU.1.99.1005072034280.18670@pulcherrima.dbai.tuwien.ac.at>
	(Gerald Pfeifer's message of "Fri, 7 May 2010 20:36:15 +0200 (CEST)")
References: <alpine.LSU.1.99.1005072034280.18670@pulcherrima.dbai.tuwien.ac.at>
Message-ID: <87bpcng31a.fsf@wine.dyndns.org>

Gerald Pfeifer <gerald at pfeifer.com> writes:

> I noticed that we are not using the error code coming from service_start, 
> and indeed there was a FIXME there already.  Would it make sense to handle
> this (at least) somehow like the patch below?
>
> If preferred, I could also yank the err variable, but I figured you'd
> prefer the error handling.  (Or is there a mistake I made when adding
> that handling?)

Printing an ERR is not error handling.

-- 
Alexandre Julliard
julliard at winehq.org


From hintak_leung at yahoo.co.uk  Mon May 10 09:25:42 2010
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Mon, 10 May 2010 14:25:42 +0000 (GMT)
Subject: Release plans
In-Reply-To: <877hncgmnx.fsf@wine.dyndns.org>
Message-ID: <241183.11790.qm@web23107.mail.ird.yahoo.com>

--- On Mon, 10/5/10, Alexandre Julliard <julliard at winehq.org> wrote:

> > The last time I checked it was possible to re-use an
> old wineprefix
> > (created by 32-bit wine under x86_64 platform) with
> 64-bit wine - is
> > it still the case? My .wine is a bit big and I'd hate
> to have to
> > re-create it... :-(.

I meant to write "wasn't possible" . Sorry about that.

> You can use a 32-bit prefix with 64-bit Wine, but of course
> only in
> 32-bit mode, you won't be able to run 64-bit apps with it.

It is all a bit confusing - see 
(https://bugzilla.redhat.com/show_bug.cgi?id=533806) I think the last time I tried both, I did encounter the problem with 
'/home/myuzer/.wine' is a 32-bit prefix, it cannot be used with 64-bit
Wine.

I think a wiki/FAQ could be useful - there is an FAQ somewhere which says one should use a different prefix for 32-bit wine vs 64-bit wine on platforms which can do both. My concern is that I have a fairly big ${HOME}/.wine and I'd prefer to continue to use it, or at least it doesn't get messed up if I switch to 64-bit wine.


      


From eric.pouech at orange.fr  Mon May 10 14:13:58 2010
From: eric.pouech at orange.fr (Eric Pouech)
Date: Mon, 10 May 2010 21:13:58 +0200
Subject: RFC on console management
In-Reply-To: <87tyqgf4vk.fsf@wine.dyndns.org>
References: <4BE6AFFC.10609@orange.fr> <87tyqgf4vk.fsf@wine.dyndns.org>
Message-ID: <4BE85AF6.1090601@orange.fr>

Le 10/05/2010 12:06, Alexandre Julliard a ?crit :
> Eric Pouech<eric.pouech at orange.fr>  writes:
>
>    
>> Scenario I (aka Client side)
>> ----------------------------
>> Create simple wineserver objects (ie not linked to wineconsole) for
>> bare console handles. All the management would be done in kernel32, by
>> distinguishing bare console handles from wineserver console handles.
>>      
> This seems preferable, if it can be done without making the kernel32
> code too ugly.
>
>    
what I foresee is:
- some extensions in server for managing the objects (wineconsole-less 
console handles)
- evolution in kernel32 limited (except when dealing with line edition 
where it will include libterm and/or termcap support for translating the 
TTY character into windows keycode)

the most impacting issue IMO is the impact of matching unix way of 
controling the terminal with what windows does
as explained, if process B is a child of process A, and A is started 
from command line
- under windows, if A dies, B is still attached to cmd and can get input 
from it (even if from a process point of view it's not reparented to cmd)
- under unix, normally if A dies, B can still output to the shell, but 
it will no longer be able to get input from it

the solutions ????
- let A run until all of its children have died (tricky it we want to 
hide A from the windows process list)
- have another program be the parent of all processes started from 
command line (and wineconsole could do the trick)

A+

-- 
Eric Pouech
"The problem with designing something completely foolproof is to underestimate the ingenuity of a complete idiot." (Douglas Adams)





From octavian.voicu at gmail.com  Mon May 10 16:31:28 2010
From: octavian.voicu at gmail.com (Octavian Voicu)
Date: Tue, 11 May 2010 00:31:28 +0300
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <s2ha71bd89a1005100549y9fc47a1cyef665a4befcf8a86@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com> 
	<o2ma71bd89a1005091614vd3dc6612s699904ae795c55e6@mail.gmail.com> 
	<l2za71bd89a1005091746g66e4518bh5e5463261f60b5fd@mail.gmail.com> 
	<AANLkTil1uF0nd8UfIrR3yR99Kg-Q1L7Uqq5VMwZWXi0Z@mail.gmail.com> 
	<s2ha71bd89a1005100549y9fc47a1cyef665a4befcf8a86@mail.gmail.com>
Message-ID: <AANLkTikNzTD9yae70vhc_tlIxZIAwqBuIOfNugLfoAAv@mail.gmail.com>

On Mon, May 10, 2010 at 3:49 PM, Dan Kegel <dank at kegel.com> wrote:
> Are there any other benchmarks we should consider adding?

Eve Online:
- there are many Eve players who depend on wine, so making it run
faster should make many happy
- lots of graphics options (so many different aspects can be tested)

Downside is that it is an MMORPG, and I don't know how easy it can be
scripted. Maybe some other Eve players here have more experience with
that. There is an in-game FPS window which draws a graph, but I'm not
sure about writing FPS to files. Also, there is both a live server
(Singularity) and a test server (Tranquility).

Another problem is that wine-1.43 seems to give an error with d3d when
starting up (unimplemented function d3dx9_36.dll.D3DXCreateEffectEx --
I did notice there is a recent patch in git that adds a stub). I
should reinstall the game with an empty prefix and test again. A few
wine betas ago it was surely working, so if there are any regressions
they will hopefully be fixed soon.

Octavian


From dgerard at gmail.com  Mon May 10 18:05:16 2010
From: dgerard at gmail.com (David Gerard)
Date: Tue, 11 May 2010 00:05:16 +0100
Subject: On Ubuntu Lucid? Add the Wine PPA!
Message-ID: <AANLkTikiSJcGgJ0Nkj4hX1276RGkmf8HDztVDiI_WBe2@mail.gmail.com>

I updated to Lucid in early March and have only just realised I
haven't been getting Wine updates.

Did you forget too? Then, per the upgrades page:

  sudo add-apt-repository ppa:ubuntu-wine/ppa

- then update and upgrade. Much nicer!


- d.


From dank at kegel.com  Tue May 11 00:27:47 2010
From: dank at kegel.com (Dan Kegel)
Date: Mon, 10 May 2010 22:27:47 -0700
Subject: today's performance results
Message-ID: <AANLkTin_NWEpKNTAhGOnJEItXybd3irn6hU7XR6FglQy@mail.gmail.com>

http://kegel.com/wine/yagmarkdata/wine-1.1.44-19-vs-wine-1.1.44-72.txt
shows yesterday's wine's performance compared to today's.
Highlights:

Comparing wine-1.1.44-19 with wine-1.1.44-72
benchmark_variable        wine-1.1.44-19 wine-1.1.44-72 ratio
3dmark06_3DMark_Score     3377.00        3388.00        1.00
3dmark2000_3DMark_Result  16662.00       16917.00       1.02
3dmark2001_3DMark_Score   15691.00       17633.00       1.12
heaven2_d3d9_FPS          9.31           11.08          1.19
heaven2_gl_FPS            16.12          16.21          1.01

Golly, looks like
http://www.winehq.org/pipermail/wine-cvs/2010-May/066833.html
was a win.

Here are a few notes about the raw results.

A couple benchmarks (really short ones?) seem to have strongly bimodal
distributions on Wine.
For instance, here are ten measurements on each OS of
3dmark06_CPU2_Red_Valley:

wine-1.1.44-19 1.33  1.36  1.36  1.36  1.37  1.37  1.37  1.37  1.37  1.37
wine-1.1.44-72 1.30  1.31  1.31  1.31  1.31  1.32  1.32  1.32  1.32  1.38
Vista          1.39  1.39  1.39  1.39  1.39  1.39  1.39  1.39  1.39  1.39

For some reason, today's wine usually had the slow result, whereas yesterday
it usually had the fast result. Vista didn't suffer from this, and was
slightly faster, too.
Why does Wine return a slow result sometimes?

3dmark2000_Game_1_Helicopter_High_Detail was quite variable under Wine
(and slightly better today), but hardly varied at all on Vista:
wine-1.1.44-19 133.70 133.90 141.60 145.00 145.40 151.60 159.30 161.80
164.40 173.60
wine-1.1.44-72 139.50 144.70 154.10 157.40 157.90 162.40 170.50 178.80
180.80 198.60
Vista          281.60 282.50 282.90 283.20 283.40 283.60 283.70 283.80
284.00 284.50

What can explain such variability?

heaven2_d3d9_FPS, on the other hand, didn't vary much on Wine - and was
quite a bit better today:
wine-1.1.44-19  9.23  9.28  9.30  9.30  9.30  9.31  9.31  9.32  9.32  9.32

wine-1.1.44-72 11.05 11.07 11.07 11.07 11.08 11.08 11.08 11.09 11.10 11.10
Vista          18.37 18.37 18.38 18.38 18.38 18.38 18.38 18.38 18.38 18.38

Perhaps I should strip down my system and run fvwm95 rather than Gnome,
etc.,
to see if I can reduce the noise a bit more.
- Dan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100510/c7b6075d/attachment.htm>

From epssyis at gmail.com  Tue May 11 00:55:03 2010
From: epssyis at gmail.com (Edward Savage)
Date: Tue, 11 May 2010 15:55:03 +1000
Subject: today's performance results
In-Reply-To: <AANLkTin_NWEpKNTAhGOnJEItXybd3irn6hU7XR6FglQy@mail.gmail.com>
References: <AANLkTin_NWEpKNTAhGOnJEItXybd3irn6hU7XR6FglQy@mail.gmail.com>
Message-ID: <AANLkTinVwB0ziWxhb_YgPR-k5fo0hEl4x7ke0h7r5Z9f@mail.gmail.com>

On Tue, May 11, 2010 at 3:27 PM, Dan Kegel <dank at kegel.com> wrote:
> Why does Wine return a slow result sometimes?

Solar flares! ;)

I can't stay I notice this discrepancy in actual game play day after
day though.

I personally would be looking at memory available as the cause.  In
general you want to make sure you have plenty free as any excessive
swapping causes performance loss.  You can test this yourself by
trying a game with 1gb free memory and then trying the game again with
only enough to fit the games memory requirements (or even force it
over).  The difference will be easily noticeable.


From thunderbird2k at gmail.com  Tue May 11 03:27:20 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Tue, 11 May 2010 10:27:20 +0200
Subject: today's performance results
In-Reply-To: <AANLkTin_NWEpKNTAhGOnJEItXybd3irn6hU7XR6FglQy@mail.gmail.com>
References: <AANLkTin_NWEpKNTAhGOnJEItXybd3irn6hU7XR6FglQy@mail.gmail.com>
Message-ID: <AANLkTilTcQ4xaN0C0o89OYAZlhJRzAzCFiXCsehnZSQk@mail.gmail.com>

On Tue, May 11, 2010 at 7:27 AM, Dan Kegel <dank at kegel.com> wrote:
> http://kegel.com/wine/yagmarkdata/wine-1.1.44-19-vs-wine-1.1.44-72.txt
> shows yesterday's wine's performance compared to today's.
> Highlights:
> Comparing wine-1.1.44-19 with wine-1.1.44-72
> benchmark_variable ? ? ? ?wine-1.1.44-19 wine-1.1.44-72 ratio
> 3dmark06_3DMark_Score ? ? 3377.00 ? ? ? ?3388.00 ? ? ? ?1.00
> 3dmark2000_3DMark_Result ?16662.00 ? ? ? 16917.00 ? ? ? 1.02
> 3dmark2001_3DMark_Score ? 15691.00 ? ? ? 17633.00 ? ? ? 1.12
> heaven2_d3d9_FPS ? ? ? ? ?9.31 ? ? ? ? ? 11.08 ? ? ? ? ?1.19
> heaven2_gl_FPS ? ? ? ? ? ?16.12 ? ? ? ? ?16.21 ? ? ? ? ?1.01
> Golly, looks
> like?http://www.winehq.org/pipermail/wine-cvs/2010-May/066833.html
> was a win.
> Here are a few notes about the raw results.
> A couple benchmarks (really short ones?) seem to have strongly bimodal
> distributions on Wine.
> For instance, here are ten measurements on each OS of
> 3dmark06_CPU2_Red_Valley:
> wine-1.1.44-19 1.33 ?1.36 ?1.36 ?1.36 ?1.37 ?1.37 ?1.37 ?1.37 ?1.37 ?1.37
> wine-1.1.44-72 1.30 ?1.31 ?1.31 ?1.31 ?1.31 ?1.32 ?1.32 ?1.32 ?1.32 ?1.38
> Vista ? ? ? ? ?1.39 ?1.39 ?1.39 ?1.39 ?1.39 ?1.39 ?1.39 ?1.39 ?1.39 ?1.39
> For some reason, today's wine usually had the slow result, whereas yesterday
> it usually had the fast result. Vista didn't suffer from this, and was
> slightly faster, too.
> Why does Wine return a slow result sometimes?
> 3dmark2000_Game_1_Helicopter_High_Detail was quite variable under Wine
> (and slightly better today), but hardly varied at all on Vista:
> wine-1.1.44-19 133.70 133.90 141.60 145.00 145.40 151.60 159.30 161.80
> 164.40 173.60
> wine-1.1.44-72 139.50 144.70 154.10 157.40 157.90 162.40 170.50 178.80
> 180.80 198.60
> Vista ? ? ? ? ?281.60 282.50 282.90 283.20 283.40 283.60 283.70 283.80
> 284.00 284.50
> What can explain such variability?
> heaven2_d3d9_FPS, on the other hand, didn't vary much on Wine - and was
> quite a bit better today:
> wine-1.1.44-19 ?9.23 ?9.28 ?9.30 ?9.30 ?9.30 ?9.31 ?9.31 ?9.32 ?9.32 ?9.32
>
> wine-1.1.44-72 11.05 11.07 11.07 11.07 11.08 11.08 11.08 11.09 11.10 11.10
> Vista ? ? ? ? ?18.37 18.37 18.38 18.38 18.38 18.38 18.38 18.38 18.38 18.38
> Perhaps I should strip down?my system and run fvwm95 rather than Gnome,
> etc.,
> to see if I can reduce the noise a bit more.
> - Dan
>
>

On my laptop I also had some weird results in some game depending on
when I started it. In my case I suspected that the GPU wasn't at the
maximum clock speeds yet. Depending on what GPU you are using you
might also have '2d' and '3d' clocks. Try to force it to maximum
clocks using nvidia-settings.

Roderick


From testbot at testbot.winehq.org  Tue May 11 07:35:36 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Tue, 11 May 2010 14:35:36 +0200
Subject: [2/6] msi: Add more patch registration tests. 
Message-ID: <201005111235.o4BCZa38024269@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1996

Your paranoid android.


=== W98SE (32 bit patch) ===
Failure running script in VM: Exceeded timeout limit of 315 sec

=== WNT4WSSP6 (32 bit patch) ===
Timeout

=== W2KPROSP4 (32 bit patch) ===
Timeout


From testbot at testbot.winehq.org  Tue May 11 07:58:42 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Tue, 11 May 2010 14:58:42 +0200
Subject: [3/6] msi: Add a test to show that the InstallSource property is
	unchanged after an upgrade. 
Message-ID: <201005111258.o4BCwgkx024787@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1997

Your paranoid android.


=== W98SE (32 bit patch) ===
Failure running script in VM: Exceeded timeout limit of 315 sec

=== WNT4WSSP6 (32 bit patch) ===
Timeout

=== W2KPROSP4 (32 bit patch) ===
Timeout


From paul.vriens.wine at gmail.com  Tue May 11 08:08:07 2010
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Tue, 11 May 2010 15:08:07 +0200
Subject: [2/6] msi: Add more patch registration tests.
In-Reply-To: <1273579336.2150.93.camel@t400>
References: <1273579336.2150.93.camel@t400>
Message-ID: <4BE956B7.5030308@gmail.com>

On 05/11/2010 02:02 PM, Hans Leidekker wrote:
> ---
>   dlls/msi/tests/patch.c |   23 +++++++++++++++++++++--
>   1 files changed, 21 insertions(+), 2 deletions(-)
>
> diff --git a/dlls/msi/tests/patch.c b/dlls/msi/tests/patch.c
> index ad581d1..a835e1d 100644
> --- a/dlls/msi/tests/patch.c
> +++ b/dlls/msi/tests/patch.c
> @@ -33,6 +33,8 @@
>   static UINT (WINAPI *pMsiApplyPatchA)( LPCSTR, LPCSTR, INSTALLTYPE, LPCSTR );
>   static UINT (WINAPI *pMsiGetPatchInfoExA)( LPCSTR, LPCSTR, LPCSTR, MSIINSTALLCONTEXT,
>                                              LPCSTR, LPSTR, DWORD * );
> +static UINT (WINAPI *pMsiEnumPatchesExA)( LPCSTR, LPCSTR, DWORD, DWORD, DWORD, LPSTR,
> +                                          LPSTR, MSIINSTALLCONTEXT *, LPSTR, LPDWORD );
>
>   static const char *msifile = "winetest-patch.msi";
>   static const char *mspfile = "winetest-patch.msp";
> @@ -143,6 +145,7 @@ static void init_function_pointers( void )
>
>       GET_PROC( hmsi, MsiApplyPatchA );
>       GET_PROC( hmsi, MsiGetPatchInfoExA );
> +    GET_PROC( hmsi, MsiEnumPatchesExA );
>   #undef GET_PROC
>   }
>
> @@ -988,9 +991,9 @@ static void test_system_tables( void )
>   static void test_patch_registration( void )
>   {
>       UINT r, size;
> -    char buffer[MAX_PATH];
> +    char buffer[MAX_PATH], patch_code[39];
>
> -    if (!pMsiApplyPatchA || !pMsiGetPatchInfoExA)
> +    if (!pMsiApplyPatchA || !pMsiGetPatchInfoExA || !pMsiEnumPatchesExA)
>       {
>           win_skip("required functions not available\n");
>           return;
> @@ -1043,6 +1046,22 @@ static void test_patch_registration( void )
>       ok( r == ERROR_SUCCESS, "expected ERROR_SUCCESS, got %u\n", r );
>       ok( !buffer[0], "got %s\n", buffer );
>
> +    r = MsiEnumPatchesExA( "{913B8D18-FBB6-4CAC-A239-C74C11E3FA74}",
> +                           NULL, MSIINSTALLCONTEXT_USERUNMANAGED, MSIPATCHSTATE_APPLIED,
> +                           0, patch_code, NULL, NULL, NULL, NULL );
> +    ok( r == ERROR_SUCCESS, "expected ERROR_SUCCESS, got %u\n", r );
> +    ok( !strcmp( patch_code, "{0F96CDC0-4CDF-4304-B283-7B9264889EF7}" ), "wrong patch code\n" );
> +
> +    r = MsiEnumPatchesExA( "{913B8D18-FBB6-4CAC-A239-C74C11E3FA74}",
> +                           NULL, MSIINSTALLCONTEXT_MACHINE, MSIPATCHSTATE_APPLIED,
> +                           0, patch_code, NULL, NULL, NULL, NULL );
> +    ok( r == ERROR_NO_MORE_ITEMS, "expected ERROR_NO_MORE_ITEMS, got %u\n", r );
> +
> +    r = MsiEnumPatchesExA( "{913B8D18-FBB6-4CAC-A239-C74C11E3FA74}",
> +                           NULL, MSIINSTALLCONTEXT_USERMANAGED, MSIPATCHSTATE_APPLIED,
> +                           0, patch_code, NULL, NULL, NULL, NULL );
> +    ok( r == ERROR_NO_MORE_ITEMS, "expected ERROR_NO_MORE_ITEMS, got %u\n", r );
> +
>       r = MsiInstallProductA( msifile, "REMOVE=ALL" );
>       ok( r == ERROR_SUCCESS, "expected ERROR_SUCCESS, got %u\n", r );
>

You forgot to actually use pMsiEnumPatchesExA in some of these calls 
(hence the WTB failures).

-- 
Cheers,

Paul.


From testbot at testbot.winehq.org  Tue May 11 08:18:02 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Tue, 11 May 2010 15:18:02 +0200
Subject: [6/6] msi: Set the SourceDir property to the registered source if
	the product is installed. 
Message-ID: <201005111318.o4BDI2wF025234@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=1998

Your paranoid android.


=== W98SE (32 bit patch) ===
Failure running script in VM: Exceeded timeout limit of 315 sec

=== WNT4WSSP6 (32 bit patch) ===
Timeout

=== W2KPROSP4 (32 bit patch) ===
Timeout


From dank at kegel.com  Tue May 11 08:45:22 2010
From: dank at kegel.com (Dan Kegel)
Date: Tue, 11 May 2010 06:45:22 -0700
Subject: today's performance results
In-Reply-To: <AANLkTilTcQ4xaN0C0o89OYAZlhJRzAzCFiXCsehnZSQk@mail.gmail.com>
References: <AANLkTin_NWEpKNTAhGOnJEItXybd3irn6hU7XR6FglQy@mail.gmail.com>
	<AANLkTilTcQ4xaN0C0o89OYAZlhJRzAzCFiXCsehnZSQk@mail.gmail.com>
Message-ID: <AANLkTikDUMJ077_ygYpEfgLTHOXcRQsHz8FAm8BHGR_3@mail.gmail.com>

On Tue, May 11, 2010 at 1:27 AM, Roderick Colenbrander
<thunderbird2k at gmail.com> wrote:
> On my laptop I also had some weird results in some game depending on
> when I started it. In my case I suspected that the GPU wasn't at the
> maximum clock speeds yet. Depending on what GPU you are using you
> might also have '2d' and '3d' clocks. Try to force it to maximum
> clocks using nvidia-settings.

Thanks, I'll try.

Looks like nvidia-settings can only read the clocks, not set them?
nvidia-settings -q GPUPerfModes -t; nvidia-settings -q
GPUCurrentPerfLevel -t; nvidia-settings -q GPUCurrentClockFreqs -t
displays their current value.

Setting them appears to require changing kernel
module parameters (either in xorg.conf or /etc/modprobe.d/mumble).
Related pages:
http://tutanhamon.com.ua/technovodstvo/NVIDIA-UNIX-driver/
https://bugs.launchpad.net/ubuntu/+source/linux-restricted-modules-2.6.24/+bug/164589


From dank at kegel.com  Tue May 11 08:49:40 2010
From: dank at kegel.com (Dan Kegel)
Date: Tue, 11 May 2010 06:49:40 -0700
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <s2ha71bd89a1005100549y9fc47a1cyef665a4befcf8a86@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
	<o2ma71bd89a1005091614vd3dc6612s699904ae795c55e6@mail.gmail.com>
	<l2za71bd89a1005091746g66e4518bh5e5463261f60b5fd@mail.gmail.com>
	<AANLkTil1uF0nd8UfIrR3yR99Kg-Q1L7Uqq5VMwZWXi0Z@mail.gmail.com>
	<s2ha71bd89a1005100549y9fc47a1cyef665a4befcf8a86@mail.gmail.com>
Message-ID: <AANLkTinneo7n4O1uuKFlI8aldoIk5IPqEe6A2HZJQDLY@mail.gmail.com>

On Mon, May 10, 2010 at 5:49 AM, Dan Kegel <dank at kegel.com> wrote:
> I'm trying to take care of Henri and Stefan's wishes/needs:
>
> http://www.winehq.org/pipermail/wine-devel/2010-April/083083.html
> http://www.winehq.org/pipermail/wine-devel/2010-April/083091.html
>
> and figured that before I added too many more benchmarks,
> I should get the automated daily report going. ?Adding
> wine3d3-on-windows tests, and ut2004, halflife2 and team fortress 2,
> and maybe Resident Evil 5 benchmark,
> are also on the to-do list.

I've added orangebox to wisotool (what a pain!), and will use the notes in
http://www.digital-daily.com/video/hl2-benchmarking/
to add hl2 to yagmark.  (Though I'm still apprehensive about how
much babysitting it will need.)
- Dan


From thunderbird2k at gmail.com  Tue May 11 08:56:48 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Tue, 11 May 2010 15:56:48 +0200
Subject: today's performance results
In-Reply-To: <AANLkTikDUMJ077_ygYpEfgLTHOXcRQsHz8FAm8BHGR_3@mail.gmail.com>
References: <AANLkTin_NWEpKNTAhGOnJEItXybd3irn6hU7XR6FglQy@mail.gmail.com>
	<AANLkTilTcQ4xaN0C0o89OYAZlhJRzAzCFiXCsehnZSQk@mail.gmail.com>
	<AANLkTikDUMJ077_ygYpEfgLTHOXcRQsHz8FAm8BHGR_3@mail.gmail.com>
Message-ID: <AANLkTil7zNtT0bwjmFqGaVKUzXf_iBVRbJ7wumUeVbGJ@mail.gmail.com>

Setting the clocks must be performed using the gui. You need to have
the Coolbits option in your xorg.conf. It reminds me to still update
nvclock which can do this from cli fine ;)

Roderick

On Tue, May 11, 2010 at 3:45 PM, Dan Kegel <dank at kegel.com> wrote:
> On Tue, May 11, 2010 at 1:27 AM, Roderick Colenbrander
> <thunderbird2k at gmail.com> wrote:
>> On my laptop I also had some weird results in some game depending on
>> when I started it. In my case I suspected that the GPU wasn't at the
>> maximum clock speeds yet. Depending on what GPU you are using you
>> might also have '2d' and '3d' clocks. Try to force it to maximum
>> clocks using nvidia-settings.
>
> Thanks, I'll try.
>
> Looks like nvidia-settings can only read the clocks, not set them?
> nvidia-settings -q GPUPerfModes -t; nvidia-settings -q
> GPUCurrentPerfLevel -t; nvidia-settings -q GPUCurrentClockFreqs -t
> displays their current value.
>
> Setting them appears to require changing kernel
> module parameters (either in xorg.conf or /etc/modprobe.d/mumble).
> Related pages:
> http://tutanhamon.com.ua/technovodstvo/NVIDIA-UNIX-driver/
> https://bugs.launchpad.net/ubuntu/+source/linux-restricted-modules-2.6.24/+bug/164589
>


From iwkse at gmx.com  Tue May 11 16:24:24 2010
From: iwkse at gmx.com (Salvatore De Paolis)
Date: Tue, 11 May 2010 23:24:24 +0200
Subject: Absynth 4 though fst
Message-ID: <20100511232424.21e00296@sinusia>

Hi,
i'm trying to run Absynth 4 using fst, the plugin loads but it doesn't show the
GUI, just a black screen.

Here's the debug log

http://filebin.ca/hwgvnw/absynth4.log

i'm running wine git version under debian sid

do you have idea what's wrong?

regards
S.


From cdavis at mymail.mines.edu  Tue May 11 16:31:34 2010
From: cdavis at mymail.mines.edu (Charles Davis)
Date: Tue, 11 May 2010 15:31:34 -0600
Subject: Absynth 4 though fst
In-Reply-To: <20100511232424.21e00296@sinusia>
References: <20100511232424.21e00296@sinusia>
Message-ID: <4BE9CCB6.7010603@mymail.mines.edu>

This is the wrong place to ask. Here we talk about Wine *development*.

You should really be asking this on wine-users.

Chip


From gerald at pfeifer.com  Tue May 11 04:11:58 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Tue, 11 May 2010 11:11:58 +0200 (CEST)
Subject: Remove variable hFont which is not really used from
	MF_PlayMetaFile. (RESEND)
In-Reply-To: <87k4rbg389.fsf@wine.dyndns.org>
References: <alpine.LSU.1.99.1005092350480.26362@acrux.dbai.tuwien.ac.at>
	<87k4rbg389.fsf@wine.dyndns.org>
Message-ID: <alpine.LSU.1.99.1005102245320.26362@acrux.dbai.tuwien.ac.at>

On Mon, 10 May 2010, Alexandre Julliard wrote:
>>  dlls/gdi32/metafile.c |    2 --
>>  1 files changed, 0 insertions(+), 2 deletions(-)
> It seems pretty clear that it should be used, not removed.

Eeeh.  That one's worth a drink the next (= first) time we meet in
person.

(On the positive side, at least my work _is_ unearthing some bugs. :-)

I'll momentarily submit a proper patch.

Gerald


From gerald at pfeifer.com  Tue May 11 04:12:56 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Tue, 11 May 2010 11:12:56 +0200 (CEST)
Subject: kernel32/tests: Remove variable ret which is not really used
	from load_blackbox. (RESEND) 
In-Reply-To: <201005090635.o496Z3Q5007667@v1.gse.nl>
References: <201005090635.o496Z3Q5007667@v1.gse.nl>
Message-ID: <alpine.LSU.1.99.1005102314180.26362@acrux.dbai.tuwien.ac.at>

On Sun, 9 May 2010, testbot at testbot.winehq.org wrote:
> While running your changed tests on Windows, I think I found new failures.
> Being a bot and all I'm not very good at pattern recognition, so I might be
> wrong, but could you please double-check?
> Full results can be found at
> http://testbot.winehq.org/JobDetails.pl?Key=1969

I did double check, and this is a false positive.  This failure is
not (and really cannot) be caused by my patch.

Is the patch acceptable with that in mind?

Gerald


From truiken at gmail.com  Tue May 11 17:17:31 2010
From: truiken at gmail.com (James Hawkins)
Date: Tue, 11 May 2010 15:17:31 -0700
Subject: advpack: Only do_ocx_reg (and thus DllRegisterServer) from 
	RegisterOCX when 'N' is passed as a flag. Clarify documentation.
In-Reply-To: <20100511202447.D6A951604A@acrux.dbai.tuwien.ac.at>
References: <20100511202447.D6A951604A@acrux.dbai.tuwien.ac.at>
Message-ID: <AANLkTilfZM3xVdblalCv6vwooehXSuNFu6f2fZeGmgXB@mail.gmail.com>

I'm very hesitant about this.  MSDN has no documentation about
RegisterOCX, so I'm not sure how you're justifying this change.  It's
been a long time since I worked on this, so I don't remember much, but
I do remember testing this method and documenting the parameters
correctly.  Where are you getting information that 'I' is required
when using 'N'?

James

On Tue, May 11, 2010 at 1:24 PM, Gerald Pfeifer <gerald at pfeifer.com> wrote:
> This is my humble attempt of addressing Alexandre's feeback at
>
> ?http://www.winehq.org/pipermail/wine-devel/2010-May/083518.html
>
> It does pass testing for me, even on FreeBSD/i386, but I will say I did
> not find the MSDN documentation I located too helpful/clear, and may have
> been misled.
>
> As a next step we'd need to look into DllInstall. ?This change, hopefully,
> is a move in the right direction, though. ?If not, some guidance or one of
> the pros looking into it will be appreciated.
>
> Gerald
>
> ---
> ?dlls/advpack/advpack.c | ? 14 ++++++++++----
> ?1 files changed, 10 insertions(+), 4 deletions(-)
>
> diff --git a/dlls/advpack/advpack.c b/dlls/advpack/advpack.c
> index 112d38a..f040ec6 100644
> --- a/dlls/advpack/advpack.c
> +++ b/dlls/advpack/advpack.c
> @@ -486,8 +486,10 @@ HRESULT do_ocx_reg(HMODULE hocx, BOOL do_reg)
> ?* NOTES
> ?* ? OCX - Filename of the OCX to register.
> ?* ? flags - Controls the operation of RegisterOCX.
> - * ? ?'I' Call DllRegisterServer and DllInstall.
> - * ? ?'N' Only call DllInstall.
> + * ? ?'I' Call DllInstall and, unless 'N' is specified as well,
> + * ? ? ? ?DllRegisterServer.
> + * ? ?'N' Do not call DllRegisterServer; only valid if 'I' is
> + * ? ? ? ?specified too.
> ?* ? param - Command line passed to DllInstall.
> ?*/
> ?HRESULT WINAPI RegisterOCX(HWND hWnd, HINSTANCE hInst, LPCSTR cmdline, INT show)
> @@ -519,8 +521,12 @@ HRESULT WINAPI RegisterOCX(HWND hWnd, HINSTANCE hInst, LPCSTR cmdline, INT show)
> ? ? if (!hm)
> ? ? ? ? goto done;
>
> - ? ?hr = do_ocx_reg(hm, TRUE);
> -
> + ? ?if(strchrW(str_flags,'I'))
> + ? ?{
> + ? ? ? ?if (!strchrW(str_flags,'N'))
> + ? ? ? ? ? ?hr = do_ocx_reg(hm, TRUE);
> + ? ?}
> +
> ?done:
> ? ? FreeLibrary(hm);
> ? ? HeapFree(GetProcessHeap(), 0, cmdline_copy);
> --
> 1.6.6.2
>
>
>


From testbot at testbot.winehq.org  Wed May 12 01:11:13 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Wed, 12 May 2010 08:11:13 +0200
Subject: [PATCH 1/5] ws2_32/tests: add some socket event tests 
Message-ID: <201005120611.o4C6BDhp010985@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2019

Your paranoid android.


=== W98SE (32 bit sock) ===
sock.c:3280: Test failed: Failed to empty buffer: 0 - 0
sock.c:3281: Test failed: Expected event sequence [FD_READ(0)], got [FD_CLOSE(0)]
sock.c:3285: Test failed: Failed to empty buffer: 0 - 0
sock.c:3171: Test failed: Expected event sequence [], got [FD_READ(0)]


From scott at open-vote.org  Wed May 12 10:08:57 2010
From: scott at open-vote.org (Scott Ritchie)
Date: Wed, 12 May 2010 17:08:57 +0200
Subject: Release plans
In-Reply-To: <87pr15glwr.fsf@wine.dyndns.org>
References: <87hbmii6aj.fsf@wine.dyndns.org>	<n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>
	<87pr15glwr.fsf@wine.dyndns.org>
Message-ID: <4BEAC489.90706@open-vote.org>

On 05/09/2010 05:00 PM, Alexandre Julliard wrote:
> Edward Savage <epssyis at gmail.com> writes:
> 
>> On Sun, May 9, 2010 at 4:42 AM, Alexandre Julliard <julliard at winehq.org> wrote:
>>>
>>> Unless some major problems come up, 1.1.44 will be the last of the 1.1.x
>>> series. The next release will be 1.2-rc1, which will mark the beginning
>>> of the code freeze. This should result in a 1.2 final sometime in June.
>>>
>>
>> Would it be worthwhile to put together some sort of release
>> announcement detailing changes and improvements in Wine between 1 and
>> 1.2? Some thing similar to what other projects release that tech sites
>> can pickup and talk about.  Maybe even a more formal press release
>> style document.
> 
> We definitely need a release changelog, yes.
> 

It seems to me what we really want is more than a changelog but a proper
release announcement.  I want a journalist who has hardly heard of Wine
to read the page and understand what we've done and why it's great.

I've created a rough skeleton of things to have here:
http://wiki.winehq.org/Wine1.2Announcement

I'm very busy at the Ubuntu Developer Summit at the moment but I'll put
some good work into it soon.

Thanks,
Scott Ritchie


From epssyis at gmail.com  Wed May 12 10:29:45 2010
From: epssyis at gmail.com (Edward Savage)
Date: Thu, 13 May 2010 01:29:45 +1000
Subject: Release plans
In-Reply-To: <4BEAC489.90706@open-vote.org>
References: <87hbmii6aj.fsf@wine.dyndns.org>
	<n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>
	<87pr15glwr.fsf@wine.dyndns.org> <4BEAC489.90706@open-vote.org>
Message-ID: <AANLkTim7RSmNXJkmoEOuxGRaozK_WKQjvjo4-Ao8Ehze@mail.gmail.com>

On Thu, May 13, 2010 at 1:08 AM, Scott Ritchie <scott at open-vote.org> wrote:
>
> It seems to me what we really want is more than a changelog but a proper
> release announcement. ?I want a journalist who has hardly heard of Wine
> to read the page and understand what we've done and why it's great.
>
> I've created a rough skeleton of things to have here:
> http://wiki.winehq.org/Wine1.2Announcement
>
> I'm very busy at the Ubuntu Developer Summit at the moment but I'll put
> some good work into it soon.
>

I was strongly alluding to this.

I am not a journalist though I did get forced to take a course in it
for a university elective so I know the basics and I am a big fan of
writing.  I have been considering the best way to frame Wine to get
the most attention and new users.  I will update that wiki page with
my ideas and start fleshing out some blocks of content.

I have almost no written work for people to see beyond some stories I
wrote for an as-yet unreleased copy of WWN.
http://home.bluesata.com/WineWWN/WineHQ/wwn/362 Still I think I'd be
up to the task to write some thing worthwhile.


From brian.vincent at gmail.com  Wed May 12 11:27:36 2010
From: brian.vincent at gmail.com (Brian Vincent)
Date: Wed, 12 May 2010 10:27:36 -0600
Subject: Release plans
In-Reply-To: <AANLkTim7RSmNXJkmoEOuxGRaozK_WKQjvjo4-Ao8Ehze@mail.gmail.com>
References: <87hbmii6aj.fsf@wine.dyndns.org>
	<n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>
	<87pr15glwr.fsf@wine.dyndns.org> <4BEAC489.90706@open-vote.org>
	<AANLkTim7RSmNXJkmoEOuxGRaozK_WKQjvjo4-Ao8Ehze@mail.gmail.com>
Message-ID: <AANLkTikaQzqAmnZjbQEVEbjlgW_P8dUbfk1brWLFWsBZ@mail.gmail.com>

On Wed, May 12, 2010 at 9:29 AM, Edward Savage <epssyis at gmail.com> wrote:

> On Thu, May 13, 2010 at 1:08 AM, Scott Ritchie <scott at open-vote.org>
> wrote:
> >
> > It seems to me what we really want is more than a changelog but a proper
> > release announcement.  I want a journalist who has hardly heard of Wine
> > to read the page and understand what we've done and why it's great.
>

Jeremy - do you have a copy of the real press release we did for 1.0?  I dug
around looking for it and couldn't find it.  Looks like we never properly
posted it on WineHQ.  It did get picked up by quite a few news sites, but
Google isn't finding it.

Scott /  Edward - when 1.0 came out, Jeremy had the PR firm that writes copy
for Codeweavers put together a press release for Wine.  It was pretty good
and fairly polished.  I'm not sure if having them do it again would be an
option.  Also, I think Wine 1.0 was coordinated with a release of Crossover
7.0.

Also, what would be really good would be to provide some contact information
for people that can be used by the press to ask some simple questions about
the release.  It'd be good to have a European contact and a US one.
 However, be prepared to actually get called and be available by email to
answer questions.  News sites like to turn articles around in a matter of
hours, so it needs a tiny bit of attention.

PS - Hung out with Mike McCormack on Monday.  It was good to see him again.

-Brian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100512/54bc9d61/attachment.htm>

From austinenglish at gmail.com  Wed May 12 11:34:46 2010
From: austinenglish at gmail.com (Austin English)
Date: Wed, 12 May 2010 11:34:46 -0500
Subject: Release plans
In-Reply-To: <AANLkTikaQzqAmnZjbQEVEbjlgW_P8dUbfk1brWLFWsBZ@mail.gmail.com>
References: <87hbmii6aj.fsf@wine.dyndns.org>
	<n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>
	<87pr15glwr.fsf@wine.dyndns.org> <4BEAC489.90706@open-vote.org> 
	<AANLkTim7RSmNXJkmoEOuxGRaozK_WKQjvjo4-Ao8Ehze@mail.gmail.com> 
	<AANLkTikaQzqAmnZjbQEVEbjlgW_P8dUbfk1brWLFWsBZ@mail.gmail.com>
Message-ID: <AANLkTikRsHwEhgkP8nXDXcYRTMP78kK7LppnJTn0CKyl@mail.gmail.com>

On Wed, May 12, 2010 at 11:27 AM, Brian Vincent <brian.vincent at gmail.com> wrote:
> Also, what would be really good would be to provide some contact information
> for people that can be used by the press to ask some simple questions about
> the release. ?It'd be good to have a European contact and a US one.
> ?However, be prepared to actually get called and be available by email to
> answer questions. ?News sites like to turn articles around in a matter of
> hours, so it needs a tiny bit of attention.

There's press at winehq.org, which gets sent to a few people. See
http://bugs.winehq.org/show_bug.cgi?id=20603

That doesn't have phone numbers, though. However, between all of us,
I'm sure someone will see the email fairly quickly.

-- 
-Austin


From julliard at winehq.org  Wed May 12 11:55:21 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 12 May 2010 18:55:21 +0200
Subject: Release plans
In-Reply-To: <4BEAC489.90706@open-vote.org> (Scott Ritchie's message of "Wed, 
	12 May 2010 17:08:57 +0200")
References: <87hbmii6aj.fsf@wine.dyndns.org>
	<n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>
	<87pr15glwr.fsf@wine.dyndns.org> <4BEAC489.90706@open-vote.org>
Message-ID: <87k4r93vra.fsf@wine.dyndns.org>

Scott Ritchie <scott at open-vote.org> writes:

> On 05/09/2010 05:00 PM, Alexandre Julliard wrote:
>> We definitely need a release changelog, yes.
>
> It seems to me what we really want is more than a changelog but a proper
> release announcement.  I want a journalist who has hardly heard of Wine
> to read the page and understand what we've done and why it's great.

Sure, that's the press release, we should have one too, but it's a
different thing. A changelog would be a detailed description of changes
that matter from a user point of view. It would list for instance new
builtin programs, new configuration options, new behaviors, new system
dependencies, backwards compatibility concerns, etc.  You can't put that
sort of things in the press release.

-- 
Alexandre Julliard
julliard at winehq.org


From jjmckenzie51 at earthlink.net  Wed May 12 12:49:51 2010
From: jjmckenzie51 at earthlink.net (James Mckenzie)
Date: Wed, 12 May 2010 10:49:51 -0700 (GMT-07:00)
Subject: Release plans
Message-ID: <9276496.1273686592037.JavaMail.root@elwamui-chisos.atl.sa.earthlink.net>

>
>On 05/09/2010 05:00 PM, Alexandre Julliard wrote:
>> Edward Savage <epssyis at gmail.com> writes:
>> 
>>> On Sun, May 9, 2010 at 4:42 AM, Alexandre Julliard <julliard at winehq.org> wrote:
>>>>
>>>> Unless some major problems come up, 1.1.44 will be the last of the 1.1.x
>>>> series. The next release will be 1.2-rc1, which will mark the beginning
>>>> of the code freeze. This should result in a 1.2 final sometime in June.
>>>>
>>>
>>> Would it be worthwhile to put together some sort of release
>>> announcement detailing changes and improvements in Wine between 1 and
>>> 1.2? Some thing similar to what other projects release that tech sites
>>> can pickup and talk about.  Maybe even a more formal press release
>>> style document.
>> 
>> We definitely need a release changelog, yes.
>> 
>
>It seems to me what we really want is more than a changelog but a proper
>release announcement.  I want a journalist who has hardly heard of Wine
>to read the page and understand what we've done and why it's great.
>
We need BOTH a change log and the press release.  The Press release needs to highlight the changes like adding Windows-on-Windows 64 code and the ability to work with .NET 2.0.  The Changelog should be extremely detailed and directed at the user to advise what was fixed and what is still broken or will be broken by using this release.

>I've created a rough skeleton of things to have here:
>http://wiki.winehq.org/Wine1.2Announcement
>
>I'm very busy at the Ubuntu Developer Summit at the moment but I'll put
>some good work into it soon.
>

Thank you for starting work on the announcement.  The changelog will be a much more lengthy work.

James McKenzie



From maik.masling at googlemail.com  Wed May 12 13:57:17 2010
From: maik.masling at googlemail.com (Maik Masling)
Date: Wed, 12 May 2010 20:57:17 +0200
Subject: wine-devel Digest, Vol 58, Issue 30
In-Reply-To: <mailman.5.1273683601.24507.wine-devel@winehq.org>
References: <mailman.5.1273683601.24507.wine-devel@winehq.org>
Message-ID: <4BEAFA0D.4000107@googlemail.com>

Am 12.05.2010 19:00, schrieb wine-devel-request at winehq.org:
> Send wine-devel mailing list submissions to
> 	wine-devel at winehq.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	http://www.winehq.org/mailman/listinfo/wine-devel
> or, via email, send a message with subject or body 'help' to
> 	wine-devel-request at winehq.org
>
> You can reach the person managing the list at
> 	wine-devel-owner at winehq.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of wine-devel digest..."
>
>
> Today's Topics:
>
>     1. Re: Release plans (Alexandre Julliard)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Wed, 12 May 2010 18:55:21 +0200
> From: Alexandre Julliard<julliard at winehq.org>
> Subject: Re: Release plans
> To: Scott Ritchie<scott at open-vote.org>
> Cc: wine-devel at winehq.org
> Message-ID:<87k4r93vra.fsf at wine.dyndns.org>
> Content-Type: text/plain; charset=us-ascii
>
> Scott Ritchie<scott at open-vote.org>  writes:
>
>    
>> On 05/09/2010 05:00 PM, Alexandre Julliard wrote:
>>      
>>> We definitely need a release changelog, yes.
>>>        
>> It seems to me what we really want is more than a changelog but a proper
>> release announcement.  I want a journalist who has hardly heard of Wine
>> to read the page and understand what we've done and why it's great.
>>      
> Sure, that's the press release, we should have one too, but it's a
> different thing. A changelog would be a detailed description of changes
> that matter from a user point of view. It would list for instance new
> builtin programs, new configuration options, new behaviors, new system
> dependencies, backwards compatibility concerns, etc.  You can't put that
> sort of things in the press release.
>
>    
That is a certain point. If the changelog would nounce namely working 
programs in series 1.2, than people would be more attracted into testing 
those but could be more dissappointed, because in fact more regressions 
to those "featured program"-list would pop up, especially after changes 
and with following 1.2.x.

To tell a non-programmer from a user-perspective point of view the 
advantages in featuring functionalities and supported application of the 
wine-project stable snapshots must not be like coding it again in 
foolish human language.

What I think the announcement really need to be is giving me/us a focus 
on the range of the advantages.
"What is the evolutionary point?"

I would be perfectly informed and proud to see it just like that:

Some few new famous massively used and working single/multiplayer games 
or programs that people heavily rely on. For example top 10 games + top 
10 applications  that work platinum with 1.2 plus an numeral overview of 
the status quo compared to 1.1 in platin,gold,silver,bronce,fixed bugs etc.

Compared:      1.0 / 1.1
Platin:                #  / #
Gold:                    "
Silver:                  "
Bronce:                "
Fixed Bugs:         "

What i really liked in earlier days was the animation with the 
gold,silver,bronce-bars, because that would easily visualise those process.

Wow, user thinks "How comes?" and we give him a additional sum-up of the 
changelogs main-points from all 1.1.* announcements plus the standard 
"additional/other/various bugfixes/improvements"-sentences that are 
regularly in part of the announcements.

I see no problem in just announcing it within WWN.
We could also just put the techie point inside of WWN and refer to it in 
the press release for a more detailed technical overvie of the advantages.






From ken at codeweavers.com  Wed May 12 18:37:45 2010
From: ken at codeweavers.com (Ken Thomases)
Date: Wed, 12 May 2010 18:37:45 -0500
Subject: [PATCH 0/2] Unaligned mmap() on Mac OS X
In-Reply-To: <1273692630-16499-1-git-send-email-cdavis@mymail.mines.edu>
References: <1273692630-16499-1-git-send-email-cdavis@mymail.mines.edu>
Message-ID: <F10A2B7E-9B47-4336-AC41-A214A0486559@codeweavers.com>

On May 12, 2010, at 2:30 PM, Charles Davis wrote:

> In Mac OS X 10.5, mmap() was changed to conform to UNIX '03. Among other
> things, this means that mmap() no longer supports unaligned file offsets
> (like Linux).

What problems does this cause?


> However, by reading Darwin source, I learned that the check for unaligned
> file offsets is done at the library level, and not in the kernel. This is
> to support older binaries compiled for Tiger and earlier. This means that Wine
> compiled for Tiger should support unaligned file offsets, like want. But it
> also means that, if we make the syscall ourselves instead of calling libc, we
> can support them on Leopard (and by extension, Snow Leopard) too! This patch
> series does just that.

Can't we achieve that just by avoiding the mapping of the "mmap" identifier to the _mmap$UNIX2003 symbol?

http://developer.apple.com/mac/library/releasenotes/Darwin/SymbolVariantsRelNotes/index.html

It may be sufficient to #define _NONSTD_SOURCE, #include <sys/mman.h> as the first header, #undef _NONSTD_SOURCE, and then continue to include any other headers.


Alternatively, you can probably use an approach like this:

http://source.winehq.org/git/wine.git/?a=commitdiff;h=028b763f2f51e78084129975e6333271dd2f861c

Regards,
Ken



From cdavis at mymail.mines.edu  Wed May 12 18:53:36 2010
From: cdavis at mymail.mines.edu (Charles Davis)
Date: Wed, 12 May 2010 17:53:36 -0600
Subject: [PATCH 0/2] Unaligned mmap() on Mac OS X
In-Reply-To: <F10A2B7E-9B47-4336-AC41-A214A0486559@codeweavers.com>
References: <1273692630-16499-1-git-send-email-cdavis@mymail.mines.edu>
	<F10A2B7E-9B47-4336-AC41-A214A0486559@codeweavers.com>
Message-ID: <4BEB3F80.2020208@mymail.mines.edu>

On 5/12/10 5:37 PM, Ken Thomases wrote:
> What problems does this cause?
It makes Wine use more memory than it needs to.

http://wiki.winehq.org/UnalignedMmap
> Can't we achieve that just by avoiding the mapping of the "mmap" identifier to the _mmap$UNIX2003 symbol?
We could for 32-bit, but not 64-bit.
> It may be sufficient to #define _NONSTD_SOURCE, #include <sys/mman.h> as the first header, #undef _NONSTD_SOURCE, and then continue to include any other headers.
Not on 64-bit (when support for that finally gets here). If you try that
in a 64-bit program, you get an error.
> Alternatively, you can probably use an approach like this:
> 
> http://source.winehq.org/git/wine.git/?a=commitdiff;h=028b763f2f51e78084129975e6333271dd2f861c
Again, it won't work for 64-bit. On 64-bit, only the "conforming"
version is available. (Use nm on the System Library,
/usr/lib/libSystem.dylib, and see for yourself. Note that it doesn't
have the $UNIX2003 on the end because the UNIX '03 version is the only
one available there.)

The 32-bit version was ugly anyway. I'll submit a new patch series.

Chip


From testbot at testbot.winehq.org  Wed May 12 18:54:16 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Thu, 13 May 2010 01:54:16 +0200
Subject: [kernel32] Return the correct processor arch and type in wow64
	mode 
Message-ID: <201005122354.o4CNsG3J010803@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2036

Your paranoid android.


=== W98SE (32 bit process) ===
Failure running script in VM: Exceeded timeout limit of 315 sec


From ken at codeweavers.com  Wed May 12 19:10:36 2010
From: ken at codeweavers.com (Ken Thomases)
Date: Wed, 12 May 2010 19:10:36 -0500
Subject: [PATCH 0/2] Unaligned mmap() on Mac OS X
In-Reply-To: <4BEB3F80.2020208@mymail.mines.edu>
References: <1273692630-16499-1-git-send-email-cdavis@mymail.mines.edu>
	<F10A2B7E-9B47-4336-AC41-A214A0486559@codeweavers.com>
	<4BEB3F80.2020208@mymail.mines.edu>
Message-ID: <9CF7A2AA-4C92-4283-8C52-DFC45406B5B4@codeweavers.com>

On May 12, 2010, at 6:53 PM, Charles Davis wrote:

> On 5/12/10 5:37 PM, Ken Thomases wrote:
>> What problems does this cause?
> It makes Wine use more memory than it needs to.
> 
> http://wiki.winehq.org/UnalignedMmap
>> Can't we achieve that just by avoiding the mapping of the "mmap" identifier to the _mmap$UNIX2003 symbol?
> We could for 32-bit, but not 64-bit.

And does the problem still matter in 64-bit?

Also, are unaligned PE images also prevalent for 64-bit executables?  There are many cases in which 64-bit ABIs impose stricter alignment requirements.  I don't know if this is one of them.

-Ken



From dank at kegel.com  Wed May 12 20:10:10 2010
From: dank at kegel.com (Dan Kegel)
Date: Wed, 12 May 2010 18:10:10 -0700
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <70933D02-FD8E-44C1-B3AF-299B81556353@gmx.at>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
	<o2ma71bd89a1005091614vd3dc6612s699904ae795c55e6@mail.gmail.com>
	<l2za71bd89a1005091746g66e4518bh5e5463261f60b5fd@mail.gmail.com>
	<AANLkTil1uF0nd8UfIrR3yR99Kg-Q1L7Uqq5VMwZWXi0Z@mail.gmail.com>
	<s2ha71bd89a1005100549y9fc47a1cyef665a4befcf8a86@mail.gmail.com>
	<70933D02-FD8E-44C1-B3AF-299B81556353@gmx.at>
Message-ID: <AANLkTilKaNLh701a0R48YPTaXKnUEYFnsoVD0CEu6rb4@mail.gmail.com>

On Mon, May 10, 2010 at 8:24 AM, Stefan D?singer <stefandoesinger at gmx.at> wrote:
> Steam is pretty nice in this regard. Everything you need can be controlled via Command line, e.g.
>
> Steam.exe -login <user> <pass> -applaunch 220 -novid -console -window -w 1024 -h 768 -dxlevel 90 +timedemo mytimedemo
>
> Everything after -applaunch 220 is a game argument. With Source engine games you can pass anything you can enter on the console via "+command". You can't make the game quit that way though, because if you pass "+timedemo xxx +quit" it will quit right after starting the timedemo - the timedemo command doesn't block.

I hear there's a +timedemoquit command....

Can you send me the timedemo files you use?

> Also, there's an add popup after the game quits, which can be annoying if you run multiple tests without restarting Steam. It can be disabled via a Steam setting(or registry key)

Pray tell...
- Dan


From cdavis at mymail.mines.edu  Wed May 12 21:17:22 2010
From: cdavis at mymail.mines.edu (Charles Davis)
Date: Wed, 12 May 2010 20:17:22 -0600
Subject: [PATCH 0/2] Unaligned mmap() on Mac OS X
In-Reply-To: <9CF7A2AA-4C92-4283-8C52-DFC45406B5B4@codeweavers.com>
References: <1273692630-16499-1-git-send-email-cdavis@mymail.mines.edu>
	<F10A2B7E-9B47-4336-AC41-A214A0486559@codeweavers.com>
	<4BEB3F80.2020208@mymail.mines.edu>
	<9CF7A2AA-4C92-4283-8C52-DFC45406B5B4@codeweavers.com>
Message-ID: <4BEB6132.3050404@mymail.mines.edu>

On 5/12/10 6:10 PM, Ken Thomases wrote:
> On May 12, 2010, at 6:53 PM, Charles Davis wrote:
> 
>> On 5/12/10 5:37 PM, Ken Thomases wrote:
>>> What problems does this cause?
>> It makes Wine use more memory than it needs to.
>>
>> http://wiki.winehq.org/UnalignedMmap
>>> Can't we achieve that just by avoiding the mapping of the "mmap" identifier to the _mmap$UNIX2003 symbol?
>> We could for 32-bit, but not 64-bit.
> 
> And does the problem still matter in 64-bit?
Probably. Everything I've read seems to indicate that the 64-bit PE
format is just that--a 64-bit version of the PE format. In particular,
it seems to me that disk alignment can still be less than one page.
> 
> Also, are unaligned PE images also prevalent for 64-bit executables?
I wouldn't know, I've never seen an actual Win64 executable.
> There are many cases in which 64-bit ABIs impose stricter alignment requirements.
That's certainly true.
> I don't know if this is one of them.
Somehow I doubt it is.

Chip


From sven.wine at gmail.com  Thu May 13 01:15:38 2010
From: sven.wine at gmail.com (Sven Baars)
Date: Thu, 13 May 2010 08:15:38 +0200
Subject: [WineHQ][WWN] WWN 362 - Brought to you by Edward Savage
In-Reply-To: <20100513043421.6B9DB2324B33@home.bluesata.com>
References: <20100513043421.6B9DB2324B33@home.bluesata.com>
Message-ID: <4BEB990A.5090407@gmail.com>

Zachary Goldberg wrote:
> +<topic>AppDB / BugZilla</topic>
> +<center><b>BugZilla Changes:</b></center>
> +<p>
> +<center>
> +<table border="1" bordercolor="#222222" cellspacing="0" cellpadding="3">
> +<tr>
> +<td align="center">
> +	<b>Category</b>
> +</td>
> +<td>
> +<b>Total Bugs Last Issue</b>
> +</td>
> +<td>
> +	<b>Total Bugs This Issue</b>
> +</td>
> +<td>
> +	<b>Net Change</b>
> +</td>
> +</tr>
> +
> +<tr>
> +<td align="center">
> +     UNCONFIRMED
> +</td>
> +<td align="center">
> +     2795
> +</td>
> +<td align="center">
> +     2821
> +</td>
> +
> +<td align="center">
> +      +26
> +</td>
> +</tr>
> +
> +<tr>
> +<td align="center">
> +     NEW
> +</td>
> +<td align="center">
> +     2677
> +</td>
> +<td align="center">
> +     2683
> +</td>
> +
> +<td align="center">
> +      +6
> +</td>
> +</tr>
> +
> +<tr>
> +<td align="center">
> +     ASSIGNED
> +</td>
> +<td align="center">
> +     28
> +</td>
> +<td align="center">
> +     26
> +</td>
> +
> +<td align="center">
> +      -2
> +</td>
> +</tr>
> +
> +<tr>
> +<td align="center">
> +     REOPENED
> +</td>
> +<td align="center">
> +     119
> +</td>
> +<td align="center">
> +     117
> +</td>
> +
> +<td align="center">
> +      -2
> +</td>
> +</tr>
> +
> +<tr>
> +<td align="center">
> +     CLOSED
> +</td>
> +<td align="center">
> +     3
> +</td>
> +<td align="center">
> +     1
> +</td>
> +
> +<td align="center">
> +      -2
> +</td>
> +</tr>
> +
> +<tr>
> +<td align="center">
> +      TOTAL OPEN
> +</td>
> +<td align="center">
> +      5619
> +</td>
> +<td align="center">
> +      5647
> +</td>
> +<td align="center">
> +      +28
> +</td>
> +</tr>
> +<tr>
> +<td align="center">
> +       TOTAL
> +</td>
> +<td align="center">
> +      5622
> +</td>
> +<td align="center">
> +      5648
> +</td>
> +<td align="center">
> +      +26
> +</td>
> +</tr>
> +</table>
>    
Hey Zach,

This says that there is 1 closed bug, while there must be thousands. 
That can't be right. Also, it doesn't say anything about not-closed 
resolved bugs (like fixed ones), so it doesn't say anything about the 
real total.

Sven


From paul.vriens.wine at gmail.com  Thu May 13 02:26:42 2010
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 13 May 2010 09:26:42 +0200
Subject: [kernel32] Return the correct processor arch and type in wow64
	mode
In-Reply-To: <201005122354.o4CNsG3J010803@v1.gse.nl>
References: <201005122354.o4CNsG3J010803@v1.gse.nl>
Message-ID: <4BEBA9B2.4020707@gmail.com>

On 05/13/2010 01:54 AM,  (Marvin) wrote:
> Hi,
>
> While running your changed tests on Windows, I think I found new failures.
> Being a bot and all I'm not very good at pattern recognition, so I might be
> wrong, but could you please double-check?
> Full results can be found at
> http://testbot.winehq.org/JobDetails.pl?Key=2036
>
> Your paranoid android.
>
>
> === W98SE (32 bit process) ===
> Failure running script in VM: Exceeded timeout limit of 315 sec

Hi,

This is a false positive. The Win9x kernel32 tests have always shown 
such behavior. This of course needs to be fixed but has nothing to do 
with this patch. Notice the "kernel32:process done (0)" in the log for 
Win98.

I'm not sure if this behavior is caused by the tests themselves or 
whether it's caused by some interaction issues when run from a command 
prompt (or batch file like WTB is doing).

-- 
Cheers,

Paul.


From paul.vriens.wine at gmail.com  Thu May 13 02:41:40 2010
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 13 May 2010 09:41:40 +0200
Subject: urlmon: CreateUri should return E_INVALIDARG for NULL args.
In-Reply-To: <AANLkTimstK2Aw4btBkQWSp8lAr4ls2OzNRAo6RJ8QaLC@mail.gmail.com>
References: <AANLkTimstK2Aw4btBkQWSp8lAr4ls2OzNRAo6RJ8QaLC@mail.gmail.com>
Message-ID: <4BEBAD34.20102@gmail.com>

On 05/13/2010 04:49 AM, Thomas Mullaly wrote:
> @@ -75,6 +77,22 @@ static void test_CreateUri_InvalidFlags(void) {
>       }
>   }
>
> +/*
> + * CreateUri returns E_INVALIDARG if the IUri it recieves is NULL.
> + * CreateUri returns E_INVALIDARG if the uri string is NULL and sets the IUri to NULL.
> + */

I don't think these comments are needed as the same is shown in the 
tests below (I was actually triggered by the wrong spelling of 
'receives' btw).

> +static void test_CreateUri_InvalidArgs(void) {
> +    HRESULT hr;
> +    IUri*uri = (void*) 0xdeadbeef;
> +
> +    hr = pCreateUri(http_urlW, 0, 0, NULL);
> +    ok(hr == E_INVALIDARG, "Error: CreateUri returned 0x%08x, expected 0x%08x\n", hr, E_INVALIDARG);
> +
> +    hr = pCreateUri(NULL, 0, 0,&uri);
> +    ok(hr == E_INVALIDARG, "Error: CreateUri returned 0x%08x, expected 0x%08x\n", hr, E_INVALIDARG);
> +    ok(uri == NULL, "Error: Expected the IUri to be NULL, but it was %p instead\n", uri);
> +}

-- 
Cheers,

Paul.


From julliard at winehq.org  Thu May 13 03:42:40 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 13 May 2010 10:42:40 +0200
Subject: [PATCH 0/2] Unaligned mmap() on Mac OS X
In-Reply-To: <4BEB3F80.2020208@mymail.mines.edu> (Charles Davis's message of
	"Wed, 12 May 2010 17:53:36 -0600")
References: <1273692630-16499-1-git-send-email-cdavis@mymail.mines.edu>
	<F10A2B7E-9B47-4336-AC41-A214A0486559@codeweavers.com>
	<4BEB3F80.2020208@mymail.mines.edu>
Message-ID: <87mxw42nwf.fsf@wine.dyndns.org>

Charles Davis <cdavis at mymail.mines.edu> writes:

> On 5/12/10 5:37 PM, Ken Thomases wrote:
>> What problems does this cause?
> It makes Wine use more memory than it needs to.

In theory, but in practice it's not worth the trouble. We used to do
this on Linux but it has been removed. It's definitely not worth
breaking libwine compatibility for this.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Thu May 13 05:28:59 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 13 May 2010 12:28:59 +0200
Subject: [PATCH 5/5] server: get rid of sock_try_event
In-Reply-To: <r2o4d8b5aa81005112259z36634779s385a2cc2b82cdf@mail.gmail.com>
	(Mike Kaplinskiy's message of "Wed, 12 May 2010 01:59:08 -0400")
References: <r2o4d8b5aa81005112259z36634779s385a2cc2b82cdf@mail.gmail.com>
Message-ID: <87hbmc2iz8.fsf@wine.dyndns.org>

Mike Kaplinskiy <mike.kaplinskiy at gmail.com> writes:

> We *might* need to ignore POLLERR messages for UDP sockets, as the
> condition is actually temporary and sock_try_event was hiding this.

It doesn't work here:

../../../tools/runtest -q -P wine -M ws2_32.dll -T ../../.. -p ws2_32_test.exe.so sock.c && touch sock.ok
sock.c:941: Test failed: some threads have not completed: 102
sock.c:3567: Tests skipped: WSAIoctl failed to get AcceptEx with ret -1 + errno 10045
make: *** [sock.ok] Error 1

-- 
Alexandre Julliard
julliard at winehq.org


From kgbricola at web.de  Thu May 13 06:12:45 2010
From: kgbricola at web.de (=?ISO-8859-1?Q?Rico_Sch=FCller?=)
Date: Thu, 13 May 2010 13:12:45 +0200
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <l2za71bd89a1005091746g66e4518bh5e5463261f60b5fd@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>	<o2ma71bd89a1005091614vd3dc6612s699904ae795c55e6@mail.gmail.com>
	<l2za71bd89a1005091746g66e4518bh5e5463261f60b5fd@mail.gmail.com>
Message-ID: <4BEBDEAD.2070800@web.de>

Am 10.05.2010 02:46, schrieb Dan Kegel:
> On Sun, May 9, 2010 at 4:14 PM, Dan Kegel<dank at kegel.com>  wrote:
>    
>> in general, Wine's D3D version achieves only half to three-quarters the performance
>> of Vista's.
>>      
> I just tried 'winetricks glsl-disable' on heaven2_d3d9.  It sped it up
> about 8% (to 16.0 fps), but added some fun problems (e.g. scenes
> 7, 10, and 12 have a black sky).
>
>
>
>    
Sceenes 7, 10 and 12 are totally black here on wine on opengl. But the 
linux native client has the same problem. So I guess there opengl engine 
is lacking some futures.


From aric at codeweavers.com  Thu May 13 07:10:06 2010
From: aric at codeweavers.com (Aric Stewart)
Date: Thu, 13 May 2010 07:10:06 -0500
Subject: winemp3.acm: Fixes the Mac-specific code
In-Reply-To: <AANLkTingQ-N2iXqExutUkv0w30nbqlha8A1rs3f3yfSZ@mail.gmail.com>
References: <AANLkTingQ-N2iXqExutUkv0w30nbqlha8A1rs3f3yfSZ@mail.gmail.com>
Message-ID: <4BEBEC1E.60206@codeweavers.com>

Hi,
   It is good to see someone working on this code.  But your patch makes 
it so that all the mp3 sound clips in the game that I was coding for 
stop working.

trace:mpeg3:mp3_leopard_horse ndst 147456 0x2eab348  <-  19901 0x2ea657c
trace:mpeg3:mp3_leopard_horse First 16 bytes to input: 
"\x00\x1f\x84\n\x92_\x81h\x00\x00\x00\x00\x00\x00\x00\x00"
trace:mpeg3:mp3_leopard_horse Invalid header at 0x2ea657c


I was also under the impression that a single input stream could come 
through as a series of ACMDM_STREAM_CONVERT messages that may or may not 
align as containing full packets or have a header on each call. This may 
not be what is happening here since it appear to be happening at the 
beginning of a given sound clip.

But that is why I used the AudioFileStream (that and i was seeing apple 
documentation recommending so)

-aric

Kristofer Henriksson wrote:
> The current winemp3.acm does not work if the Mac-specific code is
> used. This rewrites the relevant portion to fix, for example,
> background music on things like Oblivion.
> 
> 
> ------------------------------------------------------------------------
> 
> 


From dank at kegel.com  Thu May 13 07:52:08 2010
From: dank at kegel.com (Dan Kegel)
Date: Thu, 13 May 2010 05:52:08 -0700
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <4BEBDEAD.2070800@web.de>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
	<o2ma71bd89a1005091614vd3dc6612s699904ae795c55e6@mail.gmail.com>
	<l2za71bd89a1005091746g66e4518bh5e5463261f60b5fd@mail.gmail.com>
	<4BEBDEAD.2070800@web.de>
Message-ID: <AANLkTikuktWXenPo5PdStW2RLZmG43rPBaWmh-ewCA63@mail.gmail.com>

2010/5/13 Rico Sch?ller <kgbricola at web.de>:
>> I just tried 'winetricks glsl-disable' on heaven2_d3d9. ?It sped it up
>> about 8% (to 16.0 fps), but added some fun problems (e.g. scenes
>> 7, 10, and 12 have a black sky).
>
> Sceenes 7, 10 and 12 are totally black here on wine on opengl. But the linux
> native client has the same problem. So I guess there opengl engine is
> lacking some futures.

That's interesting.  What graphics hardware + drivers are you using?


From thomas.mullaly at gmail.com  Thu May 13 10:31:20 2010
From: thomas.mullaly at gmail.com (Thomas Mullaly)
Date: Thu, 13 May 2010 11:31:20 -0400
Subject: urlmon: CreateUri should return E_INVALIDARG for NULL args.
In-Reply-To: <4BEBAD34.20102@gmail.com>
References: <AANLkTimstK2Aw4btBkQWSp8lAr4ls2OzNRAo6RJ8QaLC@mail.gmail.com>
	<4BEBAD34.20102@gmail.com>
Message-ID: <AANLkTim7sxjiqBgX-fnJOIKJpiCZWi6Ks5CrqRaGYlrM@mail.gmail.com>

On Thu, May 13, 2010 at 3:41 AM, Paul Vriens <paul.vriens.wine at gmail.com>wrote:
>
> I don't think these comments are needed as the same is shown in the tests
> below (I was actually triggered by the wrong spelling of 'receives' btw).
>

Whoops. I always manage to misspell receive somehow...

I'll submit a new patch here shortly.

-- 
Thomas Mullaly
thomas.mullaly at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100513/191e13f1/attachment.htm>

From aric at codeweavers.com  Thu May 13 11:42:49 2010
From: aric at codeweavers.com (Aric Stewart)
Date: Thu, 13 May 2010 11:42:49 -0500
Subject: [Fwd: Re: winemp3.acm: Fixes the Mac-specific code]
In-Reply-To: <AANLkTikmW1u8iNxtDokHa1Oa3TPrjHm6isQ1jZaTczUn@mail.gmail.com>
References: <4BEBEC3A.3020904@codeweavers.com>
	<AANLkTikmW1u8iNxtDokHa1Oa3TPrjHm6isQ1jZaTczUn@mail.gmail.com>
Message-ID: <4BEC2C09.5020109@codeweavers.com>

Hi,

   I will admit that my understanding of both ACM drivers as well as the 
os x audio libraries are not perfect and mostly come from work on this 
code itself. So i will fully admit it is most likely full of areas 
needing improvement.

Kristofer Henriksson wrote:
> Aric,
> 
> I may have been operating under some faulty assumptions. I thought
> that all mp3 files would "begin at the beginning" and also keep track
> of how much of the source data the convert function said that it used.
> I am very careful to set the value of *nsrc to agree with how much
> source data was successfully used and assume that the calling function
> with resend the data that is not used. If this is done, it ensures a
> valid frame at the start of each invocation.

Yes, a proper application should do just that. It should be tracking the 
value in nsrc and resend unused data at the beginning of the next buffer.

You get a lot of the expected source stream format from 
MPEG3_StreamOpen.  With that i wonder if the presence of an ID3 tag 
becomes optional.  My familiarity with mp3 format makes me unsure if a 
packet header would also be required.

> 
> As far as using AudioFileStream, I tried for a bit to get it to work
> before I wrote my own custom mp3 parser. I'm running Snow Leopard
> (10.6.3) and never got the background music to work in Oblivion. One
> of the problems is that Mp3AudioConverterComplexInputDataProc needs to
> return an error if it will have more data in the future, rather than
> returning zero. However, even changing this, AudioFileStream seemed to
> be skipping a lot of mp3 frames.
> 

The lack of an error in that return is probably an oversight on my part. 
  All the mp3 clips in the game i was working with where sent in one 
piece so there was only one pass through the loop that consumed all of 
the data. I am unsure why skipping mp3 frames would occure. My guess is 
that I am feeding the data in incorrectly and on those boundries between 
feeds frames are being ignored/corrupted or the like.

> If you tell me what are more appropriate assumptions I should be
> making in my parser, I can fix it to work the way it should. I suppose
> I am also assuming that it will usually receive at least one full
> packet, and if this is unjustified I can fix this as well. If I should
> expect calling functions to ignore the value of *nsrc, then I can just
> implement an internal single-packet buffer, and this should take care
> of the problem.
> 

I think the assumptions we need to investigate is the one about there 
being a packet header at the beginning.  Maybe for non variable bit rate 
mp3s we just get the data given to us when the stream is opened.

In fact, going on a hunch i just got your code to work great with my game!

What i did was this:

I added PACMDRVSTREAMINSTANCE adsi to Mp3GetPacketLength  and then when 
you would return -1 if you could not determin the header I instead 
returned (192000 * 144) / adsi->pwfxDst->nSamplesPerSec.

I picked that because it shows up in other areas of the code where we 
need to get a length.

This is exciting also because there where a few mp3s that whre returning 
  'Fmt?' errors from the stream code and would not play. But with your 
patch and this change those clips played as well.

Does that give you something to work with?  You clearly understand mp3 
format better than I.

-aric


From aric at codeweavers.com  Thu May 13 11:46:36 2010
From: aric at codeweavers.com (Aric Stewart)
Date: Thu, 13 May 2010 11:46:36 -0500
Subject: [Fwd: Re: winemp3.acm: Fixes the Mac-specific code]
In-Reply-To: <4BEC2C09.5020109@codeweavers.com>
References: <4BEBEC3A.3020904@codeweavers.com>
	<AANLkTikmW1u8iNxtDokHa1Oa3TPrjHm6isQ1jZaTczUn@mail.gmail.com>
	<4BEC2C09.5020109@codeweavers.com>
Message-ID: <4BEC2CEC.5050900@codeweavers.com>

There is a bug in the code i just posted,  It should clearly be
adsi->pwfxSrc->nSamplesPerSec not Dst.

Still works great,  probibly because my tests had the same 
nSamplesPerSec for both Src and Dst.

-aric

Aric Stewart wrote:
> Hi,
> 
>   I will admit that my understanding of both ACM drivers as well as the 
> os x audio libraries are not perfect and mostly come from work on this 
> code itself. So i will fully admit it is most likely full of areas 
> needing improvement.
> 
> Kristofer Henriksson wrote:
>> Aric,
>>
>> I may have been operating under some faulty assumptions. I thought
>> that all mp3 files would "begin at the beginning" and also keep track
>> of how much of the source data the convert function said that it used.
>> I am very careful to set the value of *nsrc to agree with how much
>> source data was successfully used and assume that the calling function
>> with resend the data that is not used. If this is done, it ensures a
>> valid frame at the start of each invocation.
> 
> Yes, a proper application should do just that. It should be tracking the 
> value in nsrc and resend unused data at the beginning of the next buffer.
> 
> You get a lot of the expected source stream format from 
> MPEG3_StreamOpen.  With that i wonder if the presence of an ID3 tag 
> becomes optional.  My familiarity with mp3 format makes me unsure if a 
> packet header would also be required.
> 
>>
>> As far as using AudioFileStream, I tried for a bit to get it to work
>> before I wrote my own custom mp3 parser. I'm running Snow Leopard
>> (10.6.3) and never got the background music to work in Oblivion. One
>> of the problems is that Mp3AudioConverterComplexInputDataProc needs to
>> return an error if it will have more data in the future, rather than
>> returning zero. However, even changing this, AudioFileStream seemed to
>> be skipping a lot of mp3 frames.
>>
> 
> The lack of an error in that return is probably an oversight on my part. 
>  All the mp3 clips in the game i was working with where sent in one 
> piece so there was only one pass through the loop that consumed all of 
> the data. I am unsure why skipping mp3 frames would occure. My guess is 
> that I am feeding the data in incorrectly and on those boundries between 
> feeds frames are being ignored/corrupted or the like.
> 
>> If you tell me what are more appropriate assumptions I should be
>> making in my parser, I can fix it to work the way it should. I suppose
>> I am also assuming that it will usually receive at least one full
>> packet, and if this is unjustified I can fix this as well. If I should
>> expect calling functions to ignore the value of *nsrc, then I can just
>> implement an internal single-packet buffer, and this should take care
>> of the problem.
>>
> 
> I think the assumptions we need to investigate is the one about there 
> being a packet header at the beginning.  Maybe for non variable bit rate 
> mp3s we just get the data given to us when the stream is opened.
> 
> In fact, going on a hunch i just got your code to work great with my game!
> 
> What i did was this:
> 
> I added PACMDRVSTREAMINSTANCE adsi to Mp3GetPacketLength  and then when 
> you would return -1 if you could not determin the header I instead 
> returned (192000 * 144) / adsi->pwfxDst->nSamplesPerSec.
> 
> I picked that because it shows up in other areas of the code where we 
> need to get a length.
> 
> This is exciting also because there where a few mp3s that whre returning 
>  'Fmt?' errors from the stream code and would not play. But with your 
> patch and this change those clips played as well.
> 
> Does that give you something to work with?  You clearly understand mp3 
> format better than I.
> 
> -aric
> 


From mike.kaplinskiy at gmail.com  Thu May 13 12:57:42 2010
From: mike.kaplinskiy at gmail.com (Mike Kaplinskiy)
Date: Thu, 13 May 2010 13:57:42 -0400
Subject: [PATCH 5/5] server: get rid of sock_try_event
In-Reply-To: <87hbmc2iz8.fsf@wine.dyndns.org>
References: <r2o4d8b5aa81005112259z36634779s385a2cc2b82cdf@mail.gmail.com> 
	<87hbmc2iz8.fsf@wine.dyndns.org>
Message-ID: <AANLkTil0zK3nLiAMfJVAuQ_fPKmDoR_yvu00FF1uOrFK@mail.gmail.com>

On Thu, May 13, 2010 at 6:28 AM, Alexandre Julliard <julliard at winehq.org> wrote:
> Mike Kaplinskiy <mike.kaplinskiy at gmail.com> writes:
>
>> We *might* need to ignore POLLERR messages for UDP sockets, as the
>> condition is actually temporary and sock_try_event was hiding this.
>
> It doesn't work here:
>
> ../../../tools/runtest -q -P wine -M ws2_32.dll -T ../../.. -p ws2_32_test.exe.so sock.c && touch sock.ok
> sock.c:941: Test failed: some threads have not completed: 102
> sock.c:3567: Tests skipped: WSAIoctl failed to get AcceptEx with ret -1 + errno 10045
> make: *** [sock.ok] Error 1
>
> --
> Alexandre Julliard
> julliard at winehq.org
>

Hmm, this turns out to be somewhat intermittent. Looks like I forgot
one of the patches in the series (we tend to ignore POLLHUP on
SOCK_SHUTDOWN_EOF). Sorry about that, I'll resend for tomorrow. The
patches before this one should be ok.

Mike.


From kgbricola at web.de  Thu May 13 12:59:06 2010
From: kgbricola at web.de (=?ISO-8859-1?Q?Rico_Sch=FCller?=)
Date: Thu, 13 May 2010 19:59:06 +0200
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <AANLkTikuktWXenPo5PdStW2RLZmG43rPBaWmh-ewCA63@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>	
	<o2ma71bd89a1005091614vd3dc6612s699904ae795c55e6@mail.gmail.com>	
	<l2za71bd89a1005091746g66e4518bh5e5463261f60b5fd@mail.gmail.com>	
	<4BEBDEAD.2070800@web.de>
	<AANLkTikuktWXenPo5PdStW2RLZmG43rPBaWmh-ewCA63@mail.gmail.com>
Message-ID: <4BEC3DEA.4080901@web.de>

Am 13.05.2010 14:52, schrieb Dan Kegel:
> 2010/5/13 Rico Sch?ller<kgbricola at web.de>:
>    
>>> I just tried 'winetricks glsl-disable' on heaven2_d3d9.  It sped it up
>>> about 8% (to 16.0 fps), but added some fun problems (e.g. scenes
>>> 7, 10, and 12 have a black sky).
>>>        
>> Sceenes 7, 10 and 12 are totally black here on wine on opengl. But the linux
>> native client has the same problem. So I guess there opengl engine is
>> lacking some futures.
>>      
> That's interesting.  What graphics hardware + drivers are you using?
>
>    
Geforce 8800 GTS, 195.36.15

It could also be a bad driver. Could you see all scenes correctly using 
Heaven_gl.bat ? The easiest way to detect this is to run two copys, one 
with d3d9 and one with opengl. This way one could see, when a scene is 
not drawn. Otherwise you could think that the black screen is only the 
scene switching.


From fgouget at free.fr  Thu May 13 13:31:04 2010
From: fgouget at free.fr (Francois Gouget)
Date: Thu, 13 May 2010 20:31:04 +0200 (CEST)
Subject: Release plans
In-Reply-To: <87k4r93vra.fsf@wine.dyndns.org>
References: <87hbmii6aj.fsf@wine.dyndns.org>
	<n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>
	<87pr15glwr.fsf@wine.dyndns.org> <4BEAC489.90706@open-vote.org>
	<87k4r93vra.fsf@wine.dyndns.org>
Message-ID: <alpine.DEB.2.00.1005132025080.4219@amboise.dolphin>

On Wed, 12 May 2010, Alexandre Julliard wrote:

> Scott Ritchie <scott at open-vote.org> writes:
> 
> > On 05/09/2010 05:00 PM, Alexandre Julliard wrote:
> >> We definitely need a release changelog, yes.
> >
> > It seems to me what we really want is more than a changelog but a proper
> > release announcement.  I want a journalist who has hardly heard of Wine
> > to read the page and understand what we've done and why it's great.
> 
> Sure, that's the press release, we should have one too, but it's a
> different thing. A changelog would be a detailed description of changes
> that matter from a user point of view. It would list for instance new
> builtin programs, new configuration options, new behaviors, new system
> dependencies, backwards compatibility concerns, etc.

Isn't that more a release notes document?

So we'd have:
 * Press Release
   Announcing the new Wine to the world at large. Must be readable by 
   people who have never heard of Wine before.

 * Release notes
   A user friendly and high-level description what's new and what's 
   changed.

 * Changelog
   A detailed description of what's changed from a developper 
   perspective, that is the usual list of commit messages.



-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
           If it stinks, it's chemistry. If it moves, it's biology.
                  If it does not work, It's computer science.


From kthenriksson at gmail.com  Thu May 13 13:29:05 2010
From: kthenriksson at gmail.com (Kristofer Henriksson)
Date: Thu, 13 May 2010 14:29:05 -0400
Subject: [Fwd: Re: winemp3.acm: Fixes the Mac-specific code]
In-Reply-To: <4BEC2CEC.5050900@codeweavers.com>
References: <4BEBEC3A.3020904@codeweavers.com>
	<AANLkTikmW1u8iNxtDokHa1Oa3TPrjHm6isQ1jZaTczUn@mail.gmail.com> 
	<4BEC2C09.5020109@codeweavers.com> <4BEC2CEC.5050900@codeweavers.com>
Message-ID: <AANLkTim_DGsZzWiNlpgsYfzMYfTjE2f9HIlvztRfxQbs@mail.gmail.com>

I think the reason why your change works is that it seems the
AudioConverter doesn't care if it has invalid data at the beginning of
its stream. There will be however a little creeping error in
computation of frame lengths over time, which is that there may or may
not be one extra byte of padding on any given frame, and you need to
look at the frame header to know if it's there. Ignoring the padding
is essentially equivalent to ignoring the remainder in the division
you do to get the frame size.

I'm still perplexed why the very first call to the conversion function
will not start the source data with an ID3 tag or a frame header. The
data shouldn't start in the middle of a frame, and there should be
nothing else in an MP3 file than frames and ID3.

At any rate, I can fix my code to properly sync to MP3 frames, and
then the padding should be properly picked up as well.

Regards,
Kristofer

On Thu, May 13, 2010 at 12:46 PM, Aric Stewart <aric at codeweavers.com> wrote:
> There is a bug in the code i just posted, ?It should clearly be
> adsi->pwfxSrc->nSamplesPerSec not Dst.
>
> Still works great, ?probibly because my tests had the same nSamplesPerSec
> for both Src and Dst.
>
> -aric
>
> Aric Stewart wrote:
>>
>> Hi,
>>
>> ?I will admit that my understanding of both ACM drivers as well as the os
>> x audio libraries are not perfect and mostly come from work on this code
>> itself. So i will fully admit it is most likely full of areas needing
>> improvement.
>>
>> Kristofer Henriksson wrote:
>>>
>>> Aric,
>>>
>>> I may have been operating under some faulty assumptions. I thought
>>> that all mp3 files would "begin at the beginning" and also keep track
>>> of how much of the source data the convert function said that it used.
>>> I am very careful to set the value of *nsrc to agree with how much
>>> source data was successfully used and assume that the calling function
>>> with resend the data that is not used. If this is done, it ensures a
>>> valid frame at the start of each invocation.
>>
>> Yes, a proper application should do just that. It should be tracking the
>> value in nsrc and resend unused data at the beginning of the next buffer.
>>
>> You get a lot of the expected source stream format from MPEG3_StreamOpen.
>> ?With that i wonder if the presence of an ID3 tag becomes optional. ?My
>> familiarity with mp3 format makes me unsure if a packet header would also be
>> required.
>>
>>>
>>> As far as using AudioFileStream, I tried for a bit to get it to work
>>> before I wrote my own custom mp3 parser. I'm running Snow Leopard
>>> (10.6.3) and never got the background music to work in Oblivion. One
>>> of the problems is that Mp3AudioConverterComplexInputDataProc needs to
>>> return an error if it will have more data in the future, rather than
>>> returning zero. However, even changing this, AudioFileStream seemed to
>>> be skipping a lot of mp3 frames.
>>>
>>
>> The lack of an error in that return is probably an oversight on my part.
>> ?All the mp3 clips in the game i was working with where sent in one piece so
>> there was only one pass through the loop that consumed all of the data. I am
>> unsure why skipping mp3 frames would occure. My guess is that I am feeding
>> the data in incorrectly and on those boundries between feeds frames are
>> being ignored/corrupted or the like.
>>
>>> If you tell me what are more appropriate assumptions I should be
>>> making in my parser, I can fix it to work the way it should. I suppose
>>> I am also assuming that it will usually receive at least one full
>>> packet, and if this is unjustified I can fix this as well. If I should
>>> expect calling functions to ignore the value of *nsrc, then I can just
>>> implement an internal single-packet buffer, and this should take care
>>> of the problem.
>>>
>>
>> I think the assumptions we need to investigate is the one about there
>> being a packet header at the beginning. ?Maybe for non variable bit rate
>> mp3s we just get the data given to us when the stream is opened.
>>
>> In fact, going on a hunch i just got your code to work great with my game!
>>
>> What i did was this:
>>
>> I added PACMDRVSTREAMINSTANCE adsi to Mp3GetPacketLength ?and then when
>> you would return -1 if you could not determin the header I instead returned
>> (192000 * 144) / adsi->pwfxDst->nSamplesPerSec.
>>
>> I picked that because it shows up in other areas of the code where we need
>> to get a length.
>>
>> This is exciting also because there where a few mp3s that whre returning
>> ?'Fmt?' errors from the stream code and would not play. But with your patch
>> and this change those clips played as well.
>>
>> Does that give you something to work with? ?You clearly understand mp3
>> format better than I.
>>
>> -aric
>>
>


From gerald at pfeifer.com  Thu May 13 15:58:08 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Thu, 13 May 2010 22:58:08 +0200 (CEST)
Subject: comctl32/tests: Remove variable res which is not really used
	from test_monthcal_size.
In-Reply-To: <4BE1FA8A.4070205@codeweavers.com>
References: <20100505221106.097F394333@pulcherrima.dbai.tuwien.ac.at>
	<4BE1FA8A.4070205@codeweavers.com>
Message-ID: <alpine.LSU.1.99.1005132159520.26362@acrux.dbai.tuwien.ac.at>

On Thu, 6 May 2010, Nikolay Sivov wrote:
>> -    res = SendMessage(hwnd, MCM_GETMINREQRECT, 0, (LPARAM)&r1);
>> +    SendMessage(hwnd, MCM_GETMINREQRECT, 0, (LPARAM)&r1);
> Actually it won't hurt to test for it here.

Okay.  I am currently testing a patch that does exactly that in both
cases.  Thanks for the constructive feedback!

Gerald


From gerald at pfeifer.com  Thu May 13 16:56:02 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Thu, 13 May 2010 23:56:02 +0200 (CEST)
Subject: advpack: Only do_ocx_reg (and thus DllRegisterServer) from 
	RegisterOCX when 'N' is passed as a flag. Clarify documentation.
In-Reply-To: <AANLkTilfZM3xVdblalCv6vwooehXSuNFu6f2fZeGmgXB@mail.gmail.com>
References: <20100511202447.D6A951604A@acrux.dbai.tuwien.ac.at>
	<AANLkTilfZM3xVdblalCv6vwooehXSuNFu6f2fZeGmgXB@mail.gmail.com>
Message-ID: <alpine.LSU.1.99.1005132345470.26362@acrux.dbai.tuwien.ac.at>

On Tue, 11 May 2010, James Hawkins wrote:
> I'm very hesitant about this.  MSDN has no documentation about
> RegisterOCX, so I'm not sure how you're justifying this change.  It's
> been a long time since I worked on this, so I don't remember much, but
> I do remember testing this method and documenting the parameters
> correctly.  Where are you getting information that 'I' is required
> when using 'N'?

I had to look again, and it seems the best I managed to find is the
following:

  http://msdn.microsoft.com/en-us/library/bb759846%28VS.85%29.aspx

If you experimentally verified something differently I will be happy
to follow that.  However, I did not found the original documentation
sufficiently clear to really use it as a specification to base the
implementation on.

Specific questions I ran into were:

 - what happens if none of these are specified?
 - can the string contain more than one character? (pressumably yes?)
 - what happens if both are specified?

Would you feel more comfortable leaving the documentation as is and
me just suggesting the following?

    if(strchrW(str_flags,'I'))
        hr = do_ocx_reg(hm, TRUE);

to replace

    hr = do_ocx_reg(hm, TRUE);

?


Or would you prefer to submit a patch to clarify the documentation 
(copying me) and based on that I hack the code?  That way we'd ensure 
that the former is sufficiently clear and I assume you'll verify
whether the code matches that?


Whatever works for you as long as we make progress. :-)

Gerald


From testbot at testbot.winehq.org  Thu May 13 20:14:06 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Fri, 14 May 2010 03:14:06 +0200
Subject: [3/3] user32: Convert data in WM_DDE_EXECUTE to ansi when
	expected. 
Message-ID: <201005140114.o4E1E6Bv019565@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2059

Your paranoid android.


=== W98SE (32 bit dde) ===
dde.c:586: Test failed: Expected TestDDEServer(, got TestDDEServer:(04dc)
dde.c:588: Test failed: Got size 20 for TestDDEServer:(04dc)
dde.c:659: Test failed: Expected 1, got 0
dde.c:692: Test failed: Expected 12, got 28
dde.c:700: Test failed: Expected 1, got 0
dde.c:922: Test failed: Expected FALSE, got 1
dde.c:939: Test failed: Expected item atom, got 00000000
dde.c:942: Test failed: Expected poke, got 
dde.c:943: Test failed: Expected 4, got 0
dde.c:692: Test failed: Expected 12, got 28
dde.c:934: Test failed: Expected 0, got 0000c1ae
dde.c:935: Test failed: Expected empty string, got 4
dde.c:731: Test failed: Expected '[Command(Var)]', got (null)
dde.c:732: Test failed: Expected 15, got 12
dde.c:939: Test failed: Expected item atom, got 00000000
dde.c:750: Test failed: DdeGetData should have returned 17 not 0
dde.c:756: Test failed: Expected '[Command-2(Var)]' got t
dde.c:757: Test failed: Expected 17, got 0
dde.c:886: Test failed: Execpted execute hglobal, got 00000000
dde.c:892: Test failed: Expected '[Command(Var)]', got (null)
dde.c:737: Test failed: Expected '[BadCommand(Var)]', got [Command(Var)]
dde.c:738: Test failed: Expected 18, got 32
dde.c:895: Test failed: Expected TRUE, got 0
dde.c:896: Test failed: Expected '[Command-2(Var)]', got [Command(Var)]
dde.c:714: Test failed: Expected 9 or 11, got 12
dde.c:901: Test failed: Expected '[BadCommand(Var)]', got [Command-2(Var)]
dde.c:714: Test failed: Expected 9 or 11, got 13
dde.c:857: Test failed: Expected 2, 3, 4, 6, 7, 8, 9, 10 or 11, got 12
dde.c:918: Test failed: Expected TRUE, got 0
dde.c:939: Test failed: Expected item atom, got 008307f4
dde.c:812: Test failed: client failed with 15 error(s)
dde.c:2040: Test failed: Expected 0xcafebabe, got 00000884
dde.c:2041: Test failed: Expected 0xdeadbeef, got 00000083


From testbot at testbot.winehq.org  Thu May 13 20:05:52 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Fri, 14 May 2010 03:05:52 +0200
Subject: [1/3] user32: Convert data in WM_DDE_EXECUTE to unicode when
	expected. 
Message-ID: <201005140105.o4E15qlJ019260@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2058

Your paranoid android.


=== W98SE (32 bit dde) ===
dde.c:586: Test failed: Expected TestDDEServer(, got TestDDEServer:(04dc)
dde.c:588: Test failed: Got size 20 for TestDDEServer:(04dc)
dde.c:659: Test failed: Expected 1, got 0
dde.c:692: Test failed: Expected 12, got 28
dde.c:700: Test failed: Expected 1, got 0
dde.c:922: Test failed: Expected FALSE, got 1
dde.c:939: Test failed: Expected item atom, got 00000000
dde.c:942: Test failed: Expected poke, got 
dde.c:943: Test failed: Expected 4, got 0
dde.c:692: Test failed: Expected 12, got 28
dde.c:934: Test failed: Expected 0, got 0000c1ae
dde.c:935: Test failed: Expected empty string, got 4
dde.c:731: Test failed: Expected '[Command(Var)]', got (null)
dde.c:732: Test failed: Expected 15, got 12
dde.c:939: Test failed: Expected item atom, got 00000000
dde.c:750: Test failed: DdeGetData should have returned 17 not 0
dde.c:756: Test failed: Expected '[Command-2(Var)]' got t
dde.c:757: Test failed: Expected 17, got 0
dde.c:886: Test failed: Execpted execute hglobal, got 00000000
dde.c:892: Test failed: Expected '[Command(Var)]', got (null)
dde.c:737: Test failed: Expected '[BadCommand(Var)]', got [Command(Var)]
dde.c:738: Test failed: Expected 18, got 32
dde.c:895: Test failed: Expected TRUE, got 0
dde.c:896: Test failed: Expected '[Command-2(Var)]', got [Command(Var)]
dde.c:714: Test failed: Expected 9 or 11, got 12
dde.c:901: Test failed: Expected '[BadCommand(Var)]', got [Command-2(Var)]
dde.c:714: Test failed: Expected 9 or 11, got 13
dde.c:857: Test failed: Expected 2, 3, 4, 6, 7, 8, 9, 10 or 11, got 12
dde.c:918: Test failed: Expected TRUE, got 0
dde.c:939: Test failed: Expected item atom, got 008307f4
dde.c:812: Test failed: client failed with 15 error(s)
dde.c:2040: Test failed: Expected 0xcafebabe, got 00000884
dde.c:2041: Test failed: Expected 0xdeadbeef, got 00000083


From dmitry at codeweavers.com  Thu May 13 21:51:22 2010
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 14 May 2010 11:51:22 +0900
Subject: gdi32: use usp10 to optionally generate glyphs for bidi strings
In-Reply-To: <4BEC1E1E.4000706@codeweavers.com>
References: <4BEC1E1E.4000706@codeweavers.com>
Message-ID: <20100514115122.089166cd.dmitry@codeweavers.com>

Aric Stewart <aric at codeweavers.com> wrote:

> allows us to be able to make use of the mirroring code and eventually 
> the shaping code when it is in place.

This should be done the other way around. gdi32 should not depend on
a high level dll (that creates circular dependencies), gdi32 in Windows
doesn't use usp10 either.

-- 
Dmitry.


From gerald at pfeifer.com  Thu May 13 17:54:13 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Fri, 14 May 2010 00:54:13 +0200 (CEST)
Subject: gdi32/tests: Remove variable oldPen which is not really used
	from test_widenpath.
In-Reply-To: <4BE7812D.20504@kievinfo.com>
References: <20100507190658.90E3194333@pulcherrima.dbai.tuwien.ac.at>
	<4BE7812D.20504@kievinfo.com>
Message-ID: <alpine.LSU.1.99.1005140050000.26362@acrux.dbai.tuwien.ac.at>

On Sun, 9 May 2010, Vitaliy Margolen wrote:
> On 05/07/2010 01:06 PM, Gerald Pfeifer wrote:
>> -    oldPen = SelectObject(hdc, greenPen);
>> +    SelectObject(hdc, greenPen);
> If it's not used it's a bug. Everything should be reset to original 
> state to prevent influence on following tests. There are number of such 
> places in Wine's test suite that makes it impossible to isolate the 
> problem.

Hmm, the function test_widenpath starts with HDC hdc = GetDC(0) and ends 
with ReleaseDC(0, hdc).  Do you suggest to SelectObject(hdc,oldPen) before 
the latter?  Isn't that a no-op?

There are two instances in that function where a pen is selected.  Do you
suggest to restore to the old pen before the second?  Looking at the test,
I'm not sure how relevant that would be.

(Alexandre already committed my original patch, but I don't want to just
ignore your feedback.  It's well possible I may be missing something.)

Gerald


From gerald at pfeifer.com  Thu May 13 19:26:14 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Fri, 14 May 2010 02:26:14 +0200 (CEST)
Subject: wineps.drv: Remove variables scale_xx, scale_xy, scale_yx, and
	scale_yy and two dozen lines of dead code from append_complex_glyph.
In-Reply-To: <4BE66D03.4090702@codeweavers.com>
References: <20100507213608.448C894333@pulcherrima.dbai.tuwien.ac.at>
	<4BE66D03.4090702@codeweavers.com>
Message-ID: <alpine.LSU.1.99.1005140224180.26362@acrux.dbai.tuwien.ac.at>

On Sun, 9 May 2010, Nikolay Sivov wrote:
> I don't think it's dead. Variable ptr is used in a cycle.

You are amazing.  And right.  I just submitted an updated patch.

Gerald


From paul.vriens.wine at gmail.com  Fri May 14 04:22:36 2010
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 14 May 2010 11:22:36 +0200
Subject: Sudden increase of Valgrind errors
In-Reply-To: <a71bd89a1002280649w629524c3q6f292d571ea3b3ac@mail.gmail.com>
References: <4B8A7300.8050707@gmail.com>
	<a71bd89a1002280649w629524c3q6f292d571ea3b3ac@mail.gmail.com>
Message-ID: <4BED165C.7070102@gmail.com>

On 02/28/2010 03:49 PM, Dan Kegel wrote:
> Two things: I moved to karmic (and now more modules are enabled, since
> it comes with new-enough libraries), and I updated valgrind.  I haven't
> had time to dig in to the differences.  The suppressions file also needs
> updating for karmic.
>

Hi Dan,

What's the status on the Valgrind reporting you were doing 
(automatically)? The last one is from March 18th if I'm correct.

I'm not sure if fixing Valgrind errors would be accepted in the code 
freeze period but I still find it useful to have such reporting.

The same is true for Coverity. There are quite a lot false positives and 
several errors can be ignored but on the other hand loads of (potential) 
bugs were fixed because of these reports.

-- 
Cheers,

Paul.


From julliard at winehq.org  Fri May 14 04:49:19 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 14 May 2010 11:49:19 +0200
Subject: shdocvw: Added IDataObject stub implementation.
In-Reply-To: <201005131553.00096.shpigor@etersoft.ru> (Ilya Shpigor's message
	of "Thu, 13 May 2010 15:52:59 +0400")
References: <201005131553.00096.shpigor@etersoft.ru>
Message-ID: <87sk5un78g.fsf@wine.dyndns.org>

Ilya Shpigor <shpigor at etersoft.ru> writes:

> ---
>  dlls/shdocvw/Makefile.in  |    1 +
>  dlls/shdocvw/dataobject.c |  127 +++++++++++++++++++++++++++++++++++++++++++++
>  dlls/shdocvw/shdocvw.h    |    3 +
>  dlls/shdocvw/webbrowser.c |    4 ++
>  4 files changed, 135 insertions(+), 0 deletions(-)
>  create mode 100644 dlls/shdocvw/dataobject.c

Please don't create a new file for every interface. There are enough
existing files where this can go. Same for IOleLink.

-- 
Alexandre Julliard
julliard at winehq.org


From Joerg-Cyril.Hoehle at t-systems.com  Fri May 14 05:31:12 2010
From: Joerg-Cyril.Hoehle at t-systems.com (Joerg-Cyril.Hoehle at t-systems.com)
Date: Fri, 14 May 2010 12:31:12 +0200
Subject: Release plans
Message-ID: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>

Hi,

>The 64-bit support is now more or less complete
I hope I can finish my MCI parser patches in time. Without them,
every 64bit app using MCI string commands is likely to crash (OTOH
MCI commands work (those using the MCI_*_PARAMS structures)).


What can Mac users expect from this release?

Yesterday I installed an app with wine-1.1.44 on Mac OS (instead of
moving it from a Linux install). It was disappointing from a user POV:

- Wine created .desktop files that work on Linux but don't make sense
  on Mac OS.  Here I've been thinking about a simple patch that would
  instead generate a .command file like I've described in the FAQ.
  OTOH, Steven Edwards IIRC once had a much more elaborate patch about
  better Mac OS integration, rejected last year.

- In the hidden directory ~/.local/share/icons/ it created .xpm files
  that the Finder does not display.  .png would be displayed.

I have no idea how the other packages built atop Wine behave on MacOS behave:
 - Kronenberg's WineBottler
 - doh's WineSkin
 - Macports build
 - CodeWeaver's CrossOver4Mac
I assume they create nice icons that the user can click after an install.

Regarding the former 2 packages, I've always been wondering why
there's some sort of split in the Wine+Mac user community.  Obviously
the stock Wine fails to meet the Mac user's expectations, such that
several people start and write something better integrated with the
GUI -- but not integrated into the Wine source.

And I didn't write trivial Mac patches either, e.g. to have
wineprefixcreate symlink c:\users\xyz\ Desktop + Videos + Documents +
Music to /Users/xyz/Desktop/ etc.  This happens on Linux, not on MacOS.
That's another (example of a) missing element.
(Why didn't I write it? Because I was unsure where to put the #ifdef)

Regards,
 J?rg H?hle


From aric at codeweavers.com  Fri May 14 07:18:19 2010
From: aric at codeweavers.com (Aric Stewart)
Date: Fri, 14 May 2010 07:18:19 -0500
Subject: gdi32: use usp10 to optionally generate glyphs for bidi strings
In-Reply-To: <20100514115122.089166cd.dmitry@codeweavers.com>
References: <4BEC1E1E.4000706@codeweavers.com>
	<20100514115122.089166cd.dmitry@codeweavers.com>
Message-ID: <4BED3F8B.20404@codeweavers.com>

Hi Dmitry,

   I know this is not official MSDN documentation but this appears to 
disagree with you. http://www.catch22.net/tuts/neatpad/11

It also makes sense to have all the complex script processing logic in 
one place instead of spreading it out and duplicating it.

Why do you say that Windows gdi32 does not use usp10?  I do not see a 
direct dependency but I have not traced inside to see if it is doing 
LoadProcAddress or the like.

-aric

Dmitry Timoshkov wrote:
> Aric Stewart <aric at codeweavers.com> wrote:
> 
>> allows us to be able to make use of the mirroring code and eventually 
>> the shaping code when it is in place.
> 
> This should be done the other way around. gdi32 should not depend on
> a high level dll (that creates circular dependencies), gdi32 in Windows
> doesn't use usp10 either.
> 


From dank at kegel.com  Fri May 14 09:12:18 2010
From: dank at kegel.com (Dan Kegel)
Date: Fri, 14 May 2010 07:12:18 -0700
Subject: Sudden increase of Valgrind errors
In-Reply-To: <4BED165C.7070102@gmail.com>
References: <4B8A7300.8050707@gmail.com>
	<a71bd89a1002280649w629524c3q6f292d571ea3b3ac@mail.gmail.com>
	<4BED165C.7070102@gmail.com>
Message-ID: <AANLkTik0JQer4XZz1TDupo7ySVZsjhWMPYo1hG2ft_Pw@mail.gmail.com>

On Fri, May 14, 2010 at 2:22 AM, Paul Vriens <paul.vriens.wine at gmail.com> wrote:
> What's the status on the Valgrind reporting you were doing (automatically)?
> The last one is from March 18th if I'm correct.

It got lost in the shuffle (sore wrists, busy day job, etc.) but I
should be able
to start it up again.  (Once I have the 3d performance reporting bot happy,
anyway.)

> I'm not sure if fixing Valgrind errors would be accepted in the code freeze
> period but I still find it useful to have such reporting.

At the very least, catching and fixing valgrind regressions introduced
during the code freeze is absolutely a good idea.  And it'd probably be
a good idea to look at all the tests I don't currently run under valgrind
because they make it explode.
- Dan


From eric.pouech at orange.fr  Fri May 14 09:22:53 2010
From: eric.pouech at orange.fr (Eric Pouech)
Date: Fri, 14 May 2010 16:22:53 +0200
Subject: winedump: Print the network share name in .lnk files.
In-Reply-To: <1273844055.7825.823.camel@t400>
References: <1273844055.7825.823.camel@t400>
Message-ID: <AANLkTimkjaDfU8LCjPtt0RdcO7jAiAkAJzk6jW2cB8ue@mail.gmail.com>

>
> @@ -245,6 +254,18 @@ static int dump_location(void)
>     }
>     printf("\n");
>
> +    /* dump information about the network volume the link points to */
> +    printf("Network volume ofs    = %08x ", loc->dwNetworkVolTableOfs);
> +    if (loc->dwNetworkVolTableOfs &&
> (loc->dwNetworkVolTableOfs<loc->dwTotalSize))
>
me wonders if
if (loc->dwNetworkVolTableOfs && (loc->dwNetworkVolTableOfs +
sizeof(NETWORK_VOLUME_INFO)<loc->dwTotalSize))
wouldn't be better
(same also would apply for test in old code above for dwVolTableOfs






-- 
-- 
Eric Pouech
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100514/c8a91b8b/attachment.htm>

From dmitry at codeweavers.com  Fri May 14 09:24:55 2010
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Fri, 14 May 2010 23:24:55 +0900
Subject: gdi32: use usp10 to optionally generate glyphs for bidi strings
In-Reply-To: <4BED3F8B.20404@codeweavers.com>
References: <4BEC1E1E.4000706@codeweavers.com>
	<20100514115122.089166cd.dmitry@codeweavers.com>
	<4BED3F8B.20404@codeweavers.com>
Message-ID: <20100514232455.d005fe26.dmitry@codeweavers.com>

Aric Stewart <aric at codeweavers.com> wrote:

>    I know this is not official MSDN documentation but this appears to 
> disagree with you. http://www.catch22.net/tuts/neatpad/11
> 
> It also makes sense to have all the complex script processing logic in 
> one place instead of spreading it out and duplicating it.

Bidi and reordering were supported by gdi32 before Uniscribe has been
introduced.

Accridong to http://msdn.microsoft.com/en-us/goglobal/bb688137.aspx
uniscribe is used by lpk.dll (language packs): "ExtTextOut can be used
to lay out multilingual Unicode text including complex scripts. There is
no need for you to do anything other than call ExtTextOut; it handles
everything for you."

> Why do you say that Windows gdi32 does not use usp10?  I do not see a 
> direct dependency but I have not traced inside to see if it is doing 
> LoadProcAddress or the like.

Inspecting strings in gdi32.dll should be enough.

-- 
Dmitry.


From aric at codeweavers.com  Fri May 14 09:52:13 2010
From: aric at codeweavers.com (Aric Stewart)
Date: Fri, 14 May 2010 09:52:13 -0500
Subject: gdi32: use usp10 to optionally generate glyphs for bidi strings
In-Reply-To: <20100514232455.d005fe26.dmitry@codeweavers.com>
References: <4BEC1E1E.4000706@codeweavers.com>	<20100514115122.089166cd.dmitry@codeweavers.com>	<4BED3F8B.20404@codeweavers.com>
	<20100514232455.d005fe26.dmitry@codeweavers.com>
Message-ID: <4BED639D.8030908@codeweavers.com>

ok, so the LPK calls uniscribe.  Do you feel we should implement the LPK 
style of interface to gdi32?  It seems needlessly cumbersome to me. The 
LPK.dll interfaces seem to be undocumented but based on names should not 
be to difficult to figure out.

-aric

Dmitry Timoshkov wrote:
> Aric Stewart <aric at codeweavers.com> wrote:
> 
>>    I know this is not official MSDN documentation but this appears to 
>> disagree with you. http://www.catch22.net/tuts/neatpad/11
>>
>> It also makes sense to have all the complex script processing logic in 
>> one place instead of spreading it out and duplicating it.
> 
> Bidi and reordering were supported by gdi32 before Uniscribe has been
> introduced.
> 
> Accridong to http://msdn.microsoft.com/en-us/goglobal/bb688137.aspx
> uniscribe is used by lpk.dll (language packs): "ExtTextOut can be used
> to lay out multilingual Unicode text including complex scripts. There is
> no need for you to do anything other than call ExtTextOut; it handles
> everything for you."
> 
>> Why do you say that Windows gdi32 does not use usp10?  I do not see a 
>> direct dependency but I have not traced inside to see if it is doing 
>> LoadProcAddress or the like.
> 
> Inspecting strings in gdi32.dll should be enough.
> 


From julliard at winehq.org  Fri May 14 09:58:57 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Fri, 14 May 2010 16:58:57 +0200
Subject: gdi32: use usp10 to optionally generate glyphs for bidi strings
In-Reply-To: <20100514232455.d005fe26.dmitry@codeweavers.com> (Dmitry
	Timoshkov's message of "Fri, 14 May 2010 23:24:55 +0900")
References: <4BEC1E1E.4000706@codeweavers.com>
	<20100514115122.089166cd.dmitry@codeweavers.com>
	<4BED3F8B.20404@codeweavers.com>
	<20100514232455.d005fe26.dmitry@codeweavers.com>
Message-ID: <87tyqav8b2.fsf@wine.dyndns.org>

Dmitry Timoshkov <dmitry at codeweavers.com> writes:

> Aric Stewart <aric at codeweavers.com> wrote:
>
>>    I know this is not official MSDN documentation but this appears to 
>> disagree with you. http://www.catch22.net/tuts/neatpad/11
>> 
>> It also makes sense to have all the complex script processing logic in 
>> one place instead of spreading it out and duplicating it.
>
> Bidi and reordering were supported by gdi32 before Uniscribe has been
> introduced.
>
> Accridong to http://msdn.microsoft.com/en-us/goglobal/bb688137.aspx
> uniscribe is used by lpk.dll (language packs): "ExtTextOut can be used
> to lay out multilingual Unicode text including complex scripts. There is
> no need for you to do anything other than call ExtTextOut; it handles
> everything for you."

Which of course demonstrates that gdi32 calls usp10 on native too. Maybe
it does it indirectly through lpk.dll, but the end result is the same,
you have a dependency on usp10.

-- 
Alexandre Julliard
julliard at winehq.org


From jwhite at codeweavers.com  Fri May 14 10:11:33 2010
From: jwhite at codeweavers.com (Jeremy White)
Date: Fri, 14 May 2010 10:11:33 -0500
Subject: Release plans
In-Reply-To: <AANLkTikaQzqAmnZjbQEVEbjlgW_P8dUbfk1brWLFWsBZ@mail.gmail.com>
References: <87hbmii6aj.fsf@wine.dyndns.org>	<n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>	<87pr15glwr.fsf@wine.dyndns.org>
	<4BEAC489.90706@open-vote.org>	<AANLkTim7RSmNXJkmoEOuxGRaozK_WKQjvjo4-Ao8Ehze@mail.gmail.com>
	<AANLkTikaQzqAmnZjbQEVEbjlgW_P8dUbfk1brWLFWsBZ@mail.gmail.com>
Message-ID: <4BED6825.80701@codeweavers.com>

Hey Brian,

> 
> Jeremy - do you have a copy of the real press release we did for 1.0?  I
> dug around looking for it and couldn't find it.  Looks like we never
> properly posted it on WineHQ.  It did get picked up by quite a few news
> sites, but Google isn't finding it.
> 
> Scott /  Edward - when 1.0 came out, Jeremy had the PR firm that writes
> copy for Codeweavers put together a press release for Wine.  It was
> pretty good and fairly polished.  I'm not sure if having them do it
> again would be an option.  Also, I think Wine 1.0 was coordinated with a
> release of Crossover 7.0.

I can't find anything on that release, but we're certainly happy to
put together another one for Wine 1.2.  I've CC'd Jon Parshall, as he's
the guy that'll get to do it.

Cheers,

Jeremy


From hverbeet at gmail.com  Fri May 14 10:37:55 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Fri, 14 May 2010 17:37:55 +0200
Subject: [PATCH 1/3] wined3d: fix texture conversion flag bug
In-Reply-To: <1273834604-6969-1-git-send-email-thunderbird2k@gmail.com>
References: <1273834604-6969-1-git-send-email-thunderbird2k@gmail.com>
Message-ID: <AANLkTild12qqgFPTFo9YejczKZY-oXvEqhG9iIv87Y4T@mail.gmail.com>

The patch looks like it makes sense at first sight (though the double
conversion check is less than ideal), but you really want something
more descriptive for the Changelog.


From epssyis at gmail.com  Fri May 14 10:58:47 2010
From: epssyis at gmail.com (Edward Savage)
Date: Sat, 15 May 2010 01:58:47 +1000
Subject: Release plans
In-Reply-To: <4BED6825.80701@codeweavers.com>
References: <87hbmii6aj.fsf@wine.dyndns.org>
	<n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>
	<87pr15glwr.fsf@wine.dyndns.org> <4BEAC489.90706@open-vote.org>
	<AANLkTim7RSmNXJkmoEOuxGRaozK_WKQjvjo4-Ao8Ehze@mail.gmail.com>
	<AANLkTikaQzqAmnZjbQEVEbjlgW_P8dUbfk1brWLFWsBZ@mail.gmail.com>
	<4BED6825.80701@codeweavers.com>
Message-ID: <AANLkTiklsxOWIVCtpfmp3uGCpv7YjB0joED0Y-diq-y6@mail.gmail.com>

On Sat, May 15, 2010 at 1:11 AM, Jeremy White <jwhite at codeweavers.com> wrote:
>
> I can't find anything on that release, but we're certainly happy to
> put together another one for Wine 1.2. ?I've CC'd Jon Parshall, as he's
> the guy that'll get to do it.
>

Could you link us to a copy of the 1.0 one?

Some one professional doing the release would be really cool.  If that
is sorted I really want to do a short showcase of applications that do
run well now under Wine (and maybe Crossover? ie Chrome) with a blurb
and screen shot for them.  A static page that can be linked to for
people who want to quickly check out the progress instead of trudging
through the appdb.


From jwhite at codeweavers.com  Fri May 14 11:10:30 2010
From: jwhite at codeweavers.com (Jeremy White)
Date: Fri, 14 May 2010 11:10:30 -0500
Subject: Release plans
In-Reply-To: <AANLkTiklsxOWIVCtpfmp3uGCpv7YjB0joED0Y-diq-y6@mail.gmail.com>
References: <87hbmii6aj.fsf@wine.dyndns.org>	
	<n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>	
	<87pr15glwr.fsf@wine.dyndns.org> <4BEAC489.90706@open-vote.org>	
	<AANLkTim7RSmNXJkmoEOuxGRaozK_WKQjvjo4-Ao8Ehze@mail.gmail.com>	
	<AANLkTikaQzqAmnZjbQEVEbjlgW_P8dUbfk1brWLFWsBZ@mail.gmail.com>	
	<4BED6825.80701@codeweavers.com>
	<AANLkTiklsxOWIVCtpfmp3uGCpv7YjB0joED0Y-diq-y6@mail.gmail.com>
Message-ID: <4BED75F6.3000905@codeweavers.com>

Edward Savage wrote:
> On Sat, May 15, 2010 at 1:11 AM, Jeremy White <jwhite at codeweavers.com> wrote:
>> I can't find anything on that release, but we're certainly happy to
>> put together another one for Wine 1.2.  I've CC'd Jon Parshall, as he's
>> the guy that'll get to do it.
>>
> 
> Could you link us to a copy of the 1.0 one?

Um, no; that's what I meant when I said I couldn't find anything on it <grin>.
In fact, our PR firm is questioning our sanity - are we really sure we
did a release?

I'm not sure a release is all that advantageous; it goes over the wire
to overwhelmed newsprint reporters who usually ignore it.  An announcement
is quite likely to be picked up on places like Slashdot and Digg, and that
then tends to spur internet buzz far and wide.  So...an announcement
may be all we really need.

Cheers,

Jeremy


From testbot at testbot.winehq.org  Fri May 14 11:20:15 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Fri, 14 May 2010 18:20:15 +0200
Subject: [2/2] dlls/crypt32: unit test PFXImportCertStore() (2nd try) 
Message-ID: <201005141620.o4EGKF6j025719@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2067

Your paranoid android.


=== W98SE (32 bit decode) ===
decode.c:236: Test failed: succeeded in importing garbage certificate {0x57}
decode.c:249: Test failed: could not import the certificate store with a blank password {0x57}

=== WNT4WSSP6 (32 bit decode) ===
decode.c:236: Test failed: succeeded in importing garbage certificate {0x57}
decode.c:249: Test failed: could not import the certificate store with a blank password {0x57}


From stefandoesinger at gmx.at  Fri May 14 12:19:13 2010
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Fri, 14 May 2010 19:19:13 +0200
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <AANLkTilKaNLh701a0R48YPTaXKnUEYFnsoVD0CEu6rb4@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
	<70933D02-FD8E-44C1-B3AF-299B81556353@gmx.at>
	<AANLkTilKaNLh701a0R48YPTaXKnUEYFnsoVD0CEu6rb4@mail.gmail.com>
Message-ID: <201005141919.13501.stefandoesinger@gmx.at>

Am Donnerstag 13 Mai 2010 03:10:10 schrieb Dan Kegel:
> I hear there's a +timedemoquit command....
> 
> Can you send me the timedemo files you use?
My timedemo is this one here: 
http://stud4.tuwien.ac.at/~e0526822/mydemo.dem.bz2

It is quite old, but still works. It is a rather long one, but I recorded it 
when Wine ran this game at ~25 fps. Nowadays it runs at 90-100 fps, so the 
demo runs rather fast.


From dank at kegel.com  Fri May 14 13:27:33 2010
From: dank at kegel.com (Dan Kegel)
Date: Fri, 14 May 2010 11:27:33 -0700
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <201005141919.13501.stefandoesinger@gmx.at>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
	<70933D02-FD8E-44C1-B3AF-299B81556353@gmx.at>
	<AANLkTilKaNLh701a0R48YPTaXKnUEYFnsoVD0CEu6rb4@mail.gmail.com>
	<201005141919.13501.stefandoesinger@gmx.at>
Message-ID: <AANLkTin1pNW1qRdIKKrOJVtJnU5JdmKf22hORhbkM6PP@mail.gmail.com>

On Fri, May 14, 2010 at 10:19 AM, Stefan D?singer
<stefandoesinger at gmx.at> wrote:
> My timedemo is this one here:
> http://stud4.tuwien.ac.at/~e0526822/mydemo.dem.bz2
>
> It is quite old, but still works. It is a rather long one, but I recorded it
> when Wine ran this game at ~25 fps. Nowadays it runs at 90-100 fps, so the
> demo runs rather fast.

It ran nicely (if gruesomely).  But how do you get framerates out of this
(on Windows)?
http://www.digital-daily.com/video/hl2-benchmarking/ claims it shows
them in the console, and saves them to the file hl2hl2source.csv,
but neither of those seemed to happen.

Here's what I did:

cd ~/".wine/drive_c/Program Files/Steam"
cp ~/mydemo.dem config
wine steam.exe -login myuser mypass -applaunch 220 -novid -console
-window -w 1024 -h 768 -dxlevel 90 +timedemoquit mydemo.dem

I also ran it with WINEDEBUG=+file and +timedemo, but there was no
.csv opened ever :-(
- Dan


From dank at kegel.com  Fri May 14 13:32:06 2010
From: dank at kegel.com (Dan Kegel)
Date: Fri, 14 May 2010 11:32:06 -0700
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <AANLkTin1pNW1qRdIKKrOJVtJnU5JdmKf22hORhbkM6PP@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
	<70933D02-FD8E-44C1-B3AF-299B81556353@gmx.at>
	<AANLkTilKaNLh701a0R48YPTaXKnUEYFnsoVD0CEu6rb4@mail.gmail.com>
	<201005141919.13501.stefandoesinger@gmx.at>
	<AANLkTin1pNW1qRdIKKrOJVtJnU5JdmKf22hORhbkM6PP@mail.gmail.com>
Message-ID: <AANLkTilQgND_d5v03QNygSKI5EBVQIIn6vw8jemelo37@mail.gmail.com>

On Fri, May 14, 2010 at 11:27 AM, Dan Kegel <dank at kegel.com> wrote:
>> http://stud4.tuwien.ac.at/~e0526822/mydemo.dem.bz2
>
> It ran nicely (if gruesomely). ?But how do you get framerates out of this
> (on Windows)?
> http://www.digital-daily.com/video/hl2-benchmarking/ claims it shows
> them in the console, and saves them to the file hl2hl2source.csv,

http://www.techenclave.com/gaming/half-life-2-tweaks-cheats-mods-10247.html
is more specific, it says

timedemo [demoname] - Plays the specified demo and reports performance
information upon completion, including frames played, time taken,
average FPS and FPS variability. Also records the information in a
file called sourcebench.csv in your \Program
Files\Valve\Steam\SteamApps\[username]\half-life 2\hl2\ directory.

I see that directory, but there's no new file in it :-(
- Dan


From dank at kegel.com  Fri May 14 13:48:03 2010
From: dank at kegel.com (Dan Kegel)
Date: Fri, 14 May 2010 11:48:03 -0700
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <AANLkTilQgND_d5v03QNygSKI5EBVQIIn6vw8jemelo37@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
	<70933D02-FD8E-44C1-B3AF-299B81556353@gmx.at>
	<AANLkTilKaNLh701a0R48YPTaXKnUEYFnsoVD0CEu6rb4@mail.gmail.com>
	<201005141919.13501.stefandoesinger@gmx.at>
	<AANLkTin1pNW1qRdIKKrOJVtJnU5JdmKf22hORhbkM6PP@mail.gmail.com>
	<AANLkTilQgND_d5v03QNygSKI5EBVQIIn6vw8jemelo37@mail.gmail.com>
Message-ID: <AANLkTinJVfHtaySibX-jhHP3BBhGZXKF0m2dczBSsoFF@mail.gmail.com>

On Fri, May 14, 2010 at 11:32 AM, Dan Kegel <dank at kegel.com> wrote:
> On Fri, May 14, 2010 at 11:27 AM, Dan Kegel <dank at kegel.com> wrote:
>>> http://stud4.tuwien.ac.at/~e0526822/mydemo.dem.bz2
>>
>> It ran nicely (if gruesomely). ?But how do you get framerates out of this
>> (on Windows)?
>> http://www.digital-daily.com/video/hl2-benchmarking/ claims it shows
>> them in the console, and saves them to the file hl2hl2source.csv,

Aha!

wine steam.exe -login myuser mypass -applaunch 220 -novid -console
-window -w 1024 -h 768 -dxlevel 90 -condebug +timedemoquit mydemo.dem

will probably do what I want!


From octavian.voicu at gmail.com  Fri May 14 17:55:50 2010
From: octavian.voicu at gmail.com (Octavian Voicu)
Date: Sat, 15 May 2010 01:55:50 +0300
Subject: [PATCH] ntdll: Show one-time ERR if NOFILE limit is reached.
In-Reply-To: <1273877227-9664-1-git-send-email-octavian.voicu@gmail.com>
References: <1273877227-9664-1-git-send-email-octavian.voicu@gmail.com>
Message-ID: <AANLkTinJeDsHr_rYDQVdsqKN8yyeHaKKghMfYDyw7wsm@mail.gmail.com>

Forgot to mention, this fixes http://bugs.winehq.org/show_bug.cgi?id=19861.

Octavian


From octavian.voicu at gmail.com  Fri May 14 18:19:37 2010
From: octavian.voicu at gmail.com (Octavian Voicu)
Date: Sat, 15 May 2010 02:19:37 +0300
Subject: [PATCH] ntdll: Show one-time ERR if NOFILE limit is reached.
In-Reply-To: <AANLkTinJeDsHr_rYDQVdsqKN8yyeHaKKghMfYDyw7wsm@mail.gmail.com>
References: <1273877227-9664-1-git-send-email-octavian.voicu@gmail.com> 
	<AANLkTinJeDsHr_rYDQVdsqKN8yyeHaKKghMfYDyw7wsm@mail.gmail.com>
Message-ID: <AANLkTik-9mqSRJ1yEDPgjPtnfqAkyaYow_BGeuH75-kY@mail.gmail.com>

On Sat, May 15, 2010 at 1:55 AM, Octavian Voicu
<octavian.voicu at gmail.com> wrote:
> Forgot to mention, this fixes http://bugs.winehq.org/show_bug.cgi?id=19861.

I also have another idea. There are many issues that depend on
packagers to properly package wine, it's dependencies, and also
configure various aspects that might influence its stability.

There should be a page on the wiki with issues that package
maintainers should be aware of. It should be structured something like
"General issues" and "Distribution-specific issues", with
subcategories for each distribution, and a way to contact the
maintainer. This is especially important with wine1.2 around the
corner.

Such a page could include, for example, a warning about this bug and
tips for packagers on how to prevent it. Not sure about other distros,
but in Ubuntu and other Debian-based ones the wine package could
install a file /etc/security/limits.d/wine.conf to set the limit to a
safe value. Or it could be in a separate package recommended by wine,
like wine-nolimit-fix.

Octavian


From dank at kegel.com  Sat May 15 22:06:00 2010
From: dank at kegel.com (Dan Kegel)
Date: Sat, 15 May 2010 20:06:00 -0700
Subject: msvcp80 redux: easier than we thought (for some apps, at least)?
Message-ID: <AANLkTilP1w4NV1x0FqEUnv_WnIkwpWvJK76-XFhVVa1c@mail.gmail.com>

A little over a year ago, somebody asked how Wine planned to deal with msvcp80:
http://www.winehq.org/pipermail/wine-devel/2008-December/071440.html
Back then, the answer was "winetricks vcrun2005 unless you want to start
implementing it yourself":
http://www.winehq.org/pipermail/wine-devel/2008-December/071444.html

Now that msvcr80 is in pretty good shape, perhaps
it would make sense to look at whether msvcp80 could be
implemented.  Perhaps some programs only use a small subset.
Starcraft II, for instance, only needs the following seven functions
from msvcp80:

  1637  ?compare@?$char_traits at D@std@@SAHPBD0I at Z
  1498  ?_Xlen at _String_base@std@@SAXXZ
  1499  ?_Xran at _String_base@std@@SAXXZ
   377  ??0?$basic_string at DU?$char_traits at D@std@@V?$allocator at D@2@@std@@QAE at PBD@Z
  1581  ?c_str@?$basic_string at DU?$char_traits at D@std@@V?$allocator at D@2@@std@@QBEPBDXZ
c475b2
   606  ??1?$basic_string at DU?$char_traits at D@std@@V?$allocator at D@2@@std@@QAE at XZ
   370  ??0?$basic_string at DU?$char_traits at D@std@@V?$allocator at D@2@@std@@QAE at ABV01@@Z

I've added this info to
http://bugs.winehq.org/show_bug.cgi?id=22501

Perhaps we can make a little progress here more easily than we thought.
Or are more references lurking somewhere?
- Dan


From wylda at volny.cz  Sun May 16 03:07:57 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Sun, 16 May 2010 10:07:57 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_Release_plans?=
In-Reply-To: <4BED75F6.3000905@codeweavers.com>
References: <87hbmii6aj.fsf@wine.dyndns.org>	
	<n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>	
	<87pr15glwr.fsf@wine.dyndns.org> <4BEAC489.90706@open-vote.org>	
	<AANLkTim7RSmNXJkmoEOuxGRaozK_WKQjvjo4-Ao8Ehze@mail.gmail.com>	
	<AANLkTikaQzqAmnZjbQEVEbjlgW_P8dUbfk1brWLFWsBZ@mail.gmail.com>	
	<4BED6825.80701@codeweavers.com>
	<AANLkTiklsxOWIVCtpfmp3uGCpv7YjB0joED0Y-diq-y6@mail.gmail.com>
	<4BED75F6.3000905@codeweavers.com>
Message-ID: <ac37144d48d8e2a4f51aac17c4a078de@www3-mail.volny.cz>


Hi,

some time passed and because statistics are somewhat popular here, i
did one ;)

340 regressions  <-- release announcement 
356 regressions  <-- release announcement + 1week

So we are not converging... Will there be at least an effort to fix all
the regression or should i go and crawl through them and nominate them
as milestone 1.2? Don't take this bad, just a question ;)

I hope that fixing them all is the right way, which will save me time
with nominating.




From stefandoesinger at gmx.at  Sun May 16 03:56:58 2010
From: stefandoesinger at gmx.at (Stefan =?iso-8859-1?q?D=F6singer?=)
Date: Sun, 16 May 2010 10:56:58 +0200
Subject: More benchmarks of 3d performance comparing windows and linux
In-Reply-To: <AANLkTilQgND_d5v03QNygSKI5EBVQIIn6vw8jemelo37@mail.gmail.com>
References: <j2ka71bd89a1005041501o9b32e046v14072e97f58a83b@mail.gmail.com>
	<AANLkTin1pNW1qRdIKKrOJVtJnU5JdmKf22hORhbkM6PP@mail.gmail.com>
	<AANLkTilQgND_d5v03QNygSKI5EBVQIIn6vw8jemelo37@mail.gmail.com>
Message-ID: <201005161056.58576.stefandoesinger@gmx.at>

Am Freitag 14 Mai 2010 20:32:06 schrieb Dan Kegel:
> timedemo [demoname] - Plays the specified demo and reports performance
> information upon completion, including frames played, time taken,
> average FPS and FPS variability. Also records the information in a
> file called sourcebench.csv in your \Program
> Files\Valve\Steam\SteamApps\[username]\half-life 2\hl2\ directory.
> 
> I see that directory, but there's no new file in it :-(
I see the sourcebench.csv file in that directory... Not sure why it doesn't 
work for you.


From dsent.zen at gmail.com  Sun May 16 08:17:13 2010
From: dsent.zen at gmail.com (Danila Sentiabov)
Date: Sun, 16 May 2010 17:17:13 +0400
Subject: Change default library paths
Message-ID: <AANLkTimPVC0xfMvxJI0f8IzOW2hL79PGxeB5jlUPRmqT@mail.gmail.com>

Hi.
I have a set of home-made scripts for compiling and using different Wine
versions with different prefixes (no system-wide Wine installed at all).
I build new versions on Ubuntu VM (./configure
--prefix=/home/build-user/wine-build/binaries), then copy compiled binaries
to designated folder of my openSUSE box (this folder does not match with
configured --prefix, e.g. /home/my-user/wine/binaries/1.1.40) and run it,
setting correct PATH, WINELOADER and WINEPREFIX.
Everything went OK until now. I've updated my building VM from Ubuntu 8.04
to 10.04 and built Wine 1.1.44. Now it refuse to run with
wine: failed to initialize: /home/build-user/wine-build/binaries/lib/wine/
ntdll.dll.so: cannot open shared object file: No such file or directory
Setting WINEDLLPATH does not help - it searches for dlls only in default
precompiled location.
What I'm doing wrong?

-- 
Best regards,
Danila Sentiabov aka dsent
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100516/e02b2dda/attachment.htm>

From jjmckenzie51 at earthlink.net  Sun May 16 10:06:00 2010
From: jjmckenzie51 at earthlink.net (James Mckenzie)
Date: Sun, 16 May 2010 08:06:00 -0700 (GMT-07:00)
Subject: Release plans
Message-ID: <17266011.1274022360888.JavaMail.root@elwamui-royal.atl.sa.earthlink.net>

>
>
>Hi,
>
>some time passed and because statistics are somewhat popular here, i
>did one ;)
>
>340 regressions  <-- release announcement 
>356 regressions  <-- release announcement + 1week
>
Not a good statistic, but maybe we caused a few folks to decide to submit overdue regressions now that Wine 1.2 was announced.

>
>I hope that fixing them all is the right way, which will save me time
>with nominating.

+1 to this thought.  Fixing now is better than fixing later...

James McKenzie



From jjmckenzie51 at earthlink.net  Sun May 16 10:31:13 2010
From: jjmckenzie51 at earthlink.net (James Mckenzie)
Date: Sun, 16 May 2010 08:31:13 -0700 (GMT-07:00)
Subject: Work on WineQuartz for MacOSX
Message-ID: <15386303.1274023873747.JavaMail.root@mswamui-valley.atl.sa.earthlink.net>

All:

There was or is a quite lengthy thread on this project.

What is the status of work?  Any progress on Emmanuel's work from 2008?

Thank you.

James McKenzie




From julliard at winehq.org  Sun May 16 10:36:32 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Sun, 16 May 2010 17:36:32 +0200
Subject: [PATCH 1/9] tools: Modified the ICO render script to render BMPs
	(resend)
In-Reply-To: <1273945566.14915.18.camel@joel-desktop> (Joel Holdsworth's
	message of "Sat, 15 May 2010 18:46:06 +0100")
References: <1273945566.14915.18.camel@joel-desktop>
Message-ID: <87eihbc0zj.fsf@wine.dyndns.org>

Joel Holdsworth <joel at airwebreathe.org.uk> writes:

> +    # Convert it into a bmp
> +    if($depth == 32) {
> +        # Alpha channel is negated as a work around for an ImageMagick bug
> +        shell $convert, "png:$pngFile", "-channel", "Alpha", "-negate", $outFileName;

Which ImageMagick version needs this?  Mine (6.6.0) doesn't.

-- 
Alexandre Julliard
julliard at winehq.org


From computers57 at hotmail.com  Sun May 16 11:02:55 2010
From: computers57 at hotmail.com (C.W. Betts)
Date: Sun, 16 May 2010 10:02:55 -0600
Subject: Work on WineQuartz for MacOSX
In-Reply-To: <15386303.1274023873747.JavaMail.root@mswamui-valley.atl.sa.earthlink.net>
References: <15386303.1274023873747.JavaMail.root@mswamui-valley.atl.sa.earthlink.net>
Message-ID: <BLU0-SMTP1588C93760EE2CF1618307B9FF0@phx.gbl>

If memory serves, the main reason why there hasn't been any work done is because of the dependency of Objective-C, which the project administrator has said "no" to.
On May 16, 2010, at 9:31 AM, James Mckenzie wrote:

> All:
> 
> There was or is a quite lengthy thread on this project.
> 
> What is the status of work?  Any progress on Emmanuel's work from 2008?
> 
> Thank you.
> 
> James McKenzie
> 
> 
> 
> 
> 



From alexandru.balut at gmail.com  Sun May 16 11:26:15 2010
From: alexandru.balut at gmail.com (=?UTF-8?B?QWxleGFuZHJ1IELEg2x1yJs=?=)
Date: Sun, 16 May 2010 18:26:15 +0200
Subject: Fwd: [AppDB] patch: Request for UTF8-encoded results from MySQL when 
	querying the bugs DB.
In-Reply-To: <v2g9d69cf6b1005010829l20325431m5973d9f5ae0fa4ee@mail.gmail.com>
References: <v2g9d69cf6b1005010829l20325431m5973d9f5ae0fa4ee@mail.gmail.com>
Message-ID: <AANLkTimH9izwVPs_yHbhGMEMlXeqHuDYjT2Jf-xBPE3X@mail.gmail.com>

Hi,

Is anyone reviewing patches for AppDB?

Thanks,
Alex


---------- Forwarded message ----------
From: Alexandru Balut <alexandru.balut at gmail.com>
Date: Sat, May 1, 2010 at 17:29
Subject: [AppDB] patch: Request for UTF8-encoded results from MySQL
when querying the bugs DB.
To: wine-patches at winehq.org


Resending because I got no response and the patch has not been committed yet.

Partial fix for bug http://bugs.winehq.org/show_bug.cgi?id=16514 -
some characters from the bug summary do not appear correctly when a
linked bug is displayed in the page showing a version of an app. For
example, see http://appdb.winehq.org/objectManager.php?sClass=version&iId=17511
and look in that page for bug 21156.

Tested in Chrome, and Firefox, with the following chars in the title:
I?t?rn?ti?n?liz?ti?n ???????????
-------------- next part --------------
diff --git a/include/query.php b/include/query.php
index 9527fb8..7b02e79 100644
--- a/include/query.php
+++ b/include/query.php
@@ -130,6 +130,12 @@ function query_bugzilladb($sQuery,$sComment="")
         $hBugzillaLink = mysql_connect(BUGZILLA_DBHOST, BUGZILLA_DBUSER, BUGZILLA_DBPASS, true);
         if(!$hBugzillaLink) return;
         mysql_select_db(BUGZILLA_DB, $hBugzillaLink);
+        // Tell MySQL to return UTF8-encoded results
+        $sQueryAskingForUtf8Results = "SET SESSION CHARACTER_SET_RESULTS = 'utf8'";
+        if (!mysql_query($sQueryAskingForUtf8Results, $hBugzillaLink))
+        {
+            query_error($sQueryAskingForUtf8Results, "", $hBugzillaLink);
+        }
     }
     
     $hResult = mysql_query($sQuery, $hBugzillaLink);

From alex at thehandofagony.com  Sun May 16 11:59:22 2010
From: alex at thehandofagony.com (Alexander Nicolaysen =?utf-8?q?S=C3=B8rnes?=)
Date: Sun, 16 May 2010 18:59:22 +0200
Subject: Fwd: [AppDB] patch: Request for UTF8-encoded results from MySQL
	when querying the bugs DB.
In-Reply-To: <AANLkTimH9izwVPs_yHbhGMEMlXeqHuDYjT2Jf-xBPE3X@mail.gmail.com>
References: <v2g9d69cf6b1005010829l20325431m5973d9f5ae0fa4ee@mail.gmail.com>
	<AANLkTimH9izwVPs_yHbhGMEMlXeqHuDYjT2Jf-xBPE3X@mail.gmail.com>
Message-ID: <201005161859.22582.alex@thehandofagony.com>

Hello,

I must have overlooked your previous submission; I'm not used to people 
sending in AppDB patches.

That being said, it's really nice to have other people working on the code. :) 
I'll review it and commit in the next few days.


Alexander

 S?ndag 16. mai 2010 18.26.15 skrev Alexandru B?lu? :
> Hi,
> 
> Is anyone reviewing patches for AppDB?
> 
> Thanks,
> Alex
> 
> 
> ---------- Forwarded message ----------
> From: Alexandru Balut <alexandru.balut at gmail.com>
> Date: Sat, May 1, 2010 at 17:29
> Subject: [AppDB] patch: Request for UTF8-encoded results from MySQL
> when querying the bugs DB.
> To: wine-patches at winehq.org
> 
> 
> Resending because I got no response and the patch has not been committed
>  yet.
> 
> Partial fix for bug http://bugs.winehq.org/show_bug.cgi?id=16514 -
> some characters from the bug summary do not appear correctly when a
> linked bug is displayed in the page showing a version of an app. For
> example, see
>  http://appdb.winehq.org/objectManager.php?sClass=version&iId=17511 and
>  look in that page for bug 21156.
> 
> Tested in Chrome, and Firefox, with the following chars in the title:
> I?t?rn?ti?n?liz?ti?n ???????????
> 


From computers57 at hotmail.com  Sun May 16 12:06:01 2010
From: computers57 at hotmail.com (C.W. Betts)
Date: Sun, 16 May 2010 11:06:01 -0600
Subject: Fwd: Work on WineQuartz for MacOSX
References: <AANLkTilfWobbuL1UJi5bLlQO7LT4St0M584wBEJQT5kg@mail.gmail.com>
Message-ID: <BLU0-SMTP27060507E14F30582F6185B9FF0@phx.gbl>



Begin forwarded message:

> From: Erich Hoover <ehoover at mines.edu>
> Date: May 16, 2010 10:10:29 AM MDT
> To: "C.W. Betts" <computers57 at hotmail.com>
> Subject: Re: Work on WineQuartz for MacOSX
> 
> On Sun, May 16, 2010 at 10:02 AM, C.W. Betts <computers57 at hotmail.com> wrote:
> If memory serves, the main reason why there hasn't been any work done is because of the dependency of Objective-C, which the project administrator has said "no" to.
> ...
> 
> I don't know/remember if anyone brought this up previously, but there are ways to connect to an Objective-C library in a flat C project.  I've been keeping this example handy in case I ever need to do it:
> http://www.smipple.net/snippet/moriyoshi/Using%20Objective-C%20ABI%20from%20within%20a%20pure%20C%20code.
> 
> Erich Hoover
> ehoover at mines.edu

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100516/a382c4ea/attachment.htm>

From computers57 at hotmail.com  Sun May 16 17:00:05 2010
From: computers57 at hotmail.com (C.W. Betts)
Date: Sun, 16 May 2010 16:00:05 -0600
Subject: Work on WineQuartz for MacOSX
In-Reply-To: <20653084.1274034563221.JavaMail.root@elwamui-rustique.atl.sa.earthlink.net>
References: <20653084.1274034563221.JavaMail.root@elwamui-rustique.atl.sa.earthlink.net>
Message-ID: <BLU0-SMTP747BCC33B1E8A64448F447B9FF0@phx.gbl>


On May 16, 2010, at 12:29 PM, James Mckenzie wrote:

> C.W.
> 
> The page referred to by this message no longer exists....
> 
> Time for an update.
Include the period at the end.  It works then.

I was able to get the code and compile it fine under 32-bit mode.  Apparently there has been a few changes in 64-bit mode that doesn't make it work quite as well.
> 
> James McKenzie
> 
> 
> 
> -----Original Message-----
>> From: "C.W. Betts" <computers57 at hotmail.com>
>> Sent: May 16, 2010 10:06 AM
>> To: wine-devel at winehq.org
>> Subject: Fwd: Work on WineQuartz for MacOSX
>> 
>> 
>> 
>> Begin forwarded message:
>> 
>>> From: Erich Hoover <ehoover at mines.edu>
>>> Date: May 16, 2010 10:10:29 AM MDT
>>> To: "C.W. Betts" <computers57 at hotmail.com>
>>> Subject: Re: Work on WineQuartz for MacOSX
>>> 
>>> On Sun, May 16, 2010 at 10:02 AM, C.W. Betts <computers57 at hotmail.com> wrote:
>>> If memory serves, the main reason why there hasn't been any work done is because of the dependency of Objective-C, which the project administrator has said "no" to.
>>> ...
>>> 
>>> I don't know/remember if anyone brought this up previously, but there are ways to connect to an Objective-C library in a flat C project.  I've been keeping this example handy in case I ever need to do it:
>>> http://www.smipple.net/snippet/moriyoshi/Using%20Objective-C%20ABI%20from%20within%20a%20pure%20C%20code.
>>> 
>>> Erich Hoover
>>> ehoover at mines.edu
>> 
> 
> 



From thunderbird2k at gmail.com  Sun May 16 17:15:03 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Mon, 17 May 2010 00:15:03 +0200
Subject: Work on WineQuartz for MacOSX
In-Reply-To: <BLU0-SMTP1588C93760EE2CF1618307B9FF0@phx.gbl>
References: <15386303.1274023873747.JavaMail.root@mswamui-valley.atl.sa.earthlink.net>
	<BLU0-SMTP1588C93760EE2CF1618307B9FF0@phx.gbl>
Message-ID: <AANLkTimVRt_V2yQ4HQOj65H0TrL8CgPG1bd2Cp8d8vZJ@mail.gmail.com>

The fact that Cocoa is objective C is one of the issues (Charles Davis
made some C wrapper I think). The most problematic thing is that it
really need is a DIB engine. The Cocoa graphics APIs are similar to
Cairo / XRender / Direct2D and other modern APIs. These APIs are great
for vector drawing, alpha blending and other fancy operations but they
are not low-level 2D APIs. For instance they lack most classic
(bitwise) 2D ROPs. The classic rendering stuff (Windows 7 does it this
way as well) has to be performed in software by a DIB engine.

Roderick

On Sun, May 16, 2010 at 6:02 PM, C.W. Betts <computers57 at hotmail.com> wrote:
> If memory serves, the main reason why there hasn't been any work done is because of the dependency of Objective-C, which the project administrator has said "no" to.
> On May 16, 2010, at 9:31 AM, James Mckenzie wrote:
>
>> All:
>>
>> There was or is a quite lengthy thread on this project.
>>
>> What is the status of work? ?Any progress on Emmanuel's work from 2008?
>>
>> Thank you.
>>
>> James McKenzie
>>
>>
>>
>>
>>
>
>
>
>


From testbot at testbot.winehq.org  Sun May 16 18:25:33 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Mon, 17 May 2010 01:25:33 +0200
Subject: riched20: Avoid using long. 
Message-ID: <201005162325.o4GNPXPV010510@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2105

Your paranoid android.


=== W7PRO (32 bit editor) ===
editor.c:4696: Test failed: test paste: strcmp = 1, text='testing paste
editor.c:4714: Test failed: test paste: strcmp = 1
editor.c:4726: Test failed: test paste: strcmp = -1
editor.c:4756: Test failed: test paste: strcmp = -1, actual = 'Ts'
editor.c:5971: Test failed: Cursor is at 0 instead of 4
editor.c:5977: Test failed: Cursor is at 0 instead of 9
editor.c:5983: Test failed: Cursor is at 0 instead of 4
editor.c:5997: Test failed: Cursor is at 8 instead of 9
editor.c:6005: Test failed: Cursor is at 11 instead of 9
editor.c:6016: Test failed: Cursor is at 0 instead of 8
editor.c:6041: Test failed: Cursor is at 0 instead of 8


From alexandru.balut at gmail.com  Sun May 16 20:36:48 2010
From: alexandru.balut at gmail.com (=?UTF-8?B?QWxleGFuZHJ1IELEg2x1yJs=?=)
Date: Mon, 17 May 2010 03:36:48 +0200
Subject: Trying to fix a bug, stuck at cross-compiling
Message-ID: <AANLkTikX5FgM1kNC3OussMcwud0ytfDfjvmtwY-bq-g6@mail.gmail.com>

Hi,

I'm trying to fix bug 12804, and made some changes to winecfg, and I
need to test how it works on Windows. I followed the instructions from
http://wiki.winehq.org/CompilingDLLsUsingMingw - Cross Compiling the
Whole Tree, but I get an error:

$ ../wine-crossc/configure --host=i586-mingw32msvc
--with-wine-tools=../build-native --without-freetype --without-x
[...]
checking for the directory containing the Wine tools... configure:
error: could not find Wine tools in ../build-native

This seems to happen because the ../build-native/tools/winebuild
directory does not exist.

When I ran "make tools", in ../build-native, no error occurred. Any
idea why this happens?

Is there another way to build winecfg as an exe?

Thanks,
Alex


From jjmckenzie51 at earthlink.net  Sun May 16 22:04:41 2010
From: jjmckenzie51 at earthlink.net (James Mckenzie)
Date: Sun, 16 May 2010 20:04:41 -0700 (GMT-07:00)
Subject: Work on WineQuartz for MacOSX
Message-ID: <17608521.1274065483621.JavaMail.root@elwamui-polski.atl.sa.earthlink.net>

Roderick Colenbrander wrote:
>On Sun, May 16, 2010 at 6:02 PM, C.W. Betts <computers57 at hotmail.com> wrote:
>> On May 16, 2010, at 9:31 AM, James Mckenzie wrote:
>>> All:
>>>
>>> There was or is a quite lengthy thread on this project.
>>>
>>> What is the status of work? ?Any progress on Emmanuel's work from 2008?
>>>
>>> Thank you.
>>>
>>> James McKenzie
>>>
>> If memory serves, the main reason why there hasn't been any work done is because of the
>> dependency of Objective-C, which the project administrator has said "no" to.
>>
>The fact that Cocoa is objective C is one of the issues (Charles Davis
>made some C wrapper I think). The most problematic thing is that it
>really need is a DIB engine. The Cocoa graphics APIs are similar to
>Cairo / XRender / Direct2D and other modern APIs. These APIs are great
>for vector drawing, alpha blending and other fancy operations but they
>are not low-level 2D APIs. For instance they lack most classic
>(bitwise) 2D ROPs. The classic rendering stuff (Windows 7 does it this
>way as well) has to be performed in software by a DIB engine.
>
>Roderick
>
Charles Davis did not 'make a c wrapper', Apple did.  However you are more correct in that we need a fully functional DIB engine in order to fully move the Apple interface from X11 to Aqua.  I was inquiring if both of these actions have occurred.  Max was working diligently on a DIB engine until AJ basically shot his work full of holes and he left.

Again, what is the status of updating/upgrading Emmanuel's work?  Has it been left for dead or is someone working in the background on it?  I would like to pick it up and start looking at it again and seeing if the Obj-C code could be converted to plain 'c' or if we have to bring up a sidebar version of Wine that will be Aqua complaint.  Having been through this with the OpenOffice.org and NeoOffice.org projects, this is a political area I really don't want to visit, but if it has to be that way, then it will head off in that direction.

James McKenzie



From cdavis at mymail.mines.edu  Mon May 17 00:52:44 2010
From: cdavis at mymail.mines.edu (Charles Davis)
Date: Sun, 16 May 2010 23:52:44 -0600
Subject: Work on WineQuartz for MacOSX
In-Reply-To: <17608521.1274065483621.JavaMail.root@elwamui-polski.atl.sa.earthlink.net>
References: <17608521.1274065483621.JavaMail.root@elwamui-polski.atl.sa.earthlink.net>
Message-ID: <4BF0D9AC.80805@mymail.mines.edu>

On 5/16/10 9:04 PM, James Mckenzie wrote:
> Roderick Colenbrander wrote:
>> On Sun, May 16, 2010 at 6:02 PM, C.W. Betts <computers57 at hotmail.com> wrote:
>>> On May 16, 2010, at 9:31 AM, James Mckenzie wrote:
>>>> All:
>>>>
>>>> There was or is a quite lengthy thread on this project.
>>>>
>>>> What is the status of work?  Any progress on Emmanuel's work from 2008?
>>>>
>>>> Thank you.
>>>>
>>>> James McKenzie
>>>>
>>> If memory serves, the main reason why there hasn't been any work done is because of the
>>> dependency of Objective-C, which the project administrator has said "no" to.
>>>
>> The fact that Cocoa is objective C is one of the issues (Charles Davis
>> made some C wrapper I think). The most problematic thing is that it
>> really need is a DIB engine. The Cocoa graphics APIs are similar to
>> Cairo / XRender / Direct2D and other modern APIs. These APIs are great
>> for vector drawing, alpha blending and other fancy operations but they
>> are not low-level 2D APIs. For instance they lack most classic
>> (bitwise) 2D ROPs. The classic rendering stuff (Windows 7 does it this
>> way as well) has to be performed in software by a DIB engine.
>>
>> Roderick
>>
> Charles Davis did not 'make a c wrapper', Apple did.
Actually, he was referring to my tool for autogenerating C wrappers. I
haven't been working on it much, but I'll have it ready for you guys soon.
>  However you are more correct in that we need a fully functional DIB engine in order to fully move the Apple interface from X11 to Aqua.
I agree. We need a DIB engine. Quartz by itself doesn't support
low-level raster operations (it's a vector engine).
>  I was inquiring if both of these actions have occurred.
Not really. Not as far as I know. I have a Quartz Driver in my tree, but
it's nowhere near finished. I'm now thinking about merging mine and
Emmanuel's work. Maybe if I put the two half-finished drivers together,
we'll have a better working driver (without DIB support, but that needs
either the DIB engine or some other way to accelerate DIB drawing).
>  Max was working diligently on a DIB engine until AJ basically shot his work full of holes and he left.
Someone needs to pick up his work--or at least, the job of writing a DIB
engine. Personally, I would write one from scratch instead of trying to
integrate X11's software drawing engine. It's been said that the X11
server code isn't known for its neatness... But that's just me.
> 
> Again, what is the status of updating/upgrading Emmanuel's work?  Has it been left for dead or is someone working in the background on it?
As soon as I'm finished with my C wrapper generator, I'll take a look at
Emmanuel's Quartz Driver.

Chip


From mstefani at redhat.com  Mon May 17 02:41:21 2010
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Mon, 17 May 2010 09:41:21 +0200
Subject: Trying to fix a bug, stuck at cross-compiling
In-Reply-To: <AANLkTikX5FgM1kNC3OussMcwud0ytfDfjvmtwY-bq-g6@mail.gmail.com>
References: <AANLkTikX5FgM1kNC3OussMcwud0ytfDfjvmtwY-bq-g6@mail.gmail.com>
Message-ID: <4BF0F321.4050304@redhat.com>

Alexandru B?lu? wrote:
> I'm trying to fix bug 12804, and made some changes to winecfg, and I
> need to test how it works on Windows. I followed the instructions from
Just use the Wine Test Bot to test on Windows:
  https://testbot.winehq.org/
The corresponding wiki page is http://wiki.winehq.org/WineTestBot

> http://wiki.winehq.org/CompilingDLLsUsingMingw - Cross Compiling the
> Whole Tree, but I get an error:
> 
> $ ../wine-crossc/configure --host=i586-mingw32msvc
> --with-wine-tools=../build-native --without-freetype --without-x
> [...]
> checking for the directory containing the Wine tools... configure:
> error: could not find Wine tools in ../build-native
> 
> This seems to happen because the ../build-native/tools/winebuild
> directory does not exist.
> 
> When I ran "make tools", in ../build-native, no error occurred. Any
> idea why this happens?
> 
> Is there another way to build winecfg as an exe?
Uhm, you want to test winecfg on Windows? That doesn't make much sense
as winecfg is Wine specific.

bye	
	michael


From mstefani at redhat.com  Mon May 17 02:53:14 2010
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Mon, 17 May 2010 09:53:14 +0200
Subject: riched20: Avoid using long.
In-Reply-To: <201005162325.o4GNPXPV010510@v1.gse.nl>
References: <201005162325.o4GNPXPV010510@v1.gse.nl>
Message-ID: <4BF0F5EA.3010705@redhat.com>

 (Marvin) wrote:
> While running your changed tests on Windows, I think I found new failures.
> Being a bot and all I'm not very good at pattern recognition, so I might be
> wrong, but could you please double-check?
Yes, the bot is wrong on this one. The test function I modified isn't
used in the failing tests.

> Full results can be found at
> http://testbot.winehq.org/JobDetails.pl?Key=2105
> 
> Your paranoid android.
> 
> 
> === W7PRO (32 bit editor) ===
> editor.c:4696: Test failed: test paste: strcmp = 1, text='testing paste
> editor.c:4714: Test failed: test paste: strcmp = 1
> editor.c:4726: Test failed: test paste: strcmp = -1
> editor.c:4756: Test failed: test paste: strcmp = -1, actual = 'Ts'
> editor.c:5971: Test failed: Cursor is at 0 instead of 4
> editor.c:5977: Test failed: Cursor is at 0 instead of 9
> editor.c:5983: Test failed: Cursor is at 0 instead of 4
> editor.c:5997: Test failed: Cursor is at 8 instead of 9
> editor.c:6005: Test failed: Cursor is at 11 instead of 9
> editor.c:6016: Test failed: Cursor is at 0 instead of 8
> editor.c:6041: Test failed: Cursor is at 0 instead of 8

bye
	michael


From jacek at codeweavers.com  Mon May 17 03:47:13 2010
From: jacek at codeweavers.com (Jacek Caban)
Date: Mon, 17 May 2010 10:47:13 +0200
Subject: urlmon: Added tests for some of the property methods. Added a
	dependency to urlmon for oleaut32
In-Reply-To: <AANLkTinZ0IC330wpis5mSes5RCxks1G5OX8in4aKOHK8@mail.gmail.com>
References: <AANLkTinZ0IC330wpis5mSes5RCxks1G5OX8in4aKOHK8@mail.gmail.com>
Message-ID: <4BF10291.5010602@codeweavers.com>

Hi Thomas,

On 5/17/10 3:05 AM, Thomas Mullaly wrote:
> Added tests to make sure IUri_GetPropertyBSTR / IUri_GetPropertyDWORD 
> / IUri_GetPropertyLength handle invalid arguments correctly. Fixed 
> up/added some comments.
>
> Had to add a dependency to urlmon for oleaut32. This is because the 
> Uri interface returns all the string properties of a URI as BSTR's and 
> it needs the SysAllocString/SysFreeString functions in oleau32. I 
> checked on windows using Dependency Walker and the native version of 
> urlmon has this same dependency.

-IMPORTS   = uuid ole32 rpcrt4 shlwapi wininet user32 advapi32 kernel32 ntdll
+IMPORTS   = uuid ole32 oleaut32 rpcrt4 shlwapi wininet user32 advapi32 kernel32 ntdll


You should add oleaut32 dependency in a patch that uses its functions.

             hr = IUri_GetPropertyBSTR(uri, i,&str, 0);
+            todo_wine {
+                ok(hr == S_OK, "Error: GetPropertyBSTR returned 0x%08x, expected 0x%08x. property=%d\n",
+                        hr, S_OK, i);
+            }
+            todo_wine { ok(str != NULL, "Error: Expected the BSTR not to be NULL, property=%d\n", i); }
+            ok(!SysStringLen(str), "Error: Expected the BSTR to be of length 0, but it was %d instead. property=%d\n",
+                    SysStringLen(str), i);

You will have to add tests for the exact values returned sooner or later, so this will be tested better then. There is not much value in tests like this.

+            if(str) SysFreeString(str);


You don't need NULL check here.

Thanks,
     Jacek


From hverbeet at gmail.com  Mon May 17 06:29:34 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Mon, 17 May 2010 13:29:34 +0200
Subject: [PATCH 4/4] wined3d: add BLIT_OP_COMPLEX_UPLOAD
In-Reply-To: <1274094701-7866-4-git-send-email-thunderbird2k@gmail.com>
References: <1274094701-7866-1-git-send-email-thunderbird2k@gmail.com>
	<1274094701-7866-2-git-send-email-thunderbird2k@gmail.com>
	<1274094701-7866-3-git-send-email-thunderbird2k@gmail.com>
	<1274094701-7866-4-git-send-email-thunderbird2k@gmail.com>
Message-ID: <AANLkTinR9UIweUh1Rnd7gotq1dspUcf0C-9qctulkSMI@mail.gmail.com>

On 17 May 2010 13:11, Roderick Colenbrander <thunderbird2k at gmail.com> wrote:
> This patch introduces a new blit operation to allow complex uploads from LoadLocation. It allows hw accelerated
> p8 uploads to function again (I broke them by accident). Without this blit_operation there is no way to detect
> this single case at the moment in which we allow the P8 shader (remember both the source and destination have
> complex fixups set, so this doesn't pass).

I'm not so convinced this needs a separate blit operation, it should
always be possible to do blits between surfaces with the same formats
as long as no stretching is involved.


From alexandru.balut at gmail.com  Mon May 17 07:04:49 2010
From: alexandru.balut at gmail.com (=?UTF-8?B?QWxleGFuZHJ1IELEg2x1yJs=?=)
Date: Mon, 17 May 2010 14:04:49 +0200
Subject: Trying to fix a bug, stuck at cross-compiling
In-Reply-To: <4BF0F321.4050304@redhat.com>
References: <AANLkTikX5FgM1kNC3OussMcwud0ytfDfjvmtwY-bq-g6@mail.gmail.com> 
	<4BF0F321.4050304@redhat.com>
Message-ID: <AANLkTikzpDGgKApVE79705_mjPFhS2LdwKyQ8ura62Yd@mail.gmail.com>

Hi Michael,

The Wine Test Bot does not help. I need to test the interface of the
application.

Thanks,
Alex

On Mon, May 17, 2010 at 09:41, Michael Stefaniuc <mstefani at redhat.com> wrote:
> Alexandru B?lu? wrote:
>> I'm trying to fix bug 12804, and made some changes to winecfg, and I
>> need to test how it works on Windows. I followed the instructions from
> Just use the Wine Test Bot to test on Windows:
> ?https://testbot.winehq.org/
> The corresponding wiki page is http://wiki.winehq.org/WineTestBot
>
>> http://wiki.winehq.org/CompilingDLLsUsingMingw - Cross Compiling the
>> Whole Tree, but I get an error:
>>
>> $ ../wine-crossc/configure --host=i586-mingw32msvc
>> --with-wine-tools=../build-native --without-freetype --without-x
>> [...]
>> checking for the directory containing the Wine tools... configure:
>> error: could not find Wine tools in ../build-native
>>
>> This seems to happen because the ../build-native/tools/winebuild
>> directory does not exist.
>>
>> When I ran "make tools", in ../build-native, no error occurred. Any
>> idea why this happens?
>>
>> Is there another way to build winecfg as an exe?
> Uhm, you want to test winecfg on Windows? That doesn't make much sense
> as winecfg is Wine specific.
>
> bye
> ? ? ? ?michael
>


From wylda at volny.cz  Mon May 17 07:11:17 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Mon, 17 May 2010 14:11:17 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_Trying_to_fix_a_bug=2C_stuck_at_cross-compiling?=
In-Reply-To: <AANLkTikzpDGgKApVE79705_mjPFhS2LdwKyQ8ura62Yd@mail.gmail.com>
References: <AANLkTikX5FgM1kNC3OussMcwud0ytfDfjvmtwY-bq-g6@mail.gmail.com>
	<4BF0F321.4050304@redhat.com>
	<AANLkTikzpDGgKApVE79705_mjPFhS2LdwKyQ8ura62Yd@mail.gmail.com>
Message-ID: <ba5584ed0e13f3afeb0a43c434823a8d@www3-mail.volny.cz>


I'm also interested how to cross compile ;)

W.

> Hi Michael,
> 
> The Wine Test Bot does not help. I need to test the
> interface of the
> application.
> 
> Thanks,
> Alex




From thunderbird2k at gmail.com  Mon May 17 08:25:18 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Mon, 17 May 2010 15:25:18 +0200
Subject: [PATCH 4/4] wined3d: add BLIT_OP_COMPLEX_UPLOAD
In-Reply-To: <AANLkTinR9UIweUh1Rnd7gotq1dspUcf0C-9qctulkSMI@mail.gmail.com>
References: <1274094701-7866-1-git-send-email-thunderbird2k@gmail.com>
	<1274094701-7866-2-git-send-email-thunderbird2k@gmail.com>
	<1274094701-7866-3-git-send-email-thunderbird2k@gmail.com>
	<1274094701-7866-4-git-send-email-thunderbird2k@gmail.com>
	<AANLkTinR9UIweUh1Rnd7gotq1dspUcf0C-9qctulkSMI@mail.gmail.com>
Message-ID: <AANLkTim-BlbOXWGh3vvMJ_M7pLCFzAGDtYvsUtRJu8fF@mail.gmail.com>

On Mon, May 17, 2010 at 1:29 PM, Henri Verbeet <hverbeet at gmail.com> wrote:
> On 17 May 2010 13:11, Roderick Colenbrander <thunderbird2k at gmail.com> wrote:
>> This patch introduces a new blit operation to allow complex uploads from LoadLocation. It allows hw accelerated
>> p8 uploads to function again (I broke them by accident). Without this blit_operation there is no way to detect
>> this single case at the moment in which we allow the P8 shader (remember both the source and destination have
>> complex fixups set, so this doesn't pass).
>
> I'm not so convinced this needs a separate blit operation, it should
> always be possible to do blits between surfaces with the same formats
> as long as no stretching is involved.
>

I now allow this in arbfp blit_supported using this check:
    if (src_fixup == dst_fixup &&
is_complex_fixup(dst_format_desc->color_fixup) && src_rect && dst_rect
        && (src_rect->right - src_rect->left == dst_rect->right -
dst_rect->left)
        && (abs(src_rect->bottom - src_rect->top) ==
abs(dst_rect->bottom - dst_rect->top))
        && (dst_usage & WINED3DUSAGE_RENDERTARGET))

A check like that works for two cases:
1) checks if 8-bit -> 8-bit blit is supported between two different surfaces
2) checks if hw accelerated 8-bit upload is around (d3dfmt_get_conv
checks and it is what BLIT_OP_COMPLEX_UPLOAD was about)

My main worry is d3dfmt_get_conv in case of the ffp backend.
Originally there were GL extension checks there to perform format
fixups and at this point blit_supported is used there for this
purpose. If I would add the above check it would either disallow (1)
in case I would add a EXT_PALETTED_TEXTURE or if I won't include this
extension check it would break the format fixup part of
d3dfmt_get_conv. BLIT_OP_COMPLEX_FIXUP would prevent such issues. (I
could just add the EXT_PALETTED_CHECK if it is fine if we don't
support converted_p8 -> converted_p8 blits between two different
surfaces using GL; I think depending on surface location flags a
cpu_blit might make more sense as GL won't gain you much since you
have to do two surface conversions)

So the actual issue is d3dfmt_get_conv. For a part the p8 fixup is in
the formats table and for a part here. I could add a generic p8 format
to the utils table without GL checks it would fix a part of the
mentioned problem (the fixup code in d3dfmt_get_conv would then be
called but effectively it would do nothing since the internal format
and types are the same).

Overall I think that somehow the blit_shader should worry about the
formats during 'blit_surface' and decide whether to use hw conversion
or software conversion (the ffp backend should likely support both).
This could work for the geneal Blt/BltFast case but won't for
UnlockRect in the current design where it uses
LoadLocation(IN_TEXTURE) + LoadLocation(IN_DRAWABLE) but it would have
to use the blit_shader there.

Roderick


From cdavis at mymail.mines.edu  Mon May 17 10:27:28 2010
From: cdavis at mymail.mines.edu (Charles Davis)
Date: Mon, 17 May 2010 09:27:28 -0600
Subject: [PATCH] ntdll: Use the old mmap() wrapper on 32-bit Mac OS. (try
	3)
In-Reply-To: <1273862811-37044-1-git-send-email-cdavis@mymail.mines.edu>
References: <1273862811-37044-1-git-send-email-cdavis@mymail.mines.edu>
Message-ID: <4BF16060.40008@mymail.mines.edu>

What's wrong with my patch now? It's a really simple fix; in fact, this
is as about as simple as it gets. How does this "break libwine
compatibility"?

Chip


From nerv at dawncrow.de  Mon May 17 10:30:04 2010
From: nerv at dawncrow.de (=?UTF-8?B?QW5kcsOpIEhlbnRzY2hlbA==?=)
Date: Mon, 17 May 2010 17:30:04 +0200
Subject: Trying to fix a bug, stuck at cross-compiling
In-Reply-To: <AANLkTikzpDGgKApVE79705_mjPFhS2LdwKyQ8ura62Yd@mail.gmail.com>
References: <AANLkTikX5FgM1kNC3OussMcwud0ytfDfjvmtwY-bq-g6@mail.gmail.com>
	<4BF0F321.4050304@redhat.com>
	<AANLkTikzpDGgKApVE79705_mjPFhS2LdwKyQ8ura62Yd@mail.gmail.com>
Message-ID: <4BF160FC.1060406@dawncrow.de>

Am 17.05.2010 14:04, schrieb Alexandru B?lu?:
> Hi Michael,
> 
> The Wine Test Bot does not help. I need to test the interface of the
> application.
> 
> Thanks,
> Alex
> 
> On Mon, May 17, 2010 at 09:41, Michael Stefaniuc <mstefani at redhat.com> wrote:
>> Alexandru B?lu? wrote:
>>> I'm trying to fix bug 12804, and made some changes to winecfg, and I
>>> need to test how it works on Windows. I followed the instructions from
>> Just use the Wine Test Bot to test on Windows:
>>  https://testbot.winehq.org/
>> The corresponding wiki page is http://wiki.winehq.org/WineTestBot
>>
>>> http://wiki.winehq.org/CompilingDLLsUsingMingw - Cross Compiling the
>>> Whole Tree, but I get an error:
>>>
>>> $ ../wine-crossc/configure --host=i586-mingw32msvc
>>> --with-wine-tools=../build-native --without-freetype --without-x
>>> [...]
>>> checking for the directory containing the Wine tools... configure:
>>> error: could not find Wine tools in ../build-native
>>>
>>> This seems to happen because the ../build-native/tools/winebuild
>>> directory does not exist.
>>>
>>> When I ran "make tools", in ../build-native, no error occurred. Any
>>> idea why this happens?
>>>
>>> Is there another way to build winecfg as an exe?
>> Uhm, you want to test winecfg on Windows? That doesn't make much sense
>> as winecfg is Wine specific.
>>
>> bye
>>        michael
>>
> 
> 

In my out of build tree i have a directory 00mingw. in there just type:
../configure --host=i586-mingw32msvc --with-wine-tools=../32/ --without-free
type host_alias=i586-mingw32msvc

(i have a directory "32" for wine32)
and the normal make stuff

winecfg has to much wine-specific stuff in it, so you have to cut that out.
i will send you a package of a cleaned winecfg, as i already did what you try.

-- 

Best Regards, Andr? Hentschel


From julliard at winehq.org  Mon May 17 11:56:51 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 17 May 2010 18:56:51 +0200
Subject: [PATCH] ntdll: Use the old mmap() wrapper on 32-bit Mac OS. (try
	3)
In-Reply-To: <4BF16060.40008@mymail.mines.edu> (Charles Davis's message of
	"Mon, 17 May 2010 09:27:28 -0600")
References: <1273862811-37044-1-git-send-email-cdavis@mymail.mines.edu>
	<4BF16060.40008@mymail.mines.edu>
Message-ID: <871vdabh64.fsf@wine.dyndns.org>

Charles Davis <cdavis at mymail.mines.edu> writes:

> What's wrong with my patch now? It's a really simple fix; in fact, this
> is as about as simple as it gets. How does this "break libwine
> compatibility"?

Like I said, it's not worth the trouble. Most modules need to be
relocated anyway. It would have to be done in the kernel.

-- 
Alexandre Julliard
julliard at winehq.org


From bunglehead at gmail.com  Mon May 17 18:19:59 2010
From: bunglehead at gmail.com (Nikolay Sivov)
Date: Tue, 18 May 2010 03:19:59 +0400
Subject: [PATCH] comctl32/listview: Derive subitem rect from listview
	origin
In-Reply-To: <4BF1C50B.4000208@codeweavers.com>
References: <4BF1C50B.4000208@codeweavers.com>
Message-ID: <4BF1CF1F.6010607@gmail.com>

On 5/18/2010 02:36, Andrew Eikum wrote:
>
> The old code used the containing item's position to determine the
> subitem's rect.  Instead, we should be using the entire listview's
> origin as the offset, since the item position can change as columns
> are inserted and re-arranged, leading to broken listviews.
> ---
>  dlls/comctl32/listview.c |    4 ++--
>  1 files changed, 2 insertions(+), 2 deletions(-)

Looks right. Seems to be (one?) of remaining problem that comes out 
after I added column reordering.

Please add a minimal test case for this to prevent a regression. All you 
need - add 2 columns, add item,
reorder columns with a LVM_SETCOLUMNORDERARRAY and test rectangle.



From dank at kegel.com  Mon May 17 20:01:30 2010
From: dank at kegel.com (Dan Kegel)
Date: Mon, 17 May 2010 18:01:30 -0700
Subject: Nightly performance regression graphs
Message-ID: <AANLkTikJDbGYNPe_1CjZwNARtlmBjxd96hL69loSAV5J@mail.gmail.com>

I finally threw together some graphs, see
http://kegel.com/wine/yagmarkdata/wine-1.1.44-245.html
Not sure what to make of the results yet.

They use svg, so a modern browser is required.


From jjmckenzie51 at earthlink.net  Mon May 17 21:13:03 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Mon, 17 May 2010 19:13:03 -0700
Subject: [PATCH] ntdll: Use the old mmap() wrapper on 32-bit Mac OS. (try
	3)
In-Reply-To: <871vdabh64.fsf@wine.dyndns.org>
References: <1273862811-37044-1-git-send-email-cdavis@mymail.mines.edu>	<4BF16060.40008@mymail.mines.edu>
	<871vdabh64.fsf@wine.dyndns.org>
Message-ID: <4BF1F7AF.6050705@earthlink.net>

Alexandre Julliard wrote:
> Charles Davis <cdavis at mymail.mines.edu> writes:
>
>   
>> What's wrong with my patch now? It's a really simple fix; in fact, this
>> is as about as simple as it gets. How does this "break libwine
>> compatibility"?
>>     
>
> Like I said, it's not worth the trouble. Most modules need to be
> relocated anyway. It would have to be done in the kernel.
>
>   
AJ:

kernel32.dll or the OS kernel?  It is quite an effort to get patches 
into the MacOSX kernel, but it CAN BE DONE.

kernel32.dll (or kernel64.dll) is a different matter as the project has 
control over it.

James McKenzie



From cdavis at mymail.mines.edu  Mon May 17 21:39:01 2010
From: cdavis at mymail.mines.edu (Charles Davis)
Date: Mon, 17 May 2010 20:39:01 -0600
Subject: [PATCH] ntdll: Use the old mmap() wrapper on 32-bit Mac OS. (try
	3)
In-Reply-To: <4BF1F7AF.6050705@earthlink.net>
References: <1273862811-37044-1-git-send-email-cdavis@mymail.mines.edu>	<4BF16060.40008@mymail.mines.edu>
	<871vdabh64.fsf@wine.dyndns.org> <4BF1F7AF.6050705@earthlink.net>
Message-ID: <4BF1FDC5.8010000@mymail.mines.edu>

On 5/17/10 8:13 PM, James McKenzie wrote:
> Alexandre Julliard wrote:
>> Charles Davis <cdavis at mymail.mines.edu> writes:
>>
>>  
>>> What's wrong with my patch now? It's a really simple fix; in fact, this
>>> is as about as simple as it gets. How does this "break libwine
>>> compatibility"?
>>>     
>>
>> Like I said, it's not worth the trouble. Most modules need to be
>> relocated anyway. It would have to be done in the kernel.
>>
>>   
> AJ:
> 
> kernel32.dll or the OS kernel?  It is quite an effort to get patches
> into the MacOSX kernel, but it CAN BE DONE.
I think he's referring to the system kernel, not the Win32 Kernel API
(kernel32.dll).

Personally, I prefer making kexts instead of modifying the kernel
itself, but if I absolutely have to, I can change the kernel.

Chip



From jjmckenzie51 at earthlink.net  Mon May 17 22:10:36 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Mon, 17 May 2010 20:10:36 -0700
Subject: [PATCH] ntdll: Use the old mmap() wrapper on 32-bit Mac OS. (try
	3)
In-Reply-To: <4BF1FDC5.8010000@mymail.mines.edu>
References: <1273862811-37044-1-git-send-email-cdavis@mymail.mines.edu>	<4BF16060.40008@mymail.mines.edu>
	<871vdabh64.fsf@wine.dyndns.org> <4BF1F7AF.6050705@earthlink.net>
	<4BF1FDC5.8010000@mymail.mines.edu>
Message-ID: <4BF2052C.30901@earthlink.net>

Charles Davis wrote:
> On 5/17/10 8:13 PM, James McKenzie wrote:
>   
>> Alexandre Julliard wrote:
>>     
>>> Charles Davis <cdavis at mymail.mines.edu> writes:
>>>
>>>  
>>>       
>>>> What's wrong with my patch now? It's a really simple fix; in fact, this
>>>> is as about as simple as it gets. How does this "break libwine
>>>> compatibility"?
>>>>     
>>>>         
>>> Like I said, it's not worth the trouble. Most modules need to be
>>> relocated anyway. It would have to be done in the kernel.
>>>
>>>   
>>>       
>> AJ:
>>
>> kernel32.dll or the OS kernel?  It is quite an effort to get patches
>> into the MacOSX kernel, but it CAN BE DONE.
>>     
> I think he's referring to the system kernel, not the Win32 Kernel API
> (kernel32.dll).
>
> Personally, I prefer making kexts instead of modifying the kernel
> itself, but if I absolutely have to, I can change the kernel.
>
>   
Is this something that should be investigated by the Open/Free-BSD (I 
cannot keep which version MacOSX is based upon) community for inclusion 
into the base kernel?

If it is not, then it should be something under consideration by the 
Wine project.  Hacking the kernel to make one program work is not a 
'best practice'.

James McKenzie


From cdavis at mymail.mines.edu  Mon May 17 22:22:18 2010
From: cdavis at mymail.mines.edu (Charles Davis)
Date: Mon, 17 May 2010 21:22:18 -0600
Subject: [PATCH] ntdll: Use the old mmap() wrapper on 32-bit Mac OS. (try
	3)
In-Reply-To: <4BF2052C.30901@earthlink.net>
References: <1273862811-37044-1-git-send-email-cdavis@mymail.mines.edu>	<4BF16060.40008@mymail.mines.edu>
	<871vdabh64.fsf@wine.dyndns.org> <4BF1F7AF.6050705@earthlink.net>
	<4BF1FDC5.8010000@mymail.mines.edu> <4BF2052C.30901@earthlink.net>
Message-ID: <4BF207EA.60601@mymail.mines.edu>

On 5/17/10 9:10 PM, James McKenzie wrote:
> Is this something that should be investigated by the Open/Free-BSD (I
> cannot keep which version MacOSX is based upon)
It's FreeBSD.
> community for inclusion
> into the base kernel?
Maybe. Actually, Mac OS X doesn't use a stock FreeBSD kernel. It uses a
modified Mach kernel (the way NT uses a "modified microkernel") called
"XNU". Many of XNU's BSD parts were forked from FreeBSD (a few parts
come from other BSDs).

You can get the source from http://www.opensource.apple.com . It's the
'xnu' project, after selecting a version of Mac OS X.
> 
> If it is not, then it should be something under consideration by the
> Wine project.  Hacking the kernel to make one program work is not a
> 'best practice'.
That might be true, but AJ doesn't seem to be warm to the idea of doing
this in Wine.

Chip


From jjmckenzie51 at earthlink.net  Mon May 17 22:32:53 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Mon, 17 May 2010 20:32:53 -0700
Subject: [PATCH] ntdll: Use the old mmap() wrapper on 32-bit Mac OS. (try
	3)
In-Reply-To: <4BF207EA.60601@mymail.mines.edu>
References: <1273862811-37044-1-git-send-email-cdavis@mymail.mines.edu>	<4BF16060.40008@mymail.mines.edu>
	<871vdabh64.fsf@wine.dyndns.org> <4BF1F7AF.6050705@earthlink.net>
	<4BF1FDC5.8010000@mymail.mines.edu> <4BF2052C.30901@earthlink.net>
	<4BF207EA.60601@mymail.mines.edu>
Message-ID: <4BF20A65.9090508@earthlink.net>

Charles Davis wrote:
> On 5/17/10 9:10 PM, James McKenzie wrote:
>   
> Maybe. Actually, Mac OS X doesn't use a stock FreeBSD kernel. It uses a
> modified Mach kernel (the way NT uses a "modified microkernel") called
> "XNU". Many of XNU's BSD parts were forked from FreeBSD (a few parts
> come from other BSDs).
>
> You can get the source from http://www.opensource.apple.com . It's the
> 'xnu' project, after selecting a version of Mac OS X.
>   
Next stupid question:  How does the patch get back into the XNU kernel 
code?  Is there a project for it, or do we dump it on Apple's front door 
hoping that they will integrate it?
>> If it is not, then it should be something under consideration by the
>> Wine project.  Hacking the kernel to make one program work is not a
>> 'best practice'.
>>     
> That might be true, but AJ doesn't seem to be warm to the idea of doing
> this in Wine.
>   
It appears that it the case.  Sometimes sticking to your guns gets you 
shot (at least around here in Southeastern Arizona.)

However, this is your fix and definitely your call if you want to press 
AJ about it, or if you want to go to Apple and get the fix into the kernel.

James McKenzie



From cdavis at mymail.mines.edu  Mon May 17 23:05:23 2010
From: cdavis at mymail.mines.edu (Charles Davis)
Date: Mon, 17 May 2010 22:05:23 -0600
Subject: [PATCH] ntdll: Use the old mmap() wrapper on 32-bit Mac OS. (try
	3)
In-Reply-To: <4BF20A65.9090508@earthlink.net>
References: <1273862811-37044-1-git-send-email-cdavis@mymail.mines.edu>	<4BF16060.40008@mymail.mines.edu>
	<871vdabh64.fsf@wine.dyndns.org> <4BF1F7AF.6050705@earthlink.net>
	<4BF1FDC5.8010000@mymail.mines.edu> <4BF2052C.30901@earthlink.net>
	<4BF207EA.60601@mymail.mines.edu> <4BF20A65.9090508@earthlink.net>
Message-ID: <4BF21203.6080903@mymail.mines.edu>

On 5/17/10 9:32 PM, James McKenzie wrote:
> Next stupid question:  How does the patch get back into the XNU kernel
> code?  Is there a project for it, or do we dump it on Apple's front door
> hoping that they will integrate it?
To be honest, I really have no idea exactly how outsiders can contribute
to Darwin in general.

There's a mailing list, 'darwin-kernel at lists.apple.com', dedicated to
Darwin kernel development. I would start by submitting patches there.
>>> If it is not, then it should be something under consideration by the
>>> Wine project.  Hacking the kernel to make one program work is not a
>>> 'best practice'.
>>>     
>> That might be true, but AJ doesn't seem to be warm to the idea of doing
>> this in Wine.
>>   
> It appears that it the case.  Sometimes sticking to your guns gets you
> shot (at least around here in Southeastern Arizona.)
Heh.
> 
> However, this is your fix and definitely your call if you want to press
> AJ about it, or if you want to go to Apple and get the fix into the kernel.
The thing is, the support we need already *is* in the kernel. mmap(2)
supports unaligned offsets. But there are two wrappers in the System
Library:

0000420c T _mmap
0000417f T _mmap$UNIX2003

The second one is the default wrapper. That wrapper rejects unaligned
file offsets (to be compliant with UNIX '03). The first one, however,
does not reject them. All my patch does is make Wine call the first one
instead of the second one when mapping a PE file.

Chip


From msclrhd at googlemail.com  Tue May 18 01:00:11 2010
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 18 May 2010 07:00:11 +0100
Subject: Nightly performance regression graphs
In-Reply-To: <AANLkTikJDbGYNPe_1CjZwNARtlmBjxd96hL69loSAV5J@mail.gmail.com>
References: <AANLkTikJDbGYNPe_1CjZwNARtlmBjxd96hL69loSAV5J@mail.gmail.com>
Message-ID: <AANLkTilZxxP-9TMfObVPdHhLrTRMRyavhIsaWXS4SSm0@mail.gmail.com>

On 18 May 2010 02:01, Dan Kegel <dank at kegel.com> wrote:
> I finally threw together some graphs, see
> http://kegel.com/wine/yagmarkdata/wine-1.1.44-245.html
> Not sure what to make of the results yet.
>
> They use svg, so a modern browser is required.

Neat.

Can you use something like:

<object data="E8400-GT_220-Ubuntu_10.04_LTS-e8400-3dmark06_3DMark_Score.svg"
type="image/svg+xml">
 <embed src="E8400-GT_220-Ubuntu_10.04_LTS-e8400-3dmark06_3DMark_Score.svg"
type="image/svg+xml">
  <img src="E8400-GT_220-Ubuntu_10.04_LTS-e8400-3dmark06_3DMark_Score.svg"
alt="E8400 GT220 - Ubuntu 10.04 LTS - e8400 - 3dmark06 3DMark Score">
 </embed>
</object>

so that this will work in Firefox, as Firefox does not (as of 3.6.3 on
Ubuntu 10.04) support svg images in img tags, but does as object tags.
I don't know whether the above is required for the svg to be viewed in
Opera as well.

Thanks,
- Reece


From hverbeet at gmail.com  Tue May 18 02:56:45 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Tue, 18 May 2010 09:56:45 +0200
Subject: [PATCH 1/4] wined3d: only activate blit_shader in 
	arbfp_blit_surface for source fixups
In-Reply-To: <1274167846-5465-1-git-send-email-thunderbird2k@gmail.com>
References: <1274167846-5465-1-git-send-email-thunderbird2k@gmail.com>
Message-ID: <AANLkTinDRpFxi45JjKTiwTj7WVN_yzpf9_Xx_vmhf7B1@mail.gmail.com>

On 18 May 2010 09:30, Roderick Colenbrander <thunderbird2k at gmail.com> wrote:
> - ? ?arbfp_blit_set((IWineD3DDevice *)device, src_surface);
> + ? ?if (is_complex_fixup(src_surface->resource.format_desc->color_fixup) &&
> + ? ? ? ?!is_complex_fixup(dst_surface->resource.format_desc->color_fixup))
> + ? ? ? ?arbfp_blit_set((IWineD3DDevice *)device, src_surface);
>
- This doesn't do what your subject line says it does.
- Why do you think this patch makes sense?


From hverbeet at gmail.com  Tue May 18 03:02:35 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Tue, 18 May 2010 10:02:35 +0200
Subject: [PATCH 4/4] wined3d: remove unneeded memory cleanup code from 
	BltOverride
In-Reply-To: <1274167846-5465-4-git-send-email-thunderbird2k@gmail.com>
References: <1274167846-5465-1-git-send-email-thunderbird2k@gmail.com>
	<1274167846-5465-2-git-send-email-thunderbird2k@gmail.com>
	<1274167846-5465-3-git-send-email-thunderbird2k@gmail.com>
	<1274167846-5465-4-git-send-email-thunderbird2k@gmail.com>
Message-ID: <AANLkTilb4eLGrKaQcZnUbTTcVF6TCou07A-5c43rzooq@mail.gmail.com>

On 18 May 2010 09:30, Roderick Colenbrander <thunderbird2k at gmail.com> wrote:
> We think the code is not needed and the code was wrong anyway since it didn't check whether the pointers it freed
> where valid.
In which cases can it be invalid?


From hverbeet at gmail.com  Tue May 18 03:07:44 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Tue, 18 May 2010 10:07:44 +0200
Subject: [PATCH 3/4] wined3d: allow complex -> complex blits in arbfp 
	blit_shader under special circumstances
In-Reply-To: <1274167846-5465-3-git-send-email-thunderbird2k@gmail.com>
References: <1274167846-5465-1-git-send-email-thunderbird2k@gmail.com>
	<1274167846-5465-2-git-send-email-thunderbird2k@gmail.com>
	<1274167846-5465-3-git-send-email-thunderbird2k@gmail.com>
Message-ID: <AANLkTilJVVWSfLIKgLINzzJtaOXds6A3sMsrNgHSDjUd@mail.gmail.com>

On 18 May 2010 09:30, Roderick Colenbrander <thunderbird2k at gmail.com> wrote:
> This patch should also address bug 22575 when using the arbfp backend. A similar fix is needed
> for the ffp backend.
That's meaningless as a Changelog entry.

> + ? ? ? ?&& (dst_usage & WINED3DUSAGE_RENDERTARGET))
What is that condition for?


From thunderbird2k at gmail.com  Tue May 18 03:45:56 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Tue, 18 May 2010 10:45:56 +0200
Subject: [PATCH 1/4] wined3d: only activate blit_shader in 
	arbfp_blit_surface for source fixups
In-Reply-To: <AANLkTinDRpFxi45JjKTiwTj7WVN_yzpf9_Xx_vmhf7B1@mail.gmail.com>
References: <1274167846-5465-1-git-send-email-thunderbird2k@gmail.com>
	<AANLkTinDRpFxi45JjKTiwTj7WVN_yzpf9_Xx_vmhf7B1@mail.gmail.com>
Message-ID: <AANLkTilwfJOfE1hfPyZK0Yd5pMZ65mKun7Tu-Z7eu44v@mail.gmail.com>

On Tue, May 18, 2010 at 9:56 AM, Henri Verbeet <hverbeet at gmail.com> wrote:
> On 18 May 2010 09:30, Roderick Colenbrander <thunderbird2k at gmail.com> wrote:
>> - ? ?arbfp_blit_set((IWineD3DDevice *)device, src_surface);
>> + ? ?if (is_complex_fixup(src_surface->resource.format_desc->color_fixup) &&
>> + ? ? ? ?!is_complex_fixup(dst_surface->resource.format_desc->color_fixup))
>> + ? ? ? ?arbfp_blit_set((IWineD3DDevice *)device, src_surface);
>>
> - This doesn't do what your subject line says it does.
Correct, it should be using is_identity_fixup for the destination check.

> - Why do you think this patch makes sense?
All 'set_shader' calls perform similar checks to figure out whether
the shader should be set or not. The call only has information on the
source surface (though if you really want I could you could get more
from the device or swapchain). Since 'blit_surface' has all the
knowledge I thought it was nicer to avoid the unneeded call but it
isn't right since set_shader does useful things as well like
glEnable(tex_type). I could pass in the destination surface but have
to think what to do about swapchain_blit which doesn't fit into the
new design.

Roderick


From mstefani at redhat.com  Tue May 18 03:51:12 2010
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Tue, 18 May 2010 10:51:12 +0200
Subject: advapi32: Remove redundant "is NULL and error out" code
	(coccicheck).
In-Reply-To: <20100517233221.GF22743@redhat.com>
References: <20100517233221.GF22743@redhat.com>
Message-ID: <4BF25500.4070909@redhat.com>

Alexandre, please disregard this patch as I missed somehow that the
error codes are different. And to figure out which to use needs a test.

bye
	michael

Michael Stefaniuc wrote:
> ---
>  dlls/advapi32/crypt.c |    5 -----
>  1 files changed, 0 insertions(+), 5 deletions(-)
> 
> diff --git a/dlls/advapi32/crypt.c b/dlls/advapi32/crypt.c
> index bb019d0..395879f 100644
> --- a/dlls/advapi32/crypt.c
> +++ b/dlls/advapi32/crypt.c
> @@ -1413,11 +1413,6 @@ BOOL WINAPI CryptGenKey (HCRYPTPROV hProv, ALG_ID Algid, DWORD dwFlags, HCRYPTKE
>  
>  	TRACE("(0x%lx, %d, %08x, %p)\n", hProv, Algid, dwFlags, phKey);
>  
> -	if (!prov)
> -	{
> -		SetLastError(ERROR_INVALID_HANDLE);
> -		return FALSE;
> -	}
>  	if (!phKey || !prov || prov->dwMagic != MAGIC_CRYPTPROV)
>  	{
>  		SetLastError(ERROR_INVALID_PARAMETER);



From hverbeet at gmail.com  Tue May 18 03:58:37 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Tue, 18 May 2010 10:58:37 +0200
Subject: [PATCH 1/4] wined3d: only activate blit_shader in 
	arbfp_blit_surface for source fixups
In-Reply-To: <AANLkTilwfJOfE1hfPyZK0Yd5pMZ65mKun7Tu-Z7eu44v@mail.gmail.com>
References: <1274167846-5465-1-git-send-email-thunderbird2k@gmail.com>
	<AANLkTinDRpFxi45JjKTiwTj7WVN_yzpf9_Xx_vmhf7B1@mail.gmail.com>
	<AANLkTilwfJOfE1hfPyZK0Yd5pMZ65mKun7Tu-Z7eu44v@mail.gmail.com>
Message-ID: <AANLkTinpyXfTFIdPSpja0UGLykwbuKizqVEuEtRCYG4O@mail.gmail.com>

On 18 May 2010 10:45, Roderick Colenbrander <thunderbird2k at gmail.com> wrote:
> isn't right since set_shader does useful things as well like
> glEnable(tex_type).
Yeah. In the bigger picture it's also slightly insane that we have a
shader based blit backend that doesn't actually use a shader for
blitting most of the time, but instead invalidates lots of fixed
function state.


From thunderbird2k at gmail.com  Tue May 18 04:13:07 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Tue, 18 May 2010 11:13:07 +0200
Subject: [PATCH 3/4] wined3d: allow complex -> complex blits in arbfp 
	blit_shader under special circumstances
In-Reply-To: <AANLkTilJVVWSfLIKgLINzzJtaOXds6A3sMsrNgHSDjUd@mail.gmail.com>
References: <1274167846-5465-1-git-send-email-thunderbird2k@gmail.com>
	<1274167846-5465-2-git-send-email-thunderbird2k@gmail.com>
	<1274167846-5465-3-git-send-email-thunderbird2k@gmail.com>
	<AANLkTilJVVWSfLIKgLINzzJtaOXds6A3sMsrNgHSDjUd@mail.gmail.com>
Message-ID: <AANLkTinp20Bdxw5jQqXo7Zp5NwxbXXfU6y-dB0RXQNIY@mail.gmail.com>

>> + ? ? ? ?&& (dst_usage & WINED3DUSAGE_RENDERTARGET))
> What is that condition for?

For a part it was meant to disable sysmem -> sysmem copies using the
arbfp blit_shader (but that should be done in general, so outside this
check). I wasn't sure whether dst_pool == D3DPOOL_DEFAULT would be
safe in general (sysmem->texture is but texture->texture might need
fbo_blit) hence the render_target restriction.

I could add something like this (as a separate patch of course):
if (dst_pool != default)
    return FALSE;

Further I can add the following condition to disallow texture->texture
blits, so that fbo_blit can handle them:
if (src_pool == default && dst_pool == default)
    return FALSE;
Perhaps at some point we might want to offer this for srgb texture
reloads but I don't know the finer details of that only saw some
comments in the code.

Roderick


From thunderbird2k at gmail.com  Tue May 18 04:38:06 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Tue, 18 May 2010 11:38:06 +0200
Subject: [PATCH 1/4] wined3d: only activate blit_shader in 
	arbfp_blit_surface for source fixups
In-Reply-To: <AANLkTinpyXfTFIdPSpja0UGLykwbuKizqVEuEtRCYG4O@mail.gmail.com>
References: <1274167846-5465-1-git-send-email-thunderbird2k@gmail.com>
	<AANLkTinDRpFxi45JjKTiwTj7WVN_yzpf9_Xx_vmhf7B1@mail.gmail.com>
	<AANLkTilwfJOfE1hfPyZK0Yd5pMZ65mKun7Tu-Z7eu44v@mail.gmail.com>
	<AANLkTinpyXfTFIdPSpja0UGLykwbuKizqVEuEtRCYG4O@mail.gmail.com>
Message-ID: <AANLkTikH6fEdkLwHdzTm25u4OH44ignGcroqu4eg3w5S@mail.gmail.com>

On Tue, May 18, 2010 at 10:58 AM, Henri Verbeet <hverbeet at gmail.com> wrote:
> On 18 May 2010 10:45, Roderick Colenbrander <thunderbird2k at gmail.com> wrote:
>> isn't right since set_shader does useful things as well like
>> glEnable(tex_type).
> Yeah. In the bigger picture it's also slightly insane that we have a
> shader based blit backend that doesn't actually use a shader for
> blitting most of the time, but instead invalidates lots of fixed
> function state.
>

I think we might be able to get rid of a lot of that code. At this
point two out of the three cases which use the blit_shader are routed
through draw_textured_quad which for instance already does the
glEnable(tex_type) for us. In this case I guess if draw_textured_quad
also handles glDisable (it knows the target) this could already be
more efficient and get rid of unneeded state changes. The other case
is swapchain_blit but as I mentioned before the non-fbo path in this
call doesn't fit well into the design, so that's something I should
perhaps fix first perhaps by letting it use draw_textured_quad if
possible.

In general to what degree should we disable blindly disable
texture_2d, cubemaps, texture_rectangle? I thought the policy (though
not sure how the other code behaves) is that other code should be
smart enough to enable/disable states it needs to avoid unneeded state
switches or should functions clean up their own mess?

Roderick


From wylda at volny.cz  Tue May 18 04:45:35 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Tue, 18 May 2010 11:45:35 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_Nightly_performance_regression_graphs?=
In-Reply-To: <AANLkTikJDbGYNPe_1CjZwNARtlmBjxd96hL69loSAV5J@mail.gmail.com>
References: <AANLkTikJDbGYNPe_1CjZwNARtlmBjxd96hL69loSAV5J@mail.gmail.com>
Message-ID: <dfda18f5273c82b260aea2f72f891d10@www3-mail.volny.cz>

> I finally threw together some graphs, see
> http://kegel.com/wine/yagmarkdata/wine-1.1.44-245.html
> Not sure what to make of the results yet.

Cheap thought, expansive solution:

Looking at the graphs and used HW i think this not necessary do what
you expect. Change from 11 -> 10 can be just a normal deviation during
measurement. But change from 100 -> 90 (80...) can show clearly performance
regression.

Unfortunately latest nVidia cards have too high power consumption even
in idle state (although internal logic underclock the GPU/RAM card heavily
when idle). So running 24/7 brings another high cost :-/




From hverbeet at gmail.com  Tue May 18 04:49:32 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Tue, 18 May 2010 11:49:32 +0200
Subject: [PATCH 1/4] wined3d: only activate blit_shader in 
	arbfp_blit_surface for source fixups
In-Reply-To: <AANLkTikH6fEdkLwHdzTm25u4OH44ignGcroqu4eg3w5S@mail.gmail.com>
References: <1274167846-5465-1-git-send-email-thunderbird2k@gmail.com>
	<AANLkTinDRpFxi45JjKTiwTj7WVN_yzpf9_Xx_vmhf7B1@mail.gmail.com>
	<AANLkTilwfJOfE1hfPyZK0Yd5pMZ65mKun7Tu-Z7eu44v@mail.gmail.com>
	<AANLkTinpyXfTFIdPSpja0UGLykwbuKizqVEuEtRCYG4O@mail.gmail.com>
	<AANLkTikH6fEdkLwHdzTm25u4OH44ignGcroqu4eg3w5S@mail.gmail.com>
Message-ID: <AANLkTina0AkcFindY2jG8OzOPpa65XnetiQNwBn3Aqbu@mail.gmail.com>

On 18 May 2010 11:38, Roderick Colenbrander <thunderbird2k at gmail.com> wrote:
> I think we might be able to get rid of a lot of that code. At this
> point two out of the three cases which use the blit_shader are routed
> through draw_textured_quad which for instance already does the
> glEnable(tex_type) for us. In this case I guess if draw_textured_quad
> also handles glDisable (it knows the target) this could already be
> more efficient and get rid of unneeded state changes. The other case
> is swapchain_blit but as I mentioned before the non-fbo path in this
> call doesn't fit well into the design, so that's something I should
> perhaps fix first perhaps by letting it use draw_textured_quad if
> possible.
>
> In general to what degree should we disable blindly disable
> texture_2d, cubemaps, texture_rectangle? I thought the policy (though
> not sure how the other code behaves) is that other code should be
> smart enough to enable/disable states it needs to avoid unneeded state
> switches or should functions clean up their own mess?
>
Well, texture unit enables are mostly a fixed function concept, if
arbfp_blit was actually shader based it wouldn't need to bother with
that at all. In the general case you just invalidate the relevant
states and depend on the state management to figure it out. There are
some cases where that's impossible though, mostly for code that's
called by state management functions itself.


From dank at kegel.com  Tue May 18 07:38:42 2010
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 May 2010 05:38:42 -0700
Subject: Nightly performance regression graphs
In-Reply-To: <4BF24C2B.7050702@gmail.com>
References: <AANLkTikJDbGYNPe_1CjZwNARtlmBjxd96hL69loSAV5J@mail.gmail.com>
	<4BF24C2B.7050702@gmail.com>
Message-ID: <AANLkTikCRi6_o3pC5u8hxTH38B4jI1PQnnbPU6Svtbdo@mail.gmail.com>

On Tue, May 18, 2010 at 1:13 AM, Sven Baars <sven.wine at gmail.com> wrote:
>> http://kegel.com/wine/yagmarkdata/wine-1.1.44-245.html
>
> Just a question. What's this about?
>
>                                      Vista          Wine           ratio
> heaven2_d3d9_Video_memory            1024.00        256.00         0.25

The video card definitely has a gigabyte of video memory, and
I just confirmed that the wineprefix running the test has
user.reg:"VideoMemorySize"="1024"
so I have no idea.  Sounds like a bug, but I doubt it affects the
results.  A little quality time with +relay would probably
show what's going on.  (Or Wine could buy a copy of the
source code for this benchmark.  We might want one anyway...)
- Dan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100518/2694f8f9/attachment-0001.htm>

From dank at kegel.com  Tue May 18 07:42:30 2010
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 May 2010 05:42:30 -0700
Subject: Nightly performance regression graphs
In-Reply-To: <4BF266ED.8050007@open-vote.org>
References: <AANLkTikJDbGYNPe_1CjZwNARtlmBjxd96hL69loSAV5J@mail.gmail.com>
	<4BF266ED.8050007@open-vote.org>
Message-ID: <AANLkTiksnpbZiQ4xI5xwA0sVfnd0vkj8ADZ7uCvk8Tu5@mail.gmail.com>

On Tue, May 18, 2010 at 3:07 AM, Scott Ritchie <scott at open-vote.org> wrote:
> > http://kegel.com/wine/yagmarkdata/wine-1.1.44-245.html
>
> What tool are you using to make them?

gnuplot.  The script (if you can call it that) I use is at
http://code.google.com/p/winezeug/source/browse/trunk/yagmark-plot.sh

> I recommend cairoplot, it's the tool I used in the model I made here:
> http://yokozar.org/blog/archives/48
>
> It outputs svgs just the same, but is nice and pretty and pythonic. ?We
> could then script interesting things automatically, such as having the
> chart automatically use the previous max benchmark as its first or
> second node.

I'll improve what I've got a bit, but at the moment I don't see a reason
to switch away from gnuplot.
- Dan


From mike.kronenberg at kronenberg.org  Tue May 18 08:12:48 2010
From: mike.kronenberg at kronenberg.org (Mike Kronenberg)
Date: Tue, 18 May 2010 15:12:48 +0200
Subject: Work on WineQuartz for MacOSX
In-Reply-To: <4BF0D9AC.80805@mymail.mines.edu>
References: <17608521.1274065483621.JavaMail.root@elwamui-polski.atl.sa.earthlink.net>
	<4BF0D9AC.80805@mymail.mines.edu>
Message-ID: <4B826C58-27C4-4E7D-8FD3-47C48276A56A@kronenberg.org>

On 17.05.2010, at 07:52, Charles Davis wrote:

> On 5/16/10 9:04 PM, James Mckenzie wrote:
>> Roderick Colenbrander wrote:
>>> On Sun, May 16, 2010 at 6:02 PM, C.W. Betts <computers57 at hotmail.com> wrote:
>>>> On May 16, 2010, at 9:31 AM, James Mckenzie wrote:
>>>>> All:
>>>>> 
>>>>> There was or is a quite lengthy thread on this project.
>>>>> 
>>>>> What is the status of work?  Any progress on Emmanuel's work from 2008?
>>>>> 
>>>>> Thank you.
>>>>> 
>>>>> James McKenzie
>>>>> 
>>>> If memory serves, the main reason why there hasn't been any work done is because of the
>>>> dependency of Objective-C, which the project administrator has said "no" to.
>>>> 
>>> The fact that Cocoa is objective C is one of the issues (Charles Davis
>>> made some C wrapper I think). The most problematic thing is that it
>>> really need is a DIB engine. The Cocoa graphics APIs are similar to
>>> Cairo / XRender / Direct2D and other modern APIs. These APIs are great
>>> for vector drawing, alpha blending and other fancy operations but they
>>> are not low-level 2D APIs. For instance they lack most classic
>>> (bitwise) 2D ROPs. The classic rendering stuff (Windows 7 does it this
>>> way as well) has to be performed in software by a DIB engine.
>>> 
>>> Roderick
>>> 
>> Charles Davis did not 'make a c wrapper', Apple did.
> Actually, he was referring to my tool for autogenerating C wrappers. I
> haven't been working on it much, but I'll have it ready for you guys soon.
>> However you are more correct in that we need a fully functional DIB engine in order to fully move the Apple interface from X11 to Aqua.
> I agree. We need a DIB engine. Quartz by itself doesn't support
> low-level raster operations (it's a vector engine).
I did several implementations for the QEMU video output under OS X.
The main grieve was Apple depreciating the QuickDraw API in 10.4 and removing it with 64bit. With this public direct buffer access gone, we did a quartz and a OpenGL implementation later. In the end, the OpenGL implementation won, as it was more portable, flexible and scaling comes for free (Fullscreen support).
Basically one does the pixel manipulation in a buffer and loads that buffer as a texture at a fixed refresh rate (25/30/60hz?) if necessary. With Apples Client Storage and Texture Ranges [1], it proved to be the fastest pixel manipulation method and was very close to QD.
Having a OpenGL based dib engine would work great with other OpenGL parts of wine (directx comes to mind) and it's open for porting.

The OpenGL Code is still there, but I did not yet look at the current dib engine, yet. Any sparring partner?
Mike

[1] http://developer.apple.com/mac/library/documentation/GraphicsImaging/Conceptual/OpenGL-MacProgGuide/opengl_texturedata/opengl_texturedata.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 3410 bytes
Desc: not available
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100518/3ffe5274/attachment.bin>

From dank at kegel.com  Tue May 18 08:17:32 2010
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 May 2010 06:17:32 -0700
Subject: Nightly performance regression graphs
In-Reply-To: <AANLkTilZxxP-9TMfObVPdHhLrTRMRyavhIsaWXS4SSm0@mail.gmail.com>
References: <AANLkTikJDbGYNPe_1CjZwNARtlmBjxd96hL69loSAV5J@mail.gmail.com>
	<AANLkTilZxxP-9TMfObVPdHhLrTRMRyavhIsaWXS4SSm0@mail.gmail.com>
Message-ID: <AANLkTilSZ_8-2J7dw9VVlBONd_WrvBZTlJhFsTqBqjyj@mail.gmail.com>

On Mon, May 17, 2010 at 11:00 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
>> http://kegel.com/wine/yagmarkdata/wine-1.1.44-245.html
>
> Can you use something like:
>
> <object data="E8400-GT_220-Ubuntu_10.04_LTS-e8400-3dmark06_3DMark_Score.svg"
> type="image/svg+xml">
> ?<embed src="E8400-GT_220-Ubuntu_10.04_LTS-e8400-3dmark06_3DMark_Score.svg"
> type="image/svg+xml">
> ?<img src="E8400-GT_220-Ubuntu_10.04_LTS-e8400-3dmark06_3DMark_Score.svg"
> alt="E8400 GT220 - Ubuntu 10.04 LTS - e8400 - 3dmark06 3DMark Score">
> ?</embed>
> </object>
>
> so that this will work in Firefox

Bleah!  That's sooo gross.

I'm tempted to keep using img tags and asking everyone who's affected
to go vote for
https://bugzilla.mozilla.org/show_bug.cgi?id=276431 (or whatever the
bug is for their browser)
- Dan


From m.b.lankhorst at gmail.com  Tue May 18 08:45:10 2010
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 18 May 2010 15:45:10 +0200
Subject: winecfg audio tab contents
In-Reply-To: <47CC5ABB01651443A88DB8EC5B4D657B74037A@S4DE8PSAANK.mitte.t-com.de>
References: <47CC5ABB01651443A88DB8EC5B4D657B74037A@S4DE8PSAANK.mitte.t-com.de>
Message-ID: <4BF299E6.1020000@gmail.com>

Hello Joerg,

On 18-05-10 15:33, Joerg-Cyril.Hoehle at t-systems.com wrote:
> did you notice that in winecfg-1.1.44, the audio tab content
> is broken: nothing is displayed below ALSA, and OSS lists 5
> things only.  There used to be much more content.
>    
This is likely a side effect from not calling DRVM_INIT before calling 
GETNUMDEVS, meaning the devices are closed. I sent in a bunch of patches 
so that things aren't initialized before they are used. Manually calling 
DRVM_INIT might help, but then you would have to make sure you're not 
using ANY of the winmm functions that also talk to the driver.

a patch like this would probably fix it:

- if (wodMessagePtr)
+ if (wodMessagePtr && wodMessagePtr(0, DRVM_INIT, 0, 0, 0))
                     num_wod = wodMessagePtr(0, WODM_GETNUMDEVS, 0, 0, 0);

However, it is best to make sure that DRVM_INIT is only called once to 
avoid ill side effects. I wouldn't worry about it much, After 1.2 is 
shipped the audio tab will be all gone anyhow. :)

Cheers,
Maarten


From nerv at dawncrow.de  Tue May 18 10:26:23 2010
From: nerv at dawncrow.de (=?ISO-8859-1?Q?Andr=E9_Hentschel?=)
Date: Tue, 18 May 2010 17:26:23 +0200
Subject: Nightly performance regression graphs
In-Reply-To: <AANLkTilSZ_8-2J7dw9VVlBONd_WrvBZTlJhFsTqBqjyj@mail.gmail.com>
References: <AANLkTikJDbGYNPe_1CjZwNARtlmBjxd96hL69loSAV5J@mail.gmail.com>	<AANLkTilZxxP-9TMfObVPdHhLrTRMRyavhIsaWXS4SSm0@mail.gmail.com>
	<AANLkTilSZ_8-2J7dw9VVlBONd_WrvBZTlJhFsTqBqjyj@mail.gmail.com>
Message-ID: <4BF2B19F.4020101@dawncrow.de>

Am 18.05.2010 15:17, schrieb Dan Kegel:
> On Mon, May 17, 2010 at 11:00 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
>>> http://kegel.com/wine/yagmarkdata/wine-1.1.44-245.html
>>
>> Can you use something like:
>>
>> <object data="E8400-GT_220-Ubuntu_10.04_LTS-e8400-3dmark06_3DMark_Score.svg"
>> type="image/svg+xml">
>>  <embed src="E8400-GT_220-Ubuntu_10.04_LTS-e8400-3dmark06_3DMark_Score.svg"
>> type="image/svg+xml">
>>  <img src="E8400-GT_220-Ubuntu_10.04_LTS-e8400-3dmark06_3DMark_Score.svg"
>> alt="E8400 GT220 - Ubuntu 10.04 LTS - e8400 - 3dmark06 3DMark Score">
>>  </embed>
>> </object>
>>
>> so that this will work in Firefox
> 
> Bleah!  That's sooo gross.
> 
> I'm tempted to keep using img tags and asking everyone who's affected
> to go vote for
> https://bugzilla.mozilla.org/show_bug.cgi?id=276431 (or whatever the
> bug is for their browser)
> - Dan
> 
> 
It seems only Chrome understoods svg in img tags.

-- 

Best Regards, Andr? Hentschel


From thunderbird2k at gmail.com  Tue May 18 10:53:53 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Tue, 18 May 2010 17:53:53 +0200
Subject: Work on WineQuartz for MacOSX
In-Reply-To: <4B826C58-27C4-4E7D-8FD3-47C48276A56A@kronenberg.org>
References: <17608521.1274065483621.JavaMail.root@elwamui-polski.atl.sa.earthlink.net>
	<4BF0D9AC.80805@mymail.mines.edu>
	<4B826C58-27C4-4E7D-8FD3-47C48276A56A@kronenberg.org>
Message-ID: <AANLkTinJ8nrN9eI8_pW0kj4QxCaVVnYREhEegXIYe93j@mail.gmail.com>

On Tue, May 18, 2010 at 3:12 PM, Mike Kronenberg
<mike.kronenberg at kronenberg.org> wrote:
> On 17.05.2010, at 07:52, Charles Davis wrote:
>
>> On 5/16/10 9:04 PM, James Mckenzie wrote:
>>> Roderick Colenbrander wrote:
>>>> On Sun, May 16, 2010 at 6:02 PM, C.W. Betts <computers57 at hotmail.com> wrote:
>>>>> On May 16, 2010, at 9:31 AM, James Mckenzie wrote:
>>>>>> All:
>>>>>>
>>>>>> There was or is a quite lengthy thread on this project.
>>>>>>
>>>>>> What is the status of work? ?Any progress on Emmanuel's work from 2008?
>>>>>>
>>>>>> Thank you.
>>>>>>
>>>>>> James McKenzie
>>>>>>
>>>>> If memory serves, the main reason why there hasn't been any work done is because of the
>>>>> dependency of Objective-C, which the project administrator has said "no" to.
>>>>>
>>>> The fact that Cocoa is objective C is one of the issues (Charles Davis
>>>> made some C wrapper I think). The most problematic thing is that it
>>>> really need is a DIB engine. The Cocoa graphics APIs are similar to
>>>> Cairo / XRender / Direct2D and other modern APIs. These APIs are great
>>>> for vector drawing, alpha blending and other fancy operations but they
>>>> are not low-level 2D APIs. For instance they lack most classic
>>>> (bitwise) 2D ROPs. The classic rendering stuff (Windows 7 does it this
>>>> way as well) has to be performed in software by a DIB engine.
>>>>
>>>> Roderick
>>>>
>>> Charles Davis did not 'make a c wrapper', Apple did.
>> Actually, he was referring to my tool for autogenerating C wrappers. I
>> haven't been working on it much, but I'll have it ready for you guys soon.
>>> However you are more correct in that we need a fully functional DIB engine in order to fully move the Apple interface from X11 to Aqua.
>> I agree. We need a DIB engine. Quartz by itself doesn't support
>> low-level raster operations (it's a vector engine).
> I did several implementations for the QEMU video output under OS X.
> The main grieve was Apple depreciating the QuickDraw API in 10.4 and removing it with 64bit. With this public direct buffer access gone, we did a quartz and a OpenGL implementation later. In the end, the OpenGL implementation won, as it was more portable, flexible and scaling comes for free (Fullscreen support).
> Basically one does the pixel manipulation in a buffer and loads that buffer as a texture at a fixed refresh rate (25/30/60hz?) if necessary. With Apples Client Storage and Texture Ranges [1], it proved to be the fastest pixel manipulation method and was very close to QD.
> Having a OpenGL based dib engine would work great with other OpenGL parts of wine (directx comes to mind) and it's open for porting.
>
> The OpenGL Code is still there, but I did not yet look at the current dib engine, yet. Any sparring partner?
> Mike
>
> [1] http://developer.apple.com/mac/library/documentation/GraphicsImaging/Conceptual/OpenGL-MacProgGuide/opengl_texturedata/opengl_texturedata.html
>
>
>

The DIB engine has to be implemented in software. Important parts of
the DDB engine can be implemented using OpenGL. Parts which can be
implemented are things like BitBlt SRCCOPY, ColorFill, alpha blending
and some others it is similar to what Win7 accelerates and what APIs
like Cairo, XRender and others offer.

Writing a DIB engine is not a trivial job and Alexandre has also said
a couple of times (for instance at WineConf) that not much people are
capable of it because it encompasses so much. I think only he and Huw
are capable at this point. Though in the Win7 design (if we would go
for that) the DIB engine is less complex as even most DDB operations
(except for the few common ones I mentioned) are done in software.

Roderick


From thunderbird2k at gmail.com  Tue May 18 11:00:13 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Tue, 18 May 2010 18:00:13 +0200
Subject: Nightly performance regression graphs
In-Reply-To: <AANLkTiksnpbZiQ4xI5xwA0sVfnd0vkj8ADZ7uCvk8Tu5@mail.gmail.com>
References: <AANLkTikJDbGYNPe_1CjZwNARtlmBjxd96hL69loSAV5J@mail.gmail.com>
	<4BF266ED.8050007@open-vote.org>
	<AANLkTiksnpbZiQ4xI5xwA0sVfnd0vkj8ADZ7uCvk8Tu5@mail.gmail.com>
Message-ID: <AANLkTin85YgbXOef3hDVAPEPPChFzLXAw1lVCOkA-RBx@mail.gmail.com>

On Tue, May 18, 2010 at 2:42 PM, Dan Kegel <dank at kegel.com> wrote:
> On Tue, May 18, 2010 at 3:07 AM, Scott Ritchie <scott at open-vote.org> wrote:
>> > http://kegel.com/wine/yagmarkdata/wine-1.1.44-245.html
>>
>> What tool are you using to make them?
>
> gnuplot. ?The script (if you can call it that) I use is at
> http://code.google.com/p/winezeug/source/browse/trunk/yagmark-plot.sh
>
>> I recommend cairoplot, it's the tool I used in the model I made here:
>> http://yokozar.org/blog/archives/48
>>
>> It outputs svgs just the same, but is nice and pretty and pythonic. ?We
>> could then script interesting things automatically, such as having the
>> chart automatically use the previous max benchmark as its first or
>> second node.
>
> I'll improve what I've got a bit, but at the moment I don't see a reason
> to switch away from gnuplot.
> - Dan
>

Myself I'm a big fan of matplotlot (it has a Matlab like syntax) for
use with python and can do a lot. If it works like it is, just keep
it.

Roderick


From msclrhd at googlemail.com  Tue May 18 11:03:37 2010
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 18 May 2010 17:03:37 +0100
Subject: Nightly performance regression graphs
In-Reply-To: <4BF2B19F.4020101@dawncrow.de>
References: <AANLkTikJDbGYNPe_1CjZwNARtlmBjxd96hL69loSAV5J@mail.gmail.com>
	<AANLkTilZxxP-9TMfObVPdHhLrTRMRyavhIsaWXS4SSm0@mail.gmail.com>
	<AANLkTilSZ_8-2J7dw9VVlBONd_WrvBZTlJhFsTqBqjyj@mail.gmail.com>
	<4BF2B19F.4020101@dawncrow.de>
Message-ID: <AANLkTikEWSHbe1X8UOGdleuuodHIP8gsdx6TG5De3tZV@mail.gmail.com>

2010/5/18 Andr? Hentschel <nerv at dawncrow.de>:
> Am 18.05.2010 15:17, schrieb Dan Kegel:
>> On Mon, May 17, 2010 at 11:00 PM, Reece Dunn <msclrhd at googlemail.com> wrote:
>>>> http://kegel.com/wine/yagmarkdata/wine-1.1.44-245.html
>>>
>>> Can you use something like:
>>>
>>> <object data="E8400-GT_220-Ubuntu_10.04_LTS-e8400-3dmark06_3DMark_Score.svg"
>>> type="image/svg+xml">
>>> ?<embed src="E8400-GT_220-Ubuntu_10.04_LTS-e8400-3dmark06_3DMark_Score.svg"
>>> type="image/svg+xml">
>>> ?<img src="E8400-GT_220-Ubuntu_10.04_LTS-e8400-3dmark06_3DMark_Score.svg"
>>> alt="E8400 GT220 - Ubuntu 10.04 LTS - e8400 - 3dmark06 3DMark Score">
>>> ?</embed>
>>> </object>
>>>
>>> so that this will work in Firefox
>>
>> Bleah! ?That's sooo gross.
>>
>> I'm tempted to keep using img tags and asking everyone who's affected
>> to go vote for
>> https://bugzilla.mozilla.org/show_bug.cgi?id=276431 (or whatever the
>> bug is for their browser)
>> - Dan
>>
>>
> It seems only Chrome understoods svg in img tags.


From julliard at winehq.org  Tue May 18 12:03:17 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 18 May 2010 19:03:17 +0200
Subject: [PATCH 1/2] wininet: Fix error handling in HTTP_HttpSendRequestW
In-Reply-To: <4BF1D059.3000205@codeweavers.com> (Piotr Caban's message of
	"Tue, 18 May 2010 01:25:13 +0200")
References: <4BF1D059.3000205@codeweavers.com>
Message-ID: <87wrv1w3ai.fsf@wine.dyndns.org>

Piotr Caban <piotr at codeweavers.com> writes:

> ---
>  dlls/wininet/http.c |   10 ++++++----
>  1 files changed, 6 insertions(+), 4 deletions(-)

It doesn't work here:

../../../tools/runtest -q -P wine -M wininet.dll -T ../../.. -p wininet_test.exe.so http.c && touch http.ok
http.c:2692: Test failed: 2780: expected status 21 got 30
http.c:2692: Test failed: 2780: expected status 30 got 31
http.c:2692: Test failed: 2780: expected status 31 got 100
http.c:2692: Test failed: 2797: expected status 100 got 30
http.c:2693: Test failed: 2797: expected function 3 got 4
http.c:2696: Test failed: 2797: expected thread 68 got 68
http.c:2692: Test failed: 2797: expected status 30 got 31
http.c:2692: Test failed: 2811: expected status 31 got 40
http.c:2693: Test failed: 2811: expected function 4 got 5
http.c:2692: Test failed: 2819: expected status 40 got 41
http.c:2693: Test failed: 2819: expected function 5 got 6
http.c:2692: Test failed: 2819: expected status 41 got 100
http.c:2693: Test failed: 2819: expected function 5 got 6
http.c:2692: Test failed: 2819: expected status 100 got 50
http.c:2693: Test failed: 2819: expected function 5 got 6
http.c:2701: Test succeeded inside todo block: 2819: expected status 70 got 70
http.c:2703: Test succeeded inside todo block: 2819: expected function 6 got 6
make[1]: *** [http.ok] Error 17

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Tue May 18 12:10:12 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 18 May 2010 19:10:12 +0200
Subject: setupx.dll16: Fix error handling in VCP_VirtnodeCreate. (RETRY)
In-Reply-To: <alpine.LSU.1.99.1005162250080.26362@acrux.dbai.tuwien.ac.at>
	(Gerald Pfeifer's message of "Sun, 16 May 2010 22:53:20 +0200 (CEST)")
References: <alpine.LSU.1.99.1005162250080.26362@acrux.dbai.tuwien.ac.at>
Message-ID: <87sk5pw2yz.fsf@wine.dyndns.org>

Gerald Pfeifer <gerald at pfeifer.com> writes:

> This was not applied and I also did not see any feedback (and even
> checked the list archives) so I am resending it.

If you are going to return an error you have to handle the error
properly and free the data structures etc.  It's not clear that this is
the right thing to do though.

-- 
Alexandre Julliard
julliard at winehq.org


From remco47 at gmail.com  Tue May 18 12:41:12 2010
From: remco47 at gmail.com (Remco)
Date: Tue, 18 May 2010 19:41:12 +0200
Subject: Nightly performance regression graphs
In-Reply-To: <AANLkTikEWSHbe1X8UOGdleuuodHIP8gsdx6TG5De3tZV@mail.gmail.com>
References: <AANLkTikJDbGYNPe_1CjZwNARtlmBjxd96hL69loSAV5J@mail.gmail.com> 
	<AANLkTilZxxP-9TMfObVPdHhLrTRMRyavhIsaWXS4SSm0@mail.gmail.com> 
	<AANLkTilSZ_8-2J7dw9VVlBONd_WrvBZTlJhFsTqBqjyj@mail.gmail.com> 
	<4BF2B19F.4020101@dawncrow.de>
	<AANLkTikEWSHbe1X8UOGdleuuodHIP8gsdx6TG5De3tZV@mail.gmail.com>
Message-ID: <AANLkTinuxhoRVF7GzK1kNC-w2RBdJjsMKMNODdYg2kaU@mail.gmail.com>

2010/5/18 Reece Dunn <msclrhd at googlemail.com>:
> ? <object data="image.svg" type="image/svg+xml"></object>
>
> should work on all platforms that support SVG.
>
> - Reece

Chromium doesn't like the object markup. It shows tiny frames with
scrollbars. It seems there is no cross-platform way to simply display
an SVG image.

-- 
Remco


From juan.lang at gmail.com  Tue May 18 13:07:25 2010
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 18 May 2010 11:07:25 -0700
Subject: ntdll: add stub for NtRaiseHardError
Message-ID: <AANLkTim9tDUsMdQ4Nnlnaf6FVUpyYxoipqV8Ly0_vUeB@mail.gmail.com>

Hi Austin,
+    return E_NOTIMPL;
I'm thinking this should return STATUS_NOT_IMPLEMENTED instead.
--Juan


From austinenglish at gmail.com  Tue May 18 13:13:53 2010
From: austinenglish at gmail.com (Austin English)
Date: Tue, 18 May 2010 13:13:53 -0500
Subject: ntdll: add stub for NtRaiseHardError
In-Reply-To: <AANLkTim9tDUsMdQ4Nnlnaf6FVUpyYxoipqV8Ly0_vUeB@mail.gmail.com>
References: <AANLkTim9tDUsMdQ4Nnlnaf6FVUpyYxoipqV8Ly0_vUeB@mail.gmail.com>
Message-ID: <AANLkTikRhjc-vsB5JZAoXu87_lg9BxNWdbUiy35WKKXO@mail.gmail.com>

On Tue, May 18, 2010 at 1:07 PM, Juan Lang <juan.lang at gmail.com> wrote:
> Hi Austin,
> + ? ?return E_NOTIMPL;
> I'm thinking this should return STATUS_NOT_IMPLEMENTED instead.

Ah, crap. You're right, thanks for catching!

-- 
-Austin


From msclrhd at googlemail.com  Tue May 18 13:25:22 2010
From: msclrhd at googlemail.com (Reece Dunn)
Date: Tue, 18 May 2010 19:25:22 +0100
Subject: ntdll: add stub for NtRaiseHardError (try 2)
In-Reply-To: <AANLkTimpklu3lAwLiW0OfK1if5GuDhZyhE6rHY-YomwP@mail.gmail.com>
References: <AANLkTimpklu3lAwLiW0OfK1if5GuDhZyhE6rHY-YomwP@mail.gmail.com>
Message-ID: <AANLkTimhUJZADx3_x1jIi7PVopTLTWvkACFKBAH-IvUB@mail.gmail.com>

On 18 May 2010 19:17, Austin English <austinenglish at gmail.com> wrote:
> This time returning STATUS_NOT_IMPLEMENTED instead of E_NOTIMPL, to
> match the rest of ntdll. Thanks to Juan for pointing that out.
>
> --
> -Austin

Patch?

- Reece


From ale.goujon at gmail.com  Tue May 18 13:39:42 2010
From: ale.goujon at gmail.com (GOUJON Alexandre)
Date: Tue, 18 May 2010 20:39:42 +0200
Subject: SONAME_LIBFONTCONFIG undeclared
Message-ID: <4BF2DEEE.4060104@gmail.com>

Hi,

I just updated my local tree and ran CFLAGS="-g -O0" ./configure 
--disable-tests && make
and I got

make[1]: Entering directory `/home/alex/Projects/wine/dlls/winex11.drv'
gcc -c -I. -I. -I../../include -I../../include  -D__WINESRC__  
-D_REENTRANT -fPIC -Wall -pipe -fno-strict-aliasing 
-Wdeclaration-after-statement -Wstrict-prototypes -Wtype-limits 
-Wwrite-strings -Wpointer-arith  -g -O0  -o xrender.o xrender.c
xrender.c: In function 'X11DRV_XRender_Init':
xrender.c:398: error: 'SONAME_LIBFONTCONFIG' undeclared (first use in 
this function)
xrender.c:398: error: (Each undeclared identifier is reported only once
xrender.c:398: error: for each function it appears in.)
xrender.c:401: error: 'pFcConfigSubstitute' undeclared (first use in 
this function)
xrender.c:402: error: 'pFcDefaultSubstitute' undeclared (first use in 
this function)
xrender.c:403: error: 'pFcFontMatch' undeclared (first use in this function)
xrender.c:404: error: 'pFcInit' undeclared (first use in this function)
xrender.c:405: error: 'pFcPatternCreate' undeclared (first use in this 
function)
xrender.c:406: error: 'pFcPatternDestroy' undeclared (first use in this 
function)
xrender.c:407: error: 'pFcPatternAddInteger' undeclared (first use in 
this function)
xrender.c:408: error: 'pFcPatternAddString' undeclared (first use in 
this function)
xrender.c:409: error: 'pFcPatternGetInteger' undeclared (first use in 
this function)
xrender.c:411: error: 'fontconfig_installed' undeclared (first use in 
this function)
xrender.c:411: warning: implicit declaration of function 'pFcInit'
xrender.c:413: error: expected ')' before 'SONAME_LIBFONTCONFIG'
make[1]: *** [xrender.o] Error 1
make[1]: Leaving directory `/home/alex/Projects/wine/dlls/winex11.drv'
make: *** [dlls/winex11.drv] Error 2

Is anyone else experiencing this ?


From thestig at google.com  Tue May 18 13:58:26 2010
From: thestig at google.com (Lei Zhang)
Date: Tue, 18 May 2010 11:58:26 -0700
Subject: SONAME_LIBFONTCONFIG undeclared
In-Reply-To: <4BF2DEEE.4060104@gmail.com>
References: <4BF2DEEE.4060104@gmail.com>
Message-ID: <AANLkTinXUrMz5lh7m0ICZ73CwgwZdJOZCeU3-wDQpG1I@mail.gmail.com>

On Tue, May 18, 2010 at 11:39 AM, GOUJON Alexandre <ale.goujon at gmail.com> wrote:
> Hi,
>
> I just updated my local tree and ran CFLAGS="-g -O0" ./configure
> --disable-tests && make
> and I got
>
> xrender.c:411: warning: implicit declaration of function 'pFcInit'
> xrender.c:413: error: expected ')' before 'SONAME_LIBFONTCONFIG'
> make[1]: *** [xrender.o] Error 1
> make[1]: Leaving directory `/home/alex/Projects/wine/dlls/winex11.drv'
> make: *** [dlls/winex11.drv] Error 2
>
> Is anyone else experiencing this ?

Works fine here on Ubuntu Hardy with today's wine-git. Do you have all
the build dependencies? http://wiki.winehq.org/Recommended_Packages


From ale.goujon at gmail.com  Tue May 18 14:31:43 2010
From: ale.goujon at gmail.com (GOUJON Alexandre)
Date: Tue, 18 May 2010 21:31:43 +0200
Subject: SONAME_LIBFONTCONFIG undeclared
In-Reply-To: <AANLkTinXUrMz5lh7m0ICZ73CwgwZdJOZCeU3-wDQpG1I@mail.gmail.com>
References: <4BF2DEEE.4060104@gmail.com>
	<AANLkTinXUrMz5lh7m0ICZ73CwgwZdJOZCeU3-wDQpG1I@mail.gmail.com>
Message-ID: <4BF2EB1F.7090009@gmail.com>

Lei Zhang wrote:
> Works fine here on Ubuntu Hardy with today's wine-git. Do you have all
> the build dependencies? http://wiki.winehq.org/Recommended_Packages
>    

Yep.
But now you're talking about dependencies I'm thinking I recently 
installed xrandr headers.
My mistake.
I will run make distclean to be sure that all is clean.

Thanks


From ale.goujon at gmail.com  Tue May 18 15:08:58 2010
From: ale.goujon at gmail.com (GOUJON Alexandre)
Date: Tue, 18 May 2010 22:08:58 +0200
Subject: =?UTF-8?B?UmXCsjogU09OQU1FX0xJQkZPTlRDT05GSUcgdW5kZWNsYXJlZA==?=
In-Reply-To: <4BF2DEEE.4060104@gmail.com>
References: <4BF2DEEE.4060104@gmail.com>
Message-ID: <4BF2F3DA.3050304@gmail.com>

Le 05/18/10 20:39, GOUJON Alexandre a ?crit :
> xrender.c: In function 'X11DRV_XRender_Init':
> xrender.c:398: error: 'SONAME_LIBFONTCONFIG' undeclared (first use in 
> this function)

In fact, the 398th line is
     if ((fontconfig_handle = wine_dlopen(SONAME_LIBFONTCONFIG, 
RTLD_NOW, NULL, 0)))
and I guess an #ifdef is missing

Now with libfontconfig1-dev installed I have a
| #define SONAME_LIBFONTCONFIG "libfontconfig.so.1"
in config.log

And all is working.

I just wonder why is this just happening now...


From austinenglish at gmail.com  Tue May 18 15:19:16 2010
From: austinenglish at gmail.com (Austin English)
Date: Tue, 18 May 2010 15:19:16 -0500
Subject: =?UTF-8?Q?Re=3A_Re=C2=B2=3A_SONAME=5FLIBFONTCONFIG_undeclared?=
In-Reply-To: <4BF2F3DA.3050304@gmail.com>
References: <4BF2DEEE.4060104@gmail.com> <4BF2F3DA.3050304@gmail.com>
Message-ID: <AANLkTikDEatcwTG6SWzrYvdmTYyWUpXc_OIgQ1E3euzV@mail.gmail.com>

On Tue, May 18, 2010 at 3:08 PM, GOUJON Alexandre <ale.goujon at gmail.com> wrote:
> Le 05/18/10 20:39, GOUJON Alexandre a ?crit :
>>
>> xrender.c: In function 'X11DRV_XRender_Init':
>> xrender.c:398: error: 'SONAME_LIBFONTCONFIG' undeclared (first use in this
>> function)
>
> In fact, the 398th line is
> ? ?if ((fontconfig_handle = wine_dlopen(SONAME_LIBFONTCONFIG, RTLD_NOW,
> NULL, 0)))
> and I guess an #ifdef is missing
>
> Now with libfontconfig1-dev installed I have a
> | #define SONAME_LIBFONTCONFIG "libfontconfig.so.1"
> in config.log
>
> And all is working.
>
> I just wonder why is this just happening now...

Probably related to
http://source.winehq.org/git/wine.git/?a=commitdiff;h=922e15cbd04fde3d9d4fbb98600f5471420c2daa

-- 
-Austin


From gerald at pfeifer.com  Tue May 18 12:10:36 2010
From: gerald at pfeifer.com (Gerald Pfeifer)
Date: Tue, 18 May 2010 19:10:36 +0200 (CEST)
Subject: autoconf 2.62 failure due to AS_VAR_IF
Message-ID: <alpine.LSU.1.99.1005181648120.26362@acrux.dbai.tuwien.ac.at>

Using autoconf 2.62 on my primary test system I am getting:

  configure:26081: error: possibly undefined macro: AS_VAR_IF

Indeed use of AS_VAR_IF appears relatively new, and it seems this may be 
similar to AS_VAR_APPEND where we have the following in configure.ac:

  dnl autoconf versions before 2.63b don't have AS_VAR_APPEND
  m4_ifdef([AS_VAR_APPEND],,[as_fn_append () { eval $[1]=\$$[1]\$[2]; }
  AC_DEFUN([AS_VAR_APPEND],[as_fn_append $1 $2])])dnl

I assume we need something similar here, too?  I am really far from
an autoconf hacker -- is this something one of you could look into?

Gerald


From htl10 at users.sourceforge.net  Tue May 18 18:30:43 2010
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Tue, 18 May 2010 23:30:43 +0000 (GMT)
Subject: software built and worked under wine but not in vista?
Message-ID: <661512.55915.qm@web23106.mail.ird.yahoo.com>

I have encountered a slightly strange issue with building the windows self-extracting installer release of ghostscript (http://www.ghostscript.com/) - the self-extracting installer is created with the winzip self-extractor package, which can be manually unzipped.

The curious thing is that I can build the self-extracting installer under 32-bit wine with the win 7 SDK (on 64-bit linux). but when I tried to run the self-installer under Vista, it says %1 is not a valid win32 application. Manually unpacking the selft-extracting installer and run 'setupgs.exe' (the setup program) also gives 'setupgs.ese is not a valid win32 application' message. But the main ghostcript executable seems operational. (the setup program mostly only just copy the extracted files to "Program Files" and set up a few registry entries, but ghostscript doesn't not require those to work).

So it seems that setupgs.exe is mis-compiled under wine with win7 sdk but just happened to also work under wine. Any idea how it might happen?
I have checked things like end-of-line, but it is curious why the setupgs program works under wine but not in vista, the reverse situation compared to most.




      


From scott at open-vote.org  Tue May 18 18:36:04 2010
From: scott at open-vote.org (Scott Ritchie)
Date: Tue, 18 May 2010 16:36:04 -0700
Subject: Steam hardware survey causing crashes (so next round of statistics
	will under-represent Wine users)
Message-ID: <4BF32464.7020400@open-vote.org>

Just a small note but occasionally we hear from Valve about steam
statistics and the percentage of Wine users.

I just got a crash from running the survey.  It makes me pretty unlikely
to click the button again, even if it doesn't crash in the future.  I
imagine other users would feel similarly.

This means we might be substantially underestimating Wine users if we
use the Valve hardware survey as a basis.  Last I remember we were at
0.4% or so, but that was over a year ago.

Thanks,
Scott Ritchie


From juan.lang at gmail.com  Tue May 18 19:01:27 2010
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 18 May 2010 17:01:27 -0700
Subject: [PATCH 3/4] wininet: Combine certificate errors in 
	HTTP_OpenConnection
Message-ID: <AANLkTinAnJXd7zojClM4U7nskHqxY30M46fa6AQ64jkQ@mail.gmail.com>

Hi Piotr,

+            if((lpwhr->hdr.ErrorMask&INTERNET_ERROR_MASK_COMBINED_SEC_CERT)
&& (
+                    res == ERROR_INTERNET_SEC_CERT_DATE_INVALID
+                    || res == ERROR_INTERNET_INVALID_CA
+                    || res == ERROR_INTERNET_SEC_CERT_NO_REV
+                    || res == ERROR_INTERNET_SEC_CERT_REV_FAILED
+                    || res == ERROR_INTERNET_SEC_CERT_REVOKED
+                    || res == ERROR_INTERNET_SEC_INVALID_CERT
+                    || res == ERROR_INTERNET_SEC_CERT_CN_INVALID))
+                res = ERROR_INTERNET_SEC_CERT_ERRORS;

I'm confused.  Is there evidence that native does the same?  This
would be surprising to me, given the existence of
INTERNET_OPTION_SECURITY_FLAGS to mask particular errors.  When are
you trying to accomplish with this patch?  Tests would certainly help.

Thanks,
--Juan


From testbot at testbot.winehq.org  Tue May 18 19:21:18 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Wed, 19 May 2010 02:21:18 +0200
Subject: [PATCH 2/4] wininet: Added INTERNET_OPTION_ERROR_MASK flag
	handling to InternetSetOptionW 
Message-ID: <201005190021.o4J0LIjr006150@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2142

Your paranoid android.


=== W98SE (32 bit internet) ===
internet.c:969: Test failed: Retrieved proxy server should've been L"proxy.example", was: L"\0001\a000\2684X\0fb4h\0200"
internet.c:975: Test failed: Expected regtype to be REG_DWORD, was: 3
internet.c:1003: Test failed: Retrieved flags should've been PROXY_TYPE_DIRECT, was: 5767180
internet.c:1006: Test failed: Expected regtype to be REG_DWORD, was: 3
internet.c:1033: Test failed: Retrieved flags should've been PROXY_TYPE_PROXY | PROXY_TYPE_DIRECT, was: 5767180
internet.c:1036: Test failed: Expected regtype to be REG_DWORD, was: 3

=== W2KPROSP4 (32 bit internet) ===
Timeout


From piotr.caban at gmail.com  Tue May 18 20:01:10 2010
From: piotr.caban at gmail.com (Piotr Caban)
Date: Wed, 19 May 2010 03:01:10 +0200
Subject: [PATCH 3/4] wininet: Combine certificate errors in
	HTTP_OpenConnection
In-Reply-To: <AANLkTinAnJXd7zojClM4U7nskHqxY30M46fa6AQ64jkQ@mail.gmail.com>
References: <AANLkTinAnJXd7zojClM4U7nskHqxY30M46fa6AQ64jkQ@mail.gmail.com>
Message-ID: <4BF33856.1040904@gmail.com>

Hi,

On 05/19/10 02:01, Juan Lang wrote:
> +            if((lpwhr->hdr.ErrorMask&INTERNET_ERROR_MASK_COMBINED_SEC_CERT)
> &&  (
> +                    res == ERROR_INTERNET_SEC_CERT_DATE_INVALID
> +                    || res == ERROR_INTERNET_INVALID_CA
> +                    || res == ERROR_INTERNET_SEC_CERT_NO_REV
> +                    || res == ERROR_INTERNET_SEC_CERT_REV_FAILED
> +                    || res == ERROR_INTERNET_SEC_CERT_REVOKED
> +                    || res == ERROR_INTERNET_SEC_INVALID_CERT
> +                    || res == ERROR_INTERNET_SEC_CERT_CN_INVALID))
> +                res = ERROR_INTERNET_SEC_CERT_ERRORS;
>
> I'm confused.  Is there evidence that native does the same?  This
I'm not sure which of the errors are combined (and if all of them to the 
same value as is stated in msdn).
> would be surprising to me, given the existence of
> INTERNET_OPTION_SECURITY_FLAGS to mask particular errors.
I guess this flag was used in past, currently IE is probably temporarily 
accepting certificates.
   When are
> you trying to accomplish with this patch?  Tests would certainly help.
Test can't be easily added to wine because we don't have pages to test 
certificate errors on. Thanks to this patch IE7 displays certificate 
validation error page.

I have written a simple test (not to be added to wine) that shows it's 
at least partially correct behavior. This test prints error returned in 
INTERNET_STATUS_REQUEST_COMPLETE callback (you can see the difference on 
WXPPROSP3 machine).
https://testbot.winehq.org/JobDetails.pl?Key=2143&log_204=1#k204

Cheers,
Piotr


From juan.lang at gmail.com  Tue May 18 20:10:36 2010
From: juan.lang at gmail.com (Juan Lang)
Date: Tue, 18 May 2010 18:10:36 -0700
Subject: [PATCH 3/4] wininet: Combine certificate errors in 
	HTTP_OpenConnection
In-Reply-To: <4BF33856.1040904@gmail.com>
References: <AANLkTinAnJXd7zojClM4U7nskHqxY30M46fa6AQ64jkQ@mail.gmail.com>
	<4BF33856.1040904@gmail.com>
Message-ID: <AANLkTinSYBgxP8igDthQ33n1d2cIAuySHJphySKKYZ55@mail.gmail.com>

> Test can't be easily added to wine because we don't have pages to test
> certificate errors on.

That should be addressed, no?  E.g. with a page hosted at winehq.org
with a self-signed certificate?  That'd at least allow us to check the
expected error when the root of a certificate chain is untrusted.
--Juan


From epssyis at gmail.com  Tue May 18 20:51:21 2010
From: epssyis at gmail.com (Edward Savage)
Date: Wed, 19 May 2010 11:51:21 +1000
Subject: Steam hardware survey causing crashes (so next round of 
	statistics will under-represent Wine users)
In-Reply-To: <4BF32464.7020400@open-vote.org>
References: <4BF32464.7020400@open-vote.org>
Message-ID: <AANLkTikLu8LnM2yZSZxaVnLR3uAIFqsaFszNHC2nRKya@mail.gmail.com>

On Wed, May 19, 2010 at 9:36 AM, Scott Ritchie <scott at open-vote.org> wrote:
> Just a small note but occasionally we hear from Valve about steam
> statistics and the percentage of Wine users.
>
> I just got a crash from running the survey. ?It makes me pretty unlikely
> to click the button again, even if it doesn't crash in the future. ?I
> imagine other users would feel similarly.
>
> This means we might be substantially underestimating Wine users if we
> use the Valve hardware survey as a basis. ?Last I remember we were at
> 0.4% or so, but that was over a year ago.
>

This is some thing new with the major refresh they did recently and is
easily reproducible by going to Help -> System Information in the main
Steam window.

Console output resulting from the profiler running:
fixme:dbghelp_dwarf:compute_location Only supporting one breg (18 -> 24)
fixme:dbghelp_dwarf:compute_location Only supporting one breg (17 -> 23)
fixme:dbghelp_dwarf:compute_location Only supporting one breg (17 -> 23)


From jjmckenzie51 at earthlink.net  Tue May 18 21:44:22 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Tue, 18 May 2010 19:44:22 -0700
Subject: ntdll: add stub for NtRaiseHardError (try 2)
In-Reply-To: <AANLkTim0JeLIWhPIven9Bl0rdjnuLo45qprCAeKHMGtr@mail.gmail.com>
References: <AANLkTimpklu3lAwLiW0OfK1if5GuDhZyhE6rHY-YomwP@mail.gmail.com>
	<AANLkTim0JeLIWhPIven9Bl0rdjnuLo45qprCAeKHMGtr@mail.gmail.com>
Message-ID: <4BF35086.1020306@earthlink.net>

Austin English wrote:
> On Tue, May 18, 2010 at 1:17 PM, Austin English <austinenglish at gmail.com> wrote:
>   
>> This time returning STATUS_NOT_IMPLEMENTED instead of E_NOTIMPL, to
>> match the rest of ntdll. Thanks to Juan for pointing that out.
>>     
>
> Today's not my day...
>
>   
Wasn't mine either.  Spent the entire day at 'work' chasing an error.  
Finally figured it out 1/2 hour before I left.  Now to fix 140,000 or so 
database entries.

James McKenzie



From austinenglish at gmail.com  Tue May 18 22:50:42 2010
From: austinenglish at gmail.com (Austin English)
Date: Tue, 18 May 2010 22:50:42 -0500
Subject: [PATCH 2/4] wininet: Added INTERNET_OPTION_ERROR_MASK flag 
	handling to InternetSetOptionW (try2)
In-Reply-To: <4BF33EA0.2070103@codeweavers.com>
References: <4BF33EA0.2070103@codeweavers.com>
Message-ID: <AANLkTikppm5rjRarfKLiGTsMdjBvdJGX23Xnup_jcUQ_@mail.gmail.com>

On Tue, May 18, 2010 at 8:28 PM, Piotr Caban <piotr at codeweavers.com> wrote:
> Try2:
> ?- Commented out test that fails on Win2000 (there were no new failures on
> Win98).

Any reason you didn't use broken() instead?

-- 
-Austin


From dank at kegel.com  Wed May 19 00:40:49 2010
From: dank at kegel.com (Dan Kegel)
Date: Tue, 18 May 2010 22:40:49 -0700
Subject: wininet: Combine certificate errors in HTTP_OpenConnection
Message-ID: <AANLkTiltQ9-3lLgS7znyOUQlsr0eERcU-bzN3gbe8QVx@mail.gmail.com>

>> Test can't be easily added to wine because we don't have pages to test
>> certificate errors on.
>
>That should be addressed, no?  E.g. with a page hosted at winehq.org
>with a self-signed certificate?

Or look at how Chromium does its ssl unit tests, by launching a little
server written in python:
http://src.chromium.org/cgi-bin/gitweb.cgi?p=chromium.git;a=blob;f=net/socket/ssl_test_util.cc
http://src.chromium.org/cgi-bin/gitweb.cgi?p=chromium.git;a=blob;f=net/socket/ssl_client_socket_unittest.cc
- Dan


From mike.kronenberg at kronenberg.org  Wed May 19 02:08:00 2010
From: mike.kronenberg at kronenberg.org (Mike Kronenberg)
Date: Wed, 19 May 2010 09:08:00 +0200
Subject: Work on WineQuartz for MacOSX
In-Reply-To: <AANLkTinJ8nrN9eI8_pW0kj4QxCaVVnYREhEegXIYe93j@mail.gmail.com>
References: <17608521.1274065483621.JavaMail.root@elwamui-polski.atl.sa.earthlink.net>
	<4BF0D9AC.80805@mymail.mines.edu>
	<4B826C58-27C4-4E7D-8FD3-47C48276A56A@kronenberg.org>
	<AANLkTinJ8nrN9eI8_pW0kj4QxCaVVnYREhEegXIYe93j@mail.gmail.com>
Message-ID: <3E55ADDC-4831-4BFA-9FA3-6E9CE5223C61@kronenberg.org>


On 18.05.2010, at 17:53, Roderick Colenbrander wrote:

> On Tue, May 18, 2010 at 3:12 PM, Mike Kronenberg
> <mike.kronenberg at kronenberg.org> wrote:
>> On 17.05.2010, at 07:52, Charles Davis wrote:
>> 
>>> On 5/16/10 9:04 PM, James Mckenzie wrote:
>>>> Roderick Colenbrander wrote:
>>>>> On Sun, May 16, 2010 at 6:02 PM, C.W. Betts <computers57 at hotmail.com> wrote:
>>>>>> On May 16, 2010, at 9:31 AM, James Mckenzie wrote:
>>>>>>> All:
>>>>>>> 
>>>>>>> There was or is a quite lengthy thread on this project.
>>>>>>> 
>>>>>>> What is the status of work?  Any progress on Emmanuel's work from 2008?
>>>>>>> 
>>>>>>> Thank you.
>>>>>>> 
>>>>>>> James McKenzie
>>>>>>> 
>>>>>> If memory serves, the main reason why there hasn't been any work done is because of the
>>>>>> dependency of Objective-C, which the project administrator has said "no" to.
>>>>>> 
>>>>> The fact that Cocoa is objective C is one of the issues (Charles Davis
>>>>> made some C wrapper I think). The most problematic thing is that it
>>>>> really need is a DIB engine. The Cocoa graphics APIs are similar to
>>>>> Cairo / XRender / Direct2D and other modern APIs. These APIs are great
>>>>> for vector drawing, alpha blending and other fancy operations but they
>>>>> are not low-level 2D APIs. For instance they lack most classic
>>>>> (bitwise) 2D ROPs. The classic rendering stuff (Windows 7 does it this
>>>>> way as well) has to be performed in software by a DIB engine.
>>>>> 
>>>>> Roderick
>>>>> 
>>>> Charles Davis did not 'make a c wrapper', Apple did.
>>> Actually, he was referring to my tool for autogenerating C wrappers. I
>>> haven't been working on it much, but I'll have it ready for you guys soon.
>>>> However you are more correct in that we need a fully functional DIB engine in order to fully move the Apple interface from X11 to Aqua.
>>> I agree. We need a DIB engine. Quartz by itself doesn't support
>>> low-level raster operations (it's a vector engine).
>> I did several implementations for the QEMU video output under OS X.
>> The main grieve was Apple depreciating the QuickDraw API in 10.4 and removing it with 64bit. With this public direct buffer access gone, we did a quartz and a OpenGL implementation later. In the end, the OpenGL implementation won, as it was more portable, flexible and scaling comes for free (Fullscreen support).
>> Basically one does the pixel manipulation in a buffer and loads that buffer as a texture at a fixed refresh rate (25/30/60hz?) if necessary. With Apples Client Storage and Texture Ranges [1], it proved to be the fastest pixel manipulation method and was very close to QD.
>> Having a OpenGL based dib engine would work great with other OpenGL parts of wine (directx comes to mind) and it's open for porting.
>> 
>> The OpenGL Code is still there, but I did not yet look at the current dib engine, yet. Any sparring partner?
>> Mike
>> 
>> [1] http://developer.apple.com/mac/library/documentation/GraphicsImaging/Conceptual/OpenGL-MacProgGuide/opengl_texturedata/opengl_texturedata.html
>> 
>> 
>> 
> 
> The DIB engine has to be implemented in software. Important parts of
> the DDB engine can be implemented using OpenGL. Parts which can be
> implemented are things like BitBlt SRCCOPY, ColorFill, alpha blending
> and some others it is similar to what Win7 accelerates and what APIs
> like Cairo, XRender and others offer.
> 
> Writing a DIB engine is not a trivial job and Alexandre has also said
> a couple of times (for instance at WineConf) that not much people are
> capable of it because it encompasses so much. I think only he and Huw
> are capable at this point.
No doubt on that one. And I'm not going to burn my fingers on the DIB engine itself. I'm merely talking about the backend for the actual output of a flat pixel-buffer on which the DIB engine's software part  would work, which is trivial ;). So it's more a hint to implement a DIB engine to use a neutral buffer, so it could be used by different means of output.

> Though in the Win7 design (if we would go
> for that) the DIB engine is less complex as even most DDB operations
> (except for the few common ones I mentioned) are done in software.
> 
> Roderick

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 3410 bytes
Desc: not available
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100519/5321296f/attachment.bin>

From stefandoesinger at gmx.at  Wed May 19 02:56:43 2010
From: stefandoesinger at gmx.at (=?iso-8859-1?Q?Stefan_D=F6singer?=)
Date: Wed, 19 May 2010 09:56:43 +0200
Subject: [PATCH 0/7] wined3d: blit set_shader texture_target activation
	cleanup
In-Reply-To: <1274222326-6037-1-git-send-email-thunderbird2k@gmail.com>
References: <1274222326-6037-1-git-send-email-thunderbird2k@gmail.com>
Message-ID: <C6F8F610-58ED-49BE-82AE-7B69BE469A4E@gmx.at>


Am 19.05.2010 um 00:38 schrieb Roderick Colenbrander:

> This patch series removes the responsibility for enabling/disabling the
> texture_target from the 'set_shader' stage of the blit_shader.
I disagree with this patch. glEnable(GL_TEXTURE_2D) is the fixed function pipline's way of putting the right texture target into the "TEX dst, src, sampler, dimension" instruction. They are in the ARB blitter only because of my laziness - it is using the fixed function pipeline instead of an equivalent shader.

So if you want to get rid of the glEnable / glDisable calls you should instead use ARB shaders which match the fixed function pipeline's functionality, e.g.

TEX result.color, fragment.texcoord[0], texture[0], 2D;  (for the 2D case)

ffp_blit will keep calling glEnable / glDisable GL_TEXTURE_...

> At a later stage I might disallow calling set_shader when we don't need the shader.
How does the caller know when a shader is needed?



From hverbeet at gmail.com  Wed May 19 03:18:02 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Wed, 19 May 2010 10:18:02 +0200
Subject: [PATCH 0/7] wined3d: blit set_shader texture_target activation 
	cleanup
In-Reply-To: <C6F8F610-58ED-49BE-82AE-7B69BE469A4E@gmx.at>
References: <1274222326-6037-1-git-send-email-thunderbird2k@gmail.com>
	<C6F8F610-58ED-49BE-82AE-7B69BE469A4E@gmx.at>
Message-ID: <AANLkTinQQQAodT8cb3EuWh_TSztmeNLULt1xOnWgKocG@mail.gmail.com>

On 19 May 2010 09:56, Stefan D?singer <stefandoesinger at gmx.at> wrote:
>
> Am 19.05.2010 um 00:38 schrieb Roderick Colenbrander:
>
>> This patch series removes the responsibility for enabling/disabling the
>> texture_target from the 'set_shader' stage of the blit_shader.
> I disagree with this patch. glEnable(GL_TEXTURE_2D) is the fixed function pipline's way of putting the right texture target into the "TEX dst, src, sampler, dimension" instruction. They are in the ARB blitter only because of my laziness - it is using the fixed function pipeline instead of an equivalent shader.
>
Yup, as explained yesterday, this is something that should be internal
to a specific blit implementation. This series is a change in the
opposite direction.

Technical issues with this series aside, I think it's too close to 1.2
for making architectural changes. IMO the focus should be mainly on
fixing regressions and minor bugs.


From stefandoesinger at gmx.at  Wed May 19 04:10:27 2010
From: stefandoesinger at gmx.at (=?iso-8859-1?Q?Stefan_D=F6singer?=)
Date: Wed, 19 May 2010 11:10:27 +0200
Subject: d3dx9: Add some version-specific checks in the shader assembler.
In-Reply-To: <AANLkTimbHUohCC2KonI0QE5Hbf4w_q71pjDkIsCQfHs6@mail.gmail.com>
References: <AANLkTimbHUohCC2KonI0QE5Hbf4w_q71pjDkIsCQfHs6@mail.gmail.com>
Message-ID: <64DEB11E-AE6A-4DCF-A715-0AA2EE1550C7@gmx.at>


Am 18.05.2010 um 14:55 schrieb Matteo Bruni:
> +    if(!check_reg_type(src, vs_3_reg_allowed)) {
> +        asmparser_message(This, "Line %u: Source register %s not supported in VS 3.0\n",
> +                          This->line_no,
> +                          debug_print_srcreg(src, ST_VERTEX));
> +        set_parse_status(This, PARSE_ERR);
> +    }
I realize the patch has been committed already, but I'm wondering: Does the native assembler check the register numbers too? Or just the types?

You have to be careful with error checking in the assembler, because the native assembler checks for very few error conditions. More complex checks like uninitialized registers or unwritten output registers are checked by the shader validator, an undocumented interface in d3d9.dll(which is called by vsa.exe / psa.exe)

If my memory is correct, all the other error conditions you check for are checked by the native *assembler*, but I'm not sure about the register numbers. I think more unit tests would be helpful.



From thunderbird2k at gmail.com  Wed May 19 04:30:24 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Wed, 19 May 2010 11:30:24 +0200
Subject: [PATCH 0/7] wined3d: blit set_shader texture_target activation 
	cleanup
In-Reply-To: <C6F8F610-58ED-49BE-82AE-7B69BE469A4E@gmx.at>
References: <1274222326-6037-1-git-send-email-thunderbird2k@gmail.com>
	<C6F8F610-58ED-49BE-82AE-7B69BE469A4E@gmx.at>
Message-ID: <AANLkTilTmzA0vrl3yssv5CN8oRbT9jVoFAAcUcfH1mJh@mail.gmail.com>

>> At a later stage I might disallow calling set_shader when we don't need the shader.
> How does the caller know when a shader is needed?
>

In the end set_shader will only be called by blit_shader->blit_surface.

The main issue I'm facing is p8 uploads which are completely broken
right now (a regression). At the beginning of the week I wanted to add
BLIT_OP_COMPLEX_UPLOAD to fix this but Henri didn't like that. This
'fixed' the bug where d3dfmt_get_conv was not allowed by
blit_supported to offer the 8-bit shader. This fix would only apply to
the LoadLocation part which is where the 8-bit upload takes place.

The suggested direction was to fix blit_supported to allow 8-bit blits
under 'special circumstances'. Such a change would not only allow
8-bit uploads but also allow 8-bit -> 8-bit Blt/BltFast
(blit_supported can't distinguish between the two uses since it has
too vague information). Allowing the 8-bit -> 8-Blt/BltFast led to
these changes (I'm not that happy about allowing those).

At this point BltOverride (and some of the other helpers derived from
it) blindly call set_shader when it is not needed which wouldn't work
here. The set_shader call at this point lacks the knowledge (it has
only one of the surfaces) to not apply the shader in this case. I
don't think I can add the missing surface because not all places which
call set_shader have it. For this reason I wanted to take the texture
target activation out of 'set_shader' and lift this to 'blit_surface'
which the current callers are supposed to become at some point. Some
places (e.g. swapchain_blit) imply that that the shader is needed when
a complex source fixup is detected and the same for blit_to_drawable,
so in BltOverride/arbfp_blit_surface I can just not call set_shader.

Right now I don't know anymore how it should be fixed at this stage
without re-adding the ugly extension checks which existed before in
d3dfmt_get_conv or other or other hacks like checking for
'is_complex_fixup' in d3dfmt_get_conv :(

Roderick


From aric at codeweavers.com  Wed May 19 07:17:45 2010
From: aric at codeweavers.com (Aric Stewart)
Date: Wed, 19 May 2010 07:17:45 -0500
Subject: winemp3.acm: Fixes the Mac-specific code (try 2)
In-Reply-To: <AANLkTinNNir7huyuKq36DvyYXWPb-gNLC2u67q0lFKTj@mail.gmail.com>
References: <AANLkTinNNir7huyuKq36DvyYXWPb-gNLC2u67q0lFKTj@mail.gmail.com>
Message-ID: <4BF3D6E9.3080800@codeweavers.com>

Hi,

  I was excited to try out this patch but now it is giving me a crash. 
(OS/X 10.5.8)

Backtrace:
=>0 0xffff12a9 (0x0033d81c)
   1 0xffff086e (0x0033d838)
   2 0x936f5a47 
_ZN14CodecConverter14AppendNewInputEmPcmRmP28AudioStreamPacketDescription+0xb6() 
in audiotoolbox (0x0033d888)
   3 0x936f564b _ZN14CodecConverter13CallInputProcERm+0x1ca() in 
audiotoolbox (0x0033d8f8)
   4 0x936f513d 
_ZN14CodecConverter17DecoderFillBufferERmR15AudioBufferListP28AudioStreamPacketDescription+0x47c() 
in audiotoolbox (0x0033d9c8)
   5 0x936e9b61 
_ZN22BufferedAudioConverter13GetInputBytesEmRmRPK12CABufferList+0xa0() 
in audiotoolbox (0x0033d9f8)
   6 0x936e9a1d 
_ZN12CBRConverter12RenderOutputEP12CABufferListmRmP28AudioStreamPacketDescription+0x7c() 
in audiotoolbox (0x0033da38)
   7 0x936e978c 
_ZN22BufferedAudioConverter10FillBufferERmR15AudioBufferListP28AudioStreamPacketDescription+0xeb() 
in audiotoolbox (0x0033da98)
   8 0x936e9b61 
_ZN22BufferedAudioConverter13GetInputBytesEmRmRPK12CABufferList+0xa0() 
in audiotoolbox (0x0033dac8)
   9 0x936e9a1d 
_ZN12CBRConverter12RenderOutputEP12CABufferListmRmP28AudioStreamPacketDescription+0x7c() 
in audiotoolbox (0x0033db08)
   10 0x936e978c 
_ZN22BufferedAudioConverter10FillBufferERmR15AudioBufferListP28AudioStreamPacketDescription+0xeb() 
in audiotoolbox (0x0033db68)
   11 0x936e9914 
_ZN19AudioConverterChain12RenderOutputEP12CABufferListmRmP28AudioStreamPacketDescription+0x63() 
in audiotoolbox (0x0033dba8)
   12 0x936e978c 
_ZN22BufferedAudioConverter10FillBufferERmR15AudioBufferListP28AudioStreamPacketDescription+0xeb() 
in audiotoolbox (0x0033dc08)
   13 0x93700b23 AudioConverterFillComplexBuffer+0x112() in audiotoolbox 
(0x0033dc58)
   14 0x57b4f560 _mp3_leopard_horse+0x2bf() in winemp3 (0x0033dd08)
   15 0x57b4f9a5 _MPEG3_DriverProc+0xf4() in winemp3 (0x0033ddd8)


Here is the mpeg log snipit from just before the crash:

trace:mpeg3:MPEG3_DriverProc (00000000 0x27af350 0003 00000000 0033de0c);
trace:mpeg3:MPEG3_DriverProc (00000001 0x27af350 601b 0033dea8 00000000);
trace:mpeg3:MPEG3_DriverProc (00000000 0x1114418 0003 00000000 0033dd9c);
trace:mpeg3:MPEG3_DriverProc (00000001 0x1114418 604c 008f757c 00000000);
trace:mpeg3:MPEG3_DriverProc (00000001 0x1114418 604e 008f757c 0033deb0);
trace:mpeg3:MPEG3_DriverProc (00000001 0x1114418 6051 008f757c 0033df44);
trace:mpeg3:MPEG3_DriverProc (00000001 0x1114418 604f 008f757c 0033df44);
trace:mpeg3:mp3_leopard_horse ndst 147456 0x3127860  <-  19901 0x3122a94
trace:mpeg3:mp3_leopard_horse First 16 bytes to input: 
"\x00\x1f\x84\n\x92_\x81h\x00\x00\x00\x00\x00\x00\x00\x00"

I am also getting quite a number of build warning that i dont know if 
should be concerning.

Anything more I can do to test for you?
-aric

Kristofer Henriksson wrote:
> Second submission, which improves the previous patch by properly
> syncing to the initial MP3 frame header.
> 
> The current winemp3.acm does not work if the Mac-specific code is
> used. This rewrites the relevant portion to fix, for example,
> background music on things like Oblivion.
> 
> 
> ------------------------------------------------------------------------
> 
> 


From matteo.mystral at gmail.com  Wed May 19 07:21:57 2010
From: matteo.mystral at gmail.com (Matteo Bruni)
Date: Wed, 19 May 2010 14:21:57 +0200
Subject: d3dx9: Add some version-specific checks in the shader assembler.
In-Reply-To: <64DEB11E-AE6A-4DCF-A715-0AA2EE1550C7@gmx.at>
References: <AANLkTimbHUohCC2KonI0QE5Hbf4w_q71pjDkIsCQfHs6@mail.gmail.com>
	<64DEB11E-AE6A-4DCF-A715-0AA2EE1550C7@gmx.at>
Message-ID: <AANLkTinmcTcSHLXCjqGypb2O_CV107kBsc_ktJzelBh_@mail.gmail.com>

2010/5/19 Stefan D?singer <stefandoesinger at gmx.at>:
>
> Am 18.05.2010 um 14:55 schrieb Matteo Bruni:
>> + ? ?if(!check_reg_type(src, vs_3_reg_allowed)) {
>> + ? ? ? ?asmparser_message(This, "Line %u: Source register %s not supported in VS 3.0\n",
>> + ? ? ? ? ? ? ? ? ? ? ? ? ?This->line_no,
>> + ? ? ? ? ? ? ? ? ? ? ? ? ?debug_print_srcreg(src, ST_VERTEX));
>> + ? ? ? ?set_parse_status(This, PARSE_ERR);
>> + ? ?}
> I realize the patch has been committed already, but I'm wondering: Does the native assembler check the register numbers too? Or just the types?
>
> You have to be careful with error checking in the assembler, because the native assembler checks for very few error conditions. More complex checks like uninitialized registers or unwritten output registers are checked by the shader validator, an undocumented interface in d3d9.dll(which is called by vsa.exe / psa.exe)
>
> If my memory is correct, all the other error conditions you check for are checked by the native *assembler*, but I'm not sure about the register numbers. I think more unit tests would be helpful.
>
>
>
>

Yes, the register numbers are checked too. There is currently a single
test about this ("shader 22" in failure_test()), it works correctly
with native. I'm invoking D3DXAssembleShader with
D3DXSHADER_SKIPVALIDATION to avoid the validator interference.
I can add more tests anyway, maybe one showing that the register
number is ignored when there is relative addressing involved.


From piotr.caban at gmail.com  Wed May 19 07:27:48 2010
From: piotr.caban at gmail.com (Piotr Caban)
Date: Wed, 19 May 2010 14:27:48 +0200
Subject: wininet: Combine certificate errors in HTTP_OpenConnection
In-Reply-To: <AANLkTiltQ9-3lLgS7znyOUQlsr0eERcU-bzN3gbe8QVx@mail.gmail.com>
References: <AANLkTiltQ9-3lLgS7znyOUQlsr0eERcU-bzN3gbe8QVx@mail.gmail.com>
Message-ID: <4BF3D944.2020302@gmail.com>

On 05/19/10 07:40, Dan Kegel wrote:
>>> Test can't be easily added to wine because we don't have pages to test
>>> certificate errors on.
>>
>> That should be addressed, no?  E.g. with a page hosted at winehq.org
>> with a self-signed certificate?
It's writing a test case for one of possible errors. It won't prove much 
more then you can see in the test I have written earlier.
>
> Or look at how Chromium does its ssl unit tests, by launching a little
> server written in python:
> http://src.chromium.org/cgi-bin/gitweb.cgi?p=chromium.git;a=blob;f=net/socket/ssl_test_util.cc
> http://src.chromium.org/cgi-bin/gitweb.cgi?p=chromium.git;a=blob;f=net/socket/ssl_client_socket_unittest.cc
I don't see a good reason for writing small http server in tests. It's a 
lot of work. Certificate verification errors can be checked in crypt32 
tests, it can be done locally (there are already some tests).


From thunderbird2k at gmail.com  Wed May 19 07:46:40 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Wed, 19 May 2010 14:46:40 +0200
Subject: [PATCH 0/7] wined3d: blit set_shader texture_target activation 
	cleanup
In-Reply-To: <AANLkTilTmzA0vrl3yssv5CN8oRbT9jVoFAAcUcfH1mJh@mail.gmail.com>
References: <1274222326-6037-1-git-send-email-thunderbird2k@gmail.com>
	<C6F8F610-58ED-49BE-82AE-7B69BE469A4E@gmx.at>
	<AANLkTilTmzA0vrl3yssv5CN8oRbT9jVoFAAcUcfH1mJh@mail.gmail.com>
Message-ID: <AANLkTika6jPNKIeaBvfXAijZ8ShzBvDStu8vPERqV_Aq@mail.gmail.com>

On Wed, May 19, 2010 at 11:30 AM, Roderick Colenbrander
<thunderbird2k at gmail.com> wrote:
>>> At a later stage I might disallow calling set_shader when we don't need the shader.
>> How does the caller know when a shader is needed?
>>
>
> In the end set_shader will only be called by blit_shader->blit_surface.
>
> The main issue I'm facing is p8 uploads which are completely broken
> right now (a regression). At the beginning of the week I wanted to add
> BLIT_OP_COMPLEX_UPLOAD to fix this but Henri didn't like that. This
> 'fixed' the bug where d3dfmt_get_conv was not allowed by
> blit_supported to offer the 8-bit shader. This fix would only apply to
> the LoadLocation part which is where the 8-bit upload takes place.
>
> The suggested direction was to fix blit_supported to allow 8-bit blits
> under 'special circumstances'. Such a change would not only allow
> 8-bit uploads but also allow 8-bit -> 8-bit Blt/BltFast
> (blit_supported can't distinguish between the two uses since it has
> too vague information). Allowing the 8-bit -> 8-Blt/BltFast led to
> these changes (I'm not that happy about allowing those).
>
> At this point BltOverride (and some of the other helpers derived from
> it) blindly call set_shader when it is not needed which wouldn't work
> here. The set_shader call at this point lacks the knowledge (it has
> only one of the surfaces) to not apply the shader in this case. I
> don't think I can add the missing surface because not all places which
> call set_shader have it. For this reason I wanted to take the texture
> target activation out of 'set_shader' and lift this to 'blit_surface'
> which the current callers are supposed to become at some point. Some
> places (e.g. swapchain_blit) imply that that the shader is needed when
> a complex source fixup is detected and the same for blit_to_drawable,
> so in BltOverride/arbfp_blit_surface I can just not call set_shader.
>
> Right now I don't know anymore how it should be fixed at this stage
> without re-adding the ugly extension checks which existed before in
> d3dfmt_get_conv or other or other hacks like checking for
> 'is_complex_fixup' in d3dfmt_get_conv :(
>
> Roderick
>

So the main issue is that a p8 sysmem -> drawable upload on the same surface
is detected as a 'destination fixup' by blit_supported. The
blit_supported call is
used for p8 in d3dfmt_get_conv basically for format selection before it were GL
extension checks.

What I could try to do is take out the blit_supported call and rely on
the 'implicit
blit_supported' for now in the form of the formats table. When the
table is loaded
it already sets the P8 texturing format we want (it is not that nice).
Together with
this change I would also have to rewrite d3dfmt_get_conv to really get
rid of the format
fixups as they are a part of the issue.

Issues:
1) sysmem -> drawable uploads on the same surface don't work
2) when shaders nor paletted_texture is around, d3dfmt_get_conv
    receives an 'empty' description which it fills with the gl info
(bad and seems to cause some issues already)
( 3) format desc fixups are ugly )

I would propose to make three changes:
1) format desc changes
Add some format color keying flags to the format_desc (would be set
for all CK formats) and a conversion flag (this one would be set for
P8 and perhaps also for all CK formats)


2) add separate formats table for color keyed formats which
d3dfmt_get_conv would select from.
This could work like:

HRESULT d3dfmt_get_conv(..)
{
    if (color_keying_active)
    {
        /* search color key format list */
        /* At the moment this is performed in software for p8 */
        return desc;
    }

    /* In case of P8 we need a different format when we use drawpixels
     * compared to texturing when ext_paletted_texture or shaders are around */
    if (!use_textures && p8)
    {
        return p8_drawpixels_desc;
    }

    /* In case of P8 this when we arrive here we return the default
format which is in the formats table,
     * so if paletted textures are around then that format is
returned. This would be an implicit
     * blit_supported check. At a later stage the blit_shader should
perhaps be asked what format is needed.
     */
    return default_desc;
}


3) Get rid of CONVERT_TYPES and look at the flags in the format_desc
before calling d3dfmt_convert_surface (this call would also check
these flags to figure out the right conversion).


This change addresses some ugly things (format desc fixups), fixes
issue '2' and would also address the 8-bit 'complex upload' case. I
admit that the last one would be fixed in a 'sneaky' way. At a later
point the blit_shader could perhaps be asked for a format.

What do you think?

Roderick


From dank at kegel.com  Wed May 19 08:19:00 2010
From: dank at kegel.com (Dan Kegel)
Date: Wed, 19 May 2010 06:19:00 -0700
Subject: wininet: Combine certificate errors in HTTP_OpenConnection
In-Reply-To: <4BF3D944.2020302@gmail.com>
References: <AANLkTiltQ9-3lLgS7znyOUQlsr0eERcU-bzN3gbe8QVx@mail.gmail.com>
	<4BF3D944.2020302@gmail.com>
Message-ID: <AANLkTilg27HYHmd8am3eeMZc3gB4lfewnLqnQVjgmuea@mail.gmail.com>

On Wed, May 19, 2010 at 5:27 AM, Piotr Caban <piotr.caban at gmail.com> wrote:
>> Or look at how Chromium does its ssl unit tests, by launching a little
>> server written in python:
>>
>> http://src.chromium.org/cgi-bin/gitweb.cgi?p=chromium.git;a=blob;f=net/socket/ssl_test_util.cc
>>
>> http://src.chromium.org/cgi-bin/gitweb.cgi?p=chromium.git;a=blob;f=net/socket/ssl_client_socket_unittest.cc
>
> I don't see a good reason for writing small http server in tests. It's a lot
> of work.

No, you don't have to write it, you can just use a canned
python server.  It isn't a lot of work.

> Certificate verification errors can be checked in crypt32 tests, it
> can be done locally (there are already some tests).

Of course, if you can avoid having a server at all, that's the best.
But there are some tests that currently fail if you're not online,
and that's bad.
- Dan


From dank at kegel.com  Wed May 19 09:05:49 2010
From: dank at kegel.com (Dan Kegel)
Date: Wed, 19 May 2010 07:05:49 -0700
Subject: Heaven 2 benchmark in good shape...
Message-ID: <AANLkTilZbyKBacVcVFrBwbNVeOPcWHlSQyH9Es0iOwVV@mail.gmail.com>

Yesterday's performance bot results,
http://kegel.com/wine/yagmarkdata/E8400-GT_220-Ubuntu_10.04_LTS-e8400-wine-1.1.44-290.html
show that the Heaven 2 d3d9 benchmark had a couple 10%
improvements in the past week (up from 10 to 11 and then 12 fps).
If we're going to see improvements in a benchmark,
that's the best one, since it probably matches modern
games more closely than the others.

3dmark2001 had a very good day
(http://kegel.com/wine/yagmarkdata/wine-1.1.44-19-vs-wine-1.1.44-72.txt)
but returned to its poor scores thereafter.   No idea why the
one-day blip.  (There was also an upward blip in heaven2_gl that day,
but it was quite small.)


From julliard at winehq.org  Wed May 19 09:59:36 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Wed, 19 May 2010 16:59:36 +0200
Subject: [PATCH 4/4] wininet: Fix variables values after redirection in
	HTTP_HttpSendRequestW
In-Reply-To: <4BF327EA.3000304@codeweavers.com> (Piotr Caban's message of
	"Wed, 19 May 2010 01:51:06 +0200")
References: <4BF327EA.3000304@codeweavers.com>
Message-ID: <87eih8vsx3.fsf@wine.dyndns.org>

Piotr Caban <piotr at codeweavers.com> writes:

> ---
>  dlls/wininet/http.c |    4 ++++
>  1 files changed, 4 insertions(+), 0 deletions(-)

It doesn't work here:

../../../tools/runtest -q -P wine -M wininet.dll -T ../../.. -p wininet_test.exe.so http.c && touch http.ok
http.c:405: Test failed: expected status 10 (INTERNET_STATUS_RESOLVING_NAME) 1 times, received 2 times
http.c:406: Test failed: expected status 11 (INTERNET_STATUS_NAME_RESOLVED) 1 times, received 2 times
make: *** [http.ok] Error 2

-- 
Alexandre Julliard
julliard at winehq.org


From scott at open-vote.org  Wed May 19 10:03:53 2010
From: scott at open-vote.org (Scott Ritchie)
Date: Wed, 19 May 2010 08:03:53 -0700
Subject: The WineHQ About page needs a picture
Message-ID: <4BF3FDD9.1060605@open-vote.org>

I was doing some housecleaning work looking at the WineHQ website, and I
realized we still have an awful lot of flat, wide text on the About
page.  This is the perfect place to collapse it into a column and fill
the right side of the screen with an image.

But...what image?

Thanks,
Scott Ritchie


From juan.lang at gmail.com  Wed May 19 10:10:59 2010
From: juan.lang at gmail.com (Juan Lang)
Date: Wed, 19 May 2010 08:10:59 -0700
Subject: wininet: Combine certificate errors in HTTP_OpenConnection
In-Reply-To: <4BF3D944.2020302@gmail.com>
References: <AANLkTiltQ9-3lLgS7znyOUQlsr0eERcU-bzN3gbe8QVx@mail.gmail.com>
	<4BF3D944.2020302@gmail.com>
Message-ID: <AANLkTinb-yuW-2sTPuT2pyQ7LEjx8pAMoV_tHZckj-oV@mail.gmail.com>

> I don't see a good reason for writing small http server in tests. It's a lot
> of work. Certificate verification errors can be checked in crypt32 tests, it
> can be done locally (there are already some tests).

The crypt32 tests don't demonstrate the change you're making.  wininet
(and winhttp) really need their own tests for how certificate failures
should be handled.  A local http server would be ideal, but I wasn't
asking for that:  I only asked for a single test certificate, as even
a single test would be useful, even if it doesn't provide much
coverage.  Right now, all certificates could be accepted or rejected,
and we wouldn't know until bug reports started coming in.
--Juan


From dgerard at gmail.com  Wed May 19 10:14:07 2010
From: dgerard at gmail.com (David Gerard)
Date: Wed, 19 May 2010 16:14:07 +0100
Subject: The WineHQ About page needs a picture
In-Reply-To: <4BF3FDD9.1060605@open-vote.org>
References: <4BF3FDD9.1060605@open-vote.org>
Message-ID: <AANLkTin6u0zKPwC87MOh4K0gfMr5dIPJ4vVFs6TYyiDy@mail.gmail.com>

On 19 May 2010 16:03, Scott Ritchie <scott at open-vote.org> wrote:

> I was doing some housecleaning work looking at the WineHQ website, and I
> realized we still have an awful lot of flat, wide text on the About
> page. ?This is the perfect place to collapse it into a column and fill
> the right side of the screen with an image.
> But...what image?


winecfg screenshot, "About" tab?


- d.


From hverbeet at gmail.com  Wed May 19 12:02:31 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Wed, 19 May 2010 19:02:31 +0200
Subject: [PATCH 0/7] wined3d: blit set_shader texture_target activation 
	cleanup
In-Reply-To: <AANLkTika6jPNKIeaBvfXAijZ8ShzBvDStu8vPERqV_Aq@mail.gmail.com>
References: <1274222326-6037-1-git-send-email-thunderbird2k@gmail.com>
	<C6F8F610-58ED-49BE-82AE-7B69BE469A4E@gmx.at>
	<AANLkTilTmzA0vrl3yssv5CN8oRbT9jVoFAAcUcfH1mJh@mail.gmail.com>
	<AANLkTika6jPNKIeaBvfXAijZ8ShzBvDStu8vPERqV_Aq@mail.gmail.com>
Message-ID: <AANLkTikiKyK8saEwXszjQvtZjTbDH9pm6HgA0YsKjtef@mail.gmail.com>

On 19 May 2010 14:46, Roderick Colenbrander <thunderbird2k at gmail.com> wrote:
>> The main issue I'm facing is p8 uploads which are completely broken
>> right now (a regression). At the beginning of the week I wanted to add
...
> What do you think?
>
Is there a bug report / demo application that clearly shows the
problem? Maybe I can give it a look.


From frank.richter at gmail.com  Wed May 19 12:04:12 2010
From: frank.richter at gmail.com (Frank Richter)
Date: Wed, 19 May 2010 19:04:12 +0200
Subject: The WineHQ About page needs a picture
In-Reply-To: <4BF3FDD9.1060605@open-vote.org>
References: <4BF3FDD9.1060605@open-vote.org>
Message-ID: <ht15mc$ril$1@dough.gmane.org>

On 19.05.2010 17:03, Scott Ritchie wrote:
> I was doing some housecleaning work looking at the WineHQ website, and I
> realized we still have an awful lot of flat, wide text on the About
> page.  This is the perfect place to collapse it into a column and fill
> the right side of the screen with an image.
> 
> But...what image?

wxwidgets.org shows a small, random screenshot on its front page...
could do the same for the about page?

Perhaps select some AppDB screenshots of ?interesting? apps (eg Office,
popular games) and rotate through them.

-f.r.



From thunderbird2k at gmail.com  Wed May 19 13:27:07 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Wed, 19 May 2010 20:27:07 +0200
Subject: [PATCH 0/7] wined3d: blit set_shader texture_target activation 
	cleanup
In-Reply-To: <AANLkTikiKyK8saEwXszjQvtZjTbDH9pm6HgA0YsKjtef@mail.gmail.com>
References: <1274222326-6037-1-git-send-email-thunderbird2k@gmail.com>
	<C6F8F610-58ED-49BE-82AE-7B69BE469A4E@gmx.at>
	<AANLkTilTmzA0vrl3yssv5CN8oRbT9jVoFAAcUcfH1mJh@mail.gmail.com>
	<AANLkTika6jPNKIeaBvfXAijZ8ShzBvDStu8vPERqV_Aq@mail.gmail.com>
	<AANLkTikiKyK8saEwXszjQvtZjTbDH9pm6HgA0YsKjtef@mail.gmail.com>
Message-ID: <AANLkTilSIG_6vi5HL4T_rErDRLfbVraTi49IXCjk04ML@mail.gmail.com>

On Wed, May 19, 2010 at 7:02 PM, Henri Verbeet <hverbeet at gmail.com> wrote:
> On 19 May 2010 14:46, Roderick Colenbrander <thunderbird2k at gmail.com> wrote:
>>> The main issue I'm facing is p8 uploads which are completely broken
>>> right now (a regression). At the beginning of the week I wanted to add
> ...
>> What do you think?
>>
> Is there a bug report / demo application that clearly shows the
> problem? Maybe I can give it a look.
>

The bug in question is and a test case is StarCraft:
http://bugs.winehq.org/show_bug.cgi?id=22575

I have made a draft patch (this would have to be cut in a lot of
pieces and changes a few more things than just the issue). It might be
an acceptable path.

The idea is to move the 'p8 texture format' to the formats table
including the case when no shaders/ext_paletted_texture is around
(this case needs to be added in some form anyway since fixup up an
empty format desc is not that nice). The format is overridden in case
of color keying / drawpixels. So at this stage the 'blit_supported' is
implicitly performed at formats table initialization. This might be
acceptable for now. At a later stage I can imagine that we want to ask
the 'blit_shader' for the format to use as that what this is basically
about.

If I add the 'converted p8' format to the formats table, I would still
have to return 'CONVERT_PALETTED' in d3dfmt_get_conv and somehow
inspect the format. The cleanest way (I could check conv_bytes) I
think is to add a flag WINED3DFMT_FLAG_CONVERTED. I want to set this
flag also for converted textures and thus checks like 'convert !=
NO_CONVERSION || desc.convert' can be adjusted as well and
d3dfmt_convert_surface is now a bit nicer as well.

Though not all parts might be needed right now, I think at least the
Flags changes are a step in the right direction. Is the 'p8 solution'
acceptable for now?

Roderick
-------------- next part --------------
A non-text attachment was scrubbed...
Name: p8.patch
Type: text/x-diff
Size: 14785 bytes
Desc: not available
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100519/a421f287/attachment.patch>

From saulius2 at ar.fi.lt  Wed May 19 15:22:07 2010
From: saulius2 at ar.fi.lt (Saulius Krasuckas)
Date: Wed, 19 May 2010 23:22:07 +0300 (EEST)
Subject: software built and worked under wine but not in vista?
In-Reply-To: <661512.55915.qm@web23106.mail.ird.yahoo.com>
References: <661512.55915.qm@web23106.mail.ird.yahoo.com>
Message-ID: <alpine.DEB.1.10.1005192306430.27321@localhost.localdomain>

I sorry for stepping into Alexandre's or Dmitry's shoes, but..

* On Tue, 18 May 2010, Hin-Tak Leung wrote:
> 
> So it seems that setupgs.exe is mis-compiled under wine with win7 sdk 
> but just happened to also work under wine. Any idea how it might happen? 

... there could be a pair of bugs: one in PE image manipulation functions 
plus another in Wine PE loading mechanism(s).

I could imagine the first easily inside a IMAGEHLP, eg. functions 
ImageAddCertificate() or CheckSumMappedFile().

If you find the first one, then it should be possible to write a test to 
reveal the second one.

> I have checked things like end-of-line, but it is curious why the 
> setupgs program works under wine but not in vista, the reverse situation 
> compared to most.

Could you build the same project under real Windows?

Then I would run "winedump dump -f" or even "-x" on both files to compare 
the outputs (probably line by line) and to find the essential difference.


S.


From htl10 at users.sourceforge.net  Wed May 19 16:55:52 2010
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Wed, 19 May 2010 21:55:52 +0000 (GMT)
Subject: software built and worked under wine but not in vista?
In-Reply-To: <alpine.DEB.1.10.1005192306430.27321@localhost.localdomain>
Message-ID: <348859.96616.qm@web23103.mail.ird.yahoo.com>

--- On Wed, 19/5/10, Saulius Krasuckas <saulius2 at ar.fi.lt> wrote:

> I sorry for stepping into Alexandre's
> or Dmitry's shoes, but..
> 
> * On Tue, 18 May 2010, Hin-Tak Leung wrote:
> > 
> > So it seems that setupgs.exe is mis-compiled under
> wine with win7 sdk 
> > but just happened to also work under wine. Any idea
> how it might happen? 
> 
> ... there could be a pair of bugs: one in PE image
> manipulation functions 
> plus another in Wine PE loading mechanism(s).
> 
> I could imagine the first easily inside a IMAGEHLP, eg.
> functions 
> ImageAddCertificate() or CheckSumMappedFile().
> 
> If you find the first one, then it should be possible to
> write a test to 
> reveal the second one.
> 
> > I have checked things like end-of-line, but it is
> curious why the 
> > setupgs program works under wine but not in vista, the
> reverse situation 
> > compared to most.
> 
> Could you build the same project under real Windows?
> 
> Then I would run "winedump dump -f" or even "-x" on both
> files to compare 
> the outputs (probably line by line) and to find the
> essential difference.

I am thinking of doing it under real windows. I built it twice under wine and the binaries are identical except for 6 bytes (probably date stamps), so if I build the same snapshot with the same compiler under Vista and the same build procedure, I would expect the the result would be similiarly differ by 6 bytes only, if the compiler/wine works the same way as compiler/vista.

I'll try it now and see how it goes.


      


From testbot at testbot.winehq.org  Wed May 19 18:23:24 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Thu, 20 May 2010 01:23:24 +0200
Subject: quartz: Avoid using the long type. 
Message-ID: <201005192323.o4JNNOF4009458@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2159

Your paranoid android.


=== WNT4WSSP6 (32 bit referenceclock) ===
referenceclock.c:99: Test failed: Unable to create reference clock from system clock 80040154


From testbot at testbot.winehq.org  Wed May 19 19:22:37 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Thu, 20 May 2010 02:22:37 +0200
Subject: comctl32/listview: Don't forward WM_COMMAND to parent if we don't
	have an Edit box 
Message-ID: <201005200022.o4K0Mbhb011006@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2163

Your paranoid android.


=== W7PRO (32 bit listview) ===
listview.c:4393: Test failed: NM_HOVER allow test: the msg sequence is not complete: expected 0087 - actual 0000
listview.c:4398: Test failed: NM_HOVER block test: the msg sequence is not complete: expected 0087 - actual 0000


From dank at kegel.com  Wed May 19 19:41:52 2010
From: dank at kegel.com (Dan Kegel)
Date: Wed, 19 May 2010 17:41:52 -0700
Subject: performance bot results - this time with screensaver off
Message-ID: <AANLkTimm53CuV8Cr1Wy1solo7mda6S-8un8Jh8XMyNa8@mail.gmail.com>

Every benchmark did at least a little better, and 3dmark2001 did a lot
better, today:
http://kegel.com/wine/yagmarkdata/E8400-GT_220-Ubuntu_10.04_LTS-e8400-wine-1.1.44-322.html

Why?  Well, there are oodles of processes running in Gnome by default,
plus the workrave app I use for my RSI.  I had killed some of
them on the benchmark machine earlier, but forgot to kill
them again after rebooting; just noticed that last night.  Today's
results are with three more processes killed: workrave,
gnome-screensaver, and bluetooth-applet.
That might help explain the results a bit.

I did 'sudo apt-get install xubuntu-desktop' just now, rebooted,
edited ~/.pulse/client.conf to disable pulseaudio autospawn,
and killed
pulseaudio xscreensaver update-notifier
/usr/share/system-config-printer/applet.py
/usr/lib/gvfs//gvfs-fuse-daemon bluetooth-applet
There are now 'only' 148 or so processes in my idle system, only 29 of which
are the interactive user; it seems fairly stripped down.
I also ran nvidia-settings again to pick 'maximum performance' rather
than adaptive,
and told xfce to never blank the monitor.  Let's see if all that makes
a difference.
(I need to make a big checklist of Things To Do After Rebooting.)
- Dan


From paul.vriens.wine at gmail.com  Thu May 20 00:55:06 2010
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 20 May 2010 07:55:06 +0200
Subject: msi: Avoid a potential NULL pointer dereference (coccicheck).
In-Reply-To: <20100519231546.GE15805@redhat.com>
References: <20100519231546.GE15805@redhat.com>
Message-ID: <4BF4CEBA.9090501@gmail.com>

On 05/20/2010 01:15 AM, Michael Stefaniuc wrote:
> The last "goto done" is for si == NULL. When MSI_GetSummaryInformationW
> returns NULL there is a crash.
> ---
>   dlls/msi/msi.c |    3 ++-
>   1 files changed, 2 insertions(+), 1 deletions(-)
>
> diff --git a/dlls/msi/msi.c b/dlls/msi/msi.c
> index 3170e6d..9c08d1b 100644
> --- a/dlls/msi/msi.c
> +++ b/dlls/msi/msi.c
> @@ -551,7 +551,8 @@ static UINT MSI_ApplicablePatchW( MSIPACKAGE *package, LPCWSTR patch )
>
>   done:
>       msiobj_release(&patch_db->hdr );
> -    msiobj_release(&si->hdr );
> +    if (si)
> +        msiobj_release(&si->hdr );
>       return r;
>   }
>

Hi Michael,

This one is mentioned by Coverity (#970). Marcus marked this one as 
'FALSE' with the remark:

"hdr is at position 0, so this will be NULL and msiobj_release handles it."

Thoughts?

-- 
Cheers,

Paul.


From paul.vriens.wine at gmail.com  Thu May 20 01:04:02 2010
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 20 May 2010 08:04:02 +0200
Subject: msi: Avoid a potential NULL pointer dereference (coccicheck).
In-Reply-To: <4BF4CEBA.9090501@gmail.com>
References: <20100519231546.GE15805@redhat.com> <4BF4CEBA.9090501@gmail.com>
Message-ID: <4BF4D0D2.2010508@gmail.com>

On 05/20/2010 07:55 AM, Paul Vriens wrote:
> On 05/20/2010 01:15 AM, Michael Stefaniuc wrote:
>> The last "goto done" is for si == NULL. When MSI_GetSummaryInformationW
>> returns NULL there is a crash.
>> ---
>> dlls/msi/msi.c | 3 ++-
>> 1 files changed, 2 insertions(+), 1 deletions(-)
>>
>> diff --git a/dlls/msi/msi.c b/dlls/msi/msi.c
>> index 3170e6d..9c08d1b 100644
>> --- a/dlls/msi/msi.c
>> +++ b/dlls/msi/msi.c
>> @@ -551,7 +551,8 @@ static UINT MSI_ApplicablePatchW( MSIPACKAGE
>> *package, LPCWSTR patch )
>>
>> done:
>> msiobj_release(&patch_db->hdr );
>> - msiobj_release(&si->hdr );
>> + if (si)
>> + msiobj_release(&si->hdr );
>> return r;
>> }
>>
>
> Hi Michael,
>
> This one is mentioned by Coverity (#970). Marcus marked this one as
> 'FALSE' with the remark:
>
> "hdr is at position 0, so this will be NULL and msiobj_release handles it."
>
> Thoughts?
>

The main reason I'm asking is because we have several of these lingering 
around (and marked as 'FALSE' in Coverity).

-- 
Cheers,

Paul.


From hans at codeweavers.com  Thu May 20 03:00:35 2010
From: hans at codeweavers.com (Hans Leidekker)
Date: Thu, 20 May 2010 10:00:35 +0200
Subject: msi: Avoid a potential NULL pointer dereference (coccicheck).
In-Reply-To: <4BF4D0D2.2010508@gmail.com>
References: <20100519231546.GE15805@redhat.com> <4BF4CEBA.9090501@gmail.com>
	<4BF4D0D2.2010508@gmail.com>
Message-ID: <1274342435.8874.10.camel@t400>

On Thu, 2010-05-20 at 08:04 +0200, Paul Vriens wrote:

> The main reason I'm asking is because we have several of these lingering 
> around (and marked as 'FALSE' in Coverity).

In this particular case we should just get rid of the goto.




From nsivov at codeweavers.com  Thu May 20 03:00:52 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Thu, 20 May 2010 12:00:52 +0400
Subject: comctl32/listview: Don't forward WM_COMMAND to parent if we don't
	have an Edit box
In-Reply-To: <201005200022.o4K0Mbhb011006@v1.gse.nl>
References: <201005200022.o4K0Mbhb011006@v1.gse.nl>
Message-ID: <4BF4EC34.2090008@codeweavers.com>

On 5/20/2010 04:22,  (Marvin) wrote:
> Hi,
>
> While running your changed tests on Windows, I think I found new failures.
> Being a bot and all I'm not very good at pattern recognition, so I might be
> wrong, but could you please double-check?
> Full results can be found at
> http://testbot.winehq.org/JobDetails.pl?Key=2163
>
> Your paranoid android.
>
>
> === W7PRO (32 bit listview) ===
> listview.c:4393: Test failed: NM_HOVER allow test: the msg sequence is not complete: expected 0087 - actual 0000
> listview.c:4398: Test failed: NM_HOVER block test: the msg sequence is not complete: expected 0087 - actual 0000
>
>    
This is unrelated to a patch and a kind of intermittent failures. I ran 
it again manually and it works fine:

https://testbot.winehq.org/JobDetails.pl?Key=2192


From paul.vriens.wine at gmail.com  Thu May 20 03:03:50 2010
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Thu, 20 May 2010 10:03:50 +0200
Subject: msi: Avoid a potential NULL pointer dereference (coccicheck).
In-Reply-To: <1274342435.8874.10.camel@t400>
References: <20100519231546.GE15805@redhat.com> <4BF4CEBA.9090501@gmail.com>	
	<4BF4D0D2.2010508@gmail.com> <1274342435.8874.10.camel@t400>
Message-ID: <4BF4ECE6.7010106@gmail.com>

On 05/20/2010 10:00 AM, Hans Leidekker wrote:
> On Thu, 2010-05-20 at 08:04 +0200, Paul Vriens wrote:
>
>> The main reason I'm asking is because we have several of these lingering
>> around (and marked as 'FALSE' in Coverity).
>
> In this particular case we should just get rid of the goto.
>
>
But is it a (potential) issue? I guess not. If it's not an issue wee can 
leave the code as is, not?

-- 
Cheers,

Paul.


From mstefani at redhat.com  Thu May 20 04:08:01 2010
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 20 May 2010 11:08:01 +0200
Subject: quartz: Avoid using the long type.
In-Reply-To: <201005192323.o4JNNOF4009458@v1.gse.nl>
References: <201005192323.o4JNNOF4009458@v1.gse.nl>
Message-ID: <4BF4FBF1.2080004@redhat.com>

 (Marvin) wrote:
> While running your changed tests on Windows, I think I found new failures.
> Being a bot and all I'm not very good at pattern recognition, so I might be
> wrong, but could you please double-check?
Double checked and Marvin is wrong.

> Full results can be found at
> http://testbot.winehq.org/JobDetails.pl?Key=2159
> 
> Your paranoid android.
> 
> 
> === WNT4WSSP6 (32 bit referenceclock) ===
> referenceclock.c:99: Test failed: Unable to create reference clock from system clock 80040154
The failure is in test_IReferenceClock_SystemClock() but my patch
modifies test_IReferenceClock_methods(). And even there it is only used
in an ok() call.

bye
	michael


From testbot at testbot.winehq.org  Thu May 20 04:04:41 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Thu, 20 May 2010 11:04:41 +0200
Subject: winmm: Have MCI drivers handle notification for MCI_OPEN. 
Message-ID: <201005200904.o4K94fam004519@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2193

Your paranoid android.


=== W98SE (32 bit mci) ===
mci.c:613: Test failed: Expect message 0001 from play to 250 wait notify
mci.c:620: Test failed: got 0004 instead of MCI_NOTIFY_xyz 0000 from command after close
mci.c:784: Test failed: mci pause wait returned MMSYSERR 5
mci.c:798: Test failed: mci pause (space) wait returned MMSYSERR 5
mci.c:801: Test failed: mci pause wait returned MMSYSERR 5
mci.c:815: Test failed: Expect message 0004 from play (aborted by close)


From Joerg-Cyril.Hoehle at t-systems.com  Thu May 20 04:27:12 2010
From: Joerg-Cyril.Hoehle at t-systems.com (Joerg-Cyril.Hoehle at t-systems.com)
Date: Thu, 20 May 2010 11:27:12 +0200
Subject: winmm: Have MCI drivers handle notification for MCI_OPEN. 
References: <201005200904.o4K94fam004519@v1.gse.nl>
Message-ID: <47CC5ABB01651443A88DB8EC5B4D657B74037F@S4DE8PSAANK.mitte.t-com.de>

Hi,

>http://testbot.winehq.org/JobDetails.pl?Key=2193
>While running your changed tests on Windows, I think I found new failures.

These are among the known set of 7 flaky tests (in vmware only?), e.g. see
http://test.winehq.org/data/f00d44f0f63a66b9157ff7334f6b54c8b079c1ee/98_wtb-w98se/winmm:mci.html

while on the next day, everything succeeds:
http://test.winehq.org/data/658209b57164da96919500468114a6a7eb0bf7b5/98_wtb-w98se/winmm:mci.html

Regards,
 J?rg H?hle



From hans at codeweavers.com  Thu May 20 05:04:31 2010
From: hans at codeweavers.com (Hans Leidekker)
Date: Thu, 20 May 2010 12:04:31 +0200
Subject: msi: Avoid a potential NULL pointer dereference (coccicheck).
In-Reply-To: <4BF4ECE6.7010106@gmail.com>
References: <20100519231546.GE15805@redhat.com> <4BF4CEBA.9090501@gmail.com>
	<4BF4D0D2.2010508@gmail.com> <1274342435.8874.10.camel@t400>
	<4BF4ECE6.7010106@gmail.com>
Message-ID: <1274349871.8874.214.camel@t400>

On Thu, 2010-05-20 at 10:03 +0200, Paul Vriens wrote:

> >> The main reason I'm asking is because we have several of these lingering
> >> around (and marked as 'FALSE' in Coverity).
> >
> > In this particular case we should just get rid of the goto.
> >
> >
> But is it a (potential) issue? I guess not. If it's not an issue wee can 
> leave the code as is, not?

It's a header construction where you typically exploit the fact that the
header and extended structure start at the same address. So yes, we
could leave the code as is.




From hintak_leung at yahoo.co.uk  Wed May 19 20:54:40 2010
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Thu, 20 May 2010 02:54:40 +0100
Subject: software built and worked under wine but not in vista?
In-Reply-To: <alpine.DEB.1.10.1005192306430.27321@localhost.localdomain>
References: <661512.55915.qm@web23106.mail.ird.yahoo.com>
	<alpine.DEB.1.10.1005192306430.27321@localhost.localdomain>
Message-ID: <4BF49660.7090409@yahoo.co.uk>

Saulius Krasuckas wrote:
> I sorry for stepping into Alexandre's or Dmitry's shoes, but..
> 
> * On Tue, 18 May 2010, Hin-Tak Leung wrote:
>> So it seems that setupgs.exe is mis-compiled under wine with win7 sdk 
>> but just happened to also work under wine. Any idea how it might happen? 
> 
> ... there could be a pair of bugs: one in PE image manipulation functions 
> plus another in Wine PE loading mechanism(s).
> 
> I could imagine the first easily inside a IMAGEHLP, eg. functions 
> ImageAddCertificate() or CheckSumMappedFile().
> 
> If you find the first one, then it should be possible to write a test to 
> reveal the second one.
> 
>> I have checked things like end-of-line, but it is curious why the 
>> setupgs program works under wine but not in vista, the reverse situation 
>> compared to most.
> 
> Could you build the same project under real Windows?
> 
> Then I would run "winedump dump -f" or even "-x" on both files to compare 
> the outputs (probably line by line) and to find the essential difference.

I have gone ahead and done exactly that - the correct behavior should be a msg 
box saying filelist.txt is missing, rather than setupgs.exe not a valid win32 
application.

http://www.ghostscript.com/~hintak/setupgs-vista.exe
http://www.ghostscript.com/~hintak/setupgs-wine.exe

I haven't tried the uninstaller yet, so I don't know if the wine-built 
uninstaller work:

http://www.ghostscript.com/~hintak/uninstgs-vista.exe
http://www.ghostscript.com/~hintak/uninstgs-wine.exe

To analyse the executables are a bit beyond me, but I hope somebody can do that.

under either system, if I compile the file twice quickly, the result differs 
only by the datestamp and checksum (and in two wine-compiled executable built a 
bit of time between , also a few bytes in the .text section after what looks 
like an import table in a hex editor?


From david.adam.cnrs at gmail.com  Thu May 20 01:49:48 2010
From: david.adam.cnrs at gmail.com (David Adam)
Date: Thu, 20 May 2010 08:49:48 +0200
Subject: dinput2
Message-ID: <AANLkTimmwRdoXZarvf195ilxuJSxUxG5Tb5Rbm2wM4DQ@mail.gmail.com>

Hello

many distro ship the X-server with dinput2. More and more old games work
pretty well now with Wine, but the mouse. Does anyone plan to work on the
infamous bug 6971?
It would be great if it could be implemented for the official release of
Wine. It would do a big buzz :D

Cheers

David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100520/c5ea9c25/attachment.htm>

From david.adam.cnrs at gmail.com  Thu May 20 01:53:52 2010
From: david.adam.cnrs at gmail.com (David Adam)
Date: Thu, 20 May 2010 08:53:52 +0200
Subject: D3DX9: how to implement D3DXDeclaratorFromFVF
Message-ID: <AANLkTilnMZEdptUTyNIcvPz1MIR9Y_p3-_Com4tI5mc2@mail.gmail.com>

Hello,

I would like to implement the function D3DXDeclaratorFromFVF. My numerous
attempts to do this were rejected (specially my copy/paste of the function
vdecl_convert_fvf from d3d9/vertexdeclaration.c.

Does anyone know a way to implement it?

Thanks in advance

David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100520/0efd942c/attachment.htm>

From jacek at codeweavers.com  Thu May 20 05:21:20 2010
From: jacek at codeweavers.com (Jacek Caban)
Date: Thu, 20 May 2010 12:21:20 +0200
Subject: [TRY 2] shdocvw: Added IOleLink stub implementation.
In-Reply-To: <201005201133.14936.shpigor@etersoft.ru>
References: <201005201133.14936.shpigor@etersoft.ru>
Message-ID: <4BF50D20.8060805@codeweavers.com>

On 5/20/10 9:33 AM, Ilya Shpigor wrote:

+void WebBrowser_OleLink_Init(WebBrowser *This)
+{
+    This->lpOleLinkVtbl =&OleLinkVtbl;
+}


You don't need a separated function for that. Just use 
WebBrowser_OleObject_Init.

Jacek


From testbot at testbot.winehq.org  Thu May 20 05:24:14 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Thu, 20 May 2010 12:24:14 +0200
Subject: [6/7] msi: Test the reference count on the installer object
	retrieved from a session object. 
Message-ID: <201005201024.o4KAOEWG006433@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2195

Your paranoid android.


=== W7PROX64 (64 bit automation) ===
automation.c:2468: Test failed: Expected imaname, got 
automation.c:2485: Test failed: Expected imaname, got 


From mstefani at redhat.com  Thu May 20 05:36:21 2010
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 20 May 2010 12:36:21 +0200
Subject: msi: Avoid a potential NULL pointer dereference (coccicheck).
In-Reply-To: <4BF4CEBA.9090501@gmail.com>
References: <20100519231546.GE15805@redhat.com> <4BF4CEBA.9090501@gmail.com>
Message-ID: <4BF510A5.7050901@redhat.com>

Paul Vriens wrote:
> On 05/20/2010 01:15 AM, Michael Stefaniuc wrote:
>> The last "goto done" is for si == NULL. When MSI_GetSummaryInformationW
>> returns NULL there is a crash.
>> ---
>>   dlls/msi/msi.c |    3 ++-
>>   1 files changed, 2 insertions(+), 1 deletions(-)
>>
>> diff --git a/dlls/msi/msi.c b/dlls/msi/msi.c
>> index 3170e6d..9c08d1b 100644
>> --- a/dlls/msi/msi.c
>> +++ b/dlls/msi/msi.c
>> @@ -551,7 +551,8 @@ static UINT MSI_ApplicablePatchW( MSIPACKAGE
>> *package, LPCWSTR patch )
>>
>>   done:
>>       msiobj_release(&patch_db->hdr );
>> -    msiobj_release(&si->hdr );
>> +    if (si)
>> +        msiobj_release(&si->hdr );
>>       return r;
>>   }
>>
> 
> Hi Michael,
> 
> This one is mentioned by Coverity (#970). Marcus marked this one as
> 'FALSE' with the remark:
> 
> "hdr is at position 0, so this will be NULL and msiobj_release handles it."
> 
> Thoughts?

Do the compilers treat the addressof operator on the struct member as
  si + FIELD_OFFSET(MSISUMMARYINFO, hdr)
?
Then yes, no dereference happens and the result of the above calculation
is NULL which is fine as input for msiobj_release().

bye
	michael


From testbot at testbot.winehq.org  Thu May 20 05:46:12 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Thu, 20 May 2010 12:46:12 +0200
Subject: [7/7] msi: Add more tests for feature overrides. 
Message-ID: <201005201046.o4KAkCom006972@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2196

Your paranoid android.


=== W2K8SE (32 bit install) ===
Timeout

=== W7PROX64 (32 bit install) ===
install.c:5350: Test failed: Expected "C:\Program Files (x86)\msitest\maximus", got "Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Products\84A88FD7F6998CE40A22FB59F6B9C2BB\InstallProperties"
install.c:5369: Test failed: Expected "01\msitest\augustus", got "Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Products\84A88FD7F6998CE40A22FB59F6B9C2BB\InstallProperties"
install.c:5394: Test failed: Expected "C:\Program Files (x86)\msitest\maximus", got "Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Products\84A88FD7F6998CE40A22FB59F6B9C2BB\InstallProperties"
install.c:5413: Test failed: Expected "01\msitest\augustus", got "Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Products\84A88FD7F6998CE40A22FB59F6B9C2BB\InstallProperties"

=== W7PROX64 (64 bit install) ===
install.c:8203: Test failed: RegQueryValueExA failed 2 (0)
install.c:8466: Test failed: file not installed
install.c:8478: Test failed: file not installed
install.c:8479: Test failed: file not installed
install.c:8487: Test failed: file removed
install.c:8488: Test failed: directory removed
install.c:8494: Test failed: file not installed
install.c:8495: Test failed: file not installed
install.c:8503: Test failed: file removed
install.c:8504: Test failed: directory removed
install.c:8892: Test failed: file not created
install.c:8893: Test failed: file not created
install.c:8959: Test failed: file not created
install.c:8960: Test failed: file not created
install.c:8962: Test failed: file not created
install.c:8968: Test failed: file removed
install.c:8973: Test failed: directory removed
install.c:9020: Test failed: key not removed
install.c:9030: Test failed: key not removed
install.c:9041: Test failed: key not removed
install.c:9115: Test failed: got 6 expected 0
install.c:9121: Test failed: got 6 expected 0
install.c:9124: Test failed: got 6 expected 0
install.c:9126: Test failed: file removed
install.c:9271: Test failed: key not created


From mstefani at redhat.com  Thu May 20 05:49:21 2010
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Thu, 20 May 2010 12:49:21 +0200
Subject: msi: Avoid a potential NULL pointer dereference (coccicheck).
In-Reply-To: <1274349871.8874.214.camel@t400>
References: <20100519231546.GE15805@redhat.com>
	<4BF4CEBA.9090501@gmail.com>	<4BF4D0D2.2010508@gmail.com>
	<1274342435.8874.10.camel@t400>	<4BF4ECE6.7010106@gmail.com>
	<1274349871.8874.214.camel@t400>
Message-ID: <4BF513B1.1050705@redhat.com>

Hans Leidekker wrote:
> On Thu, 2010-05-20 at 10:03 +0200, Paul Vriens wrote:
> 
>>>> The main reason I'm asking is because we have several of these lingering
>>>> around (and marked as 'FALSE' in Coverity).
>>> In this particular case we should just get rid of the goto.
>>>
>>>
>> But is it a (potential) issue? I guess not. If it's not an issue wee can 
>> leave the code as is, not?
> 
> It's a header construction where you typically exploit the fact that the
> header and extended structure start at the same address. So yes, we
> could leave the code as is.
"exploit" doesn't sound like a clean approach to me. The compiler does
the right thing here but there is quite some effort involved for a human
reader to validate that. The reports of good static analyze tools should
more like a hint "there is a problem around that code" and the problem
doesn't have to be the exact same thing the tool actually reported.

bye
	michael


From meissner at suse.de  Thu May 20 06:19:10 2010
From: meissner at suse.de (Marcus Meissner)
Date: Thu, 20 May 2010 13:19:10 +0200
Subject: msi: Avoid a potential NULL pointer dereference (coccicheck).
In-Reply-To: <4BF510A5.7050901@redhat.com>
References: <20100519231546.GE15805@redhat.com> <4BF4CEBA.9090501@gmail.com>
	<4BF510A5.7050901@redhat.com>
Message-ID: <20100520111907.GA4503@suse.de>

On Thu, May 20, 2010 at 12:36:21PM +0200, Michael Stefaniuc wrote:
> Paul Vriens wrote:
> > On 05/20/2010 01:15 AM, Michael Stefaniuc wrote:
> >> The last "goto done" is for si == NULL. When MSI_GetSummaryInformationW
> >> returns NULL there is a crash.
> >> ---
> >>   dlls/msi/msi.c |    3 ++-
> >>   1 files changed, 2 insertions(+), 1 deletions(-)
> >>
> >> diff --git a/dlls/msi/msi.c b/dlls/msi/msi.c
> >> index 3170e6d..9c08d1b 100644
> >> --- a/dlls/msi/msi.c
> >> +++ b/dlls/msi/msi.c
> >> @@ -551,7 +551,8 @@ static UINT MSI_ApplicablePatchW( MSIPACKAGE
> >> *package, LPCWSTR patch )
> >>
> >>   done:
> >>       msiobj_release(&patch_db->hdr );
> >> -    msiobj_release(&si->hdr );
> >> +    if (si)
> >> +        msiobj_release(&si->hdr );
> >>       return r;
> >>   }
> >>
> > 
> > Hi Michael,
> > 
> > This one is mentioned by Coverity (#970). Marcus marked this one as
> > 'FALSE' with the remark:
> > 
> > "hdr is at position 0, so this will be NULL and msiobj_release handles it."
> > 
> > Thoughts?
> 
> Do the compilers treat the addressof operator on the struct member as
>   si + FIELD_OFFSET(MSISUMMARYINFO, hdr)
> ?
> Then yes, no dereference happens and the result of the above calculation
> is NULL which is fine as input for msiobj_release().

Yes, they do.

Ciao, Marcus


From hans at codeweavers.com  Thu May 20 06:37:54 2010
From: hans at codeweavers.com (Hans Leidekker)
Date: Thu, 20 May 2010 13:37:54 +0200
Subject: msi: Avoid a potential NULL pointer dereference (coccicheck).
In-Reply-To: <4BF513B1.1050705@redhat.com>
References: <20100519231546.GE15805@redhat.com> <4BF4CEBA.9090501@gmail.com>
	<4BF4D0D2.2010508@gmail.com> <1274342435.8874.10.camel@t400>
	<4BF4ECE6.7010106@gmail.com> <1274349871.8874.214.camel@t400>
	<4BF513B1.1050705@redhat.com>
Message-ID: <1274355474.8874.256.camel@t400>

On Thu, 2010-05-20 at 12:49 +0200, Michael Stefaniuc wrote:

> > It's a header construction where you typically exploit the fact that the
> > header and extended structure start at the same address. So yes, we
> > could leave the code as is.
> "exploit" doesn't sound like a clean approach to me. The compiler does
> the right thing here but there is quite some effort involved for a human
> reader to validate that. The reports of good static analyze tools should
> more like a hint "there is a problem around that code" and the problem
> doesn't have to be the exact same thing the tool actually reported.

Yes, that's why removing the goto is the better solution here, because
it simply avoids that case.




From tijnema at gmail.com  Thu May 20 07:15:43 2010
From: tijnema at gmail.com (Matijn Woudt)
Date: Thu, 20 May 2010 14:15:43 +0200
Subject: software built and worked under wine but not in vista?
In-Reply-To: <4BF49660.7090409@yahoo.co.uk>
References: <661512.55915.qm@web23106.mail.ird.yahoo.com>
	<alpine.DEB.1.10.1005192306430.27321@localhost.localdomain>
	<4BF49660.7090409@yahoo.co.uk>
Message-ID: <AANLkTilLBQDoYZOOxIURP_VNjXLSeUqmnxtafSV2WS8B@mail.gmail.com>

On Thu, May 20, 2010 at 3:54 AM, Hin-Tak Leung <hintak_leung at yahoo.co.uk> wrote:
> Saulius Krasuckas wrote:
>>
>> I sorry for stepping into Alexandre's or Dmitry's shoes, but..
>>
>> * On Tue, 18 May 2010, Hin-Tak Leung wrote:
>>>
>>> So it seems that setupgs.exe is mis-compiled under wine with win7 sdk but
>>> just happened to also work under wine. Any idea how it might happen?
>>
>> ... there could be a pair of bugs: one in PE image manipulation functions
>> plus another in Wine PE loading mechanism(s).
>>
>> I could imagine the first easily inside a IMAGEHLP, eg. functions
>> ImageAddCertificate() or CheckSumMappedFile().
>>
>> If you find the first one, then it should be possible to write a test to
>> reveal the second one.
>>
>>> I have checked things like end-of-line, but it is curious why the setupgs
>>> program works under wine but not in vista, the reverse situation compared to
>>> most.
>>
>> Could you build the same project under real Windows?
>>
>> Then I would run "winedump dump -f" or even "-x" on both files to compare
>> the outputs (probably line by line) and to find the essential difference.
>
> I have gone ahead and done exactly that - the correct behavior should be a
> msg box saying filelist.txt is missing, rather than setupgs.exe not a valid
> win32 application.
>
> http://www.ghostscript.com/~hintak/setupgs-vista.exe
> http://www.ghostscript.com/~hintak/setupgs-wine.exe
>
> I haven't tried the uninstaller yet, so I don't know if the wine-built
> uninstaller work:
>
> http://www.ghostscript.com/~hintak/uninstgs-vista.exe
> http://www.ghostscript.com/~hintak/uninstgs-wine.exe
>
> To analyse the executables are a bit beyond me, but I hope somebody can do
> that.
>
> under either system, if I compile the file twice quickly, the result differs
> only by the datestamp and checksum (and in two wine-compiled executable
> built a bit of time between , also a few bytes in the .text section after
> what looks like an import table in a hex editor?
>
>

There are a few differences I spotted between the two executables:
1) setupgs-wine.exe has wrong image size, changing it from 0x2b200 to
0x2b000 makes the executable working under win7.
2) setupgs-wine.exe has wrong resource size, probably related to 1),
because the size of both executables are the same.
3) The assembly in setupgs-wine.exe has only LF line endings, vista
has CRLF. This explains 2).

I don't know the reason for 3), I assume it's a bug somewhere in wine.


From Joerg-Cyril.Hoehle at t-systems.com  Thu May 20 09:36:05 2010
From: Joerg-Cyril.Hoehle at t-systems.com (Joerg-Cyril.Hoehle at t-systems.com)
Date: Thu, 20 May 2010 16:36:05 +0200
Subject: winecfg audio tab contents
References: <47CC5ABB01651443A88DB8EC5B4D657B74037A@S4DE8PSAANK.mitte.t-com.de>
	<4BF299E6.1020000@gmail.com>
Message-ID: <47CC5ABB01651443A88DB8EC5B4D657B740381@S4DE8PSAANK.mitte.t-com.de>

Hi,

Maarten Lankhorst wrote:
>After 1.2 is shipped the audio tab will be all gone anyhow. :)
You wrote "After" and not "With/when". Experience with 1.0 is that
it's used even nowadays by some, so we can assume the same with 1.2.
Therefore, the audio tab ought to work in 1.2 even if 1.3
switches to OpenAL the week after the 1.2 release.

>+ if (wodMessagePtr && wodMessagePtr(0, DRVM_INIT, 0, 0, 0))
When I'll be back on the Mac next week, I'll test whether your
suggestion perhaps (hopefully) makes bug #14052 go away.

Regards,
 J?rg H?hle


From julliard at winehq.org  Thu May 20 09:51:08 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Thu, 20 May 2010 16:51:08 +0200
Subject: [3/9] ole32: Validate pointer parameters in MkParseDisplayName.
In-Reply-To: <4BF4ABCF.1010003@codeweavers.com> (Andrew Nguyen's message of
	"Wed, 19 May 2010 22:26:07 -0500")
References: <4BF4ABCF.1010003@codeweavers.com>
Message-ID: <87zkzuvd7n.fsf@wine.dyndns.org>

Andrew Nguyen <anguyen at codeweavers.com> writes:

> @@ -814,12 +814,53 @@ static void test_MkParseDisplayName(void)
>      static const WCHAR wszDisplayNameProgId1[] = {'S','t','d','F','o','n','t',':',0};
>      static const WCHAR wszDisplayNameProgId2[] = {'@','S','t','d','F','o','n','t',0};
>      static const WCHAR wszDisplayNameProgIdFail[] = {'S','t','d','F','o','n','t',0};
> +    static const WCHAR wszEmpty[] = {0};
>      char szDisplayNameFile[256];
>      WCHAR wszDisplayNameFile[256];
> +    int i;
> +
> +    const struct
> +    {
> +        LPBC pbc;
> +        LPCOLESTR szDisplayName;
> +        LPDWORD pchEaten;
> +        LPMONIKER *ppmk;
> +    } invalid_parameters[] =
> +    {
> +        {NULL, NULL,     NULL,   NULL},
> +        {NULL, NULL,     NULL,   &pmk},
> +        {NULL, NULL,     &eaten, NULL},
> +        {NULL, NULL,     &eaten, &pmk},
> +        {NULL, wszEmpty, NULL,   NULL},
> +        {NULL, wszEmpty, NULL,   &pmk},
> +        {NULL, wszEmpty, &eaten, NULL},
> +        {NULL, wszEmpty, &eaten, &pmk},
> +        {pbc,  NULL,     NULL,   NULL},
> +        {pbc,  NULL,     NULL,   &pmk},
> +        {pbc,  NULL,     &eaten, NULL},
> +        {pbc,  NULL,     &eaten, &pmk},
> +        {pbc,  wszEmpty, NULL,   NULL},
> +        {pbc,  wszEmpty, NULL,   &pmk},
> +        {pbc,  wszEmpty, &eaten, NULL},
> +        {pbc,  wszEmpty, &eaten, &pmk},
> +    };

This won't do what you want, there's nothing in pbc at this point.

-- 
Alexandre Julliard
julliard at winehq.org


From austinenglish at gmail.com  Thu May 20 11:07:03 2010
From: austinenglish at gmail.com (Austin English)
Date: Thu, 20 May 2010 11:07:03 -0500
Subject: dinput2
In-Reply-To: <AANLkTimmwRdoXZarvf195ilxuJSxUxG5Tb5Rbm2wM4DQ@mail.gmail.com>
References: <AANLkTimmwRdoXZarvf195ilxuJSxUxG5Tb5Rbm2wM4DQ@mail.gmail.com>
Message-ID: <AANLkTilllqWXs4gPLwo0q-TOn3conM_NQjFKKbWTpQaI@mail.gmail.com>

On Thu, May 20, 2010 at 1:49 AM, David Adam <david.adam.cnrs at gmail.com> wrote:
> Hello
>
> many distro ship the X-server with dinput2. More and more old games work
> pretty well now with Wine, but the mouse. Does anyone plan to work on the
> infamous bug 6971?
> It would be great if it could be implemented for the official release of
> Wine. It would do a big buzz :D

Considering the code freeze starts tomorrow, I doubt a major
architectural change will go in at this point, even if it could be
written in time.

-- 
-Austin


From saulius2 at ar.fi.lt  Thu May 20 13:51:18 2010
From: saulius2 at ar.fi.lt (Saulius Krasuckas)
Date: Thu, 20 May 2010 21:51:18 +0300 (EEST)
Subject: software built and worked under wine but not in vista?
In-Reply-To: <AANLkTilLBQDoYZOOxIURP_VNjXLSeUqmnxtafSV2WS8B@mail.gmail.com>
References: <661512.55915.qm@web23106.mail.ird.yahoo.com>
	<alpine.DEB.1.10.1005192306430.27321@localhost.localdomain>
	<4BF49660.7090409@yahoo.co.uk>
	<AANLkTilLBQDoYZOOxIURP_VNjXLSeUqmnxtafSV2WS8B@mail.gmail.com>
Message-ID: <alpine.DEB.1.10.1005202138530.18334@localhost.localdomain>

* On Thu, 20 May 2010, Matijn Woudt wrote:
> On Thu, May 20, 2010 at 3:54 AM, Hin-Tak Leung <hintak_leung at yahoo.co.uk> wrote:
> > 
> > I have gone ahead and done exactly that - the correct behavior should 
> > be a msg box saying filelist.txt is missing, rather than setupgs.exe 
> > not a valid win32 application.
> >
> > http://www.ghostscript.com/~hintak/setupgs-vista.exe
> > http://www.ghostscript.com/~hintak/setupgs-wine.exe
> 
> There are a few differences I spotted between the two executables:
> 1) setupgs-wine.exe has wrong image size, changing it from 0x2b200 to 
> 0x2b000 makes the executable working under win7.
> 2) setupgs-wine.exe has wrong resource size, probably related to 1), 
> because the size of both executables are the same.
> 3) The assembly in setupgs-wine.exe has only LF line endings, vista has 
> CRLF. This explains 2).
> 
> I don't know the reason for 3), I assume it's a bug somewhere in wine.

Thus it could be a fault in Wine's msvcrt.dll (or the like: msvcr?0.dll).

To check this, it would be nice to run "winetricks vcrun6", recomple the 
app in Wine and see if the resulting exe run OK on Vista.


S.


From damjan.jov at gmail.com  Thu May 20 14:08:44 2010
From: damjan.jov at gmail.com (Damjan Jovanovic)
Date: Thu, 20 May 2010 21:08:44 +0200
Subject: Release plans
In-Reply-To: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
References: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
Message-ID: <AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com>

On Fri, May 14, 2010 at 12:31 PM,  <Joerg-Cyril.Hoehle at t-systems.com> wrote:
> Hi,

Hi

>>The 64-bit support is now more or less complete
> I hope I can finish my MCI parser patches in time. Without them,
> every 64bit app using MCI string commands is likely to crash (OTOH
> MCI commands work (those using the MCI_*_PARAMS structures)).
>
>
> What can Mac users expect from this release?

Hopefully, conversion to Linux :-).

> Yesterday I installed an app with wine-1.1.44 on Mac OS (instead of
> moving it from a Linux install). It was disappointing from a user POV:
>
> - Wine created .desktop files that work on Linux but don't make sense
> ?on Mac OS. ?Here I've been thinking about a simple patch that would
> ?instead generate a .command file like I've described in the FAQ.
> ?OTOH, Steven Edwards IIRC once had a much more elaborate patch about
> ?better Mac OS integration, rejected last year.
>
> - In the hidden directory ~/.local/share/icons/ it created .xpm files
> ?that the Finder does not display. ?.png would be displayed.

winemenubuilder generates .png only for 24 and 32 bits-per-pixel
icons, all other resolutions get converted to .xpm. I am planning to
change it to make .png's for everything, since thumbnailing .lnk files
requires .png as output, and then keep .xpm only as a fallback when
libpng is not installed and we're not thumbnailing. This should help
you on MacOS too.

> I have no idea how the other packages built atop Wine behave on MacOS behave:
> ?- Kronenberg's WineBottler
> ?- doh's WineSkin
> ?- Macports build
> ?- CodeWeaver's CrossOver4Mac
> I assume they create nice icons that the user can click after an install.
>
> Regarding the former 2 packages, I've always been wondering why
> there's some sort of split in the Wine+Mac user community. ?Obviously
> the stock Wine fails to meet the Mac user's expectations, such that
> several people start and write something better integrated with the
> GUI -- but not integrated into the Wine source.


From winehacker at gmail.com  Thu May 20 14:44:02 2010
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 20 May 2010 15:44:02 -0400
Subject: Release plans
In-Reply-To: <AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com>
References: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
	<AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com>
Message-ID: <AANLkTikoWzFqD-Ee2kFjwVlo2ElMMl4OchrymfC3WVqz@mail.gmail.com>

On Thu, May 20, 2010 at 3:08 PM, Damjan Jovanovic <damjan.jov at gmail.com> wrote:
> winemenubuilder generates .png only for 24 and 32 bits-per-pixel
> icons, all other resolutions get converted to .xpm. I am planning to
> change it to make .png's for everything, since thumbnailing .lnk files
> requires .png as output, and then keep .xpm only as a fallback when
> libpng is not installed and we're not thumbnailing. This should help
> you on MacOS too.
>
> > I have no idea how the other packages built atop Wine behave on MacOS behave:
> > ?- Kronenberg's WineBottler
> > ?- doh's WineSkin
> > ?- Macports build
> > ?- CodeWeaver's CrossOver4Mac
> > I assume they create nice icons that the user can click after an install.

I have a hacked version in the Bordeaux tree that uses sips to create
icns icons and working Application bundles. If they have time, Austin
or Tom can send it along for your review if your interested. The
'right' solution would be to figure out how to make them happy with
png's or write a WIC encoder/filter/whatever for icns, I just don't
have the time these days. Without getting off on to a long rant, I
'hacked' our version call sips on OS X to convert the images to icns.I
was never able to get App bundles to want to play nice with the png
images winemenubuilder spits out but it works most of the time. Since
it's derived LGPL code we are happy to share, though it really is a
hack and I am sure Alexandre would not want it in the tree, even for
the new release.

Thanks
--
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Thu May 20 14:51:38 2010
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 20 May 2010 15:51:38 -0400
Subject: Release plans
In-Reply-To: <AANLkTikoWzFqD-Ee2kFjwVlo2ElMMl4OchrymfC3WVqz@mail.gmail.com>
References: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
	<AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com>
	<AANLkTikoWzFqD-Ee2kFjwVlo2ElMMl4OchrymfC3WVqz@mail.gmail.com>
Message-ID: <AANLkTin4WTKwlX4KWum9HOFBB5mv--dd6sqcDMszQ8EJ@mail.gmail.com>

On Thu, May 20, 2010 at 3:44 PM, Steven Edwards <winehacker at gmail.com>wrote:

> I have a hacked version in the Bordeaux tree that uses sips to create
> icns icons and working Application bundles. If they have time, Austin
> or Tom can send it along for your review if your interested. The
> 'right' solution would be to figure out how to make them happy with
> png's or write a WIC encoder/filter/whatever for icns, I just don't
> have the time these days. Without getting off on to a long rant, I
> 'hacked' our version call sips on OS X to convert the images to icns.I
> was never able to get App bundles to want to play nice with the png
> images winemenubuilder spits out but it works most of the time. Since
> it's derived LGPL code we are happy to share, though it really is a
> hack and I am sure Alexandre would not want it in the tree, even for
> the new release.
>
>
Sorry for the double spam, I thought I did not have a copy of the code
handy. Here is the hacked patch, it's quite nasty as it forks for every
image is processes so it takes a while to generate the icons. There was a
bit of a race condition so I further hacked it by sleeping but it got the
job done. As I said, figuring out why Appbundles did not want to play nice
with the png images would be great. I suspect png image AppBundle support
really only works on iDevices and not full OS X and if so, we just need a
better way to spitout/convert to icns images.

Thanks
-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and that is
an idea whose time has come." - Victor Hugo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100520/0fd5f235/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: wine_menubuilder
Type: application/octet-stream
Size: 16940 bytes
Desc: not available
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100520/0fd5f235/attachment-0001.obj>

From damjan.jov at gmail.com  Thu May 20 15:13:10 2010
From: damjan.jov at gmail.com (Damjan Jovanovic)
Date: Thu, 20 May 2010 22:13:10 +0200
Subject: Release plans
In-Reply-To: <AANLkTin4WTKwlX4KWum9HOFBB5mv--dd6sqcDMszQ8EJ@mail.gmail.com>
References: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
	<AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com>
	<AANLkTikoWzFqD-Ee2kFjwVlo2ElMMl4OchrymfC3WVqz@mail.gmail.com>
	<AANLkTin4WTKwlX4KWum9HOFBB5mv--dd6sqcDMszQ8EJ@mail.gmail.com>
Message-ID: <AANLkTinwyxF3lmv9V5528ky1eGnarWaR-1ZsQQ_mLYsu@mail.gmail.com>

On Thu, May 20, 2010 at 9:51 PM, Steven Edwards <winehacker at gmail.com> wrote:
>
>
> On Thu, May 20, 2010 at 3:44 PM, Steven Edwards <winehacker at gmail.com>
> wrote:
>>
>> I have a hacked version in the Bordeaux tree that uses sips to create
>> icns icons and working Application bundles. If they have time, Austin
>> or Tom can send it along for your review if your interested. The
>> 'right' solution would be to figure out how to make them happy with
>> png's or write a WIC encoder/filter/whatever for icns, I just don't
>> have the time these days. Without getting off on to a long rant, I
>> 'hacked' our version call sips on OS X to convert the images to icns.I
>> was never able to get App bundles to want to play nice with the png
>> images winemenubuilder spits out but it works most of the time. Since
>> it's derived LGPL code we are happy to share, though it really is a
>> hack and I am sure Alexandre would not want it in the tree, even for
>> the new release.
>>
>
> Sorry for the double spam, I thought I did not have a copy of the code
> handy. Here is the hacked patch, it's quite nasty as it forks for every
> image is processes so it takes a while to generate the icons. There was a
> bit of a race?condition?so I further hacked it by sleeping but it got the
> job done. As I said, figuring out why Appbundles did not want to play nice
> with the png images would be great. I suspect png image AppBundle support
> really only works on iDevices and not full OS X and if so, we just need a
> better way to spitout/convert to icns images.
> Thanks

Everything in the .png generation looks bog standard, but maybe MacOS
doesn't like our PNG comment. Try remove that ppng_set_text call in
winemenubuilder's SaveIconResAsPNG and see if it helps?

> --
> Steven Edwards
>
> "There is one thing stronger than all the armies in the world, and that is
> an idea whose time has come." - Victor Hugo
>

Damjan


From winehacker at gmail.com  Thu May 20 15:17:25 2010
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 20 May 2010 16:17:25 -0400
Subject: Release plans
In-Reply-To: <AANLkTinwyxF3lmv9V5528ky1eGnarWaR-1ZsQQ_mLYsu@mail.gmail.com>
References: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
	<AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com>
	<AANLkTikoWzFqD-Ee2kFjwVlo2ElMMl4OchrymfC3WVqz@mail.gmail.com>
	<AANLkTin4WTKwlX4KWum9HOFBB5mv--dd6sqcDMszQ8EJ@mail.gmail.com>
	<AANLkTinwyxF3lmv9V5528ky1eGnarWaR-1ZsQQ_mLYsu@mail.gmail.com>
Message-ID: <AANLkTilcy3ePboWAqdDaf03jCxmqv79JrrX9w4Kmas-i@mail.gmail.com>

On Thu, May 20, 2010 at 4:13 PM, Damjan Jovanovic <damjan.jov at gmail.com> wrote:
> Everything in the .png generation looks bog standard, but maybe MacOS
> doesn't like our PNG comment. Try remove that ppng_set_text call in
> winemenubuilder's SaveIconResAsPNG and see if it helps?

I've tried with other PNGs before that we've not generated. Take a
third party png, edit the Info.plist and change the icon entry to
instead of pointing at the icns file point at the new Png image. Of
course I've tried this on Leopard, perhaps the behaviour is different
on snow leopard, I don't have a copy of it here.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From winehacker at gmail.com  Thu May 20 15:25:00 2010
From: winehacker at gmail.com (Steven Edwards)
Date: Thu, 20 May 2010 16:25:00 -0400
Subject: Release plans
In-Reply-To: <AANLkTilcy3ePboWAqdDaf03jCxmqv79JrrX9w4Kmas-i@mail.gmail.com>
References: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
	<AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com>
	<AANLkTikoWzFqD-Ee2kFjwVlo2ElMMl4OchrymfC3WVqz@mail.gmail.com>
	<AANLkTin4WTKwlX4KWum9HOFBB5mv--dd6sqcDMszQ8EJ@mail.gmail.com>
	<AANLkTinwyxF3lmv9V5528ky1eGnarWaR-1ZsQQ_mLYsu@mail.gmail.com>
	<AANLkTilcy3ePboWAqdDaf03jCxmqv79JrrX9w4Kmas-i@mail.gmail.com>
Message-ID: <AANLkTinbzhouez1bGPCk6NAtFHk_0LLOWREEbVTol7hC@mail.gmail.com>

On Thu, May 20, 2010 at 4:17 PM, Steven Edwards <winehacker at gmail.com> wrote:
> I've tried with other PNGs before that we've not generated. Take a
> third party png, edit the Info.plist and change the icon entry to
> instead of pointing at the icns file point at the new Png image. Of
> course I've tried this on Leopard, perhaps the behaviour is different
> on snow leopard, I don't have a copy of it here.

I am pretty sure the png support is iPod/Pad/Phone only. There may be
some magic flag to allow OS X to use png rather than icns but I can't
find it from google.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From testbot at testbot.winehq.org  Thu May 20 16:34:07 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Thu, 20 May 2010 23:34:07 +0200
Subject: comctl32/listview: Don't forward WM_COMMAND to parent if we don't
	have an Edit box (resent) 
Message-ID: <201005202134.o4KLY71v003838@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2201

Your paranoid android.


=== W7PRO (32 bit listview) ===
listview.c:4393: Test failed: NM_HOVER allow test: the msg sequence is not complete: expected 0087 - actual 0000
listview.c:4398: Test failed: NM_HOVER block test: the msg sequence is not complete: expected 0087 - actual 0000


From testbot at testbot.winehq.org  Thu May 20 17:43:47 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Fri, 21 May 2010 00:43:47 +0200
Subject: [5/6] d3dx9: Add basic implementation of D3DXFilterTexture,
	plus tests 
Message-ID: <201005202243.o4KMhlmd026411@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2207

Your paranoid android.


=== WINEBUILD (build) ===
Make failed


From testbot at testbot.winehq.org  Thu May 20 17:08:07 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Fri, 21 May 2010 00:08:07 +0200
Subject: [2/2] shell32: Export ILFree by name 
Message-ID: <201005202208.o4KM87lT025026@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2202

Your paranoid android.


=== WNT4WSSP6 (32 bit shlfileop) ===
shlfileop.c:2202: Test failed: SHGetNewLinkInfoA succeeded


From wine-devel at kievinfo.com  Thu May 20 20:15:08 2010
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Thu, 20 May 2010 19:15:08 -0600
Subject: dinput2
In-Reply-To: <AANLkTimmwRdoXZarvf195ilxuJSxUxG5Tb5Rbm2wM4DQ@mail.gmail.com>
References: <AANLkTimmwRdoXZarvf195ilxuJSxUxG5Tb5Rbm2wM4DQ@mail.gmail.com>
Message-ID: <4BF5DE9C.70209@kievinfo.com>

On 05/20/2010 12:49 AM, David Adam wrote:
> Hello
> 
> many distro ship the X-server with dinput2. More and more old games work
> pretty well now with Wine, but the mouse. Does anyone plan to work on
> the infamous bug 6971?
If you talking about XI2 then see my notes about it in that bug. XI2 is
unusable for what we need. Until that gets fixed we can't really use it.

Then comes the question on how intrusive do you want it? You can use latest
patch from the bug with minor adjustments. But to make things really right,
whole keyboard processing inside x11drv have to be rewritten.

Vitaliy.


From scott at open-vote.org  Thu May 20 23:29:06 2010
From: scott at open-vote.org (Scott Ritchie)
Date: Thu, 20 May 2010 21:29:06 -0700
Subject: dinput2
In-Reply-To: <4BF5DE9C.70209@kievinfo.com>
References: <AANLkTimmwRdoXZarvf195ilxuJSxUxG5Tb5Rbm2wM4DQ@mail.gmail.com>
	<4BF5DE9C.70209@kievinfo.com>
Message-ID: <4BF60C12.8030503@open-vote.org>

On 05/20/2010 06:15 PM, Vitaliy Margolen wrote:
> On 05/20/2010 12:49 AM, David Adam wrote:
>> Hello
>>
>> many distro ship the X-server with dinput2. More and more old games work
>> pretty well now with Wine, but the mouse. Does anyone plan to work on
>> the infamous bug 6971?
> If you talking about XI2 then see my notes about it in that bug. XI2 is
> unusable for what we need. Until that gets fixed we can't really use it.
> 
> Then comes the question on how intrusive do you want it? You can use latest
> patch from the bug with minor adjustments. But to make things really right,
> whole keyboard processing inside x11drv have to be rewritten.
> 

By the way, you're not the only one who wants this.  At the Ubuntu
Developer Summit we talked about the need for ripping the keyboard code
out of X entirely (and instead having it sit somewhere in the plumbing
lair).

I'll admit I'm not too familiar with the details about why this is a
good idea, but I believe it had something to do with keyboard layout
issues for International users, especially in East Asia.

Do you know anyone who might want to work on this?

Thanks,
Scott Ritchie


From hintak_leung at yahoo.co.uk  Thu May 20 18:34:52 2010
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Thu, 20 May 2010 23:34:52 +0000 (GMT)
Subject: software built and worked under wine but not in vista?
In-Reply-To: <AANLkTilLBQDoYZOOxIURP_VNjXLSeUqmnxtafSV2WS8B@mail.gmail.com>
Message-ID: <506591.51077.qm@web23101.mail.ird.yahoo.com>

--- On Thu, 20/5/10, Matijn Woudt <tijnema at gmail.com> wrote:

> >> * On Tue, 18 May 2010, Hin-Tak Leung wrote:
> >>>
> >>> So it seems that setupgs.exe is mis-compiled
> under wine with win7 sdk but
> >>> just happened to also work under wine. Any
> idea how it might happen?

> > I have gone ahead and done exactly that - the correct
> behavior should be a
> > msg box saying filelist.txt is missing, rather than
> setupgs.exe not a valid
> > win32 application.
> >
> > http://www.ghostscript.com/~hintak/setupgs-vista.exe
> > http://www.ghostscript.com/~hintak/setupgs-wine.exe
> >
> > I haven't tried the uninstaller yet, so I don't know
> if the wine-built
> > uninstaller work:
> >
> > http://www.ghostscript.com/~hintak/uninstgs-vista.exe
> > http://www.ghostscript.com/~hintak/uninstgs-wine.exe
> >
> > To analyse the executables are a bit beyond me, but I
> hope somebody can do
> > that.
> >
> > under either system, if I compile the file twice
> quickly, the result differs
> > only by the datestamp and checksum (and in two
> wine-compiled executable
> > built a bit of time between , also a few bytes in the
> .text section after
> > what looks like an import table in a hex editor?
> >
> >
> 
> There are a few differences I spotted between the two
> executables:
> 1) setupgs-wine.exe has wrong image size, changing it from
> 0x2b200 to
> 0x2b000 makes the executable working under win7.
> 2) setupgs-wine.exe has wrong resource size, probably
> related to 1),
> because the size of both executables are the same.
> 3) The assembly in setupgs-wine.exe has only LF line
> endings, vista
> has CRLF. This explains 2).
> 
> I don't know the reason for 3), I assume it's a bug
> somewhere in wine.

I tried uninstgs-wine.exe and it is also broken. What's more, the executable is of a different size. I am thinking 2 and 3 are probably red herrings, although it is curious how it happens. (I git-archive under unix and use winzip to extract them, so the manifests are the same, and have unix line endings.)

The ghostscript distribution has other executables besides setupgs.exe and uninstgs.exe (for install and uninstall), but only those two seem to be broken. Those two are also different in having been manipulated through mt. Could the running of mt be buggy?

mt -nologo -manifest $(PSSRC)dwsetup_x64.manifest -outputresource:$(SETUP_XE);#1
 
I have tried re-running mt on either a built executable or vista-compiled ones, but there are no modification. perhaps I don't understand what it does and how it does its work.




      


From hintak_leung at yahoo.co.uk  Thu May 20 22:25:59 2010
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Fri, 21 May 2010 03:25:59 +0000 (GMT)
Subject: software built and worked under wine but not in vista?
In-Reply-To: <alpine.DEB.1.10.1005202138530.18334@localhost.localdomain>
Message-ID: <968771.41004.qm@web23106.mail.ird.yahoo.com>

--- On Thu, 20/5/10, Saulius Krasuckas <saulius2 at ar.fi.lt> wrote:


> > > http://www.ghostscript.com/~hintak/setupgs-vista.exe
> > > http://www.ghostscript.com/~hintak/setupgs-wine.exe
> > 
> > There are a few differences I spotted between the two
> executables:
> > 1) setupgs-wine.exe has wrong image size, changing it
> from 0x2b200 to 
> > 0x2b000 makes the executable working under win7.
> > 2) setupgs-wine.exe has wrong resource size, probably
> related to 1), 
> > because the size of both executables are the same.
> > 3) The assembly in setupgs-wine.exe has only LF line
> endings, vista has 
> > CRLF. This explains 2).
> > 
> > I don't know the reason for 3), I assume it's a bug
> somewhere in wine.
> 
> Thus it could be a fault in Wine's msvcrt.dll (or the like:
> msvcr?0.dll).
> 
> To check this, it would be nice to run "winetricks vcrun6",
> recomple the 
> app in Wine and see if the resulting exe run OK on Vista.

Tried that - the binary differs by 6 bytes - just timestamp and checksum. So using native msvcrt in vcrun6 has no effect.


      


From hverbeet at gmail.com  Fri May 21 03:29:38 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Fri, 21 May 2010 10:29:38 +0200
Subject: [2/6] d3dx9: Implement D3DXCheckTextureRequirements
In-Reply-To: <4BF5A401.4010402@codeweavers.com>
References: <4BF5A401.4010402@codeweavers.com>
Message-ID: <AANLkTilmxDhEnoNhWMvtsiyO7mGRRNz7a7eMaUX25QXM@mail.gmail.com>

On 20 May 2010 23:05, Owen Rudge <orudge at codeweavers.com> wrote:
> +BOOL is_pow2(UINT num);
> +UINT make_pow2(UINT num);
I'm not so convinced these are going to be very useful for anything
outside texture.c.

> +BOOL is_pow2(UINT num)
> +{
> +    if (!num) return FALSE;
> +
> +    return !(num & (num - 1));
> +}
Do you really care that 0 is not a real power of two for these texture
functions? It's not a valid width / height anyway.

> +        if ((caps.TextureCaps & D3DPTEXTURECAPS_POW2) && (!is_pow2(*width)))
> +            make_pow2(*width);
...
> +        if ((caps.TextureCaps & D3DPTEXTURECAPS_POW2) && (!is_pow2(*height)))
> +            make_pow2(*height);
You have to assign to result to something for it to be of any use.

> +            max_mipmaps = 9;
Where does that 9 come from? (I can easily guess, but...)

> +        hr = IDirect3DDevice9_GetDirect3D(device, &d3d);
> +
> +        if (SUCCEEDED(hr))
> +            IDirect3DDevice9_GetCreationParameters(device, &params);
> +
> +        if (SUCCEEDED(hr))
> +            IDirect3DDevice9_GetDisplayMode(device, 0, &mode);
> +
> +        if (SUCCEEDED(hr))
It's probably nicer to check for failure and jump to some cleanup
code. Also, you should check all the calls for errors, not just
GetDirect3D().

The width / height handling looks a bit complicated to me. You should
probably first calculate the width and height using local variables,
and only assign those to *width/*height afterwards. Something along
these lines:

{
    UINT w = (width && *width) ? *width : 1;
    UINT h = (height && *height) ? *height : 1;

    if (w == D3DX_DEFAULT && h == D3DX_DEFAULT)
        w = h = 256;
    else if (w == D3DX_DEFAULT) w = h;
    else if (h == D3DX_DEFAULT) h = w;

    ...

    if (width) *width = w;
    if (height) *height = h;
}


From Joerg-Cyril.Hoehle at t-systems.com  Fri May 21 03:47:05 2010
From: Joerg-Cyril.Hoehle at t-systems.com (Joerg-Cyril.Hoehle at t-systems.com)
Date: Fri, 21 May 2010 10:47:05 +0200
Subject: Release plans
References: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
	<AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com>
Message-ID: <47CC5ABB01651443A88DB8EC5B4D657B740383@S4DE8PSAANK.mitte.t-com.de>

Hi,

Damjan Jovanovic wrote:
>winemenubuilder generates .png only for 24 and 32 bits-per-pixel
>icons, all other resolutions get converted to .xpm. I am planning to
>change it to make .png's for everything, since thumbnailing .lnk files
>requires .png as output
Good to know. This answers my question in bug #21644
http://bugs.winehq.org/show_bug.cgi?id=21644#c0
It would be a great patch.


>> And I didn't write trivial Mac patches either, e.g. to have
>> wineprefixcreate symlink c:\users\xyz\ Desktop + Videos + Documents +
>> Music to /Users/xyz/Desktop/ etc.  This happens on Linux, not on MacOS.
>> That's another (example of a) missing element.
>> (Why didn't I write it? Because I was unsure where to put the #ifdef)
>Isn't that linking done relative to $HOME, which should resolve to
>/Users/xyz on Mac?
That's not the problem. What I also don't know is whether I could hardcode
the directories ~/Documents etc. (these already exist in my /Users/xyz,
(but what about Tiger?)), or whether I ought to call some OSX API that
yields the name of the dir (and possibly creates it if it does not yet exist).
I'm not familiar at all with Mac APIs, but it sounds like an easy patch
for somebody with a little MacOS programming knowledge.


>> What can Mac users expect from this release?
>Hopefully, conversion to Linux :-).
Actually, one day I was fed up with the Gnome and KDE4 GUIs,
so I started looking for something else. The Mac Mini with
NVidia came out right at that time: extremely silent (except
for the CD-ROM), excellent graphics (by far better than
any onboard Intel I knew previously) and it's a UNIX.

Regards,
?J?rg H?hle


From hintak_leung at yahoo.co.uk  Fri May 21 02:27:04 2010
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Fri, 21 May 2010 00:27:04 -0700 (PDT)
Subject: software built and worked under wine but not in vista?
Message-ID: <387226.36868.qm@web23108.mail.ird.yahoo.com>

--- On Fri, 21/5/10, Hin-Tak Leung <hintak_leung at yahoo.co.uk> wrote:

> Krasuckas <saulius2 at ar.fi.lt>
> wrote:
> 
> 
> > > > http://www.ghostscript.com/~hintak/setupgs-vista.exe
> > > > http://www.ghostscript.com/~hintak/setupgs-wine.exe
> > > 
> > > There are a few differences I spotted between the
> two
> > executables:
> > > 1) setupgs-wine.exe has wrong image size,
> changing it
> > from 0x2b200 to 
> > > 0x2b000 makes the executable working under win7.


But that has to be a bug in wine - that it doesn't check the image size and loads PE with an invalid image size? (how that end up being invalid is a different issue).



      


From hverbeet at gmail.com  Fri May 21 05:01:34 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Fri, 21 May 2010 12:01:34 +0200
Subject: [4/6] d3dx9: Implement D3DXCreateTexture plus tests
In-Reply-To: <4BF5A40C.5020600@codeweavers.com>
References: <4BF5A40C.5020600@codeweavers.com>
Message-ID: <AANLkTinfUPblOjsO3XGkXPsda1wt7T8ufiUXtVMAq0Lt@mail.gmail.com>

On 20 May 2010 23:05, Owen Rudge <orudge at codeweavers.com> wrote:
> +    hr = D3DXCreateTexture(device, D3DX_DEFAULT, 63, 0, 0, 0, D3DPOOL_DEFAULT, &texture);
> +    ok(hr == D3D_OK, "D3DXCreateTexture returned %#x, expected %#x\n", hr, D3D_OK);
> +
> +    if (texture)
> +    {
> +        hr = IDirect3DTexture9_GetLevelDesc(texture, 0, &desc);
> +
> +        ok(desc.Width == 63, "Returned width %d, expected %d\n", desc.Width, 63);
> +        ok(desc.Height == 63, "Returned height %d, expected %d\n", desc.Height, 63);
Doesn't that depend on NPOT texture support in the device?


From hverbeet at gmail.com  Fri May 21 05:24:27 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Fri, 21 May 2010 12:24:27 +0200
Subject: wined3d: Avoid using the long type.
In-Reply-To: <20100521101305.GB2801@redhat.com>
References: <20100521101305.GB2801@redhat.com>
Message-ID: <AANLkTilNoJVVVsWS2FmUUSWTcixwZsB-js7ur9gqddgB@mail.gmail.com>

This will conflict with my patches from earlier today.


From alexandru.balut at gmail.com  Fri May 21 05:32:45 2010
From: alexandru.balut at gmail.com (=?UTF-8?B?QWxleGFuZHJ1IELEg2x1yJs=?=)
Date: Fri, 21 May 2010 12:32:45 +0200
Subject: Trying to fix a bug, stuck at cross-compiling
In-Reply-To: <AANLkTikX5FgM1kNC3OussMcwud0ytfDfjvmtwY-bq-g6@mail.gmail.com>
References: <AANLkTikX5FgM1kNC3OussMcwud0ytfDfjvmtwY-bq-g6@mail.gmail.com>
Message-ID: <AANLkTilJI_JVCwaPVZq3IzNWijspc9cVONCyArBYtjDe@mail.gmail.com>

A workaround is to run "make" instead of "make tools" in build-native.

Alex

On Mon, May 17, 2010 at 03:36, Alexandru B?lu?
<alexandru.balut at gmail.com> wrote:
> Hi,
>
> I'm trying to fix bug 12804, and made some changes to winecfg, and I
> need to test how it works on Windows. I followed the instructions from
> http://wiki.winehq.org/CompilingDLLsUsingMingw - Cross Compiling the
> Whole Tree, but I get an error:
>
> $ ../wine-crossc/configure --host=i586-mingw32msvc
> --with-wine-tools=../build-native --without-freetype --without-x
> [...]
> checking for the directory containing the Wine tools... configure:
> error: could not find Wine tools in ../build-native
>
> This seems to happen because the ../build-native/tools/winebuild
> directory does not exist.
>
> When I ran "make tools", in ../build-native, no error occurred. Any
> idea why this happens?
>
> Is there another way to build winecfg as an exe?
>
> Thanks,
> Alex
>


From hans at codeweavers.com  Fri May 21 05:48:58 2010
From: hans at codeweavers.com (Hans Leidekker)
Date: Fri, 21 May 2010 12:48:58 +0200
Subject: [2/2] winemenubuilder: add thumbnail mode for .lnk files
In-Reply-To: <AANLkTimwdRVkvOyHKSSatoTvZWpY7vw5PGK9SxMu6oNF@mail.gmail.com>
References: <AANLkTimwdRVkvOyHKSSatoTvZWpY7vw5PGK9SxMu6oNF@mail.gmail.com>
Message-ID: <1274438938.8874.347.camel@t400>

On Fri, 2010-05-21 at 07:52 +0200, Damjan Jovanovic wrote:

> --- winemenubuilder00.c 2010-05-21 07:44:48.195864397 +0200
> +++ winemenubuilder.c   2010-05-21 07:47:25.591878489 +0200

This will not apply from the root. This patch set needs your previous
patches to make sense, right?

> Changelog:
> * winemenubuilder: add thumbnail mode for .lnk files

winemenubuilder is a winelib app, it may not run in the prefix
that the .lnk file was created in. So while these patches get rid of
duplicate launchers on the desktop, we lose support for multiple
prefixes.




From damjan.jov at gmail.com  Fri May 21 06:39:17 2010
From: damjan.jov at gmail.com (Damjan Jovanovic)
Date: Fri, 21 May 2010 13:39:17 +0200
Subject: [2/2] winemenubuilder: add thumbnail mode for .lnk files
In-Reply-To: <1274438938.8874.347.camel@t400>
References: <AANLkTimwdRVkvOyHKSSatoTvZWpY7vw5PGK9SxMu6oNF@mail.gmail.com>
	<1274438938.8874.347.camel@t400>
Message-ID: <AANLkTikEVBu7jb02OfN5r3MlV9i8MJa0UZjLzqocwdXq@mail.gmail.com>

On Fri, May 21, 2010 at 12:48 PM, Hans Leidekker <hans at codeweavers.com> wrote:
> On Fri, 2010-05-21 at 07:52 +0200, Damjan Jovanovic wrote:
>
>> --- winemenubuilder00.c 2010-05-21 07:44:48.195864397 +0200
>> +++ winemenubuilder.c ? 2010-05-21 07:47:25.591878489 +0200
>
> This will not apply from the root. This patch set needs your previous
> patches to make sense, right?

Yes. And this particular patch is optional - the previous one alone
allegedly helps Macs, since .xpm is completely foreign there. So
please apply the prevoius one even if this one is rejected.

>> Changelog:
>> * winemenubuilder: add thumbnail mode for .lnk files
>
> winemenubuilder is a winelib app, it may not run in the prefix
> that the .lnk file was created in. So while these patches get rid of
> duplicate launchers on the desktop, we lose support for multiple
> prefixes.
>
>
>

The wineprefix is already lost. With the Git from about 36 hours ago,
you can double-click any .lnk file to run it. This patch merely adds
thumbnails.

Regards
Damjan Jovanovic


From Joerg-Cyril.Hoehle at t-systems.com  Fri May 21 07:56:03 2010
From: Joerg-Cyril.Hoehle at t-systems.com (Joerg-Cyril.Hoehle at t-systems.com)
Date: Fri, 21 May 2010 14:56:03 +0200
Subject: TRACE(...., debugstr_w(uninitialised data))?
Message-ID: <47CC5ABB01651443A88DB8EC5B4D657B740389@S4DE8PSAANK.mitte.t-com.de>

Hi,

winmm/mci.c contains some code like this:
TRACE("=> 1/ %x (%s)\n", dwRet, debugstr_w(lpstrRet));

However, in case of error, the lpstrRet buffer is likely not initialised.
This could cause
 1. debugstr_w to choke on bad/unconvertible data (not even 0-terminated);
 2. Valgrind errors (I don't know whether the Valgrind warnings I observe
    are due to this line of code).

Am I worrying too much or should any such piece of code be protected by
TRACE("=> 1/ %x (%s)\n", dwRet, LOWORD(dwRet) ? "" : debugstr_w(lpstrRet));
(actually, an even more convoluted test is needed because of MCI_INTEGER_RETURNED)

Or is it not worth careing about because it's within TRACE() only?

I assume that debugstr_w is not executed when that channel is not traced. Correct?

Regards,
 J?rg H?hle


From Paul.Hampson at Pobox.com  Fri May 21 08:16:24 2010
From: Paul.Hampson at Pobox.com (Paul "TBBle" Hampson)
Date: Fri, 21 May 2010 23:16:24 +1000
Subject: dinput2
In-Reply-To: <4BF60C12.8030503@open-vote.org>
References: <AANLkTimmwRdoXZarvf195ilxuJSxUxG5Tb5Rbm2wM4DQ@mail.gmail.com>
	<4BF5DE9C.70209@kievinfo.com> <4BF60C12.8030503@open-vote.org>
Message-ID: <AANLkTilBsTxUK25CCrRpVQUo4ikYK02DX-Sbp0QhGUS8@mail.gmail.com>

(Resending, on-list. Thanks, Gmail, apologies to Scott >_<)

On 21 May 2010 14:29, Scott Ritchie <scott at open-vote.org> wrote:
> By the way, you're not the only one who wants this. ?At the Ubuntu
> Developer Summit we talked about the need for ripping the keyboard code
> out of X entirely (and instead having it sit somewhere in the plumbing
> lair).

> I'll admit I'm not too familiar with the details about why this is a
> good idea, but I believe it had something to do with keyboard layout
> issues for International users, especially in East Asia.

Is there any particular documentation of this discussion or intention?
I'm interested in the area, but I'm not clear on what's actually being
discussed, change-wise.

-- 
Paul "TBBle" Hampson, Paul.Hampson at Pobox.com


From dank at kegel.com  Fri May 21 09:02:02 2010
From: dank at kegel.com (Dan Kegel)
Date: Fri, 21 May 2010 07:02:02 -0700
Subject: yesterday's benchmark results: xubuntu makes 3dmark happier
Message-ID: <AANLkTinT4blCS2Hy72Bzutx-d2TDTz3SSTrMQ_Mz_7Ic@mail.gmail.com>

Yesterday's results were 8 hours late because of an internet outage here.
http://kegel.com/wine/yagmarkdata/00index.html
http://kegel.com/wine/yagmarkdata/E8400-GT_220-Ubuntu_10.04_LTS-e8400-wine-1.1.44-380.html

Looking at the graphs, it seems that all benchmarks are happier
under xubuntu with nonessential services shut down as described
yesterday.  3dmark (all versions) is affected lots more than Heaven.


From dank at kegel.com  Fri May 21 09:20:18 2010
From: dank at kegel.com (Dan Kegel)
Date: Fri, 21 May 2010 07:20:18 -0700
Subject: yesterday's benchmark results: xubuntu makes 3dmark happier
In-Reply-To: <AANLkTik8mgldIliF7vMpm--kn-CjxfS3ihjbKYHEtBbL@mail.gmail.com>
References: <AANLkTinT4blCS2Hy72Bzutx-d2TDTz3SSTrMQ_Mz_7Ic@mail.gmail.com>
	<AANLkTik8mgldIliF7vMpm--kn-CjxfS3ihjbKYHEtBbL@mail.gmail.com>
Message-ID: <AANLkTinC8sDMZAYI07TtSWBwYB8uHKivBj11CPYHLrXH@mail.gmail.com>

On Fri, May 21, 2010 at 7:10 AM, Erich Hoover <ehoover at mines.edu> wrote:
> Do you run your normal-Ubuntu tests with Compiz enabled?? Apparently with
> the nVidia drivers in particular that can make a big difference:
>
> http://www.phoronix.com/scan.php?page=article&item=compiz_speed_test&num=5

No, I think I had that solidly disabled for all runs.

It wouldn't hurt for my script to check all these things, though.


From scott at open-vote.org  Fri May 21 10:01:53 2010
From: scott at open-vote.org (Scott Ritchie)
Date: Fri, 21 May 2010 08:01:53 -0700
Subject: dinput2
In-Reply-To: <AANLkTilBsTxUK25CCrRpVQUo4ikYK02DX-Sbp0QhGUS8@mail.gmail.com>
References: <AANLkTimmwRdoXZarvf195ilxuJSxUxG5Tb5Rbm2wM4DQ@mail.gmail.com>	<4BF5DE9C.70209@kievinfo.com>
	<4BF60C12.8030503@open-vote.org>
	<AANLkTilBsTxUK25CCrRpVQUo4ikYK02DX-Sbp0QhGUS8@mail.gmail.com>
Message-ID: <4BF6A061.7080304@open-vote.org>

On 05/21/2010 06:16 AM, Paul "TBBle" Hampson wrote:
> (Resending, on-list. Thanks, Gmail, apologies to Scott >_<)
> 
> On 21 May 2010 14:29, Scott Ritchie <scott at open-vote.org> wrote:
>> By the way, you're not the only one who wants this.  At the Ubuntu
>> Developer Summit we talked about the need for ripping the keyboard code
>> out of X entirely (and instead having it sit somewhere in the plumbing
>> lair).
> 
>> I'll admit I'm not too familiar with the details about why this is a
>> good idea, but I believe it had something to do with keyboard layout
>> issues for International users, especially in East Asia.
> 
> Is there any particular documentation of this discussion or intention?
> I'm interested in the area, but I'm not clear on what's actually being
> discussed, change-wise.
> 

We didn't create a wiki page yet, but here are some copy/pasted Gobby
notes taken during the session:

-----
Current Situation:
BIOS keyboard driver from boot to X
 - kernel replaces that with input drivers (can remap etc)
   - same drivers that X uses
 - atkbd translates scancodes to keycodes, X translates to key sequences
 - X starts up, uses /dev/input devices
 - on console currently have no way of differentiating keyboard

current X implementations: XKB (European) and XIM (Asian) compete with
eachother
 - If you have a key on your keyboard to switch between US mode and
"input mode" that can input other keys then we don't handle this well
 - A keyboard layout other than US English will leave you screwed if
you're on an asian language
   - X sees keycodes rather than scancodes here
 - On X key swapping is done with the unique identifiers rather than
scan codes
   - but the intermediate layer with unique key ids is not exposed
   - input method engine does not see intermediate layer
     - we need to know underlying layer as well
   - Thai problem: keyboard with a key to switch between US English and
Thai layout
     - We have no indicator for what layout you're in, so Thai users
tend to use only 0-9 for passwords because those characters are
consistant between these two layouts
 - xkb doesn't support mapping one key to multiple unicode codepoints
(such as for keys that actually generate two unicode characters)

Solution: rip out the mess in X, put everything in IBUS instead.
 - User Session IBus daemon running, X talks to it
 - xkeyboardconfig would need to be merged into IBUS
 - X would be happy to remove keyboard stuff so they can focus on Video
instead
   - need someone to focus on the new bugs introduced by this change
 - Long term we will probably always have a display server (kernel will
take video responsibility, remove VT layer)
 - udev keyboard config magic should be moved out (into device tree or
uinput)
 - talk to xkeyboardconfig upstream and may be willing to help maintain it
 - Send Arne and Chris to X Conference and plead to the audience for
someone to do this
   - Arne to gather help and get the facts right and prepare presentation
     - Chris to help Arne
     - Scott James Remnant to clarify how plumbing gets keycodes to X

-----
If you have any questions you can ask ArneGoetje on Freenode (or mail
him, here's his launchpad page: https://launchpad.net/~arnegoetje)

This is the kind of thing that should exist as a wiki page somewhere, so
feel free to get started on one.  I hope that helps, I'm not too
knowledgeable on the subject myself.

Thanks,
Scott Ritchie


From juan.lang at gmail.com  Fri May 21 10:21:07 2010
From: juan.lang at gmail.com (Juan Lang)
Date: Fri, 21 May 2010 08:21:07 -0700
Subject: TRACE(...., debugstr_w(uninitialised data))?
In-Reply-To: <47CC5ABB01651443A88DB8EC5B4D657B740389@S4DE8PSAANK.mitte.t-com.de>
References: <47CC5ABB01651443A88DB8EC5B4D657B740389@S4DE8PSAANK.mitte.t-com.de>
Message-ID: <AANLkTinAMWAovhaw-SPw9rsZXpNoX82idTUUy1ki4J4v@mail.gmail.com>

Hi Joerg,

> Am I worrying too much or should any such piece of code be protected by
> TRACE("=> 1/ %x (%s)\n", dwRet, LOWORD(dwRet) ? "" : debugstr_w(lpstrRet));
> (actually, an even more convoluted test is needed because of MCI_INTEGER_RETURNED)

I'd worry about it.  We've sometimes had bugs where a crash appears in
a failure mode when a particular debug channel is enabled, but that
debug channel is the very thing that might help us debug the failure
better.

> I assume that debugstr_w is not executed when that channel is not traced. Correct?

That's correct.
--Juan


From jjmckenzie51 at earthlink.net  Fri May 21 10:22:46 2010
From: jjmckenzie51 at earthlink.net (James Mckenzie)
Date: Fri, 21 May 2010 08:22:46 -0700 (GMT-07:00)
Subject: Fw: Re: Release plans
Message-ID: <9853804.1274455366314.JavaMail.root@elwamui-norfolk.atl.sa.earthlink.net>

To the list....


-----Forwarded Message-----
>From: James Mckenzie <jjmckenzie51 at earthlink.net>
>Sent: May 20, 2010 12:49 PM
>To: Damjan Jovanovic <damjan.jov at gmail.com>
>Subject: Re: Release plans
>
>>
>>On Fri, May 14, 2010 at 12:31 PM,  <Joerg-Cyril.Hoehle at t-systems.com> wrote:
>>> Hi,
>>
>>Hi
>>
>>>>The 64-bit support is now more or less complete
>>> I hope I can finish my MCI parser patches in time. Without them,
>>> every 64bit app using MCI string commands is likely to crash (OTOH
>>> MCI commands work (those using the MCI_*_PARAMS structures)).
>>>
>>>
>>> What can Mac users expect from this release?
>>
>>Hopefully, conversion to Linux :-).
>>
>No.  BTW, I've used:
>
>TRSDOS (Model III)
>MS-DOS 1.0/2.0/3.0/4.0/5.0/6.0 (6.22) and updates
>DR-DOS 4.0/5.0
>Windows 3.1, 3.11WFW, 95, 98, NT 3.51, NT 4.0, XP and Vista
>OS/2
>Linux, Linux and more Linux (it is still user unfriendly)
>Mac Classic
>MacOSX 10.3/.4/.5
>
>I consider MacOSX the most polished as a User Experience of all of them.
>
>>> Yesterday I installed an app with wine-1.1.44 on Mac OS (instead of
>>> moving it from a Linux install). It was disappointing from a user POV:
>>>
>>> - Wine created .desktop files that work on Linux but don't make sense
>>> ?on Mac OS. ?Here I've been thinking about a simple patch that would
>>> ?instead generate a .command file like I've described in the FAQ.
>>> ?OTOH, Steven Edwards IIRC once had a much more elaborate patch about
>>> ?better Mac OS integration, rejected last year.
>>>
>>> - In the hidden directory ~/.local/share/icons/ it created .xpm files
>>> ?that the Finder does not display. ?.png would be displayed.
>>
>>winemenubuilder generates .png only for 24 and 32 bits-per-pixel
>>icons, all other resolutions get converted to .xpm. I am planning to
>>change it to make .png's for everything, since thumbnailing .lnk files
>>requires .png as output, and then keep .xpm only as a fallback when
>>libpng is not installed and we're not thumbnailing. This should help
>>you on MacOS too.
>
>Thank you.  It is not a good thing that MacOSX cannot use .xpm files "out of the box".
>>
>>> I have no idea how the other packages built atop Wine behave on MacOS behave:
>>> ?- Kronenberg's WineBottler
>>> ?- doh's WineSkin
>>> ?- Macports build
>>> ?- CodeWeaver's CrossOver4Mac
>>> I assume they create nice icons that the user can click after an install.
>>>
>>> Regarding the former 2 packages, I've always been wondering why
>>> there's some sort of split in the Wine+Mac user community. ?Obviously
>>> the stock Wine fails to meet the Mac user's expectations, such that
>>> several people start and write something better integrated with the
>>> GUI -- but not integrated into the Wine source.
>>
>>From visiting the websites, I see Kronenberg's Winebottler doesn't
>>provide source (the source link takes you to an empty repository;
>>interestingly the LGPL requires you to provide the changed source if
>>you distribute the software...)
>
>That's because Mike no longer makes any changes directly to the Wine code.  He states that on the site (or did.)
>>Wineskin is a complete installation
>>wrapper that I would guess does the desktop integration itself,
>
>That's what doh123 states.  It is a wrapper program that builds an exportable .app product that will start Wine and then any program that you wrap with it.  He also gets the files for specific programs using winetricks.
>
>>macports.org is down but http://wine.darwinports.com/ doesn't have any
>>relevant patches, and I don't have CrossOver4Mac or a Mac to test it
>>and see what it does.
>>
>CrossOver Mac is and will remain a commercial product.  They do all sorts of magic to fix the brokenness of Apple/XQuartz(s) X11's inability to display full screen and other enhancements specific to making Wine work better on the MacOSX platform.
>
>>Maybe it's that Linux users generally expect the free software to be
>>good, while Mac users generally expect good software to cost money, so
>>when someone develops the extra bits for Wine on Mac, they either keep
>>them to themselves or sell them? Also, I think more Wine developers
>>use Linux than Mac, so there's less interest in fixing Wine on Mac.
>>
>No.  Mac users expect Mac software to just damn work.  We don't want to 'tweek' and 'twist' and apply patch after patch after patch.  If it don't work, out of the box, it goes.  We don't have time to 'play'.  So, many of us use Crossover.  We pay for others to fix that which is broken.  That being said, there are those of us that really like the challange of making Windows software work on the Mac as well as making Linux software work on the Mac.  And we EXPECT to get paid for it.  
>
>Please be aware that 'free' software NEVER IS.  The phrase "You get what you pay for" really applies here.  Again, Mac users have been conditioned to 'it works'.  Wine is not, at the present time, ready for this level of acceptance and may never be.  And no, Mac users are not going to switch to Linux.  Some may run Ubuntu, but a vast majority unpack the system, plug it in and go to work.
>
>>> And I didn't write trivial Mac patches either, e.g. to have
>>> wineprefixcreate symlink c:\users\xyz\ Desktop + Videos + Documents +
>>> Music to /Users/xyz/Desktop/ etc. ?This happens on Linux, not on MacOS.
>>> That's another (example of a) missing element.
>>> (Why didn't I write it? Because I was unsure where to put the #ifdef)
>>
>>Isn't that linking done relative to $HOME, which should resolve to
>>/Users/xyz on Mac?
>>
>Correct.  When a new user is created on the Mac, the user name, less spaces and special characters, is used for the folder name.  The Desktop folder IS the Mac Aqua desktop and I highly suggest NOT placing .desktop and .lnk files there.  Unlike Windows users, most Mac users like to keep their desktops 'clean'.  Doing what you desire will take more work and a good poll of the Mac community before implementation.  This is part of the reason that Apple has used the Dock and created Documents/Download folders on it.  Maybe that would be a good place to put Wine application icons.
>
>Please keep in mind that this is not to bash Linux or Windows users.  Each category of user has their own method of OS and system use.
>
>James McKenzie



From austinenglish at gmail.com  Fri May 21 10:35:58 2010
From: austinenglish at gmail.com (Austin English)
Date: Fri, 21 May 2010 10:35:58 -0500
Subject: Release plans
In-Reply-To: <47CC5ABB01651443A88DB8EC5B4D657B740383@S4DE8PSAANK.mitte.t-com.de>
References: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
	<AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com> 
	<47CC5ABB01651443A88DB8EC5B4D657B740383@S4DE8PSAANK.mitte.t-com.de>
Message-ID: <AANLkTingOLoDBl_OA8cnbVHV09FUblXNiHpG1shpygG6@mail.gmail.com>

On Fri, May 21, 2010 at 3:47 AM,  <Joerg-Cyril.Hoehle at t-systems.com> wrote:
>>> And I didn't write trivial Mac patches either, e.g. to have
>>> wineprefixcreate symlink c:\users\xyz\ Desktop + Videos + Documents +
>>> Music to /Users/xyz/Desktop/ etc. ?This happens on Linux, not on MacOS.
>>> That's another (example of a) missing element.
>>> (Why didn't I write it? Because I was unsure where to put the #ifdef)
>>Isn't that linking done relative to $HOME, which should resolve to
>>/Users/xyz on Mac?
> That's not the problem. What I also don't know is whether I could hardcode
> the directories ~/Documents etc. (these already exist in my /Users/xyz,
> (but what about Tiger?)), or whether I ought to call some OSX API that
> yields the name of the dir (and possibly creates it if it does not yet exist).
> I'm not familiar at all with Mac APIs, but it sounds like an easy patch
> for somebody with a little MacOS programming knowledge.

I haven't used Tiger in ages, but at least for me on Snow Leopard, I
can't delete those directories, since OSX considers them 'essential to
OS function'. The likelihood of them missing is small, IMHO.

-- 
-Austin


From paul.vriens.wine at gmail.com  Fri May 21 10:55:04 2010
From: paul.vriens.wine at gmail.com (Paul Vriens)
Date: Fri, 21 May 2010 17:55:04 +0200
Subject: taskmgr: Update Slovenian translation  [resend]
In-Reply-To: <4BF6AB42.5060205@gmail.com>
References: <4BF6AB42.5060205@gmail.com>
Message-ID: <4BF6ACD8.60707@gmail.com>

On 05/21/2010 05:48 PM, Matej ?pindler wrote:
> Anything wrong with this patch? I sent it a week ago and didn't receive
> any comments.
>
>
>
>
Hi Matej,

If you look at http://source.winehq.org/patches/ you will see that your 
patch (number 61589) had an apply failure.

I tried your patch just now and I don't have an apply failure here, so 
I'm not sure what went wrong.

-- 
Cheers,

Paul.


From dmitry at codeweavers.com  Fri May 21 11:07:40 2010
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 22 May 2010 01:07:40 +0900
Subject: dinput2
In-Reply-To: <4BF6A061.7080304@open-vote.org>
References: <AANLkTimmwRdoXZarvf195ilxuJSxUxG5Tb5Rbm2wM4DQ@mail.gmail.com>
	<4BF5DE9C.70209@kievinfo.com> <4BF60C12.8030503@open-vote.org>
	<AANLkTilBsTxUK25CCrRpVQUo4ikYK02DX-Sbp0QhGUS8@mail.gmail.com>
	<4BF6A061.7080304@open-vote.org>
Message-ID: <20100522010740.87a9abed.dmitry@codeweavers.com>

Scott Ritchie <scott at open-vote.org> wrote:

> current X implementations: XKB (European) and XIM (Asian) compete with
> eachother

That's not an issue, Windows has exactly the same problem just because
asian languages keyboard support is very complicated, and other languages
don't need that complexity (and huge slow down due to that).

>  - If you have a key on your keyboard to switch between US mode and
> "input mode" that can input other keys then we don't handle this well

Then don't map the layout switcher keys to character keys :-)

>  - A keyboard layout other than US English will leave you screwed if
> you're on an asian language

Not really, if your charset is UTF-8.

[skipped]

> Solution: rip out the mess in X, put everything in IBUS instead.
>  - User Session IBus daemon running, X talks to it
>  - xkeyboardconfig would need to be merged into IBUS
>  - X would be happy to remove keyboard stuff so they can focus on Video
> instead

Keyboard support can't be removed from X11 due to backwards compatibility and
remote display support.

All this doesn't list the real problem with X11 keyboard layouts support -
that a layout doesn't have a locale associated with it. So switching a keyboard
layout would also switch the input locale. Of course, UTF-8 locale has been
invented exactly to workaround that, so who cares... But if the input locale
really existed in X11, UTF-8 would not be really needed.

UTF-8 charset introduced a lot of problems (it is multibyte -> needs very
expensive handling/specially written applications which are multibyte aware,
handling of multibyte strings is a lot more slower that single byte ones).
RedHat bugzilla had a bug once UTF-8 has been introduced that grep worked
50 times slower in UTF-8 locale in comparison to simple en_US, but that bug
has been happily closed fairly quickly without a fix.

-- 
Dmitry.


From chris.kcat at gmail.com  Fri May 21 11:10:24 2010
From: chris.kcat at gmail.com (Chris Robinson)
Date: Fri, 21 May 2010 09:10:24 -0700
Subject: winemp3.acm: Avoid using the long type.
In-Reply-To: <20100521101336.GE2801@redhat.com>
References: <20100521101336.GE2801@redhat.com>
Message-ID: <201005210910.25073.chris.kcat@gmail.com>

On Friday, May 21, 2010 3:13:36 am Michael Stefaniuc wrote:
> @@ -191,7 +191,7 @@ static void mp3_horse(PACMDRVSTREAMINSTANCE adsi,
> 
>          if (ret == MPG123_NEW_FORMAT)
>          {
> -            long rate;
> +            LONG_PTR rate;
>              int channels, enc;
>              mpg123_getformat(amd->mh, &rate, &channels, &enc);

I'm not sure this change is correct, when the function itself is expecting a 
pointer to an actual long.


From marcus at jet.franken.de  Fri May 21 11:59:27 2010
From: marcus at jet.franken.de (Marcus Meissner)
Date: Fri, 21 May 2010 18:59:27 +0200
Subject: too much dynamic loading?
Message-ID: <20100521165927.GA5644@galeere.jet.franken.de>

Hi,

As libjpeg and libpng bumped their major versions in the last months
I had to adjust some of my library requires in my wine.spec file.

This caused me thinking if it is really necessary to dynamically
load nearly every library.

Can we make some of those direct linking? libjpeg and libpng
and some other lowlevel libraries might be useful.

Opinions?

Ciao, Marcus


From winehacker at gmail.com  Fri May 21 12:03:09 2010
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 21 May 2010 13:03:09 -0400
Subject: too much dynamic loading?
In-Reply-To: <20100521165927.GA5644@galeere.jet.franken.de>
References: <20100521165927.GA5644@galeere.jet.franken.de>
Message-ID: <AANLkTimHbwNpWn9ONj5hhOn-ZUUORWyERkv--U6l8XrC@mail.gmail.com>

On Fri, May 21, 2010 at 12:59 PM, Marcus Meissner <marcus at jet.franken.de> wrote:
> As libjpeg and libpng bumped their major versions in the last months
> I had to adjust some of my library requires in my wine.spec file.
>
> This caused me thinking if it is really necessary to dynamically
> load nearly every library.
>
> Can we make some of those direct linking? libjpeg and libpng
> and some other lowlevel libraries might be useful.

+1 for static linking them.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From marcus at jet.franken.de  Fri May 21 12:28:21 2010
From: marcus at jet.franken.de (Marcus Meissner)
Date: Fri, 21 May 2010 19:28:21 +0200
Subject: too much dynamic loading?
In-Reply-To: <AANLkTimHbwNpWn9ONj5hhOn-ZUUORWyERkv--U6l8XrC@mail.gmail.com>
References: <20100521165927.GA5644@galeere.jet.franken.de>
	<AANLkTimHbwNpWn9ONj5hhOn-ZUUORWyERkv--U6l8XrC@mail.gmail.com>
Message-ID: <20100521172821.GB5644@galeere.jet.franken.de>

On Fri, May 21, 2010 at 01:03:09PM -0400, Steven Edwards wrote:
> On Fri, May 21, 2010 at 12:59 PM, Marcus Meissner <marcus at jet.franken.de> wrote:
> > As libjpeg and libpng bumped their major versions in the last months
> > I had to adjust some of my library requires in my wine.spec file.
> >
> > This caused me thinking if it is really necessary to dynamically
> > load nearly every library.
> >
> > Can we make some of those direct linking? libjpeg and libpng
> > and some other lowlevel libraries might be useful.
> 
> +1 for static linking them.

No static linking either, its the nightmare of security maintainers ;)


But which distro doesnt have libjpeg or libpng? or libX11.so, libXext.so., libncurses.so...


To show what I mean ...  I currently have this line in my .spec file:

Requires:       libX11.so.6 libXext.so.6 libXcursor.so.1 libXi.so.6 libXxf86vm.so.1 libXrender.so.1 libXrandr.so.2 libXinerama.so
.1 libXcomposite.so.1 libGL.so.1 libGLU.so.1 libxslt.so.1 libncurses.so.5 libfreetype.so.6 libpng12.so.0 libjpeg.so.62 libfontcon
fig.so.1 libcups.so.2
to make sure everything is installed. I might forget stuff and so reduce functionality unintentionally.

While this is not necessary on 32bit systems, it is definitely necessary on a 64bit system, where 
the 32bit Wine has to pull its requires or they will not be installed.


Ciao, Marcus


From saulius2 at ar.fi.lt  Fri May 21 12:31:58 2010
From: saulius2 at ar.fi.lt (Saulius Krasuckas)
Date: Fri, 21 May 2010 20:31:58 +0300 (EEST)
Subject: software built and worked under wine but not in vista?
In-Reply-To: <387226.36868.qm@web23108.mail.ird.yahoo.com>
References: <387226.36868.qm@web23108.mail.ird.yahoo.com>
Message-ID: <alpine.DEB.1.10.1005211952510.8027@localhost.localdomain>

* On Fri, 21 May 2010, Hin-Tak Leung wrote:
> 
> > To check this, it would be nice to run "winetricks vcrun6", recomple 
> > the app in Wine and see if the resulting exe run OK on Vista.
> 
> Tried that - the binary differs by 6 bytes - just timestamp and 
> checksum. So using native msvcrt in vcrun6 has no effect.

To kindly process this situation you should enter a new bugreport, I 
guess.  This list isn't for analysing particular bugs :)

> > > There are a few differences I spotted between the two executables: 
> > > 1) setupgs-wine.exe has wrong image size, changing it from 0x2b200 
> > > to 0x2b000 makes the executable working under win7.
> 
> But that has to be a bug in wine - that it doesn't check the image size 
> and loads PE with an invalid image size? (how that end up being invalid 
> is a different issue).

It looks like that.  It would be nice to minimize resulting PE-image and 
to make some loader test from it.  To end it up into this file, eg.:  

 dlls/kernel32/tests/loader.c

Good luck with your future bug report :)


S.


From mstefani at redhat.com  Fri May 21 11:32:17 2010
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Fri, 21 May 2010 18:32:17 +0200
Subject: winemp3.acm: Avoid using the long type.
In-Reply-To: <201005210910.25073.chris.kcat@gmail.com>
References: <20100521101336.GE2801@redhat.com>
	<201005210910.25073.chris.kcat@gmail.com>
Message-ID: <4BF6B591.40607@redhat.com>

Chris Robinson wrote:
> On Friday, May 21, 2010 3:13:36 am Michael Stefaniuc wrote:
>> @@ -191,7 +191,7 @@ static void mp3_horse(PACMDRVSTREAMINSTANCE adsi,
>>
>>          if (ret == MPG123_NEW_FORMAT)
>>          {
>> -            long rate;
>> +            LONG_PTR rate;
>>              int channels, enc;
>>              mpg123_getformat(amd->mh, &rate, &channels, &enc);
> 
> I'm not sure this change is correct, when the function itself is expecting a 
> pointer to an actual long.
Yes, that's why I used LONG_PTR. That's the Win32 way of saying "I want
a real 'long' like everybody else is using" aka one that has the same
size as a pointer.

bye
	michael


From nerv at dawncrow.de  Fri May 21 12:56:28 2010
From: nerv at dawncrow.de (=?ISO-8859-1?Q?Andr=E9_Hentschel?=)
Date: Fri, 21 May 2010 19:56:28 +0200
Subject: software built and worked under wine but not in vista?
In-Reply-To: <506591.51077.qm@web23101.mail.ird.yahoo.com>
References: <506591.51077.qm@web23101.mail.ird.yahoo.com>
Message-ID: <4BF6C94C.5020500@dawncrow.de>

Am 21.05.2010 01:34, schrieb Hin-Tak Leung:
> --- On Thu, 20/5/10, Matijn Woudt <tijnema at gmail.com> wrote:
> 
>>>> * On Tue, 18 May 2010, Hin-Tak Leung wrote:
>>>>>
>>>>> So it seems that setupgs.exe is mis-compiled
>> under wine with win7 sdk but
>>>>> just happened to also work under wine. Any
>> idea how it might happen?
> 
>>> I have gone ahead and done exactly that - the correct
>> behavior should be a
>>> msg box saying filelist.txt is missing, rather than
>> setupgs.exe not a valid
>>> win32 application.
>>>
>>> http://www.ghostscript.com/~hintak/setupgs-vista.exe
>>> http://www.ghostscript.com/~hintak/setupgs-wine.exe
>>>
>>> I haven't tried the uninstaller yet, so I don't know
>> if the wine-built
>>> uninstaller work:
>>>
>>> http://www.ghostscript.com/~hintak/uninstgs-vista.exe
>>> http://www.ghostscript.com/~hintak/uninstgs-wine.exe
>>>
>>> To analyse the executables are a bit beyond me, but I
>> hope somebody can do
>>> that.
>>>
>>> under either system, if I compile the file twice
>> quickly, the result differs
>>> only by the datestamp and checksum (and in two
>> wine-compiled executable
>>> built a bit of time between , also a few bytes in the
>> .text section after
>>> what looks like an import table in a hex editor?
>>>
>>>
>>
>> There are a few differences I spotted between the two
>> executables:
>> 1) setupgs-wine.exe has wrong image size, changing it from
>> 0x2b200 to
>> 0x2b000 makes the executable working under win7.
>> 2) setupgs-wine.exe has wrong resource size, probably
>> related to 1),
>> because the size of both executables are the same.
>> 3) The assembly in setupgs-wine.exe has only LF line
>> endings, vista
>> has CRLF. This explains 2).
>>
>> I don't know the reason for 3), I assume it's a bug
>> somewhere in wine.
> 
> I tried uninstgs-wine.exe and it is also broken. What's more, the executable is of a different size. I am thinking 2 and 3 are probably red herrings, although it is curious how it happens. (I git-archive under unix and use winzip to extract them, so the manifests are the same, and have unix line endings.)
> 
> The ghostscript distribution has other executables besides setupgs.exe and uninstgs.exe (for install and uninstall), but only those two seem to be broken. Those two are also different in having been manipulated through mt. Could the running of mt be buggy?
> 
> mt -nologo -manifest $(PSSRC)dwsetup_x64.manifest -outputresource:$(SETUP_XE);#1
>  
> I have tried re-running mt on either a built executable or vista-compiled ones, but there are no modification. perhaps I don't understand what it does and how it does its work.
> 
compile your setupgs in wine but without the "mt-step" and try running it on vista.
if mt breaks the PE file then submit a bug report describing wrong behavior of mt.

-- 

Best Regards, Andr? Hentschel


From chris.kcat at gmail.com  Fri May 21 12:57:42 2010
From: chris.kcat at gmail.com (Chris Robinson)
Date: Fri, 21 May 2010 10:57:42 -0700
Subject: winemp3.acm: Avoid using the long type.
In-Reply-To: <201005211055.24913.chris.kcat@gmail.com>
References: <20100521101336.GE2801@redhat.com> <4BF6B591.40607@redhat.com>
	<201005211055.24913.chris.kcat@gmail.com>
Message-ID: <201005211057.42439.chris.kcat@gmail.com>

Now to the list...

On Friday, May 21, 2010 9:32:17 am you wrote:
> Chris Robinson wrote:
> > On Friday, May 21, 2010 3:13:36 am Michael Stefaniuc wrote:
> >> @@ -191,7 +191,7 @@ static void mp3_horse(PACMDRVSTREAMINSTANCE adsi,
> >> 
> >>          if (ret == MPG123_NEW_FORMAT)
> >>          {
> >> 
> >> -            long rate;
> >> +            LONG_PTR rate;
> >> 
> >>              int channels, enc;
> >>              mpg123_getformat(amd->mh, &rate, &channels, &enc);
> > 
> > I'm not sure this change is correct, when the function itself is
> > expecting a pointer to an actual long.
> 
> Yes, that's why I used LONG_PTR. That's the Win32 way of saying "I want
> a real 'long' like everybody else is using" aka one that has the same
> size as a pointer.

A LONG_PTR is a signed integer large enough to hold a pointer value. A long
may or may not be the same size. This would break if built for 64-bit
Windows, for example, where a long is still 32 bits (and what the 64-bit
Windows version of the lib will expect), while a LONG_PTR is 64 bits.


From winehacker at gmail.com  Fri May 21 12:58:19 2010
From: winehacker at gmail.com (Steven Edwards)
Date: Fri, 21 May 2010 13:58:19 -0400
Subject: too much dynamic loading?
In-Reply-To: <20100521172821.GB5644@galeere.jet.franken.de>
References: <20100521165927.GA5644@galeere.jet.franken.de>
	<AANLkTimHbwNpWn9ONj5hhOn-ZUUORWyERkv--U6l8XrC@mail.gmail.com>
	<20100521172821.GB5644@galeere.jet.franken.de>
Message-ID: <AANLkTikMjh6Dg5G286RbIR8YTDkFlgUNm5vnDje40tmW@mail.gmail.com>

On Fri, May 21, 2010 at 1:28 PM, Marcus Meissner <marcus at jet.franken.de>wrote:

>
> No static linking either, its the nightmare of security maintainers ;)
>
>
Good point. Direct Linking then. I am just in favor of changing it to
something other than the status quo because all of this dynamic loading
stuff never wants to work right on OS X.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and that is
an idea whose time has come." - Victor Hugo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100521/4a73b3a8/attachment.htm>

From nerv at dawncrow.de  Fri May 21 13:03:42 2010
From: nerv at dawncrow.de (=?UTF-8?B?QW5kcsOpIEhlbnRzY2hlbA==?=)
Date: Fri, 21 May 2010 20:03:42 +0200
Subject: [website] German translation of Only support Ubuntu 9.10 and 10.04
Message-ID: <4BF6CAFE.5010107@dawncrow.de>

---
 templates/de/download.template     |    2 +-
 templates/de/download/deb.template |   77 +++++++----------------------------
 2 files changed, 17 insertions(+), 62 deletions(-)



-- 

Best Regards, Andr? Hentschel
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-website-German-translation-of-Only-support-Ubuntu-9..patch
Type: text/x-patch
Size: 7726 bytes
Desc: not available
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100521/139e7a1a/attachment-0001.bin>

From jjmckenzie51 at earthlink.net  Fri May 21 13:46:09 2010
From: jjmckenzie51 at earthlink.net (James Mckenzie)
Date: Fri, 21 May 2010 11:46:09 -0700 (GMT-07:00)
Subject: Release plans
Message-ID: <12032721.1274467569712.JavaMail.root@elwamui-karabash.atl.sa.earthlink.net>

Austin English <austinenglish at gmail.com> wrote:
>
>On Fri, May 21, 2010 at 3:47 AM,  <Joerg-Cyril.Hoehle at t-systems.com> wrote:
>>>> And I didn't write trivial Mac patches either, e.g. to have
>>>> wineprefixcreate symlink c:\users\xyz\ Desktop + Videos + Documents +
>>>> Music to /Users/xyz/Desktop/ etc. ?This happens on Linux, not on MacOS.
>>>> That's another (example of a) missing element.
>>>> (Why didn't I write it? Because I was unsure where to put the #ifdef)
>>>Isn't that linking done relative to $HOME, which should resolve to
>>>/Users/xyz on Mac?
>> That's not the problem. What I also don't know is whether I could hardcode
>> the directories ~/Documents etc. (these already exist in my /Users/xyz,
>> (but what about Tiger?)), or whether I ought to call some OSX API that
>> yields the name of the dir (and possibly creates it if it does not yet exist).
>> I'm not familiar at all with Mac APIs, but it sounds like an easy patch
>> for somebody with a little MacOS programming knowledge.
>
>I haven't used Tiger in ages, but at least for me on Snow Leopard, I
>can't delete those directories, since OSX considers them 'essential to
>OS function'. The likelihood of them missing is small, IMHO.
>
Correct. However, you are free to create new directories for these functions and use them, except the Desktop.  The location of these files could be changed but that is mostly beyond most Mac Users.

Defaulting to $HOME/Desktop and $HOME/Documents is a good first step.

James McKenzie


From jjmckenzie51 at earthlink.net  Fri May 21 13:47:17 2010
From: jjmckenzie51 at earthlink.net (James Mckenzie)
Date: Fri, 21 May 2010 11:47:17 -0700 (GMT-07:00)
Subject: Fw: Re: Release plans
Message-ID: <3263523.1274467637487.JavaMail.root@elwamui-karabash.atl.sa.earthlink.net>

To the list.


-----Forwarded Message-----
>From: James Mckenzie <jjmckenzie51 at earthlink.net>
>Sent: May 21, 2010 8:20 AM
>To: Joerg-Cyril.Hoehle at t-systems.com
>Subject: Re: Release plans
>
>Joerg-Cyril.Hoehle at t-systems.com wrote: 
>>
>>>> And I didn't write trivial Mac patches either, e.g. to have
>>>> wineprefixcreate symlink c:\users\xyz\ Desktop + Videos + Documents +
>>>> Music to /Users/xyz/Desktop/ etc.  This happens on Linux, not on MacOS.
>>>> That's another (example of a) missing element.
>>>> (Why didn't I write it? Because I was unsure where to put the #ifdef)
>>>Isn't that linking done relative to $HOME, which should resolve to
>>>/Users/xyz on Mac?
>>That's not the problem. What I also don't know is whether I could hardcode
>>the directories ~/Documents etc.
>
>AFIAK, I would not hard code them, but give a default of $HOME/Documents and $HOME/Desktop (this would allow users to change the directory, maybe through the registry or through environment variables. (these already exist in my /Users/xyz,
>>but what about Tiger?
>
>I don't think there are many Intel Macs running Tiger anymore and Darwine is completely dead.
>
>>or whether I ought to call some OSX API that
>>yields the name of the dir (and possibly creates it if it does not yet exist).
>
>This is a third idea that we may want to look at.
>
>>I'm not familiar at all with Mac APIs, but it sounds like an easy patch
>>for somebody with a little MacOS programming knowledge.
>>
>Hmmm.
>>
>>>> What can Mac users expect from this release?
>>>Hopefully, conversion to Linux :-).
>>Actually, one day I was fed up with the Gnome and KDE4 GUIs,
>>so I started looking for something else. The Mac Mini with
>>NVidia came out right at that time: extremely silent (except
>>for the CD-ROM), excellent graphics (by far better than
>>any onboard Intel I knew previously) and it's a UNIX.
>>
>My feelings exactly.  If Gnome and KDE were so good, why are there other Linux windows management tools?
>
>James McKenzie



From nsivov at codeweavers.com  Fri May 21 13:51:20 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Fri, 21 May 2010 22:51:20 +0400
Subject: crypt32/tests: remove ret from testAddSerialized, where it's
	not 	really used
In-Reply-To: <AANLkTimKrUXqnhCfFd-9ZuwbMN_mYb2tP4rFoLcOLnRe@mail.gmail.com>
References: <AANLkTimKrUXqnhCfFd-9ZuwbMN_mYb2tP4rFoLcOLnRe@mail.gmail.com>
Message-ID: <4BF6D628.1060608@codeweavers.com>

On 5/21/2010 22:45, Austin English wrote:
> Gerald's made good progress here, there's only 81 of these left in
> wine-1.1.44-427-ga06a191.
>    

> -    BOOL ret;
>       CRYPT_DATA_BLOB blob = { 0, NULL };
>
> -    ret = CertSaveStore(store, X509_ASN_ENCODING, CERT_STORE_SAVE_AS_STORE,
> +    CertSaveStore(store, X509_ASN_ENCODING, CERT_STORE_SAVE_AS_STORE,
>    
Why not test for it?


From mstefani at redhat.com  Fri May 21 13:59:40 2010
From: mstefani at redhat.com (Michael Stefaniuc)
Date: Fri, 21 May 2010 20:59:40 +0200
Subject: winemp3.acm: Avoid using the long type.
In-Reply-To: <201005211057.42439.chris.kcat@gmail.com>
References: <20100521101336.GE2801@redhat.com>
	<4BF6B591.40607@redhat.com>	<201005211055.24913.chris.kcat@gmail.com>
	<201005211057.42439.chris.kcat@gmail.com>
Message-ID: <4BF6D81C.7050407@redhat.com>

On 05/21/2010 07:57 PM, Chris Robinson wrote:
> Now to the list...
>
> On Friday, May 21, 2010 9:32:17 am you wrote:
>> Chris Robinson wrote:
>>> On Friday, May 21, 2010 3:13:36 am Michael Stefaniuc wrote:
>>>> @@ -191,7 +191,7 @@ static void mp3_horse(PACMDRVSTREAMINSTANCE adsi,
>>>>
>>>>           if (ret == MPG123_NEW_FORMAT)
>>>>           {
>>>>
>>>> -            long rate;
>>>> +            LONG_PTR rate;
>>>>
>>>>               int channels, enc;
>>>>               mpg123_getformat(amd->mh,&rate,&channels,&enc);
>>>
>>> I'm not sure this change is correct, when the function itself is
>>> expecting a pointer to an actual long.
>>
>> Yes, that's why I used LONG_PTR. That's the Win32 way of saying "I want
>> a real 'long' like everybody else is using" aka one that has the same
>> size as a pointer.
>
> A LONG_PTR is a signed integer large enough to hold a pointer value. A long
> may or may not be the same size. This would break if built for 64-bit
> Windows, for example, where a long is still 32 bits (and what the 64-bit
> Windows version of the lib will expect), while a LONG_PTR is 64 bits.
mpg123_getformat() is a host native lib aka a unix lib thus expects a 
"unix long". A "unix long" translates to LONG_PTR in Wine. My patch is 
actually a no-op.

bye
	michael


From chris.kcat at gmail.com  Fri May 21 14:13:37 2010
From: chris.kcat at gmail.com (Chris Robinson)
Date: Fri, 21 May 2010 12:13:37 -0700
Subject: winemp3.acm: Avoid using the long type.
In-Reply-To: <4BF6D81C.7050407@redhat.com>
References: <20100521101336.GE2801@redhat.com>
	<201005211057.42439.chris.kcat@gmail.com>
	<4BF6D81C.7050407@redhat.com>
Message-ID: <201005211213.37516.chris.kcat@gmail.com>

On Friday, May 21, 2010 11:59:40 am Michael Stefaniuc wrote:
> mpg123_getformat() is a host native lib aka a unix lib thus expects a
> "unix long". A "unix long" translates to LONG_PTR in Wine. My patch is
> actually a no-op.

The lib is also available for Windows, and AFAIK there's no reason winemp3.acm 
can't otherwise be built for Win64. I don't really know what Wine's policy is 
for what modules should be compatible for Windows builds, though.


From hintak_leung at yahoo.co.uk  Fri May 21 23:16:08 2010
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Sat, 22 May 2010 04:16:08 +0000 (GMT)
Subject: software built and worked under wine but not in vista?
In-Reply-To: <4BF6C94C.5020500@dawncrow.de>
Message-ID: <753101.20238.qm@web23101.mail.ird.yahoo.com>

--- On Fri, 21/5/10, Andr? Hentschel <nerv at dawncrow.de> wrote:

> compile your setupgs in wine but without the "mt-step" and
> try running it on vista.
> if mt breaks the PE file then submit a bug report
> describing wrong behavior of mt.

This is what I am doing next. I have also made a change to ghostscript trunk (r11296) so that the installer/uninstaller executables can be built ahead or independent of the rest. (they are normally built last so there were some hidden assumptions about some files being already generated).

I'll upload a source tarball to http://ghostscript.com/~hintak/ as *winedebug.tar.gz soon
with a small workaround (there is a bug about cmd/cp I filed and a work around in wine's bugzilla). To build the binaries do:

nmake -f psi/msvc32.mak bin\setupgs.exe bin\uninstgs.exe

I'll put all these in two bug reports - it is looking like two bugs;
- one where binaries are miscompiled
- wine's loader does not complain about the mis-compiled executables, but windows vista or win7 do.



      


From austinenglish at gmail.com  Sat May 22 00:34:31 2010
From: austinenglish at gmail.com (Austin English)
Date: Sat, 22 May 2010 00:34:31 -0500
Subject: crypt32/tests: remove ret from testAddSerialized, where it's not 
	really used
In-Reply-To: <4BF6D628.1060608@codeweavers.com>
References: <AANLkTimKrUXqnhCfFd-9ZuwbMN_mYb2tP4rFoLcOLnRe@mail.gmail.com> 
	<4BF6D628.1060608@codeweavers.com>
Message-ID: <AANLkTikC5Otl-9EbFTz_5Aa1DP-z-oBONAWu1hvNGc6F@mail.gmail.com>

On Fri, May 21, 2010 at 1:51 PM, Nikolay Sivov <nsivov at codeweavers.com> wrote:
> On 5/21/2010 22:45, Austin English wrote:
>>
>> Gerald's made good progress here, there's only 81 of these left in
>> wine-1.1.44-427-ga06a191.
>>
>
>> - ? ?BOOL ret;
>> ? ? ?CRYPT_DATA_BLOB blob = { 0, NULL };
>>
>> - ? ?ret = CertSaveStore(store, X509_ASN_ENCODING,
>> CERT_STORE_SAVE_AS_STORE,
>> + ? ?CertSaveStore(store, X509_ASN_ENCODING, CERT_STORE_SAVE_AS_STORE,
>>
>
> Why not test for it?

Fair enough. Will resend.

-- 
-Austin


From arethusa26 at gmail.com  Sat May 22 02:12:34 2010
From: arethusa26 at gmail.com (Andrew Nguyen)
Date: Sat, 22 May 2010 02:12:34 -0500
Subject: kernel32/tests: check return value of alarmThread in 
	test_NamedPipe_2()
In-Reply-To: <AANLkTilGFLHNOeQTm2FcCRBgDP121RdyGWuHh02eoU0y@mail.gmail.com>
References: <AANLkTilGFLHNOeQTm2FcCRBgDP121RdyGWuHh02eoU0y@mail.gmail.com>
Message-ID: <AANLkTinMqE08B3352pJwyOEy7U3wCBiry5Qq7Ddi4B6a@mail.gmail.com>

On Sat, May 22, 2010 at 2:06 AM, Austin English <austinenglish at gmail.com> wrote:
> Also fix a typo.
>
> Passes WTB:
> https://testbot.winehq.org/JobDetails.pl?Key=2242
>
> --
> -Austin
>
>
>
>

While you're at it, you might as well fix the "change" typo.


From dmitry at codeweavers.com  Sat May 22 02:13:24 2010
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 22 May 2010 16:13:24 +0900
Subject: gdi32/tests: use ret in test_CreateFontIndirect()
In-Reply-To: <AANLkTimYDYhGb1tO9vuQE6EKrMUPFmMg2TeAho92y4oP@mail.gmail.com>
References: <AANLkTimYDYhGb1tO9vuQE6EKrMUPFmMg2TeAho92y4oP@mail.gmail.com>
Message-ID: <20100522161324.c2aa79f0.dmitry@codeweavers.com>

Austin English <austinenglish at gmail.com> wrote:

> @@ -3096,6 +3096,7 @@ static void test_CreateFontIndirect(void)
>          hfont = CreateFontIndirectA(&lf);
>          ok(hfont != 0, "CreateFontIndirectA failed\n");
>          ret = GetObject(hfont, sizeof(getobj_lf), &getobj_lf);
> +        ok(ret, "GetObject failed: %08x\n", GetLastError());

Printing last error without prior setting it to 0xdeadfeef won't really
help. Also errors returned by GetLastError() are defined in decimal in
winerror.h.

-- 
Dmitry.


From dmitry at codeweavers.com  Sat May 22 02:15:49 2010
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 22 May 2010 16:15:49 +0900
Subject: kernel32/tests: use ret in load_blackbox()
In-Reply-To: <AANLkTilKx5JCxkYtxN9eVQZwsDlAWNLIiUg_PKWPzs7e@mail.gmail.com>
References: <AANLkTilKx5JCxkYtxN9eVQZwsDlAWNLIiUg_PKWPzs7e@mail.gmail.com>
Message-ID: <20100522161549.751007ea.dmitry@codeweavers.com>

Austin English <austinenglish at gmail.com> wrote:

>      ret=ReadFile(hFile, blackbox, size, &read, NULL);
> +    ok(ret, "ReadFile failed: %08x\n", GetLastError());

Printing last error without prior setting it to 0xdeadfeef won't really
help. Also errors returned by GetLastError() are defined in decimal in
winerror.h.

-- 
Dmitry.


From dmitry at codeweavers.com  Sat May 22 02:17:51 2010
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 22 May 2010 16:17:51 +0900
Subject: kernel32/tests: check return value of alarmThread in 
	test_NamedPipe_2()
In-Reply-To: <AANLkTilGFLHNOeQTm2FcCRBgDP121RdyGWuHh02eoU0y@mail.gmail.com>
References: <AANLkTilGFLHNOeQTm2FcCRBgDP121RdyGWuHh02eoU0y@mail.gmail.com>
Message-ID: <20100522161751.ba5f7136.dmitry@codeweavers.com>

Austin English <austinenglish at gmail.com> wrote:

>      alarmThread = CreateThread(NULL, 0, alarmThreadMain, (void *) 20000, 0, &alarmThreadId);
> +    ok(alarmThread != INVALID_HANDLE_VALUE, "CreateThread\n");

CreateThread doesn't return INVALID_HANDLE_VALUE on failure. Clarifying
the error message and printing last error (in decimal) would be better.

-- 
Dmitry.


From testbot at testbot.winehq.org  Sat May 22 03:13:54 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sat, 22 May 2010 10:13:54 +0200
Subject: kernel32/tests: use ret in load_blackbox() 
Message-ID: <201005220813.o4M8DsDu004827@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2243

Your paranoid android.


=== W7PROX64 (64 bit debugger) ===
debugger.c:301: Test failed: Timed out waiting for the child to crash
debugger.c:315: Test failed: wrong exit code : 00000103
debugger.c:326: Test failed: Timed out waiting for the debugger
debugger.c:148: Test failed: wrong size for 'C:\Users\winetest\AppData\Local\Temp\wtADEB.tmp': read=0
debugger.c:331: Test failed: wrong debugger argument count: -28562032
debugger.c:332: Test failed: the child and debugged pids don't match: 2612 != 2046
debugger.c:301: Test failed: Timed out waiting for the child to crash
debugger.c:308: Test failed: wrong exit code : 00000103
debugger.c:326: Test failed: Timed out waiting for the debugger
debugger.c:148: Test failed: wrong size for 'C:\Users\winetest\AppData\Local\Temp\wt82DC.tmp': read=0
debugger.c:331: Test failed: wrong debugger argument count: -28562032
debugger.c:332: Test failed: the child and debugged pids don't match: 2412 != 2046
Timeout


From dmitry at codeweavers.com  Sat May 22 03:45:51 2010
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sat, 22 May 2010 17:45:51 +0900
Subject: user32/tests: check return value of GetUpdateRect in
	test_validatergn
In-Reply-To: <AANLkTin2C49d8pvTHpgPAh6UCRqYF8YmkRfUMjWYOpb8@mail.gmail.com>
References: <AANLkTin2C49d8pvTHpgPAh6UCRqYF8YmkRfUMjWYOpb8@mail.gmail.com>
Message-ID: <20100522174551.f78c8ad6.dmitry@codeweavers.com>

Austin English <austinenglish at gmail.com> wrote:

>      ValidateRect( hwnd, &rc);
>      ret = GetUpdateRect( child, &rc2, 0);
> +    ok(!ret, "GetUpdateRect failed %08x\n", GetLastError());
>      ok( rc2.left == 0 && rc2.top == 0 && rc2.right == 0 && rc2.bottom == 0,
>              "Update rectangle %d,%d-%d,%d is not empty!\n", rc2.left, rc2.top,
>              rc2.right, rc2.bottom);
> @@ -3228,6 +3230,7 @@ static void test_validatergn(HWND hwnd)
>      rgn = CreateRectRgnIndirect( &rc);
>      ValidateRgn( hwnd, rgn);
>      ret = GetUpdateRect( child, &rc2, 0);
> +    ok(!ret, "GetUpdateRect failed %08x\n", GetLastError());

Please set last error to 0xdeadbeef prior checking it, and print last error
value in decimal.

-- 
Dmitry.


From testbot at testbot.winehq.org  Sat May 22 04:38:16 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sat, 22 May 2010 11:38:16 +0200
Subject: user32/tests: check return value of DdeClientTransaction in
	test_initialisation() 
Message-ID: <201005220938.o4M9cGJ2010058@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2250

Your paranoid android.


=== W98SE (32 bit dde) ===
dde.c:586: Test failed: Expected TestDDEServer(, got TestDDEServer:(04dc)
dde.c:588: Test failed: Got size 20 for TestDDEServer:(04dc)
dde.c:934: Test failed: Expected 0, got 0000c1ae
dde.c:939: Test failed: Expected item atom, got 008307f4
dde.c:2042: Test failed: Expected 0xdeadbeef, got 00000083


From testbot at testbot.winehq.org  Sat May 22 04:49:22 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sat, 22 May 2010 11:49:22 +0200
Subject: user32/tests: check return value of GetUpdateRect in
	test_validatergn 
Message-ID: <201005220949.o4M9nMvL010482@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2251

Your paranoid android.


=== W7PRO (32 bit win) ===
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 006C0178 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 006E0178 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00060138 fg 00010040 in hook HCBT_SETFOCUS
win.c:2664: Test failed: GetActiveWindow() = 00000000
win.c:2664: Test failed: GetFocus() = 00000000
win.c:2690: Test failed: GetActiveWindow() = 00000000
win.c:2690: Test failed: GetFocus() = 00000000
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00070138 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00070136 fg 00010040 in hook HCBT_SETFOCUS
win.c:2749: Test failed: GetActiveWindow() = 00000000
win.c:2749: Test failed: GetFocus() = 00000000
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00070132 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00300138 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00310138 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00090136 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 000D0136 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 000E0136 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 007F0178 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00020142 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00070132 fg 00010040 in hook HCBT_SETFOCUS


From austinenglish at gmail.com  Sat May 22 05:03:00 2010
From: austinenglish at gmail.com (Austin English)
Date: Sat, 22 May 2010 05:03:00 -0500
Subject: kernel32/tests: check return value of alarmThread in 
	test_NamedPipe_2()
In-Reply-To: <20100522161751.ba5f7136.dmitry@codeweavers.com>
References: <AANLkTilGFLHNOeQTm2FcCRBgDP121RdyGWuHh02eoU0y@mail.gmail.com> 
	<20100522161751.ba5f7136.dmitry@codeweavers.com>
Message-ID: <AANLkTil0YbieEvG-J-B8ZQbhjS7XoCftA64XhJR5lFVv@mail.gmail.com>

On Sat, May 22, 2010 at 2:17 AM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> Austin English <austinenglish at gmail.com> wrote:
>
>> ? ? ?alarmThread = CreateThread(NULL, 0, alarmThreadMain, (void *) 20000, 0, &alarmThreadId);
>> + ? ?ok(alarmThread != INVALID_HANDLE_VALUE, "CreateThread\n");
>
> CreateThread doesn't return INVALID_HANDLE_VALUE on failure. Clarifying
> the error message and printing last error (in decimal) would be better.

I got that information from the server tests that followed it:

    /* Try server #1 */
    serverThread = CreateThread(NULL, 0, serverThreadMain1, (void *)8,
0, &serverThreadId);
    ok(serverThread != INVALID_HANDLE_VALUE, "CreateThread\n");
    exercizeServer(PIPENAME "serverThreadMain1", serverThread);

    /* Try server #2 */
    serverThread = CreateThread(NULL, 0, serverThreadMain2, 0, 0,
&serverThreadId);
    ok(serverThread != INVALID_HANDLE_VALUE, "CreateThread\n");
    exercizeServer(PIPENAME "serverThreadMain2", serverThread);

    /* Try server #3 */
    serverThread = CreateThread(NULL, 0, serverThreadMain3, 0, 0,
&serverThreadId);
    ok(serverThread != INVALID_HANDLE_VALUE, "CreateThread\n");
    exercizeServer(PIPENAME "serverThreadMain3", serverThread);

    /* Try server #4 */
    serverThread = CreateThread(NULL, 0, serverThreadMain4, 0, 0,
&serverThreadId);
    ok(serverThread != INVALID_HANDLE_VALUE, "CreateThread\n");
    exercizeServer(PIPENAME "serverThreadMain4", serverThread);

I've resent the patch with the alarmThread and serverThread cases
fixed. Thanks for the review!

-- 
-Austin


From testbot at testbot.winehq.org  Sat May 22 05:19:19 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sat, 22 May 2010 12:19:19 +0200
Subject: kernel32/tests: use ret in load_blackbox() (try 2) 
Message-ID: <201005221019.o4MAJJc5011511@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2254

Your paranoid android.


=== W7PROX64 (64 bit debugger) ===
debugger.c:302: Test failed: Timed out waiting for the child to crash
debugger.c:316: Test failed: wrong exit code : 00000103
debugger.c:327: Test failed: Timed out waiting for the debugger
debugger.c:149: Test failed: wrong size for 'C:\Users\winetest\AppData\Local\Temp\wtDCAB.tmp': read=0
debugger.c:332: Test failed: wrong debugger argument count: -28562032
debugger.c:333: Test failed: the child and debugged pids don't match: 368 != 2046
debugger.c:302: Test failed: Timed out waiting for the child to crash
debugger.c:309: Test failed: wrong exit code : 00000103
debugger.c:327: Test failed: Timed out waiting for the debugger
debugger.c:149: Test failed: wrong size for 'C:\Users\winetest\AppData\Local\Temp\wtB1BC.tmp': read=0
debugger.c:332: Test failed: wrong debugger argument count: -28562032
debugger.c:333: Test failed: the child and debugged pids don't match: 2404 != 2046
Timeout


From testbot at testbot.winehq.org  Sat May 22 05:51:56 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Sat, 22 May 2010 12:51:56 +0200
Subject: user32/tests: check return value of GetUpdateRect in
	test_validatergn (try 2) 
Message-ID: <201005221051.o4MApu9p012814@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2258

Your paranoid android.


=== W7PRO (32 bit win) ===
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00730134 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00750134 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00060138 fg 00010040 in hook HCBT_SETFOCUS
win.c:2664: Test failed: GetActiveWindow() = 00000000
win.c:2664: Test failed: GetFocus() = 00000000
win.c:2690: Test failed: GetActiveWindow() = 00000000
win.c:2690: Test failed: GetFocus() = 00000000
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00070138 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00770134 fg 00010040 in hook HCBT_SETFOCUS
win.c:2749: Test failed: GetActiveWindow() = 00000000
win.c:2749: Test failed: GetFocus() = 00000000
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00040224 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00A00134 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00A10134 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00060136 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 000A0136 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 000B0136 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00190138 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00020142 fg 00010040 in hook HCBT_SETFOCUS
win.c:823: Test failed: wrong dwWindowStatus: 0000 != 0001 active 00040224 fg 00010040 in hook HCBT_SETFOCUS


From arethusa26 at gmail.com  Sat May 22 09:44:11 2010
From: arethusa26 at gmail.com (Andrew Nguyen)
Date: Sat, 22 May 2010 09:44:11 -0500
Subject: kernel32/tests: check return value of alarmThread in 
	test_NamedPipe_2() (try 2)
In-Reply-To: <AANLkTilgj07KQys-bdcMU4plQNy0pYddbe76mGJlgsT8@mail.gmail.com>
References: <AANLkTilgj07KQys-bdcMU4plQNy0pYddbe76mGJlgsT8@mail.gmail.com>
Message-ID: <AANLkTikvztZz6zLBkYTwgAhPhklpB95BTBZyIgppE1go@mail.gmail.com>

On Sat, May 22, 2010 at 5:02 AM, Austin English <austinenglish at gmail.com> wrote:
> Changes from try 1:
> Fix another typo.
> Set LastError before checking it
> Print LastError as a decimal
> Don't check for INVALID_HANDLE_VALUE as a return value of
> CreateThread, instead make sure serverThread is not NULL.
>
> --
> -Austin
>
>
>
>

You're calling SetLastError(0xdeadbeef) at the wrong time in the pipe
server subtests. If CreateThread fails, you will unconditionally print
the decimal representation of 0xdeadbeef in the failure messages.
SetLastError has to be called before CreateThread to ensure that the
failure messages print a last error that the preceding CreateThread
call sets.


From wolfram at the-dreams.de  Sat May 22 10:15:47 2010
From: wolfram at the-dreams.de (Wolfram Sang)
Date: Sat, 22 May 2010 17:15:47 +0200
Subject: make "bisected" a keyword in bugzilla?
Message-ID: <4BF7F523.5050201@the-dreams.de>

Hi,

I noticed that Wylda uses "--private keyword: bisected" when appropriate.
IMHO this could be useful as a real keyword, e.g. if you search for bugs
you'd like to try tackling. Has this been considered already?

Regards,

   Wolfram


From dmitry at codeweavers.com  Sat May 22 10:19:10 2010
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 23 May 2010 00:19:10 +0900
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <4BF7F523.5050201@the-dreams.de>
References: <4BF7F523.5050201@the-dreams.de>
Message-ID: <20100523001910.22126ab6.dmitry@codeweavers.com>

Wolfram Sang <wolfram at the-dreams.de> wrote:

> I noticed that Wylda uses "--private keyword: bisected" when appropriate.
> IMHO this could be useful as a real keyword, e.g. if you search for bugs
> you'd like to try tackling. Has this been considered already?

There is a keyword 'regression', that should be enough.

-- 
Dmitry.


From m.b.lankhorst at gmail.com  Sat May 22 10:20:26 2010
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sat, 22 May 2010 17:20:26 +0200
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <4BF7F523.5050201@the-dreams.de>
References: <4BF7F523.5050201@the-dreams.de>
Message-ID: <4BF7F63A.7060700@gmail.com>

Hello,

On 22-05-10 17:15, Wolfram Sang wrote:
> I noticed that Wylda uses "--private keyword: bisected" when appropriate.
> IMHO this could be useful as a real keyword, e.g. if you search for bugs
> you'd like to try tackling. Has this been considered already?
>    
I don't think that keyword is needed, since there is already a keyword 
'regression' for this.

Cheers,
Maarten


From damjan.jov at gmail.com  Sat May 22 11:27:50 2010
From: damjan.jov at gmail.com (Damjan Jovanovic)
Date: Sat, 22 May 2010 18:27:50 +0200
Subject: Release plans
In-Reply-To: <AANLkTinbzhouez1bGPCk6NAtFHk_0LLOWREEbVTol7hC@mail.gmail.com>
References: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
	<AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com>
	<AANLkTikoWzFqD-Ee2kFjwVlo2ElMMl4OchrymfC3WVqz@mail.gmail.com>
	<AANLkTin4WTKwlX4KWum9HOFBB5mv--dd6sqcDMszQ8EJ@mail.gmail.com>
	<AANLkTinwyxF3lmv9V5528ky1eGnarWaR-1ZsQQ_mLYsu@mail.gmail.com>
	<AANLkTilcy3ePboWAqdDaf03jCxmqv79JrrX9w4Kmas-i@mail.gmail.com>
	<AANLkTinbzhouez1bGPCk6NAtFHk_0LLOWREEbVTol7hC@mail.gmail.com>
Message-ID: <AANLkTinefSXllqR1DsBwi6NqRGBffKyu6nWqdYMtkGp0@mail.gmail.com>

On Thu, May 20, 2010 at 10:25 PM, Steven Edwards <winehacker at gmail.com> wrote:
> On Thu, May 20, 2010 at 4:17 PM, Steven Edwards <winehacker at gmail.com> wrote:
>> I've tried with other PNGs before that we've not generated. Take a
>> third party png, edit the Info.plist and change the icon entry to
>> instead of pointing at the icns file point at the new Png image. Of
>> course I've tried this on Leopard, perhaps the behaviour is different
>> on snow leopard, I don't have a copy of it here.
>
> I am pretty sure the png support is iPod/Pad/Phone only. There may be
> some magic flag to allow OS X to use png rather than icns but I can't
> find it from google.
>
> --
> Steven Edwards
>
> "There is one thing stronger than all the armies in the world, and
> that is an idea whose time has come." - Victor Hugo
>

My latest patch set (http://source.winehq.org/patches/data/61966,
http://source.winehq.org/patches/data/61967,
http://source.winehq.org/patches/data/61968,
http://source.winehq.org/patches/data/61969,
http://source.winehq.org/patches/data/61970) moves all icon generation
in winemenubuilder to use windowscodecs and only outputs PNG icons.
This should make it pretty easy to add ICNS icon support.

If you're going to test this before it gets committed, be sure to also
grab http://source.winehq.org/patches/data/61940 which fixes a nasty
bug in windowscodecs that corrupts many paletted ICO files. I think
this was the cause of the image corruption and RGB/BGR issue Steven
reported in his experiments with windowscodecs in early February.

J?rg can you test whether you still get icons with black backgrounds
with these patches?

Damjan


From juan.lang at gmail.com  Sat May 22 12:09:35 2010
From: juan.lang at gmail.com (Juan Lang)
Date: Sat, 22 May 2010 10:09:35 -0700
Subject: crypt32: use ret in compareStore() (try 2)
Message-ID: <AANLkTikKmf3vINOLW0ERV7Va3AX5hfLFHu3w7v2Sv1cS@mail.gmail.com>

Hi Austin,

+    SetLastError(0xdeadbeef);
     ret = CertSaveStore(store, X509_ASN_ENCODING, CERT_STORE_SAVE_AS_STORE,
      CERT_STORE_SAVE_TO_MEMORY, &blob, 0);
+    todo_wine ok(ret && GetLastError() == CRYPT_E_NOT_FOUND,
"CertSaveStore failed. Expected CRYPT_E_NOT_FOUND, got %d\n",
GetLastError());

In general we don't check last error when a function succeeds.  I
think an ok(ret, ...) would be fine here.

Also, I think it's neater to print crypt errors as %08x, as the errors
are generally 0x8009....

Thanks for fixing this, I was just sloppy not to have checked ret in
the first place!
--Juan


From madewokherd at gmail.com  Sat May 22 12:13:39 2010
From: madewokherd at gmail.com (Vincent Povirk)
Date: Sat, 22 May 2010 12:13:39 -0500
Subject: [5/5] winemenubuilder: remove legacy PNG and XPM conversion code
In-Reply-To: <AANLkTila7xB4KUHlmJqu-RUg8YNQ9KnWNufCbAMzr_v7@mail.gmail.com>
References: <AANLkTila7xB4KUHlmJqu-RUg8YNQ9KnWNufCbAMzr_v7@mail.gmail.com>
Message-ID: <AANLkTik1GMIpEGvaeAWh-bBl3uenX9sDiTWyHdi3YwSZ@mail.gmail.com>

Fools! With this patch, the WIC empire shall finally be complete.

Er, I mean, this is pretty cool. And thanks for the ICO decoder fix.

On Sat, May 22, 2010 at 11:01 AM, Damjan Jovanovic <damjan.jov at gmail.com> wrote:
> Changelog:
> * winemenubuilder: remove legacy PNG and XPM conversion code
>
> The patch may look frighteningly long but the majority is just
> harmless deletions :-).
>
> Damjan Jovanovic
>
>
>
>


From austinenglish at gmail.com  Sat May 22 14:01:43 2010
From: austinenglish at gmail.com (Austin English)
Date: Sat, 22 May 2010 14:01:43 -0500
Subject: kernel32/tests: check return value of alarmThread in 
	test_NamedPipe_2() (try 2)
In-Reply-To: <AANLkTikvztZz6zLBkYTwgAhPhklpB95BTBZyIgppE1go@mail.gmail.com>
References: <AANLkTilgj07KQys-bdcMU4plQNy0pYddbe76mGJlgsT8@mail.gmail.com> 
	<AANLkTikvztZz6zLBkYTwgAhPhklpB95BTBZyIgppE1go@mail.gmail.com>
Message-ID: <AANLkTikjYefNzwJASSSSyyizt9HOKPxxtRkgyRBKFjPB@mail.gmail.com>

On Sat, May 22, 2010 at 9:44 AM, Andrew Nguyen <arethusa26 at gmail.com> wrote:
> On Sat, May 22, 2010 at 5:02 AM, Austin English <austinenglish at gmail.com> wrote:
>> Changes from try 1:
>> Fix another typo.
>> Set LastError before checking it
>> Print LastError as a decimal
>> Don't check for INVALID_HANDLE_VALUE as a return value of
>> CreateThread, instead make sure serverThread is not NULL.
>>
>> --
>> -Austin
>>
>>
>>
>>
>
> You're calling SetLastError(0xdeadbeef) at the wrong time in the pipe
> server subtests. If CreateThread fails, you will unconditionally print
> the decimal representation of 0xdeadbeef in the failure messages.
> SetLastError has to be called before CreateThread to ensure that the
> failure messages print a last error that the preceding CreateThread
> call sets.

No more coding at 4:00 AM. Resending, thanks.

-- 
-Austin


From wylda at volny.cz  Sat May 22 15:50:18 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Sat, 22 May 2010 22:50:18 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_make_=22bisected=22_a_keyword_in_bugzilla=3F?=
In-Reply-To: <20100523001910.22126ab6.dmitry@codeweavers.com>
References: <4BF7F523.5050201@the-dreams.de>
	<20100523001910.22126ab6.dmitry@codeweavers.com>
Message-ID: <8c24617f99a8b895984e0dcdf0fb436f@www3-mail.volny.cz>

> Wolfram Sang <wolfram at the-dreams.de> wrote:
> 
> > I noticed that Wylda uses "--private keyword: bisected"
> > when appropriate. IMHO this could be useful as a real keyword, e.g.
> > > > if you search for bugs you'd like to try tackling. Has this been
> > considered already?
> > 
> There is a keyword 'regression', that should be enough.

Hi, it depends, if regressions are considered as bugs of top priorites.

I would wish, if they could be considered, because killing them early
means, that quality of wine is not getting worse during the ongoing
development.

Imagine, that someone used to have a working game in 1.1.42 and his distro
offers him upgrade to 1.1.44. He goes ahead with upgrade and apps stops
working. He fills in a bug - UNCONFIRMED & REGRESSION keyword. Then
someone other have exactly the same problem, so confirms that and we
have the bug with NEW & REGRESSION. So something serious, which should
attract dev's attention. But when developer begins to work on that,
he spends some time with getting the demo, verifies it's behaviour and
then finds out, that the problem is wrong Ubuntu package. So his time
with this bug was wasted.

Compare this with regressions which are bisected (aka "bug served on
silver tray"), so saves a lot of time. And of course such a keyword
would help in dev's triage what to fix first.

Of course this has a sence and helps only if _truly_confirmed_ regressions
are taken seriously, i.e. fixed as first. But Wine is still not in this
state.




From nsivov at codeweavers.com  Sat May 22 16:06:11 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Sun, 23 May 2010 01:06:11 +0400
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <8c24617f99a8b895984e0dcdf0fb436f@www3-mail.volny.cz>
References: <4BF7F523.5050201@the-dreams.de>	<20100523001910.22126ab6.dmitry@codeweavers.com>
	<8c24617f99a8b895984e0dcdf0fb436f@www3-mail.volny.cz>
Message-ID: <4BF84743.8010906@codeweavers.com>

On 5/23/2010 00:50, wylda at volny.cz wrote:
>> Wolfram Sang<wolfram at the-dreams.de>  wrote:
>>
>>      
>>> I noticed that Wylda uses "--private keyword: bisected"
>>> when appropriate. IMHO this could be useful as a real keyword, e.g.
>>>        
>>>>> if you search for bugs you'd like to try tackling. Has this been
>>>>>            
>>> considered already?
>>>
>>>        
>> There is a keyword 'regression', that should be enough.
>>      
> Hi, it depends, if regressions are considered as bugs of top priorites.
>
> I would wish, if they could be considered, because killing them early
> means, that quality of wine is not getting worse during the ongoing
> development.
>
> Imagine, that someone used to have a working game in 1.1.42 and his distro
> offers him upgrade to 1.1.44. He goes ahead with upgrade and apps stops
> working. He fills in a bug - UNCONFIRMED&  REGRESSION keyword. Then
> someone other have exactly the same problem, so confirms that and we
> have the bug with NEW&  REGRESSION. So something serious, which should
> attract dev's attention. But when developer begins to work on that,
> he spends some time with getting the demo, verifies it's behaviour and
> then finds out, that the problem is wrong Ubuntu package. So his time
> with this bug was wasted.
>    
I believe developer's attention doesn't depend on bug state 
(confirmed/uncofirmed) at all.

The flow is to try to fix regressions caused by your own patches if it's 
not too complicated and there's
nothing more serious to do at this point. If it's too complicated to fix 
fast and a lot of apps (potentially) affected
a change is reverted.
> Compare this with regressions which are bisected (aka "bug served on
> silver tray"), so saves a lot of time. And of course such a keyword
> would help in dev's triage what to fix first.
>    
Actually a "regression" keyword supposes to mean exactly the same. It 
just happens that
it's added every time someone decided to add it. IMO it should be added 
only when regression
test results are available but this isn't going to happen of course for 
obvious reasons (some reporters don't
bother to respond in months). If no test was performed a developer will 
see a report anyway,
searching for a module of interest.

> Of course this has a sence and helps only if _truly_confirmed_ regressions
> are taken seriously, i.e. fixed as first. But Wine is still not in this
> state.
>    



From wylda at volny.cz  Sat May 22 16:22:53 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Sat, 22 May 2010 23:22:53 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_make_=22bisected=22_a_keyword_in_bugzilla=3F?=
In-Reply-To: <4BF84743.8010906@codeweavers.com>
References: <4BF7F523.5050201@the-dreams.de>	<20100523001910.22126ab6.dmitry@codeweavers.com>
	<8c24617f99a8b895984e0dcdf0fb436f@www3-mail.volny.cz>
	<4BF84743.8010906@codeweavers.com>
Message-ID: <019d1e05b128d3d0771022155b04b500@www3-mail.volny.cz>

> > Compare this with regressions which are bisected
> > (aka "bug served on silver tray"), so saves a lot of time. And of
> > > > course such a keyword would help in dev's triage what to fix first.
> > 

> Actually a "regression" keyword supposes to mean exactly
> the same. It just happens that it's added every time someone decided
> > to add it. IMO it should be added only when regression
> test results are available

I wouldn't like it either. Because i cherry pick regression keyword or
bug reports which looks like regression. So it would bit me, if REGRESSION
would disappear as a choice for reporter.

> but this isn't going to happen of course for obvious reasons (some
> reporters don't bother to respond in months). If no test was performed
> > a developer will see a report anyway, searching for a module of
> interest.

I still think that REGRESSION != BISECTED, but i don't argue or enforce
such usage. I'll quietly do it my way till someone will tell me "stop
that mess in bugzilla". Then i would leave completely...

I try to do my best and i'm a bit sad seeing unfixed "Bisected" for a
long time and don't know how to help further :-/




From nsivov at codeweavers.com  Sat May 22 16:37:32 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Sun, 23 May 2010 01:37:32 +0400
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <019d1e05b128d3d0771022155b04b500@www3-mail.volny.cz>
References: <4BF7F523.5050201@the-dreams.de>	<20100523001910.22126ab6.dmitry@codeweavers.com>
	<8c24617f99a8b895984e0dcdf0fb436f@www3-mail.volny.cz>
	<4BF84743.8010906@codeweavers.com>
	<019d1e05b128d3d0771022155b04b500@www3-mail.volny.cz>
Message-ID: <4BF84E9C.3020506@codeweavers.com>

On 5/23/2010 01:22, wylda at volny.cz wrote:
>> Actually a "regression" keyword supposes to mean exactly
>> the same. It just happens that it's added every time someone decided
>>      
>>> to add it. IMO it should be added only when regression
>>>        
>> test results are available
>>      
> I wouldn't like it either. Because i cherry pick regression keyword or
> bug reports which looks like regression. So it would bit me, if REGRESSION
> would disappear as a choice for reporter.
>    
Yeah, it isn't a solution of course to ignore it. And it won't disappear.
>    
>> but this isn't going to happen of course for obvious reasons (some
>> reporters don't bother to respond in months). If no test was performed
>>      
>>> a developer will see a report anyway, searching for a module of
>>>        
>> interest.
>>      
> I still think that REGRESSION != BISECTED, but i don't argue or enforce
> such usage. I'll quietly do it my way till someone will tell me "stop
> that mess in bugzilla". Then i would leave completely...
>    
Yes, it isn't equal, it's a fact unfortunately.
> I try to do my best and i'm a bit sad seeing unfixed "Bisected" for a
> long time and don't know how to help further :-/
>    
It isn't so simple to fix it sometimes, that's most likely a reason. So 
I'm sure your time is not wasted,
and test results are very useful. And I want to thank you for that.



From xerox_xerox2000 at yahoo.co.uk  Sat May 22 16:41:22 2010
From: xerox_xerox2000 at yahoo.co.uk (Louis Lenders)
Date: Sat, 22 May 2010 21:41:22 +0000 (UTC)
Subject: make &quot;bisected&quot; a keyword in bugzilla?
References: <4BF7F523.5050201@the-dreams.de>	<20100523001910.22126ab6.dmitry@codeweavers.com>
	<8c24617f99a8b895984e0dcdf0fb436f@www3-mail.volny.cz>
	<4BF84743.8010906@codeweavers.com>
Message-ID: <loom.20100522T232037-146@post.gmane.org>

Nikolay Sivov <nsivov <at> codeweavers.com> writes:


> >    
> I believe developer's attention doesn't depend on bug state 
> (confirmed/uncofirmed) at all.

I'm not sure about that, my experience is that some developers do care about
regressions and some don't (actually i think that they missed the bug reports
where the regressions are reported) . It would help at least that if those who
don't, drop a little message that they saw the bugreport and are aware of the
regression they caused ( or if their patch just was correct, and just revealed
another wine-bug, add that information) 

  
> Actually a "regression" keyword supposes to mean exactly the same.

I don't agree about that, "regression" means the app doesn't work  anymore, that
could also be because of a distro-upgrade or a mis-configured system at the user
side. Bisected means someone with same system+distro has pinpointed the exact
patch that caused trouble. So this should have top-priority for wine-devs to
look at, if wine wants to get mature.
 







From sven.wine at gmail.com  Sat May 22 17:08:08 2010
From: sven.wine at gmail.com (Sven Baars)
Date: Sun, 23 May 2010 00:08:08 +0200
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <loom.20100522T232037-146@post.gmane.org>
References: <4BF7F523.5050201@the-dreams.de>	<20100523001910.22126ab6.dmitry@codeweavers.com>	<8c24617f99a8b895984e0dcdf0fb436f@www3-mail.volny.cz>	<4BF84743.8010906@codeweavers.com>
	<loom.20100522T232037-146@post.gmane.org>
Message-ID: <4BF855C8.8060109@gmail.com>

Louis Lenders wrote:
> Nikolay Sivov<nsivov<at>  codeweavers.com>  writes:
>
>
>    
>>>
>>>        
>> I believe developer's attention doesn't depend on bug state
>> (confirmed/uncofirmed) at all.
>>      
> I'm not sure about that, my experience is that some developers do care about
> regressions and some don't (actually i think that they missed the bug reports
> where the regressions are reported) . It would help at least that if those who
> don't, drop a little message that they saw the bugreport and are aware of the
> regression they caused ( or if their patch just was correct, and just revealed
> another wine-bug, add that information)
>
>
>    
>> Actually a "regression" keyword supposes to mean exactly the same.
>>      
> I don't agree about that, "regression" means the app doesn't work  anymore, that
> could also be because of a distro-upgrade or a mis-configured system at the user
> side. Bisected means someone with same system+distro has pinpointed the exact
> patch that caused trouble. So this should have top-priority for wine-devs to
> look at, if wine wants to get mature.
>
>    
Wouldn't it be easier to have both the regression and the bisected 
keyword, not only to determine the importance of a bug, but also to make 
the lives of people like Wylda easier? There are bugs that have been 
marked as regressions that haven't been bisected, and it would be great 
if people could easily find those bugs and bisect them. AFAIK, we have 
at least 50 bugs like this ATM.

Also, while we're at it, I was wondering why Wylda doesn't have Bugzilla 
rights yet. He has been doing an awesome job so far.



From fgouget at free.fr  Sat May 22 17:15:27 2010
From: fgouget at free.fr (Francois Gouget)
Date: Sun, 23 May 2010 00:15:27 +0200 (CEST)
Subject: too much dynamic loading?
In-Reply-To: <AANLkTikMjh6Dg5G286RbIR8YTDkFlgUNm5vnDje40tmW@mail.gmail.com>
References: <20100521165927.GA5644@galeere.jet.franken.de>
	<AANLkTimHbwNpWn9ONj5hhOn-ZUUORWyERkv--U6l8XrC@mail.gmail.com>
	<20100521172821.GB5644@galeere.jet.franken.de>
	<AANLkTikMjh6Dg5G286RbIR8YTDkFlgUNm5vnDje40tmW@mail.gmail.com>
Message-ID: <alpine.DEB.2.00.1005230013120.5399@amboise.dolphin>

On Fri, 21 May 2010, Steven Edwards wrote:

> On Fri, May 21, 2010 at 1:28 PM, Marcus Meissner <marcus at jet.franken.de>wrote:
> >
> > No static linking either, its the nightmare of security maintainers ;)
> >
> Good point. Direct Linking then. I am just in favor of changing it to
> something other than the status quo because all of this dynamic loading
> stuff never wants to work right on OS X.

I'm not convinced direct linking will work better on Mac OS X, unless 
you ship libpng and libjpeg with Wine.


-- 
Francois Gouget <fgouget at free.fr>              http://fgouget.free.fr/
                 Dieu dit: "M-x Lumi?re". Et la lumi?re fut.

From ehoover at mines.edu  Sat May 22 18:04:32 2010
From: ehoover at mines.edu (Erich Hoover)
Date: Sat, 22 May 2010 17:04:32 -0600
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <loom.20100522T232037-146@post.gmane.org>
References: <4BF7F523.5050201@the-dreams.de>
	<20100523001910.22126ab6.dmitry@codeweavers.com>
	<8c24617f99a8b895984e0dcdf0fb436f@www3-mail.volny.cz>
	<4BF84743.8010906@codeweavers.com>
	<loom.20100522T232037-146@post.gmane.org>
Message-ID: <AANLkTimJMOHbzKRzPoO8brb8wW6yjnbJjsr5f3Dc9Say@mail.gmail.com>

On Sat, May 22, 2010 at 3:41 PM, Louis Lenders
<xerox_xerox2000 at yahoo.co.uk> wrote:
>
> Nikolay Sivov <nsivov <at> codeweavers.com> writes:
> >
> > I believe developer's attention doesn't depend on bug state
> > (confirmed/uncofirmed) at all.
>
> I'm not sure about that, my experience is that some developers do care about
> regressions and some don't (actually i think that they missed the bug reports
> where the regressions are reported) . It would help at least that if those who
> don't, drop a little message that they saw the bugreport and are aware of the
> regression they caused ( or if their patch just was correct, and just revealed
> another wine-bug, add that information)
> ...

I know I've had trouble a couple times finding the correct bugzilla
account to add the relevant developer.  People using a different email
for bugzilla than for wine-patches can be very frustrating, you would
think that there would be some sort of better way than the email-only
system to identify the appropriate developer and tag him for the CC
list.  I've only been on the developer side of a regression bug once,
but it seemed like having a relevant bisect where the reporter was
able to identify me as the offender helped a lot toward resolving the
issue quickly.

Erich Hoover
ehoover at mines.edu


From dank at kegel.com  Sat May 22 18:57:55 2010
From: dank at kegel.com (Dan Kegel)
Date: Sat, 22 May 2010 16:57:55 -0700
Subject: make "bisected" a keyword in bugzilla?
Message-ID: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>

I think it's a good idea.  'regression' isn't as strong as 'bisected'.

Unless there are objections, I'll add the keyword on Monday.


From hintak_leung at yahoo.co.uk  Sat May 22 04:10:08 2010
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Sat, 22 May 2010 10:10:08 +0100
Subject: software built and worked under wine but not in vista?
In-Reply-To: <4BF6C94C.5020500@dawncrow.de>
References: <506591.51077.qm@web23101.mail.ird.yahoo.com>
	<4BF6C94C.5020500@dawncrow.de>
Message-ID: <4BF79F70.4070204@yahoo.co.uk>

Thanks for everybody who advised. I have filed the two bugs under:

[Bug 22813] wine's loader does not check invalid image size
[Bug 22812] mt creates corrupted executables

In a nutshell, just before running mt, wine and vista generates very similiar
executables (differing by 4 bytes, two about time stamps and two seems to be 
some padding at the end of the import table?). Then the mt makes the executables 
  invalid (at least under vista and also according to one of you, from win7).

And wine certainly doesn't behave like vista in rejecting the executables and 
happily loading them...


From wolfram at the-dreams.de  Sat May 22 19:47:07 2010
From: wolfram at the-dreams.de (Wolfram Sang)
Date: Sun, 23 May 2010 02:47:07 +0200
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <019d1e05b128d3d0771022155b04b500@www3-mail.volny.cz>
References: <4BF7F523.5050201@the-dreams.de>	<20100523001910.22126ab6.dmitry@codeweavers.com>	<8c24617f99a8b895984e0dcdf0fb436f@www3-mail.volny.cz>	<4BF84743.8010906@codeweavers.com>
	<019d1e05b128d3d0771022155b04b500@www3-mail.volny.cz>
Message-ID: <4BF87B0B.20907@the-dreams.de>

>> but this isn't going to happen of course for obvious reasons (some
>> reporters don't bother to respond in months). If no test was performed
>>> a developer will see a report anyway, searching for a module of
>> interest.
> 
> I still think that REGRESSION != BISECTED, but i don't argue or enforce

That was my main point. REGRESSION is the status before the bisect,
BISECTED is after, being a lot more narrow. For someone who likes to
tackle a bug once in a while, this can make a huge difference. For me,
bisecting is not exactly thrilling. So, BISECTED would be the connection
point for people like Wylda (doing bisects) and me (doing code).

Regards,

   Wolfram




From m.b.lankhorst at gmail.com  Sat May 22 19:55:01 2010
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Sun, 23 May 2010 02:55:01 +0200
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>
References: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>
Message-ID: <4BF87CE5.2020703@gmail.com>

Hi Dan,

On 23-05-10 01:57, Dan Kegel wrote:
> I think it's a good idea.  'regression' isn't as strong as 'bisected'.
>
> Unless there are objections, I'll add the keyword on Monday.
>    
I think I'll object. I don't see any point in the bisected tag that 
regression doesn't already cover. As far as I know as soon as you tag 
something as regression you either already have bisected it, or will be 
asked to bisect it quickly after adding the regression tag.

Cheers,
Maarten


From ehoover at mines.edu  Sat May 22 19:59:19 2010
From: ehoover at mines.edu (Erich Hoover)
Date: Sat, 22 May 2010 18:59:19 -0600
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <4BF87CE5.2020703@gmail.com>
References: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>
	<4BF87CE5.2020703@gmail.com>
Message-ID: <AANLkTimvtW89ZgU3fSkw82OxddQbbUpnOnhk_NQkFetg@mail.gmail.com>

On Sat, May 22, 2010 at 6:55 PM, Maarten Lankhorst
<m.b.lankhorst at gmail.com> wrote:
> Hi Dan,
>
> On 23-05-10 01:57, Dan Kegel wrote:
>>
>> I think it's a good idea. ?'regression' isn't as strong as 'bisected'.
>>
>> Unless there are objections, I'll add the keyword on Monday.
>>
>
> I think I'll object. I don't see any point in the bisected tag that
> regression doesn't already cover. As far as I know as soon as you tag
> something as regression you either already have bisected it, or will be
> asked to bisect it quickly after adding the regression tag.
>
> Cheers,
> Maarten
>

You know what would be neat?  Turn fixing Wine into a game.  Give
people points for successfully reporting bugs, take points away for
reporting duplicates, give more points for successfully bisecting a
bug...

Erich Hoover
ehoover at mines.edu


From rwoodsmall at mac.com  Sat May 22 21:19:28 2010
From: rwoodsmall at mac.com (ryan woodsmall)
Date: Sat, 22 May 2010 21:19:28 -0500
Subject: too much dynamic loading?
In-Reply-To: <alpine.DEB.2.00.1005230013120.5399@amboise.dolphin>
References: <20100521165927.GA5644@galeere.jet.franken.de>
	<AANLkTimHbwNpWn9ONj5hhOn-ZUUORWyERkv--U6l8XrC@mail.gmail.com>
	<20100521172821.GB5644@galeere.jet.franken.de>
	<AANLkTikMjh6Dg5G286RbIR8YTDkFlgUNm5vnDje40tmW@mail.gmail.com>
	<alpine.DEB.2.00.1005230013120.5399@amboise.dolphin>
Message-ID: <D0CA3865-FC43-4944-897B-386275AD8E8A@mac.com>

> I'm not convinced direct linking will work better on Mac OS X, unless
> you ship libpng and libjpeg with Wine.

And libgnutls (plus prereqs libgpg-error & libgcrypt). And libgphoto2,  
libexif, libtiff, libgsm, libjbig... - there's a laundry list of  
libraries that are required for a full-featured Wine install, and  
prereqs of prereqs, prereqs of THOSE. You get the point. Static  
libraries on Mac OS X/Darwin also misbehave in odd ways that you  
simply don't see with dylibs as well.

I package all of these up with osxwinebuilder, building shared libs  
from source, and it's a bit tricky. Things fail in unforeseen ways if  
a user's modified their environment. I had an issue this morning where  
libghoto2 was failing for version 2.4.9+, but working for anything  
older. Turns out that GD had been installed into /usr from source on  
Leopard, the user upgraded to Snow Leopard (which broke a few of GD's  
reqs), and libgphoto2 2.4.9+ now checks for GD, which it found,  
mysteriously breaking the compile. Had GD been compiled statically, it  
may have worked - or not. But that's not something I (or Wine) check  
for, just something I didn't consider until today when a prereq broke.

Wine really wants to map and use share libraries like they're supposed  
to be used: dynamically, when a module needs them. Pain in getting to  
that point on Macs is one reason there's not a binary Wine package  
available; licensing and binary distribution questions/methods is  
another. Static libraries may be a quick workaround, but ultimately  
full shared library coverage for all prereqs on all supported  
platforms is the way to go.

If you want a bad example, take a look at GSM. configure simply won't  
work with/find a static libgsm on OS X, but a manually-built dylib  
works just fine from what I can glean. The fact that the distributor 
(s) don't include an easy method for building shared GSM libs on OS X  
made this a little tricky to workaround IMO. But it's doable.

Kind of ranting. Let me know if clarification is needed on any point.  
Standard Wine on OS X may not work in a Mac user-friendly way, but it  
works very well if you just forego a GUI, have good prereq coverage  
and use it from the terminal. That's good enough for me! -r


From madewokherd at gmail.com  Sat May 22 22:45:32 2010
From: madewokherd at gmail.com (Vincent Povirk)
Date: Sat, 22 May 2010 22:45:32 -0500
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <4BF87CE5.2020703@gmail.com>
References: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>
	<4BF87CE5.2020703@gmail.com>
Message-ID: <AANLkTimhrJgz07aIxnzW5p9lPuMMr1Fajc3gl2NvjOza@mail.gmail.com>

I'm starting to wonder about the use cases for both of those keywords.

Personally, I mostly ignore the "regression" keyword. As a developer
looking for bugs to work on, I've found it not very useful. At a given
point in time, most regression bugs are not easier, more severe, or
more important than the others, nor are there (to my knowledge) people
who work best on regression bugs.

If my name appears in a bugzilla comment (usually because my patch
broke something), it gets caught by a gmail filter and I pay
attention. If a patch I write causes a regression, it suggests
something is wrong or incomplete about the patch, and I should look at
it while it's fresh.

(I assume that such monitoring is not usually necessary because the
patch author will be CC'd. I am unusual because the email address I
use to send patches is not the same address I use on bugzilla. Also I
use gmail filters obsessively.)

The patch that switched gdiplus to builtin by default is an exception.
It tells me nothing new. I don't mind seeing the regression keyword on
those bugs because I don't use it, and anyway I pay attention to all
the gdiplus bugs.

So, at least for those I cause, it helps if regressions are found and
bisected as soon as possible, so that the original patch is fresh in
my head. I know Wylda has been bisecting regressions that others have
reported, and if adding a keyword makes that easier, I'm all for it.
Does it?

Perhaps the ability to search for non-bisected regressions would be
useful, since bisecting is something that anyone with the ability to
build wine and access to the software can do. I believe it's also
time-critical, because:
* As time goes on, it gets harder to build old versions of Wine on
modern distributions, because new versions of build tools tend to
break things. Wine accumulates build fixes that are not present in old
versions.
* The more time passes since the patch was originally written, the
more likely it is that the author has moved on.
* Even when the author is still around, it's easier to work on recent
regressions than old ones.

Perhaps, if we could easily see which regressions still need to be
bisected, someone could make it a goal that all newly-reported
regressions are bisected within a few months. When an unbisected
regression starts to get stale, perhaps someone could post something
on wine-users like "Does anyone own <product name>? It has a
regression that needs bisecting."

But that's not something I would do. I'm a developer, not a community manager.

Anyway, I think we should talk about how people use the regression
keyword now, and how they would use this new keyword, and that should
determine whether it gets added.


From dmitry at codeweavers.com  Sat May 22 23:52:42 2010
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Sun, 23 May 2010 13:52:42 +0900
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <4BF87CE5.2020703@gmail.com>
References: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>
	<4BF87CE5.2020703@gmail.com>
Message-ID: <20100523135242.b2390744.dmitry@codeweavers.com>

Maarten Lankhorst <m.b.lankhorst at gmail.com> wrote:

> On 23-05-10 01:57, Dan Kegel wrote:
> > I think it's a good idea.  'regression' isn't as strong as 'bisected'.
> >
> > Unless there are objections, I'll add the keyword on Monday.
> >    
> I think I'll object. I don't see any point in the bisected tag that 
> regression doesn't already cover. As far as I know as soon as you tag 
> something as regression you either already have bisected it, or will be 
> asked to bisect it quickly after adding the regression tag.

Exactly. There shouldn't be not bisected bugs with the 'regression' keyword
in the first place.

-- 
Dmitry.


From wylda at volny.cz  Sun May 23 00:52:01 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Sun, 23 May 2010 07:52:01 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_make_=22bisected=22_a_keyword_in_bugzilla=3F?=
In-Reply-To: <AANLkTimhrJgz07aIxnzW5p9lPuMMr1Fajc3gl2NvjOza@mail.gmail.com>
References: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>
	<4BF87CE5.2020703@gmail.com>
	<AANLkTimhrJgz07aIxnzW5p9lPuMMr1Fajc3gl2NvjOza@mail.gmail.com>
Message-ID: <fa32c511a7219dd8342c859b78591195@www3-mail.volny.cz>


Used to say here... Don't teach old eagle to fly :) Same way i shouldn't
teach developer how to write patch and for which bug. For this reason
(as i said before) i can live without BISECTED.

> Personally, I mostly ignore the "regression" keyword.

That's OK if you have a proprietary system of work based on gmail filters
etc. But from a manager point of view, i would care if i have a transparent
system independent of particular poeple. People can leave for so many
reason, then they need to be easyly replaced with new ones. And if previous
developer dies and can't resend you content of his unfinished mail folder,
you loose continuity because of such proprietary...

Other than that, if wine gets high quality, manager might want to keep
that quality. So not accepting cleaning and other "moving box" patches
till he sees that that all bisected gets closed (fixed or reverted)
for particular developer. And because it don't need to be programmer
but quite simple human understandig BISECTED&CLOSED=GOOD, he could find
a BISECTED keyword as handy ;)

Also if you have too old Bisected, you could loose the ability to revert
easily (even for developers). So another reason why to watch BISECTED.

> ...and if adding a keyword makes that easier, I'm all for it. Does
> it?
> 
Now i usualy try to process UNCONFIRMED & REGRESSION, but i think it
would be better to have an easy link to filter unbisected regressions.
Also in previous post we talk with Nikolay, why Maarten's indeas of
REGRESSION==BISECTED can't work.

But don't want to teach old eagles to fly ;)




From wolfram at the-dreams.de  Sun May 23 03:07:14 2010
From: wolfram at the-dreams.de (Wolfram Sang)
Date: Sun, 23 May 2010 10:07:14 +0200
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <20100523135242.b2390744.dmitry@codeweavers.com>
References: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>	<4BF87CE5.2020703@gmail.com>
	<20100523135242.b2390744.dmitry@codeweavers.com>
Message-ID: <4BF8E232.7090003@the-dreams.de>

Dmitry Timoshkov wrote:

> Exactly. There shouldn't be not bisected bugs with the 'regression' keyword
> in the first place.

Just to get an idea how close the bugzilla is to the above, I tried to
query the database how many bugs have 'regression' but no bisect. Alas, no
success so far, even something simple like "keyword==regression AND
substring!=commit" (pseudo-code), doesn't work for me; giving up for now.

Like Wylda, I still think it is useful, but will accept if it is too much
of a burden(?) for you, of course.

Regards,

   Wolfram



From sven.wine at gmail.com  Sun May 23 05:04:49 2010
From: sven.wine at gmail.com (Sven Baars)
Date: Sun, 23 May 2010 12:04:49 +0200
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <20100523135242.b2390744.dmitry@codeweavers.com>
References: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>	<4BF87CE5.2020703@gmail.com>
	<20100523135242.b2390744.dmitry@codeweavers.com>
Message-ID: <4BF8FDC1.6010905@gmail.com>

Dmitry Timoshkov wrote:
> Maarten Lankhorst<m.b.lankhorst at gmail.com>  wrote:
>
>    
>> On 23-05-10 01:57, Dan Kegel wrote:
>>      
>>> I think it's a good idea.  'regression' isn't as strong as 'bisected'.
>>>
>>> Unless there are objections, I'll add the keyword on Monday.
>>>
>>>        
>> I think I'll object. I don't see any point in the bisected tag that
>> regression doesn't already cover. As far as I know as soon as you tag
>> something as regression you either already have bisected it, or will be
>> asked to bisect it quickly after adding the regression tag.
>>      
> Exactly. There shouldn't be not bisected bugs with the 'regression' keyword
> in the first place.
>
>    
Exactly. And to make it easier for people to find bugs that do have the 
regression keyword, but were not bisected, you could add the bisected 
keyword, so it'd be easier to actually get to the point where all 
regressions are bisected. In this case, it is not something developers 
would use directly, but something that would at least make the work of 
developers little easier.


From hverbeet at gmail.com  Sun May 23 08:39:14 2010
From: hverbeet at gmail.com (Henri Verbeet)
Date: Sun, 23 May 2010 15:39:14 +0200
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <fa32c511a7219dd8342c859b78591195@www3-mail.volny.cz>
References: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>
	<4BF87CE5.2020703@gmail.com>
	<AANLkTimhrJgz07aIxnzW5p9lPuMMr1Fajc3gl2NvjOza@mail.gmail.com>
	<fa32c511a7219dd8342c859b78591195@www3-mail.volny.cz>
Message-ID: <AANLkTimynkDyGLNfbfzwLhwCPtSPxh3GNbml6K_q6qXH@mail.gmail.com>

Ideally all regressions would be bisected, but that's clearly not the
case. You can of course argue about terminology and / or mechanism,
but I think it's useful to distinguish "possible" regressions from
confirmed regressions with a commit id. Personally I think it would be
nice if bugzilla could give me a list of commit id's and associated
bugs, so I could use git and some scripting to do additional
processing on that.

Perhaps the real issue is that the list of regressions is large enough
that it becomes somewhat impractical to go through them on a regular
basis to look for regressions that aren't bisected yet though. There
are currently 338 bugs with the regression keyword, of which 64 have
the directx-d3d or directx-ddraw component. I'm currently CC'd on 10
of those, most of which are not so easy to fix for one reason or
another. In my personal experience, the majority of regressions aren't
necessarily a problem with the original patch, but rather existing
problems becoming more visible, etc. Perhaps that's different between
different developers and different components though.

It doesn't really matter who's fault a particular regression is
though, what it comes down to is that you touched something, and now
it's broken. So if I'd be reviewing a wined3d patch from someone, I'd
balance the likelihood of that patch / developer breaking something
versus how likely it is that that developer is going to fix it in a
timely fashion when it does break.


From wylda at volny.cz  Sun May 23 14:27:49 2010
From: wylda at volny.cz (wylda at volny.cz)
Date: Sun, 23 May 2010 21:27:49 +0200 (CEST)
Subject: =?iso-8859-2?Q?Re:_Release_plans?=
In-Reply-To: <ac37144d48d8e2a4f51aac17c4a078de@www3-mail.volny.cz>
References: <87hbmii6aj.fsf@wine.dyndns.org>	
	<n2sd6c5d7291005090733n340c42efy87e7d9d121030ef7@mail.gmail.com>	
	<87pr15glwr.fsf@wine.dyndns.org> <4BEAC489.90706@open-vote.org>	
	<AANLkTim7RSmNXJkmoEOuxGRaozK_WKQjvjo4-Ao8Ehze@mail.gmail.com>	
	<AANLkTikaQzqAmnZjbQEVEbjlgW_P8dUbfk1brWLFWsBZ@mail.gmail.com>	
	<4BED6825.80701@codeweavers.com>
	<AANLkTiklsxOWIVCtpfmp3uGCpv7YjB0joED0Y-diq-y6@mail.gmail.com>
	<4BED75F6.3000905@codeweavers.com>
	<ac37144d48d8e2a4f51aac17c4a078de@www3-mail.volny.cz>
Message-ID: <d325bf0794898a5ca08cfaa99f1ffb77@www3-mail.volny.cz>


Hi, i know this statistics are not rocket science, but i'm just interested
how things are getting better before release

340 regressions  <-- release announcement 
356 regressions  <-- release announcement + 1week
339 regressions  <-- release announcement + 2weeks

Long list of fixed bugs in 1.2-rc1 is also quite impressive. Thank you
all!




From nsivov at codeweavers.com  Sun May 23 15:22:41 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Mon, 24 May 2010 00:22:41 +0400
Subject: [PATCH] shlwapi: initial implement of SHAutoComplete
In-Reply-To: <AANLkTilntMLg88jvXia-wta9380MKEqDLrB9AUvKQ3vs@mail.gmail.com>
References: <AANLkTilntMLg88jvXia-wta9380MKEqDLrB9AUvKQ3vs@mail.gmail.com>
Message-ID: <4BF98E91.5080609@codeweavers.com>

On 5/23/2010 05:09, Hirofumi Katayama wrote:
> See attachment.
>    
Hi, some comments here.

> +/****************************************************************************/
> +
> +static const WCHAR szMRUList[] = L"MRUList";
> +static const WCHAR szRunMRU[] =
> +    L"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU";
> +
>    
Don't use this L"" specifier for strings, use array initialization style 
instead.

> +void *my_malloc(UINT size)
> +{
> +    return HeapAlloc(GetProcessHeap(), 0, size);
> +}
> +
> +void *my_realloc(void *p, UINT size)
> +{
> +    if (p == NULL)
> +        return my_malloc(size);
> +    return HeapReAlloc(GetProcessHeap(), 0, p, size);
> +}
> +
> +void my_free(void *p)
> +{
> +    HeapFree(GetProcessHeap(), 0, p);
> +}
> +
>    
This isn't very useful, I think it's not a pain to use direct calls for 
this file.
> +#define malloc my_malloc
> +#define realloc my_realloc
> +#define free my_free
> +#define _wcsdup my__wcsdup
>    
Don't do that.
> +
> +STDMETHODIMP IEnumString_fnQueryInterface(IEnumString *pEnumString, REFIID riid, void** ppvObject);
> +STDMETHODIMP_(ULONG) IEnumString_fnAddRef(IEnumString *pEnumString);
> +STDMETHODIMP_(ULONG) IEnumString_fnRelease(IEnumString *pEnumString);
> +STDMETHODIMP IEnumString_fnNext(IEnumString *pEnumString, ULONG celt, LPOLESTR *rgelt, ULONG *pceltFetched);
> +STDMETHODIMP IEnumString_fnSkip(IEnumString *pEnumString, ULONG celt);
> +STDMETHODIMP IEnumString_fnReset(IEnumString *pEnumString);
> +STDMETHODIMP IEnumString_fnClone(IEnumString *pEnumString, IEnumString **ppenum);
>    
STDMETHODIMP isn't used in Wine code, use explicit WINAPI please. Also 
forward declaration for methods isn't used, usually a vtable is
initialized just after all methods bodies.

> +typedef struct
> +{
> +    IEnumStringVtbl *lpVtbl;
> +    LONG        m_lRef;
> +    IMalloc *   m_pMalloc;
> +    INT         m_i;
> +    INT         m_c;
> +    LPWSTR *    m_strings;
> +} EnumStringImpl;
>    
Please avoid this MFC style like m_* for members, and use more 
descriptive names.

> +EnumStringImpl *IEnumString_construct(VOID)
> +{
> +    EnumStringImpl *pEnumString;
> +
> +    pEnumString = (EnumStringImpl *) malloc(sizeof(EnumStringImpl));
> +    if (pEnumString != NULL)
> +    {
> +        pEnumString->lpVtbl =&EnumStringVtbl;
> +        pEnumString->m_lRef = 0;
> +        pEnumString->m_pMalloc = NULL;
> +        SHGetMalloc(&pEnumString->m_pMalloc);
> +        pEnumString->m_i = 0;
> +        pEnumString->m_strings = GetMRUStrings(&pEnumString->m_c);
> +    }
> +    return pEnumString;
> +}
>    
This is wrong. Initial refcount should be 1.
> +EnumStringImpl *IEnumString_construct(VOID)
>    
> +
> +VOID IEnumString_destruct(EnumStringImpl *pEnumString)
>    
Should be static both, and methods too of course.

> +        pEnumString->lpVtbl->AddRef(pEnumString);
>    
No need for that, use defined macros to call methods from vtables.
> +STDMETHODIMP_(ULONG) IEnumString_fnAddRef(IEnumString *pEnumString)
> +{
> +    EnumStringImpl *this = (EnumStringImpl *) pEnumString;
> +    this->m_lRef++;
> +    return (ULONG) this->m_lRef;
> +}
>    
You should use interlocked increment here (same for _Release()).

> +    pProp->fnOldWndProc = (WNDPROC) SetWindowLongPtr(hwndEdit, GWLP_WNDPROC, (LONG_PTR) AutoCompleteEditWndProc);
>    
Did you ever build it? I think we have a blocking things for using 
implicit A/W calls.









From jjmckenzie51 at earthlink.net  Sun May 23 16:13:58 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Sun, 23 May 2010 14:13:58 -0700
Subject: too much dynamic loading?
In-Reply-To: <20100521172821.GB5644@galeere.jet.franken.de>
References: <20100521165927.GA5644@galeere.jet.franken.de>	<AANLkTimHbwNpWn9ONj5hhOn-ZUUORWyERkv--U6l8XrC@mail.gmail.com>
	<20100521172821.GB5644@galeere.jet.franken.de>
Message-ID: <4BF99A96.5070804@earthlink.net>

Marcus Meissner wrote:
> On Fri, May 21, 2010 at 01:03:09PM -0400, Steven Edwards wrote:
>   
>> On Fri, May 21, 2010 at 12:59 PM, Marcus Meissner <marcus at jet.franken.de> wrote:
>>     
>>> As libjpeg and libpng bumped their major versions in the last months
>>> I had to adjust some of my library requires in my wine.spec file.
>>>
>>> This caused me thinking if it is really necessary to dynamically
>>> load nearly every library.
>>>
>>> Can we make some of those direct linking? libjpeg and libpng
>>> and some other lowlevel libraries might be useful.
>>>       
>> +1 for static linking them.
>>     
>
> No static linking either, its the nightmare of security maintainers ;)
>
>
> But which distro doesnt have libjpeg or libpng? or libX11.so, libXext.so., libncurses.so...
>   
How about MacOSX or Solaris?  They don't come with these. 

James McKenzie



From austinenglish at gmail.com  Sun May 23 16:17:02 2010
From: austinenglish at gmail.com (Austin English)
Date: Sun, 23 May 2010 16:17:02 -0500
Subject: too much dynamic loading?
In-Reply-To: <4BF99A96.5070804@earthlink.net>
References: <20100521165927.GA5644@galeere.jet.franken.de> 
	<AANLkTimHbwNpWn9ONj5hhOn-ZUUORWyERkv--U6l8XrC@mail.gmail.com> 
	<20100521172821.GB5644@galeere.jet.franken.de>
	<4BF99A96.5070804@earthlink.net>
Message-ID: <AANLkTikeBxpSdykMZHJFzamd_PW2ZibubfOepwImLY3T@mail.gmail.com>

On Sun, May 23, 2010 at 4:13 PM, James McKenzie
<jjmckenzie51 at earthlink.net> wrote:
> Marcus Meissner wrote:
>>
>> On Fri, May 21, 2010 at 01:03:09PM -0400, Steven Edwards wrote:
>>
>>>
>>> On Fri, May 21, 2010 at 12:59 PM, Marcus Meissner <marcus at jet.franken.de>
>>> wrote:
>>>
>>>>
>>>> As libjpeg and libpng bumped their major versions in the last months
>>>> I had to adjust some of my library requires in my wine.spec file.
>>>>
>>>> This caused me thinking if it is really necessary to dynamically
>>>> load nearly every library.
>>>>
>>>> Can we make some of those direct linking? libjpeg and libpng
>>>> and some other lowlevel libraries might be useful.
>>>>
>>>
>>> +1 for static linking them.
>>>
>>
>> No static linking either, its the nightmare of security maintainers ;)
>>
>>
>> But which distro doesnt have libjpeg or libpng? or libX11.so, libXext.so.,
>> libncurses.so...
>>
>
> How about MacOSX or Solaris? ?They don't come with these.

OSX 10.5+ comes with X11 installed. OpenSolaris has X11 and friends as
well, though Solaris may not.

-- 
-Austin


From jjmckenzie51 at earthlink.net  Sun May 23 16:18:34 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Sun, 23 May 2010 14:18:34 -0700
Subject: too much dynamic loading?
In-Reply-To: <D0CA3865-FC43-4944-897B-386275AD8E8A@mac.com>
References: <20100521165927.GA5644@galeere.jet.franken.de>	<AANLkTimHbwNpWn9ONj5hhOn-ZUUORWyERkv--U6l8XrC@mail.gmail.com>	<20100521172821.GB5644@galeere.jet.franken.de>	<AANLkTikMjh6Dg5G286RbIR8YTDkFlgUNm5vnDje40tmW@mail.gmail.com>	<alpine.DEB.2.00.1005230013120.5399@amboise.dolphin>
	<D0CA3865-FC43-4944-897B-386275AD8E8A@mac.com>
Message-ID: <4BF99BAA.2020404@earthlink.net>

ryan woodsmall wrote:
>> I'm not convinced direct linking will work better on Mac OS X, unless
>> you ship libpng and libjpeg with Wine.
>
> And libgnutls (plus prereqs libgpg-error & libgcrypt). And libgphoto2, 
> libexif, libtiff, libgsm, libjbig... - there's a laundry list of 
> libraries that are required for a full-featured Wine install, and 
> prereqs of prereqs, prereqs of THOSE. You get the point. Static 
> libraries on Mac OS X/Darwin also misbehave in odd ways that you 
> simply don't see with dylibs as well.
>
Does not Wine's configure not include these if they are not found?

Yes, a MacOSX build should either:

1.  Get them.
2.  Ship with them, build for the LCD MacOSX version (right now that it 
is, believe it or not, Tiger [MacOSX 10.4.11].) 

MacOSX does not include many UNIX type programs and utilities because 
they are not used in the base product.  MacPorts and Fink are two 
porting efforts to bring UNIX utilities/programs to MacOSX and most of 
the utilities can be built from source.

However, MacOSX Wine distributors cannot rely on which version of a 
utility I installed and even if I did.

Many MacOSX users have been quietly surprised when their favorite 
Windows program causes a complete system lockup because of a faulty or 
incomplete Wine installation....

James McKenzie



From jjmckenzie51 at earthlink.net  Sun May 23 16:20:50 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Sun, 23 May 2010 14:20:50 -0700
Subject: too much dynamic loading?
In-Reply-To: <AANLkTikeBxpSdykMZHJFzamd_PW2ZibubfOepwImLY3T@mail.gmail.com>
References: <20100521165927.GA5644@galeere.jet.franken.de>
	<AANLkTimHbwNpWn9ONj5hhOn-ZUUORWyERkv--U6l8XrC@mail.gmail.com>
	<20100521172821.GB5644@galeere.jet.franken.de>
	<4BF99A96.5070804@earthlink.net>
	<AANLkTikeBxpSdykMZHJFzamd_PW2ZibubfOepwImLY3T@mail.gmail.com>
Message-ID: <4BF99C32.7010605@earthlink.net>

Austin English wrote:
> On Sun, May 23, 2010 at 4:13 PM, James McKenzie
> <jjmckenzie51 at earthlink.net> wrote:
>   
>> Marcus Meissner wrote:
>>     
>>> On Fri, May 21, 2010 at 01:03:09PM -0400, Steven Edwards wrote:
>>>
>>>       
>>>> On Fri, May 21, 2010 at 12:59 PM, Marcus Meissner <marcus at jet.franken.de>
>>>> wrote:
>>>>
>>>>         
>>>>> As libjpeg and libpng bumped their major versions in the last months
>>>>> I had to adjust some of my library requires in my wine.spec file.
>>>>>
>>>>> This caused me thinking if it is really necessary to dynamically
>>>>> load nearly every library.
>>>>>
>>>>> Can we make some of those direct linking? libjpeg and libpng
>>>>> and some other lowlevel libraries might be useful.
>>>>>
>>>>>           
>>>> +1 for static linking them.
>>>>
>>>>         
>>> No static linking either, its the nightmare of security maintainers ;)
>>>
>>>
>>> But which distro doesnt have libjpeg or libpng? or libX11.so, libXext.so.,
>>> libncurses.so...
>>>
>>>       
>> How about MacOSX or Solaris?  They don't come with these.
>>     
>
> OSX 10.5+ comes with X11 installed. OpenSolaris has X11 and friends as
> well, though Solaris may not.
>
>   
Austin:

I'm referring to the 'little' things, like openssl.  MacOSXs version is 
not the same as Linux.  Also, the level of library support varies 
greatly between versions of MacOSX.

See my reply to Ryan for more on this.

Also, we have to keep in mind that there are still Intel Mac users that 
are running MacOSX 10.4, which did not come with X11 installed.

James McKenzie



From jjmckenzie51 at earthlink.net  Sun May 23 17:32:54 2010
From: jjmckenzie51 at earthlink.net (James McKenzie)
Date: Sun, 23 May 2010 15:32:54 -0700
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <4BF8FDC1.6010905@gmail.com>
References: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>	<4BF87CE5.2020703@gmail.com>	<20100523135242.b2390744.dmitry@codeweavers.com>
	<4BF8FDC1.6010905@gmail.com>
Message-ID: <4BF9AD16.2030203@earthlink.net>

Sven Baars wrote:
> Dmitry Timoshkov wrote:
>> Maarten Lankhorst<m.b.lankhorst at gmail.com>  wrote:
>>
>>   
>>> On 23-05-10 01:57, Dan Kegel wrote:
>>>     
>>>> I think it's a good idea.  'regression' isn't as strong as 'bisected'.
>>>>
>>>> Unless there are objections, I'll add the keyword on Monday.
>>>>
>>>>        
>>> I think I'll object. I don't see any point in the bisected tag that
>>> regression doesn't already cover. As far as I know as soon as you tag
>>> something as regression you either already have bisected it, or will be
>>> asked to bisect it quickly after adding the regression tag.
>>>      
>> Exactly. There shouldn't be not bisected bugs with the 'regression' 
>> keyword
>> in the first place.
>>
>>    
> Exactly. And to make it easier for people to find bugs that do have 
> the regression keyword, but were not bisected, you could add the 
> bisected keyword, so it'd be easier to actually get to the point where 
> all regressions are bisected. In this case, it is not something 
> developers would use directly, but something that would at least make 
> the work of developers little easier.
>
>
>
+1 to this idea.  The use of regression without bisected gives those of 
us that are willing to do the bisect a target and keeps us from 
duplicating effort.  Using the word bisect points out the patch or 
patches that caused the regression.  A good example is when I found a 
problem moving through about 20 versions + of Wine where an error 
occurred.  The patch author provided a private patch to fix the problem 
until I reached the version of Wine where it was truely fixed.

Having a bisect helps in troubleshooting and may actually point out that 
the patch unveiled a code error elsewhere in Wine.  This happened on 
more than one occasion during the last two years.

Adding the bisect 'keyword'  also should require that the poster add a 
commit line (this will require more effort) for the commit that 
caused/uncovered the regression.

James McKenzie



From testbot at testbot.winehq.org  Sun May 23 18:37:37 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Mon, 24 May 2010 01:37:37 +0200
Subject: [1/2] shell32: Export lowlevel PIDL manipulation calls by name
	too 
Message-ID: <201005232337.o4NNbb0H031680@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2273

Your paranoid android.


=== WNT4WSSP6 (32 bit shlfileop) ===
shlfileop.c:2202: Test failed: SHGetNewLinkInfoA succeeded


From testbot at testbot.winehq.org  Sun May 23 18:45:18 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Mon, 24 May 2010 01:45:18 +0200
Subject: comctl32/listview: Fix vertical position offset for subitem
	rectangle 
Message-ID: <201005232345.o4NNjIe1031954@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2274

Your paranoid android.


=== W98SE (32 bit listview) ===
listview.c:2214: Test failed: got 1

=== WNT4WSSP6 (32 bit listview) ===
listview.c:2214: Test failed: got 1

=== W2KPROSP4 (32 bit listview) ===
listview.c:2214: Test failed: got 1

=== WXPPROSP3 (32 bit listview) ===
listview.c:2214: Test failed: got 1

=== W2K3R2SESP2 (32 bit listview) ===
listview.c:2214: Test failed: got 1

=== WVISTAADM (32 bit listview) ===
listview.c:2214: Test failed: got 1

=== W2K8SE (32 bit listview) ===
listview.c:2214: Test failed: got 1

=== W7PRO (32 bit listview) ===
listview.c:2214: Test failed: got 1

=== W7PROX64 (32 bit listview) ===
listview.c:2214: Test failed: got 1

=== W7PROX64 (64 bit listview) ===
listview.c:2214: Test failed: got 1


From dank at kegel.com  Sun May 23 19:39:21 2010
From: dank at kegel.com (Dan Kegel)
Date: Sun, 23 May 2010 17:39:21 -0700
Subject: bricscad goes native
Message-ID: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com>

I've long predicted that companies might use Wine
for a while to ship Linux-compatible products,
and later switch to a native build once they know
they have users.  Well, now we have at least one
example of this: Bricscad (see http://www.bricsys.com ).

This is a *good* thing, and validates somewhat the idea
that Wine is a catalyst to enable a global shift from
Windows to Linux.


From winehacker at gmail.com  Sun May 23 22:58:54 2010
From: winehacker at gmail.com (Steven Edwards)
Date: Sun, 23 May 2010 23:58:54 -0400
Subject: too much dynamic loading?
In-Reply-To: <4BF99C32.7010605@earthlink.net>
References: <20100521165927.GA5644@galeere.jet.franken.de>
	<AANLkTimHbwNpWn9ONj5hhOn-ZUUORWyERkv--U6l8XrC@mail.gmail.com>
	<20100521172821.GB5644@galeere.jet.franken.de>
	<4BF99A96.5070804@earthlink.net>
	<AANLkTikeBxpSdykMZHJFzamd_PW2ZibubfOepwImLY3T@mail.gmail.com>
	<4BF99C32.7010605@earthlink.net>
Message-ID: <AANLkTikkBQIA4tslVyLapuTfpTJwzFsKnd8w3vrmwPs7@mail.gmail.com>

On Sun, May 23, 2010 at 5:20 PM, James McKenzie
<jjmckenzie51 at earthlink.net> wrote:
> I'm referring to the 'little' things, like openssl. ?MacOSXs version is not
> the same as Linux. ?Also, the level of library support varies greatly
> between versions of MacOSX.
>
> See my reply to Ryan for more on this.
>
> Also, we have to keep in mind that there are still Intel Mac users that are
> running MacOSX 10.4, which did not come with X11 installed.

Not counting X11.app in this but, in the past I spoke with Alexandre
about putting together a Winesupport.Framework or some such that would
contain all of the libraries required for an offical OS X release and
he was not opposed to linking to it on winehq.org and making it part
of the support requirements. The problem is that putting this package
together and maintain it is going to require a bit of heavy lifting.

-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From dmitry at codeweavers.com  Sun May 23 23:53:48 2010
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Mon, 24 May 2010 13:53:48 +0900
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <AANLkTimynkDyGLNfbfzwLhwCPtSPxh3GNbml6K_q6qXH@mail.gmail.com>
References: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>
	<4BF87CE5.2020703@gmail.com>
	<AANLkTimhrJgz07aIxnzW5p9lPuMMr1Fajc3gl2NvjOza@mail.gmail.com>
	<fa32c511a7219dd8342c859b78591195@www3-mail.volny.cz>
	<AANLkTimynkDyGLNfbfzwLhwCPtSPxh3GNbml6K_q6qXH@mail.gmail.com>
Message-ID: <20100524135348.36e737b8.dmitry@codeweavers.com>

Henri Verbeet <hverbeet at gmail.com> wrote:

> Ideally all regressions would be bisected, but that's clearly not the
> case. You can of course argue about terminology and / or mechanism,
> but I think it's useful to distinguish "possible" regressions from
> confirmed regressions with a commit id. Personally I think it would be
> nice if bugzilla could give me a list of commit id's and associated
> bugs, so I could use git and some scripting to do additional
> processing on that.

Probably it would be better to add a field for commit id that caused
a regression just like there is one for url/keywords instead of inventing
new keywords. So a 'regression' with a commit id would automatically mean
'bisected'. That would also save time of finding the commit id by looking
at every comment in the bug, and possibly avoiding finding incorrect
bisect results.

-- 
Dmitry.


From austinenglish at gmail.com  Mon May 24 00:01:01 2010
From: austinenglish at gmail.com (Austin English)
Date: Mon, 24 May 2010 00:01:01 -0500
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <20100524135348.36e737b8.dmitry@codeweavers.com>
References: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com> 
	<4BF87CE5.2020703@gmail.com>
	<AANLkTimhrJgz07aIxnzW5p9lPuMMr1Fajc3gl2NvjOza@mail.gmail.com> 
	<fa32c511a7219dd8342c859b78591195@www3-mail.volny.cz>
	<AANLkTimynkDyGLNfbfzwLhwCPtSPxh3GNbml6K_q6qXH@mail.gmail.com> 
	<20100524135348.36e737b8.dmitry@codeweavers.com>
Message-ID: <AANLkTimHOEb0Mjz7P0J9uPusO1cigX2Uoj-gRIv5YWho@mail.gmail.com>

On Sun, May 23, 2010 at 11:53 PM, Dmitry Timoshkov
<dmitry at codeweavers.com> wrote:
> Henri Verbeet <hverbeet at gmail.com> wrote:
>
>> Ideally all regressions would be bisected, but that's clearly not the
>> case. You can of course argue about terminology and / or mechanism,
>> but I think it's useful to distinguish "possible" regressions from
>> confirmed regressions with a commit id. Personally I think it would be
>> nice if bugzilla could give me a list of commit id's and associated
>> bugs, so I could use git and some scripting to do additional
>> processing on that.
>
> Probably it would be better to add a field for commit id that caused
> a regression just like there is one for url/keywords instead of inventing
> new keywords. So a 'regression' with a commit id would automatically mean
> 'bisected'. That would also save time of finding the commit id by looking
> at every comment in the bug, and possibly avoiding finding incorrect
> bisect results.

If editing Bugzilla's layout is easy to do, I like this option.

-- 
-Austin


From wolfram at the-dreams.de  Mon May 24 00:45:01 2010
From: wolfram at the-dreams.de (Wolfram Sang)
Date: Mon, 24 May 2010 07:45:01 +0200
Subject: make "bisected" a keyword in bugzilla?
In-Reply-To: <20100524135348.36e737b8.dmitry@codeweavers.com>
References: <AANLkTilMzd01JUXYBmdQ1gVpfJnc4wY4THlvReaTMgJi@mail.gmail.com>	<4BF87CE5.2020703@gmail.com>	<AANLkTimhrJgz07aIxnzW5p9lPuMMr1Fajc3gl2NvjOza@mail.gmail.com>	<fa32c511a7219dd8342c859b78591195@www3-mail.volny.cz>	<AANLkTimynkDyGLNfbfzwLhwCPtSPxh3GNbml6K_q6qXH@mail.gmail.com>
	<20100524135348.36e737b8.dmitry@codeweavers.com>
Message-ID: <4BFA125D.6060300@the-dreams.de>

> Probably it would be better to add a field for commit id that caused
> a regression just like there is one for url/keywords instead of inventing
> new keywords. So a 'regression' with a commit id would automatically mean
> 'bisected'. That would also save time of finding the commit id by looking
> at every comment in the bug, and possibly avoiding finding incorrect
> bisect results.

Yay, that would be even better!


From testbot at testbot.winehq.org  Mon May 24 03:45:32 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Mon, 24 May 2010 10:45:32 +0200
Subject: d3dx9_36: Implement ID3DXLine_GetDevice with tests 
Message-ID: <201005240845.o4O8jWxb029376@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2276

Your paranoid android.


=== WINEBUILD (build) ===
Patch failed


From hintak_leung at yahoo.co.uk  Mon May 24 02:25:08 2010
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Mon, 24 May 2010 08:25:08 +0100
Subject: software built and worked under wine but not in vista?
In-Reply-To: <AANLkTilLBQDoYZOOxIURP_VNjXLSeUqmnxtafSV2WS8B@mail.gmail.com>
References: <661512.55915.qm@web23106.mail.ird.yahoo.com>	<alpine.DEB.1.10.1005192306430.27321@localhost.localdomain>	<4BF49660.7090409@yahoo.co.uk>
	<AANLkTilLBQDoYZOOxIURP_VNjXLSeUqmnxtafSV2WS8B@mail.gmail.com>
Message-ID: <4BFA29D4.3050908@yahoo.co.uk>

Matijn Woudt wrote:
> There are a few differences I spotted between the two executables:
> 1) setupgs-wine.exe has wrong image size, changing it from 0x2b200 to
> 0x2b000 makes the executable working under win7.
> 2) setupgs-wine.exe has wrong resource size, probably related to 1),
> because the size of both executables are the same.
> 3) The assembly in setupgs-wine.exe has only LF line endings, vista
> has CRLF. This explains 2).
> 
> I don't know the reason for 3), I assume it's a bug somewhere in wine.

I have started looking into pedump and dumpbin, and the PE/COFF format, but it 
is new territory to me... can you explain either in a private e-mail, or if the 
info is more relevant to the wider audience, how can one tell the image size and 
resource size is 'wrong'? Presumably it is a consistency check of some sort - 
i.e. one part needs to agree with another, and the wine loader is not doing the 
check at the moment.

If I can do that life on linux or elsewhere life would be easier - not booting 
into windows; because then I can see what the 2nd bug is about - tried using 
native imagehlp and there is no improvement, so I probably need to try each of 
mt.exe's dependencies to see which of them breaks the executable. (but I need to 
be able to tell an executable being broken first).


From piotr.caban at gmail.com  Mon May 24 05:10:08 2010
From: piotr.caban at gmail.com (Piotr Caban)
Date: Mon, 24 May 2010 12:10:08 +0200
Subject: msvcrt (1/2): add fstat64i32
In-Reply-To: <1274681395.2250.4.camel@localhost>
References: <1274681395.2250.4.camel@localhost>
Message-ID: <4BFA5080.1030109@gmail.com>

Hi,

fstat64i32 and stat64i32 are not exported by native msvcrt.dll. This 
functions should be implemented in msvcr90.

Cheers,
Piotr


From julliard at winehq.org  Mon May 24 05:50:43 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Mon, 24 May 2010 12:50:43 +0200
Subject: d3drm [patch 4/4]: Put private definitions in private header
In-Reply-To: <AANLkTil_SdHZhC2AbNV3VJSgaqWawra5e0rB_bH8LR0K@mail.gmail.com>
	(David Adam's message of "Sun, 23 May 2010 05:45:03 +0200")
References: <AANLkTil_SdHZhC2AbNV3VJSgaqWawra5e0rB_bH8LR0K@mail.gmail.com>
Message-ID: <87eih1tvy4.fsf@wine.dyndns.org>

David Adam <david.adam.cnrs at gmail.com> writes:

> From ee208ac901d7defe8ae5ddacfd4c65e36d290c4a Mon Sep 17 00:00:00 2001
> From: David Adam <david.adam.cnrs at gmail.com>
> Date: Sun, 23 May 2010 05:37:35 +0200
> Subject: Put private definitions in the private header
>
> ---
>  dlls/d3drm/d3drm_private.h |   25 +++++++++++++++++++++++++
>  dlls/d3drm/meshbuilder.c   |   25 -------------------------
>  2 files changed, 25 insertions(+), 25 deletions(-)

That's not an improvement. If the definitions are only needed in one
file they should be in that file, not in a shared header.

-- 
Alexandre Julliard
julliard at winehq.org


From nsivov at codeweavers.com  Mon May 24 07:42:55 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Mon, 24 May 2010 16:42:55 +0400
Subject: shell32: Add ExplorerBrowser with IExplorerBrowser interface stub.
In-Reply-To: <1274703940-11813-3-git-send-email-david.hedberg@gmail.com>
References: <1274703940-11813-1-git-send-email-david.hedberg@gmail.com>
	<1274703940-11813-3-git-send-email-david.hedberg@gmail.com>
Message-ID: <4BFA744F.2050200@codeweavers.com>

On 5/24/2010 16:25, David Hedberg wrote:

Hi, David.
> +}
> +
> +static ULONG WINAPI IExplorerBrowser_fnRelease(IExplorerBrowser *iface)
> +{
> +    ExplorerBrowserImpl *This = (ExplorerBrowserImpl*)iface;
> +    TRACE("This: %p\n", This);
> +
> +    This->ref--;
> +    TRACE("Ref: %d\n", This->ref);
>    
Use interlocked increment/decrement here.
> +
> +static HRESULT WINAPI IExplorerBrowser_fnSetRect(
> +    IExplorerBrowser *iface,
> +    HDWP *phdwp,
> +    RECT rcBrowser)
> +{
> +    ExplorerBrowserImpl *This = (ExplorerBrowserImpl*)iface;
> +    TRACE("This: %p\n", This);
> +
> +    return E_NOTIMPL;
>    
If it isn't tested to really return E_NOTIMPL you should output a 
FIXME() with a stub comment. };
>
> diff --git a/dlls/shell32/shell32_main.h b/dlls/shell32/shell32_main.h
> index 8f51850..78b37a8 100644
> --- a/dlls/shell32/shell32_main.h
> +++ b/dlls/shell32/shell32_main.h
> @@ -99,6 +99,7 @@ HRESULT WINAPI FolderShortcut_Constructor(IUnknown * pUnkOuter, REFIID riid, LPV
>   HRESULT WINAPI MyDocuments_Constructor(IUnknown * pUnkOuter, REFIID riid, LPVOID *ppv);
>   HRESULT WINAPI RecycleBin_Constructor(IUnknown * pUnkOuter, REFIID riif, LPVOID *ppv);
>   HRESULT WINAPI QueryAssociations_Constructor(IUnknown *pUnkOuter, REFIID riid, LPVOID *ppOutput);
> +HRESULT WINAPI ExplorerBrowser_Constructor(IUnknown *pUnkOuter, REFIID riid, LPVOID *ppv);
>   extern HRESULT CPanel_GetIconLocationW(LPCITEMIDLIST, LPWSTR, UINT, int*);
>   HRESULT WINAPI CPanel_ExtractIconA(LPITEMIDLIST pidl, LPCSTR pszFile, UINT nIconIndex, HICON *phiconLarge, HICON *phiconSmall, UINT nIconSize);
>   HRESULT WINAPI CPanel_ExtractIconW(LPITEMIDLIST pidl, LPCWSTR pszFile, UINT nIconIndex, HICON *phiconLarge, HICON *phiconSmall, UINT nIconSize);
> diff --git a/dlls/shell32/shellole.c b/dlls/shell32/shellole.c
> index 10244fd..54ae017 100644
> --- a/dlls/shell32/shellole.c
> +++ b/dlls/shell32/shellole.c
> @@ -77,6 +77,7 @@ static const struct {
>   	{&CLSID_ShellLink,	IShellLink_Constructor},
>   	{&CLSID_UnixDosFolder,  UnixDosFolder_Constructor},
>   	{&CLSID_UnixFolder,     UnixFolder_Constructor},
> +        {&CLSID_ExplorerBrowser,ExplorerBrowser_Constructor},
>   	{NULL, NULL}
>   };
>    
Use consistent indentation style please.
> +    }
> +
> +    ZeroMemory(&rc, sizeof(RECT));
>    
You don't test for a rectangle later, so there's no point to initialize it.
> +
> +    hres = IExplorerBrowser_Initialize(lpEB, hwnd,&rc, NULL);
> +    ok(SUCCEEDED(hres), "got (0x%08x)\n", hres);
> +
> +    hres = IExplorerBrowser_Destroy(lpEB);
> +    ok(SUCCEEDED(hres), "got (0x%08x)\n", hres);
> +
> +    /* Initialize again */
> +    IExplorerBrowser_Initialize(lpEB, hwnd,&rc, NULL);
> +    ok(SUCCEEDED(hres), "got (0x%08x)\n", hres);
> +
> +    /* Initialize twice */
> +    IExplorerBrowser_Initialize(lpEB, hwnd,&rc, NULL);
> +    ok(SUCCEEDED(hres), "got (0x%08x)\n", hres);
>    
Please avoid these HRESULT macros in tests, use explicit return values 
like S_OK. SUCCEEDED() hides things.



From testbot at testbot.winehq.org  Mon May 24 07:37:39 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Mon, 24 May 2010 14:37:39 +0200
Subject: shell32: Add IShellBrowser stub to ExplorerBrowser. 
Message-ID: <201005241237.o4OCbdjB005172@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2279

Your paranoid android.


=== WINEBUILD (build) ===
Patch failed


From testbot at testbot.winehq.org  Mon May 24 07:50:38 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Mon, 24 May 2010 14:50:38 +0200
Subject: [PATCH 4/4] shell32: Add IShellBrowser stub to ExplorerBrowser. 
Message-ID: <201005241250.o4OCocT2005535@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2281

Your paranoid android.


=== WINEBUILD (build) ===
Make failed


From testbot at testbot.winehq.org  Mon May 24 07:35:27 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Mon, 24 May 2010 14:35:27 +0200
Subject: shell32: Add ExplorerBrowser with IExplorerBrowser interface
	stub. 
Message-ID: <201005241235.o4OCZRSm005101@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2278

Your paranoid android.


=== WINEBUILD (build) ===
Make failed


From testbot at testbot.winehq.org  Mon May 24 07:40:38 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Mon, 24 May 2010 14:40:38 +0200
Subject: [PATCH 3/4] shell32: Add ExplorerBrowser with IExplorerBrowser
	interface stub. 
Message-ID: <201005241240.o4OCecvS005254@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2280

Your paranoid android.


=== WINEBUILD (build) ===
Make failed


From david.hedberg at gmail.com  Mon May 24 08:13:04 2010
From: david.hedberg at gmail.com (David Hedberg)
Date: Mon, 24 May 2010 15:13:04 +0200
Subject: shell32: Add ExplorerBrowser with IExplorerBrowser interface 
	stub.
In-Reply-To: <4BFA744F.2050200@codeweavers.com>
References: <1274703940-11813-1-git-send-email-david.hedberg@gmail.com>
	<1274703940-11813-3-git-send-email-david.hedberg@gmail.com>
	<4BFA744F.2050200@codeweavers.com>
Message-ID: <AANLkTimP7S5IptAVFnLfxnRRuCvS6orvtl0LHspjnnzB@mail.gmail.com>

On Mon, May 24, 2010 at 2:42 PM, Nikolay Sivov <nsivov at codeweavers.com> wrote:
> On 5/24/2010 16:25, David Hedberg wrote:
>
> Hi, David.
>>
>> +}
>> +
>> +static ULONG WINAPI IExplorerBrowser_fnRelease(IExplorerBrowser *iface)
>> +{
>> + ? ?ExplorerBrowserImpl *This = (ExplorerBrowserImpl*)iface;
>> + ? ?TRACE("This: %p\n", This);
>> +
>> + ? ?This->ref--;
>> + ? ?TRACE("Ref: %d\n", This->ref);
>>
>
> Use interlocked increment/decrement here.
>>
>> +
>> +static HRESULT WINAPI IExplorerBrowser_fnSetRect(
>> + ? ?IExplorerBrowser *iface,
>> + ? ?HDWP *phdwp,
>> + ? ?RECT rcBrowser)
>> +{
>> + ? ?ExplorerBrowserImpl *This = (ExplorerBrowserImpl*)iface;
>> + ? ?TRACE("This: %p\n", This);
>> +
>> + ? ?return E_NOTIMPL;
>>
>
> If it isn't tested to really return E_NOTIMPL you should output a FIXME()
> with a stub comment. };
>>
>> diff --git a/dlls/shell32/shell32_main.h b/dlls/shell32/shell32_main.h
>> index 8f51850..78b37a8 100644
>> --- a/dlls/shell32/shell32_main.h
>> +++ b/dlls/shell32/shell32_main.h
>> @@ -99,6 +99,7 @@ HRESULT WINAPI FolderShortcut_Constructor(IUnknown *
>> pUnkOuter, REFIID riid, LPV
>> ?HRESULT WINAPI MyDocuments_Constructor(IUnknown * pUnkOuter, REFIID riid,
>> LPVOID *ppv);
>> ?HRESULT WINAPI RecycleBin_Constructor(IUnknown * pUnkOuter, REFIID riif,
>> LPVOID *ppv);
>> ?HRESULT WINAPI QueryAssociations_Constructor(IUnknown *pUnkOuter, REFIID
>> riid, LPVOID *ppOutput);
>> +HRESULT WINAPI ExplorerBrowser_Constructor(IUnknown *pUnkOuter, REFIID
>> riid, LPVOID *ppv);
>> ?extern HRESULT CPanel_GetIconLocationW(LPCITEMIDLIST, LPWSTR, UINT,
>> int*);
>> ?HRESULT WINAPI CPanel_ExtractIconA(LPITEMIDLIST pidl, LPCSTR pszFile,
>> UINT nIconIndex, HICON *phiconLarge, HICON *phiconSmall, UINT nIconSize);
>> ?HRESULT WINAPI CPanel_ExtractIconW(LPITEMIDLIST pidl, LPCWSTR pszFile,
>> UINT nIconIndex, HICON *phiconLarge, HICON *phiconSmall, UINT nIconSize);
>> diff --git a/dlls/shell32/shellole.c b/dlls/shell32/shellole.c
>> index 10244fd..54ae017 100644
>> --- a/dlls/shell32/shellole.c
>> +++ b/dlls/shell32/shellole.c
>> @@ -77,6 +77,7 @@ static const struct {
>> ? ? ? ?{&CLSID_ShellLink, ? ? ?IShellLink_Constructor},
>> ? ? ? ?{&CLSID_UnixDosFolder, ?UnixDosFolder_Constructor},
>> ? ? ? ?{&CLSID_UnixFolder, ? ? UnixFolder_Constructor},
>> + ? ? ? ?{&CLSID_ExplorerBrowser,ExplorerBrowser_Constructor},
>> ? ? ? ?{NULL, NULL}
>> ?};
>>
>
> Use consistent indentation style please.
>>
>> + ? ?}
>> +
>> + ? ?ZeroMemory(&rc, sizeof(RECT));
>>
>
> You don't test for a rectangle later, so there's no point to initialize it.

I haven't written any tests to see what ::Initialize can handle yet,
but the reasoning behind the initialization is to make sure that
ExplorerBrowser won't crash randomly due to being passed a bad
rectangle (the RECT parameter is an in-parameter). I think that doing
this is reasonable?

>>
>> +
>> + ? ?hres = IExplorerBrowser_Initialize(lpEB, hwnd,&rc, NULL);
>> + ? ?ok(SUCCEEDED(hres), "got (0x%08x)\n", hres);
>> +
>> + ? ?hres = IExplorerBrowser_Destroy(lpEB);
>> + ? ?ok(SUCCEEDED(hres), "got (0x%08x)\n", hres);
>> +
>> + ? ?/* Initialize again */
>> + ? ?IExplorerBrowser_Initialize(lpEB, hwnd,&rc, NULL);
>> + ? ?ok(SUCCEEDED(hres), "got (0x%08x)\n", hres);
>> +
>> + ? ?/* Initialize twice */
>> + ? ?IExplorerBrowser_Initialize(lpEB, hwnd,&rc, NULL);
>> + ? ?ok(SUCCEEDED(hres), "got (0x%08x)\n", hres);
>>
>
> Please avoid these HRESULT macros in tests, use explicit return values like
> S_OK. SUCCEEDED() hides things.
>
>

Thanks, I will fix these and the similar issues in the IShellBrowser patch.


From nsivov at codeweavers.com  Mon May 24 08:22:37 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Mon, 24 May 2010 17:22:37 +0400
Subject: shell32: Add ExplorerBrowser with IExplorerBrowser interface stub.
In-Reply-To: <AANLkTimP7S5IptAVFnLfxnRRuCvS6orvtl0LHspjnnzB@mail.gmail.com>
References: <1274703940-11813-1-git-send-email-david.hedberg@gmail.com>	
	<1274703940-11813-3-git-send-email-david.hedberg@gmail.com>	
	<4BFA744F.2050200@codeweavers.com>
	<AANLkTimP7S5IptAVFnLfxnRRuCvS6orvtl0LHspjnnzB@mail.gmail.com>
Message-ID: <4BFA7D9D.109@codeweavers.com>

On 5/24/2010 17:13, David Hedberg wrote:
>> You don't test for a rectangle later, so there's no point to initialize it.
>>      
> I haven't written any tests to see what ::Initialize can handle yet,
> but the reasoning behind the initialization is to make sure that
> ExplorerBrowser won't crash randomly due to being passed a bad
> rectangle (the RECT parameter is an in-parameter). I think that doing
> this is reasonable?
>    
Yeah, that's fine then. I personally don't like ZeroMemory, but in that 
case I don't really care.

Also could you use more descriptive test functions names:
> +    test_Initialize();
> +    test_Interfaces();
>    
For example test_supported_interfaces() or something like that, cause 
all these tests are about testing interfaces actually.



From david.hedberg at gmail.com  Mon May 24 08:35:38 2010
From: david.hedberg at gmail.com (David Hedberg)
Date: Mon, 24 May 2010 15:35:38 +0200
Subject: [PATCH 3/4] shell32: Add ExplorerBrowser with IExplorerBrowser 
	interface stub.
In-Reply-To: <201005241240.o4OCecvS005254@v1.gse.nl>
References: <201005241240.o4OCecvS005254@v1.gse.nl>
Message-ID: <AANLkTikPacNTEJgXeCp9wsf3g4WxIqE_HYUYRww0dBuq@mail.gmail.com>

On Mon, May 24, 2010 at 2:40 PM, Marvin <testbot at testbot.winehq.org> wrote:
> Hi,
>
> While running your changed tests on Windows, I think I found new failures.
> Being a bot and all I'm not very good at pattern recognition, so I might be
> wrong, but could you please double-check?
> Full results can be found at
> http://testbot.winehq.org/JobDetails.pl?Key=2280
>
> Your paranoid android.
>
>
> === WINEBUILD (build) ===
> Make failed
>

I applied the patch generated by the testbot on top of master, and
both an ordinary build and a crosstest build seems to complete fine
for me. Am I missing something, or is the problem located elsewhere?


From ggeldorp at vmware.com  Mon May 24 08:51:44 2010
From: ggeldorp at vmware.com (Greg Geldorp)
Date: Mon, 24 May 2010 06:51:44 -0700
Subject: [PATCH 3/4] shell32: Add ExplorerBrowser with IExplorerBrowser
	interface stub.
In-Reply-To: <AANLkTikPacNTEJgXeCp9wsf3g4WxIqE_HYUYRww0dBuq@mail.gmail.com>
References: <201005241240.o4OCecvS005254@v1.gse.nl>
	<AANLkTikPacNTEJgXeCp9wsf3g4WxIqE_HYUYRww0dBuq@mail.gmail.com>
Message-ID: <1C77FC3365DBD149802E0F5381EBE2C903F8307CE8@EXCH-MBX-4.vmware.com>

Hi David,

> From: David Hedberg [mailto:david.hedberg at gmail.com] 
>
> I applied the patch generated by the testbot on top of master, and
> both an ordinary build and a crosstest build seems to complete fine
> for me. Am I missing something, or is the problem located elsewhere?

It's possible that the bot didn't recompile enough of the tree. From the
build output, it's missing definitions (not declarations) of
IID_IExplorerBrowser, CLSID_ExplorerBrowser, IID_ICommDlgBrowser2 and
IID_ICommDlgBrowser3. Where are these defined? Normally I'd expect them to
end up in libuuid.a, but that doesn't seem to be linked in?
Anyway, if you successfully built a crosstest I'd submit that to the bot to
verify the tests.

Ge.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 4183 bytes
Desc: not available
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100524/c588e227/attachment.bin>

From winehacker at gmail.com  Mon May 24 09:26:28 2010
From: winehacker at gmail.com (Steven Edwards)
Date: Mon, 24 May 2010 10:26:28 -0400
Subject: Release plans
In-Reply-To: <AANLkTinefSXllqR1DsBwi6NqRGBffKyu6nWqdYMtkGp0@mail.gmail.com>
References: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
	<AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com>
	<AANLkTikoWzFqD-Ee2kFjwVlo2ElMMl4OchrymfC3WVqz@mail.gmail.com>
	<AANLkTin4WTKwlX4KWum9HOFBB5mv--dd6sqcDMszQ8EJ@mail.gmail.com>
	<AANLkTinwyxF3lmv9V5528ky1eGnarWaR-1ZsQQ_mLYsu@mail.gmail.com>
	<AANLkTilcy3ePboWAqdDaf03jCxmqv79JrrX9w4Kmas-i@mail.gmail.com>
	<AANLkTinbzhouez1bGPCk6NAtFHk_0LLOWREEbVTol7hC@mail.gmail.com>
	<AANLkTinefSXllqR1DsBwi6NqRGBffKyu6nWqdYMtkGp0@mail.gmail.com>
Message-ID: <AANLkTiklKQXMZ-oELvixBv1uOEdnwTceiiEcf_Qcno8n@mail.gmail.com>

On Sat, May 22, 2010 at 12:27 PM, Damjan Jovanovic <damjan.jov at gmail.com> wrote:
> My latest patch set (http://source.winehq.org/patches/data/61966,
> http://source.winehq.org/patches/data/61967,
> http://source.winehq.org/patches/data/61968,
> http://source.winehq.org/patches/data/61969,
> http://source.winehq.org/patches/data/61970) moves all icon generation
> in winemenubuilder to use windowscodecs and only outputs PNG icons.
> This should make it pretty easy to add ICNS icon support.
>
> If you're going to test this before it gets committed, be sure to also
> grab http://source.winehq.org/patches/data/61940 which fixes a nasty
> bug in windowscodecs that corrupts many paletted ICO files. I think
> this was the cause of the image corruption and RGB/BGR issue Steven
> reported in his experiments with windowscodecs in early February.
>
> J?rg can you test whether you still get icons with black backgrounds
> with these patches?

YAY! This makes me feel like I was actually close to understanding how
it all worked ;) Thanks for all of your work on this. Since I have no
clue as to how we should actually implement icns support and how well
it is documented I will try to merge in my Appbundler hack once this
is all merged in to head.

Thanks
-- 
Steven Edwards

"There is one thing stronger than all the armies in the world, and
that is an idea whose time has come." - Victor Hugo


From damjan.jov at gmail.com  Mon May 24 09:56:02 2010
From: damjan.jov at gmail.com (Damjan Jovanovic)
Date: Mon, 24 May 2010 16:56:02 +0200
Subject: Release plans
In-Reply-To: <AANLkTiklKQXMZ-oELvixBv1uOEdnwTceiiEcf_Qcno8n@mail.gmail.com>
References: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
	<AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com>
	<AANLkTikoWzFqD-Ee2kFjwVlo2ElMMl4OchrymfC3WVqz@mail.gmail.com>
	<AANLkTin4WTKwlX4KWum9HOFBB5mv--dd6sqcDMszQ8EJ@mail.gmail.com>
	<AANLkTinwyxF3lmv9V5528ky1eGnarWaR-1ZsQQ_mLYsu@mail.gmail.com>
	<AANLkTilcy3ePboWAqdDaf03jCxmqv79JrrX9w4Kmas-i@mail.gmail.com>
	<AANLkTinbzhouez1bGPCk6NAtFHk_0LLOWREEbVTol7hC@mail.gmail.com>
	<AANLkTinefSXllqR1DsBwi6NqRGBffKyu6nWqdYMtkGp0@mail.gmail.com>
	<AANLkTiklKQXMZ-oELvixBv1uOEdnwTceiiEcf_Qcno8n@mail.gmail.com>
Message-ID: <AANLkTinWhZQpZ0H6z__WmTN85nv1G4k0HBade-JIBnMc@mail.gmail.com>

On Mon, May 24, 2010 at 4:26 PM, Steven Edwards <winehacker at gmail.com> wrote:
> On Sat, May 22, 2010 at 12:27 PM, Damjan Jovanovic <damjan.jov at gmail.com> wrote:
>> My latest patch set (http://source.winehq.org/patches/data/61966,
>> http://source.winehq.org/patches/data/61967,
>> http://source.winehq.org/patches/data/61968,
>> http://source.winehq.org/patches/data/61969,
>> http://source.winehq.org/patches/data/61970) moves all icon generation
>> in winemenubuilder to use windowscodecs and only outputs PNG icons.
>> This should make it pretty easy to add ICNS icon support.
>>
>> If you're going to test this before it gets committed, be sure to also
>> grab http://source.winehq.org/patches/data/61940 which fixes a nasty
>> bug in windowscodecs that corrupts many paletted ICO files. I think
>> this was the cause of the image corruption and RGB/BGR issue Steven
>> reported in his experiments with windowscodecs in early February.
>>
>> J?rg can you test whether you still get icons with black backgrounds
>> with these patches?
>
> YAY! This makes me feel like I was actually close to understanding how
> it all worked ;) Thanks for all of your work on this. Since I have no
> clue as to how we should actually implement icns support and how well
> it is documented I will try to merge in my Appbundler hack once this
> is all merged in to head.
>
> Thanks
> --
> Steven Edwards
>
> "There is one thing stronger than all the armies in the world, and
> that is an idea whose time has come." - Victor Hugo
>

ICNS seems like by far the easiest image file format in existence:
http://en.wikipedia.org/wiki/Apple_Icon_Image

Damjan


From testbot at testbot.winehq.org  Mon May 24 09:51:47 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Mon, 24 May 2010 16:51:47 +0200
Subject: [PATCH 4/4] shell32: Add IShellBrowser stub to ExplorerBrowser. 
Message-ID: <201005241451.o4OEplSG010899@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2284

Your paranoid android.


=== WINEBUILD (build) ===
Make failed


From testbot at testbot.winehq.org  Mon May 24 09:50:25 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Mon, 24 May 2010 16:50:25 +0200
Subject: [PATCH 3/4] shell32: Add ExplorerBrowser with IExplorerBrowser
	interface stub. 
Message-ID: <201005241450.o4OEoPd7010846@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2283

Your paranoid android.


=== WINEBUILD (build) ===
Make failed


From ken at codeweavers.com  Mon May 24 10:19:48 2010
From: ken at codeweavers.com (Ken Thomases)
Date: Mon, 24 May 2010 10:19:48 -0500
Subject: Release plans
In-Reply-To: <AANLkTinWhZQpZ0H6z__WmTN85nv1G4k0HBade-JIBnMc@mail.gmail.com>
References: <47CC5ABB01651443A88DB8EC5B4D657B74036D@S4DE8PSAANK.mitte.t-com.de>
	<AANLkTimveZvGd8t1MM-VuIbgmuJ6jaaCcL5BZD_a5AOS@mail.gmail.com>
	<AANLkTikoWzFqD-Ee2kFjwVlo2ElMMl4OchrymfC3WVqz@mail.gmail.com>
	<AANLkTin4WTKwlX4KWum9HOFBB5mv--dd6sqcDMszQ8EJ@mail.gmail.com>
	<AANLkTinwyxF3lmv9V5528ky1eGnarWaR-1ZsQQ_mLYsu@mail.gmail.com>
	<AANLkTilcy3ePboWAqdDaf03jCxmqv79JrrX9w4Kmas-i@mail.gmail.com>
	<AANLkTinbzhouez1bGPCk6NAtFHk_0LLOWREEbVTol7hC@mail.gmail.com>
	<AANLkTinefSXllqR1DsBwi6NqRGBffKyu6nWqdYMtkGp0@mail.gmail.com>
	<AANLkTiklKQXMZ-oELvixBv1uOEdnwTceiiEcf_Qcno8n@mail.gmail.com>
	<AANLkTinWhZQpZ0H6z__WmTN85nv1G4k0HBade-JIBnMc@mail.gmail.com>
Message-ID: <42920264-DFAC-4232-A434-F2688F369B63@codeweavers.com>

On May 24, 2010, at 9:56 AM, Damjan Jovanovic wrote:

> ICNS seems like by far the easiest image file format in existence:
> http://en.wikipedia.org/wiki/Apple_Icon_Image

It's apparently slightly more complicated than that page suggests, given a simple run-length compression scheme for image data:
http://ezix.org/project/wiki/MacOSXIcons

-Ken



From piotr.caban at gmail.com  Mon May 24 11:04:55 2010
From: piotr.caban at gmail.com (Piotr Caban)
Date: Mon, 24 May 2010 18:04:55 +0200
Subject: msvcrt (1/2): add fstat64i32
In-Reply-To: <1274715913.2250.35.camel@localhost>
References: <1274681395.2250.4.camel@localhost> <4BFA5080.1030109@gmail.com>
	<1274715913.2250.35.camel@localhost>
Message-ID: <4BFAA3A7.2050100@gmail.com>

On 05/24/10 17:45, Robert Wilhelm wrote:
> struct MSVCRT__stat64i32  is already defined in dlls/msvcrt/msvcrt.h
Struct _stat64i32 should be defined in includes/msvcrt/stat.h (this file 
doesn't exist currently). When msvcr90 is compiled it searches this 
directory for headers.
> And these functions are also exported from msvcr80.
You can forward calls to msvcr90 the same way you did to msvcrt. There 
are already examples of this in msvcr80.spec.

Msvcr90 is importing msvcrt, so you can use all functions exported by 
this dll. Keep in mind that msvcrt headers are incomplete and may need 
updating.


From max at veneto.com  Mon May 24 12:29:03 2010
From: max at veneto.com (Massimo Del Fedele)
Date: Mon, 24 May 2010 19:29:03 +0200
Subject: bricscad goes native
In-Reply-To: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com>
References: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com>
Message-ID: <4BFAB75F.8050609@veneto.com>

Il 24/05/2010 02:39, Dan Kegel ha scritto:
> I've long predicted that companies might use Wine
> for a while to ship Linux-compatible products,
> and later switch to a native build once they know
> they have users.  Well, now we have at least one
> example of this: Bricscad (see http://www.bricsys.com ).
>
> This is a *good* thing, and validates somewhat the idea
> that Wine is a catalyst to enable a global shift from
> Windows to Linux.
>
>
>

mhhhhh... I'm following bricscad development and I'd say that
the winelib version was quite a flop.... too many problems
and didn't have the expected success.
The linux native version is (imho) a courageus effort of
Bricsys team to give Linux something that was missing since
too long time :-)
Pity for the choice of wxwidgets, indeed.... it's becoming
too old style, imho, and the portability level isn't that
easy.

Ciao

Max


From max at veneto.com  Mon May 24 12:29:03 2010
From: max at veneto.com (Massimo Del Fedele)
Date: Mon, 24 May 2010 19:29:03 +0200
Subject: bricscad goes native
In-Reply-To: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com>
References: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com>
Message-ID: <4BFAB75F.8050609@veneto.com>

Il 24/05/2010 02:39, Dan Kegel ha scritto:
> I've long predicted that companies might use Wine
> for a while to ship Linux-compatible products,
> and later switch to a native build once they know
> they have users.  Well, now we have at least one
> example of this: Bricscad (see http://www.bricsys.com ).
>
> This is a *good* thing, and validates somewhat the idea
> that Wine is a catalyst to enable a global shift from
> Windows to Linux.
>
>
>

mhhhhh... I'm following bricscad development and I'd say that
the winelib version was quite a flop.... too many problems
and didn't have the expected success.
The linux native version is (imho) a courageus effort of
Bricsys team to give Linux something that was missing since
too long time :-)
Pity for the choice of wxwidgets, indeed.... it's becoming
too old style, imho, and the portability level isn't that
easy.

Ciao

Max



From dank at kegel.com  Mon May 24 17:46:53 2010
From: dank at kegel.com (Dan Kegel)
Date: Mon, 24 May 2010 15:46:53 -0700
Subject: bricscad goes native
In-Reply-To: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com>
References: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com>
Message-ID: <AANLkTilvcaxF7i1i3A5d4BI8jlkETwuRF6qY3Au4Jld5@mail.gmail.com>

Max wrote:
> the winelib version was quite a flop.... too many problems

Indeed.  One should never release naked winelib apps.
Instead, one should bundle the windows version
with a private copy of Wine, like Picasa (and
now at least one other app) have done.


From testbot at testbot.winehq.org  Mon May 24 18:43:57 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Tue, 25 May 2010 01:43:57 +0200
Subject: shell32: Export lowlevel PIDL manipulation calls by name too
	(try2) 
Message-ID: <201005242343.o4ONhvDP015777@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2299

Your paranoid android.


=== WXPPROSP3 (32 bit shlfileop) ===
Can't copy TestLauncher to VM: The command is not recognized by the Guest OS tools


From nsivov at codeweavers.com  Tue May 25 01:04:24 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Tue, 25 May 2010 10:04:24 +0400
Subject: shell32: Export lowlevel PIDL manipulation calls by name too
	(try2)
In-Reply-To: <201005242343.o4ONhvDP015777@v1.gse.nl>
References: <201005242343.o4ONhvDP015777@v1.gse.nl>
Message-ID: <4BFB6868.1020703@codeweavers.com>

On 5/25/2010 03:43,  (Marvin) wrote:
> Hi,
>
> While running your changed tests on Windows, I think I found new failures.
> Being a bot and all I'm not very good at pattern recognition, so I might be
> wrong, but could you please double-check?
> Full results can be found at
> http://testbot.winehq.org/JobDetails.pl?Key=2299
>
> Your paranoid android.
>
>
> === WXPPROSP3 (32 bit shlfileop) ===
> Can't copy TestLauncher to VM: The command is not recognized by the Guest OS tools
>    
Hope it's not a problem of a patch that bot can't copy something :). And 
try2 fixes a failure on NT4 as expected.


From robert.wilhelm at gmx.net  Mon May 24 10:45:13 2010
From: robert.wilhelm at gmx.net (Robert Wilhelm)
Date: Mon, 24 May 2010 17:45:13 +0200
Subject: msvcrt (1/2): add fstat64i32
In-Reply-To: <4BFA5080.1030109@gmail.com>
References: <1274681395.2250.4.camel@localhost> <4BFA5080.1030109@gmail.com>
Message-ID: <1274715913.2250.35.camel@localhost>

Hi,

struct MSVCRT__stat64i32  is already defined in dlls/msvcrt/msvcrt.h
And these functions are also exported from msvcr80.

What would be an acceptable way to deal with this?

Best regards,
Robert

Best regards,
Robert

On Mon, 2010-05-24 at 12:10 +0200, Piotr Caban wrote:
> Hi,
> 
> fstat64i32 and stat64i32 are not exported by native msvcrt.dll. This 
> functions should be implemented in msvcr90.
> 
> Cheers,
> Piotr




From florian at fkoeberle.de  Tue May 25 01:46:10 2010
From: florian at fkoeberle.de (=?ISO-8859-1?Q?Florian_K=F6berle?=)
Date: Tue, 25 May 2010 08:46:10 +0200
Subject: Voting for own bugs not allowed?
Message-ID: <4BFB7232.2020508@fkoeberle.de>

Hello,

just someone informed me that I MUST NOT vote for my own bugs. Is there
a reason for it?

I like to vote for those of my own bugs which are important to me.

It really surprised me that there is this kind of rule and that it can
make your bug being closed as invalid:
http://bugs.winehq.org/show_bug.cgi?id=22857

Best regards,
Florian


From thunderbird2k at gmail.com  Tue May 25 03:27:00 2010
From: thunderbird2k at gmail.com (Roderick Colenbrander)
Date: Tue, 25 May 2010 10:27:00 +0200
Subject: Voting for own bugs not allowed?
In-Reply-To: <4BFB7232.2020508@fkoeberle.de>
References: <4BFB7232.2020508@fkoeberle.de>
Message-ID: <AANLkTimQKHCct9KiFTVYJie_zYdrVEVC6bbDBgSkQDbR@mail.gmail.com>

On Tue, May 25, 2010 at 8:46 AM, Florian K?berle <florian at fkoeberle.de> wrote:
> Hello,
>
> just someone informed me that I MUST NOT vote for my own bugs. Is there
> a reason for it?
>

I think it is disallowed because self promotion can make an app more
important while only few people may use it.

To be honest I would even suggest that we drop this voting stuff
altogether. Personally I think not much developers
look at votes at all. They more look at regressions they caused or
bugs in their field of expertise. Further most are
unpaid and work on stuff they like, so I doubt votes lead them much.

For users votes might be confusing as well. They think voting gives a
bug more priority to fix but as I already mentioned
I doubt it helps (it could help for commercial Wine distributions).

Roderick


From florian at fkoeberle.de  Tue May 25 03:59:35 2010
From: florian at fkoeberle.de (=?ISO-8859-1?Q?Florian_K=F6berle?=)
Date: Tue, 25 May 2010 10:59:35 +0200
Subject: Voting for own bugs not allowed?
In-Reply-To: <4BFB7232.2020508@fkoeberle.de>
References: <4BFB7232.2020508@fkoeberle.de>
Message-ID: <4BFB9177.20600@fkoeberle.de>

Hello,

I got some replys at other places (bug tracker and private email). As I
want to keep the discussion on the mailinglist I will place my arguments
for voting here:

1. Not all bugs I report are important to me. I sometimes just fill in
bugs when I find them but they don't mean much to me.
2. Not all bugs stay important to me. For example when I no longer play
a game I might want to remove my vote from that game to show that less
people are interested in getting the bug fixed.
3. Bugzilla allows you to vote for your own bugs. If it's not intended
that you vote on your own bugs then it should not be possible.


I heard already the following argument against voting for your own bugs:

It produces addtional noice.

-> I don't understand this argument. Voting doesn't cause emails to be
send as far as I know. Only when you are the _second_ one who vote for a
bug then the bug gets auto confirmed.

And the following explanation why voting for my own bug has not been
received well:
"Hmm could it possibly be because you cannot in most systems of
democracy propose a candidate and second them as well? "

-> I don't know a voting process where you can't vote for your own
suggestion. At least here in germany you don't need to show for whom you
have voted. So you can even vote for yourself if you are on the list and
I assume most candidates do so.

Best regards,
Florian


From julliard at winehq.org  Tue May 25 04:22:09 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 25 May 2010 11:22:09 +0200
Subject: gdi32: Properly restore the DC in MF_PlayMetaFile. (RESEND)
In-Reply-To: <alpine.LSU.1.99.1005242123020.26362@acrux.dbai.tuwien.ac.at>
	(Gerald Pfeifer's message of "Mon, 24 May 2010 21:24:05 +0200 (CEST)")
References: <alpine.LSU.1.99.1005242123020.26362@acrux.dbai.tuwien.ac.at>
Message-ID: <878w78tjy6.fsf@wine.dyndns.org>

Gerald Pfeifer <gerald at pfeifer.com> writes:

> Any reason why this hasn't been applied yet?  It's the updated/fixed
> patch per Alexandre's guidance.

It breaks the tests.

-- 
Alexandre Julliard
julliard at winehq.org


From julliard at winehq.org  Tue May 25 04:24:14 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 25 May 2010 11:24:14 +0200
Subject: Remove code which has been #if 0-ed for 11 years from
	DOSCONF_Device and DOSCONF_Install. (RESEND)
In-Reply-To: <alpine.LSU.1.99.1005242132160.26362@acrux.dbai.tuwien.ac.at>
	(Gerald Pfeifer's message of "Mon, 24 May 2010 21:33:11 +0200 (CEST)")
References: <alpine.LSU.1.99.1005242132160.26362@acrux.dbai.tuwien.ac.at>
Message-ID: <874ohwtjup.fsf@wine.dyndns.org>

Gerald Pfeifer <gerald at pfeifer.com> writes:

> An alternate patch would be putting #if 0 around the first occurrence
> of loadhigh, too, but this code has been marked dead for more than 11
> years, so I really think it can / should go?

It doesn't make sense to parse and not do anything with it. If you want
to remove dead code you can remove essentially the entire file.
 
-- 
Alexandre Julliard
julliard at winehq.org


From dgerard at gmail.com  Tue May 25 04:46:25 2010
From: dgerard at gmail.com (David Gerard)
Date: Tue, 25 May 2010 10:46:25 +0100
Subject: Voting for own bugs not allowed?
In-Reply-To: <AANLkTimQKHCct9KiFTVYJie_zYdrVEVC6bbDBgSkQDbR@mail.gmail.com>
References: <4BFB7232.2020508@fkoeberle.de>
	<AANLkTimQKHCct9KiFTVYJie_zYdrVEVC6bbDBgSkQDbR@mail.gmail.com>
Message-ID: <AANLkTilA-VFbXF-HGuEPsPVN8sTaY_HntadIYKRy1pMp@mail.gmail.com>

On 25 May 2010 09:27, Roderick Colenbrander <thunderbird2k at gmail.com> wrote:
> On Tue, May 25, 2010 at 8:46 AM, Florian K?berle <florian at fkoeberle.de> wrote:

>> just someone informed me that I MUST NOT vote for my own bugs. Is there
>> a reason for it?

> I think it is disallowed because self promotion can make an app more
> important while only few people may use it.


So, er ... why not disable the ability to do such a thing? Rather than
shouting at people and closing otherwise-valid bugs. I suppose it
depends how much you need to put people off participating at all.


- d.


From m.b.lankhorst at gmail.com  Tue May 25 04:50:20 2010
From: m.b.lankhorst at gmail.com (Maarten Lankhorst)
Date: Tue, 25 May 2010 11:50:20 +0200
Subject: Voting for own bugs not allowed?
In-Reply-To: <4BFB9177.20600@fkoeberle.de>
References: <4BFB7232.2020508@fkoeberle.de> <4BFB9177.20600@fkoeberle.de>
Message-ID: <4BFB9D5C.9010204@gmail.com>

Hi Florian,

On 25-05-10 10:59, Florian K?berle wrote:
> Hello,
>
> I got some replys at other places (bug tracker and private email). As I
> want to keep the discussion on the mailinglist I will place my arguments
> for voting here:
>
> 1. Not all bugs I report are important to me. I sometimes just fill in
> bugs when I find them but they don't mean much to me.
>    
Can set the  'importance' field lower then :)
> 2. Not all bugs stay important to me. For example when I no longer play
> a game I might want to remove my vote from that game to show that less
> people are interested in getting the bug fixed.
>    
Well, I honestly say I never look at votes myself, the size of the CC 
list is how I see how important a bug is to people. :) If enough people 
care, they want to be mailed on updates as well, so they can help out in 
fixing the bug.
> 3. Bugzilla allows you to vote for your own bugs. If it's not intended
> that you vote on your own bugs then it should not be possible.
>    
I'm for a patch to remove voting altogether.

Cheers,
Maarten


From julliard at winehq.org  Tue May 25 04:57:53 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 25 May 2010 11:57:53 +0200
Subject: winemenubuilder: use the full path to start.exe (try 2)
In-Reply-To: <AANLkTimr1yC7G9RGoSpyyraxr3_rWIC8j65iXQNJGG9c@mail.gmail.com>
	(Damjan Jovanovic's message of "Mon, 24 May 2010 21:18:08 +0200")
References: <AANLkTimr1yC7G9RGoSpyyraxr3_rWIC8j65iXQNJGG9c@mail.gmail.com>
Message-ID: <87zkzos3q6.fsf@wine.dyndns.org>

Damjan Jovanovic <damjan.jov at gmail.com> writes:

> Changelog:
> * use the full path to start.exe

Why do you need this?

-- 
Alexandre Julliard
julliard at winehq.org


From nsivov at codeweavers.com  Tue May 25 04:58:17 2010
From: nsivov at codeweavers.com (Nikolay Sivov)
Date: Tue, 25 May 2010 13:58:17 +0400
Subject: [PATCH] shlwapi: initial implement of SHAutoComplete (Retry)
In-Reply-To: <AANLkTilX5RpDfzLE0lpm-ZhaRAlmMYqnwqAO1ux1WX3T@mail.gmail.com>
References: <AANLkTilX5RpDfzLE0lpm-ZhaRAlmMYqnwqAO1ux1WX3T@mail.gmail.com>
Message-ID: <4BFB9F39.60502@codeweavers.com>

On 5/25/2010 03:29, Hirofumi Katayama wrote:
> See attachment.
>    
Hi.
> +        list = (LPWSTR) malloc(len);
> +        free(list);
Use HeapAlloc()/HeapFree() for that and others allocations.

> +    fUnicode = IsWindowUnicode(hwndEdit);
> +    if (fUnicode)
> +        pProp = (AUTOCOMPLETEPROP *) GetPropW(hwndEdit, szPropNameW);
> +    else
> +        pProp = (AUTOCOMPLETEPROP *) GetPropA(hwndEdit, szPropNameA);
This is unrelated thing. You can use GetPropW for non-Unicode windows as 
well.


From damjan.jov at gmail.com  Tue May 25 05:38:45 2010
From: damjan.jov at gmail.com (Damjan Jovanovic)
Date: Tue, 25 May 2010 12:38:45 +0200
Subject: winemenubuilder: use the full path to start.exe (try 2)
In-Reply-To: <87zkzos3q6.fsf@wine.dyndns.org>
References: <AANLkTimr1yC7G9RGoSpyyraxr3_rWIC8j65iXQNJGG9c@mail.gmail.com>
	<87zkzos3q6.fsf@wine.dyndns.org>
Message-ID: <AANLkTilIFc4-j7aw5vnfi1ETMpCqTcgy5MVZTokppdbF@mail.gmail.com>

On Tue, May 25, 2010 at 11:57 AM, Alexandre Julliard
<julliard at winehq.org> wrote:
> Damjan Jovanovic <damjan.jov at gmail.com> writes:
>
>> Changelog:
>> * use the full path to start.exe
>
> Why do you need this?
>
> --
> Alexandre Julliard
> julliard at winehq.org
>

There might be a start.[exe/com/bat/whatever] in the directory wine
starts up in, which would get called instead of the one in
C:\Windows\...

Damjan Jovanovic


From testbot at testbot.winehq.org  Tue May 25 05:42:55 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Tue, 25 May 2010 12:42:55 +0200
Subject: [3/3] msi: End the search for a directory signature if the parent
	cannot be found. 
Message-ID: <201005251042.o4PAgtrD009457@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2305

Your paranoid android.


=== W7PROX64 (32 bit package) ===
package.c:7603: Test failed: Expected "C:\winetest\FileName1", got ""
package.c:7609: Test failed: Expected "C:\winetest\FileName2", got ""
package.c:7615: Test failed: Expected "C:\winetest\FileName3", got ""
package.c:7627: Test failed: Expected "C:\winetest\FileName5", got ""
package.c:7633: Test failed: Expected "C:\winetest\", got ""
package.c:7639: Test failed: Expected "C:\winetest\", got ""
package.c:7655: Test failed: Expected "C:\winetest\FileName8.dll", got ""
package.c:7666: Test failed: Expected "C:\winetest\FileName10.dll", got ""
package.c:11676: Test failed: Expected "{2C5EE045-5C09-40BD-93F8-086EC36919FF}", got "apple"
package.c:11703: Test failed: Expected first 3 chars of "{2C5EE045-5C09-40BD-93F8-086EC36919FF}", got "apple"
package.c:11713: Test failed: Expected first 37 chars of "{2C5EE045-5C09-40BD-93F8-086EC36919FF}", got "apple"
package.c:11723: Test failed: Expected "{2C5EE045-5C09-40BD-93F8-086EC36919FF}", got "apple"
package.c:11755: Test failed: Expected "{2C5EE045-5C09-40BD-93F8-086EC36919FF}", got "apple"

=== W7PROX64 (64 bit package) ===
package.c:8212: Test failed: Expected "C:\winetest\FileName1", got ""
package.c:8223: Test failed: Expected "C:\winetest\", got ""
package.c:8234: Test failed: Expected "C:\winetest\", got ""
package.c:8284: Test failed: Expected "C:\winetest\FileName3.dll", got ""
package.c:8295: Test failed: Expected "C:\winetest\FileName5.dll", got ""
package.c:8304: Test failed: Expected "C:\", got ""
package.c:8310: Test failed: Expected "C:\winetest\", got ""
package.c:8331: Test failed: Expected "C:\winetest\FileName1", got ""
package.c:8340: Test failed: Expected "C:\winetest\FileName1", got ""


From testbot at testbot.winehq.org  Tue May 25 06:01:17 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Tue, 25 May 2010 13:01:17 +0200
Subject: [4/4] wininet: Add tests for setting and retrieving the context
	value. 
Message-ID: <201005251101.o4PB1HID010372@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2306

Your paranoid android.


=== W2K3R2SESP2 (32 bit http) ===
http.c:406: Test failed: expected status 11 (INTERNET_STATUS_NAME_RESOLVED) 1 times, received 0 times
http.c:413: Test failed: expected status 30 (INTERNET_STATUS_SENDING_REQUEST) 2 times, received 0 times
http.c:414: Test failed: expected status 31 (INTERNET_STATUS_REQUEST_SENT) 2 times, received 0 times
http.c:415: Test failed: expected status 40 (INTERNET_STATUS_RECEIVING_RESPONSE) 2 times, received 0 times
http.c:416: Test failed: expected status 41 (INTERNET_STATUS_RESPONSE_RECEIVED) 2 times, received 0 times
http.c:418: Test failed: expected status 110 (INTERNET_STATUS_REDIRECT) 1 times, received 0 times
http.c:443: Test failed: Wrong URL http://test.winehq.org/testredirect
http.c:148: Test failed: unexpected status 10 (INTERNET_STATUS_RESOLVING_NAME)
http.c:410: Test failed: expected status 10 (INTERNET_STATUS_RESOLVING_NAME) 0 times, received 1 times
http.c:413: Test failed: expected status 30 (INTERNET_STATUS_SENDING_REQUEST) 2 times, received 0 times
http.c:414: Test failed: expected status 31 (INTERNET_STATUS_REQUEST_SENT) 2 times, received 0 times
http.c:415: Test failed: expected status 40 (INTERNET_STATUS_RECEIVING_RESPONSE) 2 times, received 0 times
http.c:416: Test failed: expected status 41 (INTERNET_STATUS_RESPONSE_RECEIVED) 2 times, received 0 times
http.c:418: Test failed: expected status 110 (INTERNET_STATUS_REDIRECT) 1 times, received 0 times
http.c:443: Test failed: Wrong URL http://test.winehq.org/testredirect
http.c:148: Test failed: unexpected status 10 (INTERNET_STATUS_RESOLVING_NAME)
http.c:771: Test failed: expected status 10 (INTERNET_STATUS_RESOLVING_NAME) 0 times, received 1 times
http.c:774: Test failed: expected status 30 (INTERNET_STATUS_SENDING_REQUEST) 2 times, received 0 times
http.c:775: Test failed: expected status 31 (INTERNET_STATUS_REQUEST_SENT) 2 times, received 0 times
http.c:776: Test failed: expected status 40 (INTERNET_STATUS_RECEIVING_RESPONSE) 2 times, received 0 times
http.c:777: Test failed: expected status 41 (INTERNET_STATUS_RESPONSE_RECEIVED) 2 times, received 0 times
http.c:780: Test failed: expected status 110 (INTERNET_STATUS_REDIRECT) 1 times, received 0 times
http.c:899: Test failed: failed to read any of the document
http.c:2719: Test failed: InternetQueryOption failed: 12018
http.c:2720: Test failed: expected INTERNET_HANDLE_TYPE_HTTP_REQUEST, got 0
http.c:2725: Test failed: HttpQueryInfo failed
http.c:2726: Test failed: expected size > 0
Timeout


From julliard at winehq.org  Tue May 25 06:30:57 2010
From: julliard at winehq.org (Alexandre Julliard)
Date: Tue, 25 May 2010 13:30:57 +0200
Subject: winemenubuilder: use the full path to start.exe (try 2)
In-Reply-To: <AANLkTilIFc4-j7aw5vnfi1ETMpCqTcgy5MVZTokppdbF@mail.gmail.com>
	(Damjan Jovanovic's message of "Tue, 25 May 2010 12:38:45 +0200")
References: <AANLkTimr1yC7G9RGoSpyyraxr3_rWIC8j65iXQNJGG9c@mail.gmail.com>
	<87zkzos3q6.fsf@wine.dyndns.org>
	<AANLkTilIFc4-j7aw5vnfi1ETMpCqTcgy5MVZTokppdbF@mail.gmail.com>
Message-ID: <87r5l0rzf2.fsf@wine.dyndns.org>

Damjan Jovanovic <damjan.jov at gmail.com> writes:

> There might be a start.[exe/com/bat/whatever] in the directory wine
> starts up in, which would get called instead of the one in
> C:\Windows\...

OK, makes sense.

-- 
Alexandre Julliard
julliard at winehq.org


From dimesio at earthlink.net  Tue May 25 08:45:59 2010
From: dimesio at earthlink.net (Rosanne DiMesio)
Date: Tue, 25 May 2010 08:45:59 -0500
Subject: Voting for own bugs not allowed?
In-Reply-To: <AANLkTimQKHCct9KiFTVYJie_zYdrVEVC6bbDBgSkQDbR@mail.gmail.com>
References: <4BFB7232.2020508@fkoeberle.de>
	<AANLkTimQKHCct9KiFTVYJie_zYdrVEVC6bbDBgSkQDbR@mail.gmail.com>
Message-ID: <20100525084559.4b2af81a.dimesio@earthlink.net>

On Tue, 25 May 2010 10:27:00 +0200
Roderick Colenbrander <thunderbird2k at gmail.com> wrote:

> 
> For users votes might be confusing as well. They think voting gives a
> bug more priority to fix but as I already mentioned
> I doubt it helps (it could help for commercial Wine distributions).
> 

+1
It's definitely misleading to users. There are sporadic posts on the forum urging people to vote for a bug, as if it made a difference, and angry posts that bugs that have lots of votes aren't fixed yet. The one purpose I can see it serving is that a bug can be "confirmed by popular vote" and the status changed to new if a couple of people vote for it. That's why users shouldn't vote for their own bugs--the point is independent confirmation. So I'm all for removing the field, but if it's kept, I suggest at least changing the wording from "vote" to something like "confirm you can reproduce this bug."

-- 
Rosanne DiMesio <dimesio at earthlink.net>


From dgerard at gmail.com  Tue May 25 08:50:34 2010
From: dgerard at gmail.com (David Gerard)
Date: Tue, 25 May 2010 14:50:34 +0100
Subject: Voting for own bugs not allowed?
In-Reply-To: <20100525084559.4b2af81a.dimesio@earthlink.net>
References: <4BFB7232.2020508@fkoeberle.de>
	<AANLkTimQKHCct9KiFTVYJie_zYdrVEVC6bbDBgSkQDbR@mail.gmail.com>
	<20100525084559.4b2af81a.dimesio@earthlink.net>
Message-ID: <AANLkTikzA8P20ur76zjElfFy-bki7W7xnt_lZ161QIpL@mail.gmail.com>

On 25 May 2010 14:45, Rosanne DiMesio <dimesio at earthlink.net> wrote:

> It's definitely misleading to users. There are sporadic posts on the forum urging people to vote for a bug, as if it made a difference, and angry posts that bugs that have lots of votes aren't fixed yet. The one purpose I can see it serving is that a bug can be "confirmed by popular vote" and the status changed to new if a couple of people vote for it. That's why users shouldn't vote for their own bugs--the point is independent confirmation. So I'm all for removing the field, but if it's kept, I suggest at least changing the wording from "vote" to something like "confirm you can reproduce this bug."


This would be like the "this is a problem for me too" field in
Launchpad, and may be useful.


- d.


From wine-devel at kievinfo.com  Tue May 25 08:55:29 2010
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 25 May 2010 07:55:29 -0600
Subject: Voting for own bugs not allowed?
In-Reply-To: <4BFB7232.2020508@fkoeberle.de>
References: <4BFB7232.2020508@fkoeberle.de>
Message-ID: <4BFBD6D1.8030408@kievinfo.com>

On 05/25/2010 12:46 AM, Florian K?berle wrote:
> Hello,
> 
> just someone informed me that I MUST NOT vote for my own bugs. Is there
> a reason for it?

Voting for your own bug confirms it (changes status to NEW). You can not
confirm your own bugs. As simple as that.

And honestly for most developers it doesn't matter how many people voted for
a bug. Wine as it is have pliantly of them to fix.

Vitaliy.


From wine-devel at kievinfo.com  Tue May 25 08:59:24 2010
From: wine-devel at kievinfo.com (Vitaliy Margolen)
Date: Tue, 25 May 2010 07:59:24 -0600
Subject: Voting for own bugs not allowed?
In-Reply-To: <4BFB9D5C.9010204@gmail.com>
References: <4BFB7232.2020508@fkoeberle.de> <4BFB9177.20600@fkoeberle.de>
	<4BFB9D5C.9010204@gmail.com>
Message-ID: <4BFBD7BC.60301@kievinfo.com>

On 05/25/2010 03:50 AM, Maarten Lankhorst wrote:
> I'm for a patch to remove voting altogether.
+1
Actually no patch needed. Voting can be disabled via option "usevotes".

Vitaliy.


From andrey.turkin at gmail.com  Tue May 25 10:05:42 2010
From: andrey.turkin at gmail.com (Andrey Turkin)
Date: Tue, 25 May 2010 19:05:42 +0400
Subject: atl: reuse code of AtlModuleRegisterWndClassInfoW
	for	AtlModuleRegisterWndClassInfoA (try 2)
In-Reply-To: <4BFBE3D4.6000604@dawncrow.de>
References: <4BFBE3D4.6000604@dawncrow.de>
Message-ID: <4BFBE746.3000502@gmail.com>

25.05.2010 18:51, Andr? Hentschel wrote:
> --- a/dlls/atl/atlwin.h
> +++ b/dlls/atl/atlwin.h
> @@ -43,7 +43,7 @@ typedef struct _ATL_WNDCLASSINFOW_TAG
>       WCHAR m_szAutoName[14];
>   } _ATL_WNDCLASSINFOW;
>
> -ATOM WINAPI AtlModuleRegisterWndClassInfoA(_ATL_MODULEW *pm, _ATL_WNDCLASSINFOA *wci, WNDPROC *pProc);
> +ATOM WINAPI AtlModuleRegisterWndClassInfoA(_ATL_MODULEA *pm, _ATL_WNDCLASSINFOA *wci, WNDPROC *pProc);
>   ATOM WINAPI AtlModuleRegisterWndClassInfoW(_ATL_MODULEW *pm, _ATL_WNDCLASSINFOW *wci, WNDPROC *pProc);
>
>   HDC WINAPI AtlCreateTargetDC(HDC hdc, DVTARGETDEVICE *ptd);
>    
Are you sure about this change?



From florian at fkoeberle.de  Tue May 25 10:10:10 2010
From: florian at fkoeberle.de (=?ISO-8859-1?Q?Florian_K=F6berle?=)
Date: Tue, 25 May 2010 17:10:10 +0200
Subject: Voting for own bugs not allowed?
In-Reply-To: <4BFBD6D1.8030408@kievinfo.com>
References: <4BFB7232.2020508@fkoeberle.de> <4BFBD6D1.8030408@kievinfo.com>
Message-ID: <4BFBE852.3030007@fkoeberle.de>

On 05/25/2010 03:55 PM, Vitaliy Margolen wrote:
> On 05/25/2010 12:46 AM, Florian K?berle wrote:
>   
>> Hello,
>>
>> just someone informed me that I MUST NOT vote for my own bugs. Is there
>> a reason for it?
>>     
> Voting for your own bug confirms it (changes status to NEW). You can not
> confirm your own bugs. As simple as that.
>   

Hello Vitaliy,

two votes are required for a bug to be confirmed. In the case bug 22857
another user was just faster then me in voting for the bug. That's why
it looked like I was confirming my own bug.

I agree with you that an author should not confirm his/her own bugs as
it would make the state UNCONFIRMED superfluous.

Best regards,
Florian


From austinenglish at gmail.com  Tue May 25 10:32:40 2010
From: austinenglish at gmail.com (Austin English)
Date: Tue, 25 May 2010 10:32:40 -0500
Subject: Voting for own bugs not allowed?
In-Reply-To: <4BFBD7BC.60301@kievinfo.com>
References: <4BFB7232.2020508@fkoeberle.de> <4BFB9177.20600@fkoeberle.de> 
	<4BFB9D5C.9010204@gmail.com> <4BFBD7BC.60301@kievinfo.com>
Message-ID: <AANLkTilETcFXVLo9rmhTNnWWHjl2wfZGrGP_gbQPMo9J@mail.gmail.com>

On Tue, May 25, 2010 at 8:59 AM, Vitaliy Margolen
<wine-devel at kievinfo.com> wrote:
> On 05/25/2010 03:50 AM, Maarten Lankhorst wrote:
>> I'm for a patch to remove voting altogether.
> +1
> Actually no patch needed. Voting can be disabled via option "usevotes".

Let's disable it then, but that's no reason to close otherwise valid
bugs as invalid.

-- 
-Austin


From nerv at dawncrow.de  Tue May 25 10:58:45 2010
From: nerv at dawncrow.de (=?ISO-8859-15?Q?Andr=E9_Hentschel?=)
Date: Tue, 25 May 2010 17:58:45 +0200
Subject: atl: reuse code of
	AtlModuleRegisterWndClassInfoW	for	AtlModuleRegisterWndClassInfoA
	(try 2)
In-Reply-To: <4BFBE746.3000502@gmail.com>
References: <4BFBE3D4.6000604@dawncrow.de> <4BFBE746.3000502@gmail.com>
Message-ID: <4BFBF3B5.9070808@dawncrow.de>

Am 25.05.2010 17:05, schrieb Andrey Turkin:
> 25.05.2010 18:51, Andr? Hentschel wrote:
>> --- a/dlls/atl/atlwin.h
>> +++ b/dlls/atl/atlwin.h
>> @@ -43,7 +43,7 @@ typedef struct _ATL_WNDCLASSINFOW_TAG
>>       WCHAR m_szAutoName[14];
>>   } _ATL_WNDCLASSINFOW;
>>
>> -ATOM WINAPI AtlModuleRegisterWndClassInfoA(_ATL_MODULEW *pm,
>> _ATL_WNDCLASSINFOA *wci, WNDPROC *pProc);
>> +ATOM WINAPI AtlModuleRegisterWndClassInfoA(_ATL_MODULEA *pm,
>> _ATL_WNDCLASSINFOA *wci, WNDPROC *pProc);
>>   ATOM WINAPI AtlModuleRegisterWndClassInfoW(_ATL_MODULEW *pm,
>> _ATL_WNDCLASSINFOW *wci, WNDPROC *pProc);
>>
>>   HDC WINAPI AtlCreateTargetDC(HDC hdc, DVTARGETDEVICE *ptd);
>>    
> Are you sure about this change?
> 

95 percent. the unicode struct would not make much sense to me.

-- 

Best Regards, Andr? Hentschel


From andrey.turkin at gmail.com  Tue May 25 11:18:24 2010
From: andrey.turkin at gmail.com (Andrey Turkin)
Date: Tue, 25 May 2010 20:18:24 +0400
Subject: atl: reuse code of
	AtlModuleRegisterWndClassInfoW	for	AtlModuleRegisterWndClassInfoA
	(try 2)
In-Reply-To: <4BFBF3B5.9070808@dawncrow.de>
References: <4BFBE3D4.6000604@dawncrow.de> <4BFBE746.3000502@gmail.com>
	<4BFBF3B5.9070808@dawncrow.de>
Message-ID: <4BFBF850.1090206@gmail.com>

25.05.2010 19:58, Andr? Hentschel wrote:
> Am 25.05.2010 17:05, schrieb Andrey Turkin:
>    
>> 25.05.2010 18:51, Andr? Hentschel wrote:
>>      
>>> --- a/dlls/atl/atlwin.h
>>> +++ b/dlls/atl/atlwin.h
>>> @@ -43,7 +43,7 @@ typedef struct _ATL_WNDCLASSINFOW_TAG
>>>        WCHAR m_szAutoName[14];
>>>    } _ATL_WNDCLASSINFOW;
>>>
>>> -ATOM WINAPI AtlModuleRegisterWndClassInfoA(_ATL_MODULEW *pm,
>>> _ATL_WNDCLASSINFOA *wci, WNDPROC *pProc);
>>> +ATOM WINAPI AtlModuleRegisterWndClassInfoA(_ATL_MODULEA *pm,
>>> _ATL_WNDCLASSINFOA *wci, WNDPROC *pProc);
>>>    ATOM WINAPI AtlModuleRegisterWndClassInfoW(_ATL_MODULEW *pm,
>>> _ATL_WNDCLASSINFOW *wci, WNDPROC *pProc);
>>>
>>>    HDC WINAPI AtlCreateTargetDC(HDC hdc, DVTARGETDEVICE *ptd);
>>>
>>>        
>> Are you sure about this change?
>>
>>      
> 95 percent. the unicode struct would not make much sense to me.
>
>    
The reason I asked was caused by the fact SDK's header specifies same 
unqualified _ATL_MODULE type for both functions so unless native atl.dll 
was partially unicode and partiall ansi compiled both functions would 
have same type of the argument. So I thought you might have some proof 
of whether this is true.
Ansi version indeed makes more sense here (since most callers who uses 
ansi version of the function would probably have their _Module as ansi 
too) . Anyway, the code of this function doesn't use any of 
unicode-dependant parts of _ATL_MODULE so any type will do.




From apenwarr at gmail.com  Tue May 25 12:21:17 2010
From: apenwarr at gmail.com (Avery Pennarun)
Date: Tue, 25 May 2010 13:21:17 -0400
Subject: bricscad goes native
In-Reply-To: <AANLkTilvcaxF7i1i3A5d4BI8jlkETwuRF6qY3Au4Jld5@mail.gmail.com>
References: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com> 
	<AANLkTilvcaxF7i1i3A5d4BI8jlkETwuRF6qY3Au4Jld5@mail.gmail.com>
Message-ID: <AANLkTinyx3F6JAb0F3Br6Ul_AasQCX6Whtc04cX-M8u_@mail.gmail.com>

On Mon, May 24, 2010 at 6:46 PM, Dan Kegel <dank at kegel.com> wrote:
> Max wrote:
>> the winelib version was quite a flop.... too many problems
>
> Indeed. ?One should never release naked winelib apps.
> Instead, one should bundle the windows version
> with a private copy of Wine, like Picasa (and
> now at least one other app) have done.

Why is that better?  What's the point of winelib then?

Thanks,

Avery


From dank at kegel.com  Tue May 25 12:47:03 2010
From: dank at kegel.com (Dan Kegel)
Date: Tue, 25 May 2010 10:47:03 -0700
Subject: bricscad goes native
In-Reply-To: <AANLkTinyx3F6JAb0F3Br6Ul_AasQCX6Whtc04cX-M8u_@mail.gmail.com>
References: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com>
	<AANLkTilvcaxF7i1i3A5d4BI8jlkETwuRF6qY3Au4Jld5@mail.gmail.com>
	<AANLkTinyx3F6JAb0F3Br6Ul_AasQCX6Whtc04cX-M8u_@mail.gmail.com>
Message-ID: <AANLkTim51nvuruznPRz6Cz4vyJqFprq6ReqTEYApMG5m@mail.gmail.com>

On Tue, May 25, 2010 at 10:21 AM, Avery Pennarun <apenwarr at gmail.com> wrote:
>>> the winelib version was quite a flop.... too many problems
>>
>> Indeed. ?One should never release naked winelib apps.
>> Instead, one should bundle the windows version
>> with a private copy of Wine, like Picasa (and
>> now at least one other app) have done.
>
> Why is that better? ?What's the point of winelib then?

Winelib is mostly useful when recompiling a windows app to
run on a non-x86 platform (where win32 compilers aren't available).
You could also use it to build a linux plugin for a windows app
running on Wine.
In either case, you probably want to bundle the Wine runtime
with the app rather than trying to run against whatever Wine
the user has.
- Dan


From apenwarr at gmail.com  Tue May 25 12:58:54 2010
From: apenwarr at gmail.com (Avery Pennarun)
Date: Tue, 25 May 2010 13:58:54 -0400
Subject: bricscad goes native
In-Reply-To: <AANLkTim51nvuruznPRz6Cz4vyJqFprq6ReqTEYApMG5m@mail.gmail.com>
References: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com> 
	<AANLkTilvcaxF7i1i3A5d4BI8jlkETwuRF6qY3Au4Jld5@mail.gmail.com> 
	<AANLkTinyx3F6JAb0F3Br6Ul_AasQCX6Whtc04cX-M8u_@mail.gmail.com> 
	<AANLkTim51nvuruznPRz6Cz4vyJqFprq6ReqTEYApMG5m@mail.gmail.com>
Message-ID: <AANLkTinBQ-HVTRu86gYbAbO-Va1pWfjrUVbnVZ07S7iw@mail.gmail.com>

On Tue, May 25, 2010 at 1:47 PM, Dan Kegel <dank at kegel.com> wrote:
> On Tue, May 25, 2010 at 10:21 AM, Avery Pennarun <apenwarr at gmail.com> wrote:
>>>> the winelib version was quite a flop.... too many problems
>>>
>>> Indeed. ?One should never release naked winelib apps.
>>> Instead, one should bundle the windows version
>>> with a private copy of Wine, like Picasa (and
>>> now at least one other app) have done.
>>
>> Why is that better? ?What's the point of winelib then?
>
> Winelib is mostly useful when recompiling a windows app to
> run on a non-x86 platform (where win32 compilers aren't available).

Ah, that makes sense.

> In either case, you probably want to bundle the Wine runtime
> with the app rather than trying to run against whatever Wine
> the user has.

I guess this is because wine is such a moving target?  It seems a
shame to bundle a copy of wine with every single app, although I can
definitely see how commercial products would want to do that to
improve repeatability.  One would hope that all the automated testing
wine is doing lately would reduce the need for this kind of thing
eventually.

Thanks,

Avery


From dank at kegel.com  Tue May 25 13:39:56 2010
From: dank at kegel.com (Dan Kegel)
Date: Tue, 25 May 2010 11:39:56 -0700
Subject: bricscad goes native
In-Reply-To: <AANLkTinBQ-HVTRu86gYbAbO-Va1pWfjrUVbnVZ07S7iw@mail.gmail.com>
References: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com>
	<AANLkTilvcaxF7i1i3A5d4BI8jlkETwuRF6qY3Au4Jld5@mail.gmail.com>
	<AANLkTinyx3F6JAb0F3Br6Ul_AasQCX6Whtc04cX-M8u_@mail.gmail.com>
	<AANLkTim51nvuruznPRz6Cz4vyJqFprq6ReqTEYApMG5m@mail.gmail.com>
	<AANLkTinBQ-HVTRu86gYbAbO-Va1pWfjrUVbnVZ07S7iw@mail.gmail.com>
Message-ID: <AANLkTin5sJ7YuoJ3atPgzDJMRP0nvYiB-MdoPLJjWQhw@mail.gmail.com>

On Tue, May 25, 2010 at 10:58 AM, Avery Pennarun <apenwarr at gmail.com> wrote:
>> In either case, you probably want to bundle the Wine runtime
>> with the app rather than trying to run against whatever Wine
>> the user has.
>
> I guess this is because wine is such a moving target? ?It seems a
> shame to bundle a copy of wine with every single app, although I can
> definitely see how commercial products would want to do that to
> improve repeatability. ?One would hope that all the automated testing
> wine is doing lately would reduce the need for this kind of thing
> eventually.

Commercial apps should continue bundling their own wine no matter
what we do, I think.   It'll be a while before they can count
on everyone already having a wine installed that can handle their app.
And security concerns might prevent wine from being installed by default
on some distros.


From wolfram at the-dreams.de  Tue May 25 19:49:32 2010
From: wolfram at the-dreams.de (Wolfram Sang)
Date: Wed, 26 May 2010 02:49:32 +0200
Subject: Voting for own bugs not allowed?
In-Reply-To: <4BFBD6D1.8030408@kievinfo.com>
References: <4BFB7232.2020508@fkoeberle.de> <4BFBD6D1.8030408@kievinfo.com>
Message-ID: <4BFC701C.6050005@the-dreams.de>

> Voting for your own bug confirms it (changes status to NEW). You can not
> confirm your own bugs. As simple as that.

While I generally agree, the "status-changing" is an effect a number of
bugzilla-users (especially new ones) are probably not aware of.
Documentation helps here (on the voting-page, for example). Also, not
counting votes from the bug-submitter could probably be patched into the
software? There are some options, but invalidating valid bugs doesn't help
wine imho.


Regards,

   Wolfram


From wolfram at the-dreams.de  Tue May 25 19:57:06 2010
From: wolfram at the-dreams.de (Wolfram Sang)
Date: Wed, 26 May 2010 02:57:06 +0200
Subject: Voting for own bugs not allowed?
In-Reply-To: <AANLkTilETcFXVLo9rmhTNnWWHjl2wfZGrGP_gbQPMo9J@mail.gmail.com>
References: <4BFB7232.2020508@fkoeberle.de> <4BFB9177.20600@fkoeberle.de>
	<4BFB9D5C.9010204@gmail.com> <4BFBD7BC.60301@kievinfo.com>
	<AANLkTilETcFXVLo9rmhTNnWWHjl2wfZGrGP_gbQPMo9J@mail.gmail.com>
Message-ID: <4BFC71E2.5090109@the-dreams.de>

> Let's disable it then, but that's no reason to close otherwise valid
> bugs as invalid.

Hmm, I am currently abusing the vote-system to mark bugs I am especially
interested in right now. Is there any better way to do this? Searching for
CC is not quite the same (but will do if needed).

Regards,

   Wolfram


From jjmckenzie51 at earthlink.net  Tue May 25 20:27:49 2010
From: jjmckenzie51 at earthlink.net (James Mckenzie)
Date: Tue, 25 May 2010 18:27:49 -0700 (GMT-07:00)
Subject: Voting for own bugs not allowed?
Message-ID: <14896237.1274837269793.JavaMail.root@elwamui-milano.atl.sa.earthlink.net>

>
>On Tue, May 25, 2010 at 8:59 AM, Vitaliy Margolen
><wine-devel at kievinfo.com> wrote:
>> On 05/25/2010 03:50 AM, Maarten Lankhorst wrote:
>>> I'm for a patch to remove voting altogether.
>> +1
>> Actually no patch needed. Voting can be disabled via option "usevotes".
>
>Let's disable it then, but that's no reason to close otherwise valid
>bugs as invalid.
>
Actually, I like Rosanne's idea.  Make the field 'Can you reproduce this bug' and not allow the 'confirmed by votes' function.  Only a bug report that has been confirmed by an interested developer should be moved into that status and immediately followed by a work-in-progress type status with a dev name associated with it.

And I agree that people who report bugs should not be able to confirm, but they can supply hacks/patches that fix the problem...

James McKenzie



From scott at open-vote.org  Tue May 25 23:44:39 2010
From: scott at open-vote.org (Scott Ritchie)
Date: Tue, 25 May 2010 21:44:39 -0700
Subject: bricscad goes native
In-Reply-To: <AANLkTin5sJ7YuoJ3atPgzDJMRP0nvYiB-MdoPLJjWQhw@mail.gmail.com>
References: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com>	<AANLkTilvcaxF7i1i3A5d4BI8jlkETwuRF6qY3Au4Jld5@mail.gmail.com>	<AANLkTinyx3F6JAb0F3Br6Ul_AasQCX6Whtc04cX-M8u_@mail.gmail.com>	<AANLkTim51nvuruznPRz6Cz4vyJqFprq6ReqTEYApMG5m@mail.gmail.com>	<AANLkTinBQ-HVTRu86gYbAbO-Va1pWfjrUVbnVZ07S7iw@mail.gmail.com>
	<AANLkTin5sJ7YuoJ3atPgzDJMRP0nvYiB-MdoPLJjWQhw@mail.gmail.com>
Message-ID: <4BFCA737.6030707@open-vote.org>

On 05/25/2010 11:39 AM, Dan Kegel wrote:
> On Tue, May 25, 2010 at 10:58 AM, Avery Pennarun <apenwarr at gmail.com> wrote:
>>> In either case, you probably want to bundle the Wine runtime
>>> with the app rather than trying to run against whatever Wine
>>> the user has.
>>
>> I guess this is because wine is such a moving target?  It seems a
>> shame to bundle a copy of wine with every single app, although I can
>> definitely see how commercial products would want to do that to
>> improve repeatability.  One would hope that all the automated testing
>> wine is doing lately would reduce the need for this kind of thing
>> eventually.
> 
> Commercial apps should continue bundling their own wine no matter
> what we do, I think.   It'll be a while before they can count
> on everyone already having a wine installed that can handle their app.
> And security concerns might prevent wine from being installed by default
> on some distros.
> 
> 

I believe a reasonable alternative is to communicate directly with the
distro Wine packager and have them test your app against whatever
version of Wine they plan on shipping.  That way you don't miss out on
good changes in Wine either.

In essence, you come to me with your app, have me verify the packaging
and put it in the archive (or store if it's a paid app), and have it
depend on the system Wine.  Then I check it against every Wine version
that gets into an official Ubuntu release.

Thanks,
Scott Ritchie


From dmitry at codeweavers.com  Wed May 26 02:17:42 2010
From: dmitry at codeweavers.com (Dmitry Timoshkov)
Date: Wed, 26 May 2010 16:17:42 +0900
Subject: bricscad goes native
In-Reply-To: <4BFCA737.6030707@open-vote.org>
References: <AANLkTimfiDDR2NEuZtH7IXLE1De4CkRizdEqWZ-Dgjj8@mail.gmail.com>
	<AANLkTilvcaxF7i1i3A5d4BI8jlkETwuRF6qY3Au4Jld5@mail.gmail.com>
	<AANLkTinyx3F6JAb0F3Br6Ul_AasQCX6Whtc04cX-M8u_@mail.gmail.com>
	<AANLkTim51nvuruznPRz6Cz4vyJqFprq6ReqTEYApMG5m@mail.gmail.com>
	<AANLkTinBQ-HVTRu86gYbAbO-Va1pWfjrUVbnVZ07S7iw@mail.gmail.com>
	<AANLkTin5sJ7YuoJ3atPgzDJMRP0nvYiB-MdoPLJjWQhw@mail.gmail.com>
	<4BFCA737.6030707@open-vote.org>
Message-ID: <20100526161742.06d570bc.dmitry@codeweavers.com>

Scott Ritchie <scott at open-vote.org> wrote:

> I believe a reasonable alternative is to communicate directly with the
> distro Wine packager and have them test your app against whatever
> version of Wine they plan on shipping.  That way you don't miss out on
> good changes in Wine either.

That's unreasonable to put the testing burden of a commercial application
to a 3rd party that's not a part of QA or a support team. Obviosuly you can't
test all the aspects of the application, or even don't know how to do that,
or testing requires additional data or tools.

-- 
Dmitry.


From harsha.angadi at gmail.com  Wed May 26 02:21:50 2010
From: harsha.angadi at gmail.com (Harsha Angadi)
Date: Wed, 26 May 2010 12:51:50 +0530
Subject: How to Create a Windows shared link in Wine(Ubuntu)
Message-ID: <AANLkTinA27tvzSzMOfdfhv_gvB0BfwHc27BaD-Mi3rBx@mail.gmail.com>

Hi,
   I have installed Windows 2003 Server, on that i have installed VMware and
in VMware i have installed Ubuntu.Now my requirement is i want to run a
Windows Application shortcut from Ubuntu, for that i have installed wine on
Ubuntu.Now i have copied and pasted the Shortcut of that Windows Application
on Ubuntu's Desktop. When i check the Windows Application shortcut
properties its path will be something like this *
\\192.168.1.15\Application\Application.exe*, but i am unable to run that
Application shortcut in Ubuntu. If i try samething on the other windows
system on network it works fine. Actually its a thin client server
architecture where i want my thin client to use ubuntu and access the
windows application shortcut and run the windows application shortcut on
ubuntu.Please help me in this regard. If this is not clear please tell me
how should be my input. Thanking you in advance.

With Regards,
Harsha S Angadi
http://www.google.com/profiles/harsha.angadi
http://www.linkedin.com/in/harshaangadi
http://www.nammagokak.com/discuss
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.winehq.org/pipermail/wine-devel/attachments/20100526/6910dac8/attachment-0001.htm>

From hans at codeweavers.com  Wed May 26 02:38:16 2010
From: hans at codeweavers.com (Hans Leidekker)
Date: Wed, 26 May 2010 09:38:16 +0200
Subject: How to Create a Windows shared link in Wine(Ubuntu)
In-Reply-To: <AANLkTinA27tvzSzMOfdfhv_gvB0BfwHc27BaD-Mi3rBx@mail.gmail.com>
References: <AANLkTinA27tvzSzMOfdfhv_gvB0BfwHc27BaD-Mi3rBx@mail.gmail.com>
Message-ID: <1274859496.8874.460.camel@t400>

On Wed, 2010-05-26 at 12:51 +0530, Harsha Angadi wrote:

> Shortcut of that Windows Application on Ubuntu's Desktop. When i check
> the Windows Application shortcut properties its path will be something
> like this \\192.168.1.15\Application\Application.exe, but i am unable
> to run that Application shortcut in Ubuntu. If i try samething on the 

Support for network paths is missing in Wine. As a workaround you
can mount the network share under Ubuntu, make sure it is visible 
to Wine, and change the shortcut to point there.

If you have further questions, please ask on wine-users, this is a
developer mailing list.




From testbot at testbot.winehq.org  Wed May 26 02:48:57 2010
From: testbot at testbot.winehq.org (testbot at testbot.winehq.org)
Date: Wed, 26 May 2010 09:48:57 +0200
Subject: [PATCH 1/2] d3d8: Set the FPU control word on device creation. 
Message-ID: <201005260748.o4Q7mvjR016075@v1.gse.nl>

Hi,

While running your changed tests on Windows, I think I found new failures.
Being a bot and all I'm not very good at pattern recognition, so I might be
wrong, but could you please double-check?
Full results can be found at
http://testbot.winehq.org/JobDetails.pl?Key=2319

Your paranoid android.


=== WVISTAADM (32 bit device) ===
device.c:1598: Test failed: Expected foreground window 00020210, got 00020260.


From bunglehead at gmail.com  Wed May 26 03:13:25 2010
From: bunglehead at gmail.com (Nikolay Sivov)
Date: Wed, 26 May 2010 12:13:25 +0400
Subject: [PATCH] wininternet: check for NULL lpwhh (Coverity)
In-Reply-To: <4bfcd6d1.0312970a.52d7.380aSMTPIN_ADDED@mx.google.com>
References: <4bfcd6d1.0312970a.52d7.380aSMTPIN_ADDED@mx.google.com>
Message-ID: <4BFCD825.3020206@gmail.com>

On 5/26/2010 11:53, Marcus Meissner wrote:
> Hi,
>
> the other cases also check for NULL lpwhh, so do it too.
>
> Ciao, Marcus
> ---
>   dlls/wininet/internet.c |    5 +++++
>   1 files changed, 5 insertions(+), 0 deletions(-)
>
> diff --git a/dlls/wininet/internet.c b/dlls/wininet/internet.c
> index 5b1913a..fd93276 100644
> --- a/dlls/wininet/internet.c
> +++ b/dlls/wininet/internet.c
> @@ -2581,6 +2581,11 @@ BOOL WINAPI InternetSetOptionW(HINTERNET hInternet, DWORD dwOption,
>       }
>       case INTERNET_OPTION_CONTEXT_VALUE:
>       {
> +        if (!lpwhh)
> +        {
> +            SetLastError(ERROR_INTERNET_INCORRECT_HANDLE_TYPE);
> +            return FALSE;
> +        }
>           if (!lpBuffer || dwBufferLength != sizeof(DWORD_PTR))
>           {
>               SetLastError(ERROR_INVALID_PARAMETER);
>    
Could you add a test for that?


